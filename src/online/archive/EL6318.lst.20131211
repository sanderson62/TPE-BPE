* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    39*-----------------------------------------------------------------
    40*REMARKS.
    41*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   3
* EL6318.cbl
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    49 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    50 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    51 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    52 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    53 77  s1                          pic s999 comp-3 value +0.
    54 77  s2                          pic s999 comp-3 value +0.
    55 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    56 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    57     88  ACCT-FOUND                 VALUE 'Y'.
    58 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    59 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    60 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    61 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    62 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    63 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    64 77  WS-REASON-SW                PIC X  VALUE ' '.
    65     88  REASONS-FOUND                  VALUE 'Y'.
    66     88  REASONS-NOT-FOUND              VALUE 'N'.
    67 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    68     88  NO-CERT-RW                 VALUE 'N'.
    69     88  CERT-RW                    VALUE 'Y'.
    70 01  P pointer.
    71 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    72 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    73 01  var-ptr pointer.
    74 01  env-var-len                 pic 9(4)  binary.
    75 01  rc                          pic 9(9)  binary.
    76 01  WS-KIXHOST                  PIC X(10).
    77 01  WS-KIXSYS.
    78     05  WS-KIX-FIL1             PIC X(10).
    79     05  WS-KIX-APPS             PIC X(10).
    80     05  WS-KIX-ENV              PIC X(10).
    81     05  WS-KIX-MYENV            PIC X(10).
    82     05  WS-KIX-SYS              PIC X(10).
    83*                                COPY ELCSCTM.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCTM                             *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-MESSAGE.
    94     12  FILLER                          PIC X(30)
    95            VALUE '** LOGIC SECURITY VIOLATION -'.
    96     12  SM-READ                         PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' PGM='.
    99     12  SM-PGM                          PIC X(6).
   100     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   4
* EL6318.cbl
   101            VALUE ' OPR='.
   102     12  SM-PROCESSOR-ID                 PIC X(4).
   103     12  FILLER                          PIC X(6)
   104            VALUE ' TERM='.
   105     12  SM-TERMID                       PIC X(4).
   106     12  FILLER                          PIC XX   VALUE SPACE.
   107     12  SM-JUL-DATE                     PIC 9(5).
   108     12  FILLER                          PIC X    VALUE SPACE.
   109     12  SM-TIME                         PIC 99.99.
   110
   111*                                COPY ELCSCRTY.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCRTY                            *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   119*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   120*        SAVED IN PI-SECURITY-ADDRESS.                           *
   121*                                                                *
   122******************************************************************
   123 01  SECURITY-CONTROL.
   124     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   125     12  FILLER                       PIC XX    VALUE 'SC'.
   126     12  SC-CREDIT-CODES.
   127         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   128             20  SC-CREDIT-DISPLAY    PIC X.
   129             20  SC-CREDIT-UPDATE     PIC X.
   130     12  SC-CLAIMS-CODES.
   131         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   132             20  SC-CLAIMS-DISPLAY    PIC X.
   133             20  SC-CLAIMS-UPDATE     PIC X.
   134 01 srch-commarea.
   135*                                copy ELCADLTRSPI.
   136******************************************************************
   137*                   C H A N G E   L O G
   138*
   139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   140*-----------------------------------------------------------------
   141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   142* EFFECTIVE    NUMBER
   143*-----------------------------------------------------------------
   144* 060611    2011022800001  PEMA  NEW COPYBOOK
   145* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   146* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   147******************************************************************
   148****************************************
   149*  commarea for NaperSoft On Demand Admin services letters
   150*  (business logic input & output)
   151****************************************
   152     03  BL-INPUT.
   153         05  BL-DATA-SRCE        PIC X.
   154         05  BL-LETTER-ID        PIC XXXX.
   155         05  BL-CARRIER          PIC X.
   156         05  BL-GROUP            PIC X(6).
   157         05  BL-STATE            PIC XX.
   158         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   5
* EL6318.cbl
   159         05  BL-EFF-DT           PIC X(10).
   160         05  BL-CERT-NO          PIC X(11).
   161         05  BL-BATCH-NO         PIC X(6).
   162         05  BL-BATCH-SEQ        PIC 9(8).
   163         05  BL-RESP-NO          PIC X(10).
   164         05  BL-NO-OF-COPIES     PIC 99.
   165         05  BL-PROC-ID          PIC XXXX.
   166         05  BL-COMP-ID          PIC XXX.
   167         05  BL-PRINT-NOW-SW     PIC X.
   168         05  BL-ENC-CD           PIC XXX.
   169         05  BL-RESEND-DT        PIC X(10).
   170         05  BL-FOLLOW-UP-DT     PIC X(10).
   171         05  BL-ARCHIVE-NO       PIC 9(8).
   172         05  BL-FUNC             PIC X(8).
   173         05  BL-COMMENTS         PIC X(100).
   174         05  FILLER REDEFINES BL-COMMENTS.
   175             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   176             10  BL-LETTER-TO-ACCT PIC X.
   177             10  BL-LETTER-TO-BENE PIC X.
   178             10  BL-WRITE-ERARCH   PIC X.
   179                 88  ERARCH-QWS      VALUE 'Q'.
   180                 88  ERARCH-BATCH    VALUE 'B'.
   181                 88  ERARCH-TEMP     VALUE 'T'.
   182             10  BL-PROCESS-TYPE PIC X(07).
   183             10  BL-CERT-FORM-ID PIC X(05).
   184             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   185             10  BL-SOURCE-SCREEN PIC X(8).
   186             10  FILLER          PIC X(25).
   187     03  BL-OUTPUT.
   188         05  BL-STATUS                   PIC X.
   189             88  BL-OK                      VALUE "P".
   190             88  BL-FAIL                  VALUE "F".
   191         05  BL-MESSAGE          PIC X(50).
   192     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   193     03  FILLER                  PIC X(31).
   194
   195*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   196*                                COPY ELCZREC.
   197******************************************************************
   198*                                                                *
   199*                                                                *
   200*                            ELCZREC.                            *
   201*                                                                *
   202*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   203*                                                                *
   204******************************************************************
   205*-----------------------------------------------------------------
   206*                   C H A N G E   L O G
   207*
   208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   209*-----------------------------------------------------------------
   210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   211* EFFECTIVE    NUMBER
   212*-----------------------------------------------------------------
   213* 122011    2011022800001  AJRA  NEW FILE
   214* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   215* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   216*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   6
* EL6318.cbl
   217 01  W-Z-CONTROL-DATA.
   218     05  W-NUMBER-OF-COPIES      PIC  9.
   219     05  FILLER                  PIC  X.
   220     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   221     05  FILLER                  PIC  X.
   222     05  W-DAYS-TO-RESEND        PIC  999.
   223     05  FILLER                  PIC  X.
   224     05  W-FORM-TO-RESEND        PIC  X(4).
   225     05  FILLER                  PIC  X.
   226     05  W-PROMPT-LETTER         PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-ENCLOSURE-CD          PIC  XXX.
   229     05  FILLER                  PIC  X.
   230     05  W-AUTO-CLOSE-IND        PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-LETTER-TO-BENE        PIC  X.
   233     05  FILLER                  PIC  X.
   234     05  W-LETTER-TO-ACCT        PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-LETTER-TYPE           PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-PRINT-CERTIFICATE     PIC  X.
   239     05  FILLER                  PIC  X.
   240     05  W-REFUND-REQUIRED       PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-ONBASE-CODE           PIC  XX.
   243     05  FILLER                  PIC  X.
   244     05  W-ACCT-SUMM             PIC  X.
   245     05  FILLER                  PIC  X.
   246     05  W-CSO-SUMM              PIC  X.
   247     05  FILLER                  PIC  X.
   248     05  W-REASONS-REQUIRED      PIC  X.
   249     05  FILLER                  PIC  X(29).
   250 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   251 01  STANDARD-AREAS.
   252     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   253     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   254                                 PIC  X(08).
   255     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   256     12  QID.
   257         16  QID-TERM        PIC X(4)    VALUE SPACES.
   258         16  FILLER          PIC X(4)    VALUE '631K'.
   259     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   260     12  TIME-MT                 PIC S9(7).
   261     12  TIME-MT-R  REDEFINES TIME-MT.
   262         16  FILLER              PIC X.
   263         16  TIME-LMT            PIC 99V99.
   264         16  FILLER              PIC X(2).
   265     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   266     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   267     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   268     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   269     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   270     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   271     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   272     12  W-CNTL-KEY.
   273         16  W-CNTL-COMPANY-ID   PIC  X(03).
   274         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   7
* EL6318.cbl
   275         16  W-CNTL-GENL.
   276             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   277             20  W-CNTL-GEN2.
   278                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   279                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   280         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   281     12  WS-ELCERT-KEY.
   282         16  W-CERT-COMPANY-CD   PIC X.
   283         16  W-CERT-CARRIER      PIC X.
   284         16  W-CERT-GROUPING     PIC X(6).
   285         16  W-CERT-STATE        PIC XX.
   286         16  W-CERT-ACCOUNT      PIC X(10).
   287         16  W-CERT-CERT-EFF-DT  PIC XX.
   288         16  W-CERT-CERT-PRIME   PIC X(10).
   289         16  W-CERT-CERT-SFX     PIC X.
   290     12  WS-ELEOBC-KEY.
   291         16  WS-EOBC-COMPANY-CD  PIC X.
   292         16  WS-EOBC-REC-TYPE    PIC X.
   293         16  WS-EOBC-CODE        PIC X(4).
   294         16  FILLER              PIC X(9).
   295     12  WS-ERNOTE-KEY.
   296         16  W-NOTE-COMPANY-CD   PIC X.
   297         16  W-NOTE-CARRIER      PIC X.
   298         16  W-NOTE-GROUPING     PIC X(6).
   299         16  W-NOTE-STATE        PIC XX.
   300         16  W-NOTE-ACCOUNT      PIC X(10).
   301         16  W-NOTE-CERT-EFF-DT  PIC XX.
   302         16  W-NOTE-CERT-PRIME   PIC X(10).
   303         16  W-NOTE-CERT-SFX     PIC X.
   304     12  ELLETR-KEY.
   305         16  LETR-PART-KEY.
   306             20  LETR-COMPANY-CD PIC X.
   307             20  LETR-LETTER-ID  PIC X(4).
   308         16  LETR-FILLER         PIC X(8).
   309         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   310     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   311     12  ERPNDB2-KEY.
   312         16  PNDB2-COMPANY-CD    PIC X.
   313         16  PNDB2-CARRIER       PIC X.
   314         16  PNDB2-GROUPING      PIC X(6).
   315         16  PNDB2-STATE         PIC XX.
   316         16  PNDB2-ACCOUNT       PIC X(10).
   317         16  PNDB2-CERT-EFF-DT   PIC XX.
   318         16  PNDB2-CERT-PRIME    PIC X(10).
   319         16  PNDB2-CERT-SFX      PIC X.
   320         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   321         16  PNDB2-RECORD-TYPE   PIC X.
   322     12  ERPNDB-KEY.
   323         16  PNDB-COMPANY-CD     PIC X.
   324         16  PNDB-BATCH-NO       PIC X(6).
   325         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   326         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   327     12  ERENDT-KEY.
   328         16  ENDT-COMPANY-CD       PIC X.
   329         16  ENDT-CARRIER          PIC X.
   330         16  ENDT-GROUPING         PIC X(6).
   331         16  ENDT-STATE            PIC XX.
   332         16  ENDT-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   8
* EL6318.cbl
   333         16  ENDT-CERT-EFF-DT      PIC XX.
   334         16  ENDT-CERT-PRIME       PIC X(10).
   335         16  ENDT-CERT-SFX         PIC X.
   336         16  ENDT-RECORD-TYPE      PIC X.
   337         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   338     12  ELCRTO-KEY.
   339         16  CRTO-COMPANY-CD     PIC X.
   340         16  CRTO-CARRIER        PIC X.
   341         16  CRTO-GROUPING       PIC X(6).
   342         16  CRTO-STATE          PIC XX.
   343         16  CRTO-ACCOUNT        PIC X(10).
   344         16  CRTO-CERT-EFF-DT    PIC XX.
   345         16  CRTO-CERT-PRIME     PIC X(10).
   346         16  CRTO-CERT-SFX       PIC X.
   347         16  CRTO-RECORD-TYPE    PIC X.
   348         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   349     12  WS-ELCRTT-KEY.
   350         16  WS-ELCRTT-PRIMARY   PIC X(33).
   351         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   352     12  WS-ERMAIL-KEY.
   353         16  MAIL-COMPANY-CD     PIC X.
   354         16  MAIL-CARRIER        PIC X.
   355         16  MAIL-GROUPING       PIC X(6).
   356         16  MAIL-STATE          PIC XX.
   357         16  MAIL-ACCOUNT        PIC X(10).
   358         16  MAIL-CERT-EFF-DT    PIC XX.
   359         16  MAIL-CERT-PRIME     PIC X(10).
   360         16  MAIL-CERT-SFX       PIC X.
   361     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   362     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   363     12  WS-CURRENT-DT.
   364         16  FILLER              PIC X(6)    VALUE SPACES.
   365         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   366     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   367     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   368         88  CANCEL-REC            VALUE 'C'.
   369         88  ISSUE-REC             VALUE 'I'.
   370     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   371     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   372     12  ELCNTL-KEY.
   373         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   374         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   375         16  CNTL-ACCESS.
   376             20  CNTL-STATE      PIC XX    VALUE SPACES.
   377             20  FILLER          PIC X     VALUE SPACES.
   378             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   379         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   380     12  WS-ERACCT-KEY.
   381         16  ACCT-COMPANY-CD     PIC X.
   382         16  ACCT-CARRIER        PIC X.
   383         16  ACCT-GROUPING       PIC X(6).
   384         16  ACCT-STATE          PIC XX.
   385         16  ACCT-ACCOUNT        PIC X(10).
   386         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   387         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   388     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   389     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   390     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page   9
* EL6318.cbl
   391     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   392     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   393     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   394     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   395     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   396     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   397     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   398     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   399     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   400     12  WS-RESPONSE             PIC S9(8)   COMP.
   401         88  RESP-NORMAL                  VALUE +00.
   402         88  RESP-NOTFND                  VALUE +13.
   403         88  RESP-DUPREC                  VALUE +14.
   404         88  RESP-DUPKEY                  VALUE +15.
   405         88  RESP-NOTOPEN                 VALUE +19.
   406         88  RESP-ENDFILE                 VALUE +20.
   407     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   408     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   409     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   410     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   411     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   412     12  PGM-NAME            PIC X(8).
   413     12  TIME-IN             PIC S9(7).
   414     12  TIME-OUT-R  REDEFINES TIME-IN.
   415         16  FILLER          PIC X.
   416         16  TIME-OUT        PIC 99V99.
   417         16  FILLER          PIC X(2).
   418     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   419     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   420     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   421     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   422     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   423     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   424     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   425     12  WS-PHONE.
   426         16  WS-PH1              PIC XXX.
   427         16  WS-PH2              PIC XXX.
   428         16  WS-PH3              PIC XXXX.
   429     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   430     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   431
   432     12  WS-BILLING-NOTE.
   433         16  WS-BN-NOTE          PIC X(25).
   434         16  WS-BN-LTRID         PIC X(4).
   435         16  FILLER              PIC X(3).
   436         16  WS-BN-DATE          PIC X(8).
   437         16  FILLER              PIC X(3).
   438         16  WS-BN-USERID        PIC X(4).
   439         16  FILLER              PIC X(30).
   440     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   441         16  WS-MAN-BN-NOTE      PIC X(63).
   442         16  FILLER              PIC X(14).
   443     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   444
   445     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   446
   447 01  NEW-ELCRTO-REC.
   448     12  NEW-ELCRTO-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  10
* EL6318.cbl
   449         16  NCRTO-COMPANY-CD      PIC X.
   450         16  NCRTO-CARRIER         PIC X.
   451         16  NCRTO-GROUPING        PIC X(6).
   452         16  NCRTO-STATE           PIC XX.
   453         16  NCRTO-ACCOUNT         PIC X(10).
   454         16  NCRTO-CERT-EFF-DT     PIC XX.
   455         16  NCRTO-CERT-PRIME      PIC X(10).
   456         16  NCRTO-CERT-SFX        PIC X.
   457         16  NCRTO-RECORD-TYPE     PIC X.
   458         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   459     12  NEW-ORIG-REC.
   460         16  NCRTO-INS-LAST-NAME   PIC X(15).
   461         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   462         16  NCRTO-INS-MIDDLE-INIT PIC X.
   463         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   464         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   465         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   466         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   467         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   468         16  NCRTO-LF-BENCD        PIC XX.
   469         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   470         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   471         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   472         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   473         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   474         16  NCRTO-LF-EXP-DT       PIC XX.
   475         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   476         16  NCRTO-LF-CANCEL-DT    PIC XX.
   477         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   478         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   479         16  NCRTO-AH-BENCD        PIC XX.
   480         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   481         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   482         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   483         16  NCRTO-AH-EXP-DT       PIC XX.
   484         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   485         16  NCRTO-AH-CP           PIC 99.
   486         16  NCRTO-AH-CANCEL-DT    PIC XX.
   487         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   488         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   489         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   490         16  NCRTO-1ST-PMT-DT      PIC XX.
   491         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   492         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   493         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   494         16  NCRTO-CANCEL-TRAN-IND PIC X.
   495         16  FILLER                PIC X(235).
   496
   497 01  CERT-NOTE-ENTRIES.
   498     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   499         16  CERT-NT-TEXT                PIC X(63).
   500         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   501         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   502         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   503
   504 01  ERCNOT-AREA.
   505     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   506     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  11
* EL6318.cbl
   507     12  ERCNOT-KEY.
   508         16  ERCNOT-PARTIAL-KEY.
   509             20 ERCNOT-COMPANY-CD    PIC X.
   510             20 ERCNOT-CARRIER       PIC X.
   511             20 ERCNOT-GROUPING      PIC X(06).
   512             20 ERCNOT-STATE         PIC XX.
   513             20 ERCNOT-ACCOUNT       PIC X(10).
   514             20 ERCNOT-EFF-DT        PIC XX.
   515             20 ERCNOT-CERT-NO.
   516                25 ERCNOT-CERT-PRIME PIC X(10).
   517                25 ERCNOT-CERT-SFX   PIC X.
   518             20 ERCNOT-REC-TYP       PIC X.
   519         16 ERCNOT-SEQ           PIC S9(4) COMP.
   520     12  SV-PARTIAL-KEY.
   521         20 SV-COMPANY-CD            PIC X.
   522         20 SV-CARRIER               PIC X.
   523         20 SV-GROUPING              PIC X(06).
   524         20 SV-STATE                 PIC XX.
   525         20 SV-ACCOUNT               PIC X(10).
   526         20 SV-EFF-DT                PIC XX.
   527         20 SV-CERT-NO.
   528            25 SV-CERT-PRIME         PIC X(10).
   529            25 SV-CERT-SFX           PIC X(1).
   530         20 SV-REC-TYP               PIC X.
   531 01  ERROR-MESSAGES.
   532     12  ER-0000                 PIC X(4)  VALUE '0000'.
   533     12  ER-0004                 PIC X(4)  VALUE '0004'.
   534     12  ER-0008                 PIC X(4)  VALUE '0008'.
   535     12  ER-0023                 PIC X(4)  VALUE '0023'.
   536     12  ER-0029                 PIC X(4)  VALUE '0029'.
   537     12  ER-0068                 PIC X(4)  VALUE '0068'.
   538     12  ER-0132                 PIC X(4)  VALUE '0132'.
   539     12  ER-0142                 PIC X(4)  VALUE '0142'.
   540     12  ER-0148                 PIC X(4)  VALUE '0148'.
   541     12  ER-0215                 PIC X(4)  VALUE '0215'.
   542     12  ER-0280                 PIC X(4)  VALUE '0280'.
   543     12  ER-0348                 PIC X(4)  VALUE '0348'.
   544     12  ER-0419                 PIC X(4)  VALUE '0419'.
   545     12  ER-0715                 PIC X(4)  VALUE '0715'.
   546     12  ER-0894                 PIC X(4)  VALUE '0894'.
   547     12  ER-1101                 PIC X(4)  VALUE '1101'.
   548     12  ER-1236                 PIC X(4)  VALUE '1236'.
   549     12  ER-1778                 PIC X(4)  VALUE '1778'.
   550     12  ER-1818                 PIC X(4)  VALUE '1818'.
   551     12  ER-1820                 PIC X(4)  VALUE '1820'.
   552     12  ER-1821                 PIC X(4)  VALUE '1821'.
   553     12  ER-2056                 PIC X(4)  VALUE '2056'.
   554     12  ER-2079                 PIC X(4)  VALUE '2079'.
   555     12  ER-2208                 PIC X(4)  VALUE '2208'.
   556     12  ER-2209                 PIC X(4)  VALUE '2209'.
   557     12  ER-2237                 PIC X(4)  VALUE '2237'.
   558     12  ER-2238                 PIC X(4)  VALUE '2238'.
   559     12  ER-2253                 PIC X(4)  VALUE '2253'.
   560     12  ER-2619                 PIC X(4)  VALUE '2619'.
   561     12  ER-2651                 PIC X(4)  VALUE '2651'.
   562     12  ER-2784                 PIC X(4)  VALUE '2784'.
   563     12  ER-2785                 PIC X(4)  VALUE '2785'.
   564     12  ER-2786                 PIC X(4)  VALUE '2786'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  12
* EL6318.cbl
   565     12  ER-2791                 PIC X(4)  VALUE '2791'.
   566     12  ER-2845                 PIC X(4)  VALUE '2845'.
   567     12  ER-2848                 PIC X(4)  VALUE '2848'.
   568     12  ER-2851                 PIC X(4)  VALUE '2851'.
   569     12  ER-3830                 PIC X(4)  VALUE '3830'.
   570     12  ER-3833                 PIC X(4)  VALUE '3833'.
   571     12  ER-7345                 PIC X(4)  VALUE '7345'.
   572     12  ER-7638                 PIC X(4)  VALUE '7638'.
   573     12  ER-8888                 PIC X(4)  VALUE '8888'.
   574     12  ER-9999                 PIC X(4)  VALUE '9999'.
   575*    COPY ELCDATE.
   576******************************************************************
   577*                                                                *
   578*                                                                *
   579*                            ELCDATE.                            *
   580*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   581*                            VMOD=2.003
   582*                                                                *
   583*                                                                *
   584*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   585*                 LENGTH = 200                                   *
   586******************************************************************
   587
   588 01  DATE-CONVERSION-DATA.
   589     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   590     12  DC-OPTION-CODE                PIC X.
   591         88  BIN-TO-GREG                VALUE ' '.
   592         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   593         88  EDIT-GREG-TO-BIN           VALUE '2'.
   594         88  YMD-GREG-TO-BIN            VALUE '3'.
   595         88  MDY-GREG-TO-BIN            VALUE '4'.
   596         88  JULIAN-TO-BIN              VALUE '5'.
   597         88  BIN-PLUS-ELAPSED           VALUE '6'.
   598         88  FIND-CENTURY               VALUE '7'.
   599         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   600         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   601         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   602         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   603         88  JULIAN-TO-BIN-3            VALUE 'C'.
   604         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   605         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   606         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   607         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   608         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   609         88  CHECK-LEAP-YEAR            VALUE 'H'.
   610         88  BIN-3-TO-GREG              VALUE 'I'.
   611         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   612         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   613         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   614         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   615         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   616         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   617         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   618         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   619         88  THREE-CHARACTER-BIN
   620                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   621         88  GREGORIAN-TO-BIN
   622                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  13
* EL6318.cbl
   623         88  BIN-TO-GREGORIAN
   624                  VALUES ' ' '1' 'I' '8' 'G'.
   625         88  JULIAN-TO-BINARY
   626                  VALUES '5' 'C' 'E' 'F'.
   627     12  DC-ERROR-CODE                 PIC X.
   628         88  NO-CONVERSION-ERROR        VALUE ' '.
   629         88  DATE-CONVERSION-ERROR
   630                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   631         88  DATE-IS-ZERO               VALUE '1'.
   632         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   633         88  DATE-IS-INVALID            VALUE '3'.
   634         88  DATE1-GREATER-DATE2        VALUE '4'.
   635         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   636         88  DATE-INVALID-OPTION        VALUE '9'.
   637         88  INVALID-CENTURY            VALUE 'A'.
   638         88  ONLY-CENTURY               VALUE 'B'.
   639         88  ONLY-LEAP-YEAR             VALUE 'C'.
   640         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   641     12  DC-END-OF-MONTH               PIC X.
   642         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   643     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   644         88  USE-NORMAL-PROCESS         VALUE ' '.
   645         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   646         88  ADJUST-UP-100-YRS          VALUE '2'.
   647     12  FILLER                        PIC X.
   648     12  DC-CONVERSION-DATES.
   649         16  DC-BIN-DATE-1             PIC XX.
   650         16  DC-BIN-DATE-2             PIC XX.
   651         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   652         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   653                       DC-GREG-DATE-1-EDIT.
   654             20  DC-EDIT1-MONTH        PIC 99.
   655             20  SLASH1-1              PIC X.
   656             20  DC-EDIT1-DAY          PIC 99.
   657             20  SLASH1-2              PIC X.
   658             20  DC-EDIT1-YEAR         PIC 99.
   659         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   660         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   661                     DC-GREG-DATE-2-EDIT.
   662             20  DC-EDIT2-MONTH        PIC 99.
   663             20  SLASH2-1              PIC X.
   664             20  DC-EDIT2-DAY          PIC 99.
   665             20  SLASH2-2              PIC X.
   666             20  DC-EDIT2-YEAR         PIC 99.
   667         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   668         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   669                     DC-GREG-DATE-1-YMD.
   670             20  DC-YMD-YEAR           PIC 99.
   671             20  DC-YMD-MONTH          PIC 99.
   672             20  DC-YMD-DAY            PIC 99.
   673         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   674         16  DC-GREG-DATE-1-MDY-R REDEFINES
   675                      DC-GREG-DATE-1-MDY.
   676             20  DC-MDY-MONTH          PIC 99.
   677             20  DC-MDY-DAY            PIC 99.
   678             20  DC-MDY-YEAR           PIC 99.
   679         16  DC-GREG-DATE-1-ALPHA.
   680             20  DC-ALPHA-MONTH        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  14
* EL6318.cbl
   681             20  DC-ALPHA-DAY          PIC 99.
   682             20  FILLER                PIC XX.
   683             20  DC-ALPHA-CENTURY.
   684                 24 DC-ALPHA-CEN-N     PIC 99.
   685             20  DC-ALPHA-YEAR         PIC 99.
   686         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   687         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   688         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   689         16  DC-JULIAN-DATE            PIC 9(05).
   690         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   691                                       PIC 9(05).
   692         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   693             20  DC-JULIAN-YEAR        PIC 99.
   694             20  DC-JULIAN-DAYS        PIC 999.
   695         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   696         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   697         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   698     12  DATE-CONVERSION-VARIBLES.
   699         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   700         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   701             20  FILLER                PIC 9(3).
   702             20  HOLD-CEN-1-CCYY.
   703                 24  HOLD-CEN-1-CC     PIC 99.
   704                 24  HOLD-CEN-1-YY     PIC 99.
   705             20  HOLD-CEN-1-MO         PIC 99.
   706             20  HOLD-CEN-1-DA         PIC 99.
   707         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   708             20  HOLD-CEN-1-R-MO       PIC 99.
   709             20  HOLD-CEN-1-R-DA       PIC 99.
   710             20  HOLD-CEN-1-R-CCYY.
   711                 24  HOLD-CEN-1-R-CC   PIC 99.
   712                 24  HOLD-CEN-1-R-YY   PIC 99.
   713             20  FILLER                PIC 9(3).
   714         16  HOLD-CENTURY-1-X.
   715             20  FILLER                PIC X(3)  VALUE SPACES.
   716             20  HOLD-CEN-1-X-CCYY.
   717                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   718                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   719             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   720             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   721         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   722             20  HOLD-CEN-1-R-X-MO     PIC XX.
   723             20  HOLD-CEN-1-R-X-DA     PIC XX.
   724             20  HOLD-CEN-1-R-X-CCYY.
   725                 24  HOLD-CEN-1-R-X-CC PIC XX.
   726                 24  HOLD-CEN-1-R-X-YY PIC XX.
   727             20  FILLER                PIC XXX.
   728         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   729         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   730         16  DC-JULIAN-DATE-1          PIC 9(07).
   731         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   732             20  DC-JULIAN-1-CCYY.
   733                 24  DC-JULIAN-1-CC    PIC 99.
   734                 24  DC-JULIAN-1-YR    PIC 99.
   735             20  DC-JULIAN-DA-1        PIC 999.
   736         16  DC-JULIAN-DATE-2          PIC 9(07).
   737         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   738             20  DC-JULIAN-2-CCYY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  15
* EL6318.cbl
   739                 24  DC-JULIAN-2-CC    PIC 99.
   740                 24  DC-JULIAN-2-YR    PIC 99.
   741             20  DC-JULIAN-DA-2        PIC 999.
   742         16  DC-GREG-DATE-A-EDIT.
   743             20  DC-EDITA-MONTH        PIC 99.
   744             20  SLASHA-1              PIC X VALUE '/'.
   745             20  DC-EDITA-DAY          PIC 99.
   746             20  SLASHA-2              PIC X VALUE '/'.
   747             20  DC-EDITA-CCYY.
   748                 24  DC-EDITA-CENT     PIC 99.
   749                 24  DC-EDITA-YEAR     PIC 99.
   750         16  DC-GREG-DATE-B-EDIT.
   751             20  DC-EDITB-MONTH        PIC 99.
   752             20  SLASHB-1              PIC X VALUE '/'.
   753             20  DC-EDITB-DAY          PIC 99.
   754             20  SLASHB-2              PIC X VALUE '/'.
   755             20  DC-EDITB-CCYY.
   756                 24  DC-EDITB-CENT     PIC 99.
   757                 24  DC-EDITB-YEAR     PIC 99.
   758         16  DC-GREG-DATE-CYMD         PIC 9(08).
   759         16  DC-GREG-DATE-CYMD-R REDEFINES
   760                              DC-GREG-DATE-CYMD.
   761             20  DC-CYMD-CEN           PIC 99.
   762             20  DC-CYMD-YEAR          PIC 99.
   763             20  DC-CYMD-MONTH         PIC 99.
   764             20  DC-CYMD-DAY           PIC 99.
   765         16  DC-GREG-DATE-MDCY         PIC 9(08).
   766         16  DC-GREG-DATE-MDCY-R REDEFINES
   767                              DC-GREG-DATE-MDCY.
   768             20  DC-MDCY-MONTH         PIC 99.
   769             20  DC-MDCY-DAY           PIC 99.
   770             20  DC-MDCY-CEN           PIC 99.
   771             20  DC-MDCY-YEAR          PIC 99.
   772    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   773        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   774    12  DC-EL310-DATE                  PIC X(21).
   775    12  FILLER                         PIC X(28).
   776*    COPY ELCTEXT.
   777******************************************************************
   778*                                                                *
   779*                                                                *
   780*                            ELCTEXT.                            *
   781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   782*                            VMOD=2.008                          *
   783*                                                                *
   784*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   785*                                     FORM LETTERS,              *
   786*                                     CERT FORM DISPLAY.
   787*                                                                *
   788*   FILE TYPE = VSAM,KSDS                                        *
   789*   RECORD SIZE = 100   RECFORM = FIXED                          *
   790*                                                                *
   791*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   792*       ALTERNATE INDEX = NONE                                   *
   793*                                                                *
   794*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   795*       ALTERNATE INDEX = NONE                                   *
   796*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  16
* EL6318.cbl
   797*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   798*       ALTERNATE INDEX = NONE                                   *
   799*                                                                *
   800*   LOG = NO                                                     *
   801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   802******************************************************************
   803 01  TEXT-FILES.
   804     12  TEXT-FILE-ID                PIC XX.
   805         88  FORMS-FILE-TEXT            VALUE 'TF'.
   806         88  LETTER-FILE-TEXT           VALUE 'TL'.
   807         88  HELP-FILE-TEXT             VALUE 'TH'.
   808
   809     12  TX-CONTROL-PRIMARY.
   810         16  TX-COMPANY-CD           PIC X.
   811             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   812         16  TX-ACCESS-CD-GENL       PIC X(12).
   813
   814         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   815             20  TX-LETTER-NO        PIC X(4).
   816             20  FILLER              PIC X(8).
   817
   818         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   819             20  TX-FORM-NO          PIC X(12).
   820
   821         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   822             20  TX-HELP-TYPE        PIC X.
   823                 88  HELP-FOR-GENERAL   VALUE ' '.
   824                 88  HELP-BY-SCREEN     VALUE 'S'.
   825                 88  HELP-BY-ERROR      VALUE 'E'.
   826             20  TX-SCREEN-OR-ERROR  PIC X(4).
   827                 88  GENERAL-INFO-HELP  VALUE '0000'.
   828             20  TX-HELP-FOR-COMPANY  PIC XXX.
   829                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   830             20  FILLER              PIC X(4).
   831
   832         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   833
   834     12  TX-PROCESS-CONTROL          PIC XX.
   835         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   836
   837     12  TX-TEXT-LINE                PIC X(70).
   838
   839     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   840         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   841         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   842         88  TX-VALID-FORM-SQUEEZE-VALUE
   843                                        VALUE 'Y' ' '.
   844
   845     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   846         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   847         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   848         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   849         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   850         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   851         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   852         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   853                                              'K' 'N' ' '
   854                                              'Z'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  17
* EL6318.cbl
   855
   856     12  TX-ARCHIVE-SW               PIC X.
   857         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   858         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   859         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   860
   861     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   862     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   863
   864     12  TX-BSR-CODE                 PIC X.
   865         88  TX-BSR-LETTER              VALUE 'B'.
   866         88  TX-NON-BSR-LETTER          VALUE ' '.
   867
   868     12  FILLER                      PIC X.
   869*****************************************************************
   870*    COPY ELCLOGOF.
   871******************************************************************
   872*                                                                *
   873*                                                                *
   874*                            ELCLOGOF.                           *
   875*                            VMOD=2.001                          *
   876*                                                                *
   877*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   878*                                                                *
   879******************************************************************
   880 01  CLASIC-LOGOFF.
   881     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   882     12  LOGOFF-TEXT.
   883         16  FILLER          PIC X(5)    VALUE SPACES.
   884         16  LOGOFF-MSG.
   885             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   886             20  FILLER      PIC X       VALUE SPACES.
   887             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   888         16  FILLER          PIC X(80)
   889           VALUE '* YOU ARE NOW LOGGED OFF'.
   890         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   891         16  FILLER          PIC X       VALUE QUOTE.
   892         16  LOGOFF-SYS-MSG  PIC X(17)
   893           VALUE 'S CLAS-IC SYSTEM '.
   894     12  TEXT-MESSAGES.
   895         16  UNACCESS-MSG    PIC X(29)
   896             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   897         16  PGMIDERR-MSG    PIC X(17)
   898             VALUE 'PROGRAM NOT FOUND'.
   899*    COPY ELCATTR.
   900******************************************************************
   901*                                                                *
   902*                            ELCATTR.                            *
   903*                            VMOD=2.001                          *
   904*                                                                *
   905*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   906*                                                                *
   907*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   908*                                                                *
   909*                   POS 1   P=PROTECTED                          *
   910*                           U=UNPROTECTED                        *
   911*                           S=ASKIP                              *
   912*                   POS 2   A=ALPHA/NUMERIC                      *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  18
* EL6318.cbl
   913*                           N=NUMERIC                            *
   914*                   POS 3   N=NORMAL                             *
   915*                           B=BRIGHT                             *
   916*                           D=DARK                               *
   917*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   918*                           OF=MODIFIED DATA TAG OFF             *
   919*                                                                *
   920*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   921******************************************************************
   922 01  ATTRIBUTE-LIST.
   923     12  AL-PABOF            PIC X       VALUE 'Y'.
   924     12  AL-PABON            PIC X       VALUE 'Z'.
   925     12  AL-PADOF            PIC X       VALUE '%'.
   926     12  AL-PADON            PIC X       VALUE '_'.
   927     12  AL-PANOF            PIC X       VALUE '-'.
   928     12  AL-PANON            PIC X       VALUE '/'.
   929     12  AL-SABOF            PIC X       VALUE '8'.
   930     12  AL-SABON            PIC X       VALUE '9'.
   931     12  AL-SADOF            PIC X       VALUE '@'.
   932     12  AL-SADON            PIC X       VALUE QUOTE.
   933     12  AL-SANOF            PIC X       VALUE '0'.
   934     12  AL-SANON            PIC X       VALUE '1'.
   935     12  AL-UABOF            PIC X       VALUE 'H'.
   936     12  AL-UABON            PIC X       VALUE 'I'.
   937     12  AL-UADOF            PIC X       VALUE '<'.
   938     12  AL-UADON            PIC X       VALUE '('.
   939     12  AL-UANOF            PIC X       VALUE ' '.
   940     12  AL-UANON            PIC X       VALUE 'A'.
   941     12  AL-UNBOF            PIC X       VALUE 'Q'.
   942     12  AL-UNBON            PIC X       VALUE 'R'.
   943     12  AL-UNDOF            PIC X       VALUE '*'.
   944     12  AL-UNDON            PIC X       VALUE ')'.
   945     12  AL-UNNOF            PIC X       VALUE '&'.
   946     12  AL-UNNON            PIC X       VALUE 'J'.
   947*    COPY ELCEMIB.
   948******************************************************************
   949*                                                                *
   950*                                                                *
   951*                            ELCEMIB.                            *
   952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   953*                            VMOD=2.005                          *
   954*                                                                *
   955*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   956*                                                                *
   957******************************************************************
   958 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   959     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   960     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   961     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   962     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   963     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   964     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   965     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   966     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   967     12  EMI-SWITCH1             PIC X        VALUE '1'.
   968         88  EMI-NO-ERRORS                    VALUE '1'.
   969         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   970         88  EMI-ERRORS-COMPLETE              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  19
* EL6318.cbl
   971     12  EMI-SWITCH2             PIC X        VALUE '1'.
   972         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   973     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   974         88  EMI-AREA1-EMPTY                  VALUE '1'.
   975         88  EMI-AREA1-FULL                   VALUE '2'.
   976     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   977         88  EMI-AREA2-EMPTY                  VALUE '1'.
   978         88  EMI-AREA2-FULL                   VALUE '2'.
   979     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   980         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   981         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   982         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   983         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   984         88  EMI-BYPASS-FATALS                VALUE 'X'.
   985     12  EMI-ERROR-LINES.
   986         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   987         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   988         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   989         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   990             20  EMI-ERR-CODES OCCURS 10 TIMES.
   991                 24  EMI-ERR-NUM         PIC X(4).
   992                 24  EMI-FILLER          PIC X.
   993                 24  EMI-SEV             PIC X.
   994                 24  FILLER              PIC X.
   995             20  FILLER                  PIC X(02).
   996     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   997         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   998             20  EMI-ERROR-NUMBER    PIC X(4).
   999             20  EMI-FILL            PIC X.
  1000             20  EMI-SEVERITY        PIC X.
  1001             20  FILLER              PIC X.
  1002             20  EMI-ERROR-TEXT.
  1003                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1004                 24  FILLER          PIC X(55).
  1005     12  EMI-SEVERITY-SAVE           PIC X.
  1006         88  EMI-NOTE                    VALUE 'N'.
  1007         88  EMI-WARNING                 VALUE 'W'.
  1008         88  EMI-FORCABLE                VALUE 'F'.
  1009         88  EMI-FATAL                   VALUE 'X'.
  1010     12  EMI-MESSAGE-FLAG            PIC X.
  1011         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1012         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1013     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1014     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1015         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1016         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1017         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1018     12  FILLER                      PIC X(137)  VALUE SPACES.
  1019     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1020     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1021     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1022     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1023*    COPY ELCINTF.
  1024******************************************************************
  1025*                                                                *
  1026*                                                                *
  1027*                            ELCINTF.                            *
  1028*                            VMOD=2.017                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  20
* EL6318.cbl
  1029*                                                                *
  1030*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1031*                                                                *
  1032*       LENGTH = 1024                                            *
  1033*                                                                *
  1034******************************************************************
  1035*                   C H A N G E   L O G
  1036*
  1037* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1038*-----------------------------------------------------------------
  1039*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1040* EFFECTIVE    NUMBER
  1041*-----------------------------------------------------------------
  1042* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1043******************************************************************
  1044 01  PROGRAM-INTERFACE-BLOCK.
  1045     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1046     12  PI-CALLING-PROGRAM              PIC X(8).
  1047     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1048     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1049     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1050     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1051     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1052     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1053     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1054     12  PI-COMPANY-ID                   PIC XXX.
  1055     12  PI-COMPANY-CD                   PIC X.
  1056
  1057     12  PI-COMPANY-PASSWORD             PIC X(8).
  1058
  1059     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1060
  1061     12  PI-CONTROL-IN-PROGRESS.
  1062         16  PI-CARRIER                  PIC X.
  1063         16  PI-GROUPING                 PIC X(6).
  1064         16  PI-STATE                    PIC XX.
  1065         16  PI-ACCOUNT                  PIC X(10).
  1066         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1067                                         PIC X(10).
  1068         16  PI-CLAIM-CERT-GRP.
  1069             20  PI-CLAIM-NO             PIC X(7).
  1070             20  PI-CERT-NO.
  1071                 25  PI-CERT-PRIME       PIC X(10).
  1072                 25  PI-CERT-SFX         PIC X.
  1073             20  PI-CERT-EFF-DT          PIC XX.
  1074         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1075             20  PI-PLAN-CODE            PIC X(2).
  1076             20  PI-REVISION-NUMBER      PIC X(3).
  1077             20  PI-PLAN-EFF-DT          PIC X(2).
  1078             20  PI-PLAN-EXP-DT          PIC X(2).
  1079             20  FILLER                  PIC X(11).
  1080         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1081             20  PI-OE-REFERENCE-1.
  1082                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1083                 25  PI-OE-REF-1-SUFF    PIC XX.
  1084
  1085     12  PI-SESSION-IN-PROGRESS          PIC X.
  1086         88  CLAIM-SESSION                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  21
* EL6318.cbl
  1087         88  CREDIT-SESSION                  VALUE '2'.
  1088         88  WARRANTY-SESSION                VALUE '3'.
  1089         88  MORTGAGE-SESSION                VALUE '4'.
  1090         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1091
  1092
  1093*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1094
  1095     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1096     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1097
  1098     12  PI-CREDIT-USER                  PIC X.
  1099         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1100         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1101
  1102     12  PI-CLAIM-USER                   PIC X.
  1103         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1104         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1105
  1106     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1107         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1108         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1109         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1110         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1111         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1112
  1113     12  PI-PROCESSOR-ID                 PIC X(4).
  1114
  1115     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1116
  1117     12  PI-MEMBER-CAPTION               PIC X(10).
  1118
  1119     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1120         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1121
  1122     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1123     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1124     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1125     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1126
  1127     12  PI-AH-OVERRIDE-L1               PIC X.
  1128     12  PI-AH-OVERRIDE-L2               PIC XX.
  1129     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1130     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1131
  1132     12  PI-NEW-SYSTEM                   PIC X(2).
  1133
  1134     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1135     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1136         88  PI-USES-PAID-TO                 VALUE '1'.
  1137     12  PI-CRDTCRD-SYSTEM.
  1138         16  PI-CRDTCRD-USER             PIC X.
  1139             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1140             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1141         16  PI-CC-MONTH-END-DT          PIC XX.
  1142     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1143
  1144     12  PI-OE-REFERENCE-2.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  22
* EL6318.cbl
  1145         16  PI-OE-REF-2-PRIME           PIC X(10).
  1146         16  PI-OE-REF-2-SUFF            PIC X.
  1147
  1148     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1149
  1150     12  PI-LANGUAGE-TYPE                PIC X.
  1151             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1152             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1153             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1154
  1155     12  PI-POLICY-LINKAGE-IND           PIC X.
  1156         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1157         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1158                                                   LOW-VALUES.
  1159
  1160     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1161     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1162         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1163         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1164
  1165     12  PI-PROCESSOR-CSR-IND            PIC X.
  1166         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1167         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1168
  1169     12  FILLER                          PIC X(3).
  1170
  1171     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1172
  1173     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1174         PI-SYSTEM-LEVEL.
  1175
  1176         16  PI-ENTRY-CODES.
  1177             20  PI-ENTRY-CD-1           PIC X.
  1178             20  PI-ENTRY-CD-2           PIC X.
  1179
  1180         16  PI-RETURN-CODES.
  1181             20  PI-RETURN-CD-1          PIC X.
  1182             20  PI-RETURN-CD-2          PIC X.
  1183
  1184         16  PI-UPDATE-STATUS-SAVE.
  1185             20  PI-UPDATE-BY            PIC X(4).
  1186             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1187
  1188         16  PI-LOWER-CASE-LETTERS       PIC X.
  1189             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1190
  1191*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1192*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1193*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1194
  1195         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1196             88  ST-ACCNT-CNTL               VALUE ' '.
  1197             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1198             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1199             88  ACCNT-CNTL                  VALUE '3'.
  1200             88  CARR-ACCNT-CNTL             VALUE '4'.
  1201
  1202         16  PI-PROCESSOR-CAP-LIST.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  23
* EL6318.cbl
  1203             20  PI-SYSTEM-CONTROLS.
  1204                24 PI-SYSTEM-DISPLAY     PIC X.
  1205                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1206                24 PI-SYSTEM-MODIFY      PIC X.
  1207                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1208             20  FILLER                  PIC XX.
  1209             20  PI-DISPLAY-CAP          PIC X.
  1210                 88  DISPLAY-CAP             VALUE 'Y'.
  1211             20  PI-MODIFY-CAP           PIC X.
  1212                 88  MODIFY-CAP              VALUE 'Y'.
  1213             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1214                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1215             20  PI-FORCE-CAP            PIC X.
  1216                 88  FORCE-CAP               VALUE 'Y'.
  1217
  1218         16  PI-PROGRAM-CONTROLS.
  1219             20  PI-PGM-PRINT-OPT        PIC X.
  1220             20  PI-PGM-FORMAT-OPT       PIC X.
  1221             20  PI-PGM-PROCESS-OPT      PIC X.
  1222             20  PI-PGM-TOTALS-OPT       PIC X.
  1223
  1224         16  PI-HELP-INTERFACE.
  1225             20  PI-LAST-ERROR-NO        PIC X(4).
  1226             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1227
  1228         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1229             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1230
  1231         16  PI-CR-CONTROL-IN-PROGRESS.
  1232             20  PI-CR-CARRIER           PIC X.
  1233             20  PI-CR-GROUPING          PIC X(6).
  1234             20  PI-CR-STATE             PIC XX.
  1235             20  PI-CR-ACCOUNT           PIC X(10).
  1236             20  PI-CR-FIN-RESP          PIC X(10).
  1237             20  PI-CR-TYPE              PIC X.
  1238
  1239         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1240
  1241         16  PI-CR-MONTH-END-DT          PIC XX.
  1242
  1243         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1244             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1245             88  PI-ZERO-CARRIER             VALUE '1'.
  1246             88  PI-ZERO-GROUPING            VALUE '2'.
  1247             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1248
  1249         16  PI-CARRIER-SECURITY         PIC X.
  1250             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1251
  1252         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1253             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1254             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1255
  1256         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1257             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1258                                         INDEXED BY PI-ACCESS-NDX
  1259                                         PIC X.
  1260
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  24
* EL6318.cbl
  1261         16  PI-GA-BILLING-CONTROL       PIC X.
  1262             88  PI-GA-BILLING               VALUE '1'.
  1263
  1264         16  PI-MAIL-PROCESSING          PIC X.
  1265             88  PI-MAIL-YES                 VALUE 'Y'.
  1266
  1267         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1268
  1269         16  PI-AR-SYSTEM.
  1270             20  PI-AR-PROCESSING-CNTL   PIC X.
  1271                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1272             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1273             20  PI-AR-MONTH-END-DT      PIC XX.
  1274
  1275         16  PI-MP-SYSTEM.
  1276             20  PI-MORTGAGE-USER            PIC X.
  1277                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1278                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1279             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1280                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1281                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1282                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1283                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1284                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1285             20  PI-MP-MONTH-END-DT          PIC XX.
  1286             20  PI-MP-REFERENCE-NO.
  1287                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1288                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1289
  1290         16  PI-LABEL-CONTROL            PIC X(01).
  1291             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1292             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1293
  1294         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1295             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1296
  1297         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1298             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1299             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1300
  1301         16  FILLER                      PIC X(14).
  1302
  1303     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1304******************************************************************
  1305     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1306        16  PI-ISS-CAN-SW           PIC X.
  1307        16  PI-ERENDT-KEY.
  1308            20  PI-ENDT-COMPANY-CD  PIC X.
  1309            20  PI-ENDT-CARRIER     PIC X.
  1310            20  PI-ENDT-GROUPING    PIC X(6).
  1311            20  PI-ENDT-STATE       PIC XX.
  1312            20  PI-ENDT-ACCOUNT     PIC X(10).
  1313            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1314            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1315            20  PI-ENDT-CERT-SFX    PIC X.
  1316            20  PI-ENDT-RECORD-TYPE PIC X.
  1317            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1318        16  PI-ELCRTO-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  25
* EL6318.cbl
  1319            20  PI-CRTO-COMPANY-CD  PIC X.
  1320            20  PI-CRTO-CARRIER     PIC X.
  1321            20  PI-CRTO-GROUPING    PIC X(6).
  1322            20  PI-CRTO-STATE       PIC XX.
  1323            20  PI-CRTO-ACCOUNT     PIC X(10).
  1324            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1325            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1326            20  PI-CRTO-CERT-SFX    PIC X.
  1327            20  PI-CRTO-RECORD-TYPE PIC X.
  1328            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1329        16  PI-ERPNDB-KEY           PIC X(11).
  1330        16  PI-DOCUMENT-PROCESSED   PIC X.
  1331            88  PI-VERI-PROCESSED      VALUE 'V'.
  1332            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1333        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1334        16  PI-RES-REF-CLM-TYPE     PIC X.
  1335        16  PI-CLM-REFORM-IND       PIC X.
  1336            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1337        16  PI-CLEAR-ERROR-SW       PIC X.
  1338            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1339        16  PI-PRINT-CERTIFICATE    PIC X.
  1340        16  PI-ENTERED.
  1341            20  PI-PRTSW-ENTERED    PIC X.
  1342            20  PI-SIGREQ-ENTERED   PIC X.
  1343            20  PI-MONEY-ENTERED    PIC X.
  1344            20  PI-LTRID-ENTERED    PIC X(4).
  1345            20  PI-VOUCHER-ENTERED  PIC X.
  1346            20  PI-HLTHAPP-ENTERED  PIC X.
  1347            20  PI-PAYEE-ENTERED    PIC X(10).
  1348            20  PI-CERTID-ENTERED   PIC X(5).
  1349            20  PI-REASONS-ENTERED  PIC X(84).
  1350            20  PI-CERTNT1-ENTERED  PIC X(63).
  1351            20  PI-CERTNT2-ENTERED  PIC X(63).
  1352        16  PI-FINALIZED-IND        PIC X.
  1353        16  PI-CERTNT3-ENTERED      PIC X(63).
  1354        16  PI-CERTNT4-ENTERED      PIC X(63).
  1355        16  PI-BILLNT1-ENTERED      PIC X(63).
  1356        16  PI-BILLNT2-ENTERED      PIC X(63).
  1357        16  PI-REASON-CODE-IND      PIC X(26).
  1358        16  FILLER                  PIC X(2).
  1359    12  FILLER                      PIC X(276).
  1360*    COPY ELCAID.
  1361******************************************************************
  1362*                                                                *
  1363*                            ELCAID.                             *
  1364*                            VMOD=2.001                          *
  1365*                                                                *
  1366*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1367*                                                                *
  1368*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1369*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1370******************************************************************
  1371
  1372 01  DFHAID.
  1373   02  DFHNULL   PIC  X  VALUE  ' '.
  1374   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1375   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1376   02  DFHPEN    PIC  X  VALUE  '='.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  26
* EL6318.cbl
  1377   02  DFHOPID   PIC  X  VALUE  'W'.
  1378   02  DFHPA1    PIC  X  VALUE  '%'.
  1379   02  DFHPA2    PIC  X  VALUE  '>'.
  1380   02  DFHPA3    PIC  X  VALUE  ','.
  1381   02  DFHPF1    PIC  X  VALUE  '1'.
  1382   02  DFHPF2    PIC  X  VALUE  '2'.
  1383   02  DFHPF3    PIC  X  VALUE  '3'.
  1384   02  DFHPF4    PIC  X  VALUE  '4'.
  1385   02  DFHPF5    PIC  X  VALUE  '5'.
  1386   02  DFHPF6    PIC  X  VALUE  '6'.
  1387   02  DFHPF7    PIC  X  VALUE  '7'.
  1388   02  DFHPF8    PIC  X  VALUE  '8'.
  1389   02  DFHPF9    PIC  X  VALUE  '9'.
  1390   02  DFHPF10   PIC  X  VALUE  ':'.
  1391   02  DFHPF11   PIC  X  VALUE  '#'.
  1392   02  DFHPF12   PIC  X  VALUE  '@'.
  1393   02  DFHPF13   PIC  X  VALUE  'A'.
  1394   02  DFHPF14   PIC  X  VALUE  'B'.
  1395   02  DFHPF15   PIC  X  VALUE  'C'.
  1396   02  DFHPF16   PIC  X  VALUE  'D'.
  1397   02  DFHPF17   PIC  X  VALUE  'E'.
  1398   02  DFHPF18   PIC  X  VALUE  'F'.
  1399   02  DFHPF19   PIC  X  VALUE  'G'.
  1400   02  DFHPF20   PIC  X  VALUE  'H'.
  1401   02  DFHPF21   PIC  X  VALUE  'I'.
  1402*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1403   02  DFHPF22   PIC  X  VALUE  '['.
  1404   02  DFHPF23   PIC  X  VALUE  '.'.
  1405   02  DFHPF24   PIC  X  VALUE  '<'.
  1406   02  DFHMSRE   PIC  X  VALUE  'X'.
  1407   02  DFHSTRF   PIC  X  VALUE  'h'.
  1408   02  DFHTRIG   PIC  X  VALUE  '"'.
  1409 01  FILLER    REDEFINES DFHAID.
  1410     12  FILLER              PIC X(8).
  1411     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1412     12  FILLER              PIC X(3).
  1413*   COPY EL6318S.
  1414 01  EL631KI.
  1415     05  FILLER            PIC  X(0012).
  1416*    -------------------------------
  1417     05  DATEL PIC S9(0004) COMP.
  1418     05  DATEF PIC  X(0001).
  1419     05  FILLER REDEFINES DATEF.
  1420         10  DATEA PIC  X(0001).
  1421     05  DATEI PIC  X(0008).
  1422*    -------------------------------
  1423     05  TIMEL PIC S9(0004) COMP.
  1424     05  TIMEF PIC  X(0001).
  1425     05  FILLER REDEFINES TIMEF.
  1426         10  TIMEA PIC  X(0001).
  1427     05  TIMEI PIC  X(0005).
  1428*    -------------------------------
  1429     05  PROCIDL PIC S9(0004) COMP.
  1430     05  PROCIDF PIC  X(0001).
  1431     05  FILLER REDEFINES PROCIDF.
  1432         10  PROCIDA PIC  X(0001).
  1433     05  PROCIDI PIC  X(0004).
  1434*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  27
* EL6318.cbl
  1435     05  HOSTL PIC S9(0004) COMP.
  1436     05  HOSTF PIC  X(0001).
  1437     05  FILLER REDEFINES HOSTF.
  1438         10  HOSTA PIC  X(0001).
  1439     05  HOSTI PIC  X(0009).
  1440*    -------------------------------
  1441     05  SYSL PIC S9(0004) COMP.
  1442     05  SYSF PIC  X(0001).
  1443     05  FILLER REDEFINES SYSF.
  1444         10  SYSA PIC  X(0001).
  1445     05  SYSI PIC  X(0005).
  1446*    -------------------------------
  1447     05  COMPANYL PIC S9(0004) COMP.
  1448     05  COMPANYF PIC  X(0001).
  1449     05  FILLER REDEFINES COMPANYF.
  1450         10  COMPANYA PIC  X(0001).
  1451     05  COMPANYI PIC  X(0003).
  1452*    -------------------------------
  1453     05  DATASORL PIC S9(0004) COMP.
  1454     05  DATASORF PIC  X(0001).
  1455     05  FILLER REDEFINES DATASORF.
  1456         10  DATASORA PIC  X(0001).
  1457     05  DATASORI PIC  X(0001).
  1458*    -------------------------------
  1459     05  BATCHNOL PIC S9(0004) COMP.
  1460     05  BATCHNOF PIC  X(0001).
  1461     05  FILLER REDEFINES BATCHNOF.
  1462         10  BATCHNOA PIC  X(0001).
  1463     05  BATCHNOI PIC  X(0006).
  1464*    -------------------------------
  1465     05  BSEQNOL PIC S9(0004) COMP.
  1466     05  BSEQNOF PIC  X(0001).
  1467     05  FILLER REDEFINES BSEQNOF.
  1468         10  BSEQNOA PIC  X(0001).
  1469     05  BSEQNOI PIC  X(0008).
  1470*    -------------------------------
  1471     05  ARCHNOL PIC S9(0004) COMP.
  1472     05  ARCHNOF PIC  X(0001).
  1473     05  FILLER REDEFINES ARCHNOF.
  1474         10  ARCHNOA PIC  X(0001).
  1475     05  ARCHNOI PIC  X(0008).
  1476*    -------------------------------
  1477     05  PRTSWL PIC S9(0004) COMP.
  1478     05  PRTSWF PIC  X(0001).
  1479     05  FILLER REDEFINES PRTSWF.
  1480         10  PRTSWA PIC  X(0001).
  1481     05  PRTSWI PIC  X(0001).
  1482*    -------------------------------
  1483     05  CARRL PIC S9(0004) COMP.
  1484     05  CARRF PIC  X(0001).
  1485     05  FILLER REDEFINES CARRF.
  1486         10  CARRA PIC  X(0001).
  1487     05  CARRI PIC  X(0001).
  1488*    -------------------------------
  1489     05  GROUPL PIC S9(0004) COMP.
  1490     05  GROUPF PIC  X(0001).
  1491     05  FILLER REDEFINES GROUPF.
  1492         10  GROUPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  28
* EL6318.cbl
  1493     05  GROUPI PIC  X(0006).
  1494*    -------------------------------
  1495     05  STATEL PIC S9(0004) COMP.
  1496     05  STATEF PIC  X(0001).
  1497     05  FILLER REDEFINES STATEF.
  1498         10  STATEA PIC  X(0001).
  1499     05  STATEI PIC  X(0002).
  1500*    -------------------------------
  1501     05  ACCTL PIC S9(0004) COMP.
  1502     05  ACCTF PIC  X(0001).
  1503     05  FILLER REDEFINES ACCTF.
  1504         10  ACCTA PIC  X(0001).
  1505     05  ACCTI PIC  X(0010).
  1506*    -------------------------------
  1507     05  EFFDTL PIC S9(0004) COMP.
  1508     05  EFFDTF PIC  X(0001).
  1509     05  FILLER REDEFINES EFFDTF.
  1510         10  EFFDTA PIC  X(0001).
  1511     05  EFFDTI PIC  X(0008).
  1512*    -------------------------------
  1513     05  CERTNOL PIC S9(0004) COMP.
  1514     05  CERTNOF PIC  X(0001).
  1515     05  FILLER REDEFINES CERTNOF.
  1516         10  CERTNOA PIC  X(0001).
  1517     05  CERTNOI PIC  X(0010).
  1518*    -------------------------------
  1519     05  CRTSFXL PIC S9(0004) COMP.
  1520     05  CRTSFXF PIC  X(0001).
  1521     05  FILLER REDEFINES CRTSFXF.
  1522         10  CRTSFXA PIC  X(0001).
  1523     05  CRTSFXI PIC  X(0001).
  1524*    -------------------------------
  1525     05  SEQNOL PIC S9(0004) COMP.
  1526     05  SEQNOF PIC  X(0001).
  1527     05  FILLER REDEFINES SEQNOF.
  1528         10  SEQNOA PIC  X(0001).
  1529     05  SEQNOI PIC  X(0006).
  1530*    -------------------------------
  1531     05  SIGREQL PIC S9(0004) COMP.
  1532     05  SIGREQF PIC  X(0001).
  1533     05  FILLER REDEFINES SIGREQF.
  1534         10  SIGREQA PIC  X(0001).
  1535     05  SIGREQI PIC  X(0001).
  1536*    -------------------------------
  1537     05  LTRIDL PIC S9(0004) COMP.
  1538     05  LTRIDF PIC  X(0001).
  1539     05  FILLER REDEFINES LTRIDF.
  1540         10  LTRIDA PIC  X(0001).
  1541     05  LTRIDI PIC  X(0004).
  1542*    -------------------------------
  1543     05  HLTHAPPL PIC S9(0004) COMP.
  1544     05  HLTHAPPF PIC  X(0001).
  1545     05  FILLER REDEFINES HLTHAPPF.
  1546         10  HLTHAPPA PIC  X(0001).
  1547     05  HLTHAPPI PIC  X(0001).
  1548*    -------------------------------
  1549     05  VOUCHL PIC S9(0004) COMP.
  1550     05  VOUCHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  29
* EL6318.cbl
  1551     05  FILLER REDEFINES VOUCHF.
  1552         10  VOUCHA PIC  X(0001).
  1553     05  VOUCHI PIC  X(0001).
  1554*    -------------------------------
  1555     05  PAYEEL PIC S9(0004) COMP.
  1556     05  PAYEEF PIC  X(0001).
  1557     05  FILLER REDEFINES PAYEEF.
  1558         10  PAYEEA PIC  X(0001).
  1559     05  PAYEEI PIC  X(0010).
  1560*    -------------------------------
  1561     05  CERTIDL PIC S9(0004) COMP.
  1562     05  CERTIDF PIC  X(0001).
  1563     05  FILLER REDEFINES CERTIDF.
  1564         10  CERTIDA PIC  X(0001).
  1565     05  CERTIDI PIC  X(0005).
  1566*    -------------------------------
  1567     05  RCD01L PIC S9(0004) COMP.
  1568     05  RCD01F PIC  X(0001).
  1569     05  FILLER REDEFINES RCD01F.
  1570         10  RCD01A PIC  X(0001).
  1571     05  RCD01I PIC  X(0004).
  1572*    -------------------------------
  1573     05  RCD02L PIC S9(0004) COMP.
  1574     05  RCD02F PIC  X(0001).
  1575     05  FILLER REDEFINES RCD02F.
  1576         10  RCD02A PIC  X(0001).
  1577     05  RCD02I PIC  X(0004).
  1578*    -------------------------------
  1579     05  RCD03L PIC S9(0004) COMP.
  1580     05  RCD03F PIC  X(0001).
  1581     05  FILLER REDEFINES RCD03F.
  1582         10  RCD03A PIC  X(0001).
  1583     05  RCD03I PIC  X(0004).
  1584*    -------------------------------
  1585     05  RCD04L PIC S9(0004) COMP.
  1586     05  RCD04F PIC  X(0001).
  1587     05  FILLER REDEFINES RCD04F.
  1588         10  RCD04A PIC  X(0001).
  1589     05  RCD04I PIC  X(0004).
  1590*    -------------------------------
  1591     05  RCD05L PIC S9(0004) COMP.
  1592     05  RCD05F PIC  X(0001).
  1593     05  FILLER REDEFINES RCD05F.
  1594         10  RCD05A PIC  X(0001).
  1595     05  RCD05I PIC  X(0004).
  1596*    -------------------------------
  1597     05  RCD06L PIC S9(0004) COMP.
  1598     05  RCD06F PIC  X(0001).
  1599     05  FILLER REDEFINES RCD06F.
  1600         10  RCD06A PIC  X(0001).
  1601     05  RCD06I PIC  X(0004).
  1602*    -------------------------------
  1603     05  RCD07L PIC S9(0004) COMP.
  1604     05  RCD07F PIC  X(0001).
  1605     05  FILLER REDEFINES RCD07F.
  1606         10  RCD07A PIC  X(0001).
  1607     05  RCD07I PIC  X(0004).
  1608*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  30
* EL6318.cbl
  1609     05  RCD08L PIC S9(0004) COMP.
  1610     05  RCD08F PIC  X(0001).
  1611     05  FILLER REDEFINES RCD08F.
  1612         10  RCD08A PIC  X(0001).
  1613     05  RCD08I PIC  X(0004).
  1614*    -------------------------------
  1615     05  RCD09L PIC S9(0004) COMP.
  1616     05  RCD09F PIC  X(0001).
  1617     05  FILLER REDEFINES RCD09F.
  1618         10  RCD09A PIC  X(0001).
  1619     05  RCD09I PIC  X(0004).
  1620*    -------------------------------
  1621     05  RCD10L PIC S9(0004) COMP.
  1622     05  RCD10F PIC  X(0001).
  1623     05  FILLER REDEFINES RCD10F.
  1624         10  RCD10A PIC  X(0001).
  1625     05  RCD10I PIC  X(0004).
  1626*    -------------------------------
  1627     05  RCD11L PIC S9(0004) COMP.
  1628     05  RCD11F PIC  X(0001).
  1629     05  FILLER REDEFINES RCD11F.
  1630         10  RCD11A PIC  X(0001).
  1631     05  RCD11I PIC  X(0004).
  1632*    -------------------------------
  1633     05  RCD12L PIC S9(0004) COMP.
  1634     05  RCD12F PIC  X(0001).
  1635     05  FILLER REDEFINES RCD12F.
  1636         10  RCD12A PIC  X(0001).
  1637     05  RCD12I PIC  X(0004).
  1638*    -------------------------------
  1639     05  CRTNT1L PIC S9(0004) COMP.
  1640     05  CRTNT1F PIC  X(0001).
  1641     05  FILLER REDEFINES CRTNT1F.
  1642         10  CRTNT1A PIC  X(0001).
  1643     05  CRTNT1I PIC  X(0063).
  1644*    -------------------------------
  1645     05  CRTNT2L PIC S9(0004) COMP.
  1646     05  CRTNT2F PIC  X(0001).
  1647     05  FILLER REDEFINES CRTNT2F.
  1648         10  CRTNT2A PIC  X(0001).
  1649     05  CRTNT2I PIC  X(0063).
  1650*    -------------------------------
  1651     05  CRTNT3L PIC S9(0004) COMP.
  1652     05  CRTNT3F PIC  X(0001).
  1653     05  FILLER REDEFINES CRTNT3F.
  1654         10  CRTNT3A PIC  X(0001).
  1655     05  CRTNT3I PIC  X(0063).
  1656*    -------------------------------
  1657     05  CRTNT4L PIC S9(0004) COMP.
  1658     05  CRTNT4F PIC  X(0001).
  1659     05  FILLER REDEFINES CRTNT4F.
  1660         10  CRTNT4A PIC  X(0001).
  1661     05  CRTNT4I PIC  X(0063).
  1662*    -------------------------------
  1663     05  BILNT1L PIC S9(0004) COMP.
  1664     05  BILNT1F PIC  X(0001).
  1665     05  FILLER REDEFINES BILNT1F.
  1666         10  BILNT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  31
* EL6318.cbl
  1667     05  BILNT1I PIC  X(0063).
  1668*    -------------------------------
  1669     05  BILNT2L PIC S9(0004) COMP.
  1670     05  BILNT2F PIC  X(0001).
  1671     05  FILLER REDEFINES BILNT2F.
  1672         10  BILNT2A PIC  X(0001).
  1673     05  BILNT2I PIC  X(0063).
  1674*    -------------------------------
  1675     05  ERRMSG1L PIC S9(0004) COMP.
  1676     05  ERRMSG1F PIC  X(0001).
  1677     05  FILLER REDEFINES ERRMSG1F.
  1678         10  ERRMSG1A PIC  X(0001).
  1679     05  ERRMSG1I PIC  X(0075).
  1680*    -------------------------------
  1681     05  ERRMSG2L PIC S9(0004) COMP.
  1682     05  ERRMSG2F PIC  X(0001).
  1683     05  FILLER REDEFINES ERRMSG2F.
  1684         10  ERRMSG2A PIC  X(0001).
  1685     05  ERRMSG2I PIC  X(0075).
  1686*    -------------------------------
  1687     05  PFENTRL PIC S9(0004) COMP.
  1688     05  PFENTRF PIC  X(0001).
  1689     05  FILLER REDEFINES PFENTRF.
  1690         10  PFENTRA PIC  X(0001).
  1691     05  PFENTRI PIC  9(2).
  1692 01  EL631KO REDEFINES EL631KI.
  1693     05  FILLER            PIC  X(0012).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  DATEO PIC  X(0008).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  TIMEO PIC  99.99.
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  PROCIDO PIC  X(0004).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  HOSTO PIC  X(0009).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  SYSO PIC  X(0005).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  COMPANYO PIC  X(0003).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  DATASORO PIC  X(0001).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  BATCHNOO PIC  X(0006).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  BSEQNOO PIC  X(0008).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  ARCHNOO PIC  X(0008).
  1724*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  32
* EL6318.cbl
  1725     05  FILLER            PIC  X(0003).
  1726     05  PRTSWO PIC  X(0001).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  CARRO PIC  X(0001).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  GROUPO PIC  X(0006).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  STATEO PIC  X(0002).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  ACCTO PIC  X(0010).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  EFFDTO PIC  X(0008).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  CERTNOO PIC  X(0010).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  CRTSFXO PIC  X(0001).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  SEQNOO PIC  999999.
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  SIGREQO PIC  X(0001).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  LTRIDO PIC  X(0004).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  HLTHAPPO PIC  X(0001).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  VOUCHO PIC  X(0001).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  PAYEEO PIC  X(0010).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  CERTIDO PIC  X(0005).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  RCD01O PIC  X(0004).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  RCD02O PIC  X(0004).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  RCD03O PIC  X(0004).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  RCD04O PIC  X(0004).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  33
* EL6318.cbl
  1783     05  RCD05O PIC  X(0004).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  RCD06O PIC  X(0004).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  RCD07O PIC  X(0004).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  RCD08O PIC  X(0004).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  RCD09O PIC  X(0004).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  RCD10O PIC  X(0004).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  RCD11O PIC  X(0004).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  RCD12O PIC  X(0004).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  CRTNT1O PIC  X(0063).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  CRTNT2O PIC  X(0063).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  CRTNT3O PIC  X(0063).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  CRTNT4O PIC  X(0063).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  BILNT1O PIC  X(0063).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  BILNT2O PIC  X(0063).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  ERRMSG1O PIC  X(0075).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  ERRMSG2O PIC  X(0075).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  PFENTRO PIC  X(0002).
  1832*    -------------------------------
  1833 01  FILLER REDEFINES EL631KI.
  1834     12  FILLER             PIC X(211).
  1835     12  REASONCDS.
  1836         16  FILLER OCCURS 12.
  1837           20  REACDL       PIC S9(4) COMP.
  1838           20  REACDA       PIC X.
  1839           20  REACD-IN     PIC X(4).
  1840     12  FILLER             PIC X(293).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  34
* EL6318.cbl
  1841****************************************************************
  1842*
  1843* Copyright (c) 2007 by Clerity Solutions, Inc.
  1844* All rights reserved.
  1845*
  1846****************************************************************
  1847 01  DFHEIV.
  1848   02  DFHEIV0               PIC X(35).
  1849   02  DFHEIV1               PIC X(08).
  1850   02  DFHEIV2               PIC X(08).
  1851   02  DFHEIV3               PIC X(08).
  1852   02  DFHEIV4               PIC X(06).
  1853   02  DFHEIV5               PIC X(04).
  1854   02  DFHEIV6               PIC X(04).
  1855   02  DFHEIV7               PIC X(02).
  1856   02  DFHEIV8               PIC X(02).
  1857   02  DFHEIV9               PIC X(01).
  1858   02  DFHEIV10              PIC S9(7) COMP-3.
  1859   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1860   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1861   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1862   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1863   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1864   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1865   02  DFHEIV17              PIC X(04).
  1866   02  DFHEIV18              PIC X(04).
  1867   02  DFHEIV19              PIC X(04).
  1868   02  DFHEIV20              USAGE IS POINTER.
  1869   02  DFHEIV21              USAGE IS POINTER.
  1870   02  DFHEIV22              USAGE IS POINTER.
  1871   02  DFHEIV23              USAGE IS POINTER.
  1872   02  DFHEIV24              USAGE IS POINTER.
  1873   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1874   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1875   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1876   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1877   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1878   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1879   02  FILLER                PIC X(02).
  1880   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1881   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1882   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1883   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1884   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1885 LINKAGE  SECTION.
  1886*****************************************************************
  1887*                                                               *
  1888* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1889* All rights reserved.                                          *
  1890*                                                               *
  1891*****************************************************************
  1892 01  dfheiblk.
  1893     02  eibtime          pic s9(7) comp-3.
  1894     02  eibdate          pic s9(7) comp-3.
  1895     02  eibtrnid         pic x(4).
  1896     02  eibtaskn         pic s9(7) comp-3.
  1897     02  eibtrmid         pic x(4).
  1898     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  35
* EL6318.cbl
  1899     02  eibcposn         pic s9(4) comp.
  1900     02  eibcalen         pic s9(4) comp.
  1901     02  eibaid           pic x(1).
  1902     02  eibfiller1       pic x(1).
  1903     02  eibfn            pic x(2).
  1904     02  eibfiller2       pic x(2).
  1905     02  eibrcode         pic x(6).
  1906     02  eibfiller3       pic x(2).
  1907     02  eibds            pic x(8).
  1908     02  eibreqid         pic x(8).
  1909     02  eibrsrce         pic x(8).
  1910     02  eibsync          pic x(1).
  1911     02  eibfree          pic x(1).
  1912     02  eibrecv          pic x(1).
  1913     02  eibsend          pic x(1).
  1914     02  eibatt           pic x(1).
  1915     02  eibeoc           pic x(1).
  1916     02  eibfmh           pic x(1).
  1917     02  eibcompl         pic x(1).
  1918     02  eibsig           pic x(1).
  1919     02  eibconf          pic x(1).
  1920     02  eiberr           pic x(1).
  1921     02  eibrldbk         pic x(1).
  1922     02  eiberrcd         pic x(4).
  1923     02  eibsynrb         pic x(1).
  1924     02  eibnodat         pic x(1).
  1925     02  eibfiller5       pic x(2).
  1926     02  eibresp          pic 9(09) comp.
  1927     02  eibresp2         pic 9(09) comp.
  1928     02  dfheigdj         pic s9(4) comp.
  1929     02  dfheigdk         pic s9(4) comp.
  1930 01  DFHCOMMAREA                 PIC X(1300).
  1931 01  var  pic x(30).
  1932*                                COPY ERCACCT.
  1933******************************************************************
  1934*                                                                *
  1935*                                                                *
  1936*                            ERCACCT                             *
  1937*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1938*                            VMOD=2.031                          *
  1939*                                                                *
  1940*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1941*                                                                *
  1942*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1943*   VSAM ACCOUNT MASTER FILES.                                   *
  1944*                                                                *
  1945*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1946*                                                                *
  1947*   FILE TYPE = VSAM,KSDS                                        *
  1948*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1949*                                                                *
  1950*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1951*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1952*                                                                *
  1953*   LOG = NO                                                     *
  1954*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1955*                                                                *
  1956*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  36
* EL6318.cbl
  1957******************************************************************
  1958*                   C H A N G E   L O G
  1959*
  1960* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1961*-----------------------------------------------------------------
  1962*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1963* EFFECTIVE    NUMBER
  1964*-----------------------------------------------------------------
  1965* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1966* 092705    2005050300006  PEMA  ADD SPP LEASES
  1967* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1968* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1969* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1970* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1971* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1972******************************************************************
  1973
  1974 01  ACCOUNT-MASTER.
  1975     12  AM-RECORD-ID                      PIC XX.
  1976         88  VALID-AM-ID                      VALUE 'AM'.
  1977
  1978     12  AM-CONTROL-PRIMARY.
  1979         16  AM-COMPANY-CD                 PIC X.
  1980         16  AM-MSTR-CNTRL.
  1981             20  AM-CONTROL-A.
  1982                 24  AM-CARRIER            PIC X.
  1983                 24  AM-GROUPING.
  1984                     28 AM-GROUPING-PREFIX PIC XXX.
  1985                     28 AM-GROUPING-PRIME  PIC XXX.
  1986                 24  AM-STATE              PIC XX.
  1987                 24  AM-ACCOUNT.
  1988                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1989                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1990             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1991                                           PIC X(19).
  1992             20  AM-CNTRL-B.
  1993                 24  AM-EXPIRATION-DT      PIC XX.
  1994                 24  FILLER                PIC X(4).
  1995             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1996                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1997
  1998     12  AM-CONTROL-BY-VAR-GRP.
  1999         16  AM-COMPANY-CD-A1              PIC X.
  2000         16  AM-VG-CARRIER                 PIC X.
  2001         16  AM-VG-GROUPING                PIC X(6).
  2002         16  AM-VG-STATE                   PIC XX.
  2003         16  AM-VG-ACCOUNT                 PIC X(10).
  2004         16  AM-VG-DATE.
  2005             20  AM-VG-EXPIRATION-DT       PIC XX.
  2006             20  FILLER                    PIC X(4).
  2007         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2008                                           PIC 9(11)      COMP-3.
  2009     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2010         16  FILLER                        PIC X(10).
  2011         16  AM-VG-KEY3.
  2012             20  AM-VG3-ACCOUNT            PIC X(10).
  2013             20  AM-VG3-EXP-DT             PIC XX.
  2014         16  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  37
* EL6318.cbl
  2015     12  AM-MAINT-INFORMATION.
  2016         16  AM-LAST-MAINT-DT              PIC XX.
  2017         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2018         16  AM-LAST-MAINT-USER            PIC X(4).
  2019         16  FILLER                        PIC XX.
  2020
  2021     12  AM-EFFECTIVE-DT                   PIC XX.
  2022     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2023
  2024     12  AM-PREV-DATES  COMP-3.
  2025         16  AM-PREV-EXP-DT                PIC 9(11).
  2026         16  AM-PREV-EFF-DT                PIC 9(11).
  2027
  2028     12  AM-REPORT-CODE-1                  PIC X(10).
  2029     12  AM-REPORT-CODE-2                  PIC X(10).
  2030
  2031     12  AM-CITY-CODE                      PIC X(4).
  2032     12  AM-COUNTY-PARISH                  PIC X(6).
  2033
  2034     12  AM-NAME                           PIC X(30).
  2035     12  AM-PERSON                         PIC X(30).
  2036     12  AM-ADDRS                          PIC X(30).
  2037     12  AM-CITY.
  2038         16  AM-ADDR-CITY                  PIC X(28).
  2039         16  AM-ADDR-STATE                 PIC XX.
  2040     12  AM-ZIP.
  2041         16  AM-ZIP-PRIME.
  2042             20  AM-ZIP-PRI-1ST            PIC X.
  2043                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2044             20  FILLER                    PIC X(4).
  2045         16  AM-ZIP-PLUS4                  PIC X(4).
  2046     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2047         16  AM-CAN-POSTAL-1               PIC XXX.
  2048         16  AM-CAN-POSTAL-2               PIC XXX.
  2049         16  FILLER                        PIC XXX.
  2050     12  AM-TEL-NO.
  2051         16  AM-AREA-CODE                  PIC 999.
  2052         16  AM-TEL-PRE                    PIC 999.
  2053         16  AM-TEL-NBR                    PIC 9(4).
  2054     12  AM-TEL-LOC                        PIC X.
  2055         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2056         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2057
  2058     12  AM-COMM-STRUCTURE.
  2059         16  AM-DEFN-1.
  2060             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2061                 24  AM-AGT.
  2062                     28  AM-AGT-PREFIX     PIC X(4).
  2063                     28  AM-AGT-PRIME      PIC X(6).
  2064                 24  AM-COM-TYP            PIC X.
  2065                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2066                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2067                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2068                 24  AM-RECALC-LV-INDIC    PIC X.
  2069                 24  AM-RETRO-LV-INDIC     PIC X.
  2070                 24  AM-GL-CODES           PIC X.
  2071                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2072                 24  FILLER                PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  38
* EL6318.cbl
  2073         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2074             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2075                 24  FILLER                PIC X(11).
  2076                 24  AM-L-COMA             PIC XXX.
  2077                 24  AM-J-COMA             PIC XXX.
  2078                 24  AM-A-COMA             PIC XXX.
  2079                 24  FILLER                PIC X(6).
  2080
  2081     12  AM-COMM-CHANGE-STATUS             PIC X.
  2082         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2083
  2084     12  AM-CSR-CODE                       PIC X(4).
  2085
  2086     12  AM-BILLING-STATUS                 PIC X.
  2087         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2088         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2089     12  AM-AUTO-REFUND-SW                 PIC X.
  2090         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2091         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2092     12  AM-GPCD                           PIC 99.
  2093     12  AM-IG                             PIC X.
  2094         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2095         88  AM-HAS-GROUP                     VALUE '2'.
  2096     12  AM-STATUS                         PIC X.
  2097         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2098         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2099         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2100         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2101         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2102         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2103     12  AM-REMIT-TO                       PIC 99.
  2104     12  AM-ID-NO                          PIC X(11).
  2105
  2106     12  AM-CAL-TABLE                      PIC XX.
  2107     12  AM-LF-DEVIATION                   PIC XXX.
  2108     12  AM-AH-DEVIATION                   PIC XXX.
  2109     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2110     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2111     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2112     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2113     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2114     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2115
  2116     12  AM-USER-FIELDS.
  2117         16  AM-FLD-1                      PIC XX.
  2118         16  AM-FLD-2                      PIC XX.
  2119         16  AM-FLD-3                      PIC XX.
  2120         16  AM-FLD-4                      PIC XX.
  2121         16  AM-FLD-5                      PIC XX.
  2122
  2123     12  AM-1ST-PROD-DATE.
  2124         16  AM-1ST-PROD-YR                PIC XX.
  2125         16  AM-1ST-PROD-MO                PIC XX.
  2126         16  AM-1ST-PROD-DA                PIC XX.
  2127     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2128     12  AM-CERTS-PURGED-DATE.
  2129         16  AM-PUR-YR                     PIC XX.
  2130         16  AM-PUR-MO                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  39
* EL6318.cbl
  2131         16  AM-PUR-DA                     PIC XX.
  2132     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2133     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2134     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2135     12  AM-INACTIVE-DATE.
  2136         16  AM-INA-MO                     PIC 99.
  2137         16  AM-INA-DA                     PIC 99.
  2138         16  AM-INA-YR                     PIC 99.
  2139     12  AM-AR-HI-CERT-DATE                PIC XX.
  2140
  2141     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2142     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2143
  2144     12  AM-OB-PAYMENT-MODE                PIC X.
  2145         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2146         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2147         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2148         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2149
  2150     12  AM-AH-ONLY-INDICATOR              PIC X.
  2151         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2152         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2153
  2154     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2155
  2156     12  AM-OVER-SHORT.
  2157         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2158         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2159
  2160     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2161     12  AM-DCC-CLP-STATE                  PIC XX.
  2162
  2163     12  AM-RECALC-COMM                    PIC X.
  2164     12  AM-RECALC-REIN                    PIC X.
  2165
  2166     12  AM-REI-TABLE                      PIC XXX.
  2167     12  AM-REI-ET-LF                      PIC X.
  2168     12  AM-REI-ET-AH                      PIC X.
  2169     12  AM-REI-PE-LF                      PIC X.
  2170     12  AM-REI-PE-AH                      PIC X.
  2171     12  AM-REI-PRT-ST                     PIC X.
  2172     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2173     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2174     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2175     12  AM-REI-GROUP-A                    PIC X(6).
  2176     12  AM-REI-MORT                       PIC X(4).
  2177     12  AM-REI-PRT-OW                     PIC X.
  2178     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2179     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2180     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2181     12  AM-REI-GROUP-B                    PIC X(6).
  2182
  2183     12  AM-TRUST-TYPE                     PIC X(2).
  2184
  2185     12  AM-EMPLOYER-STMT-USED             PIC X.
  2186     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2187
  2188     12  AM-STD-AH-TYPE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  40
* EL6318.cbl
  2189     12  AM-EARN-METHODS.
  2190         16  AM-EARN-METHOD-R              PIC X.
  2191             88 AM-REF-RL-R78                 VALUE 'R'.
  2192             88 AM-REF-RL-PR                  VALUE 'P'.
  2193             88 AM-REF-RL-MEAN                VALUE 'M'.
  2194             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2195         16  AM-EARN-METHOD-L              PIC X.
  2196             88 AM-REF-LL-R78                 VALUE 'R'.
  2197             88 AM-REF-LL-PR                  VALUE 'P'.
  2198             88 AM-REF-LL-MEAN                VALUE 'M'.
  2199             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2200         16  AM-EARN-METHOD-A              PIC X.
  2201             88 AM-REF-AH-R78                 VALUE 'R'.
  2202             88 AM-REF-AH-PR                  VALUE 'P'.
  2203             88 AM-REF-AH-MEAN                VALUE 'M'.
  2204             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2205             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2206             88 AM-REF-AH-NET                 VALUE 'N'.
  2207
  2208     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2209     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2210     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2211
  2212     12  AM-RET-Y-N                        PIC X.
  2213     12  AM-RET-P-E                        PIC X.
  2214     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2215     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2216     12  AM-RET-GRP                        PIC X(6).
  2217     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2218         16  AM-POOL-PRIME                 PIC XXX.
  2219         16  AM-POOL-SUB                   PIC XXX.
  2220     12  AM-RETRO-EARNINGS.
  2221         16  AM-RET-EARN-R                 PIC X.
  2222         16  AM-RET-EARN-L                 PIC X.
  2223         16  AM-RET-EARN-A                 PIC X.
  2224     12  AM-RET-ST-TAX-USE                 PIC X.
  2225         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2226         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2227     12  AM-RETRO-BEG-EARNINGS.
  2228         16  AM-RET-BEG-EARN-R             PIC X.
  2229         16  AM-RET-BEG-EARN-L             PIC X.
  2230         16  AM-RET-BEG-EARN-A             PIC X.
  2231     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2232     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2233
  2234     12  AM-USER-SELECT-OPTIONS.
  2235         16  AM-USER-SELECT-1              PIC X(10).
  2236         16  AM-USER-SELECT-2              PIC X(10).
  2237         16  AM-USER-SELECT-3              PIC X(10).
  2238         16  AM-USER-SELECT-4              PIC X(10).
  2239         16  AM-USER-SELECT-5              PIC X(10).
  2240
  2241     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2242
  2243     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2244
  2245     12  AM-RPT045A-SWITCH                 PIC X.
  2246         88  RPT045A-OFF                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  41
* EL6318.cbl
  2247
  2248     12  AM-INSURANCE-LIMITS.
  2249         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2250         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2251
  2252     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2253         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2254
  2255     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2256         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2257         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2258
  2259     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2260
  2261     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2262     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2263     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2264     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2265     12  AM-DCC-UEF-STATE                  PIC XX.
  2266     12  FILLER                            PIC XXX.
  2267     12  AM-REPORT-CODE-3                  PIC X(10).
  2268*    12  FILLER                            PIC X(22).
  2269
  2270     12  AM-RESERVE-DATE.
  2271         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2272         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2273         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2274
  2275     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2276     12  AM-NOTIFICATION-TYPES.
  2277         16  AM-NOTIF-OF-LETTERS           PIC X.
  2278         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2279         16  AM-NOTIF-OF-REPORTS           PIC X.
  2280         16  AM-NOTIF-OF-STATUS            PIC X.
  2281
  2282     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2283         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2284         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2285         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2286         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2287
  2288     12  AM-BENEFIT-CONTROLS.
  2289         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2290             20  AM-BENEFIT-CODE           PIC XX.
  2291             20  AM-BENEFIT-TYPE           PIC X.
  2292             20  AM-BENEFIT-REVISION       PIC XXX.
  2293             20  AM-BENEFIT-REM-TERM       PIC X.
  2294             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2295             20  FILLER                    PIC XX.
  2296         16  FILLER                        PIC X(80).
  2297
  2298     12  AM-TRANSFER-DATA.
  2299         16  AM-TRANSFERRED-FROM.
  2300             20  AM-TRNFROM-CARRIER        PIC X.
  2301             20  AM-TRNFROM-GROUPING.
  2302                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2303                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2304             20  AM-TRNFROM-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  42
* EL6318.cbl
  2305             20  AM-TRNFROM-ACCOUNT.
  2306                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2307                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2308             20  AM-TRNFROM-DTE            PIC XX.
  2309         16  AM-TRANSFERRED-TO.
  2310             20  AM-TRNTO-CARRIER          PIC X.
  2311             20  AM-TRNTO-GROUPING.
  2312                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2313                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2314             20  AM-TRNTO-STATE            PIC XX.
  2315             20  AM-TRNTO-ACCOUNT.
  2316                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2317                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2318             20  AM-TRNTO-DTE              PIC XX.
  2319         16  FILLER                        PIC X(10).
  2320
  2321     12  AM-SAVED-REMIT-TO                 PIC 99.
  2322
  2323     12  AM-COMM-STRUCTURE-SAVED.
  2324         16  AM-DEFN-1-SAVED.
  2325             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2326                 24  AM-AGT-SV             PIC X(10).
  2327                 24  AM-COM-TYP-SV         PIC X.
  2328                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2329                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2330                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2331                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2332                 24  FILLER                PIC X.
  2333                 24  AM-GL-CODES-SV        PIC X.
  2334                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2335                 24  FILLER                PIC X.
  2336         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2337             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2338                 24  FILLER                PIC X(11).
  2339                 24  AM-L-COMA-SV          PIC XXX.
  2340                 24  AM-J-COMA-SV          PIC XXX.
  2341                 24  AM-A-COMA-SV          PIC XXX.
  2342                 24  FILLER                PIC X(6).
  2343
  2344     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2345         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2346            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2347            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2348            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2349
  2350     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2351     12  FILLER                            PIC X(120).
  2352
  2353     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2354         16  AM-CONTROL-NAME               PIC X(30).
  2355         16  AM-EXECUTIVE-ONE.
  2356             20  AM-EXEC1-NAME             PIC X(15).
  2357             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2358                                                          COMP-3.
  2359             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2360                                                          COMP-3.
  2361         16  AM-EXECUTIVE-TWO.
  2362             20  AM-EXEC2-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  43
* EL6318.cbl
  2363             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2364                                                          COMP-3.
  2365             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2366                                                          COMP-3.
  2367
  2368     12  AM-RETRO-ADDITIONAL-DATA.
  2369         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2370         16  AM-RETRO-PREM-P-E             PIC X.
  2371         16  AM-RETRO-CLMS-P-I             PIC X.
  2372         16  AM-RETRO-RET-BRACKET-LF.
  2373             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2374                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2375                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2376             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2377                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2378                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2379             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2380                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2381                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2382         16  AM-RETRO-RET-BRACKET-AH.
  2383             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2384                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2385                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2386                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2387             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2388                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2389                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2390             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2391                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2392                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2393
  2394     12  AM-COMMENTS.
  2395         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2396
  2397     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2398         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2399         16  AM-FLI-BILLING-CODE           PIC X.
  2400         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2401         16  AM-FLI-UNITED-IDENT           PIC X.
  2402         16  AM-FLI-INTEREST-LOST-DATA.
  2403             20  AM-FLI-BANK-NO            PIC X(5).
  2404             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2405             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2406             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2407         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2408             20  AM-FLI-AGT                PIC X(9).
  2409             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2410             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2411         16  FILLER                        PIC X(102).
  2412
  2413     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2414         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2415             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2416             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2417             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2418             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2419             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2420         16  FILLER                          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  44
* EL6318.cbl
  2421******************************************************************
  2422*                                COPY ELCCNTL.
  2423******************************************************************
  2424*                                                                *
  2425*                                                                *
  2426*                            ELCCNTL.                            *
  2427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2428*                            VMOD=2.059                          *
  2429*                                                                *
  2430*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2431*                                                                *
  2432*   FILE TYPE = VSAM,KSDS                                        *
  2433*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2434*                                                                *
  2435*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2436*       ALTERNATE INDEX = NONE                                   *
  2437*                                                                *
  2438*   LOG = YES                                                    *
  2439*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2440******************************************************************
  2441*                   C H A N G E   L O G
  2442*
  2443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2444*-----------------------------------------------------------------
  2445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2446* EFFECTIVE    NUMBER
  2447*-----------------------------------------------------------------
  2448* 082503                   PEMA  ADD BENEFIT GROUP
  2449* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2450* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2451* 092705    2005050300006  PEMA  ADD SPP LEASES
  2452* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2453* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2454* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2455* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2456* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2457* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2458******************************************************************
  2459*
  2460 01  CONTROL-FILE.
  2461     12  CF-RECORD-ID                       PIC XX.
  2462         88  VALID-CF-ID                        VALUE 'CF'.
  2463
  2464     12  CF-CONTROL-PRIMARY.
  2465         16  CF-COMPANY-ID                  PIC XXX.
  2466         16  CF-RECORD-TYPE                 PIC X.
  2467             88  CF-COMPANY-MASTER              VALUE '1'.
  2468             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2469             88  CF-STATE-MASTER                VALUE '3'.
  2470             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2471             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2472             88  CF-CARRIER-MASTER              VALUE '6'.
  2473             88  CF-MORTALITY-MASTER            VALUE '7'.
  2474             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2475             88  CF-TERMINAL-MASTER             VALUE '9'.
  2476             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2477             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2478             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  45
* EL6318.cbl
  2479             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2480             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2481             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2482             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2483             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2484             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2485         16  CF-ACCESS-CD-GENL              PIC X(4).
  2486         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2487             20  CF-PROCESSOR               PIC X(4).
  2488         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2489             20  CF-STATE-CODE              PIC XX.
  2490             20  FILLER                     PIC XX.
  2491         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2492             20  FILLER                     PIC XX.
  2493             20  CF-HI-BEN-IN-REC           PIC XX.
  2494         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2495             20  FILLER                     PIC XXX.
  2496             20  CF-CARRIER-CNTL            PIC X.
  2497         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2498             20  FILLER                     PIC XX.
  2499             20  CF-HI-TYPE-IN-REC          PIC 99.
  2500         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2501             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2502                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2503             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2504             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2505         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2506             20  FILLER                     PIC X.
  2507             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2508         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2509             20  FILLER                     PIC XX.
  2510             20  CF-MORTGAGE-PLAN           PIC XX.
  2511         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2512
  2513     12  CF-LAST-MAINT-DT                   PIC XX.
  2514     12  CF-LAST-MAINT-BY                   PIC X(4).
  2515     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2516
  2517     12  CF-RECORD-BODY                     PIC X(728).
  2518
  2519
  2520****************************************************************
  2521*             COMPANY MASTER RECORD                            *
  2522****************************************************************
  2523
  2524     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2525         16  CF-COMPANY-ADDRESS.
  2526             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2527             20  CF-CL-IN-CARE-OF           PIC X(30).
  2528             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2529             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2530             20  CF-CL-CITY-STATE           PIC X(30).
  2531             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2532             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2533         16  CF-COMPANY-CD                  PIC X.
  2534         16  CF-COMPANY-PASSWORD            PIC X(8).
  2535         16  CF-SECURITY-OPTION             PIC X.
  2536             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  46
* EL6318.cbl
  2537             88  COMPANY-VERIFY                 VALUE '2'.
  2538             88  PROCESSOR-VERIFY               VALUE '3'.
  2539             88  NO-SECURITY                    VALUE '4'.
  2540             88  ALL-BUT-TERM                   VALUE '5'.
  2541         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2542             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2543         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2544             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2545         16  CF-INFORCE-LOCATION            PIC X.
  2546             88  CERTS-ARE-ONLINE               VALUE '1'.
  2547             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2548             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2549         16  CF-LOWER-CASE-LETTERS          PIC X.
  2550         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2551             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2552             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2553             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2554             88  CF-ACCNT-CNTL                  VALUE '3'.
  2555             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2556
  2557         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2558         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2559
  2560         16  CF-LGX-CREDIT-USER             PIC X.
  2561             88  CO-IS-NOT-USER                 VALUE 'N'.
  2562             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2563
  2564         16 CF-CREDIT-CALC-CODES.
  2565             20  CF-CR-REM-TERM-CALC PIC X.
  2566               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2567               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2568               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2569               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2570               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2571               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2572               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2573             20  CF-CR-R78-METHOD           PIC X.
  2574               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2575               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2576
  2577         16  CF-CLAIM-CONTROL-COUNTS.
  2578             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2579                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2580
  2581             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2582                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2583
  2584             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2585                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2586
  2587             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2588                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2589
  2590         16  CF-CURRENT-MONTH-END           PIC XX.
  2591
  2592         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2593             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2594             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  47
* EL6318.cbl
  2595             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2596             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2597                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2598                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2599             20  CF-CO-PREM-REJECT-SW       PIC X.
  2600                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2601                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2602             20  CF-CO-REF-REJECT-SW        PIC X.
  2603                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2604                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2605
  2606         16  CF-CO-REPORTING-DT             PIC XX.
  2607         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2608         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2609           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2610           88  CF-CO-MONTH-END                  VALUE '1'.
  2611
  2612         16  CF-LGX-CLAIM-USER              PIC X.
  2613             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2614             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2615
  2616         16  CF-CREDIT-EDIT-CONTROLS.
  2617             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2618             20  CF-MIN-AGE                 PIC 99.
  2619             20  CF-DEFAULT-AGE             PIC 99.
  2620             20  CF-MIN-TERM                PIC S999      COMP-3.
  2621             20  CF-MAX-TERM                PIC S999      COMP-3.
  2622             20  CF-DEFAULT-SEX             PIC X.
  2623             20  CF-JOINT-AGE-INPUT         PIC X.
  2624                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2625             20  CF-BIRTH-DATE-INPUT        PIC X.
  2626                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2627             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2628                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2629                 88  CF-ZERO-CARRIER            VALUE '1'.
  2630                 88  CF-ZERO-GROUPING           VALUE '2'.
  2631                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2632             20  CF-EDIT-SW                 PIC X.
  2633                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2634             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2635             20  CF-CR-PR-METHOD            PIC X.
  2636               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2637               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2638             20  FILLER                     PIC X.
  2639
  2640         16  CF-CREDIT-MISC-CONTROLS.
  2641             20  CF-REIN-TABLE-SW           PIC X.
  2642                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2643             20  CF-COMP-TABLE-SW           PIC X.
  2644                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2645             20  CF-EXPERIENCE-RETENTION-AGE
  2646                                            PIC S9        COMP-3.
  2647             20  CF-CONVERSION-DT           PIC XX.
  2648             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2649             20  CF-RUN-FREQUENCY-SW        PIC X.
  2650                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2651                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2652
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  48
* EL6318.cbl
  2653             20  CF-CR-CHECK-NO-CONTROL.
  2654                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2655                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2656                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2657                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2658                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2659                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2660
  2661                 24  CF-CR-CHECK-COUNT       REDEFINES
  2662                     CF-CR-CHECK-COUNTER      PIC X(4).
  2663
  2664                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2665                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2666
  2667                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2668                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2669                 24  CF-MAIL-PROCESSING       PIC X.
  2670                     88  MAIL-PROCESSING          VALUE 'Y'.
  2671
  2672         16  CF-MISC-SYSTEM-CONTROL.
  2673             20  CF-SYSTEM-C                 PIC X.
  2674                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2675             20  CF-SYSTEM-D                 PIC X.
  2676                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2677             20  CF-SOC-SEC-NO-SW            PIC X.
  2678                 88  SOC-SEC-NO-USED             VALUE '1'.
  2679             20  CF-MEMBER-NO-SW             PIC X.
  2680                 88  MEMBER-NO-USED              VALUE '1'.
  2681             20  CF-TAX-ID-NUMBER            PIC X(11).
  2682             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2683             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2684                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2685                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2686                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2687                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2688             20  CF-SYSTEM-E                 PIC X.
  2689                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2690
  2691         16  CF-LGX-LIFE-USER               PIC X.
  2692             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2693             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2694
  2695         16  CF-CR-MONTH-END-DT             PIC XX.
  2696
  2697         16  CF-FILE-MAINT-DATES.
  2698             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2699                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2700             20  CF-LAST-BATCH       REDEFINES
  2701                 CF-LAST-BATCH-NO               PIC X(4).
  2702             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2703             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2704             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2705             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2706             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2707             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2708             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2709             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2710             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  49
* EL6318.cbl
  2711             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2712
  2713         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2714         16  FILLER                         PIC X.
  2715
  2716         16  CF-ALT-MORT-CODE               PIC X(4).
  2717         16  CF-MEMBER-CAPTION              PIC X(10).
  2718
  2719         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2720             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2721             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2722             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2723             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2724             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2725
  2726         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2727
  2728         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2729         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2730         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2731         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2732
  2733         16  CF-AH-OVERRIDE-L1              PIC X.
  2734         16  CF-AH-OVERRIDE-L2              PIC XX.
  2735         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2736         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2737
  2738         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2739         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2740
  2741         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2742         16  CF-AR-LAST-EL860-DT            PIC XX.
  2743         16  CF-MP-MONTH-END-DT             PIC XX.
  2744
  2745         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2746         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2747             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2748
  2749         16  CF-AR-MONTH-END-DT             PIC XX.
  2750
  2751         16  CF-CRDTCRD-USER                PIC X.
  2752             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2753             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2754
  2755         16  CF-CC-MONTH-END-DT             PIC XX.
  2756
  2757         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2758
  2759         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2760             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2761             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2762             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2763         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2764         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2765         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2766         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2767             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2768             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  50
* EL6318.cbl
  2769         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2770         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2771         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2772             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2773         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2774
  2775         16  CF-CL-ZIP-CODE.
  2776             20  CF-CL-ZIP-PRIME.
  2777                 24  CF-CL-ZIP-1ST          PIC X.
  2778                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2779                 24  FILLER                 PIC X(4).
  2780             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2781         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2782             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2783             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2784             20  FILLER                     PIC XXX.
  2785
  2786         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2787         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2788         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2789         16  CF-CO-OPTION-START-DATE        PIC XX.
  2790         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2791           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2792                                                      '3' '4'.
  2793           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2794           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2795           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2796           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2797           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2798           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2799
  2800         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2801
  2802         16  CF-PAYMENT-APPROVAL-LEVELS.
  2803             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2804             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2805             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2806             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2807             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2808             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2809
  2810         16  CF-END-USER-REPORTING-USER     PIC X.
  2811             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2812             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2813
  2814         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2815             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2816             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2817
  2818         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2819
  2820         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2821         16  FILLER                         PIC X.
  2822
  2823         16  CF-CREDIT-ARCHIVE-CNTL.
  2824             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2825             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2826             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  51
* EL6318.cbl
  2827
  2828         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2829
  2830         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2831             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2832             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2833
  2834         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2835             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2836             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2837
  2838         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2839
  2840         16  CF-CO-ACH-ID-CODE              PIC  X.
  2841             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2842             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2843             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2844         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2845         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2846         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2847         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2848         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2849         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2850         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2851         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2852         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2853                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2854         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2855                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2856
  2857         16  CF-CO-OVER-SHORT.
  2858             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2859             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2860
  2861*         16  FILLER                         PIC X(102).
  2862         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2863             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2864             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2865
  2866         16  CF-AH-APPROVAL-DAYS.
  2867             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2868             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2869             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2870             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2871
  2872         16  FILLER                         PIC X(82).
  2873****************************************************************
  2874*             PROCESSOR/USER RECORD                            *
  2875****************************************************************
  2876
  2877     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2878         16  CF-PROCESSOR-NAME              PIC X(30).
  2879         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2880         16  CF-PROCESSOR-TITLE             PIC X(26).
  2881         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2882                 88  MESSAGE-YES                VALUE 'Y'.
  2883                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2884
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  52
* EL6318.cbl
  2885*****************************************************
  2886****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2887****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2888****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2889****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2890*****************************************************
  2891
  2892         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2893             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2894             20  CF-APPLICATION-FORCE       PIC X.
  2895             20  CF-INDIVIDUAL-APP.
  2896                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2897                     28  CF-BROWSE-APP      PIC X.
  2898                     28  CF-UPDATE-APP      PIC X.
  2899
  2900         16  CF-CURRENT-TERM-ON             PIC X(4).
  2901         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2902             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2903             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2904             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2905             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2906             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2907             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2908             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2909         16  CF-PROCESSOR-CARRIER           PIC X.
  2910             88  NO-CARRIER-SECURITY            VALUE ' '.
  2911         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2912             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2913         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2914             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2915         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2916             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2917
  2918         16  CF-PROC-SYS-ACCESS-SW.
  2919             20  CF-PROC-CREDIT-CLAIMS-SW.
  2920                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2921                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2922                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2923                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2924             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2925                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2926                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2927             20  CF-PROC-LIFE-GNRLDGR-SW.
  2928                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2929                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2930                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2931                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2932             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2933                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2934                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2935         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2936             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2937             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2938         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2939
  2940         16  CF-APPROVAL-LEVEL                  PIC X.
  2941             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2942             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  53
* EL6318.cbl
  2943             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2944             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2945
  2946         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2947
  2948         16  CF-LANGUAGE-TYPE                   PIC X.
  2949             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2950             88  CF-LANG-IS-FR                      VALUE 'F'.
  2951
  2952         16  CF-CSR-IND                         PIC X.
  2953         16  FILLER                             PIC X(239).
  2954
  2955****************************************************************
  2956*             PROCESSOR/REMINDERS RECORD                       *
  2957****************************************************************
  2958
  2959     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2960         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2961             20  CF-START-REMIND-DT         PIC XX.
  2962             20  CF-END-REMIND-DT           PIC XX.
  2963             20  CF-REMINDER-TEXT           PIC X(50).
  2964         16  FILLER                         PIC X(296).
  2965
  2966
  2967****************************************************************
  2968*             STATE MASTER RECORD                              *
  2969****************************************************************
  2970
  2971     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2972         16  CF-STATE-ABBREVIATION          PIC XX.
  2973         16  CF-STATE-NAME                  PIC X(25).
  2974         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2975         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2976             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2977             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2978             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2979             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2980                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2981                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2982             20  CF-ST-PREM-REJECT-SW       PIC X.
  2983                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2984                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2985             20  CF-ST-REF-REJECT-SW        PIC X.
  2986                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2987                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2988         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2989         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2990         16  CF-ST-REFUND-RULES.
  2991             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2992             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2993             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2994         16  CF-ST-FST-PMT-EXTENSION.
  2995             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2996             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2997                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2998                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2999                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3000                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  54
* EL6318.cbl
  3001         16  CF-ST-STATE-CALL.
  3002             20  CF-ST-CALL-UNEARNED        PIC X.
  3003             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3004             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3005         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3006             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3007             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3008         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3009         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3010         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3011         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3012         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3013         16  FILLER                         PIC X.
  3014         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3015             20  CF-ST-BENEFIT-CD           PIC XX.
  3016             20  CF-ST-BENEFIT-KIND         PIC X.
  3017                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3018                 88  CF-ST-AH-KIND              VALUE 'A'.
  3019             20  CF-ST-REM-TERM-CALC        PIC X.
  3020                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3021                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3022                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3023                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3024                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3025                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3026                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3027                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3028
  3029             20  CF-ST-REFUND-CALC          PIC X.
  3030                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3031                 88  ST-REFD-BY-R78             VALUE '1'.
  3032                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3033                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3034                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3035                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3036                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3037                 88  ST-REFD-UTAH               VALUE '7'.
  3038                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3039                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3040                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3041
  3042             20  CF-ST-EARNING-CALC         PIC X.
  3043                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3044                 88  ST-EARN-BY-R78             VALUE '1'.
  3045                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3046                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3047                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3048                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3049                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3050                 88  ST-EARN-MEAN               VALUE '8'.
  3051                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3052
  3053             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3054                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3055                 88  ST-OVRD-BY-R78             VALUE '1'.
  3056                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3057                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3058                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  55
* EL6318.cbl
  3059                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3060                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3061                 88  ST-OVRD-MEAN               VALUE '8'.
  3062                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3063             20  FILLER                     PIC X.
  3064
  3065         16  CF-ST-COMMISSION-CAPS.
  3066             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3067             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3068             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3069             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3070         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3071                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3072
  3073         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3074
  3075         16  CF-ST-STATUTORY-INTEREST.
  3076             20  CF-ST-STAT-DATE-FROM       PIC X.
  3077                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3078                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3079             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3080             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3081             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3082             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3083             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3084
  3085         16  CF-ST-OVER-SHORT.
  3086             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3087             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3088
  3089         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3090
  3091         16  CF-ST-RT-CALC                  PIC X.
  3092
  3093         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3094         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3095         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3096         16  CF-ST-RF-LR-CALC               PIC X.
  3097         16  CF-ST-RF-LL-CALC               PIC X.
  3098         16  CF-ST-RF-LN-CALC               PIC X.
  3099         16  CF-ST-RF-AH-CALC               PIC X.
  3100         16  CF-ST-RF-CP-CALC               PIC X.
  3101*        16  FILLER                         PIC X(206).
  3102*CIDMOD         16  FILLER                         PIC X(192).
  3103         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3104             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3105         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3106         16  CF-ST-VFY-2ND-BENE             PIC X.
  3107         16  FILLER                         PIC X(186).
  3108
  3109****************************************************************
  3110*             BENEFIT MASTER RECORD                            *
  3111****************************************************************
  3112
  3113     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3114         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3115             20  CF-BENEFIT-CODE            PIC XX.
  3116             20  CF-BENEFIT-NUMERIC  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  56
* EL6318.cbl
  3117                 CF-BENEFIT-CODE            PIC XX.
  3118             20  CF-BENEFIT-ALPHA           PIC XXX.
  3119             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3120             20  CF-BENEFIT-COMMENT         PIC X(10).
  3121
  3122             20  CF-LF-COVERAGE-TYPE        PIC X.
  3123                 88  CF-REDUCING                VALUE 'R'.
  3124                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3125
  3126             20  CF-SPECIAL-CALC-CD         PIC X.
  3127                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3128                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3129                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3130                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3131                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3132                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3133                 88  CF-FARM-PLAN               VALUE 'F'.
  3134                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3135                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3136                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3137                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3138                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3139                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3140                 88  CF-PRUDENTIAL              VALUE 'P'.
  3141                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3142                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3143                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3144                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3145                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3146                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3147
  3148             20  CF-JOINT-INDICATOR         PIC X.
  3149                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3150
  3151*            20  FILLER                     PIC X(12).
  3152             20  FILLER                     PIC X(11).
  3153             20  CF-BENEFIT-CATEGORY        PIC X.
  3154             20  CF-LOAN-TYPE               PIC X(8).
  3155
  3156             20  CF-CO-REM-TERM-CALC        PIC X.
  3157                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3158                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3159                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3160                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3161                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3162
  3163             20  CF-CO-EARNINGS-CALC        PIC X.
  3164                 88  CO-EARN-BY-R78             VALUE '1'.
  3165                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3166                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3167                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3168                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3169                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3170                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3171                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3172
  3173             20  CF-CO-REFUND-CALC          PIC X.
  3174                 88  CO-REFUND-NOT-USED         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  57
* EL6318.cbl
  3175                 88  CO-REFD-BY-R78             VALUE '1'.
  3176                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3177                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3178                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3179                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3180                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3181                 88  CO-REFD-MEAN               VALUE '8'.
  3182                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3183                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3184                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3185
  3186             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3187                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3188                 88  CO-OVRD-BY-R78             VALUE '1'.
  3189                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3190                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3191                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3192                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3193                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3194                 88  CO-OVRD-MEAN               VALUE '8'.
  3195                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3196
  3197             20  CF-CO-BEN-I-G-CD           PIC X.
  3198                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3199                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3200                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3201
  3202         16  FILLER                         PIC X(304).
  3203
  3204
  3205****************************************************************
  3206*             CARRIER MASTER RECORD                            *
  3207****************************************************************
  3208
  3209     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3210         16  CF-ADDRESS-DATA.
  3211             20  CF-MAIL-TO-NAME            PIC X(30).
  3212             20  CF-IN-CARE-OF              PIC X(30).
  3213             20  CF-ADDRESS-LINE-1          PIC X(30).
  3214             20  CF-ADDRESS-LINE-2          PIC X(30).
  3215             20  CF-CITY-STATE              PIC X(30).
  3216             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3217             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3218
  3219         16  CF-CLAIM-NO-CONTROL.
  3220             20  CF-CLAIM-NO-METHOD         PIC X.
  3221                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3222                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3223                 88  CLAIM-NO-SEQ               VALUE '3'.
  3224                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3225             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3226                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3227                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3228                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3229
  3230         16  CF-CHECK-NO-CONTROL.
  3231             20  CF-CHECK-NO-METHOD         PIC X.
  3232                 88  CHECK-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  58
* EL6318.cbl
  3233                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3234                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3235                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3236             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3237                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3238
  3239         16  CF-DOMICILE-STATE              PIC XX.
  3240
  3241         16  CF-EXPENSE-CONTROLS.
  3242             20  CF-EXPENSE-METHOD          PIC X.
  3243                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3244                 88  DOLLARS-PER-PMT            VALUE '2'.
  3245                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3246                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3247             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3248             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3249
  3250         16  CF-CORRESPONDENCE-CONTROL.
  3251             20  CF-LETTER-RESEND-OPT       PIC X.
  3252                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3253                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3254             20  FILLER                     PIC X(4).
  3255
  3256         16  CF-RESERVE-CONTROLS.
  3257             20  CF-MANUAL-SW               PIC X.
  3258                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3259             20  CF-FUTURE-SW               PIC X.
  3260                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3261             20  CF-PTC-SW                  PIC X.
  3262                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3263             20  CF-IBNR-SW                 PIC X.
  3264                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3265             20  CF-PTC-LF-SW               PIC X.
  3266                 88  CF-LF-PTC-USED             VALUE '1'.
  3267             20  CF-CDT-ACCESS-METHOD       PIC X.
  3268                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3269                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3270                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3271             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3272
  3273         16  CF-CLAIM-CALC-METHOD           PIC X.
  3274             88  360-PLUS-MONTHS                VALUE '1'.
  3275             88  365-PLUS-MONTHS                VALUE '2'.
  3276             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3277             88  360-DAILY                      VALUE '4'.
  3278             88  365-DAILY                      VALUE '5'.
  3279
  3280         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3281         16  FILLER                         PIC X(11).
  3282
  3283         16  CF-LIMIT-AMOUNTS.
  3284             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3285             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3286             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3287             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3288             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3289             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3290             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  59
* EL6318.cbl
  3291             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3292             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3293             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3294
  3295         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3296         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3297         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3298
  3299         16  CF-ZIP-CODE.
  3300             20  CF-ZIP-PRIME.
  3301                 24  CF-ZIP-1ST             PIC X.
  3302                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3303                 24  FILLER                 PIC X(4).
  3304             20  CF-ZIP-PLUS4               PIC X(4).
  3305         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3306             20  CF-CAN-POSTAL-1            PIC XXX.
  3307             20  CF-CAN-POSTAL-2            PIC XXX.
  3308             20  FILLER                     PIC XXX.
  3309
  3310         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3311         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3312         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3313
  3314         16  CF-RATING-SWITCH               PIC X.
  3315             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3316             88  CF-NO-RATING                   VALUE 'N'.
  3317
  3318         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3319
  3320         16  CF-CARRIER-OVER-SHORT.
  3321             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3322             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3323
  3324         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3325         16  CF-SECPAY-SWITCH               PIC X.
  3326             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3327             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3328         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3329         16  FILLER                         PIC X(448).
  3330*        16  FILLER                         PIC X(452).
  3331
  3332
  3333****************************************************************
  3334*             MORTALITY MASTER RECORD                          *
  3335****************************************************************
  3336
  3337     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3338         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3339                                INDEXED BY CF-MORT-NDX.
  3340             20  CF-MORT-TABLE              PIC X(5).
  3341             20  CF-MORT-TABLE-TYPE         PIC X.
  3342                 88  CF-MORT-JOINT              VALUE 'J'.
  3343                 88  CF-MORT-SINGLE             VALUE 'S'.
  3344                 88  CF-MORT-COMBINED           VALUE 'C'.
  3345                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3346                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3347             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3348             20  CF-MORT-AGE-METHOD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  60
* EL6318.cbl
  3349                 88  CF-AGE-LAST                VALUE 'AL'.
  3350                 88  CF-AGE-NEAR                VALUE 'AN'.
  3351             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3352             20  CF-MORT-ADJUSTMENT-DIRECTION
  3353                                            PIC X.
  3354                 88  CF-MINUS                   VALUE '-'.
  3355                 88  CF-PLUS                    VALUE '+'.
  3356             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3357             20  CF-MORT-JOINT-CODE         PIC X.
  3358                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3359             20  CF-MORT-PC-Q               PIC X.
  3360                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3361             20  CF-MORT-TABLE-CODE         PIC X(4).
  3362             20  CF-MORT-COMMENTS           PIC X(15).
  3363             20  FILLER                     PIC X(14).
  3364
  3365         16  FILLER                         PIC X(251).
  3366
  3367
  3368****************************************************************
  3369*             BUSSINESS TYPE MASTER RECORD                     *
  3370****************************************************************
  3371
  3372     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3373* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3374* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3375* AND RECORD 05 IS TYPES 81-99
  3376         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3377             20  CF-BUSINESS-TITLE          PIC  X(19).
  3378             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3379                                            PIC S9V9(4) COMP-3.
  3380             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3381             20  FILLER                     PIC  X.
  3382         16  FILLER                         PIC  X(248).
  3383
  3384
  3385****************************************************************
  3386*             TERMINAL MASTER RECORD                           *
  3387****************************************************************
  3388
  3389     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3390
  3391         16  CF-COMPANY-TERMINALS.
  3392             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3393                                  PIC X(4).
  3394         16  FILLER               PIC X(248).
  3395
  3396
  3397****************************************************************
  3398*             LIFE EDIT MASTER RECORD                          *
  3399****************************************************************
  3400
  3401     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3402         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3403             20  CF-LIFE-CODE-IN            PIC XX.
  3404             20  CF-LIFE-CODE-OUT           PIC XX.
  3405         16  FILLER                         PIC X(248).
  3406
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  61
* EL6318.cbl
  3407
  3408****************************************************************
  3409*             AH EDIT MASTER RECORD                            *
  3410****************************************************************
  3411
  3412     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3413         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3414             20  CF-AH-CODE-IN              PIC XXX.
  3415             20  CF-AH-CODE-OUT             PIC XX.
  3416         16  FILLER                         PIC X(248).
  3417
  3418
  3419****************************************************************
  3420*             CREDIBILITY TABLES                               *
  3421****************************************************************
  3422
  3423     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3424         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3425                             INDEXED BY CF-CRDB-NDX.
  3426             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3427             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3428             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3429         16  FILLER                         PIC  X(332).
  3430
  3431
  3432****************************************************************
  3433*             REPORT CUSTOMIZATION RECORD                      *
  3434****************************************************************
  3435
  3436     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3437         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3438             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3439             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3440             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3441**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3442****       A T-TRANSFER.                                   ****
  3443             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3444
  3445         16  FILLER                         PIC XX.
  3446
  3447         16  CF-CARRIER-CNTL-OPT.
  3448             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3449                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3450                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3451             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3452                                            PIC X.
  3453         16  CF-GROUP-CNTL-OPT.
  3454             20  CF-GROUP-OPT-SEQ           PIC 9.
  3455                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3456                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3457             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3458                                            PIC X(6).
  3459         16  CF-STATE-CNTL-OPT.
  3460             20  CF-STATE-OPT-SEQ           PIC 9.
  3461                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3462                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3463             20  CF-STATE-SELECT OCCURS 3 TIMES
  3464                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  62
* EL6318.cbl
  3465         16  CF-ACCOUNT-CNTL-OPT.
  3466             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3467                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3468                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3469             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3470                                            PIC X(10).
  3471         16  CF-BUS-TYP-CNTL-OPT.
  3472             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3473                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3474                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3475             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3476                                            PIC XX.
  3477         16  CF-LF-TYP-CNTL-OPT.
  3478             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3479                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3480                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3481             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3482                                            PIC XX.
  3483         16  CF-AH-TYP-CNTL-OPT.
  3484             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3485                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3486                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3487             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3488                                            PIC XX.
  3489         16  CF-REPTCD1-CNTL-OPT.
  3490             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3491                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3492                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3493             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3494                                            PIC X(10).
  3495         16  CF-REPTCD2-CNTL-OPT.
  3496             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3497                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3498                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3499             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3500                                            PIC X(10).
  3501         16  CF-USER1-CNTL-OPT.
  3502             20  CF-USER1-OPT-SEQ           PIC 9.
  3503                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3504                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3505             20  CF-USER1-SELECT OCCURS 3 TIMES
  3506                                            PIC X(10).
  3507         16  CF-USER2-CNTL-OPT.
  3508             20  CF-USER2-OPT-SEQ           PIC 9.
  3509                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3510                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3511             20  CF-USER2-SELECT OCCURS 3 TIMES
  3512                                            PIC X(10).
  3513         16  CF-USER3-CNTL-OPT.
  3514             20  CF-USER3-OPT-SEQ           PIC 9.
  3515                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3516                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3517             20  CF-USER3-SELECT OCCURS 3 TIMES
  3518                                            PIC X(10).
  3519         16  CF-USER4-CNTL-OPT.
  3520             20  CF-USER4-OPT-SEQ           PIC 9.
  3521                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3522                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  63
* EL6318.cbl
  3523             20  CF-USER4-SELECT OCCURS 3 TIMES
  3524                                            PIC X(10).
  3525         16  CF-USER5-CNTL-OPT.
  3526             20  CF-USER5-OPT-SEQ           PIC 9.
  3527                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3528                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3529             20  CF-USER5-SELECT OCCURS 3 TIMES
  3530                                            PIC X(10).
  3531         16  CF-REINS-CNTL-OPT.
  3532             20  CF-REINS-OPT-SEQ           PIC 9.
  3533                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3534                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3535             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3536                 24  CF-REINS-PRIME         PIC XXX.
  3537                 24  CF-REINS-SUB           PIC XXX.
  3538
  3539         16  CF-AGENT-CNTL-OPT.
  3540             20  CF-AGENT-OPT-SEQ           PIC 9.
  3541                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3542                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3543             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3544                                            PIC X(10).
  3545
  3546         16  FILLER                         PIC X(43).
  3547
  3548         16  CF-LOSS-RATIO-SELECT.
  3549             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3550             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3551         16  CF-ENTRY-DATE-SELECT.
  3552             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3553             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3554         16  CF-EFFECTIVE-DATE-SELECT.
  3555             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3556             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3557
  3558         16  CF-EXCEPTION-LIST-IND          PIC X.
  3559             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3560
  3561         16  FILLER                         PIC X(318).
  3562
  3563****************************************************************
  3564*                  EXCEPTION REPORTING RECORD                  *
  3565****************************************************************
  3566
  3567     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3568         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3569             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3570
  3571         16  CF-COMBINED-LIFE-AH-OPT.
  3572             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3573             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3574             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3575             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3576
  3577         16  CF-LIFE-OPT.
  3578             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3579             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3580             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  64
* EL6318.cbl
  3581             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3582             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3583             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3584             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3585             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3586             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3587             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3588
  3589         16  CF-AH-OPT.
  3590             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3591             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3592             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3593             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3594             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3595             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3596             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3597             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3598             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3599             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3600
  3601         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3602             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3603             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3604             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3605
  3606         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3607
  3608         16  FILLER                         PIC X(673).
  3609
  3610
  3611****************************************************************
  3612*             MORTGAGE SYSTEM PLAN RECORD                      *
  3613****************************************************************
  3614
  3615     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3616         16  CF-PLAN-TYPE                   PIC X.
  3617             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3618             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3619             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3620         16  CF-PLAN-ABBREV                 PIC XXX.
  3621         16  CF-PLAN-DESCRIPT               PIC X(10).
  3622         16  CF-PLAN-NOTES                  PIC X(20).
  3623         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3624         16  CF-PLAN-UNDERWRITING.
  3625             20  CF-PLAN-TERM-DATA.
  3626                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3627                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3628             20  CF-PLAN-AGE-DATA.
  3629                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3630                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3631                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3632             20  CF-PLAN-BENEFIT-DATA.
  3633                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3634                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3635                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3636                                            PIC S9(7)V99  COMP-3.
  3637         16  CF-PLAN-POLICY-FORMS.
  3638             20  CF-POLICY-FORM             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  65
* EL6318.cbl
  3639             20  CF-MASTER-APPLICATION      PIC X(12).
  3640             20  CF-MASTER-POLICY           PIC X(12).
  3641         16  CF-PLAN-RATING.
  3642             20  CF-RATE-CODE               PIC X(5).
  3643             20  CF-SEX-RATING              PIC X.
  3644                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3645                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3646             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3647             20  CF-SUB-STD-TYPE            PIC X.
  3648                 88  CF-PCT-OF-PREM            VALUE '1'.
  3649                 88  CF-PCT-OF-BENE            VALUE '2'.
  3650         16  CF-PLAN-PREM-TOLERANCES.
  3651             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3652             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3653         16  CF-PLAN-PYMT-TOLERANCES.
  3654             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3655             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3656         16  CF-PLAN-MISC-DATA.
  3657             20  FILLER                     PIC X.
  3658             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3659             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3660         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3661         16  CF-PLAN-IND-GRP                PIC X.
  3662             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3663                                                     '1'.
  3664             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3665                                                     '2'.
  3666         16  CF-MIB-SEARCH-SW               PIC X.
  3667             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3668             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3669             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3670             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3671         16  CF-ALPHA-SEARCH-SW             PIC X.
  3672             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3673             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3674             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3675             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3676             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3677             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3678             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3679             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3680             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3681             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3682                                                     'A' 'B' 'C'
  3683                                                     'X' 'Y' 'Z'.
  3684         16  CF-EFF-DT-RULE-SW              PIC X.
  3685             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3686             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3687             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3688             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3689             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3690         16  FILLER                         PIC X(4).
  3691         16  CF-HEALTH-QUESTIONS            PIC X.
  3692             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3693         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3694         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3695         16  CF-PLAN-SNGL-JNT               PIC X.
  3696             88  CF-COMBINED-PLAN              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  66
* EL6318.cbl
  3697             88  CF-JNT-PLAN                   VALUE 'J'.
  3698             88  CF-SNGL-PLAN                  VALUE 'S'.
  3699         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3700         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3701         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3702         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3703         16  CF-RERATE-CNTL                 PIC  X.
  3704             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3705             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3706             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3707             88  CF-AUTO-RECALC                 VALUE '4'.
  3708         16  CF-BENEFIT-TYPE                PIC  X.
  3709             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3710             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3711         16  CF-POLICY-FEE                  PIC S999V99
  3712                                                    COMP-3.
  3713         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3714         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3715         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3716         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3717         16  FILLER                         PIC  X(32).
  3718         16  CF-TERMINATION-FORM            PIC  X(04).
  3719         16  FILLER                         PIC  X(08).
  3720         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3721                                                       COMP-3.
  3722         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3723         16  CF-ISSUE-LETTER                PIC  X(4).
  3724         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3725         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3726             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3727             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3728         16  CF-MP-REFUND-CALC              PIC X.
  3729             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3730             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3731             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3732             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3733             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3734             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3735             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3736             88  CF-MP-REFD-MEAN                VALUE '8'.
  3737         16  CF-ALT-RATE-CODE               PIC  X(5).
  3738
  3739
  3740         16  FILLER                         PIC X(498).
  3741****************************************************************
  3742*             MORTGAGE COMPANY MASTER RECORD                   *
  3743****************************************************************
  3744
  3745     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3746         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3747         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3748             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3749             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3750             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3751             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3752             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3753
  3754         16  CF-MORTG-CONVERSION-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  67
* EL6318.cbl
  3755         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3756         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3757         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3758         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3759
  3760         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3761             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3762         16  CF-MP-RECON-USE-IND            PIC X(1).
  3763             88  CF-MP-USE-RECON             VALUE 'Y'.
  3764         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3765             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3766         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3767             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3768             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3769         16  FILLER                         PIC X(1).
  3770         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3771             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3772         16  CF-MORTG-MIB-VERSION           PIC X.
  3773             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3774             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3775             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3776         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3777             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3778                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3779             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3780                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3781             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3782                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3783             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3784                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3785             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3786                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3787             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3788                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3789         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3790         16  FILLER                         PIC X(7).
  3791         16  CF-MORTG-DESTINATION-SYMBOL.
  3792             20  CF-MORTG-MIB-COMM          PIC X(5).
  3793             20  CF-MORTG-MIB-TERM          PIC X(5).
  3794         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3795             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3796         16  FILLER                         PIC X(03).
  3797         16  CF-MP-CHECK-NO-CONTROL.
  3798             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3799                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3800                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3801                                                ' ' LOW-VALUES.
  3802                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3803                                               VALUE '3'.
  3804         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3805         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3806         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3807             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3808                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3809             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3810                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3811             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3812                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  68
* EL6318.cbl
  3813             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3814                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3815             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3816                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3817             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3818                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3819         16  CF-MORTG-BILLING-AREA.
  3820             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3821                                            PIC X.
  3822         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3823         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3824         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3825         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3826             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3827             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3828         16  FILLER                         PIC X.
  3829         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3830             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3831             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3832         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3833         16  FILLER                         PIC X(8).
  3834         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3835         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3836         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3837         16  CF-ACH-COMPANY-ID.
  3838             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3839                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3840                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3841                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3842             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3843         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3844             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3845         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3846             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3847             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3848         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3849         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3850         16  FILLER                         PIC X(536).
  3851
  3852****************************************************************
  3853*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3854****************************************************************
  3855
  3856     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3857         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3858             20  CF-FEMALE-HEIGHT.
  3859                 24  CF-FEMALE-FT           PIC 99.
  3860                 24  CF-FEMALE-IN           PIC 99.
  3861             20  CF-FEMALE-MIN-WT           PIC 999.
  3862             20  CF-FEMALE-MAX-WT           PIC 999.
  3863         16  FILLER                         PIC X(428).
  3864
  3865     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3866         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3867             20  CF-MALE-HEIGHT.
  3868                 24  CF-MALE-FT             PIC 99.
  3869                 24  CF-MALE-IN             PIC 99.
  3870             20  CF-MALE-MIN-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  69
* EL6318.cbl
  3871             20  CF-MALE-MAX-WT             PIC 999.
  3872         16  FILLER                         PIC X(428).
  3873******************************************************************
  3874*             AUTOMATIC ACTIVITY RECORD                          *
  3875******************************************************************
  3876     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3877         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3878             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3879             20  CF-SYS-LETTER-ID           PIC X(04).
  3880             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3881             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3882             20  CF-SYS-RESET-SW            PIC X(01).
  3883             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3884             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3885
  3886         16  FILLER                         PIC X(50).
  3887
  3888         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3889             20  CF-USER-ACTIVE-SW          PIC X(01).
  3890             20  CF-USER-LETTER-ID          PIC X(04).
  3891             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3892             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3893             20  CF-USER-RESET-SW           PIC X(01).
  3894             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3895             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3896             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3897
  3898         16  FILLER                         PIC X(246).
  3899*                                COPY ERCPNDB.
  3900******************************************************************
  3901*                                                                *
  3902*                                                                *
  3903*                            ERCPNDB.                            *
  3904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3905*                            VMOD=2.025                          *
  3906*                                                                *
  3907*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3908*                                                                *
  3909******************************************************************
  3910*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3911*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3912******************************************************************
  3913*                                                                *
  3914*                                                                *
  3915*   FILE TYPE = VSAM,KSDS                                        *
  3916*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3917*                                                                *
  3918*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3919*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3920*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3921*                                                 RKP=13,LEN=36  *
  3922*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3923*                                      AND CHG-SEQ.)             *
  3924*                                                RKP=49,LEN=11   *
  3925*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3926*                                      AND CHG-SEQ.)             *
  3927*                                                RKP=60,LEN=15   *
  3928*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  70
* EL6318.cbl
  3929*   LOG = NO                                                     *
  3930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3931******************************************************************
  3932******************************************************************
  3933*                   C H A N G E   L O G
  3934*
  3935* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3936*-----------------------------------------------------------------
  3937*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3938* EFFECTIVE    NUMBER
  3939*-----------------------------------------------------------------
  3940* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3941* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3942* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3943* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3944* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3945* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3946* 032306                   PEMA  ADD BOW LOAN NUMBER
  3947* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3948* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3949* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3950* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3951* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3952* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3953* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3954* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3955******************************************************************
  3956
  3957 01  PENDING-BUSINESS.
  3958     12  PB-RECORD-ID                     PIC XX.
  3959         88  VALID-PB-ID                        VALUE 'PB'.
  3960
  3961     12  PB-CONTROL-PRIMARY.
  3962         16  PB-COMPANY-CD                PIC X.
  3963         16  PB-ENTRY-BATCH               PIC X(6).
  3964         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3965         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3966
  3967     12  PB-CONTROL-BY-ACCOUNT.
  3968         16  PB-COMPANY-CD-A1             PIC X.
  3969         16  PB-CARRIER                   PIC X.
  3970         16  PB-GROUPING.
  3971             20  PB-GROUPING-PREFIX       PIC XXX.
  3972             20  PB-GROUPING-PRIME        PIC XXX.
  3973         16  PB-STATE                     PIC XX.
  3974         16  PB-ACCOUNT.
  3975             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3976             20  PB-ACCOUNT-PRIME         PIC X(6).
  3977         16  PB-CERT-EFF-DT               PIC XX.
  3978         16  PB-CERT-NO.
  3979             20  PB-CERT-PRIME            PIC X(10).
  3980             20  PB-CERT-SFX              PIC X.
  3981         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3982
  3983         16  PB-RECORD-TYPE               PIC X.
  3984             88  PB-MAILING-DATA                VALUE '0'.
  3985             88  PB-ISSUE                       VALUE '1'.
  3986             88  PB-CANCELLATION                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  71
* EL6318.cbl
  3987             88  PB-BATCH-TRAILER               VALUE '9'.
  3988
  3989     12  PB-CONTROL-BY-ORIG-BATCH.
  3990         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3991         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3992         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3993         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3994
  3995     12  PB-CONTROL-BY-CSR.
  3996         16  PB-CSR-COMPANY-CD            PIC X.
  3997         16  PB-CSR-ID                    PIC X(4).
  3998         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3999         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4000         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4001******************************************************************
  4002*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4003******************************************************************
  4004
  4005     12  PB-LAST-MAINT-DT                 PIC XX.
  4006     12  PB-LAST-MAINT-BY                 PIC X(4).
  4007     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4008
  4009     12  PB-RECORD-BODY                   PIC X(375).
  4010
  4011     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4012         16  PB-CERT-ORIGIN               PIC X.
  4013             88  CLASIC-CREATED-CERT         VALUE '1'.
  4014         16  PB-I-NAME.
  4015             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4016             20  PB-I-INSURED-FIRST-NAME.
  4017                 24  PB-I-INSURED-1ST-INIT PIC X.
  4018                 24  FILLER                PIC X(9).
  4019             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4020         16  PB-I-AGE                     PIC S99   COMP-3.
  4021         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4022         16  PB-I-BIRTHDAY                PIC XX.
  4023         16  PB-I-INSURED-SEX             PIC X.
  4024             88  PB-SEX-MALE     VALUE 'M'.
  4025             88  PB-SEX-FEMALE   VALUE 'F'.
  4026
  4027         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4028         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4029         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4030         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4031         16  PB-I-SKIP-CODE               PIC X.
  4032             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4033             88  PB-SKIP-JULY              VALUE '1'.
  4034             88  PB-SKIP-AUGUST            VALUE '2'.
  4035             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4036             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4037             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4038             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4039             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4040             88  PB-SKIP-JUNE              VALUE '8'.
  4041             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4042             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4043             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4044         16  PB-I-TERM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  72
* EL6318.cbl
  4045             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4046             88  PB-PAID-WEEKLY            VALUE 'W'.
  4047             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4048             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4049             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4050         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4051         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4052         16  PB-I-DATA-ENTRY-SW           PIC X.
  4053             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4054             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4055             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4056             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4057         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4058         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4059*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4060         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4061         16  FILLER                       PIC X.
  4062
  4063         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4064             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4065             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4066                                                   '90' THRU '99'.
  4067         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4068                                          PIC XX.
  4069         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4070         16  PB-I-AMOUNT-FINANCED REDEFINES
  4071                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4072         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4073         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4074                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4075         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4076         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4077         16  PB-I-CLP-AMOUNT REDEFINES
  4078                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4079         16  PB-I-LF-CALC-FLAG            PIC X.
  4080             88 PB-COMP-LF-PREM               VALUE '?'.
  4081         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4082         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4083         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4084         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4085         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4086         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4087         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4088         16  PB-I-LF-ABBR                 PIC XXX.
  4089         16  PB-I-LF-INPUT-CD             PIC XX.
  4090
  4091         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4092             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4093             88  PB-INVALID-AH               VALUE '  ' '00'
  4094                                                   '90' THRU '99'.
  4095         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4096         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4097         16  PB-I-AH-CALC-FLAG            PIC X.
  4098             88 PB-COMP-AH-PREM                  VALUE '?'.
  4099         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4100         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4101         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4102         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  73
* EL6318.cbl
  4103         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4104         16  PB-I-AH-ABBR                 PIC XXX.
  4105         16  PB-I-AH-INPUT-CD             PIC XXX.
  4106
  4107         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4108         16  PB-I-REIN-TABLE              PIC XXX.
  4109         16  PB-I-BUSINESS-TYPE           PIC 99.
  4110         16  PB-I-INDV-GRP-CD             PIC X.
  4111         16  PB-I-MORT-CODE.
  4112             20  PB-I-TABLE               PIC X.
  4113             20  PB-I-INTEREST            PIC XX.
  4114             20  PB-I-MORT-TYP            PIC X.
  4115         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4116         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4117         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4118         16  PB-I-INDV-GRP-OVRD           PIC X.
  4119         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4120         16  PB-I-SIG-SW                  PIC X.
  4121             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4122         16  PB-I-RATE-CLASS              PIC XX.
  4123         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4124         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4125         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4126         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4127         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4128         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4129         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4130         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4131         16  PB-I-OB-FLAG                 PIC X.
  4132             88  PB-I-OB                      VALUE 'B'.
  4133             88  PB-I-SUMMARY                 VALUE 'Z'.
  4134         16  PB-I-ENTRY-STATUS            PIC X.
  4135             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4136                                              'M' '5' '9' '2'.
  4137             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4138             88  PB-I-POLICY-PENDING          VALUE '2'.
  4139             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4140             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4141             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4142             88  PB-I-REIN-ONLY               VALUE '9'.
  4143             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4144             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4145             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4146             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4147         16  PB-I-INT-CODE                PIC X.
  4148             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4149             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4150         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4151         16  PB-I-SOC-SEC-NO              PIC X(11).
  4152         16  PB-I-MEMBER-NO               PIC X(12).
  4153         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4154*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4155         16  PB-I-OLD-LOF                 PIC XXX.
  4156         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4157         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4158         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4159         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4160         16  PB-I-LIFE-INDICATOR          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  74
* EL6318.cbl
  4161             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4162         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4163         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4164                                          PIC S9(5)V99    COMP-3.
  4165         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4166             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4167             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4168         16  PB-I-1ST-PMT-DT              PIC XX.
  4169         16  PB-I-JOINT-INSURED.
  4170             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4171             20 PB-I-JOINT-FIRST-NAME.
  4172                24  PB-I-JOINT-FIRST-INIT PIC X.
  4173                24  FILLER                PIC X(9).
  4174             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4175*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4176         16  PB-I-BENEFICIARY-NAME.
  4177             20  PB-I-BANK-NUMBER         PIC X(10).
  4178             20  FILLER                   PIC X(15).
  4179         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4180         16  PB-I-REFERENCE               PIC X(12).
  4181         16  FILLER REDEFINES PB-I-REFERENCE.
  4182             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4183             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4184             20  PB-I-CLP-STATE           PIC XX.
  4185         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4186             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4187             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4188             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4189         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4190         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4191         16  PB-I-RESIDENT-STATE          PIC XX.
  4192         16  PB-I-RATE-CODE               PIC X(4).
  4193         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4194         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4195         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4196         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4197         16  PB-I-BANK-NOCHRGB            PIC 99.
  4198         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4199         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4200
  4201     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4202         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4203             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4204         16  PB-C-CANCEL-ORIGIN           PIC X.
  4205             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4206         16  PB-C-LF-CANCEL-DT            PIC XX.
  4207         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4208         16  PB-C-LF-CALC-REQ             PIC X.
  4209             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4210         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4211         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4212         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4213             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4214         16  PB-C-AH-CANCEL-DT            PIC XX.
  4215         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4216         16  PB-C-AH-CALC-REQ             PIC X.
  4217             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4218         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  75
* EL6318.cbl
  4219         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4220         16  PB-C-LAST-NAME               PIC X(15).
  4221         16  PB-C-REFUND-SW               PIC X.
  4222             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4223             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4224         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4225         16  PB-C-PAYEE-CODE              PIC X(6).
  4226         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4227         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4228         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4229         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4230         16  PB-C-REFERENCE               PIC X(12).
  4231         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4232         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4233         16  PB-C-POST-CARD-IND           PIC X.
  4234         16  PB-C-CANCEL-REASON           PIC X.
  4235         16  PB-C-REF-INTERFACE-SW        PIC X.
  4236         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4237         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4238         16  FILLER                       PIC X(01).
  4239*        16  FILLER                       PIC X(18).
  4240         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4241*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4242         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4243         16  PB-CANCELED-CERT-DATA.
  4244             20  PB-CI-INSURED-NAME.
  4245                 24  PB-CI-LAST-NAME      PIC X(15).
  4246                 24  PB-CI-INITIALS       PIC XX.
  4247             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4248             20  PB-CI-INSURED-SEX        PIC X.
  4249             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4250             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4251             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4252             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4253             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4254             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4255             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4256             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4257             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4258             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4259             20  PB-CI-RATE-CLASS         PIC XX.
  4260             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4261             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4262             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4263             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4264             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4265             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4266             20  PB-CI-LF-ABBR            PIC X(3).
  4267             20  PB-CI-AH-ABBR            PIC X(3).
  4268             20  PB-CI-OB-FLAG            PIC X.
  4269                 88  PB-CI-OB                VALUE 'B'.
  4270             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4271                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4272                                           'M' '4' '5' '9' '2'.
  4273                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4274                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4275                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4276                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  76
* EL6318.cbl
  4277                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4278                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4279                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4280                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4281                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4282                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4283                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4284                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4285             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4286                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4287                                           'M' '4' '5' '9' '2'.
  4288                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4289                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4290                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4291                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4292                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4293                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4294                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4295                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4296                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4297                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4298                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4299                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4300             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4301             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4302             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4303             20  PB-CI-MEMBER-NO          PIC X(12).
  4304             20  PB-CI-INT-CODE           PIC X.
  4305                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4306                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4307             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4308             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4309             20  PB-CI-COMP-EXCP-SW       PIC X.
  4310                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4311                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4312             20  PB-CI-ENTRY-STATUS       PIC X.
  4313             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4314             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4315             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4316             20  PB-CI-DEATH-DT           PIC XX.
  4317             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4318             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4319             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4320             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4321             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4322             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4323             20  PB-CI-ENTRY-DT              PIC XX.
  4324             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4325             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4326             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4327             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4328             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4329             20  PB-CI-OLD-LOF               PIC XXX.
  4330*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4331             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4332             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4333             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4334             20  PB-CI-INDV-GRP-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  77
* EL6318.cbl
  4335             20  PB-CI-BENEFICIARY-NAME.
  4336                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4337                 24  FILLER                  PIC X(15).
  4338             20  PB-CI-NOTE-SW               PIC X.
  4339             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4340             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4341             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4342             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4343             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4344             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4345             20  PB-CI-FIRST-NAME            PIC X(10).
  4346             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4347
  4348         16  FILLER                       PIC X(13).
  4349*032306  16  FILLER                       PIC X(27).
  4350*        16  FILLER                       PIC X(46).
  4351
  4352     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4353         16  FILLER                       PIC X(10).
  4354         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4355         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4356         16  PB-M-INSURED-MID-INIT        PIC X.
  4357         16  PB-M-INSURED-AGE             PIC 99.
  4358         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4359         16  PB-M-INSURED-SEX             PIC X.
  4360         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4361         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4362         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4363         16  PB-M-INSURED-CITY-STATE.
  4364             20  PB-M-INSURED-CITY        PIC X(28).
  4365             20  PB-M-INSURED-STATE       PIC XX.
  4366         16  PB-M-INSURED-ZIP-CODE.
  4367             20  PB-M-INSURED-ZIP-PRIME.
  4368                 24  PB-M-INSURED-ZIP-1   PIC X.
  4369                     88  PB-M-CANADIAN-POST-CODE
  4370                                             VALUE 'A' THRU 'Z'.
  4371                 24  FILLER               PIC X(4).
  4372             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4373         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4374                                        PB-M-INSURED-ZIP-CODE.
  4375             20  PM-M-INS-CAN-POST1       PIC XXX.
  4376             20  PM-M-INS-CAN-POST2       PIC XXX.
  4377             20  FILLER                   PIC XXX.
  4378         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4379         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4380         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4381         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4382         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4383         16  PB-M-CRED-BENE-CITYST.
  4384             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4385             20  PB-M-CRED-BENE-STATE     PIC XX.
  4386         16  FILLER                       PIC X(92).
  4387
  4388     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4389         16  FILLER                       PIC X(10).
  4390         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4391         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4392         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  78
* EL6318.cbl
  4393         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4394         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4395         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4396         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4397         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4398         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4399         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4400         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4401         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4402         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4403         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4404         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4405         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4406         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4407         16  PB-ACCOUNT-NAME              PIC X(30).
  4408         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4409         16  PB-REFERENCE                 PIC X(12).
  4410         16  PB-B-RECEIVED-DT             PIC XX.
  4411         16  FILLER                       PIC X(234).
  4412
  4413     12  PB-RECORD-STATUS.
  4414         16  PB-CREDIT-SELECT-DT          PIC XX.
  4415         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4416         16  PB-BILLED-DT                 PIC XX.
  4417         16  PB-BILLING-STATUS            PIC X.
  4418             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4419             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4420             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4421         16  PB-RECORD-BILL               PIC X.
  4422             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4423             88  PB-RECORD-RETURNED           VALUE 'R'.
  4424             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4425             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4426             88  PB-OVERRIDE-AH               VALUE 'A'.
  4427             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4428         16  PB-BATCH-ENTRY               PIC X.
  4429             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4430             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4431             88  PB-REISSUED-CERT             VALUE 'E'.
  4432             88  PB-MONTHLY-CERT              VALUE 'M'.
  4433             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4434             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4435             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4436         16  PB-FORCE-CODE                PIC X.
  4437             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4438             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4439             88  PB-CANCEL-FORCE              VALUE '8'.
  4440             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4441             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4442             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4443             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4444             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4445             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4446             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4447         16  PB-FATAL-FLAG                PIC X.
  4448             88  PB-FATAL-ERRORS              VALUE 'X'.
  4449         16  PB-FORCE-ER-CD               PIC X.
  4450             88  PB-FORCE-ERRORS              VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  79
* EL6318.cbl
  4451             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4452         16  PB-WARN-ER-CD                PIC X.
  4453             88  PB-WARNING-ERRORS            VALUE 'W'.
  4454         16  FILLER                       PIC X.
  4455         16  PB-OUT-BAL-CD                PIC X.
  4456             88  PB-OUT-OF-BAL                VALUE 'O'.
  4457         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4458         16  PB-AH-OVERRIDE-L1            PIC X.
  4459         16  PB-INPUT-DT                  PIC XX.
  4460         16  PB-INPUT-BY                  PIC X(4).
  4461         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4462         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4463         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4464         16  PB-LF-EARNING-METHOD         PIC X.
  4465         16  PB-AH-EARNING-METHOD         PIC X.
  4466         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4467         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4468         16  PB-REIN-CD                   PIC XXX.
  4469         16  PB-LF-REFUND-TYPE            PIC X.
  4470         16  PB-AH-REFUND-TYPE            PIC X.
  4471         16  PB-ACCT-EFF-DT               PIC XX.
  4472         16  PB-ACCT-EXP-DT               PIC XX.
  4473         16  PB-COMPANY-ID                PIC X(3).
  4474         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4475         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4476         16  PB-SV-CARRIER                PIC X.
  4477         16  PB-SV-GROUPING               PIC X(6).
  4478         16  PB-SV-STATE                  PIC XX.
  4479         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4480         16  PB-GA-BILLING-INFO.
  4481             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4482                                          PIC XX.
  4483         16  PB-SV-REMIT-TO  REDEFINES
  4484             PB-GA-BILLING-INFO           PIC X(10).
  4485         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4486         16  PB-I-LOAN-OFFICER            PIC X(5).
  4487         16  PB-I-VIN                     PIC X(17).
  4488
  4489         16  FILLER                       PIC X(04).
  4490         16  IMNET-BYPASS-SW              PIC X.
  4491
  4492******************************************************************
  4493*                COMMON EDIT ERRORS                              *
  4494******************************************************************
  4495
  4496     12  PB-COMMON-ERRORS.
  4497         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4498                                           PIC S9(4)     COMP.
  4499
  4500******************************************************************
  4501*                                COPY ELCCERT.
  4502******************************************************************
  4503*                                                                *
  4504*                            ELCCERT.                            *
  4505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4506*                            VMOD=2.013                          *
  4507*                                                                *
  4508*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  80
* EL6318.cbl
  4509*                                                                *
  4510*   FILE TYPE = VSAM,KSDS                                        *
  4511*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4512*                                                                *
  4513*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4514*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4515*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4516*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4517*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4518*                                                                *
  4519*   LOG = YES                                                    *
  4520*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4521******************************************************************
  4522*                   C H A N G E   L O G
  4523*
  4524* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4525*-----------------------------------------------------------------
  4526*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4527* EFFECTIVE    NUMBER
  4528*-----------------------------------------------------------------
  4529* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4530* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4531* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4532* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4533* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4534* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4535* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4536* 032612  CR2011110200001  PEMA  AHL CHANGES
  4537******************************************************************
  4538
  4539 01  CERTIFICATE-MASTER.
  4540     12  CM-RECORD-ID                      PIC XX.
  4541         88  VALID-CM-ID                      VALUE 'CM'.
  4542
  4543     12  CM-CONTROL-PRIMARY.
  4544         16  CM-COMPANY-CD                 PIC X.
  4545         16  CM-CARRIER                    PIC X.
  4546         16  CM-GROUPING.
  4547             20  CM-GROUPING-PREFIX        PIC X(3).
  4548             20  CM-GROUPING-PRIME         PIC X(3).
  4549         16  CM-STATE                      PIC XX.
  4550         16  CM-ACCOUNT.
  4551             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4552             20  CM-ACCOUNT-PRIME          PIC X(6).
  4553         16  CM-CERT-EFF-DT                PIC XX.
  4554         16  CM-CERT-NO.
  4555             20  CM-CERT-PRIME             PIC X(10).
  4556             20  CM-CERT-SFX               PIC X.
  4557
  4558     12  CM-CONTROL-BY-NAME.
  4559         16  CM-COMPANY-CD-A1              PIC X.
  4560         16  CM-INSURED-LAST-NAME          PIC X(15).
  4561         16  CM-INSURED-INITIALS.
  4562             20  CM-INSURED-INITIAL1       PIC X.
  4563             20  CM-INSURED-INITIAL2       PIC X.
  4564
  4565     12  CM-CONTROL-BY-SSN.
  4566         16  CM-COMPANY-CD-A2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  81
* EL6318.cbl
  4567         16  CM-SOC-SEC-NO.
  4568             20  CM-SSN-STATE              PIC XX.
  4569             20  CM-SSN-ACCOUNT            PIC X(6).
  4570             20  CM-SSN-LN3.
  4571                 25  CM-INSURED-INITIALS-A2.
  4572                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4573                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4574                 25 CM-PART-LAST-NAME-A2         PIC X.
  4575
  4576     12  CM-CONTROL-BY-CERT-NO.
  4577         16  CM-COMPANY-CD-A4              PIC X.
  4578         16  CM-CERT-NO-A4                 PIC X(11).
  4579
  4580     12  CM-CONTROL-BY-MEMB.
  4581         16  CM-COMPANY-CD-A5              PIC X.
  4582         16  CM-MEMBER-NO.
  4583             20  CM-MEMB-STATE             PIC XX.
  4584             20  CM-MEMB-ACCOUNT           PIC X(6).
  4585             20  CM-MEMB-LN4.
  4586                 25  CM-INSURED-INITIALS-A5.
  4587                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4588                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4589                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4590
  4591     12  CM-INSURED-PROFILE-DATA.
  4592         16  CM-INSURED-FIRST-NAME.
  4593             20  CM-INSURED-1ST-INIT       PIC X.
  4594             20  FILLER                    PIC X(9).
  4595         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4596         16  CM-INSURED-SEX                PIC X.
  4597             88  CM-SEX-MALE                  VALUE 'M'.
  4598             88  CM-SEX-FEMAL                 VALUE 'F'.
  4599         16  CM-INSURED-JOINT-AGE          PIC 99.
  4600         16  CM-JOINT-INSURED-NAME.
  4601             20  CM-JT-LAST-NAME           PIC X(15).
  4602             20  CM-JT-FIRST-NAME.
  4603                 24  CM-JT-1ST-INIT        PIC X.
  4604                 24  FILLER                PIC X(9).
  4605             20  CM-JT-INITIAL             PIC X.
  4606
  4607     12  CM-LIFE-DATA.
  4608         16  CM-LF-BENEFIT-CD              PIC XX.
  4609         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4610         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4611         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4612         16  CM-LF-DEV-CODE                PIC XXX.
  4613         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4614         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4615         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4616         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4617         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4618         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4619         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4620         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4621         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4622         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4623         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4624         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  82
* EL6318.cbl
  4625         16  FILLER                        PIC XX.
  4626
  4627     12  CM-AH-DATA.
  4628         16  CM-AH-BENEFIT-CD              PIC XX.
  4629         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4630         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4631         16  CM-AH-DEV-CODE                PIC XXX.
  4632         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4633         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4634         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4635         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4636         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4637         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4638         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4639         16  CM-AH-PAID-THRU-DT            PIC XX.
  4640             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4641         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4642         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4643         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4644         16  FILLER                        PIC X.
  4645
  4646     12  CM-LOAN-INFORMATION.
  4647         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4648         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4649                                           PIC S9(5)V99  COMP-3.
  4650         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4651         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4652         16  CM-PAY-FREQUENCY              PIC S99.
  4653         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4654         16  CM-RATE-CLASS                 PIC XX.
  4655         16  CM-BENEFICIARY                PIC X(25).
  4656         16  CM-POLICY-FORM-NO             PIC X(12).
  4657         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4658         16  CM-LAST-ADD-ON-DT             PIC XX.
  4659         16  CM-DEDUCTIBLE-AMOUNTS.
  4660             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4661             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4662         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4663             20  CM-RESIDENT-STATE         PIC XX.
  4664             20  CM-RATE-CODE              PIC X(4).
  4665             20  FILLER                    PIC XX.
  4666         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4667             20  CM-LOAN-OFFICER           PIC X(5).
  4668             20  FILLER                    PIC XXX.
  4669         16  CM-CSR-CODE                   PIC XXX.
  4670         16  CM-UNDERWRITING-CODE          PIC X.
  4671             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4672         16  CM-POST-CARD-IND              PIC X.
  4673         16  CM-NH-INTERFACE-SW            PIC X.
  4674         16  CM-PREMIUM-TYPE               PIC X.
  4675             88  CM-SING-PRM                  VALUE '1'.
  4676             88  CM-O-B-COVERAGE              VALUE '2'.
  4677             88  CM-OPEN-END                  VALUE '3'.
  4678         16  CM-IND-GRP-TYPE               PIC X.
  4679             88  CM-INDIVIDUAL                VALUE 'I'.
  4680             88  CM-GROUP                     VALUE 'G'.
  4681         16  CM-SKIP-CODE                  PIC X.
  4682             88  NO-MONTHS-SKIPPED            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  83
* EL6318.cbl
  4683             88  SKIP-JULY                    VALUE '1'.
  4684             88  SKIP-AUGUST                  VALUE '2'.
  4685             88  SKIP-SEPTEMBER               VALUE '3'.
  4686             88  SKIP-JULY-AUG                VALUE '4'.
  4687             88  SKIP-AUG-SEPT                VALUE '5'.
  4688             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4689             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4690             88  SKIP-JUNE                    VALUE '8'.
  4691             88  SKIP-JUNE-JULY               VALUE '9'.
  4692             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4693             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4694         16  CM-PAYMENT-MODE               PIC X.
  4695             88  PAY-MONTHLY                  VALUE SPACE.
  4696             88  PAY-WEEKLY                   VALUE '1'.
  4697             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4698             88  PAY-BI-WEEKLY                VALUE '3'.
  4699             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4700         16  CM-LOAN-NUMBER                PIC X(8).
  4701         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4702         16  CM-OLD-LOF                    PIC XXX.
  4703*        16  CM-LOAN-OFFICER               PIC XXX.
  4704         16  CM-REIN-TABLE                 PIC XXX.
  4705         16  CM-SPECIAL-REIN-CODE          PIC X.
  4706         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4707         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4708         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4709
  4710     12  CM-STATUS-DATA.
  4711         16  CM-ENTRY-STATUS               PIC X.
  4712         16  CM-ENTRY-DT                   PIC XX.
  4713
  4714         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4715         16  CM-LF-CANCEL-DT               PIC XX.
  4716         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4717
  4718         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4719         16  CM-LF-DEATH-DT                PIC XX.
  4720         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4721
  4722         16  CM-LF-CURRENT-STATUS          PIC X.
  4723             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4724                                                'M' '4' '5' '9'.
  4725             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4726             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4727             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4728             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4729             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4730             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4731             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4732             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4733             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4734             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4735             88  CM-LF-DECLINED               VALUE 'D'.
  4736             88  CM-LF-VOIDED                 VALUE 'V'.
  4737
  4738         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4739         16  CM-AH-CANCEL-DT               PIC XX.
  4740         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  84
* EL6318.cbl
  4741
  4742         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4743         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4744         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4745
  4746         16  CM-AH-CURRENT-STATUS          PIC X.
  4747             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4748                                                'M' '4' '5' '9'.
  4749             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4750             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4751             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4752             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4753             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4754             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4755             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4756             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4757             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4758             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4759             88  CM-AH-DECLINED               VALUE 'D'.
  4760             88  CM-AH-VOIDED                 VALUE 'V'.
  4761
  4762         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4763             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4764             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4765             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4766         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4767
  4768         16  CM-ENTRY-BATCH                PIC X(6).
  4769         16  CM-LF-EXIT-BATCH              PIC X(6).
  4770         16  CM-AH-EXIT-BATCH              PIC X(6).
  4771         16  CM-LAST-MONTH-END             PIC XX.
  4772
  4773     12  CM-NOTE-SW                        PIC X.
  4774         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4775         88  CERT-NOTES-PRESENT               VALUE '1'.
  4776         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4777         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4778         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4779         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4780         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4781         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4782     12  CM-COMP-EXCP-SW                   PIC X.
  4783         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4784         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4785     12  CM-INSURED-ADDRESS-SW             PIC X.
  4786         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4787         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4788
  4789*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4790     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4791     12  FILLER                            PIC X.
  4792
  4793*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4794     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4795     12  FILLER                            PIC X.
  4796*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4797     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4798
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  85
* EL6318.cbl
  4799     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4800         88  CERT-ADDED-BATCH                 VALUE ' '.
  4801         88  CERT-ADDED-ONLINE                VALUE '1'.
  4802         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4803         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4804         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4805     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4806         88  CERT-AS-LOADED                   VALUE ' '.
  4807         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4808         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4809         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4810         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4811         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4812         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4813         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4814
  4815     12  CM-ACCOUNT-COMM-PCTS.
  4816         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4817         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4818
  4819     12  CM-USER-FIELD                     PIC X.
  4820     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4821     12  CM-CLP-STATE                      PIC XX.
  4822     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4823     12  CM-USER-RESERVED                  PIC XXX.
  4824     12  FILLER REDEFINES CM-USER-RESERVED.
  4825         16  CM-AH-CLASS-CD                PIC XX.
  4826         16  F                             PIC X.
  4827******************************************************************
  4828*                                COPY ELCCRTO.
  4829******************************************************************
  4830*                                                                *
  4831*                            ELCCRTO.                            *
  4832*                                                                *
  4833*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4834*                                                                *
  4835*   FILE TYPE = VSAM,KSDS                                        *
  4836*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4837*                                                                *
  4838*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4839*                                                                *
  4840*   LOG = YES                                                    *
  4841*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4842******************************************************************
  4843*                   C H A N G E   L O G
  4844*
  4845* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4846*-----------------------------------------------------------------
  4847*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4848* EFFECTIVE    NUMBER
  4849*-----------------------------------------------------------------
  4850* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4851* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4852* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4853* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4854* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4855******************************************************************
  4856 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  86
* EL6318.cbl
  4857     12  OC-RECORD-ID                      PIC XX.
  4858         88  VALID-OC-ID                      VALUE 'OC'.
  4859     12  OC-CONTROL-PRIMARY.
  4860         16  OC-COMPANY-CD                 PIC X.
  4861         16  OC-CARRIER                    PIC X.
  4862         16  OC-GROUPING                   PIC X(6).
  4863         16  OC-STATE                      PIC XX.
  4864         16  OC-ACCOUNT                    PIC X(10).
  4865         16  OC-CERT-EFF-DT                PIC XX.
  4866         16  OC-CERT-NO.
  4867             20  OC-CERT-PRIME             PIC X(10).
  4868             20  OC-CERT-SFX               PIC X.
  4869         16  OC-RECORD-TYPE                PIC X.
  4870         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4871     12  OC-LAST-MAINT-DT                  PIC XX.
  4872     12  OC-LAST-MAINT-BY                  PIC X(4).
  4873     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4874     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4875     12  FILLER                            PIC X(49).
  4876     12  OC-ORIG-REC.
  4877         16  OC-INS-LAST-NAME              PIC X(15).
  4878         16  OC-INS-FIRST-NAME             PIC X(10).
  4879         16  OC-INS-MIDDLE-INIT            PIC X.
  4880         16  OC-INS-AGE                    PIC S999     COMP-3.
  4881         16  OC-JNT-LAST-NAME              PIC X(15).
  4882         16  OC-JNT-FIRST-NAME             PIC X(10).
  4883         16  OC-JNT-MIDDLE-INIT            PIC X.
  4884         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4885         16  OC-LF-BENCD                   PIC XX.
  4886         16  OC-LF-TERM                    PIC S999      COMP-3.
  4887         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4888         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4889         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4890         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4891         16  OC-LF-EXP-DT                  PIC XX.
  4892         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4893         16  OC-LF-CANCEL-DT               PIC XX.
  4894         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4895         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4896         16  OC-AH-BENCD                   PIC XX.
  4897         16  OC-AH-TERM                    PIC S999      COMP-3.
  4898         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4899         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4900         16  OC-AH-EXP-DT                  PIC XX.
  4901         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4902         16  OC-AH-CP                      PIC 99.
  4903         16  OC-AH-CANCEL-DT               PIC XX.
  4904         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4905         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4906         16  OC-CRED-BENE-NAME             PIC X(25).
  4907         16  OC-1ST-PMT-DT                 PIC XX.
  4908         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4909         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4910         16  OC-ISSUE-TRAN-IND             PIC X.
  4911         16  OC-CANCEL-TRAN-IND            PIC X.
  4912         16  FILLER                        PIC X(211).
  4913
  4914     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  87
* EL6318.cbl
  4915******************************************************************
  4916*                                COPY ERCENDT.
  4917******************************************************************
  4918*                                                                *
  4919*                                                                *
  4920*                            ERCENDT.                            *
  4921*                            VMOD=2.001                          *
  4922*                                                                *
  4923*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4924*                                                                *
  4925*   FILE TYPE = VSAM,KSDS                                        *
  4926*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4927*                                                                *
  4928*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4929*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4930*                                                                *
  4931*   LOG = NO                                                     *
  4932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4933******************************************************************
  4934*-----------------------------------------------------------------
  4935*                   C H A N G E   L O G
  4936*
  4937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4938*-----------------------------------------------------------------
  4939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4940* EFFECTIVE    NUMBER
  4941*-----------------------------------------------------------------
  4942* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4943*                                WITH OPEN CLAIMS
  4944* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4945* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4946* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4947*-----------------------------------------------------------------
  4948 01  ENDORSEMENT-RECORD.
  4949     12  EN-RECORD-ID                PIC XX.
  4950         88  VALID-EN-ID                VALUE 'EN'.
  4951     12  EN-CONTROL-PRIMARY.
  4952         16  EN-COMPANY-CD           PIC X.
  4953         16  EN-CARRIER              PIC X.
  4954         16  EN-GROUPING             PIC X(6).
  4955         16  EN-STATE                PIC XX.
  4956         16  EN-ACCOUNT              PIC X(10).
  4957         16  EN-CERT-EFF-DT          PIC XX.
  4958         16  EN-CERT-NO.
  4959             20  EN-CERT-PRIME       PIC X(10).
  4960             20  EN-CERT-SFX         PIC X.
  4961         16  EN-REC-TYPE             PIC X.
  4962             88  EN-ISSUE               VALUE 'I'.
  4963             88  EN-CANCELLATION        VALUE 'C'.
  4964         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4965     12  EN-CONTROL-BY-ARCH-NO.
  4966         16  EN-COMPANY-CD-A1              PIC X.
  4967         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4968     12  EN-LAST-MAINT-DT            PIC XX.
  4969     12  EN-LAST-MAINT-BY            PIC X(4).
  4970     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4971     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4972     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  88
* EL6318.cbl
  4973         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4974         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4975         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4976         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4977         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4978         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4979         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4980         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4981         16  EN-LF-ORIG-BENCD        PIC XX.
  4982         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4983         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4984         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4985         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4986         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4987         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4988*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4989         16  EN-ORIG-CRED-BENE       PIC X(25).
  4990         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4991         16  FILLER                  PIC X.
  4992         16  EN-AH-ORIG-BENCD        PIC XX.
  4993         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4994         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4995         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4996         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4997*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4998*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4999         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5000         16  F                       PIC X(09).
  5001         16  EN-AH-ORIG-CP           PIC 99.
  5002         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5003         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5004         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5005         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5006         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5007         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5008         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5009         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5010         16  EN-LF-NEW-BENCD         PIC XX.
  5011         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5012         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5013         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5014         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5015         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5016         16  EN-LF-NEW-EXP-DT        PIC XX.
  5017         16  EN-NEW-CRED-BENE        PIC X(25).
  5018         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5019         16  FILLER                  PIC X.
  5020         16  EN-AH-NEW-BENCD         PIC XX.
  5021         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5022         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5023         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5024         16  EN-AH-NEW-EXP-DT        PIC XX.
  5025*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5026*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5027*        16  F                       PIC X(12).
  5028         16  EN-AH-NEW-CP            PIC 99.
  5029         16  EN-SIG-SW               PIC X.
  5030         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  89
* EL6318.cbl
  5031         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5032         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5033         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5034         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5035         16  FILLER                  PIC X(33).
  5036     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5037         16  EN-LF-ORIG-REF-DT       PIC XX.
  5038         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5039         16  EN-AH-ORIG-REF-DT       PIC XX.
  5040         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5041         16  EN-LF-NEW-REF-DT        PIC XX.
  5042         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5043         16  EN-AH-NEW-REF-DT        PIC XX.
  5044         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5045         16  EN-FLAG-CERT            PIC X.
  5046         16  EN-INS-LAST-NAME        PIC X(15).
  5047         16  EN-INS-FIRST-NAME       PIC X(10).
  5048         16  EN-INS-MIDDLE-INIT      PIC X.
  5049         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5050         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5051         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5052         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5053         16  FILLER                  PIC X(262).
  5054     12  EN-MONEY-SW             PIC X.
  5055     12  EN-HEALTH-APP           PIC X.
  5056     12  EN-VOUCHER-SW           PIC X.
  5057     12  EN-PAYEE                PIC X(14).
  5058     12  EN-INPUT-DT             PIC XX.
  5059     12  EN-PROCESS-DT           PIC XX.
  5060     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5061     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5062     12  EN-REASON-CODES.
  5063         16  F OCCURS 12.
  5064             20  EN-REASON-CODE  PIC X(4).
  5065     12  EN-TEMPLATE-USED        PIC X(8).
  5066     12  EN-DOCU-TYPE            PIC X.
  5067         88  EN-VERI-DOCU          VALUE 'V'.
  5068         88  EN-GCE-DOCU           VALUE 'G'.
  5069         88  EN-CANC-DOCU          VALUE 'C'.
  5070     12  EN-COMMENTS1            PIC X(13).
  5071     12  EN-COMMENTS2            PIC X(70).
  5072     12  EN-COMM-CHGBK           PIC X.
  5073         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5074         88  EN-CHG-ACCT           VALUE 'Y'.
  5075     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5076     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5077     12  EN-BATCH-NUMBER         PIC X(6).
  5078     12  EN-ACCT-SUMM            PIC X.
  5079     12  EN-CSO-SUMM             PIC X.
  5080     12  FILLER                  PIC X(13).
  5081******************************************************************
  5082*                                COPY ERCNOTE.
  5083******************************************************************
  5084*                                                                *
  5085*                                                                *
  5086*                            ERCNOTE                             *
  5087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5088*                            VMOD=2.003                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  90
* EL6318.cbl
  5089*                                                                *
  5090*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5091*                                                                *
  5092*        FILE TYPE= VSAM,KSDS                                    *
  5093*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5094*                                                                *
  5095*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5096*                                                                *
  5097*        LOG = YES                                               *
  5098*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5099*                                                                *
  5100******************************************************************
  5101*                   C H A N G E   L O G
  5102*
  5103* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5104*-----------------------------------------------------------------
  5105*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5106* EFFECTIVE    NUMBER
  5107*-----------------------------------------------------------------
  5108* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5109*                                FILE WILL CONTAIN BILLING NOTES O
  5110******************************************************************
  5111
  5112 01  CERTIFICATE-NOTE.
  5113     12  CN-RECORD-ID                PIC  XX.
  5114         88  VALID-CN-ID                  VALUE 'CN'.
  5115
  5116     12  CN-CONTROL-PRIMARY.
  5117         16  CN-COMPANY-CD           PIC X.
  5118         16  CN-CARRIER              PIC X.
  5119         16  CN-GROUPING.
  5120             20 CN-GROUPING-PREFIX   PIC XXX.
  5121             20 CN-GROUPING-PRIME    PIC XXX.
  5122         16  CN-STATE                PIC XX.
  5123         16  CN-ACCOUNT.
  5124             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5125             20 CN-ACCOUNT-PRIME     PIC X(6).
  5126         16  CN-CERT-EFF-DT          PIC XX.
  5127         16  CN-CERT-NO.
  5128             20  CN-CERT-PRIME       PIC X(10).
  5129             20  CN-CERT-SFX         PIC X.
  5130
  5131     12  CN-BILLING-START-LINE-NO    PIC 99.
  5132     12  CN-BILLING-END-LINE-NO      PIC 99.
  5133
  5134     12  CN-LINES.
  5135         16  CN-LINE OCCURS 10       PIC X(77).
  5136
  5137     12  CN-LAST-MAINT-DT            PIC XX.
  5138     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5139     12  CN-LAST-MAINT-USER          PIC X(4).
  5140     12  FILLER                      PIC X(6).
  5141******************************************************************
  5142*                                COPY ERCMAIL.
  5143******************************************************************
  5144*                                                                *
  5145*                                                                *
  5146*                            ERCMAIL                             *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  91
* EL6318.cbl
  5147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5148*                            VMOD=2.003                          *
  5149*                                                                *
  5150*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5151*                                                                *
  5152*   FILE TYPE = VSAM,KSDS                                        *
  5153*   RECORD SIZE = 374   RECFORM = FIX                            *
  5154*                                                                *
  5155*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5156*   ALTERNATE PATH    = NOT USED                                 *
  5157*                                                                *
  5158*   LOG = YES                                                    *
  5159*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5160******************************************************************
  5161*                   C H A N G E   L O G
  5162*
  5163* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5164*-----------------------------------------------------------------
  5165*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5166* EFFECTIVE    NUMBER
  5167*-----------------------------------------------------------------
  5168* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5169* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5170* 111108                   PEMA  ADD CRED BENE ADDR2
  5171******************************************************************
  5172
  5173 01  MAILING-DATA.
  5174     12  MA-RECORD-ID                      PIC XX.
  5175         88  VALID-MA-ID                       VALUE 'MA'.
  5176
  5177     12  MA-CONTROL-PRIMARY.
  5178         16  MA-COMPANY-CD                 PIC X.
  5179         16  MA-CARRIER                    PIC X.
  5180         16  MA-GROUPING.
  5181             20  MA-GROUPING-PREFIX        PIC XXX.
  5182             20  MA-GROUPING-PRIME         PIC XXX.
  5183         16  MA-STATE                      PIC XX.
  5184         16  MA-ACCOUNT.
  5185             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5186             20  MA-ACCOUNT-PRIME          PIC X(6).
  5187         16  MA-CERT-EFF-DT                PIC XX.
  5188         16  MA-CERT-NO.
  5189             20  MA-CERT-PRIME             PIC X(10).
  5190             20  MA-CERT-SFX               PIC X.
  5191
  5192     12  FILLER                            PIC XX.
  5193
  5194     12  MA-ACCESS-CONTROL.
  5195         16  MA-SOURCE-SYSTEM              PIC XX.
  5196             88  MA-FROM-CREDIT                VALUE 'CR'.
  5197             88  MA-FROM-VSI                   VALUE 'VS'.
  5198             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5199             88  MA-FROM-OTHER                 VALUE 'OT'.
  5200         16  MA-RECORD-ADD-DT              PIC XX.
  5201         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5202         16  MA-LAST-MAINT-DT              PIC XX.
  5203         16  MA-LAST-MAINT-BY              PIC XXXX.
  5204         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  92
* EL6318.cbl
  5205
  5206     12  MA-PROFILE-INFO.
  5207         16  MA-QUALIFY-CODE-1             PIC XX.
  5208         16  MA-QUALIFY-CODE-2             PIC XX.
  5209         16  MA-QUALIFY-CODE-3             PIC XX.
  5210         16  MA-QUALIFY-CODE-4             PIC XX.
  5211         16  MA-QUALIFY-CODE-5             PIC XX.
  5212
  5213         16  MA-INSURED-LAST-NAME          PIC X(15).
  5214         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5215         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5216         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5217         16  MA-INSURED-BIRTH-DT           PIC XX.
  5218         16  MA-INSURED-SEX                PIC X.
  5219             88  MA-SEX-MALE                   VALUE 'M'.
  5220             88  MA-SEX-FEMALE                 VALUE 'F'.
  5221         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5222
  5223         16  MA-ADDRESS-CORRECTED          PIC X.
  5224         16  MA-JOINT-BIRTH-DT             PIC XX.
  5225*        16  FILLER                        PIC X(12).
  5226
  5227         16  MA-ADDRESS-LINE-1             PIC X(30).
  5228         16  MA-ADDRESS-LINE-2             PIC X(30).
  5229         16  MA-CITY-STATE.
  5230             20  MA-CITY                   PIC X(28).
  5231             20  MA-ADDR-STATE             PIC XX.
  5232         16  MA-ZIP.
  5233             20  MA-ZIP-CODE.
  5234                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5235                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5236                 24  FILLER                PIC X(4).
  5237             20  MA-ZIP-PLUS4              PIC X(4).
  5238         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5239             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5240             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5241             20  FILLER                    PIC X(3).
  5242
  5243         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5244
  5245         16  FILLER                        PIC XXX.
  5246*        16  FILLER                        PIC X(10).
  5247
  5248     12  MA-CRED-BENE-INFO.
  5249         16  MA-CRED-BENE-NAME                 PIC X(25).
  5250         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5251         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5252         16  MA-CRED-BENE-CTYST.
  5253             20  MA-CRED-BENE-CITY             PIC X(28).
  5254             20  MA-CRED-BENE-STATE            PIC XX.
  5255         16  MA-CRED-BENE-ZIP.
  5256             20  MA-CB-ZIP-CODE.
  5257                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5258                     88  MA-CB-CANADIAN-POST-CODE
  5259                                           VALUE 'A' THRU 'Z'.
  5260                 24  FILLER                    PIC X(4).
  5261             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5262         16  MA-CB-CANADIAN-POSTAL-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  93
* EL6318.cbl
  5263                            REDEFINES MA-CRED-BENE-ZIP.
  5264             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5265             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5266             20  FILLER                        PIC X(3).
  5267     12  MA-POST-CARD-MAIL-DATA.
  5268         16  MA-MAIL-DATA OCCURS 7.
  5269             20  MA-MAIL-TYPE              PIC X.
  5270                 88  MA-12MO-MAILING           VALUE '1'.
  5271                 88  MA-EXP-MAILING            VALUE '2'.
  5272             20  MA-MAIL-STATUS            PIC X.
  5273                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5274                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5275                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5276             20  MA-MAIL-DATE              PIC XX.
  5277     12  FILLER                            PIC XX.
  5278     12  FILLER                            PIC XX.
  5279*    12  FILLER                            PIC X(30).
  5280******************************************************************
  5281*                                COPY ERCARCH.
  5282******************************************************************
  5283*                                                                *
  5284*                            ERCARCH.                            *
  5285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5286*                            VMOD=2.002                          *
  5287*                                                                *
  5288*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5289*                                                                *
  5290*   FILE TYPE = VSAM,KSDS                                        *
  5291*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5292*                                                                *
  5293*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5294*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5295*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5296*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5297*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5298*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5299*                                                                *
  5300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5301******************************************************************
  5302*                   C H A N G E   L O G
  5303*
  5304* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5305*-----------------------------------------------------------------
  5306*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5307* EFFECTIVE    NUMBER
  5308*-----------------------------------------------------------------
  5309* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5310* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5311* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5312******************************************************************
  5313 01  LETTER-ARCHIVE.
  5314     12  LA-RECORD-ID                PIC  X(02).
  5315         88  LA-VALID-ID                VALUE 'LA'.
  5316
  5317     12  LA-CONTROL-PRIMARY.
  5318         16  LA-COMPANY-CD           PIC  X(01).
  5319         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5320
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  94
* EL6318.cbl
  5321     12  LA-CONTROL-BY-CERT-RESP.
  5322         16  LA-COMPANY-CD-A2        PIC  X(01).
  5323         16  LA-CERT-NO-A2.
  5324             20  LA-CERT-PRIME-A2    PIC  X(10).
  5325             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5326         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5327             20  LA-RESP-PERSON-A2   PIC  X(10).
  5328             20  LA-TYPE-A2          PIC  X(01).
  5329         16  LA-CARRIER-A2           PIC  X(01).
  5330         16  LA-GROUPING-A2          PIC  X(06).
  5331         16  LA-STATE-A2             PIC  X(02).
  5332         16  LA-ACCOUNT-A2           PIC  X(10).
  5333         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5334         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5335
  5336     12  LA-CONTROL-BY-FORM.
  5337         16  LA-COMPANY-CD-A3        PIC  X(01).
  5338         16  LA-FORM-A3              PIC  X(04).
  5339         16  LA-CARRIER-A3           PIC  X(01).
  5340         16  LA-GROUPING-A3          PIC  X(06).
  5341         16  LA-STATE-A3             PIC  X(02).
  5342         16  LA-ACCOUNT-A3           PIC  X(10).
  5343         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5344
  5345     12  LA-CONTROL-BY-PROCESSOR.
  5346         16  LA-COMPANY-CD-A4        PIC  X(01).
  5347         16  LA-PROCESSOR-CD         PIC  X(04).
  5348         16  LA-CARRIER-A4           PIC  X(01).
  5349         16  LA-GROUPING-A4          PIC  X(06).
  5350         16  LA-STATE-A4             PIC  X(02).
  5351         16  LA-ACCOUNT-A4           PIC  X(10).
  5352         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5353
  5354     12  LA-CONTROL-BY-KEY-FIELDS.
  5355         16  LA-COMPANY-CD-A5        PIC  X(01).
  5356         16  LA-CARRIER-A5           PIC  X(01).
  5357         16  LA-GROUPING-A5          PIC  X(06).
  5358         16  LA-STATE-A5             PIC  X(02).
  5359         16  LA-ACCOUNT-A5           PIC  X(10).
  5360         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5361
  5362     12  LA-CONTROL-BY-GROUP-CODE.
  5363         16  LA-COMPANY-CD-A6        PIC  X(01).
  5364         16  LA-ENTRY-A6.
  5365             20  LA-FILLER           PIC  X(02).
  5366             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5367         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5368
  5369     12  FILLER                      PIC  X(09).
  5370
  5371     12  LA-HEADER-RECORD.
  5372         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5373         16  LA-CREATION-DATE        PIC  X(02).
  5374         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5375         16  LA-FINAL-ACT-DATE       REDEFINES
  5376               LA-FOLLOW-UP-DATE     PIC  X(02).
  5377         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5378         16  LA-NO-OF-COPIES         PIC S9(01).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  95
* EL6318.cbl
  5379         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5380         16  LA-REPLY-DATE           PIC  X(02).
  5381         16  LA-RESEND-DATES.
  5382             20  LA-RESEND-DATE      PIC  X(02).
  5383             20  LA-SENT-DATE        PIC  X(02).
  5384             20  FILLER              PIC  X(08).
  5385         16  LA-SOURCE-INFORMATION.
  5386             20  LA-DATA-SOURCE      PIC  X(01).
  5387             20  LA-ADDR-SOURCE      PIC  X(01).
  5388         16  LA-STATUS               PIC  X(01).
  5389             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5390             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5391             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5392             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5393             88  LA-STATUS-PURGED         VALUE 'P'.
  5394             88  LA-STATUS-VOIDED         VALUE 'V'.
  5395         16  LA-LAST-RESENT-PRINT-DATE
  5396                                     PIC  X(02).
  5397         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5398             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5399                                          VALUE 'C'.
  5400             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5401                                          VALUE 'F'.
  5402             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5403                                          VALUE 'P'.
  5404         16  LA-PURGED-DATE          PIC  X(02).
  5405         16  LA-VOIDED-DATE          PIC  X(02).
  5406         16  LA-RESEND-LETR          PIC  X(4).
  5407         16  FILLER                  PIC  X(08).
  5408*        16  LA-RESEND-LETR-2        PIC  X(4).
  5409*        16  LA-RESEND-LETR-3        PIC  X(4).
  5410*        16  FILLER                  PIC  X(59).
  5411         16  LA-ARCHIVE-STATUS       PIC  X.
  5412             88  LA-TEMP                VALUE 'T'.
  5413             88  LA-QWS                 VALUE 'Q'.
  5414             88  LA-BATCH               VALUE 'B'.
  5415         16  LA-FINAL-ACT-IND        PIC  X(1).
  5416         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5417         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5418         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5419                                     PIC X(4).
  5420         16  FILLER                  PIC  X(42).
  5421*        16  FILLER                  PIC  X(71).
  5422         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5423         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5424         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5425                                     PIC  X(4).
  5426         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5427
  5428******************************************************************
  5429*                                COPY ERCCNOT.
  5430******************************************************************
  5431*                                                                *
  5432*                            ERCCNOT                             *
  5433*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5434*                            VMOD=2.003                          *
  5435*                                                                *
  5436*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  96
* EL6318.cbl
  5437*                                                                *
  5438*        FILE TYPE= VSAM,KSDS                                    *
  5439*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5440*                                                                *
  5441*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5442*                                                                *
  5443*        LOG = YES                                               *
  5444*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5445*                                                                *
  5446******************************************************************
  5447*                   C H A N G E   L O G
  5448*
  5449* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5450*-----------------------------------------------------------------
  5451*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5452* EFFECTIVE    NUMBER
  5453*-----------------------------------------------------------------
  5454* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5455******************************************************************
  5456
  5457 01  CERT-NOTE-FILE.
  5458     12  CZ-RECORD-ID                PIC  XX.
  5459         88  VALID-CZ-ID                  VALUE 'CZ'.
  5460
  5461     12  CZ-CONTROL-PRIMARY.
  5462         16  CZ-COMPANY-CD           PIC X.
  5463         16  CZ-CARRIER              PIC X.
  5464         16  CZ-GROUPING.
  5465             20 CZ-GROUPING-PREFIX   PIC XXX.
  5466             20 CZ-GROUPING-PRIME    PIC XXX.
  5467         16  CZ-STATE                PIC XX.
  5468         16  CZ-ACCOUNT.
  5469             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5470             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5471         16  CZ-CERT-EFF-DT          PIC XX.
  5472         16  CZ-CERT-NO.
  5473             20  CZ-CERT-PRIME       PIC X(10).
  5474             20  CZ-CERT-SFX         PIC X.
  5475         16  CZ-RECORD-TYPE          PIC X.
  5476             88  CERT-NOTE           VALUE '1'.
  5477             88  CLAIM-CERT-NOTE     VALUE '2'.
  5478         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5479
  5480     12  CZ-LAST-MAINT-DT            PIC XX.
  5481     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5482     12  CZ-LAST-MAINT-USER          PIC X(4).
  5483
  5484     12  CZ-NOTE-INFORMATION.
  5485         16  CZ-NOTE                 PIC X(63).
  5486         16  FILLER                  PIC X(39).
  5487******************************************************************
  5488*                                COPY ELCEOBC.
  5489******************************************************************
  5490*                                                                *
  5491*                                                                *
  5492*                            ELCEOBC                             *
  5493*                            VMOD=2.001                          *
  5494*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  97
* EL6318.cbl
  5495*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5496*                                                                *
  5497*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5498*   VSAM EOB CODE TABLE                                          *
  5499*                                                                *
  5500*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5501*                                                                *
  5502*   FILE TYPE = VSAM,KSDS                                        *
  5503*   RECORD SIZE = 350   RECFORM = FIX                            *
  5504*                                                                *
  5505*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5506*                                                                *
  5507*   LOG = NO                                                     *
  5508*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5509*                                                                *
  5510*                                                                *
  5511******************************************************************
  5512*                   C H A N G E   L O G
  5513*
  5514* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5515*-----------------------------------------------------------------
  5516*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5517* EFFECTIVE    NUMBER
  5518*-----------------------------------------------------------------
  5519* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5520* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5521******************************************************************
  5522 01  EOB-CODES.
  5523     12  EO-RECORD-ID                      PIC XX.
  5524         88  VALID-DN-ID                      VALUE 'EO'.
  5525     12  EO-CONTROL-PRIMARY.
  5526         16  EO-COMPANY-CD                 PIC X.
  5527         16  EO-RECORD-TYPE                PIC X.
  5528             88  EO-EOB-RECS                  VALUE '1'.
  5529             88  EO-VERIF-RECS                VALUE '2'.
  5530             88  EO-GCE-RECS                  VALUE '3'.
  5531         16  EO-EOB-CODE                   PIC X(4).
  5532         16  FILLER                        PIC X(9).
  5533     12  EO-MAINT-INFORMATION.
  5534         16  EO-LAST-MAINT-DT              PIC XX.
  5535         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5536         16  EO-LAST-MAINT-USER            PIC X(4).
  5537         16  FILLER                        PIC XX.
  5538     12  EO-DESCRIPTION                    PIC X(275).
  5539     12  FILLER                            PIC X(46).
  5540******************************************************************
  5541*                                COPY ELCCRTT.
  5542******************************************************************
  5543*                                                                *
  5544*                            ELCCRTT.                            *
  5545*                                                                *
  5546*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5547*                                                                *
  5548*   FILE TYPE = VSAM,KSDS                                        *
  5549*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5550*                                                                *
  5551*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5552*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  98
* EL6318.cbl
  5553*   LOG = YES                                                    *
  5554*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5555******************************************************************
  5556*                   C H A N G E   L O G
  5557*
  5558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5559*-----------------------------------------------------------------
  5560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5561* EFFECTIVE    NUMBER
  5562*-----------------------------------------------------------------
  5563* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5564* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5565* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5566* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5567******************************************************************
  5568
  5569 01  CERTIFICATE-TRAILERS.
  5570     12  CS-RECORD-ID                      PIC XX.
  5571         88  VALID-CS-ID                      VALUE 'CS'.
  5572
  5573     12  CS-CONTROL-PRIMARY.
  5574         16  CS-COMPANY-CD                 PIC X.
  5575         16  CS-CARRIER                    PIC X.
  5576         16  CS-GROUPING                   PIC X(6).
  5577         16  CS-STATE                      PIC XX.
  5578         16  CS-ACCOUNT                    PIC X(10).
  5579         16  CS-CERT-EFF-DT                PIC XX.
  5580         16  CS-CERT-NO.
  5581             20  CS-CERT-PRIME             PIC X(10).
  5582             20  CS-CERT-SFX               PIC X.
  5583         16  CS-TRAILER-TYPE               PIC X.
  5584             88  COMM-TRLR           VALUE 'A'.
  5585             88  FUTURE-TRLR         VALUE 'B'.
  5586             88  CERT-DATA-TRLR      VALUE 'C'.
  5587
  5588     12  CS-DATA-AREA                      PIC X(516).
  5589
  5590     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5591         16  CS-BANK-COMMISSION-AREA.
  5592             20  CS-BANK-COMMS       OCCURS 10.
  5593                 24  CS-AGT                PIC X(10).
  5594                 24  CS-COM-TYP            PIC X.
  5595                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5596                 24  CS-RECALC-LV-INDIC    PIC X.
  5597                 24  FILLER                PIC X(10).
  5598         16  FILLER                        PIC X(256).
  5599
  5600     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5601         16  CS-VIN-NUMBER                 PIC X(17).
  5602         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5603         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5604         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5605         16  FILLER                        PIC X(496).
  5606******************************************************************
  5607 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5608                          ACCOUNT-MASTER CONTROL-FILE
  5609                          PENDING-BUSINESS CERTIFICATE-MASTER
  5610                          ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page  99
* EL6318.cbl
  5611                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5612                          MAILING-DATA LETTER-ARCHIVE
  5613                          CERT-NOTE-FILE EOB-CODES
  5614                          CERTIFICATE-TRAILERS.
  5615 0000-DFHEXIT SECTION.
  5616     MOVE '9#                    $   ' TO DFHEIV0.
  5617     MOVE 'EL6318' TO DFHEIV1.
  5618     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5619     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5620     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5621     MOVE '5'                    TO DC-OPTION-CODE
  5622     PERFORM 9700-DATE-LINK
  5623     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5624     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5625     MOVE EIBTRMID               TO QID-TERM
  5626     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5627     IF EIBCALEN = 0
  5628        GO TO 8800-UNAUTHORIZED-ACCESS
  5629     END-IF
  5630     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5631     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5632        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5633           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5634           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5635           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5636           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5637           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5638           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5639           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5640           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5641           MOVE LOW-VALUES           TO EL631KI
  5642           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5643           GO TO 0350-BUILD-INIT-MAP
  5644        END-IF
  5645     END-IF
  5646     IF PI-CALLING-PROGRAM = 'EL614'
  5647        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5648                                 TO WS-PASSED-REASON-CODES
  5649        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5650        IF WS-PASSED-REASON-CODES NOT = SPACES
  5651           MOVE 'Y'                TO WS-SET-CODES-MDT
  5652        ELSE
  5653           MOVE 'N'                TO WS-SET-CODES-MDT
  5654        END-IF
  5655        PERFORM 0600-RECOVER-TEMP-STORAGE
  5656                                 THRU 0600-EXIT
  5657        GO TO 0350-BUILD-INIT-MAP
  5658     END-IF
  5659     IF EIBAID = DFHCLEAR
  5660        IF PI-CLEAR-ERROR
  5661           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5662           MOVE ER-3833           TO EMI-ERROR
  5663           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5664           GO TO 0350-BUILD-INIT-MAP
  5665        ELSE
  5666           GO TO 9400-CLEAR
  5667        END-IF
  5668     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 100
* EL6318.cbl
  5669     .
  5670 0200-RECEIVE.
  5671     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5672        MOVE ER-0008             TO EMI-ERROR
  5673        PERFORM 9900-ERROR-FORMAT
  5674                                 THRU 9900-EXIT
  5675        MOVE -1                  TO PFENTRL
  5676        GO TO 8100-SEND-INITIAL-MAP
  5677     END-IF
  5678
  5679* EXEC CICS RECEIVE
  5680*        MAP      (MAP-NAME)
  5681*        MAPSET   (MAPSET-NAME)
  5682*        INTO     (EL631KI)
  5683*    END-EXEC
  5684     MOVE LENGTH OF
  5685      EL631KI
  5686       TO DFHEIV11
  5687*    MOVE '8"T I  L              ''   #00005674' TO DFHEIV0
  5688     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5690     MOVE X'2020233030303035363734' TO DFHEIV0(25:11)
  5691     CALL 'kxdfhei1' USING DFHEIV0,
  5692           MAP-NAME,
  5693           EL631KI,
  5694           DFHEIV11,
  5695           MAPSET-NAME,
  5696           DFHEIV99,
  5697           DFHEIV99
  5698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5699     IF PFENTRL = 0
  5700         GO TO 0300-CHECK-PFKEYS
  5701     END-IF
  5702     IF EIBAID NOT = DFHENTER
  5703         MOVE ER-0004            TO EMI-ERROR
  5704         GO TO 0320-INPUT-ERROR
  5705     END-IF
  5706     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5707        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5708     ELSE
  5709        MOVE ER-0029            TO EMI-ERROR
  5710        GO TO 0320-INPUT-ERROR
  5711     END-IF
  5712     .
  5713 0300-CHECK-PFKEYS.
  5714     IF EIBAID = DFHPF3
  5715        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5716        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5717        MOVE 'EL614'             TO PGM-NAME
  5718        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5719        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5720        move +1                  to s2
  5721        perform varying s1 from +1 by +1 until s1 > +12
  5722           if reacd-in (s1) not = spaces and low-values
  5723              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5724              add +5 to s2
  5725           end-if
  5726        END-perform
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 101
* EL6318.cbl
  5727        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5728        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5729        GO TO 9300-XCTL
  5730     END-IF
  5731     IF EIBAID = DFHPF4 OR DFHPF8
  5732        GO TO 0360-FINALIZE
  5733     END-IF
  5734     IF EIBAID = DFHPF23
  5735        IF PI-CLEAR-ERROR
  5736           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5737           MOVE ER-3833           TO EMI-ERROR
  5738           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5739           GO TO 0350-BUILD-INIT-MAP
  5740        ELSE
  5741           GO TO 8810-PF23
  5742        END-IF
  5743     END-IF
  5744     IF EIBAID = DFHPF24
  5745        IF PI-CLEAR-ERROR
  5746           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5747           MOVE ER-3833           TO EMI-ERROR
  5748           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5749           GO TO 0350-BUILD-INIT-MAP
  5750        ELSE
  5751           GO TO 9200-RETURN-MAIN-MENU
  5752        END-IF
  5753     END-IF
  5754     IF EIBAID = DFHPF12
  5755        GO TO 9500-PF12
  5756     END-IF
  5757     IF EIBAID = DFHENTER
  5758        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5759        GO TO 0325-EDIT-SCREEN
  5760     END-IF
  5761     MOVE ER-0029                TO EMI-ERROR
  5762     .
  5763 0320-INPUT-ERROR.
  5764     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5765     MOVE AL-UNBON               TO PFENTRA
  5766     MOVE -1                     TO PFENTRL
  5767     GO TO 8200-SEND-DATAONLY
  5768     .
  5769 0325-EDIT-SCREEN.
  5770     IF PRTSWL > ZEROS
  5771       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5772*          MOVE AL-UANON       TO PRTSWA
  5773*          IF PRTSWI = ' '
  5774*             MOVE 'N'         TO PRTSWI
  5775              MOVE 'P'         TO PRTSWI
  5776*          END-IF
  5777*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5778        END-IF
  5779     END-IF
  5780     IF (SIGREQL > ZEROS)
  5781        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5782        MOVE AL-UANON         TO SIGREQA
  5783        IF SIGREQI = ' '
  5784           MOVE 'N'           TO SIGREQI
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 102
* EL6318.cbl
  5785        END-IF
  5786        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5787     ELSE
  5788        MOVE ER-2651          TO EMI-ERROR
  5789        MOVE -1               TO SIGREQL
  5790        MOVE AL-UABON         TO SIGREQA
  5791        PERFORM 9900-ERROR-FORMAT
  5792                                 THRU 9900-EXIT
  5793     END-IF
  5794     IF LTRIDL > ZEROS
  5795        AND LTRIDI > SPACES
  5796        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5797        MOVE LTRIDI              TO LETR-LETTER-ID
  5798                                    PI-LTRID-ENTERED
  5799        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5800        MOVE SPACES              TO LETR-FILLER
  5801        MOVE 0                   TO LETR-SEQ-NO
  5802        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5803     ELSE
  5804        MOVE ER-1236          TO EMI-ERROR
  5805        MOVE -1               TO LTRIDL
  5806        MOVE AL-UABON         TO LTRIDA
  5807        PERFORM 9900-ERROR-FORMAT
  5808                                 THRU 9900-EXIT
  5809     END-IF
  5810
  5811     IF W-PROMPT-LETTER EQUAL 'Y'
  5812         MOVE ER-0894            TO EMI-ERROR
  5813         MOVE -1                 TO LTRIDL
  5814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5815     END-IF
  5816     IF VOUCHL > ZEROS
  5817        IF VOUCHI = 'Y' OR 'N'
  5818           MOVE AL-UANON         TO VOUCHA
  5819           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5820        ELSE
  5821           MOVE ER-9999          TO EMI-ERROR
  5822           MOVE -1               TO VOUCHL
  5823           MOVE AL-UABON         TO VOUCHA
  5824           PERFORM 9900-ERROR-FORMAT
  5825                                 THRU 9900-EXIT
  5826        END-IF
  5827     END-IF
  5828     IF HLTHAPPL > ZEROS
  5829        IF HLTHAPPI = 'Y' OR 'N'
  5830           MOVE AL-UANON         TO HLTHAPPA
  5831           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  5832        ELSE
  5833           MOVE ER-9999          TO EMI-ERROR
  5834           MOVE -1               TO HLTHAPPL
  5835           MOVE AL-UABON         TO HLTHAPPA
  5836           PERFORM 9900-ERROR-FORMAT
  5837                                 THRU 9900-EXIT
  5838        END-IF
  5839     END-IF
  5840     IF PAYEEL > ZEROS
  5841        IF PAYEEI > SPACES
  5842           MOVE AL-UANON         TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 103
* EL6318.cbl
  5843           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5844        ELSE
  5845           MOVE ER-9999          TO EMI-ERROR
  5846           MOVE -1               TO PAYEEL
  5847           MOVE AL-UABON         TO PAYEEA
  5848           PERFORM 9900-ERROR-FORMAT
  5849                                 THRU 9900-EXIT
  5850        END-IF
  5851     END-IF
  5852     IF CERTIDL > ZEROS
  5853         IF CERTIDI NUMERIC
  5854            MOVE AL-UANON      TO CERTIDA
  5855            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5856         ELSE
  5857            MOVE ER-1778       TO EMI-ERROR
  5858            MOVE -1            TO CERTIDL
  5859            MOVE AL-UABON      TO CERTIDA
  5860            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5861        END-IF
  5862     ELSE
  5863        IF PI-PRINT-CERTIFICATE = 'Y'
  5864            MOVE ER-0715       TO EMI-ERROR
  5865            MOVE -1            TO CERTIDL
  5866            MOVE AL-UABON      TO CERTIDA
  5867            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5868        END-IF
  5869     END-IF
  5870     SET REASONS-NOT-FOUND TO TRUE
  5871     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5872        IF REACDL (S1) = +4 OR
  5873          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5874              MOVE AL-SANON     TO REACDA (S1)
  5875              SET REASONS-FOUND TO TRUE
  5876        END-IF
  5877     END-PERFORM
  5878
  5879     IF REASONS-NOT-FOUND
  5880        MOVE ER-1820             TO EMI-ERROR
  5881        MOVE -1                  TO PFENTRL
  5882        PERFORM 9900-ERROR-FORMAT
  5883                                 THRU 9900-EXIT
  5884     ELSE
  5885        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5886     END-IF
  5887
  5888     IF CRTNT1L > ZEROS
  5889        IF CRTNT1I > SPACES
  5890           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5891        END-IF
  5892     END-IF
  5893
  5894     IF CRTNT2L > ZEROS
  5895        IF CRTNT2I > SPACES
  5896           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5897        END-IF
  5898     END-IF
  5899
  5900     IF CRTNT3L > ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 104
* EL6318.cbl
  5901        IF CRTNT3I > SPACES
  5902           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  5903        END-IF
  5904     END-IF
  5905
  5906     IF CRTNT4L > ZEROS
  5907        IF CRTNT4I > SPACES
  5908           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  5909        END-IF
  5910     END-IF
  5911
  5912     IF BILNT1L > ZEROS
  5913        IF BILNT1I > SPACES
  5914           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5915        END-IF
  5916     END-IF
  5917
  5918     IF BILNT2L > ZEROS
  5919        IF BILNT2I > SPACES
  5920           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5921        END-IF
  5922     END-IF
  5923
  5924     .
  5925 0325-EXIT.
  5926     EXIT.
  5927
  5928 0326-GET-Z-RECORD.
  5929
  5930     MOVE SPACES  TO W-Z-CONTROL-DATA
  5931
  5932
  5933* EXEC CICS STARTBR
  5934*         DATASET    ('ELLETR')
  5935*         RIDFLD     (ELLETR-KEY)
  5936*         GTEQ
  5937*         RESP      (WS-RESPONSE)
  5938*    END-EXEC.
  5939     MOVE 'ELLETR' TO DFHEIV1
  5940     MOVE 0
  5941       TO DFHEIV11
  5942*    MOVE '&,         G          &  N#00005912' TO DFHEIV0
  5943     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5944     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5945     MOVE X'204E233030303035393132' TO DFHEIV0(25:11)
  5946     CALL 'kxdfhei1' USING DFHEIV0,
  5947           DFHEIV1,
  5948           ELLETR-KEY,
  5949           DFHEIV99,
  5950           DFHEIV11,
  5951           DFHEIV99
  5952     MOVE EIBRESP  TO WS-RESPONSE
  5953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5954
  5955     IF NOT RESP-NORMAL
  5956         MOVE ER-1236          TO EMI-ERROR
  5957         MOVE -1               TO LTRIDL
  5958         MOVE AL-UABON         TO LTRIDA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 105
* EL6318.cbl
  5959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5960         GO TO 0326-ENDBR
  5961     END-IF.
  5962
  5963 0326-READNEXT.
  5964
  5965
  5966* EXEC CICS READNEXT
  5967*        DATASET   ('ELLETR')
  5968*        INTO      (TEXT-FILES)
  5969*        RIDFLD    (ELLETR-KEY)
  5970*        RESP      (WS-RESPONSE)
  5971*    END-EXEC
  5972     MOVE LENGTH OF
  5973      TEXT-FILES
  5974       TO DFHEIV12
  5975     MOVE 'ELLETR' TO DFHEIV1
  5976     MOVE 0
  5977       TO DFHEIV11
  5978*    MOVE '&.IL                  )  N#00005928' TO DFHEIV0
  5979     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5980     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5981     MOVE X'204E233030303035393238' TO DFHEIV0(25:11)
  5982     CALL 'kxdfhei1' USING DFHEIV0,
  5983           DFHEIV1,
  5984           TEXT-FILES,
  5985           DFHEIV12,
  5986           ELLETR-KEY,
  5987           DFHEIV99,
  5988           DFHEIV11,
  5989           DFHEIV99,
  5990           DFHEIV99
  5991     MOVE EIBRESP  TO WS-RESPONSE
  5992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5993     IF RESP-NORMAL
  5994        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5995           MOVE ER-1236          TO EMI-ERROR
  5996           MOVE -1               TO LTRIDL
  5997           MOVE AL-UABON         TO LTRIDA
  5998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5999           GO TO 0326-ENDBR
  6000        END-IF
  6001
  6002        MOVE AL-UANON         TO LTRIDA
  6003        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6004           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6005        ELSE
  6006           GO TO 0326-READNEXT
  6007        END-IF
  6008     ELSE
  6009        MOVE ER-1236          TO EMI-ERROR
  6010        MOVE -1               TO LTRIDL
  6011        MOVE AL-UABON         TO LTRIDA
  6012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6013        GO TO 0326-ENDBR
  6014     END-IF.
  6015
  6016     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 106
* EL6318.cbl
  6017
  6018 0326-ENDBR.
  6019
  6020
  6021* EXEC CICS ENDBR
  6022*        DATASET     ('ELLETR')
  6023*    END-EXEC.
  6024     MOVE 'ELLETR' TO DFHEIV1
  6025     MOVE 0
  6026       TO DFHEIV11
  6027*    MOVE '&2                    $   #00005961' TO DFHEIV0
  6028     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6029     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6030     MOVE X'2020233030303035393631' TO DFHEIV0(25:11)
  6031     CALL 'kxdfhei1' USING DFHEIV0,
  6032           DFHEIV1,
  6033           DFHEIV11,
  6034           DFHEIV99
  6035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6036
  6037
  6038 0326-EXIT.
  6039      EXIT.
  6040 0330-CHECK-ERRORS.
  6041     IF EMI-NO-ERRORS
  6042        GO TO 0350-BUILD-INIT-MAP
  6043     ELSE
  6044        GO TO 8200-SEND-DATAONLY
  6045     END-IF
  6046     .
  6047 0330-EXIT.
  6048     EXIT.
  6049 0350-BUILD-INIT-MAP.
  6050     MOVE PI-CRTO-CARRIER        TO CARRO
  6051     MOVE PI-CRTO-GROUPING       TO GROUPO
  6052     MOVE PI-CRTO-STATE          TO STATEO
  6053     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6054     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6055     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6056     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6057     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6058     MOVE ' '                    TO DC-OPTION-CODE
  6059     PERFORM 9700-DATE-LINK
  6060     IF NO-CONVERSION-ERROR
  6061        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6062     END-IF
  6063*     IF PI-PRTSW-ENTERED > SPACES
  6064*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6065*        MOVE AL-UANON            TO PRTSWA
  6066*        MOVE +1                  TO PRTSWL
  6067*     END-IF
  6068
  6069     IF PI-SIGREQ-ENTERED > SPACES
  6070        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6071        MOVE AL-UANON            TO SIGREQA
  6072        MOVE +1                  TO SIGREQL
  6073     ELSE
  6074        IF PI-CLAIM-REFORMATION
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 107
* EL6318.cbl
  6075            MOVE 'Y'             TO SIGREQI
  6076            MOVE AL-UANON        TO SIGREQA
  6077            MOVE +1              TO SIGREQL
  6078        END-IF
  6079     END-IF
  6080
  6081     IF PI-LTRID-ENTERED > SPACES
  6082        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6083        MOVE AL-UANON            TO LTRIDA
  6084        MOVE +4                  TO LTRIDL
  6085     ELSE
  6086        IF PI-CLAIM-REFORMATION
  6087            MOVE 'CLRF'          TO LTRIDI
  6088            MOVE AL-UANON        TO LTRIDA
  6089            MOVE +4              TO LTRIDL
  6090        END-IF
  6091     END-IF
  6092
  6093     IF PI-VOUCHER-ENTERED > SPACES
  6094        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6095        MOVE AL-UANON            TO VOUCHA
  6096        MOVE +1                  TO VOUCHL
  6097     END-IF
  6098
  6099     IF PI-HLTHAPP-ENTERED > SPACES
  6100        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6101        MOVE AL-UANON            TO HLTHAPPA
  6102        MOVE +1                  TO HLTHAPPL
  6103     END-IF
  6104
  6105     IF PI-PAYEE-ENTERED > SPACES
  6106        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6107        MOVE AL-UANON            TO PAYEEA
  6108        MOVE +10                 TO PAYEEL
  6109     END-IF
  6110
  6111     IF PI-CERTID-ENTERED > SPACES
  6112        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6113        MOVE AL-UANON            TO CERTIDA
  6114        MOVE +5                  TO CERTIDL
  6115     END-IF
  6116
  6117     SET REASONS-NOT-FOUND TO TRUE
  6118     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6119     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6120        IF REACDL (S1) = +4 OR
  6121          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6122              MOVE AL-SANON      TO REACDA (S1)
  6123              MOVE +4            TO REACDL (S1)
  6124              SET REASONS-FOUND  TO TRUE
  6125        END-IF
  6126     END-PERFORM
  6127
  6128     IF REASONS-NOT-FOUND
  6129         IF PI-CLAIM-REFORMATION
  6130            MOVE 'CRNA'          TO REACD-IN (1)
  6131            MOVE AL-SANON        TO REACDA (1)
  6132            MOVE +4              TO REACDL (1)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 108
* EL6318.cbl
  6133            SET REASONS-FOUND    TO TRUE
  6134        END-IF
  6135     END-IF
  6136
  6137     IF PI-CERTNT1-ENTERED > SPACES
  6138        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6139        MOVE AL-UANON            TO CRTNT1A
  6140        MOVE +63                 TO CRTNT1L
  6141     END-IF
  6142
  6143     IF PI-CERTNT2-ENTERED > SPACES
  6144        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6145        MOVE AL-UANON            TO CRTNT2A
  6146        MOVE +63                 TO CRTNT2L
  6147     END-IF
  6148
  6149     IF PI-CERTNT3-ENTERED > SPACES
  6150        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6151        MOVE AL-UANON            TO CRTNT3A
  6152        MOVE +63                 TO CRTNT3L
  6153     END-IF
  6154
  6155     IF PI-CERTNT4-ENTERED > SPACES
  6156        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6157        MOVE AL-UANON            TO CRTNT4A
  6158        MOVE +63                 TO CRTNT4L
  6159     END-IF
  6160
  6161     IF PI-BILLNT1-ENTERED > SPACES
  6162        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6163        MOVE AL-UANON            TO BILNT1A
  6164        MOVE +63                 TO BILNT1L
  6165     END-IF
  6166
  6167     IF PI-BILLNT2-ENTERED > SPACES
  6168        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6169        MOVE AL-UANON            TO BILNT2A
  6170        MOVE +63                 TO BILNT2L
  6171     END-IF
  6172
  6173     GO TO 8100-SEND-INITIAL-MAP
  6174     .
  6175 0360-FINALIZE.
  6176     display ' made it to 0360 '
  6177     set P to address of KIXSYS
  6178     CALL "getenv" using by value P returning var-ptr
  6179     if var-ptr = null then
  6180        display ' kixsys not set '
  6181     else
  6182        set address of var to var-ptr
  6183        move 0 to env-var-len
  6184        inspect var tallying env-var-len
  6185          for characters before X'00'
  6186*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6187        unstring var (1:env-var-len) delimited by '/'
  6188           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6189              WS-KIX-SYS
  6190        end-unstring
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 109
* EL6318.cbl
  6191*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6192*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6193     end-if
  6194     set P to address of KIXHOST
  6195     CALL "getenv" using by value P returning var-ptr
  6196     if var-ptr = null then
  6197        display ' kixhost not set '
  6198     else
  6199        set address of var to var-ptr
  6200        move 0 to env-var-len
  6201        inspect var tallying env-var-len
  6202          for characters before X'00'
  6203*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6204        MOVE var(1:env-var-len)  to ws-kixhost
  6205        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6206     end-if
  6207     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6208     IF NOT EMI-NO-ERRORS
  6209       AND EIBAID = DFHPF4
  6210        GO TO 8200-SEND-DATAONLY
  6211     END-IF
  6212     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6213     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6214                                    NEW-ELCRTO-KEY
  6215     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6216     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6217     IF RESP-NORMAL
  6218        AND (PI-ELCRTO-KEY = OC-CONTROL-PRIMARY)
  6219        DISPLAY ' RESP NORMAL AND = '
  6220        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6221*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6222        PERFORM 1100-CALL-NS-BUS-LOGIC
  6223                                 THRU 1100-EXIT
  6224        IF BL-OK
  6225           CONTINUE
  6226        ELSE
  6227           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6228           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6229           MOVE -1               TO SIGREQL
  6230        END-IF
  6231     ELSE
  6232        MOVE ER-9999             TO EMI-ERROR
  6233        PERFORM 9900-ERROR-FORMAT
  6234                                 THRU 9900-EXIT
  6235        MOVE -1                  TO SIGREQL
  6236        GO TO 8100-SEND-INITIAL-MAP
  6237     END-IF
  6238     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6239                                 TO SYSO
  6240     MOVE WS-KIXHOST             TO HOSTO
  6241     MOVE PI-COMPANY-ID          TO COMPANYO
  6242     MOVE '4'                    TO DATASORO
  6243     MOVE BL-BATCH-NO            TO BATCHNOO
  6244     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6245     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6246     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6247*    MOVE 'N'                    TO PRTSWO
  6248*    MOVE -1                     TO PRTSWL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 110
* EL6318.cbl
  6249*    MOVE AL-UANON               TO PRTSWA
  6250     MOVE -1                     TO SIGREQL
  6251     MOVE AL-UANON               TO SIGREQA
  6252     IF EIBAID = DFHPF4
  6253        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6254        MOVE ER-0280             TO EMI-ERROR
  6255        PERFORM 9900-ERROR-FORMAT
  6256                                 THRU 9900-EXIT
  6257        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6258        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6259        MOVE 'Y'                 TO PI-FINALIZED-IND
  6260        GO TO 9400-CLEAR
  6261     ELSE
  6262        MOVE ER-1818             TO EMI-ERROR
  6263        PERFORM 9900-ERROR-FORMAT
  6264                                 THRU 9900-EXIT
  6265     END-IF
  6266     GO TO 0350-BUILD-INIT-MAP
  6267     .
  6268 0360-EXIT.
  6269     EXIT.
  6270 0362-READ-ELCRTO.
  6271     display ' made it to 0362 '
  6272
  6273* EXEC CICS READ
  6274*        DATASET   (WS-ELCRTO-FILE-ID)
  6275*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6276*        RIDFLD    (ELCRTO-KEY)
  6277*        RESP      (WS-RESPONSE)
  6278*    END-EXEC
  6279*    MOVE '&"S        E          (  N#00006199' TO DFHEIV0
  6280     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6282     MOVE X'204E233030303036313939' TO DFHEIV0(25:11)
  6283     CALL 'kxdfhei1' USING DFHEIV0,
  6284           WS-ELCRTO-FILE-ID,
  6285           DFHEIV20,
  6286           DFHEIV99,
  6287           ELCRTO-KEY,
  6288           DFHEIV99,
  6289           DFHEIV99,
  6290           DFHEIV99
  6291     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6292         DFHEIV20
  6293     MOVE EIBRESP  TO WS-RESPONSE
  6294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6295     .
  6296 0362-EXIT.
  6297     EXIT.
  6298 0363-READ-ELCRTO-UPD.
  6299     display ' made it to 0363 '
  6300
  6301* EXEC CICS READ
  6302*        DATASET   (WS-ELCRTO-FILE-ID)
  6303*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6304*        RIDFLD    (ELCRTO-KEY)
  6305*        UPDATE
  6306*        RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 111
* EL6318.cbl
  6307*    END-EXEC
  6308*    MOVE '&"S        EU         (  N#00006210' TO DFHEIV0
  6309     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6310     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6311     MOVE X'204E233030303036323130' TO DFHEIV0(25:11)
  6312     CALL 'kxdfhei1' USING DFHEIV0,
  6313           WS-ELCRTO-FILE-ID,
  6314           DFHEIV20,
  6315           DFHEIV99,
  6316           ELCRTO-KEY,
  6317           DFHEIV99,
  6318           DFHEIV99,
  6319           DFHEIV99
  6320     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6321         DFHEIV20
  6322     MOVE EIBRESP  TO WS-RESPONSE
  6323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6324     .
  6325 0363-EXIT.
  6326     EXIT.
  6327 0365-READ-ERENDT.
  6328
  6329* EXEC CICS READ
  6330*        DATASET   (WS-ERENDT-FILE-ID)
  6331*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6332*        RIDFLD    (ERENDT-KEY)
  6333*        RESP      (WS-RESPONSE)
  6334*    END-EXEC
  6335*    MOVE '&"S        E          (  N#00006221' TO DFHEIV0
  6336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6338     MOVE X'204E233030303036323231' TO DFHEIV0(25:11)
  6339     CALL 'kxdfhei1' USING DFHEIV0,
  6340           WS-ERENDT-FILE-ID,
  6341           DFHEIV20,
  6342           DFHEIV99,
  6343           ERENDT-KEY,
  6344           DFHEIV99,
  6345           DFHEIV99,
  6346           DFHEIV99
  6347     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6348         DFHEIV20
  6349     MOVE EIBRESP  TO WS-RESPONSE
  6350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6351     .
  6352 0365-EXIT.
  6353     EXIT.
  6354 0400-ADD-ERENDT.
  6355     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6356     display ' made it to 0400 '
  6357
  6358* EXEC CICS GETMAIN
  6359*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6360*         LENGTH   (ERENDT-LENGTH)
  6361*         INITIMG  (GETMAIN-SPACE)
  6362*    END-EXEC
  6363*    MOVE ',"IL                  $   #00006233' TO DFHEIV0
  6364     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 112
* EL6318.cbl
  6365     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6366     MOVE X'2020233030303036323333' TO DFHEIV0(25:11)
  6367     CALL 'kxdfhei1' USING DFHEIV0,
  6368           DFHEIV20,
  6369           ERENDT-LENGTH,
  6370           GETMAIN-SPACE
  6371     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6372         DFHEIV20
  6373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6374     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6375     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6376     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6377     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6378                                    EN-INPUT-DT
  6379                                    EN-PROCESS-DT
  6380
  6381     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6382     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6383     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6384     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6385     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6386     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6387     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6388     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6389     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6390     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6391     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6392     IF OC-LF-BENCD NOT = '00' AND '  '
  6393        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6394        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6395        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6396        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6397        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6398        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6399        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6400     END-IF
  6401     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6402     IF OC-AH-BENCD NOT = '00' AND '  '
  6403        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6404        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6405        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6406        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6407        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6408        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6409     END-IF
  6410     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6411
  6412* EXEC CICS GETMAIN
  6413*         SET      (ADDRESS OF PENDING-BUSINESS)
  6414*         LENGTH   (ERPNDB-LENGTH)
  6415*         INITIMG  (GETMAIN-SPACE)
  6416*    END-EXEC
  6417*    MOVE ',"IL                  $   #00006275' TO DFHEIV0
  6418     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6419     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6420     MOVE X'2020233030303036323735' TO DFHEIV0(25:11)
  6421     CALL 'kxdfhei1' USING DFHEIV0,
  6422           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 113
* EL6318.cbl
  6423           ERPNDB-LENGTH,
  6424           GETMAIN-SPACE
  6425     SET ADDRESS OF PENDING-BUSINESS TO
  6426         DFHEIV20
  6427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6428     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6429     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6430
  6431* EXEC CICS READ
  6432*        DATASET   (WS-ERPNDB-FILE-ID)
  6433*        INTO      (PENDING-BUSINESS)
  6434*        RIDFLD    (ERPNDB-KEY)
  6435*        RESP      (WS-RESPONSE)
  6436*    END-EXEC
  6437     MOVE LENGTH OF
  6438      PENDING-BUSINESS
  6439       TO DFHEIV11
  6440*    MOVE '&"IL       E          (  N#00006282' TO DFHEIV0
  6441     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6443     MOVE X'204E233030303036323832' TO DFHEIV0(25:11)
  6444     CALL 'kxdfhei1' USING DFHEIV0,
  6445           WS-ERPNDB-FILE-ID,
  6446           PENDING-BUSINESS,
  6447           DFHEIV11,
  6448           ERPNDB-KEY,
  6449           DFHEIV99,
  6450           DFHEIV99,
  6451           DFHEIV99
  6452     MOVE EIBRESP  TO WS-RESPONSE
  6453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6454     IF NOT RESP-NORMAL
  6455        GO TO 0400-EXIT
  6456     END-IF
  6457*    set found-pndb to true
  6458     display ' good read on erpndb '
  6459     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6460                                      NCRTO-INS-FIRST-NAME
  6461     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6462                                      NCRTO-INS-MIDDLE-INIT
  6463     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6464                                      NCRTO-INS-LAST-NAME
  6465     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6466                                      NCRTO-INS-AGE
  6467     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6468                                      NCRTO-JNT-FIRST-NAME
  6469     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6470                                      NCRTO-JNT-MIDDLE-INIT
  6471     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6472                                      NCRTO-JNT-LAST-NAME
  6473     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6474                                      NCRTO-JNT-AGE
  6475     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6476                                      NCRTO-LF-BENCD
  6477     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6478        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6479                                      NCRTO-LF-BEN-AMT
  6480        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 114
* EL6318.cbl
  6481                                      NCRTO-LF-PRM-AMT
  6482        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6483                                      NCRTO-LF-ALT-BEN-AMT
  6484        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6485                                      NCRTO-LF-ALT-PRM-AMT
  6486        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6487                                      NCRTO-LF-TERM
  6488        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6489                                      NCRTO-LF-EXP-DT
  6490        IF PB-I-JOINT-COMMISSION > +0
  6491           MOVE PB-I-JOINT-COMMISSION
  6492                                   TO EN-LF-NEW-COMM-PCT
  6493                                      NCRTO-LF-COMM-PCT
  6494        ELSE
  6495           MOVE PB-I-LIFE-COMMISSION
  6496                                   TO EN-LF-NEW-COMM-PCT
  6497                                      NCRTO-LF-COMM-PCT
  6498        END-IF
  6499     END-IF
  6500     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6501                                      NCRTO-AH-BENCD
  6502     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6503        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6504                                      NCRTO-AH-BEN-AMT
  6505        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6506                                      NCRTO-AH-PRM-AMT
  6507        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6508                                      NCRTO-AH-TERM
  6509        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6510                                      NCRTO-AH-EXP-DT
  6511        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6512                                      NCRTO-AH-CP
  6513        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6514                                      NCRTO-AH-COMM-PCT
  6515     END-IF
  6516     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6517     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6518     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6519     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6520*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6521     MOVE 'Y'                    TO EN-COMM-CHGBK
  6522
  6523     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6524        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6525        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6526        EN-AH-NEW-PRM-AMT)
  6527     COMPUTE EN-ACCT-PORTION ROUNDED =
  6528        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6529        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6530        * EN-LF-NEW-COMM-PCT)
  6531                       +
  6532        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6533        * EN-AH-NEW-COMM-PCT)
  6534     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6535        EN-ACCT-PORTION
  6536     move pb-control-by-account (1:33)
  6537                                 to ws-ermail-key
  6538
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 115
* EL6318.cbl
  6539* EXEC CICS READ
  6540*        DATASET   ('ERMAIL')
  6541*        SET       (ADDRESS OF MAILING-DATA)
  6542*        RIDFLD    (WS-ERMAIL-KEY)
  6543*        RESP      (WS-RESPONSE)
  6544*    END-EXEC
  6545     MOVE 'ERMAIL' TO DFHEIV1
  6546*    MOVE '&"S        E          (  N#00006372' TO DFHEIV0
  6547     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6549     MOVE X'204E233030303036333732' TO DFHEIV0(25:11)
  6550     CALL 'kxdfhei1' USING DFHEIV0,
  6551           DFHEIV1,
  6552           DFHEIV20,
  6553           DFHEIV99,
  6554           WS-ERMAIL-KEY,
  6555           DFHEIV99,
  6556           DFHEIV99,
  6557           DFHEIV99
  6558     SET ADDRESS OF MAILING-DATA TO
  6559         DFHEIV20
  6560     MOVE EIBRESP  TO WS-RESPONSE
  6561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6562     IF RESP-NORMAL
  6563        DISPLAY ' FOUND ERMAIL '
  6564        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6565                                    NCRTO-CRED-BENE-NAME
  6566     ELSE
  6567        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6568     END-IF
  6569
  6570     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6571     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6572
  6573
  6574* EXEC CICS READ
  6575*         DATASET  (WS-ELCRTT-FILE-ID)
  6576*         RIDFLD   (WS-ELCRTT-KEY)
  6577*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6578*         RESP     (WS-RESPONSE)
  6579*    END-EXEC
  6580*    MOVE '&"S        E          (  N#00006389' TO DFHEIV0
  6581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6583     MOVE X'204E233030303036333839' TO DFHEIV0(25:11)
  6584     CALL 'kxdfhei1' USING DFHEIV0,
  6585           WS-ELCRTT-FILE-ID,
  6586           DFHEIV20,
  6587           DFHEIV99,
  6588           WS-ELCRTT-KEY,
  6589           DFHEIV99,
  6590           DFHEIV99,
  6591           DFHEIV99
  6592     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6593         DFHEIV20
  6594     MOVE EIBRESP  TO WS-RESPONSE
  6595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6596
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 116
* EL6318.cbl
  6597     IF RESP-NORMAL
  6598        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6599                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6600        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6601                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6602     END-IF.
  6603     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6604        IF REACD-IN (S1) NOT = LOW-VALUES
  6605           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6606        END-IF
  6607     END-PERFORM
  6608     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6609     MOVE 'G'                    TO EN-DOCU-TYPE
  6610     MOVE 'Y'                    TO EN-MONEY-SW
  6611     MOVE SIGREQI                TO EN-SIG-SW
  6612     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6613     MOVE PAYEEI                 TO EN-PAYEE
  6614     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6615     DISPLAY ' 0400 EXIT '
  6616     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6617     .
  6618 0400-EXIT.
  6619     EXIT.
  6620 0410-INIT-ERENDT.
  6621     display ' made it to 0410 '
  6622     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6623     MOVE ZEROS                  TO ENDT-SEQ-NO
  6624
  6625* EXEC CICS READ
  6626*        DATASET    (WS-ERENDT-FILE-ID)
  6627*        RIDFLD     (ERENDT-KEY)
  6628*        INTO       (ENDORSEMENT-RECORD)
  6629*        RESP       (WS-RESPONSE)
  6630*        GTEQ
  6631*    END-EXEC
  6632     MOVE LENGTH OF
  6633      ENDORSEMENT-RECORD
  6634       TO DFHEIV11
  6635*    MOVE '&"IL       G          (  N#00006423' TO DFHEIV0
  6636     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6638     MOVE X'204E233030303036343233' TO DFHEIV0(25:11)
  6639     CALL 'kxdfhei1' USING DFHEIV0,
  6640           WS-ERENDT-FILE-ID,
  6641           ENDORSEMENT-RECORD,
  6642           DFHEIV11,
  6643           ERENDT-KEY,
  6644           DFHEIV99,
  6645           DFHEIV99,
  6646           DFHEIV99
  6647     MOVE EIBRESP  TO WS-RESPONSE
  6648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6649     IF RESP-NORMAL
  6650        AND (EN-CONTROL-PRIMARY (1:34) =
  6651           OC-CONTROL-PRIMARY (1:34))
  6652        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6653     ELSE
  6654        MOVE +4096               TO WS-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 117
* EL6318.cbl
  6655     END-IF
  6656     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6657     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6658     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6659     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6660     INITIALIZE EN-ISSUE-RECORD
  6661     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6662                                    EN-AH-ORIG-EXP-DT
  6663                                    EN-LF-NEW-EXP-DT
  6664                                    EN-AH-NEW-EXP-DT
  6665                                    EN-PROCESS-DT
  6666     .
  6667 0410-EXIT.
  6668     EXIT.
  6669 0420-UPDATE-ELCRTO.
  6670     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6671     IF RESP-NORMAL
  6672        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6673                                    OC-LAST-MAINT-DT
  6674        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6675        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6676
  6677* EXEC CICS REWRITE
  6678*          FROM     (ORIGINAL-CERTIFICATE)
  6679*          DATASET  ('ELCRTO')
  6680*       END-EXEC
  6681     MOVE LENGTH OF
  6682      ORIGINAL-CERTIFICATE
  6683       TO DFHEIV11
  6684     MOVE 'ELCRTO' TO DFHEIV1
  6685*    MOVE '&& L                  %   #00006457' TO DFHEIV0
  6686     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6687     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6688     MOVE X'2020233030303036343537' TO DFHEIV0(25:11)
  6689     CALL 'kxdfhei1' USING DFHEIV0,
  6690           DFHEIV1,
  6691           ORIGINAL-CERTIFICATE,
  6692           DFHEIV11,
  6693           DFHEIV99
  6694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6695     END-IF
  6696     .
  6697 0420-EXIT.
  6698     EXIT.
  6699
  6700 0425-ADD-NEW-ELCRTO.
  6701     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6702     MOVE 'OC'                   TO OC-RECORD-ID
  6703     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6704     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6705     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6706     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6707     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6708     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6709     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6710     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6711     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6712     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 118
* EL6318.cbl
  6713     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6714     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6715     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6716     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6717     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6718     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6719     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6720     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6721     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6722     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6723     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  6724     MOVE +0                     TO OC-LF-CANCEL-AMT
  6725                                    OC-LF-ITD-CANCEL-AMT
  6726     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6727     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6728     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6729     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6730     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6731     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6732     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6733     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  6734     MOVE +0                     TO OC-AH-CANCEL-AMT
  6735                                    OC-AH-ITD-CANCEL-AMT
  6736     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6737     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6738     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6739     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6740     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  6741     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  6742     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6743     .
  6744 0425-WRITE-ELCRTO.
  6745
  6746
  6747* EXEC CICS WRITE
  6748*       DATASET   ('ELCRTO')
  6749*       FROM      (ORIGINAL-CERTIFICATE)
  6750*       RIDFLD    (OC-CONTROL-PRIMARY)
  6751*       RESP      (WS-RESPONSE)
  6752*    END-EXEC
  6753     MOVE LENGTH OF
  6754      ORIGINAL-CERTIFICATE
  6755       TO DFHEIV11
  6756     MOVE 'ELCRTO' TO DFHEIV1
  6757*    MOVE '&$ L                  ''  N#00006512' TO DFHEIV0
  6758     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6760     MOVE X'204E233030303036353132' TO DFHEIV0(25:11)
  6761     CALL 'kxdfhei1' USING DFHEIV0,
  6762           DFHEIV1,
  6763           ORIGINAL-CERTIFICATE,
  6764           DFHEIV11,
  6765           OC-CONTROL-PRIMARY,
  6766           DFHEIV99,
  6767           DFHEIV99
  6768     MOVE EIBRESP  TO WS-RESPONSE
  6769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6770
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 119
* EL6318.cbl
  6771     display ' just wrote new crto ' ws-response
  6772     IF RESP-DUPKEY
  6773        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6774        GO TO 0425-WRITE-ELCRTO
  6775     ELSE
  6776        IF NOT RESP-NORMAL
  6777           MOVE -1               TO SIGREQL
  6778           MOVE ER-3830          TO EMI-ERROR
  6779           PERFORM 9900-ERROR-FORMAT
  6780                                 THRU 9900-EXIT
  6781        ELSE
  6782           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6783        END-IF
  6784     END-IF
  6785
  6786     .
  6787 0425-EXIT.
  6788     EXIT.
  6789
  6790 0426-ADD-CERT-NOTES.
  6791
  6792     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6793     SET TB-INDX TO 1
  6794
  6795     IF PI-CERTNT1-ENTERED > SPACES
  6796         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6797         MOVE PI-PROCESSOR-ID    TO
  6798                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6799         MOVE EIBTIME            TO
  6800                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6801         MOVE WS-CURRENT-BIN-DT  TO
  6802                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6803         SET TB-INDX UP BY +1
  6804     END-IF
  6805
  6806     IF PI-CERTNT2-ENTERED > SPACES
  6807         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6808         MOVE PI-PROCESSOR-ID    TO
  6809                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6810         MOVE EIBTIME            TO
  6811                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6812         MOVE WS-CURRENT-BIN-DT  TO
  6813                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6814         SET TB-INDX UP BY +1
  6815     END-IF
  6816
  6817     IF PI-CERTNT3-ENTERED > SPACES
  6818         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6819         MOVE PI-PROCESSOR-ID    TO
  6820                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6821         MOVE EIBTIME            TO
  6822                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6823         MOVE WS-CURRENT-BIN-DT  TO
  6824                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6825         SET TB-INDX UP BY +1
  6826     END-IF
  6827
  6828     IF PI-CERTNT4-ENTERED > SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 120
* EL6318.cbl
  6829         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6830         MOVE PI-PROCESSOR-ID    TO
  6831                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6832         MOVE EIBTIME            TO
  6833                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6834         MOVE WS-CURRENT-BIN-DT  TO
  6835                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6836         SET TB-INDX UP BY +1
  6837     END-IF
  6838
  6839     IF CERT-NOTE-ENTRIES > SPACES
  6840         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6841         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6842     END-IF
  6843
  6844     IF PI-BILLNT1-ENTERED > SPACES
  6845         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6846         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6847         MOVE +63 TO WS-LEN
  6848         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6849     END-IF
  6850
  6851     IF PI-BILLNT2-ENTERED > SPACES
  6852         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6853         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6854         MOVE +63 TO WS-LEN
  6855         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6856     END-IF
  6857
  6858     .
  6859 0426-EXIT.
  6860     EXIT.
  6861
  6862 0427-LOAD-CURRENT-CERT-NOTES.
  6863
  6864     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6865     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6866     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6867     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6868     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6869     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6870     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6871     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6872     MOVE '1'                 TO ERCNOT-REC-TYP
  6873     MOVE +0                  TO ERCNOT-SEQ
  6874     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6875
  6876
  6877* EXEC CICS STARTBR
  6878*         DATASET(WS-ERCNOT-FILE-ID)
  6879*         RIDFLD(ERCNOT-KEY)
  6880*         KEYLENGTH(ERCNOT-START-LENGTH)
  6881*         RESP      (WS-RESPONSE)
  6882*         GENERIC
  6883*         GTEQ
  6884*    END-EXEC.
  6885     MOVE 0
  6886       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 121
* EL6318.cbl
  6887*    MOVE '&,   KG    G          &  N#00006624' TO DFHEIV0
  6888     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6889     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6890     MOVE X'204E233030303036363234' TO DFHEIV0(25:11)
  6891     CALL 'kxdfhei1' USING DFHEIV0,
  6892           WS-ERCNOT-FILE-ID,
  6893           ERCNOT-KEY,
  6894           ERCNOT-START-LENGTH,
  6895           DFHEIV11,
  6896           DFHEIV99
  6897     MOVE EIBRESP  TO WS-RESPONSE
  6898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6899
  6900
  6901     IF NOT RESP-NORMAL
  6902        GO TO 0427-ENDBR
  6903     END-IF.
  6904
  6905 0427-LOOP.
  6906
  6907* EXEC CICS READNEXT
  6908*         SET(ADDRESS OF CERT-NOTE-FILE)
  6909*         DATASET(WS-ERCNOT-FILE-ID)
  6910*         RIDFLD(ERCNOT-KEY)
  6911*    END-EXEC.
  6912     MOVE 0
  6913       TO DFHEIV11
  6914*    MOVE '&.S                   )   #00006638' TO DFHEIV0
  6915     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6916     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6917     MOVE X'2020233030303036363338' TO DFHEIV0(25:11)
  6918     CALL 'kxdfhei1' USING DFHEIV0,
  6919           WS-ERCNOT-FILE-ID,
  6920           DFHEIV20,
  6921           DFHEIV99,
  6922           ERCNOT-KEY,
  6923           DFHEIV99,
  6924           DFHEIV11,
  6925           DFHEIV99,
  6926           DFHEIV99
  6927     SET ADDRESS OF CERT-NOTE-FILE TO
  6928         DFHEIV20
  6929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6930
  6931
  6932     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6933         GO TO 0427-ENDBR
  6934     END-IF.
  6935
  6936     IF (CZ-CARRIER = SV-CARRIER)
  6937        AND (CZ-GROUPING = SV-GROUPING)
  6938        AND (CZ-STATE = SV-STATE)
  6939        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6940        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6941        AND (CZ-CERT-NO = SV-CERT-NO)
  6942        AND (CZ-RECORD-TYPE = '1')
  6943          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6944          MOVE CZ-LAST-MAINT-USER TO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 122
* EL6318.cbl
  6945                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6946          MOVE CZ-LAST-MAINT-DT TO
  6947                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6948          MOVE CZ-LAST-MAINT-HHMMSS TO
  6949                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6950          SET TB-INDX UP BY 1
  6951          GO TO 0427-LOOP
  6952     END-IF.
  6953
  6954 0427-ENDBR.
  6955
  6956
  6957* EXEC CICS ENDBR
  6958*         DATASET(WS-ERCNOT-FILE-ID)
  6959*    END-EXEC.
  6960     MOVE 0
  6961       TO DFHEIV11
  6962*    MOVE '&2                    $   #00006668' TO DFHEIV0
  6963     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6964     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6965     MOVE X'2020233030303036363638' TO DFHEIV0(25:11)
  6966     CALL 'kxdfhei1' USING DFHEIV0,
  6967           WS-ERCNOT-FILE-ID,
  6968           DFHEIV11,
  6969           DFHEIV99
  6970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6971
  6972
  6973     .
  6974 0427-EXIT.
  6975     EXIT.
  6976
  6977 0430-WRITE-ERENDT.
  6978     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6979     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6980     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6981
  6982* EXEC CICS WRITE
  6983*         DATASET   (WS-ERENDT-FILE-ID)
  6984*         FROM      (ENDORSEMENT-RECORD)
  6985*         RIDFLD    (EN-CONTROL-PRIMARY)
  6986*         RESP      (WS-RESPONSE)
  6987*    END-EXEC
  6988     MOVE LENGTH OF
  6989      ENDORSEMENT-RECORD
  6990       TO DFHEIV11
  6991*    MOVE '&$ L                  ''  N#00006680' TO DFHEIV0
  6992     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6993     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6994     MOVE X'204E233030303036363830' TO DFHEIV0(25:11)
  6995     CALL 'kxdfhei1' USING DFHEIV0,
  6996           WS-ERENDT-FILE-ID,
  6997           ENDORSEMENT-RECORD,
  6998           DFHEIV11,
  6999           EN-CONTROL-PRIMARY,
  7000           DFHEIV99,
  7001           DFHEIV99
  7002     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 123
* EL6318.cbl
  7003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7004     IF RESP-NORMAL
  7005        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  7006        display ' good write erendt '
  7007        IF EIBAID = DFHPF4
  7008           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7009           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7010           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7011           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7012        END-IF
  7013     ELSE
  7014        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7015        MOVE -1                  TO SIGREQL
  7016        MOVE ER-0132             TO EMI-ERROR
  7017        MOVE AL-UABON            TO SIGREQA
  7018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7019     END-IF
  7020     .
  7021 0430-EXIT.
  7022     EXIT.
  7023
  7024
  7025 0440-ADD-BILLING-NOTE.
  7026
  7027* EXEC CICS GETMAIN
  7028*         SET      (ADDRESS OF EOB-CODES)
  7029*         LENGTH   (ELEOBC-LENGTH)
  7030*         INITIMG  (GETMAIN-SPACE)
  7031*    END-EXEC
  7032*    MOVE ',"IL                  $   #00006708' TO DFHEIV0
  7033     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7034     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7035     MOVE X'2020233030303036373038' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           DFHEIV20,
  7038           ELEOBC-LENGTH,
  7039           GETMAIN-SPACE
  7040     SET ADDRESS OF EOB-CODES TO
  7041         DFHEIV20
  7042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7043
  7044     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7045     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7046     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7047
  7048
  7049* EXEC CICS STARTBR
  7050*        DATASET   ('ELEOBC')
  7051*        RIDFLD    (WS-ELEOBC-KEY)
  7052*        GTEQ
  7053*        RESP      (WS-RESPONSE)
  7054*    END-EXEC
  7055     MOVE 'ELEOBC' TO DFHEIV1
  7056     MOVE 0
  7057       TO DFHEIV11
  7058*    MOVE '&,         G          &  N#00006718' TO DFHEIV0
  7059     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7060     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 124
* EL6318.cbl
  7061     MOVE X'204E233030303036373138' TO DFHEIV0(25:11)
  7062     CALL 'kxdfhei1' USING DFHEIV0,
  7063           DFHEIV1,
  7064           WS-ELEOBC-KEY,
  7065           DFHEIV99,
  7066           DFHEIV11,
  7067           DFHEIV99
  7068     MOVE EIBRESP  TO WS-RESPONSE
  7069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7070
  7071     IF NOT RESP-NORMAL
  7072        GO TO 0440-EXIT
  7073     END-IF
  7074      .
  7075 0440-READNEXT-ELEOBC.
  7076
  7077
  7078* EXEC CICS READNEXT
  7079*       INTO    (EOB-CODES)
  7080*       DATASET ('ELEOBC')
  7081*       RIDFLD  (WS-ELEOBC-KEY)
  7082*       RESP    (WS-RESPONSE)
  7083*    END-EXEC
  7084     MOVE LENGTH OF
  7085      EOB-CODES
  7086       TO DFHEIV12
  7087     MOVE 'ELEOBC' TO DFHEIV1
  7088     MOVE 0
  7089       TO DFHEIV11
  7090*    MOVE '&.IL                  )  N#00006731' TO DFHEIV0
  7091     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7092     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7093     MOVE X'204E233030303036373331' TO DFHEIV0(25:11)
  7094     CALL 'kxdfhei1' USING DFHEIV0,
  7095           DFHEIV1,
  7096           EOB-CODES,
  7097           DFHEIV12,
  7098           WS-ELEOBC-KEY,
  7099           DFHEIV99,
  7100           DFHEIV11,
  7101           DFHEIV99,
  7102           DFHEIV99
  7103     MOVE EIBRESP  TO WS-RESPONSE
  7104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7105
  7106     IF RESP-NORMAL
  7107         IF EO-RECORD-TYPE NOT = '5'
  7108             GO TO 0440-EXIT
  7109         END-IF
  7110     ELSE
  7111         GO TO 0440-EXIT
  7112     END-IF
  7113
  7114     IF EO-RECORD-TYPE = '5' AND
  7115        EO-EOB-CODE = PI-LTRID-ENTERED
  7116           CONTINUE
  7117     ELSE
  7118         GO TO 0440-READNEXT-ELEOBC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 125
* EL6318.cbl
  7119     END-IF
  7120
  7121     MOVE SPACES TO WS-BILLING-NOTE
  7122     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7123     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7124     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7125     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7126     MOVE +25 TO WS-LEN
  7127
  7128     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7129     .
  7130 0440-EXIT.
  7131     EXIT.
  7132
  7133 0441-UPDATE-BILLING-NOTE.
  7134
  7135* EXEC CICS GETMAIN
  7136*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7137*         LENGTH   (ERNOTE-LENGTH)
  7138*         INITIMG  (GETMAIN-SPACE)
  7139*    END-EXEC
  7140*    MOVE ',"IL                  $   #00006766' TO DFHEIV0
  7141     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7142     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7143     MOVE X'2020233030303036373636' TO DFHEIV0(25:11)
  7144     CALL 'kxdfhei1' USING DFHEIV0,
  7145           DFHEIV20,
  7146           ERNOTE-LENGTH,
  7147           GETMAIN-SPACE
  7148     SET ADDRESS OF CERTIFICATE-NOTE TO
  7149         DFHEIV20
  7150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7151
  7152     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7153
  7154
  7155* EXEC CICS READ
  7156*       DATASET    (WS-ERNOTE-FILE-ID)
  7157*       RIDFLD     (WS-ERNOTE-KEY)
  7158*       INTO       (CERTIFICATE-NOTE)
  7159*       RESP       (WS-RESPONSE)
  7160*       UPDATE
  7161*    END-EXEC
  7162     MOVE LENGTH OF
  7163      CERTIFICATE-NOTE
  7164       TO DFHEIV11
  7165*    MOVE '&"IL       EU         (  N#00006774' TO DFHEIV0
  7166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7168     MOVE X'204E233030303036373734' TO DFHEIV0(25:11)
  7169     CALL 'kxdfhei1' USING DFHEIV0,
  7170           WS-ERNOTE-FILE-ID,
  7171           CERTIFICATE-NOTE,
  7172           DFHEIV11,
  7173           WS-ERNOTE-KEY,
  7174           DFHEIV99,
  7175           DFHEIV99,
  7176           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 126
* EL6318.cbl
  7177     MOVE EIBRESP  TO WS-RESPONSE
  7178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7179
  7180     IF RESP-NORMAL
  7181       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7182          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7183       END-IF
  7184       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7185          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7186       END-IF
  7187       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7188           (NOTE-SUB > +10) OR
  7189           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7190                             WS-BILLING-NOTE (1:WS-LEN))
  7191       END-PERFORM
  7192       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7193                              WS-BILLING-NOTE (1:WS-LEN)
  7194
  7195* EXEC CICS UNLOCK
  7196*           DATASET    (WS-ERNOTE-FILE-ID)
  7197*        END-EXEC
  7198*    MOVE '&*                    #   #00006796' TO DFHEIV0
  7199     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7201     MOVE X'2020233030303036373936' TO DFHEIV0(25:11)
  7202     CALL 'kxdfhei1' USING DFHEIV0,
  7203           WS-ERNOTE-FILE-ID,
  7204           DFHEIV99
  7205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7206       ELSE
  7207         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7208           (NOTE-SUB > +10) OR
  7209           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7210         END-PERFORM
  7211         IF (NOTE-SUB < +11)
  7212           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7213              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7214                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7215           ELSE
  7216             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7217              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7218                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7219                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7220             ELSE
  7221               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7222                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7223                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7224                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7225               ELSE
  7226                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7227                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7228                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7229                                       CN-BILLING-START-LINE-NO
  7230                 ELSE
  7231                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7232                 END-IF
  7233               END-IF
  7234             END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 127
* EL6318.cbl
  7235           END-IF
  7236           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7237           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7238           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7239
  7240* EXEC CICS REWRITE
  7241*             DATASET    (WS-ERNOTE-FILE-ID)
  7242*             FROM       (CERTIFICATE-NOTE)
  7243*             RESP       (WS-RESPONSE)
  7244*          END-EXEC
  7245     MOVE LENGTH OF
  7246      CERTIFICATE-NOTE
  7247       TO DFHEIV11
  7248*    MOVE '&& L                  %  N#00006832' TO DFHEIV0
  7249     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7250     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7251     MOVE X'204E233030303036383332' TO DFHEIV0(25:11)
  7252     CALL 'kxdfhei1' USING DFHEIV0,
  7253           WS-ERNOTE-FILE-ID,
  7254           CERTIFICATE-NOTE,
  7255           DFHEIV11,
  7256           DFHEIV99
  7257     MOVE EIBRESP  TO WS-RESPONSE
  7258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7259           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7260         END-IF
  7261       END-IF
  7262     ELSE
  7263        MOVE SPACES              TO CERTIFICATE-NOTE
  7264        MOVE 'CN'                TO CN-RECORD-ID
  7265        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7266                                     WS-ERNOTE-KEY
  7267        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7268                                    CN-BILLING-END-LINE-NO
  7269        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7270        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7271        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7272        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7273
  7274* EXEC CICS WRITE
  7275*          DATASET    (WS-ERNOTE-FILE-ID)
  7276*          FROM       (CERTIFICATE-NOTE)
  7277*          RIDFLD     (WS-ERNOTE-KEY)
  7278*          RESP       (WS-RESPONSE)
  7279*       END-EXEC
  7280     MOVE LENGTH OF
  7281      CERTIFICATE-NOTE
  7282       TO DFHEIV11
  7283*    MOVE '&$ L                  ''  N#00006851' TO DFHEIV0
  7284     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7286     MOVE X'204E233030303036383531' TO DFHEIV0(25:11)
  7287     CALL 'kxdfhei1' USING DFHEIV0,
  7288           WS-ERNOTE-FILE-ID,
  7289           CERTIFICATE-NOTE,
  7290           DFHEIV11,
  7291           WS-ERNOTE-KEY,
  7292           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 128
* EL6318.cbl
  7293           DFHEIV99
  7294     MOVE EIBRESP  TO WS-RESPONSE
  7295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7296
  7297        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7298     END-IF
  7299
  7300     .
  7301 0441-EXIT.
  7302     EXIT.
  7303
  7304
  7305 0442-SQUEEZE-IT-IN.
  7306
  7307     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7308        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7309           NOTE-SUB = +10
  7310           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7311           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7312             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7313             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7314             MOVE +9 TO NOTE-SUB
  7315           END-IF
  7316        END-PERFORM
  7317     ELSE
  7318        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7319           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7320             UNTIL NOTE-SUB = +1
  7321             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7322             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7323                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7324                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7325                MOVE +2          TO NOTE-SUB
  7326             END-IF
  7327           END-PERFORM
  7328        END-IF
  7329     END-IF
  7330
  7331     .
  7332 0442-EXIT.
  7333     EXIT.
  7334
  7335 0445-CERTIFICATE-UPDATE.
  7336    display 'billing note written, updating cert'
  7337     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7338     IF RESP-NORMAL
  7339        EVALUATE CM-NOTE-SW
  7340           WHEN '2'
  7341           WHEN '3'
  7342           WHEN '6'
  7343           WHEN '7'
  7344              SET NO-CERT-RW     TO TRUE
  7345           WHEN ' '
  7346              MOVE '2'           TO CM-NOTE-SW
  7347           WHEN '1'
  7348              MOVE '3'           TO CM-NOTE-SW
  7349           WHEN '4'
  7350              MOVE '6'           TO CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 129
* EL6318.cbl
  7351           WHEN '5'
  7352              MOVE '7'           TO CM-NOTE-SW
  7353        END-EVALUATE
  7354     END-IF
  7355     IF NOT NO-CERT-RW
  7356        PERFORM 1810-REWRITE-ELCERT
  7357                                 THRU 1810-EXIT
  7358     ELSE
  7359
  7360* EXEC CICS UNLOCK
  7361*          DATASET    (WS-ELCERT-FILE-ID)
  7362*       END-EXEC
  7363*    MOVE '&*                    #   #00006920' TO DFHEIV0
  7364     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7365     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7366     MOVE X'2020233030303036393230' TO DFHEIV0(25:11)
  7367     CALL 'kxdfhei1' USING DFHEIV0,
  7368           WS-ELCERT-FILE-ID,
  7369           DFHEIV99
  7370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7371     END-IF
  7372
  7373     .
  7374 0445-EXIT.
  7375     EXIT.
  7376
  7377 0450-GET-ERACCT.
  7378     MOVE ' '                    TO WS-ERACCT-SW
  7379     MOVE ZEROS                  TO WS-CHGBACK
  7380                                    WS-CSO-PORTION
  7381                                    WS-ACCT-PORTION
  7382                                    WS-DIFF
  7383     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7384     IF RESP-NORMAL
  7385        PERFORM 0470-READNEXT-ERACCT
  7386                                 THRU 0470-EXIT
  7387     END-IF
  7388     IF RESP-NORMAL
  7389        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7390           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7391              AND >= AM-EFFECTIVE-DT
  7392              SET ACCT-FOUND TO TRUE
  7393           ELSE
  7394              PERFORM 0470-READNEXT-ERACCT
  7395                                 THRU 0470-EXIT
  7396              IF RESP-NORMAL
  7397                 IF AM-CONTROL-PRIMARY (1:20)
  7398                    = EN-CONTROL-PRIMARY (1:20)
  7399                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7400                       AND >= AM-EFFECTIVE-DT
  7401                       SET ACCT-FOUND TO TRUE
  7402                    END-IF
  7403                 END-IF
  7404              END-IF
  7405           END-IF
  7406        END-IF
  7407     END-IF
  7408     IF ACCT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 130
* EL6318.cbl
  7409        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7410           (AM-COM-TYP (S1) = 'C' OR 'D')
  7411           OR (S1 > +10)
  7412        END-PERFORM
  7413        IF S1 < +11
  7414           MOVE AM-COMM-CHARGEBACK (S1)
  7415                                 TO WS-CHGBACK
  7416        END-IF
  7417     END-IF
  7418    .
  7419 0450-EXIT.
  7420     EXIT.
  7421 0460-STARTBR-ERACCT.
  7422     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7423     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7424     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7425
  7426* EXEC CICS STARTBR
  7427*        DATASET   ('ERACCT')
  7428*        RIDFLD    (WS-ERACCT-KEY)
  7429*        GTEQ
  7430*        RESP      (WS-RESPONSE)
  7431*    END-EXEC
  7432     MOVE 'ERACCT' TO DFHEIV1
  7433     MOVE 0
  7434       TO DFHEIV11
  7435*    MOVE '&,         G          &  N#00006977' TO DFHEIV0
  7436     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7438     MOVE X'204E233030303036393737' TO DFHEIV0(25:11)
  7439     CALL 'kxdfhei1' USING DFHEIV0,
  7440           DFHEIV1,
  7441           WS-ERACCT-KEY,
  7442           DFHEIV99,
  7443           DFHEIV11,
  7444           DFHEIV99
  7445     MOVE EIBRESP  TO WS-RESPONSE
  7446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7447     .
  7448 0460-EXIT.
  7449     EXIT.
  7450 0470-READNEXT-ERACCT.
  7451
  7452* EXEC CICS READNEXT
  7453*       INTO    (ACCOUNT-MASTER)
  7454*       DATASET ('ERACCT')
  7455*       RIDFLD  (WS-ERACCT-KEY)
  7456*       RESP    (WS-RESPONSE)
  7457*    END-EXEC
  7458     MOVE LENGTH OF
  7459      ACCOUNT-MASTER
  7460       TO DFHEIV12
  7461     MOVE 'ERACCT' TO DFHEIV1
  7462     MOVE 0
  7463       TO DFHEIV11
  7464*    MOVE '&.IL                  )  N#00006987' TO DFHEIV0
  7465     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7466     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 131
* EL6318.cbl
  7467     MOVE X'204E233030303036393837' TO DFHEIV0(25:11)
  7468     CALL 'kxdfhei1' USING DFHEIV0,
  7469           DFHEIV1,
  7470           ACCOUNT-MASTER,
  7471           DFHEIV12,
  7472           WS-ERACCT-KEY,
  7473           DFHEIV99,
  7474           DFHEIV11,
  7475           DFHEIV99,
  7476           DFHEIV99
  7477     MOVE EIBRESP  TO WS-RESPONSE
  7478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7479     .
  7480 0470-EXIT.
  7481     EXIT.
  7482 0500-CREATE-TEMP-STORAGE.
  7483     display ' about to write pi ' program-interface-block
  7484
  7485* EXEC CICS WRITEQ TS
  7486*        QUEUE (QID)
  7487*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7488*        LENGTH(PI-COMM-LENGTH)
  7489*    END-EXEC
  7490*    MOVE '*"                    ''   #00006998' TO DFHEIV0
  7491     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7493     MOVE X'2020233030303036393938' TO DFHEIV0(25:11)
  7494     CALL 'kxdfhei1' USING DFHEIV0,
  7495           QID,
  7496           PROGRAM-INTERFACE-BLOCK,
  7497           PI-COMM-LENGTH,
  7498           DFHEIV99,
  7499           DFHEIV99,
  7500           DFHEIV99
  7501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7502     display ' about to write map ' el631ki
  7503
  7504* EXEC CICS WRITEQ TS
  7505*        QUEUE (QID)
  7506*        FROM  (EL631KI)
  7507*        LENGTH(MAP-LENGTH)
  7508*    END-EXEC.
  7509*    MOVE '*"                    ''   #00007004' TO DFHEIV0
  7510     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7511     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7512     MOVE X'2020233030303037303034' TO DFHEIV0(25:11)
  7513     CALL 'kxdfhei1' USING DFHEIV0,
  7514           QID,
  7515           EL631KI,
  7516           MAP-LENGTH,
  7517           DFHEIV99,
  7518           DFHEIV99,
  7519           DFHEIV99
  7520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7521
  7522 0500-EXIT.
  7523      EXIT.
  7524 0600-RECOVER-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 132
* EL6318.cbl
  7525     display ' about to recover pi '
  7526
  7527* EXEC CICS READQ TS
  7528*        QUEUE (QID)
  7529*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7530*        LENGTH(PI-COMM-LENGTH)
  7531*    END-EXEC
  7532*    MOVE '*$I    L              ''   #00007013' TO DFHEIV0
  7533     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7535     MOVE X'2020233030303037303133' TO DFHEIV0(25:11)
  7536     CALL 'kxdfhei1' USING DFHEIV0,
  7537           QID,
  7538           PROGRAM-INTERFACE-BLOCK,
  7539           PI-COMM-LENGTH,
  7540           DFHEIV99,
  7541           DFHEIV99,
  7542           DFHEIV99
  7543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7544     display ' pi ' pi-program-work-area
  7545     display ' about to recover map '
  7546
  7547* EXEC CICS READQ TS
  7548*        QUEUE (QID)
  7549*        INTO  (EL631KI)
  7550*        LENGTH(MAP-LENGTH)
  7551*    END-EXEC
  7552*    MOVE '*$I    L              ''   #00007020' TO DFHEIV0
  7553     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7554     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7555     MOVE X'2020233030303037303230' TO DFHEIV0(25:11)
  7556     CALL 'kxdfhei1' USING DFHEIV0,
  7557           QID,
  7558           EL631KI,
  7559           MAP-LENGTH,
  7560           DFHEIV99,
  7561           DFHEIV99,
  7562           DFHEIV99
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7564     display ' map ' el631ki
  7565     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7566     MOVE AL-UANON            TO SIGREQA
  7567     MOVE AL-UANON            TO LTRIDA
  7568     MOVE AL-UANON            TO VOUCHA
  7569     MOVE AL-UANON            TO HLTHAPPA
  7570     MOVE AL-UANON            TO PAYEEA
  7571     IF WS-SET-CODES-MDT = 'Y'
  7572        move +1                  to s2
  7573        perform varying s1 from +1 by +5 until s1 > +60
  7574           MOVE WS-PASSED-REASON-CODES (s1:4)
  7575                                 TO reacd-in (s2)
  7576           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7577               MOVE AL-SANON     TO REACDA (S2)
  7578               MOVE +4           TO REACDL (S2)
  7579           END-IF
  7580           add +1                to s2
  7581        end-perform
  7582        MOVE REASONCDS       TO PI-REASONS-ENTERED
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 133
* EL6318.cbl
  7583     END-IF
  7584     IF CERTIDI > SPACES
  7585         MOVE AL-UANON       TO CERTIDA
  7586     END-IF
  7587
  7588     IF CRTNT1I > SPACES
  7589         MOVE AL-UANON       TO CRTNT1A
  7590     END-IF
  7591
  7592     IF CRTNT2I > SPACES
  7593         MOVE AL-UANON       TO CRTNT2A
  7594     END-IF
  7595
  7596     IF CRTNT3I > SPACES
  7597         MOVE AL-UANON       TO CRTNT3A
  7598     END-IF
  7599
  7600     IF CRTNT4I > SPACES
  7601         MOVE AL-UANON       TO CRTNT4A
  7602     END-IF
  7603
  7604     IF BILNT1I > SPACES
  7605         MOVE AL-UANON       TO BILNT1A
  7606     END-IF
  7607
  7608     IF BILNT2I > SPACES
  7609         MOVE AL-UANON       TO BILNT2A
  7610     END-IF
  7611     .
  7612 0600-EXIT.
  7613      EXIT.
  7614 0800-DELETE-TS.
  7615
  7616* EXEC CICS DELETEQ TS
  7617*        QUEUE(QID)
  7618*    END-EXEC
  7619*    MOVE '*&                    #   #00007076' TO DFHEIV0
  7620     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7621     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7622     MOVE X'2020233030303037303736' TO DFHEIV0(25:11)
  7623     CALL 'kxdfhei1' USING DFHEIV0,
  7624           QID,
  7625           DFHEIV99
  7626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7627     .
  7628 0800-EXIT.
  7629      EXIT.
  7630 1000-BUILD-ERARCH.
  7631     display ' made it to 1000 '
  7632     MOVE SPACES                 TO W-CNTL-KEY
  7633     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7634     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7635     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7636
  7637* EXEC CICS READ
  7638*         DATASET    (WS-ELCNTL-FILE-ID)
  7639*         SET        (ADDRESS OF CONTROL-FILE)
  7640*         RIDFLD     (W-CNTL-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 134
* EL6318.cbl
  7641*         UPDATE
  7642*         RESP       (WS-RESPONSE)
  7643*    END-EXEC
  7644*    MOVE '&"S        EU         (  N#00007088' TO DFHEIV0
  7645     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7646     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7647     MOVE X'204E233030303037303838' TO DFHEIV0(25:11)
  7648     CALL 'kxdfhei1' USING DFHEIV0,
  7649           WS-ELCNTL-FILE-ID,
  7650           DFHEIV20,
  7651           DFHEIV99,
  7652           W-CNTL-KEY,
  7653           DFHEIV99,
  7654           DFHEIV99,
  7655           DFHEIV99
  7656     SET ADDRESS OF CONTROL-FILE TO
  7657         DFHEIV20
  7658     MOVE EIBRESP  TO WS-RESPONSE
  7659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7660     IF RESP-NORMAL
  7661        display ' good read elcntl '
  7662        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7663           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7664        END-IF
  7665        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7666        MOVE CF-CREDIT-LAST-ARCH-NUM
  7667                                 TO W-ARCH-NUMBER
  7668
  7669* EXEC CICS REWRITE
  7670*          FROM      (CONTROL-FILE)
  7671*          DATASET   (WS-ELCNTL-FILE-ID)
  7672*       END-EXEC
  7673     MOVE LENGTH OF
  7674      CONTROL-FILE
  7675       TO DFHEIV11
  7676*    MOVE '&& L                  %   #00007103' TO DFHEIV0
  7677     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7678     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7679     MOVE X'2020233030303037313033' TO DFHEIV0(25:11)
  7680     CALL 'kxdfhei1' USING DFHEIV0,
  7681           WS-ELCNTL-FILE-ID,
  7682           CONTROL-FILE,
  7683           DFHEIV11,
  7684           DFHEIV99
  7685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7686     END-IF
  7687
  7688* EXEC CICS GETMAIN
  7689*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7690*       LENGTH   (W-ARCH-LENGTH)
  7691*    END-EXEC
  7692*    MOVE '," L                  $   #00007108' TO DFHEIV0
  7693     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7694     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7695     MOVE X'2020233030303037313038' TO DFHEIV0(25:11)
  7696     CALL 'kxdfhei1' USING DFHEIV0,
  7697           DFHEIV20,
  7698           W-ARCH-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 135
* EL6318.cbl
  7699           DFHEIV99
  7700     SET ADDRESS OF LETTER-ARCHIVE TO
  7701         DFHEIV20
  7702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7703     MOVE 'LA'                   TO LETTER-ARCHIVE
  7704     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7705                                    LA-ARCHIVE-NO-A2
  7706                                    LA-ARCHIVE-NO-A3
  7707                                    LA-ARCHIVE-NO-A4
  7708                                    LA-ARCHIVE-NO-A5
  7709                                    LA-ARCHIVE-NO-A6
  7710     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7711                                    LA-COMPANY-CD-A2
  7712                                    LA-COMPANY-CD-A3
  7713                                    LA-COMPANY-CD-A4
  7714                                    LA-COMPANY-CD-A5
  7715                                    LA-COMPANY-CD-A6
  7716     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7717                                    LA-CARRIER-A3
  7718                                    LA-CARRIER-A4
  7719                                    LA-CARRIER-A5
  7720     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7721     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7722                                    LA-GROUPING-A3
  7723                                    LA-GROUPING-A4
  7724                                    LA-GROUPING-A5
  7725     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7726                                    LA-ACCOUNT-A3
  7727                                    LA-ACCOUNT-A4
  7728                                    LA-ACCOUNT-A5
  7729     MOVE PB-STATE               TO LA-STATE-A2
  7730                                    LA-STATE-A3
  7731                                    LA-STATE-A4
  7732                                    LA-STATE-A5
  7733     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7734     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7735     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7736     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7737     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7738                                    LA-INITIAL-PRINT-DATE
  7739                                    LA-SENT-DATE
  7740                                    LA-REPLY-DATE
  7741                                    LA-RESEND-DATE
  7742                                    LA-FOLLOW-UP-DATE
  7743     MOVE 'A'                    TO LA-STATUS
  7744     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7745     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7746     MOVE LTRIDI                 TO LA-FORM-A3
  7747     MOVE '4'                    TO LA-DATA-SOURCE
  7748     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7749     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7750                                    LA-NO-OF-TEXT-RECORDS
  7751
  7752* EXEC CICS WRITE
  7753*         DATASET   ('ERARCH')
  7754*         FROM      (LETTER-ARCHIVE)
  7755*         RIDFLD    (LA-CONTROL-PRIMARY)
  7756*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 136
* EL6318.cbl
  7757*    END-EXEC
  7758     MOVE LENGTH OF
  7759      LETTER-ARCHIVE
  7760       TO DFHEIV11
  7761     MOVE 'ERARCH' TO DFHEIV1
  7762*    MOVE '&$ L                  ''  N#00007160' TO DFHEIV0
  7763     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7764     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7765     MOVE X'204E233030303037313630' TO DFHEIV0(25:11)
  7766     CALL 'kxdfhei1' USING DFHEIV0,
  7767           DFHEIV1,
  7768           LETTER-ARCHIVE,
  7769           DFHEIV11,
  7770           LA-CONTROL-PRIMARY,
  7771           DFHEIV99,
  7772           DFHEIV99
  7773     MOVE EIBRESP  TO WS-RESPONSE
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7775     IF RESP-NORMAL
  7776        display ' good write erarch '
  7777        MOVE ER-0280             TO EMI-ERROR
  7778        MOVE -1                  TO SIGREQL
  7779        PERFORM 9900-ERROR-FORMAT
  7780                                 THRU 9900-EXIT
  7781        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7782        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7783     ELSE
  7784        MOVE ER-7345             TO EMI-ERROR
  7785        MOVE -1                  TO SIGREQL
  7786        PERFORM 9900-ERROR-FORMAT
  7787                                 THRU 9900-EXIT
  7788     END-IF
  7789     .
  7790 1000-EXIT.
  7791     EXIT.
  7792 1100-CALL-NS-BUS-LOGIC.
  7793     DISPLAY ' MADE IT TO 1100 '
  7794     MOVE SPACES                 TO BL-INPUT
  7795     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7796     MOVE '4'                    TO BL-DATA-SRCE
  7797     MOVE PB-CARRIER             TO BL-CARRIER
  7798     MOVE PB-GROUPING            TO BL-GROUP
  7799     MOVE PB-STATE               TO BL-STATE
  7800     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7801     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7802        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7803        MOVE ' '                 TO DC-OPTION-CODE
  7804        PERFORM 9700-date-link
  7805        IF NO-CONVERSION-ERROR
  7806           MOVE DC-GREG-DATE-B-EDIT
  7807                                 TO BL-EFF-DT
  7808        END-IF
  7809     END-IF
  7810     MOVE PB-CERT-NO             TO BL-CERT-NO
  7811     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7812     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7813     MOVE SPACES                 TO BL-RESP-NO
  7814     MOVE LTRIDI                 TO BL-LETTER-ID
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 137
* EL6318.cbl
  7815     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7816     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7817*    MOVE 'ALWA'                 TO BL-PROC-ID
  7818     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7819*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7820*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7821     IF EIBAID = DFHPF4
  7822        MOVE 'B'                 TO BL-WRITE-ERARCH
  7823     ELSE
  7824        MOVE 'T'                 TO BL-WRITE-ERARCH
  7825     END-IF
  7826     MOVE CERTIDI                TO BL-CERT-FORM-ID
  7827     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7828     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  7829     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7830        IF REACD-IN (S1) NOT = LOW-VALUES
  7831           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7832        END-IF
  7833     END-PERFORM
  7834    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7835*****************************************
  7836* Invoke the LETTER business logic
  7837*****************************************
  7838
  7839* exec cics link
  7840*       program('NSRASBL')
  7841*       commarea(srch-commarea)
  7842*    end-exec.
  7843     MOVE LENGTH OF
  7844      srch-commarea
  7845       TO DFHEIV11
  7846     MOVE 'NSRASBL' TO DFHEIV1
  7847*    MOVE '."C                   (   #00007229' TO DFHEIV0
  7848     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7850     MOVE X'2020233030303037323239' TO DFHEIV0(25:11)
  7851     CALL 'kxdfhei1' USING DFHEIV0,
  7852           DFHEIV1,
  7853           srch-commarea,
  7854           DFHEIV11,
  7855           DFHEIV99,
  7856           DFHEIV99,
  7857           DFHEIV99,
  7858           DFHEIV99
  7859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7860
  7861     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7862        BL-MESSAGE
  7863     .
  7864 1100-EXIT.
  7865     EXIT.
  7866 1500-GET-ARCH-NO.
  7867     display ' made it to 1500 '
  7868     MOVE SPACES                 TO ELCNTL-KEY
  7869     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7870     MOVE '1'                    TO CNTL-REC-TYPE
  7871     MOVE ZEROS                  TO CNTL-SEQ
  7872
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 138
* EL6318.cbl
  7873* EXEC CICS READ
  7874*         DATASET    (WS-ELCNTL-FILE-ID)
  7875*         SET        (ADDRESS OF CONTROL-FILE)
  7876*         RIDFLD     (ELCNTL-KEY)
  7877*         UPDATE
  7878*         RESP       (WS-RESPONSE)
  7879*    END-EXEC
  7880*    MOVE '&"S        EU         (  N#00007244' TO DFHEIV0
  7881     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7882     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7883     MOVE X'204E233030303037323434' TO DFHEIV0(25:11)
  7884     CALL 'kxdfhei1' USING DFHEIV0,
  7885           WS-ELCNTL-FILE-ID,
  7886           DFHEIV20,
  7887           DFHEIV99,
  7888           ELCNTL-KEY,
  7889           DFHEIV99,
  7890           DFHEIV99,
  7891           DFHEIV99
  7892     SET ADDRESS OF CONTROL-FILE TO
  7893         DFHEIV20
  7894     MOVE EIBRESP  TO WS-RESPONSE
  7895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7896     IF RESP-NORMAL
  7897        display ' good read elcntl '
  7898        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7899           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7900        END-IF
  7901        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7902        MOVE CF-CREDIT-LAST-ARCH-NUM
  7903                                 TO W-ARCH-NUMBER
  7904        display ' new arch number ' w-arch-number
  7905
  7906* EXEC CICS REWRITE
  7907*          FROM      (CONTROL-FILE)
  7908*          DATASET   (WS-ELCNTL-FILE-ID)
  7909*       END-EXEC
  7910     MOVE LENGTH OF
  7911      CONTROL-FILE
  7912       TO DFHEIV11
  7913*    MOVE '&& L                  %   #00007260' TO DFHEIV0
  7914     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7915     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7916     MOVE X'2020233030303037323630' TO DFHEIV0(25:11)
  7917     CALL 'kxdfhei1' USING DFHEIV0,
  7918           WS-ELCNTL-FILE-ID,
  7919           CONTROL-FILE,
  7920           DFHEIV11,
  7921           DFHEIV99
  7922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7923     END-IF
  7924     .
  7925 1500-EXIT.
  7926     EXIT.
  7927
  7928
  7929 1700-WRITE-CERT-NOTE      SECTION.
  7930
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 139
* EL6318.cbl
  7931     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7932     MOVE ZERO           TO ERCNOT-SEQ.
  7933     SET TB-INDX         DOWN BY 1.
  7934     SET TB-INDX1        TO TB-INDX.
  7935
  7936****DELETE CURRENT CERT NOTES
  7937 1700-LOOP.
  7938
  7939* EXEC CICS READ
  7940*        DATASET (WS-ERCNOT-FILE-ID)
  7941*        RIDFLD  (ERCNOT-KEY)
  7942*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7943*        RESP    (WS-RESPONSE)
  7944*        GTEQ
  7945*    END-EXEC.
  7946*    MOVE '&"S        G          (  N#00007279' TO DFHEIV0
  7947     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7949     MOVE X'204E233030303037323739' TO DFHEIV0(25:11)
  7950     CALL 'kxdfhei1' USING DFHEIV0,
  7951           WS-ERCNOT-FILE-ID,
  7952           DFHEIV20,
  7953           DFHEIV99,
  7954           ERCNOT-KEY,
  7955           DFHEIV99,
  7956           DFHEIV99,
  7957           DFHEIV99
  7958     SET ADDRESS OF CERT-NOTE-FILE TO
  7959         DFHEIV20
  7960     MOVE EIBRESP  TO WS-RESPONSE
  7961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7962
  7963
  7964     IF NOT RESP-NORMAL
  7965        GO TO 1700-ENDDEL
  7966     END-IF
  7967
  7968     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7969
  7970     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7971         GO TO 1700-ENDDEL
  7972     END-IF.
  7973
  7974
  7975* EXEC CICS DELETE
  7976*        DATASET (WS-ERCNOT-FILE-ID)
  7977*        RIDFLD  (ERCNOT-KEY)
  7978*    END-EXEC.
  7979*    MOVE '&(  R                 &   #00007297' TO DFHEIV0
  7980     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7981     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7982     MOVE X'2020233030303037323937' TO DFHEIV0(25:11)
  7983     CALL 'kxdfhei1' USING DFHEIV0,
  7984           WS-ERCNOT-FILE-ID,
  7985           ERCNOT-KEY,
  7986           DFHEIV99,
  7987           DFHEIV99,
  7988           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 140
* EL6318.cbl
  7989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7990
  7991
  7992     GO TO 1700-LOOP.
  7993
  7994 1700-ENDDEL.
  7995
  7996
  7997* EXEC CICS GETMAIN
  7998*         LENGTH(ERCNOT-LENGTH)
  7999*         SET(ADDRESS OF CERT-NOTE-FILE)
  8000*         INITIMG(GETMAIN-SPACE)
  8001*    END-EXEC.
  8002*    MOVE ',"IL                  $   #00007306' TO DFHEIV0
  8003     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8004     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8005     MOVE X'2020233030303037333036' TO DFHEIV0(25:11)
  8006     CALL 'kxdfhei1' USING DFHEIV0,
  8007           DFHEIV20,
  8008           ERCNOT-LENGTH,
  8009           GETMAIN-SPACE
  8010     SET ADDRESS OF CERT-NOTE-FILE TO
  8011         DFHEIV20
  8012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8013
  8014
  8015     SET TB-INDX TO 1.
  8016     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8017     MOVE +0             TO ERCNOT-SEQ
  8018
  8019     PERFORM VARYING TB-INDX FROM 1 BY 1
  8020             UNTIL TB-INDX > TB-INDX1
  8021        MOVE SPACES                 TO  CERT-NOTE-FILE
  8022        ADD 1                       TO  ERCNOT-SEQ
  8023        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8024        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8025        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8026        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8027                                    TO  CZ-LAST-MAINT-USER
  8028        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8029                                    TO  CZ-LAST-MAINT-HHMMSS
  8030        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8031                                    TO  CZ-LAST-MAINT-DT
  8032
  8033
  8034* EXEC CICS WRITE
  8035*            DATASET(WS-ERCNOT-FILE-ID)
  8036*            FROM(CERT-NOTE-FILE)
  8037*            RIDFLD(ERCNOT-KEY)
  8038*       END-EXEC
  8039     MOVE LENGTH OF
  8040      CERT-NOTE-FILE
  8041       TO DFHEIV11
  8042*    MOVE '&$ L                  ''   #00007330' TO DFHEIV0
  8043     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8044     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8045     MOVE X'2020233030303037333330' TO DFHEIV0(25:11)
  8046     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 141
* EL6318.cbl
  8047           WS-ERCNOT-FILE-ID,
  8048           CERT-NOTE-FILE,
  8049           DFHEIV11,
  8050           ERCNOT-KEY,
  8051           DFHEIV99,
  8052           DFHEIV99
  8053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8054     END-PERFORM
  8055
  8056     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8057     IF RESP-NORMAL
  8058        EVALUATE CM-NOTE-SW
  8059           WHEN '1'
  8060           WHEN '3'
  8061           WHEN '5'
  8062           WHEN '7'
  8063              SET NO-CERT-RW     TO TRUE
  8064           WHEN ' '
  8065              MOVE '1'           TO CM-NOTE-SW
  8066           WHEN '2'
  8067              MOVE '3'           TO CM-NOTE-SW
  8068           WHEN '4'
  8069              MOVE '5'           TO CM-NOTE-SW
  8070           WHEN '6'
  8071              MOVE '7'           TO CM-NOTE-SW
  8072        END-EVALUATE
  8073     END-IF
  8074     IF NOT NO-CERT-RW
  8075        PERFORM 1810-REWRITE-ELCERT
  8076                                 THRU 1810-EXIT
  8077     ELSE
  8078
  8079* EXEC CICS UNLOCK
  8080*          DATASET    (WS-ELCERT-FILE-ID)
  8081*       END-EXEC
  8082*    MOVE '&*                    #   #00007359' TO DFHEIV0
  8083     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8084     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8085     MOVE X'2020233030303037333539' TO DFHEIV0(25:11)
  8086     CALL 'kxdfhei1' USING DFHEIV0,
  8087           WS-ELCERT-FILE-ID,
  8088           DFHEIV99
  8089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8090     END-IF
  8091
  8092     .
  8093 1799-EXIT.
  8094     EXIT.
  8095
  8096 1800-READ-ELCERT-UPDATE.
  8097
  8098     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8099     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8100     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8101     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8102     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8103     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8104     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 142
* EL6318.cbl
  8105     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8106
  8107
  8108* EXEC CICS READ
  8109*        UPDATE
  8110*        DATASET  (WS-ELCERT-FILE-ID)
  8111*        RIDFLD   (WS-ELCERT-KEY)
  8112*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8113*        RESP     (WS-RESPONSE)
  8114*    END-EXEC
  8115*    MOVE '&"S        EU         (  N#00007379' TO DFHEIV0
  8116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8117     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8118     MOVE X'204E233030303037333739' TO DFHEIV0(25:11)
  8119     CALL 'kxdfhei1' USING DFHEIV0,
  8120           WS-ELCERT-FILE-ID,
  8121           DFHEIV20,
  8122           DFHEIV99,
  8123           WS-ELCERT-KEY,
  8124           DFHEIV99,
  8125           DFHEIV99,
  8126           DFHEIV99
  8127     SET ADDRESS OF CERTIFICATE-MASTER TO
  8128         DFHEIV20
  8129     MOVE EIBRESP  TO WS-RESPONSE
  8130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8131
  8132     .
  8133 1800-EXIT.
  8134     EXIT.
  8135
  8136 1810-REWRITE-ELCERT.
  8137
  8138
  8139* EXEC CICS REWRITE
  8140*        FROM     (CERTIFICATE-MASTER)
  8141*        DATASET  (WS-ELCERT-FILE-ID)
  8142*        RESP     (WS-RESPONSE)
  8143*    END-EXEC.
  8144     MOVE LENGTH OF
  8145      CERTIFICATE-MASTER
  8146       TO DFHEIV11
  8147*    MOVE '&& L                  %  N#00007393' TO DFHEIV0
  8148     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8149     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8150     MOVE X'204E233030303037333933' TO DFHEIV0(25:11)
  8151     CALL 'kxdfhei1' USING DFHEIV0,
  8152           WS-ELCERT-FILE-ID,
  8153           CERTIFICATE-MASTER,
  8154           DFHEIV11,
  8155           DFHEIV99
  8156     MOVE EIBRESP  TO WS-RESPONSE
  8157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8158
  8159
  8160     .
  8161 1810-EXIT.
  8162     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 143
* EL6318.cbl
  8163
  8164 8100-SEND-INITIAL-MAP.
  8165     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8166     MOVE '5'                    TO DC-OPTION-CODE.
  8167     PERFORM 9700-DATE-LINK.
  8168     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8169     MOVE EIBTIME                TO TIME-IN.
  8170     MOVE TIME-OUT               TO TIMEO.
  8171     MOVE -1                     TO SIGREQL
  8172     IF PI-PROCESSOR-IS-CSR-SUPER
  8173        perform varying s1 from +1 by +1 until
  8174           s1 > +12
  8175           MOVE AL-UANON            TO reacda (s1)
  8176        end-perform
  8177     END-IF
  8178     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8179     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8180
  8181* EXEC CICS SEND
  8182*        MAP      (MAP-NAME)
  8183*        MAPSET   (MAPSET-NAME)
  8184*        FROM     (EL631KO)
  8185*        ERASE
  8186*        CURSOR
  8187*    END-EXEC.
  8188     MOVE LENGTH OF
  8189      EL631KO
  8190       TO DFHEIV12
  8191     MOVE -1
  8192       TO DFHEIV11
  8193*    MOVE '8$     CT  E    H L F ,   #00007419' TO DFHEIV0
  8194     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8195     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8196     MOVE X'2020233030303037343139' TO DFHEIV0(25:11)
  8197     CALL 'kxdfhei1' USING DFHEIV0,
  8198           MAP-NAME,
  8199           EL631KO,
  8200           DFHEIV12,
  8201           MAPSET-NAME,
  8202           DFHEIV99,
  8203           DFHEIV99,
  8204           DFHEIV99,
  8205           DFHEIV11,
  8206           DFHEIV99,
  8207           DFHEIV99,
  8208           DFHEIV99
  8209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8210
  8211     GO TO 9100-RETURN-TRAN.
  8212 8200-SEND-DATAONLY.
  8213     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8214     MOVE '5'                    TO DC-OPTION-CODE.
  8215     PERFORM 9700-DATE-LINK.
  8216     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8217     MOVE EIBTIME                TO TIME-IN.
  8218     MOVE TIME-OUT               TO TIMEO.
  8219     MOVE -1                     TO PFENTRL
  8220     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 144
* EL6318.cbl
  8221     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8222
  8223* EXEC CICS SEND
  8224*        MAP      (MAP-NAME)
  8225*        MAPSET   (MAPSET-NAME)
  8226*        FROM     (EL631KO)
  8227*        DATAONLY
  8228*        ERASEAUP
  8229*        CURSOR
  8230*    END-EXEC.
  8231     MOVE LENGTH OF
  8232      EL631KO
  8233       TO DFHEIV12
  8234     MOVE -1
  8235       TO DFHEIV11
  8236*    MOVE '8$D    CT  A    H L F ,   #00007437' TO DFHEIV0
  8237     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8238     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8239     MOVE X'2020233030303037343337' TO DFHEIV0(25:11)
  8240     CALL 'kxdfhei1' USING DFHEIV0,
  8241           MAP-NAME,
  8242           EL631KO,
  8243           DFHEIV12,
  8244           MAPSET-NAME,
  8245           DFHEIV99,
  8246           DFHEIV99,
  8247           DFHEIV99,
  8248           DFHEIV11,
  8249           DFHEIV99,
  8250           DFHEIV99,
  8251           DFHEIV99
  8252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8253
  8254     GO TO 9100-RETURN-TRAN.
  8255 8300-SEND-TEXT.
  8256
  8257* EXEC CICS SEND TEXT
  8258*        FROM     (LOGOFF-TEXT)
  8259*        LENGTH   (LOGOFF-LENGTH)
  8260*        ERASE
  8261*        FREEKB
  8262*    END-EXEC.
  8263*    MOVE '8&      T  E F  H   F -   #00007447' TO DFHEIV0
  8264     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8265     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8266     MOVE X'2020233030303037343437' TO DFHEIV0(25:11)
  8267     CALL 'kxdfhei1' USING DFHEIV0,
  8268           LOGOFF-TEXT,
  8269           LOGOFF-LENGTH,
  8270           DFHEIV99,
  8271           DFHEIV99,
  8272           DFHEIV99,
  8273           DFHEIV99,
  8274           DFHEIV99,
  8275           DFHEIV99,
  8276           DFHEIV99,
  8277           DFHEIV99,
  8278           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 145
* EL6318.cbl
  8279           DFHEIV99
  8280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8281
  8282
  8283* EXEC CICS RETURN
  8284*    END-EXEC.
  8285*    MOVE '.(                    ''   #00007453' TO DFHEIV0
  8286     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8287     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8288     MOVE X'2020233030303037343533' TO DFHEIV0(25:11)
  8289     CALL 'kxdfhei1' USING DFHEIV0,
  8290           DFHEIV99,
  8291           DFHEIV99,
  8292           DFHEIV99,
  8293           DFHEIV99,
  8294           DFHEIV99,
  8295           DFHEIV99
  8296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8297
  8298 8800-UNAUTHORIZED-ACCESS.
  8299     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8300     GO TO 8300-SEND-TEXT.
  8301 8810-PF23.
  8302     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8303     MOVE XCTL-005               TO PGM-NAME.
  8304     GO TO 9300-XCTL.
  8305 9000-RETURN-CICS.
  8306
  8307* EXEC CICS RETURN
  8308*    END-EXEC.
  8309*    MOVE '.(                    ''   #00007463' TO DFHEIV0
  8310     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8311     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8312     MOVE X'2020233030303037343633' TO DFHEIV0(25:11)
  8313     CALL 'kxdfhei1' USING DFHEIV0,
  8314           DFHEIV99,
  8315           DFHEIV99,
  8316           DFHEIV99,
  8317           DFHEIV99,
  8318           DFHEIV99,
  8319           DFHEIV99
  8320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8321
  8322 9100-RETURN-TRAN.
  8323     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8324     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8325
  8326* EXEC CICS RETURN
  8327*        TRANSID    (TRANS-ID)
  8328*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8329*        LENGTH     (PI-COMM-LENGTH)
  8330*    END-EXEC.
  8331*    MOVE '.(CT                  ''   #00007468' TO DFHEIV0
  8332     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8334     MOVE X'2020233030303037343638' TO DFHEIV0(25:11)
  8335     CALL 'kxdfhei1' USING DFHEIV0,
  8336           TRANS-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 146
* EL6318.cbl
  8337           PROGRAM-INTERFACE-BLOCK,
  8338           PI-COMM-LENGTH,
  8339           DFHEIV99,
  8340           DFHEIV99,
  8341           DFHEIV99
  8342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8343
  8344 9200-RETURN-MAIN-MENU.
  8345     MOVE XCTL-626               TO PGM-NAME.
  8346     GO TO 9300-XCTL.
  8347 9300-XCTL.
  8348
  8349* EXEC CICS XCTL
  8350*        PROGRAM    (PGM-NAME)
  8351*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8352*        LENGTH     (PI-COMM-LENGTH)
  8353*    END-EXEC.
  8354*    MOVE '.$C                   %   #00007477' TO DFHEIV0
  8355     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8356     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8357     MOVE X'2020233030303037343737' TO DFHEIV0(25:11)
  8358     CALL 'kxdfhei1' USING DFHEIV0,
  8359           PGM-NAME,
  8360           PROGRAM-INTERFACE-BLOCK,
  8361           PI-COMM-LENGTH,
  8362           DFHEIV99
  8363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8364
  8365 9400-CLEAR.
  8366     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8367
  8368* EXEC CICS XCTL
  8369*        PROGRAM    (PGM-NAME)
  8370*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8371*        LENGTH     (PI-COMM-LENGTH)
  8372*    END-EXEC.
  8373*    MOVE '.$C                   %   #00007484' TO DFHEIV0
  8374     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8375     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8376     MOVE X'2020233030303037343834' TO DFHEIV0(25:11)
  8377     CALL 'kxdfhei1' USING DFHEIV0,
  8378           PGM-NAME,
  8379           PROGRAM-INTERFACE-BLOCK,
  8380           PI-COMM-LENGTH,
  8381           DFHEIV99
  8382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8383
  8384 9500-PF12.
  8385     MOVE XCTL-010               TO PGM-NAME.
  8386     GO TO 9300-XCTL.
  8387 9600-PGMID-ERROR.
  8388
  8389* EXEC CICS HANDLE CONDITION
  8390*        PGMIDERR    (8300-SEND-TEXT)
  8391*    END-EXEC.
  8392*    MOVE '"$L                   ! " #00007493' TO DFHEIV0
  8393     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 147
* EL6318.cbl
  8395     MOVE X'2220233030303037343933' TO DFHEIV0(25:11)
  8396     CALL 'kxdfhei1' USING DFHEIV0
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8398
  8399     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8400     MOVE ' '                    TO PI-ENTRY-CD-1.
  8401     MOVE XCTL-005               TO PGM-NAME.
  8402     MOVE PGM-NAME               TO LOGOFF-PGM.
  8403     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8404     GO TO 9300-XCTL.
  8405 9700-DATE-LINK.
  8406     MOVE LINK-ELDATCV           TO PGM-NAME.
  8407
  8408* EXEC CICS LINK
  8409*        PROGRAM    (PGM-NAME)
  8410*        COMMAREA   (DATE-CONVERSION-DATA)
  8411*        LENGTH     (DC-COMM-LENGTH)
  8412*    END-EXEC.
  8413*    MOVE '."C                   (   #00007504' TO DFHEIV0
  8414     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8416     MOVE X'2020233030303037353034' TO DFHEIV0(25:11)
  8417     CALL 'kxdfhei1' USING DFHEIV0,
  8418           PGM-NAME,
  8419           DATE-CONVERSION-DATA,
  8420           DC-COMM-LENGTH,
  8421           DFHEIV99,
  8422           DFHEIV99,
  8423           DFHEIV99,
  8424           DFHEIV99
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8426
  8427 9900-ERROR-FORMAT.
  8428     IF NOT EMI-ERRORS-COMPLETE
  8429        MOVE LINK-001            TO PGM-NAME
  8430
  8431* EXEC CICS LINK
  8432*           PROGRAM    (PGM-NAME)
  8433*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8434*           LENGTH     (EMI-COMM-LENGTH)
  8435*       END-EXEC
  8436*    MOVE '."C                   (   #00007512' TO DFHEIV0
  8437     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8439     MOVE X'2020233030303037353132' TO DFHEIV0(25:11)
  8440     CALL 'kxdfhei1' USING DFHEIV0,
  8441           PGM-NAME,
  8442           ERROR-MESSAGE-INTERFACE-BLOCK,
  8443           EMI-COMM-LENGTH,
  8444           DFHEIV99,
  8445           DFHEIV99,
  8446           DFHEIV99,
  8447           DFHEIV99
  8448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8449     END-IF
  8450     .
  8451 9900-EXIT.
  8452     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 148
* EL6318.cbl
  8453 9990-ABEND.
  8454     MOVE LINK-004               TO PGM-NAME.
  8455     MOVE DFHEIBLK               TO EMI-LINE1.
  8456
  8457* EXEC CICS LINK
  8458*        PROGRAM   (PGM-NAME)
  8459*        COMMAREA  (EMI-LINE1)
  8460*        LENGTH    (72)
  8461*    END-EXEC.
  8462     MOVE 72
  8463       TO DFHEIV11
  8464*    MOVE '."C                   (   #00007524' TO DFHEIV0
  8465     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8467     MOVE X'2020233030303037353234' TO DFHEIV0(25:11)
  8468     CALL 'kxdfhei1' USING DFHEIV0,
  8469           PGM-NAME,
  8470           EMI-LINE1,
  8471           DFHEIV11,
  8472           DFHEIV99,
  8473           DFHEIV99,
  8474           DFHEIV99,
  8475           DFHEIV99
  8476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8477
  8478     GO TO 8200-SEND-DATAONLY.
  8479
  8480* GOBACK.
  8481     MOVE '9%                    "   ' TO DFHEIV0
  8482     MOVE 'EL6318' TO DFHEIV1
  8483     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8484     GOBACK.
  8485 9995-SECURITY-VIOLATION.
  8486*                            COPY ELCSCTP.
  8487******************************************************************
  8488*                                                                *
  8489*                            ELCSCTP                             *
  8490*                            VMOD=2.001                          *
  8491*                                                                *
  8492*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8493******************************************************************
  8494
  8495
  8496     MOVE EIBDATE          TO SM-JUL-DATE.
  8497     MOVE EIBTRMID         TO SM-TERMID.
  8498     MOVE THIS-PGM         TO SM-PGM.
  8499     MOVE EIBTIME          TO TIME-IN.
  8500     MOVE TIME-OUT         TO SM-TIME.
  8501     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8502
  8503
  8504* EXEC CICS LINK
  8505*         PROGRAM  ('EL003')
  8506*         COMMAREA (SECURITY-MESSAGE)
  8507*         LENGTH   (80)
  8508*    END-EXEC.
  8509     MOVE 'EL003' TO DFHEIV1
  8510     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:15 Page 149
* EL6318.cbl
  8511       TO DFHEIV11
  8512*    MOVE '."C                   (   #00007549' TO DFHEIV0
  8513     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8515     MOVE X'2020233030303037353439' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0,
  8517           DFHEIV1,
  8518           SECURITY-MESSAGE,
  8519           DFHEIV11,
  8520           DFHEIV99,
  8521           DFHEIV99,
  8522           DFHEIV99,
  8523           DFHEIV99
  8524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8525
  8526
  8527******************************************************************
  8528
  8529 9995-EXIT.
  8530     EXIT.
  8531
  8532 9999-DFHBACK SECTION.
  8533     MOVE '9%                    "   ' TO DFHEIV0
  8534     MOVE 'EL6318' TO DFHEIV1
  8535     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8536     GOBACK.
  8537 9999-DFHEXIT.
  8538     IF DFHEIGDJ EQUAL 0001
  8539         NEXT SENTENCE
  8540     ELSE IF DFHEIGDJ EQUAL 2
  8541         GO TO 8300-SEND-TEXT
  8542         DEPENDING ON DFHEIGDI.
  8543     MOVE '9%                    "   ' TO DFHEIV0
  8544     MOVE 'EL6318' TO DFHEIV1
  8545     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8546     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34808     Code:       19500
