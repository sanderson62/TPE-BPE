* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   3
* EL050.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER   PIC X(32) VALUE '********************************'.
    66 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    67 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    68
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87*    COPY ELC50WS.
    88*****************************************************************
    89*                                                               *
    90*                            ELC50WS.                           *
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    92*                            VMOD=2.061.                        *
    93*                                                               *
    94*   THIS IS THE WORKING STORAGE FOR EL050                       *
    95*                                   EL517                       *
    96*****************************************************************
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 123102                   PEMA  ADD DCC PROCESSING
   106* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   107* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   108* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   109* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   110* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   111* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   112* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   113* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   114* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   115* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   116* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   117* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   118* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   119* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   4
* EL050.cbl
   120* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   121* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   122* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   123* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   124* 030309  CR2009021700001  PEMA  ADD ER-2883
   125* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   128* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   129* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   130* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   131* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   132* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   133* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   134* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   135* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   136* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   137* 061412  CR2011022800001  AJRA  NAPERSOFT
   138* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   139* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   140* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   141* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   142* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   143* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   144* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   145* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   146* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   147* 091114  IR2014091000001  TANA  ADD ERROR 2898
   148* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   149* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   150* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   151* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   152* 100617  CR2017062000003  PEMA  Inforce state comm cap
   153* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   154* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   155*-----------------------------------------------------------------
   156
   157 01  WORK-AREAS.
   158
   159*****************************************************************
   160*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   161*****************************************************************
   162
   163     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   164     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   165     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   166     12  WS-NAME-EDIT-WORK-AREA.
   167         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   168         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   169             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   170         16  WS-WORK-NAME.
   171             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   172             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   173             20  FILLER           PIC X(10)     VALUE SPACES.
   174         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   175             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   176
   177*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   5
* EL050.cbl
   178*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   179*****************************************************************
   180
   181     12  WS-ERRESC-KEY.
   182         16 WS-ERRESC-SEARCH-KEY.
   183             20  WS-ERRESC-COMPANY-CD PIC  X.
   184             20  WS-ERRESC-CARRIER    PIC  X.
   185             20  WS-ERRESC-GROUP      PIC X(6).
   186             20  WS-ERRESC-STATE      PIC XX.
   187             20  WS-ERRESC-ACCOUNT    PIC X(10).
   188         16 WS-ERRESC-RESIDUAL-KEY.
   189             20  WS-ERRESC-AGENT      PIC X(10).
   190             20  WS-ERRESC-RES-STATE  PIC XX.
   191             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   192*                                          YYYYMMDD
   193     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   194     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   195
   196*RESIDENT STATE TAX MASTER(ERRESS)
   197*
   198     12  WS-ERRESS-KEY.
   199         16  WS-ERRESS-COMPANY-CD      PIC  X.
   200         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   201         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   202         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   203*                                          YYYYMMDD
   204
   205     12  WS-CONTRACT-DATE              PIC 9(8).
   206*                                          YYYYMMDD
   207     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   208     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   209         16 WS-YEAR-YY                 PIC   9999.
   210         16 FILLER                     PIC 9(4).
   211*                                          YYYYMMDD
   212     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   213     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   214     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   215     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   216
   217     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   218         88  DPRB-1ST-TIME                      VALUE ' '.
   219
   220*****************************************************************
   221*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   222*****************************************************************
   223
   224     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   225     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   226     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   227     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   228     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   229     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   230     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   231     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   232     12  ws-st-agent-sig-edit    pic x          value spaces.
   233     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   234     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   6
* EL050.cbl
   236     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   237         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   238         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   239     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   240         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   241         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   242     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   243
   244     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   245     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   246
   247     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   248     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   258     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   259     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   260     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   261     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   262     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   278     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   279     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   280     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   281     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   282     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   283     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   284     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   285     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   286     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   293     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   7
* EL050.cbl
   294     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   295     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   296     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   297     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   298     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   299     12  WS-2671-SW               PIC X         VALUE SPACE.
   300     12  WS-2672-SW               PIC X         VALUE SPACE.
   301     12  ws-9813-sw               pic x         value spaces.
   302     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   303         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   304     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   305         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   306     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   307
   308     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   309         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   310         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   311         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   312         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   313
   314     12  WS-CREDIT-EDIT-CONTROLS.
   315         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   316         16  WS-MIN-AGE           PIC 99                VALUE  0.
   317         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   318         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   319         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   320         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   321
   322     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   323     12  WS-AGE-FIELDS.
   324         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   325         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   326         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   327         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   328
   329     12  WS-SAVE-ALLOWABLE-BENEFIT.
   330         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   331         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   332         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   333         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   334         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   335         16  FILLER                      PIC XX.
   336
   337     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   338     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   339     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   340     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   341     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   342     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   343     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   344     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   345     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   346     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   347
   348     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   349     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   350     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   351     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   8
* EL050.cbl
   352     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   353     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   354     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   355     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   356         88  WS-REDUCING              VALUE 'R'.
   357         88  WS-LEVEL                 VALUE 'L' 'P'.
   358     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   359
   360     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   361     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   362     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   363     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   364     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   365     12  ws-ah-max-bens           pic 99        value zeros.
   366     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   367     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   368     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   369     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   370
   371     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   372     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   373     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   374     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   375     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   376     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   377     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   378     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   379     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   380     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   381     12  WS-ACCT-SIG-SW.
   382         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   383         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   384     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   385     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   386     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   388     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   389     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   391     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   392     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   393     12  WS-INITIALS.
   394         16  WS-INIT-1            PIC X         VALUE SPACES.
   395         16  WS-INIT-2            PIC X         VALUE SPACES.
   396
   397     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   398     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   399     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   400     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   401     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   402*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   403     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   404     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   405     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   406     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   407     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   408     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   409     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page   9
* EL050.cbl
   410     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   411     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   413     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   414     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   415     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   416     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   417     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   418     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   419     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   420     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   421     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   422     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   423     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   424     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   425******** FLA
   426     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   427     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   428     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   429     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   430     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   431********
   432     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   433     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   434     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   435     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   436     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   437     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   438     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   439     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   440     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   441     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   442
   443     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   444         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   445                                         '0' THRU '9'.
   446
   447     12  NUMBER-OF-MONTHS.
   448         16  SK-MO OCCURS 12 TIMES PIC X.
   449
   450     12  WS-WORK-DATE.
   451         16  WS-YEAR            PIC 99    VALUE 00.
   452         16  WS-MONTH           PIC 99    VALUE 00.
   453         16  WS-DAY             PIC 99    VALUE 00.
   454
   455     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   456     12  WS-WORK-CRIT-DEV       REDEFINES
   457         WS-WORK-LF-CRIT-PER    PIC X(03).
   458
   459     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   460     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   461
   462     12  WS-WORK-DATE-FROM.
   463         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X  VALUE SPACE.
   465         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   466         16  FILLER             PIC X         VALUE SPACE.
   467         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  10
* EL050.cbl
   468
   469     12  WS-WORK-DATE-THRU.
   470         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   471         16  FILLER             PIC X         VALUE SPACE.
   472         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   473         16  FILLER             PIC X         VALUE SPACE.
   474         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   475
   476     12  WS-LF-INPUT-CD.
   477         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   478         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   479
   480     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   481     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   482         16  WS-AH-INPUT-CD-1   PIC X.
   483         16  WS-AH-INPUT-CD-2-3 PIC XX.
   484
   485     12  WS-SWITCHES.
   486         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   487         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   488             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   489         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   490             88  BANK-ACCT-FOUND          VALUE 'Y'.
   491         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   492             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   493         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   494             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   495         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   496             88  COMP-MASTER-FOUND        VALUE 'Y'.
   497         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   498             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   499         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   500             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   501         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   502             88  STAT-MASTER-FOUND        VALUE 'Y'.
   503         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   504             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   505         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   506             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   507         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   508             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   509         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   510             88  FORM-MASTER-FOUND        VALUE 'Y'.
   511         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   512             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   513         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   514             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   515         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   516             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   517         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   518             88  NO-BENEFIT-FOUND         VALUE 'N'.
   519         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   520             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   521         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   522             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   523         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   524             88  AH-BENEFIT-FOUND         VALUE ' '.
   525             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  11
* EL050.cbl
   526         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   527             88  LF-BENEFIT-FOUND         VALUE ' '.
   528             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   529         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   530             88  NO-STATE-RECORD          VALUE '1'.
   531         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   532             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   533         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   534             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   535         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   536             88  CERT-WAS-FOUND           VALUE ' '.
   537             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   538         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   539             88  BROWSE-STARTED           VALUE 'Y'.
   540         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   541             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   542         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   543             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   544         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   545             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   546         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   547             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   548         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   549             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   550         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   551             88  APP-CERT-USED            VALUE 'Y' 'A'.
   552         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   553             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   554             88  FIRST-TIME-THROUGH       VALUE '1'.
   555             88  CTBL-NOT-FOUND           VALUE '2'.
   556
   557         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   558             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   559
   560         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   561             88  DLO-ERROR-FOUND          VALUE 'Y'.
   562
   563********FLA
   564     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   565     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   566********
   567     12  RC-SW-1                  PIC X           VALUE '0'.
   568     12  RC-SW-2                  PIC X           VALUE '0'.
   569     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   570     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   571     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   572     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   573     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   574     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   575     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   576     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   577     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   578     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   579     12  LIT-SPACES               PIC X           VALUE SPACES.
   580     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   581     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   582     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   583     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  12
* EL050.cbl
   584     12  erpndm-unlock-sw         pic x           value spaces.
   585         88  need-to-unlock-erpndm  value 'Y'.
   586     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   587     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   588     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   589         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   590         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   591     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   592         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   593
   594 01  WS-EXTRA-PERIODS-BY-STATE.
   595     12  WS-INT-PERIODS          PIC 9.
   596     12  WS-EXTRA-PMTS           PIC 9.
   597 01  ws-net-only-state           pic x value 'N'.
   598 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   599     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   600     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   601 01  WS-CRI-SSN-WORK-AREA.
   602     05  WS-CRI-SOC-SEC-NO.
   603         10  WS-SS-REPT-CD       PIC X(5).
   604         10  WS-SS-LAST-NAME     PIC X(5).
   605         10  WS-SS-INITIAL       PIC X.
   606
   607     05  WS-CRI-REPORT-CODE.
   608         10  FILLER              PIC X(5).
   609         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   610
   611     05  WS-CRI-LAST-NAME.
   612         10  WS-CRI-NAME-MOVE    PIC X(5).
   613         10  FILLER              PIC X(10).
   614
   615 01  ws-state-commission-caps.
   616     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   617     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   618     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   619     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   620     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   621     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   622     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   623     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   624     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   625     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   626     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   627     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   628     05  ws-st-cap-limit-to      pic x.
   629     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   630     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   631     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   632     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   633     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   634     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   635     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   636     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   637     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   638     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   639     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   640     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   641 01  WS-NUM-TABLE                PIC X(26)  VALUE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  13
* EL050.cbl
   642     '12345678012345070923456789'.
   643 01  FILLER REDEFINES WS-NUM-TABLE.
   644     05  WS-NUM OCCURS 26        PIC 9.
   645 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   646 01  V1                          PIC S999 COMP-3.
   647 01  V2                          PIC S999 COMP-3.
   648 01  V3                          PIC S999 COMP-3.
   649 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   650 01  FILLER REDEFINES WS-WORK-VIN.
   651     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   652 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   653 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   654 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   655 01  WS-HEX-WORK.
   656     05  FILLER                  PIC X  VALUE LOW-VALUES.
   657     05  WS-HEX-BYTE             PIC X.
   658 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   659 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   660 01  WS-WORK-HIN-ROW-B.
   661     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   662
   663 01  ws-benefit-cd-chg-sw      pic x value spaces.
   664     88  benefit-code-chg           value 'Y'.
   665 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   666 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   667     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   668 01  WS-ROW-D-TABLE.
   669     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   670
   671 01  WS-HIN-TABLE-B.
   672     05  F                       PIC XX VALUE 'A2'.
   673     05  F                       PIC XX VALUE 'B3'.
   674     05  F                       PIC XX VALUE 'C4'.
   675     05  F                       PIC XX VALUE 'D5'.
   676     05  F                       PIC XX VALUE 'E6'.
   677     05  F                       PIC XX VALUE 'F7'.
   678     05  F                       PIC XX VALUE 'G8'.
   679     05  F                       PIC XX VALUE 'H9'.
   680     05  F                       PIC XX VALUE 'I1'.
   681     05  F                       PIC XX VALUE 'J2'.
   682     05  F                       PIC XX VALUE 'K3'.
   683     05  F                       PIC XX VALUE 'L4'.
   684     05  F                       PIC XX VALUE 'M5'.
   685     05  F                       PIC XX VALUE 'N6'.
   686     05  F                       PIC XX VALUE 'O0'.
   687     05  F                       PIC XX VALUE 'P7'.
   688     05  F                       PIC XX VALUE 'Q0'.
   689     05  F                       PIC XX VALUE 'R8'.
   690     05  F                       PIC XX VALUE 'S9'.
   691     05  F                       PIC XX VALUE 'T2'.
   692     05  F                       PIC XX VALUE 'U3'.
   693     05  F                       PIC XX VALUE 'V4'.
   694     05  F                       PIC XX VALUE 'W5'.
   695     05  F                       PIC XX VALUE 'X6'.
   696     05  F                       PIC XX VALUE 'Y7'.
   697     05  F                       PIC XX VALUE 'Z8'.
   698 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   699     05  WS-VAL-IN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  14
* EL050.cbl
   700     05  WS-VAL-OUT              PIC 9.
   701 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   702 01  WS-COMPARE-BINARY-DATES.
   703     05  WS-971231                PIC XX VALUE X'92FF'.
   704     05  WS-931231                PIC XX VALUE X'8CFF'.
   705     05  WS-791231                PIC XX VALUE X'77FF'.
   706     05  WS-771001                PIC XX VALUE X'74A1'.
   707     05  WS-820301                PIC XX VALUE X'7B41'.
   708     05  WS-831031                PIC XX VALUE X'7DBF'.
   709     05  WS-831231                PIC XX VALUE X'7DFF'.
   710     05  WS-810831                PIC XX VALUE X'7A7F'.
   711     05  WS-830901                PIC XX VALUE X'7D81'.
   712
   713 01  FILE-ACCESS-IDS.
   714     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   715     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   716     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   717     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   718     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   719     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   720     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   721     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   722     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   723     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   724     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   725     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   726     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   727     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   728     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   729     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   730     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   731 01  DD-IU-SW                    PIC X   VALUE ' '.
   732     88  DD-IU-PRESENT                 VALUE 'Y'.
   733
   734 01  ACCESS-KEYS.
   735     12  ELMSTR-KEY.
   736         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   737         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   738     12  W-CLAIM-KEY.
   739         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   740         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   741
   742     12  ELCNTL-KEY.
   743         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   744         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   745         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   746         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   747
   748     12  ELCERT-KEY.
   749         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   750         16  CERT-CARRIER         PIC X       VALUE SPACE.
   751         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   752         16  CERT-STATE           PIC XX      VALUE SPACES.
   753         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   754         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   755         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   756
   757     12  ELCERT2-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  15
* EL050.cbl
   758         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   759         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   760
   761     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   762
   763     12  ELCERT-SAVE.
   764         16  FILLER                      PIC XX    VALUE SPACES.
   765
   766         16  WCS-CONTROL-PRIMARY.
   767             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   768             20  WCS-CARRIER             PIC X     VALUE SPACE.
   769             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   770             20  WCS-STATE               PIC XX    VALUE SPACES.
   771             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   772             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   773             20  WCS-CERT-NO.
   774                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   775                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   776
   777         16  CS-CONTROL-BY-NAME.
   778             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   779             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   780             20  CS-INSURED-INITIALS.
   781                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   782                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   783
   784         16  CS-CONTROL-BY-SSN.
   785             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   786             20  CS-SOC-SEC-NO.
   787                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   788                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   789                 24  CS-SSN-LN3.
   790                     28 CS-INSURED-INITIALS-A2   PIC XX
   791                                     VALUE SPACES.
   792                     28 CS-PART-LAST-NAME-A2     PIC X
   793                                     VALUE SPACE.
   794
   795         16  CS-CONTROL-BY-CERT-NO.
   796             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   797             20  CS-CERT-NO-A4           PIC X(11)
   798                                     VALUE SPACES.
   799
   800         16  CS-CONTROL-BY-MEMB.
   801             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   802             20  CS-MEMBER-NO.
   803                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   804                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   805                 24  CS-MEMB-LN4.
   806                     28 CS-INSURED-INITIALS-A5   PIC XX
   807                                      VALUE SPACES.
   808                     28 CS-PART-LAST-NAME-A5     PIC XX
   809                                      VALUE SPACES.
   810
   811         16  FILLER              PIC X(360) VALUE SPACES.
   812
   813     12  ERACCT-KEY.
   814         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   815         16  ACCT-CARRIER         PIC X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  16
* EL050.cbl
   816         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   817         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   818         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   819         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   820
   821     12  ERCOMP-KEY.
   822         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   823         16  COMP-CARRIER         PIC X     VALUE SPACES.
   824         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   825         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   826         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   827         16  COMP-TYPE            PIC X     VALUE SPACES.
   828
   829     12  ERLOFC-KEY.
   830         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   831         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   832         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   833         16  LOFC-STATE           PIC XX    VALUE SPACES.
   834         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   835         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   836
   837     12  WS-ELCRTT-KEY.
   838         16  WS-ELCRTT-PRIMARY       PIC X(33).
   839         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   840
   841     12  ERBXRF-KEY.
   842         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   843         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   844         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   845         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   846
   847     12  ERAGTC-KEY.
   848         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   849         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   850         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   851         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   852         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   853         16  AGTC-TYPE            PIC X     VALUE SPACES.
   854
   855     12  ERPLAN-KEY.
   856         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   857         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   858         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   859         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   860         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   861         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   862         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   863         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   864
   865     12  ERFORM-KEY.
   866         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   867         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   868         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   869         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   870
   871     12  ERREIN-KEY.
   872         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   873         16  REIN-TYPE            PIC X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  17
* EL050.cbl
   874         16  REIN-TABLE-CO.
   875             20  REIN-CODE-1      PIC X     VALUE SPACE.
   876             20  REIN-CODE-2      PIC X     VALUE SPACE.
   877             20  REIN-CODE-3      PIC X     VALUE SPACE.
   878         16  FILLER               PIC X(3)  VALUE SPACES.
   879
   880     12  ERCTBL-KEY.
   881         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   882         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   883         16  CTBL-CNTRL-2.
   884             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   885             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   886
   887     12  ELCRTO-KEY.
   888         16  ELCRTO-COMPANY-CD       PIC X.
   889         16  ELCRTO-CARRIER          PIC X.
   890         16  ELCRTO-GROUPING         PIC X(6).
   891         16  ELCRTO-STATE            PIC XX.
   892         16  ELCRTO-ACCOUNT          PIC X(10).
   893         16  ELCRTO-CERT-EFF-DT      PIC XX.
   894         16  ELCRTO-CERT-NO.
   895             20  ELCRTO-CERT-PRIME   PIC X(10).
   896             20  ELCRTO-CERT-SFX     PIC X.
   897         16  ELCRTO-RECORD-TYPE      PIC X.
   898         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   899
   900
   901     12  WS-ACCESS.
   902         16  FILLER               PIC XX    VALUE SPACES.
   903         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   904
   905     12  WS-CARR-ACCESS.
   906         16  FILLER               PIC X(3)  VALUE SPACES.
   907         16  WS-CARR              PIC X     VALUE SPACE.
   908*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   909*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   910     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   911         88  WS-DMD-LF-RATING   VALUE 'Y'.
   912         88  WS-DMD-AH-RATING   VALUE 'Y'.
   913         88  WS-DMD-NO-RATING   VALUE 'N'.
   914
   915     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   916         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   917                                         'NJ' 'NL'
   918                                         'PJ' 'PL'
   919                                         'SJ' 'SL'.
   920     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   921         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   922                                         'NI' 'NJ' 'NL' 'NU'
   923                                         'PJ' 'PL' 'PI' 'PU'
   924                                         'SI' 'SJ' 'SL' 'SU'
   925                                         'MX' 'MY' 'MZ'.
   926 01  ERPDEF-KEY-SAVE             PIC X(18).
   927 01  ERPDEF-KEY.
   928     12  ERPDEF-COMPANY-CD       PIC X.
   929     12  ERPDEF-STATE            PIC XX.
   930     12  ERPDEF-PROD-CD          PIC XXX.
   931     12  F                       PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  18
* EL050.cbl
   932     12  ERPDEF-BEN-TYPE         PIC X.
   933     12  ERPDEF-BEN-CODE         PIC XX.
   934     12  ERPDEF-EXP-DT           PIC XX.
   935
   936 01  ELSTAT-KEY-SAVE             PIC X(20).
   937 01  ELSTAT-KEY.
   938     12  ELSTAT-COMPANY-ID       PIC XXX.
   939     12  ELSTAT-CARRIER          PIC X.
   940     12  ELSTAT-GROUP            PIC X(6).
   941     12  ELSTAT-STATE            PIC XX.
   942     12  ELSTAT-EXP-DT           PIC 9(8).
   943 01  WS-ERROR-VALUES.
   944     12  ER-1570                     PIC S9(4)   VALUE +1570.
   945     12  ER-1571                     PIC S9(4)   VALUE +1571.
   946     12  er-1572                     pic s9(4)   value +1572.
   947     12  er-1573                     pic s9(4)   value +1573.
   948     12  er-1574                     pic s9(4)   value +1574.
   949     12  ER-1575                     PIC S9(4)   VALUE +1575.
   950     12  er-1576                     pic s9(4)   value +1576.
   951     12  er-1583                     pic s9(4)   value +1583.
   952     12  er-1743                     pic s9(4)   value +1743.
   953     12  er-1744                     pic s9(4)   value +1744.
   954     12  er-1745                     pic s9(4)   value +1745.
   955     12  er-1746                     pic s9(4)   value +1746.
   956     12  er-1747                     pic s9(4)   value +1747.
   957     12  er-1748                     pic s9(4)   value +1748.
   958     12  ER-1891                     PIC S9(4)   VALUE +1891.
   959     12  ER-1892                     PIC S9(4)   VALUE +1892.
   960     12  ER-1893                     PIC S9(4)   VALUE +1893.
   961     12  ER-1894                     PIC S9(4)   VALUE +1894.
   962     12  ER-1895                     PIC S9(4)   VALUE +1895.
   963     12  ER-1896                     PIC S9(4)   VALUE +1896.
   964     12  ER-1897                     PIC S9(4)   VALUE +1897.
   965     12  ER-1898                     PIC S9(4)   VALUE +1898.
   966     12  ER-1899                     PIC S9(4)   VALUE +1899.
   967     12  ER-1900                     PIC S9(4)   VALUE +1900.
   968     12  ER-1901                     PIC S9(4)   VALUE +1901.
   969     12  ER-1902                     PIC S9(4)   VALUE +1902.
   970     12  ER-1903                     PIC S9(4)   VALUE +1903.
   971     12  ER-1904                     PIC S9(4)   VALUE +1904.
   972     12  ER-1905                     PIC S9(4)   VALUE +1905.
   973     12  ER-1906                     PIC S9(4)   VALUE +1906.
   974     12  ER-1907                     PIC S9(4)   VALUE +1907.
   975     12  ER-1909                     PIC S9(4)   VALUE +1909.
   976     12  ER-1910                     PIC S9(4)   VALUE +1910.
   977     12  ER-1911                     PIC S9(4)   VALUE +1911.
   978     12  ER-1912                     PIC S9(4)   VALUE +1912.
   979     12  ER-1913                     PIC S9(4)   VALUE +1913.
   980     12  ER-1914                     PIC S9(4)   VALUE +1914.
   981     12  ER-1915                     PIC S9(4)   VALUE +1915.
   982     12  ER-1916                     PIC S9(4)   VALUE +1916.
   983     12  ER-1917                     PIC S9(4)   VALUE +1917.
   984     12  ER-1918                     PIC S9(4)   VALUE +1918.
   985     12  ER-1919                     PIC S9(4)   VALUE +1919.
   986     12  ER-1920                     PIC S9(4)   VALUE +1920.
   987     12  ER-1921                     PIC S9(4)   VALUE +1921.
   988     12  ER-1922                     PIC S9(4)   VALUE +1922.
   989     12  ER-1923                     PIC S9(4)   VALUE +1923.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  19
* EL050.cbl
   990     12  ER-1924                     PIC S9(4)   VALUE +1924.
   991     12  ER-1925                     PIC S9(4)   VALUE +1925.
   992     12  ER-1926                     PIC S9(4)   VALUE +1926.
   993     12  ER-1927                     PIC S9(4)   VALUE +1927.
   994     12  ER-1955                     PIC s9(4)   VALUE +1955.
   995     12  ER-1956                     PIC s9(4)   VALUE +1956.
   996     12  ER-1957                     PIC s9(4)   VALUE +1957.
   997     12  ER-1958                     PIC s9(4)   VALUE +1958.
   998     12  ER-1959                     PIC s9(4)   VALUE +1959.
   999     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1000     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1001     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1002     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1003     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1004     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1005     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1006     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1007     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1008     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1009     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1010     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1011     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1012     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1013     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1014     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1015     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1016     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1017     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1018     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1019     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1020     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1021     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1022     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1023     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1024     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1025     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1026     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1027     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1028     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1029     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1030     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1031     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1032     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1033     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1034     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1035     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1036     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1037     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1038     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1039     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1040     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1041     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1042     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1043     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1044     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1045     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1046     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1047     12  ER-2643                     PIC S9(4)   VALUE +2643.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  20
* EL050.cbl
  1048     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1049     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1050     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1051     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1052     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1053     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1054     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1055     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1056     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1057     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1058     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1059     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1060     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1061     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1062     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1063     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1064     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1065     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1066     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1067     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1068     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1069     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1070     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1071     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1072     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1073     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1074     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1075     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1076     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1077     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1078     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1079     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1080     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1081     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1082     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1083     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1084     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1085     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1086     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1087     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1088     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1089     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1090     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1091     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1092     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1093     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1094     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1095     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1096     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1097     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1098     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1099     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1100     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1101     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1102     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1103     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1104     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1105     12  ER-2701                     PIC S9(4)   VALUE +2701.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  21
* EL050.cbl
  1106     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1107     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1108     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1109     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1110     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1111     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1112     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1113     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1114     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1115     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1116     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1117     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1118     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1119     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1120     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1121     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1122     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1123     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1124     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1125     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1126     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1127     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1128     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1129     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1130     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1131     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1132     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1133     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1134     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1135     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1136     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1137     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1138     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1139     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1140     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1141     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1142     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1143     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1144     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1145     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1146     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1147     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1148     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1149     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1150     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1151     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1152     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1153     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1154     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1155     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1156     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1157     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1158     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1159     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1160     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1161     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1162     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1163     12  ER-2769                     PIC S9(4)   VALUE +2769.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  22
* EL050.cbl
  1164     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1165     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1166     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1167     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1168     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1169     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1170     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1171     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1172     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1173     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1174     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1175     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1176     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1177     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1178     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1179     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1180     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1181     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1182     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1183     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1184     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1185     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1186     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1187     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1188     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1189     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1190     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1191     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1192     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1193     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1194     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1195     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1196     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1197     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1198     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1199     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1200     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1201     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1202     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1203     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1204     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1205     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1206     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1207     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1208     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1209     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1210     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1211     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1212     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1213     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1214     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1215     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1216     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1217     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1218     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1219     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1220     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1221     12  ER-3063                     PIC S9(4)   VALUE +3063.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  23
* EL050.cbl
  1222     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1223     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1224     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1225     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1226     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1227     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1228     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1229     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1230     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1231     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1232     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1233     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1234     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1235     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1236     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1237     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1238     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1239     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1240     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1241     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1242     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1243     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1244     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1245     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1246     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1247     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1248     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1249     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1250     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1251     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1252     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1253     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1254     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1255     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1256     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1257     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1258     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1259     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1260     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1261     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1262     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1263     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1264     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1265     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1266     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1267     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1268     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1269     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1270     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1271     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1272     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1273     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1274     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1275     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1276     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1277     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1278     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1279     12  ER-8090                     PIC S9(4)   VALUE +8090.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  24
* EL050.cbl
  1280     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1281     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1282     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1283     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1284     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1285     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1286     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1287     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1288     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1289     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1290     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1291     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1292     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1293     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1294     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1295     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1296     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1297     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1298     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1299     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1300     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1301     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1302     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1303     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1304     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1305     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1306     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1307     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1308     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1309     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1310     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1311     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1312     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1313     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1314     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1315     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1316     12  er-9823                     pic s9(4)   value +9823.
  1317     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1318******************************************************************
  1319***************   END OF ELC50WS     ****************************
  1320******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  25
* EL050.cbl
  1323 01  WORKING-STORAGE-WORK-AREAS.
  1324     12  WS-RESPONSE             PIC S9(8)  COMP.
  1325         88  WS-RESP-NORMAL           VALUE +00.
  1326         88  WS-RESP-ERROR            VALUE +01.
  1327         88  WS-RESP-NOTFND           VALUE +13.
  1328         88  WS-RESP-DUPREC           VALUE +14.
  1329         88  WS-RESP-ENDFILE          VALUE +20.
  1330     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1331     12  WORK-AREAS.
  1332         16  WK-CONV-GREG.
  1333             24  WCG-CENT             PIC XX.
  1334             24  WCG-REST             PIC X(4).
  1335         16  WORK-GREGORIAN-DATE.
  1336             24  WK-GREG-CENT         PIC XX.
  1337             24  WK-GREG-DATE-YYMMDD.
  1338                 28  WK-GREG-YYMM     PIC X(4).
  1339                 28  WK-GREG-DD       PIC XX.
  1340
  1341         16  WORK-SELECT-DATE.
  1342             24  WK-SELECT-CENT            PIC XX.
  1343             24  WK-SELECT-DATE-YYMMDD.
  1344                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1345                 28  FILLER                PIC XX.
  1346
  1347         16  WK-FORM-NO.
  1348             24  WK-FORM-BANK-ID       PIC X(5).
  1349             24  WK-FORM-UNDRWRTR      PIC X(1).
  1350             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1351
  1352         16  WK-MEMBER-NO.
  1353             24  WK-MEMBER-1-6        PIC X(6).
  1354             24  WK-MEMBER-7-12       PIC X(6).
  1355
  1356         16  WK-FULL-CERT-NO.
  1357             24  WK-CERT-POS-1-2      PIC X(2).
  1358             24  WK-CERT-POS-3        PIC X(1).
  1359             24  WK-CERT-POS-4        PIC X(1).
  1360             24  WK-CERT-POS-5-6      PIC X(2).
  1361             24  WK-CERT-POS-7        PIC X(1).
  1362             24  WK-CERT-POS-8-11     PIC X(4).
  1363
  1364         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1365             88  VALID-RATE-CODE        VALUE 'Y'.
  1366             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1367
  1368         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1369         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1370         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1371         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1372         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1373         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1374         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1375         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1376         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1377         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1378
  1379* DLO001
  1380 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  26
* EL050.cbl
  1381     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1382     12  DMPF-RETURN-CODE          PIC XX.
  1383         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1384         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1385         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1386         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1387         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1388         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1389
  1390* DLO002
  1391 01  WS-DLO-INTERNAL-POLICY-FORM.
  1392     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1393     12  DIPF-RETURN-CODE          PIC XX.
  1394         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1395         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1396         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1397         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1398         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1399         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1400
  1401* DLO003
  1402 01  WS-DLO-VALID-BANK-ID.
  1403     12  DVBI-BANK-ID              PIC X(5).
  1404     12  DVBI-BANK-ID-TYPE         PIC X.
  1405         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1406         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1407         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1408         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1409         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1410     12  DVBI-RETURN-CODE          PIC XX.
  1411         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1413         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1414         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1415         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1416         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1417         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1418         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1419         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1420
  1421* DLO007
  1422 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1423     12  DCUA-RES-STATE            PIC XX.
  1424     12  DCUA-BEN-TYPE             PIC XX.
  1425     12  DCUA-SYS-IDENT            PIC X.
  1426         88  DCUA-CLAIM                        VALUE 'C'.
  1427         88  DCUA-PREMIUM                      VALUE 'P'.
  1428     12  DCUA-COVERAGE-RULE        PIC X.
  1429     12  DCUA-CLIENT-ID            PIC X(10).
  1430     12  DCUA-EFF-DATE             PIC X(8).
  1431     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1432     12  DCUA-RETURN-CODE          PIC XX.
  1433         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1434     12  DCUA-CERT-NUMBER          PIC X(11).
  1435     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1436     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1437
  1438* DLO011
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  27
* EL050.cbl
  1439 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1440     12  DPRB-RATE-CODE            PIC X(4).
  1441     12  DPRB-COVERAGE-CATEG       PIC X.
  1442     12  DPRB-RETURN-CODE          PIC XX.
  1443         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1444         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1445         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1446         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1447         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1448         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1449         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1450         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1451         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1452     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1453     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1454     12  DPRB-BEN-TYPE             PIC XX.
  1455
  1456* DLO017
  1457 01  WS-DLO-VALID-RATE-CODE.
  1458     12  DVRC-RATE-CODE            PIC X(4).
  1459     12  DVRC-RETURN-CODE          PIC XX.
  1460         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1461         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1462         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1463         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1464         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1465         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1466
  1467* DLO019
  1468 01  WS-DLO-ORIG-COV-CAT.
  1469     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1470     12  DOCC-RETURN-CODE          PIC XX.
  1471     12  DOCC-ORIG-COV-CAT         PIC X.
  1472     12  DOCC-UNDERWITER           PIC XX.
  1473     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1474     12  DOCC-FILLER               PIC X(6).
  1475
  1476* DLO021
  1477 01  WS-DLO-VALID-LOAN-OFFICER.
  1478     12  DVLO-LOAN-OFFICER.
  1479         16  DVLO-BILL-TYPE        PIC X.
  1480         16  DVLO-BILL-SOURCE      PIC X.
  1481         16  DVLO-BATCH-TYPE       PIC X.
  1482     12  DVLO-RETURN-CODE          PIC XX.
  1483         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1484         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1485         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1486         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1487         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1488         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1489
  1490* DLO022
  1491 01  WS-DLO-VALID-STATE-CODE.
  1492     12  DVSC-STATE-CODE           PIC XX.
  1493     12  DVSC-RETURN-CODE          PIC XX.
  1494         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1495
  1496* DLO023
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  28
* EL050.cbl
  1497 01  WS-DLO-VALID-CODE-VALUES.
  1498     12  DVCV-SYSTEM-ID            PIC XX.
  1499         88  DVCV-CLAIMS                       VALUE 'CL'.
  1500         88  DVCV-CREDIT                       VALUE 'CR'.
  1501     12  DVCV-RECORD-TYPE          PIC XX.
  1502         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1503         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1504         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1505         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1506         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1507         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1508         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1509         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1510     12  DVCV-RECORD-KEY           PIC X(6).
  1511     12  DVCV-RETURN-CODE          PIC XX.
  1512         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1513         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1514         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1515         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1516         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1517         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1518         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1519     12  DVCV-CODE-DESC            PIC X(60).
  1520     12  DVCV-GEN-DESC-1           PIC X(20).
  1521     12  DVCV-GEN-DESC-2           PIC X(20).
  1522     12  DVCV-GEN-DESC-3           PIC X(20).
  1523
  1524 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1525 01  hldi-pass-area.
  1526     03  PA-VIN                  PIC X(17).
  1527     03  PA-ErrorCode            PIC X(10).
  1528     03  PA-ErrorDesc            PIC X(30).
  1529     03  PA-ModelYear            PIC 9(7).
  1530     03  PA-MakeName             PIC X(50).
  1531     03  PA-ModelName            PIC X(50).
  1532     03  PA-SeriesName           PIC X(50).
  1533 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1534 01  zipcd-pass-area.
  1535     03  PA-zip                  PIC X(5).
  1536     03  PA-ErrorCode-zip        PIC X(10).
  1537     03  PA-city                 PIC x(50).
  1538     03  PA-state                PIC Xx.
  1539****  this is for aggregate report.
  1540****  Length is erpndb + 100 of passed-key-area
  1541 01  ws-passed-key-length        pic s9(4) comp value +587.
  1542 01  ws-pass-to-pemaggo.
  1543     05  ws-passed-erpndb        pic x(585).
  1544     05  ws-exceed-limit-yn      pic x.
  1545     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  29
* EL050.cbl
  1547*    COPY ERCBXRF.
  1548******************************************************************
  1549*                                                                *
  1550*                                                                *
  1551*                            ERCBXRF                             *
  1552*                                                                *
  1553*   ONLINE CREDIT SYSTEM                                         *
  1554*                                                                *
  1555*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1556*                                                                *
  1557*   FILE TYPE = VSAM,KSDS                                        *
  1558*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1559*                                                                *
  1560*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1561*       ALTERNATE PATH = NONE                                    *
  1562*                                                                *
  1563*   LOG = NO                                                     *
  1564*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1565*                                                                *
  1566******************************************************************
  1567
  1568 01  BANK-CROSS-REFERENCE.
  1569     12  BK-RECORD-ID                PIC XX.
  1570         88  VALID-BK-ID             VALUE 'BK'.
  1571
  1572     12  BK-CONTROL-PRIMARY.
  1573         16  BK-COMPANY-CD           PIC X.
  1574         16  BK-CARRIER              PIC X.
  1575         16  BK-GROUPING             PIC X(6).
  1576         16  BK-BANK-NO              PIC X(10).
  1577
  1578     12  BK-MAINT-INFORMATION.
  1579         16  BK-LAST-MAINT-DT        PIC XX.
  1580         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1581         16  BK-LAST-MAINT-USER      PIC X(4).
  1582         16  FILLER                  PIC X(9).
  1583
  1584     12  FILLER                      PIC X(37).
  1585
  1586     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1587
  1588     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1589                            DEPENDING ON BK-BANK-POINTER-CNT.
  1590         16  BK-AM-ACCOUNT           PIC X(10).
  1591         16  BK-AM-EXP-DT            PIC XX.
  1592         16  BK-AM-EFF-DT            PIC XX.
  1593         16  BK-AM-STATE             PIC XX.
  1594         16  FILLER                  PIC X(20).
  1595
  1596******************************************************************
  1597
  1598*    COPY ERCCOMP.
  1599******************************************************************
  1600*                                                                *
  1601*                                                                *
  1602*                            ERCCOMP                             *
  1603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1604*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  30
* EL050.cbl
  1605*                                                                *
  1606*   ONLINE CREDIT SYSTEM                                         *
  1607*                                                                *
  1608*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1609*                                                                *
  1610*   FILE TYPE = VSAM,KSDS                                        *
  1611*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1612*                                                                *
  1613*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1614*       ALTERNATE PATH = NONE                                    *
  1615*                                                                *
  1616*   LOG = NO                                                     *
  1617*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1618*                                                                *
  1619******************************************************************
  1620*                   C H A N G E   L O G
  1621*
  1622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1623*-----------------------------------------------------------------
  1624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1625* EFFECTIVE    NUMBER
  1626*-----------------------------------------------------------------
  1627* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1628* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1629* 092205    2005050300006  PEMA  ADD LEASE FEE
  1630* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1631* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1632* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1633* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1634* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1635* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1636******************************************************************
  1637
  1638 01  COMPENSATION-MASTER.
  1639     12  CO-RECORD-ID                          PIC XX.
  1640         88  VALID-CO-ID                          VALUE 'CO'.
  1641
  1642     12  CO-CONTROL-PRIMARY.
  1643         16  CO-COMPANY-CD                     PIC X.
  1644         16  CO-CONTROL.
  1645             20  CO-CTL-1.
  1646                 24  CO-CARR-GROUP.
  1647                     28  CO-CARRIER            PIC X.
  1648                     28  CO-GROUPING.
  1649                         32  CO-GROUP-PREFIX   PIC XXX.
  1650                         32  CO-GROUP-PRIME    PIC XXX.
  1651                 24  CO-RESP-NO.
  1652                     28  CO-RESP-PREFIX        PIC X(4).
  1653                     28  CO-RESP-PRIME         PIC X(6).
  1654             20  CO-CTL-2.
  1655                 24  CO-ACCOUNT.
  1656                     28  CO-ACCT-PREFIX        PIC X(4).
  1657                     28  CO-ACCT-PRIME         PIC X(6).
  1658         16  CO-TYPE                           PIC X.
  1659             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1660             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1661             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1662
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  31
* EL050.cbl
  1663     12  CO-MAINT-INFORMATION.
  1664         16  CO-LAST-MAINT-DT                  PIC XX.
  1665         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1666         16  CO-LAST-MAINT-USER                PIC X(4).
  1667     12  FILLER                                PIC XX.
  1668     12  CO-STMT-TYPE                          PIC XXX.
  1669     12  CO-COMP-TYPE                          PIC X.
  1670         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1671     12  CO-STMT-OWNER                         PIC X(4).
  1672     12  CO-BALANCE-CONTROL                    PIC X.
  1673         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1674         88  CO-NO-BALANCE                        VALUE 'N'.
  1675
  1676     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1677         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1678         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1679         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1680
  1681     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1682         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1683         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1684
  1685     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1686     12  CO-GA-DIRECT-DEP                      PIC X.
  1687     12  CO-FUTURE-SPACE                       PIC X.
  1688         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1689
  1690     12  CO-ACCT-NAME                          PIC X(30).
  1691     12  CO-MAIL-NAME                          PIC X(30).
  1692     12  CO-ADDR-1                             PIC X(30).
  1693     12  CO-ADDR-2                             PIC X(30).
  1694     12  CO-ADDR-3.
  1695         16  CO-ADDR-CITY                      PIC X(27).
  1696         16  CO-ADDR-STATE                     PIC XX.
  1697     12  CO-CSO-1099                           PIC X.
  1698     12  CO-ZIP.
  1699         16  CO-ZIP-PRIME.
  1700             20  CO-ZIP-PRI-1ST                PIC X.
  1701                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1702             20  FILLER                        PIC X(4).
  1703         16  CO-ZIP-PLUS4                      PIC X(4).
  1704     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1705         16  CO-CAN-POSTAL-1                   PIC XXX.
  1706         16  CO-CAN-POSTAL-2                   PIC XXX.
  1707         16  FILLER                            PIC XXX.
  1708     12  CO-SOC-SEC                            PIC X(13).
  1709     12  CO-TELEPHONE.
  1710         16  CO-AREA-CODE                      PIC XXX.
  1711         16  CO-PREFIX                         PIC XXX.
  1712         16  CO-PHONE                          PIC X(4).
  1713
  1714     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1715
  1716     12  CO-AR-BAL-LEVEL                       PIC X.
  1717         88  CO-AR-REF-LVL                        VALUE '1'.
  1718         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1719         88  CO-AR-BILL-LVL                       VALUE '2'.
  1720         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  32
* EL050.cbl
  1721         88  CO-AR-FR-LVL                         VALUE '4'.
  1722
  1723     12  CO-AR-NORMAL-PRINT                    PIC X.
  1724         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1725         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1726
  1727     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1728
  1729     12  CO-AR-REPORTING                       PIC X.
  1730         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1731         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1732
  1733     12  CO-AR-PULL-CHECK                      PIC X.
  1734         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1735         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1736
  1737     12  CO-AR-BALANCE-PRINT                   PIC X.
  1738         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1739
  1740     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1741         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1742         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1743         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1744
  1745     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1746
  1747     12  CO-USER-CODE                          PIC X.
  1748     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1749
  1750******************************************************************
  1751*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1752*    THE LAST MONTH END RUN.
  1753******************************************************************
  1754
  1755     12  CO-LAST-ACTIVITY-DATE.
  1756         16  CO-ACT-YEAR                       PIC 99.
  1757         16  CO-ACT-MONTH                      PIC 99.
  1758         16  CO-ACT-DAY                        PIC 99.
  1759
  1760     12  CO-LAST-STMT-DT.
  1761         16  CO-LAST-STMT-YEAR                 PIC 99.
  1762         16  CO-LAST-STMT-MONTH                PIC 99.
  1763         16  CO-LAST-STMT-DAY                  PIC 99.
  1764
  1765     12  CO-MO-END-TOTALS.
  1766         16  CO-MONTHLY-TOTALS.
  1767             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1768             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1769             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1770             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1771             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1772
  1773         16  CO-AGING-TOTALS.
  1774             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1775             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1776             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1777             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1778
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  33
* EL050.cbl
  1779         16  CO-YTD-TOTALS.
  1780             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1781             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1782
  1783         16  CO-OVER-UNDER-TOTALS.
  1784             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1785             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1786
  1787     12  CO-MISCELLANEOUS-TOTALS.
  1788         16  CO-FICA-TOTALS.
  1789             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1790             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1791
  1792         16  CO-CLAIM-TOTALS.
  1793             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1794             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1795
  1796******************************************************************
  1797*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1798*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1799******************************************************************
  1800
  1801     12  CO-CURRENT-TOTALS.
  1802         16  CO-CURRENT-LAST-STMT-DT.
  1803             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1804             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1805             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1806
  1807         16  CO-CURRENT-MONTHLY-TOTALS.
  1808             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1809             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1810             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1811             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1812             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1813
  1814         16  CO-CURRENT-AGING-TOTALS.
  1815             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1816             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1817             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1818             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1819
  1820         16  CO-CURRENT-YTD-TOTALS.
  1821             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1822             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1823
  1824     12  CO-PAID-COMM-TOTALS.
  1825         16  CO-YTD-PAID-COMMS.
  1826             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1827             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1828
  1829     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1830         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1831         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1832
  1833     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1834         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1835         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1836         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  34
* EL050.cbl
  1837         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1838         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1839         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1840         88  CO-FINAL-LETTER                  VALUE 'F'.
  1841         88  CO-RECONCILING                   VALUE 'R'.
  1842         88  CO-PHONE-CALL                    VALUE 'P'.
  1843         88  CO-LEGAL                         VALUE 'L'.
  1844         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1845         88  CO-WRITE-OFF                     VALUE 'W'.
  1846         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1847
  1848     12  CO-CSR-CODE                       PIC X(4).
  1849
  1850     12  CO-GA-STATUS-INFO.
  1851         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1852         16  CO-GA-TERMINATION-DT          PIC XX.
  1853         16  CO-GA-STATUS-CODE             PIC X.
  1854             88  CO-GA-ACTIVE                 VALUE 'A'.
  1855             88  CO-GA-INACTIVE               VALUE 'I'.
  1856             88  CO-GA-PENDING                VALUE 'P'.
  1857         16  CO-GA-COMMENTS.
  1858             20  CO-GA-COMMENT-1           PIC X(40).
  1859             20  CO-GA-COMMENT-2           PIC X(40).
  1860             20  CO-GA-COMMENT-3           PIC X(40).
  1861             20  CO-GA-COMMENT-4           PIC X(40).
  1862
  1863     12  CO-RPTCD2                         PIC X(10).
  1864     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1865         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1866         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1867
  1868     12  CO-TYPE-AGENT                     PIC X(01).
  1869         88  CO-CORPORATION                   VALUE 'C'.
  1870         88  CO-PARTNERSHIP                   VALUE 'P'.
  1871         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1872         88  CO-TRUST                         VALUE 'T'.
  1873         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1874
  1875     12  CO-FAXNO.
  1876         16  CO-FAX-AREA-CODE                  PIC XXX.
  1877         16  CO-FAX-PREFIX                     PIC XXX.
  1878         16  CO-FAX-PHONE                      PIC X(4).
  1879
  1880     12  CO-BANK-INFORMATION.
  1881         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1882         16  CO-BANK-TRANSIT-NON REDEFINES
  1883             CO-BANK-TRANSIT-NO                PIC 9(8).
  1884
  1885         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1886     12  CO-MISC-DEDUCT-INFO REDEFINES
  1887                  CO-BANK-INFORMATION.
  1888         16  CO-MD-GL-ACCT                     PIC X(10).
  1889         16  CO-MD-DIV                         PIC XX.
  1890         16  CO-MD-CENTER                      PIC X(4).
  1891         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1892         16  CO-CREATE-AP-CHECK                PIC X.
  1893         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1894         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  35
* EL050.cbl
  1895     12  CO-ACH-STATUS                         PIC X.
  1896         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1897         88  CO-ACH-PENDING                        VALUE 'P'.
  1898
  1899     12  CO-BILL-SW                            PIC X.
  1900     12  CO-CONTROL-NAME                       PIC X(30).
  1901     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1902     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1903     12  CO-CLP-STATE                          PIC XX.
  1904     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1905     12  CO-SPP-REFUND-EDIT                    PIC X.
  1906
  1907******************************************************************
  1908
  1909*    COPY ERCAGTC.
  1910******************************************************************
  1911*                                                                *
  1912*                                                                *
  1913*                            ERCAGTC                             *
  1914*                            VMOD=2.001                          *
  1915*                                                                *
  1916*   ONLINE CREDIT SYSTEM                                         *
  1917*                                                                *
  1918*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1919*                                                                *
  1920*   FILE TYPE = VSAM,KSDS                                        *
  1921*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1922*                                                                *
  1923*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1924*       ALTERNATE PATH = NONE                                    *
  1925*                                                                *
  1926*   LOG = NO                                                     *
  1927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1928*                                                                *
  1929******************************************************************
  1930*                   C H A N G E   L O G
  1931*
  1932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1933*-----------------------------------------------------------------
  1934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1935* EFFECTIVE    NUMBER
  1936*-----------------------------------------------------------------
  1937* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1938* 111004                         NEW FILE AND COPYBOOK
  1939* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1940******************************************************************
  1941 01  AGENT-COMMISSIONS.
  1942     12  AG-RECORD-ID                          PIC XX.
  1943         88  VALID-CO-ID                          VALUE 'AG'.
  1944     12  AG-CONTROL-PRIMARY.
  1945         16  AG-COMPANY-CD                     PIC X.
  1946         16  AG-CONTROL.
  1947             20  AG-CTL-1.
  1948                 24  AG-CARR-GROUP.
  1949                     28  AG-CARRIER            PIC X.
  1950                     28  AG-GROUPING           PIC X(6).
  1951                 24  AG-BANK                   PIC X(10).
  1952             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  36
* EL050.cbl
  1953                 24  AG-EXP-DT                 PIC XX.
  1954         16  AG-TYPE                           PIC X.
  1955             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1956             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1957     12  AG-MAINT-INFORMATION.
  1958         16  AG-LAST-MAINT-DT                  PIC XX.
  1959         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1960         16  AG-LAST-MAINT-USER                PIC X(4).
  1961         16  FILLER                            PIC X(10).
  1962     12  AG-EFF-DT                             PIC XX.
  1963     12  AG-COMM-STRUCTURE.
  1964         16  AG-AGT-COMMS OCCURS 10.
  1965             20  AG-AGT                PIC X(10).
  1966             20  AG-COM-TYP            PIC X.
  1967             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1968             20  AG-RECALC-LV-INDIC    PIC X.
  1969             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1970             20  AG-LRCALC-LV-INDIC    PIC X.
  1971             20  FILLER                PIC X(05).
  1972     12  FILLER                  PIC X(145).
  1973******************************************************************
  1974*    COPY ERCRESS.
  1975******************************************************************
  1976*                                                                *
  1977*                            ERCRESS                             *
  1978*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1979*                            VMOD=2.002                          *
  1980*                                                                *
  1981*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1982*                                                                *
  1983*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1984*   VSAM RESIDENT STATE TAX MASTER                              *
  1985*                                                                *
  1986*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1987*                                                                *
  1988*   FILE TYPE = VSAM,KSDS                                        *
  1989*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1990*                                                                *
  1991*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1992*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1993*                                                                *
  1994*   LOG = NO                                                     *
  1995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1996*                                                                *
  1997*                                                                *
  1998******************************************************************
  1999
  2000 01  RESIDENT-STATE-TAX-MASTER.
  2001
  2002     10  ERRESS-PRIMARY-KEY.
  2003         15  RES-COMPANY-CD        PIC X.
  2004         15  RES-RESIDENT-STATE    PIC XX.
  2005         15  RES-COVERAGE-CATEGORY PIC X.
  2006         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2007*                                      YYYYMMDD
  2008*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2009
  2010     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  37
* EL050.cbl
  2011
  2012         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2013         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2014         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2015         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2016
  2017     10 RES-RECALC-SW              PIC   X.
  2018         88 RECALC                VALUE 'Y'.
  2019         88 NO-RECALC             VALUE 'N'.
  2020     10  RES-MAINT-BY              PIC X(4).
  2021     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2022     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2023*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  38
* EL050.cbl
  2025*    COPY ERCRESC.
  2026******************************************************************
  2027*                                                                *
  2028*                            ERCRESC                             *
  2029*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2030*                            VMOD=2.003                          *
  2031*                                                                *
  2032*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2033*                                                                *
  2034*   FILE TYPE = VSAM,KSDS                                        *
  2035*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2036*                                                                *
  2037*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2038*       ALTERNATE PATH1 = NONE                                   *
  2039*                                                                *
  2040*   LOG = NO                                                     *
  2041*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2042*                                                                *
  2043******************************************************************
  2044
  2045 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2046
  2047     10  ERRESC-RECORD-KEY.
  2048         15  RESC-COMPANY-CD           PIC   X.
  2049         15  RESC-CARRIER              PIC   X.
  2050         15  RESC-GROUP                PIC   X(6).
  2051         15  RESC-STATE                PIC   XX.
  2052         15  RESC-ACCOUNT              PIC   X(10).
  2053         15  RESC-AGENT                PIC   X(10).
  2054         15  RESC-RESIDENT-STATE       PIC   XX.
  2055         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2056*                                           YYYYMMDD
  2057     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2058
  2059     10  RESC-COMM-RECORD-DATA.
  2060         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2061             20 RESC-COVERAGE-CAT      PIC    X.
  2062             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2063             20 RESC-COMMISSION-TAB REDEFINES
  2064                RESC-COMMISSION-PER    PIC  XXX.
  2065
  2066     10  RESC-MAINT-BY                 PIC X(4).
  2067     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2068     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2069*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  39
* EL050.cbl
  2071*    COPY ERCPLAN.
  2072******************************************************************
  2073*                                                                *
  2074*                                                                *
  2075*                            ERCPLAN                             *
  2076*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2077*                            VMOD=2.003                          *
  2078*                                                                *
  2079*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2080*                                                                *
  2081*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2082*   PLAN MASTER                                                  *
  2083*                                                                *
  2084*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2085*                                                                *
  2086*   FILE TYPE = VSAM,KSDS                                        *
  2087*   RECORD SIZE = 420   RECFORM = FIX                            *
  2088*                                                                *
  2089*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2090*       ALTERNATE PATH1 = N/A                                    *
  2091*                                                                *
  2092*   LOG = NO                                                     *
  2093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2094*                                                                *
  2095*                                                                *
  2096******************************************************************
  2097
  2098 01  PLAN-MASTER.
  2099     12  PL-RECORD-ID                      PIC XX.
  2100         88  VALID-PL-ID                      VALUE 'PL'.
  2101
  2102     12  PL-CONTROL-PRIMARY.
  2103         16  PL-COMPANY-CD                 PIC X.
  2104         16  PL-MSTR-CNTRL.
  2105             20  PL-CONTROL-A.
  2106                 24  PL-CARRIER            PIC X.
  2107                 24  PL-GROUPING           PIC X(6).
  2108                 24  PL-STATE              PIC XX.
  2109                 24  PL-ACCOUNT            PIC X(10).
  2110             20  PL-BENEFIT-TYPE           PIC X.
  2111             20  PL-BENEFIT-CODE           PIC XX.
  2112             20  PL-REVISION-NO            PIC X(3).
  2113
  2114     12  PL-CONTROL-BY-VAR-GRP.
  2115         16  PL-COMPANY-CD-A1              PIC X.
  2116         16  PL-VG-CARRIER                 PIC X.
  2117         16  PL-VG-GROUPING                PIC X(6).
  2118         16  PL-VG-STATE                   PIC XX.
  2119         16  PL-VG-ACCOUNT                 PIC X(10).
  2120         16  PL-BENEFIT-TYPE-A1            PIC X.
  2121         16  PL-BENEFIT-CODE-A1            PIC XX.
  2122         16  PL-REVISION-NO-A1             PIC 999.
  2123
  2124     12  PL-MAINT-INFORMATION.
  2125         16  PL-LAST-MAINT-DT              PIC XX.
  2126         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2127         16  PL-LAST-MAINT-USER            PIC X(4).
  2128         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  40
* EL050.cbl
  2129
  2130     12  PL-LIABILITY-LIMITS.
  2131         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2132         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2133             20  PL-LM-AGE                 PIC S99        COMP-3.
  2134             20  PL-LM-DUR                 PIC S999       COMP-3.
  2135             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2136             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2137
  2138     12  FILLER                            PIC X(30).
  2139
  2140     12  PL-GL-ACCOUNT-NOS.
  2141         16  PL-PREMIUM-GL                 PIC X(8).
  2142         16  PL-COMM-GL                    PIC X(8).
  2143         16  PL-CLAIM-GL                   PIC X(8).
  2144     12  FILLER                            PIC X(24).
  2145     12  PL-TOLERANCES.
  2146         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2147         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2148         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2149         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2150         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2151         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2152     12  PL-OVER-SHORT.
  2153         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2154         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2155     12  FILLER                            PIC X(24).
  2156     12  PLAN-MISC.
  2157         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2158         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2159         16  PL-IG                         PIC X.
  2160         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2161         16  PL-POLICY-FORM                PIC X(12).
  2162         16  PL-EDIT-FOR-FORM              PIC X(01).
  2163         16  PL-DEV-CODE                   PIC XXX.
  2164         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2165         16  PL-CALC-METHOD                PIC X.
  2166         16  PL-BENEFIT-GROUP              PIC X(05).
  2167         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2168
  2169         16  FILLER                        PIC X(99).
  2170******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  41
* EL050.cbl
  2172*    COPY ELCCERT.
  2173******************************************************************
  2174*                                                                *
  2175*                            ELCCERT.                            *
  2176*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2177*                            VMOD=2.013                          *
  2178*                                                                *
  2179*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2180*                                                                *
  2181*   FILE TYPE = VSAM,KSDS                                        *
  2182*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2183*                                                                *
  2184*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2185*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2186*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2187*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2188*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2189*                                                                *
  2190*   LOG = YES                                                    *
  2191*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2192******************************************************************
  2193*                   C H A N G E   L O G
  2194*
  2195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2196*-----------------------------------------------------------------
  2197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2198* EFFECTIVE    NUMBER
  2199*-----------------------------------------------------------------
  2200* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2201* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2202* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2203* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2204* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2205* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2206* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2207* 032612  CR2011110200001  PEMA  AHL CHANGES
  2208* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2209* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2210* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2211******************************************************************
  2212
  2213 01  CERTIFICATE-MASTER.
  2214     12  CM-RECORD-ID                      PIC XX.
  2215         88  VALID-CM-ID                      VALUE 'CM'.
  2216
  2217     12  CM-CONTROL-PRIMARY.
  2218         16  CM-COMPANY-CD                 PIC X.
  2219         16  CM-CARRIER                    PIC X.
  2220         16  CM-GROUPING.
  2221             20  CM-GROUPING-PREFIX        PIC X(3).
  2222             20  CM-GROUPING-PRIME         PIC X(3).
  2223         16  CM-STATE                      PIC XX.
  2224         16  CM-ACCOUNT.
  2225             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2226             20  CM-ACCOUNT-PRIME          PIC X(6).
  2227         16  CM-CERT-EFF-DT                PIC XX.
  2228         16  CM-CERT-NO.
  2229             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  42
* EL050.cbl
  2230             20  CM-CERT-SFX               PIC X.
  2231
  2232     12  CM-CONTROL-BY-NAME.
  2233         16  CM-COMPANY-CD-A1              PIC X.
  2234         16  CM-INSURED-LAST-NAME          PIC X(15).
  2235         16  CM-INSURED-INITIALS.
  2236             20  CM-INSURED-INITIAL1       PIC X.
  2237             20  CM-INSURED-INITIAL2       PIC X.
  2238
  2239     12  CM-CONTROL-BY-SSN.
  2240         16  CM-COMPANY-CD-A2              PIC X.
  2241         16  CM-SOC-SEC-NO.
  2242             20  CM-SSN-STATE              PIC XX.
  2243             20  CM-SSN-ACCOUNT            PIC X(6).
  2244             20  CM-SSN-LN3.
  2245                 25  CM-INSURED-INITIALS-A2.
  2246                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2247                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2248                 25 CM-PART-LAST-NAME-A2         PIC X.
  2249
  2250     12  CM-CONTROL-BY-CERT-NO.
  2251         16  CM-COMPANY-CD-A4              PIC X.
  2252         16  CM-CERT-NO-A4                 PIC X(11).
  2253
  2254     12  CM-CONTROL-BY-MEMB.
  2255         16  CM-COMPANY-CD-A5              PIC X.
  2256         16  CM-MEMBER-NO.
  2257             20  CM-MEMB-STATE             PIC XX.
  2258             20  CM-MEMB-ACCOUNT           PIC X(6).
  2259             20  CM-MEMB-LN4.
  2260                 25  CM-INSURED-INITIALS-A5.
  2261                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2262                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2263                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2264
  2265     12  CM-INSURED-PROFILE-DATA.
  2266         16  CM-INSURED-FIRST-NAME.
  2267             20  CM-INSURED-1ST-INIT       PIC X.
  2268             20  FILLER                    PIC X(9).
  2269         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2270         16  CM-INSURED-SEX                PIC X.
  2271             88  CM-SEX-MALE                  VALUE 'M'.
  2272             88  CM-SEX-FEMAL                 VALUE 'F'.
  2273         16  CM-INSURED-JOINT-AGE          PIC 99.
  2274         16  CM-JOINT-INSURED-NAME.
  2275             20  CM-JT-LAST-NAME           PIC X(15).
  2276             20  CM-JT-FIRST-NAME.
  2277                 24  CM-JT-1ST-INIT        PIC X.
  2278                 24  FILLER                PIC X(9).
  2279             20  CM-JT-INITIAL             PIC X.
  2280
  2281     12  CM-LIFE-DATA.
  2282         16  CM-LF-BENEFIT-CD              PIC XX.
  2283         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2284         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2285         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2286         16  CM-LF-DEV-CODE                PIC XXX.
  2287         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  43
* EL050.cbl
  2288         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2289         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2290         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2291         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2292         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2293         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2294         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2295         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2296         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2297         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2298         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2299         16  cm-temp-epiq                  pic xx.
  2300             88  EPIQ-CLASS                  value 'EQ'.
  2301*        16  FILLER                        PIC XX.
  2302
  2303     12  CM-AH-DATA.
  2304         16  CM-AH-BENEFIT-CD              PIC XX.
  2305         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2306         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2307         16  CM-AH-DEV-CODE                PIC XXX.
  2308         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2309         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2310         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2311         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2312         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2313         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2314         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2315         16  CM-AH-PAID-THRU-DT            PIC XX.
  2316             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2317         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2318         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2319         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2320         16  FILLER                        PIC X.
  2321
  2322     12  CM-LOAN-INFORMATION.
  2323         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2324         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2325                                           PIC S9(5)V99  COMP-3.
  2326         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2327         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2328         16  CM-PAY-FREQUENCY              PIC S99.
  2329         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2330         16  CM-RATE-CLASS                 PIC XX.
  2331         16  CM-BENEFICIARY                PIC X(25).
  2332         16  CM-POLICY-FORM-NO             PIC X(12).
  2333         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2334         16  CM-LAST-ADD-ON-DT             PIC XX.
  2335         16  CM-DEDUCTIBLE-AMOUNTS.
  2336             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2337             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2338         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2339             20  CM-RESIDENT-STATE         PIC XX.
  2340             20  CM-RATE-CODE              PIC X(4).
  2341             20  FILLER                    PIC XX.
  2342         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2343             20  CM-LOAN-OFFICER           PIC X(5).
  2344             20  FILLER                    PIC XXX.
  2345         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  44
* EL050.cbl
  2346         16  CM-UNDERWRITING-CODE          PIC X.
  2347             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2348         16  CM-POST-CARD-IND              PIC X.
  2349         16  CM-REF-INTERFACE-SW           PIC X.
  2350         16  CM-PREMIUM-TYPE               PIC X.
  2351             88  CM-SING-PRM                  VALUE '1'.
  2352             88  CM-O-B-COVERAGE              VALUE '2'.
  2353             88  CM-OPEN-END                  VALUE '3'.
  2354         16  CM-IND-GRP-TYPE               PIC X.
  2355             88  CM-INDIVIDUAL                VALUE 'I'.
  2356             88  CM-GROUP                     VALUE 'G'.
  2357         16  CM-SKIP-CODE                  PIC X.
  2358             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2359             88  SKIP-JULY                    VALUE '1'.
  2360             88  SKIP-AUGUST                  VALUE '2'.
  2361             88  SKIP-SEPTEMBER               VALUE '3'.
  2362             88  SKIP-JULY-AUG                VALUE '4'.
  2363             88  SKIP-AUG-SEPT                VALUE '5'.
  2364             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2365             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2366             88  SKIP-JUNE                    VALUE '8'.
  2367             88  SKIP-JUNE-JULY               VALUE '9'.
  2368             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2369             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2370         16  CM-PAYMENT-MODE               PIC X.
  2371             88  PAY-MONTHLY                  VALUE SPACE.
  2372             88  PAY-WEEKLY                   VALUE '1'.
  2373             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2374             88  PAY-BI-WEEKLY                VALUE '3'.
  2375             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2376         16  CM-LOAN-NUMBER                PIC X(8).
  2377         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2378         16  CM-OLD-LOF                    PIC XXX.
  2379*        16  CM-LOAN-OFFICER               PIC XXX.
  2380         16  CM-REIN-TABLE                 PIC XXX.
  2381         16  CM-SPECIAL-REIN-CODE          PIC X.
  2382         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2383         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2384         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2385
  2386     12  CM-STATUS-DATA.
  2387         16  CM-ENTRY-STATUS               PIC X.
  2388         16  CM-ENTRY-DT                   PIC XX.
  2389
  2390         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2391         16  CM-LF-CANCEL-DT               PIC XX.
  2392         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2393
  2394         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2395         16  CM-LF-DEATH-DT                PIC XX.
  2396         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2397
  2398         16  CM-LF-CURRENT-STATUS          PIC X.
  2399             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2400                                                'M' '4' '5' '9'.
  2401             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2402             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2403             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  45
* EL050.cbl
  2404             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2405             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2406             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2407             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2408             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2409             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2410             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2411             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2412             88  CM-LF-DECLINED               VALUE 'D'.
  2413             88  CM-LF-VOIDED                 VALUE 'V'.
  2414
  2415         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2416         16  CM-AH-CANCEL-DT               PIC XX.
  2417         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2418
  2419         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2420         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2421         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2422
  2423         16  CM-AH-CURRENT-STATUS          PIC X.
  2424             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2425                                                'M' '4' '5' '9'.
  2426             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2427             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2428             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2429             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2430             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2431             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2432             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2433             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2434             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2435             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2436             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2437             88  CM-AH-DECLINED               VALUE 'D'.
  2438             88  CM-AH-VOIDED                 VALUE 'V'.
  2439
  2440         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2441             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2442             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2443             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2444         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2445
  2446         16  CM-ENTRY-BATCH                PIC X(6).
  2447         16  CM-LF-EXIT-BATCH              PIC X(6).
  2448         16  CM-AH-EXIT-BATCH              PIC X(6).
  2449         16  CM-LAST-MONTH-END             PIC XX.
  2450
  2451     12  CM-NOTE-SW                        PIC X.
  2452         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2453         88  CERT-NOTES-PRESENT               VALUE '1'.
  2454         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2455         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2456         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2457         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2458         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2459         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2460     12  CM-COMP-EXCP-SW                   PIC X.
  2461         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  46
* EL050.cbl
  2462         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2463     12  CM-INSURED-ADDRESS-SW             PIC X.
  2464         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2465         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2466
  2467*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2468     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2469     12  FILLER                            PIC X.
  2470
  2471*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2472     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2473     12  FILLER                            PIC X.
  2474*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2475     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2476
  2477     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2478         88  CERT-ADDED-BATCH                 VALUE ' '.
  2479         88  CERT-ADDED-ONLINE                VALUE '1'.
  2480         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2481         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2482         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2483     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2484         88  CERT-AS-LOADED                   VALUE ' '.
  2485         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2486         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2487         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2488         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2489         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2490         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2491         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2492
  2493     12  CM-ACCOUNT-COMM-PCTS.
  2494         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2495         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2496
  2497     12  CM-USER-FIELD                     PIC X.
  2498     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2499     12  CM-CLP-STATE                      PIC XX.
  2500     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2501     12  CM-USER-RESERVED                  PIC XXX.
  2502     12  FILLER REDEFINES CM-USER-RESERVED.
  2503         16  CM-AH-CLASS-CD                PIC XX.
  2504         16  F                             PIC X.
  2505******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  47
* EL050.cbl
  2507*    COPY ERCMAIL.
  2508******************************************************************
  2509*                                                                *
  2510*                                                                *
  2511*                            ERCMAIL                             *
  2512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2513*                            VMOD=2.003                          *
  2514*                                                                *
  2515*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2516*                                                                *
  2517*   FILE TYPE = VSAM,KSDS                                        *
  2518*   RECORD SIZE = 374   RECFORM = FIX                            *
  2519*                                                                *
  2520*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2521*   ALTERNATE PATH    = NOT USED                                 *
  2522*                                                                *
  2523*   LOG = YES                                                    *
  2524*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2525******************************************************************
  2526*                   C H A N G E   L O G
  2527*
  2528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2529*-----------------------------------------------------------------
  2530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2531* EFFECTIVE    NUMBER
  2532*-----------------------------------------------------------------
  2533* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2534* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2535* 111108                   PEMA  ADD CRED BENE ADDR2
  2536******************************************************************
  2537
  2538 01  MAILING-DATA.
  2539     12  MA-RECORD-ID                      PIC XX.
  2540         88  VALID-MA-ID                       VALUE 'MA'.
  2541
  2542     12  MA-CONTROL-PRIMARY.
  2543         16  MA-COMPANY-CD                 PIC X.
  2544         16  MA-CARRIER                    PIC X.
  2545         16  MA-GROUPING.
  2546             20  MA-GROUPING-PREFIX        PIC XXX.
  2547             20  MA-GROUPING-PRIME         PIC XXX.
  2548         16  MA-STATE                      PIC XX.
  2549         16  MA-ACCOUNT.
  2550             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2551             20  MA-ACCOUNT-PRIME          PIC X(6).
  2552         16  MA-CERT-EFF-DT                PIC XX.
  2553         16  MA-CERT-NO.
  2554             20  MA-CERT-PRIME             PIC X(10).
  2555             20  MA-CERT-SFX               PIC X.
  2556
  2557     12  FILLER                            PIC XX.
  2558
  2559     12  MA-ACCESS-CONTROL.
  2560         16  MA-SOURCE-SYSTEM              PIC XX.
  2561             88  MA-FROM-CREDIT                VALUE 'CR'.
  2562             88  MA-FROM-VSI                   VALUE 'VS'.
  2563             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2564             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  48
* EL050.cbl
  2565         16  MA-RECORD-ADD-DT              PIC XX.
  2566         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2567         16  MA-LAST-MAINT-DT              PIC XX.
  2568         16  MA-LAST-MAINT-BY              PIC XXXX.
  2569         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2570
  2571     12  MA-PROFILE-INFO.
  2572         16  MA-QUALIFY-CODE-1             PIC XX.
  2573         16  MA-QUALIFY-CODE-2             PIC XX.
  2574         16  MA-QUALIFY-CODE-3             PIC XX.
  2575         16  MA-QUALIFY-CODE-4             PIC XX.
  2576         16  MA-QUALIFY-CODE-5             PIC XX.
  2577
  2578         16  MA-INSURED-LAST-NAME          PIC X(15).
  2579         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2580         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2581         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2582         16  MA-INSURED-BIRTH-DT           PIC XX.
  2583         16  MA-INSURED-SEX                PIC X.
  2584             88  MA-SEX-MALE                   VALUE 'M'.
  2585             88  MA-SEX-FEMALE                 VALUE 'F'.
  2586         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2587
  2588         16  MA-ADDRESS-CORRECTED          PIC X.
  2589         16  MA-JOINT-BIRTH-DT             PIC XX.
  2590*        16  FILLER                        PIC X(12).
  2591
  2592         16  MA-ADDRESS-LINE-1             PIC X(30).
  2593         16  MA-ADDRESS-LINE-2             PIC X(30).
  2594         16  MA-CITY-STATE.
  2595             20  MA-CITY                   PIC X(28).
  2596             20  MA-ADDR-STATE             PIC XX.
  2597         16  MA-ZIP.
  2598             20  MA-ZIP-CODE.
  2599                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2600                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2601                 24  FILLER                PIC X(4).
  2602             20  MA-ZIP-PLUS4              PIC X(4).
  2603         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2604             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2605             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2606             20  FILLER                    PIC X(3).
  2607
  2608         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2609
  2610         16  FILLER                        PIC XXX.
  2611*        16  FILLER                        PIC X(10).
  2612
  2613     12  MA-CRED-BENE-INFO.
  2614         16  MA-CRED-BENE-NAME                 PIC X(25).
  2615         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2616         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2617         16  MA-CRED-BENE-CTYST.
  2618             20  MA-CRED-BENE-CITY             PIC X(28).
  2619             20  MA-CRED-BENE-STATE            PIC XX.
  2620         16  MA-CRED-BENE-ZIP.
  2621             20  MA-CB-ZIP-CODE.
  2622                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  49
* EL050.cbl
  2623                     88  MA-CB-CANADIAN-POST-CODE
  2624                                           VALUE 'A' THRU 'Z'.
  2625                 24  FILLER                    PIC X(4).
  2626             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2627         16  MA-CB-CANADIAN-POSTAL-CODE
  2628                            REDEFINES MA-CRED-BENE-ZIP.
  2629             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2630             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2631             20  FILLER                        PIC X(3).
  2632     12  MA-POST-CARD-MAIL-DATA.
  2633         16  MA-MAIL-DATA OCCURS 7.
  2634             20  MA-MAIL-TYPE              PIC X.
  2635                 88  MA-12MO-MAILING           VALUE '1'.
  2636                 88  MA-EXP-MAILING            VALUE '2'.
  2637             20  MA-MAIL-STATUS            PIC X.
  2638                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2639                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2640                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2641             20  MA-MAIL-DATE              PIC XX.
  2642     12  FILLER                            PIC XX.
  2643     12  FILLER                            PIC XX.
  2644*    12  FILLER                            PIC X(30).
  2645******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  50
* EL050.cbl
  2647*    COPY ERCPNDM.
  2648******************************************************************
  2649*                                                                *
  2650*                                                                *
  2651*                            ERCPNDM                             *
  2652*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2653*                            VMOD=2.003                          *
  2654*                                                                *
  2655*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2656*                                                                *
  2657*   FILE TYPE = VSAM,KSDS                                        *
  2658*   RECORD SIZE = 374   RECFORM = FIX                            *
  2659*                                                                *
  2660*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2661*   ALTERNATE PATH    = NOT USED                                 *
  2662*                                                                *
  2663*   LOG = YES                                                    *
  2664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2665******************************************************************
  2666*                   C H A N G E   L O G
  2667*
  2668* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2669*-----------------------------------------------------------------
  2670*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2671* EFFECTIVE    NUMBER
  2672*-----------------------------------------------------------------
  2673* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2674* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2675* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2676* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2677******************************************************************
  2678
  2679 01  PENDING-MAILING-DATA.
  2680     12  PM-RECORD-ID                      PIC XX.
  2681         88  VALID-MA-ID                       VALUE 'PM'.
  2682
  2683     12  PM-CONTROL-PRIMARY.
  2684         16  PM-COMPANY-CD                 PIC X.
  2685         16  PM-ENTRY-BATCH                PIC X(6).
  2686         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2687         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2688
  2689     12  FILLER                            PIC X(14).
  2690
  2691     12  PM-ACCESS-CONTROL.
  2692         16  PM-SOURCE-SYSTEM              PIC XX.
  2693             88  PM-FROM-CREDIT                VALUE 'CR'.
  2694             88  PM-FROM-VSI                   VALUE 'VS'.
  2695             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2696             88  PM-FROM-OTHER                 VALUE 'OT'.
  2697         16  PM-RECORD-ADD-DT              PIC XX.
  2698         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2699         16  PM-LAST-MAINT-DT              PIC XX.
  2700         16  PM-LAST-MAINT-BY              PIC XXXX.
  2701         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2702
  2703     12  PM-PROFILE-INFO.
  2704         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  51
* EL050.cbl
  2705         16  PM-QUALIFY-CODE-2             PIC XX.
  2706         16  PM-QUALIFY-CODE-3             PIC XX.
  2707         16  PM-QUALIFY-CODE-4             PIC XX.
  2708         16  PM-QUALIFY-CODE-5             PIC XX.
  2709
  2710         16  PM-INSURED-LAST-NAME          PIC X(15).
  2711         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2712         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2713         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2714         16  PM-INSURED-BIRTH-DT           PIC XX.
  2715         16  PM-INSURED-SEX                PIC X.
  2716             88  PM-SEX-MALE                   VALUE 'M'.
  2717             88  PM-SEX-FEMALE                 VALUE 'F'.
  2718         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2719
  2720         16  PM-ADDRESS-CORRECTED          PIC X.
  2721         16  PM-JOINT-BIRTH-DT             PIC XX.
  2722*        16  FILLER                        PIC X(12).
  2723
  2724         16  PM-ADDRESS-LINE-1             PIC X(30).
  2725         16  PM-ADDRESS-LINE-2             PIC X(30).
  2726         16  PM-CITY-STATE.
  2727             20  PM-CITY                   PIC X(28).
  2728             20  PM-STATE                  PIC XX.
  2729         16  PM-ZIP.
  2730             20  PM-ZIP-CODE.
  2731                 24  PM-ZIP-1              PIC X.
  2732                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2733                 24  FILLER                PIC X(4).
  2734             20  PM-ZIP-PLUS4              PIC X(4).
  2735         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2736             20  PM-CAN-POST1              PIC XXX.
  2737             20  PM-CAN-POST2              PIC XXX.
  2738             20  FILLER                    PIC XXX.
  2739
  2740         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2741         16  pm-city-st-zip-verified       pic x.
  2742         16  FILLER                        PIC XX.
  2743
  2744     12  PM-CRED-BENE-INFO.
  2745         16  PM-CRED-BENE-NAME             PIC X(25).
  2746         16  PM-CRED-BENE-ADDR             PIC X(30).
  2747         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2748         16  PM-CRED-BENE-CTYST.
  2749             20  PM-CRED-BENE-CITY         PIC X(28).
  2750             20  PM-CRED-BENE-STATE        PIC XX.
  2751         16  PM-CRED-BENE-ZIP.
  2752             20  PM-CB-ZIP-CODE.
  2753                 24  PM-CB-ZIP-1           PIC X.
  2754                     88  PM-CB-CANADIAN-POST-CODE
  2755                                  VALUE 'A' THRU 'Z'.
  2756                 24  FILLER                PIC X(4).
  2757             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2758         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2759             20  PM-CB-CAN-POST1           PIC XXX.
  2760             20  PM-CB-CAN-POST2           PIC XXX.
  2761             20  FILLER                    PIC XXX.
  2762     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  52
* EL050.cbl
  2763         16  PM-MAIL-DATA OCCURS 7.
  2764             20  PM-MAIL-TYPE              PIC X.
  2765                 88  PM-12MO-MAILING           VALUE '1'.
  2766                 88  PM-EXP-MAILING            VALUE '2'.
  2767             20  PM-MAIL-STATUS            PIC X.
  2768                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2769                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2770                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2771             20  PM-MAIL-DATE              PIC XX.
  2772     12  FILLER                            PIC XX.
  2773     12  FILLER                            PIC X(12).
  2774*    12  FILLER                            PIC X(30).
  2775
  2776******************************************************************
  2777*                                COPY ERCLOFC.
  2778******************************************************************
  2779*                                                                *
  2780*                                                                *
  2781*                            ERCLOFC                             *
  2782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2783*                            VMOD=2.003                          *
  2784*                                                                *
  2785*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2786*                                                                *
  2787*   FILE TYPE = VSAM,KSDS                                        *
  2788*   RECORD SIZE = 670   RECFORM = FIX                            *
  2789*                                                                *
  2790*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2791*                                                                *
  2792*   LOG = YES                                                    *
  2793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2794*                                                                *
  2795******************************************************************
  2796
  2797 01  LOAN-OFFICER-MASTER.
  2798     12  LO-RECORD-ID                PIC XX.
  2799         88  VALID-LO-ID                VALUE 'LO'.
  2800
  2801     12  LO-CONTROL-PRIMARY.
  2802         16  LO-COMPANY-CD           PIC X.
  2803         16  LO-CARRIER              PIC X.
  2804         16  LO-GROUPING.
  2805             20  LO-GROUPING-PREFIX  PIC XXX.
  2806             20  LO-GROUPING-PRIME   PIC XXX.
  2807         16  LO-STATE                PIC XX.
  2808         16  LO-ACCOUNT.
  2809             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2810             20  LO-ACCOUNT-PRIME    PIC X(6).
  2811         16  LO-OFFICER-CODE         PIC X(5).
  2812
  2813     12  LO-OFFICER-NAME             PIC X(30).
  2814
  2815     12  LO-LAST-MAINT-DT            PIC XX.
  2816     12  LO-LAST-USER                PIC X(4).
  2817     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2818
  2819     12  LO-COMP-CONTROL             PIC X.
  2820             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  53
* EL050.cbl
  2821             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2822     12  LO-DETAIL-CONTROL           PIC X.
  2823             88  LO-PRINT-DETAIL        VALUE 'D'.
  2824             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2825
  2826     12  LO-SV-CARRIER               PIC X.
  2827     12  LO-SV-GROUPING              PIC X(6).
  2828     12  LO-SV-STATE                 PIC XX.
  2829
  2830     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2831     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2832
  2833     12  LO-OFFICER-INFO.
  2834         16  FILLER OCCURS 12 TIMES.
  2835             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2836             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2837             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2838             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2839             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2840             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2841             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2842             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2843     12  FILLER                      PIC X(198).
  2844******************************************************************
  2845*                                COPY ERCPDEF.
  2846******************************************************************
  2847*                                                                *
  2848*                                                                *
  2849*                            ERCPDEF.                            *
  2850*                                                                *
  2851*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2852*                                                                *
  2853*    FILE TYPE = VSAM,KSDS                                       *
  2854*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2855*                                                                *
  2856*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2857*                                                                *
  2858*    LOG = YES                                                   *
  2859*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2860******************************************************************
  2861*                   C H A N G E   L O G
  2862*
  2863* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2864*-----------------------------------------------------------------
  2865*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2866* EFFECTIVE    NUMBER
  2867*-----------------------------------------------------------------
  2868* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2869* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2870* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2871******************************************************************
  2872 01  PRODUCT-MASTER.
  2873    12  PD-RECORD-ID                 PIC X(02).
  2874        88  VALID-PD-ID                  VALUE 'PD'.
  2875    12  PD-CONTROL-PRIMARY.
  2876        16  PD-COMPANY-CD            PIC X.
  2877        16  PD-STATE                 PIC XX.
  2878        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  54
* EL050.cbl
  2879        16  PD-FILLER                PIC X(7).
  2880        16  PD-BEN-TYPE              PIC X.
  2881        16  PD-BEN-CODE              PIC XX.
  2882        16  PD-PROD-EXP-DT           PIC XX.
  2883    12  FILLER                       PIC X(50).
  2884    12  PD-PRODUCT-DATA OCCURS 8.
  2885        16  PD-PROD-CODE             PIC X.
  2886            88  PD-PROD-LIFE           VALUE 'L'.
  2887            88  PD-PROD-PROP           VALUE 'P'.
  2888            88  PD-PROD-AH             VALUE 'A'.
  2889            88  PD-PROD-IU             VALUE 'I'.
  2890            88  PD-PROD-GAP            VALUE 'G'.
  2891            88  PD-PROD-FAML           VALUE 'F'.
  2892        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2893        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2894        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2895        16  PD-MAX-TERM              PIC S999        COMP-3.
  2896        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2897        16  FILLER                   PIC X.
  2898        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2899        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2900        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2901        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2902        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2903        16  PD-REC-CRIT-PERIOD       PIC 99.
  2904        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2905            20  PD-RECURRING-YN      PIC X.
  2906            20  FILLER               PIC X.
  2907        16  PD-RTW-MOS               PIC 99.
  2908        16  PD-MAX-EXTENSION         PIC 99.
  2909        16  pd-ben-pct               pic sv999 comp-3.
  2910*       16  FILLER                   PIC XX.
  2911    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2912    12  PD-TERM-LIMITS OCCURS 15.
  2913        16  PD-LOW-TERM              PIC S999        COMP-3.
  2914        16  PD-HI-TERM               PIC S999        COMP-3.
  2915*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2916    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2917        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2918        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2919    12  PD-EARN-FACTORS.
  2920        16  FILLER OCCURS 15.
  2921            20  FILLER OCCURS 15.
  2922                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2923    12  PD-PRODUCT-DESC              PIC X(80).
  2924    12  PD-TRUNCATED                 PIC X.
  2925    12  FILLER                       PIC X(59).
  2926    12  PD-MAINT-INFORMATION.
  2927        16  PD-LAST-MAINT-DT         PIC X(02).
  2928        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2929        16  PD-LAST-MAINT-BY         PIC X(04).
  2930*                                COPY ELCSTATE.
  2931******************************************************************
  2932*                                                                *
  2933*                                                                *
  2934*                            ELCSTATE.                           *
  2935*                                                                *
  2936*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  55
* EL050.cbl
  2937*                                                                *
  2938*   FILE TYPE = VSAM,KSDS                                        *
  2939*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2940*                                                                *
  2941*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2942*       ALTERNATE INDEX = NONE                                   *
  2943*                                                                *
  2944*   LOG = YES                                                    *
  2945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2946******************************************************************
  2947*                   C H A N G E   L O G
  2948*
  2949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2950*-----------------------------------------------------------------
  2951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2952* EFFECTIVE    NUMBER
  2953*-----------------------------------------------------------------
  2954* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2955******************************************************************
  2956*
  2957 01  STATE-FILE.
  2958     12  SF-RECORD-ID                       PIC XX.
  2959         88  VALID-CF-ID                        VALUE 'SF'.
  2960     12  SF-CONTROL-PRIMARY.
  2961         16  SF-COMPANY-ID                  PIC XXX.
  2962         16  SF-CARRIER-CODE                PIC X.
  2963         16  SF-GROUPING                    PIC X(6).
  2964         16  SF-STATE-CODE                  PIC XX.
  2965         16  SF-EXPIRE-DATE                 PIC 9(8).
  2966****************************************************************
  2967*             STATE CONTROLS
  2968****************************************************************
  2969     12  SF-LAST-MAINT-DT                   PIC XX.
  2970     12  SF-LAST-MAINT-BY                   PIC X(4).
  2971     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2972     12  SF-STATE-RT-CONTROLS.
  2973         16  SF-ST-RT-CALC                  PIC X.
  2974     12  SF-ST-TAX-CONTROLS.
  2975         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2976         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2977         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2978     12  SF-ST-REFUND-OPTIONS.
  2979         16  SF-ST-RF-LR-CALC               PIC X.
  2980         16  SF-ST-RF-LL-CALC               PIC X.
  2981         16  SF-ST-RF-LN-CALC               PIC X.
  2982         16  SF-ST-RF-AH-CALC               PIC X.
  2983         16  SF-ST-RF-CP-CALC               PIC X.
  2984     12  SF-ST-UNEARN-PREM-OPTIONS.
  2985         16  SF-ST-LUEP-R78                 PIC X.
  2986         16  SF-ST-LUEP-PRO                 PIC X.
  2987         16  SF-ST-LUEP-ST                  PIC X.
  2988         16  SF-ST-LUEP-DOM                 PIC X.
  2989         16  SF-ST-AUEP-R78                 PIC X.
  2990         16  SF-ST-AUEP-PRO                 PIC X.
  2991         16  SF-ST-AUEP-ST                  PIC X.
  2992         16  SF-ST-AUEP-DOM                 PIC X.
  2993         16  SF-ST-CUEP-R78                 PIC X.
  2994         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  56
* EL050.cbl
  2995         16  SF-ST-CUEP-ST                  PIC X.
  2996         16  SF-ST-CUEP-DOM                 PIC X.
  2997     12  SF-ST-EARN-PREM-OPTIONS.
  2998         16  SF-ST-LEP-R78                  PIC X.
  2999         16  SF-ST-LEP-PRO                  PIC X.
  3000         16  SF-ST-LEP-ST                   PIC X.
  3001         16  SF-ST-LEP-DOM                  PIC X.
  3002         16  SF-ST-AEP-R78                  PIC X.
  3003         16  SF-ST-AEP-PRO                  PIC X.
  3004         16  SF-ST-AEP-ST                   PIC X.
  3005         16  SF-ST-AEP-DOM                  PIC X.
  3006         16  SF-ST-CEP-R78                  PIC X.
  3007         16  SF-ST-CEP-PRO                  PIC X.
  3008         16  SF-ST-CEP-ST                   PIC X.
  3009         16  SF-ST-CEP-DOM                  PIC X.
  3010     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  57
* EL050.cbl
  3012*    COPY ELCCRTT.
  3013******************************************************************
  3014*                                                                *
  3015*                            ELCCRTT.                            *
  3016*                                                                *
  3017*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3018*                                                                *
  3019*   FILE TYPE = VSAM,KSDS                                        *
  3020*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3021*                                                                *
  3022*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3023*                                                                *
  3024*   LOG = YES                                                    *
  3025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3026******************************************************************
  3027*                   C H A N G E   L O G
  3028*
  3029* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3030*-----------------------------------------------------------------
  3031*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3032* EFFECTIVE    NUMBER
  3033*-----------------------------------------------------------------
  3034* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3035* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3036* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3037* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3038* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3039* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3040* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3041* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3042* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3043******************************************************************
  3044
  3045 01  CERTIFICATE-TRAILERS.
  3046     12  CS-RECORD-ID                      PIC XX.
  3047         88  VALID-CS-ID                      VALUE 'CS'.
  3048
  3049     12  CS-CONTROL-PRIMARY.
  3050         16  CS-COMPANY-CD                 PIC X.
  3051         16  CS-CARRIER                    PIC X.
  3052         16  CS-GROUPING                   PIC X(6).
  3053         16  CS-STATE                      PIC XX.
  3054         16  CS-ACCOUNT                    PIC X(10).
  3055         16  CS-CERT-EFF-DT                PIC XX.
  3056         16  CS-CERT-NO.
  3057             20  CS-CERT-PRIME             PIC X(10).
  3058             20  CS-CERT-SFX               PIC X.
  3059         16  CS-TRAILER-TYPE               PIC X.
  3060             88  COMM-TRLR           VALUE 'A'.
  3061             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3062             88  CERT-DATA-TRLR      VALUE 'C'.
  3063
  3064     12  CS-DATA-AREA                      PIC X(516).
  3065
  3066     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3067         16  CS-BANK-COMMISSION-AREA.
  3068             20  CS-BANK-COMMS       OCCURS 10.
  3069                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  58
* EL050.cbl
  3070                 24  CS-COM-TYP            PIC X.
  3071                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3072                 24  CS-RECALC-LV-INDIC    PIC X.
  3073                 24  FILLER                PIC X(10).
  3074         16  FILLER                        PIC X(256).
  3075
  3076     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3077****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3078         16  CS-MB-CLAIM-DATA OCCURS 24.
  3079             20  CS-CLAIM-NO               PIC X(7).
  3080             20  CS-CLAIM-TYPE             PIC X.
  3081                 88  CS-AH-CLM               VALUE 'A'.
  3082                 88  CS-IU-CLM               VALUE 'I'.
  3083                 88  CS-GP-CLM               VALUE 'G'.
  3084                 88  CS-LF-CLM               VALUE 'L'.
  3085                 88  CS-PR-CLM               VALUE 'P'.
  3086                 88  CS-FL-CLM               VALUE 'F'.
  3087             20  CS-INSURED-TYPE           PIC X.
  3088                 88  CS-PRIM-INSURED          VALUE 'P'.
  3089                 88  CS-CO-BORROWER           VALUE 'C'.
  3090             20  CS-BENEFIT-PERIOD         PIC 99.
  3091             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3092             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3093             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3094         16  FILLER                        PIC X(12).
  3095     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3096         16  CS-VIN-NUMBER                 PIC X(17).
  3097         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3098         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3099         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3100         16  cs-agent-name.
  3101             20  cs-agent-fname            pic x(20).
  3102             20  cs-agent-mi               pic x.
  3103             20  cs-agent-lname            pic x(25).
  3104         16  cs-license-no                 pic x(15).
  3105         16  cs-npn-number                 pic x(10).
  3106         16  cs-agent-edit-status          pic x.
  3107             88  cs-ae-refer-to-manager      value 'M'.
  3108             88  cs-ae-cover-sheet           value 'C'.
  3109             88  cs-ae-sig-form              value 'S'.
  3110             88  cs-ae-verified              value 'V'.
  3111             88  cs-unidentified-signature   value 'U'.
  3112             88  cs-cert-returned            value 'R'.
  3113             88  cs-accept-no-commission     value 'N'.
  3114         16  cs-year                       pic 9999.
  3115         16  cs-make                       pic x(20).
  3116         16  cs-model                      pic x(20).
  3117         16  cs-future                     pic x(20).
  3118         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3119         16  FILLER                        PIC X(356). *> was 420
  3120*        16  FILLER                        PIC X(496).
  3121*    COPY ELCCRTO.
  3122******************************************************************
  3123*                                                                *
  3124*                            ELCCRTO.                            *
  3125*                                                                *
  3126*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3127*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  59
* EL050.cbl
  3128*   FILE TYPE = VSAM,KSDS                                        *
  3129*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3130*                                                                *
  3131*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3132*                                                                *
  3133*   LOG = YES                                                    *
  3134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3135******************************************************************
  3136*                   C H A N G E   L O G
  3137*
  3138* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3139*-----------------------------------------------------------------
  3140*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3141* EFFECTIVE    NUMBER
  3142*-----------------------------------------------------------------
  3143* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3144* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3145* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3146* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3147* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3148******************************************************************
  3149 01  ORIGINAL-CERTIFICATE.
  3150     12  OC-RECORD-ID                      PIC XX.
  3151         88  VALID-OC-ID                      VALUE 'OC'.
  3152     12  OC-CONTROL-PRIMARY.
  3153         16  OC-COMPANY-CD                 PIC X.
  3154         16  OC-CARRIER                    PIC X.
  3155         16  OC-GROUPING                   PIC X(6).
  3156         16  OC-STATE                      PIC XX.
  3157         16  OC-ACCOUNT                    PIC X(10).
  3158         16  OC-CERT-EFF-DT                PIC XX.
  3159         16  OC-CERT-NO.
  3160             20  OC-CERT-PRIME             PIC X(10).
  3161             20  OC-CERT-SFX               PIC X.
  3162         16  OC-RECORD-TYPE                PIC X.
  3163         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3164     12  OC-LAST-MAINT-DT                  PIC XX.
  3165     12  OC-LAST-MAINT-BY                  PIC X(4).
  3166     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3167     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3168     12  FILLER                            PIC X(49).
  3169     12  OC-ORIG-REC.
  3170         16  OC-INS-LAST-NAME              PIC X(15).
  3171         16  OC-INS-FIRST-NAME             PIC X(10).
  3172         16  OC-INS-MIDDLE-INIT            PIC X.
  3173         16  OC-INS-AGE                    PIC S999     COMP-3.
  3174         16  OC-JNT-LAST-NAME              PIC X(15).
  3175         16  OC-JNT-FIRST-NAME             PIC X(10).
  3176         16  OC-JNT-MIDDLE-INIT            PIC X.
  3177         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3178         16  OC-LF-BENCD                   PIC XX.
  3179         16  OC-LF-TERM                    PIC S999      COMP-3.
  3180         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3181         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3182         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3183         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3184         16  OC-LF-EXP-DT                  PIC XX.
  3185         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  60
* EL050.cbl
  3186         16  OC-LF-CANCEL-DT               PIC XX.
  3187         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3188         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3189         16  OC-AH-BENCD                   PIC XX.
  3190         16  OC-AH-TERM                    PIC S999      COMP-3.
  3191         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3192         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3193         16  OC-AH-EXP-DT                  PIC XX.
  3194         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3195         16  OC-AH-CP                      PIC 99.
  3196         16  OC-AH-CANCEL-DT               PIC XX.
  3197         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3198         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3199         16  OC-CRED-BENE-NAME             PIC X(25).
  3200         16  OC-1ST-PMT-DT                 PIC XX.
  3201         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3202         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3203         16  OC-ISSUE-TRAN-IND             PIC X.
  3204         16  OC-CANCEL-TRAN-IND            PIC X.
  3205         16  FILLER                        PIC X(211).
  3206
  3207     12  FILLER                            PIC X(50).
  3208******************************************************************
  3209
  3210*    COPY ELCDATE.
  3211******************************************************************
  3212*                                                                *
  3213*                                                                *
  3214*                            ELCDATE.                            *
  3215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3216*                            VMOD=2.003
  3217*                                                                *
  3218*                                                                *
  3219*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3220*                 LENGTH = 200                                   *
  3221******************************************************************
  3222
  3223 01  DATE-CONVERSION-DATA.
  3224     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3225     12  DC-OPTION-CODE                PIC X.
  3226         88  BIN-TO-GREG                VALUE ' '.
  3227         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3228         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3229         88  YMD-GREG-TO-BIN            VALUE '3'.
  3230         88  MDY-GREG-TO-BIN            VALUE '4'.
  3231         88  JULIAN-TO-BIN              VALUE '5'.
  3232         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3233         88  FIND-CENTURY               VALUE '7'.
  3234         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3235         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3236         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3237         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3238         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3239         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3240         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3241         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3242         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3243         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  61
* EL050.cbl
  3244         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3245         88  BIN-3-TO-GREG              VALUE 'I'.
  3246         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3247         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3248         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3249         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3250         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3251         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3252         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3253         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3254         88  THREE-CHARACTER-BIN
  3255                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3256         88  GREGORIAN-TO-BIN
  3257                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3258         88  BIN-TO-GREGORIAN
  3259                  VALUES ' ' '1' 'I' '8' 'G'.
  3260         88  JULIAN-TO-BINARY
  3261                  VALUES '5' 'C' 'E' 'F'.
  3262     12  DC-ERROR-CODE                 PIC X.
  3263         88  NO-CONVERSION-ERROR        VALUE ' '.
  3264         88  DATE-CONVERSION-ERROR
  3265                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3266         88  DATE-IS-ZERO               VALUE '1'.
  3267         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3268         88  DATE-IS-INVALID            VALUE '3'.
  3269         88  DATE1-GREATER-DATE2        VALUE '4'.
  3270         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3271         88  DATE-INVALID-OPTION        VALUE '9'.
  3272         88  INVALID-CENTURY            VALUE 'A'.
  3273         88  ONLY-CENTURY               VALUE 'B'.
  3274         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3275         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3276     12  DC-END-OF-MONTH               PIC X.
  3277         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3278     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3279         88  USE-NORMAL-PROCESS         VALUE ' '.
  3280         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3281         88  ADJUST-UP-100-YRS          VALUE '2'.
  3282     12  FILLER                        PIC X.
  3283     12  DC-CONVERSION-DATES.
  3284         16  DC-BIN-DATE-1             PIC XX.
  3285         16  DC-BIN-DATE-2             PIC XX.
  3286         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3287         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3288                       DC-GREG-DATE-1-EDIT.
  3289             20  DC-EDIT1-MONTH        PIC 99.
  3290             20  SLASH1-1              PIC X.
  3291             20  DC-EDIT1-DAY          PIC 99.
  3292             20  SLASH1-2              PIC X.
  3293             20  DC-EDIT1-YEAR         PIC 99.
  3294         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3295         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3296                     DC-GREG-DATE-2-EDIT.
  3297             20  DC-EDIT2-MONTH        PIC 99.
  3298             20  SLASH2-1              PIC X.
  3299             20  DC-EDIT2-DAY          PIC 99.
  3300             20  SLASH2-2              PIC X.
  3301             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  62
* EL050.cbl
  3302         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3303         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3304                     DC-GREG-DATE-1-YMD.
  3305             20  DC-YMD-YEAR           PIC 99.
  3306             20  DC-YMD-MONTH          PIC 99.
  3307             20  DC-YMD-DAY            PIC 99.
  3308         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3309         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3310                      DC-GREG-DATE-1-MDY.
  3311             20  DC-MDY-MONTH          PIC 99.
  3312             20  DC-MDY-DAY            PIC 99.
  3313             20  DC-MDY-YEAR           PIC 99.
  3314         16  DC-GREG-DATE-1-ALPHA.
  3315             20  DC-ALPHA-MONTH        PIC X(10).
  3316             20  DC-ALPHA-DAY          PIC 99.
  3317             20  FILLER                PIC XX.
  3318             20  DC-ALPHA-CENTURY.
  3319                 24 DC-ALPHA-CEN-N     PIC 99.
  3320             20  DC-ALPHA-YEAR         PIC 99.
  3321         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3322         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3323         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3324         16  DC-JULIAN-DATE            PIC 9(05).
  3325         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3326                                       PIC 9(05).
  3327         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3328             20  DC-JULIAN-YEAR        PIC 99.
  3329             20  DC-JULIAN-DAYS        PIC 999.
  3330         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3331         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3332         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3333     12  DATE-CONVERSION-VARIBLES.
  3334         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3335         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3336             20  FILLER                PIC 9(3).
  3337             20  HOLD-CEN-1-CCYY.
  3338                 24  HOLD-CEN-1-CC     PIC 99.
  3339                 24  HOLD-CEN-1-YY     PIC 99.
  3340             20  HOLD-CEN-1-MO         PIC 99.
  3341             20  HOLD-CEN-1-DA         PIC 99.
  3342         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3343             20  HOLD-CEN-1-R-MO       PIC 99.
  3344             20  HOLD-CEN-1-R-DA       PIC 99.
  3345             20  HOLD-CEN-1-R-CCYY.
  3346                 24  HOLD-CEN-1-R-CC   PIC 99.
  3347                 24  HOLD-CEN-1-R-YY   PIC 99.
  3348             20  FILLER                PIC 9(3).
  3349         16  HOLD-CENTURY-1-X.
  3350             20  FILLER                PIC X(3)  VALUE SPACES.
  3351             20  HOLD-CEN-1-X-CCYY.
  3352                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3353                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3354             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3355             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3356         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3357             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3358             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3359             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  63
* EL050.cbl
  3360                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3361                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3362             20  FILLER                PIC XXX.
  3363         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3364         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3365         16  DC-JULIAN-DATE-1          PIC 9(07).
  3366         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3367             20  DC-JULIAN-1-CCYY.
  3368                 24  DC-JULIAN-1-CC    PIC 99.
  3369                 24  DC-JULIAN-1-YR    PIC 99.
  3370             20  DC-JULIAN-DA-1        PIC 999.
  3371         16  DC-JULIAN-DATE-2          PIC 9(07).
  3372         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3373             20  DC-JULIAN-2-CCYY.
  3374                 24  DC-JULIAN-2-CC    PIC 99.
  3375                 24  DC-JULIAN-2-YR    PIC 99.
  3376             20  DC-JULIAN-DA-2        PIC 999.
  3377         16  DC-GREG-DATE-A-EDIT.
  3378             20  DC-EDITA-MONTH        PIC 99.
  3379             20  SLASHA-1              PIC X VALUE '/'.
  3380             20  DC-EDITA-DAY          PIC 99.
  3381             20  SLASHA-2              PIC X VALUE '/'.
  3382             20  DC-EDITA-CCYY.
  3383                 24  DC-EDITA-CENT     PIC 99.
  3384                 24  DC-EDITA-YEAR     PIC 99.
  3385         16  DC-GREG-DATE-B-EDIT.
  3386             20  DC-EDITB-MONTH        PIC 99.
  3387             20  SLASHB-1              PIC X VALUE '/'.
  3388             20  DC-EDITB-DAY          PIC 99.
  3389             20  SLASHB-2              PIC X VALUE '/'.
  3390             20  DC-EDITB-CCYY.
  3391                 24  DC-EDITB-CENT     PIC 99.
  3392                 24  DC-EDITB-YEAR     PIC 99.
  3393         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3394         16  DC-GREG-DATE-CYMD-R REDEFINES
  3395                              DC-GREG-DATE-CYMD.
  3396             20  DC-CYMD-CEN           PIC 99.
  3397             20  DC-CYMD-YEAR          PIC 99.
  3398             20  DC-CYMD-MONTH         PIC 99.
  3399             20  DC-CYMD-DAY           PIC 99.
  3400         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3401         16  DC-GREG-DATE-MDCY-R REDEFINES
  3402                              DC-GREG-DATE-MDCY.
  3403             20  DC-MDCY-MONTH         PIC 99.
  3404             20  DC-MDCY-DAY           PIC 99.
  3405             20  DC-MDCY-CEN           PIC 99.
  3406             20  DC-MDCY-YEAR          PIC 99.
  3407    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3408        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3409    12  DC-EL310-DATE                  PIC X(21).
  3410    12  FILLER                         PIC X(28).
  3411
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  64
* EL050.cbl
  3413*    COPY ELCCALC.
  3414******************************************************************
  3415*                                                                *
  3416*                           ELCCALC.                            *
  3417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3418*                            VMOD=2.025                          *
  3419*                                                                *
  3420*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3421*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3422*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3423*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3424*                                                                *
  3425*  PASSED TO ELRTRM                                              *
  3426*  -----------------                                             *
  3427*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3428*  ORIGINAL TERM                                                 *
  3429*  BEGINNING DATE                                                *
  3430*  ENDING DATE                                                   *
  3431*  COMPANY I.D.                                                  *
  3432*  ACCOUNT MASTER USER FIELD                                     *
  3433*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3434*  FREE LOOK DAYS                                                *
  3435*                                                                *
  3436*  RETURNED FROM ELRTRM                                          *
  3437*  ---------------------                                         *
  3438*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3439*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3440*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3441*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3442*----------------------------------------------------------------*
  3443*  PASSED TO ELRAMT                                              *
  3444*  ----------------                                              *
  3445*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3446*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3447*  ORIGINAL AMOUNT                                               *
  3448*  ALTERNATE BENEFIT (BALLON)                                    *
  3449*  A.P.R. - NET PAY ONLY                                         *
  3450*  METHOD
  3451*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3452*  COMPANY I.D.                                                  *
  3453*  BENEFIT TYPE                                                  *
  3454*                                                                *
  3455*  RETURNED FROM ELRAMT                                          *
  3456*  --------------------                                          *
  3457*  REMAINING AMOUNT 1 - CURRENT                                  *
  3458*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3459*  REMAINING AMOUNT FACTOR
  3460*----------------------------------------------------------------*
  3461*  PASSED TO ELRESV                                              *
  3462*  -----------------                                             *
  3463*  CERTIFICATE EFFECTIVE DATE                                    *
  3464*  VALUATION DATE                                                *
  3465*  PAID THRU DATE                                                *
  3466*  BENEFIT                                                       *
  3467*  INCURRED DATE                                                 *
  3468*  REPORTED DATE                                                 *
  3469*  ISSUE AGE                                                     *
  3470*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  65
* EL050.cbl
  3471*  CDT PERCENT                                                   *
  3472*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3473* *CLAIM TYPE (LIFE, A/H)                                        *
  3474* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3475* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3476*                                                                *
  3477*  RETURNED FROM ELRESV                                          *
  3478*  --------------------                                          *
  3479*  CDT TABLE USED                                                *
  3480*  CDT FACTOR USED                                               *
  3481*  PAY TO CURRENT RESERVE                                        *
  3482*  I.B.N.R. - A/H ONLY                                           *
  3483*  FUTURE (ACCRUED) AH ONLY                                      *
  3484*----------------------------------------------------------------*
  3485*  PASSED TO ELRATE                                              *
  3486*  ----------------                                              *
  3487*  CERT ISSUE DATE                                               *
  3488*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3489*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3490*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3491*  STATE CODE (CLIENT DEFINED)                                   *
  3492*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3493*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3494*  DEVIATION CODE                                                *
  3495*  ISSUE AGE                                                     *
  3496*  ORIGINAL BENEFIT AMOUNT                                       *
  3497*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3498*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3499*  BENEFIT KIND (LIFE OR A/H)                                    *
  3500*  A.P.R.                                                        *
  3501*  METHOD
  3502*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3503*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3504*  COMPANY I.D. (3 CHARACTER)                                    *
  3505*  BENEFIT CODE                                                  *
  3506*  BENEFIT OVERRIDE CODE                                         *
  3507*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3508*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3509*  JOINT INDICATOR (CSL ONLY)                                    *
  3510*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3511*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3512*                                                                *
  3513*  RETURNED FROM ELRATE                                          *
  3514*  --------------------                                          *
  3515*  CALCULATED PREMIUM                                            *
  3516*  PREMIUM RATE                                                  *
  3517*  MORTALITY CODE                                                *
  3518*  MAX ATTAINED AGE                                              *
  3519*  MAX AGE                                                       *
  3520*  MAX TERM                                                      *
  3521*  MAX MONTHLY BENEFIT                                           *
  3522*  MAX TOTAL BENIFIT                                             *
  3523*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3524*----------------------------------------------------------------*
  3525*  PASSED TO ELRFND                                              *
  3526*  ----------------                                              *
  3527*  CERT ISSUE DATE                                               *
  3528*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  66
* EL050.cbl
  3529*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3530*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3531*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3532*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3533*  STATE CODE (CLIENT DEFINED)                                   *
  3534*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3535*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3536*  DEVIATION CODE                                                *
  3537*  ISSUE AGE                                                     *
  3538*  ORIGINAL BENEFIT AMOUNT                                       *
  3539*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3540*  PROCESS TYPE (CANCEL)                                         *
  3541*  BENEFIT KIND (LIFE OR A/H)                                    *
  3542*  A.P.R.                                                        *
  3543*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3544*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3545*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3546*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3547*  COMPANY I.D. (3 CHARACTER)                                    *
  3548*  BENEFIT CODE                                                  *
  3549*  BENEFIT OVERRIDE CODE                                         *
  3550*                                                                *
  3551*  RETURNED FROM ELRFND                                          *
  3552*  --------------------                                          *
  3553*  CALCULATED REFUND                                             *
  3554*----------------------------------------------------------------*
  3555*  PASSED TO ELEARN                                              *
  3556*  ----------------                                              *
  3557*  CERT ISSUE DATE                                               *
  3558*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3559*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3560*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3561*  STATE CODE (CLIENT DEFINED)                                   *
  3562*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3563*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3564*  DEVIATION CODE                                                *
  3565*  ISSUE AGE                                                     *
  3566*  ORIGINAL BENEFIT AMOUNT                                       *
  3567*  BENEFIT KIND (LIFE OR A/H)                                    *
  3568*  A.P.R.                                                        *
  3569*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3570*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3571*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3572*  COMPANY I.D. (3 CHARACTER)                                    *
  3573*  BENEFIT CODE                                                  *
  3574*  BENEFIT OVERRIDE CODE                                         *
  3575*                                                                *
  3576*  RETURNED FROM ELEARN                                          *
  3577*  --------------------                                          *
  3578*  INDICATED  EARNINGS                                           *
  3579*----------------------------------------------------------------*
  3580*                 LENGTH = 450                                   *
  3581*                                                                *
  3582******************************************************************
  3583******************************************************************
  3584*                   C H A N G E   L O G
  3585*
  3586* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  67
* EL050.cbl
  3587*-----------------------------------------------------------------
  3588*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3589* EFFECTIVE    NUMBER
  3590*-----------------------------------------------------------------
  3591* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3592* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3593* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3594* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3595* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3596* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3597* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3598* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3599* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3600* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3601* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3602******************************************************************
  3603
  3604 01  CALCULATION-PASS-AREA.
  3605     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3606                                     COMP.
  3607
  3608     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3609       88  NO-CP-ERROR                             VALUE ZERO.
  3610       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3611                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3612       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3613       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3614       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3615       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3616       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3617       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3618       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3619       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3620       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3621       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3622       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3623       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3624       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3625       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3626       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3627       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3628       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3629
  3630     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3631       88  NO-CP-ERROR-2                           VALUE ZERO.
  3632***********************  INPUT AREAS ****************************
  3633
  3634     12  CP-CALCULATION-AREA.
  3635         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3636         16  CP-CERT-EFF-DT        PIC XX.
  3637         16  CP-VALUATION-DT       PIC XX.
  3638         16  CP-PAID-THRU-DT       PIC XX.
  3639         16  CP-BENEFIT-TYPE       PIC X.
  3640           88  CP-AH                               VALUE 'A' 'D'
  3641                                                   'I' 'U'.
  3642           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3643           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3644         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  68
* EL050.cbl
  3645         16  CP-REPORTED-DT        PIC XX.
  3646         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3647         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3648         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3649                                     COMP-3.
  3650         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3651                                     COMP-3.
  3652         16  CP-CDT-METHOD         PIC X.
  3653           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3654           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3655           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3656         16  CP-CLAIM-TYPE         PIC X.
  3657           88  CP-AH-CLAIM                         VALUE 'A'.
  3658           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3659         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3660                                     COMP-3.
  3661         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3670                                     COMP-3.
  3671         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-REM-TERM-METHOD    PIC X.
  3674           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3675           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3676           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3677           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3678           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3679           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3680           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3681         16  CP-EARNING-METHOD     PIC X.
  3682           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3683           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3684           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3685           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3686           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3687           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3688           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3689           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3690           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3691           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3692           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3693           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3694           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3695           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3696         16  CP-PROCESS-TYPE       PIC X.
  3697           88  CP-CLAIM                            VALUE '1'.
  3698           88  CP-CANCEL                           VALUE '2'.
  3699           88  CP-ISSUE                            VALUE '3'.
  3700         16  CP-SPECIAL-CALC-CD    PIC X.
  3701           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3702           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  69
* EL050.cbl
  3703           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3704           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3705           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3706           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3707           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3708           88  CP-FARM-PLAN                    VALUE 'F'.
  3709           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3710           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3711           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3712           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3713           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3714           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3715           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3716           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3717           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3718           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3719                                                     'W' 'X'.
  3720           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3721           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3722           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3723           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3724           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3725           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3726           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3727           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3728           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3729           88  CP-CSL-METH-1                   VALUE '5'.
  3730           88  CP-CSL-METH-2                   VALUE '6'.
  3731           88  CP-CSL-METH-3                   VALUE '7'.
  3732           88  CP-CSL-METH-4                   VALUE '8'.
  3733
  3734         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3737         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3738         16  CP-STATE              PIC XX          VALUE SPACE.
  3739         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3740         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3741           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3742               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3743         16  CP-R78-OPTION         PIC X.
  3744           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3745           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3746
  3747         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3748         16  CP-IBNR-RESERVE-SW    PIC X.
  3749         16  CP-CLAIM-STATUS       PIC X.
  3750         16  CP-RATE-FILE          PIC X.
  3751         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3752                                     COMP-3.
  3753
  3754         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3755         16  CP-AH-OVERRIDE-CODE   PIC X.
  3756
  3757         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3758                                     COMP-3.
  3759         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3760                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  70
* EL050.cbl
  3761         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3762                                     COMP-3.
  3763         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3768                                  PIC S9(7)V99 COMP-3.
  3769
  3770         16  CP-PAID-FROM-DATE     PIC X(02).
  3771         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3772         16  CP-EXT-DAYS-CALC      PIC X.
  3773           88  CP-EXT-NO-CHG                   VALUE ' '.
  3774           88  CP-EXT-CHG-LF                   VALUE '1'.
  3775           88  CP-EXT-CHG-AH                   VALUE '2'.
  3776           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3777         16  CP-DOMICILE-STATE     PIC XX.
  3778         16  CP-CARRIER            PIC X.
  3779         16  CP-REIN-FLAG          PIC X.
  3780         16  CP-REM-TRM-CALC-OPTION PIC X.
  3781           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3782                      '2' '3' '4' '5'.
  3783           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3784           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3785           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3786           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3787           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3788           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3789           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3790           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3791         16  CP-SIG-SWITCH         PIC X.
  3792         16  CP-RATING-METHOD      PIC X.
  3793           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3794           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3795           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3796           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3797           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3798           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3799           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3800           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3801           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3802         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3803                                     COMP-3.
  3804         16  CP-BEN-CATEGORY       PIC X.
  3805         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3806         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3807                                   PIC S99V9(5) COMP-3.
  3808         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3809         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3810                                   PIC S99V9(5) COMP-3.
  3811         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3812         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3813         16  CP-EXPIRE-DT          PIC XX.
  3814         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3815         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3816         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3817         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3818         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  71
* EL050.cbl
  3819             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3820             88  CP-CALC-CLP              VALUE 'C'.
  3821         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3822         16  CP-CANCEL-REASON      PIC X.
  3823         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3824         16  CP-PMT-MODE           PIC X.
  3825         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3826         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3827         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3828         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3829         16  FILLER                PIC X.
  3830
  3831***************    OUTPUT FROM ELRESV   ************************
  3832
  3833         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3834
  3835         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3836                                     COMP-3.
  3837         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3838                                     COMP-3.
  3839         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3840                                     COMP-3.
  3841         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3842                                     COMP-3.
  3843         16  FILLER                PIC X(09).
  3844***************    OUTPUT FROM ELRTRM   *************************
  3845
  3846         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3847                                     COMP-3.
  3848         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3851                                     COMP-3.
  3852         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3853                                     COMP-3.
  3854         16  FILLER                PIC X(12).
  3855
  3856***************    OUTPUT FROM ELRAMT   *************************
  3857
  3858         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3859                                     COMP-3.
  3860         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3861                                     COMP-3.
  3862         16  FILLER                PIC X(12).
  3863
  3864***************    OUTPUT FROM ELRATE   *************************
  3865
  3866         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3867                                     COMP-3.
  3868         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3869                                     COMP-3.
  3870         16  CP-MORTALITY-CODE     PIC X(4).
  3871         16  CP-RATE-EDIT-FLAG     PIC X.
  3872             88  CP-RATES-NEED-APR                  VALUE '1'.
  3873         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3876         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  72
* EL050.cbl
  3877         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3878                                   PIC S9(7)V99 COMP-3.
  3879         16  FILLER                PIC X(07).
  3880
  3881***************    OUTPUT FROM ELRFND   *************************
  3882
  3883         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3884                                     COMP-3.
  3885         16  CP-REFUND-TYPE-USED   PIC X.
  3886           88  CP-R-AS-R78                         VALUE '1'.
  3887           88  CP-R-AS-PRORATA                     VALUE '2'.
  3888           88  CP-R-AS-CALIF                       VALUE '3'.
  3889           88  CP-R-AS-TEXAS                       VALUE '4'.
  3890           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3891           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3892           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3893           88  CP-R-AS-MEAN                        VALUE '8'.
  3894           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3895           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3896           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3897           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3898           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3899           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3900         16  FILLER                PIC X(12).
  3901
  3902***************    OUTPUT FROM ELEARN   *************************
  3903
  3904         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3905                                     COMP-3.
  3906         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3909                                     COMP-3.
  3910         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3911                                     COMP-3.
  3912         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3913                                     COMP-3.
  3914         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3915                                     COMP-3.
  3916         16  CP-EARNING-TYPE-USED  PIC X.
  3917           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3918           88  CP-E-AS-R78                         VALUE '1'.
  3919           88  CP-E-AS-PRORATA                     VALUE '2'.
  3920           88  CP-E-AS-TEXAS                       VALUE '4'.
  3921           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3922           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3923           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3924           88  CP-E-AS-MEAN                        VALUE '8'.
  3925           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3926         16  FILLER                PIC X(12).
  3927
  3928***************    OUTPUT FROM ELPMNT   *************************
  3929
  3930         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3931                                     COMP-3.
  3932         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3933                                     COMP-3.
  3934         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  73
* EL050.cbl
  3935
  3936***************   MISC WORK AREAS    *****************************
  3937         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3938                                     COMP-3.
  3939         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3940                                     COMP-3.
  3941         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3942                                     COMP-3.
  3943         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3944                                     COMP-3.
  3945         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3946                                     COMP-3.
  3947         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3948                                     COMP-3.
  3949         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3950             88  OPEN-RATE-FILE                   VALUE 'O'.
  3951             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3952             88  IO-ERROR                         VALUE 'E'.
  3953
  3954         16  CP-FIRST-PAY-DATE     PIC XX.
  3955
  3956         16  CP-JOINT-INDICATOR    PIC X.
  3957
  3958         16  CP-RESERVE-REMAINING-TERM
  3959                                   PIC S9(4)V9    VALUE ZERO
  3960                                     COMP-3.
  3961
  3962         16  CP-INSURED-BIRTH-DT   PIC XX.
  3963
  3964         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3965                                     COMP-3.
  3966
  3967         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3968                                     COMP-3.
  3969
  3970         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3971                                     COMP-3.
  3972
  3973         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3974                                     COMP-3.
  3975
  3976         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3977                                     COMP-3.
  3978
  3979         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3980                                     COMP-3.
  3981
  3982         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3983                                     COMP-3.
  3984
  3985         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3986             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3987
  3988         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3989                                     COMP-3.
  3990         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3991                                     COMP-3.
  3992         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  74
* EL050.cbl
  3993         16  cp-extra-periods      pic 9 value zeros.
  3994         16  cp-net-only-state     pic x value spaces.
  3995         16  FILLER                PIC X(13).
  3996******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  75
* EL050.cbl
  3998******************************************************************
  3999*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4000*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4001*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4002*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4003*** MODIFICATION.                                              ***
  4004*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4005*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4006******************************************************************
  4007*    COPY ERCPNDB.
  4008******************************************************************
  4009*                                                                *
  4010*                                                                *
  4011*                            ERCPNDB.                            *
  4012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4013*                            VMOD=2.025                          *
  4014*                                                                *
  4015*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4016*                                                                *
  4017******************************************************************
  4018*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4019*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4020******************************************************************
  4021*                                                                *
  4022*                                                                *
  4023*   FILE TYPE = VSAM,KSDS                                        *
  4024*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4025*                                                                *
  4026*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4027*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4028*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4029*                                                 RKP=13,LEN=36  *
  4030*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4031*                                      AND CHG-SEQ.)             *
  4032*                                                RKP=49,LEN=11   *
  4033*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4034*                                      AND CHG-SEQ.)             *
  4035*                                                RKP=60,LEN=15   *
  4036*                                                                *
  4037*   LOG = NO                                                     *
  4038*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4039******************************************************************
  4040******************************************************************
  4041*                   C H A N G E   L O G
  4042*
  4043* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4044*-----------------------------------------------------------------
  4045*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4046* EFFECTIVE    NUMBER
  4047*-----------------------------------------------------------------
  4048* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4049* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4050* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4051* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4052* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4053* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4054* 032306                   PEMA  ADD BOW LOAN NUMBER
  4055* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  76
* EL050.cbl
  4056* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4057* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4058* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4059* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4060* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4061* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4062* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4063* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4064* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4065* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4066* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4067******************************************************************
  4068
  4069 01  PENDING-BUSINESS.
  4070     12  PB-RECORD-ID                     PIC XX.
  4071         88  VALID-PB-ID                        VALUE 'PB'.
  4072
  4073     12  PB-CONTROL-PRIMARY.
  4074         16  PB-COMPANY-CD                PIC X.
  4075         16  PB-ENTRY-BATCH               PIC X(6).
  4076         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4077         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4078
  4079     12  PB-CONTROL-BY-ACCOUNT.
  4080         16  PB-COMPANY-CD-A1             PIC X.
  4081         16  PB-CARRIER                   PIC X.
  4082         16  PB-GROUPING.
  4083             20  PB-GROUPING-PREFIX       PIC XXX.
  4084             20  PB-GROUPING-PRIME        PIC XXX.
  4085         16  PB-STATE                     PIC XX.
  4086         16  PB-ACCOUNT.
  4087             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4088             20  PB-ACCOUNT-PRIME         PIC X(6).
  4089         16  PB-CERT-EFF-DT               PIC XX.
  4090         16  PB-CERT-NO.
  4091             20  PB-CERT-PRIME            PIC X(10).
  4092             20  PB-CERT-SFX              PIC X.
  4093         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4094
  4095         16  PB-RECORD-TYPE               PIC X.
  4096             88  PB-MAILING-DATA                VALUE '0'.
  4097             88  PB-ISSUE                       VALUE '1'.
  4098             88  PB-CANCELLATION                VALUE '2'.
  4099             88  PB-BATCH-TRAILER               VALUE '9'.
  4100
  4101     12  PB-CONTROL-BY-ORIG-BATCH.
  4102         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4103         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4104         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4105         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4106
  4107     12  PB-CONTROL-BY-CSR.
  4108         16  PB-CSR-COMPANY-CD            PIC X.
  4109         16  PB-CSR-ID                    PIC X(4).
  4110         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4111         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4112         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4113******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  77
* EL050.cbl
  4114*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4115******************************************************************
  4116
  4117     12  PB-LAST-MAINT-DT                 PIC XX.
  4118     12  PB-LAST-MAINT-BY                 PIC X(4).
  4119     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4120
  4121     12  PB-RECORD-BODY                   PIC X(375).
  4122
  4123     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4124         16  PB-CERT-ORIGIN               PIC X.
  4125             88  CLASIC-CREATED-CERT         VALUE '1'.
  4126         16  PB-I-NAME.
  4127             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4128             20  PB-I-INSURED-FIRST-NAME.
  4129                 24  PB-I-INSURED-1ST-INIT PIC X.
  4130                 24  FILLER                PIC X(9).
  4131             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4132         16  PB-I-AGE                     PIC S99   COMP-3.
  4133         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4134         16  PB-I-BIRTHDAY                PIC XX.
  4135         16  PB-I-INSURED-SEX             PIC X.
  4136             88  PB-SEX-MALE     VALUE 'M'.
  4137             88  PB-SEX-FEMALE   VALUE 'F'.
  4138
  4139         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4140         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4141         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4142         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4143         16  PB-I-SKIP-CODE               PIC X.
  4144             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4145             88  PB-SKIP-JULY              VALUE '1'.
  4146             88  PB-SKIP-AUGUST            VALUE '2'.
  4147             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4148             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4149             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4150             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4151             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4152             88  PB-SKIP-JUNE              VALUE '8'.
  4153             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4154             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4155             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4156         16  PB-I-TERM-TYPE               PIC X.
  4157             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4158             88  PB-PAID-WEEKLY            VALUE 'W'.
  4159             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4160             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4161             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4162         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4163         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4164         16  PB-I-DATA-ENTRY-SW           PIC X.
  4165             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4166             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4167             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4168             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4169         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4170         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4171*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  78
* EL050.cbl
  4172         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4173         16  FILLER                       PIC X.
  4174
  4175         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4176             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4177             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4178                                                   '90' THRU '99'.
  4179         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4180                                          PIC XX.
  4181         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4182         16  PB-I-AMOUNT-FINANCED REDEFINES
  4183                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4184         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4185         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4186                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4187         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4188         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4189         16  PB-I-CLP-AMOUNT REDEFINES
  4190                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4191         16  PB-I-LF-CALC-FLAG            PIC X.
  4192             88 PB-COMP-LF-PREM               VALUE '?'.
  4193         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4194         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4195         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4196         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4197         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4198         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4199         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4200         16  PB-I-LF-ABBR                 PIC XXX.
  4201         16  PB-I-LF-INPUT-CD             PIC XX.
  4202
  4203         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4204             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4205             88  PB-INVALID-AH               VALUE '  ' '00'
  4206                                                   '90' THRU '99'.
  4207         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4208         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4209         16  PB-I-AH-CALC-FLAG            PIC X.
  4210             88 PB-COMP-AH-PREM                  VALUE '?'.
  4211         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4212         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4213         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4214         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4215         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4216         16  PB-I-AH-ABBR                 PIC XXX.
  4217         16  PB-I-AH-INPUT-CD             PIC XXX.
  4218
  4219         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4220         16  PB-I-REIN-TABLE              PIC XXX.
  4221         16  PB-I-BUSINESS-TYPE           PIC 99.
  4222         16  PB-I-INDV-GRP-CD             PIC X.
  4223         16  PB-I-MORT-CODE.
  4224             20  PB-I-TABLE               PIC X.
  4225             20  PB-I-INTEREST            PIC XX.
  4226             20  PB-I-MORT-TYP            PIC X.
  4227         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4228         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4229         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  79
* EL050.cbl
  4230         16  PB-I-INDV-GRP-OVRD           PIC X.
  4231         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4232         16  PB-I-SIG-SW                  PIC X.
  4233             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4234         16  PB-I-RATE-CLASS              PIC XX.
  4235         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4236         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4237         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4238         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4239         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4240         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4241         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4242         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4243         16  PB-I-OB-FLAG                 PIC X.
  4244             88  PB-I-OB                      VALUE 'B'.
  4245             88  PB-I-SUMMARY                 VALUE 'Z'.
  4246         16  PB-I-ENTRY-STATUS            PIC X.
  4247             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4248                                              'M' '5' '9' '2'.
  4249             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4250             88  PB-I-POLICY-PENDING          VALUE '2'.
  4251             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4252             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4253             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4254             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4255             88  PB-I-REIN-ONLY               VALUE '9'.
  4256             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4257             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4258             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4259             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4260         16  PB-I-INT-CODE                PIC X.
  4261             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4262             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4263         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4264         16  PB-I-SOC-SEC-NO              PIC X(11).
  4265         16  PB-I-MEMBER-NO               PIC X(12).
  4266         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4267*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4268         16  PB-I-OLD-LOF                 PIC XXX.
  4269         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4270         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4271         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4272         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4273         16  PB-I-LIFE-INDICATOR          PIC X.
  4274             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4275         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4276         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4277                                          PIC S9(5)V99    COMP-3.
  4278         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4279             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4280             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4281         16  PB-I-1ST-PMT-DT              PIC XX.
  4282         16  PB-I-JOINT-INSURED.
  4283             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4284             20 PB-I-JOINT-FIRST-NAME.
  4285                24  PB-I-JOINT-FIRST-INIT PIC X.
  4286                24  FILLER                PIC X(9).
  4287             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  80
* EL050.cbl
  4288*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4289         16  PB-I-BENEFICIARY-NAME.
  4290             20  PB-I-BANK-NUMBER         PIC X(10).
  4291             20  FILLER                   PIC X(15).
  4292         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4293         16  PB-I-REFERENCE               PIC X(12).
  4294         16  FILLER REDEFINES PB-I-REFERENCE.
  4295             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4296             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4297             20  PB-I-CLP-STATE           PIC XX.
  4298         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4299             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4300             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4301             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4302         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4303         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4304         16  PB-I-RESIDENT-STATE          PIC XX.
  4305         16  PB-I-RATE-CODE               PIC X(4).
  4306         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4307         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4308         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4309         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4310         16  PB-I-BANK-NOCHRGB            PIC 99.
  4311         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4312         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4313
  4314     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4315         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4316             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4317         16  PB-C-CANCEL-ORIGIN           PIC X.
  4318             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4319         16  PB-C-LF-CANCEL-DT            PIC XX.
  4320         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4321         16  PB-C-LF-CALC-REQ             PIC X.
  4322             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4323         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4324         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4325         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4326             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4327         16  PB-C-AH-CANCEL-DT            PIC XX.
  4328         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4329         16  PB-C-AH-CALC-REQ             PIC X.
  4330             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4331         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4332         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4333         16  PB-C-LAST-NAME               PIC X(15).
  4334         16  PB-C-REFUND-SW               PIC X.
  4335             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4336             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4337         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4338         16  PB-C-PAYEE-CODE              PIC X(6).
  4339         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4340         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4341         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4342         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4343         16  PB-C-REFERENCE               PIC X(12).
  4344         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4345         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  81
* EL050.cbl
  4346         16  PB-C-POST-CARD-IND           PIC X.
  4347         16  PB-C-CANCEL-REASON           PIC X.
  4348         16  PB-C-REF-INTERFACE-SW        PIC X.
  4349         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4350         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4351         16  FILLER                       PIC X(01).
  4352*        16  FILLER                       PIC X(18).
  4353         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4354*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4355         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4356         16  PB-CANCELED-CERT-DATA.
  4357             20  PB-CI-INSURED-NAME.
  4358                 24  PB-CI-LAST-NAME      PIC X(15).
  4359                 24  PB-CI-INITIALS       PIC XX.
  4360             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4361             20  PB-CI-INSURED-SEX        PIC X.
  4362             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4363             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4364             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4365             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4366             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4367             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4368             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4369             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4370             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4371             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4372             20  PB-CI-RATE-CLASS         PIC XX.
  4373             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4374             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4375             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4376             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4377             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4378             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4379             20  PB-CI-LF-ABBR            PIC X(3).
  4380             20  PB-CI-AH-ABBR            PIC X(3).
  4381             20  PB-CI-OB-FLAG            PIC X.
  4382                 88  PB-CI-OB                VALUE 'B'.
  4383             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4384                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4385                                           'M' '4' '5' '9' '2'.
  4386                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4387                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4388                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4389                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4390                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4391                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4392                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4393                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4394                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4395                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4396                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4397                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4398                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4399             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4400                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4401                                           'M' '4' '5' '9' '2'.
  4402                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4403                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  82
* EL050.cbl
  4404                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4405                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4406                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4407                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4408                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4409                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4410                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4411                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4412                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4413                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4414                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4415             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4416             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4417             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4418             20  PB-CI-MEMBER-NO          PIC X(12).
  4419             20  PB-CI-INT-CODE           PIC X.
  4420                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4421                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4422             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4423             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4424             20  PB-CI-COMP-EXCP-SW       PIC X.
  4425                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4426                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4427             20  PB-CI-ENTRY-STATUS       PIC X.
  4428             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4429             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4430             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4431             20  PB-CI-DEATH-DT           PIC XX.
  4432             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4433             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4434             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4435             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4436             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4437             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4438             20  PB-CI-ENTRY-DT              PIC XX.
  4439             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4440             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4441             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4442             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4443             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4444             20  PB-CI-OLD-LOF               PIC XXX.
  4445*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4446             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4447             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4448             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4449             20  PB-CI-INDV-GRP-CD           PIC X.
  4450             20  PB-CI-BENEFICIARY-NAME.
  4451                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4452                 24  FILLER                  PIC X(15).
  4453             20  PB-CI-NOTE-SW               PIC X.
  4454             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4455             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4456             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4457             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4458             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4459             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4460             20  PB-CI-FIRST-NAME            PIC X(10).
  4461             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  83
* EL050.cbl
  4462
  4463         16  FILLER                       PIC X(13).
  4464*032306  16  FILLER                       PIC X(27).
  4465*        16  FILLER                       PIC X(46).
  4466
  4467     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4468         16  FILLER                       PIC X(10).
  4469         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4470         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4471         16  PB-M-INSURED-MID-INIT        PIC X.
  4472         16  PB-M-INSURED-AGE             PIC 99.
  4473         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4474         16  PB-M-INSURED-SEX             PIC X.
  4475         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4476         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4477         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4478         16  PB-M-INSURED-CITY-STATE.
  4479             20  PB-M-INSURED-CITY        PIC X(28).
  4480             20  PB-M-INSURED-STATE       PIC XX.
  4481         16  PB-M-INSURED-ZIP-CODE.
  4482             20  PB-M-INSURED-ZIP-PRIME.
  4483                 24  PB-M-INSURED-ZIP-1   PIC X.
  4484                     88  PB-M-CANADIAN-POST-CODE
  4485                                             VALUE 'A' THRU 'Z'.
  4486                 24  FILLER               PIC X(4).
  4487             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4488         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4489                                        PB-M-INSURED-ZIP-CODE.
  4490             20  PM-M-INS-CAN-POST1       PIC XXX.
  4491             20  PM-M-INS-CAN-POST2       PIC XXX.
  4492             20  FILLER                   PIC XXX.
  4493         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4494         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4495         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4496         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4497         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4498         16  PB-M-CRED-BENE-CITYST.
  4499             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4500             20  PB-M-CRED-BENE-STATE     PIC XX.
  4501         16  FILLER                       PIC X(92).
  4502
  4503     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4504         16  FILLER                       PIC X(10).
  4505         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4506         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4507         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4508         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4509         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4510         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4511         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4512         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4513         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4514         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4515         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4516         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4517         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4518         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4519         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  84
* EL050.cbl
  4520         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4521         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4522         16  PB-ACCOUNT-NAME              PIC X(30).
  4523         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4524         16  PB-REFERENCE                 PIC X(12).
  4525         16  PB-B-RECEIVED-DT             PIC XX.
  4526         16  FILLER                       PIC X(234).
  4527
  4528     12  PB-RECORD-STATUS.
  4529         16  PB-CREDIT-SELECT-DT          PIC XX.
  4530         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4531         16  PB-BILLED-DT                 PIC XX.
  4532         16  PB-BILLING-STATUS            PIC X.
  4533             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4534             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4535             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4536         16  PB-RECORD-BILL               PIC X.
  4537             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4538             88  PB-RECORD-RETURNED           VALUE 'R'.
  4539             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4540             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4541             88  PB-OVERRIDE-AH               VALUE 'A'.
  4542             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4543         16  PB-BATCH-ENTRY               PIC X.
  4544             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4545             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4546             88  PB-REISSUED-CERT             VALUE 'E'.
  4547             88  PB-CASH-CERT                 VALUE 'C'.
  4548             88  PB-MONTHLY-CERT              VALUE 'M'.
  4549             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4550             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4551             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4552         16  PB-FORCE-CODE                PIC X.
  4553             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4554             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4555             88  PB-CANCEL-FORCE              VALUE '8'.
  4556             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4557             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4558             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4559             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4560             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4561             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4562             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4563             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4564         16  PB-FATAL-FLAG                PIC X.
  4565             88  PB-FATAL-ERRORS              VALUE 'X'.
  4566         16  PB-FORCE-ER-CD               PIC X.
  4567             88  PB-FORCE-ERRORS              VALUE 'F'.
  4568             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4569         16  PB-WARN-ER-CD                PIC X.
  4570             88  PB-WARNING-ERRORS            VALUE 'W'.
  4571         16  FILLER                       PIC X.
  4572         16  PB-OUT-BAL-CD                PIC X.
  4573             88  PB-OUT-OF-BAL                VALUE 'O'.
  4574         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4575         16  PB-AH-OVERRIDE-L1            PIC X.
  4576         16  PB-INPUT-DT                  PIC XX.
  4577         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  85
* EL050.cbl
  4578         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4579         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4580         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4581         16  PB-LF-EARNING-METHOD         PIC X.
  4582         16  PB-AH-EARNING-METHOD         PIC X.
  4583         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4584         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4585         16  PB-REIN-CD                   PIC XXX.
  4586         16  PB-LF-REFUND-TYPE            PIC X.
  4587         16  PB-AH-REFUND-TYPE            PIC X.
  4588         16  PB-ACCT-EFF-DT               PIC XX.
  4589         16  PB-ACCT-EXP-DT               PIC XX.
  4590         16  PB-COMPANY-ID                PIC X(3).
  4591         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4592         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4593         16  PB-SV-CARRIER                PIC X.
  4594         16  PB-SV-GROUPING               PIC X(6).
  4595         16  PB-SV-STATE                  PIC XX.
  4596         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4597         16  PB-GA-BILLING-INFO.
  4598             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4599                                          PIC XX.
  4600         16  PB-SV-REMIT-TO  REDEFINES
  4601             PB-GA-BILLING-INFO           PIC X(10).
  4602         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4603         16  PB-I-LOAN-OFFICER            PIC X(5).
  4604         16  PB-I-VIN                     PIC X(17).
  4605
  4606         16  FILLER                       PIC X(04).
  4607         16  IMNET-BYPASS-SW              PIC X.
  4608
  4609******************************************************************
  4610*                COMMON EDIT ERRORS                              *
  4611******************************************************************
  4612
  4613     12  PB-COMMON-ERRORS.
  4614         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4615                                           PIC S9(4)     COMP.
  4616
  4617******************************************************************
  4618
  4619* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4620*    COPY ELC50W1.
  4621******************************************************************
  4622*                                                                *
  4623*                                                                *
  4624*                             ELC50W1                            *
  4625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4626*                            VMOD=2.004                          *
  4627*                                                                *
  4628*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4629*                                                                *
  4630*                                                                *
  4631******************************************************************
  4632
  4633     12  WK-WORK-AREA.
  4634         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4635         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  86
* EL050.cbl
  4636         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4637         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4638         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4639         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4640         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4641         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4642         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4643         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4644         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4645         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4646         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4647         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4648         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4649         16  WK-CREDIT-EDIT-CONTROLS.
  4650             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4651             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4652             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4653             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4654             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4655             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4656         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4657         16  WK-SAVE-REIN-DATA.
  4658             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4659             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4660             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4661         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4662             88  ENTRY-FROM-EL6311       VALUE '6'.
  4663         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4664         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4665     12  WK-RECORD-ADDRESSES.
  4666         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4667         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4668         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4669         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4670         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4671         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4672         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4673         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4674     12  WK-OVER-SHORT-AREA.
  4675         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4676         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4677         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4678             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4679         16  FILLER                   PIC X(5) VALUE SPACES.
  4680
  4681*    COPY ELCEDITC.
  4682******************************************************************
  4683*                                                                *
  4684*                                                                *
  4685*                            ELCEDITC                            *
  4686*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4687*                            VMOD=2.012                          *
  4688*                                                                *
  4689*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4690*                     EL6313, EL050 AND EL517.                   *
  4691*                                                                *
  4692******************************************************************
  4693******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  87
* EL050.cbl
  4694*                   C H A N G E   L O G
  4695*
  4696* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4697*-----------------------------------------------------------------
  4698*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4699* EFFECTIVE    NUMBER
  4700*-----------------------------------------------------------------
  4701* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4702******************************************************************
  4703
  4704     12  EDIT-CRITERIA-DATA.
  4705         16  EC-CO-MONTH-END-DT       PIC XX.
  4706         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4707         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4708         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4709         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4710         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4711         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4712         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4713         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4714         16  EC-CO-REM-TERM-CALC      PIC X.
  4715               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4716               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4717               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4718               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4719
  4720         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4721               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4722               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4723               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4724               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4725               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4726               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4727               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4728               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4729               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4730               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4731
  4732         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4733               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4734               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4735               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4736               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4737               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4738               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4739               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4740               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4741
  4742         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4743                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4744                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4745
  4746         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4747                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4748                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4749                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4750                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4751                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  88
* EL050.cbl
  4752                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4753                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4754                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4755
  4756         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4757               88  EC-BR-REDUCING                   VALUE 'R'.
  4758               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4759
  4760         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4761         16  EC-BR-LF-DESC             PIC X(10).
  4762         16  EC-BR-AH-DESC             PIC X(10).
  4763         16  EC-BR-LF-COMMENT          PIC X(10).
  4764         16  EC-BR-AH-COMMENT          PIC X(10).
  4765
  4766         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4767               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4768               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4769               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4770               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4771
  4772         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4773               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4774               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4775               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4776               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4777
  4778         16  EC-BR-LF-REFUND-CALC      PIC X.
  4779                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4780                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4781                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4782                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4783                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4784                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4785                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4786
  4787         16  EC-BR-AH-REFUND-CALC      PIC X.
  4788                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4789                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4790                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4791                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4792                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4793                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4794                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4795                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4796
  4797         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4798                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4799                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4800                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4801
  4802         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4803                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4804                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4805                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4806
  4807         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4808         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4809         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  89
* EL050.cbl
  4810         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4811
  4812         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4813         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4814                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4815                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4816                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4817                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4818
  4819         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4820               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4821               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4822               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4823               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4824               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4825
  4826         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4827               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4828               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4829               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4830               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4831               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4832
  4833         16  EC-ST-LF-REFUND-CALC      PIC X.
  4834                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4835                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4836                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4837                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4838                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4839                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4840                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4841                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4842
  4843         16  EC-ST-AH-REFUND-CALC      PIC X.
  4844                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4845                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4846                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4847                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4848                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4849                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4850                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4851                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4852
  4853         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4854         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4855         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4856         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4857         16  EC-AM-EXPIRATION-DT       PIC XX.
  4858         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4859         16  EC-AM-CLASS-CD            PIC XX.
  4860         16  EC-AM-LF-DEVIATION        PIC XXX.
  4861         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4862         16  EC-AM-AH-DEVIATION        PIC XXX.
  4863         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4864         16  EC-AM-PHONE-NO            PIC X(10).
  4865
  4866         16  EC-AM-LF-REFUND-CALC      PIC X.
  4867                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  90
* EL050.cbl
  4868                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4869                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4870                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4871                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4872                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4873                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4874
  4875         16  EC-AM-AH-REFUND-CALC      PIC X.
  4876                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4877                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4878                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4879                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4880                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4881                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4882                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4883
  4884         16  EC-AM-BEN-I-G-CD          PIC X.
  4885                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4886                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4887                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4888
  4889         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4890         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4891         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4892         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4893         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4894         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4895         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4896         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4897         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4898
  4899         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4900         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4901         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4902         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4903         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4904         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4905         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4906         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4907         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4908         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4909         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4910         16  EC-RT-LF-NSP-ST           PIC XX.
  4911         16  EC-RT-AH-NSP-ST           PIC XX.
  4912         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4913         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4914
  4915         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4916             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4917                                             'M' '5' '9' '2'.
  4918             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4919             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4920             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4921             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4922             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4923             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4924             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4925             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  91
* EL050.cbl
  4926             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4927             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4928
  4929         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4930             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4931                                             'M' '5' '9' '2'.
  4932             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4933             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4934             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4935             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4936             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4937             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4938             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4939             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4940             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4941             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4942
  4943         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4944         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4945         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4946         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4947         16  EC-CM-DEATH-DT            PIC XX.
  4948
  4949*DMD CUSTOM CODING FIELDS BELOW
  4950*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4951         16  EC-BR-DMD-RATING-SW       PIC X.
  4952                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4953                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4954                 88  NO-DMD-RATING               VALUE 'N'.
  4955
  4956         16  EC-NEW-CERT               PIC X(11).
  4957         16  EC-NEW-STATE              PIC XX.
  4958         16  FILLER                    PIC X.
  4959*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4960         16  OVER-SHORT-EDIT-FIELDS.
  4961             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4962             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4963             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4964             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4965             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4966             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4967             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4968             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4969             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4970         16  FILLER                    PIC X(71).
  4971******************************************************************
  4972
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  92
* EL050.cbl
  4974*    COPY ELCDIFRD.
  4975******************************************************************
  4976*                                                                *
  4977*                                                                *
  4978*                            ELCDIFRD.                           *
  4979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4980*                            VMOD=2.004                          *
  4981*                                                                *
  4982*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4983*                                                                *
  4984******************************************************************
  4985*
  4986  01  WS-DIFFERENCE-CALCULATION.
  4987        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4988        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4989        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4990        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4991        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4992        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4993        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4994        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4995        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4996        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4997        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4998
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  93
* EL050.cbl
  5000****************************************************************
  5001*
  5002* Copyright (c) 2007-2013 Dell Inc.
  5003* All rights reserved.
  5004*
  5005****************************************************************
  5006 01  DFHEIV.
  5007   02  DFHEIV0               PIC X(35).
  5008   02  DFHEIV1               PIC X(08).
  5009   02  DFHEIV2               PIC X(08).
  5010   02  DFHEIV3               PIC X(08).
  5011   02  DFHEIV4               PIC X(06).
  5012   02  DFHEIV5               PIC X(04).
  5013   02  DFHEIV6               PIC X(04).
  5014   02  DFHEIV7               PIC X(02).
  5015   02  DFHEIV8               PIC X(02).
  5016   02  DFHEIV9               PIC X(01).
  5017   02  DFHEIV10              PIC S9(7) COMP-3.
  5018   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5019   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5020   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5021   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5022   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5023   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5024   02  DFHEIV17              PIC X(04).
  5025   02  DFHEIV18              PIC X(04).
  5026   02  DFHEIV19              PIC X(04).
  5027   02  DFHEIV20              USAGE IS POINTER.
  5028   02  DFHEIV21              USAGE IS POINTER.
  5029   02  DFHEIV22              USAGE IS POINTER.
  5030   02  DFHEIV23              USAGE IS POINTER.
  5031   02  DFHEIV24              USAGE IS POINTER.
  5032   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5033   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5034   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5035   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5036   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5037   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5038   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5039   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5040   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5041   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5042   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5043   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5044   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5045   02  FILLER                PIC X(02).
  5046   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5047   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5048   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5049   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5050   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5051   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5052   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5053 LINKAGE  SECTION.
  5054*****************************************************************
  5055*                                                               *
  5056* Copyright (c) 2007-2013 Dell Inc.                             *
  5057* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  94
* EL050.cbl
  5058*                                                               *
  5059*****************************************************************
  5060 01  dfheiblk.
  5061     02  eibtime          pic s9(7) comp-3.
  5062     02  eibdate          pic s9(7) comp-3.
  5063     02  eibtrnid         pic x(4).
  5064     02  eibtaskn         pic s9(7) comp-3.
  5065     02  eibtrmid         pic x(4).
  5066     02  dfheigdi         pic s9(4) comp.
  5067     02  eibcposn         pic s9(4) comp.
  5068     02  eibcalen         pic s9(4) comp.
  5069     02  eibaid           pic x(1).
  5070     02  eibfiller1       pic x(1).
  5071     02  eibfn            pic x(2).
  5072     02  eibfiller2       pic x(2).
  5073     02  eibrcode         pic x(6).
  5074     02  eibfiller3       pic x(2).
  5075     02  eibds            pic x(8).
  5076     02  eibreqid         pic x(8).
  5077     02  eibrsrce         pic x(8).
  5078     02  eibsync          pic x(1).
  5079     02  eibfree          pic x(1).
  5080     02  eibrecv          pic x(1).
  5081     02  eibsend          pic x(1).
  5082     02  eibatt           pic x(1).
  5083     02  eibeoc           pic x(1).
  5084     02  eibfmh           pic x(1).
  5085     02  eibcompl         pic x(1).
  5086     02  eibsig           pic x(1).
  5087     02  eibconf          pic x(1).
  5088     02  eiberr           pic x(1).
  5089     02  eibrldbk         pic x(1).
  5090     02  eiberrcd         pic x(4).
  5091     02  eibsynrb         pic x(1).
  5092     02  eibnodat         pic x(1).
  5093     02  eibfiller5       pic x(2).
  5094     02  eibresp          pic s9(8) comp.
  5095     02  eibresp2         pic s9(8) comp.
  5096     02  dfheigdj         pic s9(4) comp.
  5097     02  dfheigdk         pic s9(4) comp.
  5098
  5099 01  DFHCOMMAREA                   PIC X(1036).
  5100
  5101*01 PARMLIST .
  5102*    02  FILLER                    PIC S9(8)   COMP.
  5103*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5104*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5105*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5106*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5107*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5108*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5109*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5110
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  95
* EL050.cbl
  5112*    COPY ELCCNTL.
  5113******************************************************************
  5114*                                                                *
  5115*                                                                *
  5116*                            ELCCNTL.                            *
  5117*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5118*                            VMOD=2.059                          *
  5119*                                                                *
  5120*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5121*                                                                *
  5122*   FILE TYPE = VSAM,KSDS                                        *
  5123*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5124*                                                                *
  5125*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5126*       ALTERNATE INDEX = NONE                                   *
  5127*                                                                *
  5128*   LOG = YES                                                    *
  5129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5130******************************************************************
  5131*                   C H A N G E   L O G
  5132*
  5133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5134*-----------------------------------------------------------------
  5135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5136* EFFECTIVE    NUMBER
  5137*-----------------------------------------------------------------
  5138* 082503                   PEMA  ADD BENEFIT GROUP
  5139* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5140* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5141* 092705    2005050300006  PEMA  ADD SPP LEASES
  5142* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5143* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5144* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5145* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5146* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5147* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5148* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5149* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5150* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5151* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5152* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5153******************************************************************
  5154*
  5155 01  CONTROL-FILE.
  5156     12  CF-RECORD-ID                       PIC XX.
  5157         88  VALID-CF-ID                        VALUE 'CF'.
  5158
  5159     12  CF-CONTROL-PRIMARY.
  5160         16  CF-COMPANY-ID                  PIC XXX.
  5161         16  CF-RECORD-TYPE                 PIC X.
  5162             88  CF-COMPANY-MASTER              VALUE '1'.
  5163             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5164             88  CF-STATE-MASTER                VALUE '3'.
  5165             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5166             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5167             88  CF-CARRIER-MASTER              VALUE '6'.
  5168             88  CF-MORTALITY-MASTER            VALUE '7'.
  5169             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  96
* EL050.cbl
  5170             88  CF-TERMINAL-MASTER             VALUE '9'.
  5171             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5172             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5173             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5174             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5175             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5176             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5177             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5178             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5179             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5180         16  CF-ACCESS-CD-GENL              PIC X(4).
  5181         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5182             20  CF-PROCESSOR               PIC X(4).
  5183         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5184             20  CF-STATE-CODE              PIC XX.
  5185             20  FILLER                     PIC XX.
  5186         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5187             20  FILLER                     PIC XX.
  5188             20  CF-HI-BEN-IN-REC           PIC XX.
  5189         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5190             20  FILLER                     PIC XXX.
  5191             20  CF-CARRIER-CNTL            PIC X.
  5192         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5193             20  FILLER                     PIC XX.
  5194             20  CF-HI-TYPE-IN-REC          PIC 99.
  5195         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5196             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5197                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5198             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5199             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5200         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5201             20  FILLER                     PIC X.
  5202             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5203         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5204             20  FILLER                     PIC XX.
  5205             20  CF-MORTGAGE-PLAN           PIC XX.
  5206         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5207
  5208     12  CF-LAST-MAINT-DT                   PIC XX.
  5209     12  CF-LAST-MAINT-BY                   PIC X(4).
  5210     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5211
  5212     12  CF-RECORD-BODY                     PIC X(728).
  5213
  5214
  5215****************************************************************
  5216*             COMPANY MASTER RECORD                            *
  5217****************************************************************
  5218
  5219     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5220         16  CF-COMPANY-ADDRESS.
  5221             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5222             20  CF-CL-IN-CARE-OF           PIC X(30).
  5223             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5224             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5225             20  CF-CL-CITY-STATE           PIC X(30).
  5226             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5227             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  97
* EL050.cbl
  5228         16  CF-COMPANY-CD                  PIC X.
  5229         16  CF-COMPANY-PASSWORD            PIC X(8).
  5230         16  CF-SECURITY-OPTION             PIC X.
  5231             88  ALL-SECURITY                   VALUE '1'.
  5232             88  COMPANY-VERIFY                 VALUE '2'.
  5233             88  PROCESSOR-VERIFY               VALUE '3'.
  5234             88  NO-SECURITY                    VALUE '4'.
  5235             88  ALL-BUT-TERM                   VALUE '5'.
  5236         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5237             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5238         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5239             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5240         16  CF-INFORCE-LOCATION            PIC X.
  5241             88  CERTS-ARE-ONLINE               VALUE '1'.
  5242             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5243             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5244         16  CF-LOWER-CASE-LETTERS          PIC X.
  5245         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5246             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5247             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5248             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5249             88  CF-ACCNT-CNTL                  VALUE '3'.
  5250             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5251
  5252         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5253         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5254
  5255         16  CF-LGX-CREDIT-USER             PIC X.
  5256             88  CO-IS-NOT-USER                 VALUE 'N'.
  5257             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5258
  5259         16 CF-CREDIT-CALC-CODES.
  5260             20  CF-CR-REM-TERM-CALC PIC X.
  5261               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5262               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5263               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5264               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5265               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5266               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5267               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5268             20  CF-CR-R78-METHOD           PIC X.
  5269               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5270               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5271
  5272         16  CF-CLAIM-CONTROL-COUNTS.
  5273             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5274                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5275
  5276             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5277                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5278
  5279             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5280                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5281
  5282             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5283                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5284
  5285         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  98
* EL050.cbl
  5286
  5287         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5288             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5289             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5290             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5291             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5292                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5293                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5294             20  CF-CO-PREM-REJECT-SW       PIC X.
  5295                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5296                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5297             20  CF-CO-REF-REJECT-SW        PIC X.
  5298                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5299                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5300
  5301         16  CF-CO-REPORTING-DT             PIC XX.
  5302         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5303         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5304           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5305           88  CF-CO-MONTH-END                  VALUE '1'.
  5306
  5307         16  CF-LGX-CLAIM-USER              PIC X.
  5308             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5309             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5310
  5311         16  CF-CREDIT-EDIT-CONTROLS.
  5312             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5313             20  CF-MIN-AGE                 PIC 99.
  5314             20  CF-DEFAULT-AGE             PIC 99.
  5315             20  CF-MIN-TERM                PIC S999      COMP-3.
  5316             20  CF-MAX-TERM                PIC S999      COMP-3.
  5317             20  CF-DEFAULT-SEX             PIC X.
  5318             20  CF-JOINT-AGE-INPUT         PIC X.
  5319                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5320             20  CF-BIRTH-DATE-INPUT        PIC X.
  5321                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5322             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5323                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5324                 88  CF-ZERO-CARRIER            VALUE '1'.
  5325                 88  CF-ZERO-GROUPING           VALUE '2'.
  5326                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5327             20  CF-EDIT-SW                 PIC X.
  5328                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5329             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5330             20  CF-CR-PR-METHOD            PIC X.
  5331               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5332               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5333             20  FILLER                     PIC X.
  5334
  5335         16  CF-CREDIT-MISC-CONTROLS.
  5336             20  CF-REIN-TABLE-SW           PIC X.
  5337                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5338             20  CF-COMP-TABLE-SW           PIC X.
  5339                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5340             20  CF-EXPERIENCE-RETENTION-AGE
  5341                                            PIC S9        COMP-3.
  5342             20  CF-CONVERSION-DT           PIC XX.
  5343             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page  99
* EL050.cbl
  5344             20  CF-RUN-FREQUENCY-SW        PIC X.
  5345                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5346                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5347
  5348             20  CF-CR-CHECK-NO-CONTROL.
  5349                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5350                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5351                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5352                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5353                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5354                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5355
  5356                 24  CF-CR-CHECK-COUNT       REDEFINES
  5357                     CF-CR-CHECK-COUNTER      PIC X(4).
  5358
  5359                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5360                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5361
  5362                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5363                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5364                 24  CF-MAIL-PROCESSING       PIC X.
  5365                     88  MAIL-PROCESSING          VALUE 'Y'.
  5366
  5367         16  CF-MISC-SYSTEM-CONTROL.
  5368             20  CF-SYSTEM-C                 PIC X.
  5369                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5370             20  CF-SYSTEM-D                 PIC X.
  5371                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5372             20  CF-SOC-SEC-NO-SW            PIC X.
  5373                 88  SOC-SEC-NO-USED             VALUE '1'.
  5374             20  CF-MEMBER-NO-SW             PIC X.
  5375                 88  MEMBER-NO-USED              VALUE '1'.
  5376             20  CF-TAX-ID-NUMBER            PIC X(11).
  5377             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5378             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5379                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5380                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5381                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5382                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5383             20  CF-SYSTEM-E                 PIC X.
  5384                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5385
  5386         16  CF-LGX-LIFE-USER               PIC X.
  5387             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5388             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5389
  5390         16  CF-CR-MONTH-END-DT             PIC XX.
  5391
  5392         16  CF-FILE-MAINT-DATES.
  5393             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5394                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5395             20  CF-LAST-BATCH       REDEFINES
  5396                 CF-LAST-BATCH-NO               PIC X(4).
  5397             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5398             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5399             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5400             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5401             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 100
* EL050.cbl
  5402             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5403             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5404             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5405             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5406             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5407
  5408         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5409         16  FILLER                         PIC X.
  5410
  5411         16  CF-ALT-MORT-CODE               PIC X(4).
  5412         16  CF-MEMBER-CAPTION              PIC X(10).
  5413
  5414         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5415             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5416             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5417             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5418             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5419             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5420
  5421         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5422
  5423         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5424         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5425         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5426         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5427
  5428         16  CF-AH-OVERRIDE-L1              PIC X.
  5429         16  CF-AH-OVERRIDE-L2              PIC XX.
  5430         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5431         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5432
  5433         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5434         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5435
  5436         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5437         16  CF-AR-LAST-EL860-DT            PIC XX.
  5438         16  CF-MP-MONTH-END-DT             PIC XX.
  5439
  5440         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5441         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5442             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5443
  5444         16  CF-AR-MONTH-END-DT             PIC XX.
  5445
  5446         16  CF-CRDTCRD-USER                PIC X.
  5447             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5448             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5449
  5450         16  CF-CC-MONTH-END-DT             PIC XX.
  5451
  5452         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5453
  5454         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5455             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5456             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5457             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5458         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5459         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 101
* EL050.cbl
  5460         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5461         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5462             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5463             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5464         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5465         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5466         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5467             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5468         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5469
  5470         16  CF-CL-ZIP-CODE.
  5471             20  CF-CL-ZIP-PRIME.
  5472                 24  CF-CL-ZIP-1ST          PIC X.
  5473                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5474                 24  FILLER                 PIC X(4).
  5475             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5476         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5477             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5478             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5479             20  FILLER                     PIC XXX.
  5480
  5481         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5482         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5483         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5484         16  CF-CO-OPTION-START-DATE        PIC XX.
  5485         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5486           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5487                                                      '3' '4'.
  5488           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5489           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5490           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5491           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5492           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5493           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5494
  5495         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5496
  5497         16  CF-PAYMENT-APPROVAL-LEVELS.
  5498             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5499             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5500             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5501             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5502             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5503             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5504
  5505         16  CF-END-USER-REPORTING-USER     PIC X.
  5506             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5507             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5508
  5509         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5510             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5511             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5512
  5513         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5514
  5515         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5516         16  FILLER                         PIC X.
  5517
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 102
* EL050.cbl
  5518         16  CF-CREDIT-ARCHIVE-CNTL.
  5519             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5520             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5521             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5522
  5523         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5524
  5525         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5526             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5527             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5528
  5529         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5530             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5531             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5532
  5533         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5534
  5535         16  CF-CO-ACH-ID-CODE              PIC  X.
  5536             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5537             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5538             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5539         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5540         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5541         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5542         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5543         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5544         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5545         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5546         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5547         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5548                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5549         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5550                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5551
  5552         16  CF-CO-OVER-SHORT.
  5553             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5554             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5555
  5556*         16  FILLER                         PIC X(102).
  5557         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5558             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5559             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5560
  5561         16  CF-AH-APPROVAL-DAYS.
  5562             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5563             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5564             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5565             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5566
  5567         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5568
  5569         16  CF-APPROV-LEV-5.
  5570             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5571             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5572             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5573
  5574         16  FILLER                         PIC X(68).
  5575****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 103
* EL050.cbl
  5576*             PROCESSOR/USER RECORD                            *
  5577****************************************************************
  5578
  5579     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5580         16  CF-PROCESSOR-NAME              PIC X(30).
  5581         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5582         16  CF-PROCESSOR-TITLE             PIC X(26).
  5583         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5584                 88  MESSAGE-YES                VALUE 'Y'.
  5585                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5586
  5587*****************************************************
  5588****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5589****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5590****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5591****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5592*****************************************************
  5593
  5594         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5595             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5596             20  CF-APPLICATION-FORCE       PIC X.
  5597             20  CF-INDIVIDUAL-APP.
  5598                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5599                     28  CF-BROWSE-APP      PIC X.
  5600                     28  CF-UPDATE-APP      PIC X.
  5601
  5602         16  CF-CURRENT-TERM-ON             PIC X(4).
  5603         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5604             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5605             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5606             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5607             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5608             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5609             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5610             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5611         16  CF-PROCESSOR-CARRIER           PIC X.
  5612             88  NO-CARRIER-SECURITY            VALUE ' '.
  5613         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5614             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5615         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5616             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5617         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5618             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5619
  5620         16  CF-PROC-SYS-ACCESS-SW.
  5621             20  CF-PROC-CREDIT-CLAIMS-SW.
  5622                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5623                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5624                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5625                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5626             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5627                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5628                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5629             20  CF-PROC-LIFE-GNRLDGR-SW.
  5630                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5631                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5632                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5633                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 104
* EL050.cbl
  5634             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5635                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5636                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5637         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5638             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5639             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5640         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5641
  5642         16  CF-APPROVAL-LEVEL                  PIC X.
  5643             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5644             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5645             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5646             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5647             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5648
  5649         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5650
  5651         16  CF-LANGUAGE-TYPE                   PIC X.
  5652             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5653             88  CF-LANG-IS-FR                      VALUE 'F'.
  5654
  5655         16  CF-CSR-IND                         PIC X.
  5656         16  FILLER                             PIC X(239).
  5657
  5658****************************************************************
  5659*             PROCESSOR/REMINDERS RECORD                       *
  5660****************************************************************
  5661
  5662     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5663         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5664             20  CF-START-REMIND-DT         PIC XX.
  5665             20  CF-END-REMIND-DT           PIC XX.
  5666             20  CF-REMINDER-TEXT           PIC X(50).
  5667         16  FILLER                         PIC X(296).
  5668
  5669
  5670****************************************************************
  5671*             STATE MASTER RECORD                              *
  5672****************************************************************
  5673
  5674     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5675         16  CF-STATE-ABBREVIATION          PIC XX.
  5676         16  CF-STATE-NAME                  PIC X(25).
  5677         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5678         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5679             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5680             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5681             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5682             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5683                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5684                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5685             20  CF-ST-PREM-REJECT-SW       PIC X.
  5686                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5687                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5688             20  CF-ST-REF-REJECT-SW        PIC X.
  5689                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5690                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5691         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 105
* EL050.cbl
  5692         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5693         16  CF-ST-REFUND-RULES.
  5694             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5695             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5696             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5697         16  CF-ST-FST-PMT-EXTENSION.
  5698             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5699             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5700                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5701                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5702                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5703                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5704         16  CF-ST-STATE-CALL.
  5705             20  CF-ST-CALL-UNEARNED        PIC X.
  5706             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5707             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5708         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5709             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5710             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5711         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5712         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5713         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5714         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5715         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5716         16  FILLER                         PIC X.
  5717         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5718             20  CF-ST-BENEFIT-CD           PIC XX.
  5719             20  CF-ST-BENEFIT-KIND         PIC X.
  5720                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5721                 88  CF-ST-AH-KIND              VALUE 'A'.
  5722             20  CF-ST-REM-TERM-CALC        PIC X.
  5723                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5724                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5725                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5726                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5727                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5728                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5729                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5730                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5731
  5732             20  CF-ST-REFUND-CALC          PIC X.
  5733                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5734                 88  ST-REFD-BY-R78             VALUE '1'.
  5735                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5736                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5737                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5738                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5739                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5740                 88  ST-REFD-UTAH               VALUE '7'.
  5741                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5742                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5743                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5744
  5745             20  CF-ST-EARNING-CALC         PIC X.
  5746                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5747                 88  ST-EARN-BY-R78             VALUE '1'.
  5748                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5749                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 106
* EL050.cbl
  5750                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5751                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5752                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5753                 88  ST-EARN-MEAN               VALUE '8'.
  5754                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5755
  5756             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5757                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5758                 88  ST-OVRD-BY-R78             VALUE '1'.
  5759                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5760                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5761                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5762                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5763                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5764                 88  ST-OVRD-MEAN               VALUE '8'.
  5765                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5766             20  cf-st-extra-periods        pic 9.
  5767*            20  FILLER                     PIC X.
  5768
  5769         16  CF-ST-COMMISSION-CAPS.
  5770             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5771             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5772             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5773             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5774         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5775                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5776                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5777                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5778
  5779         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5780
  5781         16  CF-ST-STATUTORY-INTEREST.
  5782             20  CF-ST-STAT-DATE-FROM       PIC X.
  5783                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5784                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5785             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5786             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5787             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5788             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5789             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5790
  5791         16  CF-ST-OVER-SHORT.
  5792             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5793             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5794
  5795         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5796
  5797         16  CF-ST-RT-CALC                  PIC X.
  5798
  5799         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5800         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5801         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5802         16  CF-ST-RF-LR-CALC               PIC X.
  5803         16  CF-ST-RF-LL-CALC               PIC X.
  5804         16  CF-ST-RF-LN-CALC               PIC X.
  5805         16  CF-ST-RF-AH-CALC               PIC X.
  5806         16  CF-ST-RF-CP-CALC               PIC X.
  5807*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 107
* EL050.cbl
  5808*CIDMOD         16  FILLER                         PIC X(192).
  5809         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5810             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5811         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5812         16  CF-ST-VFY-2ND-BENE             PIC X.
  5813         16  CF-ST-CAUSAL-STATE             PIC X.
  5814         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5815         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5816         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5817             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5818         16  CF-ST-NET-ONLY-STATE           PIC X.
  5819             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5820         16  cf-commission-cap-required     pic x.
  5821         16  CF-ST-GA-COMMISSION-CAPS.
  5822             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5823             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5824             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5825             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5826         16  CF-ST-TOT-COMMISSION-CAPS.
  5827             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5828             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5829             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5830             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5831         16  FILLER                         PIC X(156).
  5832
  5833****************************************************************
  5834*             BENEFIT MASTER RECORD                            *
  5835****************************************************************
  5836
  5837     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5838         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5839             20  CF-BENEFIT-CODE            PIC XX.
  5840             20  CF-BENEFIT-NUMERIC  REDEFINES
  5841                 CF-BENEFIT-CODE            PIC XX.
  5842             20  CF-BENEFIT-ALPHA           PIC XXX.
  5843             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5844             20  CF-BENEFIT-COMMENT         PIC X(10).
  5845
  5846             20  CF-LF-COVERAGE-TYPE        PIC X.
  5847                 88  CF-REDUCING                VALUE 'R'.
  5848                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5849
  5850             20  CF-SPECIAL-CALC-CD         PIC X.
  5851                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5852                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5853                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5854                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5855                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5856                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5857                 88  CF-FARM-PLAN               VALUE 'F'.
  5858                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5859                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5860                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5861                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5862                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5863                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5864                 88  CF-PRUDENTIAL              VALUE 'P'.
  5865                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 108
* EL050.cbl
  5866                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5867                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5868                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5869                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5870                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5871
  5872             20  CF-JOINT-INDICATOR         PIC X.
  5873                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5874
  5875*            20  FILLER                     PIC X(12).
  5876             20  cf-maximum-benefits        pic s999 comp-3.
  5877             20  FILLER                     PIC X(09).
  5878             20  CF-BENEFIT-CATEGORY        PIC X.
  5879             20  CF-LOAN-TYPE               PIC X(8).
  5880
  5881             20  CF-CO-REM-TERM-CALC        PIC X.
  5882                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5883                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5884                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5885                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5886                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5887
  5888             20  CF-CO-EARNINGS-CALC        PIC X.
  5889                 88  CO-EARN-BY-R78             VALUE '1'.
  5890                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5891                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5892                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5893                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5894                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5895                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5896                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5897
  5898             20  CF-CO-REFUND-CALC          PIC X.
  5899                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5900                 88  CO-REFD-BY-R78             VALUE '1'.
  5901                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5902                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5903                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5904                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5905                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5906                 88  CO-REFD-MEAN               VALUE '8'.
  5907                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5908                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5909                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5910
  5911             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5912                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5913                 88  CO-OVRD-BY-R78             VALUE '1'.
  5914                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5915                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5916                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5917                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5918                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5919                 88  CO-OVRD-MEAN               VALUE '8'.
  5920                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5921
  5922             20  CF-CO-BEN-I-G-CD           PIC X.
  5923                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 109
* EL050.cbl
  5924                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5925                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5926
  5927         16  FILLER                         PIC X(304).
  5928
  5929
  5930****************************************************************
  5931*             CARRIER MASTER RECORD                            *
  5932****************************************************************
  5933
  5934     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5935         16  CF-ADDRESS-DATA.
  5936             20  CF-MAIL-TO-NAME            PIC X(30).
  5937             20  CF-IN-CARE-OF              PIC X(30).
  5938             20  CF-ADDRESS-LINE-1          PIC X(30).
  5939             20  CF-ADDRESS-LINE-2          PIC X(30).
  5940             20  CF-CITY-STATE              PIC X(30).
  5941             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5942             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5943
  5944         16  CF-CLAIM-NO-CONTROL.
  5945             20  CF-CLAIM-NO-METHOD         PIC X.
  5946                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5947                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5948                 88  CLAIM-NO-SEQ               VALUE '3'.
  5949                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5950             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5951                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5952                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5953                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5954
  5955         16  CF-CHECK-NO-CONTROL.
  5956             20  CF-CHECK-NO-METHOD         PIC X.
  5957                 88  CHECK-NO-MANUAL            VALUE '1'.
  5958                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5959                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5960                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5961             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5962                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5963
  5964         16  CF-DOMICILE-STATE              PIC XX.
  5965
  5966         16  CF-EXPENSE-CONTROLS.
  5967             20  CF-EXPENSE-METHOD          PIC X.
  5968                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5969                 88  DOLLARS-PER-PMT            VALUE '2'.
  5970                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5971                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5972             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5973             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5974
  5975         16  CF-CORRESPONDENCE-CONTROL.
  5976             20  CF-LETTER-RESEND-OPT       PIC X.
  5977                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5978                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5979             20  FILLER                     PIC X(4).
  5980
  5981         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 110
* EL050.cbl
  5982             20  CF-MANUAL-SW               PIC X.
  5983                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5984             20  CF-FUTURE-SW               PIC X.
  5985                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5986             20  CF-PTC-SW                  PIC X.
  5987                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5988             20  CF-IBNR-SW                 PIC X.
  5989                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5990             20  CF-PTC-LF-SW               PIC X.
  5991                 88  CF-LF-PTC-USED             VALUE '1'.
  5992             20  CF-CDT-ACCESS-METHOD       PIC X.
  5993                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5994                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5995                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5996             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5997
  5998         16  CF-CLAIM-CALC-METHOD           PIC X.
  5999             88  360-PLUS-MONTHS                VALUE '1'.
  6000             88  365-PLUS-MONTHS                VALUE '2'.
  6001             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6002             88  360-DAILY                      VALUE '4'.
  6003             88  365-DAILY                      VALUE '5'.
  6004
  6005         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6006         16  FILLER                         PIC X(11).
  6007
  6008         16  CF-LIMIT-AMOUNTS.
  6009             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6010             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6011             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6012             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6013             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6014             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6015             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6016             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6017             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6018             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6019
  6020         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6021         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6022         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6023
  6024         16  CF-ZIP-CODE.
  6025             20  CF-ZIP-PRIME.
  6026                 24  CF-ZIP-1ST             PIC X.
  6027                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6028                 24  FILLER                 PIC X(4).
  6029             20  CF-ZIP-PLUS4               PIC X(4).
  6030         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6031             20  CF-CAN-POSTAL-1            PIC XXX.
  6032             20  CF-CAN-POSTAL-2            PIC XXX.
  6033             20  FILLER                     PIC XXX.
  6034
  6035         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6036         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6037         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6038
  6039         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 111
* EL050.cbl
  6040             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6041             88  CF-NO-RATING                   VALUE 'N'.
  6042
  6043         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6044
  6045         16  CF-CARRIER-OVER-SHORT.
  6046             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6047             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6048
  6049         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6050         16  CF-SECPAY-SWITCH               PIC X.
  6051             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6052             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6053         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6054         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6055         16  FILLER                         PIC X(444).
  6056*        16  FILLER                         PIC X(452).
  6057
  6058
  6059****************************************************************
  6060*             MORTALITY MASTER RECORD                          *
  6061****************************************************************
  6062
  6063     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6064         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6065                                INDEXED BY CF-MORT-NDX.
  6066             20  CF-MORT-TABLE              PIC X(5).
  6067             20  CF-MORT-TABLE-TYPE         PIC X.
  6068                 88  CF-MORT-JOINT              VALUE 'J'.
  6069                 88  CF-MORT-SINGLE             VALUE 'S'.
  6070                 88  CF-MORT-COMBINED           VALUE 'C'.
  6071                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6072                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6073             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6074             20  CF-MORT-AGE-METHOD         PIC XX.
  6075                 88  CF-AGE-LAST                VALUE 'AL'.
  6076                 88  CF-AGE-NEAR                VALUE 'AN'.
  6077             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6078             20  CF-MORT-ADJUSTMENT-DIRECTION
  6079                                            PIC X.
  6080                 88  CF-MINUS                   VALUE '-'.
  6081                 88  CF-PLUS                    VALUE '+'.
  6082             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6083             20  CF-MORT-JOINT-CODE         PIC X.
  6084                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6085             20  CF-MORT-PC-Q               PIC X.
  6086                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6087             20  CF-MORT-TABLE-CODE         PIC X(4).
  6088             20  CF-MORT-COMMENTS           PIC X(15).
  6089             20  FILLER                     PIC X(14).
  6090
  6091         16  FILLER                         PIC X(251).
  6092
  6093
  6094****************************************************************
  6095*             BUSSINESS TYPE MASTER RECORD                     *
  6096****************************************************************
  6097
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 112
* EL050.cbl
  6098     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6099* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6100* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6101* AND RECORD 05 IS TYPES 81-99
  6102         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6103             20  CF-BUSINESS-TITLE          PIC  X(19).
  6104             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6105                                            PIC S9V9(4) COMP-3.
  6106             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6107             20  FILLER                     PIC  X.
  6108         16  FILLER                         PIC  X(248).
  6109
  6110
  6111****************************************************************
  6112*             TERMINAL MASTER RECORD                           *
  6113****************************************************************
  6114
  6115     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6116
  6117         16  CF-COMPANY-TERMINALS.
  6118             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6119                                  PIC X(4).
  6120         16  FILLER               PIC X(248).
  6121
  6122
  6123****************************************************************
  6124*             LIFE EDIT MASTER RECORD                          *
  6125****************************************************************
  6126
  6127     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6128         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6129             20  CF-LIFE-CODE-IN            PIC XX.
  6130             20  CF-LIFE-CODE-OUT           PIC XX.
  6131         16  FILLER                         PIC X(248).
  6132
  6133
  6134****************************************************************
  6135*             AH EDIT MASTER RECORD                            *
  6136****************************************************************
  6137
  6138     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6139         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6140             20  CF-AH-CODE-IN              PIC XXX.
  6141             20  CF-AH-CODE-OUT             PIC XX.
  6142         16  FILLER                         PIC X(248).
  6143
  6144
  6145****************************************************************
  6146*             CREDIBILITY TABLES                               *
  6147****************************************************************
  6148
  6149     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6150         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6151                             INDEXED BY CF-CRDB-NDX.
  6152             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6153             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6154             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6155         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 113
* EL050.cbl
  6156
  6157
  6158****************************************************************
  6159*             REPORT CUSTOMIZATION RECORD                      *
  6160****************************************************************
  6161
  6162     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6163         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6164             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6165             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6166             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6167**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6168****       A T-TRANSFER.                                   ****
  6169             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6170
  6171         16  FILLER                         PIC XX.
  6172
  6173         16  CF-CARRIER-CNTL-OPT.
  6174             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6175                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6176                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6177             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6178                                            PIC X.
  6179         16  CF-GROUP-CNTL-OPT.
  6180             20  CF-GROUP-OPT-SEQ           PIC 9.
  6181                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6182                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6183             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6184                                            PIC X(6).
  6185         16  CF-STATE-CNTL-OPT.
  6186             20  CF-STATE-OPT-SEQ           PIC 9.
  6187                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6188                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6189             20  CF-STATE-SELECT OCCURS 3 TIMES
  6190                                            PIC XX.
  6191         16  CF-ACCOUNT-CNTL-OPT.
  6192             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6193                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6194                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6195             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6196                                            PIC X(10).
  6197         16  CF-BUS-TYP-CNTL-OPT.
  6198             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6199                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6200                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6201             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6202                                            PIC XX.
  6203         16  CF-LF-TYP-CNTL-OPT.
  6204             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6205                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6206                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6207             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6208                                            PIC XX.
  6209         16  CF-AH-TYP-CNTL-OPT.
  6210             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6211                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6212                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6213             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 114
* EL050.cbl
  6214                                            PIC XX.
  6215         16  CF-REPTCD1-CNTL-OPT.
  6216             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6217                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6218                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6219             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6220                                            PIC X(10).
  6221         16  CF-REPTCD2-CNTL-OPT.
  6222             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6223                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6224                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6225             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6226                                            PIC X(10).
  6227         16  CF-USER1-CNTL-OPT.
  6228             20  CF-USER1-OPT-SEQ           PIC 9.
  6229                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6230                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6231             20  CF-USER1-SELECT OCCURS 3 TIMES
  6232                                            PIC X(10).
  6233         16  CF-USER2-CNTL-OPT.
  6234             20  CF-USER2-OPT-SEQ           PIC 9.
  6235                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6236                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6237             20  CF-USER2-SELECT OCCURS 3 TIMES
  6238                                            PIC X(10).
  6239         16  CF-USER3-CNTL-OPT.
  6240             20  CF-USER3-OPT-SEQ           PIC 9.
  6241                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6242                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6243             20  CF-USER3-SELECT OCCURS 3 TIMES
  6244                                            PIC X(10).
  6245         16  CF-USER4-CNTL-OPT.
  6246             20  CF-USER4-OPT-SEQ           PIC 9.
  6247                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6248                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6249             20  CF-USER4-SELECT OCCURS 3 TIMES
  6250                                            PIC X(10).
  6251         16  CF-USER5-CNTL-OPT.
  6252             20  CF-USER5-OPT-SEQ           PIC 9.
  6253                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6254                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6255             20  CF-USER5-SELECT OCCURS 3 TIMES
  6256                                            PIC X(10).
  6257         16  CF-REINS-CNTL-OPT.
  6258             20  CF-REINS-OPT-SEQ           PIC 9.
  6259                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6260                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6261             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6262                 24  CF-REINS-PRIME         PIC XXX.
  6263                 24  CF-REINS-SUB           PIC XXX.
  6264
  6265         16  CF-AGENT-CNTL-OPT.
  6266             20  CF-AGENT-OPT-SEQ           PIC 9.
  6267                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6268                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6269             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6270                                            PIC X(10).
  6271
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 115
* EL050.cbl
  6272         16  FILLER                         PIC X(43).
  6273
  6274         16  CF-LOSS-RATIO-SELECT.
  6275             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6276             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6277         16  CF-ENTRY-DATE-SELECT.
  6278             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6279             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6280         16  CF-EFFECTIVE-DATE-SELECT.
  6281             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6282             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6283
  6284         16  CF-EXCEPTION-LIST-IND          PIC X.
  6285             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6286
  6287         16  FILLER                         PIC X(318).
  6288
  6289****************************************************************
  6290*                  EXCEPTION REPORTING RECORD                  *
  6291****************************************************************
  6292
  6293     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6294         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6295             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6296
  6297         16  CF-COMBINED-LIFE-AH-OPT.
  6298             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6299             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6300             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6301             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6302
  6303         16  CF-LIFE-OPT.
  6304             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6305             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6306             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6307             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6308             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6309             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6310             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6311             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6312             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6313             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6314
  6315         16  CF-AH-OPT.
  6316             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6317             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6318             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6319             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6320             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6321             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6322             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6323             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6324             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6325             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6326
  6327         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6328             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6329             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 116
* EL050.cbl
  6330             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6331
  6332         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6333
  6334         16  FILLER                         PIC X(673).
  6335
  6336
  6337****************************************************************
  6338*             MORTGAGE SYSTEM PLAN RECORD                      *
  6339****************************************************************
  6340
  6341     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6342         16  CF-PLAN-TYPE                   PIC X.
  6343             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6344             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6345             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6346         16  CF-PLAN-ABBREV                 PIC XXX.
  6347         16  CF-PLAN-DESCRIPT               PIC X(10).
  6348         16  CF-PLAN-NOTES                  PIC X(20).
  6349         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6350         16  CF-PLAN-UNDERWRITING.
  6351             20  CF-PLAN-TERM-DATA.
  6352                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6353                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6354             20  CF-PLAN-AGE-DATA.
  6355                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6356                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6357                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6358             20  CF-PLAN-BENEFIT-DATA.
  6359                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6360                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6361                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6362                                            PIC S9(7)V99  COMP-3.
  6363         16  CF-PLAN-POLICY-FORMS.
  6364             20  CF-POLICY-FORM             PIC X(12).
  6365             20  CF-MASTER-APPLICATION      PIC X(12).
  6366             20  CF-MASTER-POLICY           PIC X(12).
  6367         16  CF-PLAN-RATING.
  6368             20  CF-RATE-CODE               PIC X(5).
  6369             20  CF-SEX-RATING              PIC X.
  6370                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6371                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6372             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6373             20  CF-SUB-STD-TYPE            PIC X.
  6374                 88  CF-PCT-OF-PREM            VALUE '1'.
  6375                 88  CF-PCT-OF-BENE            VALUE '2'.
  6376         16  CF-PLAN-PREM-TOLERANCES.
  6377             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6378             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6379         16  CF-PLAN-PYMT-TOLERANCES.
  6380             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6381             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6382         16  CF-PLAN-MISC-DATA.
  6383             20  FILLER                     PIC X.
  6384             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6385             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6386         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6387         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 117
* EL050.cbl
  6388             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6389                                                     '1'.
  6390             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6391                                                     '2'.
  6392         16  CF-MIB-SEARCH-SW               PIC X.
  6393             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6394             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6395             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6396             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6397         16  CF-ALPHA-SEARCH-SW             PIC X.
  6398             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6399             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6400             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6401             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6402             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6403             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6404             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6405             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6406             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6407             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6408                                                     'A' 'B' 'C'
  6409                                                     'X' 'Y' 'Z'.
  6410         16  CF-EFF-DT-RULE-SW              PIC X.
  6411             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6412             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6413             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6414             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6415             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6416         16  FILLER                         PIC X(4).
  6417         16  CF-HEALTH-QUESTIONS            PIC X.
  6418             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6419         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6420         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6421         16  CF-PLAN-SNGL-JNT               PIC X.
  6422             88  CF-COMBINED-PLAN              VALUE 'C'.
  6423             88  CF-JNT-PLAN                   VALUE 'J'.
  6424             88  CF-SNGL-PLAN                  VALUE 'S'.
  6425         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6426         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6427         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6428         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6429         16  CF-RERATE-CNTL                 PIC  X.
  6430             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6431             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6432             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6433             88  CF-AUTO-RECALC                 VALUE '4'.
  6434         16  CF-BENEFIT-TYPE                PIC  X.
  6435             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6436             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6437         16  CF-POLICY-FEE                  PIC S999V99
  6438                                                    COMP-3.
  6439         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6440         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6441         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6442         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6443         16  FILLER                         PIC  X(32).
  6444         16  CF-TERMINATION-FORM            PIC  X(04).
  6445         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 118
* EL050.cbl
  6446         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6447                                                       COMP-3.
  6448         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6449         16  CF-ISSUE-LETTER                PIC  X(4).
  6450         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6451         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6452             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6453             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6454         16  CF-MP-REFUND-CALC              PIC X.
  6455             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6456             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6457             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6458             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6459             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6460             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6461             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6462             88  CF-MP-REFD-MEAN                VALUE '8'.
  6463         16  CF-ALT-RATE-CODE               PIC  X(5).
  6464
  6465
  6466         16  FILLER                         PIC X(498).
  6467****************************************************************
  6468*             MORTGAGE COMPANY MASTER RECORD                   *
  6469****************************************************************
  6470
  6471     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6472         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6473         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6474             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6475             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6476             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6477             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6478             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6479
  6480         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6481         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6482         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6483         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6484         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6485
  6486         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6487             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6488         16  CF-MP-RECON-USE-IND            PIC X(1).
  6489             88  CF-MP-USE-RECON             VALUE 'Y'.
  6490         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6491             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6492         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6493             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6494             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6495         16  FILLER                         PIC X(1).
  6496         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6497             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6498         16  CF-MORTG-MIB-VERSION           PIC X.
  6499             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6500             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6501             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6502         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6503             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 119
* EL050.cbl
  6504                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6505             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6506                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6507             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6508                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6509             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6510                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6511             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6512                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6513             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6514                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6515         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6516         16  FILLER                         PIC X(7).
  6517         16  CF-MORTG-DESTINATION-SYMBOL.
  6518             20  CF-MORTG-MIB-COMM          PIC X(5).
  6519             20  CF-MORTG-MIB-TERM          PIC X(5).
  6520         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6521             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6522         16  FILLER                         PIC X(03).
  6523         16  CF-MP-CHECK-NO-CONTROL.
  6524             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6525                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6526                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6527                                                ' ' LOW-VALUES.
  6528                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6529                                               VALUE '3'.
  6530         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6531         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6532         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6533             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6534                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6535             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6536                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6537             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6538                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6539             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6540                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6541             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6542                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6543             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6544                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6545         16  CF-MORTG-BILLING-AREA.
  6546             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6547                                            PIC X.
  6548         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6549         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6550         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6551         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6552             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6553             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6554         16  FILLER                         PIC X.
  6555         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6556             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6557             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6558         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6559         16  FILLER                         PIC X(8).
  6560         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6561         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 120
* EL050.cbl
  6562         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6563         16  CF-ACH-COMPANY-ID.
  6564             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6565                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6566                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6567                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6568             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6569         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6570             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6571         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6572             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6573             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6574         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6575         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6576         16  FILLER                         PIC X(536).
  6577
  6578****************************************************************
  6579*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6580****************************************************************
  6581
  6582     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6583         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6584             20  CF-FEMALE-HEIGHT.
  6585                 24  CF-FEMALE-FT           PIC 99.
  6586                 24  CF-FEMALE-IN           PIC 99.
  6587             20  CF-FEMALE-MIN-WT           PIC 999.
  6588             20  CF-FEMALE-MAX-WT           PIC 999.
  6589         16  FILLER                         PIC X(428).
  6590
  6591     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6592         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6593             20  CF-MALE-HEIGHT.
  6594                 24  CF-MALE-FT             PIC 99.
  6595                 24  CF-MALE-IN             PIC 99.
  6596             20  CF-MALE-MIN-WT             PIC 999.
  6597             20  CF-MALE-MAX-WT             PIC 999.
  6598         16  FILLER                         PIC X(428).
  6599******************************************************************
  6600*             AUTOMATIC ACTIVITY RECORD                          *
  6601******************************************************************
  6602     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6603         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6604             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6605             20  CF-SYS-LETTER-ID           PIC X(04).
  6606             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6607             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6608             20  CF-SYS-RESET-SW            PIC X(01).
  6609             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6610             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6611
  6612         16  FILLER                         PIC X(50).
  6613
  6614         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6615             20  CF-USER-ACTIVE-SW          PIC X(01).
  6616             20  CF-USER-LETTER-ID          PIC X(04).
  6617             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6618             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6619             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 121
* EL050.cbl
  6620             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6621             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6622             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6623
  6624         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 122
* EL050.cbl
  6626*    COPY ERCACCT.
  6627******************************************************************
  6628*                                                                *
  6629*                                                                *
  6630*                            ERCACCT                             *
  6631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6632*                            VMOD=2.031                          *
  6633*                                                                *
  6634*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6635*                                                                *
  6636*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6637*   VSAM ACCOUNT MASTER FILES.                                   *
  6638*                                                                *
  6639*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6640*                                                                *
  6641*   FILE TYPE = VSAM,KSDS                                        *
  6642*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6643*                                                                *
  6644*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6645*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6646*                                                                *
  6647*   LOG = NO                                                     *
  6648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6649*                                                                *
  6650*                                                                *
  6651******************************************************************
  6652*                   C H A N G E   L O G
  6653*
  6654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6655*-----------------------------------------------------------------
  6656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6657* EFFECTIVE    NUMBER
  6658*-----------------------------------------------------------------
  6659* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6660* 092705    2005050300006  PEMA  ADD SPP LEASES
  6661* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6662* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6663* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6664* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6665* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6666* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6667******************************************************************
  6668
  6669 01  ACCOUNT-MASTER.
  6670     12  AM-RECORD-ID                      PIC XX.
  6671         88  VALID-AM-ID                      VALUE 'AM'.
  6672
  6673     12  AM-CONTROL-PRIMARY.
  6674         16  AM-COMPANY-CD                 PIC X.
  6675         16  AM-MSTR-CNTRL.
  6676             20  AM-CONTROL-A.
  6677                 24  AM-CARRIER            PIC X.
  6678                 24  AM-GROUPING.
  6679                     28 AM-GROUPING-PREFIX PIC XXX.
  6680                     28 AM-GROUPING-PRIME  PIC XXX.
  6681                 24  AM-STATE              PIC XX.
  6682                 24  AM-ACCOUNT.
  6683                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 123
* EL050.cbl
  6684                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6685             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6686                                           PIC X(19).
  6687             20  AM-CNTRL-B.
  6688                 24  AM-EXPIRATION-DT      PIC XX.
  6689                 24  FILLER                PIC X(4).
  6690             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6691                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6692
  6693     12  AM-CONTROL-BY-VAR-GRP.
  6694         16  AM-COMPANY-CD-A1              PIC X.
  6695         16  AM-VG-CARRIER                 PIC X.
  6696         16  AM-VG-GROUPING                PIC X(6).
  6697         16  AM-VG-STATE                   PIC XX.
  6698         16  AM-VG-ACCOUNT                 PIC X(10).
  6699         16  AM-VG-DATE.
  6700             20  AM-VG-EXPIRATION-DT       PIC XX.
  6701             20  FILLER                    PIC X(4).
  6702         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6703                                           PIC 9(11)      COMP-3.
  6704     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6705         16  FILLER                        PIC X(10).
  6706         16  AM-VG-KEY3.
  6707             20  AM-VG3-ACCOUNT            PIC X(10).
  6708             20  AM-VG3-EXP-DT             PIC XX.
  6709         16  FILLER                        PIC X(4).
  6710     12  AM-MAINT-INFORMATION.
  6711         16  AM-LAST-MAINT-DT              PIC XX.
  6712         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6713         16  AM-LAST-MAINT-USER            PIC X(4).
  6714         16  FILLER                        PIC XX.
  6715
  6716     12  AM-EFFECTIVE-DT                   PIC XX.
  6717     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6718
  6719     12  AM-PREV-DATES  COMP-3.
  6720         16  AM-PREV-EXP-DT                PIC 9(11).
  6721         16  AM-PREV-EFF-DT                PIC 9(11).
  6722
  6723     12  AM-REPORT-CODE-1                  PIC X(10).
  6724     12  AM-REPORT-CODE-2                  PIC X(10).
  6725
  6726     12  AM-CITY-CODE                      PIC X(4).
  6727     12  AM-COUNTY-PARISH                  PIC X(6).
  6728
  6729     12  AM-NAME                           PIC X(30).
  6730     12  AM-PERSON                         PIC X(30).
  6731     12  AM-ADDRS                          PIC X(30).
  6732     12  AM-CITY.
  6733         16  AM-ADDR-CITY                  PIC X(28).
  6734         16  AM-ADDR-STATE                 PIC XX.
  6735     12  AM-ZIP.
  6736         16  AM-ZIP-PRIME.
  6737             20  AM-ZIP-PRI-1ST            PIC X.
  6738                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6739             20  FILLER                    PIC X(4).
  6740         16  AM-ZIP-PLUS4                  PIC X(4).
  6741     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 124
* EL050.cbl
  6742         16  AM-CAN-POSTAL-1               PIC XXX.
  6743         16  AM-CAN-POSTAL-2               PIC XXX.
  6744         16  FILLER                        PIC XXX.
  6745     12  AM-TEL-NO.
  6746         16  AM-AREA-CODE                  PIC 999.
  6747         16  AM-TEL-PRE                    PIC 999.
  6748         16  AM-TEL-NBR                    PIC 9(4).
  6749     12  AM-TEL-LOC                        PIC X.
  6750         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6751         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6752
  6753     12  AM-COMM-STRUCTURE.
  6754         16  AM-DEFN-1.
  6755             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6756                 24  AM-AGT.
  6757                     28  AM-AGT-PREFIX     PIC X(4).
  6758                     28  AM-AGT-PRIME      PIC X(6).
  6759                 24  AM-COM-TYP            PIC X.
  6760                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6761                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6762                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6763                 24  AM-RECALC-LV-INDIC    PIC X.
  6764                 24  AM-RETRO-LV-INDIC     PIC X.
  6765                 24  AM-GL-CODES           PIC X.
  6766                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6767                 24  FILLER                PIC X(01).
  6768         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6769             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6770                 24  FILLER                PIC X(11).
  6771                 24  AM-L-COMA             PIC XXX.
  6772                 24  AM-J-COMA             PIC XXX.
  6773                 24  AM-A-COMA             PIC XXX.
  6774                 24  FILLER                PIC X(6).
  6775
  6776     12  AM-COMM-CHANGE-STATUS             PIC X.
  6777         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6778
  6779     12  AM-CSR-CODE                       PIC X(4).
  6780
  6781     12  AM-BILLING-STATUS                 PIC X.
  6782         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6783         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6784     12  AM-AUTO-REFUND-SW                 PIC X.
  6785         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6786         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6787     12  AM-GPCD                           PIC 99.
  6788     12  AM-IG                             PIC X.
  6789         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6790         88  AM-HAS-GROUP                     VALUE '2'.
  6791     12  AM-STATUS                         PIC X.
  6792         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6793         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6794         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6795         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6796         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6797         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6798         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6799         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 125
* EL050.cbl
  6800         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6801         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6802     12  AM-REMIT-TO                       PIC 99.
  6803     12  AM-ID-NO                          PIC X(11).
  6804
  6805     12  AM-CAL-TABLE                      PIC XX.
  6806     12  AM-LF-DEVIATION                   PIC XXX.
  6807     12  AM-AH-DEVIATION                   PIC XXX.
  6808     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6809     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6810     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6811     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6812     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6813     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6814
  6815     12  AM-USER-FIELDS.
  6816         16  AM-FLD-1                      PIC XX.
  6817         16  AM-FLD-2                      PIC XX.
  6818         16  AM-FLD-3                      PIC XX.
  6819         16  AM-FLD-4                      PIC XX.
  6820         16  AM-FLD-5                      PIC XX.
  6821
  6822     12  AM-1ST-PROD-DATE.
  6823         16  AM-1ST-PROD-YR                PIC XX.
  6824         16  AM-1ST-PROD-MO                PIC XX.
  6825         16  AM-1ST-PROD-DA                PIC XX.
  6826     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6827     12  AM-CERTS-PURGED-DATE.
  6828         16  AM-PUR-YR                     PIC XX.
  6829         16  AM-PUR-MO                     PIC XX.
  6830         16  AM-PUR-DA                     PIC XX.
  6831     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6832     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6833     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6834     12  AM-INACTIVE-DATE.
  6835         16  AM-INA-MO                     PIC 99.
  6836         16  AM-INA-DA                     PIC 99.
  6837         16  AM-INA-YR                     PIC 99.
  6838     12  AM-AR-HI-CERT-DATE                PIC XX.
  6839
  6840     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6841     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6842
  6843     12  AM-OB-PAYMENT-MODE                PIC X.
  6844         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6845         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6846         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6847         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6848
  6849     12  AM-AH-ONLY-INDICATOR              PIC X.
  6850         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6851         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6852
  6853     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6854
  6855     12  AM-OVER-SHORT.
  6856         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6857         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 126
* EL050.cbl
  6858
  6859     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6860     12  AM-DCC-CLP-STATE                  PIC XX.
  6861
  6862     12  AM-RECALC-COMM                    PIC X.
  6863     12  AM-RECALC-REIN                    PIC X.
  6864
  6865     12  AM-REI-TABLE                      PIC XXX.
  6866     12  AM-REI-ET-LF                      PIC X.
  6867     12  AM-REI-ET-AH                      PIC X.
  6868     12  AM-REI-PE-LF                      PIC X.
  6869     12  AM-REI-PE-AH                      PIC X.
  6870     12  AM-REI-PRT-ST                     PIC X.
  6871     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6872     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6873     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6874     12  AM-REI-GROUP-A                    PIC X(6).
  6875     12  AM-REI-MORT                       PIC X(4).
  6876     12  AM-REI-PRT-OW                     PIC X.
  6877     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6878     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6879     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6880     12  AM-REI-GROUP-B                    PIC X(6).
  6881
  6882     12  AM-TRUST-TYPE                     PIC X(2).
  6883
  6884     12  AM-EMPLOYER-STMT-USED             PIC X.
  6885     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6886
  6887     12  AM-STD-AH-TYPE                    PIC XX.
  6888     12  AM-EARN-METHODS.
  6889         16  AM-EARN-METHOD-R              PIC X.
  6890             88 AM-REF-RL-R78                 VALUE 'R'.
  6891             88 AM-REF-RL-PR                  VALUE 'P'.
  6892             88 AM-REF-RL-MEAN                VALUE 'M'.
  6893             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6894         16  AM-EARN-METHOD-L              PIC X.
  6895             88 AM-REF-LL-R78                 VALUE 'R'.
  6896             88 AM-REF-LL-PR                  VALUE 'P'.
  6897             88 AM-REF-LL-MEAN                VALUE 'M'.
  6898             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6899         16  AM-EARN-METHOD-A              PIC X.
  6900             88 AM-REF-AH-R78                 VALUE 'R'.
  6901             88 AM-REF-AH-PR                  VALUE 'P'.
  6902             88 AM-REF-AH-MEAN                VALUE 'M'.
  6903             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6904             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6905             88 AM-REF-AH-NET                 VALUE 'N'.
  6906
  6907     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6908     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6909     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6910
  6911     12  AM-RET-Y-N                        PIC X.
  6912     12  AM-RET-P-E                        PIC X.
  6913     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6914     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6915     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 127
* EL050.cbl
  6916     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6917         16  AM-POOL-PRIME                 PIC XXX.
  6918         16  AM-POOL-SUB                   PIC XXX.
  6919     12  AM-RETRO-EARNINGS.
  6920         16  AM-RET-EARN-R                 PIC X.
  6921         16  AM-RET-EARN-L                 PIC X.
  6922         16  AM-RET-EARN-A                 PIC X.
  6923     12  AM-RET-ST-TAX-USE                 PIC X.
  6924         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6925         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6926     12  AM-RETRO-BEG-EARNINGS.
  6927         16  AM-RET-BEG-EARN-R             PIC X.
  6928         16  AM-RET-BEG-EARN-L             PIC X.
  6929         16  AM-RET-BEG-EARN-A             PIC X.
  6930     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6931     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6932
  6933     12  AM-USER-SELECT-OPTIONS.
  6934         16  AM-USER-SELECT-1              PIC X(10).
  6935         16  AM-USER-SELECT-2              PIC X(10).
  6936         16  AM-USER-SELECT-3              PIC X(10).
  6937         16  AM-USER-SELECT-4              PIC X(10).
  6938         16  AM-USER-SELECT-5              PIC X(10).
  6939
  6940     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6941
  6942     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6943
  6944     12  AM-RPT045A-SWITCH                 PIC X.
  6945         88  RPT045A-OFF                   VALUE 'N'.
  6946
  6947     12  AM-INSURANCE-LIMITS.
  6948         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6949         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6950
  6951     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6952         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6953
  6954     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6955         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6956         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6957
  6958     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6959
  6960     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6961     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6962     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6963     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6964     12  AM-DCC-UEF-STATE                  PIC XX.
  6965     12  FILLER                            PIC XXX.
  6966     12  AM-REPORT-CODE-3                  PIC X(10).
  6967*    12  FILLER                            PIC X(22).
  6968
  6969     12  AM-RESERVE-DATE.
  6970         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6971         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6972         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6973
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 128
* EL050.cbl
  6974     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6975     12  AM-NOTIFICATION-TYPES.
  6976         16  AM-NOTIF-OF-LETTERS           PIC X.
  6977         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6978         16  AM-NOTIF-OF-REPORTS           PIC X.
  6979         16  AM-NOTIF-OF-STATUS            PIC X.
  6980
  6981     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6982         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6983         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6984         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6985         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6986
  6987     12  AM-BENEFIT-CONTROLS.
  6988         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6989             20  AM-BENEFIT-CODE           PIC XX.
  6990             20  AM-BENEFIT-TYPE           PIC X.
  6991             20  AM-BENEFIT-REVISION       PIC XXX.
  6992             20  AM-BENEFIT-REM-TERM       PIC X.
  6993             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6994             20  FILLER                    PIC XX.
  6995         16  FILLER                        PIC X(80).
  6996
  6997     12  AM-TRANSFER-DATA.
  6998         16  AM-TRANSFERRED-FROM.
  6999             20  AM-TRNFROM-CARRIER        PIC X.
  7000             20  AM-TRNFROM-GROUPING.
  7001                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7002                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7003             20  AM-TRNFROM-STATE          PIC XX.
  7004             20  AM-TRNFROM-ACCOUNT.
  7005                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7006                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7007             20  AM-TRNFROM-DTE            PIC XX.
  7008         16  AM-TRANSFERRED-TO.
  7009             20  AM-TRNTO-CARRIER          PIC X.
  7010             20  AM-TRNTO-GROUPING.
  7011                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7012                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7013             20  AM-TRNTO-STATE            PIC XX.
  7014             20  AM-TRNTO-ACCOUNT.
  7015                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7016                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7017             20  AM-TRNTO-DTE              PIC XX.
  7018         16  FILLER                        PIC X(10).
  7019
  7020     12  AM-SAVED-REMIT-TO                 PIC 99.
  7021
  7022     12  AM-COMM-STRUCTURE-SAVED.
  7023         16  AM-DEFN-1-SAVED.
  7024             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7025                 24  AM-AGT-SV             PIC X(10).
  7026                 24  AM-COM-TYP-SV         PIC X.
  7027                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7028                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7029                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7030                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7031                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 129
* EL050.cbl
  7032                 24  AM-GL-CODES-SV        PIC X.
  7033                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7034                 24  FILLER                PIC X.
  7035         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7036             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7037                 24  FILLER                PIC X(11).
  7038                 24  AM-L-COMA-SV          PIC XXX.
  7039                 24  AM-J-COMA-SV          PIC XXX.
  7040                 24  AM-A-COMA-SV          PIC XXX.
  7041                 24  FILLER                PIC X(6).
  7042
  7043     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7044         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7045            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7046            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7047            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7048
  7049     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7050     12  FILLER                            PIC X(120).
  7051
  7052     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7053         16  AM-CONTROL-NAME               PIC X(30).
  7054         16  AM-EXECUTIVE-ONE.
  7055             20  AM-EXEC1-NAME             PIC X(15).
  7056             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7057                                                          COMP-3.
  7058             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7059                                                          COMP-3.
  7060         16  AM-EXECUTIVE-TWO.
  7061             20  AM-EXEC2-NAME             PIC X(15).
  7062             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7063                                                          COMP-3.
  7064             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7065                                                          COMP-3.
  7066
  7067     12  AM-RETRO-ADDITIONAL-DATA.
  7068         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7069         16  AM-RETRO-PREM-P-E             PIC X.
  7070         16  AM-RETRO-CLMS-P-I             PIC X.
  7071         16  AM-RETRO-RET-BRACKET-LF.
  7072             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7073                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7074                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7075             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7076                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7077                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7078             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7079                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7080                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7081         16  AM-RETRO-RET-BRACKET-AH.
  7082             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7083                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7084                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7085                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7086             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7087                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7088                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7089             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 130
* EL050.cbl
  7090                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7091                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7092
  7093     12  AM-COMMENTS.
  7094         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7095
  7096     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7097         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7098         16  AM-FLI-BILLING-CODE           PIC X.
  7099         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7100         16  AM-FLI-UNITED-IDENT           PIC X.
  7101         16  AM-FLI-INTEREST-LOST-DATA.
  7102             20  AM-FLI-BANK-NO            PIC X(5).
  7103             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7104             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7105             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7106         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7107             20  AM-FLI-AGT                PIC X(9).
  7108             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7109             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7110         16  FILLER                        PIC X(102).
  7111
  7112     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7113         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7114             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7115             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7116             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7117             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7118             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7119         16  FILLER                          PIC X(10).
  7120******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 131
* EL050.cbl
  7122*    COPY ERCREIN.
  7123******************************************************************
  7124*                                                                *
  7125*                            ERCREIN                             *
  7126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7127*                            VMOD=2.010                          *
  7128*                                                                *
  7129*   ONLINE CREDIT SYSTEM                                         *
  7130*                                                                *
  7131*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7132*                                                                *
  7133*   FILE TYPE = VSAM,KSDS                                        *
  7134*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7135*                                                                *
  7136*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7137*       ALTERNATE PATH = NONE                                    *
  7138*                                                                *
  7139*   LOG = NO                                                     *
  7140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7141*                                                                *
  7142******************************************************************
  7143*                   C H A N G E   L O G
  7144*
  7145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7146*-----------------------------------------------------------------
  7147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7148* EFFECTIVE    NUMBER
  7149*-----------------------------------------------------------------
  7150* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7151* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7152******************************************************************
  7153 01  REINSURANCE-RECORD.
  7154     12  RE-RECORD-ID                      PIC XX.
  7155         88  VALID-RE-ID                      VALUE 'RE'.
  7156
  7157     12  RE-CONTROL-PRIMARY.
  7158         16  RE-COMPANY-CD                 PIC X.
  7159         16  RE-KEY.
  7160             20  RE-CODE                   PIC X.
  7161                 88  RE-TABLE-RECORD          VALUE 'A'.
  7162                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7163             20  RE-TABLE                  PIC XXX.
  7164             20  FILLER                    PIC XXX.
  7165         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7166             20  FILLER                    PIC X.
  7167             20  RE-COMPANY.
  7168                 24  RE-COMP-PRIME         PIC XXX.
  7169                 24  RE-COMP-SUB           PIC XXX.
  7170
  7171     12  RE-MAINT-INFORMATION.
  7172         16  RE-LAST-MAINT-DT              PIC XX.
  7173         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7174         16  RE-LAST-MAINT-USER            PIC X(4).
  7175         16  FILLER                        PIC X(10).
  7176
  7177     12  RE-TABLE-DATA.
  7178         16  RE-100-COMP                   PIC 99.
  7179
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 132
* EL050.cbl
  7180         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7181             20  RE-REI-COMP-NO.
  7182                 24  RE-REI-COMP           PIC XXX.
  7183                 24  RE-REI-COMP-SUB       PIC XXX.
  7184             20  RE-LF-QC                  PIC X.
  7185             20  RE-AH-QC                  PIC X.
  7186             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7187             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7188             20  RE-LFAGE-LO               PIC 99.
  7189             20  RE-LFAGE-HI               PIC 99.
  7190             20  RE-AHAGE-LO               PIC 99.
  7191             20  RE-AHAGE-HI               PIC 99.
  7192             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7193             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7194             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7195             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7196             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7197             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7198             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7199             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7200             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7201             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7202             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7203             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7204             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7205             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7206             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7207             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7208             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7209             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7210             20  RE-LF-BEN-CODE            PIC X.
  7211             20  RE-AH-BEN-CODE            PIC X.
  7212             20  RE-INTERACTIVE            PIC X.
  7213             20  RE-REMAINING              PIC X.
  7214             20  RE-LF-RUNOFF-SW           PIC X.
  7215             20  RE-AH-RUNOFF-SW           PIC X.
  7216             20  FILLER                    PIC X(19).
  7217
  7218         16  RE-COMP-INFO-END              PIC X(6).
  7219         16  RE-NSP-ST-CD-LF               PIC XX.
  7220         16  RE-NSP-ST-CD-AH               PIC XX.
  7221         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7222             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7223
  7224         16  FILLER                        PIC X(27).
  7225
  7226     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7227         16  RE-NAME                       PIC X(30).
  7228         16  RE-LF-PE                      PIC X.
  7229         16  RE-AH-PE                      PIC X.
  7230         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7231         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7232         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7233         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7234         16  RE-PRT-ST                     PIC X.
  7235         16  RE-PRT-OW                     PIC X.
  7236         16  RE-MORT-CODE                  PIC X(4).
  7237         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 133
* EL050.cbl
  7238         16  RE-ZERO-LF-FEE                PIC X.
  7239         16  RE-ZERO-AH-FEE                PIC X.
  7240         16  RE-CEDE-NAME                  PIC X(30).
  7241         16  RE-LF-COMM                    PIC X.
  7242         16  RE-AH-COMM                    PIC X.
  7243         16  RE-LF-TAX                     PIC X.
  7244         16  RE-AH-TAX                     PIC X.
  7245         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7246         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7247         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7248
  7249         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7250             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7251
  7252         16  RE-LF-CEDING-FEE-BRACKETS.
  7253             20  RE-LF-FEE-METHOD          PIC X.
  7254                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7255                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7256                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7257                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7258             20  RE-LF-FEE-BASIS           PIC X.
  7259                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7260                 88  RE-LF-NET-CEDED               VALUE '2'.
  7261                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7262                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7263                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7264                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7265                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7266                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7267             20  FILLER                    PIC XXX.
  7268             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7269                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7270                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7271
  7272         16  RE-AH-CEDING-FEE-BRACKETS.
  7273             20  RE-AH-FEE-METHOD          PIC X.
  7274                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7275                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7276                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7277                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7278             20  RE-AH-FEE-BASIS           PIC X.
  7279                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7280                 88  RE-AH-NET-CEDED               VALUE '2'.
  7281                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7282                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7283                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7284                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7285                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7286                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7287             20  FILLER                    PIC XXX.
  7288             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7289                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7290                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7291
  7292         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7293
  7294         16  RE-OLD-CEDING-STMT            PIC X.
  7295
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 134
* EL050.cbl
  7296         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7297         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7298         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7299         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7300         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7301         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7302         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7303         16  RE-MORT-SW                    PIC X.
  7304         16  RE-CEDING-TYPE-FLAG           PIC X.
  7305             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7306             88  RE-CEDED                          VALUE 'C'.
  7307             88  RE-ASSUMED                        VALUE 'A'.
  7308             88  RE-PHANTOM                        VALUE 'P'.
  7309
  7310         16  RE-CEDING-STMT-OPT-A          PIC X.
  7311             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7312         16  RE-CEDING-STMT-OPT-B          PIC X.
  7313             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7314         16  RE-CEDING-STMT-OPT-C          PIC X.
  7315             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7316         16  RE-CEDING-STMT-OPT-D          PIC X.
  7317             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7318         16  RE-CEDING-STMT-OPT-E          PIC X.
  7319             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7320
  7321         16  RE-PRT-CRSV                   PIC X.
  7322
  7323         16  RE-GL-CENTER                  PIC X(4).
  7324
  7325         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7326
  7327         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7328
  7329         16  RE-EARN-STOP-CODE             PIC X.
  7330             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7331             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7332
  7333         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7334             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7335
  7336         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7337         16  FILLER                        PIC X(2281).
  7338
  7339         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7340
  7341******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 135
* EL050.cbl
  7343*    COPY ERCCTBL.
  7344******************************************************************
  7345*                                                                *
  7346*                                                                *
  7347*                            ERCCTBL                             *
  7348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7349*                            VMOD=2.003
  7350*                                                                *
  7351*   ONLINE CREDIT SYSTEM                                         *
  7352*                                                                *
  7353*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7354*                                                                *
  7355*   FILE TYPE = VSAM,KSDS                                        *
  7356*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7357*                                                                *
  7358*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7359*       ALTERNATE PATH = NONE                                    *
  7360*                                                                *
  7361*   LOG = NO                                                     *
  7362*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7363*                                                                *
  7364*                                                                *
  7365******************************************************************
  7366
  7367 01  COMM-TABLE-RECORD.
  7368     12  CT-RECORD-ID                      PIC XX.
  7369         88  VALID-CT-ID                      VALUE 'CT'.
  7370
  7371     12  CT-CONTROL-PRIMARY.
  7372         16  CT-COMPANY-CD                 PIC X.
  7373         16  CT-TABLE                      PIC XXX.
  7374         16  CT-CNTRL-2.
  7375             20  CT-BEN-TYPE               PIC X.
  7376             20  CT-BEN-CODE               PIC XX.
  7377
  7378     12  CT-MAINT-INFORMATION.
  7379         16  CT-LAST-MAINT-DT              PIC XX.
  7380         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7381         16  CT-LAST-MAINT-USER            PIC X(4).
  7382         16  FILLER                        PIC X(31).
  7383
  7384     12  CT-LIMITS.
  7385         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7386
  7387         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7388
  7389         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7390
  7391     12  CT-RATES.
  7392         16  CT-RTX          OCCURS 27 TIMES.
  7393             20  CT-RT                     PIC SV9(5)     COMP-3.
  7394             20  CT-RT-R   REDEFINES
  7395                 CT-RT                     PIC XXX.
  7396
  7397     12  FILLER                            PIC  X(42).
  7398
  7399******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 136
* EL050.cbl
  7401*    COPY ERCFORM.
  7402******************************************************************
  7403*                                                                *
  7404*                                                                *
  7405*                            ERCFORM.                            *
  7406*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7407*                            VMOD=2.003                          *
  7408*                                                                *
  7409*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7410*                                                                *
  7411*    FILE TYPE = VSAM,KSDS                                       *
  7412*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7413*                                                                *
  7414*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7415*                                                                *
  7416*    LOG = YES                                                   *
  7417*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7418******************************************************************
  7419 01  FORM-MASTER.
  7420    12  FO-RECORD-ID                 PIC X(02).
  7421        88  VALID-FO-ID                  VALUE 'FO'.
  7422
  7423    12  FO-CONTROL-PRIMARY.
  7424        16  FO-COMPANY-CD            PIC X(01).
  7425        16  FO-STATE                 PIC X(02).
  7426        16  FO-FORM-ID               PIC X(12).
  7427        16  FO-FORM-EXP-DT           PIC X(02).
  7428
  7429    12  FO-POLICY-FORM-DATA.
  7430        16  FO-IND-GRP-CD            PIC X(01).
  7431        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7432        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7433        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7434        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7435        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7436        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7437        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7438        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7439        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7440        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7441        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7442        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7443        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7444        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7445        16  FO-APP-CERT-USE-CD       PIC X(01).
  7446
  7447    12  FILLER                       PIC X(29).
  7448
  7449    12  FO-FORM-PLAN-TABLE.
  7450        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7451            20  FO-PLAN-TYPE         PIC X(01).
  7452            20  FO-PLAN-ID           PIC X(02).
  7453            20  FO-PLAN-TERM         PIC 9(03).
  7454            20  FO-PLAN-REFUND-METHOD
  7455                                     PIC X.
  7456
  7457    12  FILLER                       PIC X(30).
  7458
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 137
* EL050.cbl
  7459    12  FO-COMMENTS-AREA.
  7460        16  FO-COMMENT-LINE-1        PIC X(78).
  7461
  7462    12  FILLER                       PIC X(20).
  7463
  7464    12  FO-MAINT-INFORMATION.
  7465        16  FO-LAST-MAINT-DT         PIC X(02).
  7466        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7467        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 138
* EL050.cbl
  7469*    COPY ELCMSTR.
  7470******************************************************************
  7471*                                                                *
  7472*                            ELCMSTR.                            *
  7473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7474*                            VMOD=2.012                          *
  7475*                                                                *
  7476*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7477*                                                                *
  7478*   FILE TYPE = VSAM,KSDS                                        *
  7479*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7480*                                                                *
  7481*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7482*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7483*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7484*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7485*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7486*                                                 RKP=75,LEN=21  *
  7487*                                                                *
  7488*   **** NOTE ****                                               *
  7489*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7490*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7491*                                                                *
  7492*   LOG = YES                                                    *
  7493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7494******************************************************************
  7495*                   C H A N G E   L O G
  7496*
  7497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7498*-----------------------------------------------------------------
  7499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7500* EFFECTIVE    NUMBER
  7501*-----------------------------------------------------------------
  7502* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7503* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7504* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7505* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7506* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7507* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7508******************************************************************
  7509 01  CLAIM-MASTER.
  7510     12  CL-RECORD-ID                PIC XX.
  7511         88  VALID-CL-ID         VALUE 'CL'.
  7512
  7513     12  CL-CONTROL-PRIMARY.
  7514         16  CL-COMPANY-CD           PIC X.
  7515         16  CL-CARRIER              PIC X.
  7516         16  CL-CLAIM-NO             PIC X(7).
  7517         16  CL-CERT-NO.
  7518             20  CL-CERT-PRIME       PIC X(10).
  7519             20  CL-CERT-SFX         PIC X.
  7520
  7521     12  CL-CONTROL-BY-NAME.
  7522         16  CL-COMPANY-CD-A1        PIC X.
  7523         16  CL-INSURED-LAST-NAME    PIC X(15).
  7524         16  CL-INSURED-NAME.
  7525             20  CL-INSURED-1ST-NAME PIC X(12).
  7526             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 139
* EL050.cbl
  7527
  7528     12  CL-CONTROL-BY-SSN.
  7529         16  CL-COMPANY-CD-A2        PIC X.
  7530         16  CL-SOC-SEC-NO.
  7531             20  CL-SSN-STATE        PIC XX.
  7532             20  CL-SSN-ACCOUNT      PIC X(6).
  7533             20  CL-SSN-LN3          PIC X(3).
  7534
  7535     12  CL-CONTROL-BY-CERT-NO.
  7536         16  CL-COMPANY-CD-A4        PIC X.
  7537         16  CL-CERT-NO-A4.
  7538             20  CL-CERT-A4-PRIME    PIC X(10).
  7539             20  CL-CERT-A4-SFX      PIC X.
  7540
  7541     12  CL-CONTROL-BY-CCN.
  7542         16  CL-COMPANY-CD-A5        PIC X.
  7543         16  CL-CCN-A5.
  7544             20  CL-CCN.
  7545                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7546                 24  CL-CCN-PRIME-A5 PIC X(12).
  7547             20  CL-CCN-FILLER-A5    PIC X(4).
  7548
  7549     12  CL-INSURED-PROFILE-DATA.
  7550         16  CL-INSURED-BIRTH-DT     PIC XX.
  7551         16  CL-INSURED-SEX-CD       PIC X.
  7552             88  INSURED-IS-MALE        VALUE 'M'.
  7553             88  INSURED-IS-FEMALE      VALUE 'F'.
  7554             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7555         16  CL-INSURED-OCC-CD       PIC X(6).
  7556         16  FILLER                  PIC X(5).
  7557
  7558     12  CL-PROCESSING-INFO.
  7559         16  CL-PROCESSOR-ID         PIC X(4).
  7560         16  CL-CLAIM-STATUS         PIC X.
  7561             88  CLAIM-IS-OPEN          VALUE 'O'.
  7562             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7563         16  CL-CLAIM-TYPE           PIC X.
  7564*            88  AH-CLAIM               VALUE 'A'.
  7565*            88  LIFE-CLAIM             VALUE 'L'.
  7566*            88  PROPERTY-CLAIM         VALUE 'P'.
  7567*            88  IUI-CLAIM              VALUE 'I'.
  7568*            88  GAP-CLAIM              VALUE 'G'.
  7569*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7570         16  CL-CLAIM-PREM-TYPE      PIC X.
  7571             88  SINGLE-PREMIUM         VALUE '1'.
  7572             88  O-B-COVERAGE           VALUE '2'.
  7573             88  OPEN-END-COVERAGE      VALUE '3'.
  7574         16  CL-INCURRED-DT          PIC XX.
  7575         16  CL-REPORTED-DT          PIC XX.
  7576         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7577         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7578         16  CL-LAST-PMT-DT          PIC XX.
  7579         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7580         16  CL-PAID-THRU-DT         PIC XX.
  7581         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7582         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7583         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7584         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 140
* EL050.cbl
  7585             88  CL-360-DAY-YR          VALUE '1'.
  7586             88  CL-365-DAY-YR          VALUE '2'.
  7587             88  CL-FULL-MONTHS         VALUE '3'.
  7588         16  CL-CAUSE-CD             PIC X(6).
  7589
  7590         16  CL-PRIME-CERT-NO.
  7591             20  CL-PRIME-CERT-PRIME PIC X(10).
  7592             20  CL-PRIME-CERT-SFX   PIC X.
  7593
  7594         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7595             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7596             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7597
  7598         16  CL-MICROFILM-NO         PIC X(10).
  7599         16  FILLER REDEFINES CL-MICROFILM-NO.
  7600             20  CL-BENEFIT-PERIOD   PIC 99.
  7601             20  FILLER              PIC X(8).
  7602         16  CL-PROG-FORM-TYPE       PIC X.
  7603         16  CL-LAST-ADD-ON-DT       PIC XX.
  7604
  7605         16  CL-LAST-REOPEN-DT       PIC XX.
  7606         16  CL-LAST-CLOSE-DT        PIC XX.
  7607         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7608             88  FINAL-PAID             VALUE '1'.
  7609             88  CLAIM-DENIED           VALUE '2'.
  7610             88  AUTO-CLOSE             VALUE '3'.
  7611             88  MANUAL-CLOSE           VALUE '4'.
  7612             88  BENEFITS-CHANGED       VALUE 'C'.
  7613             88  SETUP-ERRORS           VALUE 'E'.
  7614         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7615         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7616         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7617             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7618         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7619         16  FILLER                  PIC X.
  7620
  7621     12  CL-CERTIFICATE-DATA.
  7622         16  CL-CERT-ORIGIN          PIC X.
  7623             88  CERT-WAS-ONLINE        VALUE '1'.
  7624             88  CERT-WAS-CREATED       VALUE '2'.
  7625             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7626         16  CL-CERT-KEY-DATA.
  7627             20  CL-CERT-CARRIER     PIC X.
  7628             20  CL-CERT-GROUPING    PIC X(6).
  7629             20  CL-CERT-STATE       PIC XX.
  7630             20  CL-CERT-ACCOUNT.
  7631                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7632                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7633             20  CL-CERT-EFF-DT      PIC XX.
  7634
  7635     12  CL-STATUS-CONTROLS.
  7636         16  CL-PRIORITY-CD          PIC X.
  7637             88  CONFIDENTIAL-DATA      VALUE '8'.
  7638             88  HIGHEST-PRIORITY       VALUE '9'.
  7639         16  CL-SUPV-ATTN-CD         PIC X.
  7640             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7641             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7642         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 141
* EL050.cbl
  7643         16  CL-RESTORED-DT          PIC XX.
  7644         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7645         16  CL-NEXT-RESEND-DT       PIC XX.
  7646         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7647         16  CL-CRITICAL-PERIOD      PIC 99.
  7648*        16  FILLER                  PIC XX.
  7649         16  CL-LAST-MAINT-DT        PIC XX.
  7650         16  CL-LAST-MAINT-USER      PIC X(4).
  7651         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7652         16  CL-LAST-MAINT-TYPE      PIC X.
  7653             88  CLAIM-SET-UP           VALUE ' '.
  7654             88  PAYMENT-MADE           VALUE '1'.
  7655             88  LETTER-SENT            VALUE '2'.
  7656             88  MASTER-WAS-ALTERED     VALUE '3'.
  7657             88  MASTER-WAS-RESTORED    VALUE '4'.
  7658             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7659             88  FILE-CONVERTED         VALUE '6'.
  7660             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7661             88  ERROR-CORRECTION       VALUE 'E'.
  7662         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7663         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7664         16  CL-BENEFICIARY          PIC X(10).
  7665         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7666         16  CL-DENIAL-TYPE          PIC X.
  7667             88  CL-TYPE-DENIAL          VALUE '1'.
  7668             88  CL-TYPE-RESCISSION      VALUE '2'.
  7669             88  CL-TYPE-REFORMATION     VALUE '3'.
  7670             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7671             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7672         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7673         16  filler                  pic x(3).
  7674*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7675*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7676*        16  CL-RTW-DT               PIC XX.
  7677
  7678     12  CL-TRAILER-CONTROLS.
  7679         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7680             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7681             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7682             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7683         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7684         16  FILLER                  PIC XX.
  7685         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7686         16  CL-ADDRESS-TRAILER-CNT.
  7687             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7688                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7689             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7690                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7691             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7692                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7693             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7694                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7695             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7696                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7697             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7698                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7699             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7700                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 142
* EL050.cbl
  7701
  7702     12  CL-CV-REFERENCE-NO.
  7703         16  CL-CV-REFNO-PRIME       PIC X(18).
  7704         16  CL-CV-REFNO-SFX         PIC XX.
  7705
  7706     12  CL-FILE-LOCATION            PIC X(4).
  7707
  7708     12  CL-PROCESS-ERRORS.
  7709         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7710             88  NO-FATAL-ERRORS        VALUE ZERO.
  7711         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7712             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7713
  7714     12  CL-PRODUCT-CD               PIC X.
  7715
  7716     12  CL-CURRENT-KEY-DATA.
  7717         16  CL-CURRENT-CARRIER      PIC X.
  7718         16  CL-CURRENT-GROUPING     PIC X(6).
  7719         16  CL-CURRENT-STATE        PIC XX.
  7720         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7721
  7722     12  CL-ASSOCIATES               PIC X.
  7723         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7724         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7725         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7726         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7727
  7728     12  CL-ACTIVITY-CODE            PIC 99.
  7729     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7730     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7731
  7732     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7733     12  CL-LAG-REPORT-CODE          PIC 9.
  7734     12  CL-LOAN-TYPE                PIC XX.
  7735     12  CL-LEGAL-STATE              PIC XX.
  7736
  7737     12  CL-YESNOSW                  PIC X.
  7738     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7739         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7740         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7741         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7742     12  cl-insured-type             pic x.
  7743         88  cl-claim-on-primary         value 'P'.
  7744         88  cl-claim-on-co-borrower     value 'C'.
  7745     12  cl-benefit-expiration-dt    PIC XX.
  7746
  7747 01  PLAN-RECORDS.
  7748     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7749     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7750
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 143
* EL050.cbl
  7752 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7753                          ACCOUNT-MASTER REINSURANCE-RECORD
  7754                          COMM-TABLE-RECORD FORM-MASTER
  7755                          CLAIM-MASTER PLAN-RECORDS.
  7756 0000-DFHEXIT SECTION.
  7757     MOVE '9#                    $   ' TO DFHEIV0.
  7758     MOVE 'EL050' TO DFHEIV1.
  7759     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7760
  7761     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7762
  7763
  7764* EXEC CICS  HANDLE CONDITION
  7765*           ERROR    (9300-ABEND)
  7766*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7767*    END-EXEC.
  7768*    MOVE '"$.J                  ! " #00007759' TO DFHEIV0
  7769     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7771     MOVE X'2220233030303037373539' TO DFHEIV0(25:11)
  7772     CALL 'kxdfhei1' USING DFHEIV0
  7773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7774
  7775
  7776 0000-COPY-PROCEDURE-DIV.
  7777*                          COPY ELC50PD.
  7778******************************************************************
  7779*                                                                *
  7780*                            ELC50PD                             *
  7781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7782*                            VMOD=2.188                          *
  7783*                                                                *
  7784******************************************************************
  7785*                   C H A N G E   L O G
  7786*
  7787* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7788*-----------------------------------------------------------------
  7789*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7790* EFFECTIVE    NUMBER
  7791*-----------------------------------------------------------------
  7792* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7793* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7794* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7795*                             2709 AND 2718
  7796* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7797* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7798* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7799* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7800* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7801*                                IS OPEN OR CNC DT < PD THRU
  7802* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7803* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7804* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7805* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7806* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7807* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7808* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7809* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 144
* EL050.cbl
  7810* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7811* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7812* 020906                   PEMA  EXPAND LOAN OFFICER
  7813* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7814* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7815* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7816* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7817* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7818* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7819* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7820* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7821* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7822* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7823* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7824* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7825* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7826* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7827* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7828* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7829* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7830* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7831* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7832* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7833* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7834* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7835* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7836* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7837* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7838*                                UPDATE VIN ON CERT TRAILER
  7839* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7840* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7841* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7842* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7843* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7844* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7845* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7846* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7847* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7848* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7849* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7850* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7851* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7852* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7853* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7854* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7855* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7856* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7857* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7858* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7859* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7860* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7861* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7862* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7863* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7864* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7865* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7866* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7867* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 145
* EL050.cbl
  7868* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7869* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7870* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7871* 032912  CR2011110200001  PEMA  AHL CHANGES
  7872* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7873* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7874* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7875* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7876* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7877* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7878* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7879* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7880* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7881* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7882* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7883* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7884* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7885* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7886* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7887* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7888* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7889* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7890* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7891* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7892* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7893* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7894* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7895* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7896* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7897* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7898* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7899*                                CERT #, ADD 2898 FORCIBLE ERROR
  7900* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7901* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7902* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7903* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7904* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7905* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7906* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7907* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7908* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7909* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7910* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7911* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7912* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7913* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7914* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7915* 100617  CR2017062000003  PEMA  New comm cap edits
  7916* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7917* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7918* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7919* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7920******************************************************************
  7921************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7922******************************************************************
  7923
  7924     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7925
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 146
* EL050.cbl
  7926     MOVE SPACES                 TO PB-FATAL-FLAG
  7927                                    PB-FORCE-ER-CD
  7928                                    PB-WARN-ER-CD
  7929                                    PB-OUT-BAL-CD.
  7930
  7931     MOVE SPACE                  TO WS-IG-OVRD-AH
  7932                                    WS-IG-OVRD-LF
  7933                                    WS-IG-OVRD-AM
  7934                                    WS-IG-OVRD
  7935                                    WS-IG-OVRD-AH-PL
  7936                                    WS-IG-OVRD-LF-PL
  7937                                    WS-IG-OVRD-AH-BEN
  7938                                    WS-IG-OVRD-LF-BEN.
  7939
  7940******************************************************************
  7941*************       INITIALIZE COMMON ERRORS       ***************
  7942******************************************************************
  7943
  7944     MOVE +0                     TO PB-NO-OF-ERRORS.
  7945     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7946
  7947******************************************************************
  7948
  7949     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7950     SET JULIAN-TO-BIN           TO TRUE.
  7951*    MOVE 5                      TO DC-OPTION-CODE.
  7952     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7953     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7954
  7955     MOVE ZERO                   TO  SUB4.
  7956
  7957 0040-INITIALIZE-GA-BILL-DT.
  7958
  7959     ADD +1                      TO  SUB4.
  7960
  7961     IF  SUB4 GREATER THAN +5
  7962         GO TO 0050-CHECK-CNTL-FOUND.
  7963
  7964     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7965         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7966
  7967     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7968
  7969 0050-CHECK-CNTL-FOUND.
  7970
  7971     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7972        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7973                                         WS-AH-REM-TERM-CALC
  7974                                         EC-CO-REM-TERM-CALC
  7975        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7976        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7977        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7978                                         WS-TOL-AH-CLAIM
  7979        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7980                                         WS-TOL-AH-PREM
  7981                                         EC-CO-TOL-PREM
  7982        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7983                                         WS-TOL-AH-REFUND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 147
* EL050.cbl
  7984                                         EC-CO-TOL-REFUND
  7985        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7986                                         WS-AH-REFUND-OVS-AMT
  7987                                         EC-CO-OVR-SHT-AMT
  7988        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7989                                         WS-TOL-AH-PREM-PCT
  7990                                         EC-CO-TOL-PREM-PCT
  7991        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7992                                         WS-TOL-AH-REFUND-PCT
  7993                                         EC-CO-TOL-REFUND-PCT
  7994        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7995                                         WS-AH-REFUND-OVS-PCT
  7996                                         EC-CO-OVR-SHT-PCT
  7997        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7998        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7999        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8000        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8001        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8002        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8003        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8004        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8005        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8006        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8007        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8008        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8009                                         EC-CO-MONTH-END-DT
  8010        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8011          GO TO 0100-READ-ACCT.
  8012
  8013     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8014     MOVE SPACES                 TO CNTL-ACCESS.
  8015     MOVE '1'                    TO CNTL-REC-TYPE.
  8016     MOVE +0                     TO CNTL-SEQ-NO.
  8017
  8018     MOVE '1' TO RC-SW-1.
  8019     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8020     IF NOT CF-COMPANY-MASTER
  8021         MOVE ZEROS             TO WK-CO-TOL-PREM
  8022                                   WK-CO-TOL-CLAIM
  8023                                   WK-CO-TOL-REFUND
  8024                                   WK-REFUND-OVS-AMT
  8025                                   WK-REFUND-OVS-PCT
  8026                                   WK-CO-TOL-PREM-PCT
  8027                                   WK-CO-TOL-REFUND-PCT
  8028                                   WK-DEFAULT-APR
  8029                                   WK-CO-MAX-CAP
  8030        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8031                                   WK-CR-R78-METHOD
  8032                                   WK-CO-REF-REJECT-SW
  8033                                   WK-CO-PREM-REJECT-SW
  8034                                   WK-REM-TRM-CALC-OPTION
  8035                                   WK-BIRTH-DATE-INPUT
  8036                                   WK-JOINT-AGE-INPUT
  8037        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8038        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8039        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8040        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8041          GO TO 0099-COMPANY-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 148
* EL050.cbl
  8042
  8043     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8044        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8045     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8046        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8047     IF CF-CO-TOL-CAP NOT NUMERIC
  8048        MOVE +0                    TO CF-CO-TOL-CAP.
  8049     IF CF-DEFAULT-APR NOT NUMERIC
  8050        MOVE +0                    TO CF-DEFAULT-APR.
  8051
  8052     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8053     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8054     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8055     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8056     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8057     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8058     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8059     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8060     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8061     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8062     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8063     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8064
  8065     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8066          CF-CO-OVR-SHT-AMT > +0
  8067        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8068
  8069     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8070          CF-CO-OVR-SHT-PCT > +0
  8071        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8072
  8073     IF CF-VALID-REM-TRM-OPTION
  8074         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8075     ELSE
  8076         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8077
  8078     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8079     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8080     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8081     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8082
  8083     GO TO 0050-CHECK-CNTL-FOUND.
  8084
  8085 0099-COMPANY-NOT-FOUND.
  8086
  8087     MOVE ER-2616                TO WS-ERROR.
  8088     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8089
  8090 0100-READ-ACCT.
  8091
  8092     MOVE SPACES                 TO DATE-RANGE-SW.
  8093
  8094     IF WK-ACCT-ADDR = ZEROS
  8095        GO TO 0102-ACCT-GETMAIN.
  8096
  8097     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8098     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8099     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 149
* EL050.cbl
  8100
  8101     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8102        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8103        GO TO 0105-READ-ACCT
  8104     END-IF
  8105
  8106     IF PB-CARRIER NOT = SPACES
  8107        IF PB-CARRIER NOT = AM-VG-CARRIER
  8108           GO TO 0105-READ-ACCT.
  8109
  8110     IF PB-STATE NOT = SPACES
  8111        IF PB-STATE NOT = AM-VG-STATE
  8112           GO TO 0105-READ-ACCT.
  8113
  8114     IF PB-GROUPING NOT = SPACES
  8115        IF PB-GROUPING NOT = AM-VG-GROUPING
  8116           GO TO 0105-READ-ACCT.
  8117
  8118     MOVE 'X'                 TO DATE-RANGE-SW.
  8119
  8120     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8121        MOVE 'X'                 TO DATE-RANGE-SW
  8122        GO TO 0105-READ-ACCT.
  8123
  8124     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8125        GO TO 0105-READ-ACCT.
  8126
  8127     GO TO 0180-ACCOUNT-FOUND.
  8128
  8129 0102-ACCT-GETMAIN.
  8130     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8131     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8132
  8133 0105-READ-ACCT.
  8134     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8135     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8136     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8137     MOVE PB-STATE               TO ACCT-STATE.
  8138     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8139     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8140
  8141     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8142
  8143     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8144
  8145 0110-FIND-ACCT-TOLERANCES-LOOP.
  8146     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8147
  8148     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8149        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8150        GO TO 0199-ACCT-NOT-FOUND
  8151     END-IF
  8152     IF PB-CARRIER NOT = SPACES
  8153        IF PB-CARRIER NOT = AM-VG-CARRIER
  8154           GO TO 0199-ACCT-NOT-FOUND.
  8155
  8156     IF PB-STATE NOT = SPACES
  8157        IF PB-STATE NOT = AM-VG-STATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 150
* EL050.cbl
  8158           GO TO 0199-ACCT-NOT-FOUND.
  8159
  8160     IF PB-GROUPING NOT = SPACES
  8161        IF PB-GROUPING NOT = AM-VG-GROUPING
  8162           GO TO 0199-ACCT-NOT-FOUND.
  8163
  8164     MOVE 'X'                    TO DATE-RANGE-SW.
  8165
  8166     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8167        MOVE 'X'                 TO DATE-RANGE-SW
  8168        GO TO 0199-ACCT-NOT-FOUND.
  8169
  8170     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8171        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8172
  8173 0180-ACCOUNT-FOUND.
  8174     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8175     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8176     MOVE AM-STATE               TO PB-SV-STATE.
  8177     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8178
  8179     IF AM-CANCEL-FEE  NOT NUMERIC
  8180        MOVE ZEROS TO AM-CANCEL-FEE.
  8181
  8182     IF AM-MAX-MON-BEN NOT NUMERIC
  8183        MOVE ZEROS TO AM-MAX-MON-BEN.
  8184
  8185     IF AM-MAX-TOT-BEN NOT NUMERIC
  8186        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8187
  8188     IF AM-CLP-TOL-PCT NOT NUMERIC
  8189        MOVE +0                  TO AM-CLP-TOL-PCT
  8190     END-IF
  8191     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8192        MOVE +0                  TO AM-SPP-LEASE-COMM
  8193     END-IF
  8194     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8195        MOVE ER-2611             TO   WS-ERROR
  8196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8197
  8198     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8199        MOVE ER-2621             TO   WS-ERROR
  8200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8201
  8202     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8203        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8204        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8205        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8206         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8207
  8208     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8209     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8210     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8211     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8212     IF AM-CLP-TOL-PCT NOT = ZEROS
  8213        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8214     END-IF
  8215     IF AM-SPP-LEASE-COMM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 151
* EL050.cbl
  8216        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8217     END-IF
  8218*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8219*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8220*                                   WS-ADMIN-FEES
  8221*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8222*          (SUB5 > +10)
  8223*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8224*             AND (AM-A-COM (SUB5) NUMERIC)
  8225*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8226*                + (AM-A-COM (SUB5) * 1000)
  8227*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8228*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8229*                + (AM-A-COM (SUB5) * 1000)
  8230*             END-IF
  8231*             IF AM-COM-TYP (SUB5) = 'N'
  8232*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8233*                + (AM-A-COM (SUB5) * 1000)
  8234*             END-IF
  8235*          END-IF
  8236*       END-PERFORM
  8237*    END-IF
  8238     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8239        AND (PB-ISSUE)
  8240        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8241                                    ws-cred-union-fees
  8242        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8243           (SUB5 > +10)
  8244           MOVE +0 TO WS-WK-RATE
  8245           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8246                                   'O' OR 'S')
  8247              IF (AM-A-COM (SUB5) NUMERIC)
  8248                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8249                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8250              ELSE
  8251                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8252                 IF PB-ISSUE
  8253                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8254                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8255                 ELSE
  8256                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8257                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8258                 END-IF
  8259                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8260                 MOVE ZEROS             TO WS-SUB1
  8261                                           WS-COMMISSION
  8262                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8263                 MOVE '0530'               TO CTBL-SW
  8264                 MOVE ' '                  TO WS-CTBL-READ-SW
  8265                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8266                 IF FIRST-TIME-THROUGH
  8267                    MOVE 'AA'              TO CTBL-BEN-CODE
  8268                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8269                 END-IF
  8270                 IF CTBL-TABLE-FOUND
  8271                    IF PB-ISSUE
  8272                       COMPUTE WS-COMM-CK-AMT =
  8273                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 152
* EL050.cbl
  8274                    ELSE
  8275                       COMPUTE WS-COMM-CK-AMT =
  8276                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8277                    END-IF
  8278                    PERFORM 8800-GET-COMP-RATE
  8279                              THRU 8800-EXIT
  8280                 END-IF
  8281              END-IF
  8282              if am-com-typ (sub5) = 'O' or 'S'
  8283                 compute ws-cred-union-fees rounded =
  8284                    ws-cred-union-fees +
  8285                    (pb-i-ah-premium-amt * ws-wk-rate)
  8286              else
  8287                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8288                + (WS-WK-RATE * 1000)
  8289              end-if
  8290           END-IF
  8291        END-PERFORM
  8292     END-IF
  8293     IF PB-COMPANY-ID EQUAL 'CRI'
  8294         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8295
  8296     IF PB-COMPANY-ID EQUAL 'NCL'
  8297         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8298     END-IF
  8299
  8300     GO TO 0200-READ-CERT.
  8301
  8302 0199-ACCT-NOT-FOUND.
  8303
  8304     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8305
  8306     IF DATE-RANGE-SW NOT = SPACES
  8307        MOVE ER-2601             TO WS-ERROR
  8308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8309     ELSE
  8310        MOVE ER-2619             TO WS-ERROR
  8311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8312
  8313     GO TO 9990-RETURN.
  8314
  8315 0200-READ-CERT.
  8316
  8317     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8318     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8319     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8320     MOVE PB-SV-STATE            TO CERT-STATE.
  8321     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8322     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8323     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8324
  8325     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8326
  8327     IF CERT-WAS-NOT-FOUND
  8328        GO TO 0299-CERT-NOT-FOUND.
  8329
  8330     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8331        MOVE ER-2759             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 153
* EL050.cbl
  8332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8333        GO TO 0298-UNLOCK-RETURN.
  8334
  8335     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8336         MOVE ER-2758            TO WS-ERROR
  8337         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8338         GO TO 0298-UNLOCK-RETURN.
  8339
  8340     IF PB-ISSUE
  8341        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8342           IF CERT-WAS-CREATED-FOR-CLAIM
  8343              NEXT SENTENCE
  8344            ELSE
  8345              MOVE ER-2626       TO WS-ERROR
  8346              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8347              GO TO 0298-UNLOCK-RETURN.
  8348
  8349     IF NOT PB-CANCELLATION
  8350        GO TO 0300-CONTINUE-EDIT.
  8351
  8352     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8353     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8354     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8355     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8356     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8357     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8358
  8359     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8360     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8361     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8362     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8363     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8364     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8365     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8366     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8367     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8368
  8369     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8370     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8371     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8372     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8373     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8374     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8375     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8376
  8377     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8378     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8379
  8380     MOVE CM-CREDIT-INTERFACE-SW-1
  8381                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8382     MOVE CM-CREDIT-INTERFACE-SW-2
  8383                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8384
  8385     IF CM-O-B-COVERAGE
  8386         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8387
  8388     IF CM-LIVES NOT NUMERIC
  8389         MOVE ZERO                TO CM-LIVES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 154
* EL050.cbl
  8390
  8391     IF CM-BILLED NOT NUMERIC
  8392         MOVE ZERO                TO CM-BILLED.
  8393
  8394     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8395         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8396         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8397         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8398         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8399         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8400         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8401         MOVE CM-LIVES             TO PB-CI-LIVES
  8402*The next line causes a problem with my change  I dont think it is
  8403*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8404
  8405     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8406     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8407     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8408     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8409     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8410     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8411
  8412     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8413     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8414     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8415     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8416
  8417     IF CM-LIFE-COMM-PCT NUMERIC
  8418         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8419     ELSE
  8420         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8421
  8422     IF CM-AH-COMM-PCT NUMERIC
  8423         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8424     ELSE
  8425         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8426
  8427     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8428
  8429     IF CM-LOAN-APR       NOT NUMERIC
  8430           MOVE ZERO               TO CM-LOAN-APR.
  8431
  8432     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8433           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8434
  8435     IF CM-LOAN-TERM      NOT NUMERIC
  8436           MOVE ZERO               TO CM-LOAN-TERM.
  8437
  8438     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8439           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8440
  8441     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8442           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8443
  8444     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8445     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8446     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8447     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 155
* EL050.cbl
  8448     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8449     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8450     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8451     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8452     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8453     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8454     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8455     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8456     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8457
  8458     IF CM-STATE = CM-SSN-STATE
  8459         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8460
  8461     IF CM-STATE NOT = CM-MEMB-STATE
  8462         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8463
  8464     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8465
  8466     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8467*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8468        IF CM-ADDL-CLP NOT NUMERIC
  8469           MOVE +0               TO CM-ADDL-CLP
  8470        END-IF
  8471        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8472        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8473           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8474        END-IF
  8475     END-IF
  8476     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8477        MOVE +0                  TO WS-ADMIN-FEES
  8478                                    WS-CSO-ADMIN-FEE
  8479                                    WS-COMM-AND-MFEE
  8480                                    WS-1ST-YR-ALLOW
  8481        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8482           (SUB5 > +10)
  8483           MOVE +0 TO WS-WK-RATE
  8484           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8485              IF (AM-A-COM (SUB5) NUMERIC)
  8486                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8487                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8488              ELSE
  8489                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8490                 IF PB-ISSUE
  8491                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8492                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8493                 ELSE
  8494                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8495                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8496                 END-IF
  8497                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8498                 MOVE ZEROS             TO WS-SUB1
  8499                                           WS-COMMISSION
  8500                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8501                 MOVE '0530'               TO CTBL-SW
  8502                 MOVE ' '                  TO WS-CTBL-READ-SW
  8503                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8504                 IF FIRST-TIME-THROUGH
  8505                    MOVE 'AA'              TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 156
* EL050.cbl
  8506                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8507                 END-IF
  8508                 IF CTBL-TABLE-FOUND
  8509                    IF PB-ISSUE
  8510                       COMPUTE WS-COMM-CK-AMT =
  8511                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8512                    ELSE
  8513                       COMPUTE WS-COMM-CK-AMT =
  8514                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8515                    END-IF
  8516                    PERFORM 8800-GET-COMP-RATE
  8517                              THRU 8800-EXIT
  8518                 END-IF
  8519              END-IF
  8520              IF AM-COM-TYP (SUB5) = 'I'
  8521                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8522                   + (WS-WK-RATE * 1000)
  8523              END-IF
  8524              IF AM-COM-TYP (SUB5) = 'N'
  8525                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8526                   + (WS-WK-RATE * 1000)
  8527              END-IF
  8528              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8529                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8530                   + (WS-WK-RATE * 1000)
  8531              END-IF
  8532              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8533                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8534                   + (WS-WK-RATE * 1000)
  8535              END-IF
  8536           END-IF
  8537        END-PERFORM
  8538     END-IF
  8539     GO TO 0300-CONTINUE-EDIT.
  8540
  8541 0298-UNLOCK-RETURN.
  8542      PERFORM 9250-UNLOCK-RETURN
  8543      GO TO 9990-RETURN.
  8544
  8545 0299-CERT-NOT-FOUND.
  8546
  8547     MOVE '1'                     TO CERT-STATUS-SW.
  8548
  8549     IF PB-COMPANY-ID = 'UCL'
  8550         IF WS-ERROR = ER-2799
  8551             GO TO 3000-CONTINUE-EDIT.
  8552
  8553     IF NOT PB-CANCELLATION
  8554         GO TO 0300-CONTINUE-EDIT.
  8555
  8556     MOVE ER-2726                  TO  WS-ERROR.
  8557     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8558     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8559     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8560                                    PB-CI-LF-TERM
  8561                                    PB-C-LF-REM-TERM
  8562                                    PB-CI-AH-TERM
  8563                                    PB-C-AH-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 157
* EL050.cbl
  8564                                    PB-CI-LF-BENEFIT-CD
  8565                                    PB-CI-LF-BENEFIT-AMT
  8566                                    PB-CI-LF-ALT-BENEFIT-AMT
  8567                                    PB-CI-LF-PREMIUM-AMT
  8568                                    PB-CI-LF-ALT-PREMIUM-AMT
  8569                                    PB-CI-AH-BENEFIT-CD
  8570                                    PB-CI-AH-BENEFIT-AMT
  8571                                    PB-CI-AH-PREMIUM-AMT
  8572                                    PB-CI-PAY-FREQUENCY
  8573                                    PB-CI-LOAN-APR
  8574                                    PB-CI-LOAN-TERM
  8575                                    PB-CI-LIFE-COMMISSION
  8576                                    PB-CI-AH-COMMISSION
  8577                                    PB-CI-CURR-SEQ
  8578                                    PB-CI-AH-CANCEL-AMT
  8579                                    PB-CI-LF-CANCEL-AMT
  8580                                    PB-CI-RATE-DEV-PCT-LF
  8581                                    PB-CI-RATE-DEV-PCT-AH
  8582                                    PB-CI-EXTENTION-DAYS
  8583                                    PB-CI-TERM-IN-DAYS
  8584                                    PB-CI-LIVES
  8585                                    PB-CI-LF-CRIT-PER
  8586                                    PB-CI-AH-CRIT-PER
  8587                                    PB-CI-ADDL-CLP
  8588                                    PB-CI-DDF-IU-RATE-UP.
  8589
  8590     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8591                                    PB-CI-AH-SETTLEMENT-DT
  8592                                    PB-CI-DEATH-DT
  8593                                    PB-CI-LF-PRIOR-CANCEL-DT
  8594                                    PB-CI-AH-PRIOR-CANCEL-DT
  8595                                    PB-CI-ENTRY-DT
  8596                                    PB-CI-LF-EXPIRE-DT
  8597                                    PB-CI-AH-EXPIRE-DT
  8598                                    PB-CI-LOAN-1ST-PMT-DT.
  8599
  8600     IF ACCOUNT-MAST-FOUND
  8601        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8602        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8603
  8604
  8605 0300-CONTINUE-EDIT.
  8606
  8607     IF PB-ISSUE
  8608        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8609            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8610
  8611     IF PB-ISSUE
  8612        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8613            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8614
  8615     IF PB-ISSUE
  8616       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8617          (AM-NO-AH-ONLY)
  8618           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8619               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8620                   MOVE ER-2679 TO WS-ERROR
  8621                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 158
* EL050.cbl
  8622
  8623     IF PB-ISSUE
  8624        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8625        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8626        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8627     ELSE
  8628        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8629        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8630        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8631
  8632     MOVE 'N'                    TO PLAN-MASTER-SW
  8633                                    PLAN-MASTER-LIFE-SW
  8634                                    FORM-MASTER-SW
  8635                                    WS-APP-CERT-SW.
  8636
  8637     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8638                                    WS-PL-TOL-LF-REFUND
  8639                                    WS-PL-REF-OVS-AMT
  8640                                    WS-PL-TOL-LF-PREM-PCT
  8641                                    WS-PL-TOL-LF-REFUND-PCT
  8642                                    WS-PL-REF-OVS-PCT
  8643                                    WS-PL-TOL-LF-CLAIM.
  8644
  8645     IF PB-COMPANY-ID = 'NCL'
  8646       IF PB-ISSUE
  8647         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8648             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8649             IF FORM-MASTER-FOUND
  8650                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8651
  8652     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8653        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8654
  8655********************** MON CODE **********************
  8656     IF PB-COMPANY-ID = 'MON'
  8657     IF PB-ISSUE
  8658     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8659        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8660             PB-I-LOAN-APR = ZERO)
  8661               MOVE 14.0         TO PB-I-LOAN-APR.
  8662******************************************************
  8663
  8664     IF PB-COMPANY-ID = 'NCL'
  8665       IF PB-ISSUE
  8666           IF FORM-MASTER-FOUND
  8667             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8668                AM-DISMBR-COVERAGE
  8669                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8670                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8671                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8672                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8673                                           PB-I-LIFE-BENEFIT-CD.
  8674
  8675     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8676
  8677     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8678         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8679         SET ELCNTL-FILE-ADDRESSED   TO TRUE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 159
* EL050.cbl
  8680         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8681         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8682         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8683           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8684             GO TO 0301-LIFE-BENEFIT-SEARCH
  8685         ELSE
  8686             NEXT SENTENCE
  8687     ELSE
  8688         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8689
  8690     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8691     MOVE '4'                    TO CNTL-REC-TYPE.
  8692     MOVE +0                     TO CNTL-SEQ-NO.
  8693     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8694
  8695     MOVE '1' TO RC-SW-2.
  8696     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8697
  8698     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8699        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8700         GO TO 0305-BENEFIT-NOT-FOUND.
  8701
  8702     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8703
  8704 0301-LIFE-BENEFIT-SEARCH.
  8705
  8706     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8707
  8708     IF NO-BENEFIT-FOUND
  8709        GO TO 0305-BENEFIT-NOT-FOUND.
  8710
  8711     IF WS-BEN-CD = '99'
  8712        GO TO 0305-BENEFIT-NOT-FOUND.
  8713
  8714     IF PB-COMPANY-ID = 'NCL'
  8715         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8716             GO TO 0304-LIFE-BENEFIT-FOUND.
  8717
  8718     MOVE +1                     TO SUB5.
  8719     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8720
  8721* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8722* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8723     IF PB-COMPANY-ID = 'DMD'
  8724         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8725
  8726 0302-EDIT-ACCT-LF-BENEFITS.
  8727
  8728     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8729        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8730           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8731                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8732           GO TO 03XX-GET-LIFE-ERPLAN.
  8733
  8734     IF SUB5 LESS THAN +20
  8735        ADD +1                   TO SUB5
  8736        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8737
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 160
* EL050.cbl
  8738     MOVE +1                     TO SUB5.
  8739
  8740     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8741        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8742
  8743 0303-EDIT-DMD-EXTRA-BENEFITS.
  8744
  8745     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8746        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8747           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8748                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8749           GO TO 03XX-GET-LIFE-ERPLAN.
  8750
  8751     IF SUB5 LESS THAN +30
  8752        ADD +1                   TO SUB5
  8753        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8754
  8755     MOVE +1                     TO SUB5.
  8756
  8757 03XX-EDIT-FOR-NINETY-LF.
  8758
  8759***************************************************************
  8760*                                                             *
  8761*    NINETY BENEFIT PLAN TYPES:                               *
  8762*                                                             *
  8763*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8764*      92 = ALL GROUP REDUCING BENEFITS                       *
  8765*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8766*      94 = ALL GROUP LEVEL BENEFITS                          *
  8767*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8768*           BENEFIT CONTROLS.                                 *
  8769*      99 = ALL BENEFITS                                      *
  8770*                                                             *
  8771***************************************************************
  8772
  8773     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8774                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8775
  8776     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8777       AND
  8778        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8779        GO TO 03XX-GET-LIFE-ERPLAN.
  8780
  8781     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8782       AND
  8783        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8784        IF CF-REDUCING (SUB3)
  8785           IF (PB-I-INDV-GRP-OVRD = 'I')
  8786              OR
  8787           ((AM-IG = '1') AND
  8788           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8789              OR
  8790           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8791           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8792           (AM-IG NOT = '2'))
  8793              GO TO 03XX-GET-LIFE-ERPLAN.
  8794
  8795     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 161
* EL050.cbl
  8796       AND
  8797        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8798        IF CF-REDUCING (SUB3)
  8799           IF (PB-I-INDV-GRP-OVRD = 'G')
  8800              OR
  8801           ((AM-IG = '2') AND
  8802           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8803              OR
  8804           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8805           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8806           (AM-IG NOT = '1'))
  8807              GO TO 03XX-GET-LIFE-ERPLAN.
  8808
  8809     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8810       AND
  8811        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8812        IF CF-LEVEL    (SUB3)
  8813           IF (PB-I-INDV-GRP-OVRD = 'I')
  8814              OR
  8815           ((AM-IG = '1') AND
  8816           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8817              OR
  8818           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8819           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8820            (AM-IG NOT = '2'))
  8821              GO TO 03XX-GET-LIFE-ERPLAN.
  8822
  8823     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8824       AND
  8825        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8826        IF CF-LEVEL    (SUB3)
  8827           IF (PB-I-INDV-GRP-OVRD = 'G')
  8828              OR
  8829           ((AM-IG = '2') AND
  8830           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8831              OR
  8832           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8833           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8834           (AM-IG NOT = '1'))
  8835              GO TO 03XX-GET-LIFE-ERPLAN.
  8836
  8837     IF SUB5 LESS THAN +20
  8838        ADD +1                   TO SUB5
  8839        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8840
  8841     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8842
  8843     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8844        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8845
  8846     MOVE +1                     TO SUB5.
  8847
  8848 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8849
  8850     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8851                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8852
  8853     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 162
* EL050.cbl
  8854       AND
  8855        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8856        GO TO 03XX-GET-LIFE-ERPLAN.
  8857
  8858     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8859       AND
  8860        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8861        IF CF-REDUCING (SUB3)
  8862           IF (PB-I-INDV-GRP-OVRD = 'I')
  8863              OR
  8864           ((AM-IG = '1') AND
  8865           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8866              OR
  8867           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8868           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8869           (AM-IG NOT = '2'))
  8870              GO TO 03XX-GET-LIFE-ERPLAN.
  8871
  8872     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8873       AND
  8874        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8875        IF CF-REDUCING (SUB3)
  8876           IF (PB-I-INDV-GRP-OVRD = 'G')
  8877              OR
  8878           ((AM-IG = '2') AND
  8879           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8880              OR
  8881           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8882           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8883           (AM-IG NOT = '1'))
  8884              GO TO 03XX-GET-LIFE-ERPLAN.
  8885
  8886     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8887       AND
  8888        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8889        IF CF-LEVEL    (SUB3)
  8890           IF (PB-I-INDV-GRP-OVRD = 'I')
  8891              OR
  8892           ((AM-IG = '1') AND
  8893           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8894              OR
  8895           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8896           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8897            (AM-IG NOT = '2'))
  8898              GO TO 03XX-GET-LIFE-ERPLAN.
  8899
  8900     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8901       AND
  8902        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8903        IF CF-LEVEL    (SUB3)
  8904           IF (PB-I-INDV-GRP-OVRD = 'G')
  8905              OR
  8906           ((AM-IG = '2') AND
  8907           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8908              OR
  8909           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8910           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8911           (AM-IG NOT = '1'))
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 163
* EL050.cbl
  8912              GO TO 03XX-GET-LIFE-ERPLAN.
  8913
  8914     IF SUB5 LESS THAN +30
  8915        ADD +1                   TO SUB5
  8916        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8917
  8918     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8919
  8920 03XX-EDIT-FOR-NINETY-LF-CONT.
  8921
  8922     MOVE +99                    TO SUB5.
  8923
  8924     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8925        IF PB-ISSUE
  8926           MOVE ER-1924          TO  WS-ERROR
  8927           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8928
  8929     GO TO 0304-LIFE-BENEFIT-FOUND.
  8930
  8931 03XX-GET-LIFE-ERPLAN.
  8932
  8933     IF WK-PLAN-ADDR EQUAL +0
  8934        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8935
  8936     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8937     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8938     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8939     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8940     MOVE 'Y'                    TO PLAN-MASTER-SW
  8941                                    PLAN-MASTER-LIFE-SW.
  8942     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8943
  8944 03XX-ERPLAN-LIFE-GETMAIN.
  8945
  8946     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8947     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8948
  8949 03XX-ERPLAN-LIFE-READ.
  8950
  8951     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8952     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8953     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8954     MOVE PB-SV-STATE            TO PLAN-STATE.
  8955     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8956     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8957     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8958     MOVE WS-SAVE-BENEFIT-REVISION
  8959                                 TO PLAN-REVISION-NO.
  8960
  8961     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8962     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8963
  8964     IF PB-COMPANY-ID = 'NCL'
  8965       IF NOT LF-PLAN-MASTER-FOUND
  8966         IF NOT PB-POLICY-IS-DECLINED  AND
  8967            NOT PB-POLICY-IS-VOIDED
  8968             MOVE  ER-1921         TO  WS-ERROR
  8969             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 164
* EL050.cbl
  8970             GO TO 0304-LIFE-BENEFIT-FOUND.
  8971
  8972     IF NOT LF-PLAN-MASTER-FOUND
  8973        GO TO 0304-LIFE-BENEFIT-FOUND.
  8974
  8975 XXXX-CHECK-LF-PLAN-KEY.
  8976
  8977     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8978        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8979        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8980        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8981        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8982        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8983        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8984        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8985        MOVE 'N'                 TO PLAN-MASTER-SW
  8986          GO TO 03XX-ERPLAN-LIFE-READ.
  8987
  8988     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8989
  8990     IF  PB-CANCELLATION
  8991         GO TO  0303-LF-ACCT-BEN-FOUND.
  8992
  8993     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8994        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8995           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8996           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8997              MOVE ER-2644             TO WS-ERROR
  8998              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8999           ELSE
  9000              NEXT SENTENCE
  9001        ELSE
  9002           IF PB-COMPANY-ID NOT = 'NCL'
  9003              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9004                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9005
  9006 0303-LF-ACCT-BEN-FOUND.
  9007
  9008     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9009
  9010     IF PL-DEV-CODE NOT = SPACES
  9011        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9012
  9013     IF PL-DEV-PCT NUMERIC AND
  9014        PL-DEV-PCT NOT = ZEROS
  9015        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9016
  9017     IF PL-TOL-PREM-AMT GREATER THAN +0
  9018        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9019
  9020     IF PL-TOL-REF-AMT GREATER THAN +0
  9021        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9022
  9023     IF PL-TOL-PREM-PCT GREATER THAN +0
  9024        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9025
  9026     IF PL-TOL-REF-PCT GREATER THAN +0
  9027        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 165
* EL050.cbl
  9028
  9029     IF PL-TOL-CLM-AMT GREATER THAN +0
  9030        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9031
  9032     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9033                          PL-OVER-SHORT-AMT > +0
  9034        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9035
  9036     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9037                          PL-OVER-SHORT-PCT > +0
  9038        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9039
  9040     IF PL-SALES-TAX NUMERIC AND
  9041                          PL-SALES-TAX > +0
  9042         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9043
  9044     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9045        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9046                                    WS-IG-OVRD-AM.
  9047
  9048 0304-LIFE-BENEFIT-FOUND.
  9049
  9050     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9051
  9052     IF PB-ISSUE
  9053        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9054     ELSE
  9055        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9056
  9057     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9058     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9059     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9060     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9061     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9062                                         WS-LF-REFUND-CALC.
  9063     if (ws-lf-earnings-calc = '5')
  9064        and (pb-i-loan-apr = zeros)
  9065        and (benefit-code-chg)
  9066        move +99.9999 to pb-i-loan-apr
  9067     end-if
  9068
  9069     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9070        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9071
  9072     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9073        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9074     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9075
  9076     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9077     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9078     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9079     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9080     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9081     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9082
  9083     IF PB-COMPANY-ID = 'NCL'  AND
  9084        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9085         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 166
* EL050.cbl
  9086     ELSE
  9087         IF SUB5 NOT GREATER THAN +20
  9088            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9089               MOVE WS-SAVE-BENEFIT-REM-TERM
  9090                                      TO WS-AM-LF-BENE-REM-TERM
  9091                                         EC-BR-LF-REM-TERM-CALC.
  9092
  9093     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9094     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9095
  9096     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9097
  9098 0305-BENEFIT-NOT-FOUND.
  9099
  9100     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9101     MOVE ER-2604                TO WS-ERROR.
  9102     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9103
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 167
* EL050.cbl
  9105
  9106 0310-FIND-AH-BENEFIT-RECORD.
  9107
  9108     MOVE 'N'                    TO PLAN-MASTER-SW
  9109                                    PLAN-MASTER-AH-SW.
  9110
  9111     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9112                                    WS-PL-TOL-AH-REFUND
  9113                                    WS-AH-PL-REF-OVS-AMT
  9114                                    WS-PL-TOL-AH-PREM-PCT
  9115                                    WS-PL-TOL-AH-REFUND-PCT
  9116                                    WS-AH-PL-REF-OVS-PCT
  9117                                    WS-PL-TOL-AH-CLAIM.
  9118     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9119
  9120
  9121     if pb-issue
  9122        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9123           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9124        end-if
  9125        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9126           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9127           GO TO 0399-BENEFIT-NOT-FOUND
  9128        end-if
  9129     end-if
  9130
  9131     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9132        GO TO 0400-FIND-CARRIER.
  9133
  9134     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9135
  9136     IF WK-AH-BEN-ADDR NOT = ZEROS
  9137         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9138         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9139         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9140         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9141           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9142             GO TO 0311-AH-BENEFIT-SEARCH
  9143         ELSE
  9144             NEXT SENTENCE
  9145     ELSE
  9146         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9147
  9148     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9149     MOVE '5'                    TO CNTL-REC-TYPE.
  9150     MOVE +0                     TO CNTL-SEQ-NO.
  9151     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9152
  9153     MOVE '2' TO RC-SW-2.
  9154     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9155
  9156     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9157        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9158          GO TO 0399-BENEFIT-NOT-FOUND.
  9159
  9160     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9161
  9162 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 168
* EL050.cbl
  9163
  9164     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9165
  9166     IF NO-BENEFIT-FOUND
  9167         GO TO 0399-BENEFIT-NOT-FOUND.
  9168
  9169     IF WS-BEN-CD = '99'
  9170        GO TO 0399-BENEFIT-NOT-FOUND.
  9171
  9172     IF PB-COMPANY-ID  =  'NCL'
  9173         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9174             GO TO 0314-A-H-BENEFIT-FOUND.
  9175
  9176     MOVE +1                     TO SUB5.
  9177     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9178
  9179* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9180* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9181     IF PB-COMPANY-ID = 'DMD'
  9182         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9183
  9184 0312-EDIT-ACCT-AH-BENEFITS.
  9185
  9186     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9187        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9188           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9189                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9190           GO TO 03XX-GET-AH-ERPLAN.
  9191
  9192     IF SUB5 LESS THAN +20
  9193        ADD +1                   TO SUB5
  9194        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9195
  9196     MOVE +1                     TO SUB5.
  9197
  9198     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9199        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9200
  9201 0313-EDIT-DMD-EXTRA-BENEFITS.
  9202
  9203     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9204        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9205           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9206                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9207           GO TO 03XX-GET-AH-ERPLAN.
  9208
  9209     IF SUB5 LESS THAN +30
  9210        ADD +1                   TO SUB5
  9211        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9212
  9213     MOVE +1                     TO SUB5.
  9214
  9215 03XX-EDIT-FOR-NINETY-AH.
  9216
  9217***************************************************************
  9218*                                                             *
  9219*    NINETY BENEFIT PLAN TYPES:                               *
  9220*                                                             *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 169
* EL050.cbl
  9221*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9222*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9223*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9224*           BENEFIT CONTROLS.                                 *
  9225*      99 = ALL BENEFITS.                                     *
  9226*                                                             *
  9227***************************************************************
  9228
  9229     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9230                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9231
  9232     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9233       AND
  9234        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9235        GO TO 03XX-GET-AH-ERPLAN.
  9236
  9237     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9238       AND
  9239        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9240           IF (PB-I-INDV-GRP-OVRD = 'I')
  9241              OR
  9242           ((AM-IG = '1') AND
  9243           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9244              OR
  9245           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9246           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9247           (AM-IG NOT = '2'))
  9248              GO TO 03XX-GET-AH-ERPLAN.
  9249
  9250     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9251       AND
  9252        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9253           IF (PB-I-INDV-GRP-OVRD = 'G')
  9254              OR
  9255           ((AM-IG = '2') AND
  9256           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9257              OR
  9258           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9259           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9260           (AM-IG NOT = '1'))
  9261              GO TO 03XX-GET-AH-ERPLAN.
  9262
  9263     IF SUB5 LESS THAN +20
  9264        ADD +1                   TO SUB5
  9265        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9266
  9267     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9268        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9269
  9270     MOVE +1                    TO SUB5.
  9271
  9272 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9273
  9274     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9275                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9276
  9277     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9278       AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 170
* EL050.cbl
  9279        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9280        GO TO 03XX-GET-AH-ERPLAN.
  9281
  9282     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9283       AND
  9284        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9285           IF (PB-I-INDV-GRP-OVRD = 'I')
  9286              OR
  9287           ((AM-IG = '1') AND
  9288           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9289              OR
  9290           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9291           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9292           (AM-IG NOT = '2'))
  9293              GO TO 03XX-GET-AH-ERPLAN.
  9294
  9295     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9296       AND
  9297        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9298           IF (PB-I-INDV-GRP-OVRD = 'G')
  9299              OR
  9300           ((AM-IG = '2') AND
  9301           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9302              OR
  9303           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9304           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9305           (AM-IG NOT = '1'))
  9306              GO TO 03XX-GET-AH-ERPLAN.
  9307
  9308     IF SUB5 LESS THAN +30
  9309        ADD +1                   TO SUB5
  9310        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9311
  9312 03XX-EDIT-FOR-NINETY-AH-CONT.
  9313
  9314     MOVE +99                    TO SUB5.
  9315
  9316     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9317
  9318     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9319        IF PB-ISSUE
  9320           MOVE ER-1925          TO  WS-ERROR
  9321           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9322
  9323     GO TO 0314-A-H-BENEFIT-FOUND.
  9324
  9325 03XX-GET-AH-ERPLAN.
  9326
  9327     IF WK-PLAN-ADDR EQUAL +0
  9328         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9329
  9330     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9331     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9332     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9333     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9334     MOVE 'Y'                    TO PLAN-MASTER-SW
  9335                                    PLAN-MASTER-AH-SW.
  9336*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 171
* EL050.cbl
  9337     GO TO 03XX-ERPLAN-AH-READ.
  9338
  9339 03XX-ERPLAN-AH-GETMAIN.
  9340
  9341     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9342     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9343
  9344 03XX-ERPLAN-AH-READ.
  9345
  9346     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9347     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9348     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9349     MOVE PB-SV-STATE            TO PLAN-STATE.
  9350     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9351     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9352     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9353     MOVE WS-SAVE-BENEFIT-REVISION
  9354                                 TO PLAN-REVISION-NO.
  9355
  9356     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9357     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9358
  9359     IF PB-COMPANY-ID = 'NCL'
  9360       IF NOT AH-PLAN-MASTER-FOUND
  9361         IF NOT PB-POLICY-IS-DECLINED  AND
  9362            NOT PB-POLICY-IS-VOIDED
  9363             MOVE  ER-1922         TO  WS-ERROR
  9364             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9365             GO TO 0314-A-H-BENEFIT-FOUND.
  9366
  9367     IF NOT AH-PLAN-MASTER-FOUND
  9368        GO TO 0314-A-H-BENEFIT-FOUND.
  9369
  9370 XXXX-CHECK-AH-PLAN-KEY.
  9371
  9372     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9373        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9374        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9375        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9376        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9377        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9378        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9379        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9380        MOVE 'N'                 TO PLAN-MASTER-SW
  9381          GO TO 03XX-ERPLAN-AH-READ.
  9382
  9383     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9384
  9385     IF  PB-CANCELLATION
  9386         GO TO  0313-AH-ACCT-BEN-FOUND.
  9387
  9388     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9389       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9390          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9391          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9392             MOVE ER-2644             TO WS-ERROR
  9393             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9394          ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 172
* EL050.cbl
  9395             NEXT SENTENCE
  9396       ELSE
  9397          IF PB-COMPANY-ID NOT = 'NCL'
  9398             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9399                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9400
  9401 0313-AH-ACCT-BEN-FOUND.
  9402
  9403     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9404
  9405     IF PL-DEV-CODE NOT = SPACES
  9406        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9407
  9408     IF PL-DEV-PCT NUMERIC AND
  9409        PL-DEV-PCT NOT = ZEROS
  9410        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9411
  9412     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9413        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9414
  9415     IF PL-TOL-REF-AMT NOT EQUAL +0
  9416        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9417
  9418     IF PL-TOL-PREM-PCT GREATER THAN +0
  9419        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9420
  9421     IF PL-TOL-REF-PCT GREATER THAN +0
  9422        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9423
  9424     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9425        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9426
  9427     IF PL-OVER-SHORT-AMT NUMERIC AND
  9428                          PL-OVER-SHORT-AMT > +0
  9429        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9430
  9431     IF PL-OVER-SHORT-PCT NUMERIC AND
  9432                          PL-OVER-SHORT-PCT > +0
  9433        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9434
  9435     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9436        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9437        IF WS-IG-OVRD-AM EQUAL SPACES
  9438            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9439
  9440 0314-A-H-BENEFIT-FOUND.
  9441
  9442     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9443
  9444     IF PB-ISSUE
  9445        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9446       ELSE
  9447        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9448
  9449     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9450     if cf-maximum-benefits (sub3) numeric
  9451        move cf-maximum-benefits (sub3)
  9452                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 173
* EL050.cbl
  9453     else
  9454        move zeros               to ws-ah-max-bens
  9455     end-if
  9456     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9457     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9458     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9459                                         WS-AH-REFUND-CALC.
  9460
  9461     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9462        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9463
  9464     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9465        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9466     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9467
  9468     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9469     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9470     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9471     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9472     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9473     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9474
  9475     IF PB-COMPANY-ID = 'NCL'  AND
  9476        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9477         NEXT SENTENCE
  9478     ELSE
  9479         IF SUB5 NOT GREATER THAN +20
  9480            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9481                MOVE WS-SAVE-BENEFIT-REM-TERM
  9482                                      TO WS-AM-AH-BENE-REM-TERM
  9483                                         EC-BR-AH-REM-TERM-CALC.
  9484
  9485     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9486     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9487
  9488     GO TO 0400-FIND-CARRIER.
  9489
  9490 0399-BENEFIT-NOT-FOUND.
  9491
  9492     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9493     MOVE ER-2605                TO WS-ERROR.
  9494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9495
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 174
* EL050.cbl
  9497
  9498 0400-FIND-CARRIER.
  9499
  9500     MOVE PB-SV-CARRIER          TO WS-CARR.
  9501
  9502     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9503     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9504     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9505     MOVE '6'                    TO CNTL-REC-TYPE.
  9506
  9507*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9508     MOVE SPACE                  TO WS-DMD-RATING-SW
  9509                                    EC-BR-DMD-RATING-SW.
  9510
  9511     MOVE '2'                    TO RC-SW-1.
  9512     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9513
  9514     IF NOT CF-CARRIER-MASTER
  9515        GO TO 0400-CARRIER-NOT-FOUND.
  9516
  9517 0400-BUILD-CARR-TOL.
  9518
  9519     IF CF-CR-TOL-PREM NUMERIC AND
  9520        CF-CR-TOL-PREM GREATER THAN +0
  9521        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9522                                    WS-TOL-AH-PREM.
  9523
  9524     IF CF-CR-TOL-REFUND NUMERIC AND
  9525        CF-CR-TOL-REFUND GREATER THAN +0
  9526        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9527                                    WS-TOL-AH-REFUND.
  9528
  9529     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9530        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9531        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9532                                    WS-AH-REFUND-OVS-AMT.
  9533
  9534     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9535        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9536        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9537                                    WS-AH-REFUND-OVS-PCT.
  9538
  9539     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9540        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9541        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9542                                    WS-TOL-AH-PREM-PCT.
  9543
  9544     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9545        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9546        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9547                                     WS-TOL-AH-REFUND-PCT.
  9548
  9549     IF CF-COMPANY-ID EQUAL 'DMD'
  9550         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9551                                    EC-BR-DMD-RATING-SW.
  9552
  9553     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9554     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 175
* EL050.cbl
  9555        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9556     END-IF
  9557     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9558        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9559     END-IF
  9560     IF WS-TOL-CLP-PCT = ZEROS
  9561        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9562     END-IF
  9563
  9564     IF WS-SPP-LEASE-COMM = ZEROS
  9565        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9566     END-IF
  9567     GO TO 0400-FIND-ERPDEF.
  9568
  9569 0400-CARRIER-NOT-FOUND.
  9570
  9571     MOVE ER-2602                TO WS-ERROR.
  9572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9573
  9574 0400-FIND-ERPDEF.
  9575*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9576     IF (PB-COMPANY-ID = 'DCC')
  9577        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9578        CONTINUE
  9579     ELSE
  9580        GO TO 0400-FIND-ERCOMP
  9581     END-IF
  9582     MOVE ' '                    TO PDEF-MASTER-SW
  9583     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9584     MOVE PB-STATE               TO ERPDEF-STATE
  9585     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9586        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9587     END-IF
  9588     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9589     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9590     IF PB-ISSUE
  9591        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9592     ELSE
  9593        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9594     END-IF
  9595     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9596     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9597     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9598     IF PDEF-MASTER-FOUND
  9599        MOVE 'N'                 TO PDEF-MASTER-SW
  9600        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9601        IF PDEF-MASTER-FOUND
  9602           IF (ERPDEF-KEY-SAVE (1:16) =
  9603                        PD-CONTROL-PRIMARY (1:16))
  9604              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9605              CONTINUE
  9606           ELSE
  9607              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9608              IF (ERPDEF-KEY-SAVE (1:16) =
  9609                        PD-CONTROL-PRIMARY (1:16))
  9610                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9611                 CONTINUE
  9612              ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 176
* EL050.cbl
  9613                 MOVE 'N'        TO PDEF-MASTER-SW
  9614              END-IF
  9615           END-IF
  9616        END-IF
  9617        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9618     END-IF
  9619     IF PDEF-MASTER-FOUND
  9620        IF PD-TRUNCATED = 'Y'
  9621           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9622        END-IF
  9623     END-IF
  9624     .
  9625 0400-FIND-ERCOMP.
  9626     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9627        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9628           (WS-SUB1 > +10)
  9629           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9630                 OR 'A' OR 'N'
  9631              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9632              MOVE PB-CARRIER    TO COMP-CARRIER
  9633              MOVE PB-GROUPING   TO COMP-GROUPING
  9634              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9635              MOVE AM-AGT (WS-SUB1)
  9636                                 TO COMP-FIN-RESP
  9637              MOVE 'G'           TO COMP-TYPE
  9638              PERFORM 8582-READ-COMPENSATION-MASTER
  9639                                 THRU 8582-EXIT
  9640              IF COMP-MASTER-FOUND
  9641                 IF CO-GA-INACTIVE
  9642                    MOVE ER-2763 TO WS-ERROR
  9643                    PERFORM 9900-ERROR-FORMAT
  9644                                 THRU 9900-EXIT
  9645                    MOVE +11     TO WS-SUB1
  9646                 END-IF
  9647                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9648                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9649                    MOVE ER-2788 TO WS-ERROR
  9650                    PERFORM 9900-ERROR-FORMAT
  9651                                 THRU 9900-EXIT
  9652                    MOVE +11     TO WS-SUB1
  9653                 END-IF
  9654              END-IF
  9655           END-IF
  9656        END-PERFORM
  9657     END-IF
  9658     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9659        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9660           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9661                                    WS-CLP-STATE
  9662        ELSE
  9663           MOVE SPACES           TO PB-I-CLP-STATE
  9664                                    WS-CLP-STATE
  9665        END-IF
  9666     END-IF
  9667
  9668     IF (PB-COMPANY-ID = 'DCC')
  9669        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9670        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 177
* EL050.cbl
  9671        CONTINUE
  9672     ELSE
  9673        GO TO 0400-FIND-STATE-RECORD
  9674     END-IF
  9675     MOVE SPACES                 TO WS-CLP-STATE
  9676     MOVE +0                     TO WS-BANK-FEE
  9677                                    WS-BANK-LFEE
  9678                                    WS-BANK-NOCHRGB
  9679
  9680     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9681     IF (PB-ISSUE)
  9682        AND (PB-I-BANK-NUMBER NOT =
  9683            SPACES AND ZEROS AND LOW-VALUES)
  9684        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9685     ELSE
  9686        IF (PB-CANCELLATION)
  9687           AND (PB-CI-BANK-NUMBER NOT =
  9688                SPACES AND ZEROS AND LOW-VALUES)
  9689           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9690        END-IF
  9691     END-IF
  9692     IF COMP-FIN-RESP NOT = LOW-VALUES
  9693        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9694        MOVE PB-CARRIER          TO COMP-CARRIER
  9695        MOVE PB-GROUPING         TO COMP-GROUPING
  9696        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9697        MOVE 'B'                 TO COMP-TYPE
  9698        PERFORM 8582-READ-COMPENSATION-MASTER
  9699                                 THRU 8582-EXIT
  9700        IF COMP-MASTER-FOUND
  9701           IF CO-MAX-BANK-FEE NOT NUMERIC
  9702              MOVE +0            TO CO-MAX-BANK-FEE
  9703           END-IF
  9704           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9705              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9706           END-IF
  9707           IF CO-GA-INACTIVE
  9708              MOVE ER-2763       TO WS-ERROR
  9709              PERFORM 9900-ERROR-FORMAT
  9710                                 THRU 9900-EXIT
  9711           END-IF
  9712           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9713              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9714              MOVE ER-2788 TO WS-ERROR
  9715              PERFORM 9900-ERROR-FORMAT
  9716                                 THRU 9900-EXIT
  9717              MOVE +11     TO WS-SUB1
  9718           END-IF
  9719           IF WS-AH-BEN-CATEGORY = 'G'
  9720              MOVE CO-MAX-BANK-FEE
  9721                                 TO WS-BANK-FEE
  9722                                    PB-I-BANK-FEE
  9723           ELSE
  9724              MOVE CO-MAX-BANK-FEE-LEASE
  9725                                 TO WS-BANK-LFEE
  9726                                    PB-I-BANK-FEE
  9727           END-IF
  9728           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 178
* EL050.cbl
  9729              AND (WS-AH-REFUND-CALC = 'G'))
  9730                        OR
  9731              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9732              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9733              CONTINUE
  9734           ELSE
  9735              MOVE ER-2789 TO WS-ERROR
  9736              PERFORM 9900-ERROR-FORMAT
  9737                                 THRU 9900-EXIT
  9738           END-IF
  9739           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9740                                    PB-I-CLP-STATE
  9741           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9742           MOVE CO-CARRIER       TO BXRF-CARRIER
  9743           MOVE CO-GROUPING      TO BXRF-GROUPING
  9744           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9745           MOVE BXRF-MAX-REC-LENGTH
  9746                                 TO BXRF-REC-LENGTH
  9747           PERFORM 8584-READ-BANK-CROSS-REF
  9748                                 THRU 8584-EXIT
  9749           IF BXRF-MASTER-FOUND
  9750              MOVE ' '           TO BANK-ACCT-SW
  9751              MOVE BK-BANK-POINTER-CNT
  9752                                 TO BK-BANK-POINTER-CNT
  9753              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9754                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9755                 OR (BANK-ACCT-FOUND)
  9756                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9757                    AND (BK-AM-EXP-DT (WS-SUB1)
  9758                                 > PB-CERT-EFF-DT)
  9759                    AND (BK-AM-EFF-DT (WS-SUB1)
  9760                                 NOT > PB-CERT-EFF-DT)
  9761                    SET BANK-ACCT-FOUND TO TRUE
  9762                 END-IF
  9763              END-PERFORM
  9764              IF NOT BANK-ACCT-FOUND
  9765                 MOVE ZEROS      TO WS-BANK-FEE
  9766                                    WS-BANK-LFEE
  9767                 MOVE ER-2869    TO WS-ERROR
  9768                 PERFORM 9900-ERROR-FORMAT
  9769                                 THRU 9900-EXIT
  9770              ELSE
  9771                 PERFORM 5000-PROCESS-REPS
  9772                                 THRU 5000-EXIT
  9773                 IF AGENT-MASTER-FOUND
  9774                    MOVE +0      TO WS-BANK-FEE
  9775                                    WS-BANK-LFEE
  9776*                   MOVE AG-SPP-FEES (1)
  9777*                                TO PB-I-BANK-FEE
  9778*                                   WS-BANK-FEE
  9779                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9780                       (WS-SUB1 > +10)
  9781                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9782                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9783                       END-IF
  9784                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9785                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9786                       END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 179
* EL050.cbl
  9787                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9788                          AG-SPP-FEES (WS-SUB1)
  9789                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9790                          AG-SPP-LFEES (WS-SUB1)
  9791                    END-PERFORM
  9792                    IF WS-AH-BEN-CATEGORY = 'G'
  9793                       MOVE WS-BANK-FEE
  9794                                 TO PB-I-BANK-FEE
  9795                    ELSE
  9796                       MOVE WS-BANK-LFEE
  9797                                 TO PB-I-BANK-FEE
  9798                    END-IF
  9799                 END-IF
  9800              END-IF
  9801           END-IF
  9802        ELSE
  9803           MOVE ER-2879          TO WS-ERROR
  9804           PERFORM 9900-ERROR-FORMAT
  9805                                 THRU 9900-EXIT
  9806        END-IF
  9807     ELSE
  9808        MOVE ER-2879             TO WS-ERROR
  9809        PERFORM 9900-ERROR-FORMAT
  9810                                 THRU 9900-EXIT
  9811     END-IF
  9812     IF WS-AH-BEN-CATEGORY = 'G'
  9813        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9814        + WS-BANK-FEE
  9815     ELSE
  9816        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9817        + WS-BANK-LFEE
  9818     END-IF
  9819     .
  9820 0400-FIND-STATE-RECORD.
  9821
  9822     IF WK-STATE-ADDR NOT = ZEROS
  9823         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9824         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9825         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9826         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9827         IF PB-SV-STATE = CF-STATE-CODE
  9828             GO TO 0405-CONTINUE-EDIT
  9829         ELSE
  9830             NEXT SENTENCE
  9831     ELSE
  9832         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9833
  9834     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9835     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9836     MOVE '3'                    TO CNTL-REC-TYPE.
  9837     MOVE +0                     TO CNTL-SEQ-NO.
  9838
  9839     MOVE '3'                    TO RC-SW-2.
  9840     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9841
  9842     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9843        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9844        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 180
* EL050.cbl
  9845        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9846                                    WS-TOL-AH-CLAIM
  9847                                    WS-MINIMUM-REFUND
  9848                                    WS-TOL-LF-PREM
  9849                                    WS-TOL-AH-PREM
  9850                                    WS-TOL-LF-REFUND
  9851                                    WS-TOL-AH-REFUND
  9852                                    EC-ST-TOL-PREM-PCT
  9853                                    WS-TOL-LF-PREM-PCT
  9854                                    WS-TOL-AH-PREM-PCT
  9855                                    EC-ST-TOL-REFUND-PCT
  9856                                    WS-TOL-LF-REFUND-PCT
  9857                                    WS-TOL-AH-REFUND-PCT
  9858                                    EC-ST-TOL-PREM
  9859                                    EC-ST-TOL-REFUND
  9860                                    EC-ST-FST-PMT-DAYS-MAX
  9861                                    WS-FREE-LOOK-PERIOD
  9862                                    WS-ST-LF-PREM-TAX
  9863                                    WS-ST-AH-PREM-TAX-I
  9864                                    WS-ST-AH-PREM-TAX-G
  9865                                    WS-BANK-FEE
  9866                                    WS-BANK-LFEE
  9867                                    WS-TOL-CLP-PCT
  9868                                    WS-SPP-LEASE-COMM
  9869                                    WS-INT-PERIODS
  9870                                    WS-EXTRA-PMTS
  9871        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9872                                    EC-ST-FST-PMT-DAYS-CHG
  9873                                    WS-LF-REM-TERM-CALC
  9874                                    WS-LF-REFUND-CALC
  9875                                    EC-ST-LF-REM-TERM-CALC
  9876                                    EC-ST-LF-REFUND-CALC
  9877                                    WS-AH-REM-TERM-CALC
  9878                                    WS-AH-REFUND-CALC
  9879                                    WS-LF-BEN-CATEGORY
  9880                                    WS-AH-BEN-CATEGORY
  9881                                    WS-CLP-STATE
  9882                                    WS-ST-REFUND-CLAIM-FLAG
  9883                                    WS-ST-CAUSAL-STATE
  9884                                    ws-st-agent-sig-edit
  9885                                    EC-ST-AH-REM-TERM-CALC
  9886                                    EC-ST-AH-REFUND-CALC
  9887          GO TO 0499-STATE-NOT-FOUND.
  9888
  9889     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9890
  9891 0405-CONTINUE-EDIT.
  9892
  9893     if pb-company-id = 'AHL'
  9894        continue
  9895     else
  9896        IF PB-CERT-PRIME NOT NUMERIC
  9897           MOVE ER-2722          TO WS-ERROR
  9898           PERFORM 9900-ERROR-FORMAT
  9899                                 THRU 9900-EXIT
  9900        end-if
  9901     END-IF
  9902*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 181
* EL050.cbl
  9903*       MOVE +0                  TO SUB3
  9904*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9905*       IF SUB3 > +0
  9906*          MOVE ER-2722          TO WS-ERROR
  9907*          PERFORM 9900-ERROR-FORMAT
  9908*                                THRU 9900-EXIT
  9909*       END-IF
  9910*    END-IF
  9911*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9912*       IF PB-CERT-PRIME NOT NUMERIC
  9913*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9914*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9915*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9916*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9917*
  9918*          MOVE ER-2722          TO WS-ERROR
  9919*          PERFORM 9900-ERROR-FORMAT
  9920*                                THRU 9900-EXIT
  9921*       END-IF
  9922*    END-IF
  9923
  9924     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9925
  9926     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9927        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9928                                    WS-TOL-AH-CLAIM.
  9929
  9930     IF CF-ST-REFUND-MIN NOT NUMERIC
  9931        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9932
  9933     IF CF-ST-REFUND-MIN NOT = ZEROS
  9934        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9935
  9936     IF CF-ST-TOL-PREM  NOT = ZEROS
  9937        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9938                                    WS-TOL-AH-PREM
  9939        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9940
  9941     IF CF-ST-TOL-REFUND NOT = ZEROS
  9942        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9943                                    WS-TOL-AH-REFUND
  9944        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9945
  9946     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9947        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9948        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9949                                    WS-AH-REFUND-OVS-AMT
  9950                                    EC-ST-OVR-SHT-AMT.
  9951
  9952     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9953        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9954        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9955                                    WS-TOL-LF-PREM-PCT
  9956                                    WS-TOL-AH-PREM-PCT.
  9957
  9958     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9959        CF-ST-TOL-REF-PCT GREATER THAN +0
  9960        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 182
* EL050.cbl
  9961                                    WS-TOL-LF-REFUND-PCT
  9962                                    WS-TOL-AH-REFUND-PCT.
  9963
  9964     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9965        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9966        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9967                                    WS-AH-REFUND-OVS-PCT
  9968                                    EC-ST-OVR-SHT-PCT.
  9969
  9970     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9971     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9972
  9973     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9974          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9975
  9976     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9977     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9978     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9979
  9980     IF CF-ST-LF-PREM-TAX NUMERIC
  9981        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9982     END-IF
  9983     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9984        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9985     END-IF
  9986     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9987        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9988     END-IF
  9989
  9990     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9991         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9992     END-IF.
  9993
  9994     IF CF-ST-CAUSAL-STATE > SPACES
  9995         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9996     END-IF.
  9997     if cf-st-extra-interest-periods not numeric
  9998        move zeros               to cf-st-extra-interest-periods
  9999     end-if
 10000     if cf-st-extra-payments not numeric
 10001        move zeros               to cf-st-extra-payments
 10002     end-if
 10003
 10004     move cf-st-extra-interest-periods
 10005                                 to ws-int-periods
 10006     move cf-st-extra-payments   to ws-extra-pmts
 10007     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10008     move cf-st-net-only-state   to ws-net-only-state
 10009     if cf-st-comm-cap-sl not numeric
 10010        move zeros               to cf-st-comm-cap-sl
 10011     end-if
 10012     if cf-st-comm-cap-jl not numeric
 10013        move zeros               to cf-st-comm-cap-jl
 10014     end-if
 10015     if cf-st-comm-cap-sa not numeric
 10016        move zeros               to cf-st-comm-cap-sa
 10017     end-if
 10018     if cf-st-comm-cap-ja not numeric
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 183
* EL050.cbl
 10019        move zeros               to cf-st-comm-cap-ja
 10020     end-if
 10021     if cf-st-ga-comm-cap-sl not numeric
 10022        move zeros               to cf-st-ga-comm-cap-sl
 10023     end-if
 10024     if cf-st-ga-comm-cap-jl not numeric
 10025        move zeros               to cf-st-ga-comm-cap-jl
 10026     end-if
 10027     if cf-st-ga-comm-cap-sa not numeric
 10028        move zeros               to cf-st-ga-comm-cap-sa
 10029     end-if
 10030     if cf-st-ga-comm-cap-ja not numeric
 10031        move zeros               to cf-st-ga-comm-cap-ja
 10032     end-if
 10033
 10034     if cf-st-tot-comm-cap-sl not numeric
 10035        move zeros               to cf-st-tot-comm-cap-sl
 10036     end-if
 10037     if cf-st-tot-comm-cap-jl not numeric
 10038        move zeros               to cf-st-tot-comm-cap-jl
 10039     end-if
 10040     if cf-st-tot-comm-cap-sa not numeric
 10041        move zeros               to cf-st-tot-comm-cap-sa
 10042     end-if
 10043     if cf-st-tot-comm-cap-ja not numeric
 10044        move zeros               to cf-st-tot-comm-cap-ja
 10045     end-if
 10046
 10047     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10048     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10049     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10050     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10051     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10052     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10053     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10054     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10055     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10056     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10057     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10058     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10059     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10060     IF WS-LF-BENEFIT-CD = ZEROS
 10061        GO TO 0410-CHECK-AH.
 10062
 10063     IF CF-ST-RT-CALC NOT = SPACES
 10064        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10065                                    EC-ST-LF-REM-TERM-CALC
 10066     END-IF
 10067
 10068     IF WS-LF-COVERAGE-TYPE = 'R'
 10069        IF WS-LF-EARNINGS-CALC = '5'
 10070           IF CF-ST-RF-LN-CALC > '0'
 10071              MOVE CF-ST-RF-LN-CALC
 10072                                 TO WS-LF-REFUND-CALC
 10073                                    EC-ST-LF-REFUND-CALC
 10074           END-IF
 10075        ELSE
 10076           IF CF-ST-RF-LR-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 184
* EL050.cbl
 10077              MOVE CF-ST-RF-LR-CALC
 10078                                 TO WS-LF-REFUND-CALC
 10079                                    EC-ST-LF-REFUND-CALC
 10080           END-IF
 10081        END-IF
 10082     ELSE
 10083        IF CF-ST-RF-LL-CALC > '0'
 10084           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10085                                    EC-ST-LF-REFUND-CALC
 10086        END-IF
 10087     END-IF
 10088
 10089     IF CF-ST-RT-CALC NOT = SPACES
 10090        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10091                                    EC-ST-LF-REM-TERM-CALC
 10092     END-IF
 10093
 10094     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10095     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10096
 10097     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10098
 10099     IF NO-BENEFIT-FOUND
 10100        GO TO 0410-CHECK-AH.
 10101
 10102     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10103        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10104                                 TO EC-ST-LF-REM-TERM-CALC
 10105                                    WS-LF-REM-TERM-CALC
 10106     END-IF
 10107
 10108     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10109        MOVE CF-ST-REFUND-CALC (SUB3)
 10110                                 TO WS-LF-REFUND-CALC
 10111                                    EC-ST-LF-REFUND-CALC
 10112     END-IF
 10113*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10114     if cf-st-extra-periods (sub3) not numeric
 10115        move zeros               to cf-st-extra-periods (sub3)
 10116     end-if
 10117     if cf-st-extra-periods (sub3) > zeros
 10118        if ws-lf-ben-category = 'P'
 10119           move cf-st-extra-periods (sub3)
 10120                                 to ws-extra-pmts
 10121        else
 10122           if ws-lf-ben-category = 'I'
 10123              move cf-st-extra-periods (sub3)
 10124                                 to ws-int-periods
 10125           end-if
 10126        end-if
 10127     end-if
 10128     .
 10129 0410-CHECK-AH.
 10130
 10131     IF WS-AH-BENEFIT-CD = ZEROS
 10132        GO TO 0500-SET-ACCOUNT.
 10133
 10134     IF CF-ST-RT-CALC NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 185
* EL050.cbl
 10135        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10136                                    EC-ST-AH-REM-TERM-CALC
 10137     END-IF
 10138
 10139     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10140        IF CF-ST-RF-CP-CALC > '0'
 10141           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10142                                    EC-ST-AH-REFUND-CALC
 10143        END-IF
 10144     ELSE
 10145        IF CF-ST-RF-AH-CALC > '0'
 10146           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10147                                    EC-ST-AH-REFUND-CALC
 10148        END-IF
 10149     END-IF
 10150     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10151     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10152
 10153     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10154
 10155     IF NO-BENEFIT-FOUND
 10156        GO TO 0500-SET-ACCOUNT.
 10157
 10158     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10159        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10160                                 TO WS-AH-REM-TERM-CALC
 10161                                    EC-ST-AH-REM-TERM-CALC
 10162     END-IF
 10163
 10164     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10165        MOVE CF-ST-REFUND-CALC (SUB3)
 10166                                 TO WS-AH-REFUND-CALC
 10167                                    EC-ST-AH-REFUND-CALC
 10168     END-IF
 10169
 10170*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10171
 10172     GO TO 0500-SET-ACCOUNT.
 10173
 10174 0499-STATE-NOT-FOUND.
 10175
 10176     MOVE ER-2603                TO WS-ERROR.
 10177     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10178
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 186
* EL050.cbl
 10180
 10181 0500-SET-ACCOUNT.
 10182*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10183     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10184        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10185        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10186        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10187        MOVE '3'                 TO CNTL-REC-TYPE
 10188        MOVE +0                  TO CNTL-SEQ-NO
 10189
 10190        MOVE '3'                 TO RC-SW-2
 10191        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10192
 10193        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10194           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10195           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10196           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10197                                    WS-ST-AH-PREM-TAX-I
 10198                                    WS-ST-AH-PREM-TAX-G
 10199        ELSE
 10200           IF CF-ST-LF-PREM-TAX NUMERIC
 10201              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10202           END-IF
 10203           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10204              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10205           END-IF
 10206           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10207              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10208           END-IF
 10209        END-IF
 10210        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10211     END-IF
 10212*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10213*  FOR DCC ONLY
 10214     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10215
 10216        MOVE ' '                 TO STAT-MASTER-SW
 10217        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10218        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10219        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10220        MOVE PB-STATE            TO ELSTAT-STATE
 10221        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10222           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10223        END-IF
 10224
 10225        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10226        SET BIN-TO-GREG          TO TRUE
 10227        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10228        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10229        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10230
 10231        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10232        IF STAT-MASTER-FOUND
 10233           MOVE 'N'              TO STAT-MASTER-SW
 10234           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10235           IF STAT-MASTER-FOUND
 10236              IF (ELSTAT-KEY-SAVE (1:12) =
 10237                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 187
* EL050.cbl
 10238                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10239                    MOVE 'F'        TO STAT-MASTER-SW
 10240                 ELSE
 10241                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10242                    IF (STAT-MASTER-FOUND)
 10243                       AND (ELSTAT-KEY-SAVE (1:12) =
 10244                           SF-CONTROL-PRIMARY (1:12))
 10245                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10246                       MOVE 'F'     TO STAT-MASTER-SW
 10247                    END-IF
 10248                 END-IF
 10249              END-IF
 10250           END-IF
 10251        END-IF
 10252
 10253        IF STAT-MASTER-SW = 'F'
 10254           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10255              and (sf-st-lf-prem-tax > zeros)
 10256              MOVE SF-ST-LF-PREM-TAX
 10257                                 TO WS-ST-LF-PREM-TAX
 10258           END-IF
 10259           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10260              and (sf-st-ah-prem-tax-i > zeros)
 10261              MOVE SF-ST-AH-PREM-TAX-I
 10262                                 TO WS-ST-AH-PREM-TAX-I
 10263           END-IF
 10264           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10265              and (sf-st-ah-prem-tax-g > zeros)
 10266              MOVE SF-ST-AH-PREM-TAX-G
 10267                                 TO WS-ST-AH-PREM-TAX-G
 10268           END-IF
 10269        END-IF
 10270     END-IF
 10271     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10272        AND (PB-ISSUE)
 10273        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10274        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10275        AND (AM-GPCD = 06)
 10276        MOVE 'Y'                 TO WS-GOOD-HIN
 10277        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10278           MOVE PB-I-VIN         TO WS-WORK-VIN
 10279           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10280              (V1 > 16)
 10281              IF WS-WORK-VIN (V1:1) NUMERIC
 10282                 MOVE WS-WORK-VIN-N (V1)
 10283                                 TO WS-ROW-B-VAL (V1)
 10284              ELSE
 10285                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10286                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10287                    OR (V2 > 26)
 10288                 END-PERFORM
 10289                 IF V2 < 27
 10290                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10291                 ELSE
 10292                    MOVE 'N'     TO WS-GOOD-HIN
 10293                 END-IF
 10294              END-IF
 10295              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 188
* EL050.cbl
 10296                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10297              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10298                 WS-ROW-D-VAL (V1)
 10299           END-PERFORM
 10300           MOVE ZEROS            TO WS-VIN-REMAINDER
 10301           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10302             REMAINDER WS-VIN-REMAINDER
 10303           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10304              CONTINUE
 10305           ELSE
 10306              MOVE 'N'           TO WS-GOOD-HIN
 10307           END-IF
 10308        ELSE
 10309           MOVE 'N'              TO WS-GOOD-HIN
 10310        END-IF
 10311        IF WS-GOOD-HIN NOT = 'Y'
 10312           MOVE ER-3826           TO WS-ERROR
 10313           PERFORM 9900-ERROR-FORMAT
 10314                                 THRU 9900-EXIT
 10315        END-IF
 10316     END-IF
 10317     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10318        AND (PB-ISSUE)
 10319        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10320        AND (AM-GPCD NOT = 06)
 10321        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10322           perform 3400-edit-vin thru 3400-exit
 10323        ELSE
 10324          MOVE ER-3826           TO WS-ERROR
 10325          PERFORM 9900-ERROR-FORMAT
 10326                                 THRU 9900-EXIT
 10327        END-IF
 10328     END-IF
 10329     if (pb-company-id = 'CID')
 10330        and (pb-issue)
 10331        and (pb-i-vin not = spaces and low-values and zeros)
 10332        perform 3400-edit-vin    thru 3400-exit
 10333     end-if
 10334******************************************************************
 10335******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10336******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10337******* METHODS.
 10338******************************************************************
 10339     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10340        IF PB-CANCELLATION
 10341           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10342              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10343                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10344                IF FORM-MASTER-FOUND
 10345                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10346******************************************************************
 10347
 10348     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10349     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10350
 10351     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10352     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10353     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 189
* EL050.cbl
 10354     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10355
 10356
 10357     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10358     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10359     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10360
 10361     IF AM-LF-OB-RATE NOT NUMERIC
 10362         MOVE ZERO               TO AM-LF-OB-RATE.
 10363
 10364     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10365         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10366
 10367     IF AM-AH-OB-RATE NOT NUMERIC
 10368         MOVE ZERO               TO AM-AH-OB-RATE.
 10369
 10370     IF WS-LF-JOINT-INDICATOR = 'J'
 10371         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10372     ELSE
 10373         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10374
 10375     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10376
 10377     IF WS-IG-OVRD-AM  EQUAL SPACE
 10378         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10379
 10380     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10381         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10382                                       WS-IG-OVRD
 10383     ELSE
 10384         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10385             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10386                                       WS-IG-OVRD
 10387         ELSE
 10388             MOVE AM-IG             TO WS-IG-OVRD-AH
 10389                                       WS-IG-OVRD.
 10390
 10391     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10392         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10393                                       WS-IG-OVRD
 10394     ELSE
 10395         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10396             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10397                                       WS-IG-OVRD
 10398         ELSE
 10399             MOVE AM-IG             TO WS-IG-OVRD-LF
 10400                                       WS-IG-OVRD.
 10401
 10402     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10403     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10404     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10405     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10406*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10407     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10408                                              TO 'PRLDSFCTIA'.
 10409
 10410     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10411     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 190
* EL050.cbl
 10412     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10413     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10414
 10415     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10416     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10417     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10418     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10419     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10420     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10421     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10422
 10423     IF WS-ACCT-AH-DEV-PCT > +0
 10424        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10425     ELSE
 10426        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10427
 10428     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10429        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10430     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10431        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10432
 10433        IF AM-EARN-METHOD-L = 'S'
 10434            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10435                                        WS-LF-REFUND-CALC.
 10436
 10437        IF AM-EARN-METHOD-R = 'S'
 10438            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10439                                        WS-LF-REFUND-CALC.
 10440
 10441     IF WS-LF-COVERAGE-TYPE = 'R'
 10442         IF AM-EARN-METHOD-R = 'R'
 10443            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10444                                    WS-LF-REFUND-CALC.
 10445     IF WS-LF-COVERAGE-TYPE = 'R'
 10446         IF AM-EARN-METHOD-R = 'P'
 10447            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10448                                    WS-LF-REFUND-CALC.
 10449     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10450         IF AM-EARN-METHOD-L = 'R'
 10451            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10452                                    WS-LF-REFUND-CALC.
 10453     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10454         IF AM-EARN-METHOD-L = 'P'
 10455            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10456                                    WS-LF-REFUND-CALC.
 10457     IF WS-LF-COVERAGE-TYPE = 'R'
 10458         IF AM-EARN-METHOD-R = 'A'
 10459            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10460                                    WS-LF-REFUND-CALC.
 10461     IF WS-LF-COVERAGE-TYPE = 'R'
 10462         IF AM-EARN-METHOD-R = 'M'
 10463            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10464                                    WS-LF-REFUND-CALC.
 10465     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10466         IF AM-EARN-METHOD-L = 'A'
 10467            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10468                                    WS-LF-REFUND-CALC.
 10469     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 191
* EL050.cbl
 10470         IF AM-EARN-METHOD-L = 'M'
 10471            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10472                                    WS-LF-REFUND-CALC.
 10473
 10474     IF AM-EARN-METHOD-A = 'R'
 10475        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10476                                    WS-AH-REFUND-CALC.
 10477     IF AM-EARN-METHOD-A = 'P'
 10478        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10479                                    WS-AH-REFUND-CALC.
 10480     IF AM-EARN-METHOD-A = 'C'
 10481        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10482                                    WS-AH-REFUND-CALC.
 10483     IF AM-EARN-METHOD-A = 'A'
 10484        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10485                                    WS-AH-REFUND-CALC.
 10486     IF AM-EARN-METHOD-A = 'M'
 10487        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10488                                    WS-AH-REFUND-CALC.
 10489     IF AM-EARN-METHOD-A = 'N'
 10490        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10491                                    WS-AH-REFUND-CALC.
 10492     IF AM-EARN-METHOD-A = 'S'
 10493        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10494                                    WS-AH-REFUND-CALC.
 10495
 10496     IF AM-TOL-PREM NOT = ZEROS
 10497        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10498                                    WS-TOL-AH-PREM.
 10499
 10500     IF AM-OVR-SHT-AMT NUMERIC AND
 10501                  AM-OVR-SHT-AMT > 0
 10502        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10503                                    EC-AM-LF-OVR-SHT-AMT
 10504                                    WS-AH-REFUND-OVS-AMT
 10505                                    EC-AM-AH-OVR-SHT-AMT.
 10506
 10507     IF AM-OVR-SHT-PCT NUMERIC AND
 10508                    AM-OVR-SHT-PCT > 0
 10509        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10510                                    EC-AM-LF-OVR-SHT-PCT
 10511                                    WS-AH-REFUND-OVS-PCT
 10512                                    EC-AM-AH-OVR-SHT-PCT.
 10513
 10514     IF AM-TOL-REF-PCT NUMERIC AND
 10515                  AM-TOL-REF-PCT > 0
 10516        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10517                                    WS-TOL-AH-REFUND-PCT.
 10518
 10519     IF AM-TOL-REF  NOT = ZEROS  AND
 10520                  AM-TOL-REF NUMERIC
 10521        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10522                                    EC-AM-LF-TOL-REFUND
 10523                                    WS-TOL-AH-REFUND
 10524                                    EC-AM-AH-TOL-REFUND.
 10525
 10526     IF AM-TOL-CLM  NOT = ZEROS
 10527        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 192
* EL050.cbl
 10528                                    WS-TOL-AH-CLAIM.
 10529
 10530     IF AM-CLP-TOL-PCT NOT NUMERIC
 10531        MOVE +0                  TO AM-CLP-TOL-PCT
 10532     END-IF
 10533
 10534     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10535        MOVE +0                  TO AM-SPP-LEASE-COMM
 10536     END-IF
 10537     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10538        MOVE WS-PL-TOL-LF-PREM-PCT
 10539                                 TO WS-TOL-LF-PREM-PCT.
 10540
 10541     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10542        MOVE WS-PL-TOL-AH-PREM-PCT
 10543                                 TO WS-TOL-AH-PREM-PCT.
 10544
 10545     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10546        MOVE WS-PL-TOL-LF-REFUND-PCT
 10547                                 TO WS-TOL-LF-REFUND-PCT.
 10548
 10549     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10550        MOVE WS-PL-TOL-AH-REFUND-PCT
 10551                                 TO WS-TOL-AH-REFUND-PCT.
 10552
 10553     IF WS-PL-REF-OVS-AMT > +0
 10554        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10555
 10556     IF WS-PL-REF-OVS-PCT > +0
 10557        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10558
 10559     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10560        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10561     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10562        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10563     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10564        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10565     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10566        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10567     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10568        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10569     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10570        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10571
 10572     IF WS-AH-PL-REF-OVS-AMT > +0
 10573        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10574
 10575     IF WS-AH-PL-REF-OVS-PCT > +0
 10576        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10577
 10578     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10579     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10580
 10581     IF PB-CANCELLATION
 10582        GO TO 3000-CONTINUE-EDIT.
 10583
 10584     MOVE +1 TO SUB1.
 10585     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 193
* EL050.cbl
 10586     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10587
 10588     IF CF-COMPANY-ID = 'DMD'
 10589       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10590         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10591        ELSE
 10592         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10593
 10594  0525-FIND-ACCT-COMM.
 10595     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10596        NEXT SENTENCE
 10597      ELSE
 10598         ADD +1 TO SUB1
 10599         IF SUB1 LESS +11
 10600            GO TO 0525-FIND-ACCT-COMM
 10601          ELSE
 10602             GO TO 0550-st-comm-cap-check.
 10603
 10604     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10605     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10606                                    PB-I-LIFE-COMMISSION.
 10607***  IF PB-COMPANY-ID = 'CRI'
 10608     IF PB-PREM-ACCTNG-ONLY
 10609         GO TO 0550-st-comm-cap-check.
 10610
 10611     MOVE '0530' TO CTBL-SW.
 10612     MOVE ' '    TO WS-CTBL-READ-SW.
 10613
 10614
 10615 0530-GET-AH-COMP.
 10616     IF NO-AH-COVERAGE  OR
 10617        NO-AH-BENEFIT-MATCH
 10618           GO TO 0540-NEXT-READ-STEP.
 10619
 10620     IF AM-A-COM (SUB1) NUMERIC
 10621        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10622         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10623         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10624         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10625         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10626     ELSE
 10627          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10628          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10629          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10630          MOVE ZEROS             TO WS-SUB1
 10631                                    WS-COMMISSION
 10632          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10633          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10634          IF WS-COMMISSION > ZEROS
 10635             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10636             GO TO 0540-NEXT-READ-STEP
 10637          END-IF
 10638          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10639          IF CTBL-TABLE-FOUND
 10640             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10641                                        PB-I-AH-TERM
 10642             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10643             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 194
* EL050.cbl
 10644             GO TO 0540-NEXT-READ-STEP
 10645          ELSE
 10646             IF FIRST-TIME-THROUGH
 10647                 GO TO 0530-GET-AH-COMP
 10648             ELSE
 10649                 MOVE ER-2609                TO WS-ERROR
 10650                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10651
 10652 0540-NEXT-READ-STEP.
 10653     MOVE '0540' TO CTBL-SW.
 10654     MOVE ' '    TO WS-CTBL-READ-SW.
 10655
 10656 0540-GET-LF-COMP.
 10657     IF NO-LIFE-COVERAGE  OR
 10658        NO-LF-BENEFIT-MATCH
 10659           GO TO 0550-st-comm-cap-check.
 10660
 10661     IF WS-LF-JOINT-INDICATOR = 'J'
 10662        IF AM-J-COM (SUB1) NUMERIC
 10663           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10664           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10665           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10666           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10667           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10668        ELSE
 10669           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10670           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10671           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10672           MOVE ZEROS                TO WS-SUB1
 10673                                        WS-COMMISSION
 10674           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10675           IF WS-COMMISSION > ZEROS
 10676              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10677              GO TO 0550-st-comm-cap-check
 10678           END-IF
 10679           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10680           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10681           IF CTBL-TABLE-FOUND
 10682              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10683              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10684              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10685              GO TO 0550-st-comm-cap-check
 10686           ELSE
 10687              IF FIRST-TIME-THROUGH
 10688                  GO TO 0540-GET-LF-COMP
 10689              ELSE
 10690                  MOVE ER-2609                TO WS-ERROR
 10691                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10692                  GO TO 0550-st-comm-cap-check.
 10693
 10694     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10695        IF AM-L-COM (SUB1) NUMERIC
 10696           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10697           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10698           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10699           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10700           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10701        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 195
* EL050.cbl
 10702           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10703           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10704           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10705           MOVE ZEROS                TO WS-SUB1
 10706                                        WS-COMMISSION
 10707           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10708           IF WS-COMMISSION IS GREATER THAN ZEROS
 10709              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10710              GO TO 0550-st-comm-cap-check
 10711           END-IF
 10712           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10713           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10714           IF CTBL-TABLE-FOUND
 10715              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10716              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10717              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10718              GO TO 0550-st-comm-cap-check
 10719           ELSE
 10720              IF FIRST-TIME-THROUGH
 10721                  GO TO 0540-GET-LF-COMP
 10722              ELSE
 10723                  MOVE ER-2609                TO WS-ERROR
 10724                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10725
 10726 0550-st-comm-cap-check.
 10727
 10728     move +0                     to ws-tot-sl-wk-rate
 10729                                    ws-sl-wk-rate
 10730                                    ws-ga-sl-wk-rate
 10731                                    ws-tot-jl-wk-rate
 10732                                    ws-jl-wk-rate
 10733                                    ws-ga-jl-wk-rate
 10734                                    ws-tot-sa-wk-rate
 10735                                    ws-sa-wk-rate
 10736                                    ws-ga-sa-wk-rate
 10737                                    ws-tot-ja-wk-rate
 10738                                    ws-ja-wk-rate
 10739                                    ws-ga-ja-wk-rate
 10740     perform varying sub5 from +1 by +1 until
 10741        (sub5 > +10)
 10742        move +0                  to ws-wk-rate
 10743        if (am-gl-codes (sub5) <> 'Y')
 10744           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10745           if pb-i-lf-benefit-cd <> '  ' and '00'
 10746              move zeros         to ws-wk-rate
 10747              if (am-l-com (sub5) numeric)
 10748                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10749                 move am-l-com(sub5)
 10750                                 to ws-wk-rate
 10751              else
 10752                 move pb-company-cd to ctbl-company-cd
 10753                 move pb-i-lf-benefit-cd
 10754                                 to ctbl-ben-code
 10755                 move pb-i-lf-term  to ws-work-term
 10756                 move pb-life-override-l1
 10757                                 to ctbl-ben-type
 10758                 move zeros      to ws-sub1
 10759                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 196
* EL050.cbl
 10760                 move am-l-coma (sub5)
 10761                                 to ctbl-table
 10762                 move '0540'     to ctbl-sw
 10763                 perform 0552-get-it
 10764                                 thru 0552-exit
 10765              end-if
 10766              compute ws-tot-sl-wk-rate =
 10767                 ws-tot-sl-wk-rate + ws-wk-rate
 10768              if am-com-typ(sub5) = 'C' or 'D'
 10769                 compute ws-sl-wk-rate =
 10770                    ws-sl-wk-rate + ws-wk-rate
 10771              else
 10772                 if am-com-typ(sub5) = 'O' or 'P'
 10773                    compute ws-ga-sl-wk-rate =
 10774                       ws-ga-sl-wk-rate + ws-wk-rate
 10775                 end-if
 10776              end-if
 10777
 10778              move zeros         to ws-wk-rate
 10779              if (am-j-com (sub5) numeric)
 10780                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10781                 move am-j-com(sub5)
 10782                                 to ws-wk-rate
 10783              else
 10784                 move pb-company-cd to ctbl-company-cd
 10785                 move pb-i-lf-benefit-cd
 10786                                 to ctbl-ben-code
 10787                 move pb-i-lf-term  to ws-work-term
 10788                 move pb-life-override-l1
 10789                                 to ctbl-ben-type
 10790                 move zeros      to ws-sub1
 10791                                    ws-commission
 10792                 move am-j-coma (sub5)
 10793                                 to ctbl-table
 10794                 move '0540'     to ctbl-sw
 10795                 perform 0552-get-it
 10796                                 thru 0552-exit
 10797              end-if
 10798              compute ws-tot-jl-wk-rate =
 10799                 ws-tot-jl-wk-rate + ws-wk-rate
 10800              if am-com-typ(sub5) = 'C' or 'D'
 10801                 compute ws-jl-wk-rate =
 10802                    ws-jl-wk-rate + ws-wk-rate
 10803              else
 10804                 if am-com-typ(sub5) = 'O' or 'P'
 10805                    compute ws-ga-jl-wk-rate =
 10806                       ws-ga-jl-wk-rate + ws-wk-rate
 10807                 end-if
 10808              end-if
 10809           end-if
 10810           move zeros            to ws-wk-rate
 10811
 10812           if pb-i-ah-benefit-cd <> '  ' and '00'
 10813              if (am-a-com (sub5) numeric)
 10814                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10815                 move am-a-com(sub5)
 10816                                 to ws-wk-rate
 10817              else
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 197
* EL050.cbl
 10818                 move pb-company-cd to ctbl-company-cd
 10819                 move pb-i-ah-benefit-cd
 10820                                 to ctbl-ben-code
 10821                 move pb-i-ah-term  to ws-work-term
 10822                 move pb-ah-override-l1
 10823                                 to ctbl-ben-type
 10824                 move zeros      to ws-sub1
 10825                                    ws-commission
 10826                 move am-a-coma (sub5)
 10827                                 to ctbl-table
 10828                 move '0530'     to ctbl-sw
 10829                 perform 0552-get-it
 10830                                 thru 0552-exit
 10831              end-if
 10832              compute ws-tot-sa-wk-rate =
 10833                 ws-tot-sa-wk-rate + ws-wk-rate
 10834              if am-com-typ(sub5) = 'C' or 'D'
 10835                 compute ws-sa-wk-rate =
 10836                    ws-sa-wk-rate + ws-wk-rate
 10837              else
 10838                 if am-com-typ(sub5) = 'O' or 'P'
 10839                    compute ws-ga-sa-wk-rate =
 10840                       ws-ga-sa-wk-rate + ws-wk-rate
 10841                 end-if
 10842              end-if
 10843           end-if
 10844        end-if
 10845     end-perform
 10846
 10847     go to 0550-continue
 10848
 10849     .
 10850 0552-get-it.
 10851
 10852     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10853     MOVE ZEROS                  TO WS-SUB1
 10854                                    WS-COMMISSION
 10855     MOVE ' '                    TO WS-CTBL-READ-SW
 10856     PERFORM 8300-READ-CTBL-TABLE
 10857                                 THRU 8300-EXIT
 10858     IF FIRST-TIME-THROUGH
 10859        MOVE 'AA'                TO CTBL-BEN-CODE
 10860        PERFORM 8300-READ-CTBL-TABLE
 10861                                 THRU 8300-EXIT
 10862     END-IF
 10863     IF CTBL-TABLE-FOUND
 10864        if pb-life-override-l1 = ctbl-ben-type
 10865           move pb-i-lf-benefit-amt
 10866                                 to WS-COMM-CK-AMT
 10867        else
 10868           compute ws-comm-ck-amt =
 10869              pb-I-ah-benefit-amt * pb-i-ah-term
 10870        end-if
 10871        PERFORM 8800-GET-COMP-RATE
 10872                                 THRU 8800-EXIT
 10873     else
 10874        move zeros               to ws-wk-rate
 10875     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 198
* EL050.cbl
 10876
 10877     .
 10878 0552-exit.
 10879     exit.
 10880
 10881 0550-continue.
 10882
 10883     if ws-lf-joint-indicator = 'J'
 10884        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10885           and (ws-st-comm-cap-jl <> zeros)
 10886           MOVE ER-1956          TO WS-ERROR
 10887           PERFORM 9900-ERROR-FORMAT
 10888                                 THRU 9900-EXIT
 10889        end-if
 10890        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10891           and (ws-st-ga-comm-cap-jl <> zeros)
 10892           MOVE ER-1959          TO WS-ERROR
 10893           PERFORM 9900-ERROR-FORMAT
 10894                                 THRU 9900-EXIT
 10895        end-if
 10896        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10897           and (ws-st-tot-comm-cap-jl <> zeros)
 10898           MOVE ER-1962          TO WS-ERROR
 10899           PERFORM 9900-ERROR-FORMAT
 10900                                 THRU 9900-EXIT
 10901        end-if
 10902     else
 10903        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10904           and (ws-st-comm-cap-sl <> zeros)
 10905           MOVE ER-1955          TO WS-ERROR
 10906           PERFORM 9900-ERROR-FORMAT
 10907                                 THRU 9900-EXIT
 10908        end-if
 10909        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10910           and (ws-st-ga-comm-cap-sl <> zeros)
 10911           MOVE ER-1958          TO WS-ERROR
 10912           PERFORM 9900-ERROR-FORMAT
 10913                                 THRU 9900-EXIT
 10914        end-if
 10915        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10916           and (ws-st-tot-comm-cap-sl <> zeros)
 10917           MOVE ER-1961          TO WS-ERROR
 10918           PERFORM 9900-ERROR-FORMAT
 10919                                 THRU 9900-EXIT
 10920        end-if
 10921
 10922     if ws-ah-joint-indicator = 'J'
 10923        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10924           and (ws-st-comm-cap-ja <> zeros)
 10925           MOVE ER-1957          TO WS-ERROR
 10926           PERFORM 9900-ERROR-FORMAT
 10927                                 THRU 9900-EXIT
 10928        end-if
 10929        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10930           and (ws-st-ga-comm-cap-ja <> zeros)
 10931           MOVE ER-1960          TO WS-ERROR
 10932           PERFORM 9900-ERROR-FORMAT
 10933                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 199
* EL050.cbl
 10934        end-if
 10935        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10936           and (ws-st-tot-comm-cap-ja <> zeros)
 10937           MOVE ER-1963          TO WS-ERROR
 10938           PERFORM 9900-ERROR-FORMAT
 10939                                 THRU 9900-EXIT
 10940        end-if
 10941     else
 10942        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10943           and (ws-st-comm-cap-sa <> zeros)
 10944           MOVE ER-1957          TO WS-ERROR
 10945           PERFORM 9900-ERROR-FORMAT
 10946                                 THRU 9900-EXIT
 10947        end-if
 10948        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10949           and (ws-st-ga-comm-cap-sa <> zeros)
 10950           MOVE ER-1960          TO WS-ERROR
 10951           PERFORM 9900-ERROR-FORMAT
 10952                                 THRU 9900-EXIT
 10953        end-if
 10954        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10955           and (ws-st-tot-comm-cap-sa <> zeros)
 10956           MOVE ER-1963          TO WS-ERROR
 10957           PERFORM 9900-ERROR-FORMAT
 10958                                 THRU 9900-EXIT
 10959        end-if
 10960     end-if
 10961     .
 10962 0560-EDIT-CONTINUE.
 10963     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10964                                    WS-AH-PMF-COMM
 10965*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10966*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10967     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10968        (SUB1 > +10)
 10969        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10970           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10971           MOVE '0530'           TO CTBL-SW
 10972           MOVE ' '              TO WS-CTBL-READ-SW
 10973           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10974           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10975           MOVE '0540'           TO CTBL-SW
 10976           MOVE ' '              TO WS-CTBL-READ-SW
 10977           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10978        END-IF
 10979     END-PERFORM
 10980     GO TO 0564-EDIT-CONTINUE
 10981     .
 10982 0561-CHECK-AH.
 10983     IF (NO-AH-COVERAGE)
 10984        OR (NO-AH-BENEFIT-MATCH)
 10985        CONTINUE
 10986     ELSE
 10987        IF (AM-A-COM (SUB1) NUMERIC)
 10988           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10989           IF (AM-COM-TYP (SUB1) = 'A')
 10990              AND (WS-AH-PMF-COMM = ZEROS)
 10991              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 200
* EL050.cbl
 10992           END-IF
 10993           CONTINUE
 10994        ELSE
 10995           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10996           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10997           MOVE PB-AH-OVERRIDE-L1
 10998                                 TO CTBL-BEN-TYPE
 10999           MOVE ZEROS            TO WS-SUB1
 11000                                    WS-COMMISSION
 11001           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11002           PERFORM 8300-READ-CTBL-TABLE
 11003                                 THRU 8300-EXIT
 11004           IF CTBL-TABLE-FOUND
 11005              IF (AM-COM-TYP (SUB1) = 'A')
 11006                 AND (WS-AH-PMF-COMM = ZEROS)
 11007                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11008                                        PB-I-AH-TERM
 11009                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11010                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11011              END-IF
 11012              CONTINUE
 11013           ELSE
 11014              IF FIRST-TIME-THROUGH
 11015                 GO TO 0561-CHECK-AH
 11016              ELSE
 11017                 MOVE ER-2609    TO WS-ERROR
 11018                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11019              END-IF
 11020           END-IF
 11021        END-IF
 11022     END-IF
 11023     .
 11024 0561-EXIT.
 11025     EXIT.
 11026 0563-CHECK-LF.
 11027     IF (NO-LIFE-COVERAGE)
 11028        OR (NO-LF-BENEFIT-MATCH)
 11029        CONTINUE
 11030     ELSE
 11031        IF WS-LF-JOINT-INDICATOR = 'J'
 11032           IF AM-J-COM (SUB1) NUMERIC
 11033              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11034              IF (AM-COM-TYP (SUB1) = 'A')
 11035                 AND (WS-LF-PMF-COMM = ZEROS)
 11036                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11037              END-IF
 11038              CONTINUE
 11039           ELSE
 11040              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11041              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11042              MOVE PB-LIFE-OVERRIDE-L1
 11043                                 TO CTBL-BEN-TYPE
 11044              MOVE ZEROS         TO WS-SUB1
 11045                                    WS-COMMISSION
 11046              MOVE AM-J-COMA (SUB1)
 11047                                 TO CTBL-TABLE
 11048              PERFORM 8300-READ-CTBL-TABLE
 11049                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 201
* EL050.cbl
 11050              IF CTBL-TABLE-FOUND
 11051                 IF (AM-COM-TYP (SUB1) = 'A')
 11052                    AND (WS-LF-PMF-COMM = ZEROS)
 11053                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11054                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11055                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11056                 END-IF
 11057                 CONTINUE
 11058              ELSE
 11059                 IF FIRST-TIME-THROUGH
 11060                    GO TO 0563-CHECK-LF
 11061                 ELSE
 11062                    MOVE ER-2609 TO WS-ERROR
 11063                    PERFORM 9900-ERROR-FORMAT
 11064                                 THRU 9900-EXIT
 11065*                   GO TO 0560-EDIT-CONTINUE
 11066                 END-IF
 11067              END-IF
 11068           END-IF
 11069        ELSE
 11070           IF AM-L-COM (SUB1) NUMERIC
 11071              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11072              IF (AM-COM-TYP (SUB1) = 'A')
 11073                 AND (WS-LF-PMF-COMM = ZEROS)
 11074                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11075              END-IF
 11076              CONTINUE
 11077           ELSE
 11078              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11079              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11080              MOVE PB-LIFE-OVERRIDE-L1
 11081                                 TO CTBL-BEN-TYPE
 11082              MOVE ZEROS         TO WS-SUB1
 11083                                    WS-COMMISSION
 11084              MOVE AM-L-COMA (SUB1)
 11085                                 TO CTBL-TABLE
 11086              PERFORM 8300-READ-CTBL-TABLE
 11087                                 THRU 8300-EXIT
 11088              IF CTBL-TABLE-FOUND
 11089                 CONTINUE
 11090              ELSE
 11091                 IF FIRST-TIME-THROUGH
 11092                    GO TO 0563-CHECK-LF
 11093                 ELSE
 11094                    MOVE ER-2609 TO WS-ERROR
 11095                    PERFORM 9900-ERROR-FORMAT
 11096                                 THRU 9900-EXIT
 11097                 END-IF
 11098              END-IF
 11099           END-IF
 11100        END-IF
 11101     END-IF
 11102     .
 11103 0563-EXIT.
 11104     EXIT.
 11105 0564-EDIT-CONTINUE.
 11106
 11107     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 202
* EL050.cbl
 11108         IF PB-I-NUM-BILLED EQUAL ZEROS
 11109            MOVE ER-8148       TO WS-ERROR
 11110            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11111
 11112*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11113*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11114*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11115*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11116*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11117*         IF NO-CONVERSION-ERROR
 11118*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11119*         ELSE
 11120*             IF PB-COMPANY-ID EQUAL 'HAN'
 11121*                 MOVE ZEROS     TO PB-I-AGE.
 11122     IF PB-I-BIRTHDAY > LOW-VALUES
 11123        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11124        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11125        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11126        PERFORM 8500-DATE-CONVERT
 11127                                 THRU 8500-EXIT
 11128        IF NO-CONVERSION-ERROR
 11129           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11130           IF PB-I-AGE > ZEROS
 11131              IF WS-WORK-AGE NOT = PB-I-AGE
 11132                 MOVE ER-9501    TO WS-ERROR
 11133                 PERFORM 9900-ERROR-FORMAT
 11134                                 THRU 9900-EXIT
 11135              END-IF
 11136           ELSE
 11137              MOVE WS-WORK-AGE   TO PB-I-AGE
 11138           END-IF
 11139        END-IF
 11140     END-IF
 11141     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11142                                   WS-INS-AGE-SET
 11143     IF PB-I-AGE = ZEROS
 11144        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11145           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11146                                   WS-INS-AGE-SET
 11147           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11148
 11149     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11150                                   WS-AH-EDIT-AGE.
 11151
 11152     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11153        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11154        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11155        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11156        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11157        IF NO-CONVERSION-ERROR
 11158           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11159           IF PB-I-JOINT-AGE > 0
 11160              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11161                 MOVE ER-9503    TO WS-ERROR
 11162                 PERFORM 9900-ERROR-FORMAT
 11163                                 THRU 9900-EXIT
 11164              END-IF
 11165           ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 203
* EL050.cbl
 11166              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11167           END-IF
 11168        ELSE
 11169           MOVE ZEROS            TO PB-I-JOINT-AGE
 11170        END-IF
 11171     END-IF
 11172     IF PB-I-JOINT-AGE NOT NUMERIC
 11173        MOVE ZERO               TO PB-I-JOINT-AGE.
 11174
 11175     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11176                                   WS-JNT-AGE-SET
 11177     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11178        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11179           (WS-AH-JOINT-INDICATOR = 'J')
 11180           IF PB-I-JOINT-AGE = ZEROS
 11181               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11182                                          WS-JNT-AGE-SET
 11183               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11184           END-IF
 11185        END-IF
 11186     END-IF
 11187
 11188     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11189     IF WS-LF-JOINT-INDICATOR = 'J'
 11190        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11191        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11192            IF  PB-I-JOINT-AGE = ZERO
 11193                MOVE ER-2686       TO WS-ERROR
 11194                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11195            ELSE
 11196                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11197                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11198                    IF PB-COMPANY-ID NOT = 'LBL'
 11199                        MOVE ER-2685    TO WS-ERROR
 11200                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11201
 11202     IF WS-AH-JOINT-INDICATOR = 'J'
 11203        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11204            IF  PB-I-JOINT-AGE = ZERO
 11205                MOVE ER-2686       TO WS-ERROR
 11206                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11207            ELSE
 11208                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11209                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11210                                           WS-EDIT-AGE
 11211                    IF PB-COMPANY-ID NOT = 'LBL'
 11212                        MOVE ER-2685    TO WS-ERROR
 11213                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11214
 11215******************************************************************
 11216*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11217******************************************************************
 11218
 11219     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11220        (WS-AH-SPECIAL-CALC-CD = 'O')
 11221        NEXT SENTENCE
 11222     ELSE
 11223        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 204
* EL050.cbl
 11224          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11225           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11226            WS-AH-JOINT-INDICATOR = 'J')  AND
 11227           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11228            MOVE ER-2627             TO WS-ERROR
 11229            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11230
 11231     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11232        (WS-AH-SPECIAL-CALC-CD = 'O')
 11233         NEXT SENTENCE
 11234     ELSE
 11235         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11236            WS-AH-JOINT-INDICATOR = 'J'
 11237             IF PB-I-JOINT-INSURED = SPACES
 11238                 IF PB-COMPANY-ID NOT = 'JAL'
 11239                     MOVE ER-2696    TO WS-ERROR
 11240                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11241
 11242     IF PB-COMPANY-ID NOT = 'BOA'
 11243        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11244           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11245           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11246               PB-I-JOINT-INSURED NOT = SPACES)
 11247                MOVE ER-2691         TO WS-ERROR
 11248                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11249
 11250     IF PB-COMPANY-ID = 'BOA'
 11251        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11252           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11253            IF PB-I-JOINT-AGE NOT = ZEROS
 11254                MOVE ER-2691         TO WS-ERROR
 11255                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11256
 11257     IF PB-COMPANY-ID = 'CRI'
 11258        IF PB-I-SIG-SW = 'J'
 11259           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11260              WS-AH-JOINT-INDICATOR NOT = 'J'
 11261              MOVE ER-2675       TO WS-ERROR
 11262              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11263
 11264     IF PB-COMPANY-ID = 'CRI'
 11265        IF PB-I-SIG-SW = 'S'
 11266           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11267              WS-AH-JOINT-INDICATOR = 'J'
 11268              MOVE ER-2676       TO WS-ERROR
 11269              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11270
 11271     IF PB-COMPANY-ID = 'CVL'
 11272         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11273            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11274              MOVE ER-2783           TO WS-ERROR
 11275              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11276     IF (WS-LF-JOINT-INDICATOR = 'J')
 11277        AND (WS-AH-JOINT-INDICATOR = 'J')
 11278        AND (PB-I-LF-TERM > 120)
 11279        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11280        MOVE ER-2783             TO WS-ERROR
 11281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 205
* EL050.cbl
 11282     END-IF
 11283     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11284
 11285     IF PB-I-INDV-GRP-OVRD = 'I'
 11286        MOVE ER-2666             TO WS-ERROR
 11287        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11288        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11289
 11290     IF PB-I-INDV-GRP-OVRD = 'G'
 11291        MOVE ER-2666             TO WS-ERROR
 11292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11293        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11294
 11295     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11296        NEXT SENTENCE
 11297     ELSE
 11298        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11299
 11300     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11301        IF WS-ERROR = ER-2666
 11302           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11303           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11304
 11305     IF PB-COMPANY-ID = 'CID'
 11306        IF PB-STATE = 'UT' OR 'MO'
 11307           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11308                 OR '76' OR '77')
 11309                      OR
 11310               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11311                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11312                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11313                   OR '2K' OR '2L'))
 11314              AND PB-I-INDV-GRP-CD = 'I'
 11315              MOVE ER-2721             TO WS-ERROR
 11316              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11317           END-IF
 11318        END-IF
 11319     END-IF
 11320
 11321     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11322     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11323        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11324     ELSE
 11325        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11326     END-IF
 11327
 11328*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11329*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11330     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11331                                    ACCOUNT-AH-CK-SW.
 11332
 11333     IF PB-REISSUED-CERT       OR
 11334        PB-REIN-ONLY-CERT      OR
 11335        PB-POLICY-IS-DECLINED  OR
 11336        PB-POLICY-IS-VOIDED
 11337*       OR PB-MONTHLY-CERT
 11338         GO TO 3000-CONTINUE-EDIT.
 11339
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 206
* EL050.cbl
 11340     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11341        IF WS-EDIT-AGE           > +65
 11342           MOVE ER-2709          TO WS-ERROR
 11343           PERFORM 9900-ERROR-FORMAT
 11344                                 THRU 9900-EXIT
 11345        ELSE
 11346           IF WS-EDIT-AGE        > +55
 11347              MOVE ER-2718       TO WS-ERROR
 11348              PERFORM 9900-ERROR-FORMAT
 11349                                 THRU 9900-EXIT
 11350           END-IF
 11351        END-IF
 11352     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11353        IF WS-EDIT-AGE           > +65
 11354           MOVE ER-2709          TO WS-ERROR
 11355           PERFORM 9900-ERROR-FORMAT
 11356                                 THRU 9900-EXIT
 11357        END-IF
 11358     END-IF
 11359     .
 11360
 11361 0565-LIFE-PLAN-LIMIT-EDITS.
 11362
 11363     IF NOT LF-PLAN-MASTER-FOUND
 11364        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11365                                    EC-AM-LF-MAX-TOT-BEN
 11366        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11367
 11368     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11369
 11370     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11371         IF PL-LM-AGE (1) = ZEROS
 11372             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11373
 11374     IF NO-LF-BENEFIT-MATCH          OR
 11375        WS-LF-BENEFIT-CD = ZEROS     OR
 11376        WS-LF-SPECIAL-CALC-CD = 'M'
 11377        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11378
 11379     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11380     MOVE +1                     TO SUB2.
 11381
 11382     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11383        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11384           MOVE +5   TO SUB2
 11385           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11386              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11387              (PL-LM-AGE (SUB2) EQUAL +0)
 11388              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11389              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11390
 11391     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11392
 11393     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11394                               + PB-I-LF-ALT-BENEFIT-AMT.
 11395
 11396 0568-CHECK-LIFE-ATT-AGE.
 11397
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 207
* EL050.cbl
 11398     IF PL-ATT-AGE NUMERIC AND
 11399        PL-ATT-AGE > +0
 11400        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11401     END-IF
 11402*    IF PL-ATT-AGE NUMERIC AND
 11403*       PL-ATT-AGE > +0
 11404*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11405*       IF PB-I-BIRTHDAY > LOW-VALUES
 11406*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11407*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11408*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11409*          SET BIN-PLUS-ELAPSED  TO TRUE
 11410*          PERFORM 8500-DATE-CONVERT
 11411*                                THRU 8500-EXIT
 11412*          IF NO-CONVERSION-ERROR
 11413*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11414*             MOVE ER-2669       TO WS-ERROR
 11415*             PERFORM 9900-ERROR-FORMAT
 11416*                                THRU 9900-EXIT
 11417*          END-IF
 11418*       ELSE
 11419*          IF WS-ATT-AGE >= PL-ATT-AGE
 11420*             MOVE ER-2669       TO WS-ERROR
 11421*             PERFORM 9900-ERROR-FORMAT
 11422*                                THRU 9900-EXIT
 11423*          END-IF
 11424*       END-IF
 11425*    END-IF
 11426     .
 11427 0570-CHECK-LIFE-LIMITS.
 11428
 11429     IF PB-COMPANY-ID EQUAL 'CRI'
 11430        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11431           IF SUB2 GREATER THAN +4
 11432              MOVE ER-2637 TO WS-ERROR
 11433              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11434              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11435
 11436     IF PB-COMPANY-ID  =  'NCL'
 11437        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11438            SUB2 GREATER THAN +8
 11439             MOVE 'U'         TO PB-BATCH-ENTRY
 11440             MOVE ER-2637     TO WS-ERROR
 11441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11442             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11443
 11444     IF SUB2 > +8
 11445        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11446           AND (PB-I-SIG-SW = 'Y')
 11447           CONTINUE
 11448        ELSE
 11449           MOVE ER-2637          TO WS-ERROR
 11450           PERFORM 9900-ERROR-FORMAT
 11451                                 THRU 9900-EXIT
 11452        END-IF
 11453        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11454     END-IF
 11455     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 208
* EL050.cbl
 11456     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11457     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11458
 11459     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11460        ADD +1  TO SUB2
 11461        GO TO 0570-CHECK-LIFE-LIMITS.
 11462
 11463     IF PB-COMPANY-ID = 'NCL'
 11464         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11465
 11466     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11467        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11468        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11469           AND (PB-I-SIG-SW = 'Y')
 11470           CONTINUE
 11471        ELSE
 11472           MOVE ER-2637          TO WS-ERROR
 11473           PERFORM 9900-ERROR-FORMAT
 11474                                 THRU 9900-EXIT
 11475        END-IF
 11476     END-IF
 11477     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11478
 11479
 11480 0570-CHECK-NCL-LIFE-LIMITS.
 11481
 11482     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11483        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11484         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11485
 11486     IF APP-CERT-USED
 11487         IF SUB2  LESS THAN  +5
 11488             MOVE +5          TO SUB2
 11489             GO TO 0570-CHECK-LIFE-LIMITS.
 11490
 11491     MOVE ER-2637             TO WS-ERROR.
 11492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11493
 11494     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11495
 11496 0575-CHECK-NCL-SIG-SWITCH.
 11497
 11498     IF NOT APP-CERT-USED
 11499         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11500
 11501     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11502        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11503        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11504        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11505         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11506
 11507     IF SUB2 GREATER THAN +4
 11508         IF PL-LM-AGE (5) = ZEROS  AND
 11509            PL-LM-AGE (6) = ZEROS  AND
 11510            PL-LM-AGE (7) = ZEROS  AND
 11511            PL-LM-AGE (8) = ZEROS
 11512             MOVE  ER-1927        TO WS-ERROR
 11513             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 209
* EL050.cbl
 11514             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11515         ELSE
 11516             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11517                 MOVE  ER-1920    TO WS-ERROR
 11518                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11519
 11520     IF PB-I-SIG-SW  = 'Y'
 11521       IF NOT PB-I-POLICY-ACCEPTED  AND
 11522          NOT PB-I-POLICY-DECLINED
 11523           MOVE 'U'               TO PB-BATCH-ENTRY
 11524           MOVE  ER-1926          TO WS-ERROR
 11525           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11526
 11527
 11528 0580-AH-PLAN-LIMIT-EDITS.
 11529
 11530     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11531        IF PB-I-AH-BENEFIT-AMT > +1250
 11532           MOVE ER-2702          TO WS-ERROR
 11533           PERFORM 9900-ERROR-FORMAT
 11534                                 THRU 9900-EXIT
 11535        END-IF
 11536     END-IF
 11537
 11538     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11539        AND (PB-MONTHLY-CERT)
 11540        IF PB-I-AH-BENEFIT-AMT > +3000
 11541           MOVE ER-2881          TO WS-ERROR
 11542           PERFORM 9900-ERROR-FORMAT
 11543                                 THRU 9900-EXIT
 11544        END-IF
 11545     END-IF
 11546     IF NOT AH-PLAN-MASTER-FOUND
 11547        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11548        GO TO 3000-CONTINUE-EDIT.
 11549
 11550     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11551
 11552     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11553         IF PL-LM-AGE (1) = ZEROS
 11554             GO TO 3000-CONTINUE-EDIT.
 11555
 11556     IF NO-AH-BENEFIT-MATCH          OR
 11557        WS-AH-BENEFIT-CD = ZEROS     OR
 11558        WS-AH-SPECIAL-CALC-CD = 'M'
 11559        GO TO 3000-CONTINUE-EDIT.
 11560
 11561     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11562     MOVE +1                     TO SUB2.
 11563
 11564     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11565        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11566           MOVE +5 TO SUB2
 11567           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11568              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11569              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11570              (PL-LM-AGE (SUB2) EQUAL +0)
 11571              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 210
* EL050.cbl
 11572              GO TO 3000-CONTINUE-EDIT.
 11573
 11574     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11575
 11576 0590-CHECK-AH-ATT-AGE.
 11577
 11578     IF PL-ATT-AGE NUMERIC AND
 11579        PL-ATT-AGE GREATER THAN +0
 11580        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11581     END-IF
 11582*       IF WS-ATT-AGE >= PL-ATT-AGE
 11583*          MOVE ER-3054          TO WS-ERROR
 11584*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11585     .
 11586 0597-CHECK-AH-LIMITS.
 11587
 11588     IF PB-COMPANY-ID EQUAL 'CRI'
 11589        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11590           IF SUB2 GREATER THAN +4
 11591              MOVE ER-2638       TO WS-ERROR
 11592              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11593              GO TO 3000-CONTINUE-EDIT.
 11594
 11595     IF PB-COMPANY-ID  =  'NCL'
 11596        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11597            SUB2 GREATER THAN +8
 11598             MOVE 'U'            TO PB-BATCH-ENTRY
 11599             MOVE ER-2638        TO WS-ERROR
 11600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11602
 11603     IF SUB2 > +8
 11604        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11605           AND (PB-I-SIG-SW = 'Y')
 11606           CONTINUE
 11607        ELSE
 11608           MOVE ER-2638          TO WS-ERROR
 11609           PERFORM 9900-ERROR-FORMAT
 11610                                 THRU 9900-EXIT
 11611        END-IF
 11612        GO TO 3000-CONTINUE-EDIT
 11613     END-IF
 11614
 11615     IF PB-COMPANY-ID = 'CRI'
 11616        IF WS-ERROR = ER-2638
 11617           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11618
 11619     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11620     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11621     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11622     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11623
 11624     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11625        ADD +1                   TO SUB2
 11626        GO TO 0597-CHECK-AH-LIMITS.
 11627
 11628     IF PB-COMPANY-ID = 'NCL'
 11629         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 211
* EL050.cbl
 11630
 11631     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11632        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11633        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11634                                 > PL-LM-AMT (SUB2))
 11635        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11636           AND (PB-I-SIG-SW = 'Y')
 11637           CONTINUE
 11638        ELSE
 11639           MOVE ER-2638          TO WS-ERROR
 11640           PERFORM 9900-ERROR-FORMAT
 11641                                 THRU 9900-EXIT
 11642        END-IF
 11643     END-IF
 11644
 11645     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11646         IF  WS-ERROR    EQUAL    ER-2638
 11647             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11648                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11649                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11650                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11651                MOVE  ER-1910    TO  WS-ERROR
 11652                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11653
 11654     IF PB-COMPANY-ID = 'CRI'
 11655        IF WS-ERROR = ER-2638
 11656            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11657            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11658            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11659
 11660     GO TO 3000-CONTINUE-EDIT.
 11661
 11662 0597-CHECK-NCL-AH-LIMITS.
 11663
 11664     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11665        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11666        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11667                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11668         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11669
 11670     IF APP-CERT-USED
 11671         IF SUB2  LESS THAN  +5
 11672             MOVE +5             TO SUB2
 11673             GO TO 0597-CHECK-AH-LIMITS.
 11674
 11675     MOVE ER-2638                TO WS-ERROR.
 11676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11677
 11678     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11679
 11680 0599-CHECK-NCL-SIG-SWITCH.
 11681
 11682     IF NOT APP-CERT-USED
 11683         GO TO 3000-CONTINUE-EDIT.
 11684
 11685     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11686        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11687        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 212
* EL050.cbl
 11688        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11689         GO TO 3000-CONTINUE-EDIT.
 11690
 11691     IF SUB2 GREATER THAN +4
 11692         IF PL-LM-AGE (5) = ZEROS  AND
 11693            PL-LM-AGE (6) = ZEROS  AND
 11694            PL-LM-AGE (7) = ZEROS  AND
 11695            PL-LM-AGE (8) = ZEROS
 11696             MOVE  ER-1927        TO WS-ERROR
 11697             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11698             GO TO 3000-CONTINUE-EDIT
 11699         ELSE
 11700             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11701                 MOVE  ER-1920    TO WS-ERROR
 11702                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11703
 11704     IF PB-I-SIG-SW  = 'Y'
 11705       IF NOT PB-I-POLICY-ACCEPTED  AND
 11706          NOT PB-I-POLICY-DECLINED
 11707           MOVE 'U'               TO PB-BATCH-ENTRY
 11708           MOVE  ER-1926          TO WS-ERROR
 11709           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11710
 11711******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 213
* EL050.cbl
 11713
 11714 3000-CONTINUE-EDIT.
 11715
 11716     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11717     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11718     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11719     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11720     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11721
 11722     IF BROWSE-STARTED
 11723        PERFORM 9990-RETURN THRU 9990-EXIT
 11724        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11725
 11726     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11727        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11728        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11729        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11730*       MOVE 1                   TO DC-OPTION-CODE
 11731        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11732        IF DATE-CONVERSION-ERROR
 11733           MOVE ER-2622          TO WS-ERROR
 11734           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11735        ELSE
 11736           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11737              MOVE ER-2623       TO WS-ERROR
 11738              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11739           ELSE
 11740              MOVE ER-2622       TO WS-ERROR
 11741              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11742
 11743     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11744     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11745     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11746*    MOVE 1                      TO DC-OPTION-CODE.
 11747     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11748     IF DATE-CONVERSION-ERROR
 11749        GO TO 3005-EDIT-CONTINUE
 11750     ELSE
 11751        IF DC-ELAPSED-DAYS GREATER +180
 11752           MOVE ER-2613          TO WS-ERROR
 11753           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11754        ELSE
 11755           IF DC-ELAPSED-DAYS GREATER +90
 11756              MOVE ER-2612       TO WS-ERROR
 11757              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11758           ELSE
 11759             IF DC-ELAPSED-DAYS GREATER +60
 11760                MOVE ER-2614     TO WS-ERROR
 11761                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11762
 11763 3005-EDIT-CONTINUE.
 11764
 11765     IF PB-CANCELLATION
 11766         GO TO 3700-EDIT-CANCEL.
 11767
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 214
* EL050.cbl
 11769******************************************************************
 11770*                  E D I T   I S S U E                           *
 11771******************************************************************
 11772
 11773 3020-EDIT-ISSUE.
 11774
 11775      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11776      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11777      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11778      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11779      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11780
 11781     IF PB-ISSUE-FORCE
 11782        OR PB-ISSUE-DATE-FORCED
 11783        OR PB-FORCE-OFF
 11784        OR PB-OVERCHARGE-FORCE
 11785        or pb-exceeded-limit-forced
 11786        CONTINUE
 11787     ELSE
 11788        MOVE ER-2670             TO WS-ERROR
 11789        PERFORM 9900-ERROR-FORMAT
 11790                                 THRU 9900-EXIT
 11791     END-IF
 11792     .
 11793 3022-SET-POLICY-STATUS.
 11794
 11795     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11796
 11797     IF (PB-REISSUED-CERT)
 11798             OR
 11799        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11800         AND (PB-MONTHLY-CERT))
 11801         MOVE '5'                TO PB-I-ENTRY-STATUS
 11802         MOVE 'E'                TO PB-BATCH-ENTRY
 11803     END-IF
 11804
 11805     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11806        IF PB-MONTHLY-CERT
 11807           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11808        END-IF
 11809        IF PB-CASH-CERT
 11810           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11811        END-IF
 11812     END-IF
 11813     IF PB-POLICY-IS-DECLINED
 11814         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11815     IF PB-POLICY-IS-VOIDED
 11816         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11817     IF PB-NEEDS-UNDERWRITING
 11818         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11819     IF PB-REIN-ONLY-CERT
 11820         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11821     IF PB-PREM-ACCTNG-ONLY
 11822         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11823
 11824     MOVE SPACE                  TO PB-I-OB-FLAG.
 11825
 11826     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 215
* EL050.cbl
 11827         MOVE ER-2665            TO WS-ERROR
 11828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11829         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11830
 11831     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11832        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11833           MOVE 'Z'             TO PB-I-OB-FLAG.
 11834
 11835     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11836        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11837           MOVE 'Z'             TO PB-I-OB-FLAG.
 11838
 11839     IF ACCOUNT-MAST-FOUND
 11840         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11841         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11842         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11843         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11844         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11845         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11846         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11847     END-IF
 11848
 11849     IF ACCOUNT-MAST-FOUND
 11850        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11851         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11852
 11853     IF (ACCOUNT-MAST-FOUND)
 11854*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11855        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11856        IF PB-REISSUED-CERT
 11857           CONTINUE
 11858        ELSE
 11859           MOVE ER-2608          TO WS-ERROR
 11860           PERFORM 9900-ERROR-FORMAT
 11861                                 THRU 9900-EXIT
 11862         END-IF
 11863     END-IF
 11864
 11865     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11866        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11867        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11868
 11869**********   DMD CUSTOM CODE FOLLOWS  **********
 11870 3024-EDIT-DMD-FIELDS.
 11871     IF PB-COMPANY-ID NOT = 'DMD'
 11872        GO TO 3025-EDIT-REINSURANCE.
 11873
 11874*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11875*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11876*** ERROR IF THEY ARE NOT EQUAL.
 11877
 11878     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11879     SET BIN-TO-GREG               TO TRUE.
 11880     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11881     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11882**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11883
 11884     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 216
* EL050.cbl
 11885     SET BIN-TO-GREG               TO TRUE.
 11886     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11887     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11888**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11889
 11890     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11891        MOVE ER-8116               TO WS-ERROR
 11892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11893
 11894     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11895
 11896     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11897                                      WK-FULL-CERT-NO.
 11898     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11899
 11900     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11901
 11902     IF PB-VALID-LIFE
 11903        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11904     ELSE
 11905        IF PB-VALID-AH
 11906          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11907
 11908
 11909     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11910     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11911     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11912                                      DCUA-UNDRWRTR-CODE
 11913                                      DCUA-UNDRWRTR-GROUP-CODE
 11914                                      DCUA-RETURN-CODE.
 11915
 11916****************************************************************
 11917*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11918***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11919***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11920***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11921***   TO THIS RECORD.                                        ***
 11922****************************************************************
 11923     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11924     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11925     IF DCUA-SUCCESSFUL-PROCESS
 11926        GO TO 3024-EDIT-DL7-CONT.
 11927
 11928     IF DCUA-RETURN-CODE EQUAL '01'
 11929        MOVE ER-8110               TO WS-ERROR
 11930        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11931        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11932        GO TO 3024-EDIT-DL7-CONT.
 11933
 11934     IF DCUA-RETURN-CODE EQUAL '02'
 11935        MOVE ER-8111               TO WS-ERROR
 11936        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11938        GO TO 3024-EDIT-DL7-CONT.
 11939
 11940     IF DCUA-RETURN-CODE EQUAL '03'
 11941        MOVE ER-8074               TO WS-ERROR
 11942        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 217
* EL050.cbl
 11943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11944        GO TO 3024-EDIT-DL7-CONT.
 11945
 11946     IF DCUA-RETURN-CODE EQUAL '04'
 11947        MOVE ER-8075               TO WS-ERROR
 11948        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11949        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11950        GO TO 3024-EDIT-DL7-CONT.
 11951
 11952     IF DCUA-RETURN-CODE EQUAL '05'
 11953        MOVE ER-8076               TO WS-ERROR
 11954        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11955        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11956        GO TO 3024-EDIT-DL7-CONT.
 11957
 11958     IF DCUA-RETURN-CODE EQUAL '06'
 11959        MOVE ER-8077               TO WS-ERROR
 11960        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11962        GO TO 3024-EDIT-DL7-CONT.
 11963
 11964     IF DCUA-RETURN-CODE EQUAL '07'
 11965        MOVE ER-8078               TO WS-ERROR
 11966        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11968        GO TO 3024-EDIT-DL7-CONT.
 11969
 11970     IF DCUA-RETURN-CODE EQUAL 'E1'
 11971        MOVE ER-8079               TO WS-ERROR
 11972        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11973        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11974        GO TO 3024-EDIT-DL7-CONT.
 11975
 11976     IF DCUA-RETURN-CODE EQUAL 'E2'
 11977        MOVE ER-8080               TO WS-ERROR
 11978        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11980        GO TO 3024-EDIT-DL7-CONT.
 11981
 11982     IF DCUA-RETURN-CODE EQUAL 'E3'
 11983        MOVE ER-8098               TO WS-ERROR
 11984        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11986        GO TO 3024-EDIT-DL7-CONT.
 11987
 11988     IF DCUA-RETURN-CODE EQUAL 'C1'
 11989        MOVE ER-8099               TO WS-ERROR
 11990        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11992        GO TO 3024-EDIT-DL7-CONT.
 11993
 11994     IF DCUA-RETURN-CODE EQUAL 'U1'
 11995        MOVE ER-8109               TO WS-ERROR
 11996        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11998        GO TO 3024-EDIT-DL7-CONT.
 11999
 12000     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 218
* EL050.cbl
 12001        MOVE ER-8112               TO WS-ERROR
 12002        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12004        GO TO 3024-EDIT-DL7-CONT.
 12005
 12006     IF DCUA-RETURN-CODE EQUAL 'N2'
 12007        MOVE ER-8113               TO WS-ERROR
 12008        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12010        GO TO 3024-EDIT-DL7-CONT.
 12011
 12012     IF DCUA-RETURN-CODE EQUAL 'N3'
 12013        MOVE ER-8114               TO WS-ERROR
 12014        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12016        GO TO 3024-EDIT-DL7-CONT.
 12017
 12018     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12019     MOVE ER-8097                  TO WS-ERROR.
 12020     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12021     GO TO 3024-EDIT-DL7-CONT.
 12022
 12023 3024-EDIT-DL7-CONT.
 12024
 12025     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12026     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12027     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12028        NEXT SENTENCE
 12029     ELSE
 12030        MOVE ER-9263               TO WS-ERROR
 12031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12032
 12033******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12034******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12035     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12036        NEXT SENTENCE
 12037     ELSE
 12038        MOVE ER-8039               TO WS-ERROR
 12039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12040
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 219
* EL050.cbl
 12042****************************************************************
 12043*** VALIDATE STATE  : DLO022                                 ***
 12044****************************************************************
 12045     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12046     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12047
 12048     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12049     IF DVSC-SUCCESSFUL-EDIT
 12050        GO TO 3024-EDIT-DL22-CONT.
 12051
 12052     IF DVSC-RETURN-CODE EQUAL '01'
 12053        MOVE ER-8300               TO WS-ERROR
 12054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12055        GO TO 3024-EDIT-DL22-CONT.
 12056
 12057     IF DVSC-RETURN-CODE EQUAL '02'
 12058        MOVE ER-8301               TO WS-ERROR
 12059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12060        GO TO 3024-EDIT-DL22-CONT.
 12061
 12062     IF DVSC-RETURN-CODE EQUAL '03'
 12063        MOVE ER-8302               TO WS-ERROR
 12064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12065        GO TO 3024-EDIT-DL22-CONT.
 12066
 12067     IF DVSC-RETURN-CODE EQUAL 'N1'
 12068        MOVE ER-8304               TO WS-ERROR
 12069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12070        GO TO 3024-EDIT-DL22-CONT.
 12071
 12072     MOVE ER-8303                  TO WS-ERROR
 12073     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12074
 12075 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 220
* EL050.cbl
 12077****************************************************************
 12078*** VALIDATE LOAN OFFICER : DLO021                           ***
 12079****************************************************************
 12080
 12081     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12082     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12083     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12084     IF DVLO-SUCCESSFUL-EDIT
 12085        GO TO 3024-EDIT-DL21-CONT.
 12086
 12087     IF DVLO-RETURN-CODE EQUAL '01'
 12088        MOVE ER-8081               TO WS-ERROR
 12089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12090        GO TO 3024-EDIT-DL21-CONT.
 12091
 12092     IF DVLO-RETURN-CODE EQUAL '02'
 12093        MOVE ER-8082               TO WS-ERROR
 12094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12095        GO TO 3024-EDIT-DL21-CONT.
 12096
 12097     IF DVLO-RETURN-CODE EQUAL '03'
 12098        MOVE ER-8083               TO WS-ERROR
 12099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12100        GO TO 3024-EDIT-DL21-CONT.
 12101
 12102     IF DVLO-RETURN-CODE EQUAL '04'
 12103        MOVE ER-8084               TO WS-ERROR
 12104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12105        GO TO 3024-EDIT-DL21-CONT.
 12106
 12107     IF DVLO-RETURN-CODE EQUAL '05'
 12108        MOVE ER-8085               TO WS-ERROR
 12109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12110        GO TO 3024-EDIT-DL21-CONT.
 12111
 12112     MOVE ER-7825                  TO WS-ERROR
 12113     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12114     GO TO 3024-EDIT-DL21-CONT.
 12115
 12116 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 221
* EL050.cbl
 12118
 12119****************************************************************
 12120*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12121****************************************************************
 12122
 12123     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12124     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12125     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12126     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12127     IF DIPF-SUCCESSFUL-EDIT
 12128        GO TO 3024-EDIT-DL02-CONT.
 12129
 12130     IF DIPF-RETURN-CODE EQUAL '01'
 12131        MOVE ER-8086               TO WS-ERROR
 12132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12133        GO TO 3024-EDIT-DL02-CONT.
 12134
 12135     IF DIPF-RETURN-CODE EQUAL '02'
 12136        MOVE ER-8087               TO WS-ERROR
 12137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12138        GO TO 3024-EDIT-DL02-CONT.
 12139
 12140     IF DIPF-RETURN-CODE EQUAL '03'
 12141        MOVE ER-8088               TO WS-ERROR
 12142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12143        GO TO 3024-EDIT-DL02-CONT.
 12144
 12145     MOVE ER-8095                  TO WS-ERROR
 12146     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12147     GO TO 3024-EDIT-DL02-CONT.
 12148
 12149 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 222
* EL050.cbl
 12151
 12152****************************************************************
 12153*** VALIDATE BANK ID : DLO003                                ***
 12154****************************************************************
 12155
 12156     MOVE WK-GREG-CENT           TO WCG-CENT.
 12157     MOVE WK-GREG-YYMM           TO WCG-REST.
 12158     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12159        MOVE ER-8040               TO WS-ERROR
 12160        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12161
 12162     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12163     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12164     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12165     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12166     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12167     IF DVBI-SUCCESSFUL-EDIT
 12168        GO TO 3024-EDIT-DL03-CONT.
 12169
 12170     IF DVBI-RETURN-CODE EQUAL '01'
 12171        MOVE ER-8089               TO WS-ERROR
 12172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12173        GO TO 3024-EDIT-DL03-CONT.
 12174
 12175     IF DVBI-RETURN-CODE EQUAL '02'
 12176        MOVE ER-8090               TO WS-ERROR
 12177        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12178        GO TO 3024-EDIT-DL03-CONT.
 12179
 12180     IF DVBI-RETURN-CODE EQUAL '03'
 12181        MOVE ER-8091               TO WS-ERROR
 12182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12183        GO TO 3024-EDIT-DL03-CONT.
 12184
 12185     IF DVBI-RETURN-CODE EQUAL '04'
 12186        MOVE ER-8092               TO WS-ERROR
 12187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12188        GO TO 3024-EDIT-DL03-CONT.
 12189
 12190     IF DVBI-RETURN-CODE EQUAL '05'
 12191        MOVE ER-8093               TO WS-ERROR
 12192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12193        GO TO 3024-EDIT-DL03-CONT.
 12194
 12195     IF DVBI-RETURN-CODE EQUAL '06'
 12196        MOVE ER-8094               TO WS-ERROR
 12197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12198        GO TO 3024-EDIT-DL03-CONT.
 12199
 12200     MOVE ER-8096                  TO WS-ERROR
 12201     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12202     GO TO 3024-EDIT-DL03-CONT.
 12203
 12204 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 223
* EL050.cbl
 12206
 12207     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12208        NEXT SENTENCE
 12209     ELSE
 12210        MOVE ER-8042               TO WS-ERROR
 12211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12212
 12213     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12214     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12215     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12216
 12217     IF DMPF-RETURN-CODE = '01'
 12218        MOVE ER-8067               TO WS-ERROR
 12219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12220        GO TO 3024-EDIT-DL01-CONT.
 12221
 12222     IF DMPF-RETURN-CODE = '02'
 12223        MOVE ER-8068               TO WS-ERROR
 12224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12225        GO TO 3024-EDIT-DL01-CONT.
 12226
 12227     IF DMPF-RETURN-CODE = '03'
 12228        MOVE ER-8069               TO WS-ERROR
 12229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12230        GO TO 3024-EDIT-DL01-CONT.
 12231
 12232     IF DMPF-RETURN-CODE = 'E1'
 12233        MOVE ER-8070               TO WS-ERROR
 12234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12235        GO TO 3024-EDIT-DL01-CONT.
 12236
 12237     IF DMPF-RETURN-CODE = 'N1'
 12238        MOVE ER-8071               TO WS-ERROR
 12239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12240        GO TO 3024-EDIT-DL01-CONT.
 12241
 12242     IF DMPF-RETURN-CODE NOT = 'OK'
 12243        MOVE ER-8072               TO WS-ERROR
 12244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12245
 12246 3024-EDIT-DL01-CONT.
 12247******************************************************************
 12248***  VALIDATES RATE CODES : DLO017                             ***
 12249******************************************************************
 12250
 12251      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12252      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12253      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12254      IF DVRC-SUCCESSFUL-EDIT
 12255        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12256        GO TO 3024-CHECK-VALID-RATE.
 12257
 12258      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12259
 12260      IF DVRC-RETURN-CODE EQUAL '01'
 12261         MOVE ER-7817                   TO WS-ERROR
 12262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12263         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 224
* EL050.cbl
 12264
 12265      IF DVRC-RETURN-CODE EQUAL '02'
 12266         MOVE ER-7818                   TO WS-ERROR
 12267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12268         GO TO 3025-EDIT-REINSURANCE.
 12269
 12270      IF DVRC-RETURN-CODE EQUAL '03'
 12271         MOVE ER-7819                   TO WS-ERROR
 12272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12273         GO TO 3025-EDIT-REINSURANCE.
 12274
 12275       MOVE ER-7820                     TO WS-ERROR.
 12276       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12277       GO TO 3025-EDIT-REINSURANCE.
 12278
 12279******************************************************************
 12280***  GET PREMIUM RATES : DLO011                                ***
 12281******************************************************************
 12282
 12283 3024-CHECK-VALID-RATE.
 12284
 12285     IF VALID-RATE-CODE
 12286        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12287        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12288        MOVE SPACES                TO DPRB-RETURN-CODE
 12289        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12290     ELSE
 12291         GO TO 3025-EDIT-REINSURANCE.
 12292
 12293      IF DPRB-SUCCESSFUL-PROCESS
 12294         IF PB-VALID-LIFE
 12295             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12296             GO TO 3025-EDIT-REINSURANCE
 12297         ELSE
 12298             IF PB-VALID-AH
 12299                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12300                 GO TO 3025-EDIT-REINSURANCE.
 12301
 12302      IF DPRB-RETURN-CODE EQUAL '01'
 12303         MOVE ER-7812                   TO WS-ERROR
 12304         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12305         GO TO 3025-EDIT-REINSURANCE.
 12306
 12307      IF DPRB-RETURN-CODE EQUAL '02'
 12308         MOVE ER-7813                   TO WS-ERROR
 12309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12310         GO TO 3025-EDIT-REINSURANCE.
 12311
 12312      IF DPRB-RETURN-CODE EQUAL '03'
 12313         MOVE ER-7814                   TO WS-ERROR
 12314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12315         GO TO 3025-EDIT-REINSURANCE.
 12316
 12317      IF DPRB-RETURN-CODE EQUAL '04'
 12318         IF NOT DPRB-1ST-TIME
 12319            MOVE ER-7815                   TO WS-ERROR
 12320            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12321            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 225
* EL050.cbl
 12322          ELSE
 12323         IF PB-VALID-LIFE
 12324            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12325          ELSE
 12326            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12327         END-IF
 12328         MOVE SPACES                TO DOCC-RETURN-CODE
 12329         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12330         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12331         IF DOCC-RETURN-CODE = 'OK'
 12332             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12333             GO TO 3024-CHECK-VALID-RATE
 12334           ELSE
 12335             MOVE ER-7823               TO WS-ERROR
 12336             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12337             GO TO 3025-EDIT-REINSURANCE.
 12338
 12339       MOVE ER-7816                     TO WS-ERROR.
 12340       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12341       GO TO 3025-EDIT-REINSURANCE.
 12342
 12343**********   DMD CUSTOM CODE ABOVE    **********
 12344
 12345 3025-EDIT-REINSURANCE.
 12346     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12347         GO TO 3027-EDIT-CONTINUE.
 12348
 12349     MOVE LOW-VALUES               TO ERREIN-KEY.
 12350     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12351     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12352                                      REIN-CODE-2
 12353                                      REIN-CODE-3.
 12354     MOVE 'A'                      TO REIN-TYPE.
 12355
 12356     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12357
 12358     MOVE '3026' TO REIN-SW.
 12359     MOVE ' '                   TO WS-REIN-READ-SW.
 12360
 12361     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12362     IF REIN-TABLE-NOT-FOUND
 12363         GO TO 3026-NO-SPEC-TABLE.
 12364
 12365     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12366     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12367                                   WS-NSP-ST-CD-LF.
 12368     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12369                                   WS-NSP-ST-CD-AH.
 12370
 12371     GO TO 3040-EDIT-CONTINUE.
 12372
 12373 3026-NO-SPEC-TABLE.
 12374
 12375     MOVE ER-2664                TO WS-ERROR.
 12376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12377     GO TO 3040-EDIT-CONTINUE.
 12378
 12379 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 226
* EL050.cbl
 12380
 12381     IF PB-I-REIN-TABLE = SPACES
 12382       GO TO 3040-EDIT-CONTINUE.
 12383
 12384     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12385          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12386          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12387           GO TO 3040-EDIT-CONTINUE.
 12388
 12389     MOVE LOW-VALUES            TO ERREIN-KEY.
 12390     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12391     MOVE 'A'                   TO REIN-TYPE.
 12392     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12393
 12394     MOVE '3028'                TO REIN-SW.
 12395     MOVE ' '                   TO WS-REIN-READ-SW.
 12396
 12397     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12398     IF REIN-TABLE-NOT-FOUND
 12399         GO TO 3028-NO-REIN-TABLE.
 12400
 12401     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12402     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12403                                   WS-NSP-ST-CD-LF.
 12404     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12405                                   WS-NSP-ST-CD-AH.
 12406
 12407     GO TO 3040-EDIT-CONTINUE.
 12408
 12409 3028-NO-REIN-TABLE.
 12410
 12411     MOVE ER-2615                TO WS-ERROR.
 12412     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12413     GO TO 3040-EDIT-CONTINUE.
 12414
 12415 3040-EDIT-CONTINUE.
 12416
 12417     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12418         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12419
 12420     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12421         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12422
 12423     IF (NOT PB-REISSUED-CERT)
 12424        AND (NOT PB-MONTHLY-CERT)
 12425        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12426            MOVE '001'           TO PB-I-LF-TERM
 12427            MOVE 'M'             TO PB-I-INSURED-SEX.
 12428
 12429     IF (NOT PB-REISSUED-CERT)
 12430        AND (NOT PB-MONTHLY-CERT)
 12431        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12432            MOVE '001'           TO PB-I-AH-TERM
 12433            MOVE 'M'             TO PB-I-INSURED-SEX.
 12434
 12435 3040-EDIT-1ST-PMT-DT.
 12436     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12437     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 227
* EL050.cbl
 12438         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12439
 12440******************************************************************
 12441*                                                                *
 12442*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12443*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12444*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12445*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12446*                                                                *
 12447******************************************************************
 12448
 12449     IF PB-EFF-DT-PROCESSING
 12450        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12451                                    PB-I-LF-EXPIRE-DT
 12452                                    PB-I-AH-EXPIRE-DT
 12453        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12454        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12455        MOVE ZERO                TO DC-ELAPSED-DAYS
 12456        MOVE +1                  TO DC-ELAPSED-MONTHS
 12457        SET BIN-PLUS-ELAPSED     TO TRUE
 12458*       MOVE 6                   TO DC-OPTION-CODE
 12459        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12460        IF NO-CONVERSION-ERROR
 12461           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12462
 12463******************************************************************
 12464*                                                                *
 12465*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12466*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12467*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12468*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12469*                                                                *
 12470******************************************************************
 12471
 12472     IF PB-EXT-DAYS-PROCESSING
 12473          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12474                                         PB-I-LF-EXPIRE-DT
 12475                                         PB-I-AH-EXPIRE-DT
 12476          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12477          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12478          MOVE +1                     TO DC-ELAPSED-MONTHS
 12479          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12480          SET BIN-PLUS-ELAPSED        TO TRUE
 12481*         MOVE 6                      TO DC-OPTION-CODE
 12482          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12483          IF NO-CONVERSION-ERROR
 12484             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12485
 12486******************************************************************
 12487*                                                                *
 12488*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12489*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12490*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12491*        (EXPIRE DATE - (TERM -1))  *  -1.
 12492*                                                                *
 12493******************************************************************
 12494
 12495     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 228
* EL050.cbl
 12496        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12497           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12498              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12499              MOVE PB-I-AH-TERM      TO WS-TERM
 12500           ELSE
 12501              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12502              MOVE PB-I-LF-TERM      TO WS-TERM
 12503        ELSE
 12504           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12505              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12506              MOVE PB-I-LF-TERM      TO WS-TERM
 12507           ELSE
 12508              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12509              MOVE PB-I-AH-TERM      TO WS-TERM.
 12510
 12511     IF PB-EXPIRE-DT-PROCESSING
 12512        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12513        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12514        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12515        MOVE ZERO                TO DC-ELAPSED-DAYS
 12516                                    DC-ODD-DAYS-OVER
 12517          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12518          SET BIN-PLUS-ELAPSED    TO TRUE
 12519*         MOVE 6                  TO DC-OPTION-CODE
 12520          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12521          IF NO-CONVERSION-ERROR
 12522             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12523
 12524******************************************************************
 12525*                                                                *
 12526*            1ST PAYMENT DATE PROCESSING                         *
 12527*                                                                *
 12528******************************************************************
 12529
 12530     IF PB-1ST-PMT-DT-PROCESSING
 12531        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12532                                    PB-I-AH-EXPIRE-DT
 12533        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12534
 12535     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12536         NEXT SENTENCE
 12537     ELSE
 12538         MOVE ER-2680                 TO WS-ERROR
 12539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12540         GO TO 3060-ORIG-TERM-CHECK.
 12541
 12542     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12543     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12544     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12545*    MOVE 1                      TO DC-OPTION-CODE.
 12546     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12547                                    DC-ELAPSED-DAYS
 12548                                    DC-ODD-DAYS-OVER.
 12549
 12550     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12551
 12552     IF DATE-CONVERSION-ERROR
 12553        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 229
* EL050.cbl
 12554
 12555     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12556     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12557        AND (WS-LF-COVERAGE-TYPE = 'L')
 12558        IF (DC-ELAPSED-MONTHS > 1)
 12559                      OR
 12560           ((DC-ELAPSED-MONTHS = 1)
 12561           AND (DC-ODD-DAYS-OVER > 0))
 12562           MOVE ER-2882          TO WS-ERROR
 12563           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12564        END-IF
 12565     END-IF
 12566     if dc-elapsed-months > 0
 12567        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12568        + dc-odd-days-over
 12569     end-if
 12570     IF PB-EXT-DAYS-PROCESSING
 12571        CONTINUE
 12572     ELSE
 12573        IF DC-ELAPSED-MONTHS = +0
 12574           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12575        ELSE
 12576           IF (WS-LF-EARNINGS-CALC = '4')
 12577              AND (DC-ELAPSED-MONTHS > ZERO)
 12578              AND (DC-ELAPSED-DAYS > ZERO)
 12579              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12580           ELSE
 12581              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12582                                 THRU 6499-EXIT
 12583              MOVE WS-ODD-DAYS-OVER
 12584                                 TO PB-I-EXTENTION-DAYS
 12585           END-IF
 12586        END-IF
 12587     END-IF
 12588******************************************************************
 12589*                                                                *
 12590*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12591*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12592*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12593*            AND ANY ODD DAYS.                                   *
 12594*                                                                *
 12595******************************************************************
 12596
 12597     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12598                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12599     IF WS-LF-EARNINGS-CALC NOT = '4'
 12600        IF DC-ELAPSED-DAYS > ZEROS
 12601           MOVE ER-2681          TO WS-ERROR
 12602           PERFORM 9900-ERROR-FORMAT
 12603                                 THRU 9900-EXIT
 12604        END-IF
 12605     END-IF
 12606
 12607     IF WS-LF-EARNINGS-CALC NOT = '4'
 12608        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12609           MOVE ER-2681          TO WS-ERROR
 12610           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12611
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 230
* EL050.cbl
 12612     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12613        (PB-I-LF-TERM NOT = ZERO) AND
 12614         NOT NO-LIFE-COVERAGE
 12615          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12616          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12617          IF WS-LF-EARNINGS-CALC = '4'
 12618             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12619             PB-I-PAY-FREQUENCY
 12620          END-IF
 12621          MOVE ZERO              TO DC-ELAPSED-DAYS
 12622                                    DC-ODD-DAYS-OVER
 12623          MOVE 1                 TO DC-END-OF-MONTH
 12624          SET BIN-PLUS-ELAPSED        TO TRUE
 12625*         MOVE 6                 TO DC-OPTION-CODE
 12626          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12627          IF NO-CONVERSION-ERROR
 12628             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12629             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12630                (WS-LF-SPECIAL-CALC-CD = 'L')
 12631                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12632                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12633                  MOVE +1             TO DC-ELAPSED-MONTHS
 12634                  SET BIN-PLUS-ELAPSED  TO TRUE
 12635*                 MOVE 6              TO DC-OPTION-CODE
 12636                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12637                  IF NO-CONVERSION-ERROR
 12638                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12639
 12640* okay, i had to move the new att age edit down here because the
 12641* expiration date could get recalculated and i need the exp date
 12642     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12643        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12644        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12645        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12646           AND ZEROS
 12647           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12648           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12649           SET ELAPSED-BETWEEN-BIN TO TRUE
 12650           PERFORM 8500-DATE-CONVERT
 12651                                 THRU 8500-EXIT
 12652           IF NO-CONVERSION-ERROR
 12653              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12654                 MOVE ER-2669       TO WS-ERROR
 12655*                PERFORM 9900-ERROR-FORMAT
 12656*                                THRU 9900-EXIT
 12657              END-IF
 12658           END-IF
 12659        ELSE
 12660           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12661           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12662              MOVE ER-2669       TO WS-ERROR
 12663*             PERFORM 9900-ERROR-FORMAT
 12664*                                THRU 9900-EXIT
 12665           ELSE
 12666              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12667                 MOVE ER-1570    TO WS-ERROR
 12668                 PERFORM 9900-ERROR-FORMAT
 12669                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 231
* EL050.cbl
 12670              END-IF
 12671           END-IF
 12672        END-IF
 12673        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12674           AND ZEROS
 12675           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12676           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12677           SET ELAPSED-BETWEEN-BIN TO TRUE
 12678           PERFORM 8500-DATE-CONVERT
 12679                                 THRU 8500-EXIT
 12680           IF NO-CONVERSION-ERROR
 12681              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12682                 MOVE ER-2669       TO WS-ERROR
 12683*                PERFORM 9900-ERROR-FORMAT
 12684*                                THRU 9900-EXIT
 12685              END-IF
 12686           END-IF
 12687        ELSE
 12688           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12689             (PB-I-LF-TERM / 12)
 12690           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12691              MOVE ER-2669       TO WS-ERROR
 12692*             PERFORM 9900-ERROR-FORMAT
 12693*                                THRU 9900-EXIT
 12694           ELSE
 12695              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12696                 MOVE ER-1571    TO WS-ERROR
 12697                 PERFORM 9900-ERROR-FORMAT
 12698                                 THRU 9900-EXIT
 12699              END-IF
 12700           END-IF
 12701        END-IF
 12702        IF WS-ERROR = ER-2669
 12703           PERFORM 9900-ERROR-FORMAT
 12704                                 THRU 9900-EXIT
 12705        END-IF
 12706     END-IF
 12707     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12708        (PB-I-AH-TERM NOT = ZERO) AND
 12709         NOT NO-AH-COVERAGE
 12710          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12711             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12712             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12713             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12714          ELSE
 12715             IF WS-LF-EARNINGS-CALC = '4'
 12716                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12717                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12718                PB-I-PAY-FREQUENCY
 12719             ELSE
 12720                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12721                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12722             END-IF
 12723          END-IF
 12724          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12725                                         DC-ODD-DAYS-OVER
 12726          MOVE 1                      TO DC-END-OF-MONTH
 12727          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 232
* EL050.cbl
 12728*         MOVE 6                      TO DC-OPTION-CODE
 12729          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12730          IF NO-CONVERSION-ERROR
 12731             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12732     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12733        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12734        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12735        IF PB-I-BIRTHDAY > LOW-VALUES
 12736           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12737           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12738           SET ELAPSED-BETWEEN-BIN TO TRUE
 12739           PERFORM 8500-DATE-CONVERT
 12740                                 THRU 8500-EXIT
 12741           IF NO-CONVERSION-ERROR
 12742              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12743                 MOVE ER-3054       TO WS-ERROR
 12744*                PERFORM 9900-ERROR-FORMAT
 12745*                                THRU 9900-EXIT
 12746              END-IF
 12747           END-IF
 12748        ELSE
 12749           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12750           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12751              MOVE ER-3054       TO WS-ERROR
 12752*             PERFORM 9900-ERROR-FORMAT
 12753*                                THRU 9900-EXIT
 12754           END-IF
 12755        END-IF
 12756        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12757           AND ZEROS
 12758           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12759           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12760           SET ELAPSED-BETWEEN-BIN TO TRUE
 12761           PERFORM 8500-DATE-CONVERT
 12762                                 THRU 8500-EXIT
 12763           IF NO-CONVERSION-ERROR
 12764              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12765                 MOVE ER-3054       TO WS-ERROR
 12766*                PERFORM 9900-ERROR-FORMAT
 12767*                                THRU 9900-EXIT
 12768              END-IF
 12769           END-IF
 12770        ELSE
 12771           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12772             (PB-I-AH-TERM / 12)
 12773           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12774              MOVE ER-3054       TO WS-ERROR
 12775*             PERFORM 9900-ERROR-FORMAT
 12776*                                THRU 9900-EXIT
 12777           END-IF
 12778        END-IF
 12779        IF WS-ERROR = ER-3054
 12780           PERFORM 9900-ERROR-FORMAT
 12781                                 THRU 9900-EXIT
 12782        END-IF
 12783     END-IF
 12784     MOVE SPACE                       TO DC-END-OF-MONTH.
 12785
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 233
* EL050.cbl
 12786     IF PB-COMPANY-ID = 'NCB'
 12787        GO TO 3040-EDIT-EXTENSION-DAYS.
 12788
 12789     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12790       AND
 12791        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12792        NEXT SENTENCE
 12793     ELSE
 12794        GO TO 3040-EDIT-EXTENSION-DAYS.
 12795
 12796     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12797        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12798        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12799     ELSE
 12800        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12801        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12802
 12803     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12804*    MOVE '1'      TO DC-OPTION-CODE
 12805     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12806     IF (NO-CONVERSION-ERROR)
 12807        AND (DC-ELAPSED-MONTHS > +1)
 12808        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12809        MOVE ER-2668   TO WS-ERROR
 12810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12811
 12812 3040-EDIT-EXTENSION-DAYS.
 12813
 12814     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12815        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12816         GO TO 3050-EDIT-TERM-IN-DAYS
 12817     ELSE
 12818         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12819
 12820     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12821         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12822     ELSE
 12823        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12824           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12825           MOVE ER-2681         TO WS-ERROR
 12826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12827
 12828     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12829        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12830        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12831         GO TO 3060-ORIG-TERM-CHECK.
 12832
 12833     GO TO 3060-ORIG-TERM-CHECK.
 12834
 12835 3050-EDIT-TERM-IN-DAYS.
 12836
 12837     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12838
 12839     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12840         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12841     ELSE
 12842         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12843            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 234
* EL050.cbl
 12844            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12845
 12846     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12847                                       REMAINDER WS-WORK-TERM.
 12848     IF WS-WORK-TERM GREATER THAN ZERO
 12849         ADD +1 TO PB-I-LF-TERM.
 12850
 12851     IF NOT NO-AH-COVERAGE
 12852         MOVE ER-2684            TO WS-ERROR
 12853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12854
 12855
 12856 3060-ORIG-TERM-CHECK.
 12857
 12858******************************************************************
 12859*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12860******************************************************************
 12861
 12862     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12863        NEXT SENTENCE
 12864     ELSE
 12865        IF NOT NO-LIFE-COVERAGE
 12866           IF PB-I-LF-TERM NUMERIC
 12867              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12868              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12869              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12870                  NEXT SENTENCE
 12871           ELSE
 12872              MOVE ER-2647       TO WS-ERROR
 12873              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12874
 12875     IF NOT NO-AH-COVERAGE
 12876         IF PB-I-AH-TERM NUMERIC
 12877            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12878            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12879            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12880             NEXT SENTENCE
 12881          ELSE
 12882              MOVE ER-2658       TO WS-ERROR
 12883              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12884
 12885     IF PB-COMPANY-ID = 'NCB'
 12886        GO TO 3070-LOAN-TERM-CHECK.
 12887
 12888     IF POLICY-HAS-AH
 12889       AND
 12890        POLICY-HAS-LIFE
 12891       AND
 12892        PB-I-LF-TERM NUMERIC
 12893       AND
 12894        PB-I-AH-TERM NUMERIC
 12895        NEXT SENTENCE
 12896     ELSE
 12897        GO TO 3070-LOAN-TERM-CHECK.
 12898
 12899     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12900     IF WS-TEX-FACT-2 LESS THAN +0
 12901        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 235
* EL050.cbl
 12902
 12903     IF WS-TEX-FACT-2 GREATER THAN +1
 12904        MOVE ER-2668             TO WS-ERROR
 12905        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12906
 12907 3070-LOAN-TERM-CHECK.
 12908
 12909     IF (WS-LF-BENEFIT-CD = ZERO)
 12910         OR (NO-LF-BENEFIT-MATCH)
 12911            GO TO 3125-EDIT-PMT-FREQ.
 12912*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12913*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12914*          AND 'V' AND 'W' AND 'X'
 12915*          GO TO 3125-EDIT-PMT-FREQ
 12916*       END-IF
 12917*    ELSE
 12918*       IF WS-AH-DCC-TRUNC = 'T'
 12919*          CONTINUE
 12920*       ELSE
 12921*          GO TO 3125-EDIT-PMT-FREQ
 12922*       END-IF
 12923*    END-IF
 12924     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12925                    OR
 12926        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12927        AND (WS-AH-DCC-TRUNC = 'T'))
 12928        CONTINUE
 12929     ELSE
 12930        GO TO 3125-EDIT-PMT-FREQ
 12931     END-IF
 12932     IF PB-I-LOAN-TERM NOT NUMERIC
 12933         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12934
 12935     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12936        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12937*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12938        PB-I-LOAN-TERM NOT GREATER THAN +360
 12939         NEXT SENTENCE
 12940     ELSE
 12941         MOVE ER-2648            TO WS-ERROR
 12942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12943
 12944     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12945        MOVE ER-3058             TO WS-ERROR
 12946        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12947     end-if
 12948
 12949     IF WS-STATE-ABBREVIATION = 'NC'
 12950        IF PB-I-LOAN-TERM > +59
 12951           CONTINUE
 12952        ELSE
 12953           MOVE ER-2792          TO WS-ERROR
 12954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12955        END-IF
 12956     END-IF
 12957
 12958     .
 12959 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 236
* EL050.cbl
 12960     IF (WS-LF-BENEFIT-CD = ZERO)
 12961         OR (NO-LF-BENEFIT-MATCH)
 12962            GO TO 3127-EDIT-LOAN-OFFICER.
 12963     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12964                    OR
 12965        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12966        AND (WS-AH-DCC-TRUNC = 'T'))
 12967                    OR
 12968         (PB-COMPANY-ID = 'AHL')
 12969        CONTINUE
 12970     ELSE
 12971        IF (PB-I-LOAN-TERM > ZEROS)
 12972           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12973           MOVE ER-1575          TO WS-ERROR
 12974           PERFORM 9900-ERROR-FORMAT
 12975                                 THRU 9900-EXIT
 12976        END-IF
 12977     END-IF
 12978     IF WS-LF-EARNINGS-CALC NOT = '4'
 12979         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12980            MOVE ER-2653         TO WS-ERROR
 12981            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12982            GO TO 3127-EDIT-LOAN-OFFICER
 12983         ELSE
 12984            GO TO 3127-EDIT-LOAN-OFFICER.
 12985
 12986     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12987         MOVE ER-2655            TO WS-ERROR
 12988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12989         GO TO 3127-EDIT-LOAN-OFFICER.
 12990
 12991     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12992         MOVE ER-2654            TO WS-ERROR
 12993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12994         GO TO 3127-EDIT-LOAN-OFFICER.
 12995
 12996     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12997         GIVING WS-TEX-FACT-2
 12998             REMAINDER WS-TEX-FACT-3.
 12999
 13000*    IF WS-TEX-FACT-3 NOT = ZERO
 13001*       MOVE ER-2654             TO WS-ERROR
 13002*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13003
 13004
 13005 3127-EDIT-LOAN-OFFICER.
 13006
 13007     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13008        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13009           MOVE ER-2690          TO WS-ERROR
 13010           PERFORM 9900-ERROR-FORMAT
 13011                                 THRU 9900-EXIT
 13012        ELSE
 13013           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13014           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13015           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13016           MOVE PB-SV-STATE      TO LOFC-STATE
 13017           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 237
* EL050.cbl
 13018           MOVE PB-I-LOAN-OFFICER
 13019                                 TO LOFC-CODE
 13020           PERFORM 8586-READ-LOAN-OFFICER
 13021                                 THRU 8586-EXIT
 13022           IF (NOT LOFC-MASTER-FOUND)
 13023              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13024              MOVE ER-3006       TO WS-ERROR
 13025              PERFORM 9900-ERROR-FORMAT
 13026                                 THRU 9900-EXIT
 13027           END-IF
 13028        END-IF
 13029     END-IF
 13030     .
 13031 3129-EDIT-APR.
 13032
 13033     IF (WS-LF-BENEFIT-CD = ZERO)
 13034        OR (NO-LF-BENEFIT-MATCH)
 13035        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13036           GO TO 3130-EDIT-AGE
 13037*       ELSE
 13038*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13039*             GO TO 3130-EDIT-AGE
 13040*          END-IF
 13041        END-IF
 13042     END-IF
 13043
 13044     IF (WS-STATE-ABBREVIATION = 'OH')
 13045         AND (PB-I-RATE-CLASS NOT = 'L ')
 13046         AND (PB-I-LF-TERM GREATER THAN 60)
 13047         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13048         GO TO 3129-APR-CONT.
 13049
 13050     IF (WS-STATE-ABBREVIATION = 'RI')
 13051         AND (PB-I-LF-TERM GREATER THAN 60)
 13052         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13053         GO TO 3129-APR-CONT.
 13054
 13055     IF (WS-STATE-ABBREVIATION = 'UT')
 13056         AND (PB-I-LF-TERM GREATER THAN 62)
 13057         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13058         AND (PB-CERT-EFF-DT LESS WS-830901)
 13059         GO TO 3129-APR-CONT.
 13060
 13061     IF PB-COMPANY-ID = 'LAP'
 13062        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13063           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13064              MOVE ER-2656         TO WS-ERROR
 13065              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13066              GO TO 3130-EDIT-AGE.
 13067
 13068     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13069        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13070        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13071        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13072        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13073        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13074         GO TO 3130-EDIT-AGE.
 13075
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 238
* EL050.cbl
 13076 3129-APR-CONT.
 13077     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13078         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13079         GO TO 3130-EDIT-AGE.
 13080
 13081     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13082         WS-AH-BENEFIT-CD (1:1) = 'S')
 13083        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13084        AND (PB-I-LOAN-APR = ZERO)
 13085        MOVE ER-2657             TO WS-ERROR
 13086        PERFORM 9900-ERROR-FORMAT
 13087                                 THRU 9900-EXIT
 13088        GO TO 3130-EDIT-AGE
 13089     END-IF
 13090*    IF PB-I-LOAN-APR = ZERO
 13091*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13092*    END-IF
 13093
 13094     if pb-i-loan-apr = +99.9999
 13095        move er-2656             to ws-error
 13096        PERFORM 9900-ERROR-FORMAT
 13097                                 THRU 9900-EXIT
 13098        GO TO 3130-EDIT-AGE
 13099     end-if
 13100*    IF PB-I-LOAN-APR = ZERO
 13101*       MOVE ER-2656             TO WS-ERROR
 13102*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103*       GO TO 3130-EDIT-AGE.
 13104
 13105*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13106     if pb-i-loan-apr not = +99.9999
 13107        IF PB-I-LOAN-APR > +30.000
 13108           MOVE ER-2657          TO WS-ERROR
 13109           PERFORM 9900-ERROR-FORMAT
 13110                                 THRU 9900-EXIT
 13111        end-if
 13112     end-if
 13113     .
 13114 3130-EDIT-AGE.
 13115
 13116******************************************************************
 13117*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13118******************************************************************
 13119
 13120     IF NOT NO-LIFE-COVERAGE
 13121        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13122           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13123               MOVE ER-2628             TO WS-ERROR
 13124               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13125
 13126     IF NOT NO-AH-COVERAGE
 13127        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13128           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13129               MOVE ER-2628         TO WS-ERROR
 13130               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13131
 13132 3133-SEX-CODE.
 13133     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 239
* EL050.cbl
 13134         IF WS-DEFAULT-SEX = 'M'
 13135             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13136          ELSE
 13137             IF WS-DEFAULT-SEX = 'F'
 13138             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13139
 13140     IF PB-I-INSURED-SEX = '1'
 13141         MOVE 'M' TO PB-I-INSURED-SEX.
 13142
 13143     IF PB-I-INSURED-SEX = '2'
 13144         MOVE 'F' TO PB-I-INSURED-SEX.
 13145
 13146 3134-SIG-SW-EDIT.
 13147     IF PB-I-SIG-SW = SPACE
 13148         MOVE 'N'                TO  PB-I-SIG-SW.
 13149
 13150     IF PB-COMPANY-ID = 'NCL'
 13151         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13152             NEXT SENTENCE
 13153         ELSE
 13154             MOVE ER-1923        TO  WS-ERROR
 13155             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13156     ELSE
 13157     IF PB-COMPANY-ID = 'CRI'
 13158         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13159             NEXT SENTENCE
 13160         ELSE
 13161             MOVE ER-2606        TO  WS-ERROR
 13162             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13163     ELSE
 13164     IF PB-COMPANY-ID = 'TMS'
 13165         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13166             NEXT SENTENCE
 13167         ELSE
 13168             MOVE ER-2689        TO  WS-ERROR
 13169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13170     ELSE
 13171         IF PB-I-SIG-SW = 'Y' OR 'N'
 13172             NEXT SENTENCE
 13173         ELSE
 13174             MOVE ER-2651        TO  WS-ERROR
 13175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13176
 13177     IF PB-COMPANY-ID = 'FLA'
 13178         IF (WS-EDIT-AGE GREATER 54  OR
 13179             WS-AH-EDIT-AGE GREATER 54)  AND
 13180            PB-I-SIG-SW = 'N'
 13181            MOVE ER-2651         TO  WS-ERROR
 13182            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13183
 13184 3135-NAME-EDIT.
 13185
 13186     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13187        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13188        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13189           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13190                                 TO PB-I-JOINT-FIRST-NAME
 13191        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 240
* EL050.cbl
 13192     END-IF
 13193     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13194        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13195        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13196           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13197                                 TO PB-I-JOINT-LAST-NAME
 13198        END-PERFORM
 13199     END-IF
 13200     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13201        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13202        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13203           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13204                                 TO PB-I-INSURED-FIRST-NAME
 13205        END-PERFORM
 13206     END-IF
 13207     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13208        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13209        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13210           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13211                                 TO PB-I-INSURED-LAST-NAME
 13212        END-PERFORM
 13213     END-IF
 13214     IF PB-I-INSURED-LAST-NAME = SPACES
 13215       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13216       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13217           MOVE ER-2660    TO WS-ERROR
 13218           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13219
 13220 3136-EDIT-SEX.
 13221
 13222******************************************************************
 13223*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13224******************************************************************
 13225
 13226     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13227        (WS-AH-SPECIAL-CALC-CD = 'O')
 13228        NEXT SENTENCE
 13229     ELSE
 13230        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13231           NEXT SENTENCE
 13232        ELSE
 13233           MOVE ER-2629            TO WS-ERROR
 13234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13235
 13236 3137-EDIT-EFF-DATE.
 13237
 13238     IF PB-REISSUED-CERT       OR
 13239        PB-POLICY-IS-DECLINED  OR
 13240        PB-POLICY-IS-VOIDED
 13241         GO TO 3139-EDIT-COVERAGE-CODES.
 13242
 13243     MOVE SPACE                  TO WS-2671-SW
 13244                                    WS-2672-SW.
 13245
 13246     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13247         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13248             MOVE ER-2703        TO WS-ERROR
 13249             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 241
* EL050.cbl
 13250             GO TO 3139-EDIT-COVERAGE-CODES.
 13251
 13252     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13253         GO TO 3139-EDIT-COVERAGE-CODES.
 13254
 13255     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13256     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13257*    MOVE '1'                    TO DC-OPTION-CODE.
 13258     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13259     MOVE +0                     TO DC-ELAPSED-MONTHS
 13260                                    DC-ELAPSED-DAYS.
 13261     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13262
 13263     IF DATE-CONVERSION-ERROR
 13264         GO TO 3139-EDIT-COVERAGE-CODES.
 13265
 13266     IF DC-ELAPSED-DAYS GREATER +180
 13267         MOVE ER-2672            TO WS-ERROR
 13268         MOVE 'Y'                TO WS-2672-SW
 13269         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13270     END-IF
 13271
 13272     IF WS-ERROR = ER-2671  AND
 13273        PB-COMPANY-ID  = 'LBL'
 13274        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13275        MOVE SPACE               TO WS-2671-SW
 13276        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13277
 13278     IF PB-ISSUE-DATE-FORCED  AND
 13279      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13280         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13281         MOVE ER-2673            TO WS-ERROR
 13282         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13283         MOVE SPACE              TO WS-2671-SW
 13284                                    WS-2672-SW.
 13285
 13286     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13287         IF PB-ISSUE-DATE-FORCED
 13288             MOVE ER-2600          TO  WS-ERROR
 13289             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13290         ELSE
 13291             MOVE ER-2692          TO  WS-ERROR
 13292             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13293
 13294
 13295 3139-EDIT-COVERAGE-CODES.
 13296
 13297     if pb-company-id not = 'AHL'
 13298        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13299           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13300           MOVE ER-2787          TO WS-ERROR
 13301           PERFORM 9900-ERROR-FORMAT
 13302                                 THRU 9900-EXIT
 13303        END-IF
 13304     end-if
 13305     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13306        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13307                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 242
* EL050.cbl
 13308           MOVE ER-2719          TO WS-ERROR
 13309           PERFORM 9900-ERROR-FORMAT
 13310                                 THRU 9900-EXIT
 13311        END-IF
 13312     END-IF
 13313
 13314     IF PB-POLICY-IS-DECLINED  OR
 13315        PB-POLICY-IS-VOIDED
 13316         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13317
 13318     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13319        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13320         MOVE ER-2630                TO WS-ERROR
 13321         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13322
 13323     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13324        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13325        PB-I-LF-PREMIUM-AMT = ZERO
 13326         GO TO 3140-CHECK-AH-FOR-ZERO.
 13327
 13328     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13329        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13330        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13331         GO TO 3140-CHECK-AH-FOR-ZERO.
 13332
 13333     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13334        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13335        MOVE ER-2631             TO WS-ERROR
 13336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13337     END-IF
 13338
 13339
 13340******************************************************************
 13341*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13342******************************************************************
 13343
 13344     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13345        NEXT SENTENCE
 13346     ELSE
 13347        IF PB-I-LF-BENEFIT-AMT = ZERO
 13348           MOVE ER-2632             TO WS-ERROR
 13349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13350
 13351
 13352******************************************************************
 13353*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13354******************************************************************
 13355
 13356     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13357        CONTINUE
 13358     ELSE
 13359        IF PB-I-LF-PREMIUM-AMT = ZERO
 13360           IF (NOT PB-COMP-LF-PREM)
 13361              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13362              and (ws-lf-ben-category not = 'C')
 13363              MOVE ER-2633       TO WS-ERROR
 13364              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13365           END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 243
* EL050.cbl
 13366        END-IF
 13367     END-IF
 13368     .
 13369 3140-CHECK-AH-FOR-ZERO.
 13370
 13371     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13372        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13373        PB-I-AH-PREMIUM-AMT = ZERO
 13374         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13375
 13376     IF PB-COMPANY-ID = 'CSL'  AND
 13377        PB-I-AH-BENEFIT-CD = ZERO  AND
 13378        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13379        PB-I-AH-PREMIUM-AMT = ZERO
 13380         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13381
 13382     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13383        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13384        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13385         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13386
 13387     IF PB-I-AH-BENEFIT-CD = ZERO
 13388         MOVE ER-2634            TO WS-ERROR
 13389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13390
 13391******************************************************************
 13392*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13393******************************************************************
 13394
 13395     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13396        NEXT SENTENCE
 13397     ELSE
 13398        IF PB-I-AH-BENEFIT-AMT = ZERO
 13399           MOVE ER-2635             TO WS-ERROR
 13400           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13401
 13402******************************************************************
 13403*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13404******************************************************************
 13405
 13406     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13407        NEXT SENTENCE
 13408     ELSE
 13409        IF PB-I-AH-PREMIUM-AMT = ZERO
 13410            IF NOT PB-COMP-AH-PREM
 13411                MOVE ER-2636    TO WS-ERROR
 13412                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13413
 13414
 13415 3140-EDIT-MAX-AMT-SIZES.
 13416* CUSTOM CODE FOR CLIENT    'DMD'
 13417     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13418                                     WS-RES-MUNI-TAX
 13419                                     PB-I-STATE-TAX
 13420                                     PB-I-MUNI-TAX.
 13421
 13422     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13423
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 244
* EL050.cbl
 13424     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13425        GO TO 3150-RATE-OUTSTAND-BAL.
 13426
 13427     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13428        GO TO 3150-RATE-OUTSTAND-BAL.
 13429
 13430     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13431        GO TO 3150-RATE-OUTSTAND-BAL.
 13432
 13433     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13434                             OR 'RIC')
 13435        GO TO 3150-RATE-OUTSTAND-BAL.
 13436
 13437     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13438        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13439            GO TO 3150-RATE-OUTSTAND-BAL
 13440        ELSE
 13441           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13442               GO TO 3150-RATE-OUTSTAND-BAL.
 13443
 13444     IF NOT PB-NO-MONTHS-SKIPPED
 13445        GO TO 3150-RATE-OUTSTAND-BAL.
 13446
 13447     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13448        GO TO 3150-RATE-OUTSTAND-BAL.
 13449
 13450     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13451        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13452           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13453             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13454           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13455           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13456              MOVE ER-2693     TO WS-ERROR
 13457              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13458              GO TO 3150-RATE-OUTSTAND-BAL
 13459           ELSE
 13460              GO TO 3150-RATE-OUTSTAND-BAL.
 13461
 13462 3150-RATE-OUTSTAND-BAL.
 13463
 13464* DMD RATING TEST
 13465     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13466         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13467         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13468         MOVE ER-2687                 TO WS-ERROR
 13469         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13470         MOVE 'B'                     TO PB-I-OB-FLAG
 13471         GO TO 3260-EDIT-CONTINUE.
 13472
 13473     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13474         IF  WS-ERROR    EQUAL    ER-2693
 13475             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13476                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13477                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13478                 MOVE  +0            TO  WS-ERROR.
 13479
 13480     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13481         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 245
* EL050.cbl
 13482             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13483                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13484                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13485                 MOVE  +0            TO  WS-ERROR.
 13486
 13487     IF PLAN-MASTER-AH-SW = 'Y'
 13488        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13489            IF  WS-ERROR    EQUAL    ER-2693
 13490              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13491                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13492                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13493                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13494                 MOVE  ER-1910           TO  WS-ERROR
 13495                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13496
 13497     IF PLAN-MASTER-AH-SW = 'Y'
 13498        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13499            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13500               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13501               MOVE  ER-1910           TO  WS-ERROR
 13502               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13503
 13504     IF PLAN-MASTER-AH-SW = 'Y'
 13505        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13506            IF  WS-ERROR    EQUAL    ER-2693
 13507                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13508                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13509                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13510                 MOVE  +0       TO  WS-ERROR.
 13511
 13512     IF WS-ERROR = ER-2693
 13513        IF PB-COMPANY-ID = 'JAL' AND
 13514           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13515           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13516           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13517
 13518     IF WS-ERROR = ER-2693
 13519        IF PB-COMPANY-ID = 'NCL'  AND
 13520           PB-I-AH-BENEFIT-CD = 'OA'
 13521           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13522           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13523
 13524     IF WS-ERROR = ER-2693
 13525        IF PB-COMPANY-ID = 'CNL' AND
 13526           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13527           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13528           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13529
 13530     IF WS-ERROR = ER-2693
 13531        IF PB-COMPANY-ID = 'HER'
 13532           IF WS-LEVEL
 13533              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13534              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13535
 13536     IF ((LF-BENEFIT-FOUND) AND
 13537         (NOT NO-LIFE-COVERAGE)  AND
 13538         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13539       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 246
* EL050.cbl
 13540             (NOT NO-AH-COVERAGE)    AND
 13541             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13542         NEXT SENTENCE
 13543     ELSE
 13544         GO TO 3215-EDIT-RATES.
 13545
 13546     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13547        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13548           MOVE ER-2674          TO WS-ERROR
 13549           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13550           GO TO 3215-EDIT-RATES.
 13551
 13552     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13553        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13554           MOVE ER-2674          TO WS-ERROR
 13555           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13556           GO TO 3215-EDIT-RATES.
 13557
 13558     MOVE 'B'                    TO PB-I-OB-FLAG.
 13559
 13560     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13561         NEXT SENTENCE
 13562     ELSE
 13563         IF NOT NO-LIFE-COVERAGE
 13564             IF WS-ACCT-LF-OB-RT = ZERO
 13565                MOVE ER-2641    TO WS-ERROR
 13566                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13567
 13568     IF PB-COMPANY-ID = 'CRI'
 13569       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13570         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13571         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13572         IF WS-ERROR = ER-2675
 13573            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13574            MOVE ER-2687              TO WS-ERROR
 13575            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13576         ELSE
 13577            MOVE ER-2687              TO WS-ERROR
 13578            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13579
 13580
 13581     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13582         NEXT SENTENCE
 13583     ELSE
 13584       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13585            NEXT SENTENCE
 13586       ELSE
 13587         IF NOT NO-AH-COVERAGE
 13588             IF WS-ACCT-AH-OB-RT = ZERO
 13589                MOVE ER-2642    TO WS-ERROR
 13590                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13591
 13592     IF PB-COMPANY-ID = 'CRI'
 13593       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13594         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13595         IF WS-ERROR = ER-2676
 13596            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13597            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 247
* EL050.cbl
 13598            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13599         ELSE
 13600            MOVE ER-2687              TO WS-ERROR
 13601            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13602
 13603     IF PB-COMPANY-ID NOT = 'GIC'
 13604         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13605            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13606     ELSE
 13607         IF PB-I-LF-PREM-CALC = ZEROS
 13608             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13609                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13610
 13611     IF PB-COMPANY-ID NOT = 'GIC'
 13612         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13613            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13614     ELSE
 13615         IF PB-I-AH-PREM-CALC = ZEROS
 13616             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13617                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13618
 13619     MOVE ZEROS TO PB-I-MORT-CODE.
 13620
 13621     GO TO 3260-EDIT-CONTINUE.
 13622
 13623
 13624 3215-EDIT-RATES.
 13625     IF ACCOUNT-MAST-FOUND
 13626         NEXT SENTENCE
 13627     ELSE
 13628         GO TO 3999-END-EDIT.
 13629
 13630 3220-CHECK-LF-RATES.
 13631
 13632     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13633        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13634        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13635        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13636           AND (NOT WS-LF-CASH))
 13637                           OR
 13638           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13639           AND (NOT WS-AH-CASH)))
 13640                       AND
 13641           (PB-I-ENTRY-STATUS NOT = '5')
 13642           MOVE 'M'              TO PB-BATCH-ENTRY
 13643                                    PB-I-ENTRY-STATUS
 13644        END-IF
 13645     END-IF
 13646     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13647                                    PB-I-AH-PREM-CALC
 13648                                    PB-I-LF-ALT-PREM-CALC
 13649                                    PB-I-LF-ALT-RATE
 13650                                    PB-I-LF-REI-RATE
 13651                                    PB-I-LF-ALT-REI-RATE
 13652                                    PB-I-AH-REI-RATE
 13653                                    PB-I-TOT-FEES-CALC.
 13654
 13655     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 248
* EL050.cbl
 13656        NEXT SENTENCE
 13657     ELSE
 13658        MOVE ZEROS               TO PB-I-LF-RATE
 13659                                    PB-I-AH-RATE.
 13660
 13661     IF PB-I-TOT-FEES NOT NUMERIC
 13662        MOVE ZEROS               TO PB-I-TOT-FEES
 13663     END-IF
 13664     IF PB-I-LIVES NOT NUMERIC
 13665         MOVE ZERO               TO PB-I-LIVES.
 13666
 13667     IF PB-I-NUM-BILLED NOT NUMERIC
 13668         MOVE ZERO               TO PB-I-NUM-BILLED.
 13669
 13670     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13671        MOVE +0                  TO PB-I-LF-PREM-TAX
 13672     END-IF
 13673
 13674     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13675        MOVE +0                  TO PB-I-AH-PREM-TAX
 13676     END-IF
 13677
 13678     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13679        PB-I-PAY-FREQUENCY = ZEROS
 13680            MOVE 12 TO CP-PAY-FREQUENCY
 13681     ELSE
 13682            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13683
 13684     IF PB-I-STATE-TAX NOT NUMERIC
 13685         MOVE ZEROS               TO PB-I-STATE-TAX.
 13686
 13687     IF PB-I-MUNI-TAX NOT NUMERIC
 13688         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13689
 13690     MOVE SPACES                 TO CP-BEN-CATEGORY
 13691     IF PB-COMPANY-ID  = 'CSL'  AND
 13692        PB-I-LF-TERM NOT = ZERO
 13693        COMPUTE WS-PAYMENT-AMT =
 13694             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13695        COMPUTE WS-CSL-AMT1 =
 13696             PB-I-LF-TERM * AM-MAX-MON-BEN
 13697        COMPUTE WS-CSL-AMT2 =
 13698             WS-PAYMENT-AMT * PB-I-LF-TERM
 13699        IF CP-PAY-FREQUENCY NOT = 12
 13700           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13701           MOVE '8' TO WS-CSL-CALC-CD
 13702        ELSE
 13703           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13704              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13705               AM-MAX-TOT-BEN
 13706               MOVE '6' TO WS-CSL-CALC-CD
 13707           ELSE
 13708              IF (WS-CSL-AMT1  GREATER THAN
 13709                 AM-MAX-TOT-BEN) AND
 13710                 (WS-CSL-AMT2  GREATER THAN
 13711                 AM-MAX-TOT-BEN)
 13712                 MOVE '7' TO WS-CSL-CALC-CD
 13713              ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 249
* EL050.cbl
 13714                 MOVE '5' TO WS-CSL-CALC-CD.
 13715
 13716     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13717         NEXT SENTENCE
 13718     ELSE
 13719         GO TO 3300-CHECK-AH-RATES.
 13720
 13721*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13722
 13723     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13724        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13725              OR
 13726           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13727           MOVE ER-2618          TO WS-ERROR
 13728           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13729           GO TO 3300-CHECK-AH-RATES.
 13730
 13731     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13732           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13733                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13734
 13735     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13736         MOVE ER-2687             TO WS-ERROR
 13737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13738         MOVE 'Z000'              TO PB-I-MORT-CODE
 13739         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13740         GO TO 3300-CHECK-AH-RATES.
 13741
 13742     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13743        IF PB-I-LIVES = ZERO
 13744           MOVE ER-2688          TO WS-ERROR
 13745           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13746
 13747     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13748
 13749     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13750     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13751     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13752     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13753     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13754     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13755     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13756     MOVE '3'                    TO CP-PROCESS-TYPE.
 13757     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13758     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13759
 13760******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13761     IF PB-COMPANY-ID EQUAL 'CDL'
 13762         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13763            CP-EARN-AS-NET-PAY)
 13764             IF PB-CERT-EFF-DT GREATER  WS-931231
 13765                 MOVE '1'        TO CP-EARNING-METHOD.
 13766*******
 13767
 13768     MOVE PB-SV-STATE            TO CP-STATE.
 13769     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13770     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13771     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 250
* EL050.cbl
 13772     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13773     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13774                                    CP-RATING-BENEFIT-AMT.
 13775     IF CP-STATE-STD-ABBRV = 'OR'
 13776         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13777                                         PB-I-LF-ALT-BENEFIT-AMT.
 13778     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13779     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13780     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13781     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13782     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13783     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13784     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13785     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13786     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13787                                    CP-REMAINING-TERM
 13788                                    CP-LOAN-TERM.
 13789
 13790     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13791         NEXT SENTENCE
 13792     ELSE
 13793         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13794             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13795                                           PB-I-LF-PREMIUM-AMT.
 13796
 13797     IF PB-COMPANY-ID EQUAL 'CSL'
 13798        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13799           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13800                                         PB-I-LF-PREMIUM-AMT.
 13801
 13802     IF PB-COMPANY-ID EQUAL 'NCB'
 13803         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13804            CP-EARN-AS-NET-PAY
 13805             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13806                 PB-I-LF-PREMIUM-AMT.
 13807
 13808     IF (CP-TRUNCATED-LIFE)
 13809        or ((pb-company-id = 'AHL')
 13810           and (pb-i-loan-term > pb-i-lf-term))
 13811        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13812
 13813     IF PB-COMPANY-ID EQUAL 'CRI'
 13814        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13815
 13816     IF CP-TERM-IS-DAYS
 13817         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13818     ELSE
 13819         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13820     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13821        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13822        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13823        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13824        IF WS-LF-BEN-CATEGORY = 'D'
 13825           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13826           MOVE PB-I-LIFE-COMMISSION
 13827                                 TO CP-DCC-ACT-COMM
 13828           MOVE WS-LF-BEN-CATEGORY
 13829                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 251
* EL050.cbl
 13830        END-IF
 13831        IF (CP-BENEFIT-CD (1:1) = 'P')
 13832           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13833           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13834           add pb-i-ah-premium-amt to cp-original-premium
 13835        END-IF
 13836     END-IF
 13837     IF PB-COMPANY-ID = 'CSL'
 13838         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13839         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13840         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13841
 13842     IF PB-COMPANY-ID = 'CSL'
 13843        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13844
 13845     IF (CP-SPECIAL-CALC-CD = 'H')
 13846        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13847         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13848                                    TO CP-ALTERNATE-BENEFIT
 13849         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13850     if (pb-company-id = 'CID')
 13851        and (ws-lf-earnings-calc = '4')
 13852        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13853        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13854        move pb-i-term-type      to cp-pmt-mode
 13855        move pb-i-no-of-payments to cp-no-of-pmts
 13856     end-if
 13857     move ws-net-only-state      to cp-net-only-state
 13858     IF (PB-COMPANY-ID = 'CID')
 13859        AND (WS-LF-EARNINGS-CALC = 'B')
 13860        AND (CP-STATE-STD-ABBRV = 'MN')
 13861        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13862                                 TO CP-ALTERNATE-BENEFIT
 13863        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13864     END-IF
 13865     IF (PB-COMPANY-ID = 'CID')
 13866        AND (WS-LF-EARNINGS-CALC = 'B')
 13867        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13868                                 TO CP-ALTERNATE-BENEFIT
 13869        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13870        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13871*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13872*         pb-i-lf-alt-premium-amt
 13873        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13874        IF WS-LF-BEN-CATEGORY = 'P'
 13875           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13876        ELSE
 13877           IF WS-LF-BEN-CATEGORY = 'I'
 13878              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13879           END-IF
 13880        END-IF
 13881     END-IF
 13882     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13883     MOVE 'R'                   TO CP-RATE-FILE.
 13884     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13885
 13886     IF CP-ERROR-RATE-NOT-FOUND
 13887        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 252
* EL050.cbl
 13888        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889        GO TO 3300-CHECK-AH-RATES.
 13890
 13891     IF PB-COMPANY-ID EQUAL 'CRI'
 13892        IF CP-ERROR-NO-LIMITS-CRI
 13893           IF NOT ACCOUNT-LIFE-CHECKED
 13894              MOVE ER-2607      TO WS-ERROR
 13895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13896
 13897******************************************************************
 13898*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13899*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13900******************************************************************
 13901
 13902* CALC LIFE AGE AT EXPIRATION.
 13903
 13904     COMPUTE WS-AGE-AT-EXPIRE =
 13905          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13906
 13907*    IF PB-STATE = 'CO' OR 'UT'
 13908*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13909*        MOVE 'F'            TO PB-FATAL-FLAG
 13910*        MOVE ER-2709        TO WS-ERROR
 13911*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13912*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13913
 13914*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13915*        MOVE 'X'            TO PB-FATAL-FLAG
 13916*        MOVE ER-2718        TO WS-ERROR
 13917*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13918*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13919
 13920* CALC A & H AGE AT EXPIRATION.
 13921
 13922     COMPUTE WS-AGE-AT-EXPIRE =
 13923          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13924
 13925*    IF PB-STATE = 'CO' OR 'UT'
 13926*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13927*        MOVE 'F'            TO PB-FATAL-FLAG
 13928*        MOVE ER-2709        TO WS-ERROR
 13929*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13930*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13931
 13932*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13933*        MOVE 'X'            TO PB-FATAL-FLAG
 13934*        MOVE ER-2718        TO WS-ERROR
 13935*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13936*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13937
 13938     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13939        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13940
 13941     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13942        and (not pb-monthly-cert)
 13943        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13944     end-if
 13945
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 253
* EL050.cbl
 13946     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13947        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13948
 13949     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13950         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13951         MOVE ER-2639        TO WS-ERROR
 13952         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13953
 13954
 13955******************************************************************
 13956*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13957******************************************************************
 13958
 13959 PREMIUM-EDITING-IS-BYPASSED.
 13960     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13961        AND (CP-R-MAX-ATT-AGE > +0)
 13962        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13963        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13964           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13965           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13966           MOVE '1'              TO DC-OPTION-CODE
 13967           PERFORM 8500-DATE-CONVERT
 13968                                 THRU 8500-EXIT
 13969           IF NO-CONVERSION-ERROR
 13970              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13971                 MOVE ER-2661       TO WS-ERROR
 13972*                PERFORM 9900-ERROR-FORMAT
 13973*                                THRU 9900-EXIT
 13974              END-IF
 13975           END-IF
 13976        ELSE
 13977           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13978           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13979              MOVE ER-2661       TO WS-ERROR
 13980*             PERFORM 9900-ERROR-FORMAT
 13981*                                THRU 9900-EXIT
 13982           ELSE
 13983              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13984                 MOVE ER-1570    TO WS-ERROR
 13985                 PERFORM 9900-ERROR-FORMAT
 13986                                 THRU 9900-EXIT
 13987              END-IF
 13988           END-IF
 13989        END-IF
 13990        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13991           MOVE PB-I-JOINT-BIRTHDAY
 13992                                 TO DC-BIN-DATE-1
 13993           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13994           MOVE '1'              TO DC-OPTION-CODE
 13995           PERFORM 8500-DATE-CONVERT
 13996                                 THRU 8500-EXIT
 13997           IF NO-CONVERSION-ERROR
 13998              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13999                 MOVE ER-2661       TO WS-ERROR
 14000*                PERFORM 9900-ERROR-FORMAT
 14001*                                THRU 9900-EXIT
 14002              END-IF
 14003           ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 254
* EL050.cbl
 14004              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14005           END-IF
 14006        ELSE
 14007           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14008             (PB-I-LF-TERM / 12)
 14009           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14010              MOVE ER-2661       TO WS-ERROR
 14011*             PERFORM 9900-ERROR-FORMAT
 14012*                                THRU 9900-EXIT
 14013           ELSE
 14014              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14015                 MOVE ER-1571    TO WS-ERROR
 14016                 PERFORM 9900-ERROR-FORMAT
 14017                                 THRU 9900-EXIT
 14018              END-IF
 14019           END-IF
 14020        END-IF
 14021        IF WS-ERROR = ER-2661
 14022           PERFORM 9900-ERROR-FORMAT
 14023                                 THRU 9900-EXIT
 14024        END-IF
 14025     END-IF
 14026*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14027*       MOVE ER-2661             TO WS-ERROR
 14028*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14029
 14030     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14031        MOVE ER-2662             TO WS-ERROR
 14032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14033
 14034     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14035        MOVE ER-2677             TO WS-ERROR
 14036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14037
 14038     IF CP-ERROR-LOAN-TERM
 14039        MOVE ER-2648             TO WS-ERROR
 14040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14041
 14042 3221-CHECK-ERROR-RATE-OPEN.
 14043
 14044     IF CP-ERROR-RATE-FILE-NOTOPEN
 14045         GO TO 3990-FILES-NOT-OPEN.
 14046
 14047     IF PB-COMPANY-ID NOT = 'DMD'
 14048        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14049     END-IF
 14050     .
 14051 3221-CONTINUE.
 14052     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14053                                    WS-DCC-AH-RATE
 14054     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14055        IF WS-LF-BEN-CATEGORY = 'D'
 14056           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14057              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14058        END-IF
 14059     END-IF
 14060     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14061*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 255
* EL050.cbl
 14062     IF (PB-COMPANY-ID = 'CID')
 14063        AND (WS-LF-EARNINGS-CALC = 'B')
 14064        AND (CP-STATE-STD-ABBRV = 'MN')
 14065        AND (PB-CERT-EFF-DT > X'A4FF')
 14066        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14067     END-IF
 14068     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14069
 14070     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14071     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14072        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14073        AND (PB-I-POLICY-IS-MONTHLY)
 14074        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14075        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14076     END-IF
 14077     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14078     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14079     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14080     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14081     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14082        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14083        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14084        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14085        MOVE ER-2786             TO WS-ERROR
 14086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14087     END-IF
 14088
 14089     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14090
 14091******************************************************************
 14092*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14093******************************************************************
 14094     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14095        and ((not pb-monthly-cert)
 14096        or (ws-lf-ben-category = 'C'))
 14097        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14098
 14099     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14100        GO TO 3225-CHECK-ALT-LIFE-RATE
 14101     ELSE
 14102       IF PB-I-LF-RATE = ZERO
 14103          MOVE ER-2641          TO WS-ERROR
 14104          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14105
 14106 3225-CHECK-ALT-LIFE-RATE.
 14107
 14108     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14109        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14110        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14111         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14112
 14113     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14114         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14115             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14116                   OR
 14117              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14118              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14119              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 256
* EL050.cbl
 14120             MOVE ER-2720        TO  WS-ERROR
 14121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14122             GO TO 3225-RATING-CONT
 14123         ELSE
 14124             GO TO 3225-RATING-CONT.
 14125     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14126        AND (AM-GPCD = 01 OR 06 OR 15)
 14127        MOVE ER-2798             TO WS-ERROR
 14128        PERFORM 9900-ERROR-FORMAT
 14129                                 THRU 9900-EXIT
 14130*       GO TO 3225-RATING-CONT
 14131     END-IF
 14132     if (pb-company-id = 'CID')
 14133        and (ws-lf-earnings-calc = 'B')
 14134        and (ws-lf-ben-category = 'P' or 'I')
 14135        and (ws-net-only-state = 'Y')
 14136        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14137        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14138        go to 3225-rating-cont
 14139     end-if
 14140     IF (PB-COMPANY-ID = 'CID')
 14141        AND (WS-LF-EARNINGS-CALC = 'B')
 14142        AND (CP-STATE-STD-ABBRV = 'MN')
 14143        AND (PB-CERT-EFF-DT > X'A4FF')
 14144        GO TO 3225-RATING-CONT
 14145     END-IF
 14146     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14147        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14148           AND (PB-I-POLICY-IS-MONTHLY)
 14149           GO TO 3225-RATING-CONT
 14150        END-IF
 14151     END-IF
 14152
 14153     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14154        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14155        CP-EARN-AS-REG-BALLOON
 14156        NEXT SENTENCE
 14157     ELSE
 14158        MOVE '2'                 TO CP-EARNING-METHOD.
 14159
 14160 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14161
 14162     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14163
 14164     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14165        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14166        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14167         NEXT SENTENCE
 14168     ELSE
 14169         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14170
 14171     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14172     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14173     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14174                                     CP-RATING-BENEFIT-AMT.
 14175     IF CP-STATE-STD-ABBRV = 'OR'
 14176         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14177                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 257
* EL050.cbl
 14178     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14179        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14180     END-IF
 14181     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14182     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14183     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14184                                    CP-REMAINING-TERM
 14185                                    CP-LOAN-TERM.
 14186     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14187        ADD +1                   TO CP-ORIGINAL-TERM
 14188                                    CP-REMAINING-TERM
 14189                                    CP-LOAN-TERM.
 14190
 14191     MOVE 'R'                   TO CP-RATE-FILE.
 14192     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14193
 14194     IF CP-ERROR-RATE-NOT-FOUND
 14195         MOVE ER-2641            TO WS-ERROR
 14196         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14197         GO TO 3300-CHECK-AH-RATES.
 14198
 14199     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14200     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14201
 14202     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14203         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14204
 14205     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14206                               + PB-I-LF-ALT-BENEFIT-AMT.
 14207
 14208     IF ACCOUNT-LIFE-CHECKED  OR
 14209        PB-POLICY-IS-VOIDED   OR
 14210        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14211        and (not pb-monthly-cert))
 14212        GO TO 3225-CONTINUE.
 14213
 14214     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14215        GO TO 3225-CONTINUE.
 14216
 14217     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14218                             EC-RT-LF-MAX-TOT-BEN
 14219        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14220        MOVE ER-2639       TO WS-ERROR
 14221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14222
 14223 3225-CONTINUE.
 14224     IF PB-I-LF-ALT-RATE = ZERO
 14225         MOVE ER-2659            TO WS-ERROR
 14226         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14227
 14228     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14229        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14230        MOVE ER-2698             TO WS-ERROR
 14231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14232
 14233 3225-RATING-CONT.
 14234
 14235     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 258
* EL050.cbl
 14236        and (not pb-monthly-cert)
 14237         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14238         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14239         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14240            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14241            CONTINUE
 14242         ELSE
 14243            MOVE ER-2687         TO WS-ERROR
 14244            PERFORM 9900-ERROR-FORMAT
 14245                                 THRU 9900-EXIT
 14246         END-IF
 14247         GO TO 3290-EDIT-LF-REIN-RATE
 14248     END-IF
 14249
 14250* DMD RATING TEST
 14251     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14252         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14253         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14254         MOVE ER-2687                 TO WS-ERROR
 14255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14256         GO TO 3290-EDIT-LF-REIN-RATE.
 14257
 14258 3230-CLIENT-MORT-CD-SPECIALS.
 14259
 14260     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14261     SET BIN-TO-GREG          TO TRUE.
 14262*    MOVE ' '                 TO DC-OPTION-CODE.
 14263     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14264     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14265
 14266 C-POS-3230-MORT-CD.
 14267     IF PB-COMPANY-ID = 'POS' AND
 14268        PB-SV-CARRIER = '2'
 14269         NEXT SENTENCE
 14270     ELSE
 14271         GO TO C-POS-3240-MORT-CD.
 14272
 14273     IF PB-SV-GROUPING = '030'
 14274        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14275         MOVE '2350' TO PB-I-MORT-CODE
 14276      ELSE
 14277         MOVE '3300' TO PB-I-MORT-CODE.
 14278
 14279
 14280 C-POS-3240-MORT-CD.
 14281     IF PB-COMPANY-ID = 'POS' AND
 14282        PB-SV-CARRIER = '1'
 14283         NEXT SENTENCE
 14284     ELSE
 14285         GO TO 3230-CONTINUE.
 14286
 14287     IF PB-SV-STATE = '45' OR '47'
 14288        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14289         MOVE '5200' TO PB-I-MORT-CODE
 14290     ELSE
 14291         MOVE '8300' TO PB-I-MORT-CODE.
 14292
 14293 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 259
* EL050.cbl
 14294
 14295     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14296        GO TO 3240-CONTINUE
 14297     END-IF
 14298
 14299     IF PB-CERT-EFF-DT > WS-971231
 14300        GO TO 3240-CONTINUE
 14301     END-IF
 14302
 14303     IF LF-BENEFIT-FOUND AND
 14304        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14305         MOVE 'F250'       TO PB-I-MORT-CODE
 14306     ELSE
 14307         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14308             MOVE '7250'   TO PB-I-MORT-CODE
 14309         ELSE
 14310             MOVE '4251'   TO PB-I-MORT-CODE
 14311         END-IF
 14312     END-IF
 14313
 14314     .
 14315 3240-CONTINUE.
 14316
 14317     IF PB-COMPANY-ID NOT = 'GNL'
 14318         GO TO 3256-CONTINUE.
 14319
 14320     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14321         MOVE 'A300' TO PB-I-MORT-CODE
 14322     ELSE
 14323         MOVE '8350' TO PB-I-MORT-CODE.
 14324
 14325 3256-CONTINUE.
 14326     IF PB-COMPANY-ID NOT = 'ABL'
 14327         GO TO 3260-EDIT-CONTINUE.
 14328
 14329     IF PB-I-LF-TERM GREATER THAN 59
 14330         MOVE 'F550' TO PB-I-MORT-CODE
 14331     ELSE
 14332         MOVE 'E550' TO PB-I-MORT-CODE.
 14333
 14334 3260-EDIT-CONTINUE.
 14335     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14336
 14337 3290-EDIT-LF-REIN-RATE.
 14338     IF LF-REIN-NSP-NOT-USED
 14339         GO TO 3290-RATING-CONT.
 14340
 14341     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14342        GO TO 3290-RATING-CONT.
 14343     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14344     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14345     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14346     MOVE '3'                   TO CP-PROCESS-TYPE.
 14347     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14348
 14349******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14350     IF PB-COMPANY-ID EQUAL 'CDL'
 14351         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 260
* EL050.cbl
 14352            CP-EARN-AS-NET-PAY)
 14353             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14354*            MOVE SPACE          TO DC-OPTION-CODE
 14355             SET BIN-TO-GREG     TO TRUE
 14356             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14357***  Y2K PROJ 7744
 14358             IF DC-GREG-DATE-CYMD GREATER 19931231
 14359                 MOVE '1'        TO CP-EARNING-METHOD.
 14360***  Y2K PROJ 7744
 14361*******
 14362
 14363     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14364     MOVE PB-SV-STATE           TO CP-STATE.
 14365     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14366     MOVE ZERO                  TO CP-DEVIATION-CODE
 14367                                   CP-RATE-DEV-PCT.
 14368     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14369     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14370                                   CP-RATING-BENEFIT-AMT.
 14371
 14372************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14373     IF PB-COMPANY-ID EQUAL 'NCB'
 14374         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14375            CP-EARN-AS-NET-PAY
 14376             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14377                 PB-I-LF-PREMIUM-AMT.
 14378************
 14379
 14380     IF CP-STATE-STD-ABBRV = 'OR'
 14381         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14382                                         PB-I-LF-ALT-BENEFIT-AMT.
 14383     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14384     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14385     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14386     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14387     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14388     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14389     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14390     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14391                                   CP-REMAINING-TERM
 14392                                   CP-LOAN-TERM.
 14393     IF CP-TRUNCATED-LIFE
 14394        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14395
 14396     IF CP-TERM-IS-DAYS
 14397         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14398     ELSE
 14399         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14400
 14401     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14402        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14403     END-IF
 14404     IF PB-COMPANY-ID NOT = 'TIC'
 14405          MOVE ZERO          TO CP-CLASS-CODE.
 14406
 14407     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14408
 14409     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 261
* EL050.cbl
 14410     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14411
 14412     IF CP-ERROR-RATE-NOT-FOUND
 14413        IF PB-I-OB
 14414           MOVE ER-2625      TO WS-ERROR
 14415           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14416           GO TO 3299-EDIT-CONTINUE
 14417        ELSE
 14418           MOVE ER-2643      TO WS-ERROR
 14419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14420           GO TO 3299-EDIT-CONTINUE.
 14421
 14422     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14423
 14424     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14425     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14426
 14427     IF PB-I-LF-REI-RATE = ZERO
 14428         MOVE ER-2643        TO WS-ERROR
 14429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14430
 14431 3290-CHECK-ALT-REIN-RATE.
 14432
 14433     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14434        GO TO 3290-RATING-CONT.
 14435
 14436     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14437     MOVE '2'                    TO CP-EARNING-METHOD.
 14438     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14439     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14440     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14441     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14442                                     CP-RATING-BENEFIT-AMT.
 14443     IF CP-STATE-STD-ABBRV = 'OR'
 14444         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14445                                         PB-I-LF-ALT-BENEFIT-AMT.
 14446     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14447        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14448     END-IF
 14449     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14450     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14451     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14452                                    CP-REMAINING-TERM
 14453                                    CP-LOAN-TERM.
 14454     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14455        ADD +1                   TO CP-ORIGINAL-TERM
 14456                                    CP-REMAINING-TERM
 14457                                    CP-LOAN-TERM.
 14458
 14459     MOVE 'R'                   TO CP-RATE-FILE.
 14460     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14461
 14462     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14463
 14464     IF PB-I-LF-ALT-REI-RATE = ZERO
 14465         MOVE ER-2643            TO WS-ERROR
 14466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14467
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 262
* EL050.cbl
 14468 3290-RATING-CONT.
 14469
 14470     IF PB-I-OB
 14471*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14472        GO TO 3300-CHECK-AH-RATES.
 14473
 14474 3299-EDIT-CONTINUE.
 14475
 14476     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14477         NEXT SENTENCE
 14478     ELSE
 14479         MOVE ER-2620           TO WS-ERROR
 14480         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14481
 14482 3300-CHECK-AH-RATES.
 14483     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14484         NEXT SENTENCE
 14485     ELSE
 14486         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14487
 14488     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14489        and (not pb-monthly-cert))
 14490                  or
 14491        ((CF-COMPANY-ID = 'DMD') AND
 14492                (NO-DMD-RATING))
 14493         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14494            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14495            CONTINUE
 14496         ELSE
 14497            MOVE ER-2687         TO WS-ERROR
 14498            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14499         END-IF
 14500         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14501         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14502     END-IF
 14503
 14504     IF PB-I-OB
 14505        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14506
 14507     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14508         MOVE ER-2687             TO WS-ERROR
 14509         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14510         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14511         GO TO 3999-END-EDIT.
 14512
 14513*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14514     if pb-company-id = 'AHL'
 14515        go to 3300-skip-crit-per
 14516     end-if
 14517     if (pb-i-ah-crit-per not = zeros)
 14518        and (ws-ah-special-calc-cd not = 'C')
 14519        MOVE ER-1572             TO WS-ERROR
 14520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14521        go to 3300-skip-crit-per
 14522     END-IF
 14523     if (pb-company-id = 'DCC' or 'VPP')
 14524        and (am-dcc-product-code not = spaces)
 14525        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 263
* EL050.cbl
 14526     end-if
 14527     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14528        IF PB-I-AH-CRIT-PER = ZERO
 14529           move ws-ah-max-bens   to pb-i-ah-crit-per
 14530*          MOVE ER-2618       TO WS-ERROR
 14531*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14532*          GO TO 3999-END-EDIT
 14533        END-IF
 14534     END-IF
 14535     if (ws-ah-special-calc-cd = 'C')
 14536        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14537        MOVE ER-1576             TO WS-ERROR
 14538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14539     end-if
 14540
 14541     .
 14542 3300-skip-crit-per.
 14543     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14544     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14545     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14546     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14547     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14548     MOVE PB-SV-STATE            TO CP-STATE.
 14549     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14550     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14551     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14552*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14553     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14554     MOVE '3'                    TO CP-PROCESS-TYPE.
 14555     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14556     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14557                                    CP-RATING-BENEFIT-AMT.
 14558     IF PB-COMPANY-ID = 'CID'
 14559               OR
 14560        CP-STATE-STD-ABBRV = 'OR'
 14561         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14562                                         PB-I-AH-TERM.
 14563     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14564        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14565           AND (PB-I-POLICY-IS-MONTHLY)
 14566           MOVE PB-I-LF-BENEFIT-AMT
 14567                                 TO CP-NET-BENEFIT-AMT
 14568           move pb-i-ah-premium-amt to cp-original-premium
 14569           add pb-i-lf-premium-amt to cp-original-premium
 14570        END-IF
 14571     END-IF
 14572     MOVE SPACES                 TO CP-BEN-CATEGORY
 14573     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14574        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14575        EVALUATE TRUE
 14576           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14577              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14578              MOVE PB-I-LF-BENEFIT-AMT
 14579                                 TO CP-RATING-BENEFIT-AMT
 14580              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14581           WHEN WS-AH-BEN-CATEGORY = 'G'
 14582              MOVE PB-I-UNPAID-CASH-PRICE
 14583                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 264
* EL050.cbl
 14584           WHEN WS-AH-BEN-CATEGORY = 'D'
 14585              MOVE WS-AH-PMF-COMM
 14586                                 TO CP-DCC-PMF-COMM
 14587              MOVE PB-I-AH-COMMISSION
 14588                                 TO CP-DCC-ACT-COMM
 14589        END-EVALUATE
 14590     END-IF
 14591     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14592     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14593     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14594     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14595     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14596     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14597     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14598                                    CP-REMAINING-TERM
 14599                                    WS-WORK-TERM.
 14600     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14601
 14602     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14603     SET BIN-TO-GREG             TO TRUE.
 14604*    MOVE ' '                    TO DC-OPTION-CODE.
 14605     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14606     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14607
 14608     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14609     IF NOT VALID-SKIP-CODE
 14610         MOVE ER-2683            TO WS-ERROR
 14611         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14612         GO TO 3320-RATE-CONTINUE.
 14613
 14614     IF PB-NO-MONTHS-SKIPPED
 14615         GO TO 3320-RATE-CONTINUE.
 14616
 14617     MOVE SPACE TO NUMBER-OF-MONTHS.
 14618
 14619     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14620         MOVE 'S'                TO SK-MO (6).
 14621     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14622         MOVE 'S'                TO SK-MO (7).
 14623     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14624         MOVE 'S'                TO SK-MO (8).
 14625     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14626         MOVE 'S'                TO SK-MO (9).
 14627     IF PB-I-SKIP-CODE = 'A'
 14628         MOVE 'S'                TO SK-MO (10).
 14629
 14630     MOVE 1                      TO SUB2.
 14631     MOVE PB-I-AH-TERM           TO SUB3.
 14632     MOVE WS-MONTH               TO SUB1.
 14633     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14634     GO TO 3320-RATE-CONTINUE.
 14635
 14636 3310-GET-SKIP-MO.
 14637     IF SUB1 = 13
 14638         MOVE 1                  TO SUB1.
 14639
 14640     IF SK-MO (SUB1) = 'S'
 14641         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 265
* EL050.cbl
 14642
 14643     ADD 1 TO SUB2
 14644              SUB1.
 14645
 14646 3320-RATE-CONTINUE.
 14647
 14648     IF WS-WORK-TERM = ZERO
 14649         MOVE 1                  TO WS-WORK-TERM.
 14650
 14651     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14652                                    CP-LOAN-TERM.
 14653
 14654     IF PB-COMPANY-ID EQUAL 'DMD'
 14655         NEXT SENTENCE
 14656     ELSE
 14657         MOVE ZERO               TO PB-I-AH-RATE
 14658                                    PB-I-AH-REI-RATE.
 14659
 14660
 14661     IF PB-COMPANY-ID EQUAL 'CRI'
 14662        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14663
 14664     IF PB-COMPANY-ID = 'CSL'
 14665         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14666         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14667         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14668         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14669
 14670     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14671        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14672           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14673              PB-I-RATE-DEV-PCT-LF
 14674        END-IF
 14675        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14676                                 TO CP-ALTERNATE-BENEFIT
 14677        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14678        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14679        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14680     END-IF
 14681*    if ws-clp-state not = spaces
 14682*       move ws-clp-state to cp-state
 14683*    end-if
 14684     IF (PB-COMPANY-ID = 'CID')
 14685        AND (WS-LF-EARNINGS-CALC = 'B')
 14686        AND (CP-STATE-STD-ABBRV = 'MN')
 14687        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14688     ELSE
 14689        MOVE ' '                 TO CP-AH-BALLOON-SW
 14690     END-IF
 14691     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14692     MOVE 'R'                   TO CP-RATE-FILE.
 14693     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14694
 14695     IF (CP-ERROR-RATE-NOT-FOUND)
 14696        and (not pb-monthly-cert)
 14697        IF PB-I-OB
 14698           MOVE ER-2624          TO WS-ERROR
 14699           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 266
* EL050.cbl
 14700           GO TO 3340-CALCULATE-PREMIUM-AMT
 14701        ELSE
 14702          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14703              NEXT SENTENCE
 14704          ELSE
 14705           MOVE ER-2642          TO WS-ERROR
 14706           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14707           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14708
 14709     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14710        CP-ERROR-DIV-BY-ZERO
 14711           MOVE ER-3782          TO WS-ERROR
 14712           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14713
 14714     IF PB-COMPANY-ID EQUAL 'CRI'
 14715        IF CP-ERROR-NO-LIMITS-CRI
 14716           IF NOT ACCOUNT-AH-CHECKED
 14717              MOVE ER-2607          TO WS-ERROR
 14718              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14719
 14720     IF ACCOUNT-AH-CHECKED
 14721        NEXT SENTENCE
 14722     ELSE
 14723       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14724          MOVE ER-2640           TO WS-ERROR
 14725          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14726
 14727     IF PB-COMPANY-ID = 'CRI'
 14728         IF WS-ERROR = ER-2640
 14729             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14730     IF ACCOUNT-AH-CHECKED
 14731        CONTINUE
 14732     ELSE
 14733        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14734           AND (CP-R-MAX-ATT-AGE > +0)
 14735           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14736           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14737              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14738              MOVE PB-I-AH-EXPIRE-DT
 14739                                 TO DC-BIN-DATE-2
 14740              MOVE '1'           TO DC-OPTION-CODE
 14741              PERFORM 8500-DATE-CONVERT
 14742                                 THRU 8500-EXIT
 14743              IF NO-CONVERSION-ERROR
 14744                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14745                    MOVE ER-2661       TO WS-ERROR
 14746*                   PERFORM 9900-ERROR-FORMAT
 14747*                                THRU 9900-EXIT
 14748                 END-IF
 14749              END-IF
 14750           ELSE
 14751              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14752              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14753                 MOVE ER-2661    TO WS-ERROR
 14754*                PERFORM 9900-ERROR-FORMAT
 14755*                                THRU 9900-EXIT
 14756              ELSE
 14757                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 267
* EL050.cbl
 14758                    MOVE ER-1570 TO WS-ERROR
 14759                    PERFORM 9900-ERROR-FORMAT
 14760                                 THRU 9900-EXIT
 14761                 END-IF
 14762              END-IF
 14763           END-IF
 14764           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14765              MOVE PB-I-JOINT-BIRTHDAY
 14766                                    TO DC-BIN-DATE-1
 14767              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14768              MOVE '1'              TO DC-OPTION-CODE
 14769              PERFORM 8500-DATE-CONVERT
 14770                                    THRU 8500-EXIT
 14771              IF NO-CONVERSION-ERROR
 14772                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14773                    MOVE ER-2661       TO WS-ERROR
 14774*                   PERFORM 9900-ERROR-FORMAT
 14775*                                   THRU 9900-EXIT
 14776                 END-IF
 14777              END-IF
 14778           ELSE
 14779              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14780                (PB-I-AH-TERM / 12)
 14781              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14782                 MOVE ER-2661       TO WS-ERROR
 14783*                PERFORM 9900-ERROR-FORMAT
 14784*                                   THRU 9900-EXIT
 14785              ELSE
 14786                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14787                    MOVE ER-1571 TO WS-ERROR
 14788                    PERFORM 9900-ERROR-FORMAT
 14789                                 THRU 9900-EXIT
 14790                 END-IF
 14791              END-IF
 14792           END-IF
 14793           IF WS-ERROR = ER-2661
 14794              PERFORM 9900-ERROR-FORMAT
 14795                                    THRU 9900-EXIT
 14796           END-IF
 14797        END-IF
 14798     END-IF
 14799*    IF ACCOUNT-AH-CHECKED
 14800*       NEXT SENTENCE
 14801*    ELSE
 14802*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14803*          MOVE ER-2661          TO WS-ERROR
 14804*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14805
 14806     IF ACCOUNT-AH-CHECKED
 14807        NEXT SENTENCE
 14808     ELSE
 14809        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14810           MOVE ER-2663          TO WS-ERROR
 14811           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14812
 14813     IF ACCOUNT-AH-CHECKED OR
 14814        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14815         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 268
* EL050.cbl
 14816        NEXT SENTENCE
 14817     ELSE
 14818        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14819           MOVE ER-2667            TO WS-ERROR
 14820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14821
 14822     IF PB-COMPANY-ID = 'CRI'
 14823         IF WS-ERROR = ER-2667
 14824             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14825
 14826     IF ACCOUNT-AH-CHECKED
 14827        NEXT SENTENCE
 14828     ELSE
 14829        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14830           MOVE ER-2678            TO WS-ERROR
 14831           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14832
 14833     IF CP-ERROR-RATE-FILE-NOTOPEN
 14834         GO TO 3990-FILES-NOT-OPEN.
 14835
 14836 3321-CONTINUE.
 14837     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14838     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14839     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14840*    IF (PB-COMPANY-ID = 'DCC')
 14841        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14842        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14843                                    PB-I-LF-ALT-PREM-CALC
 14844        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14845        IF WS-AH-BEN-CATEGORY = 'G'
 14846           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14847           + PB-I-ADDL-CLP)
 14848           * (1 + WS-TOL-CLP-PCT)
 14849*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14850        ELSE
 14851           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14852           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14853*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14854        END-IF
 14855        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14856                                 TO PB-I-AH-PREM-CALC
 14857        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14858           MOVE ER-8152          TO WS-ERROR
 14859           PERFORM 9900-ERROR-FORMAT
 14860                                 THRU 9900-EXIT
 14861        ELSE
 14862           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14863                 PB-I-ADDL-CLP)
 14864              MOVE ER-8148       TO WS-ERROR
 14865              PERFORM 9900-ERROR-FORMAT
 14866                                 THRU 9900-EXIT
 14867           END-IF
 14868        END-IF
 14869     END-IF
 14870     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14871        AND (PB-I-POLICY-IS-MONTHLY)
 14872        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14873        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 269
* EL050.cbl
 14874        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14875           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14876        END-IF
 14877     END-IF
 14878     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14879        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14880        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14881        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14882        MOVE ER-2786             TO WS-ERROR
 14883        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14884     END-IF
 14885     MOVE +0                     TO PB-I-AH-CLP
 14886     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14887        evaluate true
 14888           when WS-AH-BEN-CATEGORY = 'D'
 14889              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14890                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14891           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14892              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14893           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14894              compute ws-cred-union-fees rounded =
 14895                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14896                    pb-i-ah-commission)
 14897              COMPUTE PB-I-AH-CLP =
 14898                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14899        end-evaluate
 14900     END-IF
 14901     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14902
 14903     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14904         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14905
 14906     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14907         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14908
 14909     if (ws-ah-special-calc-cd = 'E')
 14910        and (pb-monthly-cert)
 14911        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14912     end-if
 14913     IF PB-COMPANY-ID = 'CRI'
 14914         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14915            PB-I-PAYMENT-AMOUNT = ZERO
 14916             NEXT SENTENCE
 14917         ELSE
 14918             COMPUTE PB-I-AH-PREM-CALC =
 14919                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14920                 (CP-PREMIUM-RATE / 100)
 14921             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14922                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14923                                             PB-I-RATE-DEV-PCT-AH.
 14924
 14925     IF (PB-I-AH-RATE  = ZERO)
 14926        and (not pb-monthly-cert)
 14927       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14928           NEXT SENTENCE
 14929       ELSE
 14930         MOVE ER-2642            TO WS-ERROR
 14931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 270
* EL050.cbl
 14932
 14933     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14934     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14935     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14936     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14937     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14938     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14939
 14940     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14941        AND (WS-AH-BEN-CATEGORY = 'G')
 14942        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14943        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14944        IF CP-DEVIATION-CODE NOT = '000'
 14945           MOVE '000'            TO CP-DEVIATION-CODE
 14946           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14947           IF NO-CP-ERROR
 14948              COMPUTE PB-I-DDF-IU-RATE-UP =
 14949              PB-I-AH-CLP - CP-CALC-PREMIUM
 14950           ELSE
 14951              MOVE ER-3057        TO WS-ERROR
 14952              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14953           END-IF
 14954        END-IF
 14955     END-IF
 14956     .
 14957 3335-EDIT-AH-REIN-NSP-RATE.
 14958     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14959        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14960              compute ws-cred-union-fees rounded =
 14961                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14962                    pb-i-ah-commission)
 14963              COMPUTE PB-I-AH-CLP =
 14964                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14965        end-if
 14966     END-IF
 14967     IF AH-REIN-NSP-NOT-USED
 14968         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14969
 14970     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14971     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14972         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14973     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14974     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14975     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14976     MOVE PB-SV-STATE            TO CP-STATE.
 14977     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14978     MOVE ZERO                   TO CP-DEVIATION-CODE
 14979                                    CP-RATE-DEV-PCT.
 14980*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14981     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14982     MOVE '3'                    TO CP-PROCESS-TYPE.
 14983     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14984     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14985                                    CP-RATING-BENEFIT-AMT.
 14986     IF CP-STATE-STD-ABBRV = 'OR'
 14987         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14988                                         PB-I-AH-TERM.
 14989     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 271
* EL050.cbl
 14990     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14991     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14992     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14993     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14994     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14995                                    CP-REMAINING-TERM
 14996                                    WS-WORK-TERM.
 14997     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14998     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14999        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15000     END-IF
 15001     IF  PB-COMPANY-ID = 'TIC'
 15002         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15003            MOVE ZERO TO CP-CLASS-CODE.
 15004
 15005     IF PB-COMPANY-ID NOT = 'TIC'
 15006          MOVE ZERO          TO CP-CLASS-CODE.
 15007
 15008     MOVE ZERO               TO CP-DEVIATION-CODE.
 15009
 15010     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15011
 15012     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15013
 15014     MOVE 'R'                   TO CP-RATE-FILE.
 15015     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15016
 15017     IF CP-ERROR-RATE-NOT-FOUND
 15018         MOVE ER-2645        TO WS-ERROR
 15019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15020         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15021
 15022     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15023
 15024     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15025     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15026
 15027     IF PB-I-AH-REI-RATE = ZERO
 15028         MOVE ER-2645        TO WS-ERROR
 15029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15030
 15031
 15032 3340-CALCULATE-PREMIUM-AMT.
 15033
 15034     IF PB-COMPANY-ID = 'NCL'
 15035         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15036             WS-AH-SPECIAL-CALC-CD = 'O')
 15037             GO TO 3999-END-EDIT.
 15038
 15039     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15040                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15041                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15042                         OR 'AHL'
 15043         NEXT SENTENCE
 15044     ELSE
 15045         IF WS-STATE-ABBREVIATION = 'CT'
 15046             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15047                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 272
* EL050.cbl
 15048                 COMPUTE PB-I-LF-PREM-CALC =
 15049                                     PB-I-LF-PREM-CALC * .90
 15050                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15051                                     PB-I-LF-ALT-PREM-CALC * .90
 15052                 COMPUTE PB-I-AH-PREM-CALC =
 15053                                     PB-I-AH-PREM-CALC * .90.
 15054
 15055     IF PB-COMP-LF-PREM
 15056        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15057        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15058
 15059     IF PB-COMP-AH-PREM
 15060        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15061
 15062 3340-CHECK-DCC-TOT-FEES.
 15063     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15064        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15065        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15066        AND (PB-I-POLICY-IS-MONTHLY)
 15067        CONTINUE
 15068     ELSE
 15069        GO TO 3340-EDIT-LF-AH-TOL
 15070     END-IF
 15071     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15072     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15073     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15074        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15075           PB-I-RATE-DEV-PCT-LF
 15076     END-IF
 15077     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15078        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15079           PB-I-RATE-DEV-PCT-AH
 15080     END-IF
 15081     MOVE 'N'                    TO CP-BEN-CATEGORY
 15082     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15083
 15084     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15085     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15086     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15087     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15088     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15089     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15090     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15091     MOVE '3'                    TO CP-PROCESS-TYPE.
 15092     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15093     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15094
 15095     MOVE PB-SV-STATE            TO CP-STATE.
 15096     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15097     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15098     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15099     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15100     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15101                                    CP-RATING-BENEFIT-AMT.
 15102     IF CP-STATE-STD-ABBRV = 'OR'
 15103         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15104                                         PB-I-LF-ALT-BENEFIT-AMT.
 15105     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 273
* EL050.cbl
 15106     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15107     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15108     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15109     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15110     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15111     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15112     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15113     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15114                                    CP-REMAINING-TERM
 15115                                    CP-LOAN-TERM.
 15116     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15117        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15118           PB-I-LF-PREMIUM-AMT
 15119     end-if
 15120
 15121     IF CP-TRUNCATED-LIFE
 15122        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15123
 15124     IF CP-TERM-IS-DAYS
 15125         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15126     ELSE
 15127         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15128
 15129     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15130     IF CP-SPECIAL-CALC-CD = 'H'
 15131         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15132                                    TO CP-ALTERNATE-BENEFIT
 15133         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15134     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15135     MOVE 'R'                    TO CP-RATE-FILE
 15136     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15137     IF NOT CP-ERROR-RATE-NOT-FOUND
 15138        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15139        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15140           AND (CP-BENEFIT-CD (1:1) = 'S')
 15141           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15142                                    PB-I-LF-PREMIUM-AMT
 15143        END-IF
 15144     ELSE
 15145        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15146     END-IF
 15147     .
 15148 3340-EDIT-LF-AH-TOL.
 15149
 15150***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15151***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15152***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15153***
 15154     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15155         PB-I-AH-PREMIUM-AMT
 15156          GIVING WS-CALC-WORK.
 15157
 15158     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15159        AND WS-CALC-WORK NOT = ZERO
 15160         MOVE ER-2649            TO WS-ERROR
 15161         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15162
 15163     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 274
* EL050.cbl
 15164             FROM PB-I-LF-PREMIUM-AMT
 15165                 GIVING WS-UNSIGN-WRK1.
 15166
 15167     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15168             FROM PB-I-LF-ALT-PREMIUM-AMT
 15169                 GIVING WS-UNSIGN-WRK4.
 15170
 15171     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15172                                + WS-UNSIGN-WRK4.
 15173
 15174     SUBTRACT PB-I-AH-PREM-CALC
 15175             FROM PB-I-AH-PREMIUM-AMT
 15176                 GIVING WS-UNSIGN-WRK2.
 15177
 15178******************************************************************
 15179*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15180******************************************************************
 15181
 15182     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15183         MOVE ZERO TO WS-UNSIGN-WRK1.
 15184
 15185     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15186         MOVE ZERO TO WS-UNSIGN-WRK2.
 15187
 15188     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15189             GIVING WS-UNSIGN-WRK3.
 15190
 15191 3342-CONTINUE.
 15192
 15193     IF (PB-I-LF-RATE = ZERO  AND
 15194         PB-I-AH-RATE = ZERO)
 15195         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15196            WS-AH-SPECIAL-CALC-CD = 'O'
 15197              NEXT SENTENCE
 15198         ELSE
 15199             GO TO 3345-EDIT-CONTINUE.
 15200
 15201     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15202         NEXT SENTENCE
 15203     ELSE
 15204     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15205        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15206           IF (PB-REISSUED-CERT         OR
 15207               PB-POLICY-IS-DECLINED    OR
 15208               PB-POLICY-IS-VOIDED)
 15209              NEXT SENTENCE
 15210           ELSE
 15211              IF WS-PREM-REJECT-SW = SPACE
 15212                 MOVE ER-2652    TO WS-ERROR
 15213                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15214                 GO TO 3344-CHECK-AH
 15215              ELSE
 15216                 MOVE ER-2650    TO WS-ERROR
 15217                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15218                 GO TO 3344-CHECK-AH.
 15219
 15220***
 15221***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 275
* EL050.cbl
 15222***
 15223
 15224     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15225         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15226            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15227             (1 + WS-TOL-LF-PREM-PCT)
 15228         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15229            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15230             (1 - WS-TOL-LF-PREM-PCT)
 15231     ELSE
 15232         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15233         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15234
 15235***
 15236***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15237***
 15238
 15239     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15240         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15241          WS-TOL-LF-PREM.
 15242
 15243     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15244         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15245          WS-TOL-LF-PREM.
 15246
 15247     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15248        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15249
 15250     IF PB-REISSUED-CERT
 15251        or PB-POLICY-IS-DECLINED
 15252        or PB-POLICY-IS-VOIDED
 15253        continue
 15254     ELSE
 15255        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15256              > WS-TOL-LF-HIGH-PREM-AMT)
 15257           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15258              < WS-TOL-LF-LOW-PREM-AMT))
 15259                      or
 15260           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15261              > WS-TOL-LF-HIGH-PREM-PCT)
 15262           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15263              < WS-TOL-LF-LOW-PREM-PCT))
 15264           IF WS-PREM-REJECT-SW = SPACE
 15265              MOVE ER-2652       TO WS-ERROR
 15266              PERFORM 9900-ERROR-FORMAT
 15267                                 THRU 9900-EXIT
 15268           ELSE
 15269              MOVE ER-2650       TO WS-ERROR
 15270              PERFORM 9900-ERROR-FORMAT
 15271                                 THRU 9900-EXIT
 15272           end-if
 15273        end-if
 15274     end-if
 15275
 15276*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15277*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15278*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15279*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 276
* EL050.cbl
 15280
 15281     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15282        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15283                      OR
 15284           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15285           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15286           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15287           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15288        END-IF
 15289     END-IF
 15290
 15291     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15292        IF WS-COMP-MAX-CAP GREATER THAN +0
 15293           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15294              IF (PB-REISSUED-CERT         OR
 15295                  PB-POLICY-IS-DECLINED    OR
 15296                  PB-POLICY-IS-VOIDED)
 15297                 NEXT SENTENCE
 15298              ELSE
 15299                  MOVE ER-2646   TO  WS-ERROR
 15300                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15301
 15302 3344-CVL-TOLERANCE-CHECK.
 15303
 15304      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15305          GO TO 3344-CHECK-AH.
 15306
 15307      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15308          GO TO 3344-CHECK-AH.
 15309
 15310      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15311                                     WS-UNSIGN-WRK6.
 15312
 15313      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15314          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15315                                 + PB-I-LF-PREMIUM-AMT
 15316                                 - PB-I-LF-PREM-CALC.
 15317
 15318      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15319          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15320                                 + PB-I-LF-ALT-PREMIUM-AMT
 15321                                 - PB-I-LF-ALT-PREM-CALC.
 15322
 15323      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15324          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15325              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15326                 MOVE ER-2652    TO  WS-ERROR
 15327                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15328              ELSE
 15329                 MOVE ER-2650    TO  WS-ERROR
 15330                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15331
 15332      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15333          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15334              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15335                 MOVE ER-2652    TO  WS-ERROR
 15336                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15337              ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 277
* EL050.cbl
 15338                 MOVE ER-2650    TO  WS-ERROR
 15339                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15340
 15341 3344-CHECK-AH.
 15342
 15343****************************************************************
 15344***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15345***
 15346
 15347     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15348         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15349             (1 + WS-TOL-AH-PREM-PCT)
 15350         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15351             (1 - WS-TOL-AH-PREM-PCT)
 15352     ELSE
 15353         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15354         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15355
 15356***
 15357***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15358***
 15359
 15360     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15361         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15362
 15363     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15364         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15365
 15366     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15367        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15368
 15369     IF (PB-REISSUED-CERT)
 15370        OR (PB-POLICY-IS-DECLINED)
 15371        OR (PB-POLICY-IS-VOIDED)
 15372        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15373        CONTINUE
 15374     ELSE
 15375        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15376              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15377                          or
 15378           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15379              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15380           IF WS-PREM-REJECT-SW = SPACE
 15381              MOVE ER-3052       TO WS-ERROR
 15382              PERFORM 9900-ERROR-FORMAT
 15383                                 THRU 9900-EXIT
 15384           ELSE
 15385              MOVE ER-3050       TO WS-ERROR
 15386              PERFORM 9900-ERROR-FORMAT
 15387                                 THRU 9900-EXIT
 15388           END-IF
 15389        END-IF
 15390     END-IF
 15391     if (pb-company-id = 'DCC' or 'VPP')
 15392        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15393        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15394        and (pb-i-policy-is-monthly)
 15395        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 278
* EL050.cbl
 15396           pb-i-tot-fees-calc + ws-tol-ah-prem
 15397        compute ws-tol-ah-low-prem-amt =
 15398           pb-i-tot-fees-calc - ws-tol-ah-prem
 15399        if ws-tol-ah-prem-pct > zeros
 15400           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15401              (1 + ws-tol-ah-prem-pct)
 15402           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15403              (1 - ws-tol-ah-prem-pct)
 15404        else
 15405           move +9999999.99      to ws-tol-ah-high-prem-pct
 15406           move +0               to ws-tol-ah-low-prem-pct
 15407        end-if
 15408        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15409            or
 15410           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15411                          or
 15412           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15413           or
 15414           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15415            move er-3049         to ws-error
 15416           perform 9900-error-format
 15417                                 thru 9900-exit
 15418
 15419        end-if
 15420     end-if
 15421     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15422         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15423             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15424             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15425
 15426     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15427        IF WS-COMP-MAX-CAP GREATER THAN +0
 15428           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15429              IF (PB-REISSUED-CERT         OR
 15430                  PB-POLICY-IS-DECLINED    OR
 15431                  PB-POLICY-IS-VOIDED)
 15432                 NEXT SENTENCE
 15433              ELSE
 15434                  MOVE ER-2646   TO  WS-ERROR
 15435                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15436
 15437     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15438        (WS-COMP-MAX-CAP EQUAL +0)
 15439           GO TO 3345-EDIT-CONTINUE.
 15440
 15441     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15442        GREATER THAN WS-COMP-MAX-CAP
 15443           MOVE ER-2646          TO  WS-ERROR
 15444           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15445
 15446 3345-EDIT-CONTINUE.
 15447
 15448*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15449*       IF PB-ENTRY-BATCH   NUMERIC
 15450*          IF PB-ISSUE
 15451*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15452*          ELSE
 15453*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 279
* EL050.cbl
 15454*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15455
 15456*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15457*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15458*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15459*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15460*        ELSE
 15461*            MOVE  ER-1909            TO  WS-ERROR
 15462*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15463
 15464     IF PB-I-POLICY-ACCEPTED
 15465        IF PB-POLICY-IS-DECLINED  OR
 15466           PB-REISSUED-CERT  OR
 15467           PB-REIN-ONLY-CERT  OR
 15468           PB-POLICY-IS-VOIDED
 15469            MOVE  ER-1891         TO  WS-ERROR
 15470            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15471        ELSE
 15472            MOVE SPACE            TO  PB-BATCH-ENTRY
 15473            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15474
 15475     IF PB-I-POLICY-DECLINED
 15476        IF PB-REISSUED-CERT  OR
 15477           PB-REIN-ONLY-CERT  OR
 15478           PB-POLICY-IS-VOIDED
 15479            MOVE  ER-1906         TO  WS-ERROR
 15480            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15481        ELSE
 15482            MOVE  'D'             TO  PB-BATCH-ENTRY
 15483                                      PB-I-ENTRY-STATUS.
 15484
 15485     IF PB-I-NEEDS-UNDERWRITING
 15486        IF PB-POLICY-IS-DECLINED OR
 15487           PB-REISSUED-CERT  OR
 15488           PB-REIN-ONLY-CERT  OR
 15489           PB-POLICY-IS-VOIDED
 15490            MOVE  ER-1907         TO  WS-ERROR
 15491            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15492        ELSE
 15493            MOVE 'U'              TO  PB-BATCH-ENTRY
 15494                                      PB-I-ENTRY-STATUS.
 15495
 15496     IF PB-NEEDS-UNDERWRITING
 15497        MOVE  ER-1901             TO  WS-ERROR
 15498        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15499     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15500        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15501        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15502        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15503           AND (NOT WS-LF-CASH))
 15504                           OR
 15505           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15506           AND (NOT WS-AH-CASH)))
 15507                       AND
 15508           (PB-I-ENTRY-STATUS NOT = '5')
 15509           MOVE 'M'              TO PB-BATCH-ENTRY
 15510                                    PB-I-ENTRY-STATUS
 15511        END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 280
* EL050.cbl
 15512     END-IF
 15513     move pending-business       to ws-passed-erpndb
 15514     move ' '                    to ws-exceed-limit-yn
 15515     perform 7780-call-agg       thru 7780-exit
 15516*    display ' el050 exceed ' ws-exceed-limit-yn
 15517     if ws-exceed-limit-yn = 'Y'
 15518        MOVE  ER-9813            TO WS-ERROR
 15519        move 'Y'                 to ws-9813-sw
 15520        PERFORM  9900-ERROR-FORMAT
 15521                                 THRU 9900-EXIT
 15522     end-if
 15523     if (PB-EXCEEDED-LIMIT-FORCED)
 15524        and (ws-9813-sw = 'Y')
 15525        subtract +1 from PB-NO-OF-ERRORS
 15526        move er-9823             to ws-error
 15527        PERFORM  9900-ERROR-FORMAT
 15528                                 THRU 9900-EXIT
 15529     end-if
 15530     IF  PB-COMPANY-ID NOT = 'NCL'
 15531         GO TO 3999-END-EDIT.
 15532
 15533     IF PB-REISSUED-CERT  OR
 15534        PB-POLICY-IS-DECLINED  OR
 15535        PB-POLICY-IS-VOIDED  OR
 15536        PB-I-OB
 15537         GO TO 3999-END-EDIT.
 15538
 15539     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15540         MOVE  ER-2644            TO  WS-ERROR
 15541         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15542         GO TO 3999-END-EDIT.
 15543
 15544     MOVE 'N'                     TO  FORM-MASTER-SW.
 15545     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15546
 15547     IF NOT FORM-MASTER-FOUND
 15548         GO TO 3999-END-EDIT.
 15549
 15550     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15551                                      FORM-MASTER-AH-SW.
 15552
 15553     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15554         MOVE  +1                 TO SUB6
 15555         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15556
 15557     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15558         MOVE  +1                 TO SUB6
 15559         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15560
 15561     IF LF-FORM-MASTER-FOUND  OR
 15562        AH-FORM-MASTER-FOUND
 15563         GO TO 3360-CHECK-FORM-LIMITS
 15564     ELSE
 15565         GO TO 3999-END-EDIT.
 15566
 15567******************************************************************
 15568*                  3350-GET-ERFORM                               *
 15569*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 281
* EL050.cbl
 15570*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15571******************************************************************
 15572
 15573 3350-GET-ERFORM.
 15574
 15575     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15576         GO TO  3350-ERFORM-GETMAIN.
 15577
 15578     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15579     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15580     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15581     MOVE 'Y'                     TO FORM-MASTER-SW.
 15582
 15583     IF PB-CANCELLATION
 15584         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15585            PB-SV-STATE          EQUAL   FO-STATE       AND
 15586            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15587              GO TO 3350-EXIT
 15588         ELSE
 15589             NEXT SENTENCE
 15590     ELSE
 15591         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15592            PB-SV-STATE          EQUAL   FO-STATE       AND
 15593            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15594              GO TO 3350-EXIT.
 15595
 15596 3350-ERFORM-GETMAIN.
 15597
 15598     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15599     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15600
 15601 3350-ERFORM-READ.
 15602
 15603     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15604     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15605     IF PB-CANCELLATION
 15606         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15607     ELSE
 15608         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15609     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15610
 15611     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15612
 15613     IF FORM-MASTER-FOUND
 15614       IF PB-CANCELLATION
 15615          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15616             PB-SV-STATE          EQUAL   FO-STATE       AND
 15617             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15618              GO  TO 3350-EXIT
 15619          ELSE
 15620              NEXT SENTENCE
 15621       ELSE
 15622          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15623             PB-SV-STATE          EQUAL   FO-STATE       AND
 15624             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15625              GO  TO 3350-EXIT.
 15626
 15627     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 282
* EL050.cbl
 15628     MOVE  ER-1895                TO  WS-ERROR.
 15629     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15630
 15631 3350-EXIT.
 15632      EXIT.
 15633
 15634******************************************************************
 15635*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15636*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15637*   VALID FOR THE POLICY FORM USED.                              *
 15638******************************************************************
 15639
 15640 3355-EDIT-FORM-LF-BENEFITS.
 15641
 15642     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15643        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15644         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15645         GO TO   3355-EXIT.
 15646
 15647     IF  SUB6    LESS THAN   +40
 15648         ADD  +1      TO  SUB6
 15649         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15650
 15651     MOVE  ER-1896         TO  WS-ERROR.
 15652     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15653
 15654 3355-EXIT.
 15655      EXIT.
 15656
 15657******************************************************************
 15658*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15659*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15660*   VALID FOR THE POLICY FORM USED.                              *
 15661******************************************************************
 15662
 15663 3356-EDIT-FORM-AH-BENEFITS.
 15664
 15665     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15666        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15667         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15668         GO TO  3356-EXIT.
 15669
 15670      IF  SUB6    LESS THAN     +40
 15671          ADD  +1      TO  SUB6
 15672          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15673
 15674     MOVE  ER-1897         TO  WS-ERROR.
 15675     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15676
 15677 3356-EXIT.
 15678      EXIT.
 15679
 15680******************************************************************
 15681*                  3357-BENEFIT-SEARCH                           *
 15682*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15683*   CANCELLATIONS ONLY.                                          *
 15684******************************************************************
 15685 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 283
* EL050.cbl
 15686     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15687         MOVE +1                          TO SUB6
 15688         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15689
 15690     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15691         MOVE +1                          TO SUB6
 15692         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15693
 15694 3357-EXIT.
 15695     EXIT.
 15696
 15697******************************************************************
 15698*                  3358-BENEFIT-LIFE-SEARCH                      *
 15699*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15700*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15701*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15702******************************************************************
 15703 3358-BENEFIT-LIFE-SEARCH.
 15704     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15705       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15706         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15707           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15708              IF FO-PLAN-REFUND-METHOD (SUB6)
 15709                     IS GREATER THAN SPACES
 15710                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15711                                          WS-LF-REFUND-CALC
 15712                 GO TO 3358-EXIT.
 15713
 15714     IF SUB6 LESS THAN +40
 15715         ADD +1                 TO SUB6
 15716         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15717
 15718 3358-EXIT.
 15719     EXIT.
 15720******************************************************************
 15721*                  3359-BENEFIT-AH-SEARCH                        *
 15722*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15723*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15724*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15725******************************************************************
 15726 3359-BENEFIT-AH-SEARCH.
 15727     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15728       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15729         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15730           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15731              IF FO-PLAN-REFUND-METHOD (SUB6)
 15732                      IS GREATER THAN SPACES
 15733                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15734                                          WS-AH-REFUND-CALC
 15735                 GO TO 3359-EXIT.
 15736
 15737     IF SUB6 LESS THAN +40
 15738         ADD +1                 TO SUB6
 15739         GO TO 3359-BENEFIT-AH-SEARCH.
 15740
 15741 3359-EXIT.
 15742     EXIT.
 15743
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 284
* EL050.cbl
 15744******************************************************************
 15745*                  3360-CHECK-FORM-LIMITS                        *
 15746*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15747*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15748******************************************************************
 15749
 15750 3360-CHECK-FORM-LIMITS.
 15751
 15752     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15753         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15754
 15755     IF NOT LF-FORM-MASTER-FOUND
 15756         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15757
 15758 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15759
 15760     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15761       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15762        WS-LF-JOINT-INDICATOR = 'J'  AND
 15763        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15764         IF PB-COMPANY-ID = 'NCL'
 15765            MOVE  ER-1911          TO  WS-ERROR
 15766            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15767         ELSE
 15768            MOVE  ER-1892          TO  WS-ERROR
 15769            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15770
 15771 3360-CHECK-FORM-LF-ATT-AGE.
 15772
 15773     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15774
 15775     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15776         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15777         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15778            IF PB-COMPANY-ID = 'NCL'
 15779                MOVE  ER-1913      TO  WS-ERROR
 15780                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15781            ELSE
 15782                MOVE  ER-1894      TO  WS-ERROR
 15783                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15784
 15785 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15786
 15787     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15788         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15789         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15790            IF PB-COMPANY-ID = 'NCL'
 15791                MOVE  ER-1914      TO  WS-ERROR
 15792                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15793            ELSE
 15794                MOVE  ER-1899      TO  WS-ERROR
 15795                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15796
 15797 3360-CHECK-FORM-LF-TERM-BAMT.
 15798
 15799     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15800         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15801         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 285
* EL050.cbl
 15802           IF  PB-COMPANY-ID = 'NCL'
 15803               MOVE  ER-1916       TO  WS-ERROR
 15804               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15805           ELSE
 15806               MOVE  ER-1902       TO  WS-ERROR
 15807               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15808
 15809     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15810                                    PB-I-LF-ALT-BENEFIT-AMT.
 15811
 15812     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15813         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15814         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15815             IF  PB-COMPANY-ID = 'NCL'
 15816                 MOVE  ER-1918     TO  WS-ERROR
 15817                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15818             ELSE
 15819                 MOVE  ER-1904     TO  WS-ERROR
 15820                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15821
 15822******************************************************************
 15823*                  3360-CHECK-FORM-AH-LIMITS                     *
 15824*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15825*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15826******************************************************************
 15827
 15828 3360-CHECK-FORM-AH-LIMITS.
 15829
 15830     IF NOT AH-FORM-MASTER-FOUND
 15831         GO TO 3999-END-EDIT.
 15832
 15833 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15834
 15835     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15836       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15837        WS-AH-JOINT-INDICATOR = 'J'  AND
 15838        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15839         IF PB-COMPANY-ID = 'NCL'
 15840            MOVE  ER-1912          TO  WS-ERROR
 15841            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15842         ELSE
 15843            MOVE  ER-1893          TO  WS-ERROR
 15844            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15845
 15846 3360-CHECK-FORM-AH-ATT-AGE.
 15847
 15848     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15849
 15850     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15851         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15852         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15853            IF PB-COMPANY-ID = 'NCL'
 15854                MOVE  ER-1913      TO  WS-ERROR
 15855                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15856            ELSE
 15857                MOVE  ER-1894      TO  WS-ERROR
 15858                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15859
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 286
* EL050.cbl
 15860 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15861
 15862     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15863         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15864         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15865            IF PB-COMPANY-ID = 'NCL'
 15866                MOVE  ER-1915      TO  WS-ERROR
 15867                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15868            ELSE
 15869                MOVE  ER-1900      TO  WS-ERROR
 15870                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15871
 15872 3360-CHECK-FORM-AH-TERM-BAMT.
 15873
 15874     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15875         FO-AH-MAX-TERM    GREATER THAN  +0
 15876         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15877             IF  PB-COMPANY-ID = 'NCL'
 15878                 MOVE  ER-1917     TO  WS-ERROR
 15879                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15880             ELSE
 15881                  MOVE  ER-1903    TO  WS-ERROR
 15882                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15883
 15884     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15885         FO-MAX-AH-AMT    GREATER THAN  +0
 15886         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15887             IF  PB-COMPANY-ID = 'NCL'
 15888                 MOVE  ER-1919     TO  WS-ERROR
 15889                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15890             ELSE
 15891                 MOVE  ER-1905     TO  WS-ERROR
 15892                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15893
 15894     GO TO 3999-END-EDIT.
 15895
 15896******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 287
* EL050.cbl
 15898 3400-edit-vin.
 15899
 15900     move spaces                 to hldi-pass-area
 15901     MOVE PB-I-VIN               TO WS-WORK-VIN
 15902     MOVE +8                     TO V2
 15903     MOVE ZEROS                  TO WS-VIN-TOTAL
 15904     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15905      (V1 > 17)
 15906        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15907           MOVE ER-3825          TO WS-ERROR
 15908           PERFORM 9900-ERROR-FORMAT
 15909                                 THRU 9900-EXIT
 15910        ELSE
 15911           IF V1 = 8
 15912              MOVE 10            TO V2
 15913           END-IF
 15914           IF V1 = 9
 15915              MOVE 0             TO V2
 15916           END-IF
 15917           IF V1 = 10
 15918              MOVE 9             TO V2
 15919           END-IF
 15920           IF WS-WORK-VIN (V1:1) NUMERIC
 15921              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15922               + (WS-WORK-VIN-N (V1) * V2)
 15923           ELSE
 15924              MOVE WS-WORK-VIN (V1:1)
 15925                            TO WS-HEX-BYTE
 15926              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15927              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15928               + (WS-NUM (V3) * V2)
 15929           END-IF
 15930           COMPUTE V2 = V2 - 1
 15931        END-IF
 15932     END-PERFORM
 15933     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15934     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15935        REMAINDER WS-VIN-REMAINDER
 15936     IF ((WS-WORK-VIN (9:1) = 'X')
 15937        AND (WS-VIN-REMAINDER = 10))
 15938                OR
 15939        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15940        if pb-company-id = 'VPP'
 15941           perform 3410-check-with-hldi
 15942                                 thru 3410-exit
 15943        end-if
 15944     ELSE
 15945        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15946           MOVE ER-3826          TO WS-ERROR
 15947           PERFORM 9900-ERROR-FORMAT
 15948                                 THRU 9900-EXIT
 15949        ELSE
 15950           MOVE ER-3827          TO WS-ERROR
 15951           PERFORM 9900-ERROR-FORMAT
 15952                                 THRU 9900-EXIT
 15953        END-IF
 15954     END-IF
 15955
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 288
* EL050.cbl
 15956     .
 15957 3400-exit.
 15958     exit.
 15959 3410-check-with-hldi.
 15960     move spaces                 to hldi-pass-area
 15961     move pb-i-vin               to pa-vin
 15962     perform 7785-call-hldi      thru 7785-exit
 15963*    display 'PA-VIN        ' PA-VIN
 15964*    display 'PA-ErrorCode  ' PA-ErrorCode
 15965*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15966*    display 'PA-ModelYear  ' PA-ModelYear
 15967*    display 'PA-MakeName   ' PA-MakeName
 15968*    display 'PA-ModelName  ' PA-ModelName
 15969*    display 'PA-SeriesName ' PA-SeriesName
 15970     if pa-errorcode (1:1) not = '0'
 15971        move spaces              to hldi-pass-area
 15972        move pb-i-vin            to pa-vin
 15973*       move pa-errordesc        to pa-seriesname
 15974*       perform 7786-call-hldim  thru 7786-exit
 15975*       display 'PA-VIN        ' PA-VIN
 15976*       display 'PA-ErrorCode  ' PA-ErrorCode
 15977*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15978*       display 'PA-ModelYear  ' PA-ModelYear
 15979*       display 'PA-MakeName   ' PA-MakeName
 15980*       display 'PA-ModelName  ' PA-ModelName
 15981*       display 'PA-SeriesName ' PA-SeriesName
 15982     end-if
 15983     .
 15984 3410-exit.
 15985     exit.
 15986******************************************************************
 15987*                  E D I T   C A N C E L                         *
 15988******************************************************************
 15989
 15990 3700-EDIT-CANCEL.
 15991     IF PB-COMPANY-ID = 'DMD'
 15992         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15993                                         WS-RES-MUNI-TAX
 15994                                         PB-CI-STATE-TAX
 15995                                         PB-CI-MUNI-TAX
 15996         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15997
 15998*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15999*       IF PB-ENTRY-BATCH  NUMERIC
 16000*          IF PB-CANCELLATION
 16001*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16002*          ELSE
 16003*             IF PB-ISSUE
 16004*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16005
 16006     IF PB-C-INT-ON-REFS NOT NUMERIC
 16007        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16008     END-IF
 16009*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16010*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16011
 16012     IF CM-ENTRY-STATUS = 'V'
 16013        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 289
* EL050.cbl
 16014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16015        GO TO 3999-END-EDIT.
 16016
 16017     IF CM-ENTRY-STATUS = 'D'
 16018        MOVE ER-2781             TO WS-ERROR
 16019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16020        GO TO 3999-END-EDIT.
 16021
 16022     IF CM-ENTRY-STATUS = 'U'
 16023        MOVE ER-2782             TO WS-ERROR
 16024        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16025
 16026***************************************************************
 16027*                                                             *
 16028*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16029*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16030*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16031*   OF ANOTHER COVERAGE.                                      *
 16032*                                                             *
 16033***************************************************************
 16034
 16035     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16036                                    PB-C-AH-CANCEL-VOID-SW.
 16037
 16038     if pb-company-id = 'DCC' or 'VPP'
 16039        if ((pb-ci-lf-cancel-amt <> zeros)
 16040                       or
 16041            (pb-ci-ah-cancel-amt <> zeros))
 16042           MOVE ER-3068          TO WS-ERROR
 16043           PERFORM 9900-ERROR-FORMAT
 16044                                 THRU 9900-EXIT
 16045           GO TO 3999-END-EDIT
 16046        end-if
 16047     end-if
 16048     IF PB-C-LF-CANCEL-AMT = ZERO
 16049        NEXT SENTENCE
 16050     ELSE
 16051        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16052           AND
 16053           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16054               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16055               MOVE ER-2745           TO WS-ERROR
 16056               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16057
 16058     IF PB-C-AH-CANCEL-AMT = ZERO
 16059        NEXT SENTENCE
 16060     ELSE
 16061        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16062           AND
 16063           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16064               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16065               MOVE ER-2745           TO WS-ERROR
 16066               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16067
 16068     IF WS-LF-EARNINGS-CALC = '4'
 16069        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16070
 16071     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 290
* EL050.cbl
 16072     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16073     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16074     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16075     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16076     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16077
 16078     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16079                                      PB-C-AH-REF-CALC.
 16080     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16081
 16082******************************************************************
 16083*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16084*             TO VALIDATE COVERAGE.                              *
 16085******************************************************************
 16086
 16087     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16088        PB-C-LF-CANCEL-AMT = ZEROS
 16089          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16090      ELSE
 16091          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16092
 16093     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16094        PB-C-AH-CANCEL-AMT = ZEROS
 16095          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16096      ELSE
 16097          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16098
 16099     EVALUATE TRUE
 16100         WHEN PB-CANCEL-FORCE             OR
 16101              PB-CANCEL-DATE-FORCED       OR
 16102              PB-FORCE-OFF
 16103                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16104                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16105                  END-IF
 16106         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16107               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16108              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16109                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16110         WHEN OTHER
 16111              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16112                 MOVE ER-2794              TO WS-ERROR
 16113              ELSE
 16114                 MOVE ER-2749              TO WS-ERROR
 16115              END-IF
 16116              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16117     END-EVALUATE.
 16118
 16119
 16120*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16121*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16122*            MOVE  ER-1909            TO  WS-ERROR
 16123*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16124*        ELSE
 16125*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16126
 16127     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16128     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16129        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 291
* EL050.cbl
 16130     ELSE
 16131        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16132     END-IF
 16133     .
 16134 3705-EDIT-CANCEL-DT.
 16135
 16136     IF LF-COVERAGE-CANCELLED
 16137        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16138         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16139         MOVE WS-CURRENT-MONTH-END
 16140                                 TO DC-BIN-DATE-2
 16141         SET ELAPSED-BETWEEN-BIN TO TRUE
 16142*        MOVE 1                  TO DC-OPTION-CODE
 16143         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16144         IF DATE-CONVERSION-ERROR
 16145            NEXT SENTENCE
 16146          ELSE
 16147             IF DC-ELAPSED-DAYS GREATER +180
 16148                IF PB-CANCEL-DATE-FORCED  OR
 16149                   PB-CANCEL-DATE-FORCED-NO-FEE
 16150                      MOVE ER-2751  TO WS-ERROR
 16151                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16152                 ELSE
 16153                   MOVE ER-2752  TO WS-ERROR
 16154                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16155
 16156     IF AH-COVERAGE-CANCELLED
 16157        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16158         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16159         MOVE WS-CURRENT-MONTH-END
 16160                                 TO DC-BIN-DATE-2
 16161         SET ELAPSED-BETWEEN-BIN TO TRUE
 16162*        MOVE 1                  TO DC-OPTION-CODE
 16163         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16164         IF DATE-CONVERSION-ERROR
 16165            NEXT SENTENCE
 16166          ELSE
 16167             IF DC-ELAPSED-DAYS GREATER +180
 16168                IF PB-CANCEL-DATE-FORCED OR
 16169                   PB-CANCEL-DATE-FORCED-NO-FEE
 16170                      MOVE ER-2751  TO WS-ERROR
 16171                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16172                 ELSE
 16173                   MOVE ER-2752  TO WS-ERROR
 16174                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16175
 16176     IF WS-ERROR = ER-2752
 16177        AND (PB-COMPANY-ID = 'ABL'
 16178         OR  PB-COMPANY-ID = 'FGL'
 16179         OR  PB-COMPANY-ID = 'IST'
 16180         OR  PB-COMPANY-ID = 'JHL'
 16181         OR  PB-COMPANY-ID = 'LAP'
 16182         OR  PB-COMPANY-ID = 'LBL'
 16183         OR  PB-COMPANY-ID = 'NCB'
 16184         OR  PB-COMPANY-ID = 'NLI'
 16185         OR  PB-COMPANY-ID = 'OFI'
 16186         OR  PB-COMPANY-ID = 'PLI'
 16187         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 292
* EL050.cbl
 16188         OR  PB-COMPANY-ID = 'TIC'
 16189         OR  PB-COMPANY-ID = 'HER'
 16190         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16191         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16192            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16193            MOVE ER-2762     TO WS-ERROR
 16194            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16195
 16196     IF LF-COVERAGE-CANCELLED
 16197        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16198        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16199             MOVE ER-2733         TO WS-ERROR
 16200             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16201
 16202     IF AH-COVERAGE-CANCELLED
 16203        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16204        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16205              MOVE ER-2733        TO WS-ERROR
 16206              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16207
 16208     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16209        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16210        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16211           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16212            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16213              IF PB-COMPANY-ID NOT = 'LAP'
 16214               MOVE ER-2704            TO WS-ERROR
 16215               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16216
 16217     IF CERT-WAS-NOT-FOUND
 16218         GO TO 3999-END-EDIT.
 16219
 16220     IF PB-COMPANY-ID EQUAL 'CDC'
 16221        IF LF-COVERAGE-CANCELLED
 16222           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16223            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16224            MOVE PB-C-LF-CANCEL-DT
 16225                                 TO DC-BIN-DATE-2
 16226            SET ELAPSED-BETWEEN-BIN TO TRUE
 16227*           MOVE 1               TO DC-OPTION-CODE
 16228            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16229            IF DATE-CONVERSION-ERROR
 16230               NEXT SENTENCE
 16231             ELSE
 16232                IF DC-ELAPSED-DAYS GREATER +60
 16233                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16234
 16235     IF PB-COMPANY-ID EQUAL 'CDC'
 16236        IF AH-COVERAGE-CANCELLED
 16237           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16238            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16239            MOVE PB-C-AH-CANCEL-DT
 16240                                 TO DC-BIN-DATE-2
 16241            MOVE +0              TO DC-ELAPSED-DAYS
 16242                                    DC-ELAPSED-MONTHS
 16243            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16244*           MOVE 1               TO DC-OPTION-CODE
 16245            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 293
* EL050.cbl
 16246            IF DATE-CONVERSION-ERROR
 16247               NEXT SENTENCE
 16248             ELSE
 16249                IF DC-ELAPSED-DAYS GREATER +60
 16250                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16251
 16252     MOVE +0                     TO DC-ELAPSED-DAYS
 16253                                    DC-ELAPSED-MONTHS.
 16254
 16255     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16256        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16257          MOVE 'Z'                TO PB-CI-OB-FLAG
 16258          MOVE ER-2767            TO WS-ERROR
 16259          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16260          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16261          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16262          GO TO 3775-OVER-REF-CHK
 16263        ELSE
 16264          MOVE ZEROS              TO PB-CI-LIVES
 16265                                     PB-C-LIVES
 16266          IF PB-CI-OB-FLAG NOT = 'B'
 16267             MOVE SPACE           TO PB-CI-OB-FLAG.
 16268
 16269     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16270         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16271     ELSE
 16272         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16273
 16274     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16275        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16276            MOVE ER-2760         TO WS-ERROR
 16277            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16278
 16279     IF LF-COVERAGE-CANCELLED
 16280        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16281         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16282            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16283               MOVE ER-2774       TO WS-ERROR
 16284               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16285
 16286     IF AH-COVERAGE-CANCELLED
 16287        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16288         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16289            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16290               MOVE ER-2775       TO WS-ERROR
 16291               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16292
 16293     IF LF-COVERAGE-CANCELLED
 16294        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16295         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16296            MOVE ER-2776         TO WS-ERROR
 16297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16298
 16299     IF AH-COVERAGE-CANCELLED
 16300        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16301         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16302            MOVE ER-2777         TO WS-ERROR
 16303            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 294
* EL050.cbl
 16304
 16305     IF LF-COVERAGE-CANCELLED
 16306        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16307        if pb-ci-lf-expire-dt = low-values or spaces
 16308           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16309           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16310           MOVE PB-CI-EXTENTION-DAYS
 16311                                 TO DC-ELAPSED-DAYS
 16312           SET BIN-PLUS-ELAPSED  TO TRUE
 16313           PERFORM 8500-DATE-CONVERT
 16314                                 THRU 8500-EXIT
 16315           IF DATE-CONVERSION-ERROR
 16316              move low-values    to dc-bin-date-2
 16317           end-if
 16318        else
 16319           move pb-ci-lf-expire-dt
 16320                                 to dc-bin-date-2
 16321        end-if
 16322        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16323           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16324                             OR  'FIA'
 16325              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16326           ELSE
 16327              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16328              MOVE ER-2731       TO WS-ERROR
 16329              PERFORM 9900-ERROR-FORMAT
 16330                                 THRU 9900-EXIT
 16331           end-if
 16332        end-if
 16333     end-if
 16334*    IF LF-COVERAGE-CANCELLED
 16335*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16336*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16337*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16338*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16339*        SET BIN-PLUS-ELAPSED      TO TRUE
 16340*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16341*        IF DATE-CONVERSION-ERROR
 16342*           NEXT SENTENCE
 16343*         ELSE
 16344*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16345*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16346*                            OR  'FIA'
 16347*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16348*              ELSE
 16349*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16350*               MOVE ER-2731       TO WS-ERROR
 16351*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16352     .
 16353 3705-EDIT-AH-CANCEL-DT.
 16354     IF AH-COVERAGE-CANCELLED
 16355        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16356        if pb-ci-AH-expire-dt = low-values or spaces
 16357           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16358           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16359           MOVE PB-CI-EXTENTION-DAYS
 16360                                 TO DC-ELAPSED-DAYS
 16361           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 295
* EL050.cbl
 16362           PERFORM 8500-DATE-CONVERT
 16363                                 THRU 8500-EXIT
 16364           IF DATE-CONVERSION-ERROR
 16365              move low-values    to dc-bin-date-2
 16366           end-if
 16367        else
 16368           move pb-ci-ah-expire-dt
 16369                                 to dc-bin-date-2
 16370        end-if
 16371        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16372           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16373                             OR  'FIA'
 16374              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16375           ELSE
 16376              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16377              MOVE ER-2771       TO WS-ERROR
 16378              PERFORM 9900-ERROR-FORMAT
 16379                                 THRU 9900-EXIT
 16380           end-if
 16381        end-if
 16382     end-if
 16383*    IF AH-COVERAGE-CANCELLED
 16384*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16385*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16386*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16387*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16388**       MOVE 6                    TO DC-OPTION-CODE
 16389*        SET BIN-PLUS-ELAPSED      TO TRUE
 16390*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16391*        IF DATE-CONVERSION-ERROR
 16392*           NEXT SENTENCE
 16393*         ELSE
 16394*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16395*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16396*                             OR 'FIA'
 16397*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16398*             ELSE
 16399*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16400*              MOVE ER-2771       TO WS-ERROR
 16401*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16402     .
 16403 3705-EDIT-CONTINUED.
 16404
 16405*    IF LF-COVERAGE-CANCELLED
 16406*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16407*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16408*            MOVE ER-2727         TO WS-ERROR
 16409*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16410*
 16411*    IF AH-COVERAGE-CANCELLED
 16412*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16413*        IF PB-COMPANY-ID = 'ACE'
 16414*           MOVE ER-2727        TO WS-ERROR
 16415*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16416*        ELSE
 16417*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16418*              MOVE ER-2727     TO WS-ERROR
 16419*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 296
* EL050.cbl
 16420
 16421     IF PB-COMPANY-ID = 'ACE'
 16422       IF AH-COVERAGE-CANCELLED
 16423         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16424           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16425              MOVE ER-2732      TO WS-ERROR
 16426              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16427
 16428     IF PB-COMPANY-ID      EQUAL   'HER'
 16429        IF WS-ERROR        EQUAL   ER-2727
 16430            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16431            MOVE  ER-2725          TO  WS-ERROR
 16432            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16433
 16434     IF PB-C-CLAIM-CREATED-CANCEL
 16435            MOVE ER-2748         TO WS-ERROR
 16436            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16437
 16438     IF PB-C-LAST-NAME NOT = SPACES
 16439         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16440            MOVE ER-2747         TO WS-ERROR
 16441            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16442
 16443 3710-EDIT-LUMP-SUM-PRIOR.
 16444
 16445     IF AH-COVERAGE-CANCELLED
 16446         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16447             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16448                MOVE ER-2735    TO WS-ERROR
 16449                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16450
 16451     IF LF-COVERAGE-CANCELLED
 16452         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16453             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16454                MOVE ER-2735    TO WS-ERROR
 16455                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16456
 16457 3710-EDIT-PRIOR-DEATH.
 16458
 16459*    IF LF-COVERAGE-CANCELLED
 16460*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16461*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16462*           (NOT PB-CI-OB)
 16463*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16464*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16465*                   MOVE ER-2732  TO WS-ERROR
 16466*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16467*
 16468*    IF AH-COVERAGE-CANCELLED
 16469*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16470*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16471*           (NOT PB-CI-OB)
 16472*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16473*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16474*                   MOVE ER-2732  TO WS-ERROR
 16475*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16476
 16477     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 297
* EL050.cbl
 16478         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16479            (NOT PB-COMP-LF-CANCEL)
 16480             NEXT SENTENCE
 16481         ELSE
 16482           IF PB-C-LF-CANCEL-VOIDED
 16483              NEXT SENTENCE
 16484           ELSE
 16485              MOVE ER-2753      TO WS-ERROR
 16486              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16487
 16488     IF CANCEL-FUTURE-DT
 16489         GO TO 3999-END-EDIT.
 16490
 16491 3715-GET-REMAIN-TERM-LF.
 16492
 16493     IF NO-LF-BENEFIT-MATCH  OR
 16494        WS-LF-BENEFIT-CD = ZEROS
 16495        GO TO 3730-GET-AH-REMAIN-TERM.
 16496
 16497     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16498     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16499     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16500     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16501     MOVE PB-SV-STATE            TO CP-STATE.
 16502     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16503     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16504     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16505     MOVE '2'                    TO CP-PROCESS-TYPE.
 16506     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16507     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16508     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16509     IF (PB-COMPANY-ID = 'CID')
 16510        AND (CP-STATE-STD-ABBRV = 'WI')
 16511        MOVE '7'                 TO CP-REM-TERM-METHOD
 16512        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16513     ELSE
 16514        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16515        MOVE WS-REM-TRM-CALC-OPTION
 16516                                 TO CP-REM-TRM-CALC-OPTION
 16517     END-IF
 16518**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16519     IF (PB-COMPANY-ID = 'CID')
 16520        AND (CP-STATE-STD-ABBRV = 'MO')
 16521        AND (PB-CERT-EFF-DT >= X'9B41')
 16522        AND (PB-CERT-EFF-DT <= X'A2FB')
 16523        MOVE '7'                 TO CP-REM-TERM-METHOD
 16524        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16525     END-IF
 16526     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16527                                    CP-LOAN-TERM.
 16528     IF CP-TRUNCATED-LIFE
 16529        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16530
 16531     IF CP-TERM-IS-DAYS
 16532         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16533     ELSE
 16534         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16535
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 298
* EL050.cbl
 16536     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16537
 16538     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16539
 16540     IF LF-COVERAGE-CANCELLED
 16541        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16542        NEXT SENTENCE
 16543      ELSE
 16544          GO TO 3730-GET-AH-REMAIN-TERM.
 16545
 16546 3720-GET-LF-REFUND.
 16547
 16548     IF PB-C-LF-CANCEL-VOIDED
 16549        GO TO 3730-GET-AH-REMAIN-TERM
 16550     end-if
 16551
 16552     IF PB-COMPANY-ID EQUAL 'BOA'
 16553         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16554         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16555         GO TO 3730-GET-AH-REMAIN-TERM.
 16556
 16557     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16558        (WS-AH-SPECIAL-CALC-CD = 'M')
 16559         MOVE ER-2767            TO WS-ERROR
 16560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16561         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16562         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16563         GO TO 3780-UPDATE-CANCEL-CERT.
 16564
 16565*    if (ws-lf-earnings-calc = '6')
 16566*       or (pb-c-lf-refund-override = '6')
 16567*       move cp-remaining-term-1 to cp-remaining-term-2
 16568*    end-if
 16569     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16570
 16571     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16572     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16573     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16574     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16575     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16576     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16577     IF PB-COMPANY-ID = 'DCC'
 16578        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16579        IF PDEF-MASTER-FOUND
 16580           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16581              (V1 > +8)
 16582              OR (PD-PROD-CODE (V1) = 'L')
 16583           END-PERFORM
 16584           IF V1 < +9
 16585              MOVE PD-MAX-AMT (V1)
 16586                           TO CP-R-MAX-TOT-BEN
 16587                              EC-AM-LF-MAX-TOT-BEN
 16588           END-IF
 16589        ELSE
 16590        MOVE ' '                 TO PDEF-MASTER-SW
 16591        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16592        MOVE PB-STATE            TO ERPDEF-STATE
 16593        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 299
* EL050.cbl
 16594           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16595        END-IF
 16596        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16597        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16598        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16599        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16600        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16601        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16602        IF PDEF-MASTER-FOUND
 16603           MOVE 'N'              TO PDEF-MASTER-SW
 16604           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16605           IF PDEF-MASTER-FOUND
 16606              IF (ERPDEF-KEY-SAVE (1:16) =
 16607                           PD-CONTROL-PRIMARY (1:16))
 16608                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16609                 CONTINUE
 16610              ELSE
 16611                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16612                 IF (ERPDEF-KEY-SAVE (1:16) =
 16613                           PD-CONTROL-PRIMARY (1:16))
 16614                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16615                    CONTINUE
 16616                 ELSE
 16617                    MOVE 'N'     TO PDEF-MASTER-SW
 16618                 END-IF
 16619              END-IF
 16620
 16621              IF PDEF-MASTER-FOUND
 16622                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16623                    (V1 > +8)
 16624                    OR (PD-PROD-CODE (V1) = 'L')
 16625                 END-PERFORM
 16626                 IF V1 < +9
 16627                    MOVE PD-MAX-AMT (V1)
 16628                                 TO CP-R-MAX-TOT-BEN
 16629                                    EC-AM-LF-MAX-TOT-BEN
 16630                 END-IF
 16631              END-IF
 16632           END-IF
 16633           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16634        END-IF
 16635        END-IF
 16636     END-IF
 16637     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16638
 16639     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16640
 16641     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16642                                    PB-C-LF-REM-TERM.
 16643
 16644     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16645     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16646
 16647     IF PB-COMPANY-ID EQUAL 'FLC'
 16648        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16649           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16650           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16651                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 300
* EL050.cbl
 16652                    - CM-LF-ITD-DEATH-AMT
 16653           IF PB-C-LF-REF-CALC LESS THAN +0
 16654              MOVE +0            TO PB-C-LF-REF-CALC
 16655              GO TO 3730-GET-AH-REMAIN-TERM
 16656           ELSE
 16657              GO TO 3730-GET-AH-REMAIN-TERM.
 16658
 16659     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16660                            OR '4' OR '5' OR '6' OR '8'
 16661                            OR '9' OR 'G'
 16662        MOVE PB-C-LF-REFUND-OVERRIDE
 16663                                 TO CP-EARNING-METHOD.
 16664
 16665     if pb-company-id = 'AHL'
 16666        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16667        if cp-class-code = spaces
 16668           move zeros            to cp-class-code
 16669        end-if
 16670     ELSE
 16671        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16672     END-IF
 16673*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16674     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16675     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16676                                    CP-RATING-BENEFIT-AMT.
 16677     IF CP-STATE-STD-ABBRV = 'OR'
 16678         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16679                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16680     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16681     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16682     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16683     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16684     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16685     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16686     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16687     IF WS-DEFAULT-APR NOT NUMERIC
 16688         MOVE ZEROS TO WS-DEFAULT-APR.
 16689****   N O T E   ****
 16690*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16691*      THE OH HARD CODING IN ELCRFNDP
 16692
 16693     IF PB-COMPANY-ID = 'CID'
 16694        IF CP-STATE-STD-ABBRV = 'OH'
 16695           MOVE WS-LF-EARNINGS-CALC
 16696                                 TO CP-EARNING-METHOD
 16697        END-IF
 16698     END-IF
 16699
 16700****   N O T E   ****
 16701
 16702*    IF CP-EARN-AS-NET-PAY
 16703*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16704*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16705*               MOVE WS-DEFAULT-APR
 16706*                                TO  CP-LOAN-APR
 16707*               MOVE ER-3780     TO  WS-ERROR
 16708*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16709*           ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 301
* EL050.cbl
 16710*               MOVE ER-3781     TO  WS-ERROR
 16711*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16712*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16713     move ' '                    to cp-ext-days-calc
 16714     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16715
 16716     IF CP-REFUND-TYPE-USED NOT = SPACE
 16717         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16718
 16719     IF CP-ERROR-RATE-IS-ZERO OR
 16720        CP-ERROR-RATE-NOT-FOUND
 16721        MOVE ER-2740             TO WS-ERROR
 16722        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16723
 16724     IF CP-ERROR-RATE-FILE-NOTOPEN
 16725        MOVE ER-2617             TO WS-ERROR
 16726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16727
 16728     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16729        AND PB-CI-ENTRY-STATUS = 'M'
 16730        MOVE +0                  TO PB-C-LF-REF-CALC
 16731     ELSE
 16732        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16733     END-IF
 16734
 16735     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16736         GO TO 3730-GET-AH-REMAIN-TERM.
 16737
 16738*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16739*       ADD +1                   TO PB-C-LF-REM-TERM
 16740*                                   CP-REMAINING-TERM
 16741*                                   CP-ORIGINAL-TERM.
 16742
 16743     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16744     MOVE '2'                    TO CP-EARNING-METHOD
 16745                                    CP-RATING-METHOD.
 16746     IF PB-COMPANY-ID = 'CID'
 16747        IF (CP-STATE-STD-ABBRV = 'MN')
 16748           AND (PB-CERT-EFF-DT > X'A4FF')
 16749           AND (WS-LF-EARNINGS-CALC = 'B')
 16750           MOVE '5'              TO CP-EARNING-METHOD
 16751           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16752        END-IF
 16753     END-IF
 16754     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16755                                        CP-REMAINING-BENEFIT
 16756                                        CP-RATING-BENEFIT-AMT.
 16757     IF CP-STATE-STD-ABBRV = 'OR'
 16758         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16759                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16760     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16761     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16762
 16763     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16764
 16765     IF CP-ERROR-RATE-IS-ZERO OR
 16766        CP-ERROR-RATE-NOT-FOUND
 16767        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 302
* EL050.cbl
 16768        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16769
 16770     IF CP-ERROR-RATE-FILE-NOTOPEN
 16771        MOVE ER-2617             TO WS-ERROR
 16772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16773
 16774     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16775
 16776******************************************************************
 16777
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 303
* EL050.cbl
 16779 3730-GET-AH-REMAIN-TERM.
 16780     IF NO-AH-BENEFIT-MATCH  OR
 16781        WS-AH-BENEFIT-CD = ZEROS
 16782         GO TO 3770-CHECK-REFUNDS.
 16783
 16784     IF PB-CI-AH-LUMP-SUM-DISAB
 16785         IF  PB-C-AH-CANCEL-AMT = ZERO
 16786            IF NOT PB-COMP-AH-CANCEL
 16787             GO TO 3770-CHECK-REFUNDS.
 16788
 16789     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16790     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16791     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16792     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16793     MOVE PB-SV-STATE            TO CP-STATE.
 16794     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16795     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16796     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16797     MOVE '2'                    TO CP-PROCESS-TYPE.
 16798     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16799     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16800     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16801     IF (PB-COMPANY-ID = 'CID')
 16802        AND (CP-STATE-STD-ABBRV = 'WI')
 16803        MOVE '7'                 TO CP-REM-TERM-METHOD
 16804        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16805     ELSE
 16806        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16807        MOVE WS-REM-TRM-CALC-OPTION
 16808                                 TO CP-REM-TRM-CALC-OPTION
 16809     END-IF
 16810     IF (PB-COMPANY-ID = 'CID')
 16811        AND (CP-STATE-STD-ABBRV = 'MO')
 16812        AND (PB-CERT-EFF-DT >= X'9B41')
 16813        AND (PB-CERT-EFF-DT <= X'A2FB')
 16814        MOVE '7'                 TO CP-REM-TERM-METHOD
 16815        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16816     END-IF
 16817     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16818                                    CP-LOAN-TERM.
 16819     IF NOT CP-TERM-IS-DAYS
 16820         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16821
 16822     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16823
 16824     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16825
 16826     IF AH-COVERAGE-CANCELLED
 16827        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16828        NEXT SENTENCE
 16829      ELSE
 16830         GO TO 3770-CHECK-REFUNDS.
 16831
 16832 3740-GET-AH-REFUND.
 16833
 16834     IF PB-C-AH-CANCEL-VOIDED
 16835        GO TO 3780-UPDATE-CANCEL-CERT
 16836     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 304
* EL050.cbl
 16837
 16838     IF PB-COMPANY-ID = 'BOA'
 16839         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16840         GO TO 3770-CHECK-REFUNDS.
 16841
 16842     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16843*    MOVE ' '                    TO DC-OPTION-CODE
 16844     SET BIN-TO-GREG             TO TRUE
 16845     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16846     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16847                                    PB-C-AH-REM-TERM.
 16848     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16849     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16850
 16851     IF PB-COMPANY-ID EQUAL 'FLC'
 16852        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16853           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16854           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16855                    - CM-AH-ITD-AH-PMT)
 16856           IF PB-C-AH-REF-CALC LESS THAN +0
 16857              MOVE +0            TO PB-C-AH-REF-CALC
 16858              GO TO 3770-CHECK-REFUNDS
 16859           ELSE
 16860              GO TO 3770-CHECK-REFUNDS.
 16861
 16862     IF PB-COMPANY-ID = 'DCC'
 16863        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16864            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16865           MOVE 'S'              TO CP-EARNING-METHOD
 16866        END-IF
 16867     END-IF
 16868     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16869                            OR '4' OR '5' OR '6' OR '8'
 16870                            OR '9' OR 'G' OR 'S'
 16871        MOVE PB-C-AH-REFUND-OVERRIDE
 16872                                 TO CP-EARNING-METHOD.
 16873
 16874     if pb-company-id = 'AHL'
 16875        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16876        if cp-class-code = spaces
 16877           move zeros            to cp-class-code
 16878        end-if
 16879     ELSE
 16880        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16881     END-IF
 16882*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16883     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16884     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16885                                    CP-RATING-BENEFIT-AMT.
 16886     IF CP-STATE-STD-ABBRV = 'OR'
 16887         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16888                                         PB-CI-AH-TERM.
 16889     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16890     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16891     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16892     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16893     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16894     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 305
* EL050.cbl
 16895
 16896     IF CP-STATE-STD-ABBRV = 'OH'
 16897        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16898                                AND 'CID' AND 'DCC' and 'VPP'
 16899                                AND 'AHL')
 16900           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16901              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16902              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16903              MOVE '6' TO CP-EARNING-METHOD
 16904           END-IF
 16905        END-IF
 16906        IF PB-COMPANY-ID = 'CID'
 16907           IF NO-LIFE-COVERAGE
 16908              IF CP-CRITICAL-PERIOD
 16909                 MOVE '2'       TO CP-EARNING-METHOD
 16910              ELSE
 16911                 MOVE '6'       TO CP-EARNING-METHOD
 16912              END-IF
 16913           ELSE
 16914              IF WS-LF-COVERAGE-TYPE = 'L'
 16915                 MOVE '2'       TO CP-EARNING-METHOD
 16916              ELSE
 16917                 IF (PB-CI-LF-TERM > +60) OR
 16918                    (WS-LF-EARNINGS-CALC = '5')
 16919                    IF CP-CRITICAL-PERIOD
 16920                       MOVE '2'  TO CP-EARNING-METHOD
 16921                    ELSE
 16922                       MOVE '6'  TO CP-EARNING-METHOD
 16923                    END-IF
 16924                 ELSE
 16925                    MOVE '1'     TO CP-EARNING-METHOD
 16926                 END-IF
 16927              END-IF
 16928           END-IF
 16929        END-IF
 16930     END-IF
 16931
 16932*    IF CP-STATE-STD-ABBRV = 'VA'
 16933*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16934*          IF CP-ORIGINAL-TERM GREATER 61
 16935*             MOVE '6' TO CP-EARNING-METHOD
 16936*          ELSE
 16937*             MOVE '1' TO CP-EARNING-METHOD.
 16938
 16939     IF WS-DEFAULT-APR NOT NUMERIC
 16940         MOVE ZEROS TO WS-DEFAULT-APR.
 16941     IF CP-EARN-AS-NET-PAY
 16942         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16943            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16944                MOVE WS-DEFAULT-APR
 16945                                 TO  CP-LOAN-APR
 16946                MOVE ER-3780     TO  WS-ERROR
 16947                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16948            ELSE
 16949                MOVE ER-3781     TO  WS-ERROR
 16950                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16951     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16952     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 306
* EL050.cbl
 16953        AND CP-CANCEL-REASON = 'R'
 16954        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16955        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16956     END-IF
 16957     IF PB-COMPANY-ID = 'DCC'
 16958        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16959        AND (CP-EARNING-METHOD = 'D')
 16960        AND (CP-CANCEL-REASON NOT = 'R')
 16961        CONTINUE
 16962     ELSE
 16963        GO TO 3750-CONTINUE
 16964     END-IF
 16965     MOVE ' '                    TO DD-IU-SW
 16966     IF NOT PDEF-MASTER-FOUND
 16967        MOVE ' '                 TO PDEF-MASTER-SW
 16968        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16969        MOVE PB-STATE            TO ERPDEF-STATE
 16970        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16971           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16972        END-IF
 16973        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16974        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16975        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16976        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16977        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16978        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16979        IF PDEF-MASTER-FOUND
 16980           MOVE 'N'              TO PDEF-MASTER-SW
 16981           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16982           IF PDEF-MASTER-FOUND
 16983              IF (ERPDEF-KEY-SAVE (1:16) =
 16984                           PD-CONTROL-PRIMARY (1:16))
 16985                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16986                 CONTINUE
 16987              ELSE
 16988                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16989                 IF (ERPDEF-KEY-SAVE (1:16) =
 16990                           PD-CONTROL-PRIMARY (1:16))
 16991                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16992                    CONTINUE
 16993                 ELSE
 16994                    MOVE ER-2740 TO WS-ERROR
 16995                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16996                    GO TO 3770-CHECK-REFUNDS
 16997                 END-IF
 16998              END-IF
 16999           END-IF
 17000           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17001        END-IF
 17002     END-IF
 17003     IF PDEF-MASTER-FOUND
 17004        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17005           (V1 > +8)
 17006           OR (PD-PROD-CODE (V1) = 'I')
 17007        END-PERFORM
 17008        IF V1 < +9
 17009           SET DD-IU-PRESENT        TO TRUE
 17010        END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 307
* EL050.cbl
 17011        IF WS-AH-DCC-TRUNC = 'T'
 17012           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17013        ELSE
 17014           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17015        END-IF
 17016        EVALUATE TRUE
 17017           WHEN WS-TERM > +168
 17018              MOVE 15               TO V1
 17019           WHEN WS-TERM > +156
 17020              MOVE 14               TO V1
 17021           WHEN WS-TERM > +144
 17022              MOVE 13               TO V1
 17023           WHEN WS-TERM > +132
 17024              MOVE 12               TO V1
 17025           WHEN WS-TERM > +120
 17026              MOVE 11               TO V1
 17027           WHEN WS-TERM > +108
 17028              MOVE 10               TO V1
 17029           WHEN WS-TERM > +96
 17030              MOVE 9                TO V1
 17031           WHEN WS-TERM > +84
 17032              MOVE 8                TO V1
 17033           WHEN WS-TERM > +72
 17034              MOVE 7                TO V1
 17035           WHEN WS-TERM > +60
 17036              MOVE 6                TO V1
 17037           WHEN WS-TERM > +48
 17038              MOVE 5                TO V1
 17039           WHEN WS-TERM > +36
 17040              MOVE 4                TO V1
 17041           WHEN WS-TERM > +24
 17042              MOVE 3                TO V1
 17043           WHEN WS-TERM > +12
 17044              MOVE 2                TO V1
 17045           WHEN OTHER
 17046              MOVE 1                TO V1
 17047        END-EVALUATE
 17048
 17049        EVALUATE TRUE
 17050*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17051*             < +13)
 17052*             AND (DD-IU-PRESENT)
 17053*             MOVE 2                TO V2
 17054*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17055*             MOVE 1                TO V2
 17056           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17057              MOVE 2                TO V2
 17058           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17059              MOVE 3                TO V2
 17060           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17061              MOVE 4                TO V2
 17062           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17063              MOVE 5                TO V2
 17064           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17065              MOVE 6                TO V2
 17066           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17067              MOVE 7                TO V2
 17068           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 308
* EL050.cbl
 17069              MOVE 8                TO V2
 17070           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17071              MOVE 9                TO V2
 17072           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17073              MOVE 10               TO V2
 17074           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17075              MOVE 11               TO V2
 17076           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17077              MOVE 12               TO V2
 17078           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17079              MOVE 13               TO V2
 17080           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17081              MOVE 14               TO V2
 17082           WHEN OTHER
 17083              MOVE 15               TO V2
 17084        END-EVALUATE
 17085
 17086        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17087                                 TO CP-DDF-LO-FACT
 17088        MOVE PD-UEP-FACTOR (V1 V2)
 17089                                 TO CP-DDF-HI-FACT
 17090
 17091        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17092        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17093        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17094           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17095        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17096        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17097        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17098           + PD-1ST-YR-ADMIN-ALLOW
 17099
 17100        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17101*       IF PI-CLP-YN = 'Y'
 17102*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17103*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17104*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17105*       END-IF
 17106
 17107        IF DD-IU-PRESENT
 17108           MOVE 'I'              TO CP-EARNING-METHOD
 17109        END-IF
 17110        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17111                                     CP-CLP-RATE-UP
 17112        IF CP-IU-RATE-UP NOT = ZEROS
 17113           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17114              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17115           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17116              / (1 - WS-WORK-FACT)
 17117        END-IF
 17118     END-IF
 17119     .
 17120 3750-CONTINUE.
 17121     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17122
 17123     IF CP-REFUND-TYPE-USED NOT = SPACE
 17124         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17125
 17126     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 309
* EL050.cbl
 17127        CP-ERROR-RATE-NOT-FOUND
 17128        MOVE ER-2740             TO WS-ERROR
 17129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17130
 17131     IF CP-ERROR-RATE-FILE-NOTOPEN
 17132        MOVE ER-2617             TO WS-ERROR
 17133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17134     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17135        AND (PB-CI-ENTRY-STATUS = 'M')
 17136        MOVE +0                  TO PB-C-AH-REF-CALC
 17137     ELSE
 17138        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17139     END-IF
 17140     if pb-company-id = 'VPP'
 17141        MOVE cm-ah-clp           to cp-original-premium
 17142        move zeros               to cp-calc-refund
 17143        perform 7600-get-refund  thru 7600-exit
 17144        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17145           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17146        else
 17147           move zeros            to pb-c-ah-rfnd-clp
 17148        end-if
 17149        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17150           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17151           pb-ci-cancel-fee
 17152     end-if
 17153     IF PB-COMPANY-ID = 'DCC'
 17154        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17155        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17156        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17157        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17158        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17159        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17160        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17161        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17162*       if pb-c-cancel-amt < +0
 17163*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17164*       end-if
 17165*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17166     END-IF
 17167     .
 17168 3770-CHECK-REFUNDS.
 17169
 17170     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17171        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17172           MOVE ER-2766          TO WS-ERROR
 17173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17174           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17175           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17176              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17177
 17178     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17179        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17180           MOVE ER-2766          TO WS-ERROR
 17181           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17182           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17183           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17184              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 310
* EL050.cbl
 17185
 17186     IF PB-COMP-LF-CANCEL
 17187        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17188        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17189           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17190              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17191
 17192     IF PB-COMP-AH-CANCEL
 17193        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17194        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17195           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17196              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17197
 17198     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17199             GIVING WS-UNSIGN-WRK1
 17200     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17201             GIVING WS-UNSIGN-WRK2.
 17202
 17203     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17204         MOVE ZERO TO WS-UNSIGN-WRK1.
 17205
 17206     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17207         MOVE ZERO TO WS-UNSIGN-WRK2.
 17208
 17209     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17210
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 311
* EL050.cbl
 17212
 17213 3772-CONTINUE.
 17214
 17215**********************************
 17216*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17217*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17218*** DOUBLES THE TOLERANCE AMOUNT.
 17219***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17220**********************************
 17221     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17222     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17223         IF WS-REF-REJECT-SW = SPACE
 17224             MOVE ER-2754        TO WS-ERROR
 17225             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17226           ELSE
 17227             MOVE ER-2736        TO WS-ERROR
 17228             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17229**********************************
 17230
 17231 3773-CONTINUE.
 17232
 17233     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17234        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17235           MOVE ER-2723          TO WS-ERROR
 17236           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17237
 17238     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17239        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17240           MOVE ER-2724          TO WS-ERROR
 17241           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17242
 17243     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17244         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17245             (1 + WS-LF-REFUND-OVS-PCT)
 17246     ELSE
 17247         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17248
 17249     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17250         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17251             (1 - WS-TOL-LF-REFUND-PCT)
 17252     ELSE
 17253         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17254
 17255     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17256        AND (PB-CI-ENTRY-STATUS = 'M')
 17257        AND (PB-C-LF-CANCEL-AMT > +0)
 17258        MOVE ER-3843             TO WS-ERROR
 17259        PERFORM 9900-ERROR-FORMAT
 17260                                 THRU 9900-EXIT
 17261     END-IF
 17262     EVALUATE TRUE
 17263        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17264           CONTINUE
 17265        WHEN PB-C-LF-CANCEL-AMT = +0
 17266                 AND PB-C-LF-REF-CALC > +0
 17267           CONTINUE
 17268        WHEN WS-LF-REFUND-OVS-AMT = 0
 17269                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 312
* EL050.cbl
 17270           CONTINUE
 17271        WHEN OTHER
 17272           IF WS-TOL-LF-REFUND  = +0
 17273              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17274           END-IF
 17275           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17276                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17277                          (PB-C-LF-CANCEL-AMT))
 17278              CONTINUE
 17279           ELSE
 17280              IF WS-LF-REFUND-OVS-AMT = +0
 17281                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17282              END-IF
 17283              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17284                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17285                                       PB-C-LF-CANCEL-AMT)
 17286                 CONTINUE
 17287              ELSE
 17288                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17289                   MOVE ER-2754   TO  WS-ERROR
 17290                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17291                 ELSE
 17292                    MOVE ER-2736   TO  WS-ERROR
 17293                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17294                 END-IF
 17295              END-IF
 17296           END-IF
 17297     END-EVALUATE.
 17298
 17299     EVALUATE TRUE
 17300        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17301           CONTINUE
 17302        WHEN PB-C-LF-CANCEL-AMT = +0
 17303                 AND PB-C-LF-REF-CALC > +0
 17304           CONTINUE
 17305        WHEN OTHER
 17306           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17307               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17308              CONTINUE
 17309           ELSE
 17310              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17311               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17312                CONTINUE
 17313              ELSE
 17314                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17315                     MOVE ER-2754   TO  WS-ERROR
 17316                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17317                 ELSE
 17318                     MOVE ER-2736   TO  WS-ERROR
 17319                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17320                 END-IF
 17321              END-IF
 17322           END-IF
 17323     END-EVALUATE.
 17324
 17325     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17326         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17327             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 313
* EL050.cbl
 17328     ELSE
 17329         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17330
 17331     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17332         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17333             (1 - WS-TOL-AH-REFUND-PCT)
 17334     ELSE
 17335         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17336
 17337     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17338        AND (PB-CI-ENTRY-STATUS = 'M')
 17339        AND (PB-C-AH-CANCEL-AMT > +0)
 17340        MOVE ER-3843             TO WS-ERROR
 17341        PERFORM 9900-ERROR-FORMAT
 17342                                 THRU 9900-EXIT
 17343     END-IF
 17344     EVALUATE TRUE
 17345        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17346           CONTINUE
 17347*       WHEN PB-C-AH-REF-CALC = +0 AND
 17348*                  PB-C-AH-CANCEL-AMT > +0
 17349        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17350                   PB-C-AH-REF-CALC > +0
 17351           CONTINUE
 17352        WHEN WS-AH-REFUND-OVS-AMT = +0
 17353                AND WS-TOL-AH-REFUND = +0
 17354           CONTINUE
 17355        WHEN OTHER
 17356           IF WS-TOL-AH-REFUND = +0
 17357              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17358           END-IF
 17359           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17360               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17361                                         PB-C-AH-CANCEL-AMT)
 17362              CONTINUE
 17363           ELSE
 17364              IF WS-AH-REFUND-OVS-AMT = +0
 17365                 MOVE +9999999.99 TO
 17366                         WS-AH-REFUND-OVS-AMT
 17367              END-IF
 17368              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17369                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17370                                         PB-C-AH-CANCEL-AMT)
 17371                 CONTINUE
 17372              ELSE
 17373                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17374                    MOVE ER-2754   TO  WS-ERROR
 17375                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17376                 ELSE
 17377                    MOVE ER-2736   TO  WS-ERROR
 17378                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17379                 END-IF
 17380              END-IF
 17381           END-IF
 17382     END-EVALUATE.
 17383
 17384     EVALUATE TRUE
 17385        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 314
* EL050.cbl
 17386           CONTINUE
 17387*       WHEN PB-C-AH-REF-CALC > +0 AND
 17388*                  PB-C-AH-CANCEL-AMT = +0
 17389        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17390                   PB-C-AH-REF-CALC = +0
 17391           CONTINUE
 17392        WHEN OTHER
 17393           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17394               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17395              CONTINUE
 17396           ELSE
 17397              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17398                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17399                 CONTINUE
 17400              ELSE
 17401                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17402                     MOVE ER-2754   TO  WS-ERROR
 17403                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17404                 ELSE
 17405                     MOVE ER-2736   TO  WS-ERROR
 17406                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17407                 END-IF
 17408              END-IF
 17409           END-IF
 17410     END-EVALUATE.
 17411
 17412     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17413        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17414        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17415           AND  PB-C-LF-REF-CALC < +1.00
 17416           AND  PB-C-AH-REF-CALC < +1.00
 17417           CONTINUE
 17418        ELSE
 17419           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17420              AND (PB-CI-ENTRY-STATUS = 'M')
 17421              CONTINUE
 17422           ELSE
 17423              MOVE ER-2741       TO WS-ERROR
 17424              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17425           END-IF
 17426        END-IF
 17427     END-IF
 17428
 17429     IF (PB-C-LF-CANCEL-AMT = ZERO
 17430        AND WS-LF-BENEFIT-CD NOT = ZERO
 17431        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17432        AND PB-C-LF-REF-CALC NOT = ZERO)
 17433        OR
 17434        (PB-C-LF-CANCEL-AMT = ZERO
 17435        AND WS-LF-BENEFIT-CD NOT = ZERO
 17436        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17437             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17438                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17439                NEXT SENTENCE
 17440             ELSE
 17441                MOVE ER-2739        TO WS-ERROR
 17442                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17443
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 315
* EL050.cbl
 17444     IF (PB-C-AH-CANCEL-AMT = ZERO
 17445        AND WS-AH-BENEFIT-CD NOT = ZERO
 17446        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17447        AND PB-C-AH-REF-CALC NOT = ZERO)
 17448        OR
 17449        (PB-C-AH-CANCEL-AMT = ZERO
 17450        AND WS-AH-BENEFIT-CD NOT = ZERO
 17451        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17452             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17453                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17454                NEXT SENTENCE
 17455             ELSE
 17456                MOVE ER-2738        TO WS-ERROR
 17457                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17458
 17459 3775-OVER-REF-CHK.
 17460
 17461     IF PB-CI-ENTRY-STATUS = '5'
 17462        GO TO 3780-UPDATE-CANCEL-CERT.
 17463
 17464     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17465                              PB-CI-LF-ALT-PREMIUM-AMT.
 17466
 17467     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17468        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17469                                 PB-C-LF-REF-CALC
 17470      ELSE
 17471        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17472                                 PB-C-LF-CANCEL-AMT.
 17473
 17474     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17475        MOVE ER-2755             TO WS-ERROR
 17476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17477
 17478     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17479
 17480     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17481        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17482                                 PB-C-AH-REF-CALC
 17483      ELSE
 17484        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17485                                 PB-C-AH-CANCEL-AMT.
 17486
 17487     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17488        MOVE ER-2778             TO WS-ERROR
 17489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17490
 17491     IF PB-CI-OB-FLAG NOT = 'Z'
 17492        NEXT SENTENCE
 17493       ELSE
 17494         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17495            MOVE ER-2757           TO WS-ERROR
 17496            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17497
 17498 3780-UPDATE-CANCEL-CERT.
 17499
 17500     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17501        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 316
* EL050.cbl
 17502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17503
 17504     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17505         MOVE ER-2729              TO WS-ERROR
 17506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17507
 17508     IF PB-CI-LF-BENEFIT-CD = ZERO
 17509         GO TO 3780-UPDATE-CONT-1.
 17510
 17511     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17512         GO TO 3780-UPDATE-CONT-1.
 17513
 17514     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17515       AND
 17516        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17517       AND
 17518        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17519       AND
 17520        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17521            NEXT SENTENCE
 17522       ELSE
 17523        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17524          AND
 17525***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17526***       AND
 17527           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17528            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17529               MOVE ER-2730      TO WS-ERROR
 17530               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17531               GO TO 3999-END-EDIT
 17532            ELSE
 17533               GO TO 3999-END-EDIT
 17534        ELSE
 17535            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17536               MOVE ER-2765           TO WS-ERROR
 17537               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17538               GO TO 3785-CHECK-REF-INT.
 17539*              GO TO 3999-END-EDIT.
 17540
 17541 3780-UPDATE-CONT-1.
 17542     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17543
 17544     IF PB-CI-AH-BENEFIT-CD = ZERO
 17545         GO TO 3780-UPDATE-CONT-2.
 17546
 17547     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17548         GO TO 3780-UPDATE-CONT-2.
 17549
 17550     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17551
 17552     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17553       AND
 17554        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17555       AND
 17556        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17557       AND
 17558        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17559            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 317
* EL050.cbl
 17560       ELSE
 17561        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17562          AND
 17563***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17564***       AND
 17565           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17566           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17567            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17568               MOVE ER-2773      TO WS-ERROR
 17569               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17570               GO TO 3999-END-EDIT
 17571            ELSE
 17572               GO TO 3999-END-EDIT
 17573            END-IF
 17574           ELSE
 17575             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17576                IF MSTR-CERT-NO = W-CL-CERT-NO
 17577                   MOVE ER-2890 TO WS-ERROR
 17578                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17579                   GO TO 3999-END-EDIT
 17580                ELSE
 17581                   MOVE ER-2898 TO WS-ERROR
 17582                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17583                   GO TO 3999-END-EDIT
 17584                END-IF
 17585             ELSE
 17586                GO TO 3785-CHECK-REF-INT
 17587             END-IF
 17588           END-IF
 17589          ELSE
 17590            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17591              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17592                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17593                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17594                      MOVE ER-2890 TO WS-ERROR
 17595                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17596                      GO TO 3999-END-EDIT
 17597                   ELSE
 17598                      MOVE ER-2898 TO WS-ERROR
 17599                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17600                      GO TO 3999-END-EDIT
 17601                   END-IF
 17602                ELSE
 17603                   MOVE ER-2765 TO WS-ERROR
 17604                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17605                   GO TO 3785-CHECK-REF-INT
 17606                END-IF
 17607              ELSE
 17608               MOVE ER-2765      TO WS-ERROR
 17609               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17610               GO TO 3785-CHECK-REF-INT.
 17611*              GO TO 3999-END-EDIT.
 17612
 17613 3780-UPDATE-CONT-2.
 17614
 17615     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17616        AND WS-LF-BENEFIT-CD = ZERO
 17617           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 318
* EL050.cbl
 17618           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17619
 17620     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17621        AND WS-AH-BENEFIT-CD = ZERO
 17622           MOVE ER-2744           TO WS-ERROR
 17623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17624
 17625     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17626        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17627        AND
 17628        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17629         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17630           MOVE ER-2746           TO WS-ERROR
 17631           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17632
 17633     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17634       AND
 17635        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17636             MOVE ER-2737        TO WS-ERROR
 17637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17638
 17639     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17640       AND
 17641        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17642             MOVE ER-2737        TO WS-ERROR
 17643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17644
 17645     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17646         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17647             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17648             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17649         ELSE
 17650             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17651                 MOVE ER-2768    TO WS-ERROR
 17652                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17653             ELSE
 17654                 MOVE ER-2756    TO WS-ERROR
 17655                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17656
 17657     IF CERT-PEND-ISSUE-RETURNED
 17658        MOVE ER-2772             TO WS-ERROR
 17659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17660 3785-CHECK-REF-INT.
 17661*    IF PB-STATE NOT = 'NH' and 'TN'
 17662     IF PB-STATE NOT = 'NH'
 17663        GO TO 3999-END-EDIT
 17664     END-IF
 17665
 17666     MOVE ER-2796                TO WS-ERROR
 17667     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17668     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17669        OR (CM-REF-INTERFACE-SW = 'Y')
 17670        MOVE ER-2793             TO WS-ERROR
 17671        PERFORM 9900-ERROR-FORMAT
 17672                                 THRU 9900-EXIT
 17673     END-IF
 17674     MOVE +0                     TO WS-PAYMENT-AMT
 17675     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 319
* EL050.cbl
 17676        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17677               PB-C-AH-CANCEL-DT
 17678           GO TO 3999-END-EDIT
 17679        END-IF
 17680     end-if
 17681***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17682***-_-
 17683***-_-   For TN it's only flat cancels
 17684***-_-
 17685***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17686     if pb-state = 'TN'
 17687        if ((pb-c-lf-cancel-dt <> low-values)
 17688           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17689                      or
 17690           ((pb-c-ah-cancel-dt <> low-values)
 17691           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17692           GO TO 3999-END-EDIT
 17693        END-IF
 17694     end-if
 17695     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17696        GO TO 3999-END-EDIT
 17697     END-IF
 17698***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17699***-_-
 17700***-_-   if cancel date within 15 days of effective date, bypass
 17701***-_-
 17702***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17703     IF PB-STATE NOT = 'NH'
 17704        GO TO 3785-CONTINUE
 17705     END-IF
 17706     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17707     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17708     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17709        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17710     END-IF
 17711     MOVE '1'                    TO DC-OPTION-CODE
 17712     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17713     IF NO-CONVERSION-ERROR
 17714        IF DC-ELAPSED-DAYS < +16
 17715           GO TO 3999-END-EDIT
 17716        END-IF
 17717     END-IF
 17718***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17719***-_-
 17720***-_-   if cancel date within 30 days of current date then
 17721***-_-   bypass else subtract 15 days from period
 17722***-_-
 17723***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17724     MOVE +0                     TO DC-ELAPSED-DAYS
 17725     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17726     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17727     MOVE '1'                    TO DC-OPTION-CODE
 17728     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17729     IF NO-CONVERSION-ERROR
 17730        IF DC-ELAPSED-DAYS > +30
 17731           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17732        ELSE
 17733           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 320
* EL050.cbl
 17734        END-IF
 17735     ELSE
 17736        GO TO 3999-END-EDIT
 17737     END-IF
 17738     .
 17739 3785-CONTINUE.
 17740     if pb-state = 'TN'
 17741        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17742        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17743        MOVE '1'                 TO DC-OPTION-CODE
 17744        PERFORM 8500-DATE-CONVERT
 17745                                 THRU 8500-EXIT
 17746        IF no-CONVERSION-ERROR
 17747           IF DC-ELAPSED-DAYS < +16
 17748              GO TO 3999-END-EDIT
 17749           END-IF
 17750        END-IF
 17751     end-if
 17752***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17753***-_-
 17754***-_-   'NH' is 10%, TN is 3.5%
 17755***-_-
 17756***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17757*    if pb-state = 'NH'
 17758*       move +1.10               to ws-work-rate
 17759*    else
 17760*       move +1.035              to ws-work-rate
 17761*    end-if
 17762     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17763     display ' cal int ' ws-st-refund-int-rate ' ' ws-work-rate
 17764       ' ' dc-elapsed-days
 17765     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17766        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17767           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17768     IF WS-PAYMENT-AMT < 10.00
 17769        GO TO 3999-END-EDIT
 17770     END-IF
 17771*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17772
 17773     if (cm-soc-sec-no(1:9) numeric)
 17774        and (cm-soc-sec-no(1:9) not = zeros)
 17775        GO TO 3999-END-EDIT
 17776     END-IF
 17777     MOVE ER-2795                TO WS-ERROR
 17778     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17779
 17780     GO TO 3999-END-EDIT.
 17781******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 321
* EL050.cbl
 17783 3990-FILES-NOT-OPEN.
 17784
 17785     MOVE ER-2617                TO WS-ERROR.
 17786     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17787     GO TO 9990-RETURN.
 17788
 17789 3999-END-EDIT.
 17790
 17791     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17792
 17793     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17794         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17795         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17796             PERFORM 9250-UNLOCK-RETURN
 17797             GO TO 9990-RETURN
 17798          ELSE
 17799             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17800             GO TO 9990-RETURN.
 17801
 17802     IF PB-CANCELLATION
 17803          GO TO 9990-RETURN.
 17804
 17805     IF CERT-WAS-NOT-FOUND
 17806        MOVE SPACES              TO CERTIFICATE-MASTER.
 17807
 17808     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17809
 17810     IF CERT-WAS-FOUND
 17811         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17812             PERFORM 9250-UNLOCK-RETURN
 17813          ELSE
 17814            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17815      ELSE
 17816         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17817
 17818*    if pb-company-id = 'VPP'
 17819*       perform 8150-read-elcrtt thru 8150-exit
 17820*       if ws-vehicle-odometer numeric
 17821*          if ws-vehicle-odometer > 6000
 17822*             move er-1583       to ws-error
 17823*             PERFORM 9900-ERROR-FORMAT
 17824*                                THRU 9900-EXIT
 17825*          end-if
 17826*       end-if
 17827*    end-if
 17828     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17829        IF ((PB-COMPANY-ID = 'DCC')
 17830           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17831                         or
 17832            (pb-company-id = 'CID' or 'VPP')
 17833            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17834        END-IF
 17835     END-IF.
 17836
 17837     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17838         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17839     END-IF.
 17840     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 322
* EL050.cbl
 17841     perform 8150-read-elcrtt    thru 8150-exit
 17842     if ws-ins-age-defaulted = 'Y'
 17843        move er-1573             to ws-error
 17844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17845     end-if
 17846
 17847     if ws-jnt-age-defaulted = 'Y'
 17848        move er-1574             to ws-error
 17849        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17850     end-if
 17851***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17852***                                                           ****
 17853***  Set an error if the state requires verification of agent ****
 17854***  and agent hasn't verified yet and the status is not =    ****
 17855***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17856***  and the entry date > 09/01/2015.                         ****
 17857***                                                           ****
 17858***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17859     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17860        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17861        and (pb-account (9:2) not = 'OB')
 17862        if (ws-st-agent-sig-edit = 'Y')
 17863           and (am-report-code-1 not = 'CONLEY')
 17864           evaluate true
 17865              when cs-agent-edit-status = 'C'
 17866                 move er-1743    to ws-error
 17867                 perform 9900-error-format
 17868                                 thru 9900-exit
 17869              when cs-agent-edit-status = 'S'
 17870                 move er-1744    to ws-error
 17871                 perform 9900-error-format
 17872                                 thru 9900-exit
 17873              when cs-agent-edit-status = 'M'
 17874                 move er-1745    to ws-error
 17875                 perform 9900-error-format
 17876                                 thru 9900-exit
 17877              when cs-agent-edit-status = 'R'
 17878                 move er-1747    to ws-error
 17879                 perform 9900-error-format
 17880                                 thru 9900-exit
 17881              when cs-agent-edit-status = 'N'
 17882                 move er-1748    to ws-error
 17883                 perform 9900-error-format
 17884                                 thru 9900-exit
 17885              when cs-agent-edit-status <> 'V' and 'U' and
 17886                                           'R' and 'N'
 17887                 move er-1746    to ws-error
 17888                 perform 9900-error-format
 17889                                 thru 9900-exit
 17890           end-evaluate
 17891        end-if
 17892     end-if
 17893     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17894     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17895        AND (WS-NO-SECURE-PAY))
 17896                  OR
 17897        (WS-LF-SPECIAL-CALC-CD = 'O'
 17898        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 323
* EL050.cbl
 17899        SET SKIP-ADDR-EDIT       TO TRUE
 17900     END-IF
 17901     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17902        AND (NOT SKIP-ADDR-EDIT)
 17903        MOVE ER-2963             TO WS-ERROR
 17904        PERFORM 9900-ERROR-FORMAT
 17905                                 THRU 9900-EXIT
 17906        GO TO 9990-RETURN
 17907     END-IF
 17908     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17909     IF ERPNDM-FOUND NOT = 'X'
 17910        move 'Y'                 to erpndm-unlock-sw
 17911        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17912           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17913           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17914           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17915           or (pm-zip-code    = zeros)
 17916           or (pm-zip-code not numeric))
 17917           AND (NOT SKIP-ADDR-EDIT)
 17918           MOVE ER-2694          TO WS-ERROR
 17919           PERFORM 9900-ERROR-FORMAT
 17920                                 THRU 9900-EXIT
 17921        END-IF
 17922        MOVE ' '                 TO STATE-RECORD-ERROR
 17923        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17924        MOVE PM-STATE            TO CNTL-ACCESS
 17925        MOVE '3'                 TO CNTL-REC-TYPE
 17926        MOVE +0                  TO CNTL-SEQ-NO
 17927        MOVE '0'                 TO RC-SW-2
 17928        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17929        IF (NO-STATE-RECORD)
 17930           OR (CF-RECORD-TYPE NOT = '3')
 17931           OR (PM-STATE NOT = CF-STATE-CODE)
 17932           IF (PM-STATE = SPACES)
 17933              AND (SKIP-ADDR-EDIT)
 17934              CONTINUE
 17935           ELSE
 17936              MOVE ER-2963       TO WS-ERROR
 17937              PERFORM 9900-ERROR-FORMAT
 17938                                 THRU 9900-EXIT
 17939           END-IF
 17940        END-IF
 17941        if (ws-error not = er-2963 and er-2694)
 17942           and (pm-city-st-zip-verified = ' ')
 17943           and (pb-company-id = 'CID')
 17944           move spaces           to zipcd-pass-area
 17945           move pm-zip-code      to pa-zip
 17946           move pm-city          to pa-city
 17947           move pm-state         to pa-state
 17948           perform 7790-call-zip-verify
 17949                                 thru 7790-exit
 17950           if pa-errorcode-zip (1:1) = ' '
 17951                    move 'Y'     to pm-city-st-zip-verified
 17952                    PERFORM 8102-REWRITE-ERPNDM
 17953                                 THRU 8102-EXIT
 17954                    move 'N'     to erpndm-unlock-sw
 17955           else
 17956              MOVE ER-3061       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 324
* EL050.cbl
 17957              PERFORM 9900-ERROR-FORMAT
 17958                                 THRU 9900-EXIT
 17959           end-if
 17960        end-if
 17961        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17962           MOVE ER-2883          TO WS-ERROR
 17963           PERFORM 9900-ERROR-FORMAT
 17964                                 THRU 9900-EXIT
 17965        END-IF
 17966        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17967           MOVE ' '                 TO STATE-RECORD-ERROR
 17968           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17969           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17970           MOVE '3'                 TO CNTL-REC-TYPE
 17971           MOVE +0                  TO CNTL-SEQ-NO
 17972           MOVE '0'                 TO RC-SW-2
 17973           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17974           IF NO-STATE-RECORD
 17975              OR (CF-RECORD-TYPE NOT = '3')
 17976              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17977              MOVE ER-2964          TO WS-ERROR
 17978              PERFORM 9900-ERROR-FORMAT
 17979                                    THRU 9900-EXIT
 17980           END-IF
 17981        END-IF
 17982     ELSE
 17983        IF NOT SKIP-ADDR-EDIT
 17984           MOVE ER-2393          TO WS-ERROR
 17985           PERFORM 9900-ERROR-FORMAT
 17986                                 THRU 9900-EXIT
 17987        END-IF
 17988     END-IF
 17989     if need-to-unlock-erpndm
 17990        perform 8104-unlock-erpndm
 17991                                 thru 8104-exit
 17992     end-if
 17993     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17994
 17995     IF (ERMAIL-FOUND = ' ' AND
 17996        ERPNDM-FOUND = ' ')
 17997        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17998           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17999           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18000          OR
 18001           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18002          OR
 18003           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18004           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18005           GO TO 3999-UNLOCK-ERMAIL.
 18006
 18007     IF ERPNDM-FOUND = 'X'
 18008        GO TO 3999-UNLOCK-ERMAIL.
 18009
 18010     IF PM-INSURED-LAST-NAME      = SPACES
 18011        AND PM-INSURED-FIRST-NAME = SPACES
 18012        AND PM-ADDRESS-LINE-1     = SPACES
 18013        AND PM-ADDRESS-LINE-2     = SPACES
 18014        AND PM-CITY-STATE         = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 325
* EL050.cbl
 18015        AND PM-CRED-BENE-NAME     = SPACES
 18016        AND PM-CRED-BENE-ADDR     = SPACES
 18017        AND PM-CRED-BENE-CTYST    = SPACES
 18018        GO TO 3999-UNLOCK-ERMAIL
 18019     END-IF
 18020
 18021     MOVE SPACES                 TO MAILING-DATA.
 18022
 18023     MOVE 'MA'                   TO MA-RECORD-ID.
 18024     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18025     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18026     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18027     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18028     MOVE PB-SV-STATE            TO MA-STATE.
 18029     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18030     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18031
 18032     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18033     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18034
 18035     IF ERMAIL-FOUND = ' '
 18036        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18037     ELSE
 18038        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18039        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18040        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18041
 18042     GO TO 9990-RETURN.
 18043
 18044 3999-UNLOCK-ERMAIL.
 18045     IF ERMAIL-FOUND = ' '
 18046        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18047
 18048     GO TO 9990-RETURN.
 18049******************************************************************
 18050
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 326
* EL050.cbl
 18052 4000-UPDATE-CANCELLED-CERT.
 18053     IF CERT-WAS-NOT-FOUND
 18054        GO TO 4299-EXIT.
 18055
 18056*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18057     IF PB-C-INT-ON-REFS > ZEROS
 18058        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18059     END-IF
 18060     IF PB-C-REF-INTERFACE-SW = 'Y'
 18061        MOVE PB-C-REF-INTERFACE-SW
 18062                                 TO CM-REF-INTERFACE-SW
 18063     END-IF
 18064     IF ERMAIL-FOUND = ' '
 18065        PERFORM 8140-UNLOCK-ERMAIL
 18066                                 THRU 8140-EXIT
 18067     end-if
 18068     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18069     IF ERMAIL-FOUND = 'X'
 18070        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18071        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18072        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18073        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18074           MOVE ER-2694          TO WS-ERROR
 18075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18076     END-IF
 18077
 18078     IF PB-C-POST-CARD-IND = 'Y'
 18079        MOVE +8                  TO SUB
 18080*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18081        IF ERMAIL-FOUND = ' '
 18082           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18083              (SUB > +7)
 18084              OR (MA-MAIL-STATUS (SUB) = '1')
 18085           END-PERFORM
 18086        END-IF
 18087        IF (SUB > +7)
 18088           OR (ERMAIL-FOUND = 'X')
 18089           MOVE ER-3789          TO WS-ERROR
 18090           PERFORM 9900-ERROR-FORMAT
 18091                                 THRU 9900-EXIT
 18092        END-IF
 18093     ELSE
 18094        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18095     END-IF
 18096
 18097     IF ERMAIL-FOUND = ' '
 18098        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18099     END-IF.
 18100
 18101     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18102
 18103     IF PB-CI-OB-FLAG = 'Z'
 18104        GO TO 4150-SUMMARY-CERT-CANCEL.
 18105
 18106     IF PB-C-LF-CANCEL-VOIDED
 18107         PERFORM 4200-REVERSE-LF-CANCEL.
 18108     IF PB-C-AH-CANCEL-VOIDED
 18109         PERFORM 4200-REVERSE-AH-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 327
* EL050.cbl
 18110
 18111 4100-APPLY-LF-CANCEL.
 18112
 18113     MOVE +0                     TO WS-SUB.
 18114
 18115 4100-CHECK-LF-ERRORS.
 18116
 18117     ADD +1                       TO WS-SUB.
 18118
 18119     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18120        IF LF-COVERAGE-CANCELLED
 18121           GO TO 4100-LF-CANCEL-CONT
 18122        ELSE
 18123           GO TO 4100-UPDATE-LF-COVERAGE.
 18124
 18125     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18126                                   ER-2729 OR
 18127                                   ER-2730 OR
 18128                                   ER-2731 OR
 18129                                   ER-2732 OR
 18130                                   ER-2737 OR
 18131                                   ER-2740 OR
 18132                                   ER-2743 OR
 18133                                   ER-2749 OR
 18134                                   ER-2750 OR
 18135                                   ER-2755 OR
 18136                                   ER-2757 OR
 18137                                   ER-2760 OR
 18138                                   ER-2772 OR
 18139                                   ER-2774 OR
 18140                                   ER-2776 OR
 18141                                   ER-2794
 18142        GO TO 4100-UPDATE-LF-COVERAGE.
 18143
 18144     GO TO 4100-CHECK-LF-ERRORS.
 18145
 18146 4100-UPDATE-LF-COVERAGE.
 18147
 18148     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18149     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18150     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18151        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18152     END-IF
 18153     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18154                                      TO CM-CREDIT-INTERFACE-SW-2.
 18155     IF CM-LF-CANCEL-DT = LOW-VALUE
 18156         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18157
 18158     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18159         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18160                                         CM-LF-STATUS-AT-CANCEL.
 18161
 18162     GO TO 4100-APPLY-AH-CANCEL.
 18163
 18164 4100-LF-CANCEL-CONT.
 18165     IF PB-C-LF-CANCEL-VOIDED
 18166         GO TO 4100-APPLY-AH-CANCEL.
 18167
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 328
* EL050.cbl
 18168     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18169         GO TO 4100-APPLY-AH-CANCEL.
 18170
 18171     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18172        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18173           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18174        ELSE
 18175           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18176
 18177     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18178     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18179
 18180     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18181         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18182
 18183     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18184        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18185         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18186         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18187
 18188     IF PB-RECORD-RETURNED
 18189        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18190      ELSE
 18191        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18192
 18193 4100-APPLY-AH-CANCEL.
 18194
 18195     MOVE +0                      TO WS-SUB.
 18196
 18197 4100-CHECK-AH-ERRORS.
 18198
 18199     ADD +1                       TO WS-SUB.
 18200
 18201     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18202        IF AH-COVERAGE-CANCELLED
 18203           GO TO 4100-AH-CANCEL-CONT
 18204        ELSE
 18205           GO TO 4100-UPDATE-AH-COVERAGE.
 18206
 18207     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18208                                   ER-2729 OR
 18209                                   ER-2732 OR
 18210                                   ER-2737 OR
 18211                                   ER-2740 OR
 18212                                   ER-2744 OR
 18213                                   ER-2749 OR
 18214                                   ER-2750 OR
 18215                                   ER-2755 OR
 18216                                   ER-2757 OR
 18217                                   ER-2760 OR
 18218                                   ER-2771 OR
 18219                                   ER-2772 OR
 18220                                   ER-2773 OR
 18221                                   ER-2775 OR
 18222                                   ER-2777 OR
 18223                                   ER-2778 OR
 18224                                   ER-2794
 18225        GO TO 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 329
* EL050.cbl
 18226
 18227     GO TO 4100-CHECK-AH-ERRORS.
 18228
 18229 4100-UPDATE-AH-COVERAGE.
 18230
 18231     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18232     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18233     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18234     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18235                                      TO CM-CREDIT-INTERFACE-SW-2.
 18236     IF CM-AH-CANCEL-DT = LOW-VALUE
 18237         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18238
 18239     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18240         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18241                                         CM-AH-STATUS-AT-CANCEL.
 18242
 18243     IF LF-COVERAGE-CANCELLED
 18244         IF PB-RECORD-RETURNED
 18245              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18246          ELSE
 18247              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18248
 18249     GO TO 4299-EXIT.
 18250
 18251 4100-AH-CANCEL-CONT.
 18252     IF PB-C-AH-CANCEL-VOIDED
 18253         GO TO 4299-EXIT.
 18254
 18255     if cm-credit-interface-sw-2 = ' '
 18256        if pb-fatal-errors or pb-unforced-errors
 18257           move '4'              to cm-credit-interface-sw-2
 18258        else
 18259           move '1'              to cm-credit-interface-sw-2
 18260        end-if
 18261     end-if
 18262     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18263         GO TO 4299-EXIT.
 18264
 18265     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18266        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18267           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18268        ELSE
 18269           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18270
 18271     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18272     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18273
 18274     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18275         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18276
 18277     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18278         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18279         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18280
 18281     IF PB-RECORD-RETURNED
 18282        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18283      ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 330
* EL050.cbl
 18284        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18285
 18286     GO TO 4299-EXIT.
 18287
 18288 4150-SUMMARY-CERT-CANCEL.
 18289     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18290
 18291     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18292        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18293                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18294     ELSE
 18295        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18296                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18297
 18298     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18299        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18300                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18301     ELSE
 18302        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18303                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18304
 18305     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18306        NEXT SENTENCE
 18307     ELSE
 18308        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18309
 18310     GO TO 4299-EXIT.
 18311
 18312 4200-REVERSE-LF-CANCEL.
 18313     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18314
 18315     IF CM-LF-CANCEL-APPLIED
 18316        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18317        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18318        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18319
 18320     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18321
 18322     IF PB-RECORD-RETURNED
 18323        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18324       ELSE
 18325        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18326
 18327 4200-REVERSE-LF-EXIT.
 18328       EXIT.
 18329
 18330 4200-REVERSE-AH-CANCEL.
 18331     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18332
 18333     IF CM-AH-CANCEL-APPLIED
 18334        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18335        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18336        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18337
 18338     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18339
 18340     IF PB-RECORD-RETURNED
 18341        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 331
* EL050.cbl
 18342       ELSE
 18343        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18344
 18345 4200-REVERSE-AH-EXIT.
 18346       EXIT.
 18347
 18348 4299-EXIT.
 18349       EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 332
* EL050.cbl
 18351
 18352 4500-UPDATE-NEW-CERT.
 18353     IF CERT-WAS-FOUND
 18354         NEXT SENTENCE
 18355       ELSE
 18356         GO TO 4520-BUILD-NEW-KEY.
 18357
 18358     IF  CLASIC-CREATED-CERT
 18359         GO TO 4999-EXIT.
 18360
 18361     IF  CERT-WAS-CREATED-FOR-CLAIM
 18362         GO TO 4520-BUILD-NEW-KEY.
 18363
 18364     IF CERT-ADDED-BATCH
 18365        IF CM-RECORD-ID = 'CM'
 18366            GO TO 4999-EXIT.
 18367
 18368 4520-BUILD-NEW-KEY.
 18369* BUILD CONTROL PRIMARY
 18370
 18371     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18372                                       CM-COMPANY-CD-A1
 18373                                       CM-COMPANY-CD-A2
 18374                                       CM-COMPANY-CD-A4
 18375                                       CM-COMPANY-CD-A5.
 18376
 18377     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18378     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18379     MOVE PB-SV-STATE               TO CM-STATE.
 18380     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18381     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18382     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18383     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18384
 18385     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18386
 18387     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18388     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18389     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18390     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18391
 18392     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18393        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18394
 18395     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18396         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18397         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18398         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18399         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18400     ELSE
 18401         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18402
 18403     IF PB-COMPANY-ID   EQUAL  'CRI'
 18404         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18405         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18406         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18407         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18408         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 333
* EL050.cbl
 18409
 18410     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18411        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18412         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18413
 18414     IF PB-COMPANY-ID  = 'LBL'
 18415        IF PB-I-JOINT-COVERAGE
 18416            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18417                                           PB-I-MEMBER-NO
 18418            GO TO 4550-CONT-CERT-PROCESS.
 18419
 18420     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18421        NEXT SENTENCE
 18422     ELSE
 18423        GO TO 4540-BUILD-MEMBER-NO.
 18424
 18425******************************************************************
 18426*                                                                *
 18427*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18428*    FOR 'MON'.                                                  *
 18429*                                                                *
 18430******************************************************************
 18431
 18432     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18433     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18434     MOVE +1                     TO WS-SUB1
 18435                                    WS-SUB2.
 18436
 18437 4530-EDIT-MEMB-NAME.
 18438
 18439     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18440        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18441        ADD +1                       TO WS-SUB2.
 18442
 18443     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18444        ADD +1                       TO WS-SUB1
 18445        GO TO 4530-EDIT-MEMB-NAME.
 18446
 18447     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18448     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18449     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18450*    MOVE SPACE                      TO DC-OPTION-CODE.
 18451     SET  BIN-TO-GREG                TO TRUE.
 18452     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18453     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18454
 18455     GO TO 4550-CONT-CERT-PROCESS.
 18456
 18457******************************************************************
 18458*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18459******************************************************************
 18460
 18461 4540-BUILD-MEMBER-NO.
 18462
 18463     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18464         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18465         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18466         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 334
* EL050.cbl
 18467         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18468     ELSE
 18469         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18470
 18471     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18472        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18473         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18474
 18475 4550-CONT-CERT-PROCESS.
 18476
 18477*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18478*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18479*    ELSE
 18480*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18481
 18482     IF CERT-WAS-CREATED-FOR-CLAIM
 18483        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18484        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18485
 18486     IF CERT-AND-CLAIM-ONLINE
 18487        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18488        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18489
 18490     MOVE 'CM'                     TO CM-RECORD-ID.
 18491     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18492
 18493     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18494        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18495        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18496     ELSE
 18497        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18498        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18499
 18500     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18501     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18502     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18503     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18504     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18505     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18506     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18507                                      CM-LF-ITD-CANCEL-AMT
 18508                                      CM-LF-ITD-DEATH-AMT
 18509                                      CM-AH-ITD-AH-PMT
 18510                                      CM-AH-ITD-LUMP-PMT
 18511                                      CM-AH-ITD-CANCEL-AMT
 18512                                      CM-LF-NSP-PREMIUM-AMT
 18513                                      CM-AH-NSP-PREMIUM-AMT.
 18514*                                     CM-CLAIM-DEDUCT-WITHHELD
 18515*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18516     if pb-i-loan-apr = +99.9999
 18517        move zeros                 to cm-loan-apr
 18518     else
 18519        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18520     end-if
 18521     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18522     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18523     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18524     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 335
* EL050.cbl
 18525     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18526     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18527     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18528     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18529     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18530     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18531     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18532
 18533     IF PB-I-LIVES NOT NUMERIC
 18534         MOVE ZERO                 TO PB-I-LIVES.
 18535
 18536     IF PB-I-NUM-BILLED NOT NUMERIC
 18537         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18538
 18539     MOVE PB-I-LIVES               TO CM-LIVES.
 18540     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18541
 18542     IF PB-COMPANY-ID EQUAL  'DMD'
 18543         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18544         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18545
 18546     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18547     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18548     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18549     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18550     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18551     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18552
 18553     IF PB-I-LF-POLICY-FEE NUMERIC
 18554        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18555     ELSE
 18556        MOVE +0                    TO CM-LF-POLICY-FEE.
 18557
 18558     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18559        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18560        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18561     ELSE
 18562        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18563
 18564     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18565     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18566     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18567     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18568     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18569     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18570     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18571     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18572     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18573
 18574     IF PB-I-CANCEL-FEE NUMERIC
 18575        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18576     ELSE
 18577        MOVE +0                  TO CM-CANCEL-FEE
 18578     END-IF
 18579
 18580     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18581        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18582     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 336
* EL050.cbl
 18583        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18584
 18585     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18586     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18587
 18588     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18589                                      CM-LF-DEATH-EXIT-DT
 18590                                      CM-AH-SETTLEMENT-EXIT-DT.
 18591
 18592*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18593*                       'TIH' OR 'OFL' OR 'FLA' OR
 18594*                       'TII' OR 'TMS' OR 'CRI' OR
 18595*                       'NCL'
 18596     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18597
 18598     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18599         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18600            MOVE '2'                TO CM-PREMIUM-TYPE.
 18601
 18602     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18603         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18604            MOVE '2'                TO CM-PREMIUM-TYPE.
 18605
 18606     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18607         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18608     ELSE
 18609         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18610         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18611
 18612     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18613     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18614     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18615     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18616     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18617     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18618     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18619     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18620
 18621     IF PB-NO-MONTHS-SKIPPED
 18622         MOVE SPACE                 TO CM-SKIP-CODE
 18623     ELSE
 18624         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18625
 18626     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18627     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18628                                       CM-LF-STATUS-AT-CANCEL.
 18629
 18630     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18631     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18632                                       CM-AH-STATUS-AT-CANCEL.
 18633
 18634     MOVE '1'                       TO CM-ENTRY-STATUS.
 18635
 18636     IF PB-REISSUED-CERT
 18637        MOVE '5'                    TO CM-ENTRY-STATUS.
 18638
 18639     IF PB-MONTHLY-CERT
 18640        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 337
* EL050.cbl
 18641
 18642     IF PB-CASH-CERT
 18643        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18644
 18645     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18646     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18647     IF PB-POLICY-IS-DECLINED
 18648        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18649
 18650     IF PB-POLICY-IS-VOIDED
 18651        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18652
 18653     IF PB-NEEDS-UNDERWRITING
 18654        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18655
 18656     IF PB-REIN-ONLY-CERT
 18657        MOVE '9'                    TO CM-ENTRY-STATUS.
 18658
 18659     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18660         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18661     ELSE
 18662         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18663
 18664     IF PB-RECORD-RETURNED
 18665        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18666      ELSE
 18667        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18668
 18669     IF PB-I-MAIL-ADDRS-PRESENT
 18670        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18671
 18672     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18673                                       CM-ENTRY-DT.
 18674
 18675 4999-EXIT.
 18676     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 338
* EL050.cbl
 18678
 18679 5000-PROCESS-REPS.
 18680     MOVE ' '                    TO AGTC-MASTER-SW
 18681     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18682     MOVE CO-TYPE                TO AGTC-TYPE
 18683     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18684     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18685     IF (AGTC-MASTER-SW NOT = 'N')
 18686        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18687        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18688        PERFORM 8583-READ-ERAGTC-NEXT
 18689                                 THRU 8583-EXIT
 18690     END-IF
 18691     IF AGTC-MASTER-SW = 'N'
 18692        CONTINUE
 18693     ELSE
 18694        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18695           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18696              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18697              MOVE 'Y'           TO AGTC-MASTER-SW
 18698           END-IF
 18699        END-IF
 18700     END-IF
 18701     .
 18702 5000-EXIT.
 18703     EXIT.
 18704 6370-EDIT-INPUT-LF-CODE.
 18705     move ' ' to ws-benefit-cd-chg-sw
 18706     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18707        MOVE +1                  TO SUB
 18708        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18709        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18710        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18711        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18712        GO TO 6370-SEARCH-LOOP.
 18713
 18714     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18715
 18716     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18717     MOVE SPACES                 TO CNTL-ACCESS.
 18718*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18719     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18720     MOVE +0                     TO CNTL-SEQ-NO.
 18721     MOVE '4' TO RC-SW-2.
 18722     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18723
 18724     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18725        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18726        GO TO 6370-NO-LF-FOUND.
 18727
 18728     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18729     MOVE +1                     TO SUB.
 18730
 18731 6370-SEARCH-LOOP.
 18732     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18733         GO TO 6370-NO-LF-FOUND.
 18734
 18735     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 339
* EL050.cbl
 18736        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18737           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18738           set benefit-code-chg to true
 18739        end-if
 18740        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18741        GO TO 6370-HER-NET-PAY-CHECK.
 18742
 18743     ADD 1   TO SUB.
 18744*    IF SUB GREATER 120
 18745     IF SUB GREATER 200
 18746         GO TO 6370-NO-LF-FOUND.
 18747
 18748     GO TO 6370-SEARCH-LOOP.
 18749
 18750 6370-NO-LF-FOUND.
 18751
 18752     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18753        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18754        set benefit-code-chg to true
 18755     end-if
 18756     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18757
 18758 6370-HER-NET-PAY-CHECK.
 18759
 18760     IF PB-COMPANY-ID = 'CID'
 18761        IF PB-SV-STATE = 'CA' OR 'MN'
 18762           IF PB-I-LF-BENEFIT-CD = '02'
 18763              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18764           ELSE
 18765              IF PB-I-LF-BENEFIT-CD = '04'
 18766                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18767              END-IF
 18768           END-IF
 18769        END-IF
 18770     END-IF
 18771
 18772     IF PB-COMPANY-ID NOT = 'HER'
 18773         GO TO 6370-EXIT.
 18774
 18775     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18776         GO TO 6370-EXIT.
 18777
 18778     IF PB-I-LF-TERM NOT NUMERIC
 18779         MOVE ZEROS              TO PB-I-LF-TERM.
 18780
 18781     IF PB-I-LOAN-TERM NOT NUMERIC
 18782         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18783
 18784     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18785         GO TO 6370-EXIT.
 18786
 18787     IF PB-I-LF-BENEFIT-CD = '33'
 18788         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18789
 18790     IF PB-I-LF-BENEFIT-CD = '34'
 18791         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18792
 18793 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 340
* EL050.cbl
 18794     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 341
* EL050.cbl
 18796
 18797 6380-EDIT-INPUT-AH-CODE.
 18798     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18799        MOVE +1                  TO SUB
 18800        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18801        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18802        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18803        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18804        GO TO 6380-SEARCH-LOOP.
 18805
 18806     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18807
 18808     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18809     MOVE SPACES                 TO CNTL-ACCESS.
 18810     MOVE 'A'                    TO CNTL-REC-TYPE.
 18811*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18812     MOVE +0                     TO CNTL-SEQ-NO.
 18813     MOVE '5' TO RC-SW-2.
 18814     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18815
 18816     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18817        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18818        GO TO 6380-NO-AH-FOUND.
 18819
 18820     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18821     MOVE +1 TO SUB.
 18822
 18823 6380-SEARCH-LOOP.
 18824     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18825         GO TO 6380-NO-AH-FOUND.
 18826
 18827     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18828         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18829         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18830
 18831     ADD 1   TO SUB.
 18832     IF SUB GREATER THAN 96
 18833*    IF SUB GREATER THAN 300
 18834         GO TO 6380-NO-AH-FOUND.
 18835
 18836     GO TO 6380-SEARCH-LOOP.
 18837
 18838 6380-NO-AH-FOUND.
 18839
 18840     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18841
 18842     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18843         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18844     ELSE
 18845         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18846
 18847 6380-CSO-AH-ONLY-CHECKS.
 18848
 18849     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18850        NEXT SENTENCE
 18851      ELSE
 18852        GO TO 6380-EXIT.
 18853
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 342
* EL050.cbl
 18854     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18855         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18856
 18857
 18858     GO TO 6380-EXIT
 18859     .
 18860 6380-CSO-LIFE-WITH-AH-CHECKS.
 18861
 18862
 18863     .
 18864 6380-EXIT.
 18865     EXIT.
 18866
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 343
* EL050.cbl
 18868
 18869 6400-COMPUTE-EXTENSION-DAYS.
 18870
 18871******************************************************************
 18872*                                                                *
 18873*                   COMPUTE EXTENSION DAYS                       *
 18874*                                                                *
 18875*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18876*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18877*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18878*    THE EXTENSION DAYS.                                         *
 18879*                                                                *
 18880******************************************************************
 18881
 18882     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18883     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18884
 18885******************************************************************
 18886*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18887*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18888******************************************************************
 18889
 18890     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18891        COMPUTE WS-ODD-DAYS-OVER =
 18892               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18893     ELSE
 18894        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18895
 18896     IF WS-ODD-DAYS-OVER = ZEROS
 18897           GO TO 6499-EXIT
 18898     ELSE
 18899        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18900           IF WS-WDF-MONTH = 02
 18901              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18902              ADD 2       TO  WS-ODD-DAYS-OVER
 18903              GO TO 6499-EXIT
 18904           ELSE
 18905              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18906                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18907                 GO TO 6499-EXIT
 18908               ELSE
 18909                 GO TO 6499-EXIT
 18910        ELSE
 18911           GO TO 6499-EXIT.
 18912
 18913 6412-CHECK-TO-DAY.
 18914
 18915        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18916           IF WS-WDT-DAY = 28
 18917              ADD 2              TO WS-ODD-DAYS-OVER
 18918           ELSE
 18919              IF WS-WDT-DAY = 29
 18920                 ADD 1           TO WS-ODD-DAYS-OVER
 18921              ELSE
 18922                 NEXT SENTENCE
 18923        ELSE
 18924           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18925              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 344
* EL050.cbl
 18926
 18927     GO TO 6499-EXIT.
 18928
 18929
 18930 6415-CHECK-LEAP-YEAR.
 18931
 18932     IF DC-DAYS-IN-MONTH = 29
 18933        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18934
 18935 6415-EXIT.
 18936     EXIT.
 18937
 18938 6499-EXIT.
 18939      EXIT.
 18940
 18941 6500-END.
 18942     EXIT.
 18943
 18944
 18945******************************************************************
 18946************* PROCEDURE DIVISION FOR EL050 ***********************
 18947********************** ELC50PD END *******************************
 18948
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 345
* EL050.cbl
 18950
 18951**START***********************************************************
 18952*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18953*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18954******************************************************************
 18955*
 18956 6600-GET-STATE-MUNICIPAL-TAX.
 18957
 18958     IF PB-COMPANY-ID NOT = 'DMD'
 18959         GO TO 6640-EXIT.
 18960
 18961     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18962     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18963     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18964*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18965*
 18966***  Y2K PROJ 7744
 18967     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18968     SET BIN-TO-GREG          TO TRUE.
 18969     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18970
 18971     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18972
 18973     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18974     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18975
 18976
 18977* EXEC CICS HANDLE CONDITION
 18978*        INVREQ    (6610-START-BROWSE)
 18979*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18980*        NOTFND    (6630-END-OF-FILE)
 18981*    END-EXEC.
 18982*    MOVE '"$8JI                 ! # #00018966' TO DFHEIV0
 18983     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18984     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18985     MOVE X'2320233030303138393636' TO DFHEIV0(25:11)
 18986     CALL 'kxdfhei1' USING DFHEIV0
 18987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18988
 18989
 18990 6610-START-BROWSE.
 18991
 18992
 18993* EXEC CICS HANDLE CONDITION
 18994*        NOTFND    (6630-END-OF-FILE)
 18995*        DISABLED  (6630-ERRESS-PROBLEM)
 18996*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18997*        ENDFILE   (6630-END-OF-FILE)
 18998*    END-EXEC.
 18999*    MOVE '"$IcJ''                ! $ #00018974' TO DFHEIV0
 19000     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19002     MOVE X'2420233030303138393734' TO DFHEIV0(25:11)
 19003     CALL 'kxdfhei1' USING DFHEIV0
 19004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19005
 19006
 19007
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 346
* EL050.cbl
 19008* EXEC CICS STARTBR
 19009*        DATASET (FILE-ID-ERRESS)
 19010*        RIDFLD  (WS-ERRESS-KEY)
 19011*        GTEQ
 19012*    END-EXEC.
 19013     MOVE 0
 19014       TO DFHEIV11
 19015*    MOVE '&,         G          &   #00018981' TO DFHEIV0
 19016     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19017     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19018     MOVE X'2020233030303138393831' TO DFHEIV0(25:11)
 19019     CALL 'kxdfhei1' USING DFHEIV0,
 19020           FILE-ID-ERRESS,
 19021           WS-ERRESS-KEY,
 19022           DFHEIV99,
 19023           DFHEIV11,
 19024           DFHEIV99
 19025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19026
 19027
 19028 6620-READ-NEXT-ERRESS-MASTER.
 19029
 19030
 19031* EXEC CICS HANDLE CONDITION
 19032*        NOTFND    (6630-END-OF-FILE)
 19033*        ENDFILE   (6630-END-OF-FILE)
 19034*        DISABLED  (6630-ERRESS-PROBLEM)
 19035*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19036*    END-EXEC.
 19037*    MOVE '"$I''cJ                ! % #00018989' TO DFHEIV0
 19038     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19040     MOVE X'2520233030303138393839' TO DFHEIV0(25:11)
 19041     CALL 'kxdfhei1' USING DFHEIV0
 19042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19043
 19044
 19045
 19046* EXEC CICS READNEXT
 19047*        DATASET (FILE-ID-ERRESS)
 19048*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19049*        RIDFLD  (WS-ERRESS-KEY)
 19050*    END-EXEC.
 19051     MOVE LENGTH OF
 19052      RESIDENT-STATE-TAX-MASTER
 19053       TO DFHEIV12
 19054     MOVE 0
 19055       TO DFHEIV11
 19056*    MOVE '&.IL                  )   #00018996' TO DFHEIV0
 19057     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19058     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19059     MOVE X'2020233030303138393936' TO DFHEIV0(25:11)
 19060     CALL 'kxdfhei1' USING DFHEIV0,
 19061           FILE-ID-ERRESS,
 19062           RESIDENT-STATE-TAX-MASTER,
 19063           DFHEIV12,
 19064           WS-ERRESS-KEY,
 19065           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 347
* EL050.cbl
 19066           DFHEIV11,
 19067           DFHEIV99,
 19068           DFHEIV99
 19069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19070
 19071
 19072     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19073
 19074* EXEC CICS ENDBR
 19075*            DATASET (FILE-ID-ERRESS)
 19076*       END-EXEC
 19077     MOVE 0
 19078       TO DFHEIV11
 19079*    MOVE '&2                    $   #00019003' TO DFHEIV0
 19080     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19081     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19082     MOVE X'2020233030303139303033' TO DFHEIV0(25:11)
 19083     CALL 'kxdfhei1' USING DFHEIV0,
 19084           FILE-ID-ERRESS,
 19085           DFHEIV11,
 19086           DFHEIV99
 19087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19088        GO TO 6630-END-OF-FILE.
 19089
 19090     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19091        NEXT SENTENCE
 19092      ELSE
 19093        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19094
 19095*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19096*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19097*
 19098     MOVE +2                     TO WS-SUB1.
 19099
 19100     IF PB-ISSUE
 19101     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19102        MOVE +1                  TO WS-SUB1.
 19103
 19104     IF PB-CANCELLATION
 19105     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19106        MOVE +1                  TO WS-SUB1.
 19107*
 19108*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19109*
 19110***  Y2K PROJ 7744
 19111     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19112***  Y2K PROJ 7744
 19113
 19114*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19115* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19116* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19117
 19118     ADD 1                    TO WS-YEAR-YY.
 19119
 19120     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19121         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19122                              TO WS-RES-STATE-TAX
 19123         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 348
* EL050.cbl
 19124                              TO WS-RES-MUNI-TAX
 19125     ELSE
 19126         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19127                              TO WS-RES-STATE-TAX
 19128         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19129                              TO WS-RES-MUNI-TAX.
 19130
 19131*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19132
 19133     IF PB-CANCELLATION
 19134         GO TO 6640-CANCEL-TAX.
 19135
 19136     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19137         COMPUTE PB-I-STATE-TAX ROUNDED =
 19138                                   PB-I-LF-PREMIUM-AMT
 19139                                 * WS-RES-STATE-TAX
 19140         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19141                                   PB-I-LF-PREMIUM-AMT
 19142                                 * WS-RES-MUNI-TAX
 19143     ELSE
 19144     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19145         COMPUTE PB-I-STATE-TAX ROUNDED =
 19146                                   PB-I-AH-PREMIUM-AMT
 19147                                 * WS-RES-STATE-TAX
 19148         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19149                                   PB-I-AH-PREMIUM-AMT
 19150                                 * WS-RES-MUNI-TAX.
 19151
 19152
 19153* EXEC CICS ENDBR
 19154*         DATASET (FILE-ID-ERRESS)
 19155*    END-EXEC.
 19156     MOVE 0
 19157       TO DFHEIV11
 19158*    MOVE '&2                    $   #00019070' TO DFHEIV0
 19159     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19160     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19161     MOVE X'2020233030303139303730' TO DFHEIV0(25:11)
 19162     CALL 'kxdfhei1' USING DFHEIV0,
 19163           FILE-ID-ERRESS,
 19164           DFHEIV11,
 19165           DFHEIV99
 19166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19167
 19168
 19169     GO TO 6640-EXIT.
 19170
 19171 6640-CANCEL-TAX.
 19172     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19173
 19174     IF PB-C-LF-CANCEL-AMT > ZEROS
 19175         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19176                                   PB-C-LF-CANCEL-AMT
 19177                                 * WS-RES-STATE-TAX
 19178         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19179                                   PB-C-LF-CANCEL-AMT
 19180                                *  WS-RES-MUNI-TAX
 19181     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 349
* EL050.cbl
 19182     IF PB-C-AH-CANCEL-AMT > ZEROS
 19183         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19184                                   PB-C-AH-CANCEL-AMT
 19185                                 * WS-RES-STATE-TAX
 19186         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19187                                   PB-C-AH-CANCEL-AMT
 19188                                *  WS-RES-MUNI-TAX.
 19189
 19190
 19191* EXEC CICS ENDBR
 19192*         DATASET (FILE-ID-ERRESS)
 19193*    END-EXEC.
 19194     MOVE 0
 19195       TO DFHEIV11
 19196*    MOVE '&2                    $   #00019095' TO DFHEIV0
 19197     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19198     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19199     MOVE X'2020233030303139303935' TO DFHEIV0(25:11)
 19200     CALL 'kxdfhei1' USING DFHEIV0,
 19201           FILE-ID-ERRESS,
 19202           DFHEIV11,
 19203           DFHEIV99
 19204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19205
 19206
 19207     GO TO 6640-EXIT.
 19208
 19209 6630-END-OF-FILE.
 19210     MOVE ER-8002              TO WS-ERROR.
 19211     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19212
 19213     GO TO 6640-EXIT.
 19214
 19215 6630-ERRESS-PROBLEM.
 19216     MOVE ER-8044              TO WS-ERROR.
 19217     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19218
 19219 6640-EXIT.
 19220     EXIT.
 19221
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 350
* EL050.cbl
 19223 6650-GET-RES-STATE-COMM.
 19224
 19225     IF PB-COMPANY-ID NOT = 'DMD'
 19226         GO TO 6700-COMM-EXIT.
 19227
 19228     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19229     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19230     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19231     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19232     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19233     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19234     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19235
 19236*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19237*
 19238***  Y2K PROJ 7744
 19239     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19240     SET BIN-TO-GREG          TO TRUE.
 19241     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19242
 19243     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19244***  Y2K PROJ 7744
 19245
 19246     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19247
 19248
 19249* EXEC CICS HANDLE CONDITION
 19250*        INVREQ    (6660-START-BROWSE)
 19251*        DISABLED  (6690-ERRESC-PROBLEM)
 19252*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19253*        NOTFND    (6690-END-OF-FILE)
 19254*    END-EXEC.
 19255*    MOVE '"$8cJI                ! & #00019140' TO DFHEIV0
 19256     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19258     MOVE X'2620233030303139313430' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0
 19260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19261
 19262
 19263
 19264* EXEC CICS RESETBR
 19265*        DATASET (FILE-ID-ERRESC)
 19266*        RIDFLD  (WS-ERRESC-KEY)
 19267*    END-EXEC.
 19268     MOVE 0
 19269       TO DFHEIV11
 19270*    MOVE '&4         G          &   #00019147' TO DFHEIV0
 19271     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19272     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19273     MOVE X'2020233030303139313437' TO DFHEIV0(25:11)
 19274     CALL 'kxdfhei1' USING DFHEIV0,
 19275           FILE-ID-ERRESC,
 19276           WS-ERRESC-KEY,
 19277           DFHEIV99,
 19278           DFHEIV11,
 19279           DFHEIV99
 19280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 351
* EL050.cbl
 19281
 19282
 19283 6660-START-BROWSE.
 19284
 19285
 19286* EXEC CICS HANDLE CONDITION
 19287*        NOTFND    (6690-END-OF-FILE)
 19288*        DISABLED  (6690-ERRESC-PROBLEM)
 19289*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19290*        ENDFILE   (6690-END-OF-FILE)
 19291*    END-EXEC.
 19292*    MOVE '"$IcJ''                ! '' #00019154' TO DFHEIV0
 19293     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19295     MOVE X'2720233030303139313534' TO DFHEIV0(25:11)
 19296     CALL 'kxdfhei1' USING DFHEIV0
 19297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19298
 19299
 19300
 19301* EXEC CICS STARTBR
 19302*        DATASET (FILE-ID-ERRESC)
 19303*        RIDFLD  (WS-ERRESC-KEY)
 19304*        GTEQ
 19305*    END-EXEC.
 19306     MOVE 0
 19307       TO DFHEIV11
 19308*    MOVE '&,         G          &   #00019161' TO DFHEIV0
 19309     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19311     MOVE X'2020233030303139313631' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0,
 19313           FILE-ID-ERRESC,
 19314           WS-ERRESC-KEY,
 19315           DFHEIV99,
 19316           DFHEIV11,
 19317           DFHEIV99
 19318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19319
 19320
 19321     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19322
 19323 6670-READ-NEXT-ERRESC-MASTER.
 19324
 19325
 19326* EXEC CICS HANDLE CONDITION
 19327*        NOTFND    (6690-END-OF-FILE)
 19328*        DISABLED  (6690-ERRESC-PROBLEM)
 19329*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19330*        ENDFILE   (6690-END-OF-FILE)
 19331*    END-EXEC.
 19332*    MOVE '"$IcJ''                ! ( #00019171' TO DFHEIV0
 19333     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19335     MOVE X'2820233030303139313731' TO DFHEIV0(25:11)
 19336     CALL 'kxdfhei1' USING DFHEIV0
 19337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19338
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 352
* EL050.cbl
 19339
 19340
 19341* EXEC CICS READNEXT
 19342*        DATASET (FILE-ID-ERRESC)
 19343*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19344*        RIDFLD  (ERRESC-RECORD-KEY)
 19345*    END-EXEC.
 19346     MOVE LENGTH OF
 19347      ACCOUNT-RESIDENT-ST-COMMISSION
 19348       TO DFHEIV12
 19349     MOVE 0
 19350       TO DFHEIV11
 19351*    MOVE '&.IL                  )   #00019178' TO DFHEIV0
 19352     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19353     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19354     MOVE X'2020233030303139313738' TO DFHEIV0(25:11)
 19355     CALL 'kxdfhei1' USING DFHEIV0,
 19356           FILE-ID-ERRESC,
 19357           ACCOUNT-RESIDENT-ST-COMMISSION,
 19358           DFHEIV12,
 19359           ERRESC-RECORD-KEY,
 19360           DFHEIV99,
 19361           DFHEIV11,
 19362           DFHEIV99,
 19363           DFHEIV99
 19364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19365
 19366
 19367     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19368        NEXT SENTENCE
 19369     ELSE
 19370
 19371* EXEC CICS ENDBR
 19372*            DATASET (FILE-ID-ERRESC)
 19373*       END-EXEC
 19374     MOVE 0
 19375       TO DFHEIV11
 19376*    MOVE '&2                    $   #00019187' TO DFHEIV0
 19377     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303139313837' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0,
 19381           FILE-ID-ERRESC,
 19382           DFHEIV11,
 19383           DFHEIV99
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19385        GO TO 6690-END-OF-FILE.
 19386
 19387     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19388
 19389* EXEC CICS ENDBR
 19390*            DATASET (FILE-ID-ERRESC)
 19391*       END-EXEC
 19392     MOVE 0
 19393       TO DFHEIV11
 19394*    MOVE '&2                    $   #00019193' TO DFHEIV0
 19395     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19396     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 353
* EL050.cbl
 19397     MOVE X'2020233030303139313933' TO DFHEIV0(25:11)
 19398     CALL 'kxdfhei1' USING DFHEIV0,
 19399           FILE-ID-ERRESC,
 19400           DFHEIV11,
 19401           DFHEIV99
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19403        GO TO 6690-END-OF-FILE.
 19404
 19405     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19406        NEXT SENTENCE
 19407      ELSE
 19408        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19409
 19410* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19411*
 19412     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19413
 19414     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19415
 19416     IF WS-SUB1 > ZERO
 19417         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19418             PERFORM 6680-SET-COMMISSION
 19419         ELSE
 19420             PERFORM 6680-SET-TABLE-CODE.
 19421
 19422
 19423* EXEC CICS ENDBR
 19424*         DATASET (FILE-ID-ERRESC)
 19425*    END-EXEC.
 19426     MOVE 0
 19427       TO DFHEIV11
 19428*    MOVE '&2                    $   #00019215' TO DFHEIV0
 19429     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19430     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19431     MOVE X'2020233030303139323135' TO DFHEIV0(25:11)
 19432     CALL 'kxdfhei1' USING DFHEIV0,
 19433           FILE-ID-ERRESC,
 19434           DFHEIV11,
 19435           DFHEIV99
 19436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19437
 19438
 19439     GO TO 6700-COMM-EXIT.
 19440
 19441 6680-SET-TABLE-CODE.
 19442     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19443        MOVE ZEROS             TO WS-SUB1
 19444     ELSE
 19445* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19446* TO COMPUTE AH COMMISSION.
 19447        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19448        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19449        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19450        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19451        PERFORM 6680-READ-CTBL-TABLE
 19452        IF WS-CTBL-READ-SW NOT = 'Y'
 19453           MOVE ZEROS          TO WS-SUB1.
 19454
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 354
* EL050.cbl
 19455 6680-READ-CTBL-TABLE.
 19456*
 19457* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19458* TO COMPUTE LIFE COMMISSION
 19459
 19460     IF CTBL-SW = '0540'
 19461        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19462        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19463        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19464
 19465     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19466
 19467     IF CTBL-TABLE-FOUND
 19468        IF CTBL-SW = '0530'
 19469             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19470                                    * PB-I-AH-TERM
 19471             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19472             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19473        ELSE
 19474             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19475             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19476             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19477     ELSE
 19478        IF FIRST-TIME-THROUGH
 19479            GO TO 6680-READ-CTBL-TABLE
 19480        ELSE
 19481            MOVE ZEROS         TO WS-SUB1.
 19482
 19483 6680-SET-COMMISSION.
 19484     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19485           MOVE ZEROS          TO WS-SUB1
 19486       ELSE
 19487           MOVE RESC-COMMISSION-PER (WS-SUB)
 19488                               TO WS-COMMISSION
 19489           IF CTBL-SW = '0530'
 19490               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19491           ELSE
 19492               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19493
 19494 6680-SEARCH-CATEGORY.
 19495     ADD +1                   TO WS-SUB.
 19496     IF WS-SUB > +12
 19497         GO TO 6680-EXIT.
 19498
 19499     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19500          MOVE WS-SUB         TO WS-SUB1
 19501          GO TO 6680-EXIT.
 19502
 19503     GO TO 6680-SEARCH-CATEGORY.
 19504
 19505 6680-EXIT.
 19506     EXIT.
 19507
 19508 6690-END-OF-FILE.
 19509     GO TO 6700-COMM-EXIT.
 19510
 19511 6690-ERRESC-PROBLEM.
 19512      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 355
* EL050.cbl
 19513      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19514
 19515      GO TO 6700-COMM-EXIT.
 19516
 19517 6700-COMM-EXIT.
 19518     EXIT.
 19519
 19520 7000-GET-RATE.
 19521
 19522* EXEC CICS LINK
 19523*        PROGRAM    ('ELRATE')
 19524*        COMMAREA   (CALCULATION-PASS-AREA)
 19525*        LENGTH     (CP-COMM-LENGTH)
 19526*    END-EXEC.
 19527     MOVE 'ELRATE' TO DFHEIV1
 19528*    MOVE '."C                   (   #00019301' TO DFHEIV0
 19529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19531     MOVE X'2020233030303139333031' TO DFHEIV0(25:11)
 19532     CALL 'kxdfhei1' USING DFHEIV0,
 19533           DFHEIV1,
 19534           CALCULATION-PASS-AREA,
 19535           CP-COMM-LENGTH,
 19536           DFHEIV99,
 19537           DFHEIV99,
 19538           DFHEIV99,
 19539           DFHEIV99
 19540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19541
 19542
 19543 7000-EXIT.
 19544     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 356
* EL050.cbl
 19546 7100-FIND-BENEFIT-IN-STATE.
 19547     MOVE 'N'                    TO BEN-SEARCH-SW.
 19548
 19549     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19550         VARYING SUB3 FROM 1 BY 1 UNTIL
 19551            ((SUB3 GREATER 50) OR
 19552              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19553               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19554
 19555     IF SUB3 NOT = 51
 19556         MOVE 'Y'                TO BEN-SEARCH-SW.
 19557
 19558     GO TO 7199-EXIT.
 19559
 19560 7100-BENEFIT-DUMMY.
 19561
 19562 7100-DUMMY-EXIT.
 19563     EXIT.
 19564
 19565 7199-EXIT.
 19566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 357
* EL050.cbl
 19568 7200-FIND-BENEFIT.
 19569     MOVE 'N'                    TO BEN-SEARCH-SW.
 19570
 19571     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19572         VARYING SUB3 FROM 1 BY 1 UNTIL
 19573            ((SUB3 GREATER 8) OR
 19574            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19575
 19576     IF SUB3 NOT = 9
 19577         MOVE 'Y'                TO BEN-SEARCH-SW.
 19578
 19579     GO TO 7200-EXIT.
 19580
 19581 7200-BENEFIT-DUMMY.
 19582
 19583 7200-DUMMY-EXIT.
 19584     EXIT.
 19585
 19586 7200-EXIT.
 19587     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 358
* EL050.cbl
 19589 7250-LOOK-FOR-RESCINDED-CLAIM.
 19590     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19591                                    W-CL-COMP-CD.
 19592     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19593                                    W-CL-CERT-NO.
 19594
 19595
 19596* EXEC CICS HANDLE CONDITION
 19597*        NOTFND  (7250-CONTINUE)
 19598*        ENDFILE (7250-CONTINUE)
 19599*    END-EXEC.
 19600*    MOVE '"$I''                  ! ) #00019359' TO DFHEIV0
 19601     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19603     MOVE X'2920233030303139333539' TO DFHEIV0(25:11)
 19604     CALL 'kxdfhei1' USING DFHEIV0
 19605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19606
 19607
 19608
 19609* EXEC CICS IGNORE CONDITION
 19610*        DUPKEY
 19611*    END-EXEC.
 19612*    MOVE '"*$                   !   #00019364' TO DFHEIV0
 19613     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19615     MOVE X'2020233030303139333634' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0
 19617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19618
 19619
 19620
 19621* EXEC CICS STARTBR
 19622*        DATASET   (CLMS-ID)
 19623*        RIDFLD    (ELMSTR-KEY)
 19624*        GENERIC   EQUAL
 19625*        KEYLENGTH (ELMSTR-LENGTH)
 19626*    END-EXEC.
 19627     MOVE 0
 19628       TO DFHEIV11
 19629*    MOVE '&,   KG    E          &   #00019368' TO DFHEIV0
 19630     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19632     MOVE X'2020233030303139333638' TO DFHEIV0(25:11)
 19633     CALL 'kxdfhei1' USING DFHEIV0,
 19634           CLMS-ID,
 19635           ELMSTR-KEY,
 19636           ELMSTR-LENGTH,
 19637           DFHEIV11,
 19638           DFHEIV99
 19639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19640
 19641
 19642     MOVE 'Y'                    TO W-BROWSE-SW.
 19643
 19644 7250-NEXT-CLAIM.
 19645
 19646
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 359
* EL050.cbl
 19647* EXEC CICS READNEXT
 19648*        DATASET   (CLMS-ID)
 19649*        RIDFLD    (ELMSTR-KEY)
 19650*        SET       (ADDRESS OF CLAIM-MASTER)
 19651*    END-EXEC.
 19652     MOVE 0
 19653       TO DFHEIV11
 19654*    MOVE '&.S                   )   #00019379' TO DFHEIV0
 19655     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19656     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19657     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 19658     CALL 'kxdfhei1' USING DFHEIV0,
 19659           CLMS-ID,
 19660           DFHEIV20,
 19661           DFHEIV99,
 19662           ELMSTR-KEY,
 19663           DFHEIV99,
 19664           DFHEIV11,
 19665           DFHEIV99,
 19666           DFHEIV99
 19667     SET ADDRESS OF CLAIM-MASTER TO
 19668         DFHEIV20
 19669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19670
 19671
 19672     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19673        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19674         GO TO 7250-CONTINUE
 19675     END-IF.
 19676
 19677     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19678        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19679        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19680        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19681        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19682         GO TO 7250-NEXT-CLAIM
 19683     END-IF.
 19684
 19685     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19686        OR (CL-CLAIM-TYPE = 'I')
 19687        OR (CL-CLAIM-TYPE = 'G')
 19688        OR (CL-CLAIM-TYPE = 'F')
 19689          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19690              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19691              GO TO 7250-CONTINUE
 19692          END-IF
 19693     END-IF.
 19694
 19695     GO TO 7250-NEXT-CLAIM.
 19696
 19697 7250-CONTINUE.
 19698
 19699     IF W-BROWSE-SW = 'Y'
 19700
 19701* EXEC CICS ENDBR
 19702*            DATASET   (CLMS-ID)
 19703*        END-EXEC
 19704     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 360
* EL050.cbl
 19705       TO DFHEIV11
 19706*    MOVE '&2                    $   #00019413' TO DFHEIV0
 19707     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19708     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19709     MOVE X'2020233030303139343133' TO DFHEIV0(25:11)
 19710     CALL 'kxdfhei1' USING DFHEIV0,
 19711           CLMS-ID,
 19712           DFHEIV11,
 19713           DFHEIV99
 19714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19715         MOVE 'N' TO W-BROWSE-SW
 19716     END-IF.
 19717
 19718 7250-EXIT.
 19719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 361
* EL050.cbl
 19721 7300-CHECK-FOR-OPEN-CLMS.
 19722
 19723*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19724*    MOVE SPACES                 TO CNTL-ACCESS.
 19725*    MOVE '1'                    TO CNTL-REC-TYPE.
 19726*    MOVE +0                     TO CNTL-SEQ-NO.
 19727
 19728*    MOVE '3'                    TO RC-SW-1.
 19729*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19730
 19731*    IF NOT CF-COMPANY-MASTER
 19732*         PERFORM 0099-COMPANY-NOT-FOUND
 19733*         GO TO 7300-EXIT.
 19734
 19735     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19736                                    W-CL-COMP-CD.
 19737     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19738                                    W-CL-CERT-NO.
 19739
 19740
 19741* EXEC CICS HANDLE CONDITION
 19742*        NOTFND  (7300-CONTINUE)
 19743*        ENDFILE (7300-CONTINUE)
 19744*    END-EXEC.
 19745*    MOVE '"$I''                  ! * #00019441' TO DFHEIV0
 19746     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19748     MOVE X'2A20233030303139343431' TO DFHEIV0(25:11)
 19749     CALL 'kxdfhei1' USING DFHEIV0
 19750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19751
 19752
 19753
 19754* EXEC CICS IGNORE CONDITION
 19755*        DUPKEY
 19756*    END-EXEC.
 19757*    MOVE '"*$                   !   #00019446' TO DFHEIV0
 19758     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19760     MOVE X'2020233030303139343436' TO DFHEIV0(25:11)
 19761     CALL 'kxdfhei1' USING DFHEIV0
 19762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19763
 19764
 19765
 19766* EXEC CICS STARTBR
 19767*        DATASET   (CLMS-ID)
 19768*        RIDFLD    (ELMSTR-KEY)
 19769*        GENERIC   EQUAL
 19770*        KEYLENGTH (ELMSTR-LENGTH)
 19771*    END-EXEC.
 19772     MOVE 0
 19773       TO DFHEIV11
 19774*    MOVE '&,   KG    E          &   #00019450' TO DFHEIV0
 19775     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19777     MOVE X'2020233030303139343530' TO DFHEIV0(25:11)
 19778     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 362
* EL050.cbl
 19779           CLMS-ID,
 19780           ELMSTR-KEY,
 19781           ELMSTR-LENGTH,
 19782           DFHEIV11,
 19783           DFHEIV99
 19784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19785
 19786
 19787     MOVE 'Y'                    TO W-BROWSE-SW.
 19788
 19789 7300-NEXT-CLAIM.
 19790
 19791
 19792* EXEC CICS READNEXT
 19793*        DATASET   (CLMS-ID)
 19794*        RIDFLD    (ELMSTR-KEY)
 19795*        SET       (ADDRESS OF CLAIM-MASTER)
 19796*    END-EXEC.
 19797     MOVE 0
 19798       TO DFHEIV11
 19799*    MOVE '&.S                   )   #00019461' TO DFHEIV0
 19800     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19801     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19802     MOVE X'2020233030303139343631' TO DFHEIV0(25:11)
 19803     CALL 'kxdfhei1' USING DFHEIV0,
 19804           CLMS-ID,
 19805           DFHEIV20,
 19806           DFHEIV99,
 19807           ELMSTR-KEY,
 19808           DFHEIV99,
 19809           DFHEIV11,
 19810           DFHEIV99,
 19811           DFHEIV99
 19812     SET ADDRESS OF CLAIM-MASTER TO
 19813         DFHEIV20
 19814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19815
 19816
 19817     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19818        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19819         GO TO 7300-CONTINUE.
 19820
 19821     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19822        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19823        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19824        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19825        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19826         GO TO 7300-NEXT-CLAIM.
 19827
 19828*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19829     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19830        OR (CL-CLAIM-TYPE = 'I')
 19831        OR (CL-CLAIM-TYPE = 'G')
 19832        OR (CL-CLAIM-TYPE = 'F')
 19833        IF CLAIM-IS-OPEN
 19834           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19835             AND PB-C-AH-CANCEL-DT > SPACES
 19836              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 363
* EL050.cbl
 19837              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19838           END-IF
 19839           EVALUATE TRUE
 19840             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19841                 MOVE ER-2884      TO WS-ERROR
 19842             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19843                 MOVE ER-2887      TO WS-ERROR
 19844             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19845                 MOVE ER-2886      TO WS-ERROR
 19846             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19847                 MOVE ER-2888      TO WS-ERROR
 19848             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19849                 MOVE ER-2885      TO WS-ERROR
 19850             WHEN OTHER
 19851                 MOVE ER-2768      TO WS-ERROR
 19852           END-EVALUATE
 19853           IF PB-C-AH-CANCEL-VOIDED OR
 19854              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19855                NOT AH-COVERAGE-CANCELLED)
 19856               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19857               MOVE ER-2768      TO WS-ERROR
 19858           END-IF
 19859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19860           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19861              PB-FORCE-CODE NOT EQUAL '8'
 19862               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19863           END-IF
 19864           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19865           GO TO 7300-NEXT-CLAIM
 19866        ELSE
 19867           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19868*****THIS IS A RESCISSION OR REFORMATION
 19869              IF AH-COVERAGE-CANCELLED
 19870                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19871                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19872                    MOVE 1                   TO DC-ELAPSED-DAYS
 19873                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19874                    SET BIN-PLUS-ELAPSED     TO TRUE
 19875                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19876                    IF NO-CONVERSION-ERROR
 19877                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19878                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19879                          MOVE ER-2897 TO WS-ERROR
 19880                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19881                          GO TO 7300-NEXT-CLAIM
 19882                       END-IF
 19883                    END-IF
 19884                 ELSE
 19885                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19886                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19887                         MOVE ER-2890 TO WS-ERROR
 19888                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19889                         GO TO 7300-NEXT-CLAIM
 19890                      ELSE
 19891                         MOVE ER-2898 TO WS-ERROR
 19892                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19893                         GO TO 7300-NEXT-CLAIM
 19894                      END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 364
* EL050.cbl
 19895                   END-IF
 19896                 END-IF
 19897              END-IF
 19898           ELSE
 19899              IF CL-DENIAL-TYPE = '1'  AND
 19900                 CL-TOTAL-PAID-AMT = 0
 19901                    GO TO 7300-NEXT-CLAIM
 19902              END-IF
 19903              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19904               AND PB-C-AH-CANCEL-DT > SPACES
 19905                 MOVE ER-2756        TO WS-ERROR
 19906                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19907                 GO TO 7300-NEXT-CLAIM
 19908              END-IF
 19909           END-IF
 19910        END-IF
 19911     ELSE
 19912*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19913        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19914           IF (CLAIM-IS-OPEN)
 19915              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19916                 <> zeros
 19917              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19918                 <> zeros)
 19919              MOVE ER-2889      TO WS-ERROR
 19920              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19921              GO TO 7300-NEXT-CLAIM
 19922           ELSE
 19923              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19924*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19925                 IF (LF-COVERAGE-CANCELLED AND
 19926                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19927                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19928                         MOVE ER-2890 TO WS-ERROR
 19929                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19930                         GO TO 7300-NEXT-CLAIM
 19931                      ELSE
 19932                         MOVE ER-2898 TO WS-ERROR
 19933                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19934                         GO TO 7300-NEXT-CLAIM
 19935                      END-IF
 19936                 END-IF
 19937              ELSE
 19938                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19939                    and (CL-TOTAL-PAID-AMT = 0)
 19940                    GO TO 7300-NEXT-CLAIM
 19941                 END-IF
 19942                 IF (
 19943                      (AH-COVERAGE-CANCELLED)
 19944                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19945                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19946                      and (pb-ci-ah-cancel-amt +
 19947                         pb-c-ah-cancel-amt) <> zeros
 19948                    )
 19949                               OR
 19950                    (
 19951                      (LF-COVERAGE-CANCELLED)
 19952                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 365
* EL050.cbl
 19953                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19954                      and (pb-ci-lf-cancel-amt +
 19955                         pb-c-lf-cancel-amt) <> zeros
 19956                    )
 19957                       MOVE ER-2965 TO WS-ERROR
 19958                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19959                       GO TO 7300-NEXT-CLAIM
 19960                 END-IF
 19961                 IF LF-COVERAGE-CANCELLED
 19962                  IF CL-TOTAL-PAID-AMT > 0
 19963                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19964                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19965                        MOVE ER-2891 TO WS-ERROR
 19966                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19967                        GO TO 7300-NEXT-CLAIM
 19968                      END-IF
 19969                    ELSE
 19970****only show this error if cert num matches exactly
 19971                      IF PB-CERT-NO = CL-CERT-NO
 19972                         MOVE ER-2892 TO WS-ERROR
 19973                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19974                         GO TO 7300-NEXT-CLAIM
 19975                      END-IF
 19976                    END-IF
 19977                  END-IF
 19978                 END-IF
 19979              END-IF
 19980           END-IF
 19981        END-IF
 19982     END-IF
 19983
 19984     GO TO 7300-NEXT-CLAIM.
 19985
 19986 7300-CONTINUE.
 19987
 19988     IF W-BROWSE-SW = 'Y'
 19989
 19990* EXEC CICS ENDBR
 19991*            DATASET   (CLMS-ID)
 19992*        END-EXEC.
 19993     MOVE 0
 19994       TO DFHEIV11
 19995*    MOVE '&2                    $   #00019639' TO DFHEIV0
 19996     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19998     MOVE X'2020233030303139363339' TO DFHEIV0(25:11)
 19999     CALL 'kxdfhei1' USING DFHEIV0,
 20000           CLMS-ID,
 20001           DFHEIV11,
 20002           DFHEIV99
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006 7300-EXIT.
 20007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 366
* EL050.cbl
 20009
 20010 7400-GET-REMAIN-TERM.
 20011
 20012* EXEC CICS LINK
 20013*        PROGRAM    ('ELRTRM')
 20014*        COMMAREA   (CALCULATION-PASS-AREA)
 20015*        LENGTH     (CP-COMM-LENGTH)
 20016*    END-EXEC.
 20017     MOVE 'ELRTRM' TO DFHEIV1
 20018*    MOVE '."C                   (   #00019648' TO DFHEIV0
 20019     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20021     MOVE X'2020233030303139363438' TO DFHEIV0(25:11)
 20022     CALL 'kxdfhei1' USING DFHEIV0,
 20023           DFHEIV1,
 20024           CALCULATION-PASS-AREA,
 20025           CP-COMM-LENGTH,
 20026           DFHEIV99,
 20027           DFHEIV99,
 20028           DFHEIV99,
 20029           DFHEIV99
 20030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20031
 20032
 20033 7400-EXIT.
 20034     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 367
* EL050.cbl
 20036
 20037 7500-GET-REMAIN-AMOUNT.
 20038
 20039* EXEC CICS LINK
 20040*        PROGRAM    ('ELRAMT')
 20041*        COMMAREA   (CALCULATION-PASS-AREA)
 20042*        LENGTH     (CP-COMM-LENGTH)
 20043*    END-EXEC.
 20044     MOVE 'ELRAMT' TO DFHEIV1
 20045*    MOVE '."C                   (   #00019659' TO DFHEIV0
 20046     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20048     MOVE X'2020233030303139363539' TO DFHEIV0(25:11)
 20049     CALL 'kxdfhei1' USING DFHEIV0,
 20050           DFHEIV1,
 20051           CALCULATION-PASS-AREA,
 20052           CP-COMM-LENGTH,
 20053           DFHEIV99,
 20054           DFHEIV99,
 20055           DFHEIV99,
 20056           DFHEIV99
 20057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20058
 20059
 20060 7500-EXIT.
 20061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 368
* EL050.cbl
 20063
 20064 7600-GET-REFUND.
 20065
 20066* EXEC CICS LINK
 20067*        PROGRAM    ('ELRFND')
 20068*        COMMAREA   (CALCULATION-PASS-AREA)
 20069*        LENGTH     (CP-COMM-LENGTH)
 20070*    END-EXEC.
 20071     MOVE 'ELRFND' TO DFHEIV1
 20072*    MOVE '."C                   (   #00019670' TO DFHEIV0
 20073     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20075     MOVE X'2020233030303139363730' TO DFHEIV0(25:11)
 20076     CALL 'kxdfhei1' USING DFHEIV0,
 20077           DFHEIV1,
 20078           CALCULATION-PASS-AREA,
 20079           CP-COMM-LENGTH,
 20080           DFHEIV99,
 20081           DFHEIV99,
 20082           DFHEIV99,
 20083           DFHEIV99
 20084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20085
 20086
 20087 7600-EXIT.
 20088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 369
* EL050.cbl
 20090 7700-CALL-DL1.
 20091
 20092* EXEC CICS LINK
 20093*        PROGRAM    ('DLO001')
 20094*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20095*        LENGTH     (DLO001-COMM-LENGTH)
 20096*    END-EXEC.
 20097     MOVE 'DLO001' TO DFHEIV1
 20098*    MOVE '."C                   (   #00019680' TO DFHEIV0
 20099     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20101     MOVE X'2020233030303139363830' TO DFHEIV0(25:11)
 20102     CALL 'kxdfhei1' USING DFHEIV0,
 20103           DFHEIV1,
 20104           WS-DLO-MASTER-POLICY-FORM,
 20105           DLO001-COMM-LENGTH,
 20106           DFHEIV99,
 20107           DFHEIV99,
 20108           DFHEIV99,
 20109           DFHEIV99
 20110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20111
 20112
 20113 7700-EXIT.
 20114     EXIT.
 20115
 20116 7710-CALL-DL2.
 20117
 20118* EXEC CICS LINK
 20119*        PROGRAM    ('DLO002')
 20120*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20121*        LENGTH     (DLO002-COMM-LENGTH)
 20122*    END-EXEC.
 20123     MOVE 'DLO002' TO DFHEIV1
 20124*    MOVE '."C                   (   #00019690' TO DFHEIV0
 20125     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20127     MOVE X'2020233030303139363930' TO DFHEIV0(25:11)
 20128     CALL 'kxdfhei1' USING DFHEIV0,
 20129           DFHEIV1,
 20130           WS-DLO-INTERNAL-POLICY-FORM,
 20131           DLO002-COMM-LENGTH,
 20132           DFHEIV99,
 20133           DFHEIV99,
 20134           DFHEIV99,
 20135           DFHEIV99
 20136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20137
 20138
 20139 7710-EXIT.
 20140     EXIT.
 20141
 20142 7720-CALL-DL3.
 20143
 20144* EXEC CICS LINK
 20145*        PROGRAM    ('DLO003')
 20146*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20147*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 370
* EL050.cbl
 20148*    END-EXEC.
 20149     MOVE 'DLO003' TO DFHEIV1
 20150*    MOVE '."C                   (   #00019700' TO DFHEIV0
 20151     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20153     MOVE X'2020233030303139373030' TO DFHEIV0(25:11)
 20154     CALL 'kxdfhei1' USING DFHEIV0,
 20155           DFHEIV1,
 20156           WS-DLO-VALID-BANK-ID,
 20157           DLO003-COMM-LENGTH,
 20158           DFHEIV99,
 20159           DFHEIV99,
 20160           DFHEIV99,
 20161           DFHEIV99
 20162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20163
 20164
 20165 7720-EXIT.
 20166     EXIT.
 20167
 20168 7730-CALL-DL7.
 20169
 20170* EXEC CICS LINK
 20171*        PROGRAM    ('DLO007')
 20172*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20173*        LENGTH     (DLO007-COMM-LENGTH)
 20174*    END-EXEC.
 20175     MOVE 'DLO007' TO DFHEIV1
 20176*    MOVE '."C                   (   #00019710' TO DFHEIV0
 20177     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20179     MOVE X'2020233030303139373130' TO DFHEIV0(25:11)
 20180     CALL 'kxdfhei1' USING DFHEIV0,
 20181           DFHEIV1,
 20182           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20183           DLO007-COMM-LENGTH,
 20184           DFHEIV99,
 20185           DFHEIV99,
 20186           DFHEIV99,
 20187           DFHEIV99
 20188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20189
 20190
 20191 7730-EXIT.
 20192     EXIT.
 20193
 20194 7740-CALL-DL11.
 20195
 20196* EXEC CICS LINK
 20197*        PROGRAM    ('DLO011')
 20198*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20199*        LENGTH     (DLO011-COMM-LENGTH)
 20200*    END-EXEC.
 20201     MOVE 'DLO011' TO DFHEIV1
 20202*    MOVE '."C                   (   #00019720' TO DFHEIV0
 20203     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20204     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20205     MOVE X'2020233030303139373230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 371
* EL050.cbl
 20206     CALL 'kxdfhei1' USING DFHEIV0,
 20207           DFHEIV1,
 20208           WS-DLO-PREM-RATES-BEN-TYPE,
 20209           DLO011-COMM-LENGTH,
 20210           DFHEIV99,
 20211           DFHEIV99,
 20212           DFHEIV99,
 20213           DFHEIV99
 20214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20215
 20216
 20217 7740-EXIT.
 20218     EXIT.
 20219
 20220 7750-CALL-DL17.
 20221
 20222* EXEC CICS LINK
 20223*        PROGRAM    ('DLO017')
 20224*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20225*        LENGTH     (DLO017-COMM-LENGTH)
 20226*    END-EXEC.
 20227     MOVE 'DLO017' TO DFHEIV1
 20228*    MOVE '."C                   (   #00019730' TO DFHEIV0
 20229     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20231     MOVE X'2020233030303139373330' TO DFHEIV0(25:11)
 20232     CALL 'kxdfhei1' USING DFHEIV0,
 20233           DFHEIV1,
 20234           WS-DLO-VALID-RATE-CODE,
 20235           DLO017-COMM-LENGTH,
 20236           DFHEIV99,
 20237           DFHEIV99,
 20238           DFHEIV99,
 20239           DFHEIV99
 20240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20241
 20242
 20243 7750-EXIT.
 20244     EXIT.
 20245
 20246 7755-CALL-DL19.
 20247
 20248* EXEC CICS LINK
 20249*        PROGRAM    ('DLO019')
 20250*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20251*        LENGTH     (DLO019-COMM-LENGTH)
 20252*    END-EXEC.
 20253     MOVE 'DLO019' TO DFHEIV1
 20254*    MOVE '."C                   (   #00019740' TO DFHEIV0
 20255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20257     MOVE X'2020233030303139373430' TO DFHEIV0(25:11)
 20258     CALL 'kxdfhei1' USING DFHEIV0,
 20259           DFHEIV1,
 20260           WS-DLO-ORIG-COV-CAT,
 20261           DLO019-COMM-LENGTH,
 20262           DFHEIV99,
 20263           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 372
* EL050.cbl
 20264           DFHEIV99,
 20265           DFHEIV99
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269 7755-EXIT.
 20270     EXIT.
 20271
 20272 7760-CALL-DL21.
 20273
 20274* EXEC CICS LINK
 20275*        PROGRAM    ('DLO021')
 20276*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20277*        LENGTH     (DLO021-COMM-LENGTH)
 20278*    END-EXEC.
 20279     MOVE 'DLO021' TO DFHEIV1
 20280*    MOVE '."C                   (   #00019750' TO DFHEIV0
 20281     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20283     MOVE X'2020233030303139373530' TO DFHEIV0(25:11)
 20284     CALL 'kxdfhei1' USING DFHEIV0,
 20285           DFHEIV1,
 20286           WS-DLO-VALID-LOAN-OFFICER,
 20287           DLO021-COMM-LENGTH,
 20288           DFHEIV99,
 20289           DFHEIV99,
 20290           DFHEIV99,
 20291           DFHEIV99
 20292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20293
 20294
 20295 7760-EXIT.
 20296     EXIT.
 20297
 20298 7770-CALL-DL22.
 20299
 20300* EXEC CICS LINK
 20301*        PROGRAM    ('DLO022')
 20302*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20303*        LENGTH     (DLO022-COMM-LENGTH)
 20304*    END-EXEC.
 20305     MOVE 'DLO022' TO DFHEIV1
 20306*    MOVE '."C                   (   #00019760' TO DFHEIV0
 20307     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20309     MOVE X'2020233030303139373630' TO DFHEIV0(25:11)
 20310     CALL 'kxdfhei1' USING DFHEIV0,
 20311           DFHEIV1,
 20312           WS-DLO-VALID-STATE-CODE,
 20313           DLO022-COMM-LENGTH,
 20314           DFHEIV99,
 20315           DFHEIV99,
 20316           DFHEIV99,
 20317           DFHEIV99
 20318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20319
 20320
 20321 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 373
* EL050.cbl
 20322     EXIT.
 20323
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 374
* EL050.cbl
 20325
 20326 7780-CALL-AGG.
 20327
 20328* EXEC CICS LINK
 20329*        PROGRAM    ('ELAGGO')
 20330*        COMMAREA   (WS-PASS-to-pemaggo)
 20331*        LENGTH     (ws-passed-key-LENGTH)
 20332*    END-EXEC.
 20333     MOVE 'ELAGGO' TO DFHEIV1
 20334*    MOVE '."C                   (   #00019772' TO DFHEIV0
 20335     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20336     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20337     MOVE X'2020233030303139373732' TO DFHEIV0(25:11)
 20338     CALL 'kxdfhei1' USING DFHEIV0,
 20339           DFHEIV1,
 20340           WS-PASS-to-pemaggo,
 20341           ws-passed-key-LENGTH,
 20342           DFHEIV99,
 20343           DFHEIV99,
 20344           DFHEIV99,
 20345           DFHEIV99
 20346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20347
 20348 7780-EXIT.
 20349     EXIT.
 20350 7785-CALL-HLDI.
 20351
 20352* EXEC CICS LINK
 20353*        PROGRAM    ('ELHLDI')
 20354*        COMMAREA   (HLDI-PASS-AREA)
 20355*        LENGTH     (HLDI-PASS-AREA-LEN)
 20356*    END-EXEC.
 20357     MOVE 'ELHLDI' TO DFHEIV1
 20358*    MOVE '."C                   (   #00019780' TO DFHEIV0
 20359     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20361     MOVE X'2020233030303139373830' TO DFHEIV0(25:11)
 20362     CALL 'kxdfhei1' USING DFHEIV0,
 20363           DFHEIV1,
 20364           HLDI-PASS-AREA,
 20365           HLDI-PASS-AREA-LEN,
 20366           DFHEIV99,
 20367           DFHEIV99,
 20368           DFHEIV99,
 20369           DFHEIV99
 20370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20371
 20372 7785-EXIT.
 20373     EXIT.
 20374 7786-CALL-HLDIM.
 20375
 20376* EXEC CICS LINK
 20377*        PROGRAM    ('ELHLDIM')
 20378*        COMMAREA   (HLDI-PASS-AREA)
 20379*        LENGTH     (HLDI-PASS-AREA-LEN)
 20380*    END-EXEC.
 20381     MOVE 'ELHLDIM' TO DFHEIV1
 20382*    MOVE '."C                   (   #00019788' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 375
* EL050.cbl
 20383     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20385     MOVE X'2020233030303139373838' TO DFHEIV0(25:11)
 20386     CALL 'kxdfhei1' USING DFHEIV0,
 20387           DFHEIV1,
 20388           HLDI-PASS-AREA,
 20389           HLDI-PASS-AREA-LEN,
 20390           DFHEIV99,
 20391           DFHEIV99,
 20392           DFHEIV99,
 20393           DFHEIV99
 20394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20395
 20396 7786-EXIT.
 20397     EXIT.
 20398 7790-CALL-ZIP-VERIFY.
 20399
 20400
 20401* EXEC CICS LINK
 20402*        PROGRAM    ('WSZIPCD')
 20403*        COMMAREA   (ZIPCD-PASS-AREA)
 20404*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20405*    END-EXEC.
 20406     MOVE 'WSZIPCD' TO DFHEIV1
 20407*    MOVE '."C                   (   #00019797' TO DFHEIV0
 20408     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20409     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20410     MOVE X'2020233030303139373937' TO DFHEIV0(25:11)
 20411     CALL 'kxdfhei1' USING DFHEIV0,
 20412           DFHEIV1,
 20413           ZIPCD-PASS-AREA,
 20414           ZIPCD-PASS-AREA-LEN,
 20415           DFHEIV99,
 20416           DFHEIV99,
 20417           DFHEIV99,
 20418           DFHEIV99
 20419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20420
 20421
 20422 7790-EXIT.
 20423     EXIT.
 20424 7800-REWRITE-CERT.
 20425******************************************************************
 20426*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20427*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20428******************************************************************
 20429
 20430     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20431        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20432        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20433        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20434
 20435* EXEC CICS REWRITE
 20436*                  DATASET (CERT-ID)
 20437*                  FROM    (CERTIFICATE-MASTER)
 20438*              END-EXEC
 20439     MOVE LENGTH OF
 20440      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 376
* EL050.cbl
 20441       TO DFHEIV11
 20442*    MOVE '&& L                  %   #00019815' TO DFHEIV0
 20443     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20445     MOVE X'2020233030303139383135' TO DFHEIV0(25:11)
 20446     CALL 'kxdfhei1' USING DFHEIV0,
 20447           CERT-ID,
 20448           CERTIFICATE-MASTER,
 20449           DFHEIV11,
 20450           DFHEIV99
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20452        GO TO 7800-EXIT.
 20453
 20454       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20455       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20456
 20457 7800-EXIT.
 20458      EXIT.
 20459
 20460 7900-DELETE-CERT.
 20461
 20462* EXEC CICS DELETE
 20463*        DATASET (CERT-ID)
 20464*    END-EXEC.
 20465*    MOVE '&(                    &   #00019828' TO DFHEIV0
 20466     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20467     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20468     MOVE X'2020233030303139383238' TO DFHEIV0(25:11)
 20469     CALL 'kxdfhei1' USING DFHEIV0,
 20470           CERT-ID,
 20471           DFHEIV99,
 20472           DFHEIV99,
 20473           DFHEIV99,
 20474           DFHEIV99
 20475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20476
 20477
 20478 7900-EXIT.
 20479     EXIT.
 20480
 20481 8000-WRITE-CERT.
 20482
 20483* EXEC CICS HANDLE CONDITION
 20484*        DUPKEY    (8000-FREE-MAIN)
 20485*    END-EXEC.
 20486*    MOVE '"$$                   ! + #00019836' TO DFHEIV0
 20487     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20489     MOVE X'2B20233030303139383336' TO DFHEIV0(25:11)
 20490     CALL 'kxdfhei1' USING DFHEIV0
 20491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20492
 20493
 20494
 20495* EXEC CICS WRITE
 20496*        DATASET     (CERT-ID)
 20497*        FROM        (CERTIFICATE-MASTER)
 20498*        RIDFLD      (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 377
* EL050.cbl
 20499*    END-EXEC.
 20500     MOVE LENGTH OF
 20501      CERTIFICATE-MASTER
 20502       TO DFHEIV11
 20503*    MOVE '&$ L                  ''   #00019840' TO DFHEIV0
 20504     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20506     MOVE X'2020233030303139383430' TO DFHEIV0(25:11)
 20507     CALL 'kxdfhei1' USING DFHEIV0,
 20508           CERT-ID,
 20509           CERTIFICATE-MASTER,
 20510           DFHEIV11,
 20511           ELCERT-KEY,
 20512           DFHEIV99,
 20513           DFHEIV99
 20514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20515
 20516
 20517 8000-FREE-MAIN.
 20518
 20519 8000-EXIT.
 20520      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 378
* EL050.cbl
 20522
 20523 8100-READ-ERPNDM.
 20524
 20525* EXEC CICS HANDLE CONDITION
 20526*         NOTFND     (8100-NOTFND)
 20527*         ENDFILE    (8100-NOTFND)
 20528*    END-EXEC.
 20529*    MOVE '"$I''                  ! , #00019853' TO DFHEIV0
 20530     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20531     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20532     MOVE X'2C20233030303139383533' TO DFHEIV0(25:11)
 20533     CALL 'kxdfhei1' USING DFHEIV0
 20534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20535
 20536
 20537     MOVE SPACES                 TO ERPNDM-FOUND.
 20538     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20539
 20540
 20541* EXEC CICS READ UPDATE
 20542*         DATASET   (FILE-ERPNDM)
 20543*         RIDFLD    (PM-CONTROL-PRIMARY)
 20544*         INTO      (PENDING-MAILING-DATA)
 20545*    END-EXEC.
 20546     MOVE LENGTH OF
 20547      PENDING-MAILING-DATA
 20548       TO DFHEIV11
 20549*    MOVE '&"IL       EU         (   #00019861' TO DFHEIV0
 20550     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20551     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20552     MOVE X'2020233030303139383631' TO DFHEIV0(25:11)
 20553     CALL 'kxdfhei1' USING DFHEIV0,
 20554           FILE-ERPNDM,
 20555           PENDING-MAILING-DATA,
 20556           DFHEIV11,
 20557           PM-CONTROL-PRIMARY,
 20558           DFHEIV99,
 20559           DFHEIV99,
 20560           DFHEIV99
 20561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20562
 20563
 20564     GO TO 8100-EXIT.
 20565
 20566 8100-NOTFND.
 20567
 20568     MOVE 'X'                    TO ERPNDM-FOUND.
 20569     MOVE ER-2694                TO WS-ERROR.
 20570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20571     MOVE ER-2883                TO WS-ERROR
 20572     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20573     .
 20574 8100-EXIT.
 20575     EXIT.
 20576 8102-REWRITE-ERPNDM.
 20577
 20578
 20579* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 379
* EL050.cbl
 20580*         DATASET    (FILE-ERPNDM)
 20581*         FROM       (PENDING-MAILING-DATA)
 20582*    END-EXEC
 20583     MOVE LENGTH OF
 20584      PENDING-MAILING-DATA
 20585       TO DFHEIV11
 20586*    MOVE '&& L                  %   #00019881' TO DFHEIV0
 20587     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20588     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20589     MOVE X'2020233030303139383831' TO DFHEIV0(25:11)
 20590     CALL 'kxdfhei1' USING DFHEIV0,
 20591           FILE-ERPNDM,
 20592           PENDING-MAILING-DATA,
 20593           DFHEIV11,
 20594           DFHEIV99
 20595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20596
 20597     .
 20598 8102-EXIT.
 20599     EXIT.
 20600 8104-UNLOCK-ERPNDM.
 20601
 20602
 20603* EXEC CICS UNLOCK
 20604*         DATASET   (FILE-ERPNDM)
 20605*    END-EXEC
 20606*    MOVE '&*                    #   #00019891' TO DFHEIV0
 20607     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20608     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20609     MOVE X'2020233030303139383931' TO DFHEIV0(25:11)
 20610     CALL 'kxdfhei1' USING DFHEIV0,
 20611           FILE-ERPNDM,
 20612           DFHEIV99
 20613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20614
 20615     .
 20616 8104-EXIT.
 20617     EXIT.
 20618 8110-READ-ERMAIL.
 20619
 20620* EXEC CICS HANDLE CONDITION
 20621*         NOTFND     (8110-NOTFND)
 20622*         ENDFILE    (8110-NOTFND)
 20623*    END-EXEC.
 20624*    MOVE '"$I''                  ! - #00019899' TO DFHEIV0
 20625     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20627     MOVE X'2D20233030303139383939' TO DFHEIV0(25:11)
 20628     CALL 'kxdfhei1' USING DFHEIV0
 20629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20630
 20631
 20632     MOVE SPACES                 TO ERMAIL-FOUND.
 20633     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20634     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20635     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20636     MOVE PB-SV-STATE            TO MA-STATE.
 20637
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 380
* EL050.cbl
 20638
 20639* EXEC CICS READ
 20640*         UPDATE
 20641*         DATASET   (FILE-ERMAIL)
 20642*         RIDFLD    (MA-CONTROL-PRIMARY)
 20643*         INTO      (MAILING-DATA)
 20644*    END-EXEC.
 20645     MOVE LENGTH OF
 20646      MAILING-DATA
 20647       TO DFHEIV11
 20648*    MOVE '&"IL       EU         (   #00019910' TO DFHEIV0
 20649     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20650     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20651     MOVE X'2020233030303139393130' TO DFHEIV0(25:11)
 20652     CALL 'kxdfhei1' USING DFHEIV0,
 20653           FILE-ERMAIL,
 20654           MAILING-DATA,
 20655           DFHEIV11,
 20656           MA-CONTROL-PRIMARY,
 20657           DFHEIV99,
 20658           DFHEIV99,
 20659           DFHEIV99
 20660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20661
 20662
 20663     GO TO 8110-EXIT.
 20664
 20665 8110-NOTFND.
 20666     MOVE 'X'                    TO ERMAIL-FOUND.
 20667
 20668 8110-EXIT.
 20669     EXIT.
 20670
 20671 8120-REWRITE-ERMAIL.
 20672
 20673* EXEC CICS REWRITE
 20674*         DATASET    (FILE-ERMAIL)
 20675*         FROM       (MAILING-DATA)
 20676*    END-EXEC.
 20677     MOVE LENGTH OF
 20678      MAILING-DATA
 20679       TO DFHEIV11
 20680*    MOVE '&& L                  %   #00019926' TO DFHEIV0
 20681     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20682     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20683     MOVE X'2020233030303139393236' TO DFHEIV0(25:11)
 20684     CALL 'kxdfhei1' USING DFHEIV0,
 20685           FILE-ERMAIL,
 20686           MAILING-DATA,
 20687           DFHEIV11,
 20688           DFHEIV99
 20689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20690
 20691
 20692 8120-EXIT.
 20693     EXIT.
 20694
 20695 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 381
* EL050.cbl
 20696
 20697* EXEC CICS HANDLE CONDITION
 20698*         DUPKEY   (8130-EXIT)
 20699*    END-EXEC.
 20700*    MOVE '"$$                   ! . #00019935' TO DFHEIV0
 20701     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20703     MOVE X'2E20233030303139393335' TO DFHEIV0(25:11)
 20704     CALL 'kxdfhei1' USING DFHEIV0
 20705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20706
 20707
 20708
 20709* EXEC CICS WRITE
 20710*         DATASET     (FILE-ERMAIL)
 20711*         RIDFLD      (MA-CONTROL-PRIMARY)
 20712*         FROM        (MAILING-DATA)
 20713*    END-EXEC.
 20714     MOVE LENGTH OF
 20715      MAILING-DATA
 20716       TO DFHEIV11
 20717*    MOVE '&$ L                  ''   #00019939' TO DFHEIV0
 20718     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20720     MOVE X'2020233030303139393339' TO DFHEIV0(25:11)
 20721     CALL 'kxdfhei1' USING DFHEIV0,
 20722           FILE-ERMAIL,
 20723           MAILING-DATA,
 20724           DFHEIV11,
 20725           MA-CONTROL-PRIMARY,
 20726           DFHEIV99,
 20727           DFHEIV99
 20728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20729
 20730
 20731 8130-EXIT.
 20732     EXIT.
 20733
 20734 8140-UNLOCK-ERMAIL.
 20735
 20736* EXEC CICS UNLOCK
 20737*         DATASET   (FILE-ERMAIL)
 20738*    END-EXEC.
 20739*    MOVE '&*                    #   #00019949' TO DFHEIV0
 20740     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20741     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20742     MOVE X'2020233030303139393439' TO DFHEIV0(25:11)
 20743     CALL 'kxdfhei1' USING DFHEIV0,
 20744           FILE-ERMAIL,
 20745           DFHEIV99
 20746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20747
 20748
 20749 8140-EXIT.
 20750     EXIT.
 20751
 20752 8150-read-elcrtt.
 20753
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 382
* EL050.cbl
 20754
 20755* EXEC CICS HANDLE CONDITION
 20756*        NOTFND   (8150-exit)
 20757*    END-EXEC
 20758*    MOVE '"$I                   ! / #00019958' TO DFHEIV0
 20759     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20761     MOVE X'2F20233030303139393538' TO DFHEIV0(25:11)
 20762     CALL 'kxdfhei1' USING DFHEIV0
 20763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20764
 20765     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20766     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20767
 20768
 20769* EXEC CICS READ
 20770*        DATASET  (CRTT-ID)
 20771*        RIDFLD   (WS-ELCRTT-KEY)
 20772*        INTO     (CERTIFICATE-TRAILERS)
 20773*    END-EXEC
 20774     MOVE LENGTH OF
 20775      CERTIFICATE-TRAILERS
 20776       TO DFHEIV11
 20777*    MOVE '&"IL       E          (   #00019965' TO DFHEIV0
 20778     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20780     MOVE X'2020233030303139393635' TO DFHEIV0(25:11)
 20781     CALL 'kxdfhei1' USING DFHEIV0,
 20782           CRTT-ID,
 20783           CERTIFICATE-TRAILERS,
 20784           DFHEIV11,
 20785           WS-ELCRTT-KEY,
 20786           DFHEIV99,
 20787           DFHEIV99,
 20788           DFHEIV99
 20789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20790
 20791     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20792     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20793     move cs-vehicle-odometer    to ws-vehicle-odometer
 20794
 20795     .
 20796 8150-exit.
 20797     exit.
 20798 8180-UPDATE-VIN-NUMBER.
 20799
 20800* EXEC CICS HANDLE CONDITION
 20801*        NOTFND   (8180-NOTFND)
 20802*    END-EXEC.
 20803*    MOVE '"$I                   ! 0 #00019979' TO DFHEIV0
 20804     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20805     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20806     MOVE X'3020233030303139393739' TO DFHEIV0(25:11)
 20807     CALL 'kxdfhei1' USING DFHEIV0
 20808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20809
 20810
 20811     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 383
* EL050.cbl
 20812     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20813
 20814
 20815* EXEC CICS READ
 20816*        UPDATE
 20817*        DATASET  (CRTT-ID)
 20818*        RIDFLD   (WS-ELCRTT-KEY)
 20819*        INTO     (CERTIFICATE-TRAILERS)
 20820*    END-EXEC.
 20821     MOVE LENGTH OF
 20822      CERTIFICATE-TRAILERS
 20823       TO DFHEIV11
 20824*    MOVE '&"IL       EU         (   #00019986' TO DFHEIV0
 20825     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20827     MOVE X'2020233030303139393836' TO DFHEIV0(25:11)
 20828     CALL 'kxdfhei1' USING DFHEIV0,
 20829           CRTT-ID,
 20830           CERTIFICATE-TRAILERS,
 20831           DFHEIV11,
 20832           WS-ELCRTT-KEY,
 20833           DFHEIV99,
 20834           DFHEIV99,
 20835           DFHEIV99
 20836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20837
 20838
 20839     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20840        or (hldi-pass-area not = spaces)
 20841        move pa-modelyear        to cs-year
 20842        move pa-makename         to cs-make
 20843        move pa-modelname        to cs-model
 20844        move pa-seriesname       to cs-future
 20845        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20846
 20847* EXEC CICS REWRITE
 20848*           DATASET  (CRTT-ID)
 20849*           FROM     (CERTIFICATE-TRAILERS)
 20850*        END-EXEC
 20851     MOVE LENGTH OF
 20852      CERTIFICATE-TRAILERS
 20853       TO DFHEIV11
 20854*    MOVE '&& L                  %   #00020000' TO DFHEIV0
 20855     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20856     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20857     MOVE X'2020233030303230303030' TO DFHEIV0(25:11)
 20858     CALL 'kxdfhei1' USING DFHEIV0,
 20859           CRTT-ID,
 20860           CERTIFICATE-TRAILERS,
 20861           DFHEIV11,
 20862           DFHEIV99
 20863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20864     ELSE
 20865
 20866* EXEC CICS UNLOCK
 20867*          DATASET  (CRTT-ID)
 20868*       END-EXEC
 20869*    MOVE '&*                    #   #00020005' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 384
* EL050.cbl
 20870     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20871     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20872     MOVE X'2020233030303230303035' TO DFHEIV0(25:11)
 20873     CALL 'kxdfhei1' USING DFHEIV0,
 20874           CRTT-ID,
 20875           DFHEIV99
 20876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20877     END-IF.
 20878
 20879     GO TO 8180-EXIT.
 20880
 20881 8180-NOTFND.
 20882
 20883     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20884     MOVE 'CS'         TO CS-RECORD-ID.
 20885     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20886     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20887     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20888     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20889
 20890* EXEC CICS WRITE
 20891*       DATASET  (CRTT-ID)
 20892*       RIDFLD   (WS-ELCRTT-KEY)
 20893*       FROM     (CERTIFICATE-TRAILERS)
 20894*    END-EXEC.
 20895     MOVE LENGTH OF
 20896      CERTIFICATE-TRAILERS
 20897       TO DFHEIV11
 20898*    MOVE '&$ L                  ''   #00020020' TO DFHEIV0
 20899     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20900     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20901     MOVE X'2020233030303230303230' TO DFHEIV0(25:11)
 20902     CALL 'kxdfhei1' USING DFHEIV0,
 20903           CRTT-ID,
 20904           CERTIFICATE-TRAILERS,
 20905           DFHEIV11,
 20906           WS-ELCRTT-KEY,
 20907           DFHEIV99,
 20908           DFHEIV99
 20909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20910
 20911
 20912 8180-EXIT.
 20913     EXIT.
 20914
 20915 8190-UPDATE-REFUND-CLAIM-FLAG.
 20916
 20917* EXEC CICS HANDLE CONDITION
 20918*        NOTFND   (8190-NOTFND)
 20919*    END-EXEC.
 20920*    MOVE '"$I                   ! 1 #00020030' TO DFHEIV0
 20921     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20923     MOVE X'3120233030303230303330' TO DFHEIV0(25:11)
 20924     CALL 'kxdfhei1' USING DFHEIV0
 20925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20926
 20927
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 385
* EL050.cbl
 20928     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20929     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20930
 20931
 20932* EXEC CICS READ
 20933*        UPDATE
 20934*        DATASET  (CRTT-ID)
 20935*        RIDFLD   (WS-ELCRTT-KEY)
 20936*        INTO     (CERTIFICATE-TRAILERS)
 20937*    END-EXEC.
 20938     MOVE LENGTH OF
 20939      CERTIFICATE-TRAILERS
 20940       TO DFHEIV11
 20941*    MOVE '&"IL       EU         (   #00020037' TO DFHEIV0
 20942     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20943     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20944     MOVE X'2020233030303230303337' TO DFHEIV0(25:11)
 20945     CALL 'kxdfhei1' USING DFHEIV0,
 20946           CRTT-ID,
 20947           CERTIFICATE-TRAILERS,
 20948           DFHEIV11,
 20949           WS-ELCRTT-KEY,
 20950           DFHEIV99,
 20951           DFHEIV99,
 20952           DFHEIV99
 20953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20954
 20955
 20956     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20957
 20958* EXEC CICS REWRITE
 20959*       DATASET  (CRTT-ID)
 20960*       FROM     (CERTIFICATE-TRAILERS)
 20961*    END-EXEC.
 20962     MOVE LENGTH OF
 20963      CERTIFICATE-TRAILERS
 20964       TO DFHEIV11
 20965*    MOVE '&& L                  %   #00020045' TO DFHEIV0
 20966     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20967     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20968     MOVE X'2020233030303230303435' TO DFHEIV0(25:11)
 20969     CALL 'kxdfhei1' USING DFHEIV0,
 20970           CRTT-ID,
 20971           CERTIFICATE-TRAILERS,
 20972           DFHEIV11,
 20973           DFHEIV99
 20974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20975
 20976
 20977     GO TO 8190-EXIT.
 20978
 20979 8190-NOTFND.
 20980
 20981     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20982     MOVE 'CS'         TO CS-RECORD-ID.
 20983     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20984     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20985     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 386
* EL050.cbl
 20986     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20987
 20988* EXEC CICS WRITE
 20989*       DATASET  (CRTT-ID)
 20990*       RIDFLD   (WS-ELCRTT-KEY)
 20991*       FROM     (CERTIFICATE-TRAILERS)
 20992*    END-EXEC.
 20993     MOVE LENGTH OF
 20994      CERTIFICATE-TRAILERS
 20995       TO DFHEIV11
 20996*    MOVE '&$ L                  ''   #00020060' TO DFHEIV0
 20997     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20998     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20999     MOVE X'2020233030303230303630' TO DFHEIV0(25:11)
 21000     CALL 'kxdfhei1' USING DFHEIV0,
 21001           CRTT-ID,
 21002           CERTIFICATE-TRAILERS,
 21003           DFHEIV11,
 21004           WS-ELCRTT-KEY,
 21005           DFHEIV99,
 21006           DFHEIV99
 21007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21008
 21009
 21010 8190-EXIT.
 21011     EXIT.
 21012
 21013 8195-UPDATE-AGE-FLAGS.
 21014
 21015* EXEC CICS HANDLE CONDITION
 21016*        NOTFND   (8195-NOTFND)
 21017*    END-EXEC.
 21018*    MOVE '"$I                   ! 2 #00020070' TO DFHEIV0
 21019     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21021     MOVE X'3220233030303230303730' TO DFHEIV0(25:11)
 21022     CALL 'kxdfhei1' USING DFHEIV0
 21023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21024
 21025
 21026     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21027     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21028
 21029
 21030* EXEC CICS READ
 21031*        UPDATE
 21032*        DATASET  (CRTT-ID)
 21033*        RIDFLD   (WS-ELCRTT-KEY)
 21034*        INTO     (CERTIFICATE-TRAILERS)
 21035*    END-EXEC.
 21036     MOVE LENGTH OF
 21037      CERTIFICATE-TRAILERS
 21038       TO DFHEIV11
 21039*    MOVE '&"IL       EU         (   #00020077' TO DFHEIV0
 21040     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21041     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21042     MOVE X'2020233030303230303737' TO DFHEIV0(25:11)
 21043     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 387
* EL050.cbl
 21044           CRTT-ID,
 21045           CERTIFICATE-TRAILERS,
 21046           DFHEIV11,
 21047           WS-ELCRTT-KEY,
 21048           DFHEIV99,
 21049           DFHEIV99,
 21050           DFHEIV99
 21051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21052
 21053
 21054     IF WS-INS-AGE-SET = 'Y'
 21055        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21056     END-IF
 21057     IF WS-JNT-AGE-SET = 'Y'
 21058        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21059     END-IF
 21060
 21061
 21062* EXEC CICS REWRITE
 21063*       DATASET  (CRTT-ID)
 21064*       FROM     (CERTIFICATE-TRAILERS)
 21065*    END-EXEC.
 21066     MOVE LENGTH OF
 21067      CERTIFICATE-TRAILERS
 21068       TO DFHEIV11
 21069*    MOVE '&& L                  %   #00020091' TO DFHEIV0
 21070     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21071     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21072     MOVE X'2020233030303230303931' TO DFHEIV0(25:11)
 21073     CALL 'kxdfhei1' USING DFHEIV0,
 21074           CRTT-ID,
 21075           CERTIFICATE-TRAILERS,
 21076           DFHEIV11,
 21077           DFHEIV99
 21078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21079
 21080
 21081     GO TO 8195-EXIT.
 21082
 21083 8195-NOTFND.
 21084
 21085     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21086     MOVE 'CS'         TO CS-RECORD-ID.
 21087     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21088     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21089     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21090     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21091     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21092
 21093* EXEC CICS WRITE
 21094*       DATASET  (CRTT-ID)
 21095*       RIDFLD   (WS-ELCRTT-KEY)
 21096*       FROM     (CERTIFICATE-TRAILERS)
 21097*    END-EXEC.
 21098     MOVE LENGTH OF
 21099      CERTIFICATE-TRAILERS
 21100       TO DFHEIV11
 21101*    MOVE '&$ L                  ''   #00020107' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 388
* EL050.cbl
 21102     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21104     MOVE X'2020233030303230313037' TO DFHEIV0(25:11)
 21105     CALL 'kxdfhei1' USING DFHEIV0,
 21106           CRTT-ID,
 21107           CERTIFICATE-TRAILERS,
 21108           DFHEIV11,
 21109           WS-ELCRTT-KEY,
 21110           DFHEIV99,
 21111           DFHEIV99
 21112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21113
 21114
 21115 8195-EXIT.
 21116     EXIT.
 21117
 21118 8200-READ-REIN-TABLE.
 21119
 21120* EXEC CICS HANDLE CONDITION
 21121*         NOTFND   (8200-NOTFND)
 21122*    END-EXEC.
 21123*    MOVE '"$I                   ! 3 #00020117' TO DFHEIV0
 21124     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21126     MOVE X'3320233030303230313137' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0
 21128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21129
 21130
 21131
 21132* EXEC CICS READ
 21133*        DATASET     (REIN-ID)
 21134*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21135*        RIDFLD      (ERREIN-KEY)
 21136*    END-EXEC.
 21137*    MOVE '&"S        E          (   #00020121' TO DFHEIV0
 21138     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21139     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21140     MOVE X'2020233030303230313231' TO DFHEIV0(25:11)
 21141     CALL 'kxdfhei1' USING DFHEIV0,
 21142           REIN-ID,
 21143           DFHEIV20,
 21144           DFHEIV99,
 21145           ERREIN-KEY,
 21146           DFHEIV99,
 21147           DFHEIV99,
 21148           DFHEIV99
 21149     SET ADDRESS OF REINSURANCE-RECORD TO
 21150         DFHEIV20
 21151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21152
 21153
 21154     GO TO 8200-EXIT.
 21155
 21156 8200-NOTFND.
 21157     MOVE 'N'             TO WS-REIN-READ-SW.
 21158
 21159 8200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 389
* EL050.cbl
 21160      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 390
* EL050.cbl
 21162
 21163 8300-READ-CTBL-TABLE.
 21164
 21165* EXEC CICS HANDLE CONDITION
 21166*        NOTFND    (8300-NOTFND)
 21167*        DISABLED  (8300-ERRESS-PROBLEM)
 21168*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21169*        ENDFILE   (8300-NOTFND)
 21170*    END-EXEC.
 21171*    MOVE '"$IcJ''                ! 4 #00020137' TO DFHEIV0
 21172     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21174     MOVE X'3420233030303230313337' TO DFHEIV0(25:11)
 21175     CALL 'kxdfhei1' USING DFHEIV0
 21176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21177
 21178
 21179
 21180* EXEC CICS READ
 21181*        DATASET     (CTBL-ID)
 21182*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21183*        RIDFLD      (ERCTBL-KEY)
 21184*    END-EXEC.
 21185*    MOVE '&"S        E          (   #00020144' TO DFHEIV0
 21186     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21188     MOVE X'2020233030303230313434' TO DFHEIV0(25:11)
 21189     CALL 'kxdfhei1' USING DFHEIV0,
 21190           CTBL-ID,
 21191           DFHEIV20,
 21192           DFHEIV99,
 21193           ERCTBL-KEY,
 21194           DFHEIV99,
 21195           DFHEIV99,
 21196           DFHEIV99
 21197     SET ADDRESS OF COMM-TABLE-RECORD TO
 21198         DFHEIV20
 21199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21200
 21201
 21202     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21203
 21204     GO TO 8300-EXIT.
 21205
 21206 8300-NOTFND.
 21207
 21208     IF CTBL-SW = '0530'
 21209         MOVE 'AA'                     TO WS-AH-COMP-CD
 21210         MOVE '0550'                   TO CTBL-SW
 21211         MOVE '1'                      TO WS-CTBL-READ-SW
 21212         GO TO 8300-EXIT.
 21213
 21214     IF CTBL-SW = '0540'
 21215         MOVE 'AA'                     TO WS-LF-COMP-CD
 21216         MOVE '0550'                   TO CTBL-SW
 21217         MOVE '1'                      TO WS-CTBL-READ-SW
 21218         GO TO 8300-EXIT.
 21219
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 391
* EL050.cbl
 21220     IF CTBL-SW = '0550'
 21221         MOVE '2'                      TO WS-CTBL-READ-SW
 21222         GO TO 8300-EXIT.
 21223
 21224     GO TO 8300-EXIT.
 21225
 21226 8300-ERRESS-PROBLEM.
 21227
 21228      MOVE ER-8050              TO WS-ERROR.
 21229      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21230
 21231     GO TO 8300-EXIT.
 21232
 21233 8300-EXIT.
 21234      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 392
* EL050.cbl
 21236
 21237
 21238 8400-GETMAIN-ERFORM.
 21239
 21240
 21241* EXEC CICS   GETMAIN
 21242*        LENGTH  (500)
 21243*        SET     (ADDRESS OF FORM-MASTER)
 21244*    END-EXEC.
 21245     MOVE 500
 21246       TO DFHEIV11
 21247*    MOVE '," L                  $   #00020188' TO DFHEIV0
 21248     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21249     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21250     MOVE X'2020233030303230313838' TO DFHEIV0(25:11)
 21251     CALL 'kxdfhei1' USING DFHEIV0,
 21252           DFHEIV20,
 21253           DFHEIV11,
 21254           DFHEIV99
 21255     SET ADDRESS OF FORM-MASTER TO
 21256         DFHEIV20
 21257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21258
 21259
 21260     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21261
 21262 8400-EXIT.
 21263      EXIT.
 21264
 21265 8450-READ-FORM-MASTER.
 21266
 21267
 21268* EXEC CICS  HANDLE CONDITION
 21269*        NOTFND   (8450-FORM-NOT-FOUND)
 21270*        ENDFILE  (8450-FORM-NOT-FOUND)
 21271*    END-EXEC.
 21272*    MOVE '"$I''                  ! 5 #00020200' TO DFHEIV0
 21273     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21275     MOVE X'3520233030303230323030' TO DFHEIV0(25:11)
 21276     CALL 'kxdfhei1' USING DFHEIV0
 21277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21278
 21279
 21280
 21281* EXEC CICS   READ
 21282*        DATASET   (FORM-ID)
 21283*        RIDFLD    (ERFORM-KEY)
 21284*        INTO      (FORM-MASTER)
 21285*        GTEQ
 21286*    END-EXEC.
 21287     MOVE LENGTH OF
 21288      FORM-MASTER
 21289       TO DFHEIV11
 21290*    MOVE '&"IL       G          (   #00020205' TO DFHEIV0
 21291     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21293     MOVE X'2020233030303230323035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 393
* EL050.cbl
 21294     CALL 'kxdfhei1' USING DFHEIV0,
 21295           FORM-ID,
 21296           FORM-MASTER,
 21297           DFHEIV11,
 21298           ERFORM-KEY,
 21299           DFHEIV99,
 21300           DFHEIV99,
 21301           DFHEIV99
 21302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21303
 21304
 21305     MOVE  'Y'           TO  FORM-MASTER-SW.
 21306
 21307     GO TO  8450-EXIT.
 21308
 21309 8450-FORM-NOT-FOUND.
 21310
 21311     MOVE  'N'           TO  FORM-MASTER-SW.
 21312
 21313 8450-EXIT.
 21314      EXIT.
 21315
 21316 8500-DATE-CONVERT.
 21317
 21318* EXEC CICS LINK
 21319*        PROGRAM    ('ELDATCV')
 21320*        COMMAREA   (DATE-CONVERSION-DATA)
 21321*        LENGTH     (DC-COMM-LENGTH)
 21322*    END-EXEC.
 21323     MOVE 'ELDATCV' TO DFHEIV1
 21324*    MOVE '."C                   (   #00020224' TO DFHEIV0
 21325     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21327     MOVE X'2020233030303230323234' TO DFHEIV0(25:11)
 21328     CALL 'kxdfhei1' USING DFHEIV0,
 21329           DFHEIV1,
 21330           DATE-CONVERSION-DATA,
 21331           DC-COMM-LENGTH,
 21332           DFHEIV99,
 21333           DFHEIV99,
 21334           DFHEIV99,
 21335           DFHEIV99
 21336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21337
 21338
 21339 8500-EXIT.
 21340     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 394
* EL050.cbl
 21342
 21343 8555-RELOAD-CONTROL-FILE.
 21344     CONTINUE.
 21345
 21346 8555-EXIT.
 21347     EXIT.
 21348
 21349 8557-GETMAIN-ERPLAN.
 21350
 21351
 21352* EXEC CICS GETMAIN
 21353*        LENGTH    (840)
 21354*        SET       (ADDRESS OF PLAN-RECORDS)
 21355*    END-EXEC.
 21356     MOVE 840
 21357       TO DFHEIV11
 21358*    MOVE '," L                  $   #00020242' TO DFHEIV0
 21359     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21360     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21361     MOVE X'2020233030303230323432' TO DFHEIV0(25:11)
 21362     CALL 'kxdfhei1' USING DFHEIV0,
 21363           DFHEIV20,
 21364           DFHEIV11,
 21365           DFHEIV99
 21366     SET ADDRESS OF PLAN-RECORDS TO
 21367         DFHEIV20
 21368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21369
 21370
 21371     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21372
 21373 8557-EXIT.
 21374     EXIT.
 21375
 21376 8560-GETMAIN.
 21377
 21378* EXEC CICS GETMAIN
 21379*        LENGTH    (2000)
 21380*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21381*    END-EXEC.
 21382     MOVE 2000
 21383       TO DFHEIV11
 21384*    MOVE '," L                  $   #00020253' TO DFHEIV0
 21385     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21386     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21387     MOVE X'2020233030303230323533' TO DFHEIV0(25:11)
 21388     CALL 'kxdfhei1' USING DFHEIV0,
 21389           DFHEIV20,
 21390           DFHEIV11,
 21391           DFHEIV99
 21392     SET ADDRESS OF ACCOUNT-MASTER TO
 21393         DFHEIV20
 21394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21395
 21396
 21397     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21398
 21399 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 395
* EL050.cbl
 21400     EXIT.
 21401
 21402 8570-START-ACCOUNT-MASTER.
 21403
 21404* EXEC CICS HANDLE CONDITION
 21405*        NOTFND    (0199-ACCT-NOT-FOUND)
 21406*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21407*    END-EXEC.
 21408*    MOVE '"$I''                  ! 6 #00020264' TO DFHEIV0
 21409     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21411     MOVE X'3620233030303230323634' TO DFHEIV0(25:11)
 21412     CALL 'kxdfhei1' USING DFHEIV0
 21413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21414
 21415
 21416
 21417* EXEC CICS STARTBR
 21418*        DATASET    (ACCT-ID)
 21419*        RIDFLD     (ERACCT-KEY)
 21420*        GTEQ
 21421*    END-EXEC.
 21422     MOVE 0
 21423       TO DFHEIV11
 21424*    MOVE '&,         G          &   #00020269' TO DFHEIV0
 21425     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21426     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21427     MOVE X'2020233030303230323639' TO DFHEIV0(25:11)
 21428     CALL 'kxdfhei1' USING DFHEIV0,
 21429           ACCT-ID,
 21430           ERACCT-KEY,
 21431           DFHEIV99,
 21432           DFHEIV11,
 21433           DFHEIV99
 21434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21435
 21436
 21437 8570-EXIT.
 21438     EXIT.
 21439
 21440 8580-READ-ACCOUNT-MASTER.
 21441
 21442* EXEC CICS HANDLE CONDITION
 21443*        NOTFND    (0199-ACCT-NOT-FOUND)
 21444*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21445*    END-EXEC.
 21446*    MOVE '"$I''                  ! 7 #00020279' TO DFHEIV0
 21447     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21449     MOVE X'3720233030303230323739' TO DFHEIV0(25:11)
 21450     CALL 'kxdfhei1' USING DFHEIV0
 21451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21452
 21453
 21454
 21455* EXEC CICS READNEXT
 21456*        DATASET     (ACCT-ID)
 21457*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 396
* EL050.cbl
 21458*        RIDFLD      (ERACCT-KEY)
 21459*    END-EXEC.
 21460     MOVE LENGTH OF
 21461      ACCOUNT-MASTER
 21462       TO DFHEIV12
 21463     MOVE 0
 21464       TO DFHEIV11
 21465*    MOVE '&.IL                  )   #00020284' TO DFHEIV0
 21466     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21467     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21468     MOVE X'2020233030303230323834' TO DFHEIV0(25:11)
 21469     CALL 'kxdfhei1' USING DFHEIV0,
 21470           ACCT-ID,
 21471           ACCOUNT-MASTER,
 21472           DFHEIV12,
 21473           ERACCT-KEY,
 21474           DFHEIV99,
 21475           DFHEIV11,
 21476           DFHEIV99,
 21477           DFHEIV99
 21478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21479
 21480
 21481 8580-EXIT.
 21482     EXIT.
 21483
 21484 8582-READ-COMPENSATION-MASTER.
 21485
 21486* EXEC CICS HANDLE CONDITION
 21487*        NOTFND    (8582-COMP-NOT-FOUND)
 21488*        ENDFILE   (8582-COMP-NOT-FOUND)
 21489*    END-EXEC.
 21490*    MOVE '"$I''                  ! 8 #00020294' TO DFHEIV0
 21491     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21493     MOVE X'3820233030303230323934' TO DFHEIV0(25:11)
 21494     CALL 'kxdfhei1' USING DFHEIV0
 21495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21496
 21497
 21498
 21499* EXEC CICS READ
 21500*        DATASET     (COMP-ID)
 21501*        INTO        (COMPENSATION-MASTER)
 21502*        RIDFLD      (ERCOMP-KEY)
 21503*    END-EXEC.
 21504     MOVE LENGTH OF
 21505      COMPENSATION-MASTER
 21506       TO DFHEIV11
 21507*    MOVE '&"IL       E          (   #00020299' TO DFHEIV0
 21508     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21510     MOVE X'2020233030303230323939' TO DFHEIV0(25:11)
 21511     CALL 'kxdfhei1' USING DFHEIV0,
 21512           COMP-ID,
 21513           COMPENSATION-MASTER,
 21514           DFHEIV11,
 21515           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 397
* EL050.cbl
 21516           DFHEIV99,
 21517           DFHEIV99,
 21518           DFHEIV99
 21519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21520
 21521
 21522     MOVE 'Y'                    TO COMP-MASTER-SW
 21523
 21524     GO TO 8582-EXIT
 21525     .
 21526 8582-COMP-NOT-FOUND.
 21527
 21528     MOVE 'N'                    TO COMP-MASTER-SW.
 21529
 21530 8582-EXIT.
 21531     EXIT.
 21532
 21533 8583-READ-ERAGTC.
 21534
 21535* EXEC CICS HANDLE CONDITION
 21536*        NOTFND    (8583-AGTC-NOT-FOUND)
 21537*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21538*    END-EXEC.
 21539*    MOVE '"$I''                  ! 9 #00020317' TO DFHEIV0
 21540     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21542     MOVE X'3920233030303230333137' TO DFHEIV0(25:11)
 21543     CALL 'kxdfhei1' USING DFHEIV0
 21544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21545
 21546
 21547
 21548* EXEC CICS STARTBR
 21549*        DATASET    (AGTC-ID)
 21550*        RIDFLD     (ERAGTC-KEY)
 21551*        GTEQ
 21552*    END-EXEC.
 21553     MOVE 0
 21554       TO DFHEIV11
 21555*    MOVE '&,         G          &   #00020322' TO DFHEIV0
 21556     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21557     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21558     MOVE X'2020233030303230333232' TO DFHEIV0(25:11)
 21559     CALL 'kxdfhei1' USING DFHEIV0,
 21560           AGTC-ID,
 21561           ERAGTC-KEY,
 21562           DFHEIV99,
 21563           DFHEIV11,
 21564           DFHEIV99
 21565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21566
 21567
 21568 8583-READ-ERAGTC-NEXT.
 21569
 21570* EXEC CICS READNEXT
 21571*        DATASET     (AGTC-ID)
 21572*        INTO        (AGENT-COMMISSIONS)
 21573*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 398
* EL050.cbl
 21574*    END-EXEC.
 21575     MOVE LENGTH OF
 21576      AGENT-COMMISSIONS
 21577       TO DFHEIV12
 21578     MOVE 0
 21579       TO DFHEIV11
 21580*    MOVE '&.IL                  )   #00020329' TO DFHEIV0
 21581     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21582     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21583     MOVE X'2020233030303230333239' TO DFHEIV0(25:11)
 21584     CALL 'kxdfhei1' USING DFHEIV0,
 21585           AGTC-ID,
 21586           AGENT-COMMISSIONS,
 21587           DFHEIV12,
 21588           ERAGTC-KEY,
 21589           DFHEIV99,
 21590           DFHEIV11,
 21591           DFHEIV99,
 21592           DFHEIV99
 21593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21594
 21595
 21596*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21597
 21598     GO TO 8583-EXIT
 21599     .
 21600 8583-AGTC-NOT-FOUND.
 21601
 21602     MOVE 'N'                    TO AGTC-MASTER-SW.
 21603
 21604 8583-EXIT.
 21605     EXIT.
 21606
 21607 8584-READ-BANK-CROSS-REF.
 21608
 21609* EXEC CICS HANDLE CONDITION
 21610*        NOTFND    (8584-BXRF-NOT-FOUND)
 21611*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21612*    END-EXEC.
 21613*    MOVE '"$I''                  ! : #00020347' TO DFHEIV0
 21614     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21616     MOVE X'3A20233030303230333437' TO DFHEIV0(25:11)
 21617     CALL 'kxdfhei1' USING DFHEIV0
 21618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21619
 21620
 21621
 21622* EXEC CICS READ
 21623*        DATASET     (BXRF-ID)
 21624*        INTO        (BANK-CROSS-REFERENCE)
 21625*        RIDFLD      (ERBXRF-KEY)
 21626*        LENGTH      (BXRF-REC-LENGTH)
 21627*    END-EXEC.
 21628*    MOVE '&"IL       E          (   #00020352' TO DFHEIV0
 21629     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21630     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21631     MOVE X'2020233030303230333532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 399
* EL050.cbl
 21632     CALL 'kxdfhei1' USING DFHEIV0,
 21633           BXRF-ID,
 21634           BANK-CROSS-REFERENCE,
 21635           BXRF-REC-LENGTH,
 21636           ERBXRF-KEY,
 21637           DFHEIV99,
 21638           DFHEIV99,
 21639           DFHEIV99
 21640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21641
 21642
 21643     MOVE 'Y'                    TO BXRF-MASTER-SW
 21644
 21645     GO TO 8584-EXIT
 21646     .
 21647 8584-BXRF-NOT-FOUND.
 21648
 21649     MOVE 'N'                    TO BXRF-MASTER-SW.
 21650
 21651 8584-EXIT.
 21652     EXIT.
 21653
 21654 8585-READ-PLAN-MASTER.
 21655
 21656
 21657* EXEC CICS HANDLE CONDITION
 21658*        NOTFND    (8585-PLAN-NOT-FOUND)
 21659*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21660*    END-EXEC.
 21661*    MOVE '"$I''                  ! ; #00020372' TO DFHEIV0
 21662     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21664     MOVE X'3B20233030303230333732' TO DFHEIV0(25:11)
 21665     CALL 'kxdfhei1' USING DFHEIV0
 21666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21667
 21668
 21669
 21670* EXEC CICS READ
 21671*        DATASET     (PLAN-ID)
 21672*        INTO        (PLAN-MASTER)
 21673*        RIDFLD      (ERPLAN-KEY)
 21674*    END-EXEC.
 21675     MOVE LENGTH OF
 21676      PLAN-MASTER
 21677       TO DFHEIV11
 21678*    MOVE '&"IL       E          (   #00020377' TO DFHEIV0
 21679     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21680     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21681     MOVE X'2020233030303230333737' TO DFHEIV0(25:11)
 21682     CALL 'kxdfhei1' USING DFHEIV0,
 21683           PLAN-ID,
 21684           PLAN-MASTER,
 21685           DFHEIV11,
 21686           ERPLAN-KEY,
 21687           DFHEIV99,
 21688           DFHEIV99,
 21689           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 400
* EL050.cbl
 21690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21691
 21692
 21693     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21694
 21695     GO TO 8585-EXIT.
 21696
 21697 8585-PLAN-NOT-FOUND.
 21698
 21699     MOVE 'N'                    TO PLAN-MASTER-SW.
 21700
 21701 8585-EXIT.
 21702     EXIT.
 21703
 21704 8586-READ-LOAN-OFFICER.
 21705
 21706* EXEC CICS READ
 21707*        DATASET     (LOFC-ID)
 21708*        INTO        (LOAN-OFFICER-MASTER)
 21709*        RIDFLD      (ERLOFC-KEY)
 21710*        RESP        (WS-RESPONSE)
 21711*    END-EXEC
 21712     MOVE LENGTH OF
 21713      LOAN-OFFICER-MASTER
 21714       TO DFHEIV11
 21715*    MOVE '&"IL       E          (  N#00020395' TO DFHEIV0
 21716     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21718     MOVE X'204E233030303230333935' TO DFHEIV0(25:11)
 21719     CALL 'kxdfhei1' USING DFHEIV0,
 21720           LOFC-ID,
 21721           LOAN-OFFICER-MASTER,
 21722           DFHEIV11,
 21723           ERLOFC-KEY,
 21724           DFHEIV99,
 21725           DFHEIV99,
 21726           DFHEIV99
 21727     MOVE EIBRESP  TO WS-RESPONSE
 21728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21729
 21730     IF WS-RESP-NORMAL
 21731        MOVE 'Y'                 TO LOFC-MASTER-SW
 21732     ELSE
 21733        MOVE 'N'                 TO LOFC-MASTER-SW
 21734     END-IF
 21735     .
 21736 8586-EXIT.
 21737     EXIT.
 21738 8587-START-ERPDEF.
 21739
 21740* EXEC CICS STARTBR
 21741*       DATASET   (PDEF-ID)
 21742*       RIDFLD    (ERPDEF-KEY)
 21743*       GTEQ
 21744*       RESP      (WS-RESPONSE)
 21745*    END-EXEC
 21746     MOVE 0
 21747       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 401
* EL050.cbl
 21748*    MOVE '&,         G          &  N#00020411' TO DFHEIV0
 21749     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21751     MOVE X'204E233030303230343131' TO DFHEIV0(25:11)
 21752     CALL 'kxdfhei1' USING DFHEIV0,
 21753           PDEF-ID,
 21754           ERPDEF-KEY,
 21755           DFHEIV99,
 21756           DFHEIV11,
 21757           DFHEIV99
 21758     MOVE EIBRESP  TO WS-RESPONSE
 21759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21760     IF WS-RESP-NORMAL
 21761        MOVE 'Y'                 TO PDEF-MASTER-SW
 21762     ELSE
 21763        MOVE 'N'                 TO PDEF-MASTER-SW
 21764     END-IF
 21765     .
 21766 8587-EXIT.
 21767     EXIT.
 21768 8588-READ-ERPDEF.
 21769
 21770* EXEC CICS READNEXT
 21771*       DATASET   (PDEF-ID)
 21772*       RIDFLD    (ERPDEF-KEY)
 21773*       INTO      (PRODUCT-MASTER)
 21774*       RESP      (WS-RESPONSE)
 21775*    END-EXEC
 21776     MOVE LENGTH OF
 21777      PRODUCT-MASTER
 21778       TO DFHEIV12
 21779     MOVE 0
 21780       TO DFHEIV11
 21781*    MOVE '&.IL                  )  N#00020426' TO DFHEIV0
 21782     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21783     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21784     MOVE X'204E233030303230343236' TO DFHEIV0(25:11)
 21785     CALL 'kxdfhei1' USING DFHEIV0,
 21786           PDEF-ID,
 21787           PRODUCT-MASTER,
 21788           DFHEIV12,
 21789           ERPDEF-KEY,
 21790           DFHEIV99,
 21791           DFHEIV11,
 21792           DFHEIV99,
 21793           DFHEIV99
 21794     MOVE EIBRESP  TO WS-RESPONSE
 21795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21796     IF WS-RESP-NORMAL
 21797        MOVE 'Y'                 TO PDEF-MASTER-SW
 21798     ELSE
 21799        MOVE 'N'                 TO PDEF-MASTER-SW
 21800     END-IF
 21801     .
 21802 8588-EXIT.
 21803     EXIT.
 21804 8589-ENDBR-ERPDEF.
 21805
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 402
* EL050.cbl
 21806* EXEC CICS ENDBR
 21807*       DATASET   (PDEF-ID)
 21808*    END-EXEC
 21809     MOVE 0
 21810       TO DFHEIV11
 21811*    MOVE '&2                    $   #00020441' TO DFHEIV0
 21812     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21814     MOVE X'2020233030303230343431' TO DFHEIV0(25:11)
 21815     CALL 'kxdfhei1' USING DFHEIV0,
 21816           PDEF-ID,
 21817           DFHEIV11,
 21818           DFHEIV99
 21819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21820     .
 21821 8589-EXIT.
 21822     EXIT.
 21823 8590-READ-CERT-MASTER.
 21824     IF PB-COMPANY-ID = 'UCL'
 21825         GO TO 8690-READ-CERT-MASTER-UCL.
 21826
 21827
 21828* EXEC CICS HANDLE CONDITION
 21829*         NOTFND    (0299-CERT-NOT-FOUND)
 21830*    END-EXEC.
 21831*    MOVE '"$I                   ! < #00020451' TO DFHEIV0
 21832     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21834     MOVE X'3C20233030303230343531' TO DFHEIV0(25:11)
 21835     CALL 'kxdfhei1' USING DFHEIV0
 21836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21837
 21838
 21839
 21840* EXEC CICS READ
 21841*        DATASET     (CERT-ID)
 21842*        INTO        (CERTIFICATE-MASTER)
 21843*        RIDFLD      (ELCERT-KEY)
 21844*        UPDATE
 21845*    END-EXEC.
 21846     MOVE LENGTH OF
 21847      CERTIFICATE-MASTER
 21848       TO DFHEIV11
 21849*    MOVE '&"IL       EU         (   #00020455' TO DFHEIV0
 21850     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21851     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21852     MOVE X'2020233030303230343535' TO DFHEIV0(25:11)
 21853     CALL 'kxdfhei1' USING DFHEIV0,
 21854           CERT-ID,
 21855           CERTIFICATE-MASTER,
 21856           DFHEIV11,
 21857           ELCERT-KEY,
 21858           DFHEIV99,
 21859           DFHEIV99,
 21860           DFHEIV99
 21861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21862
 21863
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 403
* EL050.cbl
 21864 8590-EXIT.
 21865     EXIT.
 21866
 21867 8690-READ-CERT-MASTER-UCL.
 21868
 21869* EXEC CICS HANDLE CONDITION
 21870*         NOTFND    (8700-READ-CERT-MASTER)
 21871*    END-EXEC.
 21872*    MOVE '"$I                   ! = #00020466' TO DFHEIV0
 21873     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21875     MOVE X'3D20233030303230343636' TO DFHEIV0(25:11)
 21876     CALL 'kxdfhei1' USING DFHEIV0
 21877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21878
 21879
 21880 8690-READ-CERT-CONT.
 21881
 21882* EXEC CICS READ
 21883*        DATASET     (CERT-ID)
 21884*        INTO        (CERTIFICATE-MASTER)
 21885*        RIDFLD      (ELCERT-KEY)
 21886*        UPDATE
 21887*    END-EXEC.
 21888     MOVE LENGTH OF
 21889      CERTIFICATE-MASTER
 21890       TO DFHEIV11
 21891*    MOVE '&"IL       EU         (   #00020471' TO DFHEIV0
 21892     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21893     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21894     MOVE X'2020233030303230343731' TO DFHEIV0(25:11)
 21895     CALL 'kxdfhei1' USING DFHEIV0,
 21896           CERT-ID,
 21897           CERTIFICATE-MASTER,
 21898           DFHEIV11,
 21899           ELCERT-KEY,
 21900           DFHEIV99,
 21901           DFHEIV99,
 21902           DFHEIV99
 21903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21904
 21905
 21906     GO TO 8590-EXIT.
 21907
 21908 8700-READ-CERT-MASTER.
 21909     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21910     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21911
 21912* EXEC CICS HANDLE CONDITION
 21913*         DUPKEY    (8720-COMP-ACCOUNTS)
 21914*         ENDFILE   (8730-END-BROWSE)
 21915*         NOTFND    (8740-NOT-FOUND)
 21916*    END-EXEC.
 21917*    MOVE '"$$''I                 ! > #00020483' TO DFHEIV0
 21918     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21920     MOVE X'3E20233030303230343833' TO DFHEIV0(25:11)
 21921     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 404
* EL050.cbl
 21922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21923
 21924
 21925
 21926* EXEC CICS STARTBR
 21927*        DATASET     ('ELCERT5')
 21928*        RIDFLD      (ELCERT2-KEY)
 21929*        EQUAL
 21930*    END-EXEC.
 21931     MOVE 'ELCERT5' TO DFHEIV1
 21932     MOVE 0
 21933       TO DFHEIV11
 21934*    MOVE '&,         E          &   #00020489' TO DFHEIV0
 21935     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21936     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21937     MOVE X'2020233030303230343839' TO DFHEIV0(25:11)
 21938     CALL 'kxdfhei1' USING DFHEIV0,
 21939           DFHEIV1,
 21940           ELCERT2-KEY,
 21941           DFHEIV99,
 21942           DFHEIV11,
 21943           DFHEIV99
 21944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21945
 21946
 21947 8710-READ-NEXT.
 21948
 21949* EXEC CICS READNEXT
 21950*        DATASET     ('ELCERT5')
 21951*        INTO        (CERTIFICATE-MASTER)
 21952*        RIDFLD      (ELCERT2-KEY)
 21953*    END-EXEC.
 21954     MOVE LENGTH OF
 21955      CERTIFICATE-MASTER
 21956       TO DFHEIV12
 21957     MOVE 'ELCERT5' TO DFHEIV1
 21958     MOVE 0
 21959       TO DFHEIV11
 21960*    MOVE '&.IL                  )   #00020496' TO DFHEIV0
 21961     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21962     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21963     MOVE X'2020233030303230343936' TO DFHEIV0(25:11)
 21964     CALL 'kxdfhei1' USING DFHEIV0,
 21965           DFHEIV1,
 21966           CERTIFICATE-MASTER,
 21967           DFHEIV12,
 21968           ELCERT2-KEY,
 21969           DFHEIV99,
 21970           DFHEIV11,
 21971           DFHEIV99,
 21972           DFHEIV99
 21973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21974
 21975
 21976 8720-COMP-ACCOUNTS.
 21977
 21978* EXEC CICS ENTER
 21979*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 405
* EL050.cbl
 21980*         FROM (PB-C-LAST-NAME)
 21981*    END-EXEC.
 21982     MOVE 001
 21983       TO DFHEIV11
 21984*    MOVE ':$F                   %   #00020503' TO DFHEIV0
 21985     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21986     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21987     MOVE X'2020233030303230353033' TO DFHEIV0(25:11)
 21988     CALL 'kxdfhei1' USING DFHEIV0,
 21989           DFHEIV11,
 21990           PB-C-LAST-NAME,
 21991           DFHEIV99,
 21992           DFHEIV99
 21993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21994
 21995
 21996
 21997* EXEC CICS ENTER
 21998*         TRACEID (002)
 21999*         FROM (CM-INSURED-LAST-NAME)
 22000*    END-EXEC.
 22001     MOVE 002
 22002       TO DFHEIV11
 22003*    MOVE ':$F                   %   #00020508' TO DFHEIV0
 22004     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22005     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22006     MOVE X'2020233030303230353038' TO DFHEIV0(25:11)
 22007     CALL 'kxdfhei1' USING DFHEIV0,
 22008           DFHEIV11,
 22009           CM-INSURED-LAST-NAME,
 22010           DFHEIV99,
 22011           DFHEIV99
 22012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22013
 22014
 22015     IF PB-CERT-NO NOT = CM-CERT-NO
 22016         GO TO 8730-END-BROWSE.
 22017
 22018     IF PB-ACCOUNT = CM-ACCOUNT
 22019         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22020             MOVE ER-2799        TO WS-ERROR
 22021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22022             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22023             GO TO 8730-END-BROWSE.
 22024
 22025     GO TO 8710-READ-NEXT.
 22026
 22027 8730-END-BROWSE.
 22028
 22029* EXEC CICS ENDBR
 22030*         DATASET    ('ELCERT5')
 22031*    END-EXEC.
 22032     MOVE 'ELCERT5' TO DFHEIV1
 22033     MOVE 0
 22034       TO DFHEIV11
 22035*    MOVE '&2                    $   #00020526' TO DFHEIV0
 22036     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22037     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 406
* EL050.cbl
 22038     MOVE X'2020233030303230353236' TO DFHEIV0(25:11)
 22039     CALL 'kxdfhei1' USING DFHEIV0,
 22040           DFHEIV1,
 22041           DFHEIV11,
 22042           DFHEIV99
 22043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22044
 22045
 22046 8740-NOT-FOUND.
 22047     GO TO 0299-CERT-NOT-FOUND.
 22048
 22049 8750-START-ELSTAT.
 22050
 22051* EXEC CICS STARTBR
 22052*       DATASET   (STAT-ID)
 22053*       RIDFLD    (ELSTAT-KEY)
 22054*       GTEQ
 22055*       RESP      (WS-RESPONSE)
 22056*    END-EXEC
 22057     MOVE 0
 22058       TO DFHEIV11
 22059*    MOVE '&,         G          &  N#00020534' TO DFHEIV0
 22060     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22061     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22062     MOVE X'204E233030303230353334' TO DFHEIV0(25:11)
 22063     CALL 'kxdfhei1' USING DFHEIV0,
 22064           STAT-ID,
 22065           ELSTAT-KEY,
 22066           DFHEIV99,
 22067           DFHEIV11,
 22068           DFHEIV99
 22069     MOVE EIBRESP  TO WS-RESPONSE
 22070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22071     IF WS-RESP-NORMAL
 22072        MOVE 'Y'                 TO STAT-MASTER-SW
 22073     ELSE
 22074        MOVE 'N'                 TO STAT-MASTER-SW
 22075     END-IF
 22076     .
 22077 8750-EXIT.
 22078     EXIT.
 22079 8752-READ-ELSTAT.
 22080
 22081* EXEC CICS READNEXT
 22082*       DATASET   (STAT-ID)
 22083*       RIDFLD    (ELSTAT-KEY)
 22084*       INTO      (STATE-FILE)
 22085*       RESP      (WS-RESPONSE)
 22086*    END-EXEC
 22087     MOVE LENGTH OF
 22088      STATE-FILE
 22089       TO DFHEIV12
 22090     MOVE 0
 22091       TO DFHEIV11
 22092*    MOVE '&.IL                  )  N#00020549' TO DFHEIV0
 22093     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22094     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22095     MOVE X'204E233030303230353439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 407
* EL050.cbl
 22096     CALL 'kxdfhei1' USING DFHEIV0,
 22097           STAT-ID,
 22098           STATE-FILE,
 22099           DFHEIV12,
 22100           ELSTAT-KEY,
 22101           DFHEIV99,
 22102           DFHEIV11,
 22103           DFHEIV99,
 22104           DFHEIV99
 22105     MOVE EIBRESP  TO WS-RESPONSE
 22106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22107     IF WS-RESP-NORMAL
 22108        MOVE 'Y'                 TO STAT-MASTER-SW
 22109     ELSE
 22110        MOVE 'N'                 TO STAT-MASTER-SW
 22111     END-IF
 22112     .
 22113 8752-EXIT.
 22114     EXIT.
 22115 8800-GET-COMP-RATE.
 22116     MOVE +1 TO IB.
 22117     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22118         ADD +9 TO IB
 22119         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22120             ADD +9 TO IB
 22121             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22122                MOVE ZEROS       TO WS-WK-RATE
 22123                GO TO 8800-EXIT.
 22124
 22125     IF PB-I-AGE GREATER CT-AGE (1)
 22126         ADD +3 TO IB
 22127         IF PB-I-AGE GREATER CT-AGE (2)
 22128             ADD +3 TO IB
 22129             IF PB-I-AGE GREATER CT-AGE (3)
 22130                MOVE ZEROS       TO WS-WK-RATE
 22131                GO TO 8800-EXIT.
 22132
 22133     IF WS-WORK-TERM GREATER CT-TRM (1)
 22134         ADD +1 TO IB
 22135         IF WS-WORK-TERM GREATER CT-TRM (2)
 22136             ADD +1 TO IB
 22137             IF WS-WORK-TERM GREATER CT-TRM (3)
 22138                MOVE ZEROS       TO WS-WK-RATE
 22139                GO TO 8800-EXIT.
 22140
 22141     IF CT-RT (IB) NOT NUMERIC
 22142         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22143         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22144         GO TO 8800-GET-COMP-RATE.
 22145
 22146     MOVE CT-RT (IB) TO WS-WK-RATE.
 22147
 22148 8800-EXIT.
 22149     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 408
* EL050.cbl
 22151 8900-ADDRESS-FILE.
 22152     IF ERACCT-FILE-ADDRESSED
 22153         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22154         GO TO 8900-ADDRESS-EXIT.
 22155
 22156     IF ELCNTL-FILE-ADDRESSED
 22157         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22158         GO TO 8900-ADDRESS-EXIT.
 22159
 22160     IF ERPLAN-FILE-ADDRESSED
 22161         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22162         GO TO 8900-ADDRESS-EXIT.
 22163
 22164     IF ERFORM-FILE-ADDRESSED
 22165         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22166         GO TO 8900-ADDRESS-EXIT.
 22167
 22168 8900-ADDRESS-EXIT.
 22169     EXIT.
 22170
 22171 9000-READ-CONTROL.
 22172
 22173* EXEC CICS HANDLE CONDITION
 22174*        NOTFND    (9000-NOTFND)
 22175*    END-EXEC.
 22176*    MOVE '"$I                   ! ? #00020620' TO DFHEIV0
 22177     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22179     MOVE X'3F20233030303230363230' TO DFHEIV0(25:11)
 22180     CALL 'kxdfhei1' USING DFHEIV0
 22181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22182
 22183
 22184
 22185* EXEC CICS READ
 22186*        DATASET     (CNTL-ID)
 22187*        SET         (ADDRESS OF CONTROL-FILE)
 22188*        RIDFLD      (ELCNTL-KEY)
 22189*        GTEQ
 22190*    END-EXEC.
 22191*    MOVE '&"S        G          (   #00020624' TO DFHEIV0
 22192     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22194     MOVE X'2020233030303230363234' TO DFHEIV0(25:11)
 22195     CALL 'kxdfhei1' USING DFHEIV0,
 22196           CNTL-ID,
 22197           DFHEIV20,
 22198           DFHEIV99,
 22199           ELCNTL-KEY,
 22200           DFHEIV99,
 22201           DFHEIV99,
 22202           DFHEIV99
 22203     SET ADDRESS OF CONTROL-FILE TO
 22204         DFHEIV20
 22205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22206
 22207
 22208     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 409
* EL050.cbl
 22209
 22210 9000-NOTFND.
 22211     IF RC-SW-1 = '1'
 22212        MOVE ER-2616              TO WS-ERROR
 22213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22214        GO TO 9000-EXIT.
 22215
 22216     IF RC-SW-1 = '2'
 22217        MOVE ER-2602              TO WS-ERROR
 22218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22219
 22220 9000-EXIT.
 22221      EXIT.
 22222
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 410
* EL050.cbl
 22224 9100-READ-CONTROL.
 22225
 22226* EXEC CICS HANDLE CONDITION
 22227*        NOTFND  (9100-NOTFND)
 22228*        ENDFILE (9100-NOTFND)
 22229*    END-EXEC.
 22230*    MOVE '"$I''                  ! @ #00020648' TO DFHEIV0
 22231     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22233     MOVE X'4020233030303230363438' TO DFHEIV0(25:11)
 22234     CALL 'kxdfhei1' USING DFHEIV0
 22235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22236
 22237
 22238
 22239* EXEC CICS READ
 22240*        DATASET     (CNTL-ID)
 22241*        INTO        (CONTROL-FILE)
 22242*        RIDFLD      (ELCNTL-KEY)
 22243*        GTEQ
 22244*    END-EXEC.
 22245     MOVE LENGTH OF
 22246      CONTROL-FILE
 22247       TO DFHEIV11
 22248*    MOVE '&"IL       G          (   #00020653' TO DFHEIV0
 22249     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22251     MOVE X'2020233030303230363533' TO DFHEIV0(25:11)
 22252     CALL 'kxdfhei1' USING DFHEIV0,
 22253           CNTL-ID,
 22254           CONTROL-FILE,
 22255           DFHEIV11,
 22256           ELCNTL-KEY,
 22257           DFHEIV99,
 22258           DFHEIV99,
 22259           DFHEIV99
 22260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22261
 22262
 22263     GO TO 9100-EXIT.
 22264
 22265 9100-NOTFND.
 22266     IF RC-SW-2 = '0'
 22267        MOVE '1'                  TO STATE-RECORD-ERROR
 22268        GO TO 9100-EXIT
 22269     END-IF
 22270     IF RC-SW-2 = '1'
 22271        MOVE '1'                  TO LF-BENEFIT-ERROR
 22272        MOVE ER-2604              TO WS-ERROR
 22273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22274        GO TO 9100-EXIT.
 22275
 22276     IF RC-SW-2 = '2'
 22277        MOVE '1'                  TO AH-BENEFIT-ERROR
 22278        MOVE ER-2605              TO WS-ERROR
 22279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22280        GO TO 9100-EXIT.
 22281
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 411
* EL050.cbl
 22282     IF RC-SW-2 = '3'
 22283         MOVE ER-2603           TO WS-ERROR
 22284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22285         GO TO 9100-EXIT.
 22286
 22287     IF RC-SW-2 = '4'
 22288         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22289         GO TO 9100-EXIT.
 22290
 22291     IF RC-SW-2 = '5'
 22292         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22293         IF WS-AH-INPUT-CD-1 = SPACE
 22294             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22295         ELSE
 22296             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22297
 22298 9100-EXIT.
 22299      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 412
* EL050.cbl
 22301 9200-CONTROL-GETMAIN.
 22302
 22303* EXEC CICS GETMAIN
 22304*         LENGTH   (750)
 22305*         SET      (ADDRESS OF CONTROL-FILE)
 22306*    END-EXEC.
 22307     MOVE 750
 22308       TO DFHEIV11
 22309*    MOVE '," L                  $   #00020699' TO DFHEIV0
 22310     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22311     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22312     MOVE X'2020233030303230363939' TO DFHEIV0(25:11)
 22313     CALL 'kxdfhei1' USING DFHEIV0,
 22314           DFHEIV20,
 22315           DFHEIV11,
 22316           DFHEIV99
 22317     SET ADDRESS OF CONTROL-FILE TO
 22318         DFHEIV20
 22319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22320
 22321
 22322     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22323
 22324 9200-EXIT.
 22325     EXIT.
 22326
 22327 9250-UNLOCK-RETURN.
 22328
 22329* EXEC CICS UNLOCK
 22330*        DATASET   (CERT-ID)
 22331*    END-EXEC.
 22332*    MOVE '&*                    #   #00020710' TO DFHEIV0
 22333     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22334     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22335     MOVE X'2020233030303230373130' TO DFHEIV0(25:11)
 22336     CALL 'kxdfhei1' USING DFHEIV0,
 22337           CERT-ID,
 22338           DFHEIV99
 22339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22340
 22341
 22342 9300-ABEND.
 22343     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22344
 22345
 22346* EXEC CICS LINK
 22347*        PROGRAM   ('EL004')
 22348*        COMMAREA  (WS-ERROR-LINE)
 22349*        LENGTH    (72)
 22350*    END-EXEC.
 22351     MOVE 'EL004' TO DFHEIV1
 22352     MOVE 72
 22353       TO DFHEIV11
 22354*    MOVE '."C                   (   #00020717' TO DFHEIV0
 22355     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22357     MOVE X'2020233030303230373137' TO DFHEIV0(25:11)
 22358     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 413
* EL050.cbl
 22359           DFHEIV1,
 22360           WS-ERROR-LINE,
 22361           DFHEIV11,
 22362           DFHEIV99,
 22363           DFHEIV99,
 22364           DFHEIV99,
 22365           DFHEIV99
 22366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22367
 22368
 22369     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22370
 22371
 22372* EXEC CICS ABEND
 22373*        ABCODE ('EL50')
 22374*    END-EXEC.
 22375     MOVE 'EL50' TO DFHEIV5
 22376*    MOVE '.,A                   "   #00020725' TO DFHEIV0
 22377     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22378     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22379     MOVE X'2020233030303230373235' TO DFHEIV0(25:11)
 22380     CALL 'kxdfhei1' USING DFHEIV0,
 22381           DFHEIV5
 22382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22383
 22384
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 414
* EL050.cbl
 22386
 22387******************************************************************
 22388*                                                                *
 22389*            E R R O R   F O R M A T   R O U T I N E             *
 22390*                                                                *
 22391******************************************************************
 22392
 22393 9900-ERROR-FORMAT.
 22394
 22395     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22396                    PB-COMMON-ERROR (2) OR
 22397                    PB-COMMON-ERROR (3) OR
 22398                    PB-COMMON-ERROR (4) OR
 22399                    PB-COMMON-ERROR (5) OR
 22400                    PB-COMMON-ERROR (6) OR
 22401                    PB-COMMON-ERROR (7) OR
 22402                    PB-COMMON-ERROR (8) OR
 22403                    PB-COMMON-ERROR (9) OR
 22404                    PB-COMMON-ERROR (10)
 22405        GO TO 9900-EXIT.
 22406
 22407     IF PB-NO-OF-ERRORS = +10
 22408        GO TO 9900-EXIT.
 22409
 22410     ADD +1  TO PB-NO-OF-ERRORS.
 22411     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22412                                       (PB-NO-OF-ERRORS).
 22413 9900-EXIT.
 22414     EXIT.
 22415
 22416 9990-RETURN.
 22417     IF BROWSE-STARTED
 22418
 22419* EXEC CICS ENDBR
 22420*            DATASET  (ACCT-ID)
 22421*       END-EXEC.
 22422     MOVE 0
 22423       TO DFHEIV11
 22424*    MOVE '&2                    $   #00020762' TO DFHEIV0
 22425     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22427     MOVE X'2020233030303230373632' TO DFHEIV0(25:11)
 22428     CALL 'kxdfhei1' USING DFHEIV0,
 22429           ACCT-ID,
 22430           DFHEIV11,
 22431           DFHEIV99
 22432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22433
 22434
 22435 9990-EXIT.
 22436     EXIT.
 22437
 22438
 22439****Check for CRTO record, add one if not found.
 22440 9991-CHECK-FOR-ELCRTO.
 22441
 22442* EXEC CICS HANDLE CONDITION
 22443*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 415
* EL050.cbl
 22444*         ENDFILE (9991-CRTO-NOT-FOUND)
 22445*     END-EXEC.
 22446*    MOVE '"$I''                  ! A #00020772' TO DFHEIV0
 22447     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22449     MOVE X'4120233030303230373732' TO DFHEIV0(25:11)
 22450     CALL 'kxdfhei1' USING DFHEIV0
 22451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22452
 22453     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22454     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22455     MOVE +0                     TO ELCRTO-SEQ-NO
 22456
 22457
 22458* EXEC CICS READ
 22459*       DATASET   ('ELCRTO')
 22460*       INTO      (ORIGINAL-CERTIFICATE)
 22461*       RIDFLD    (ELCRTO-KEY)
 22462*       GTEQ
 22463*       RESP      (WS-RESPONSE)
 22464*    END-EXEC
 22465     MOVE LENGTH OF
 22466      ORIGINAL-CERTIFICATE
 22467       TO DFHEIV11
 22468     MOVE 'ELCRTO' TO DFHEIV1
 22469*    MOVE '&"IL       G          (  N#00020780' TO DFHEIV0
 22470     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22472     MOVE X'204E233030303230373830' TO DFHEIV0(25:11)
 22473     CALL 'kxdfhei1' USING DFHEIV0,
 22474           DFHEIV1,
 22475           ORIGINAL-CERTIFICATE,
 22476           DFHEIV11,
 22477           ELCRTO-KEY,
 22478           DFHEIV99,
 22479           DFHEIV99,
 22480           DFHEIV99
 22481     MOVE EIBRESP  TO WS-RESPONSE
 22482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22483
 22484     IF WS-RESP-NORMAL
 22485        AND (OC-CONTROL-PRIMARY (1:33) =
 22486                 PB-CONTROL-BY-ACCOUNT (1:33))
 22487        AND (OC-RECORD-TYPE =  'I')
 22488           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22489               GO TO 9991-CHECK-INDICATORS
 22490           ELSE
 22491               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22492               GO TO 9991-CRTO-ADD-REC
 22493           END-IF
 22494     END-IF.
 22495
 22496 9991-CRTO-NOT-FOUND.
 22497
 22498     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22499     MOVE 'OC'                TO OC-RECORD-ID
 22500     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22501                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 416
* EL050.cbl
 22502     MOVE +4096               TO OC-KEY-SEQ-NO.
 22503
 22504 9991-CRTO-ADD-REC.
 22505
 22506     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22507     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22508     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22509     MOVE 'I'                 TO OC-RECORD-TYPE
 22510     IF PB-ISSUE
 22511         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22512         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22513         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22514         MOVE PB-I-AGE               TO OC-INS-AGE
 22515         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22516         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22517         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22518         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22519         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22520         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22521         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22522         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22523         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22524         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22525         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22526         IF PB-I-JOINT-COMMISSION > +0
 22527             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22528         ELSE
 22529             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22530         END-IF
 22531         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22532         MOVE +0                     TO OC-LF-CANCEL-AMT
 22533                                        OC-LF-ITD-CANCEL-AMT
 22534         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22535         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22536         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22537         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22538         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22539         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22540         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22541         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22542         MOVE +0                     TO OC-AH-CANCEL-AMT
 22543                                        OC-AH-ITD-CANCEL-AMT
 22544         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22545         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22546         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22547     ELSE
 22548         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22549         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22550         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22551         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22552         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22553         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22554         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22555         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22556         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22557          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22558             MOVE SPACES             TO OC-LF-BENCD
 22559             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 417
* EL050.cbl
 22560                                        OC-LF-BEN-AMT
 22561                                        OC-LF-PRM-AMT
 22562                                        OC-LF-ALT-BEN-AMT
 22563                                        OC-LF-ALT-PRM-AMT
 22564                                        OC-LF-COMM-PCT
 22565                                        OC-LF-CANCEL-AMT
 22566             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22567             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22568         ELSE
 22569             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22570             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22571             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22572             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22573             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22574             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22575             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22576             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22577             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22578             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22579         END-IF
 22580         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22581         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22582          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22583             MOVE SPACES             TO OC-AH-BENCD
 22584             MOVE ZEROS              TO OC-AH-TERM
 22585                                        OC-AH-BEN-AMT
 22586                                        OC-AH-PRM-AMT
 22587                                        OC-AH-COMM-PCT
 22588                                        OC-AH-CANCEL-AMT
 22589                                        OC-AH-CP
 22590             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22591             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22592         ELSE
 22593             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22594             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22595             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22596             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22597             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22598             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22599             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22600             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22601             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22602         END-IF
 22603         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22604         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22605         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22606         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22607     END-IF
 22608     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22609
 22610     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22611
 22612
 22613* EXEC CICS READ
 22614*         DATASET   (FILE-ERMAIL)
 22615*         RIDFLD    (MA-CONTROL-PRIMARY)
 22616*         INTO      (MAILING-DATA)
 22617*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 418
* EL050.cbl
 22618*    END-EXEC
 22619     MOVE LENGTH OF
 22620      MAILING-DATA
 22621       TO DFHEIV11
 22622*    MOVE '&"IL       E          (  N#00020916' TO DFHEIV0
 22623     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22625     MOVE X'204E233030303230393136' TO DFHEIV0(25:11)
 22626     CALL 'kxdfhei1' USING DFHEIV0,
 22627           FILE-ERMAIL,
 22628           MAILING-DATA,
 22629           DFHEIV11,
 22630           MA-CONTROL-PRIMARY,
 22631           DFHEIV99,
 22632           DFHEIV99,
 22633           DFHEIV99
 22634     MOVE EIBRESP  TO WS-RESPONSE
 22635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22636
 22637     IF WS-RESP-NORMAL
 22638         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22639     END-IF.
 22640
 22641     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22642     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22643
 22644
 22645* EXEC CICS READ
 22646*         DATASET  (CRTT-ID)
 22647*         RIDFLD   (WS-ELCRTT-KEY)
 22648*         INTO     (CERTIFICATE-TRAILERS)
 22649*         RESP     (WS-RESPONSE)
 22650*    END-EXEC
 22651     MOVE LENGTH OF
 22652      CERTIFICATE-TRAILERS
 22653       TO DFHEIV11
 22654*    MOVE '&"IL       E          (  N#00020930' TO DFHEIV0
 22655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22657     MOVE X'204E233030303230393330' TO DFHEIV0(25:11)
 22658     CALL 'kxdfhei1' USING DFHEIV0,
 22659           CRTT-ID,
 22660           CERTIFICATE-TRAILERS,
 22661           DFHEIV11,
 22662           WS-ELCRTT-KEY,
 22663           DFHEIV99,
 22664           DFHEIV99,
 22665           DFHEIV99
 22666     MOVE EIBRESP  TO WS-RESPONSE
 22667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22668
 22669     IF WS-RESP-NORMAL
 22670         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22671         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22672     END-IF.
 22673
 22674
 22675* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 419
* EL050.cbl
 22676*       DATASET   ('ELCRTO')
 22677*       FROM      (ORIGINAL-CERTIFICATE)
 22678*       RIDFLD    (OC-CONTROL-PRIMARY)
 22679*       RESP      (WS-RESPONSE)
 22680*    END-EXEC.
 22681     MOVE LENGTH OF
 22682      ORIGINAL-CERTIFICATE
 22683       TO DFHEIV11
 22684     MOVE 'ELCRTO' TO DFHEIV1
 22685*    MOVE '&$ L                  ''  N#00020942' TO DFHEIV0
 22686     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22687     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22688     MOVE X'204E233030303230393432' TO DFHEIV0(25:11)
 22689     CALL 'kxdfhei1' USING DFHEIV0,
 22690           DFHEIV1,
 22691           ORIGINAL-CERTIFICATE,
 22692           DFHEIV11,
 22693           OC-CONTROL-PRIMARY,
 22694           DFHEIV99,
 22695           DFHEIV99
 22696     MOVE EIBRESP  TO WS-RESPONSE
 22697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22698
 22699
 22700     GO TO 9991-EXIT.
 22701
 22702 9991-CHECK-INDICATORS.
 22703
 22704     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22705         GO TO 9991-EXIT
 22706     END-IF.
 22707
 22708     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22709         GO TO 9991-EXIT
 22710     END-IF.
 22711
 22712
 22713* EXEC CICS READ
 22714*       DATASET   ('ELCRTO')
 22715*       INTO      (ORIGINAL-CERTIFICATE)
 22716*       RIDFLD    (OC-CONTROL-PRIMARY)
 22717*       UPDATE
 22718*       RESP      (WS-RESPONSE)
 22719*    END-EXEC
 22720     MOVE LENGTH OF
 22721      ORIGINAL-CERTIFICATE
 22722       TO DFHEIV11
 22723     MOVE 'ELCRTO' TO DFHEIV1
 22724*    MOVE '&"IL       EU         (  N#00020961' TO DFHEIV0
 22725     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22726     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22727     MOVE X'204E233030303230393631' TO DFHEIV0(25:11)
 22728     CALL 'kxdfhei1' USING DFHEIV0,
 22729           DFHEIV1,
 22730           ORIGINAL-CERTIFICATE,
 22731           DFHEIV11,
 22732           OC-CONTROL-PRIMARY,
 22733           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 420
* EL050.cbl
 22734           DFHEIV99,
 22735           DFHEIV99
 22736     MOVE EIBRESP  TO WS-RESPONSE
 22737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22738     IF WS-RESP-NORMAL
 22739        IF PB-ISSUE
 22740          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22741          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22742          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22743          MOVE PB-I-AGE               TO OC-INS-AGE
 22744          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22745          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22746          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22747          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22748          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22749          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22750          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22751          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22752          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22753          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22754          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22755          IF PB-I-JOINT-COMMISSION > +0
 22756              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22757          ELSE
 22758              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22759          END-IF
 22760          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22761          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22762          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22763          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22764          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22765          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22766          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22767          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22768          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22769
 22770          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22771
 22772* EXEC CICS READ
 22773*             DATASET   (FILE-ERMAIL)
 22774*             RIDFLD    (MA-CONTROL-PRIMARY)
 22775*             INTO      (MAILING-DATA)
 22776*             RESP      (WS-RESPONSE)
 22777*         END-EXEC
 22778     MOVE LENGTH OF
 22779      MAILING-DATA
 22780       TO DFHEIV11
 22781*    MOVE '&"IL       E          (  N#00021001' TO DFHEIV0
 22782     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22784     MOVE X'204E233030303231303031' TO DFHEIV0(25:11)
 22785     CALL 'kxdfhei1' USING DFHEIV0,
 22786           FILE-ERMAIL,
 22787           MAILING-DATA,
 22788           DFHEIV11,
 22789           MA-CONTROL-PRIMARY,
 22790           DFHEIV99,
 22791           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 421
* EL050.cbl
 22792           DFHEIV99
 22793     MOVE EIBRESP  TO WS-RESPONSE
 22794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22795          IF WS-RESP-NORMAL
 22796             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22797          END-IF
 22798
 22799          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22800          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22801
 22802* EXEC CICS READ
 22803*             DATASET  (CRTT-ID)
 22804*             RIDFLD   (WS-ELCRTT-KEY)
 22805*             INTO     (CERTIFICATE-TRAILERS)
 22806*             RESP     (WS-RESPONSE)
 22807*         END-EXEC
 22808     MOVE LENGTH OF
 22809      CERTIFICATE-TRAILERS
 22810       TO DFHEIV11
 22811*    MOVE '&"IL       E          (  N#00021013' TO DFHEIV0
 22812     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22814     MOVE X'204E233030303231303133' TO DFHEIV0(25:11)
 22815     CALL 'kxdfhei1' USING DFHEIV0,
 22816           CRTT-ID,
 22817           CERTIFICATE-TRAILERS,
 22818           DFHEIV11,
 22819           WS-ELCRTT-KEY,
 22820           DFHEIV99,
 22821           DFHEIV99,
 22822           DFHEIV99
 22823     MOVE EIBRESP  TO WS-RESPONSE
 22824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22825          IF WS-RESP-NORMAL
 22826             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22827                               OC-INS-AGE-DEFAULT-FLAG
 22828             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22829                               OC-JNT-AGE-DEFAULT-FLAG
 22830          END-IF
 22831
 22832        ELSE
 22833          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22834             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22835             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22836             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22837          END-IF
 22838          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22839             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22840             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22841             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22842          END-IF
 22843          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22844        END-IF
 22845
 22846* EXEC CICS REWRITE
 22847*          DATASET   ('ELCRTO')
 22848*          FROM      (ORIGINAL-CERTIFICATE)
 22849*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 422
* EL050.cbl
 22850*       END-EXEC
 22851     MOVE LENGTH OF
 22852      ORIGINAL-CERTIFICATE
 22853       TO DFHEIV11
 22854     MOVE 'ELCRTO' TO DFHEIV1
 22855*    MOVE '&& L                  %  N#00021039' TO DFHEIV0
 22856     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22857     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22858     MOVE X'204E233030303231303339' TO DFHEIV0(25:11)
 22859     CALL 'kxdfhei1' USING DFHEIV0,
 22860           DFHEIV1,
 22861           ORIGINAL-CERTIFICATE,
 22862           DFHEIV11,
 22863           DFHEIV99
 22864     MOVE EIBRESP  TO WS-RESPONSE
 22865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22866     END-IF.
 22867
 22868 9991-EXIT.
 22869     EXIT.
 22870
 22871
 22872 9999-RETURN.
 22873     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22874
 22875
 22876* EXEC CICS RETURN
 22877*    END-EXEC.
 22878*    MOVE '.(                    ''   #00021053' TO DFHEIV0
 22879     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22880     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22881     MOVE X'2020233030303231303533' TO DFHEIV0(25:11)
 22882     CALL 'kxdfhei1' USING DFHEIV0,
 22883           DFHEIV99,
 22884           DFHEIV99,
 22885           DFHEIV99,
 22886           DFHEIV99,
 22887           DFHEIV99,
 22888           DFHEIV99
 22889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22890
 22891
 22892
 22893* GOBACK.
 22894     MOVE '9%                    "   ' TO DFHEIV0
 22895     MOVE 'EL050' TO DFHEIV1
 22896     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22897     GOBACK.
 22898
 22899 9999-DFHBACK SECTION.
 22900     MOVE '9%                    "   ' TO DFHEIV0
 22901     MOVE 'EL050' TO DFHEIV1
 22902     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22903     GOBACK.
 22904 9999-DFHEXIT.
 22905     IF DFHEIGDJ EQUAL 0001
 22906         NEXT SENTENCE
 22907     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 423
* EL050.cbl
 22908         GO TO 9300-ABEND,
 22909               3990-FILES-NOT-OPEN
 22910         DEPENDING ON DFHEIGDI
 22911     ELSE IF DFHEIGDJ EQUAL 3
 22912         GO TO 6610-START-BROWSE,
 22913               6630-ERRESS-PROBLEM,
 22914               6630-END-OF-FILE
 22915         DEPENDING ON DFHEIGDI
 22916     ELSE IF DFHEIGDJ EQUAL 4
 22917         GO TO 6630-END-OF-FILE,
 22918               6630-ERRESS-PROBLEM,
 22919               6630-ERRESS-PROBLEM,
 22920               6630-END-OF-FILE
 22921         DEPENDING ON DFHEIGDI
 22922     ELSE IF DFHEIGDJ EQUAL 5
 22923         GO TO 6630-END-OF-FILE,
 22924               6630-END-OF-FILE,
 22925               6630-ERRESS-PROBLEM,
 22926               6630-ERRESS-PROBLEM
 22927         DEPENDING ON DFHEIGDI
 22928     ELSE IF DFHEIGDJ EQUAL 6
 22929         GO TO 6660-START-BROWSE,
 22930               6690-ERRESC-PROBLEM,
 22931               6690-ERRESC-PROBLEM,
 22932               6690-END-OF-FILE
 22933         DEPENDING ON DFHEIGDI
 22934     ELSE IF DFHEIGDJ EQUAL 7
 22935         GO TO 6690-END-OF-FILE,
 22936               6690-ERRESC-PROBLEM,
 22937               6690-ERRESC-PROBLEM,
 22938               6690-END-OF-FILE
 22939         DEPENDING ON DFHEIGDI
 22940     ELSE IF DFHEIGDJ EQUAL 8
 22941         GO TO 6690-END-OF-FILE,
 22942               6690-ERRESC-PROBLEM,
 22943               6690-ERRESC-PROBLEM,
 22944               6690-END-OF-FILE
 22945         DEPENDING ON DFHEIGDI
 22946     ELSE IF DFHEIGDJ EQUAL 9
 22947         GO TO 7250-CONTINUE,
 22948               7250-CONTINUE
 22949         DEPENDING ON DFHEIGDI
 22950     ELSE IF DFHEIGDJ EQUAL 10
 22951         GO TO 7300-CONTINUE,
 22952               7300-CONTINUE
 22953         DEPENDING ON DFHEIGDI
 22954     ELSE IF DFHEIGDJ EQUAL 11
 22955         GO TO 8000-FREE-MAIN
 22956         DEPENDING ON DFHEIGDI
 22957     ELSE IF DFHEIGDJ EQUAL 12
 22958         GO TO 8100-NOTFND,
 22959               8100-NOTFND
 22960         DEPENDING ON DFHEIGDI
 22961     ELSE IF DFHEIGDJ EQUAL 13
 22962         GO TO 8110-NOTFND,
 22963               8110-NOTFND
 22964         DEPENDING ON DFHEIGDI
 22965     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 424
* EL050.cbl
 22966         GO TO 8130-EXIT
 22967         DEPENDING ON DFHEIGDI
 22968     ELSE IF DFHEIGDJ EQUAL 15
 22969         GO TO 8150-exit
 22970         DEPENDING ON DFHEIGDI
 22971     ELSE IF DFHEIGDJ EQUAL 16
 22972         GO TO 8180-NOTFND
 22973         DEPENDING ON DFHEIGDI
 22974     ELSE IF DFHEIGDJ EQUAL 17
 22975         GO TO 8190-NOTFND
 22976         DEPENDING ON DFHEIGDI
 22977     ELSE IF DFHEIGDJ EQUAL 18
 22978         GO TO 8195-NOTFND
 22979         DEPENDING ON DFHEIGDI
 22980     ELSE IF DFHEIGDJ EQUAL 19
 22981         GO TO 8200-NOTFND
 22982         DEPENDING ON DFHEIGDI
 22983     ELSE IF DFHEIGDJ EQUAL 20
 22984         GO TO 8300-NOTFND,
 22985               8300-ERRESS-PROBLEM,
 22986               8300-ERRESS-PROBLEM,
 22987               8300-NOTFND
 22988         DEPENDING ON DFHEIGDI
 22989     ELSE IF DFHEIGDJ EQUAL 21
 22990         GO TO 8450-FORM-NOT-FOUND,
 22991               8450-FORM-NOT-FOUND
 22992         DEPENDING ON DFHEIGDI
 22993     ELSE IF DFHEIGDJ EQUAL 22
 22994         GO TO 0199-ACCT-NOT-FOUND,
 22995               0199-ACCT-NOT-FOUND
 22996         DEPENDING ON DFHEIGDI
 22997     ELSE IF DFHEIGDJ EQUAL 23
 22998         GO TO 0199-ACCT-NOT-FOUND,
 22999               0199-ACCT-NOT-FOUND
 23000         DEPENDING ON DFHEIGDI
 23001     ELSE IF DFHEIGDJ EQUAL 24
 23002         GO TO 8582-COMP-NOT-FOUND,
 23003               8582-COMP-NOT-FOUND
 23004         DEPENDING ON DFHEIGDI
 23005     ELSE IF DFHEIGDJ EQUAL 25
 23006         GO TO 8583-AGTC-NOT-FOUND,
 23007               8583-AGTC-NOT-FOUND
 23008         DEPENDING ON DFHEIGDI
 23009     ELSE IF DFHEIGDJ EQUAL 26
 23010         GO TO 8584-BXRF-NOT-FOUND,
 23011               8584-BXRF-NOT-FOUND
 23012         DEPENDING ON DFHEIGDI
 23013     ELSE IF DFHEIGDJ EQUAL 27
 23014         GO TO 8585-PLAN-NOT-FOUND,
 23015               8585-PLAN-NOT-FOUND
 23016         DEPENDING ON DFHEIGDI
 23017     ELSE IF DFHEIGDJ EQUAL 28
 23018         GO TO 0299-CERT-NOT-FOUND
 23019         DEPENDING ON DFHEIGDI
 23020     ELSE IF DFHEIGDJ EQUAL 29
 23021         GO TO 8700-READ-CERT-MASTER
 23022         DEPENDING ON DFHEIGDI
 23023     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:39 Page 425
* EL050.cbl
 23024         GO TO 8720-COMP-ACCOUNTS,
 23025               8730-END-BROWSE,
 23026               8740-NOT-FOUND
 23027         DEPENDING ON DFHEIGDI
 23028     ELSE IF DFHEIGDJ EQUAL 31
 23029         GO TO 9000-NOTFND
 23030         DEPENDING ON DFHEIGDI
 23031     ELSE IF DFHEIGDJ EQUAL 32
 23032         GO TO 9100-NOTFND,
 23033               9100-NOTFND
 23034         DEPENDING ON DFHEIGDI
 23035     ELSE IF DFHEIGDJ EQUAL 33
 23036         GO TO 9991-CRTO-NOT-FOUND,
 23037               9991-CRTO-NOT-FOUND
 23038         DEPENDING ON DFHEIGDI.
 23039     MOVE '9%                    "   ' TO DFHEIV0
 23040     MOVE 'EL050' TO DFHEIV1
 23041     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23042     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41688     Code:       94617
