* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74******************************************************************
    75
    76 ENVIRONMENT DIVISION.
    77
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   4
* EL6311.cbl
    79 DATA DIVISION.
    80 WORKING-STORAGE SECTION.
    81 01  DFH-START PIC X(04).
    82 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    83 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    84 77  FILLER  PIC X(32)  VALUE '********************************'.
    85 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    86 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    87 77  A1                          PIC S999 COMP-3 VALUE +0.
    88 77  N1                          PIC S999 COMP-3 VALUE +0.
    89 77  N2                          PIC S999 COMP-3 VALUE +0.
    90 77  N3                          PIC S999 COMP-3 VALUE +0.
    91 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    92 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    93 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    94     88  REVERSAL                    VALUE 'Y'.
    95 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    96 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    97 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    98 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    99 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   100     88  ERMAIL-FOUND                 VALUE 'Y'.
   101 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   102 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   103 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   104 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   105     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   106 77  ws-stop-sw                  pic x value ' '.
   107     88  i-say-stop                 value 'Y'.
   108 77  ws-check-sw                 pic x value ' '.
   109     88  i-have-checks              value 'Y'.
   110 77  ws-proc-check-sw            pic x value ' '.
   111     88  i-have-processed-checks    value 'Y'.
   112 77  ws-chek-browse-sw           pic x value ' '.
   113 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   114 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   115 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   116 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   117
   118*    COPY ELCSCTM.
   119******************************************************************
   120*                                                                *
   121*                                                                *
   122*                            ELCSCTM                             *
   123*                            VMOD=2.001                          *
   124*                                                                *
   125*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   126*                                                                *
   127******************************************************************
   128 01  SECURITY-MESSAGE.
   129     12  FILLER                          PIC X(30)
   130            VALUE '** LOGIC SECURITY VIOLATION -'.
   131     12  SM-READ                         PIC X(6).
   132     12  FILLER                          PIC X(5)
   133            VALUE ' PGM='.
   134     12  SM-PGM                          PIC X(6).
   135     12  FILLER                          PIC X(5)
   136            VALUE ' OPR='.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   5
* EL6311.cbl
   137     12  SM-PROCESSOR-ID                 PIC X(4).
   138     12  FILLER                          PIC X(6)
   139            VALUE ' TERM='.
   140     12  SM-TERMID                       PIC X(4).
   141     12  FILLER                          PIC XX   VALUE SPACE.
   142     12  SM-JUL-DATE                     PIC 9(5).
   143     12  FILLER                          PIC X    VALUE SPACE.
   144     12  SM-TIME                         PIC 99.99.
   145
   146
   147*    COPY ELCSCRTY.
   148******************************************************************
   149*                                                                *
   150*                                                                *
   151*                            ELCSCRTY                            *
   152*                            VMOD=2.001                          *
   153*                                                                *
   154*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   155*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   156*        SAVED IN PI-SECURITY-ADDRESS.                           *
   157*                                                                *
   158******************************************************************
   159 01  SECURITY-CONTROL.
   160     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   161     12  FILLER                       PIC XX    VALUE 'SC'.
   162     12  SC-CREDIT-CODES.
   163         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   164             20  SC-CREDIT-DISPLAY    PIC X.
   165             20  SC-CREDIT-UPDATE     PIC X.
   166     12  SC-CLAIMS-CODES.
   167         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   168             20  SC-CLAIMS-DISPLAY    PIC X.
   169             20  SC-CLAIMS-UPDATE     PIC X.
   170
   171 01  WS-VA-NO-COMM-MESS.
   172     12  FILLER                  PIC X(41) VALUE
   173        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   174 01  WS-OC-MESSAGE.
   175     12  FILLER                  PIC X(43) VALUE
   176        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   177     12  WS-OC-DIS-AMT           PIC -----9.99.
   178     12  FILLER                  PIC X(4) VALUE ' ON '.
   179     12  WS-OC-DATE              PIC X(10).
   180 01  WS-DATE-AREA.
   181     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   182     12  WS-CURRENT-DT.
   183         16  FILLER              PIC X(6)    VALUE SPACES.
   184         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   185     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   186     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   187     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   188
   189 01  STANDARD-AREAS.
   190     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   191     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   192     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   193     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   194     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   6
* EL6311.cbl
   195     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   196     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   197     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   198     12  PGM-NAME                PIC X(8).
   199     12  TIME-IN                 PIC S9(7).
   200     12  TIME-OUT-R  REDEFINES TIME-IN.
   201         16  FILLER              PIC X.
   202         16  TIME-OUT            PIC 99V99.
   203         16  FILLER              PIC XX.
   204     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   205     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   206     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   207     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   208     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   209     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   210     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   211     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   212     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   213     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   214     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   215     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   216     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   217     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   218     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   219     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   220     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   221     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   222     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   223     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   224     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   225     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   226     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   227     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   228     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   229     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   230     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   231     12  FILE-ID                 PIC X(8).
   232     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   233     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   234     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   235     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   236     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   237     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   238     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   239     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   240     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   241     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   242     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   243     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   244     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   245     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   246     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   247
   248 01  WS-PASS-AREA.
   249     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   250     05  WS-PASS-VADS-REC    PIC X(350).
   251*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   252*                                COPY ELCZREC.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   7
* EL6311.cbl
   253******************************************************************
   254*                                                                *
   255*                                                                *
   256*                            ELCZREC.                            *
   257*                                                                *
   258*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   259*                                                                *
   260******************************************************************
   261*-----------------------------------------------------------------
   262*                   C H A N G E   L O G
   263*
   264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   265*-----------------------------------------------------------------
   266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   267* EFFECTIVE    NUMBER
   268*-----------------------------------------------------------------
   269* 122011    2011022800001  AJRA  NEW FILE
   270* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   271* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   272* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   273* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   274*-----------------------------------------------------------------
   275 01  W-Z-CONTROL-DATA.
   276     05  W-NUMBER-OF-COPIES      PIC  9.
   277     05  FILLER                  PIC  X.
   278     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   279     05  FILLER                  PIC  X.
   280     05  W-DAYS-TO-RESEND        PIC  999.
   281     05  FILLER                  PIC  X.
   282     05  W-FORM-TO-RESEND        PIC  X(4).
   283     05  W-ADD-BAR-CODE          PIC  X.
   284     05  W-PROMPT-LETTER         PIC  X.
   285     05  W-HAS-RETURN-ENV        PIC  X.
   286     05  W-ENCLOSURE-CD          PIC  XXX.
   287     05  W-SIG-FLAG-DEFAULT      PIC  X.
   288     05  W-AUTO-CLOSE-IND        PIC  X.
   289     05  FILLER                  PIC  X.
   290     05  W-LETTER-TO-BENE        PIC  X.
   291     05  FILLER                  PIC  X.
   292     05  W-LETTER-TO-ACCT        PIC  X.
   293     05  FILLER                  PIC  X.
   294     05  W-LETTER-TYPE           PIC  X.
   295     05  FILLER                  PIC  X.
   296     05  W-PRINT-CERTIFICATE     PIC  X.
   297     05  FILLER                  PIC  X.
   298     05  W-REFUND-REQUIRED       PIC  X.
   299     05  FILLER                  PIC  X.
   300     05  W-ONBASE-CODE           PIC  XX.
   301     05  FILLER                  PIC  X.
   302     05  W-ACCT-SUMM             PIC  X.
   303     05  FILLER                  PIC  X.
   304     05  W-CSO-SUMM              PIC  X.
   305     05  FILLER                  PIC  X.
   306     05  W-REASONS-REQUIRED      PIC  X.
   307     05  FILLER                  PIC  X(29).
   308******************************************************************
   309*                                                                *
   310*              A C C E S S   K E Y S                             *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   8
* EL6311.cbl
   311*                                                                *
   312******************************************************************
   313
   314 01  ACCESS-KEYS.
   315     12  ERPYAJ-KEY.
   316         16  ERPYAJ-COMPANY-CD       PIC X.
   317         16  ERPYAJ-CARRIER          PIC X.
   318         16  ERPYAJ-GROUPING         PIC X(6).
   319         16  ERPYAJ-FIN-RESP         PIC X(10).
   320         16  ERPYAJ-ACCOUNT          PIC X(10).
   321         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   322         16  ERPYAJ-TYPE             PIC X.
   323     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   324     12  ELCERT-KEY.
   325         16  ELCERT-COMPANY-CD       PIC X.
   326         16  ELCERT-CARRIER          PIC X.
   327         16  ELCERT-GROUPING         PIC X(6).
   328         16  ELCERT-STATE            PIC XX.
   329         16  ELCERT-ACCOUNT          PIC X(10).
   330         16  ELCERT-CERT-EFF-DT      PIC XX.
   331         16  ELCERT-CERT-NO.
   332             20  ELCERT-CERT-PRIME   PIC X(10).
   333             20  ELCERT-CERT-SFX     PIC X.
   334
   335     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   336     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   337     12  ELCRTO-KEY.
   338         16  ELCRTO-COMPANY-CD       PIC X.
   339         16  ELCRTO-CARRIER          PIC X.
   340         16  ELCRTO-GROUPING         PIC X(6).
   341         16  ELCRTO-STATE            PIC XX.
   342         16  ELCRTO-ACCOUNT          PIC X(10).
   343         16  ELCRTO-CERT-EFF-DT      PIC XX.
   344         16  ELCRTO-CERT-NO.
   345             20  ELCRTO-CERT-PRIME   PIC X(10).
   346             20  ELCRTO-CERT-SFX     PIC X.
   347         16  ELCRTO-RECORD-TYPE      PIC X.
   348         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   349
   350     12  ELCRTT-KEY.
   351         16  ELCRTT-PRIMARY          PIC X(33).
   352         16  ELCRTT-REC-TYPE         PIC X(1).
   353     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   354     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   355
   356     12  ERPNDB-KEY.
   357         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   358         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   359         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   360         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   361             ERPNDB-BATCH-SEQ-NO     PIC XX.
   362         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   363
   364     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   365     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   366     12  ERCHEK-KEY.
   367         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   368         16  CHEK-CARRIER            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page   9
* EL6311.cbl
   369         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   370         16  CHEK-STATE              PIC XX      VALUE SPACES.
   371         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   372         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   373         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   374         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   375         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   376     12  ELLETR-KEY.
   377         16  LETR-COMPANY-CD     PIC X.
   378         16  LETR-LETTER-ID      PIC X(4).
   379         16  LETR-FILLER         PIC X(8).
   380         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   381     12  ERPNDM-KEY.
   382         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   383         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   384         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   385         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   386
   387*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   388     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   389*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   390     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   391
   392     12  ERPNDB-ALT-KEY.
   393         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   394         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   395         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   396         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   397         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   398         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   399         16  ERPNDB-CERT-NO.
   400             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   401             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   402         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   403         16  ERPNDB-RECORD-TYPE      PIC X.
   404
   405      12  ERPNDB-CSR-KEY.
   406          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   407          20  ERPNDB-CSR-ID                PIC X(4).
   408          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   409          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   410          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   411
   412     12  ERNOTE-KEY.
   413         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   414         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   415         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   416         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   417         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   418         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   419         16  ERNOTE-CERT-NO.
   420             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   421             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   422
   423     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   424     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   425
   426     12  ERCNOT-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  10
* EL6311.cbl
   427         16  ERCNOT-PART-KEY.
   428             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   429             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   430             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   431             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   432             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   433             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   434             20  ERCNOT-CERT-NO.
   435                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   436                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   437         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   438         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   439
   440     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   441     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   442
   443     12  ERMAIL-KEY.
   444         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   445         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   446         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   447         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   448         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   449         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   450         16  ERMAIL-CERT-NO.
   451             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   452             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   453
   454     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   455     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   456
   457     12  ERRQST-KEY.
   458         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   459         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   460
   461     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   462     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   463
   464     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   465
   466     12  ERLOFC-KEY.
   467         16  ERLOFC-COMPANY-CD          PIC  X.
   468         16  ERLOFC-CARRIER             PIC  X.
   469         16  ERLOFC-GROUPING            PIC  X(6).
   470         16  ERLOFC-STATE               PIC  XX.
   471         16  ERLOFC-ACCOUNT             PIC  X(10).
   472         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   473*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   474
   475     12  ERACCT-KEY.
   476         16  ERACCT-COMPANY-CD          PIC  X.
   477         16  ERACCT-CARRIER             PIC  X.
   478         16  ERACCT-GROUPING            PIC  X(6).
   479         16  ERACCT-STATE               PIC  XX.
   480         16  ERACCT-ACCOUNT             PIC  X(10).
   481         16  ERACCT-EXP-DT.
   482             20  ERACCT-DT              PIC  XX.
   483             20  ERACCT-FILL            PIC  X(4).
   484
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  11
* EL6311.cbl
   485     12  ERENDT-KEY.
   486         16  ENDT-COMPANY-CD       PIC X.
   487         16  ENDT-CARRIER          PIC X.
   488         16  ENDT-GROUPING         PIC X(6).
   489         16  ENDT-STATE            PIC XX.
   490         16  ENDT-ACCOUNT          PIC X(10).
   491         16  ENDT-CERT-EFF-DT      PIC XX.
   492         16  ENDT-CERT-PRIME       PIC X(10).
   493         16  ENDT-CERT-SFX         PIC X.
   494         16  ENDT-RECORD-TYPE      PIC X.
   495         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   496
   497 01  WS-ELMSTR-WORK.
   498     12  ELMSTR-KEY.
   499         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   500         16  MSTR-CERT-NO.
   501             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   502             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   503     12  W-CLAIM-KEY.
   504         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   505         16  W-CL-CERT-NO.
   506             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   507             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   508      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   509 01  CANCEL-GEN-PASS-AREA.
   510     05  CG-OPTION-CODE          PIC X.
   511         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   512         88  CG-FLAT-CANCEL        VALUE '1'.
   513         88  CG-CANCEL             VALUE '2'.
   514         88  CG-CANCEL-REISSUE     VALUE '3'.
   515     05  CG-ERROR-CODE           PIC 99.
   516         88  CG-SUCCESS            VALUE 00.
   517         88  CG-DATE-ERROR         VALUE 01.
   518         88  CG-CERT-NOT-FOUND     VALUE 02.
   519         88  CG-AMOUNT-ERROR       VALUE 04.
   520         88  CG-OPTION-ERROR       VALUE 05.
   521         88  CG-PREV-CAN           VALUE 06.
   522         88  CG-INVALID-DATA       VALUE 07.
   523         88  CG-NO-ACCT-MSTR       VALUE 08.
   524         88  CG-SFX-A-EXIST        VALUE 09.
   525         88  CG-MISC-ERROR         VALUE 99.
   526     05  CG-COMPANY-ID           PIC XXX.
   527     05  CG-PROC-ID              PIC XXXX.
   528     05  CG-CURRENT-DT           PIC XX.
   529     05  CG-MONTH-END-DT         PIC XX.
   530     05  CG-CERT-KEY.
   531         10  CG-CERT-COMPANY-CD  PIC X.
   532         10  CG-CERT-CARRIER     PIC X.
   533         10  CG-CERT-GROUP       PIC X(6).
   534         10  CG-CERT-STATE       PIC XX.
   535         10  CG-CERT-ACCOUNT     PIC X(10).
   536         10  CG-CERT-EFF-DT      PIC XX.
   537         10  CG-CERT-CERT-NO     PIC X(11).
   538     05  CG-LF-CAN-DATA.
   539         10  CG-LF-CAN-DT        PIC XX.
   540         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   541     05  CG-AH-CAN-DATA.
   542         10  CG-AH-CAN-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  12
* EL6311.cbl
   543         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   544     05  CG-CERT-PROFILE-DATA.
   545         10  CG-INS-LNAME        PIC X(15).
   546         10  CG-INS-FNAME        PIC X(10).
   547         10  CG-INS-MID-INIT     PIC X.
   548         10  CG-INS-AGE          PIC 99.
   549         10  CG-JNT-LNAME        PIC X(15).
   550         10  CG-JNT-FNAME        PIC X(10).
   551         10  CG-JNT-MID-INIT     PIC X.
   552         10  CG-JNT-AGE          PIC 99.
   553     05  CG-LF-ISS-DATA.
   554         10  CG-LF-BENCD         PIC XX.
   555         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   556         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   557     05  CG-AH-ISS-DATA.
   558         10  CG-AH-BENCD         PIC XX.
   559         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   560     05  CG-BATCH-NO             PIC X(6).
   561     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   562     05  FILLER                  PIC X(306).
   563******************************************************************
   564*                                                                *
   565*            G E N E R A L   W O R K   A R E A                   *
   566*                                                                *
   567******************************************************************
   568
   569 01  WORK-AREA.
   570     12  WS-RESPONSE             PIC S9(8)   COMP.
   571         88  RESP-NORMAL           VALUE +0.
   572         88  resp-file-notfnd      value +12.
   573         88  RESP-NOTFND           VALUE +13.
   574         88  resp-duprec           value +14.
   575         88  resp-dupkey           value +15.
   576         88  resp-invreq           value +16.
   577         88  RESP-NOTOPEN          VALUE +19.
   578         88  RESP-ENDFILE          VALUE +20.
   579         88  resp-lengtherr        value +22.
   580     12  DEEDIT-FIELD            PIC X(15).
   581     12  FILLER          REDEFINES DEEDIT-FIELD.
   582         16  FILLER              PIC X(4).
   583         16  DEEDIT-FIELD-X11    PIC X(11).
   584     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   585                                 PIC S9(15).
   586     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   587                                 PIC S9(13)V99.
   588     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   589                                 PIC S9(11)V9999.
   590     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   591     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   592     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   593         16  WS-CALC-TERM-WHOLE  PIC S999.
   594         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   595
   596     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   597     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   598         16  WS-HR-MINS          PIC 99V99.
   599         16  FILLER              PIC XX.
   600
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  13
* EL6311.cbl
   601     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   602     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   603
   604     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   605     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   606
   607     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   608     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   609     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   610     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   611     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   612     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   613     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   614
   615     12  QID.
   616         16  QID-TERM            PIC X(4).
   617         16  FILLER              PIC X(4)    VALUE '607B'.
   618
   619     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   620         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   621
   622     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   623         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   624
   625     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   626         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   627                                         'A'.
   628
   629     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   630
   631     12  WS-NUMERIC-SW           PIC X.
   632        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   633
   634     12  WS-EDIT-CSO-FIELD.
   635         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   636                                 PIC X.
   637
   638     12  WS-SAVE-INPUT-FIELDS.
   639         16  WS-BAGE             PIC 99       VALUE ZERO.
   640*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   641         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   642         16  FILLER REDEFINES WS-BAPR.
   643             20  WS-APR-WHOLE-NUM    PIC 99.
   644             20  WS-APR-DEC          PIC 9999.
   645         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   646         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   647
   648         16  WS-B-COVERAGE OCCURS 2 TIMES.
   649             20  WS-TERM-IN-DAYS-SW  PIC X.
   650                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   651             20  WS-BTERM        PIC 999       COMP-3.
   652             20  WS-BALT-TERM    PIC 999       COMP-3.
   653             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   654             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   655             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   656             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   657             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   658             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  14
* EL6311.cbl
   659
   660         16  WS-C-FIELDS COMP-3.
   661             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   662             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   663             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   664
   665         16  WS-D-FIELDS COMP-3.
   666             20  WS-DRISS        PIC S9(5)    VALUE +0.
   667             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   668             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   669             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   670             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   671             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   672
   673     12  WS-SAVE-BIRTH-DATE.
   674         16  FILLER              PIC X(4)   VALUE SPACES.
   675         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   676
   677     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   678     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   679     12  FILLER REDEFINES WS-WORK-BIN-RED.
   680         16  FILLER              PIC X(02).
   681         16  WS-WORK-BIN-DT      PIC X(02).
   682     12  WS-SW-1                 PIC X     VALUE SPACE.
   683     12  WS-SW-2                 PIC X     VALUE SPACE.
   684     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   685         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   686     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   687         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   688
   689     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   690     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   691     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   692     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   693     12  WS-CONVERTED-CANCEL-DATES.
   694         16  WS-CONVERTED-CANDT1                  PIC XX.
   695         16  WS-CONVERTED-CANDT2                  PIC XX.
   696
   697     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   698
   699     12  WS-REC-FOUND-SW         PIC X.
   700         88  RECORD-NOT-FOUND    VALUE 'N'.
   701
   702     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   703         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   704         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   705
   706     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   707         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   708         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   709
   710     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   711         88  BROWSE-STARTED      VALUE 'Y'.
   712
   713     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   714         88  FIRST-TIME          VALUE 'Y'.
   715
   716     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  15
* EL6311.cbl
   717         88  FIRST-ENTRY         VALUE 'Y'.
   718
   719     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   720         88  REC-BILLED          VALUE 'Y'.
   721
   722     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   723         88  NO-CURSOR-SET       VALUE +0.
   724         88  CURSOR-SET          VALUE +1.
   725
   726     12  WS-ERR-SW               PIC X.
   727         88  STD-ERRORS          VALUE 'S'.
   728         88  TRN-ERRORS          VALUE 'T'.
   729
   730     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   731         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   732
   733     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   734         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   735
   736     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   737         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   738
   739     12  WS-ERR-CODE.
   740         16  FILLER              PIC 99.
   741         16  WS-ERROR-SUB        PIC 99.
   742
   743     12  WS-DATE-WORK.
   744         16  WS-WORK-MM          PIC XX.
   745         16  WS-WORK-DD          PIC XX.
   746         16  WS-WORK-YY          PIC XX.
   747
   748     12  WS-MM-YY.
   749         16  WS-MM               PIC XX.
   750         16  FILLER              PIC X     VALUE '/'.
   751         16  WS-YY               PIC XX.
   752
   753     12  WS-CERT-EFF-DT          PIC XX.
   754
   755     12  WS-MEMBER-NO            PIC X(12).
   756     12  FILLER  REDEFINES  WS-MEMBER-NO.
   757         16  WS-MEMBER-NO-1-8    PIC 9(8).
   758         16  FILLER              PIC X(4).
   759
   760     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   761
   762     12  WS-ERPNDB-ALT-KEY.
   763         16  WS-PB-COMPANY-CD-A1         PIC X.
   764         16  WS-PB-CARRIER               PIC X.
   765         16  WS-PB-GROUPING              PIC X(6).
   766         16  WS-PB-STATE                 PIC XX.
   767         16  WS-PB-ACCOUNT               PIC X(10).
   768         16  WS-PB-CERT-EFF-DT           PIC XX.
   769         16  WS-PB-CERT-NO.
   770             20  WS-PB-CERT-PRIME        PIC X(10).
   771             20  WS-PB-CERT-SFX          PIC X.
   772         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   773         16  WS-PB-RECORD-TYPE           PIC X.
   774
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  16
* EL6311.cbl
   775     12  WS-SHOW-SAVE-AREAS.
   776         16  WS-NEW-CERT-NO.
   777             20  WS-NEW-PRIME    PIC X(10).
   778             20  WS-NEW-SUFFIX   PIC X.
   779         16  WS-NEW-CERT-EFF-DT  PIC XX.
   780         16  WS-NEW-RECORD-TYPE  PIC X.
   781         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   782             88   SHOW-RECORD            VALUE 'Y'.
   783
   784     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   785
   786     12  WS-BATCH-NO.
   787         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   788         16  FILLER              PIC X(5) VALUE SPACES.
   789
   790     12  WS-FIRST-NAME.
   791         16  WS-1ST-INIT         PIC X.
   792         16  FILLER              PIC X(9).
   793
   794     12  WS-INITIALS.
   795         16  WS-INITIAL-1        PIC X.
   796         16  WS-INITIAL-2        PIC X.
   797
   798     12  WS-C-HDG.
   799         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   800         16  FILLER              PIC X(4) VALUE '-REF'.
   801
   802     12  WS-D-PREM-HDG.
   803         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   804         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   805
   806     12  WS-D-REFUND-HDG.
   807         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   808         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   809
   810     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   811
   812     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   813     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   814     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   815     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   816     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   817     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   818     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   819
   820     12  WS-01-CANCEL-ERR        PIC X(25)
   821         VALUE 'CANCEL DATE ERROR'.
   822     12  WS-02-CANCEL-ERR        PIC X(25)
   823         VALUE 'CERT NOT FOUND'.
   824     12  WS-04-CANCEL-ERR        PIC X(25)
   825         VALUE 'CANCEL AMOUNT ERROR'.
   826     12  WS-05-CANCEL-ERR        PIC X(25)
   827         VALUE 'CANCEL OPTION ERROR'.
   828     12  WS-06-CANCEL-ERR        PIC X(25)
   829         VALUE 'PREVIOUSLY CANCELLED'.
   830     12  WS-07-CANCEL-ERR        PIC X(25)
   831         VALUE 'INVALID DATA'.
   832     12  WS-08-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  17
* EL6311.cbl
   833         VALUE 'NO ACCOUNT MASTER'.
   834     12  WS-09-CANCEL-ERR        PIC X(25)
   835         VALUE 'SUFFIX ALREADY EXISTS'.
   836     12  WS-99-CANCEL-ERR        PIC X(25)
   837         VALUE 'MISC CANCEL ERROR'.
   838
   839     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   840     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   841
   842     12  WS-AGE-FIELDS.
   843         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   844         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   845         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   846         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   847
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  18
* EL6311.cbl
   849
   850******************************************************************
   851*                                                                *
   852*                 B A T C H   T O T A L S                        *
   853*                                                                *
   854******************************************************************
   855
   856     12  WS-BATCH-RECORD.
   857         16  FILLER                       PIC X(10).
   858         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   859         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   860         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   861         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   862         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   863         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   864         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   865         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   866         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   867         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   868         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   869         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   870         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   871         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   872         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   873         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   874         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   875         16  WS-ACCOUNT-NAME              PIC X(30).
   876         16  FILLER                       PIC X.
   877         16  WS-REFERENCE                 PIC X(12).
   878         16  FILLER                       PIC X(197).
   879
   880     12  WS-BATCH-TOTALS.
   881         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   882         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   883         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   884         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   885         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   886         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   887         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   888         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   889         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   890         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   891         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   892         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   893         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   894         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   895         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   896         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   897         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   898         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   899         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   900
   901     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   902
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  19
* EL6311.cbl
   904
   905******************************************************************
   906*                                                                *
   907*                E R R O R   M E S S A G E S                     *
   908*                                                                *
   909******************************************************************
   910
   911 01  ERROR-MESSAGES.
   912     12  ER-0004                 PIC  9(4) VALUE 0004.
   913     12  ER-0008                 PIC  9(4) VALUE 0008.
   914     12  ER-0023                 PIC  9(4) VALUE 0023.
   915     12  ER-0029                 PIC  9(4) VALUE 0029.
   916     12  ER-0033                 PIC  9(4) VALUE 0033.
   917     12  ER-0070                 PIC  9(4) VALUE 0070.
   918     12  ER-0220                 PIC  9(4) VALUE 0220.
   919     12  ER-0248                 PIC  9(4) VALUE 0248.
   920     12  ER-0280                 PIC  9(4) VALUE 0280.
   921     12  ER-0348                 PIC  9(4) VALUE 0348.
   922     12  ER-0582                 PIC  9(4) VALUE 0582.
   923     12  ER-0877                 PIC  9(4) VALUE 0877.
   924     12  ER-1236                 PIC  9(4) VALUE 1236.
   925     12  ER-1570                 PIC  9(4) VALUE 1570.
   926     12  ER-1575                 PIC  9(4) VALUE 1575.
   927     12  ER-1609                 PIC  9(4) VALUE 1609.
   928     12  ER-1819                 PIC  9(4) VALUE 1819.
   929     12  ER-2077                 PIC  9(4) VALUE 2077.
   930     12  ER-2129                 PIC  9(4) VALUE 2129.
   931     12  ER-2188                 PIC  9(4) VALUE 2188.
   932     12  ER-2192                 PIC  9(4) VALUE 2192.
   933     12  ER-2196                 PIC  9(4) VALUE 2196.
   934     12  ER-2197                 PIC  9(4) VALUE 2197.
   935     12  ER-2198                 PIC  9(4) VALUE 2198.
   936     12  ER-2200                 PIC  9(4) VALUE 2200.
   937     12  ER-2212                 PIC  9(4) VALUE 2212.
   938     12  ER-2218                 PIC  9(4) VALUE 2218.
   939     12  ER-2220                 PIC  9(4) VALUE 2220.
   940     12  ER-2222                 PIC  9(4) VALUE 2222.
   941     12  ER-2223                 PIC  9(4) VALUE 2223.
   942     12  ER-2224                 PIC  9(4) VALUE 2224.
   943     12  ER-2225                 PIC  9(4) VALUE 2225.
   944     12  ER-2226                 PIC  9(4) VALUE 2226.
   945     12  ER-2227                 PIC  9(4) VALUE 2227.
   946     12  ER-2228                 PIC  9(4) VALUE 2228.
   947     12  ER-2240                 PIC  9(4) VALUE 2240.
   948     12  ER-2241                 PIC  9(4) VALUE 2241.
   949     12  ER-2242                 PIC  9(4) VALUE 2242.
   950     12  ER-2243                 PIC  9(4) VALUE 2243.
   951     12  ER-2244                 PIC  9(4) VALUE 2244.
   952     12  ER-2245                 PIC  9(4) VALUE 2245.
   953     12  ER-2246                 PIC  9(4) VALUE 2246.
   954     12  ER-2247                 PIC  9(4) VALUE 2247.
   955     12  ER-2251                 PIC  9(4) VALUE 2251.
   956     12  ER-2252                 PIC  9(4) VALUE 2252.
   957     12  ER-2253                 PIC  9(4) VALUE 2253.
   958     12  ER-2254                 PIC  9(4) VALUE 2254.
   959     12  ER-2255                 PIC  9(4) VALUE 2255.
   960     12  ER-2256                 PIC  9(4) VALUE 2256.
   961     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  20
* EL6311.cbl
   962     12  ER-2258                 PIC  9(4) VALUE 2258.
   963     12  ER-2259                 PIC  9(4) VALUE 2259.
   964     12  ER-2260                 PIC  9(4) VALUE 2260.
   965     12  ER-2261                 PIC  9(4) VALUE 2261.
   966     12  ER-2287                 PIC  9(4) VALUE 2287.
   967     12  ER-2336                 PIC  9(4) VALUE 2336.
   968     12  ER-2337                 PIC  9(4) VALUE 2337.
   969     12  ER-2437                 PIC  9(4) VALUE 2437.
   970     12  ER-2471                 PIC  9(4) VALUE 2471.
   971     12  ER-2530                 PIC  9(4) VALUE 2530.
   972     12  ER-2531                 PIC  9(4) VALUE 2531.
   973     12  ER-2532                 PIC  9(4) VALUE 2532.
   974     12  ER-2533                 PIC  9(4) VALUE 2533.
   975     12  ER-2547                 PIC  9(4) VALUE 2547.
   976     12  ER-2591                 PIC  9(4) VALUE 2591.
   977     12  ER-2592                 PIC  9(4) VALUE 2592.
   978     12  ER-2593                 PIC  9(4) VALUE 2593.
   979     12  ER-2600                 PIC  9(4) VALUE 2600.
   980     12  ER-2601                 PIC  9(4) VALUE 2601.
   981     12  ER-2604                 PIC  9(4) VALUE 2604.
   982     12  ER-2605                 PIC  9(4) VALUE 2605.
   983     12  ER-2606                 PIC  9(4) VALUE 2606.
   984     12  ER-2607                 PIC  9(4) VALUE 2607.
   985     12  ER-2622                 PIC  9(4) VALUE 2622.
   986     12  ER-2625                 PIC  9(4) VALUE 2625.
   987     12  ER-2626                 PIC  9(4) VALUE 2626.
   988     12  ER-2627                 PIC  9(4) VALUE 2627.
   989     12  ER-2628                 PIC  9(4) VALUE 2628.
   990     12  ER-2629                 PIC  9(4) VALUE 2629.
   991     12  ER-2630                 PIC  9(4) VALUE 2630.
   992     12  ER-2631                 PIC  9(4) VALUE 2631.
   993     12  ER-2632                 PIC  9(4) VALUE 2632.
   994     12  ER-2633                 PIC  9(4) VALUE 2633.
   995     12  ER-2634                 PIC  9(4) VALUE 2634.
   996     12  ER-2635                 PIC  9(4) VALUE 2635.
   997     12  ER-2636                 PIC  9(4) VALUE 2636.
   998     12  ER-2639                 PIC  9(4) VALUE 2639.
   999     12  ER-2640                 PIC  9(4) VALUE 2640.
  1000     12  ER-2647                 PIC  9(4) VALUE 2647.
  1001     12  ER-2648                 PIC  9(4) VALUE 2648.
  1002     12  ER-2649                 PIC  9(4) VALUE 2649.
  1003     12  ER-2650                 PIC  9(4) VALUE 2650.
  1004     12  ER-2653                 PIC  9(4) VALUE 2653.
  1005     12  ER-2654                 PIC  9(4) VALUE 2654.
  1006     12  ER-2655                 PIC  9(4) VALUE 2655.
  1007     12  ER-2656                 PIC  9(4) VALUE 2656.
  1008     12  ER-2657                 PIC  9(4) VALUE 2657.
  1009     12  ER-2660                 PIC  9(4) VALUE 2660.
  1010     12  ER-2661                 PIC  9(4) VALUE 2661.
  1011     12  ER-2662                 PIC  9(4) VALUE 2662.
  1012     12  ER-2663                 PIC  9(4) VALUE 2663.
  1013     12  ER-2664                 PIC  9(4) VALUE 2664.
  1014     12  ER-2667                 PIC  9(4) VALUE 2667.
  1015     12  ER-2668                 PIC  9(4) VALUE 2668.
  1016     12  ER-2669                 PIC  9(4) VALUE 2669.
  1017     12  ER-2670                 PIC  9(4) VALUE 2670.
  1018     12  ER-2671                 PIC  9(4) VALUE 2671.
  1019     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  21
* EL6311.cbl
  1020     12  ER-2673                 PIC  9(4) VALUE 2673.
  1021     12  ER-2677                 PIC  9(4) VALUE 2677.
  1022     12  ER-2678                 PIC  9(4) VALUE 2678.
  1023     12  ER-2679                 PIC  9(4) VALUE 2679.
  1024     12  ER-2680                 PIC  9(4) VALUE 2680.
  1025     12  ER-2681                 PIC  9(4) VALUE 2681.
  1026     12  ER-2682                 PIC  9(4) VALUE 2682.
  1027     12  ER-2683                 PIC  9(4) VALUE 2683.
  1028     12  ER-2684                 PIC  9(4) VALUE 2684.
  1029     12  ER-2686                 PIC  9(4) VALUE 2686.
  1030     12  ER-2689                 PIC  9(4) VALUE 2689.
  1031     12  ER-2690                 PIC  9(4) VALUE 2690.
  1032     12  ER-2693                 PIC  9(4) VALUE 2693.
  1033     12  ER-2695                 PIC  9(4) VALUE 2695.
  1034     12  ER-2701                 PIC  9(4) VALUE 2701.
  1035     12  ER-2720                 PIC  9(4) VALUE 2720.
  1036     12  ER-2709                 PIC  9(4) VALUE 2709.
  1037     12  ER-2704                 PIC  9(4) VALUE 2704.
  1038     12  ER-2725                 PIC  9(4) VALUE 2725.
  1039     12  ER-2726                 PIC  9(4) VALUE 2726.
  1040     12  ER-2728                 PIC  9(4) VALUE 2728.
  1041     12  ER-2729                 PIC  9(4) VALUE 2729.
  1042     12  ER-2731                 PIC  9(4) VALUE 2731.
  1043     12  ER-2732                 PIC  9(4) VALUE 2732.
  1044     12  ER-2733                 PIC  9(4) VALUE 2733.
  1045     12  ER-2735                 PIC  9(4) VALUE 2735.
  1046     12  ER-2738                 PIC  9(4) VALUE 2738.
  1047     12  ER-2742                 PIC  9(4) VALUE 2742.
  1048     12  ER-2743                 PIC  9(4) VALUE 2743.
  1049     12  ER-2744                 PIC  9(4) VALUE 2744.
  1050     12  ER-2747                 PIC  9(4) VALUE 2747.
  1051     12  ER-2749                 PIC  9(4) VALUE 2749.
  1052     12  ER-2753                 PIC  9(4) VALUE 2753.
  1053     12  ER-2755                 PIC  9(4) VALUE 2755.
  1054     12  ER-2757                 PIC  9(4) VALUE 2757.
  1055     12  ER-2771                 PIC  9(4) VALUE 2771.
  1056     12  ER-2774                 PIC  9(4) VALUE 2774.
  1057     12  ER-2775                 PIC  9(4) VALUE 2775.
  1058     12  ER-2776                 PIC  9(4) VALUE 2776.
  1059     12  ER-2777                 PIC  9(4) VALUE 2777.
  1060     12  ER-2794                 PIC  9(4) VALUE 2794.
  1061     12  ER-2799                 PIC  9(4) VALUE 2799.
  1062     12  ER-2900                 PIC  9(4) VALUE 2900.
  1063     12  ER-2902                 PIC  9(4) VALUE 2902.
  1064     12  ER-2945                 PIC  9(4) VALUE 2945.
  1065     12  ER-3000                 PIC  9(4) VALUE 3000.
  1066     12  ER-3006                 PIC  9(4) VALUE 3006.
  1067     12  ER-3054                 PIC  9(4) VALUE 3054.
  1068     12  ER-3224                 PIC  9(4) VALUE 3224.
  1069     12  ER-3269                 PIC  9(4) VALUE 3269.
  1070     12  er-3444                 pic  9(4) value 3444.
  1071     12  er-3446                 pic  9(4) value 3446.
  1072     12  er-3447                 pic  9(4) value 3447.
  1073     12  er-3448                 pic  9(4) value 3448.
  1074     12  er-3449                 pic  9(4) value 3449.
  1075     12  ER-3504                 PIC  9(4) VALUE 3504.
  1076     12  ER-3513                 PIC  9(4) VALUE 3513.
  1077     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  22
* EL6311.cbl
  1078     12  ER-3834                 PIC  9(4) VALUE 3834.
  1079     12  ER-3835                 PIC  9(4) VALUE 3835.
  1080     12  ER-4005                 PIC  9(4) VALUE 4005.
  1081     12  ER-7144                 PIC  9(4) VALUE 7144.
  1082     12  ER-7401                 PIC  9(4) VALUE 7401.
  1083     12  ER-7402                 PIC  9(4) VALUE 7402.
  1084     12  ER-7403                 PIC  9(4) VALUE 7403.
  1085     12  ER-7404                 PIC  9(4) VALUE 7404.
  1086     12  ER-7423                 PIC  9(4) VALUE 7423.
  1087     12  ER-7424                 PIC  9(4) VALUE 7424.
  1088     12  ER-7433                 PIC  9(4) VALUE 7433.
  1089     12  ER-7450                 PIC  9(4) VALUE 7450.
  1090     12  ER-7451                 PIC  9(4) VALUE 7451.
  1091     12  ER-7530                 PIC  9(4) VALUE 7530.
  1092     12  ER-7573                 PIC  9(4) VALUE 7573.
  1093     12  ER-7631                 PIC  9(4) VALUE 7631.
  1094     12  ER-7632                 PIC  9(4) VALUE 7632.
  1095     12  ER-7633                 PIC  9(4) VALUE 7633.
  1096     12  ER-7537                 PIC  9(4) VALUE 7537.
  1097     12  ER-7538                 PIC  9(4) VALUE 7538.
  1098     12  ER-7574                 PIC  9(4) VALUE 7574.
  1099     12  ER-7997                 PIC  9(4) VALUE 7997.
  1100     12  ER-7998                 PIC  9(4) VALUE 7998.
  1101     12  ER-8148                 PIC  9(4) VALUE 8148.
  1102     12  ER-9063                 PIC  9(4) VALUE 9063.
  1103     12  ER-9076                 PIC  9(4) VALUE 9076.
  1104     12  ER-9618                 PIC  9(4) VALUE 9618.
  1105     12  ER-9841                 PIC  9(4) VALUE 9841.
  1106
  1107*                                COPY ELCTEXT.
  1108******************************************************************
  1109*                                                                *
  1110*                                                                *
  1111*                            ELCTEXT.                            *
  1112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1113*                            VMOD=2.008                          *
  1114*                                                                *
  1115*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1116*                                     FORM LETTERS,              *
  1117*                                     CERT FORM DISPLAY.
  1118*                                                                *
  1119*   FILE TYPE = VSAM,KSDS                                        *
  1120*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1121*                                                                *
  1122*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1123*       ALTERNATE INDEX = NONE                                   *
  1124*                                                                *
  1125*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1126*       ALTERNATE INDEX = NONE                                   *
  1127*                                                                *
  1128*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1129*       ALTERNATE INDEX = NONE                                   *
  1130*                                                                *
  1131*   LOG = NO                                                     *
  1132*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1133******************************************************************
  1134 01  TEXT-FILES.
  1135     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  23
* EL6311.cbl
  1136         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1137         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1138         88  HELP-FILE-TEXT             VALUE 'TH'.
  1139
  1140     12  TX-CONTROL-PRIMARY.
  1141         16  TX-COMPANY-CD           PIC X.
  1142             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1143         16  TX-ACCESS-CD-GENL       PIC X(12).
  1144
  1145         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1146             20  TX-LETTER-NO        PIC X(4).
  1147             20  FILLER              PIC X(8).
  1148
  1149         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1150             20  TX-FORM-NO          PIC X(12).
  1151
  1152         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1153             20  TX-HELP-TYPE        PIC X.
  1154                 88  HELP-FOR-GENERAL   VALUE ' '.
  1155                 88  HELP-BY-SCREEN     VALUE 'S'.
  1156                 88  HELP-BY-ERROR      VALUE 'E'.
  1157             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1158                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1159             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1160                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1161             20  FILLER              PIC X(4).
  1162
  1163         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1164
  1165     12  TX-PROCESS-CONTROL          PIC XX.
  1166         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1167
  1168     12  TX-TEXT-LINE                PIC X(70).
  1169
  1170     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1171         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1172         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1173         88  TX-VALID-FORM-SQUEEZE-VALUE
  1174                                        VALUE 'Y' ' '.
  1175
  1176     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1177         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1178         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1179         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1180         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1181         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1182         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1183         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1184                                              'K' 'N' ' '
  1185                                              'Z'.
  1186
  1187     12  TX-ARCHIVE-SW               PIC X.
  1188         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1189         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1190         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1191
  1192     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1193     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  24
* EL6311.cbl
  1194
  1195     12  TX-BSR-CODE                 PIC X.
  1196         88  TX-BSR-LETTER              VALUE 'B'.
  1197         88  TX-NON-BSR-LETTER          VALUE ' '.
  1198
  1199     12  FILLER                      PIC X.
  1200*****************************************************************
  1201*                                COPY ELCCRTO.
  1202******************************************************************
  1203*                                                                *
  1204*                            ELCCRTO.                            *
  1205*                                                                *
  1206*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1207*                                                                *
  1208*   FILE TYPE = VSAM,KSDS                                        *
  1209*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1210*                                                                *
  1211*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1212*                                                                *
  1213*   LOG = YES                                                    *
  1214*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1215******************************************************************
  1216*                   C H A N G E   L O G
  1217*
  1218* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1219*-----------------------------------------------------------------
  1220*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1221* EFFECTIVE    NUMBER
  1222*-----------------------------------------------------------------
  1223* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1224* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1225* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1226* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1227* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1228******************************************************************
  1229 01  ORIGINAL-CERTIFICATE.
  1230     12  OC-RECORD-ID                      PIC XX.
  1231         88  VALID-OC-ID                      VALUE 'OC'.
  1232     12  OC-CONTROL-PRIMARY.
  1233         16  OC-COMPANY-CD                 PIC X.
  1234         16  OC-CARRIER                    PIC X.
  1235         16  OC-GROUPING                   PIC X(6).
  1236         16  OC-STATE                      PIC XX.
  1237         16  OC-ACCOUNT                    PIC X(10).
  1238         16  OC-CERT-EFF-DT                PIC XX.
  1239         16  OC-CERT-NO.
  1240             20  OC-CERT-PRIME             PIC X(10).
  1241             20  OC-CERT-SFX               PIC X.
  1242         16  OC-RECORD-TYPE                PIC X.
  1243         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1244     12  OC-LAST-MAINT-DT                  PIC XX.
  1245     12  OC-LAST-MAINT-BY                  PIC X(4).
  1246     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1247     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1248     12  FILLER                            PIC X(49).
  1249     12  OC-ORIG-REC.
  1250         16  OC-INS-LAST-NAME              PIC X(15).
  1251         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  25
* EL6311.cbl
  1252         16  OC-INS-MIDDLE-INIT            PIC X.
  1253         16  OC-INS-AGE                    PIC S999     COMP-3.
  1254         16  OC-JNT-LAST-NAME              PIC X(15).
  1255         16  OC-JNT-FIRST-NAME             PIC X(10).
  1256         16  OC-JNT-MIDDLE-INIT            PIC X.
  1257         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1258         16  OC-LF-BENCD                   PIC XX.
  1259         16  OC-LF-TERM                    PIC S999      COMP-3.
  1260         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1261         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1262         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1263         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1264         16  OC-LF-EXP-DT                  PIC XX.
  1265         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1266         16  OC-LF-CANCEL-DT               PIC XX.
  1267         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1268         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1269         16  OC-AH-BENCD                   PIC XX.
  1270         16  OC-AH-TERM                    PIC S999      COMP-3.
  1271         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1272         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1273         16  OC-AH-EXP-DT                  PIC XX.
  1274         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1275         16  OC-AH-CP                      PIC 99.
  1276         16  OC-AH-CANCEL-DT               PIC XX.
  1277         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1278         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1279         16  OC-CRED-BENE-NAME             PIC X(25).
  1280         16  OC-1ST-PMT-DT                 PIC XX.
  1281         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1282         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1283         16  OC-ISSUE-TRAN-IND             PIC X.
  1284         16  OC-CANCEL-TRAN-IND            PIC X.
  1285         16  FILLER                        PIC X(211).
  1286
  1287     12  FILLER                            PIC X(50).
  1288******************************************************************
  1289*                                COPY ERCACCT.
  1290******************************************************************
  1291*                                                                *
  1292*                                                                *
  1293*                            ERCACCT                             *
  1294*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1295*                            VMOD=2.031                          *
  1296*                                                                *
  1297*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1298*                                                                *
  1299*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1300*   VSAM ACCOUNT MASTER FILES.                                   *
  1301*                                                                *
  1302*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1303*                                                                *
  1304*   FILE TYPE = VSAM,KSDS                                        *
  1305*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1306*                                                                *
  1307*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1308*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1309*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  26
* EL6311.cbl
  1310*   LOG = NO                                                     *
  1311*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1312*                                                                *
  1313*                                                                *
  1314******************************************************************
  1315*                   C H A N G E   L O G
  1316*
  1317* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1318*-----------------------------------------------------------------
  1319*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1320* EFFECTIVE    NUMBER
  1321*-----------------------------------------------------------------
  1322* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1323* 092705    2005050300006  PEMA  ADD SPP LEASES
  1324* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1325* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1326* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1327* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1328* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1329******************************************************************
  1330
  1331 01  ACCOUNT-MASTER.
  1332     12  AM-RECORD-ID                      PIC XX.
  1333         88  VALID-AM-ID                      VALUE 'AM'.
  1334
  1335     12  AM-CONTROL-PRIMARY.
  1336         16  AM-COMPANY-CD                 PIC X.
  1337         16  AM-MSTR-CNTRL.
  1338             20  AM-CONTROL-A.
  1339                 24  AM-CARRIER            PIC X.
  1340                 24  AM-GROUPING.
  1341                     28 AM-GROUPING-PREFIX PIC XXX.
  1342                     28 AM-GROUPING-PRIME  PIC XXX.
  1343                 24  AM-STATE              PIC XX.
  1344                 24  AM-ACCOUNT.
  1345                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1346                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1347             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1348                                           PIC X(19).
  1349             20  AM-CNTRL-B.
  1350                 24  AM-EXPIRATION-DT      PIC XX.
  1351                 24  FILLER                PIC X(4).
  1352             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1353                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1354
  1355     12  AM-CONTROL-BY-VAR-GRP.
  1356         16  AM-COMPANY-CD-A1              PIC X.
  1357         16  AM-VG-CARRIER                 PIC X.
  1358         16  AM-VG-GROUPING                PIC X(6).
  1359         16  AM-VG-STATE                   PIC XX.
  1360         16  AM-VG-ACCOUNT                 PIC X(10).
  1361         16  AM-VG-DATE.
  1362             20  AM-VG-EXPIRATION-DT       PIC XX.
  1363             20  FILLER                    PIC X(4).
  1364         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1365                                           PIC 9(11)      COMP-3.
  1366     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1367         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  27
* EL6311.cbl
  1368         16  AM-VG-KEY3.
  1369             20  AM-VG3-ACCOUNT            PIC X(10).
  1370             20  AM-VG3-EXP-DT             PIC XX.
  1371         16  FILLER                        PIC X(4).
  1372     12  AM-MAINT-INFORMATION.
  1373         16  AM-LAST-MAINT-DT              PIC XX.
  1374         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1375         16  AM-LAST-MAINT-USER            PIC X(4).
  1376         16  FILLER                        PIC XX.
  1377
  1378     12  AM-EFFECTIVE-DT                   PIC XX.
  1379     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1380
  1381     12  AM-PREV-DATES  COMP-3.
  1382         16  AM-PREV-EXP-DT                PIC 9(11).
  1383         16  AM-PREV-EFF-DT                PIC 9(11).
  1384
  1385     12  AM-REPORT-CODE-1                  PIC X(10).
  1386     12  AM-REPORT-CODE-2                  PIC X(10).
  1387
  1388     12  AM-CITY-CODE                      PIC X(4).
  1389     12  AM-COUNTY-PARISH                  PIC X(6).
  1390
  1391     12  AM-NAME                           PIC X(30).
  1392     12  AM-PERSON                         PIC X(30).
  1393     12  AM-ADDRS                          PIC X(30).
  1394     12  AM-CITY.
  1395         16  AM-ADDR-CITY                  PIC X(28).
  1396         16  AM-ADDR-STATE                 PIC XX.
  1397     12  AM-ZIP.
  1398         16  AM-ZIP-PRIME.
  1399             20  AM-ZIP-PRI-1ST            PIC X.
  1400                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1401             20  FILLER                    PIC X(4).
  1402         16  AM-ZIP-PLUS4                  PIC X(4).
  1403     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1404         16  AM-CAN-POSTAL-1               PIC XXX.
  1405         16  AM-CAN-POSTAL-2               PIC XXX.
  1406         16  FILLER                        PIC XXX.
  1407     12  AM-TEL-NO.
  1408         16  AM-AREA-CODE                  PIC 999.
  1409         16  AM-TEL-PRE                    PIC 999.
  1410         16  AM-TEL-NBR                    PIC 9(4).
  1411     12  AM-TEL-LOC                        PIC X.
  1412         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1413         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1414
  1415     12  AM-COMM-STRUCTURE.
  1416         16  AM-DEFN-1.
  1417             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1418                 24  AM-AGT.
  1419                     28  AM-AGT-PREFIX     PIC X(4).
  1420                     28  AM-AGT-PRIME      PIC X(6).
  1421                 24  AM-COM-TYP            PIC X.
  1422                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1423                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1424                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1425                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  28
* EL6311.cbl
  1426                 24  AM-RETRO-LV-INDIC     PIC X.
  1427                 24  AM-GL-CODES           PIC X.
  1428                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1429                 24  FILLER                PIC X(01).
  1430         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1431             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1432                 24  FILLER                PIC X(11).
  1433                 24  AM-L-COMA             PIC XXX.
  1434                 24  AM-J-COMA             PIC XXX.
  1435                 24  AM-A-COMA             PIC XXX.
  1436                 24  FILLER                PIC X(6).
  1437
  1438     12  AM-COMM-CHANGE-STATUS             PIC X.
  1439         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1440
  1441     12  AM-CSR-CODE                       PIC X(4).
  1442
  1443     12  AM-BILLING-STATUS                 PIC X.
  1444         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1445         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1446     12  AM-AUTO-REFUND-SW                 PIC X.
  1447         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1448         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1449     12  AM-GPCD                           PIC 99.
  1450     12  AM-IG                             PIC X.
  1451         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1452         88  AM-HAS-GROUP                     VALUE '2'.
  1453     12  AM-STATUS                         PIC X.
  1454         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1455         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1456         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1457         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1458         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1459         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1460     12  AM-REMIT-TO                       PIC 99.
  1461     12  AM-ID-NO                          PIC X(11).
  1462
  1463     12  AM-CAL-TABLE                      PIC XX.
  1464     12  AM-LF-DEVIATION                   PIC XXX.
  1465     12  AM-AH-DEVIATION                   PIC XXX.
  1466     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1467     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1468     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1469     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1470     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1471     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1472
  1473     12  AM-USER-FIELDS.
  1474         16  AM-FLD-1                      PIC XX.
  1475         16  AM-FLD-2                      PIC XX.
  1476         16  AM-FLD-3                      PIC XX.
  1477         16  AM-FLD-4                      PIC XX.
  1478         16  AM-FLD-5                      PIC XX.
  1479
  1480     12  AM-1ST-PROD-DATE.
  1481         16  AM-1ST-PROD-YR                PIC XX.
  1482         16  AM-1ST-PROD-MO                PIC XX.
  1483         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  29
* EL6311.cbl
  1484     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1485     12  AM-CERTS-PURGED-DATE.
  1486         16  AM-PUR-YR                     PIC XX.
  1487         16  AM-PUR-MO                     PIC XX.
  1488         16  AM-PUR-DA                     PIC XX.
  1489     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1490     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1491     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1492     12  AM-INACTIVE-DATE.
  1493         16  AM-INA-MO                     PIC 99.
  1494         16  AM-INA-DA                     PIC 99.
  1495         16  AM-INA-YR                     PIC 99.
  1496     12  AM-AR-HI-CERT-DATE                PIC XX.
  1497
  1498     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1499     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1500
  1501     12  AM-OB-PAYMENT-MODE                PIC X.
  1502         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1503         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1504         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1505         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1506
  1507     12  AM-AH-ONLY-INDICATOR              PIC X.
  1508         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1509         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1510
  1511     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1512
  1513     12  AM-OVER-SHORT.
  1514         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1515         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1516
  1517     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1518     12  AM-DCC-CLP-STATE                  PIC XX.
  1519
  1520     12  AM-RECALC-COMM                    PIC X.
  1521     12  AM-RECALC-REIN                    PIC X.
  1522
  1523     12  AM-REI-TABLE                      PIC XXX.
  1524     12  AM-REI-ET-LF                      PIC X.
  1525     12  AM-REI-ET-AH                      PIC X.
  1526     12  AM-REI-PE-LF                      PIC X.
  1527     12  AM-REI-PE-AH                      PIC X.
  1528     12  AM-REI-PRT-ST                     PIC X.
  1529     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1530     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1531     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1532     12  AM-REI-GROUP-A                    PIC X(6).
  1533     12  AM-REI-MORT                       PIC X(4).
  1534     12  AM-REI-PRT-OW                     PIC X.
  1535     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1536     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1537     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1538     12  AM-REI-GROUP-B                    PIC X(6).
  1539
  1540     12  AM-TRUST-TYPE                     PIC X(2).
  1541
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  30
* EL6311.cbl
  1542     12  AM-EMPLOYER-STMT-USED             PIC X.
  1543     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1544
  1545     12  AM-STD-AH-TYPE                    PIC XX.
  1546     12  AM-EARN-METHODS.
  1547         16  AM-EARN-METHOD-R              PIC X.
  1548             88 AM-REF-RL-R78                 VALUE 'R'.
  1549             88 AM-REF-RL-PR                  VALUE 'P'.
  1550             88 AM-REF-RL-MEAN                VALUE 'M'.
  1551             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1552         16  AM-EARN-METHOD-L              PIC X.
  1553             88 AM-REF-LL-R78                 VALUE 'R'.
  1554             88 AM-REF-LL-PR                  VALUE 'P'.
  1555             88 AM-REF-LL-MEAN                VALUE 'M'.
  1556             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1557         16  AM-EARN-METHOD-A              PIC X.
  1558             88 AM-REF-AH-R78                 VALUE 'R'.
  1559             88 AM-REF-AH-PR                  VALUE 'P'.
  1560             88 AM-REF-AH-MEAN                VALUE 'M'.
  1561             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1562             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1563             88 AM-REF-AH-NET                 VALUE 'N'.
  1564
  1565     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1566     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1567     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1568
  1569     12  AM-RET-Y-N                        PIC X.
  1570     12  AM-RET-P-E                        PIC X.
  1571     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1572     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1573     12  AM-RET-GRP                        PIC X(6).
  1574     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1575         16  AM-POOL-PRIME                 PIC XXX.
  1576         16  AM-POOL-SUB                   PIC XXX.
  1577     12  AM-RETRO-EARNINGS.
  1578         16  AM-RET-EARN-R                 PIC X.
  1579         16  AM-RET-EARN-L                 PIC X.
  1580         16  AM-RET-EARN-A                 PIC X.
  1581     12  AM-RET-ST-TAX-USE                 PIC X.
  1582         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1583         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1584     12  AM-RETRO-BEG-EARNINGS.
  1585         16  AM-RET-BEG-EARN-R             PIC X.
  1586         16  AM-RET-BEG-EARN-L             PIC X.
  1587         16  AM-RET-BEG-EARN-A             PIC X.
  1588     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1589     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1590
  1591     12  AM-USER-SELECT-OPTIONS.
  1592         16  AM-USER-SELECT-1              PIC X(10).
  1593         16  AM-USER-SELECT-2              PIC X(10).
  1594         16  AM-USER-SELECT-3              PIC X(10).
  1595         16  AM-USER-SELECT-4              PIC X(10).
  1596         16  AM-USER-SELECT-5              PIC X(10).
  1597
  1598     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1599
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  31
* EL6311.cbl
  1600     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1601
  1602     12  AM-RPT045A-SWITCH                 PIC X.
  1603         88  RPT045A-OFF                   VALUE 'N'.
  1604
  1605     12  AM-INSURANCE-LIMITS.
  1606         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1607         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1608
  1609     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1610         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1611
  1612     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1613         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1614         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1615
  1616     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1617
  1618     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1619     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1620     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1621     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1622     12  AM-DCC-UEF-STATE                  PIC XX.
  1623     12  FILLER                            PIC XXX.
  1624     12  AM-REPORT-CODE-3                  PIC X(10).
  1625*    12  FILLER                            PIC X(22).
  1626
  1627     12  AM-RESERVE-DATE.
  1628         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1629         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1630         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1631
  1632     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1633     12  AM-NOTIFICATION-TYPES.
  1634         16  AM-NOTIF-OF-LETTERS           PIC X.
  1635         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1636         16  AM-NOTIF-OF-REPORTS           PIC X.
  1637         16  AM-NOTIF-OF-STATUS            PIC X.
  1638
  1639     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1640         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1641         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1642         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1643         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1644
  1645     12  AM-BENEFIT-CONTROLS.
  1646         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1647             20  AM-BENEFIT-CODE           PIC XX.
  1648             20  AM-BENEFIT-TYPE           PIC X.
  1649             20  AM-BENEFIT-REVISION       PIC XXX.
  1650             20  AM-BENEFIT-REM-TERM       PIC X.
  1651             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1652             20  FILLER                    PIC XX.
  1653         16  FILLER                        PIC X(80).
  1654
  1655     12  AM-TRANSFER-DATA.
  1656         16  AM-TRANSFERRED-FROM.
  1657             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  32
* EL6311.cbl
  1658             20  AM-TRNFROM-GROUPING.
  1659                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1660                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1661             20  AM-TRNFROM-STATE          PIC XX.
  1662             20  AM-TRNFROM-ACCOUNT.
  1663                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1664                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1665             20  AM-TRNFROM-DTE            PIC XX.
  1666         16  AM-TRANSFERRED-TO.
  1667             20  AM-TRNTO-CARRIER          PIC X.
  1668             20  AM-TRNTO-GROUPING.
  1669                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1670                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1671             20  AM-TRNTO-STATE            PIC XX.
  1672             20  AM-TRNTO-ACCOUNT.
  1673                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1674                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1675             20  AM-TRNTO-DTE              PIC XX.
  1676         16  FILLER                        PIC X(10).
  1677
  1678     12  AM-SAVED-REMIT-TO                 PIC 99.
  1679
  1680     12  AM-COMM-STRUCTURE-SAVED.
  1681         16  AM-DEFN-1-SAVED.
  1682             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1683                 24  AM-AGT-SV             PIC X(10).
  1684                 24  AM-COM-TYP-SV         PIC X.
  1685                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1686                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1687                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1688                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1689                 24  FILLER                PIC X.
  1690                 24  AM-GL-CODES-SV        PIC X.
  1691                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1692                 24  FILLER                PIC X.
  1693         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1694             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1695                 24  FILLER                PIC X(11).
  1696                 24  AM-L-COMA-SV          PIC XXX.
  1697                 24  AM-J-COMA-SV          PIC XXX.
  1698                 24  AM-A-COMA-SV          PIC XXX.
  1699                 24  FILLER                PIC X(6).
  1700
  1701     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1702         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1703            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1704            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1705            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1706
  1707     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1708     12  FILLER                            PIC X(120).
  1709
  1710     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1711         16  AM-CONTROL-NAME               PIC X(30).
  1712         16  AM-EXECUTIVE-ONE.
  1713             20  AM-EXEC1-NAME             PIC X(15).
  1714             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1715                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  33
* EL6311.cbl
  1716             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1717                                                          COMP-3.
  1718         16  AM-EXECUTIVE-TWO.
  1719             20  AM-EXEC2-NAME             PIC X(15).
  1720             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1721                                                          COMP-3.
  1722             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1723                                                          COMP-3.
  1724
  1725     12  AM-RETRO-ADDITIONAL-DATA.
  1726         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1727         16  AM-RETRO-PREM-P-E             PIC X.
  1728         16  AM-RETRO-CLMS-P-I             PIC X.
  1729         16  AM-RETRO-RET-BRACKET-LF.
  1730             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1731                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1732                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1733             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1734                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1735                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1736             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1737                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1738                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1739         16  AM-RETRO-RET-BRACKET-AH.
  1740             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1741                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1742                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1743                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1744             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1745                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1746                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1747             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1748                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1749                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1750
  1751     12  AM-COMMENTS.
  1752         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1753
  1754     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1755         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1756         16  AM-FLI-BILLING-CODE           PIC X.
  1757         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1758         16  AM-FLI-UNITED-IDENT           PIC X.
  1759         16  AM-FLI-INTEREST-LOST-DATA.
  1760             20  AM-FLI-BANK-NO            PIC X(5).
  1761             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1762             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1763             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1764         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1765             20  AM-FLI-AGT                PIC X(9).
  1766             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1767             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1768         16  FILLER                        PIC X(102).
  1769
  1770     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1771         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1772             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1773             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  34
* EL6311.cbl
  1774             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1775             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1776             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1777         16  FILLER                          PIC X(10).
  1778******************************************************************
  1779*                                COPY ELCVADS.
  1780******************************************************************
  1781*                                                                *
  1782*                                                                *
  1783*                            ELCVADS.                            *
  1784*                                                                *
  1785*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1786*   ELVADS                  LENGTH = 350                         *
  1787******************************************************************
  1788******************************************************************
  1789*                   C H A N G E   L O G
  1790*
  1791* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1792*-----------------------------------------------------------------
  1793*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1794* EFFECTIVE    NUMBER
  1795*-----------------------------------------------------------------
  1796* 100111    2011022800001  AJRA  NAPERSOFT
  1797******************************************************************
  1798
  1799 01  VIRGINIA-DISCLOSURE.
  1800     12  VD-COMPANY-CD              PIC X.
  1801     12  VD-CARRIER                 PIC X.
  1802     12  VD-GROUPING.
  1803         20  VD-GROUPING-PREFIX     PIC XXX.
  1804         20  VD-GROUPING-PRIME      PIC XXX.
  1805     12  VD-STATE                   PIC XX.
  1806     12  VD-ACCOUNT.
  1807         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1808         20  VD-ACCOUNT-PRIME       PIC X(6).
  1809     12  VD-CERT-EFF-DT             PIC XX.
  1810     12  VD-CERT-NO.
  1811         20  VD-CERT-PRIME          PIC X(10).
  1812         20  VD-CERT-SFX            PIC X.
  1813     12  VD-ENTRY-BATCH             PIC X(6).
  1814     12  VD-CSR-ID                  PIC X(4).
  1815     12  VD-NAME.
  1816         20  VD-INSURED-LAST-NAME   PIC X(15).
  1817         20  VD-INSURED-FIRST-NAME.
  1818             24  VD-INSURED-1ST-INIT PIC X.
  1819             24  FILLER             PIC X(9).
  1820         20  VD-INSURED-MIDDLE-INIT PIC X.
  1821     12  VD-JOINT-INSURED.
  1822         20 VD-JOINT-LAST-NAME      PIC X(15).
  1823         20 VD-JOINT-FIRST-NAME.
  1824            24  VD-JOINT-FIRST-INIT PIC X.
  1825            24  FILLER              PIC X(9).
  1826         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1827     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1828     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1829     12  VD-INSURED-CITY-STATE.
  1830         20  VD-INSURED-CITY        PIC X(28).
  1831         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  35
* EL6311.cbl
  1832     12  VD-INSURED-ZIP-CODE.
  1833         20  VD-INSURED-ZIP-PRIME.
  1834             24  VD-INSURED-ZIP-1   PIC X.
  1835                 88  VD-CANADIAN-POST-CODE
  1836                                       VALUE 'A' THRU 'Z'.
  1837             24  FILLER             PIC X(4).
  1838         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1839     12  VD-BENEFICIARY-NAME        PIC X(30).
  1840     12  VD-ACCOUNT-NAME            PIC X(30).
  1841     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1842     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1843     12  VD-1ST-PMT-DT              PIC XX.
  1844     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1845         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1846         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1847                                             '90' THRU '99'.
  1848     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1849                                    PIC XX.
  1850     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1851     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1852     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1853     12  VD-LF-TERM                 PIC S999   COMP-3.
  1854     12  VD-AH-BENEFIT-CD           PIC XX.
  1855         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1856         88  VD-INVALID-AH             VALUE '  ' '00'
  1857                                             '90' THRU '99'.
  1858     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1859     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1860     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1861     12  VD-AH-TERM                 PIC S999   COMP-3.
  1862     12  VD-LETTER-ID               PIC X(4).
  1863     12  VD-PROC-ID                 PIC X(4).
  1864     12  VD-COMP-ID                 PIC X(3).
  1865     12  VD-CURRENT-DATE            PIC XX.
  1866     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1867     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1868     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  36
* EL6311.cbl
  1870*    COPY ELCDATE.
  1871******************************************************************
  1872*                                                                *
  1873*                                                                *
  1874*                            ELCDATE.                            *
  1875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1876*                            VMOD=2.003
  1877*                                                                *
  1878*                                                                *
  1879*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1880*                 LENGTH = 200                                   *
  1881******************************************************************
  1882
  1883 01  DATE-CONVERSION-DATA.
  1884     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1885     12  DC-OPTION-CODE                PIC X.
  1886         88  BIN-TO-GREG                VALUE ' '.
  1887         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1888         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1889         88  YMD-GREG-TO-BIN            VALUE '3'.
  1890         88  MDY-GREG-TO-BIN            VALUE '4'.
  1891         88  JULIAN-TO-BIN              VALUE '5'.
  1892         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1893         88  FIND-CENTURY               VALUE '7'.
  1894         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1895         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1896         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1897         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1898         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1899         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1900         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1901         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1902         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1903         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1904         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1905         88  BIN-3-TO-GREG              VALUE 'I'.
  1906         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1907         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1908         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1909         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1910         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1911         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1912         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1913         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1914         88  THREE-CHARACTER-BIN
  1915                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1916         88  GREGORIAN-TO-BIN
  1917                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1918         88  BIN-TO-GREGORIAN
  1919                  VALUES ' ' '1' 'I' '8' 'G'.
  1920         88  JULIAN-TO-BINARY
  1921                  VALUES '5' 'C' 'E' 'F'.
  1922     12  DC-ERROR-CODE                 PIC X.
  1923         88  NO-CONVERSION-ERROR        VALUE ' '.
  1924         88  DATE-CONVERSION-ERROR
  1925                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1926         88  DATE-IS-ZERO               VALUE '1'.
  1927         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  37
* EL6311.cbl
  1928         88  DATE-IS-INVALID            VALUE '3'.
  1929         88  DATE1-GREATER-DATE2        VALUE '4'.
  1930         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1931         88  DATE-INVALID-OPTION        VALUE '9'.
  1932         88  INVALID-CENTURY            VALUE 'A'.
  1933         88  ONLY-CENTURY               VALUE 'B'.
  1934         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1935         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1936     12  DC-END-OF-MONTH               PIC X.
  1937         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1938     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1939         88  USE-NORMAL-PROCESS         VALUE ' '.
  1940         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1941         88  ADJUST-UP-100-YRS          VALUE '2'.
  1942     12  FILLER                        PIC X.
  1943     12  DC-CONVERSION-DATES.
  1944         16  DC-BIN-DATE-1             PIC XX.
  1945         16  DC-BIN-DATE-2             PIC XX.
  1946         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1947         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1948                       DC-GREG-DATE-1-EDIT.
  1949             20  DC-EDIT1-MONTH        PIC 99.
  1950             20  SLASH1-1              PIC X.
  1951             20  DC-EDIT1-DAY          PIC 99.
  1952             20  SLASH1-2              PIC X.
  1953             20  DC-EDIT1-YEAR         PIC 99.
  1954         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1955         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1956                     DC-GREG-DATE-2-EDIT.
  1957             20  DC-EDIT2-MONTH        PIC 99.
  1958             20  SLASH2-1              PIC X.
  1959             20  DC-EDIT2-DAY          PIC 99.
  1960             20  SLASH2-2              PIC X.
  1961             20  DC-EDIT2-YEAR         PIC 99.
  1962         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1963         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1964                     DC-GREG-DATE-1-YMD.
  1965             20  DC-YMD-YEAR           PIC 99.
  1966             20  DC-YMD-MONTH          PIC 99.
  1967             20  DC-YMD-DAY            PIC 99.
  1968         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1969         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1970                      DC-GREG-DATE-1-MDY.
  1971             20  DC-MDY-MONTH          PIC 99.
  1972             20  DC-MDY-DAY            PIC 99.
  1973             20  DC-MDY-YEAR           PIC 99.
  1974         16  DC-GREG-DATE-1-ALPHA.
  1975             20  DC-ALPHA-MONTH        PIC X(10).
  1976             20  DC-ALPHA-DAY          PIC 99.
  1977             20  FILLER                PIC XX.
  1978             20  DC-ALPHA-CENTURY.
  1979                 24 DC-ALPHA-CEN-N     PIC 99.
  1980             20  DC-ALPHA-YEAR         PIC 99.
  1981         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1982         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1983         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1984         16  DC-JULIAN-DATE            PIC 9(05).
  1985         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  38
* EL6311.cbl
  1986                                       PIC 9(05).
  1987         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1988             20  DC-JULIAN-YEAR        PIC 99.
  1989             20  DC-JULIAN-DAYS        PIC 999.
  1990         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1991         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1992         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1993     12  DATE-CONVERSION-VARIBLES.
  1994         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1995         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1996             20  FILLER                PIC 9(3).
  1997             20  HOLD-CEN-1-CCYY.
  1998                 24  HOLD-CEN-1-CC     PIC 99.
  1999                 24  HOLD-CEN-1-YY     PIC 99.
  2000             20  HOLD-CEN-1-MO         PIC 99.
  2001             20  HOLD-CEN-1-DA         PIC 99.
  2002         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2003             20  HOLD-CEN-1-R-MO       PIC 99.
  2004             20  HOLD-CEN-1-R-DA       PIC 99.
  2005             20  HOLD-CEN-1-R-CCYY.
  2006                 24  HOLD-CEN-1-R-CC   PIC 99.
  2007                 24  HOLD-CEN-1-R-YY   PIC 99.
  2008             20  FILLER                PIC 9(3).
  2009         16  HOLD-CENTURY-1-X.
  2010             20  FILLER                PIC X(3)  VALUE SPACES.
  2011             20  HOLD-CEN-1-X-CCYY.
  2012                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2013                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2014             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2015             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2016         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2017             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2018             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2019             20  HOLD-CEN-1-R-X-CCYY.
  2020                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2021                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2022             20  FILLER                PIC XXX.
  2023         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2024         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2025         16  DC-JULIAN-DATE-1          PIC 9(07).
  2026         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2027             20  DC-JULIAN-1-CCYY.
  2028                 24  DC-JULIAN-1-CC    PIC 99.
  2029                 24  DC-JULIAN-1-YR    PIC 99.
  2030             20  DC-JULIAN-DA-1        PIC 999.
  2031         16  DC-JULIAN-DATE-2          PIC 9(07).
  2032         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2033             20  DC-JULIAN-2-CCYY.
  2034                 24  DC-JULIAN-2-CC    PIC 99.
  2035                 24  DC-JULIAN-2-YR    PIC 99.
  2036             20  DC-JULIAN-DA-2        PIC 999.
  2037         16  DC-GREG-DATE-A-EDIT.
  2038             20  DC-EDITA-MONTH        PIC 99.
  2039             20  SLASHA-1              PIC X VALUE '/'.
  2040             20  DC-EDITA-DAY          PIC 99.
  2041             20  SLASHA-2              PIC X VALUE '/'.
  2042             20  DC-EDITA-CCYY.
  2043                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  39
* EL6311.cbl
  2044                 24  DC-EDITA-YEAR     PIC 99.
  2045         16  DC-GREG-DATE-B-EDIT.
  2046             20  DC-EDITB-MONTH        PIC 99.
  2047             20  SLASHB-1              PIC X VALUE '/'.
  2048             20  DC-EDITB-DAY          PIC 99.
  2049             20  SLASHB-2              PIC X VALUE '/'.
  2050             20  DC-EDITB-CCYY.
  2051                 24  DC-EDITB-CENT     PIC 99.
  2052                 24  DC-EDITB-YEAR     PIC 99.
  2053         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2054         16  DC-GREG-DATE-CYMD-R REDEFINES
  2055                              DC-GREG-DATE-CYMD.
  2056             20  DC-CYMD-CEN           PIC 99.
  2057             20  DC-CYMD-YEAR          PIC 99.
  2058             20  DC-CYMD-MONTH         PIC 99.
  2059             20  DC-CYMD-DAY           PIC 99.
  2060         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2061         16  DC-GREG-DATE-MDCY-R REDEFINES
  2062                              DC-GREG-DATE-MDCY.
  2063             20  DC-MDCY-MONTH         PIC 99.
  2064             20  DC-MDCY-DAY           PIC 99.
  2065             20  DC-MDCY-CEN           PIC 99.
  2066             20  DC-MDCY-YEAR          PIC 99.
  2067    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2068        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2069    12  DC-EL310-DATE                  PIC X(21).
  2070    12  FILLER                         PIC X(28).
  2071
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  40
* EL6311.cbl
  2073*    COPY ELCLOGOF.
  2074******************************************************************
  2075*                                                                *
  2076*                                                                *
  2077*                            ELCLOGOF.                           *
  2078*                            VMOD=2.001                          *
  2079*                                                                *
  2080*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2081*                                                                *
  2082******************************************************************
  2083 01  CLASIC-LOGOFF.
  2084     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2085     12  LOGOFF-TEXT.
  2086         16  FILLER          PIC X(5)    VALUE SPACES.
  2087         16  LOGOFF-MSG.
  2088             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2089             20  FILLER      PIC X       VALUE SPACES.
  2090             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2091         16  FILLER          PIC X(80)
  2092           VALUE '* YOU ARE NOW LOGGED OFF'.
  2093         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2094         16  FILLER          PIC X       VALUE QUOTE.
  2095         16  LOGOFF-SYS-MSG  PIC X(17)
  2096           VALUE 'S CLAS-IC SYSTEM '.
  2097     12  TEXT-MESSAGES.
  2098         16  UNACCESS-MSG    PIC X(29)
  2099             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2100         16  PGMIDERR-MSG    PIC X(17)
  2101             VALUE 'PROGRAM NOT FOUND'.
  2102
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  41
* EL6311.cbl
  2104*    COPY ELCATTR.
  2105******************************************************************
  2106*                                                                *
  2107*                            ELCATTR.                            *
  2108*                            VMOD=2.001                          *
  2109*                                                                *
  2110*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2111*                                                                *
  2112*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2113*                                                                *
  2114*                   POS 1   P=PROTECTED                          *
  2115*                           U=UNPROTECTED                        *
  2116*                           S=ASKIP                              *
  2117*                   POS 2   A=ALPHA/NUMERIC                      *
  2118*                           N=NUMERIC                            *
  2119*                   POS 3   N=NORMAL                             *
  2120*                           B=BRIGHT                             *
  2121*                           D=DARK                               *
  2122*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2123*                           OF=MODIFIED DATA TAG OFF             *
  2124*                                                                *
  2125*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2126******************************************************************
  2127 01  ATTRIBUTE-LIST.
  2128     12  AL-PABOF            PIC X       VALUE 'Y'.
  2129     12  AL-PABON            PIC X       VALUE 'Z'.
  2130     12  AL-PADOF            PIC X       VALUE '%'.
  2131     12  AL-PADON            PIC X       VALUE '_'.
  2132     12  AL-PANOF            PIC X       VALUE '-'.
  2133     12  AL-PANON            PIC X       VALUE '/'.
  2134     12  AL-SABOF            PIC X       VALUE '8'.
  2135     12  AL-SABON            PIC X       VALUE '9'.
  2136     12  AL-SADOF            PIC X       VALUE '@'.
  2137     12  AL-SADON            PIC X       VALUE QUOTE.
  2138     12  AL-SANOF            PIC X       VALUE '0'.
  2139     12  AL-SANON            PIC X       VALUE '1'.
  2140     12  AL-UABOF            PIC X       VALUE 'H'.
  2141     12  AL-UABON            PIC X       VALUE 'I'.
  2142     12  AL-UADOF            PIC X       VALUE '<'.
  2143     12  AL-UADON            PIC X       VALUE '('.
  2144     12  AL-UANOF            PIC X       VALUE ' '.
  2145     12  AL-UANON            PIC X       VALUE 'A'.
  2146     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2147     12  AL-UNBON            PIC X       VALUE 'R'.
  2148     12  AL-UNDOF            PIC X       VALUE '*'.
  2149     12  AL-UNDON            PIC X       VALUE ')'.
  2150     12  AL-UNNOF            PIC X       VALUE '&'.
  2151     12  AL-UNNON            PIC X       VALUE 'J'.
  2152
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  42
* EL6311.cbl
  2154*    COPY ELCEMIB.
  2155******************************************************************
  2156*                                                                *
  2157*                                                                *
  2158*                            ELCEMIB.                            *
  2159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2160*                            VMOD=2.005                          *
  2161*                                                                *
  2162*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2163*                                                                *
  2164******************************************************************
  2165 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2166     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2167     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2168     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2169     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2170     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2171     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2172     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2173     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2174     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2175         88  EMI-NO-ERRORS                    VALUE '1'.
  2176         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2177         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2178     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2179         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2180     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2181         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2182         88  EMI-AREA1-FULL                   VALUE '2'.
  2183     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2184         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2185         88  EMI-AREA2-FULL                   VALUE '2'.
  2186     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2187         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2188         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2189         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2190         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2191         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2192     12  EMI-ERROR-LINES.
  2193         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2194         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2195         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2196         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2197             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2198                 24  EMI-ERR-NUM         PIC X(4).
  2199                 24  EMI-FILLER          PIC X.
  2200                 24  EMI-SEV             PIC X.
  2201                 24  FILLER              PIC X.
  2202             20  FILLER                  PIC X(02).
  2203     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2204         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2205             20  EMI-ERROR-NUMBER    PIC X(4).
  2206             20  EMI-FILL            PIC X.
  2207             20  EMI-SEVERITY        PIC X.
  2208             20  FILLER              PIC X.
  2209             20  EMI-ERROR-TEXT.
  2210                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2211                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  43
* EL6311.cbl
  2212     12  EMI-SEVERITY-SAVE           PIC X.
  2213         88  EMI-NOTE                    VALUE 'N'.
  2214         88  EMI-WARNING                 VALUE 'W'.
  2215         88  EMI-FORCABLE                VALUE 'F'.
  2216         88  EMI-FATAL                   VALUE 'X'.
  2217     12  EMI-MESSAGE-FLAG            PIC X.
  2218         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2219         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2220     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2221     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2222         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2223         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2224         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2225     12  emi-claim-no                pic x(7).
  2226     12  emi-claim-type              pic x(6).
  2227     12  FILLER                      PIC X(124)  VALUE SPACES.
  2228     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2229     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2230     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2231     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2232
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  44
* EL6311.cbl
  2234*    COPY ELCINTF.
  2235******************************************************************
  2236*                                                                *
  2237*                                                                *
  2238*                            ELCINTF.                            *
  2239*                            VMOD=2.017                          *
  2240*                                                                *
  2241*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2242*                                                                *
  2243*       LENGTH = 1024                                            *
  2244*                                                                *
  2245******************************************************************
  2246*                   C H A N G E   L O G
  2247*
  2248* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2249*-----------------------------------------------------------------
  2250*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2251* EFFECTIVE    NUMBER
  2252*-----------------------------------------------------------------
  2253* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2254******************************************************************
  2255 01  PROGRAM-INTERFACE-BLOCK.
  2256     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2257     12  PI-CALLING-PROGRAM              PIC X(8).
  2258     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2259     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2260     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2261     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2262     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2263     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2264     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2265     12  PI-COMPANY-ID                   PIC XXX.
  2266     12  PI-COMPANY-CD                   PIC X.
  2267
  2268     12  PI-COMPANY-PASSWORD             PIC X(8).
  2269
  2270     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2271
  2272     12  PI-CONTROL-IN-PROGRESS.
  2273         16  PI-CARRIER                  PIC X.
  2274         16  PI-GROUPING                 PIC X(6).
  2275         16  PI-STATE                    PIC XX.
  2276         16  PI-ACCOUNT                  PIC X(10).
  2277         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2278                                         PIC X(10).
  2279         16  PI-CLAIM-CERT-GRP.
  2280             20  PI-CLAIM-NO             PIC X(7).
  2281             20  PI-CERT-NO.
  2282                 25  PI-CERT-PRIME       PIC X(10).
  2283                 25  PI-CERT-SFX         PIC X.
  2284             20  PI-CERT-EFF-DT          PIC XX.
  2285         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2286             20  PI-PLAN-CODE            PIC X(2).
  2287             20  PI-REVISION-NUMBER      PIC X(3).
  2288             20  PI-PLAN-EFF-DT          PIC X(2).
  2289             20  PI-PLAN-EXP-DT          PIC X(2).
  2290             20  FILLER                  PIC X(11).
  2291         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  45
* EL6311.cbl
  2292             20  PI-OE-REFERENCE-1.
  2293                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2294                 25  PI-OE-REF-1-SUFF    PIC XX.
  2295
  2296     12  PI-SESSION-IN-PROGRESS          PIC X.
  2297         88  CLAIM-SESSION                   VALUE '1'.
  2298         88  CREDIT-SESSION                  VALUE '2'.
  2299         88  WARRANTY-SESSION                VALUE '3'.
  2300         88  MORTGAGE-SESSION                VALUE '4'.
  2301         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2302
  2303
  2304*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2305
  2306     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2307     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2308
  2309     12  PI-CREDIT-USER                  PIC X.
  2310         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2311         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2312
  2313     12  PI-CLAIM-USER                   PIC X.
  2314         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2315         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2316
  2317     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2318         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2319         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2320         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2321         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2322         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2323
  2324     12  PI-PROCESSOR-ID                 PIC X(4).
  2325
  2326     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2327
  2328     12  PI-MEMBER-CAPTION               PIC X(10).
  2329
  2330     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2331         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2332
  2333     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2334     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2335     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2336     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2337
  2338     12  PI-AH-OVERRIDE-L1               PIC X.
  2339     12  PI-AH-OVERRIDE-L2               PIC XX.
  2340     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2341     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2342
  2343     12  PI-NEW-SYSTEM                   PIC X(2).
  2344
  2345     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2346     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2347         88  PI-USES-PAID-TO                 VALUE '1'.
  2348     12  PI-CRDTCRD-SYSTEM.
  2349         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  46
* EL6311.cbl
  2350             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2351             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2352         16  PI-CC-MONTH-END-DT          PIC XX.
  2353     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2354
  2355     12  PI-OE-REFERENCE-2.
  2356         16  PI-OE-REF-2-PRIME           PIC X(10).
  2357         16  PI-OE-REF-2-SUFF            PIC X.
  2358
  2359     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2360
  2361     12  PI-LANGUAGE-TYPE                PIC X.
  2362             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2363             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2364             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2365
  2366     12  PI-POLICY-LINKAGE-IND           PIC X.
  2367         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2368         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2369                                                   LOW-VALUES.
  2370
  2371     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2372     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2373         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2374         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2375
  2376     12  PI-PROCESSOR-CSR-IND            PIC X.
  2377         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2378         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2379
  2380     12  FILLER                          PIC X(3).
  2381
  2382     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2383
  2384     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2385         PI-SYSTEM-LEVEL.
  2386
  2387         16  PI-ENTRY-CODES.
  2388             20  PI-ENTRY-CD-1           PIC X.
  2389             20  PI-ENTRY-CD-2           PIC X.
  2390
  2391         16  PI-RETURN-CODES.
  2392             20  PI-RETURN-CD-1          PIC X.
  2393             20  PI-RETURN-CD-2          PIC X.
  2394
  2395         16  PI-UPDATE-STATUS-SAVE.
  2396             20  PI-UPDATE-BY            PIC X(4).
  2397             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2398
  2399         16  PI-LOWER-CASE-LETTERS       PIC X.
  2400             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2401
  2402*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2403*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2404*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2405
  2406         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2407             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  47
* EL6311.cbl
  2408             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2409             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2410             88  ACCNT-CNTL                  VALUE '3'.
  2411             88  CARR-ACCNT-CNTL             VALUE '4'.
  2412
  2413         16  PI-PROCESSOR-CAP-LIST.
  2414             20  PI-SYSTEM-CONTROLS.
  2415                24 PI-SYSTEM-DISPLAY     PIC X.
  2416                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2417                24 PI-SYSTEM-MODIFY      PIC X.
  2418                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2419             20  FILLER                  PIC XX.
  2420             20  PI-DISPLAY-CAP          PIC X.
  2421                 88  DISPLAY-CAP             VALUE 'Y'.
  2422             20  PI-MODIFY-CAP           PIC X.
  2423                 88  MODIFY-CAP              VALUE 'Y'.
  2424             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2425                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2426             20  PI-FORCE-CAP            PIC X.
  2427                 88  FORCE-CAP               VALUE 'Y'.
  2428
  2429         16  PI-PROGRAM-CONTROLS.
  2430             20  PI-PGM-PRINT-OPT        PIC X.
  2431             20  PI-PGM-FORMAT-OPT       PIC X.
  2432             20  PI-PGM-PROCESS-OPT      PIC X.
  2433             20  PI-PGM-TOTALS-OPT       PIC X.
  2434
  2435         16  PI-HELP-INTERFACE.
  2436             20  PI-LAST-ERROR-NO        PIC X(4).
  2437             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2438
  2439         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2440             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2441
  2442         16  PI-CR-CONTROL-IN-PROGRESS.
  2443             20  PI-CR-CARRIER           PIC X.
  2444             20  PI-CR-GROUPING          PIC X(6).
  2445             20  PI-CR-STATE             PIC XX.
  2446             20  PI-CR-ACCOUNT           PIC X(10).
  2447             20  PI-CR-FIN-RESP          PIC X(10).
  2448             20  PI-CR-TYPE              PIC X.
  2449
  2450         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2451
  2452         16  PI-CR-MONTH-END-DT          PIC XX.
  2453
  2454         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2455             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2456             88  PI-ZERO-CARRIER             VALUE '1'.
  2457             88  PI-ZERO-GROUPING            VALUE '2'.
  2458             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2459
  2460         16  PI-CARRIER-SECURITY         PIC X.
  2461             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2462
  2463         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2464             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2465             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  48
* EL6311.cbl
  2466
  2467         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2468             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2469                                         INDEXED BY PI-ACCESS-NDX
  2470                                         PIC X.
  2471
  2472         16  PI-GA-BILLING-CONTROL       PIC X.
  2473             88  PI-GA-BILLING               VALUE '1'.
  2474
  2475         16  PI-MAIL-PROCESSING          PIC X.
  2476             88  PI-MAIL-YES                 VALUE 'Y'.
  2477
  2478         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2479
  2480         16  PI-AR-SYSTEM.
  2481             20  PI-AR-PROCESSING-CNTL   PIC X.
  2482                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2483             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2484             20  PI-AR-MONTH-END-DT      PIC XX.
  2485
  2486         16  PI-MP-SYSTEM.
  2487             20  PI-MORTGAGE-USER            PIC X.
  2488                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2489                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2490             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2491                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2492                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2493                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2494                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2495                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2496             20  PI-MP-MONTH-END-DT          PIC XX.
  2497             20  PI-MP-REFERENCE-NO.
  2498                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2499                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2500
  2501         16  PI-LABEL-CONTROL            PIC X(01).
  2502             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2503             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2504
  2505         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2506             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2507
  2508         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2509             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2510             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2511
  2512         16  FILLER                      PIC X(14).
  2513
  2514     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2515******************************************************************
  2516
  2517     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2518*    COPY ELC631PI.
  2519******************************************************************
  2520*                                                                *
  2521*                                                                *
  2522*                            ELC631PI                            *
  2523*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  49
* EL6311.cbl
  2524*                                                                *
  2525*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2526*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2527*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2528*                                                                *
  2529*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2530*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2531*    BETWEEN PROGRAMS.                                           *
  2532*                                                                *
  2533*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2534*                                                                *
  2535*               EL631 - EL6311 - EL6312 - EL6313                 *
  2536*                                                                *
  2537******************************************************************
  2538*                   C H A N G E   L O G
  2539*
  2540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2541*-----------------------------------------------------------------
  2542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2543* EFFECTIVE    NUMBER
  2544*-----------------------------------------------------------------
  2545* 021414    2003053000001  PEMA  changes for auto chk request
  2546******************************************************************
  2547
  2548         16  PI-631-DATA.
  2549             20  PI-ERPNDB-KEY.
  2550                 24  PI-PB-COMPANY-CD     PIC X.
  2551                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2552                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2553                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2554
  2555             20  PI-ERPNDB-ALT-KEY.
  2556                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2557                 24  PI-PB-CARRIER        PIC X.
  2558                 24  PI-PB-GROUPING       PIC X(6).
  2559                 24  PI-PB-STATE          PIC XX.
  2560                 24  PI-PB-ACCOUNT        PIC X(10).
  2561                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2562                 24  PI-PB-CERT-NO.
  2563                     28  PI-PB-CERT-PRIME PIC X(10).
  2564                     28  PI-PB-CERT-SFX   PIC X.
  2565                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2566                 24  PI-PB-RECORD-TYPE    PIC X.
  2567
  2568             20  PI-ERPNDB-CSR-KEY.
  2569                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2570                 24  PI-PB-CSR-ID             PIC X(4).
  2571                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2572                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2573                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2574
  2575             20  PI-BROWSE-TYPE               PIC X.
  2576                 88  PI-FILE-BROWSE             VALUE ' '.
  2577                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2578                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2579                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2580                 88  PI-CSR-BROWSE              VALUE '4'.
  2581
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  50
* EL6311.cbl
  2582             20  PI-MAINT-FUNCTION            PIC X.
  2583                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2584                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2585                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2586                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2587                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2588                 88  PI-PF5-FUNCTION            VALUE '5'.
  2589                 88  PI-PF6-FUNCTION            VALUE '6'.
  2590
  2591             20  PI-FILE-SWITCHES.
  2592                 24  PI-ALL-ISSUES-SW         PIC X.
  2593                     88  ALL-ISSUES             VALUE 'Y'.
  2594                 24  PI-ALL-CANCELS-SW        PIC X.
  2595                     88  ALL-CANCELS            VALUE 'Y'.
  2596                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2597                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2598                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2599                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2600                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2601                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2602                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2603                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2604                 24  PI-HOLD-REC-SW           PIC X.
  2605                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2606                 24  PI-CHANGE-REC-SW         PIC X.
  2607                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2608                 24  PI-CHK-REQ-REC-SW        PIC X.
  2609                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2610                 24  PI-ISSUE-WARNING-SW      PIC X.
  2611                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2612                 24  PI-CANCEL-WARNING-SW     PIC X.
  2613                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2614             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2615                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2616             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2617                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2618
  2619             20  PI-MAP-NAME                  PIC X(8).
  2620
  2621             20  PI-CURSOR                    PIC S9(4) COMP.
  2622
  2623             20  PI-PREV-ALT-KEY              PIC X(36).
  2624             20  PI-PREV-CSR-KEY              PIC X(15).
  2625             20  PI-PREV-KEY.
  2626                 24  PI-PREV-COMPANY-CD       PIC X.
  2627                 24  PI-PREV-BATCH            PIC X(6).
  2628                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2629                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2630             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2631             20  PI-BROWSE-SW                 PIC X.
  2632                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2633                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2634             20  PI-SV-CARRIER                PIC X.
  2635             20  PI-SV-GROUPING               PIC X(6).
  2636             20  PI-SV-STATE                  PIC XX.
  2637             20  PI-EDIT-SW                   PIC X.
  2638             20  PI-DISPLAY-SW                PIC XX.
  2639                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  51
* EL6311.cbl
  2640                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2641             20  PI-CRITERIA-DATA             PIC X(350).
  2642             20  PI-BMODE                     PIC X.
  2643             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2644             20  PI-BPMTS                     PIC S999     COMP-3.
  2645             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2646             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2647             20  PI-CSR-SESSION-SW            PIC X.
  2648                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2649             20  PI-ERRORS-SW                 PIC X.
  2650                 88  FATAL-ERRORS               VALUE 'X'.
  2651*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2652             20  pi-unforced-sw               pic x.
  2653                 88  unforced-errors            value 'X'.
  2654             20  FILLER                       PIC X(4).
  2655
  2656        16  FILLER             PIC X(94).
  2657
  2658 01  W-LETTER-COMMUNICATION-AREAS.
  2659*    COPY ELC1042.
  2660******************************************************************
  2661*                                                                *
  2662*                                                                *
  2663*                           ELC1042                              *
  2664*                            VMOD=2.002                          *
  2665*                                                                *
  2666*    NOTE                                                        *
  2667*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2668*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2669*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2670*        TO THESE PROGRAMS.                                      *
  2671*                                                                *
  2672*    NOTE                                                        *
  2673*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2674*        USE ONLY!                                               *
  2675*                                                                *
  2676******************************************************************
  2677
  2678         16  PI-1042-WA.
  2679             20  PI-ACTION       PIC  X(01).
  2680                 88 PI-SHOW-MODE           VALUE '1'.
  2681                 88 PI-CLEAR-MODE          VALUE '2'.
  2682                 88 PI-CREATE-MODE         VALUE '3'.
  2683             20  PI-COMM-CONTROL PIC  X(12).
  2684             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2685             20  PI-EOF-SW       PIC  X(01).
  2686                 88  PI-FILE-EOF           VALUE 'Y'.
  2687             20  PI-FILETYP      PIC  X(01).
  2688             20  PI-FORM-SQUEEZE-CONTROL
  2689                                 PIC  X(01).
  2690                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2691                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2692             20  PI-LAST-CONTROL PIC  X(12).
  2693             20  PI-TEMP-STOR-ITEMS
  2694                                 PIC S9(04) COMP.
  2695             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2696             20  PI-UPDATE-SW    PIC  9(01).
  2697                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  52
* EL6311.cbl
  2698             20  PI-104-SCREEN-SENT-IND
  2699                                 PIC  X(01).
  2700                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2701                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2702             20  PI-1042-SCREEN-SENT-IND
  2703                                 PIC  X(01).
  2704                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2705                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2706             20  PI-1042-ARCHIVE-IND
  2707                                 PIC  X(01).
  2708                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2709             20  FILLER          PIC  X(29).
  2710*    COPY ELC689PI.
  2711******************************************************************
  2712*                                                                *
  2713*                            ELC689PI                            *
  2714*                            VMOD=2.003                          *
  2715*                                                                *
  2716*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2717*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2718*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2719*                                                                *
  2720*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2721*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2722*    BETWEEN PROGRAMS.                                           *
  2723*                                                                *
  2724*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2725*                                                                *
  2726*               EL631 - EL689  - EL6891 - EL6892                 *
  2727*                                                                *
  2728******************************************************************
  2729*                   C H A N G E   L O G
  2730*
  2731* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2732*-----------------------------------------------------------------
  2733*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2734* EFFECTIVE    NUMBER
  2735*-----------------------------------------------------------------
  2736* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2737* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2738* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2739******************************************************************
  2740
  2741
  2742         16  PI-689-WORK-AREA.
  2743             20  PI-689-ALT-PRINTER-ID
  2744                                 PIC  X(04).
  2745             20  PI-689-ARCHIVE-NUMBER
  2746                                 PIC  9(08).
  2747             20  PI-689-ARCHIVE-SW
  2748                                 PIC  X(01).
  2749                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2750             20  PI-689-DATA-SOURCE
  2751                                 PIC  X(01).
  2752                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2753                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2754                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2755                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  53
* EL6311.cbl
  2756                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2757             20  PI-689-ERROR-IND
  2758                                 PIC  X(01).
  2759                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2760             20  PI-689-ERROR    PIC  9(04).
  2761                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2762                 88  PI-689-FATAL-ERROR
  2763                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2764                            0042 0047 0051 0066 0067 0070
  2765                            0168 0169 0174 0175 0176 0177 0179
  2766                            0180 0181 0182 0184 0185 0189 0190
  2767                            0191
  2768                            0215 0279 0280
  2769                            0412 0413 0454
  2770                            0533 0537
  2771                            2055 2114 2208 2209 2216 2232 2369
  2772                            2398 2433 2908 2999
  2773                            3000 3770 3771 3775
  2774                            7250 7365 7367 7368 7369 7370 7371
  2775                            7272 7373 7374 7376 7377 7378 7379
  2776                            7381 7388 7390 7393 7395 7396 7398
  2777                            9095 9096 9281 9298 9299 9320 9327
  2778                            9426 9427.
  2779                 88  PI-689-STOP-ERROR
  2780                     VALUES 0004 0008 0013 0023 0029 0033
  2781                            0042 0047 0066 0067 0070
  2782                            0168 0169 0174 0175 0176 0177
  2783                            0181 0182 0184 0185 0189 0190
  2784                            0279 0280
  2785                            0412 0413 0454
  2786                            2055 2208 2209 2216 2232
  2787                            2398 2999
  2788                            3000 3770 3771 3775
  2789                            7250 7365 7369 7370 7371
  2790                            7272 7373 7374 7376 7377 7378 7379
  2791                            7381 7388 7390 7393 7396 7398
  2792                            9095 9096 9299 9320 9426.
  2793             20  PI-689-FOLLOW-UP-DATE
  2794                                 PIC  X(02).
  2795             20  PI-689-FORM-NUMBER
  2796                                 PIC  X(04).
  2797             20  PI-689-LABEL-SOURCE
  2798                                 PIC X(01).
  2799                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2800                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2801                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2802                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2803                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2804                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2805                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2806             20  PI-689-NUMBER-COPIES
  2807                                 PIC  9(01).
  2808             20  PI-689-NUMBER-LABEL-LINES
  2809                                 PIC  9(01).
  2810             20  PI-689-NUMBER-TEXT-RECORDS
  2811                                 PIC  9(03).
  2812             20  PI-689-PRINT-ORDER-SW
  2813                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  54
* EL6311.cbl
  2814                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2815                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2816                 88  PI-689-PRINT-LATER     VALUE '3'.
  2817                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2818             20  PI-689-PRINT-RESTRICTION
  2819                                 PIC  X(01).
  2820                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2821                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2822                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2823             20  PI-689-PRINT-SW PIC  X(01).
  2824                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2825             20  PI-689-RESEND-DATE-1
  2826                                 PIC  X(02).
  2827             20  PI-689-RESEND-LETR-1
  2828                                 PIC X(4).
  2829             20  PI-689-TEMP-STOR-ID
  2830                                 PIC  X(08).
  2831             20  PI-689-USE-SCREEN-IND
  2832                                 PIC  X(01).
  2833                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2834             20  PI-689-ARCH-POINTER
  2835                                 PIC S9(08) COMP.
  2836                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2837             20  PI-689-ARCT-POINTER
  2838                                 PIC S9(08) COMP.
  2839                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2840             20  PI-689-VARIABLE-DATA-GRP.
  2841                 24  PI-689-VARIABLE-DATA-1
  2842                                 PIC  X(30).
  2843                 24  PI-689-VARIABLE-DATA-2
  2844                                 PIC  X(30).
  2845                 24  PI-689-VARIABLE-DATA-3
  2846                                 PIC  X(30).
  2847                 24  PI-689-VARIABLE-DATA-4
  2848                                 PIC  X(30).
  2849
  2850         16  PI-689-KEY-DATA-FIELDS.
  2851             20  PI-689-ACCOUNT  PIC  X(10).
  2852             20  PI-689-CARRIER  PIC  X(01).
  2853             20  PI-689-CERT-NO.
  2854                 24  PI-689-CERT-PRIME
  2855                                 PIC  X(10).
  2856                 24  PI-689-CERT-SFX
  2857                                 PIC  X(01).
  2858             20  PI-689-CHG-SEQ-NO
  2859                                 PIC S9(04)    COMP.
  2860             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2861                                 PIC  X(02).
  2862             20  PI-689-ENTRY-BATCH
  2863                                 PIC  X(06).
  2864             20  PI-689-EFF-DATE PIC  X(02).
  2865             20  PI-689-EXP-DATE PIC  X(02).
  2866             20  PI-689-GROUPING PIC  X(06).
  2867             20  PI-689-RESP-PERSON
  2868                                 PIC  X(10).
  2869             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2870             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2871                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  55
* EL6311.cbl
  2872             20  PI-689-STATE    PIC  X(02).
  2873             20  PI-689-TYPE     PIC  X(01).
  2874             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2875             20  PI-689-ALT-SEQ-NO
  2876                                 PIC S9(04)    COMP.
  2877         16  PI-689-DATE-EDIT    PIC  X(08).
  2878         16  PI-689-FOLLOW-UP-EDIT
  2879                                 PIC  X(08).
  2880         16  PI-689-RESEND1-EDIT PIC  X(08).
  2881         16  PI-689-SEQ-EDIT     PIC  X(08).
  2882         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2883         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2884             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2885         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2886         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  56
* EL6311.cbl
  2888
  2889 01  WS-EL6315-PASS-AREA.
  2890        16  PI-6315-ISS-CAN-SW      PIC X.
  2891        16  FILLER                  PIC X(120).
  2892        16  PI-RES-REF-CLM-TYPE     PIC X.
  2893        16  FILLER                  PIC X.
  2894        16  PI-6315-PASS-AREA.
  2895            20 FILLER               PIC X(236).
  2896            20 PI-6315-FINALIZED    PIC X.
  2897            20 FILLER               PIC X(280).
  2898
  2899 01  WS-EL6316-PASS-AREA.
  2900        16  PI-ISS-CAN-SW           PIC X.
  2901        16  FILLER                  PIC X(121).
  2902        16  PI-CLM-RESC-IND         PIC X.
  2903        16  PI-6316-PASS-AREA.
  2904            20 FILLER               PIC X(236).
  2905            20 PI-6316-FINALIZED    PIC X.
  2906            20 FILLER               PIC X(280).
  2907
  2908******************************************************************
  2909*                                                                *
  2910*         P A S S   A R E A   F O R   E D I T                    *
  2911*                                                                *
  2912******************************************************************
  2913
  2914 01  PASSED-RECORD.
  2915     12  RECORD-SAVE                  PIC X(585).
  2916* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2917*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2918*                    BY  WK-CURRENT-DATE.
  2919******************************************************************
  2920*                                                                *
  2921*                                                                *
  2922*                             ELC50W1                            *
  2923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2924*                            VMOD=2.004                          *
  2925*                                                                *
  2926*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2927*                                                                *
  2928*                                                                *
  2929******************************************************************
  2930
  2931     12  WK-WORK-AREA.
  2932         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2933         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2934         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2935         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2936         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2937         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2938         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2939         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2940         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2941         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2942         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2943         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2944         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2945         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  57
* EL6311.cbl
  2946         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2947         16  WK-CREDIT-EDIT-CONTROLS.
  2948             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2949             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2950             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2951             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2952             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2953             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2954         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2955         16  WK-SAVE-REIN-DATA.
  2956             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2957             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2958             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2959         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2960             88  ENTRY-FROM-EL6311       VALUE '6'.
  2961         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2962         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2963     12  WK-RECORD-ADDRESSES.
  2964         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2965         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2966         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2967         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2968         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2969         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2970         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2971         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2972     12  WK-OVER-SHORT-AREA.
  2973         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2974         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2975         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2976             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2977         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  58
* EL6311.cbl
  2979
  2980*    COPY ELCEDITC.
  2981******************************************************************
  2982*                                                                *
  2983*                                                                *
  2984*                            ELCEDITC                            *
  2985*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2986*                            VMOD=2.012                          *
  2987*                                                                *
  2988*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2989*                     EL6313, EL050 AND EL517.                   *
  2990*                                                                *
  2991******************************************************************
  2992******************************************************************
  2993*                   C H A N G E   L O G
  2994*
  2995* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2996*-----------------------------------------------------------------
  2997*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2998* EFFECTIVE    NUMBER
  2999*-----------------------------------------------------------------
  3000* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3001******************************************************************
  3002
  3003     12  EDIT-CRITERIA-DATA.
  3004         16  EC-CO-MONTH-END-DT       PIC XX.
  3005         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3006         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3007         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3008         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3009         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3010         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3011         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3012         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3013         16  EC-CO-REM-TERM-CALC      PIC X.
  3014               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3015               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3016               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3017               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3018
  3019         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3020               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3021               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3022               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3023               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3024               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3025               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3026               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3027               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3028               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3029               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3030
  3031         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3032               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3033               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3034               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3035               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3036               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  59
* EL6311.cbl
  3037               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3038               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3039               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3040
  3041         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3042                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3043                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3044
  3045         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3046                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3047                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3048                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3049                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3050                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3051                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3052                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3053                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3054
  3055         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3056               88  EC-BR-REDUCING                   VALUE 'R'.
  3057               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3058
  3059         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3060         16  EC-BR-LF-DESC             PIC X(10).
  3061         16  EC-BR-AH-DESC             PIC X(10).
  3062         16  EC-BR-LF-COMMENT          PIC X(10).
  3063         16  EC-BR-AH-COMMENT          PIC X(10).
  3064
  3065         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3066               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3067               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3068               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3069               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3070
  3071         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3072               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3073               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3074               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3075               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3076
  3077         16  EC-BR-LF-REFUND-CALC      PIC X.
  3078                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3079                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3080                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3081                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3082                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3083                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3084                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3085
  3086         16  EC-BR-AH-REFUND-CALC      PIC X.
  3087                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3088                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3089                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3090                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3091                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3092                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3093                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3094                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  60
* EL6311.cbl
  3095
  3096         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3097                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3098                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3099                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3100
  3101         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3102                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3103                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3104                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3105
  3106         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3107         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3108         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3109         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3110
  3111         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3112         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3113                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3114                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3115                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3116                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3117
  3118         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3119               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3120               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3121               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3122               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3123               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3124
  3125         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3126               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3127               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3128               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3129               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3130               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3131
  3132         16  EC-ST-LF-REFUND-CALC      PIC X.
  3133                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3134                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3135                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3136                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3137                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3138                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3139                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3140                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3141
  3142         16  EC-ST-AH-REFUND-CALC      PIC X.
  3143                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3144                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3145                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3146                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3147                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3148                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3149                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3150                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3151
  3152         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  61
* EL6311.cbl
  3153         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3154         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3155         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3156         16  EC-AM-EXPIRATION-DT       PIC XX.
  3157         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3158         16  EC-AM-CLASS-CD            PIC XX.
  3159         16  EC-AM-LF-DEVIATION        PIC XXX.
  3160         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3161         16  EC-AM-AH-DEVIATION        PIC XXX.
  3162         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3163         16  EC-AM-PHONE-NO            PIC X(10).
  3164
  3165         16  EC-AM-LF-REFUND-CALC      PIC X.
  3166                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3167                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3168                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3169                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3170                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3171                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3172                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3173
  3174         16  EC-AM-AH-REFUND-CALC      PIC X.
  3175                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3176                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3177                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3178                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3179                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3180                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3181                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3182
  3183         16  EC-AM-BEN-I-G-CD          PIC X.
  3184                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3185                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3186                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3187
  3188         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3189         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3190         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3191         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3192         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3193         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3194         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3195         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3196         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3197
  3198         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3199         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3200         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3201         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3202         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3203         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3204         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3205         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3206         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3207         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3208         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3209         16  EC-RT-LF-NSP-ST           PIC XX.
  3210         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  62
* EL6311.cbl
  3211         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3212         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3213
  3214         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3215             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3216                                             'M' '5' '9' '2'.
  3217             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3218             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3219             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3220             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3221             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3222             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3223             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3224             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3225             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3226             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3227
  3228         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3229             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3230                                             'M' '5' '9' '2'.
  3231             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3232             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3233             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3234             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3235             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3236             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3237             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3238             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3239             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3240             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3241
  3242         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3243         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3244         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3245         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3246         16  EC-CM-DEATH-DT            PIC XX.
  3247
  3248*DMD CUSTOM CODING FIELDS BELOW
  3249*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3250         16  EC-BR-DMD-RATING-SW       PIC X.
  3251                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3252                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3253                 88  NO-DMD-RATING               VALUE 'N'.
  3254
  3255         16  EC-NEW-CERT               PIC X(11).
  3256         16  EC-NEW-STATE              PIC XX.
  3257         16  FILLER                    PIC X.
  3258*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3259         16  OVER-SHORT-EDIT-FIELDS.
  3260             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3261             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3262             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3263             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3264             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3265             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3266             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3267             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3268             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  63
* EL6311.cbl
  3269         16  FILLER                    PIC X(71).
  3270
  3271******************************************************************
  3272
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  64
* EL6311.cbl
  3274
  3275*    COPY ELCJPFX.
  3276******************************************************************
  3277*                                                                *
  3278*                                                                *
  3279*                            ELCJPFX.                            *
  3280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3281*                            VMOD=2.002                          *
  3282*                                                                *
  3283*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3284*                                                                *
  3285*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3286*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3287*        ELCNTL - CONTROL FILE                                   *
  3288*        ELMSTR - CLAIM MASTERS                                  *
  3289*        ELTRLR - ACTIVITY TRAILERS                              *
  3290*        ELCHKQ - CHECK QUE                                      *
  3291******************************************************************
  3292 01  JOURNAL-RECORD.
  3293     12  jp-date                     pic s9(5) comp-3.
  3294     12  jp-time                     pic s9(7) comp-3.
  3295     12  JP-USER-ID                  PIC X(4).
  3296     12  JP-FILE-ID                  PIC X(8).
  3297     12  JP-PROGRAM-ID               PIC X(8).
  3298     12  JP-RECORD-TYPE              PIC X.
  3299         88 JP-ADD              VALUE 'A'.
  3300         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3301         88 JP-AFTER-CHANGE     VALUE 'C'.
  3302         88 JP-DELETE           VALUE 'D'.
  3303         88 JP-GENERIC-DELETE   VALUE 'G'.
  3304         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3305         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3306     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3307     12  JP-RECORD-AREA
  3308
  3309
  3310                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  65
* EL6311.cbl
  3312*    COPY ELCAID.
  3313******************************************************************
  3314*                                                                *
  3315*                            ELCAID.                             *
  3316*                            VMOD=2.001                          *
  3317*                                                                *
  3318*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3319*                                                                *
  3320*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3321*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3322******************************************************************
  3323
  3324 01  DFHAID.
  3325   02  DFHNULL   PIC  X  VALUE  ' '.
  3326   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3327   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3328   02  DFHPEN    PIC  X  VALUE  '='.
  3329   02  DFHOPID   PIC  X  VALUE  'W'.
  3330   02  DFHPA1    PIC  X  VALUE  '%'.
  3331   02  DFHPA2    PIC  X  VALUE  '>'.
  3332   02  DFHPA3    PIC  X  VALUE  ','.
  3333   02  DFHPF1    PIC  X  VALUE  '1'.
  3334   02  DFHPF2    PIC  X  VALUE  '2'.
  3335   02  DFHPF3    PIC  X  VALUE  '3'.
  3336   02  DFHPF4    PIC  X  VALUE  '4'.
  3337   02  DFHPF5    PIC  X  VALUE  '5'.
  3338   02  DFHPF6    PIC  X  VALUE  '6'.
  3339   02  DFHPF7    PIC  X  VALUE  '7'.
  3340   02  DFHPF8    PIC  X  VALUE  '8'.
  3341   02  DFHPF9    PIC  X  VALUE  '9'.
  3342   02  DFHPF10   PIC  X  VALUE  ':'.
  3343   02  DFHPF11   PIC  X  VALUE  '#'.
  3344   02  DFHPF12   PIC  X  VALUE  '@'.
  3345   02  DFHPF13   PIC  X  VALUE  'A'.
  3346   02  DFHPF14   PIC  X  VALUE  'B'.
  3347   02  DFHPF15   PIC  X  VALUE  'C'.
  3348   02  DFHPF16   PIC  X  VALUE  'D'.
  3349   02  DFHPF17   PIC  X  VALUE  'E'.
  3350   02  DFHPF18   PIC  X  VALUE  'F'.
  3351   02  DFHPF19   PIC  X  VALUE  'G'.
  3352   02  DFHPF20   PIC  X  VALUE  'H'.
  3353   02  DFHPF21   PIC  X  VALUE  'I'.
  3354*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3355   02  DFHPF22   PIC  X  VALUE  '['.
  3356   02  DFHPF23   PIC  X  VALUE  '.'.
  3357   02  DFHPF24   PIC  X  VALUE  '<'.
  3358   02  DFHMSRE   PIC  X  VALUE  'X'.
  3359   02  DFHSTRF   PIC  X  VALUE  'h'.
  3360   02  DFHTRIG   PIC  X  VALUE  '"'.
  3361
  3362 01  FILLER    REDEFINES DFHAID.
  3363     12  FILLER              PIC X(8).
  3364     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3365
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  66
* EL6311.cbl
  3367*    COPY EL6311S.
  3368 01  EL631BI.
  3369     05  FILLER            PIC  X(0012).
  3370*    -------------------------------
  3371     05  BDATEL PIC S9(0004) COMP.
  3372     05  BDATEF PIC  X(0001).
  3373     05  FILLER REDEFINES BDATEF.
  3374         10  BDATEA PIC  X(0001).
  3375     05  BDATEI PIC  X(0008).
  3376*    -------------------------------
  3377     05  BTIMEL PIC S9(0004) COMP.
  3378     05  BTIMEF PIC  X(0001).
  3379     05  FILLER REDEFINES BTIMEF.
  3380         10  BTIMEA PIC  X(0001).
  3381     05  BTIMEI PIC  X(0005).
  3382*    -------------------------------
  3383     05  BHEADL PIC S9(0004) COMP.
  3384     05  BHEADF PIC  X(0001).
  3385     05  FILLER REDEFINES BHEADF.
  3386         10  BHEADA PIC  X(0001).
  3387     05  BHEADI PIC  X(0038).
  3388*    -------------------------------
  3389     05  BNCERTLL PIC S9(0004) COMP.
  3390     05  BNCERTLF PIC  X(0001).
  3391     05  FILLER REDEFINES BNCERTLF.
  3392         10  BNCERTLA PIC  X(0001).
  3393     05  BNCERTLI PIC  X(0008).
  3394*    -------------------------------
  3395     05  BNCERTL PIC S9(0004) COMP.
  3396     05  BNCERTF PIC  X(0001).
  3397     05  FILLER REDEFINES BNCERTF.
  3398         10  BNCERTA PIC  X(0001).
  3399     05  BNCERTI PIC  X(0011).
  3400*    -------------------------------
  3401     05  BNSTATLL PIC S9(0004) COMP.
  3402     05  BNSTATLF PIC  X(0001).
  3403     05  FILLER REDEFINES BNSTATLF.
  3404         10  BNSTATLA PIC  X(0001).
  3405     05  BNSTATLI PIC  X(0009).
  3406*    -------------------------------
  3407     05  BNSTATL PIC S9(0004) COMP.
  3408     05  BNSTATF PIC  X(0001).
  3409     05  FILLER REDEFINES BNSTATF.
  3410         10  BNSTATA PIC  X(0001).
  3411     05  BNSTATI PIC  X(0002).
  3412*    -------------------------------
  3413     05  BCHGTL PIC S9(0004) COMP.
  3414     05  BCHGTF PIC  X(0001).
  3415     05  FILLER REDEFINES BCHGTF.
  3416         10  BCHGTA PIC  X(0001).
  3417     05  BCHGTI PIC  X(0004).
  3418*    -------------------------------
  3419     05  BCHGL PIC S9(0004) COMP.
  3420     05  BCHGF PIC  X(0001).
  3421     05  FILLER REDEFINES BCHGF.
  3422         10  BCHGA PIC  X(0001).
  3423     05  BCHGI PIC  X(0004).
  3424*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  67
* EL6311.cbl
  3425     05  BMAINTL PIC S9(0004) COMP.
  3426     05  BMAINTF PIC  X(0001).
  3427     05  FILLER REDEFINES BMAINTF.
  3428         10  BMAINTA PIC  X(0001).
  3429     05  BMAINTI PIC  X(0001).
  3430*    -------------------------------
  3431     05  BMANTBYL PIC S9(0004) COMP.
  3432     05  BMANTBYF PIC  X(0001).
  3433     05  FILLER REDEFINES BMANTBYF.
  3434         10  BMANTBYA PIC  X(0001).
  3435     05  BMANTBYI PIC  X(0004).
  3436*    -------------------------------
  3437     05  BCHGHDGL PIC S9(0004) COMP.
  3438     05  BCHGHDGF PIC  X(0001).
  3439     05  FILLER REDEFINES BCHGHDGF.
  3440         10  BCHGHDGA PIC  X(0001).
  3441     05  BCHGHDGI PIC  X(0003).
  3442*    -------------------------------
  3443     05  BMANTDTL PIC S9(0004) COMP.
  3444     05  BMANTDTF PIC  X(0001).
  3445     05  FILLER REDEFINES BMANTDTF.
  3446         10  BMANTDTA PIC  X(0001).
  3447     05  BMANTDTI PIC  X(0008).
  3448*    -------------------------------
  3449     05  BMANTATL PIC S9(0004) COMP.
  3450     05  BMANTATF PIC  X(0001).
  3451     05  FILLER REDEFINES BMANTATF.
  3452         10  BMANTATA PIC  X(0001).
  3453     05  BMANTATI PIC  X(0005).
  3454*    -------------------------------
  3455     05  BCSRL PIC S9(0004) COMP.
  3456     05  BCSRF PIC  X(0001).
  3457     05  FILLER REDEFINES BCSRF.
  3458         10  BCSRA PIC  X(0001).
  3459     05  BCSRI PIC  X(0004).
  3460*    -------------------------------
  3461     05  BBATCHL PIC S9(0004) COMP.
  3462     05  BBATCHF PIC  X(0001).
  3463     05  FILLER REDEFINES BBATCHF.
  3464         10  BBATCHA PIC  X(0001).
  3465     05  BBATCHI PIC  X(0006).
  3466*    -------------------------------
  3467     05  BSEQL PIC S9(0004) COMP.
  3468     05  BSEQF PIC  X(0001).
  3469     05  FILLER REDEFINES BSEQF.
  3470         10  BSEQA PIC  X(0001).
  3471     05  BSEQI PIC  X(0004).
  3472*    -------------------------------
  3473     05  BMOENDTL PIC S9(0004) COMP.
  3474     05  BMOENDTF PIC  X(0001).
  3475     05  FILLER REDEFINES BMOENDTF.
  3476         10  BMOENDTA PIC  X(0001).
  3477     05  BMOENDTI PIC  X(0008).
  3478*    -------------------------------
  3479     05  BCARRL PIC S9(0004) COMP.
  3480     05  BCARRF PIC  X(0001).
  3481     05  FILLER REDEFINES BCARRF.
  3482         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  68
* EL6311.cbl
  3483     05  BCARRI PIC  X(0001).
  3484*    -------------------------------
  3485     05  BGROUPL PIC S9(0004) COMP.
  3486     05  BGROUPF PIC  X(0001).
  3487     05  FILLER REDEFINES BGROUPF.
  3488         10  BGROUPA PIC  X(0001).
  3489     05  BGROUPI PIC  X(0006).
  3490*    -------------------------------
  3491     05  BSTATEL PIC S9(0004) COMP.
  3492     05  BSTATEF PIC  X(0001).
  3493     05  FILLER REDEFINES BSTATEF.
  3494         10  BSTATEA PIC  X(0001).
  3495     05  BSTATEI PIC  X(0002).
  3496*    -------------------------------
  3497     05  BACCTL PIC S9(0004) COMP.
  3498     05  BACCTF PIC  X(0001).
  3499     05  FILLER REDEFINES BACCTF.
  3500         10  BACCTA PIC  X(0001).
  3501     05  BACCTI PIC  X(0010).
  3502*    -------------------------------
  3503     05  BVINHL PIC S9(0004) COMP.
  3504     05  BVINHF PIC  X(0001).
  3505     05  FILLER REDEFINES BVINHF.
  3506         10  BVINHA PIC  X(0001).
  3507     05  BVINHI PIC  X(0004).
  3508*    -------------------------------
  3509     05  BVINL PIC S9(0004) COMP.
  3510     05  BVINF PIC  X(0001).
  3511     05  FILLER REDEFINES BVINF.
  3512         10  BVINA PIC  X(0001).
  3513     05  BVINI PIC  X(0017).
  3514*    -------------------------------
  3515     05  BREFHDGL PIC S9(0004) COMP.
  3516     05  BREFHDGF PIC  X(0001).
  3517     05  FILLER REDEFINES BREFHDGF.
  3518         10  BREFHDGA PIC  X(0001).
  3519     05  BREFHDGI PIC  X(0004).
  3520*    -------------------------------
  3521     05  BREFL PIC S9(0004) COMP.
  3522     05  BREFF PIC  X(0001).
  3523     05  FILLER REDEFINES BREFF.
  3524         10  BREFA PIC  X(0001).
  3525     05  BREFI PIC  X(0012).
  3526*    -------------------------------
  3527     05  BAGEDEFL PIC S9(0004) COMP.
  3528     05  BAGEDEFF PIC  X(0001).
  3529     05  FILLER REDEFINES BAGEDEFF.
  3530         10  BAGEDEFA PIC  X(0001).
  3531     05  BAGEDEFI PIC  X(0004).
  3532*    -------------------------------
  3533     05  BCERTNOL PIC S9(0004) COMP.
  3534     05  BCERTNOF PIC  X(0001).
  3535     05  FILLER REDEFINES BCERTNOF.
  3536         10  BCERTNOA PIC  X(0001).
  3537     05  BCERTNOI PIC  X(0010).
  3538*    -------------------------------
  3539     05  BSUFIXL PIC S9(0004) COMP.
  3540     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  69
* EL6311.cbl
  3541     05  FILLER REDEFINES BSUFIXF.
  3542         10  BSUFIXA PIC  X(0001).
  3543     05  BSUFIXI PIC  X(0001).
  3544*    -------------------------------
  3545     05  BEFFDTL PIC S9(0004) COMP.
  3546     05  BEFFDTF PIC  X(0001).
  3547     05  FILLER REDEFINES BEFFDTF.
  3548         10  BEFFDTA PIC  X(0001).
  3549     05  BEFFDTI PIC  X(0008).
  3550*    -------------------------------
  3551     05  BLSTNML PIC S9(0004) COMP.
  3552     05  BLSTNMF PIC  X(0001).
  3553     05  FILLER REDEFINES BLSTNMF.
  3554         10  BLSTNMA PIC  X(0001).
  3555     05  BLSTNMI PIC  X(0015).
  3556*    -------------------------------
  3557     05  B1STNML PIC S9(0004) COMP.
  3558     05  B1STNMF PIC  X(0001).
  3559     05  FILLER REDEFINES B1STNMF.
  3560         10  B1STNMA PIC  X(0001).
  3561     05  B1STNMI PIC  X(0010).
  3562*    -------------------------------
  3563     05  BINITL PIC S9(0004) COMP.
  3564     05  BINITF PIC  X(0001).
  3565     05  FILLER REDEFINES BINITF.
  3566         10  BINITA PIC  X(0001).
  3567     05  BINITI PIC  X(0001).
  3568*    -------------------------------
  3569     05  BSEXL PIC S9(0004) COMP.
  3570     05  BSEXF PIC  X(0001).
  3571     05  FILLER REDEFINES BSEXF.
  3572         10  BSEXA PIC  X(0001).
  3573     05  BSEXI PIC  X(0001).
  3574*    -------------------------------
  3575     05  BAGEL PIC S9(0004) COMP.
  3576     05  BAGEF PIC  X(0001).
  3577     05  FILLER REDEFINES BAGEF.
  3578         10  BAGEA PIC  X(0001).
  3579     05  BAGEI PIC  X(0002).
  3580*    -------------------------------
  3581     05  BBIRTHL PIC S9(0004) COMP.
  3582     05  BBIRTHF PIC  X(0001).
  3583     05  FILLER REDEFINES BBIRTHF.
  3584         10  BBIRTHA PIC  X(0001).
  3585     05  BBIRTHI PIC  X(0008).
  3586*    -------------------------------
  3587     05  B1STPMTL PIC S9(0004) COMP.
  3588     05  B1STPMTF PIC  X(0001).
  3589     05  FILLER REDEFINES B1STPMTF.
  3590         10  B1STPMTA PIC  X(0001).
  3591     05  B1STPMTI PIC  X(0008).
  3592*    -------------------------------
  3593     05  BDAYSL PIC S9(0004) COMP.
  3594     05  BDAYSF PIC  X(0001).
  3595     05  FILLER REDEFINES BDAYSF.
  3596         10  BDAYSA PIC  X(0001).
  3597     05  BDAYSI PIC  X(0003).
  3598*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  70
* EL6311.cbl
  3599     05  BLNTRML PIC S9(0004) COMP.
  3600     05  BLNTRMF PIC  X(0001).
  3601     05  FILLER REDEFINES BLNTRMF.
  3602         10  BLNTRMA PIC  X(0001).
  3603     05  BLNTRMI PIC  X(0003).
  3604*    -------------------------------
  3605     05  BLNOFCRL PIC S9(0004) COMP.
  3606     05  BLNOFCRF PIC  X(0001).
  3607     05  FILLER REDEFINES BLNOFCRF.
  3608         10  BLNOFCRA PIC  X(0001).
  3609     05  BLNOFCRI PIC  X(0005).
  3610*    -------------------------------
  3611     05  BMODEL PIC S9(0004) COMP.
  3612     05  BMODEF PIC  X(0001).
  3613     05  FILLER REDEFINES BMODEF.
  3614         10  BMODEA PIC  X(0001).
  3615     05  BMODEI PIC  X(0001).
  3616*    -------------------------------
  3617     05  BFREQL PIC S9(0004) COMP.
  3618     05  BFREQF PIC  X(0001).
  3619     05  FILLER REDEFINES BFREQF.
  3620         10  BFREQA PIC  X(0001).
  3621     05  BFREQI PIC  X(0002).
  3622*    -------------------------------
  3623     05  BPMTSL PIC S9(0004) COMP.
  3624     05  BPMTSF PIC  X(0001).
  3625     05  FILLER REDEFINES BPMTSF.
  3626         10  BPMTSA PIC  X(0001).
  3627     05  BPMTSI PIC  999.
  3628*    -------------------------------
  3629     05  BPMTAMTL PIC S9(0004) COMP.
  3630     05  BPMTAMTF PIC  X(0001).
  3631     05  FILLER REDEFINES BPMTAMTF.
  3632         10  BPMTAMTA PIC  X(0001).
  3633     05  BPMTAMTI PIC  9(7)V99.
  3634*    -------------------------------
  3635     05  BAPRL PIC S9(0004) COMP.
  3636     05  BAPRF PIC  X(0001).
  3637     05  FILLER REDEFINES BAPRF.
  3638         10  BAPRA PIC  X(0001).
  3639     05  BAPRI PIC  X(7).
  3640*    -------------------------------
  3641     05  BLIVESL PIC S9(0004) COMP.
  3642     05  BLIVESF PIC  X(0001).
  3643     05  FILLER REDEFINES BLIVESF.
  3644         10  BLIVESA PIC  X(0001).
  3645     05  BLIVESI PIC  X(0009).
  3646*    -------------------------------
  3647     05  BMEMCAPL PIC S9(0004) COMP.
  3648     05  BMEMCAPF PIC  X(0001).
  3649     05  FILLER REDEFINES BMEMCAPF.
  3650         10  BMEMCAPA PIC  X(0001).
  3651     05  BMEMCAPI PIC  X(0011).
  3652*    -------------------------------
  3653     05  BORIGHDL PIC S9(0004) COMP.
  3654     05  BORIGHDF PIC  X(0001).
  3655     05  FILLER REDEFINES BORIGHDF.
  3656         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  71
* EL6311.cbl
  3657     05  BORIGHDI PIC  X(0009).
  3658*    -------------------------------
  3659     05  DMDBILL PIC S9(0004) COMP.
  3660     05  DMDBILF PIC  X(0001).
  3661     05  FILLER REDEFINES DMDBILF.
  3662         10  DMDBILA PIC  X(0001).
  3663     05  DMDBILI PIC  X(0006).
  3664*    -------------------------------
  3665     05  BFORCEL PIC S9(0004) COMP.
  3666     05  BFORCEF PIC  X(0001).
  3667     05  FILLER REDEFINES BFORCEF.
  3668         10  BFORCEA PIC  X(0001).
  3669     05  BFORCEI PIC  X(0001).
  3670*    -------------------------------
  3671     05  BENTRYL PIC S9(0004) COMP.
  3672     05  BENTRYF PIC  X(0001).
  3673     05  FILLER REDEFINES BENTRYF.
  3674         10  BENTRYA PIC  X(0001).
  3675     05  BENTRYI PIC  X(0001).
  3676*    -------------------------------
  3677     05  BREINL PIC S9(0004) COMP.
  3678     05  BREINF PIC  X(0001).
  3679     05  FILLER REDEFINES BREINF.
  3680         10  BREINA PIC  X(0001).
  3681     05  BREINI PIC  X(0001).
  3682*    -------------------------------
  3683     05  BBILCDL PIC S9(0004) COMP.
  3684     05  BBILCDF PIC  X(0001).
  3685     05  FILLER REDEFINES BBILCDF.
  3686         10  BBILCDA PIC  X(0001).
  3687     05  BBILCDI PIC  X(0001).
  3688*    -------------------------------
  3689     05  BUNWRITL PIC S9(0004) COMP.
  3690     05  BUNWRITF PIC  X(0001).
  3691     05  FILLER REDEFINES BUNWRITF.
  3692         10  BUNWRITA PIC  X(0001).
  3693     05  BUNWRITI PIC  X(0001).
  3694*    -------------------------------
  3695     05  BSKPCDL PIC S9(0004) COMP.
  3696     05  BSKPCDF PIC  X(0001).
  3697     05  FILLER REDEFINES BSKPCDF.
  3698         10  BSKPCDA PIC  X(0001).
  3699     05  BSKPCDI PIC  X(0001).
  3700*    -------------------------------
  3701     05  BINDGRPL PIC S9(0004) COMP.
  3702     05  BINDGRPF PIC  X(0001).
  3703     05  FILLER REDEFINES BINDGRPF.
  3704         10  BINDGRPA PIC  X(0001).
  3705     05  BINDGRPI PIC  X(0001).
  3706*    -------------------------------
  3707     05  BSIGL PIC S9(0004) COMP.
  3708     05  BSIGF PIC  X(0001).
  3709     05  FILLER REDEFINES BSIGF.
  3710         10  BSIGA PIC  X(0001).
  3711     05  BSIGI PIC  X(0001).
  3712*    -------------------------------
  3713     05  BRTCLSL PIC S9(0004) COMP.
  3714     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  72
* EL6311.cbl
  3715     05  FILLER REDEFINES BRTCLSF.
  3716         10  BRTCLSA PIC  X(0001).
  3717     05  BRTCLSI PIC  X(0002).
  3718*    -------------------------------
  3719     05  BCHGCNTL PIC S9(0004) COMP.
  3720     05  BCHGCNTF PIC  X(0001).
  3721     05  FILLER REDEFINES BCHGCNTF.
  3722         10  BCHGCNTA PIC  X(0001).
  3723     05  BCHGCNTI PIC  X(0003).
  3724*    -------------------------------
  3725     05  BMEMBERL PIC S9(0004) COMP.
  3726     05  BMEMBERF PIC  X(0001).
  3727     05  FILLER REDEFINES BMEMBERF.
  3728         10  BMEMBERA PIC  X(0001).
  3729     05  BMEMBERI PIC  X(0012).
  3730*    -------------------------------
  3731     05  BORGNOL PIC S9(0004) COMP.
  3732     05  BORGNOF PIC  X(0001).
  3733     05  FILLER REDEFINES BORGNOF.
  3734         10  BORGNOA PIC  X(0001).
  3735     05  BORGNOI PIC  X(0006).
  3736*    -------------------------------
  3737     05  BORGSEQL PIC S9(0004) COMP.
  3738     05  BORGSEQF PIC  X(0001).
  3739     05  FILLER REDEFINES BORGSEQF.
  3740         10  BORGSEQA PIC  X(0001).
  3741     05  BORGSEQI PIC  X(0004).
  3742*    -------------------------------
  3743     05  BBILLEDL PIC S9(0004) COMP.
  3744     05  BBILLEDF PIC  X(0001).
  3745     05  FILLER REDEFINES BBILLEDF.
  3746         10  BBILLEDA PIC  X(0001).
  3747     05  BBILLEDI PIC  9(9).
  3748*    -------------------------------
  3749     05  BKIND1L PIC S9(0004) COMP.
  3750     05  BKIND1F PIC  X(0001).
  3751     05  FILLER REDEFINES BKIND1F.
  3752         10  BKIND1A PIC  X(0001).
  3753     05  BKIND1I PIC  X(0002).
  3754*    -------------------------------
  3755     05  BTYPE1L PIC S9(0004) COMP.
  3756     05  BTYPE1F PIC  X(0001).
  3757     05  FILLER REDEFINES BTYPE1F.
  3758         10  BTYPE1A PIC  X(0001).
  3759     05  BTYPE1I PIC  X(0003).
  3760*    -------------------------------
  3761     05  BTERM1L PIC S9(0004) COMP.
  3762     05  BTERM1F PIC  X(0001).
  3763     05  FILLER REDEFINES BTERM1F.
  3764         10  BTERM1A PIC  X(0001).
  3765     05  BTERM1I PIC  X(0003).
  3766*    -------------------------------
  3767     05  BBEN1L PIC S9(0004) COMP.
  3768     05  BBEN1F PIC  X(0001).
  3769     05  FILLER REDEFINES BBEN1F.
  3770         10  BBEN1A PIC  X(0001).
  3771     05  BBEN1I PIC  X(0012).
  3772*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  73
* EL6311.cbl
  3773     05  BPREM1L PIC S9(0004) COMP.
  3774     05  BPREM1F PIC  X(0001).
  3775     05  FILLER REDEFINES BPREM1F.
  3776         10  BPREM1A PIC  X(0001).
  3777     05  BPREM1I PIC  X(0011).
  3778*    -------------------------------
  3779     05  BEXPIR1L PIC S9(0004) COMP.
  3780     05  BEXPIR1F PIC  X(0001).
  3781     05  FILLER REDEFINES BEXPIR1F.
  3782         10  BEXPIR1A PIC  X(0001).
  3783     05  BEXPIR1I PIC  X(0008).
  3784*    -------------------------------
  3785     05  BCP1L PIC S9(0004) COMP.
  3786     05  BCP1F PIC  X(0001).
  3787     05  FILLER REDEFINES BCP1F.
  3788         10  BCP1A PIC  X(0001).
  3789     05  BCP1I PIC  X(0002).
  3790*    -------------------------------
  3791     05  BALTBN1L PIC S9(0004) COMP.
  3792     05  BALTBN1F PIC  X(0001).
  3793     05  FILLER REDEFINES BALTBN1F.
  3794         10  BALTBN1A PIC  X(0001).
  3795     05  BALTBN1I PIC  X(0012).
  3796*    -------------------------------
  3797     05  BALTPR1L PIC S9(0004) COMP.
  3798     05  BALTPR1F PIC  X(0001).
  3799     05  FILLER REDEFINES BALTPR1F.
  3800         10  BALTPR1A PIC  X(0001).
  3801     05  BALTPR1I PIC  X(0011).
  3802*    -------------------------------
  3803     05  BBNCD1L PIC S9(0004) COMP.
  3804     05  BBNCD1F PIC  X(0001).
  3805     05  FILLER REDEFINES BBNCD1F.
  3806         10  BBNCD1A PIC  X(0001).
  3807     05  BBNCD1I PIC  X(0003).
  3808*    -------------------------------
  3809     05  BCPRM1L PIC S9(0004) COMP.
  3810     05  BCPRM1F PIC  X(0001).
  3811     05  FILLER REDEFINES BCPRM1F.
  3812         10  BCPRM1A PIC  X(0001).
  3813     05  BCPRM1I PIC  X(0011).
  3814*    -------------------------------
  3815     05  BCAPRM1L PIC S9(0004) COMP.
  3816     05  BCAPRM1F PIC  X(0001).
  3817     05  FILLER REDEFINES BCAPRM1F.
  3818         10  BCAPRM1A PIC  X(0001).
  3819     05  BCAPRM1I PIC  X(0011).
  3820*    -------------------------------
  3821     05  BENABR1L PIC S9(0004) COMP.
  3822     05  BENABR1F PIC  X(0001).
  3823     05  FILLER REDEFINES BENABR1F.
  3824         10  BENABR1A PIC  X(0001).
  3825     05  BENABR1I PIC  X(0005).
  3826*    -------------------------------
  3827     05  BDIFF1L PIC S9(0004) COMP.
  3828     05  BDIFF1F PIC  X(0001).
  3829     05  FILLER REDEFINES BDIFF1F.
  3830         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  74
* EL6311.cbl
  3831     05  BDIFF1I PIC  X(0011).
  3832*    -------------------------------
  3833     05  BBILIT1L PIC S9(0004) COMP.
  3834     05  BBILIT1F PIC  X(0001).
  3835     05  FILLER REDEFINES BBILIT1F.
  3836         10  BBILIT1A PIC  X(0001).
  3837     05  BBILIT1I PIC  X(0008).
  3838*    -------------------------------
  3839     05  BADIFF1L PIC S9(0004) COMP.
  3840     05  BADIFF1F PIC  X(0001).
  3841     05  FILLER REDEFINES BADIFF1F.
  3842         10  BADIFF1A PIC  X(0001).
  3843     05  BADIFF1I PIC  X(0011).
  3844*    -------------------------------
  3845     05  BKIND2L PIC S9(0004) COMP.
  3846     05  BKIND2F PIC  X(0001).
  3847     05  FILLER REDEFINES BKIND2F.
  3848         10  BKIND2A PIC  X(0001).
  3849     05  BKIND2I PIC  X(0002).
  3850*    -------------------------------
  3851     05  BTYPE2L PIC S9(0004) COMP.
  3852     05  BTYPE2F PIC  X(0001).
  3853     05  FILLER REDEFINES BTYPE2F.
  3854         10  BTYPE2A PIC  X(0001).
  3855     05  BTYPE2I PIC  X(0003).
  3856*    -------------------------------
  3857     05  BTERM2L PIC S9(0004) COMP.
  3858     05  BTERM2F PIC  X(0001).
  3859     05  FILLER REDEFINES BTERM2F.
  3860         10  BTERM2A PIC  X(0001).
  3861     05  BTERM2I PIC  X(0003).
  3862*    -------------------------------
  3863     05  BBEN2L PIC S9(0004) COMP.
  3864     05  BBEN2F PIC  X(0001).
  3865     05  FILLER REDEFINES BBEN2F.
  3866         10  BBEN2A PIC  X(0001).
  3867     05  BBEN2I PIC  X(0012).
  3868*    -------------------------------
  3869     05  BPREM2L PIC S9(0004) COMP.
  3870     05  BPREM2F PIC  X(0001).
  3871     05  FILLER REDEFINES BPREM2F.
  3872         10  BPREM2A PIC  X(0001).
  3873     05  BPREM2I PIC  X(0011).
  3874*    -------------------------------
  3875     05  BEXPIR2L PIC S9(0004) COMP.
  3876     05  BEXPIR2F PIC  X(0001).
  3877     05  FILLER REDEFINES BEXPIR2F.
  3878         10  BEXPIR2A PIC  X(0001).
  3879     05  BEXPIR2I PIC  X(0008).
  3880*    -------------------------------
  3881     05  BCP2L PIC S9(0004) COMP.
  3882     05  BCP2F PIC  X(0001).
  3883     05  FILLER REDEFINES BCP2F.
  3884         10  BCP2A PIC  X(0001).
  3885     05  BCP2I PIC  X(0002).
  3886*    -------------------------------
  3887     05  BALTBN2L PIC S9(0004) COMP.
  3888     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  75
* EL6311.cbl
  3889     05  FILLER REDEFINES BALTBN2F.
  3890         10  BALTBN2A PIC  X(0001).
  3891     05  BALTBN2I PIC  X(0012).
  3892*    -------------------------------
  3893     05  BALTPR2L PIC S9(0004) COMP.
  3894     05  BALTPR2F PIC  X(0001).
  3895     05  FILLER REDEFINES BALTPR2F.
  3896         10  BALTPR2A PIC  X(0001).
  3897     05  BALTPR2I PIC  X(0011).
  3898*    -------------------------------
  3899     05  BBNCD2L PIC S9(0004) COMP.
  3900     05  BBNCD2F PIC  X(0001).
  3901     05  FILLER REDEFINES BBNCD2F.
  3902         10  BBNCD2A PIC  X(0001).
  3903     05  BBNCD2I PIC  X(0003).
  3904*    -------------------------------
  3905     05  BCPRM2L PIC S9(0004) COMP.
  3906     05  BCPRM2F PIC  X(0001).
  3907     05  FILLER REDEFINES BCPRM2F.
  3908         10  BCPRM2A PIC  X(0001).
  3909     05  BCPRM2I PIC  X(0011).
  3910*    -------------------------------
  3911     05  BCAPRM2L PIC S9(0004) COMP.
  3912     05  BCAPRM2F PIC  X(0001).
  3913     05  FILLER REDEFINES BCAPRM2F.
  3914         10  BCAPRM2A PIC  X(0001).
  3915     05  BCAPRM2I PIC  X(0011).
  3916*    -------------------------------
  3917     05  BENABR2L PIC S9(0004) COMP.
  3918     05  BENABR2F PIC  X(0001).
  3919     05  FILLER REDEFINES BENABR2F.
  3920         10  BENABR2A PIC  X(0001).
  3921     05  BENABR2I PIC  X(0005).
  3922*    -------------------------------
  3923     05  BDIFF2L PIC S9(0004) COMP.
  3924     05  BDIFF2F PIC  X(0001).
  3925     05  FILLER REDEFINES BDIFF2F.
  3926         10  BDIFF2A PIC  X(0001).
  3927     05  BDIFF2I PIC  X(0011).
  3928*    -------------------------------
  3929     05  BBILIT2L PIC S9(0004) COMP.
  3930     05  BBILIT2F PIC  X(0001).
  3931     05  FILLER REDEFINES BBILIT2F.
  3932         10  BBILIT2A PIC  X(0001).
  3933     05  BBILIT2I PIC  X(0008).
  3934*    -------------------------------
  3935     05  BADIFF2L PIC S9(0004) COMP.
  3936     05  BADIFF2F PIC  X(0001).
  3937     05  FILLER REDEFINES BADIFF2F.
  3938         10  BADIFF2A PIC  X(0001).
  3939     05  BADIFF2I PIC  X(0011).
  3940*    -------------------------------
  3941     05  BERMSG1L PIC S9(0004) COMP.
  3942     05  BERMSG1F PIC  X(0001).
  3943     05  FILLER REDEFINES BERMSG1F.
  3944         10  BERMSG1A PIC  X(0001).
  3945     05  BERMSG1I PIC  X(0078).
  3946*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  76
* EL6311.cbl
  3947     05  BERMSG2L PIC S9(0004) COMP.
  3948     05  BERMSG2F PIC  X(0001).
  3949     05  FILLER REDEFINES BERMSG2F.
  3950         10  BERMSG2A PIC  X(0001).
  3951     05  BERMSG2I PIC  X(0078).
  3952*    -------------------------------
  3953     05  BERMSG3L PIC S9(0004) COMP.
  3954     05  BERMSG3F PIC  X(0001).
  3955     05  FILLER REDEFINES BERMSG3F.
  3956         10  BERMSG3A PIC  X(0001).
  3957     05  BERMSG3I PIC  X(0078).
  3958*    -------------------------------
  3959     05  BPFENTRL PIC S9(0004) COMP.
  3960     05  BPFENTRF PIC  X(0001).
  3961     05  FILLER REDEFINES BPFENTRF.
  3962         10  BPFENTRA PIC  X(0001).
  3963     05  BPFENTRI PIC  9(2).
  3964*    -------------------------------
  3965     05  BPF5HDRL PIC S9(0004) COMP.
  3966     05  BPF5HDRF PIC  X(0001).
  3967     05  FILLER REDEFINES BPF5HDRF.
  3968         10  BPF5HDRA PIC  X(0001).
  3969     05  BPF5HDRI PIC  X(0005).
  3970*    -------------------------------
  3971     05  BPF4HDRL PIC S9(0004) COMP.
  3972     05  BPF4HDRF PIC  X(0001).
  3973     05  FILLER REDEFINES BPF4HDRF.
  3974         10  BPF4HDRA PIC  X(0001).
  3975     05  BPF4HDRI PIC  X(0013).
  3976*    -------------------------------
  3977     05  BF15HDRL PIC S9(0004) COMP.
  3978     05  BF15HDRF PIC  X(0001).
  3979     05  FILLER REDEFINES BF15HDRF.
  3980         10  BF15HDRA PIC  X(0001).
  3981     05  BF15HDRI PIC  X(0010).
  3982 01  EL631BO REDEFINES EL631BI.
  3983     05  FILLER            PIC  X(0012).
  3984*    -------------------------------
  3985     05  FILLER            PIC  X(0003).
  3986     05  BDATEO PIC  X(0008).
  3987*    -------------------------------
  3988     05  FILLER            PIC  X(0003).
  3989     05  BTIMEO PIC  99.99.
  3990*    -------------------------------
  3991     05  FILLER            PIC  X(0003).
  3992     05  BHEADO PIC  X(0038).
  3993*    -------------------------------
  3994     05  FILLER            PIC  X(0003).
  3995     05  BNCERTLO PIC  X(0008).
  3996*    -------------------------------
  3997     05  FILLER            PIC  X(0003).
  3998     05  BNCERTO PIC  X(0011).
  3999*    -------------------------------
  4000     05  FILLER            PIC  X(0003).
  4001     05  BNSTATLO PIC  X(0009).
  4002*    -------------------------------
  4003     05  FILLER            PIC  X(0003).
  4004     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  77
* EL6311.cbl
  4005*    -------------------------------
  4006     05  FILLER            PIC  X(0003).
  4007     05  BCHGTO PIC  X(0004).
  4008*    -------------------------------
  4009     05  FILLER            PIC  X(0003).
  4010     05  BCHGO PIC  ZZZ9.
  4011*    -------------------------------
  4012     05  FILLER            PIC  X(0003).
  4013     05  BMAINTO PIC  X(0001).
  4014*    -------------------------------
  4015     05  FILLER            PIC  X(0003).
  4016     05  BMANTBYO PIC  X(0004).
  4017*    -------------------------------
  4018     05  FILLER            PIC  X(0003).
  4019     05  BCHGHDGO PIC  X(0003).
  4020*    -------------------------------
  4021     05  FILLER            PIC  X(0003).
  4022     05  BMANTDTO PIC  X(0008).
  4023*    -------------------------------
  4024     05  FILLER            PIC  X(0003).
  4025     05  BMANTATO PIC  99.99.
  4026*    -------------------------------
  4027     05  FILLER            PIC  X(0003).
  4028     05  BCSRO PIC  X(0004).
  4029*    -------------------------------
  4030     05  FILLER            PIC  X(0003).
  4031     05  BBATCHO PIC  X(0006).
  4032*    -------------------------------
  4033     05  FILLER            PIC  X(0003).
  4034     05  BSEQO PIC  X(0004).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BMOENDTO PIC  X(0008).
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BCARRO PIC  X(0001).
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BGROUPO PIC  X(0006).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BSTATEO PIC  X(0002).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BACCTO PIC  X(0010).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BVINHO PIC  X(0004).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BVINO PIC  X(0017).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BREFHDGO PIC  X(0004).
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BREFO PIC  X(0012).
  4062*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  78
* EL6311.cbl
  4063     05  FILLER            PIC  X(0003).
  4064     05  BAGEDEFO PIC  X(0004).
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BCERTNOO PIC  X(0010).
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BSUFIXO PIC  X(0001).
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BEFFDTO PIC  X(0008).
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  BLSTNMO PIC  X(0015).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  B1STNMO PIC  X(0010).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  BINITO PIC  X(0001).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BSEXO PIC  X(0001).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BAGEO PIC  X(0002).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  BBIRTHO PIC  X(0008).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  B1STPMTO PIC  X(0008).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BDAYSO PIC  X(0003).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BLNTRMO PIC  X(0003).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BLNOFCRO PIC  X(0005).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BMODEO PIC  X(0001).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BFREQO PIC  X(0002).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BPMTSO PIC  X(0003).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BPMTAMTO PIC  ZZZZZ9.99.
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  BAPRO PIC  99.9999.
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  79
* EL6311.cbl
  4121     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BMEMCAPO PIC  X(0011).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BORIGHDO PIC  X(0009).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  DMDBILO PIC  X(0006).
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BFORCEO PIC  X(0001).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BENTRYO PIC  X(0001).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BREINO PIC  X(0001).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BBILCDO PIC  X(0001).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BUNWRITO PIC  X(0001).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BSKPCDO PIC  X(0001).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BINDGRPO PIC  X(0001).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BSIGO PIC  X(0001).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BRTCLSO PIC  X(0002).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BCHGCNTO PIC  X(0003).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BMEMBERO PIC  X(0012).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BORGNOO PIC  X(0006).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BORGSEQO PIC  X(0004).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BKIND1O PIC  X(0002).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  80
* EL6311.cbl
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BTERM1O PIC  X(0003).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BBEN1O PIC  X(0012).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BPREM1O PIC  X(0011).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BEXPIR1O PIC  X(0008).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BCP1O PIC  X(0002).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BALTBN1O PIC  X(0012).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BALTPR1O PIC  X(0011).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BBNCD1O PIC  X(0003).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BCPRM1O PIC  X(0011).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BCAPRM1O PIC  X(0011).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BENABR1O PIC  X(0005).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BDIFF1O PIC  X(0011).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BBILIT1O PIC  X(0008).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BADIFF1O PIC  X(0011).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BKIND2O PIC  X(0002).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BTYPE2O PIC  X(0003).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BTERM2O PIC  X(0003).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BBEN2O PIC  X(0012).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BPREM2O PIC  X(0011).
  4236*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  81
* EL6311.cbl
  4237     05  FILLER            PIC  X(0003).
  4238     05  BEXPIR2O PIC  X(0008).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BCP2O PIC  X(0002).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BALTBN2O PIC  X(0012).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BALTPR2O PIC  X(0011).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  BBNCD2O PIC  X(0003).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BCPRM2O PIC  X(0011).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BCAPRM2O PIC  X(0011).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BENABR2O PIC  X(0005).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BDIFF2O PIC  X(0011).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BBILIT2O PIC  X(0008).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  BADIFF2O PIC  X(0011).
  4269*    -------------------------------
  4270     05  FILLER            PIC  X(0003).
  4271     05  BERMSG1O PIC  X(0078).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
  4274     05  BERMSG2O PIC  X(0078).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
  4277     05  BERMSG3O PIC  X(0078).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BPFENTRO PIC  X(0002).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  BPF5HDRO PIC  X(0005).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  BPF4HDRO PIC  X(0013).
  4287*    -------------------------------
  4288     05  FILLER            PIC  X(0003).
  4289     05  BF15HDRO PIC  X(0010).
  4290*    -------------------------------
  4291 01  EL631CI REDEFINES EL631BI.
  4292     05  FILLER            PIC  X(0012).
  4293*    -------------------------------
  4294     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  82
* EL6311.cbl
  4295     05  CDATEF PIC  X(0001).
  4296     05  FILLER REDEFINES CDATEF.
  4297         10  CDATEA PIC  X(0001).
  4298     05  CDATEI PIC  X(0008).
  4299*    -------------------------------
  4300     05  CTIMEL PIC S9(0004) COMP.
  4301     05  CTIMEF PIC  X(0001).
  4302     05  FILLER REDEFINES CTIMEF.
  4303         10  CTIMEA PIC  X(0001).
  4304     05  CTIMEI PIC  X(0005).
  4305*    -------------------------------
  4306     05  CHEADL PIC S9(0004) COMP.
  4307     05  CHEADF PIC  X(0001).
  4308     05  FILLER REDEFINES CHEADF.
  4309         10  CHEADA PIC  X(0001).
  4310     05  CHEADI PIC  X(0038).
  4311*    -------------------------------
  4312     05  CCHGTL PIC S9(0004) COMP.
  4313     05  CCHGTF PIC  X(0001).
  4314     05  FILLER REDEFINES CCHGTF.
  4315         10  CCHGTA PIC  X(0001).
  4316     05  CCHGTI PIC  X(0004).
  4317*    -------------------------------
  4318     05  CCHGL PIC S9(0004) COMP.
  4319     05  CCHGF PIC  X(0001).
  4320     05  FILLER REDEFINES CCHGF.
  4321         10  CCHGA PIC  X(0001).
  4322     05  CCHGI PIC  X(0004).
  4323*    -------------------------------
  4324     05  CMAINTL PIC S9(0004) COMP.
  4325     05  CMAINTF PIC  X(0001).
  4326     05  FILLER REDEFINES CMAINTF.
  4327         10  CMAINTA PIC  X(0001).
  4328     05  CMAINTI PIC  X(0001).
  4329*    -------------------------------
  4330     05  CMANTBYL PIC S9(0004) COMP.
  4331     05  CMANTBYF PIC  X(0001).
  4332     05  FILLER REDEFINES CMANTBYF.
  4333         10  CMANTBYA PIC  X(0001).
  4334     05  CMANTBYI PIC  X(0004).
  4335*    -------------------------------
  4336     05  CCHGHDGL PIC S9(0004) COMP.
  4337     05  CCHGHDGF PIC  X(0001).
  4338     05  FILLER REDEFINES CCHGHDGF.
  4339         10  CCHGHDGA PIC  X(0001).
  4340     05  CCHGHDGI PIC  X(0003).
  4341*    -------------------------------
  4342     05  CMANTDTL PIC S9(0004) COMP.
  4343     05  CMANTDTF PIC  X(0001).
  4344     05  FILLER REDEFINES CMANTDTF.
  4345         10  CMANTDTA PIC  X(0001).
  4346     05  CMANTDTI PIC  X(0008).
  4347*    -------------------------------
  4348     05  CMANTATL PIC S9(0004) COMP.
  4349     05  CMANTATF PIC  X(0001).
  4350     05  FILLER REDEFINES CMANTATF.
  4351         10  CMANTATA PIC  X(0001).
  4352     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  83
* EL6311.cbl
  4353*    -------------------------------
  4354     05  CCSRL PIC S9(0004) COMP.
  4355     05  CCSRF PIC  X(0001).
  4356     05  FILLER REDEFINES CCSRF.
  4357         10  CCSRA PIC  X(0001).
  4358     05  CCSRI PIC  X(0004).
  4359*    -------------------------------
  4360     05  CBATCHL PIC S9(0004) COMP.
  4361     05  CBATCHF PIC  X(0001).
  4362     05  FILLER REDEFINES CBATCHF.
  4363         10  CBATCHA PIC  X(0001).
  4364     05  CBATCHI PIC  X(0006).
  4365*    -------------------------------
  4366     05  CSEQL PIC S9(0004) COMP.
  4367     05  CSEQF PIC  X(0001).
  4368     05  FILLER REDEFINES CSEQF.
  4369         10  CSEQA PIC  X(0001).
  4370     05  CSEQI PIC  X(0004).
  4371*    -------------------------------
  4372     05  CMOENDTL PIC S9(0004) COMP.
  4373     05  CMOENDTF PIC  X(0001).
  4374     05  FILLER REDEFINES CMOENDTF.
  4375         10  CMOENDTA PIC  X(0001).
  4376     05  CMOENDTI PIC  X(0008).
  4377*    -------------------------------
  4378     05  CCARRL PIC S9(0004) COMP.
  4379     05  CCARRF PIC  X(0001).
  4380     05  FILLER REDEFINES CCARRF.
  4381         10  CCARRA PIC  X(0001).
  4382     05  CCARRI PIC  X(0001).
  4383*    -------------------------------
  4384     05  CGROUPL PIC S9(0004) COMP.
  4385     05  CGROUPF PIC  X(0001).
  4386     05  FILLER REDEFINES CGROUPF.
  4387         10  CGROUPA PIC  X(0001).
  4388     05  CGROUPI PIC  X(0006).
  4389*    -------------------------------
  4390     05  CSTATEL PIC S9(0004) COMP.
  4391     05  CSTATEF PIC  X(0001).
  4392     05  FILLER REDEFINES CSTATEF.
  4393         10  CSTATEA PIC  X(0001).
  4394     05  CSTATEI PIC  X(0002).
  4395*    -------------------------------
  4396     05  CACCTL PIC S9(0004) COMP.
  4397     05  CACCTF PIC  X(0001).
  4398     05  FILLER REDEFINES CACCTF.
  4399         10  CACCTA PIC  X(0001).
  4400     05  CACCTI PIC  X(0010).
  4401*    -------------------------------
  4402     05  CORIGHDL PIC S9(0004) COMP.
  4403     05  CORIGHDF PIC  X(0001).
  4404     05  FILLER REDEFINES CORIGHDF.
  4405         10  CORIGHDA PIC  X(0001).
  4406     05  CORIGHDI PIC  X(0011).
  4407*    -------------------------------
  4408     05  CORGNOL PIC S9(0004) COMP.
  4409     05  CORGNOF PIC  X(0001).
  4410     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  84
* EL6311.cbl
  4411         10  CORGNOA PIC  X(0001).
  4412     05  CORGNOI PIC  X(0006).
  4413*    -------------------------------
  4414     05  CORGSEQL PIC S9(0004) COMP.
  4415     05  CORGSEQF PIC  X(0001).
  4416     05  FILLER REDEFINES CORGSEQF.
  4417         10  CORGSEQA PIC  X(0001).
  4418     05  CORGSEQI PIC  X(0004).
  4419*    -------------------------------
  4420     05  CREFHDGL PIC S9(0004) COMP.
  4421     05  CREFHDGF PIC  X(0001).
  4422     05  FILLER REDEFINES CREFHDGF.
  4423         10  CREFHDGA PIC  X(0001).
  4424     05  CREFHDGI PIC  X(0010).
  4425*    -------------------------------
  4426     05  CREFL PIC S9(0004) COMP.
  4427     05  CREFF PIC  X(0001).
  4428     05  FILLER REDEFINES CREFF.
  4429         10  CREFA PIC  X(0001).
  4430     05  CREFI PIC  X(0012).
  4431*    -------------------------------
  4432     05  CNHINTL PIC S9(0004) COMP.
  4433     05  CNHINTF PIC  X(0001).
  4434     05  FILLER REDEFINES CNHINTF.
  4435         10  CNHINTA PIC  X(0001).
  4436     05  CNHINTI PIC  9(7)V99.
  4437*    -------------------------------
  4438     05  CCERTNOL PIC S9(0004) COMP.
  4439     05  CCERTNOF PIC  X(0001).
  4440     05  FILLER REDEFINES CCERTNOF.
  4441         10  CCERTNOA PIC  X(0001).
  4442     05  CCERTNOI PIC  X(0010).
  4443*    -------------------------------
  4444     05  CSUFIXL PIC S9(0004) COMP.
  4445     05  CSUFIXF PIC  X(0001).
  4446     05  FILLER REDEFINES CSUFIXF.
  4447         10  CSUFIXA PIC  X(0001).
  4448     05  CSUFIXI PIC  X(0001).
  4449*    -------------------------------
  4450     05  CEFFDTL PIC S9(0004) COMP.
  4451     05  CEFFDTF PIC  X(0001).
  4452     05  FILLER REDEFINES CEFFDTF.
  4453         10  CEFFDTA PIC  X(0001).
  4454     05  CEFFDTI PIC  X(0008).
  4455*    -------------------------------
  4456     05  CLSTNML PIC S9(0004) COMP.
  4457     05  CLSTNMF PIC  X(0001).
  4458     05  FILLER REDEFINES CLSTNMF.
  4459         10  CLSTNMA PIC  X(0001).
  4460     05  CLSTNMI PIC  X(0015).
  4461*    -------------------------------
  4462     05  CPCYNL PIC S9(0004) COMP.
  4463     05  CPCYNF PIC  X(0001).
  4464     05  FILLER REDEFINES CPCYNF.
  4465         10  CPCYNA PIC  X(0001).
  4466     05  CPCYNI PIC  X(0001).
  4467*    -------------------------------
  4468     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  85
* EL6311.cbl
  4469     05  CINAMEF PIC  X(0001).
  4470     05  FILLER REDEFINES CINAMEF.
  4471         10  CINAMEA PIC  X(0001).
  4472     05  CINAMEI PIC  X(0015).
  4473*    -------------------------------
  4474     05  CINITSL PIC S9(0004) COMP.
  4475     05  CINITSF PIC  X(0001).
  4476     05  FILLER REDEFINES CINITSF.
  4477         10  CINITSA PIC  X(0001).
  4478     05  CINITSI PIC  X(0010).
  4479*    -------------------------------
  4480     05  CCANREAL PIC S9(0004) COMP.
  4481     05  CCANREAF PIC  X(0001).
  4482     05  FILLER REDEFINES CCANREAF.
  4483         10  CCANREAA PIC  X(0001).
  4484     05  CCANREAI PIC  X(0001).
  4485*    -------------------------------
  4486     05  CKIND1L PIC S9(0004) COMP.
  4487     05  CKIND1F PIC  X(0001).
  4488     05  FILLER REDEFINES CKIND1F.
  4489         10  CKIND1A PIC  X(0001).
  4490     05  CKIND1I PIC  X(0002).
  4491*    -------------------------------
  4492     05  CCANDT1L PIC S9(0004) COMP.
  4493     05  CCANDT1F PIC  X(0001).
  4494     05  FILLER REDEFINES CCANDT1F.
  4495         10  CCANDT1A PIC  X(0001).
  4496     05  CCANDT1I PIC  X(0008).
  4497*    -------------------------------
  4498     05  CREFND1L PIC S9(0004) COMP.
  4499     05  CREFND1F PIC  X(0001).
  4500     05  FILLER REDEFINES CREFND1F.
  4501         10  CREFND1A PIC  X(0001).
  4502     05  CREFND1I PIC  S9(9)V99.
  4503*    -------------------------------
  4504     05  CMTHD1L PIC S9(0004) COMP.
  4505     05  CMTHD1F PIC  X(0001).
  4506     05  FILLER REDEFINES CMTHD1F.
  4507         10  CMTHD1A PIC  X(0001).
  4508     05  CMTHD1I PIC  X(0001).
  4509*    -------------------------------
  4510     05  CKIND2L PIC S9(0004) COMP.
  4511     05  CKIND2F PIC  X(0001).
  4512     05  FILLER REDEFINES CKIND2F.
  4513         10  CKIND2A PIC  X(0001).
  4514     05  CKIND2I PIC  X(0002).
  4515*    -------------------------------
  4516     05  CCANDT2L PIC S9(0004) COMP.
  4517     05  CCANDT2F PIC  X(0001).
  4518     05  FILLER REDEFINES CCANDT2F.
  4519         10  CCANDT2A PIC  X(0001).
  4520     05  CCANDT2I PIC  X(0008).
  4521*    -------------------------------
  4522     05  CREFND2L PIC S9(0004) COMP.
  4523     05  CREFND2F PIC  X(0001).
  4524     05  FILLER REDEFINES CREFND2F.
  4525         10  CREFND2A PIC  X(0001).
  4526     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  86
* EL6311.cbl
  4527*    -------------------------------
  4528     05  CMTHD2L PIC S9(0004) COMP.
  4529     05  CMTHD2F PIC  X(0001).
  4530     05  FILLER REDEFINES CMTHD2F.
  4531         10  CMTHD2A PIC  X(0001).
  4532     05  CMTHD2I PIC  X(0001).
  4533*    -------------------------------
  4534     05  CLIVESL PIC S9(0004) COMP.
  4535     05  CLIVESF PIC  X(0001).
  4536     05  FILLER REDEFINES CLIVESF.
  4537         10  CLIVESA PIC  X(0001).
  4538     05  CLIVESI PIC  X(0003).
  4539*    -------------------------------
  4540     05  CFORCEL PIC S9(0004) COMP.
  4541     05  CFORCEF PIC  X(0001).
  4542     05  FILLER REDEFINES CFORCEF.
  4543         10  CFORCEA PIC  X(0001).
  4544     05  CFORCEI PIC  X(0001).
  4545*    -------------------------------
  4546     05  CBILCDL PIC S9(0004) COMP.
  4547     05  CBILCDF PIC  X(0001).
  4548     05  FILLER REDEFINES CBILCDF.
  4549         10  CBILCDA PIC  X(0001).
  4550     05  CBILCDI PIC  X(0001).
  4551*    -------------------------------
  4552     05  CCRFND1L PIC S9(0004) COMP.
  4553     05  CCRFND1F PIC  X(0001).
  4554     05  FILLER REDEFINES CCRFND1F.
  4555         10  CCRFND1A PIC  X(0001).
  4556     05  CCRFND1I PIC  X(0011).
  4557*    -------------------------------
  4558     05  CCRFND2L PIC S9(0004) COMP.
  4559     05  CCRFND2F PIC  X(0001).
  4560     05  FILLER REDEFINES CCRFND2F.
  4561         10  CCRFND2A PIC  X(0001).
  4562     05  CCRFND2I PIC  X(0011).
  4563*    -------------------------------
  4564     05  CBILIT1L PIC S9(0004) COMP.
  4565     05  CBILIT1F PIC  X(0001).
  4566     05  FILLER REDEFINES CBILIT1F.
  4567         10  CBILIT1A PIC  X(0001).
  4568     05  CBILIT1I PIC  X(0008).
  4569*    -------------------------------
  4570     05  CDRFND1L PIC S9(0004) COMP.
  4571     05  CDRFND1F PIC  X(0001).
  4572     05  FILLER REDEFINES CDRFND1F.
  4573         10  CDRFND1A PIC  X(0001).
  4574     05  CDRFND1I PIC  X(0011).
  4575*    -------------------------------
  4576     05  CBILIT2L PIC S9(0004) COMP.
  4577     05  CBILIT2F PIC  X(0001).
  4578     05  FILLER REDEFINES CBILIT2F.
  4579         10  CBILIT2A PIC  X(0001).
  4580     05  CBILIT2I PIC  X(0008).
  4581*    -------------------------------
  4582     05  CDRFND2L PIC S9(0004) COMP.
  4583     05  CDRFND2F PIC  X(0001).
  4584     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  87
* EL6311.cbl
  4585         10  CDRFND2A PIC  X(0001).
  4586     05  CDRFND2I PIC  X(0011).
  4587*    -------------------------------
  4588     05  CCANTXTL PIC S9(0004) COMP.
  4589     05  CCANTXTF PIC  X(0001).
  4590     05  FILLER REDEFINES CCANTXTF.
  4591         10  CCANTXTA PIC  X(0001).
  4592     05  CCANTXTI PIC  X(0005).
  4593*    -------------------------------
  4594     05  CCANFEEL PIC S9(0004) COMP.
  4595     05  CCANFEEF PIC  X(0001).
  4596     05  FILLER REDEFINES CCANFEEF.
  4597         10  CCANFEEA PIC  X(0001).
  4598     05  CCANFEEI PIC  X(0002).
  4599*    -------------------------------
  4600     05  CTERM1L PIC S9(0004) COMP.
  4601     05  CTERM1F PIC  X(0001).
  4602     05  FILLER REDEFINES CTERM1F.
  4603         10  CTERM1A PIC  X(0001).
  4604     05  CTERM1I PIC  X(0003).
  4605*    -------------------------------
  4606     05  CRTERM1L PIC S9(0004) COMP.
  4607     05  CRTERM1F PIC  X(0001).
  4608     05  FILLER REDEFINES CRTERM1F.
  4609         10  CRTERM1A PIC  X(0001).
  4610     05  CRTERM1I PIC  X(0003).
  4611*    -------------------------------
  4612     05  CPREM1L PIC S9(0004) COMP.
  4613     05  CPREM1F PIC  X(0001).
  4614     05  FILLER REDEFINES CPREM1F.
  4615         10  CPREM1A PIC  X(0001).
  4616     05  CPREM1I PIC  X(0011).
  4617*    -------------------------------
  4618     05  CTERM2L PIC S9(0004) COMP.
  4619     05  CTERM2F PIC  X(0001).
  4620     05  FILLER REDEFINES CTERM2F.
  4621         10  CTERM2A PIC  X(0001).
  4622     05  CTERM2I PIC  X(0003).
  4623*    -------------------------------
  4624     05  CRTERM2L PIC S9(0004) COMP.
  4625     05  CRTERM2F PIC  X(0001).
  4626     05  FILLER REDEFINES CRTERM2F.
  4627         10  CRTERM2A PIC  X(0001).
  4628     05  CRTERM2I PIC  X(0003).
  4629*    -------------------------------
  4630     05  CPREM2L PIC S9(0004) COMP.
  4631     05  CPREM2F PIC  X(0001).
  4632     05  FILLER REDEFINES CPREM2F.
  4633         10  CPREM2A PIC  X(0001).
  4634     05  CPREM2I PIC  X(0011).
  4635*    -------------------------------
  4636     05  CENTRDTL PIC S9(0004) COMP.
  4637     05  CENTRDTF PIC  X(0001).
  4638     05  FILLER REDEFINES CENTRDTF.
  4639         10  CENTRDTA PIC  X(0001).
  4640     05  CENTRDTI PIC  X(0008).
  4641*    -------------------------------
  4642     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  88
* EL6311.cbl
  4643     05  CPAYEEF PIC  X(0001).
  4644     05  FILLER REDEFINES CPAYEEF.
  4645         10  CPAYEEA PIC  X(0001).
  4646     05  CPAYEEI PIC  X(0006).
  4647*    -------------------------------
  4648     05  CRFNDSWL PIC S9(0004) COMP.
  4649     05  CRFNDSWF PIC  X(0001).
  4650     05  FILLER REDEFINES CRFNDSWF.
  4651         10  CRFNDSWA PIC  X(0001).
  4652     05  CRFNDSWI PIC  X(0003).
  4653*    -------------------------------
  4654     05  CLFHDGL PIC S9(0004) COMP.
  4655     05  CLFHDGF PIC  X(0001).
  4656     05  FILLER REDEFINES CLFHDGF.
  4657         10  CLFHDGA PIC  X(0001).
  4658     05  CLFHDGI PIC  X(0006).
  4659*    -------------------------------
  4660     05  CAHHDGL PIC S9(0004) COMP.
  4661     05  CAHHDGF PIC  X(0001).
  4662     05  FILLER REDEFINES CAHHDGF.
  4663         10  CAHHDGA PIC  X(0001).
  4664     05  CAHHDGI PIC  X(0006).
  4665*    -------------------------------
  4666     05  CENTDTL PIC S9(0004) COMP.
  4667     05  CENTDTF PIC  X(0001).
  4668     05  FILLER REDEFINES CENTDTF.
  4669         10  CENTDTA PIC  X(0001).
  4670     05  CENTDTI PIC  X(0008).
  4671*    -------------------------------
  4672     05  CENTBYL PIC S9(0004) COMP.
  4673     05  CENTBYF PIC  X(0001).
  4674     05  FILLER REDEFINES CENTBYF.
  4675         10  CENTBYA PIC  X(0001).
  4676     05  CENTBYI PIC  X(0004).
  4677*    -------------------------------
  4678     05  CCHGCNTL PIC S9(0004) COMP.
  4679     05  CCHGCNTF PIC  X(0001).
  4680     05  FILLER REDEFINES CCHGCNTF.
  4681         10  CCHGCNTA PIC  X(0001).
  4682     05  CCHGCNTI PIC  X(0003).
  4683*    -------------------------------
  4684     05  CLFREFNL PIC S9(0004) COMP.
  4685     05  CLFREFNF PIC  X(0001).
  4686     05  FILLER REDEFINES CLFREFNF.
  4687         10  CLFREFNA PIC  X(0001).
  4688     05  CLFREFNI PIC  X(0006).
  4689*    -------------------------------
  4690     05  CAHREFNL PIC S9(0004) COMP.
  4691     05  CAHREFNF PIC  X(0001).
  4692     05  FILLER REDEFINES CAHREFNF.
  4693         10  CAHREFNA PIC  X(0001).
  4694     05  CAHREFNI PIC  X(0006).
  4695*    -------------------------------
  4696     05  CREINCDL PIC S9(0004) COMP.
  4697     05  CREINCDF PIC  X(0001).
  4698     05  FILLER REDEFINES CREINCDF.
  4699         10  CREINCDA PIC  X(0001).
  4700     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  89
* EL6311.cbl
  4701*    -------------------------------
  4702     05  CAEFFDTL PIC S9(0004) COMP.
  4703     05  CAEFFDTF PIC  X(0001).
  4704     05  FILLER REDEFINES CAEFFDTF.
  4705         10  CAEFFDTA PIC  X(0001).
  4706     05  CAEFFDTI PIC  X(0008).
  4707*    -------------------------------
  4708     05  CAEXPDTL PIC S9(0004) COMP.
  4709     05  CAEXPDTF PIC  X(0001).
  4710     05  FILLER REDEFINES CAEXPDTF.
  4711         10  CAEXPDTA PIC  X(0001).
  4712     05  CAEXPDTI PIC  X(0008).
  4713*    -------------------------------
  4714     05  COMMLFL PIC S9(0004) COMP.
  4715     05  COMMLFF PIC  X(0001).
  4716     05  FILLER REDEFINES COMMLFF.
  4717         10  COMMLFA PIC  X(0001).
  4718     05  COMMLFI PIC  X(0006).
  4719*    -------------------------------
  4720     05  COMMAHL PIC S9(0004) COMP.
  4721     05  COMMAHF PIC  X(0001).
  4722     05  FILLER REDEFINES COMMAHF.
  4723         10  COMMAHA PIC  X(0001).
  4724     05  COMMAHI PIC  X(0006).
  4725*    -------------------------------
  4726     05  CERMSG1L PIC S9(0004) COMP.
  4727     05  CERMSG1F PIC  X(0001).
  4728     05  FILLER REDEFINES CERMSG1F.
  4729         10  CERMSG1A PIC  X(0001).
  4730     05  CERMSG1I PIC  X(0078).
  4731*    -------------------------------
  4732     05  CERMSG2L PIC S9(0004) COMP.
  4733     05  CERMSG2F PIC  X(0001).
  4734     05  FILLER REDEFINES CERMSG2F.
  4735         10  CERMSG2A PIC  X(0001).
  4736     05  CERMSG2I PIC  X(0078).
  4737*    -------------------------------
  4738     05  CERMSG3L PIC S9(0004) COMP.
  4739     05  CERMSG3F PIC  X(0001).
  4740     05  FILLER REDEFINES CERMSG3F.
  4741         10  CERMSG3A PIC  X(0001).
  4742     05  CERMSG3I PIC  X(0078).
  4743*    -------------------------------
  4744     05  CPFENTRL PIC S9(0004) COMP.
  4745     05  CPFENTRF PIC  X(0001).
  4746     05  FILLER REDEFINES CPFENTRF.
  4747         10  CPFENTRA PIC  X(0001).
  4748     05  CPFENTRI PIC  9(2).
  4749*    -------------------------------
  4750     05  CPF5HDRL PIC S9(0004) COMP.
  4751     05  CPF5HDRF PIC  X(0001).
  4752     05  FILLER REDEFINES CPF5HDRF.
  4753         10  CPF5HDRA PIC  X(0001).
  4754     05  CPF5HDRI PIC  X(0005).
  4755*    -------------------------------
  4756     05  CPF4HDRL PIC S9(0004) COMP.
  4757     05  CPF4HDRF PIC  X(0001).
  4758     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  90
* EL6311.cbl
  4759         10  CPF4HDRA PIC  X(0001).
  4760     05  CPF4HDRI PIC  X(0013).
  4761*    -------------------------------
  4762     05  CF15HDRL PIC S9(0004) COMP.
  4763     05  CF15HDRF PIC  X(0001).
  4764     05  FILLER REDEFINES CF15HDRF.
  4765         10  CF15HDRA PIC  X(0001).
  4766     05  CF15HDRI PIC  X(0022).
  4767 01  EL631CO REDEFINES EL631BI.
  4768     05  FILLER            PIC  X(0012).
  4769*    -------------------------------
  4770     05  FILLER            PIC  X(0003).
  4771     05  CDATEO PIC  X(0008).
  4772*    -------------------------------
  4773     05  FILLER            PIC  X(0003).
  4774     05  CTIMEO PIC  99.99.
  4775*    -------------------------------
  4776     05  FILLER            PIC  X(0003).
  4777     05  CHEADO PIC  X(0038).
  4778*    -------------------------------
  4779     05  FILLER            PIC  X(0003).
  4780     05  CCHGTO PIC  X(0004).
  4781*    -------------------------------
  4782     05  FILLER            PIC  X(0003).
  4783     05  CCHGO PIC  ZZZ9.
  4784*    -------------------------------
  4785     05  FILLER            PIC  X(0003).
  4786     05  CMAINTO PIC  X(0001).
  4787*    -------------------------------
  4788     05  FILLER            PIC  X(0003).
  4789     05  CMANTBYO PIC  X(0004).
  4790*    -------------------------------
  4791     05  FILLER            PIC  X(0003).
  4792     05  CCHGHDGO PIC  X(0003).
  4793*    -------------------------------
  4794     05  FILLER            PIC  X(0003).
  4795     05  CMANTDTO PIC  X(0008).
  4796*    -------------------------------
  4797     05  FILLER            PIC  X(0003).
  4798     05  CMANTATO PIC  99.99.
  4799*    -------------------------------
  4800     05  FILLER            PIC  X(0003).
  4801     05  CCSRO PIC  X(0004).
  4802*    -------------------------------
  4803     05  FILLER            PIC  X(0003).
  4804     05  CBATCHO PIC  X(0006).
  4805*    -------------------------------
  4806     05  FILLER            PIC  X(0003).
  4807     05  CSEQO PIC  X(0004).
  4808*    -------------------------------
  4809     05  FILLER            PIC  X(0003).
  4810     05  CMOENDTO PIC  X(0008).
  4811*    -------------------------------
  4812     05  FILLER            PIC  X(0003).
  4813     05  CCARRO PIC  X(0001).
  4814*    -------------------------------
  4815     05  FILLER            PIC  X(0003).
  4816     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  91
* EL6311.cbl
  4817*    -------------------------------
  4818     05  FILLER            PIC  X(0003).
  4819     05  CSTATEO PIC  X(0002).
  4820*    -------------------------------
  4821     05  FILLER            PIC  X(0003).
  4822     05  CACCTO PIC  X(0010).
  4823*    -------------------------------
  4824     05  FILLER            PIC  X(0003).
  4825     05  CORIGHDO PIC  X(0011).
  4826*    -------------------------------
  4827     05  FILLER            PIC  X(0003).
  4828     05  CORGNOO PIC  X(0006).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CORGSEQO PIC  X(0004).
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CREFHDGO PIC  X(0010).
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CREFO PIC  X(0012).
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CNHINTO PIC  999999.99.
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CCERTNOO PIC  X(0010).
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CSUFIXO PIC  X(0001).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CEFFDTO PIC  X(0008).
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CLSTNMO PIC  X(0015).
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CPCYNO PIC  X(0001).
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CINAMEO PIC  X(0015).
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CINITSO PIC  X(0010).
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CCANREAO PIC  X(0001).
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CKIND1O PIC  X(0002).
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CCANDT1O PIC  X(0008).
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CREFND1O PIC  Z(7).99-.
  4874*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  92
* EL6311.cbl
  4875     05  FILLER            PIC  X(0003).
  4876     05  CMTHD1O PIC  X(0001).
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CKIND2O PIC  X(0002).
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CCANDT2O PIC  X(0008).
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CREFND2O PIC  Z(7).99-.
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CMTHD2O PIC  X(0001).
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CLIVESO PIC  X(0003).
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CFORCEO PIC  X(0001).
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CBILCDO PIC  X(0001).
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CCRFND1O PIC  Z(7).99-.
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CCRFND2O PIC  Z(7).99-.
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CBILIT1O PIC  X(0008).
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CDRFND1O PIC  Z(7).99-.
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CBILIT2O PIC  X(0008).
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CDRFND2O PIC  Z(7).99-.
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CCANTXTO PIC  X(0005).
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CCANFEEO PIC  Z9.
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CTERM1O PIC  ZZ9.
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CRTERM1O PIC  ZZ9.
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  CPREM1O PIC  ZZZZZZ9.99-.
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  93
* EL6311.cbl
  4933     05  CTERM2O PIC  ZZ9.
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CRTERM2O PIC  ZZ9.
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CPREM2O PIC  ZZZZZZ9.99-.
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CENTRDTO PIC  X(0008).
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CPAYEEO PIC  X(0006).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CRFNDSWO PIC  X(0003).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CLFHDGO PIC  X(0006).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CAHHDGO PIC  X(0006).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CENTDTO PIC  X(0008).
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CENTBYO PIC  X(0004).
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CCHGCNTO PIC  X(0003).
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CLFREFNO PIC  X(0006).
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CAHREFNO PIC  X(0006).
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CREINCDO PIC  X(0003).
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CAEFFDTO PIC  X(0008).
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CAEXPDTO PIC  X(0008).
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  COMMLFO PIC  .99999.
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  COMMAHO PIC  .99999.
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CERMSG1O PIC  X(0078).
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  94
* EL6311.cbl
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CERMSG3O PIC  X(0078).
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CPFENTRO PIC  X(0002).
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CPF5HDRO PIC  X(0005).
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CPF4HDRO PIC  X(0013).
  5003*    -------------------------------
  5004     05  FILLER            PIC  X(0003).
  5005     05  CF15HDRO PIC  X(0022).
  5006*    -------------------------------
  5007 01  EL631DI REDEFINES EL631BI.
  5008     05  FILLER            PIC  X(0012).
  5009*    -------------------------------
  5010     05  DDATEL PIC S9(0004) COMP.
  5011     05  DDATEF PIC  X(0001).
  5012     05  FILLER REDEFINES DDATEF.
  5013         10  DDATEA PIC  X(0001).
  5014     05  DDATEI PIC  X(0008).
  5015*    -------------------------------
  5016     05  DTIMEL PIC S9(0004) COMP.
  5017     05  DTIMEF PIC  X(0001).
  5018     05  FILLER REDEFINES DTIMEF.
  5019         10  DTIMEA PIC  X(0001).
  5020     05  DTIMEI PIC  X(0005).
  5021*    -------------------------------
  5022     05  DHEADL PIC S9(0004) COMP.
  5023     05  DHEADF PIC  X(0001).
  5024     05  FILLER REDEFINES DHEADF.
  5025         10  DHEADA PIC  X(0001).
  5026     05  DHEADI PIC  X(0038).
  5027*    -------------------------------
  5028     05  DLDATEL PIC S9(0004) COMP.
  5029     05  DLDATEF PIC  X(0001).
  5030     05  FILLER REDEFINES DLDATEF.
  5031         10  DLDATEA PIC  X(0001).
  5032     05  DLDATEI PIC  X(0010).
  5033*    -------------------------------
  5034     05  DBATCHL PIC S9(0004) COMP.
  5035     05  DBATCHF PIC  X(0001).
  5036     05  FILLER REDEFINES DBATCHF.
  5037         10  DBATCHA PIC  X(0001).
  5038     05  DBATCHI PIC  X(0011).
  5039*    -------------------------------
  5040     05  DACCTNML PIC S9(0004) COMP.
  5041     05  DACCTNMF PIC  X(0001).
  5042     05  FILLER REDEFINES DACCTNMF.
  5043         10  DACCTNMA PIC  X(0001).
  5044     05  DACCTNMI PIC  X(0030).
  5045*    -------------------------------
  5046     05  DPROCDTL PIC S9(0004) COMP.
  5047     05  DPROCDTF PIC  X(0001).
  5048     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  95
* EL6311.cbl
  5049         10  DPROCDTA PIC  X(0001).
  5050     05  DPROCDTI PIC  X(0008).
  5051*    -------------------------------
  5052     05  DINPUTL PIC S9(0004) COMP.
  5053     05  DINPUTF PIC  X(0001).
  5054     05  FILLER REDEFINES DINPUTF.
  5055         10  DINPUTA PIC  X(0001).
  5056     05  DINPUTI PIC  X(0008).
  5057*    -------------------------------
  5058     05  DMAINDTL PIC S9(0004) COMP.
  5059     05  DMAINDTF PIC  X(0001).
  5060     05  FILLER REDEFINES DMAINDTF.
  5061         10  DMAINDTA PIC  X(0001).
  5062     05  DMAINDTI PIC  X(0008).
  5063*    -------------------------------
  5064     05  DCARRL PIC S9(0004) COMP.
  5065     05  DCARRF PIC  X(0001).
  5066     05  FILLER REDEFINES DCARRF.
  5067         10  DCARRA PIC  X(0001).
  5068     05  DCARRI PIC  X(0001).
  5069*    -------------------------------
  5070     05  DGROUPL PIC S9(0004) COMP.
  5071     05  DGROUPF PIC  X(0001).
  5072     05  FILLER REDEFINES DGROUPF.
  5073         10  DGROUPA PIC  X(0001).
  5074     05  DGROUPI PIC  X(0006).
  5075*    -------------------------------
  5076     05  DSTATEL PIC S9(0004) COMP.
  5077     05  DSTATEF PIC  X(0001).
  5078     05  FILLER REDEFINES DSTATEF.
  5079         10  DSTATEA PIC  X(0001).
  5080     05  DSTATEI PIC  X(0002).
  5081*    -------------------------------
  5082     05  DACCTL PIC S9(0004) COMP.
  5083     05  DACCTF PIC  X(0001).
  5084     05  FILLER REDEFINES DACCTF.
  5085         10  DACCTA PIC  X(0001).
  5086     05  DACCTI PIC  X(0010).
  5087*    -------------------------------
  5088     05  DRECVDTL PIC S9(0004) COMP.
  5089     05  DRECVDTF PIC  X(0001).
  5090     05  FILLER REDEFINES DRECVDTF.
  5091         10  DRECVDTA PIC  X(0001).
  5092     05  DRECVDTI PIC  X(0008).
  5093*    -------------------------------
  5094     05  DCSRL PIC S9(0004) COMP.
  5095     05  DCSRF PIC  X(0001).
  5096     05  FILLER REDEFINES DCSRF.
  5097         10  DCSRA PIC  X(0001).
  5098     05  DCSRI PIC  X(0004).
  5099*    -------------------------------
  5100     05  DREFHDGL PIC S9(0004) COMP.
  5101     05  DREFHDGF PIC  X(0001).
  5102     05  FILLER REDEFINES DREFHDGF.
  5103         10  DREFHDGA PIC  X(0001).
  5104     05  DREFHDGI PIC  X(0010).
  5105*    -------------------------------
  5106     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  96
* EL6311.cbl
  5107     05  DREFF PIC  X(0001).
  5108     05  FILLER REDEFINES DREFF.
  5109         10  DREFA PIC  X(0001).
  5110     05  DREFI PIC  X(0012).
  5111*    -------------------------------
  5112     05  DLFPHDGL PIC S9(0004) COMP.
  5113     05  DLFPHDGF PIC  X(0001).
  5114     05  FILLER REDEFINES DLFPHDGF.
  5115         10  DLFPHDGA PIC  X(0001).
  5116     05  DLFPHDGI PIC  X(0010).
  5117*    -------------------------------
  5118     05  DAHPHDGL PIC S9(0004) COMP.
  5119     05  DAHPHDGF PIC  X(0001).
  5120     05  FILLER REDEFINES DAHPHDGF.
  5121         10  DAHPHDGA PIC  X(0001).
  5122     05  DAHPHDGI PIC  X(0010).
  5123*    -------------------------------
  5124     05  DLFRHDGL PIC S9(0004) COMP.
  5125     05  DLFRHDGF PIC  X(0001).
  5126     05  FILLER REDEFINES DLFRHDGF.
  5127         10  DLFRHDGA PIC  X(0001).
  5128     05  DLFRHDGI PIC  X(0009).
  5129*    -------------------------------
  5130     05  DAHRHDGL PIC S9(0004) COMP.
  5131     05  DAHRHDGF PIC  X(0001).
  5132     05  FILLER REDEFINES DAHRHDGF.
  5133         10  DAHRHDGA PIC  X(0001).
  5134     05  DAHRHDGI PIC  X(0009).
  5135*    -------------------------------
  5136     05  DRISSL PIC S9(0004) COMP.
  5137     05  DRISSF PIC  X(0001).
  5138     05  FILLER REDEFINES DRISSF.
  5139         10  DRISSA PIC  X(0001).
  5140     05  DRISSI PIC  X(0005).
  5141*    -------------------------------
  5142     05  DRLFPRML PIC S9(0004) COMP.
  5143     05  DRLFPRMF PIC  X(0001).
  5144     05  FILLER REDEFINES DRLFPRMF.
  5145         10  DRLFPRMA PIC  X(0001).
  5146     05  DRLFPRMI PIC  S9(9)V99.
  5147*    -------------------------------
  5148     05  DRAHPRML PIC S9(0004) COMP.
  5149     05  DRAHPRMF PIC  X(0001).
  5150     05  FILLER REDEFINES DRAHPRMF.
  5151         10  DRAHPRMA PIC  X(0001).
  5152     05  DRAHPRMI PIC  S9(9)V99.
  5153*    -------------------------------
  5154     05  DRCANCL PIC S9(0004) COMP.
  5155     05  DRCANCF PIC  X(0001).
  5156     05  FILLER REDEFINES DRCANCF.
  5157         10  DRCANCA PIC  X(0001).
  5158     05  DRCANCI PIC  X(0005).
  5159*    -------------------------------
  5160     05  DRLFRFDL PIC S9(0004) COMP.
  5161     05  DRLFRFDF PIC  X(0001).
  5162     05  FILLER REDEFINES DRLFRFDF.
  5163         10  DRLFRFDA PIC  X(0001).
  5164     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  97
* EL6311.cbl
  5165*    -------------------------------
  5166     05  DRAHRFDL PIC S9(0004) COMP.
  5167     05  DRAHRFDF PIC  X(0001).
  5168     05  FILLER REDEFINES DRAHRFDF.
  5169         10  DRAHRFDA PIC  X(0001).
  5170     05  DRAHRFDI PIC  S9(9)V99.
  5171*    -------------------------------
  5172     05  DEISSL PIC S9(0004) COMP.
  5173     05  DEISSF PIC  X(0001).
  5174     05  FILLER REDEFINES DEISSF.
  5175         10  DEISSA PIC  X(0001).
  5176     05  DEISSI PIC  X(0005).
  5177*    -------------------------------
  5178     05  DELFPRML PIC S9(0004) COMP.
  5179     05  DELFPRMF PIC  X(0001).
  5180     05  FILLER REDEFINES DELFPRMF.
  5181         10  DELFPRMA PIC  X(0001).
  5182     05  DELFPRMI PIC  X(0011).
  5183*    -------------------------------
  5184     05  DEAHPRML PIC S9(0004) COMP.
  5185     05  DEAHPRMF PIC  X(0001).
  5186     05  FILLER REDEFINES DEAHPRMF.
  5187         10  DEAHPRMA PIC  X(0001).
  5188     05  DEAHPRMI PIC  X(0011).
  5189*    -------------------------------
  5190     05  DECANCL PIC S9(0004) COMP.
  5191     05  DECANCF PIC  X(0001).
  5192     05  FILLER REDEFINES DECANCF.
  5193         10  DECANCA PIC  X(0001).
  5194     05  DECANCI PIC  X(0005).
  5195*    -------------------------------
  5196     05  DELFRFDL PIC S9(0004) COMP.
  5197     05  DELFRFDF PIC  X(0001).
  5198     05  FILLER REDEFINES DELFRFDF.
  5199         10  DELFRFDA PIC  X(0001).
  5200     05  DELFRFDI PIC  X(0011).
  5201*    -------------------------------
  5202     05  DEAHRFDL PIC S9(0004) COMP.
  5203     05  DEAHRFDF PIC  X(0001).
  5204     05  FILLER REDEFINES DEAHRFDF.
  5205         10  DEAHRFDA PIC  X(0001).
  5206     05  DEAHRFDI PIC  X(0011).
  5207*    -------------------------------
  5208     05  DCISSL PIC S9(0004) COMP.
  5209     05  DCISSF PIC  X(0001).
  5210     05  FILLER REDEFINES DCISSF.
  5211         10  DCISSA PIC  X(0001).
  5212     05  DCISSI PIC  X(0005).
  5213*    -------------------------------
  5214     05  DCLFPRML PIC S9(0004) COMP.
  5215     05  DCLFPRMF PIC  X(0001).
  5216     05  FILLER REDEFINES DCLFPRMF.
  5217         10  DCLFPRMA PIC  X(0001).
  5218     05  DCLFPRMI PIC  X(0011).
  5219*    -------------------------------
  5220     05  DCAHPRML PIC S9(0004) COMP.
  5221     05  DCAHPRMF PIC  X(0001).
  5222     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  98
* EL6311.cbl
  5223         10  DCAHPRMA PIC  X(0001).
  5224     05  DCAHPRMI PIC  X(0011).
  5225*    -------------------------------
  5226     05  DCCANCL PIC S9(0004) COMP.
  5227     05  DCCANCF PIC  X(0001).
  5228     05  FILLER REDEFINES DCCANCF.
  5229         10  DCCANCA PIC  X(0001).
  5230     05  DCCANCI PIC  X(0005).
  5231*    -------------------------------
  5232     05  DCLFRFDL PIC S9(0004) COMP.
  5233     05  DCLFRFDF PIC  X(0001).
  5234     05  FILLER REDEFINES DCLFRFDF.
  5235         10  DCLFRFDA PIC  X(0001).
  5236     05  DCLFRFDI PIC  X(0011).
  5237*    -------------------------------
  5238     05  DCAHRFDL PIC S9(0004) COMP.
  5239     05  DCAHRFDF PIC  X(0001).
  5240     05  FILLER REDEFINES DCAHRFDF.
  5241         10  DCAHRFDA PIC  X(0001).
  5242     05  DCAHRFDI PIC  X(0011).
  5243*    -------------------------------
  5244     05  DOISSL PIC S9(0004) COMP.
  5245     05  DOISSF PIC  X(0001).
  5246     05  FILLER REDEFINES DOISSF.
  5247         10  DOISSA PIC  X(0001).
  5248     05  DOISSI PIC  X(0005).
  5249*    -------------------------------
  5250     05  DOLFPRML PIC S9(0004) COMP.
  5251     05  DOLFPRMF PIC  X(0001).
  5252     05  FILLER REDEFINES DOLFPRMF.
  5253         10  DOLFPRMA PIC  X(0001).
  5254     05  DOLFPRMI PIC  X(0011).
  5255*    -------------------------------
  5256     05  DOAHPRML PIC S9(0004) COMP.
  5257     05  DOAHPRMF PIC  X(0001).
  5258     05  FILLER REDEFINES DOAHPRMF.
  5259         10  DOAHPRMA PIC  X(0001).
  5260     05  DOAHPRMI PIC  X(0011).
  5261*    -------------------------------
  5262     05  DOCANCL PIC S9(0004) COMP.
  5263     05  DOCANCF PIC  X(0001).
  5264     05  FILLER REDEFINES DOCANCF.
  5265         10  DOCANCA PIC  X(0001).
  5266     05  DOCANCI PIC  X(0005).
  5267*    -------------------------------
  5268     05  DOLFRFDL PIC S9(0004) COMP.
  5269     05  DOLFRFDF PIC  X(0001).
  5270     05  FILLER REDEFINES DOLFRFDF.
  5271         10  DOLFRFDA PIC  X(0001).
  5272     05  DOLFRFDI PIC  X(0011).
  5273*    -------------------------------
  5274     05  DOAHRFDL PIC S9(0004) COMP.
  5275     05  DOAHRFDF PIC  X(0001).
  5276     05  FILLER REDEFINES DOAHRFDF.
  5277         10  DOAHRFDA PIC  X(0001).
  5278     05  DOAHRFDI PIC  X(0011).
  5279*    -------------------------------
  5280     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page  99
* EL6311.cbl
  5281     05  DITOTALF PIC  X(0001).
  5282     05  FILLER REDEFINES DITOTALF.
  5283         10  DITOTALA PIC  X(0001).
  5284     05  DITOTALI PIC  X(0005).
  5285*    -------------------------------
  5286     05  DIFATALL PIC S9(0004) COMP.
  5287     05  DIFATALF PIC  X(0001).
  5288     05  FILLER REDEFINES DIFATALF.
  5289         10  DIFATALA PIC  X(0001).
  5290     05  DIFATALI PIC  X(0005).
  5291*    -------------------------------
  5292     05  DIFORCEL PIC S9(0004) COMP.
  5293     05  DIFORCEF PIC  X(0001).
  5294     05  FILLER REDEFINES DIFORCEF.
  5295         10  DIFORCEA PIC  X(0001).
  5296     05  DIFORCEI PIC  X(0005).
  5297*    -------------------------------
  5298     05  DIHOLDL PIC S9(0004) COMP.
  5299     05  DIHOLDF PIC  X(0001).
  5300     05  FILLER REDEFINES DIHOLDF.
  5301         10  DIHOLDA PIC  X(0001).
  5302     05  DIHOLDI PIC  X(0005).
  5303*    -------------------------------
  5304     05  DIAVAILL PIC S9(0004) COMP.
  5305     05  DIAVAILF PIC  X(0001).
  5306     05  FILLER REDEFINES DIAVAILF.
  5307         10  DIAVAILA PIC  X(0001).
  5308     05  DIAVAILI PIC  X(0005).
  5309*    -------------------------------
  5310     05  DIGPREML PIC S9(0004) COMP.
  5311     05  DIGPREMF PIC  X(0001).
  5312     05  FILLER REDEFINES DIGPREMF.
  5313         10  DIGPREMA PIC  X(0001).
  5314     05  DIGPREMI PIC  X(0011).
  5315*    -------------------------------
  5316     05  DIBPREML PIC S9(0004) COMP.
  5317     05  DIBPREMF PIC  X(0001).
  5318     05  FILLER REDEFINES DIBPREMF.
  5319         10  DIBPREMA PIC  X(0001).
  5320     05  DIBPREMI PIC  X(0011).
  5321*    -------------------------------
  5322     05  DCTOTALL PIC S9(0004) COMP.
  5323     05  DCTOTALF PIC  X(0001).
  5324     05  FILLER REDEFINES DCTOTALF.
  5325         10  DCTOTALA PIC  X(0001).
  5326     05  DCTOTALI PIC  X(0005).
  5327*    -------------------------------
  5328     05  DCFATALL PIC S9(0004) COMP.
  5329     05  DCFATALF PIC  X(0001).
  5330     05  FILLER REDEFINES DCFATALF.
  5331         10  DCFATALA PIC  X(0001).
  5332     05  DCFATALI PIC  X(0005).
  5333*    -------------------------------
  5334     05  DCFORCEL PIC S9(0004) COMP.
  5335     05  DCFORCEF PIC  X(0001).
  5336     05  FILLER REDEFINES DCFORCEF.
  5337         10  DCFORCEA PIC  X(0001).
  5338     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 100
* EL6311.cbl
  5339*    -------------------------------
  5340     05  DCHOLDL PIC S9(0004) COMP.
  5341     05  DCHOLDF PIC  X(0001).
  5342     05  FILLER REDEFINES DCHOLDF.
  5343         10  DCHOLDA PIC  X(0001).
  5344     05  DCHOLDI PIC  X(0005).
  5345*    -------------------------------
  5346     05  DCAVAILL PIC S9(0004) COMP.
  5347     05  DCAVAILF PIC  X(0001).
  5348     05  FILLER REDEFINES DCAVAILF.
  5349         10  DCAVAILA PIC  X(0001).
  5350     05  DCAVAILI PIC  X(0005).
  5351*    -------------------------------
  5352     05  DCGPREML PIC S9(0004) COMP.
  5353     05  DCGPREMF PIC  X(0001).
  5354     05  FILLER REDEFINES DCGPREMF.
  5355         10  DCGPREMA PIC  X(0001).
  5356     05  DCGPREMI PIC  X(0011).
  5357*    -------------------------------
  5358     05  DCBPREML PIC S9(0004) COMP.
  5359     05  DCBPREMF PIC  X(0001).
  5360     05  FILLER REDEFINES DCBPREMF.
  5361         10  DCBPREMA PIC  X(0001).
  5362     05  DCBPREMI PIC  X(0011).
  5363*    -------------------------------
  5364     05  DNTOTALL PIC S9(0004) COMP.
  5365     05  DNTOTALF PIC  X(0001).
  5366     05  FILLER REDEFINES DNTOTALF.
  5367         10  DNTOTALA PIC  X(0001).
  5368     05  DNTOTALI PIC  X(0005).
  5369*    -------------------------------
  5370     05  DNFATALL PIC S9(0004) COMP.
  5371     05  DNFATALF PIC  X(0001).
  5372     05  FILLER REDEFINES DNFATALF.
  5373         10  DNFATALA PIC  X(0001).
  5374     05  DNFATALI PIC  X(0005).
  5375*    -------------------------------
  5376     05  DNFORCEL PIC S9(0004) COMP.
  5377     05  DNFORCEF PIC  X(0001).
  5378     05  FILLER REDEFINES DNFORCEF.
  5379         10  DNFORCEA PIC  X(0001).
  5380     05  DNFORCEI PIC  X(0005).
  5381*    -------------------------------
  5382     05  DNHOLDL PIC S9(0004) COMP.
  5383     05  DNHOLDF PIC  X(0001).
  5384     05  FILLER REDEFINES DNHOLDF.
  5385         10  DNHOLDA PIC  X(0001).
  5386     05  DNHOLDI PIC  X(0005).
  5387*    -------------------------------
  5388     05  DNAVAILL PIC S9(0004) COMP.
  5389     05  DNAVAILF PIC  X(0001).
  5390     05  FILLER REDEFINES DNAVAILF.
  5391         10  DNAVAILA PIC  X(0001).
  5392     05  DNAVAILI PIC  X(0005).
  5393*    -------------------------------
  5394     05  DNGPREML PIC S9(0004) COMP.
  5395     05  DNGPREMF PIC  X(0001).
  5396     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 101
* EL6311.cbl
  5397         10  DNGPREMA PIC  X(0001).
  5398     05  DNGPREMI PIC  X(0011).
  5399*    -------------------------------
  5400     05  DNBPREML PIC S9(0004) COMP.
  5401     05  DNBPREMF PIC  X(0001).
  5402     05  FILLER REDEFINES DNBPREMF.
  5403         10  DNBPREMA PIC  X(0001).
  5404     05  DNBPREMI PIC  X(0011).
  5405*    -------------------------------
  5406     05  DERMSGL PIC S9(0004) COMP.
  5407     05  DERMSGF PIC  X(0001).
  5408     05  FILLER REDEFINES DERMSGF.
  5409         10  DERMSGA PIC  X(0001).
  5410     05  DERMSGI PIC  X(0075).
  5411*    -------------------------------
  5412     05  DPFENTRL PIC S9(0004) COMP.
  5413     05  DPFENTRF PIC  X(0001).
  5414     05  FILLER REDEFINES DPFENTRF.
  5415         10  DPFENTRA PIC  X(0001).
  5416     05  DPFENTRI PIC  9(2).
  5417 01  EL631DO REDEFINES EL631BI.
  5418     05  FILLER            PIC  X(0012).
  5419*    -------------------------------
  5420     05  FILLER            PIC  X(0003).
  5421     05  DDATEO PIC  X(0008).
  5422*    -------------------------------
  5423     05  FILLER            PIC  X(0003).
  5424     05  DTIMEO PIC  99.99.
  5425*    -------------------------------
  5426     05  FILLER            PIC  X(0003).
  5427     05  DHEADO PIC  X(0038).
  5428*    -------------------------------
  5429     05  FILLER            PIC  X(0003).
  5430     05  DLDATEO PIC  X(0010).
  5431*    -------------------------------
  5432     05  FILLER            PIC  X(0003).
  5433     05  DBATCHO PIC  X(0011).
  5434*    -------------------------------
  5435     05  FILLER            PIC  X(0003).
  5436     05  DACCTNMO PIC  X(0030).
  5437*    -------------------------------
  5438     05  FILLER            PIC  X(0003).
  5439     05  DPROCDTO PIC  X(0008).
  5440*    -------------------------------
  5441     05  FILLER            PIC  X(0003).
  5442     05  DINPUTO PIC  X(0008).
  5443*    -------------------------------
  5444     05  FILLER            PIC  X(0003).
  5445     05  DMAINDTO PIC  X(0008).
  5446*    -------------------------------
  5447     05  FILLER            PIC  X(0003).
  5448     05  DCARRO PIC  X(0001).
  5449*    -------------------------------
  5450     05  FILLER            PIC  X(0003).
  5451     05  DGROUPO PIC  X(0006).
  5452*    -------------------------------
  5453     05  FILLER            PIC  X(0003).
  5454     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 102
* EL6311.cbl
  5455*    -------------------------------
  5456     05  FILLER            PIC  X(0003).
  5457     05  DACCTO PIC  X(0010).
  5458*    -------------------------------
  5459     05  FILLER            PIC  X(0003).
  5460     05  DRECVDTO PIC  X(0008).
  5461*    -------------------------------
  5462     05  FILLER            PIC  X(0003).
  5463     05  DCSRO PIC  X(0004).
  5464*    -------------------------------
  5465     05  FILLER            PIC  X(0003).
  5466     05  DREFHDGO PIC  X(0010).
  5467*    -------------------------------
  5468     05  FILLER            PIC  X(0003).
  5469     05  DREFO PIC  X(0012).
  5470*    -------------------------------
  5471     05  FILLER            PIC  X(0003).
  5472     05  DLFPHDGO PIC  X(0010).
  5473*    -------------------------------
  5474     05  FILLER            PIC  X(0003).
  5475     05  DAHPHDGO PIC  X(0010).
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DLFRHDGO PIC  X(0009).
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DAHRHDGO PIC  X(0009).
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DRISSO PIC  ZZ99-.
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DRCANCO PIC  ZZ99-.
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DEISSO PIC  ZZ99-.
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DECANCO PIC  ZZ99-.
  5512*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 103
* EL6311.cbl
  5513     05  FILLER            PIC  X(0003).
  5514     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DCISSO PIC  ZZ99-.
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DCCANCO PIC  ZZ99-.
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DOISSO PIC  ZZ99-.
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DOCANCO PIC  ZZ99-.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DITOTALO PIC  ZZZ99.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DIFATALO PIC  ZZZ99.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DIFORCEO PIC  ZZZ99.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DIHOLDO PIC  ZZZ99.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DIAVAILO PIC  ZZZ99.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 104
* EL6311.cbl
  5571     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5575*    -------------------------------
  5576     05  FILLER            PIC  X(0003).
  5577     05  DCTOTALO PIC  ZZZ99.
  5578*    -------------------------------
  5579     05  FILLER            PIC  X(0003).
  5580     05  DCFATALO PIC  ZZZ99.
  5581*    -------------------------------
  5582     05  FILLER            PIC  X(0003).
  5583     05  DCFORCEO PIC  ZZZ99.
  5584*    -------------------------------
  5585     05  FILLER            PIC  X(0003).
  5586     05  DCHOLDO PIC  ZZZ99.
  5587*    -------------------------------
  5588     05  FILLER            PIC  X(0003).
  5589     05  DCAVAILO PIC  ZZZ99.
  5590*    -------------------------------
  5591     05  FILLER            PIC  X(0003).
  5592     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5593*    -------------------------------
  5594     05  FILLER            PIC  X(0003).
  5595     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5596*    -------------------------------
  5597     05  FILLER            PIC  X(0003).
  5598     05  DNTOTALO PIC  ---99.
  5599*    -------------------------------
  5600     05  FILLER            PIC  X(0003).
  5601     05  DNFATALO PIC  ---99.
  5602*    -------------------------------
  5603     05  FILLER            PIC  X(0003).
  5604     05  DNFORCEO PIC  ---99.
  5605*    -------------------------------
  5606     05  FILLER            PIC  X(0003).
  5607     05  DNHOLDO PIC  ---99.
  5608*    -------------------------------
  5609     05  FILLER            PIC  X(0003).
  5610     05  DNAVAILO PIC  ---99.
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DNGPREMO PIC  -------9.99.
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DNBPREMO PIC  -------9.99.
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DERMSGO PIC  X(0075).
  5620*    -------------------------------
  5621     05  FILLER            PIC  X(0003).
  5622     05  DPFENTRO PIC  X(0002).
  5623*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 105
* EL6311.cbl
  5625 01  MAP-B REDEFINES EL631BI.
  5626     12  FILLER                  PIC X(569).
  5627*    12  FILLER                  PIC X(512).
  5628*    12  FILLER                  PIC X(510).
  5629     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5630         16  BKIND-LEN               PIC S9(4)  COMP.
  5631         16  BKIND-ATTRB             PIC X.
  5632         16  BKIND                   PIC XX.
  5633         16  BTYPE-LEN               PIC S9(4)  COMP.
  5634         16  BTYPE-ATTRB             PIC X.
  5635         16  BTYPE                   PIC X(3).
  5636         16  BTERM-LEN               PIC S9(4)  COMP.
  5637         16  BTERM-ATTRB             PIC X.
  5638         16  BTERMI                  PIC 999.
  5639         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5640         16  BBEN-LEN                PIC S9(4)  COMP.
  5641         16  BBEN-ATTRB              PIC X.
  5642         16  BBENI                   PIC 9(10)V99.
  5643*        16  BBENI                   PIC 9(12).
  5644         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5645         16  BPREM-LEN               PIC S9(4)  COMP.
  5646         16  BPREM-ATTRB             PIC X.
  5647         16  BPREMI                  PIC S9(9)V99.
  5648*        16  BPREMI                  PIC 9(11).
  5649         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5650         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5651         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5652         16  BEXPIRE-ATTRB           PIC X.
  5653         16  BEXPIRE                 PIC X(8).
  5654         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5655         16  BCRIT-PERD-ATTRB        PIC X.
  5656         16  BCRIT-PERDI             PIC 99.
  5657         16  BCRIT-PERDO REDEFINES
  5658                         BCRIT-PERDI PIC ZZ.
  5659         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5660         16  BALT-BEN-ATTRB          PIC X.
  5661         16  BALT-BENI               PIC 9(10)V99.
  5662*        16  BALT-BENI               PIC 9(12).
  5663         16  BALT-BENO REDEFINES
  5664                           BALT-BENI PIC Z(9).ZZ.
  5665         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5666         16  BALT-PREM-ATTRB         PIC X.
  5667         16  BALT-PREMI              PIC 9(9)V99.
  5668*        16  BALT-PREMI              PIC 9(11).
  5669         16  BALT-PREMO REDEFINES
  5670                          BALT-PREMI PIC Z(7).ZZ-.
  5671         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5672         16  BBEN-CD-ATTRB           PIC X.
  5673         16  BBEN-CD                 PIC XXX.
  5674         16  BCPREM-LEN              PIC S9(4)  COMP.
  5675         16  BCPREM-ATTRB            PIC X.
  5676         16  BCPREMI                 PIC S9(9)V99.
  5677*        16  BCPREMI                 PIC X(11).
  5678         16  BCPREMO REDEFINES BCPREMI
  5679                                     PIC Z(7).99-.
  5680         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5681         16  BCALT-PREM-ATTRB        PIC X.
  5682         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 106
* EL6311.cbl
  5683         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5684         16  BBEN-ABBR-ATTRB         PIC X.
  5685         16  BBEN-ABBR               PIC X(5).
  5686         16  BDIFF-LEN               PIC S9(4)  COMP.
  5687         16  BDIFF-ATTRB             PIC X.
  5688         16  BDIFFO                  PIC Z(7).99-.
  5689         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5690         16  BBILL-LIT-ATTRB         PIC X.
  5691         16  BBILL-LIT               PIC X(8).
  5692         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5693         16  BDALT-PREM-ATTRB        PIC X.
  5694         16  BDALT-PREM              PIC Z(7).99-.
  5695
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 107
* EL6311.cbl
  5697
  5698****************************************************************
  5699*
  5700* Copyright (c) 2007 by Clerity Solutions, Inc.
  5701* All rights reserved.
  5702*
  5703****************************************************************
  5704 01  DFHEIV.
  5705   02  DFHEIV0               PIC X(35).
  5706   02  DFHEIV1               PIC X(08).
  5707   02  DFHEIV2               PIC X(08).
  5708   02  DFHEIV3               PIC X(08).
  5709   02  DFHEIV4               PIC X(06).
  5710   02  DFHEIV5               PIC X(04).
  5711   02  DFHEIV6               PIC X(04).
  5712   02  DFHEIV7               PIC X(02).
  5713   02  DFHEIV8               PIC X(02).
  5714   02  DFHEIV9               PIC X(01).
  5715   02  DFHEIV10              PIC S9(7) COMP-3.
  5716   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5717   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5718   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5719   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5720   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5721   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5722   02  DFHEIV17              PIC X(04).
  5723   02  DFHEIV18              PIC X(04).
  5724   02  DFHEIV19              PIC X(04).
  5725   02  DFHEIV20              USAGE IS POINTER.
  5726   02  DFHEIV21              USAGE IS POINTER.
  5727   02  DFHEIV22              USAGE IS POINTER.
  5728   02  DFHEIV23              USAGE IS POINTER.
  5729   02  DFHEIV24              USAGE IS POINTER.
  5730   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5731   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5732   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5733   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5734   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5735   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5736   02  FILLER                PIC X(02).
  5737   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5738   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5739   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5740   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5741   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5742 LINKAGE  SECTION.
  5743*****************************************************************
  5744*                                                               *
  5745* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5746* All rights reserved.                                          *
  5747*                                                               *
  5748*****************************************************************
  5749 01  dfheiblk.
  5750     02  eibtime          pic s9(7) comp-3.
  5751     02  eibdate          pic s9(7) comp-3.
  5752     02  eibtrnid         pic x(4).
  5753     02  eibtaskn         pic s9(7) comp-3.
  5754     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 108
* EL6311.cbl
  5755     02  dfheigdi         pic s9(4) comp.
  5756     02  eibcposn         pic s9(4) comp.
  5757     02  eibcalen         pic s9(4) comp.
  5758     02  eibaid           pic x(1).
  5759     02  eibfiller1       pic x(1).
  5760     02  eibfn            pic x(2).
  5761     02  eibfiller2       pic x(2).
  5762     02  eibrcode         pic x(6).
  5763     02  eibfiller3       pic x(2).
  5764     02  eibds            pic x(8).
  5765     02  eibreqid         pic x(8).
  5766     02  eibrsrce         pic x(8).
  5767     02  eibsync          pic x(1).
  5768     02  eibfree          pic x(1).
  5769     02  eibrecv          pic x(1).
  5770     02  eibsend          pic x(1).
  5771     02  eibatt           pic x(1).
  5772     02  eibeoc           pic x(1).
  5773     02  eibfmh           pic x(1).
  5774     02  eibcompl         pic x(1).
  5775     02  eibsig           pic x(1).
  5776     02  eibconf          pic x(1).
  5777     02  eiberr           pic x(1).
  5778     02  eibrldbk         pic x(1).
  5779     02  eiberrcd         pic x(4).
  5780     02  eibsynrb         pic x(1).
  5781     02  eibnodat         pic x(1).
  5782     02  eibfiller5       pic x(2).
  5783     02  eibresp          pic 9(09) comp.
  5784     02  eibresp2         pic 9(09) comp.
  5785     02  dfheigdj         pic s9(4) comp.
  5786     02  dfheigdk         pic s9(4) comp.
  5787 01  DFHCOMMAREA                 PIC X(1300).
  5788*                                COPY ERCPNDB.
  5789******************************************************************
  5790*                                                                *
  5791*                                                                *
  5792*                            ERCPNDB.                            *
  5793*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5794*                            VMOD=2.025                          *
  5795*                                                                *
  5796*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5797*                                                                *
  5798******************************************************************
  5799*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5800*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5801******************************************************************
  5802*                                                                *
  5803*                                                                *
  5804*   FILE TYPE = VSAM,KSDS                                        *
  5805*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5806*                                                                *
  5807*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5808*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5809*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5810*                                                 RKP=13,LEN=36  *
  5811*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5812*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 109
* EL6311.cbl
  5813*                                                RKP=49,LEN=11   *
  5814*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5815*                                      AND CHG-SEQ.)             *
  5816*                                                RKP=60,LEN=15   *
  5817*                                                                *
  5818*   LOG = NO                                                     *
  5819*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5820******************************************************************
  5821******************************************************************
  5822*                   C H A N G E   L O G
  5823*
  5824* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5825*-----------------------------------------------------------------
  5826*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5827* EFFECTIVE    NUMBER
  5828*-----------------------------------------------------------------
  5829* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5830* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5831* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5832* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5833* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5834* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5835* 032306                   PEMA  ADD BOW LOAN NUMBER
  5836* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5837* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5838* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5839* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5840* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5841* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5842* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5843* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5844******************************************************************
  5845
  5846 01  PENDING-BUSINESS.
  5847     12  PB-RECORD-ID                     PIC XX.
  5848         88  VALID-PB-ID                        VALUE 'PB'.
  5849
  5850     12  PB-CONTROL-PRIMARY.
  5851         16  PB-COMPANY-CD                PIC X.
  5852         16  PB-ENTRY-BATCH               PIC X(6).
  5853         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5854         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5855
  5856     12  PB-CONTROL-BY-ACCOUNT.
  5857         16  PB-COMPANY-CD-A1             PIC X.
  5858         16  PB-CARRIER                   PIC X.
  5859         16  PB-GROUPING.
  5860             20  PB-GROUPING-PREFIX       PIC XXX.
  5861             20  PB-GROUPING-PRIME        PIC XXX.
  5862         16  PB-STATE                     PIC XX.
  5863         16  PB-ACCOUNT.
  5864             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5865             20  PB-ACCOUNT-PRIME         PIC X(6).
  5866         16  PB-CERT-EFF-DT               PIC XX.
  5867         16  PB-CERT-NO.
  5868             20  PB-CERT-PRIME            PIC X(10).
  5869             20  PB-CERT-SFX              PIC X.
  5870         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 110
* EL6311.cbl
  5871
  5872         16  PB-RECORD-TYPE               PIC X.
  5873             88  PB-MAILING-DATA                VALUE '0'.
  5874             88  PB-ISSUE                       VALUE '1'.
  5875             88  PB-CANCELLATION                VALUE '2'.
  5876             88  PB-BATCH-TRAILER               VALUE '9'.
  5877
  5878     12  PB-CONTROL-BY-ORIG-BATCH.
  5879         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5880         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5881         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5882         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5883
  5884     12  PB-CONTROL-BY-CSR.
  5885         16  PB-CSR-COMPANY-CD            PIC X.
  5886         16  PB-CSR-ID                    PIC X(4).
  5887         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5888         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5889         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5890******************************************************************
  5891*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5892******************************************************************
  5893
  5894     12  PB-LAST-MAINT-DT                 PIC XX.
  5895     12  PB-LAST-MAINT-BY                 PIC X(4).
  5896     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5897
  5898     12  PB-RECORD-BODY                   PIC X(375).
  5899
  5900     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5901         16  PB-CERT-ORIGIN               PIC X.
  5902             88  CLASIC-CREATED-CERT         VALUE '1'.
  5903         16  PB-I-NAME.
  5904             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5905             20  PB-I-INSURED-FIRST-NAME.
  5906                 24  PB-I-INSURED-1ST-INIT PIC X.
  5907                 24  FILLER                PIC X(9).
  5908             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5909         16  PB-I-AGE                     PIC S99   COMP-3.
  5910         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5911         16  PB-I-BIRTHDAY                PIC XX.
  5912         16  PB-I-INSURED-SEX             PIC X.
  5913             88  PB-SEX-MALE     VALUE 'M'.
  5914             88  PB-SEX-FEMALE   VALUE 'F'.
  5915
  5916         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5917         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5918         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5919         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5920         16  PB-I-SKIP-CODE               PIC X.
  5921             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5922             88  PB-SKIP-JULY              VALUE '1'.
  5923             88  PB-SKIP-AUGUST            VALUE '2'.
  5924             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5925             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5926             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5927             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5928             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 111
* EL6311.cbl
  5929             88  PB-SKIP-JUNE              VALUE '8'.
  5930             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5931             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5932             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5933         16  PB-I-TERM-TYPE               PIC X.
  5934             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5935             88  PB-PAID-WEEKLY            VALUE 'W'.
  5936             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5937             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5938             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5939         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5940         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5941         16  PB-I-DATA-ENTRY-SW           PIC X.
  5942             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5943             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5944             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5945             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5946         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5947         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5948*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5949         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5950         16  FILLER                       PIC X.
  5951
  5952         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5953             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5954             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5955                                                   '90' THRU '99'.
  5956         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5957                                          PIC XX.
  5958         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5959         16  PB-I-AMOUNT-FINANCED REDEFINES
  5960                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5961         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5962         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5963                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5964         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5965         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5966         16  PB-I-CLP-AMOUNT REDEFINES
  5967                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5968         16  PB-I-LF-CALC-FLAG            PIC X.
  5969             88 PB-COMP-LF-PREM               VALUE '?'.
  5970         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5971         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5972         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5973         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5974         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5975         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5976         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5977         16  PB-I-LF-ABBR                 PIC XXX.
  5978         16  PB-I-LF-INPUT-CD             PIC XX.
  5979
  5980         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5981             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5982             88  PB-INVALID-AH               VALUE '  ' '00'
  5983                                                   '90' THRU '99'.
  5984         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5985         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5986         16  PB-I-AH-CALC-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 112
* EL6311.cbl
  5987             88 PB-COMP-AH-PREM                  VALUE '?'.
  5988         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5989         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5990         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5991         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5992         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5993         16  PB-I-AH-ABBR                 PIC XXX.
  5994         16  PB-I-AH-INPUT-CD             PIC XXX.
  5995
  5996         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5997         16  PB-I-REIN-TABLE              PIC XXX.
  5998         16  PB-I-BUSINESS-TYPE           PIC 99.
  5999         16  PB-I-INDV-GRP-CD             PIC X.
  6000         16  PB-I-MORT-CODE.
  6001             20  PB-I-TABLE               PIC X.
  6002             20  PB-I-INTEREST            PIC XX.
  6003             20  PB-I-MORT-TYP            PIC X.
  6004         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6005         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6006         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6007         16  PB-I-INDV-GRP-OVRD           PIC X.
  6008         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6009         16  PB-I-SIG-SW                  PIC X.
  6010             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6011         16  PB-I-RATE-CLASS              PIC XX.
  6012         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6013         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6014         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6015         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6016         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6017         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6018         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6019         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6020         16  PB-I-OB-FLAG                 PIC X.
  6021             88  PB-I-OB                      VALUE 'B'.
  6022             88  PB-I-SUMMARY                 VALUE 'Z'.
  6023         16  PB-I-ENTRY-STATUS            PIC X.
  6024             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6025                                              'M' '5' '9' '2'.
  6026             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6027             88  PB-I-POLICY-PENDING          VALUE '2'.
  6028             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6029             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6030             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6031             88  PB-I-REIN-ONLY               VALUE '9'.
  6032             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6033             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6034             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6035             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6036         16  PB-I-INT-CODE                PIC X.
  6037             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6038             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6039         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6040         16  PB-I-SOC-SEC-NO              PIC X(11).
  6041         16  PB-I-MEMBER-NO               PIC X(12).
  6042         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6043*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6044         16  PB-I-OLD-LOF                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 113
* EL6311.cbl
  6045         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6046         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6047         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6048         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6049         16  PB-I-LIFE-INDICATOR          PIC X.
  6050             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6051         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6052         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6053                                          PIC S9(5)V99    COMP-3.
  6054         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6055             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6056             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6057         16  PB-I-1ST-PMT-DT              PIC XX.
  6058         16  PB-I-JOINT-INSURED.
  6059             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6060             20 PB-I-JOINT-FIRST-NAME.
  6061                24  PB-I-JOINT-FIRST-INIT PIC X.
  6062                24  FILLER                PIC X(9).
  6063             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6064*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6065         16  PB-I-BENEFICIARY-NAME.
  6066             20  PB-I-BANK-NUMBER         PIC X(10).
  6067             20  FILLER                   PIC X(15).
  6068         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6069         16  PB-I-REFERENCE               PIC X(12).
  6070         16  FILLER REDEFINES PB-I-REFERENCE.
  6071             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6072             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6073             20  PB-I-CLP-STATE           PIC XX.
  6074         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6075             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6076             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6077             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6078         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6079         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6080         16  PB-I-RESIDENT-STATE          PIC XX.
  6081         16  PB-I-RATE-CODE               PIC X(4).
  6082         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6083         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6084         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6085         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6086         16  PB-I-BANK-NOCHRGB            PIC 99.
  6087         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6088         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6089
  6090     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6091         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6092             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6093         16  PB-C-CANCEL-ORIGIN           PIC X.
  6094             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6095         16  PB-C-LF-CANCEL-DT            PIC XX.
  6096         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6097         16  PB-C-LF-CALC-REQ             PIC X.
  6098             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6099         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6100         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6101         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6102             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 114
* EL6311.cbl
  6103         16  PB-C-AH-CANCEL-DT            PIC XX.
  6104         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6105         16  PB-C-AH-CALC-REQ             PIC X.
  6106             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6107         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6108         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6109         16  PB-C-LAST-NAME               PIC X(15).
  6110         16  PB-C-REFUND-SW               PIC X.
  6111             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6112             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6113         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6114         16  PB-C-PAYEE-CODE              PIC X(6).
  6115         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6116         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6117         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6118         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6119         16  PB-C-REFERENCE               PIC X(12).
  6120         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6121         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6122         16  PB-C-POST-CARD-IND           PIC X.
  6123         16  PB-C-CANCEL-REASON           PIC X.
  6124         16  PB-C-REF-INTERFACE-SW        PIC X.
  6125         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6126         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6127         16  FILLER                       PIC X(01).
  6128*        16  FILLER                       PIC X(18).
  6129         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6130*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6131         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6132         16  PB-CANCELED-CERT-DATA.
  6133             20  PB-CI-INSURED-NAME.
  6134                 24  PB-CI-LAST-NAME      PIC X(15).
  6135                 24  PB-CI-INITIALS       PIC XX.
  6136             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6137             20  PB-CI-INSURED-SEX        PIC X.
  6138             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6139             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6140             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6141             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6142             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6143             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6144             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6145             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6146             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6147             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6148             20  PB-CI-RATE-CLASS         PIC XX.
  6149             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6150             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6151             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6152             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6153             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6154             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6155             20  PB-CI-LF-ABBR            PIC X(3).
  6156             20  PB-CI-AH-ABBR            PIC X(3).
  6157             20  PB-CI-OB-FLAG            PIC X.
  6158                 88  PB-CI-OB                VALUE 'B'.
  6159             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6160                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 115
* EL6311.cbl
  6161                                           'M' '4' '5' '9' '2'.
  6162                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6163                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6164                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6165                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6166                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6167                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6168                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6169                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6170                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6171                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6172                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6173                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6174             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6175                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6176                                           'M' '4' '5' '9' '2'.
  6177                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6178                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6179                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6180                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6181                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6182                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6183                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6184                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6185                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6186                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6187                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6188                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6189             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6190             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6191             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6192             20  PB-CI-MEMBER-NO          PIC X(12).
  6193             20  PB-CI-INT-CODE           PIC X.
  6194                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6195                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6196             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6197             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6198             20  PB-CI-COMP-EXCP-SW       PIC X.
  6199                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6200                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6201             20  PB-CI-ENTRY-STATUS       PIC X.
  6202             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6203             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6204             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6205             20  PB-CI-DEATH-DT           PIC XX.
  6206             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6207             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6208             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6209             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6210             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6211             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6212             20  PB-CI-ENTRY-DT              PIC XX.
  6213             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6214             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6215             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6216             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6217             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6218             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 116
* EL6311.cbl
  6219*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6220             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6221             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6222             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6223             20  PB-CI-INDV-GRP-CD           PIC X.
  6224             20  PB-CI-BENEFICIARY-NAME.
  6225                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6226                 24  FILLER                  PIC X(15).
  6227             20  PB-CI-NOTE-SW               PIC X.
  6228             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6229             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6230             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6231             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6232             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6233             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6234             20  PB-CI-FIRST-NAME            PIC X(10).
  6235             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6236
  6237         16  FILLER                       PIC X(13).
  6238*032306  16  FILLER                       PIC X(27).
  6239*        16  FILLER                       PIC X(46).
  6240
  6241     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6242         16  FILLER                       PIC X(10).
  6243         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6244         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6245         16  PB-M-INSURED-MID-INIT        PIC X.
  6246         16  PB-M-INSURED-AGE             PIC 99.
  6247         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6248         16  PB-M-INSURED-SEX             PIC X.
  6249         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6250         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6251         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6252         16  PB-M-INSURED-CITY-STATE.
  6253             20  PB-M-INSURED-CITY        PIC X(28).
  6254             20  PB-M-INSURED-STATE       PIC XX.
  6255         16  PB-M-INSURED-ZIP-CODE.
  6256             20  PB-M-INSURED-ZIP-PRIME.
  6257                 24  PB-M-INSURED-ZIP-1   PIC X.
  6258                     88  PB-M-CANADIAN-POST-CODE
  6259                                             VALUE 'A' THRU 'Z'.
  6260                 24  FILLER               PIC X(4).
  6261             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6262         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6263                                        PB-M-INSURED-ZIP-CODE.
  6264             20  PM-M-INS-CAN-POST1       PIC XXX.
  6265             20  PM-M-INS-CAN-POST2       PIC XXX.
  6266             20  FILLER                   PIC XXX.
  6267         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6268         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6269         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6270         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6271         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6272         16  PB-M-CRED-BENE-CITYST.
  6273             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6274             20  PB-M-CRED-BENE-STATE     PIC XX.
  6275         16  FILLER                       PIC X(92).
  6276
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 117
* EL6311.cbl
  6277     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6278         16  FILLER                       PIC X(10).
  6279         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6280         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6281         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6282         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6283         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6284         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6285         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6286         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6287         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6288         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6289         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6290         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6291         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6292         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6293         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6294         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6295         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6296         16  PB-ACCOUNT-NAME              PIC X(30).
  6297         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6298         16  PB-REFERENCE                 PIC X(12).
  6299         16  PB-B-RECEIVED-DT             PIC XX.
  6300         16  FILLER                       PIC X(234).
  6301
  6302     12  PB-RECORD-STATUS.
  6303         16  PB-CREDIT-SELECT-DT          PIC XX.
  6304         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6305         16  PB-BILLED-DT                 PIC XX.
  6306         16  PB-BILLING-STATUS            PIC X.
  6307             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6308             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6309             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6310         16  PB-RECORD-BILL               PIC X.
  6311             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6312             88  PB-RECORD-RETURNED           VALUE 'R'.
  6313             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6314             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6315             88  PB-OVERRIDE-AH               VALUE 'A'.
  6316             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6317         16  PB-BATCH-ENTRY               PIC X.
  6318             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6319             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6320             88  PB-REISSUED-CERT             VALUE 'E'.
  6321             88  PB-MONTHLY-CERT              VALUE 'M'.
  6322             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6323             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6324             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6325         16  PB-FORCE-CODE                PIC X.
  6326             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6327             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6328             88  PB-CANCEL-FORCE              VALUE '8'.
  6329             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6330             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6331             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6332             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6333             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6334             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 118
* EL6311.cbl
  6335             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6336         16  PB-FATAL-FLAG                PIC X.
  6337             88  PB-FATAL-ERRORS              VALUE 'X'.
  6338         16  PB-FORCE-ER-CD               PIC X.
  6339             88  PB-FORCE-ERRORS              VALUE 'F'.
  6340             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6341         16  PB-WARN-ER-CD                PIC X.
  6342             88  PB-WARNING-ERRORS            VALUE 'W'.
  6343         16  FILLER                       PIC X.
  6344         16  PB-OUT-BAL-CD                PIC X.
  6345             88  PB-OUT-OF-BAL                VALUE 'O'.
  6346         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6347         16  PB-AH-OVERRIDE-L1            PIC X.
  6348         16  PB-INPUT-DT                  PIC XX.
  6349         16  PB-INPUT-BY                  PIC X(4).
  6350         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6351         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6352         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6353         16  PB-LF-EARNING-METHOD         PIC X.
  6354         16  PB-AH-EARNING-METHOD         PIC X.
  6355         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6356         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6357         16  PB-REIN-CD                   PIC XXX.
  6358         16  PB-LF-REFUND-TYPE            PIC X.
  6359         16  PB-AH-REFUND-TYPE            PIC X.
  6360         16  PB-ACCT-EFF-DT               PIC XX.
  6361         16  PB-ACCT-EXP-DT               PIC XX.
  6362         16  PB-COMPANY-ID                PIC X(3).
  6363         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6364         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6365         16  PB-SV-CARRIER                PIC X.
  6366         16  PB-SV-GROUPING               PIC X(6).
  6367         16  PB-SV-STATE                  PIC XX.
  6368         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6369         16  PB-GA-BILLING-INFO.
  6370             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6371                                          PIC XX.
  6372         16  PB-SV-REMIT-TO  REDEFINES
  6373             PB-GA-BILLING-INFO           PIC X(10).
  6374         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6375         16  PB-I-LOAN-OFFICER            PIC X(5).
  6376         16  PB-I-VIN                     PIC X(17).
  6377
  6378         16  FILLER                       PIC X(04).
  6379         16  IMNET-BYPASS-SW              PIC X.
  6380
  6381******************************************************************
  6382*                COMMON EDIT ERRORS                              *
  6383******************************************************************
  6384
  6385     12  PB-COMMON-ERRORS.
  6386         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6387                                           PIC S9(4)     COMP.
  6388
  6389******************************************************************
  6390*                                COPY ELCCERT.
  6391******************************************************************
  6392*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 119
* EL6311.cbl
  6393*                            ELCCERT.                            *
  6394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6395*                            VMOD=2.013                          *
  6396*                                                                *
  6397*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6398*                                                                *
  6399*   FILE TYPE = VSAM,KSDS                                        *
  6400*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6401*                                                                *
  6402*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6403*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6404*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6405*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6406*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6407*                                                                *
  6408*   LOG = YES                                                    *
  6409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6410******************************************************************
  6411*                   C H A N G E   L O G
  6412*
  6413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6414*-----------------------------------------------------------------
  6415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6416* EFFECTIVE    NUMBER
  6417*-----------------------------------------------------------------
  6418* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6419* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6420* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6421* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6422* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6423* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6424* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6425* 032612  CR2011110200001  PEMA  AHL CHANGES
  6426******************************************************************
  6427
  6428 01  CERTIFICATE-MASTER.
  6429     12  CM-RECORD-ID                      PIC XX.
  6430         88  VALID-CM-ID                      VALUE 'CM'.
  6431
  6432     12  CM-CONTROL-PRIMARY.
  6433         16  CM-COMPANY-CD                 PIC X.
  6434         16  CM-CARRIER                    PIC X.
  6435         16  CM-GROUPING.
  6436             20  CM-GROUPING-PREFIX        PIC X(3).
  6437             20  CM-GROUPING-PRIME         PIC X(3).
  6438         16  CM-STATE                      PIC XX.
  6439         16  CM-ACCOUNT.
  6440             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6441             20  CM-ACCOUNT-PRIME          PIC X(6).
  6442         16  CM-CERT-EFF-DT                PIC XX.
  6443         16  CM-CERT-NO.
  6444             20  CM-CERT-PRIME             PIC X(10).
  6445             20  CM-CERT-SFX               PIC X.
  6446
  6447     12  CM-CONTROL-BY-NAME.
  6448         16  CM-COMPANY-CD-A1              PIC X.
  6449         16  CM-INSURED-LAST-NAME          PIC X(15).
  6450         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 120
* EL6311.cbl
  6451             20  CM-INSURED-INITIAL1       PIC X.
  6452             20  CM-INSURED-INITIAL2       PIC X.
  6453
  6454     12  CM-CONTROL-BY-SSN.
  6455         16  CM-COMPANY-CD-A2              PIC X.
  6456         16  CM-SOC-SEC-NO.
  6457             20  CM-SSN-STATE              PIC XX.
  6458             20  CM-SSN-ACCOUNT            PIC X(6).
  6459             20  CM-SSN-LN3.
  6460                 25  CM-INSURED-INITIALS-A2.
  6461                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6462                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6463                 25 CM-PART-LAST-NAME-A2         PIC X.
  6464
  6465     12  CM-CONTROL-BY-CERT-NO.
  6466         16  CM-COMPANY-CD-A4              PIC X.
  6467         16  CM-CERT-NO-A4                 PIC X(11).
  6468
  6469     12  CM-CONTROL-BY-MEMB.
  6470         16  CM-COMPANY-CD-A5              PIC X.
  6471         16  CM-MEMBER-NO.
  6472             20  CM-MEMB-STATE             PIC XX.
  6473             20  CM-MEMB-ACCOUNT           PIC X(6).
  6474             20  CM-MEMB-LN4.
  6475                 25  CM-INSURED-INITIALS-A5.
  6476                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6477                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6478                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6479
  6480     12  CM-INSURED-PROFILE-DATA.
  6481         16  CM-INSURED-FIRST-NAME.
  6482             20  CM-INSURED-1ST-INIT       PIC X.
  6483             20  FILLER                    PIC X(9).
  6484         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6485         16  CM-INSURED-SEX                PIC X.
  6486             88  CM-SEX-MALE                  VALUE 'M'.
  6487             88  CM-SEX-FEMAL                 VALUE 'F'.
  6488         16  CM-INSURED-JOINT-AGE          PIC 99.
  6489         16  CM-JOINT-INSURED-NAME.
  6490             20  CM-JT-LAST-NAME           PIC X(15).
  6491             20  CM-JT-FIRST-NAME.
  6492                 24  CM-JT-1ST-INIT        PIC X.
  6493                 24  FILLER                PIC X(9).
  6494             20  CM-JT-INITIAL             PIC X.
  6495
  6496     12  CM-LIFE-DATA.
  6497         16  CM-LF-BENEFIT-CD              PIC XX.
  6498         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6499         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6500         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6501         16  CM-LF-DEV-CODE                PIC XXX.
  6502         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6503         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6504         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6505         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6506         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6507         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6508         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 121
* EL6311.cbl
  6509         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6510         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6511         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6512         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6513         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6514         16  FILLER                        PIC XX.
  6515
  6516     12  CM-AH-DATA.
  6517         16  CM-AH-BENEFIT-CD              PIC XX.
  6518         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6519         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6520         16  CM-AH-DEV-CODE                PIC XXX.
  6521         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6522         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6523         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6524         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6525         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6526         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6527         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6528         16  CM-AH-PAID-THRU-DT            PIC XX.
  6529             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6530         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6531         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6532         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6533         16  FILLER                        PIC X.
  6534
  6535     12  CM-LOAN-INFORMATION.
  6536         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6537         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6538                                           PIC S9(5)V99  COMP-3.
  6539         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6540         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6541         16  CM-PAY-FREQUENCY              PIC S99.
  6542         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6543         16  CM-RATE-CLASS                 PIC XX.
  6544         16  CM-BENEFICIARY                PIC X(25).
  6545         16  CM-POLICY-FORM-NO             PIC X(12).
  6546         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6547         16  CM-LAST-ADD-ON-DT             PIC XX.
  6548         16  CM-DEDUCTIBLE-AMOUNTS.
  6549             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6550             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6551         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6552             20  CM-RESIDENT-STATE         PIC XX.
  6553             20  CM-RATE-CODE              PIC X(4).
  6554             20  FILLER                    PIC XX.
  6555         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6556             20  CM-LOAN-OFFICER           PIC X(5).
  6557             20  FILLER                    PIC XXX.
  6558         16  CM-CSR-CODE                   PIC XXX.
  6559         16  CM-UNDERWRITING-CODE          PIC X.
  6560             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6561         16  CM-POST-CARD-IND              PIC X.
  6562         16  CM-NH-INTERFACE-SW            PIC X.
  6563         16  CM-PREMIUM-TYPE               PIC X.
  6564             88  CM-SING-PRM                  VALUE '1'.
  6565             88  CM-O-B-COVERAGE              VALUE '2'.
  6566             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 122
* EL6311.cbl
  6567         16  CM-IND-GRP-TYPE               PIC X.
  6568             88  CM-INDIVIDUAL                VALUE 'I'.
  6569             88  CM-GROUP                     VALUE 'G'.
  6570         16  CM-SKIP-CODE                  PIC X.
  6571             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6572             88  SKIP-JULY                    VALUE '1'.
  6573             88  SKIP-AUGUST                  VALUE '2'.
  6574             88  SKIP-SEPTEMBER               VALUE '3'.
  6575             88  SKIP-JULY-AUG                VALUE '4'.
  6576             88  SKIP-AUG-SEPT                VALUE '5'.
  6577             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6578             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6579             88  SKIP-JUNE                    VALUE '8'.
  6580             88  SKIP-JUNE-JULY               VALUE '9'.
  6581             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6582             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6583         16  CM-PAYMENT-MODE               PIC X.
  6584             88  PAY-MONTHLY                  VALUE SPACE.
  6585             88  PAY-WEEKLY                   VALUE '1'.
  6586             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6587             88  PAY-BI-WEEKLY                VALUE '3'.
  6588             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6589         16  CM-LOAN-NUMBER                PIC X(8).
  6590         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6591         16  CM-OLD-LOF                    PIC XXX.
  6592*        16  CM-LOAN-OFFICER               PIC XXX.
  6593         16  CM-REIN-TABLE                 PIC XXX.
  6594         16  CM-SPECIAL-REIN-CODE          PIC X.
  6595         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6596         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6597         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6598
  6599     12  CM-STATUS-DATA.
  6600         16  CM-ENTRY-STATUS               PIC X.
  6601         16  CM-ENTRY-DT                   PIC XX.
  6602
  6603         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6604         16  CM-LF-CANCEL-DT               PIC XX.
  6605         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6606
  6607         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6608         16  CM-LF-DEATH-DT                PIC XX.
  6609         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6610
  6611         16  CM-LF-CURRENT-STATUS          PIC X.
  6612             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6613                                                'M' '4' '5' '9'.
  6614             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6615             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6616             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6617             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6618             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6619             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6620             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6621             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6622             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6623             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6624             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 123
* EL6311.cbl
  6625             88  CM-LF-VOIDED                 VALUE 'V'.
  6626
  6627         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6628         16  CM-AH-CANCEL-DT               PIC XX.
  6629         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6630
  6631         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6632         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6633         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6634
  6635         16  CM-AH-CURRENT-STATUS          PIC X.
  6636             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6637                                                'M' '4' '5' '9'.
  6638             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6639             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6640             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6641             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6642             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6643             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6644             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6645             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6646             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6647             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6648             88  CM-AH-DECLINED               VALUE 'D'.
  6649             88  CM-AH-VOIDED                 VALUE 'V'.
  6650
  6651         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6652             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6653             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6654             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6655         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6656
  6657         16  CM-ENTRY-BATCH                PIC X(6).
  6658         16  CM-LF-EXIT-BATCH              PIC X(6).
  6659         16  CM-AH-EXIT-BATCH              PIC X(6).
  6660         16  CM-LAST-MONTH-END             PIC XX.
  6661
  6662     12  CM-NOTE-SW                        PIC X.
  6663         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6664         88  CERT-NOTES-PRESENT               VALUE '1'.
  6665         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6666         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6667         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6668         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6669         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6670         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6671     12  CM-COMP-EXCP-SW                   PIC X.
  6672         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6673         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6674     12  CM-INSURED-ADDRESS-SW             PIC X.
  6675         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6676         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6677
  6678*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6679     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6680     12  FILLER                            PIC X.
  6681
  6682*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 124
* EL6311.cbl
  6683     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6684     12  FILLER                            PIC X.
  6685*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6686     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6687
  6688     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6689         88  CERT-ADDED-BATCH                 VALUE ' '.
  6690         88  CERT-ADDED-ONLINE                VALUE '1'.
  6691         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6692         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6693         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6694     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6695         88  CERT-AS-LOADED                   VALUE ' '.
  6696         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6697         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6698         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6699         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6700         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6701         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6702         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6703
  6704     12  CM-ACCOUNT-COMM-PCTS.
  6705         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6706         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6707
  6708     12  CM-USER-FIELD                     PIC X.
  6709     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6710     12  CM-CLP-STATE                      PIC XX.
  6711     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6712     12  CM-USER-RESERVED                  PIC XXX.
  6713     12  FILLER REDEFINES CM-USER-RESERVED.
  6714         16  CM-AH-CLASS-CD                PIC XX.
  6715         16  F                             PIC X.
  6716******************************************************************
  6717*                                COPY ERCNOTE.
  6718******************************************************************
  6719*                                                                *
  6720*                                                                *
  6721*                            ERCNOTE                             *
  6722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6723*                            VMOD=2.003                          *
  6724*                                                                *
  6725*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6726*                                                                *
  6727*        FILE TYPE= VSAM,KSDS                                    *
  6728*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6729*                                                                *
  6730*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6731*                                                                *
  6732*        LOG = YES                                               *
  6733*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6734*                                                                *
  6735******************************************************************
  6736*                   C H A N G E   L O G
  6737*
  6738* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6739*-----------------------------------------------------------------
  6740*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 125
* EL6311.cbl
  6741* EFFECTIVE    NUMBER
  6742*-----------------------------------------------------------------
  6743* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6744*                                FILE WILL CONTAIN BILLING NOTES O
  6745******************************************************************
  6746
  6747 01  CERTIFICATE-NOTE.
  6748     12  CN-RECORD-ID                PIC  XX.
  6749         88  VALID-CN-ID                  VALUE 'CN'.
  6750
  6751     12  CN-CONTROL-PRIMARY.
  6752         16  CN-COMPANY-CD           PIC X.
  6753         16  CN-CARRIER              PIC X.
  6754         16  CN-GROUPING.
  6755             20 CN-GROUPING-PREFIX   PIC XXX.
  6756             20 CN-GROUPING-PRIME    PIC XXX.
  6757         16  CN-STATE                PIC XX.
  6758         16  CN-ACCOUNT.
  6759             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6760             20 CN-ACCOUNT-PRIME     PIC X(6).
  6761         16  CN-CERT-EFF-DT          PIC XX.
  6762         16  CN-CERT-NO.
  6763             20  CN-CERT-PRIME       PIC X(10).
  6764             20  CN-CERT-SFX         PIC X.
  6765
  6766     12  CN-BILLING-START-LINE-NO    PIC 99.
  6767     12  CN-BILLING-END-LINE-NO      PIC 99.
  6768
  6769     12  CN-LINES.
  6770         16  CN-LINE OCCURS 10       PIC X(77).
  6771
  6772     12  CN-LAST-MAINT-DT            PIC XX.
  6773     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6774     12  CN-LAST-MAINT-USER          PIC X(4).
  6775     12  FILLER                      PIC X(6).
  6776******************************************************************
  6777*                                COPY ERCPNDM.
  6778******************************************************************
  6779*                                                                *
  6780*                                                                *
  6781*                            ERCPNDM                             *
  6782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6783*                            VMOD=2.003                          *
  6784*                                                                *
  6785*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6786*                                                                *
  6787*   FILE TYPE = VSAM,KSDS                                        *
  6788*   RECORD SIZE = 374   RECFORM = FIX                            *
  6789*                                                                *
  6790*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6791*   ALTERNATE PATH    = NOT USED                                 *
  6792*                                                                *
  6793*   LOG = YES                                                    *
  6794*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6795******************************************************************
  6796*                   C H A N G E   L O G
  6797*
  6798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 126
* EL6311.cbl
  6799*-----------------------------------------------------------------
  6800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6801* EFFECTIVE    NUMBER
  6802*-----------------------------------------------------------------
  6803* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6804* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6805* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6806******************************************************************
  6807
  6808 01  PENDING-MAILING-DATA.
  6809     12  PM-RECORD-ID                      PIC XX.
  6810         88  VALID-MA-ID                       VALUE 'PM'.
  6811
  6812     12  PM-CONTROL-PRIMARY.
  6813         16  PM-COMPANY-CD                 PIC X.
  6814         16  PM-ENTRY-BATCH                PIC X(6).
  6815         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6816         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6817
  6818     12  FILLER                            PIC X(14).
  6819
  6820     12  PM-ACCESS-CONTROL.
  6821         16  PM-SOURCE-SYSTEM              PIC XX.
  6822             88  PM-FROM-CREDIT                VALUE 'CR'.
  6823             88  PM-FROM-VSI                   VALUE 'VS'.
  6824             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6825             88  PM-FROM-OTHER                 VALUE 'OT'.
  6826         16  PM-RECORD-ADD-DT              PIC XX.
  6827         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6828         16  PM-LAST-MAINT-DT              PIC XX.
  6829         16  PM-LAST-MAINT-BY              PIC XXXX.
  6830         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6831
  6832     12  PM-PROFILE-INFO.
  6833         16  PM-QUALIFY-CODE-1             PIC XX.
  6834         16  PM-QUALIFY-CODE-2             PIC XX.
  6835         16  PM-QUALIFY-CODE-3             PIC XX.
  6836         16  PM-QUALIFY-CODE-4             PIC XX.
  6837         16  PM-QUALIFY-CODE-5             PIC XX.
  6838
  6839         16  PM-INSURED-LAST-NAME          PIC X(15).
  6840         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6841         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6842         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6843         16  PM-INSURED-BIRTH-DT           PIC XX.
  6844         16  PM-INSURED-SEX                PIC X.
  6845             88  PM-SEX-MALE                   VALUE 'M'.
  6846             88  PM-SEX-FEMALE                 VALUE 'F'.
  6847         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6848
  6849         16  PM-ADDRESS-CORRECTED          PIC X.
  6850         16  PM-JOINT-BIRTH-DT             PIC XX.
  6851*        16  FILLER                        PIC X(12).
  6852
  6853         16  PM-ADDRESS-LINE-1             PIC X(30).
  6854         16  PM-ADDRESS-LINE-2             PIC X(30).
  6855         16  PM-CITY-STATE.
  6856             20  PM-CITY                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 127
* EL6311.cbl
  6857             20  PM-STATE                  PIC XX.
  6858         16  PM-ZIP.
  6859             20  PM-ZIP-CODE.
  6860                 24  PM-ZIP-1              PIC X.
  6861                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6862                 24  FILLER                PIC X(4).
  6863             20  PM-ZIP-PLUS4              PIC X(4).
  6864         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6865             20  PM-CAN-POST1              PIC XXX.
  6866             20  PM-CAN-POST2              PIC XXX.
  6867             20  FILLER                    PIC XXX.
  6868
  6869         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6870
  6871         16  FILLER                        PIC X(03).
  6872
  6873     12  PM-CRED-BENE-INFO.
  6874         16  PM-CRED-BENE-NAME             PIC X(25).
  6875         16  PM-CRED-BENE-ADDR             PIC X(30).
  6876         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6877         16  PM-CRED-BENE-CTYST.
  6878             20  PM-CRED-BENE-CITY         PIC X(28).
  6879             20  PM-CRED-BENE-STATE        PIC XX.
  6880         16  PM-CRED-BENE-ZIP.
  6881             20  PM-CB-ZIP-CODE.
  6882                 24  PM-CB-ZIP-1           PIC X.
  6883                     88  PM-CB-CANADIAN-POST-CODE
  6884                                  VALUE 'A' THRU 'Z'.
  6885                 24  FILLER                PIC X(4).
  6886             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6887         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6888             20  PM-CB-CAN-POST1           PIC XXX.
  6889             20  PM-CB-CAN-POST2           PIC XXX.
  6890             20  FILLER                    PIC XXX.
  6891     12  PM-POST-CARD-MAIL-DATA.
  6892         16  PM-MAIL-DATA OCCURS 7.
  6893             20  PM-MAIL-TYPE              PIC X.
  6894                 88  PM-12MO-MAILING           VALUE '1'.
  6895                 88  PM-EXP-MAILING            VALUE '2'.
  6896             20  PM-MAIL-STATUS            PIC X.
  6897                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6898                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6899                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6900             20  PM-MAIL-DATE              PIC XX.
  6901     12  FILLER                            PIC XX.
  6902     12  FILLER                            PIC X(12).
  6903*    12  FILLER                            PIC X(30).
  6904
  6905******************************************************************
  6906*                                COPY ERCMAIL.
  6907******************************************************************
  6908*                                                                *
  6909*                                                                *
  6910*                            ERCMAIL                             *
  6911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6912*                            VMOD=2.003                          *
  6913*                                                                *
  6914*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 128
* EL6311.cbl
  6915*                                                                *
  6916*   FILE TYPE = VSAM,KSDS                                        *
  6917*   RECORD SIZE = 374   RECFORM = FIX                            *
  6918*                                                                *
  6919*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6920*   ALTERNATE PATH    = NOT USED                                 *
  6921*                                                                *
  6922*   LOG = YES                                                    *
  6923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6924******************************************************************
  6925*                   C H A N G E   L O G
  6926*
  6927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6928*-----------------------------------------------------------------
  6929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6930* EFFECTIVE    NUMBER
  6931*-----------------------------------------------------------------
  6932* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6933* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6934* 111108                   PEMA  ADD CRED BENE ADDR2
  6935******************************************************************
  6936
  6937 01  MAILING-DATA.
  6938     12  MA-RECORD-ID                      PIC XX.
  6939         88  VALID-MA-ID                       VALUE 'MA'.
  6940
  6941     12  MA-CONTROL-PRIMARY.
  6942         16  MA-COMPANY-CD                 PIC X.
  6943         16  MA-CARRIER                    PIC X.
  6944         16  MA-GROUPING.
  6945             20  MA-GROUPING-PREFIX        PIC XXX.
  6946             20  MA-GROUPING-PRIME         PIC XXX.
  6947         16  MA-STATE                      PIC XX.
  6948         16  MA-ACCOUNT.
  6949             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6950             20  MA-ACCOUNT-PRIME          PIC X(6).
  6951         16  MA-CERT-EFF-DT                PIC XX.
  6952         16  MA-CERT-NO.
  6953             20  MA-CERT-PRIME             PIC X(10).
  6954             20  MA-CERT-SFX               PIC X.
  6955
  6956     12  FILLER                            PIC XX.
  6957
  6958     12  MA-ACCESS-CONTROL.
  6959         16  MA-SOURCE-SYSTEM              PIC XX.
  6960             88  MA-FROM-CREDIT                VALUE 'CR'.
  6961             88  MA-FROM-VSI                   VALUE 'VS'.
  6962             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6963             88  MA-FROM-OTHER                 VALUE 'OT'.
  6964         16  MA-RECORD-ADD-DT              PIC XX.
  6965         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6966         16  MA-LAST-MAINT-DT              PIC XX.
  6967         16  MA-LAST-MAINT-BY              PIC XXXX.
  6968         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6969
  6970     12  MA-PROFILE-INFO.
  6971         16  MA-QUALIFY-CODE-1             PIC XX.
  6972         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 129
* EL6311.cbl
  6973         16  MA-QUALIFY-CODE-3             PIC XX.
  6974         16  MA-QUALIFY-CODE-4             PIC XX.
  6975         16  MA-QUALIFY-CODE-5             PIC XX.
  6976
  6977         16  MA-INSURED-LAST-NAME          PIC X(15).
  6978         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6979         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6980         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6981         16  MA-INSURED-BIRTH-DT           PIC XX.
  6982         16  MA-INSURED-SEX                PIC X.
  6983             88  MA-SEX-MALE                   VALUE 'M'.
  6984             88  MA-SEX-FEMALE                 VALUE 'F'.
  6985         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6986
  6987         16  MA-ADDRESS-CORRECTED          PIC X.
  6988         16  MA-JOINT-BIRTH-DT             PIC XX.
  6989*        16  FILLER                        PIC X(12).
  6990
  6991         16  MA-ADDRESS-LINE-1             PIC X(30).
  6992         16  MA-ADDRESS-LINE-2             PIC X(30).
  6993         16  MA-CITY-STATE.
  6994             20  MA-CITY                   PIC X(28).
  6995             20  MA-ADDR-STATE             PIC XX.
  6996         16  MA-ZIP.
  6997             20  MA-ZIP-CODE.
  6998                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6999                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7000                 24  FILLER                PIC X(4).
  7001             20  MA-ZIP-PLUS4              PIC X(4).
  7002         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7003             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7004             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7005             20  FILLER                    PIC X(3).
  7006
  7007         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7008
  7009         16  FILLER                        PIC XXX.
  7010*        16  FILLER                        PIC X(10).
  7011
  7012     12  MA-CRED-BENE-INFO.
  7013         16  MA-CRED-BENE-NAME                 PIC X(25).
  7014         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7015         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7016         16  MA-CRED-BENE-CTYST.
  7017             20  MA-CRED-BENE-CITY             PIC X(28).
  7018             20  MA-CRED-BENE-STATE            PIC XX.
  7019         16  MA-CRED-BENE-ZIP.
  7020             20  MA-CB-ZIP-CODE.
  7021                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7022                     88  MA-CB-CANADIAN-POST-CODE
  7023                                           VALUE 'A' THRU 'Z'.
  7024                 24  FILLER                    PIC X(4).
  7025             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7026         16  MA-CB-CANADIAN-POSTAL-CODE
  7027                            REDEFINES MA-CRED-BENE-ZIP.
  7028             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7029             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7030             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 130
* EL6311.cbl
  7031     12  MA-POST-CARD-MAIL-DATA.
  7032         16  MA-MAIL-DATA OCCURS 7.
  7033             20  MA-MAIL-TYPE              PIC X.
  7034                 88  MA-12MO-MAILING           VALUE '1'.
  7035                 88  MA-EXP-MAILING            VALUE '2'.
  7036             20  MA-MAIL-STATUS            PIC X.
  7037                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7038                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7039                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7040             20  MA-MAIL-DATE              PIC XX.
  7041     12  FILLER                            PIC XX.
  7042     12  FILLER                            PIC XX.
  7043*    12  FILLER                            PIC X(30).
  7044******************************************************************
  7045*                                COPY ERCRQST.
  7046******************************************************************
  7047*                                                                *
  7048*                                                                *
  7049*                            ERCRQST.                            *
  7050*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7051*                            VMOD=2.002                          *
  7052*                                                                *
  7053*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7054*                                                                *
  7055*   FILE TYPE = VSAM,KSDS                                        *
  7056*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7057*                                                                *
  7058*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7059*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7060*                                   ACCOUNT, REF, BATCH)         *
  7061*                                                RKP=9, LEN=38   *
  7062*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7063*                                   ACCOUNT, REF, BATCH)         *
  7064*                                                RKP=47, LEN=46  *
  7065*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7066*                                   BATCH)                       *
  7067*                                                RKP=93, LEN=24  *
  7068*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7069*                                   REF, BATCH)                  *
  7070*                                                RKP=117, LEN=35 *
  7071*   LOG = NO                                                     *
  7072*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7073******************************************************************
  7074
  7075 01  AR-REQUEST-RECORD.
  7076     12  RQ-RECORD-ID                     PIC XX.
  7077         88  VALID-RQ-ID                        VALUE 'RQ'.
  7078
  7079     12  RQ-CONTROL-PRIMARY.
  7080         16  RQ-COMPANY-CD                PIC X.
  7081         16  RQ-ENTRY-BATCH               PIC X(6).
  7082
  7083     12  RQ-CONTROL-BY-ACCT-REF.
  7084         16  RQ-COMPANY-CD-A1             PIC X.
  7085         16  RQ-CARRIER-A1                PIC X.
  7086         16  RQ-GROUPING-A1               PIC X(6).
  7087         16  RQ-STATE-A1                  PIC XX.
  7088         16  RQ-ACCOUNT-A1                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 131
* EL6311.cbl
  7089         16  RQ-REFERENCE-A1              PIC X(12).
  7090         16  RQ-BATCH-A1                  PIC X(6).
  7091
  7092     12  RQ-CONTROL-BY-FIN-RESP.
  7093         16  RQ-COMPANY-CD-A2             PIC X.
  7094         16  RQ-CARRIER-A2                PIC X.
  7095         16  RQ-GROUPING-A2               PIC X(6).
  7096         16  RQ-FIN-RESP-A2               PIC X(10).
  7097         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7098         16  RQ-REFERENCE-A2              PIC X(12).
  7099         16  RQ-BATCH-A2                  PIC X(6).
  7100
  7101     12  RQ-CONTROL-BY-ACCT-AGENT.
  7102         16  RQ-COMPANY-CD-A3             PIC X.
  7103         16  RQ-CARRIER-A3                PIC X.
  7104         16  RQ-GROUPING-A3               PIC X(6).
  7105         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7106         16  RQ-BATCH-A3                  PIC X(6).
  7107
  7108     12  RQ-CONTROL-BY-SUMMARY.
  7109         16  RQ-COMPANY-CD-A4             PIC X.
  7110         16  RQ-SUMMARY-CODE              PIC X(6).
  7111         16  RQ-ACCOUNT-A4                PIC X(10).
  7112         16  RQ-REFERENCE-A4              PIC X(12).
  7113         16  RQ-BATCH-A4                  PIC X(6).
  7114
  7115     12  RQ-REQUEST-METHOD                PIC X.
  7116         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7117         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7118         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7119         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7120     12  FILLER                           PIC X.
  7121     12  RQ-STATUS                        PIC X.
  7122         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7123         88  RQ-RESUBMIT                      VALUE 'R'.
  7124     12  RQ-PROCESSOR-ID                  PIC X(4).
  7125     12  RQ-ENTRY-DT                      PIC XX.
  7126     12  RQ-MO-END-DT                     PIC XX.
  7127     12  RQ-REQUEST-DT                    PIC XX.
  7128     12  RQ-STMT-DT                       PIC XX.
  7129     12  RQ-REVERSAL-DT                   PIC XX.
  7130     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7131     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7132
  7133     12  FILLER                           PIC X(27).
  7134
  7135******************************************************************
  7136
  7137*                                COPY ERCLOFC.
  7138******************************************************************
  7139*                                                                *
  7140*                                                                *
  7141*                            ERCLOFC                             *
  7142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7143*                            VMOD=2.003                          *
  7144*                                                                *
  7145*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7146*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 132
* EL6311.cbl
  7147*   FILE TYPE = VSAM,KSDS                                        *
  7148*   RECORD SIZE = 670   RECFORM = FIX                            *
  7149*                                                                *
  7150*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7151*                                                                *
  7152*   LOG = YES                                                    *
  7153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7154*                                                                *
  7155******************************************************************
  7156
  7157 01  LOAN-OFFICER-MASTER.
  7158     12  LO-RECORD-ID                PIC XX.
  7159         88  VALID-LO-ID                VALUE 'LO'.
  7160
  7161     12  LO-CONTROL-PRIMARY.
  7162         16  LO-COMPANY-CD           PIC X.
  7163         16  LO-CARRIER              PIC X.
  7164         16  LO-GROUPING.
  7165             20  LO-GROUPING-PREFIX  PIC XXX.
  7166             20  LO-GROUPING-PRIME   PIC XXX.
  7167         16  LO-STATE                PIC XX.
  7168         16  LO-ACCOUNT.
  7169             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7170             20  LO-ACCOUNT-PRIME    PIC X(6).
  7171         16  LO-OFFICER-CODE         PIC X(5).
  7172
  7173     12  LO-OFFICER-NAME             PIC X(30).
  7174
  7175     12  LO-LAST-MAINT-DT            PIC XX.
  7176     12  LO-LAST-USER                PIC X(4).
  7177     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7178
  7179     12  LO-COMP-CONTROL             PIC X.
  7180             88  LO-SHOW-COMP           VALUE 'Y'.
  7181             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7182     12  LO-DETAIL-CONTROL           PIC X.
  7183             88  LO-PRINT-DETAIL        VALUE 'D'.
  7184             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7185
  7186     12  LO-SV-CARRIER               PIC X.
  7187     12  LO-SV-GROUPING              PIC X(6).
  7188     12  LO-SV-STATE                 PIC XX.
  7189
  7190     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7191     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7192
  7193     12  LO-OFFICER-INFO.
  7194         16  FILLER OCCURS 12 TIMES.
  7195             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7196             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7197             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7198             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7199             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7200             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7201             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7202             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7203     12  FILLER                      PIC X(198).
  7204******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 133
* EL6311.cbl
  7205*                                COPY ERCPYAJ.
  7206******************************************************************
  7207*                                                                *
  7208*                            ERCPYAJ                             *
  7209*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7210*                            VMOD=2.015                          *
  7211*                                                                *
  7212*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7213*                                                                *
  7214*                                                                *
  7215*   FILE TYPE = VSAM,KSDS                                        *
  7216*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7217*                                                                *
  7218*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7219*       ALTERNATE PATHS = NONE                                   *
  7220*                                                                *
  7221*   LOG = YES                                                    *
  7222*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7223******************************************************************
  7224******************************************************************
  7225*                   C H A N G E   L O G
  7226*
  7227* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7228*-----------------------------------------------------------------
  7229*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7230* EFFECTIVE    NUMBER
  7231*-----------------------------------------------------------------
  7232* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7233* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7234******************************************************************
  7235
  7236 01  PENDING-PAY-ADJ.
  7237     12  PY-RECORD-ID                     PIC XX.
  7238         88  VALID-PY-ID                        VALUE 'PY'.
  7239
  7240     12  PY-CONTROL-PRIMARY.
  7241         16  PY-COMPANY-CD                PIC X.
  7242         16  PY-CARRIER                   PIC X.
  7243         16  PY-GROUPING                  PIC X(6).
  7244         16  PY-FIN-RESP                  PIC X(10).
  7245         16  PY-ACCOUNT                   PIC X(10).
  7246         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7247                                          PIC X(10).
  7248         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7249         16  PY-RECORD-TYPE               PIC X.
  7250             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7251             88  PY-DEPOSIT                   VALUE 'D'.
  7252             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7253             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7254             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7255             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7256             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7257             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7258             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7259             88  PY-FICA-ENTRY                VALUE 'F'.
  7260             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7261             88  PY-POLICY-FEE                VALUE 'W'.
  7262             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 134
* EL6311.cbl
  7263
  7264     12  PY-PYMT-TYPE                     PIC X.
  7265             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7266             88  PY-REINS-PYMT                VALUE 'R'.
  7267             88  PY-EXP-PYMT                  VALUE 'E'.
  7268
  7269     12  PY-BIL-INV                       PIC X(6).
  7270     12  PY-REF-NO                        PIC X(12).
  7271
  7272     12  PY-LAST-MAINT-DT                 PIC XX.
  7273     12  PY-LAST-MAINT-BY                 PIC X(4).
  7274     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7275
  7276     12  PY-PYADJ-RECORD.
  7277         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7278         16  PY-ENTRY-COMMENT             PIC X(30).
  7279         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7280             20  PY-GL-ACCOUNT            PIC X(10).
  7281             20  PY-GL-STATE              PIC X(02).
  7282             20  PY-GL-CANC-SW            PIC X(01).
  7283                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7284                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7285             20  PY-GL-COMMENT            PIC X(10).
  7286             20  FILLER      REDEFINES PY-GL-COMMENT.
  7287                 24  PY-GL-CHECK-NO       PIC 9(06).
  7288                 24  FILLER               PIC X(04).
  7289             20  FILLER                   PIC X(07).
  7290         16  PY-SAVE-ACCOUNT              PIC X(10).
  7291         16  PY-SAVE-TYPE                 PIC X(01).
  7292
  7293         16  PY-LETTERS.
  7294             20  PY-LETTER OCCURS 3 TIMES
  7295                           INDEXED BY PY-LET-NDX
  7296                                          PIC X(04).
  7297
  7298         16  PY-ERCOMP-TYPE               PIC X.
  7299             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7300             88  PY-GA-TYPE                   VALUE 'G'.
  7301             88  PY-BANK-TYPE                 VALUE 'B'.
  7302         16  FILLER                       PIC X(05).
  7303
  7304     12  PY-RECORD-STATUS.
  7305         16  PY-CREDIT-SELECT-DT          PIC XX.
  7306         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7307         16  PY-BILLED-DATE               PIC XX.
  7308         16  PY-REPORTED-DT               PIC XX.
  7309         16  PY-PMT-APPLIED               PIC X.
  7310             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7311             88  PY-GA-PMT                    VALUE 'G'.
  7312             88  PY-OVWRITE-PMT               VALUE 'O'.
  7313             88  PY-NON-AR-PMT                VALUE 'N'.
  7314         16  FILLER                       PIC X(5).
  7315         16  PY-INPUT-DT                  PIC XX.
  7316         16  PY-CHECK-NUMBER              PIC X(6).
  7317         16  PY-VOID-SW                   PIC X.
  7318             88  PY-CHECK-VOIDED              VALUE 'V'.
  7319         16  PY-CHECK-ORIGIN-SW           PIC X.
  7320             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 135
* EL6311.cbl
  7321             88  PY-REFUND-CHECK              VALUE 'R'.
  7322             88  PY-GA-CHECK                  VALUE 'G'.
  7323             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7324             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7325         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7326         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7327         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7328         16  PY-BILL-FLAG                 PIC X.
  7329             88  PY-BILLED                    VALUE 'B'.
  7330         16  PY-AR-FLAG                   PIC X.
  7331             88  PY-AR-CYCLE                  VALUE 'C'.
  7332             88  PY-AR-MONTH-END              VALUE 'M'.
  7333         16  PY-AR-DATE                   PIC XX.
  7334
  7335     12  PY-GL-CODES.
  7336         16  PY-GL-DB                     PIC X(14).
  7337         16  PY-GL-CR                     PIC X(14).
  7338         16  PY-GL-FLAG                   PIC X.
  7339         16  PY-GL-DATE                   PIC XX.
  7340
  7341     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7342     12  FILLER                           PIC X(3).
  7343******************************************************************
  7344*                                COPY ERCCNOT.
  7345******************************************************************
  7346*                                                                *
  7347*                            ERCCNOT                             *
  7348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7349*                            VMOD=2.003                          *
  7350*                                                                *
  7351*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7352*                                                                *
  7353*        FILE TYPE= VSAM,KSDS                                    *
  7354*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7355*                                                                *
  7356*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7357*                                                                *
  7358*        LOG = YES                                               *
  7359*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7360*                                                                *
  7361******************************************************************
  7362*                   C H A N G E   L O G
  7363*
  7364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7365*-----------------------------------------------------------------
  7366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7367* EFFECTIVE    NUMBER
  7368*-----------------------------------------------------------------
  7369* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7370******************************************************************
  7371
  7372 01  CERT-NOTE-FILE.
  7373     12  CZ-RECORD-ID                PIC  XX.
  7374         88  VALID-CZ-ID                  VALUE 'CZ'.
  7375
  7376     12  CZ-CONTROL-PRIMARY.
  7377         16  CZ-COMPANY-CD           PIC X.
  7378         16  CZ-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 136
* EL6311.cbl
  7379         16  CZ-GROUPING.
  7380             20 CZ-GROUPING-PREFIX   PIC XXX.
  7381             20 CZ-GROUPING-PRIME    PIC XXX.
  7382         16  CZ-STATE                PIC XX.
  7383         16  CZ-ACCOUNT.
  7384             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7385             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7386         16  CZ-CERT-EFF-DT          PIC XX.
  7387         16  CZ-CERT-NO.
  7388             20  CZ-CERT-PRIME       PIC X(10).
  7389             20  CZ-CERT-SFX         PIC X.
  7390         16  CZ-RECORD-TYPE          PIC X.
  7391             88  CERT-NOTE           VALUE '1'.
  7392             88  CLAIM-CERT-NOTE     VALUE '2'.
  7393         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7394
  7395     12  CZ-LAST-MAINT-DT            PIC XX.
  7396     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7397     12  CZ-LAST-MAINT-USER          PIC X(4).
  7398
  7399     12  CZ-NOTE-INFORMATION.
  7400         16  CZ-NOTE                 PIC X(63).
  7401         16  FILLER                  PIC X(39).
  7402******************************************************************
  7403*                                COPY ELCMSTR.
  7404******************************************************************
  7405*                                                                *
  7406*                            ELCMSTR.                            *
  7407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7408*                            VMOD=2.012                          *
  7409*                                                                *
  7410*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7411*                                                                *
  7412*   FILE TYPE = VSAM,KSDS                                        *
  7413*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7414*                                                                *
  7415*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7416*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7417*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7418*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7419*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7420*                                                 RKP=75,LEN=21  *
  7421*                                                                *
  7422*   **** NOTE ****                                               *
  7423*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7424*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7425*                                                                *
  7426*   LOG = YES                                                    *
  7427*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7428******************************************************************
  7429*                   C H A N G E   L O G
  7430*
  7431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7432*-----------------------------------------------------------------
  7433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7434* EFFECTIVE    NUMBER
  7435*-----------------------------------------------------------------
  7436* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 137
* EL6311.cbl
  7437* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7438* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7439******************************************************************
  7440 01  CLAIM-MASTER.
  7441     12  CL-RECORD-ID                PIC XX.
  7442         88  VALID-CL-ID         VALUE 'CL'.
  7443
  7444     12  CL-CONTROL-PRIMARY.
  7445         16  CL-COMPANY-CD           PIC X.
  7446         16  CL-CARRIER              PIC X.
  7447         16  CL-CLAIM-NO             PIC X(7).
  7448         16  CL-CERT-NO.
  7449             20  CL-CERT-PRIME       PIC X(10).
  7450             20  CL-CERT-SFX         PIC X.
  7451
  7452     12  CL-CONTROL-BY-NAME.
  7453         16  CL-COMPANY-CD-A1        PIC X.
  7454         16  CL-INSURED-LAST-NAME    PIC X(15).
  7455         16  CL-INSURED-NAME.
  7456             20  CL-INSURED-1ST-NAME PIC X(12).
  7457             20  CL-INSURED-MID-INIT PIC X.
  7458
  7459     12  CL-CONTROL-BY-SSN.
  7460         16  CL-COMPANY-CD-A2        PIC X.
  7461         16  CL-SOC-SEC-NO.
  7462             20  CL-SSN-STATE        PIC XX.
  7463             20  CL-SSN-ACCOUNT      PIC X(6).
  7464             20  CL-SSN-LN3          PIC X(3).
  7465
  7466     12  CL-CONTROL-BY-CERT-NO.
  7467         16  CL-COMPANY-CD-A4        PIC X.
  7468         16  CL-CERT-NO-A4.
  7469             20  CL-CERT-A4-PRIME    PIC X(10).
  7470             20  CL-CERT-A4-SFX      PIC X.
  7471
  7472     12  CL-CONTROL-BY-CCN.
  7473         16  CL-COMPANY-CD-A5        PIC X.
  7474         16  CL-CCN-A5.
  7475             20  CL-CCN.
  7476                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7477                 24  CL-CCN-PRIME-A5 PIC X(12).
  7478             20  CL-CCN-FILLER-A5    PIC X(4).
  7479
  7480     12  CL-INSURED-PROFILE-DATA.
  7481         16  CL-INSURED-BIRTH-DT     PIC XX.
  7482         16  CL-INSURED-SEX-CD       PIC X.
  7483             88  INSURED-IS-MALE        VALUE 'M'.
  7484             88  INSURED-IS-FEMALE      VALUE 'F'.
  7485             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7486         16  CL-INSURED-OCC-CD       PIC X(6).
  7487         16  FILLER                  PIC X(5).
  7488
  7489     12  CL-PROCESSING-INFO.
  7490         16  CL-PROCESSOR-ID         PIC X(4).
  7491         16  CL-CLAIM-STATUS         PIC X.
  7492             88  CLAIM-IS-OPEN          VALUE 'O'.
  7493             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7494         16  CL-CLAIM-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 138
* EL6311.cbl
  7495*            88  AH-CLAIM               VALUE 'A'.
  7496*            88  LIFE-CLAIM             VALUE 'L'.
  7497*            88  PROPERTY-CLAIM         VALUE 'P'.
  7498*            88  IUI-CLAIM              VALUE 'I'.
  7499*            88  GAP-CLAIM              VALUE 'G'.
  7500         16  CL-CLAIM-PREM-TYPE      PIC X.
  7501             88  SINGLE-PREMIUM         VALUE '1'.
  7502             88  O-B-COVERAGE           VALUE '2'.
  7503             88  OPEN-END-COVERAGE      VALUE '3'.
  7504         16  CL-INCURRED-DT          PIC XX.
  7505         16  CL-REPORTED-DT          PIC XX.
  7506         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7507         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7508         16  CL-LAST-PMT-DT          PIC XX.
  7509         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7510         16  CL-PAID-THRU-DT         PIC XX.
  7511         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7512         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7513         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7514         16  CL-PMT-CALC-METHOD      PIC X.
  7515             88  CL-360-DAY-YR          VALUE '1'.
  7516             88  CL-365-DAY-YR          VALUE '2'.
  7517             88  CL-FULL-MONTHS         VALUE '3'.
  7518         16  CL-CAUSE-CD             PIC X(6).
  7519
  7520         16  CL-PRIME-CERT-NO.
  7521             20  CL-PRIME-CERT-PRIME PIC X(10).
  7522             20  CL-PRIME-CERT-SFX   PIC X.
  7523
  7524         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7525             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7526             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7527
  7528         16  CL-MICROFILM-NO         PIC X(10).
  7529         16  CL-PROG-FORM-TYPE       PIC X.
  7530         16  CL-LAST-ADD-ON-DT       PIC XX.
  7531
  7532         16  CL-LAST-REOPEN-DT       PIC XX.
  7533         16  CL-LAST-CLOSE-DT        PIC XX.
  7534         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7535             88  FINAL-PAID             VALUE '1'.
  7536             88  CLAIM-DENIED           VALUE '2'.
  7537             88  AUTO-CLOSE             VALUE '3'.
  7538             88  MANUAL-CLOSE           VALUE '4'.
  7539             88  BENEFITS-CHANGED       VALUE 'C'.
  7540             88  SETUP-ERRORS           VALUE 'E'.
  7541         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7542         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7543         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7544             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7545         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7546         16  FILLER                  PIC X.
  7547
  7548     12  CL-CERTIFICATE-DATA.
  7549         16  CL-CERT-ORIGIN          PIC X.
  7550             88  CERT-WAS-ONLINE        VALUE '1'.
  7551             88  CERT-WAS-CREATED       VALUE '2'.
  7552             88  COVERAGE-WAS-ADDED     VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 139
* EL6311.cbl
  7553         16  CL-CERT-KEY-DATA.
  7554             20  CL-CERT-CARRIER     PIC X.
  7555             20  CL-CERT-GROUPING    PIC X(6).
  7556             20  CL-CERT-STATE       PIC XX.
  7557             20  CL-CERT-ACCOUNT.
  7558                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7559                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7560             20  CL-CERT-EFF-DT      PIC XX.
  7561
  7562     12  CL-STATUS-CONTROLS.
  7563         16  CL-PRIORITY-CD          PIC X.
  7564             88  CONFIDENTIAL-DATA      VALUE '8'.
  7565             88  HIGHEST-PRIORITY       VALUE '9'.
  7566         16  CL-SUPV-ATTN-CD         PIC X.
  7567             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7568             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7569         16  CL-PURGED-DT            PIC XX.
  7570         16  CL-RESTORED-DT          PIC XX.
  7571         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7572         16  CL-NEXT-RESEND-DT       PIC XX.
  7573         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7574         16  CL-CRITICAL-PERIOD      PIC 99.
  7575*        16  FILLER                  PIC XX.
  7576         16  CL-LAST-MAINT-DT        PIC XX.
  7577         16  CL-LAST-MAINT-USER      PIC X(4).
  7578         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7579         16  CL-LAST-MAINT-TYPE      PIC X.
  7580             88  CLAIM-SET-UP           VALUE ' '.
  7581             88  PAYMENT-MADE           VALUE '1'.
  7582             88  LETTER-SENT            VALUE '2'.
  7583             88  MASTER-WAS-ALTERED     VALUE '3'.
  7584             88  MASTER-WAS-RESTORED    VALUE '4'.
  7585             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7586             88  FILE-CONVERTED         VALUE '6'.
  7587             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7588             88  ERROR-CORRECTION       VALUE 'E'.
  7589         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7590         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7591         16  CL-BENEFICIARY          PIC X(10).
  7592         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7593         16  CL-DENIAL-TYPE          PIC X.
  7594             88  CL-TYPE-DENIAL          VALUE '1'.
  7595             88  CL-TYPE-RESCISSION      VALUE '2'.
  7596             88  CL-TYPE-REFORMATION     VALUE '3'.
  7597             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7598             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7599         16  CL-CRIT-PER-RECURRENT   PIC X.
  7600         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7601         16  CL-RTW-DT               PIC XX.
  7602
  7603     12  CL-TRAILER-CONTROLS.
  7604         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7605             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7606             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7607             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7608         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7609         16  FILLER                  PIC XX.
  7610         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 140
* EL6311.cbl
  7611         16  CL-ADDRESS-TRAILER-CNT.
  7612             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7613                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7614             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7615                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7616             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7617                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7618             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7619                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7620             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7621                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7622             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7623                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7624             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7625                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7626
  7627     12  CL-CV-REFERENCE-NO.
  7628         16  CL-CV-REFNO-PRIME       PIC X(18).
  7629         16  CL-CV-REFNO-SFX         PIC XX.
  7630
  7631     12  CL-FILE-LOCATION            PIC X(4).
  7632
  7633     12  CL-PROCESS-ERRORS.
  7634         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7635             88  NO-FATAL-ERRORS        VALUE ZERO.
  7636         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7637             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7638
  7639     12  CL-PRODUCT-CD               PIC X.
  7640
  7641     12  CL-CURRENT-KEY-DATA.
  7642         16  CL-CURRENT-CARRIER      PIC X.
  7643         16  CL-CURRENT-GROUPING     PIC X(6).
  7644         16  CL-CURRENT-STATE        PIC XX.
  7645         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7646
  7647     12  CL-ASSOCIATES               PIC X.
  7648         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7649         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7650         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7651         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7652
  7653     12  CL-ACTIVITY-CODE            PIC 99.
  7654     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7655     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7656
  7657     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7658     12  CL-LAG-REPORT-CODE          PIC 9.
  7659     12  CL-LOAN-TYPE                PIC XX.
  7660     12  CL-LEGAL-STATE              PIC XX.
  7661
  7662     12  CL-YESNOSW                  PIC X.
  7663     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7664         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7665         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7666         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7667     12  cl-insured-claim            pic x.
  7668         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 141
* EL6311.cbl
  7669         88  cl-claim-on-secondary       value 'S'.
  7670     12  cl-benefit-expiration-dt    PIC XX.
  7671*                                COPY ERCENDT.
  7672******************************************************************
  7673*                                                                *
  7674*                                                                *
  7675*                            ERCENDT.                            *
  7676*                            VMOD=2.001                          *
  7677*                                                                *
  7678*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7679*                                                                *
  7680*   FILE TYPE = VSAM,KSDS                                        *
  7681*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7682*                                                                *
  7683*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7684*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7685*                                                                *
  7686*   LOG = NO                                                     *
  7687*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7688******************************************************************
  7689*-----------------------------------------------------------------
  7690*                   C H A N G E   L O G
  7691*
  7692* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7693*-----------------------------------------------------------------
  7694*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7695* EFFECTIVE    NUMBER
  7696*-----------------------------------------------------------------
  7697* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7698*                                WITH OPEN CLAIMS
  7699* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7700* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7701* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7702*-----------------------------------------------------------------
  7703 01  ENDORSEMENT-RECORD.
  7704     12  EN-RECORD-ID                PIC XX.
  7705         88  VALID-EN-ID                VALUE 'EN'.
  7706     12  EN-CONTROL-PRIMARY.
  7707         16  EN-COMPANY-CD           PIC X.
  7708         16  EN-CARRIER              PIC X.
  7709         16  EN-GROUPING             PIC X(6).
  7710         16  EN-STATE                PIC XX.
  7711         16  EN-ACCOUNT              PIC X(10).
  7712         16  EN-CERT-EFF-DT          PIC XX.
  7713         16  EN-CERT-NO.
  7714             20  EN-CERT-PRIME       PIC X(10).
  7715             20  EN-CERT-SFX         PIC X.
  7716         16  EN-REC-TYPE             PIC X.
  7717             88  EN-ISSUE               VALUE 'I'.
  7718             88  EN-CANCELLATION        VALUE 'C'.
  7719         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7720     12  EN-CONTROL-BY-ARCH-NO.
  7721         16  EN-COMPANY-CD-A1              PIC X.
  7722         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7723     12  EN-LAST-MAINT-DT            PIC XX.
  7724     12  EN-LAST-MAINT-BY            PIC X(4).
  7725     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7726     12  EN-ENDORSEMENT-RECORD       PIC X(329).
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 142
* EL6311.cbl
  7727     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7728         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7729         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7730         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7731         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7732         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7733         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7734         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7735         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7736         16  EN-LF-ORIG-BENCD        PIC XX.
  7737         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7738         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7739         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7740         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7741         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7742         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7743*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7744         16  EN-ORIG-CRED-BENE       PIC X(25).
  7745         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7746         16  FILLER                  PIC X.
  7747         16  EN-AH-ORIG-BENCD        PIC XX.
  7748         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7749         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7750         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7751         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7752*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7753*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7754         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7755         16  F                       PIC X(09).
  7756         16  EN-AH-ORIG-CP           PIC 99.
  7757         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7758         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7759         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7760         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7761         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7762         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7763         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7764         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7765         16  EN-LF-NEW-BENCD         PIC XX.
  7766         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7767         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7768         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7769         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7770         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7771         16  EN-LF-NEW-EXP-DT        PIC XX.
  7772         16  EN-NEW-CRED-BENE        PIC X(25).
  7773         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7774         16  FILLER                  PIC X.
  7775         16  EN-AH-NEW-BENCD         PIC XX.
  7776         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7777         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7778         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7779         16  EN-AH-NEW-EXP-DT        PIC XX.
  7780*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7781*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7782*        16  F                       PIC X(12).
  7783         16  EN-AH-NEW-CP            PIC 99.
  7784         16  EN-SIG-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 143
* EL6311.cbl
  7785         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7786         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7787         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7788         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7789         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7790         16  FILLER                  PIC X(33).
  7791     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7792         16  EN-LF-ORIG-REF-DT       PIC XX.
  7793         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7794         16  EN-AH-ORIG-REF-DT       PIC XX.
  7795         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7796         16  EN-LF-NEW-REF-DT        PIC XX.
  7797         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7798         16  EN-AH-NEW-REF-DT        PIC XX.
  7799         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7800         16  EN-FLAG-CERT            PIC X.
  7801         16  EN-INS-LAST-NAME        PIC X(15).
  7802         16  EN-INS-FIRST-NAME       PIC X(10).
  7803         16  EN-INS-MIDDLE-INIT      PIC X.
  7804         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7805         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7806         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7807         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7808         16  FILLER                  PIC X(262).
  7809     12  EN-MONEY-SW             PIC X.
  7810     12  EN-HEALTH-APP           PIC X.
  7811     12  EN-VOUCHER-SW           PIC X.
  7812     12  EN-PAYEE                PIC X(14).
  7813     12  EN-INPUT-DT             PIC XX.
  7814     12  EN-PROCESS-DT           PIC XX.
  7815     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7816     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7817     12  EN-REASON-CODES.
  7818         16  F OCCURS 12.
  7819             20  EN-REASON-CODE  PIC X(4).
  7820     12  EN-TEMPLATE-USED        PIC X(8).
  7821     12  EN-DOCU-TYPE            PIC X.
  7822         88  EN-VERI-DOCU          VALUE 'V'.
  7823         88  EN-GCE-DOCU           VALUE 'G'.
  7824         88  EN-CANC-DOCU          VALUE 'C'.
  7825     12  EN-COMMENTS1            PIC X(13).
  7826     12  EN-COMMENTS2            PIC X(70).
  7827     12  EN-COMM-CHGBK           PIC X.
  7828         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7829         88  EN-CHG-ACCT           VALUE 'Y'.
  7830     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7831     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7832     12  EN-BATCH-NUMBER         PIC X(6).
  7833     12  EN-ACCT-SUMM            PIC X.
  7834     12  EN-CSO-SUMM             PIC X.
  7835     12  FILLER                  PIC X(13).
  7836******************************************************************
  7837*                                COPY ELCCRTT.
  7838******************************************************************
  7839*                                                                *
  7840*                            ELCCRTT.                            *
  7841*                                                                *
  7842*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 144
* EL6311.cbl
  7843*                                                                *
  7844*   FILE TYPE = VSAM,KSDS                                        *
  7845*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7846*                                                                *
  7847*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7848*                                                                *
  7849*   LOG = YES                                                    *
  7850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7851******************************************************************
  7852*                   C H A N G E   L O G
  7853*
  7854* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7855*-----------------------------------------------------------------
  7856*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7857* EFFECTIVE    NUMBER
  7858*-----------------------------------------------------------------
  7859* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7860* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7861* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7862* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7863* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7864******************************************************************
  7865
  7866 01  CERTIFICATE-TRAILERS.
  7867     12  CS-RECORD-ID                      PIC XX.
  7868         88  VALID-CS-ID                      VALUE 'CS'.
  7869
  7870     12  CS-CONTROL-PRIMARY.
  7871         16  CS-COMPANY-CD                 PIC X.
  7872         16  CS-CARRIER                    PIC X.
  7873         16  CS-GROUPING                   PIC X(6).
  7874         16  CS-STATE                      PIC XX.
  7875         16  CS-ACCOUNT                    PIC X(10).
  7876         16  CS-CERT-EFF-DT                PIC XX.
  7877         16  CS-CERT-NO.
  7878             20  CS-CERT-PRIME             PIC X(10).
  7879             20  CS-CERT-SFX               PIC X.
  7880         16  CS-TRAILER-TYPE               PIC X.
  7881             88  COMM-TRLR           VALUE 'A'.
  7882             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7883             88  CERT-DATA-TRLR      VALUE 'C'.
  7884
  7885     12  CS-DATA-AREA                      PIC X(516).
  7886
  7887     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7888         16  CS-BANK-COMMISSION-AREA.
  7889             20  CS-BANK-COMMS       OCCURS 10.
  7890                 24  CS-AGT                PIC X(10).
  7891                 24  CS-COM-TYP            PIC X.
  7892                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7893                 24  CS-RECALC-LV-INDIC    PIC X.
  7894                 24  FILLER                PIC X(10).
  7895         16  FILLER                        PIC X(256).
  7896
  7897     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7898****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7899****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7900         16  CS-MB-CLAIM-DATA OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 145
* EL6311.cbl
  7901             20  FILLER OCCURS 10.
  7902                 24  CS-CLAIM-TYPE         PIC X.
  7903                     88  CS-AH-CLM           VALUE 'A'.
  7904                     88  CS-IU-CLM           VALUE 'I'.
  7905                     88  CS-GP-CLM           VALUE 'G'.
  7906                     88  CS-LF-CLM           VALUE 'L'.
  7907                     88  CS-PR-CLM           VALUE 'P'.
  7908                 24  CS-BANK               PIC S999 COMP-3.
  7909                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7910                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7911                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7912         16  FILLER                        PIC X(216).
  7913     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7914         16  CS-VIN-NUMBER                 PIC X(17).
  7915         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7916         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7917         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7918         16  FILLER                        PIC X(496).
  7919******************************************************************
  7920*                                COPY ERCCHEK.
  7921******************************************************************
  7922*                                                                *
  7923*                                                                *
  7924*                            ERCCHEK                             *
  7925*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7926*                            VMOD=2.008                          *
  7927*                                                                *
  7928*   FILE DESCRIPTION = CHECK RECORDS                             *
  7929*                                                                *
  7930*   FILE TYPE = VSAM,KSDS                                        *
  7931*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7932*                                                                *
  7933*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7934*       ALTERNATE INDEX = NONE                                   *
  7935*                                                                *
  7936*   LOG = YES                                                    *
  7937*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7938******************************************************************
  7939*                   C H A N G E   L O G
  7940*
  7941* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7942*-----------------------------------------------------------------
  7943*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7944* EFFECTIVE    NUMBER
  7945*-----------------------------------------------------------------
  7946* 021414    2003053000001  PEMA  changes for auto chk request
  7947******************************************************************
  7948 01  CHECK-RECORDS.
  7949     12  CH-RECORD-ID                      PIC XX.
  7950         88  VALID-CH-ID                      VALUE 'CH'.
  7951
  7952     12  CH-CONTROL-PRIMARY.
  7953         16  CH-COMPANY-CD                 PIC X.
  7954         16  CH-CARRIER                    PIC X.
  7955         16  CH-GROUPING                   PIC X(6).
  7956         16  CH-STATE                      PIC XX.
  7957         16  CH-ACCOUNT                    PIC X(10).
  7958         16  CH-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 146
* EL6311.cbl
  7959         16  CH-CERT-NO.
  7960             20  CH-CERT-PRIME             PIC X(10).
  7961             20  CH-CERT-SFX               PIC X.
  7962         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7963
  7964     12  CH-RECORDED-DT                    PIC XX.
  7965     12  CH-RECORDED-BY                    PIC X(4).
  7966     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  7967
  7968     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  7969     12  CH-CHECK-NO                       PIC X(7).
  7970     12  CH-REASON-FOR-CHECK               PIC X(25).
  7971     12  CH-CHECK-WRITTEN-DT               PIC XX.
  7972     12  FILLER                            PIC X.
  7973
  7974     12  CH-PAYEE-INFO.
  7975         16  CH-PAYEE-NAME-1               PIC X(30).
  7976         16  CH-PAYEE-NAME-2               PIC X(30).
  7977         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  7978         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  7979         16  CH-PAYEE-CITY-ST.
  7980             20  CH-PAYEE-CITY             PIC X(28).
  7981             20  CH-PAYEE-STATE            PIC XX.
  7982         16  CH-PAYEE-ZIP-CODE.
  7983             20  CH-PAYEE-ZIP.
  7984                 24  CH-ZIP-PRI-1ST        PIC X.
  7985                     88  CH-CANADIAN-POST-CODE
  7986                                           VALUES 'A' THRU 'Z'.
  7987                 24  FILLER                PIC X(4).
  7988             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  7989         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  7990             20  CH-CAN-POSTAL-1           PIC XXX.
  7991             20  CH-CAN-POSTAL-2           PIC XXX.
  7992             20  FILLER                    PIC XXX.
  7993
  7994     12  CH-CHECK-STUB-TEXT.
  7995         16  CH-STUB-LINE-1                PIC X(30).
  7996         16  CH-TEXT-LINE-1                PIC X(50).
  7997         16  CH-TEXT-LINE-2                PIC X(50).
  7998         16  CH-TEXT-LINE-3                PIC X(40).
  7999     12  CH-RETURN-TO                      PIC X(30).
  8000
  8001     12  CH-COMPENSATION-CONTROL.
  8002         16  CH-COMP-CARRIER               PIC X.
  8003         16  CH-COMP-GROUPING              PIC X(6).
  8004         16  CH-COMP-FIN-RESP              PIC X(10).
  8005         16  CH-COMP-ACCOUNT               PIC X(10).
  8006
  8007     12  CH-CREDIT-SELECT-DT               PIC XX.
  8008     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8009     12  CH-PAYEE-CODE                     PIC X(6).
  8010
  8011     12  CH-VOID-DATA.
  8012         20  CH-VOID-DT                    PIC XX.
  8013         20  CH-VOID-BY                    PIC X(4).
  8014         20  CH-VOID-REASON                PIC X(25).
  8015
  8016     12  CH-APPROVAL-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 147
* EL6311.cbl
  8017         20  CH-APPROVAL-DT                PIC XX.
  8018         20  CH-APPROVAL-STATUS            PIC X.
  8019             88  CH-IN-LIMBO                  VALUE ' '.
  8020             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8021             88  CH-APPROVED                  VALUE 'A'.
  8022             88  CH-DENIED                    VALUE 'D'.
  8023         20  CH-APPROVED-BY                PIC XXXX.
  8024     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8025             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8026     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8027
  8028     12  ch-released-dt                    pic xx.
  8029     12  ch-check-cashed-dt                pic xx.
  8030     12  FILLER                            PIC X.
  8031*    12  CH-CHECK-REFERENCE                PIC X(12).
  8032     12  CH-CHECK-ORIGIN-SW                PIC X.
  8033             88  CH-REFUND-CHECK              VALUE 'R'.
  8034             88  CH-MAINT-CHECK               VALUE 'M'.
  8035
  8036     12  CH-CANC-DT                        PIC XX.
  8037     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8038     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8039
  8040     12  CH-INSURED-NAME                   PIC X(28).
  8041
  8042     12  ch-released-by                    pic x(4).
  8043     12  ch-csr                            pic x(4).
  8044     12  ch-deduct-commission              pic x.
  8045         88  ch-deduct-comm                  value 'Y'.
  8046         88  ch-do-not-deduct-comm           value 'N'.
  8047
  8048     12  FILLER                            PIC X(11).
  8049*    12  CH-LETTER-TABLE.
  8050*        16  CH-LETTERS OCCURS 3 TIMES
  8051*                       INDEXED BY CH-LT-NDX
  8052*                                          PIC X(04).
  8053
  8054     12  FILLER                            PIC X(07).
  8055
  8056 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8057                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8058                          PENDING-MAILING-DATA MAILING-DATA
  8059                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8060                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8061                          CLAIM-MASTER ENDORSEMENT-RECORD
  8062                          CERTIFICATE-TRAILERS CHECK-RECORDS.
  8063 0000-DFHEXIT SECTION.
  8064     MOVE '9#                    $   ' TO DFHEIV0.
  8065     MOVE 'EL6311' TO DFHEIV1.
  8066     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8067
  8068     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8069     MOVE EIBTRMID               TO QID-TERM.
  8070     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8071     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8072     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8073     MOVE 2                      TO EMI-SWITCH2.
  8074
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 148
* EL6311.cbl
  8075     IF EIBCALEN = 0
  8076         GO TO 8800-UNAUTHORIZED-ACCESS.
  8077
  8078     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8079     MOVE '5'                   TO DC-OPTION-CODE.
  8080     PERFORM 9700-DATE-LINK.
  8081     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8082     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8083
  8084     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8085     MOVE SPACE                  TO DC-OPTION-CODE.
  8086     PERFORM 9700-DATE-LINK.
  8087     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8088     MOVE LOW-VALUES             TO EL631BI.
  8089
  8090
  8091* EXEC CICS HANDLE CONDITION
  8092*        PGMIDERR  (9600-PGMID-ERROR)
  8093*        ERROR     (9990-ABEND)
  8094*        INVREQ    (9990-ABEND)
  8095*        QIDERR    (0010-MAIN-LOGIC)
  8096*    END-EXEC.
  8097*    MOVE '"$L.8N                ! " #00008086' TO DFHEIV0
  8098     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8100     MOVE X'2220233030303038303836' TO DFHEIV0(25:11)
  8101     CALL 'kxdfhei1' USING DFHEIV0
  8102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8103
  8104
  8105     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8106         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8107             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8108             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8109             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8110             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8111             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8112             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8113             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8114             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8115
  8116             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8117                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8118
  8119             ELSE
  8120                 NEXT SENTENCE
  8121
  8122         ELSE
  8123             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8124             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8125             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8126             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8127             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8128             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8129             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8130             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8131             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8132             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 149
* EL6311.cbl
  8133             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8134             GO TO 3900-RE-DISPLAY-RECORD
  8135     ELSE
  8136         GO TO 0020-MAIN-LOGIC.
  8137
  8138 0010-MAIN-LOGIC.
  8139     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8140                                    WS-FIRST-ENTRY-SW.
  8141
  8142     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8143
  8144     MOVE LOW-VALUES             TO EC-NEW-CERT
  8145                                    EC-NEW-STATE.
  8146
  8147     IF PI-DISPLAY-ORIGINAL-BATCH
  8148         NEXT SENTENCE
  8149     ELSE
  8150         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8151             GO TO 5000-BROWSE-BATCH-HEADERS.
  8152
  8153     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8154         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8155
  8156     IF PI-CSR-BROWSE
  8157        GO TO 4200-BROWSE-CSR-FORWARD.
  8158
  8159     IF PI-FILE-BROWSE
  8160         GO TO 4300-BROWSE-FILE-FORWARD.
  8161
  8162     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8163
  8164 0020-MAIN-LOGIC.
  8165     IF EIBAID = DFHCLEAR
  8166         GO TO 9400-CLEAR.
  8167
  8168     MOVE LOW-VALUES             TO EC-NEW-CERT
  8169                                    EC-NEW-STATE.
  8170
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 150
* EL6311.cbl
  8172
  8173******************************************************************
  8174*                                                                *
  8175*              R E C E I V E   M A P                             *
  8176*                                                                *
  8177******************************************************************
  8178
  8179 0200-RECEIVE.
  8180     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8181         MOVE ER-0008            TO EMI-ERROR
  8182         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8183         IF PI-MAP-NAME = EL631B
  8184             MOVE -1                 TO BMAINTL
  8185             GO TO 8200-SEND-DATAONLY
  8186         ELSE
  8187             IF PI-MAP-NAME = EL631C
  8188                 MOVE -1                 TO CMAINTL
  8189                 GO TO 8200-SEND-DATAONLY
  8190             ELSE
  8191                 IF PI-MAP-NAME = EL631D
  8192                     MOVE -1                 TO DPFENTRL
  8193                     GO TO 8200-SEND-DATAONLY.
  8194
  8195
  8196* EXEC CICS RECEIVE
  8197*        MAP      (PI-MAP-NAME)
  8198*        MAPSET   (MAPSET-EL6311S)
  8199*        INTO     (EL631BI)
  8200*    END-EXEC.
  8201     MOVE LENGTH OF
  8202      EL631BI
  8203       TO DFHEIV11
  8204*    MOVE '8"T I  L              ''   #00008183' TO DFHEIV0
  8205     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8206     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8207     MOVE X'2020233030303038313833' TO DFHEIV0(25:11)
  8208     CALL 'kxdfhei1' USING DFHEIV0,
  8209           PI-MAP-NAME,
  8210           EL631BI,
  8211           DFHEIV11,
  8212           MAPSET-EL6311S,
  8213           DFHEIV99,
  8214           DFHEIV99
  8215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8216
  8217
  8218******************************************************************
  8219*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8220******************************************************************
  8221
  8222     IF BTYPE-LEN (1) EQUAL +3
  8223        IF BTYPE (1) EQUAL ALL ' '
  8224            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8225
  8226     IF BTYPE-LEN (2) EQUAL +3
  8227        IF BTYPE (2) EQUAL ALL ' '
  8228            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8229
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 151
* EL6311.cbl
  8230     INSPECT EL631BI CONVERTING '_' TO ' '.
  8231
  8232     IF PI-MAP-NAME = EL631B
  8233         IF BPFENTRL GREATER THAN ZEROS
  8234             IF EIBAID NOT = DFHENTER
  8235                 MOVE ER-0004       TO EMI-ERROR
  8236                 MOVE -1            TO BPFENTRL
  8237                 MOVE AL-UNBOF      TO BPFENTRA
  8238                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8239                 GO TO 8200-SEND-DATAONLY
  8240             ELSE
  8241                 IF BPFENTRI NUMERIC AND
  8242                   (BPFENTRI GREATER 0 AND LESS 25)
  8243                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8244                 ELSE
  8245                     MOVE ER-0029  TO EMI-ERROR
  8246                     MOVE AL-UNBON TO BPFENTRA
  8247                     MOVE -1       TO BPFENTRL
  8248                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8249                     GO TO 8200-SEND-DATAONLY
  8250         ELSE
  8251             NEXT SENTENCE
  8252     ELSE
  8253         IF PI-MAP-NAME = EL631C
  8254            IF CPFENTRL GREATER THAN ZEROS
  8255                IF EIBAID NOT = DFHENTER
  8256                 MOVE ER-0004         TO EMI-ERROR
  8257                 MOVE -1              TO CPFENTRL
  8258                 MOVE AL-UNBOF        TO CPFENTRA
  8259                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8260                 GO TO 8200-SEND-DATAONLY
  8261             ELSE
  8262                 IF CPFENTRI NUMERIC AND
  8263                   (CPFENTRI GREATER 0 AND LESS 25)
  8264                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8265                 ELSE
  8266                     MOVE ER-0029      TO EMI-ERROR
  8267                     MOVE AL-UNBON     TO CPFENTRA
  8268                     MOVE -1           TO CPFENTRL
  8269                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8270                     GO TO 8200-SEND-DATAONLY
  8271         ELSE
  8272             NEXT SENTENCE
  8273     ELSE
  8274     IF PI-MAP-NAME = EL631D
  8275         IF DPFENTRL GREATER THAN ZEROS
  8276             IF EIBAID NOT = DFHENTER
  8277                 MOVE ER-0004         TO EMI-ERROR
  8278                 MOVE -1              TO DPFENTRL
  8279                 MOVE AL-UNBOF        TO DPFENTRA
  8280                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8281                 GO TO 8200-SEND-DATAONLY
  8282             ELSE
  8283                 IF DPFENTRI NUMERIC AND
  8284                   (DPFENTRI GREATER 0 AND LESS 25)
  8285                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8286                 ELSE
  8287                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 152
* EL6311.cbl
  8288                     MOVE AL-UNBON     TO DPFENTRA
  8289                     MOVE -1           TO DPFENTRL
  8290                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8291                     GO TO 8200-SEND-DATAONLY.
  8292
  8293     IF EIBAID = DFHPF23
  8294         GO TO 8810-PF23.
  8295
  8296     IF EIBAID = DFHPF24
  8297         GO TO 9200-RETURN-MAIN-MENU.
  8298
  8299     IF EIBAID = DFHPF12
  8300         GO TO 9500-PF12.
  8301
  8302     IF PI-MAP-NAME = EL631B
  8303        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8304
  8305     IF PI-MAP-NAME = EL631C
  8306        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8307
  8308     IF PI-MAP-NAME = EL631D
  8309        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8310
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 153
* EL6311.cbl
  8312
  8313******************************************************************
  8314*                                                                *
  8315*      ISSUE SCREEN PF KEY CHECKING                              *
  8316*                                                                *
  8317******************************************************************
  8318
  8319******************************************************************
  8320*                                                                *
  8321*      PF KEY FUNCTIONS:                                         *
  8322*                                                                *
  8323*      PF1  = BROWSE FORWARD                                     *
  8324*      PF2  = BROWSE BACKWARD                                    *
  8325*      PF3  = CERTIFICATE LOOKUP                                 *
  8326*      PF4  = DISPLAY BATCH HEADER                               *
  8327*      PF5  = ADD ISSUE  SCREEN                                  *
  8328*      PF6  = ADD CANCEL SCREEN                                  *
  8329*      PF7  = CERTIFICATE DISPLAY                                *
  8330*      PF8  = CERTIFICATE NOTES                                  *
  8331*      PF9  = EDIT CONTROL                                       *
  8332*      PF10 = DISPLAY LETTER SCREEN                              *
  8333*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8334*      PF12 = HELP SCREEN                                        *
  8335*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8336*      PF14 = ACCOUNT MASTER                                     *
  8337*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8338*      PF16 = DISPLAY LETTER REVIEW                              *
  8339*                                                                *
  8340******************************************************************
  8341
  8342 0300-CHECK-ISSUE-PF-KEYS.
  8343     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8344        MOVE ER-2337            TO EMI-ERROR
  8345        MOVE -1                  TO BMAINTL
  8346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8347        GO TO 8200-SEND-DATAONLY.
  8348
  8349     IF EIBAID = DFHPF1
  8350        MOVE '0'                TO PI-EDIT-SW
  8351        IF PI-PRIMARY-BROWSE
  8352           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8353        ELSE
  8354           IF PI-PRIMARY-WITH-SELECT
  8355              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8356           ELSE
  8357              IF PI-FILE-BROWSE
  8358                 GO TO 4300-BROWSE-FILE-FORWARD
  8359              ELSE
  8360                 IF PI-CSR-BROWSE
  8361                    GO TO 4200-BROWSE-CSR-FORWARD
  8362                 ELSE
  8363                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8364
  8365     IF EIBAID = DFHPF2
  8366        MOVE '0'                TO PI-EDIT-SW
  8367        IF PI-PRIMARY-BROWSE
  8368           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8369        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 154
* EL6311.cbl
  8370           IF PI-PRIMARY-WITH-SELECT
  8371              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8372           ELSE
  8373              IF PI-FILE-BROWSE
  8374                 GO TO 4800-BROWSE-FILE-BACKWARD
  8375              ELSE
  8376                 IF PI-CSR-BROWSE
  8377                    GO TO 4900-BROWSE-CSR-BACKWARD
  8378                 ELSE
  8379                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8380
  8381     IF EIBAID = DFHPF3
  8382        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8383        MOVE XCTL-EL127         TO PGM-NAME
  8384        GO TO 9300-XCTL.
  8385
  8386     IF (EIBAID = DFHPF15 OR DFHPF6)
  8387        AND (CSR-EDIT-SESSION)
  8388*       AND (FATAL-OR-UNFORCED)
  8389        AND (FATAL-ERRORS)
  8390        MOVE ER-1819             TO EMI-ERROR
  8391        MOVE -1                  TO BMAINTL
  8392        MOVE AL-UANON            TO BMAINTA
  8393        PERFORM 9900-ERROR-FORMAT
  8394                                 THRU 9900-EXIT
  8395        GO TO 8200-SEND-DATAONLY
  8396     END-IF
  8397     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8398      OR (EIBAID = DFHPF10)
  8399        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8400        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8401        IF (RESP-NORMAL)
  8402           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8403              AM-CONTROL-PRIMARY (1:20))
  8404            IF AM-NAME NOT GREATER THAN SPACES OR
  8405               AM-ADDRS NOT GREATER THAN SPACES  OR
  8406               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8407               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8408               AM-ZIP NOT GREATER THAN SPACES
  8409               MOVE ER-3834             TO EMI-ERROR
  8410               MOVE -1                  TO BMAINTL
  8411               MOVE AL-UANON            TO BMAINTA
  8412               PERFORM 9900-ERROR-FORMAT
  8413                                 THRU 9900-EXIT
  8414               GO TO 8200-SEND-DATAONLY
  8415            END-IF
  8416        ELSE
  8417           MOVE ER-1609             TO EMI-ERROR
  8418           MOVE -1                  TO BMAINTL
  8419           MOVE AL-UANON            TO BMAINTA
  8420           PERFORM 9900-ERROR-FORMAT
  8421                                THRU 9900-EXIT
  8422           GO TO 8200-SEND-DATAONLY
  8423        END-IF
  8424
  8425        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8426        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8427        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 155
* EL6311.cbl
  8428            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8429               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8430               MA-CITY NOT GREATER THAN SPACES OR
  8431               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8432               MA-ZIP-CODE NOT GREATER THAN SPACES
  8433               MOVE ER-3835             TO EMI-ERROR
  8434               MOVE -1                  TO BMAINTL
  8435               MOVE AL-UANON            TO BMAINTA
  8436               PERFORM 9900-ERROR-FORMAT
  8437                                 THRU 9900-EXIT
  8438               GO TO 8200-SEND-DATAONLY
  8439            END-IF
  8440        ELSE
  8441           MOVE ER-3000             TO EMI-ERROR
  8442           MOVE -1                  TO BMAINTL
  8443           MOVE AL-UANON            TO BMAINTA
  8444           PERFORM 9900-ERROR-FORMAT
  8445                                THRU 9900-EXIT
  8446           GO TO 8200-SEND-DATAONLY
  8447        END-IF
  8448
  8449     END-IF
  8450     IF (EIBAID = DFHPF15)
  8451        AND (CSR-EDIT-SESSION)
  8452        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8453        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8454        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8455        MOVE PI-SV-STATE         TO PI-STATE
  8456        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8457        MOVE BCERTNOI            TO PI-CERT-PRIME
  8458        MOVE BSUFIXI             TO PI-CERT-SFX
  8459        MOVE BEFFDTI             TO DEEDIT-FIELD
  8460        PERFORM 8600-DEEDIT
  8461        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8462        MOVE '4'                 TO DC-OPTION-CODE
  8463        PERFORM 9700-DATE-LINK
  8464        IF DATE-CONVERSION-ERROR
  8465           MOVE ER-0348          TO EMI-ERROR
  8466           MOVE -1               TO BEFFDTL
  8467           MOVE AL-UABON         TO BEFFDTA
  8468           PERFORM 9900-ERROR-FORMAT
  8469                                 THRU 9900-EXIT
  8470           GO TO 8200-SEND-DATAONLY
  8471        ELSE
  8472           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8473           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8474           MOVE XCTL-EL6315      TO PGM-NAME
  8475           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8476           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8477           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8478           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8479           GO TO 9300-XCTL
  8480        END-IF
  8481     END-IF
  8482
  8483     IF EIBAID = DFHPF4
  8484        MOVE '0'                TO PI-EDIT-SW
  8485        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 156
* EL6311.cbl
  8486           NEXT SENTENCE
  8487        ELSE
  8488           GO TO 7200-DISPLAY-BATCHES.
  8489
  8490     IF EIBAID = DFHPF5
  8491        MOVE ER-0029                TO EMI-ERROR
  8492        MOVE -1                     TO BPFENTRL
  8493        MOVE AL-UNBON               TO BPFENTRA
  8494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8495        GO TO 8200-SEND-DATAONLY.
  8496*        MOVE '0'                TO PI-EDIT-SW
  8497*        IF PI-DISPLAY-ORIGINAL-BATCH
  8498*           NEXT SENTENCE
  8499*        ELSE
  8500*           MOVE EL631B              TO PI-MAP-NAME
  8501*           MOVE LOW-VALUES          TO EL631BI
  8502*           MOVE 'A'                 TO BMAINTO
  8503*           MOVE AL-UANON            TO BMAINTA
  8504*           MOVE -1                  TO BMAINTL
  8505*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8506*           GO TO 8100-SEND-INITIAL-MAP.
  8507
  8508     IF EIBAID = DFHPF6
  8509        IF NOT CSR-EDIT-SESSION
  8510           MOVE ER-0029                TO EMI-ERROR
  8511           MOVE -1                     TO BPFENTRL
  8512           MOVE AL-UNBON               TO BPFENTRA
  8513           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8514           GO TO 8200-SEND-DATAONLY
  8515*           MOVE '0'              TO PI-EDIT-SW
  8516*           IF PI-DISPLAY-ORIGINAL-BATCH
  8517*              NEXT SENTENCE
  8518*           ELSE
  8519*              MOVE EL631C        TO PI-MAP-NAME
  8520*              MOVE LOW-VALUES    TO EL631CI
  8521*              MOVE 'A'           TO CMAINTO
  8522*              MOVE AL-UANON      TO CMAINTA
  8523*              MOVE -1            TO CMAINTL
  8524*              MOVE '6'           TO PI-MAINT-FUNCTION
  8525*              GO TO 8100-SEND-INITIAL-MAP
  8526*           END-IF
  8527        ELSE
  8528           PERFORM 5100-PROCESS-POL-RESC
  8529                                 THRU 5100-EXIT
  8530           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8531           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8532                                    PI-PREV-SEQ-NO
  8533           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8534*                                    WS-CANCEL-LETTER-SW
  8535                                    PI-ALL-ISSUES-SW
  8536                                    PI-ALL-CANCELS-SW
  8537           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8538        END-IF
  8539     END-IF
  8540     IF EIBAID = DFHPF7
  8541        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8542        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8543        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 157
* EL6311.cbl
  8544        MOVE PI-SV-STATE            TO PI-STATE
  8545        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8546        MOVE BCERTNOI               TO PI-CERT-PRIME
  8547        MOVE BSUFIXI                TO PI-CERT-SFX
  8548        MOVE BEFFDTI                TO DEEDIT-FIELD
  8549        PERFORM 8600-DEEDIT
  8550        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8551        MOVE '4'                    TO DC-OPTION-CODE
  8552        PERFORM 9700-DATE-LINK
  8553        IF DATE-CONVERSION-ERROR
  8554           MOVE ER-0348            TO EMI-ERROR
  8555           MOVE -1                  TO BEFFDTL
  8556           MOVE AL-UABON            TO BEFFDTA
  8557           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8558           GO TO 8200-SEND-DATAONLY
  8559        ELSE
  8560           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8561           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8562           MOVE XCTL-EL1273        TO PGM-NAME
  8563           GO TO 9300-XCTL.
  8564
  8565     IF EIBAID = DFHPF8
  8566        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8567        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8568        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8569        MOVE PI-SV-STATE            TO PI-STATE
  8570        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8571        MOVE BCERTNOI               TO PI-CERT-PRIME
  8572        MOVE BSUFIXI                TO PI-CERT-SFX
  8573        MOVE BEFFDTI                TO DEEDIT-FIELD
  8574        PERFORM 8600-DEEDIT
  8575        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8576        MOVE '4'                    TO DC-OPTION-CODE
  8577        PERFORM 9700-DATE-LINK
  8578        IF DATE-CONVERSION-ERROR
  8579           MOVE ER-0348            TO EMI-ERROR
  8580           MOVE -1                  TO BEFFDTL
  8581           MOVE AL-UABON            TO BEFFDTA
  8582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8583           GO TO 8200-SEND-DATAONLY
  8584        ELSE
  8585           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8586           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8587           IF PI-COMPANY-ID = 'DMD'
  8588               MOVE XCTL-EL401DMD      TO PGM-NAME
  8589             ELSE
  8590               MOVE XCTL-EL1279        TO PGM-NAME
  8591           END-IF
  8592           GO TO 9300-XCTL.
  8593
  8594     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8595        MOVE XCTL-EL6312         TO PGM-NAME
  8596
  8597* EXEC CICS XCTL
  8598*           PROGRAM   (PGM-NAME)
  8599*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8600*           LENGTH    (WS-COMM-LENGTH)
  8601*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 158
* EL6311.cbl
  8602*    MOVE '.$C                   %   #00008567' TO DFHEIV0
  8603     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8604     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8605     MOVE X'2020233030303038353637' TO DFHEIV0(25:11)
  8606     CALL 'kxdfhei1' USING DFHEIV0,
  8607           PGM-NAME,
  8608           PROGRAM-INTERFACE-BLOCK,
  8609           WS-COMM-LENGTH,
  8610           DFHEIV99
  8611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8612     ELSE
  8613        MOVE '0'                 TO  PI-EDIT-SW.
  8614
  8615     IF  EIBAID = DFHPF10
  8616         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8617         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8618         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8619                                    PI-1042-WA
  8620         MOVE 4                  TO PI-689-DATA-SOURCE
  8621         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8622         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8623         MOVE PI-SV-STATE        TO PI-689-STATE
  8624         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8625         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8626         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8627         MOVE PI-PB-ALT-CHG-SEQ-NO
  8628                                 TO PI-689-ALT-SEQ-NO
  8629         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8630         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8631         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8632         MOVE +0                 TO PI-689-CONTROL
  8633         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8634                                    PI-689-EXP-DATE
  8635                                    PI-689-RESP-PERSON
  8636                                    PI-689-TYPE
  8637                                    PI-689-FOLLOW-UP-EDIT
  8638                                    PI-689-RESEND1-EDIT
  8639                                    PI-689-SEQ-EDIT
  8640                                    PI-689-BCSEQ-EDIT
  8641                                    PI-689-LBL-OVERRIDE
  8642         MOVE W-LETTER-COMMUNICATION-AREAS
  8643                                 TO PI-PROGRAM-WORK-AREA
  8644         MOVE XCTL-EL689         TO PGM-NAME
  8645         GO TO 9300-XCTL.
  8646
  8647     IF  EIBAID = DFHPF16
  8648         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8649         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8650         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8651                                    PI-1042-WA
  8652         MOVE 4                  TO PI-689-DATA-SOURCE
  8653         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8654         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8655         MOVE PI-SV-STATE        TO PI-689-STATE
  8656         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8657         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8658         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8659         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 159
* EL6311.cbl
  8660                                 TO PI-689-ALT-SEQ-NO
  8661         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8662         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8663         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8664         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8665         MOVE W-LETTER-COMMUNICATION-AREAS
  8666                                 TO PI-PROGRAM-WORK-AREA
  8667         MOVE XCTL-EL690         TO PGM-NAME
  8668         GO TO 9300-XCTL.
  8669
  8670     IF EIBAID = DFHPF13
  8671         MOVE XCTL-EL6313        TO PGM-NAME
  8672         GO TO 9300-XCTL.
  8673
  8674     IF EIBAID = DFHPF17
  8675        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8676        IF (PB-I-LOAN-APR > ZEROS)
  8677           and (pb-i-loan-apr < 99.9999)
  8678           AND (PB-I-BENEFICIARY-NAME NOT
  8679              = SPACES AND LOW-VALUES)
  8680
  8681           MOVE LINK-ELVADS          TO PGM-NAME
  8682
  8683* EXEC CICS LINK
  8684*              PROGRAM    (PGM-NAME)
  8685*              COMMAREA   (WS-PASS-AREA)
  8686*              LENGTH     (WS-PASS-AREA-LENGTH)
  8687*          END-EXEC
  8688*    MOVE '."C                   (   #00008642' TO DFHEIV0
  8689     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8691     MOVE X'2020233030303038363432' TO DFHEIV0(25:11)
  8692     CALL 'kxdfhei1' USING DFHEIV0,
  8693           PGM-NAME,
  8694           WS-PASS-AREA,
  8695           WS-PASS-AREA-LENGTH,
  8696           DFHEIV99,
  8697           DFHEIV99,
  8698           DFHEIV99,
  8699           DFHEIV99
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8701
  8702           MOVE 0000             TO EMI-ERROR
  8703           MOVE -1               TO BMAINTL
  8704           PERFORM 9900-ERROR-FORMAT
  8705                                 THRU 9900-EXIT
  8706           GO TO 8200-SEND-DATAONLY
  8707        ELSE
  8708           MOVE ER-0877            TO EMI-ERROR
  8709           MOVE -1                  TO BEFFDTL
  8710           MOVE AL-UABON            TO BEFFDTA
  8711           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8712           GO TO 8200-SEND-DATAONLY
  8713        END-IF
  8714     END-IF
  8715     IF EIBAID = DFHPF14
  8716        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8717        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 160
* EL6311.cbl
  8718        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8719        MOVE PI-SV-STATE            TO PI-CR-STATE
  8720        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8721        MOVE SPACE                  TO PI-EDIT-SW
  8722        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8723        MOVE XCTL-EL650             TO PGM-NAME
  8724        GO TO 9300-XCTL.
  8725
  8726     IF EIBAID = DFHPF15
  8727        IF PI-COMPANY-ID  =  'HER'
  8728            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8729            MOVE XCTL-EL680         TO PGM-NAME
  8730            GO TO 9300-XCTL.
  8731
  8732     IF EIBAID = DFHENTER OR DFHPF11
  8733        GO TO 1000-ISSUE-MAINLINE.
  8734
  8735     MOVE ER-0029                TO EMI-ERROR
  8736     MOVE -1                     TO BPFENTRL
  8737     MOVE AL-UNBON               TO BPFENTRA
  8738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8739     GO TO 8200-SEND-DATAONLY.
  8740
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 161
* EL6311.cbl
  8742
  8743******************************************************************
  8744*                                                                *
  8745*      CANCEL SCREEN PF KEY CHECKING                             *
  8746*                                                                *
  8747******************************************************************
  8748
  8749******************************************************************
  8750*                                                                *
  8751*      PF KEY FUNCTIONS:                                         *
  8752*                                                                *
  8753*      PF1  = BROWSE FORWARD                                     *
  8754*      PF2  = BROWSE BACKWARD                                    *
  8755*      PF3  = CERTIFICATE LOOKUP                                 *
  8756*      PF4  = DISPLAY BATCH HEADER                               *
  8757*      PF5  = ADD ISSUE SCREEN                                   *
  8758*      PF6  = ADD CANCEL SCREEN                                  *
  8759*      PF7  = CERTIFICATE DISPLAY                                *
  8760*      PF8  = CERTIFICATE NOTES                                  *
  8761*      PF9  = EDIT CONTROL                                       *
  8762*      PF10 = DISPLAY LETTER SCREEN                              *
  8763*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8764*      PF12 = DISPLAY HELP SCREEN                                *
  8765*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8766*      PF14 = ACCOUNT MASTER                                     *
  8767*      PF16 = LETTER REVIEW                                      *
  8768*                                                                *
  8769******************************************************************
  8770
  8771 0400-CHECK-CANCEL-PF-KEYS.
  8772     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8773        MOVE ER-2337             TO EMI-ERROR
  8774        MOVE -1                  TO CMAINTL
  8775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8776        GO TO 8200-SEND-DATAONLY.
  8777
  8778     IF EIBAID = DFHPF1
  8779        MOVE '0'                TO PI-EDIT-SW
  8780        IF PI-PRIMARY-BROWSE
  8781           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8782        ELSE
  8783           IF PI-PRIMARY-WITH-SELECT
  8784              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8785           ELSE
  8786              IF PI-FILE-BROWSE
  8787                 GO TO 4300-BROWSE-FILE-FORWARD
  8788              ELSE
  8789                 IF PI-CSR-BROWSE
  8790                    GO TO 4200-BROWSE-CSR-FORWARD
  8791                 ELSE
  8792                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8793
  8794     IF EIBAID = DFHPF2
  8795        MOVE '0'                TO PI-EDIT-SW
  8796        IF PI-PRIMARY-BROWSE
  8797           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8798        ELSE
  8799           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 162
* EL6311.cbl
  8800              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8801           ELSE
  8802              IF PI-FILE-BROWSE
  8803                 GO TO 4800-BROWSE-FILE-BACKWARD
  8804              ELSE
  8805                 IF PI-CSR-BROWSE
  8806                    GO TO 4900-BROWSE-CSR-BACKWARD
  8807                 ELSE
  8808                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8809
  8810     IF EIBAID = DFHPF3
  8811        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8812        MOVE XCTL-EL127         TO PGM-NAME
  8813        GO TO 9300-XCTL.
  8814
  8815     IF (EIBAID = DFHPF15 OR DFHPF17)
  8816        AND (CSR-EDIT-SESSION)
  8817*       AND (FATAL-OR-UNFORCED)
  8818        AND (FATAL-ERRORS)
  8819        MOVE ER-1819             TO EMI-ERROR
  8820        MOVE -1                  TO CMAINTL
  8821        MOVE AL-UANON            TO CMAINTA
  8822        PERFORM 9900-ERROR-FORMAT
  8823                                 THRU 9900-EXIT
  8824        GO TO 8200-SEND-DATAONLY
  8825     END-IF
  8826     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8827       AND (CSR-EDIT-SESSION)
  8828        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8829        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8830        IF (RESP-NORMAL)
  8831           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8832              AM-CONTROL-PRIMARY (1:20))
  8833            IF AM-NAME NOT GREATER THAN SPACES OR
  8834               AM-ADDRS NOT GREATER THAN SPACES  OR
  8835               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8836               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8837               AM-ZIP NOT GREATER THAN SPACES
  8838               MOVE ER-3834             TO EMI-ERROR
  8839               MOVE -1                  TO BMAINTL
  8840               MOVE AL-UANON            TO BMAINTA
  8841               PERFORM 9900-ERROR-FORMAT
  8842                                 THRU 9900-EXIT
  8843               GO TO 8200-SEND-DATAONLY
  8844            END-IF
  8845        ELSE
  8846           MOVE ER-1609             TO EMI-ERROR
  8847           MOVE -1                  TO BMAINTL
  8848           MOVE AL-UANON            TO BMAINTA
  8849           PERFORM 9900-ERROR-FORMAT
  8850                                THRU 9900-EXIT
  8851           GO TO 8200-SEND-DATAONLY
  8852        END-IF
  8853
  8854        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8855        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8856        IF (ERMAIL-FOUND)
  8857            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 163
* EL6311.cbl
  8858               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8859               MA-CITY NOT GREATER THAN SPACES OR
  8860               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8861               MA-ZIP-CODE NOT GREATER THAN SPACES
  8862               MOVE ER-3835             TO EMI-ERROR
  8863               MOVE -1                  TO BMAINTL
  8864               MOVE AL-UANON            TO BMAINTA
  8865               PERFORM 9900-ERROR-FORMAT
  8866                                 THRU 9900-EXIT
  8867               GO TO 8200-SEND-DATAONLY
  8868            END-IF
  8869        ELSE
  8870           MOVE ER-3000             TO EMI-ERROR
  8871           MOVE -1                  TO BMAINTL
  8872           MOVE AL-UANON            TO BMAINTA
  8873           PERFORM 9900-ERROR-FORMAT
  8874                                THRU 9900-EXIT
  8875           GO TO 8200-SEND-DATAONLY
  8876        END-IF
  8877
  8878     END-IF
  8879     IF (EIBAID = DFHPF15 OR DFHPF17)
  8880        AND (CSR-EDIT-SESSION)
  8881        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8882        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8883        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8884        MOVE PI-SV-STATE         TO PI-STATE
  8885        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8886        MOVE CCERTNOI            TO PI-CERT-PRIME
  8887        MOVE CSUFIXI             TO PI-CERT-SFX
  8888        MOVE CEFFDTI             TO DEEDIT-FIELD
  8889        PERFORM 8600-DEEDIT
  8890        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8891        MOVE '4'                 TO DC-OPTION-CODE
  8892        PERFORM 9700-DATE-LINK
  8893        IF DATE-CONVERSION-ERROR
  8894           MOVE ER-0348          TO EMI-ERROR
  8895           MOVE -1               TO CEFFDTL
  8896           MOVE AL-UABON         TO CEFFDTA
  8897           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8898           GO TO 8200-SEND-DATAONLY
  8899        ELSE
  8900           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8901           PERFORM 6000-CREATE-TEMP-STORAGE
  8902                                 THRU 6000-EXIT
  8903           IF EIBAID = DFHPF17
  8904               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8905                                  THRU 6400-EXIT
  8906               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8907                                 '2' AND '3' AND '4'
  8908                  MOVE ER-3831     TO  EMI-ERROR
  8909                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8910                  GO TO 8200-SEND-DATAONLY
  8911               END-IF
  8912               MOVE 'Y'          TO PI-CLM-RESC-IND
  8913           ELSE
  8914               MOVE 'N'          TO PI-CLM-RESC-IND
  8915           END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 164
* EL6311.cbl
  8916           MOVE XCTL-EL6316      TO PGM-NAME
  8917           MOVE '2'              TO PI-ISS-CAN-SW
  8918           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8919           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8920           GO TO 9300-XCTL
  8921        END-IF
  8922     END-IF
  8923
  8924     IF EIBAID = DFHPF4
  8925        MOVE '0'                TO PI-EDIT-SW
  8926        IF PI-DISPLAY-ORIGINAL-BATCH
  8927           NEXT SENTENCE
  8928        ELSE
  8929           GO TO 7200-DISPLAY-BATCHES.
  8930
  8931     IF EIBAID = DFHPF5
  8932        MOVE ER-0029                TO EMI-ERROR
  8933        MOVE -1                     TO BPFENTRL
  8934        MOVE AL-UNBON               TO BPFENTRA
  8935        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8936        GO TO 8200-SEND-DATAONLY.
  8937*        MOVE '0'                TO PI-EDIT-SW
  8938*        IF PI-DISPLAY-ORIGINAL-BATCH
  8939*           NEXT SENTENCE
  8940*        ELSE
  8941*           MOVE EL631B              TO PI-MAP-NAME
  8942*           MOVE LOW-VALUES          TO EL631BI
  8943*           MOVE 'A'                 TO BMAINTO
  8944*           MOVE AL-UANON            TO BMAINTA
  8945*           MOVE -1                  TO BMAINTL
  8946*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8947*           GO TO 8100-SEND-INITIAL-MAP.
  8948
  8949     IF EIBAID = DFHPF6
  8950        MOVE ER-0029                TO EMI-ERROR
  8951        MOVE -1                     TO BPFENTRL
  8952        MOVE AL-UNBON               TO BPFENTRA
  8953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8954        GO TO 8200-SEND-DATAONLY.
  8955*        MOVE '0'                TO PI-EDIT-SW
  8956*        IF PI-DISPLAY-ORIGINAL-BATCH
  8957*           NEXT SENTENCE
  8958*        ELSE
  8959*           MOVE EL631C              TO PI-MAP-NAME
  8960*           MOVE LOW-VALUES          TO EL631CI
  8961*           MOVE 'A'                 TO CMAINTO
  8962*           MOVE AL-UANON            TO CMAINTA
  8963*           MOVE -1                  TO CMAINTL
  8964*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8965*           GO TO 8100-SEND-INITIAL-MAP.
  8966
  8967     IF EIBAID = DFHPF7
  8968        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8969        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8970        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8971        MOVE PI-SV-STATE            TO PI-STATE
  8972        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8973        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 165
* EL6311.cbl
  8974        MOVE CSUFIXI                TO PI-CERT-SFX
  8975        MOVE CEFFDTI                TO DEEDIT-FIELD
  8976        PERFORM 8600-DEEDIT
  8977        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8978        MOVE '4'                    TO DC-OPTION-CODE
  8979        PERFORM 9700-DATE-LINK
  8980        IF DATE-CONVERSION-ERROR
  8981           MOVE ER-0348            TO EMI-ERROR
  8982           MOVE -1                  TO BEFFDTL
  8983           MOVE AL-UABON            TO BEFFDTA
  8984           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8985           GO TO 8200-SEND-DATAONLY
  8986        ELSE
  8987           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8988           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8989           MOVE XCTL-EL1273        TO PGM-NAME
  8990           GO TO 9300-XCTL.
  8991
  8992     IF EIBAID = DFHPF8
  8993        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8994        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8995        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8996        MOVE PI-SV-STATE            TO PI-STATE
  8997        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8998        MOVE CCERTNOI               TO PI-CERT-PRIME
  8999        MOVE CSUFIXI                TO PI-CERT-SFX
  9000        MOVE CEFFDTI                TO DEEDIT-FIELD
  9001        PERFORM 8600-DEEDIT
  9002        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9003        MOVE '4'                    TO DC-OPTION-CODE
  9004        PERFORM 9700-DATE-LINK
  9005        IF DATE-CONVERSION-ERROR
  9006           MOVE ER-0348             TO EMI-ERROR
  9007           MOVE -1                  TO BEFFDTL
  9008           MOVE AL-UABON            TO BEFFDTA
  9009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9010           GO TO 8200-SEND-DATAONLY
  9011        ELSE
  9012           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9013           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9014           IF PI-COMPANY-ID = 'DMD'
  9015               MOVE XCTL-EL401DMD      TO PGM-NAME
  9016             ELSE
  9017               MOVE XCTL-EL1279        TO PGM-NAME
  9018           END-IF
  9019           GO TO 9300-XCTL.
  9020
  9021     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9022        MOVE XCTL-EL6312     TO PGM-NAME
  9023
  9024* EXEC CICS XCTL
  9025*           PROGRAM  (PGM-NAME)
  9026*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9027*           LENGTH   (WS-COMM-LENGTH)
  9028*       END-EXEC
  9029*    MOVE '.$C                   %   #00008969' TO DFHEIV0
  9030     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9031     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 166
* EL6311.cbl
  9032     MOVE X'2020233030303038393639' TO DFHEIV0(25:11)
  9033     CALL 'kxdfhei1' USING DFHEIV0,
  9034           PGM-NAME,
  9035           PROGRAM-INTERFACE-BLOCK,
  9036           WS-COMM-LENGTH,
  9037           DFHEIV99
  9038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9039     ELSE
  9040        MOVE '0'                 TO  PI-EDIT-SW.
  9041
  9042     IF EIBAID = DFHPF10
  9043         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9044         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9045         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9046         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9047                                    PI-1042-WA
  9048         MOVE 4                  TO PI-689-DATA-SOURCE
  9049         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9050         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9051         MOVE PI-SV-STATE        TO PI-689-STATE
  9052         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9053         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9054         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9055         MOVE PI-PB-ALT-CHG-SEQ-NO
  9056                                 TO PI-689-ALT-SEQ-NO
  9057         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9058         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9059         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9060         MOVE +0                 TO PI-689-CONTROL
  9061         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9062                                    PI-689-EXP-DATE
  9063                                    PI-689-RESP-PERSON
  9064                                    PI-689-TYPE
  9065                                    PI-689-FOLLOW-UP-EDIT
  9066                                    PI-689-RESEND1-EDIT
  9067                                    PI-689-SEQ-EDIT
  9068                                    PI-689-BCSEQ-EDIT
  9069                                    PI-689-LBL-OVERRIDE
  9070         MOVE W-LETTER-COMMUNICATION-AREAS
  9071                                 TO PI-PROGRAM-WORK-AREA
  9072         MOVE XCTL-EL689         TO PGM-NAME
  9073         GO TO 9300-XCTL.
  9074
  9075     IF  EIBAID = DFHPF16
  9076         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9077         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9078         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9079                                    PI-1042-WA
  9080         MOVE 4                  TO PI-689-DATA-SOURCE
  9081         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9082         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9083         MOVE PI-SV-STATE        TO PI-689-STATE
  9084         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9085         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9086         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9087         MOVE PI-PB-ALT-CHG-SEQ-NO
  9088                                 TO PI-689-ALT-SEQ-NO
  9089         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 167
* EL6311.cbl
  9090         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9091         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9092         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9093         MOVE W-LETTER-COMMUNICATION-AREAS
  9094                                 TO PI-PROGRAM-WORK-AREA
  9095         MOVE XCTL-EL690         TO PGM-NAME
  9096         GO TO 9300-XCTL.
  9097     IF (EIBAID = DFHPF13)
  9098        if (not fatal-errors)
  9099           and (not unforced-errors)
  9100           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9101           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9102           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9103           MOVE PI-SV-STATE      TO PI-STATE
  9104           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9105           MOVE CCERTNOI         TO PI-CERT-PRIME
  9106           MOVE CSUFIXI          TO PI-CERT-SFX
  9107           MOVE CEFFDTI          TO DEEDIT-FIELD
  9108           PERFORM 8600-DEEDIT
  9109           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9110           MOVE '4'              TO DC-OPTION-CODE
  9111           PERFORM 9700-DATE-LINK
  9112           IF DATE-CONVERSION-ERROR
  9113              MOVE ER-0348       TO EMI-ERROR
  9114              MOVE -1            TO CEFFDTL
  9115              MOVE AL-UABON      TO CEFFDTA
  9116              PERFORM 9900-ERROR-FORMAT
  9117                                 THRU 9900-EXIT
  9118              GO TO 8200-SEND-DATAONLY
  9119           ELSE
  9120              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9121              MOVE AL-UANON      TO CEFFDTA
  9122              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9123              PERFORM 6000-CREATE-TEMP-STORAGE
  9124                                 THRU 6000-EXIT
  9125              MOVE XCTL-EL677    TO PGM-NAME
  9126              GO TO 9300-XCTL
  9127           end-if
  9128        else
  9129           MOVE ER-3444          TO EMI-ERROR
  9130           MOVE -1               TO CPFENTRL
  9131           MOVE AL-UNBON         TO CPFENTRA
  9132           PERFORM 9900-ERROR-FORMAT
  9133                                 THRU 9900-EXIT
  9134           GO TO 8200-SEND-DATAONLY
  9135        end-if
  9136     end-if
  9137
  9138     IF EIBAID = DFHPF14
  9139        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9140        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9141        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9142        MOVE PI-SV-STATE            TO PI-CR-STATE
  9143        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9144        MOVE SPACE                  TO PI-EDIT-SW
  9145        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9146        MOVE XCTL-EL650             TO PGM-NAME
  9147        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 168
* EL6311.cbl
  9148
  9149     IF EIBAID = DFHENTER OR DFHPF11
  9150        GO TO 2000-CANCEL-MAINLINE.
  9151
  9152     MOVE ER-0029                TO EMI-ERROR.
  9153     MOVE -1                     TO CPFENTRL.
  9154     MOVE AL-UNBON               TO CPFENTRA.
  9155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9156     GO TO 8200-SEND-DATAONLY.
  9157
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 169
* EL6311.cbl
  9159
  9160******************************************************************
  9161*                                                                *
  9162*      BATCH SCREEN PF KEY CHECKING                              *
  9163*                                                                *
  9164******************************************************************
  9165
  9166******************************************************************
  9167*                                                                *
  9168*      PF KEY FUNCTIONS:                                         *
  9169*                                                                *
  9170*      PF1 = BROWSE FORWARD                                      *
  9171*      PF2 = BROWSE BACKWARD                                     *
  9172*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9173*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9174*                                                                *
  9175*                                                                *
  9176******************************************************************
  9177
  9178 0500-CHECK-BATCH-PF-KEYS.
  9179     IF EIBAID = DFHPF1
  9180        MOVE '0'                TO PI-EDIT-SW
  9181        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9182           GO TO 5000-BROWSE-BATCH-HEADERS
  9183        ELSE
  9184           IF PI-GOOD-BROWSE
  9185              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9186                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9187              ELSE
  9188                 IF PI-FILE-BROWSE
  9189                    GO TO 4300-BROWSE-FILE-FORWARD
  9190                 ELSE
  9191                    IF PI-CSR-BROWSE
  9192                       GO TO 4200-BROWSE-CSR-FORWARD
  9193                    ELSE
  9194                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9195           ELSE
  9196              GO TO 0800-BROWSE-ERROR.
  9197
  9198     IF EIBAID = DFHPF2
  9199        MOVE '0'                TO PI-EDIT-SW
  9200        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9201           GO TO 5500-BROWSE-BATCH-BACKWARD
  9202        ELSE
  9203           IF PI-GOOD-BROWSE
  9204              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9205                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9206              ELSE
  9207                 IF PI-FILE-BROWSE
  9208                    GO TO 4800-BROWSE-FILE-BACKWARD
  9209                 ELSE
  9210                    IF PI-CSR-BROWSE
  9211                       GO TO 4900-BROWSE-CSR-BACKWARD
  9212                    ELSE
  9213                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9214           ELSE
  9215              GO TO 0800-BROWSE-ERROR.
  9216
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 170
* EL6311.cbl
  9217     IF EIBAID = DFHPF3
  9218        GO TO 3000-BATCH-MAINLINE.
  9219
  9220     IF  EIBAID = DFHPF4
  9221        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9222        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9223        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9224        MOVE PI-SV-STATE            TO PI-CR-STATE
  9225        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9226                                       PI-CR-FIN-RESP
  9227        MOVE 'A'                    TO PI-CR-TYPE
  9228        MOVE SPACE                  TO PI-EDIT-SW
  9229        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9230        MOVE XCTL-EL640             TO PGM-NAME
  9231        GO TO 9300-XCTL.
  9232
  9233     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9234       AND
  9235        (EIBAID = DFHENTER)
  9236           GO TO 3500-EDIT-BATCH-DATA.
  9237
  9238     IF EIBAID = DFHENTER
  9239        GO TO 3500-EDIT-BATCH-DATA.
  9240
  9241     MOVE ER-0029             TO EMI-ERROR.
  9242     MOVE -1                  TO DPFENTRL.
  9243     MOVE AL-UNBON            TO DPFENTRA.
  9244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9245     GO TO 8200-SEND-DATAONLY.
  9246
  9247 0800-BROWSE-ERROR.
  9248     MOVE ER-2258                TO EMI-ERROR.
  9249     MOVE -1                     TO DPFENTRL.
  9250     MOVE AL-UNBON               TO DPFENTRA.
  9251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9252     GO TO 8200-SEND-DATAONLY.
  9253
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 171
* EL6311.cbl
  9255
  9256******************************************************************
  9257*                                                                *
  9258*                I S S U E   M A I N L I N E                     *
  9259*                                                                *
  9260******************************************************************
  9261
  9262 1000-ISSUE-MAINLINE.
  9263     IF PI-DISPLAY-ORIGINAL-BATCH
  9264        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9265           MOVE ER-0023             TO EMI-ERROR
  9266           MOVE -1                  TO BMAINTL
  9267           MOVE AL-UABON            TO BMAINTA
  9268           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9269           GO TO 8200-SEND-DATAONLY
  9270        ELSE
  9271           NEXT SENTENCE
  9272     ELSE
  9273        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9274           MOVE ER-0023             TO EMI-ERROR
  9275           MOVE -1                  TO BMAINTL
  9276           MOVE AL-UABON            TO BMAINTA
  9277           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9278           GO TO 8200-SEND-DATAONLY.
  9279
  9280     IF BMAINTI = 'S'
  9281        GO TO 1100-SHOW-REQUEST.
  9282
  9283     IF NOT MODIFY-CAP
  9284         MOVE 'UPDATE'       TO SM-READ
  9285         PERFORM 9995-SECURITY-VIOLATION
  9286         MOVE ER-0070        TO EMI-ERROR
  9287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9288         GO TO 8100-SEND-INITIAL-MAP.
  9289
  9290     IF BMAINTL GREATER THAN ZEROS
  9291        IF PI-PF5-FUNCTION
  9292           IF BMAINTI NOT = 'A'
  9293              MOVE AL-UABON  TO BMAINTA
  9294              MOVE -1        TO BMAINTL
  9295              MOVE ER-2260   TO EMI-ERROR
  9296              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9297              GO TO 8200-SEND-DATAONLY.
  9298
  9299     IF BCERTNOL = ZEROS
  9300       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9301         NEXT SENTENCE
  9302     ELSE
  9303         IF BCERTNOL NOT = ZEROS
  9304             MOVE AL-UANON       TO BCERTNOA
  9305         ELSE
  9306             MOVE -1             TO BCERTNOL
  9307             MOVE  1             TO SET-CURSOR-SW
  9308             MOVE ER-2218        TO EMI-ERROR
  9309             MOVE AL-UABON       TO BCERTNOA
  9310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9311
  9312     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 172
* EL6311.cbl
  9313         MOVE AL-UANON       TO BSUFIXA
  9314     ELSE
  9315         MOVE AL-SANOF       TO BSUFIXA.
  9316
  9317     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9318        NEXT SENTENCE
  9319     ELSE
  9320        IF BEFFDTL NOT = ZEROS
  9321           MOVE AL-UNNON             TO BEFFDTA
  9322           MOVE BEFFDTI              TO DEEDIT-FIELD
  9323           PERFORM 8600-DEEDIT
  9324           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9325           MOVE 4                    TO DC-OPTION-CODE
  9326           PERFORM 9700-DATE-LINK
  9327           IF NO-CONVERSION-ERROR
  9328              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9329              ELSE
  9330              MOVE -1                TO BEFFDTL
  9331              MOVE  1                TO SET-CURSOR-SW
  9332              MOVE ER-2226           TO EMI-ERROR
  9333              MOVE AL-UNBON          TO BEFFDTA
  9334              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9335           ELSE
  9336              MOVE -1                TO BEFFDTL
  9337              MOVE  1                TO SET-CURSOR-SW
  9338              MOVE ER-2220           TO EMI-ERROR
  9339              MOVE AL-UNBON          TO BEFFDTA
  9340              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9341
  9342     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9343
  9344     IF BCERTNOL NOT = ZEROS
  9345        MOVE BCERTNOI                TO WS-NEW-PRIME
  9346     ELSE
  9347        MOVE SPACES                  TO WS-NEW-PRIME.
  9348
  9349     IF BSUFIXL NOT = ZEROS
  9350        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9351     ELSE
  9352        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9353
  9354     IF BEFFDTL NOT = ZEROS
  9355        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9356     ELSE
  9357        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9358
  9359     IF BMAINTI = 'A' OR 'K' OR 'S'
  9360        NEXT SENTENCE
  9361     ELSE
  9362        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9363        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9364           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9365           WS-PB-RECORD-TYPE NOT = '1'
  9366           IF BMAINTI = 'C'
  9367               MOVE ER-2287          TO EMI-ERROR
  9368               MOVE -1               TO BCERTNOL
  9369               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9370               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 173
* EL6311.cbl
  9371               GO TO 8200-SEND-DATAONLY
  9372             ELSE
  9373               MOVE ER-2260          TO EMI-ERROR
  9374               MOVE -1               TO BCERTNOL
  9375               MOVE AL-UABON         TO BCERTNOA
  9376               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9377               GO TO 8200-SEND-DATAONLY.
  9378
  9379     IF BMAINTI = 'D'
  9380         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9381
  9382*    IF BMICRNOL  NOT =  ZEROS
  9383*        IF BMICRNOI  NUMERIC
  9384*            MOVE AL-UNNON       TO  BMICRNOA
  9385*        ELSE
  9386*            MOVE -1             TO  BMICRNOL
  9387*            MOVE 1              TO  SET-CURSOR-SW
  9388*            MOVE AL-UNBON       TO  BMICRNOA
  9389*            MOVE ER-2701        TO  EMI-ERROR
  9390*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9391     IF BVINL NOT = ZEROS
  9392        MOVE AL-UANON            TO BVINA
  9393     END-IF
  9394     IF B1STNML NOT = ZEROS
  9395         MOVE AL-UANON                TO B1STNMA.
  9396
  9397     IF BINITL  NOT = ZEROS
  9398        MOVE AL-UANON                TO BINITA.
  9399
  9400     IF BSEXL NOT = ZEROS
  9401        IF BSEXI = 'M' OR 'F'
  9402           MOVE AL-UANON             TO BSEXA
  9403        ELSE
  9404           MOVE -1               TO BSEXL
  9405           MOVE ER-2629          TO EMI-ERROR
  9406           MOVE AL-UABON         TO BSEXA
  9407           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9408
  9409     IF BAGEL NOT = ZEROS
  9410         IF BAGEI NUMERIC
  9411             MOVE BAGEI              TO WS-BAGE
  9412             MOVE AL-UNNON           TO BAGEA
  9413         ELSE
  9414             MOVE -1                 TO BAGEL
  9415             MOVE  1                 TO SET-CURSOR-SW
  9416             MOVE ER-2223            TO EMI-ERROR
  9417             MOVE AL-UNBON           TO BAGEA
  9418             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9419
  9420     IF BLSTNML NOT = ZERO  OR
  9421        B1STNML NOT = ZERO  OR
  9422        BINITL NOT = ZERO
  9423         IF BAGEL = ZEROS
  9424             MOVE -1                 TO BAGEL
  9425             MOVE  1                 TO SET-CURSOR-SW
  9426             MOVE ER-3269            TO EMI-ERROR
  9427             MOVE AL-UNBON           TO BAGEA
  9428             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 174
* EL6311.cbl
  9429         END-IF
  9430     END-IF.
  9431
  9432     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9433
  9434     IF (BBIRTHL GREATER THAN +0) AND
  9435        (BBIRTHI NOT EQUAL SPACES)
  9436        NEXT SENTENCE
  9437     ELSE
  9438        GO TO 1010-CHECK-AGE.
  9439
  9440     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9441     PERFORM 8600-DEEDIT.
  9442     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9443     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9444     MOVE AL-UNNON               TO BBIRTHA.
  9445     MOVE '4'                    TO DC-OPTION-CODE.
  9446     PERFORM 9700-DATE-LINK.
  9447     IF DATE-CONVERSION-ERROR
  9448        MOVE -1                  TO BBIRTHL
  9449        MOVE  1                  TO SET-CURSOR-SW
  9450        MOVE ER-2228             TO EMI-ERROR
  9451        MOVE AL-UNBON            TO BBIRTHA
  9452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9453        GO TO 1010-CHECK-AGE.
  9454
  9455     IF (NO-CONVERSION-ERROR) AND
  9456        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9457        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9458        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9459        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9460                                    WS-CONVERTED-BIRTH
  9461        MOVE AL-UANON            TO BBIRTHA
  9462     ELSE
  9463        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9464        MOVE AL-UANON            TO BBIRTHA.
  9465
  9466 1010-CHECK-AGE.
  9467
  9468*    IF BAGEL = ZERO
  9469*       IF BBIRTHL GREATER THAN ZERO
  9470*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9471
  9472     IF B1STPMTL NOT = ZEROS
  9473        IF B1STPMTI = SPACES
  9474           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9475        ELSE
  9476           MOVE B1STPMTI             TO DEEDIT-FIELD
  9477           PERFORM 8600-DEEDIT
  9478           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9479           MOVE AL-UNNON             TO B1STPMTA
  9480           MOVE 4                    TO DC-OPTION-CODE
  9481           PERFORM 9700-DATE-LINK
  9482           IF NO-CONVERSION-ERROR
  9483              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9484              MOVE AL-UANON          TO B1STPMTA
  9485           ELSE
  9486              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 175
* EL6311.cbl
  9487              MOVE  1                TO SET-CURSOR-SW
  9488              MOVE ER-2200           TO EMI-ERROR
  9489              MOVE AL-UNBON          TO B1STPMTA
  9490              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9491
  9492     IF BDAYSL NOT = ZEROS
  9493         IF BDAYSI NUMERIC
  9494             MOVE AL-UNNON           TO BDAYSA
  9495         ELSE
  9496             MOVE -1                 TO BDAYSL
  9497             MOVE ER-2530            TO EMI-ERROR
  9498             MOVE AL-UNBON           TO BDAYSA
  9499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9500
  9501     IF BLNTRML NOT = ZEROS
  9502         IF BLNTRMI NUMERIC
  9503             MOVE AL-UNNON       TO BLNTRMA
  9504         ELSE
  9505             MOVE -1             TO BLNTRML
  9506             MOVE ER-2533        TO EMI-ERROR
  9507             MOVE AL-UNBON       TO BLNTRMA
  9508             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9509
  9510**   IF PI-COMPANY-ID = 'DMD'
  9511     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9512        NEXT SENTENCE
  9513     ELSE
  9514         IF BLNOFCRL NOT = ZEROS
  9515            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9516            IF LOAN-OFFICER-FOUND
  9517                MOVE AL-UANON        TO BLNOFCRA
  9518             ELSE
  9519                 MOVE SPACE          TO WS-LOAN-OFFICER
  9520                 MOVE -1             TO BLNOFCRL
  9521                 MOVE  1             TO SET-CURSOR-SW
  9522                 MOVE ER-3006        TO EMI-ERROR
  9523                 MOVE AL-UNBON       TO BLNOFCRA
  9524                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9525
  9526     IF BFREQL NOT = ZEROS
  9527         IF BFREQI NUMERIC
  9528             MOVE AL-UNNON       TO BFREQA
  9529         ELSE
  9530             MOVE -1             TO BFREQL
  9531             MOVE  1             TO SET-CURSOR-SW
  9532             MOVE ER-2223        TO EMI-ERROR
  9533             MOVE AL-UNBON       TO BFREQA
  9534             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9535
  9536     IF BMODEL NOT = ZEROS
  9537         MOVE BMODEI             TO WS-MODE-CODE
  9538                                    PI-BMODE
  9539         IF WS-MODE-CODE-VALID
  9540             MOVE AL-UANON       TO BMODEA
  9541         ELSE
  9542             MOVE -1             TO BMODEL
  9543             MOVE ER-2591        TO EMI-ERROR
  9544             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 176
* EL6311.cbl
  9545             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9546
  9547     IF BPMTSL NOT = ZEROS
  9548         IF BPMTSI NUMERIC
  9549             MOVE AL-UNNON           TO BPMTSA
  9550             MOVE BPMTSI             TO PI-BPMTS
  9551         ELSE
  9552             MOVE -1                 TO BPMTSL
  9553             MOVE ER-2592            TO EMI-ERROR
  9554             MOVE AL-UNBON           TO BPMTSA
  9555             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9556
  9557     IF BPMTAMTL NOT = ZEROS
  9558
  9559* EXEC CICS BIF DEEDIT
  9560*            FIELD  (BPMTAMTI)
  9561*            LENGTH (9)
  9562*       END-EXEC
  9563     MOVE 9
  9564       TO DFHEIV11
  9565*    MOVE '@"L                   #   #00009493' TO DFHEIV0
  9566     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9567     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9568     MOVE X'2020233030303039343933' TO DFHEIV0(25:11)
  9569     CALL 'kxdfhei1' USING DFHEIV0,
  9570           BPMTAMTI,
  9571           DFHEIV11
  9572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9573        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9574*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9575*        PERFORM 8600-DEEDIT
  9576*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9577
  9578*    IF BAPRL NOT = ZEROS
  9579*        EXEC CICS BIF DEEDIT
  9580*            FIELD  (BAPRI)
  9581*            LENGTH (7)
  9582*        END-EXEC
  9583*        MOVE BAPRI              TO WS-BAPR.
  9584
  9585     IF BAPRL > 0
  9586        MOVE +0                  TO  WS-BAPR
  9587        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9588           (WS-SUB > 7)
  9589           OR (BAPRI (WS-SUB:1) NUMERIC)
  9590           OR (BAPRI (WS-SUB:1) = '.')
  9591        END-PERFORM
  9592        IF WS-SUB > 7
  9593           MOVE ER-2471       TO EMI-ERROR
  9594           MOVE -1            TO BAPRL
  9595           MOVE AL-UNBON      TO BAPRA
  9596           PERFORM 9900-ERROR-FORMAT
  9597                                 THRU 9900-EXIT
  9598        ELSE
  9599           IF BAPRI (WS-SUB:1) NUMERIC
  9600              MOVE WS-SUB           TO WS-BEG
  9601              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9602                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 177
* EL6311.cbl
  9603                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9604              END-PERFORM
  9605              COMPUTE WS-END = WS-SUB - WS-BEG
  9606              MOVE BAPRI (WS-BEG:WS-END)
  9607                                 TO WS-APR-WHOLE-NUM
  9608           END-IF
  9609           IF BAPRI (WS-SUB:1) = '.'
  9610              COMPUTE WS-BEG = WS-SUB + 1
  9611              IF (WS-BEG < 8)
  9612                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9613                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9614                    (WS-SUB > 7)
  9615                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9616                 END-PERFORM
  9617                 COMPUTE WS-END = WS-SUB - WS-BEG
  9618                 MOVE BAPRI (WS-BEG:WS-END)
  9619                                 TO WS-APR-DEC (1:WS-END)
  9620              END-IF
  9621           END-IF
  9622           MOVE AL-UNNON      TO BAPRA
  9623           MOVE WS-BAPR       TO BAPRO
  9624        END-IF
  9625     END-IF
  9626*     IF BAPRL NOT = ZEROS
  9627*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9628*        PERFORM 8600-DEEDIT
  9629*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9630
  9631     IF BLIVESL NOT = ZEROS
  9632        MOVE BLIVESI             TO DEEDIT-FIELD
  9633        PERFORM 8600-DEEDIT
  9634        IF DEEDIT-FIELD-V0 NUMERIC
  9635           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9636           MOVE AL-UNNON         TO BLIVESA
  9637        ELSE
  9638           MOVE -1               TO BLIVESL
  9639           MOVE AL-UNBON         TO BLIVESA
  9640           MOVE ER-2223          TO EMI-ERROR
  9641           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9642
  9643*DMD CUSTOM CODING*************START
  9644*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9645     IF PI-COMPANY-ID NOT = 'DMD'
  9646         MOVE ZEROS               TO BBILLEDL
  9647         GO TO 1010-EDIT-CONT.
  9648
  9649     IF BBILLEDL NOT = ZEROS
  9650        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9651        MOVE 'Y'                 TO WS-NUMERIC-SW
  9652        MOVE +1                  TO WS-CSO-SUB
  9653        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9654        IF CSO-NUMERIC-FIELD
  9655
  9656* EXEC CICS BIF DEEDIT
  9657*              FIELD  (BBILLEDI)
  9658*              LENGTH (9)
  9659*          END-EXEC
  9660     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 178
* EL6311.cbl
  9661       TO DFHEIV11
  9662*    MOVE '@"L                   #   #00009579' TO DFHEIV0
  9663     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9664     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9665     MOVE X'2020233030303039353739' TO DFHEIV0(25:11)
  9666     CALL 'kxdfhei1' USING DFHEIV0,
  9667           BBILLEDI,
  9668           DFHEIV11
  9669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9670           MOVE BBILLEDI         TO WS-BILLED
  9671           MOVE AL-UNNON         TO BBILLEDA
  9672        ELSE
  9673           MOVE -1               TO BBILLEDL
  9674           MOVE AL-UNBON         TO BBILLEDA
  9675           MOVE ER-2547          TO EMI-ERROR
  9676           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9677     ELSE
  9678        IF BMAINTI EQUAL 'A'
  9679           MOVE -1               TO BBILLEDL
  9680           MOVE AL-UNBON         TO BBILLEDA
  9681           MOVE ER-8148          TO EMI-ERROR
  9682           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9683
  9684 1010-EDIT-CONT.
  9685
  9686     IF BFORCEL  NOT = ZEROS
  9687         IF FORCE-CAP
  9688            MOVE AL-UANON            TO BFORCEA
  9689         ELSE
  9690            MOVE ER-2945             TO EMI-ERROR
  9691            MOVE AL-UABON            TO BFORCEA
  9692            MOVE -1                  TO BFORCEL
  9693            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9694
  9695     IF BENTRYL NOT = ZEROS
  9696        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9697                         'D' AND 'V' AND 'U' AND 'M'
  9698           MOVE ER-2224              TO EMI-ERROR
  9699           MOVE AL-UABON             TO BENTRYA
  9700           MOVE -1                   TO BENTRYL
  9701           MOVE  1                   TO SET-CURSOR-SW
  9702           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9703        ELSE
  9704           MOVE AL-UANON             TO BENTRYA.
  9705
  9706     IF BUNWRITL NOT = ZEROS
  9707        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9708           MOVE ER-7574              TO EMI-ERROR
  9709           MOVE AL-UABON             TO BUNWRITA
  9710           MOVE -1                   TO BUNWRITL
  9711           MOVE  1                   TO SET-CURSOR-SW
  9712           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9713        ELSE
  9714           MOVE AL-UANON             TO BUNWRITA.
  9715
  9716     IF BREINL  NOT = ZEROS
  9717         MOVE AL-UANON               TO BREINA.
  9718
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 179
* EL6311.cbl
  9719     IF BBILCDL NOT = ZEROS
  9720        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9721                             AND 'A' AND 'B' AND 'E'
  9722           MOVE ER-2225              TO EMI-ERROR
  9723           MOVE AL-UABON             TO BBILCDA
  9724           MOVE -1                   TO BBILCDL
  9725           MOVE  1                   TO SET-CURSOR-SW
  9726           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9727        ELSE
  9728           MOVE AL-UANON             TO BBILCDA.
  9729
  9730     IF BSKPCDL NOT = ZEROS
  9731         MOVE AL-UANON               TO BSKPCDA.
  9732
  9733     IF BINDGRPL NOT = ZEROS
  9734         MOVE AL-UANON               TO BINDGRPA.
  9735
  9736     IF BSIGL   NOT = ZEROS
  9737         MOVE AL-UANON               TO BSIGA.
  9738
  9739     IF BRTCLSL NOT = ZEROS
  9740         MOVE AL-UANON               TO BRTCLSA.
  9741
  9742     IF BMEMBERL NOT = ZEROS
  9743         MOVE AL-UANON               TO BMEMBERA.
  9744
  9745     MOVE +0                         TO WS-SUB1.
  9746
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 180
* EL6311.cbl
  9748
  9749******************************************************************
  9750*                                                                *
  9751*           E D I T   I S S U E   C O V E R A G E S              *
  9752*                                                                *
  9753******************************************************************
  9754
  9755 1020-EDIT-COVERAGES.
  9756     ADD +1                      TO WS-SUB1.
  9757
  9758     IF WS-SUB1 GREATER +2
  9759        GO TO 1025-EDIT-COMPLETE.
  9760
  9761     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9762       IF (BMODEL   GREATER ZERO  OR
  9763            BPMTSL   GREATER ZERO  OR
  9764            BPMTAMTL GREATER ZERO)
  9765          AND
  9766            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9767               GO TO 1021-CONT-EDIT.
  9768
  9769     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9770        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9771        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9772        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9773        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9774        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9775        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9776        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9777        NEXT SENTENCE
  9778         ELSE
  9779            GO TO 1020-EDIT-COVERAGES.
  9780
  9781 1021-CONT-EDIT.
  9782
  9783     IF BMAINTI = 'A'
  9784        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9785           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9786        ELSE
  9787           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9788           MOVE ER-7404          TO EMI-ERROR
  9789           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9790           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9791     ELSE
  9792        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9793           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9794
  9795     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9796        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9797        PERFORM 8600-DEEDIT
  9798        IF DEEDIT-FIELD-V0 NUMERIC
  9799           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9800        ELSE
  9801           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9802
  9803     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9804*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9805        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 181
* EL6311.cbl
  9806           BPMTSL  GREATER THAN ZEROS
  9807           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9808
  9809     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9810         IF BMODEL   GREATER THAN ZEROS  OR
  9811            BPMTSL   GREATER THAN ZEROS  OR
  9812            BPMTAMTL GREATER THAN ZEROS
  9813             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9814
  9815     IF BMAINTI = ('C' OR 'K')
  9816        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9817           NEXT SENTENCE
  9818        ELSE
  9819           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9820           PERFORM 8600-DEEDIT
  9821           IF DEEDIT-FIELD-V0 NUMERIC
  9822              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9823              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9824                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9825              ELSE
  9826                    MOVE ER-2241      TO EMI-ERROR
  9827                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9828                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9829                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9830           ELSE
  9831              MOVE ER-2223          TO EMI-ERROR
  9832              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9833              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9834              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9835     ELSE
  9836        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9837            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9838            PERFORM 8600-DEEDIT
  9839            IF DEEDIT-FIELD-V0      NUMERIC
  9840               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9841                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9842                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9843               ELSE
  9844                  MOVE ER-2241         TO EMI-ERROR
  9845                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9846                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9847                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9848            ELSE
  9849              MOVE ER-2223             TO EMI-ERROR
  9850              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9851              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9852              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9853        ELSE
  9854            MOVE ER-2240               TO EMI-ERROR
  9855            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9856            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9857*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9858*        IF BMODEL  GREATER THAN ZEROS  AND
  9859*           BPMTSL  GREATER THAN ZEROS
  9860*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9861
  9862     IF BBEN-LEN (WS-SUB1) = ZEROS
  9863        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 182
* EL6311.cbl
  9864           NEXT SENTENCE
  9865     ELSE
  9866        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9867           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9868
  9869* EXEC CICS BIF DEEDIT
  9870*              FIELD  (BBENI (WS-SUB1))
  9871*              LENGTH (12)
  9872*          END-EXEC
  9873     MOVE 12
  9874       TO DFHEIV11
  9875*    MOVE '@"L                   #   #00009781' TO DFHEIV0
  9876     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9877     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9878     MOVE X'2020233030303039373831' TO DFHEIV0(25:11)
  9879     CALL 'kxdfhei1' USING DFHEIV0,
  9880           BBENI(WS-SUB1),
  9881           DFHEIV11
  9882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9883           IF BBENI (WS-SUB1)  NUMERIC
  9884              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9885                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9886*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9887*          PERFORM 8600-DEEDIT
  9888*          IF DEEDIT-FIELD-V2  NUMERIC
  9889*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9890*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9891              ELSE
  9892                 MOVE ER-7632    TO EMI-ERROR
  9893                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9894                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9895                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9896           ELSE
  9897              MOVE ER-2223         TO EMI-ERROR
  9898              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9899              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9900              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9901        ELSE
  9902           MOVE ER-7632    TO EMI-ERROR
  9903           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9904           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9905           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9906
  9907     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9908        AND (BMAINTI = ('C' OR 'K'))
  9909        CONTINUE
  9910     ELSE
  9911        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9912           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9913           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9914              FOR ALL '.'
  9915           IF WS-TALLY > 1
  9916              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9917                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9918              END-PERFORM
  9919              IF A1 < 9
  9920                 ADD 3 TO A1
  9921                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 183
* EL6311.cbl
  9922              END-IF
  9923           ELSE
  9924              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9925                (A1 > 11)
  9926                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9927                  LOW-VALUES OR SPACES)
  9928              END-PERFORM
  9929              IF A1 > 1 AND < 12
  9930                 MOVE SPACES
  9931                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9932              END-IF
  9933           END-IF
  9934
  9935* EXEC CICS BIF DEEDIT
  9936*              FIELD  (BPREMI (WS-SUB1))
  9937*              LENGTH (11)
  9938*          END-EXEC
  9939     MOVE 11
  9940       TO DFHEIV11
  9941*    MOVE '@"L                   #   #00009836' TO DFHEIV0
  9942     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9943     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9944     MOVE X'2020233030303039383336' TO DFHEIV0(25:11)
  9945     CALL 'kxdfhei1' USING DFHEIV0,
  9946           BPREMI(WS-SUB1),
  9947           DFHEIV11
  9948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9949           IF BPREMI (WS-SUB1) NUMERIC
  9950              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9951                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9952*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9953*          PERFORM 8600-DEEDIT
  9954*          IF DEEDIT-FIELD-V2  NUMERIC
  9955*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9956*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9957              ELSE
  9958                 IF PI-COMPANY-ID NOT = 'DCC'
  9959                    MOVE ER-7633    TO EMI-ERROR
  9960                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9961                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9962                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9963                 END-IF
  9964              END-IF
  9965           ELSE
  9966              MOVE ER-2223         TO EMI-ERROR
  9967              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9968              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9969              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9970           END-IF
  9971        ELSE
  9972           IF PI-COMPANY-ID NOT = 'DCC'
  9973              MOVE ER-7633         TO EMI-ERROR
  9974              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9975              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9976              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9977           END-IF
  9978        END-IF
  9979     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 184
* EL6311.cbl
  9980
  9981     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9982        NEXT SENTENCE
  9983     ELSE
  9984        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9985
  9986* EXEC CICS BIF DEEDIT
  9987*           FIELD  (BCPREMI (WS-SUB1))
  9988*           LENGTH (11)
  9989*       END-EXEC
  9990     MOVE 11
  9991       TO DFHEIV11
  9992*    MOVE '@"L                   #   #00009876' TO DFHEIV0
  9993     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9994     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9995     MOVE X'2020233030303039383736' TO DFHEIV0(25:11)
  9996     CALL 'kxdfhei1' USING DFHEIV0,
  9997           BCPREMI(WS-SUB1),
  9998           DFHEIV11
  9999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10000        IF BCPREMI (WS-SUB1) NUMERIC
 10001           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10002*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10003*       PERFORM 8600-DEEDIT
 10004*       IF DEEDIT-FIELD-V2  NUMERIC
 10005*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10006        ELSE
 10007           MOVE ER-2223         TO EMI-ERROR
 10008           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10009           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10010           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10011
 10012     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10013        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10014        PERFORM 8600-DEEDIT
 10015        IF DEEDIT-FIELD-V0 NUMERIC
 10016           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10017           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10018         ELSE
 10019           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10020           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10021           MOVE ER-2223              TO EMI-ERROR
 10022           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10023
 10024     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10025        IF BEXPIRE   (WS-SUB1) = SPACES
 10026           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10027        ELSE
 10028           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10029           PERFORM 8600-DEEDIT
 10030           IF DEEDIT-FIELD-V0        NUMERIC
 10031              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10032              MOVE 4                TO DC-OPTION-CODE
 10033              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10034              PERFORM 9700-DATE-LINK
 10035              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10036                                                        (WS-SUB1)
 10037              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 185
* EL6311.cbl
 10038                 NEXT SENTENCE
 10039              ELSE
 10040                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10041                 MOVE ER-2531    TO EMI-ERROR
 10042                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10043                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10044           ELSE
 10045             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10046             MOVE ER-2532        TO EMI-ERROR
 10047             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10048             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10049
 10050     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10051        NEXT SENTENCE
 10052     ELSE
 10053
 10054* EXEC CICS BIF DEEDIT
 10055*           FIELD  (BALT-BENI (WS-SUB1))
 10056*           LENGTH (12)
 10057*       END-EXEC
 10058     MOVE 12
 10059       TO DFHEIV11
 10060*    MOVE '@"L                   #   #00009933' TO DFHEIV0
 10061     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10062     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10063     MOVE X'2020233030303039393333' TO DFHEIV0(25:11)
 10064     CALL 'kxdfhei1' USING DFHEIV0,
 10065           BALT-BENI(WS-SUB1),
 10066           DFHEIV11
 10067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10068        IF BALT-BENI (WS-SUB1) NUMERIC
 10069           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10070*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10071*       PERFORM 8600-DEEDIT
 10072*       IF DEEDIT-FIELD-V0 NUMERIC
 10073*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10074        ELSE
 10075           MOVE ER-2223         TO EMI-ERROR
 10076           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10077           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10078           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10079
 10080     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10081        NEXT SENTENCE
 10082     ELSE
 10083
 10084* EXEC CICS BIF DEEDIT
 10085*           FIELD  (BALT-PREMI (WS-SUB1))
 10086*           LENGTH (11)
 10087*       END-EXEC
 10088     MOVE 11
 10089       TO DFHEIV11
 10090*    MOVE '@"L                   #   #00009952' TO DFHEIV0
 10091     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10092     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10093     MOVE X'2020233030303039393532' TO DFHEIV0(25:11)
 10094     CALL 'kxdfhei1' USING DFHEIV0,
 10095           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 186
* EL6311.cbl
 10096           DFHEIV11
 10097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10098        IF BALT-PREMI (WS-SUB1) NUMERIC
 10099           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10100*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10101*       PERFORM 8600-DEEDIT
 10102*       IF DEEDIT-FIELD-V0 NUMERIC
 10103*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10104        ELSE
 10105           MOVE ER-2223         TO EMI-ERROR
 10106           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10107           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10108           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10109
 10110      GO TO 1020-EDIT-COVERAGES.
 10111
 10112 1025-EDIT-COMPLETE.
 10113     IF PI-COMPANY-ID  =  'DMD'
 10114        MOVE LOW-VALUES             TO BNCERTI
 10115                                       BNSTATI.
 10116
 10117     IF EMI-ERROR = ZEROS
 10118         NEXT SENTENCE
 10119     ELSE
 10120         GO TO 8200-SEND-DATAONLY.
 10121
 10122     IF BMAINTI = 'A'
 10123         GO TO 1200-ADD-ISSUE-ROUTINE.
 10124
 10125     IF BMAINTI = 'C'
 10126         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10127
 10128     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10129
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 187
* EL6311.cbl
 10131
 10132 1030-EDIT-FOR-NUMERICS.
 10133     IF WS-CSO-SUB EQUAL 10
 10134        GO TO 1030-EDIT-EXIT.
 10135
 10136     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10137        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10138        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10139           ADD +1               TO WS-CSO-SUB
 10140           GO TO 1030-EDIT-FOR-NUMERICS.
 10141
 10142     MOVE 'N'                   TO WS-NUMERIC-SW.
 10143
 10144 1030-EDIT-EXIT.
 10145******************************************************************
 10146*                                                                *
 10147*                 C A L C U L A T E   A G E                      *
 10148*                                                                *
 10149******************************************************************
 10150
 10151
 10152 1095-CALC-AGE.
 10153
 10154     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10155     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10156     MOVE 1                  TO DC-OPTION-CODE.
 10157     PERFORM 9700-DATE-LINK
 10158     IF NO-CONVERSION-ERROR
 10159         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10160         MOVE WS-BAGE            TO BAGEI
 10161         MOVE +2                 TO BAGEL
 10162         MOVE AL-UNNON TO BAGEA.
 10163
 10164 1099-EXIT.
 10165     EXIT.
 10166
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 188
* EL6311.cbl
 10168
 10169******************************************************************
 10170*                                                                *
 10171*                   S H O W   I S S U E                          *
 10172*                                                                *
 10173******************************************************************
 10174
 10175 1100-SHOW-REQUEST.
 10176     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10177
 10178     IF BCERTNOL = ZEROS AND
 10179        BEFFDTL  = ZEROS
 10180        MOVE -1                  TO BMAINTL
 10181        GO TO 8200-SEND-DATAONLY.
 10182
 10183     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10184
 10185     IF BSUFIXL NOT = ZEROS
 10186        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10187     ELSE
 10188        MOVE SPACE               TO WS-NEW-SUFFIX.
 10189
 10190     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10191     PERFORM 8600-DEEDIT.
 10192     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10193     MOVE '4'                    TO DC-OPTION-CODE.
 10194     PERFORM 9700-DATE-LINK.
 10195     IF DATE-CONVERSION-ERROR
 10196        MOVE ER-0348             TO EMI-ERROR
 10197        MOVE -1                  TO BEFFDTL
 10198        MOVE AL-UABON            TO BEFFDTA
 10199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10200        GO TO 8200-SEND-DATAONLY
 10201     ELSE
 10202        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10203        MOVE AL-UANON            TO BEFFDTA
 10204        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10205
 10206     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10207
 10208     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10209        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10210          MOVE 'Y'                    TO WS-SHOW-SW
 10211          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10212             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10213           ELSE
 10214             IF PI-FILE-BROWSE
 10215                GO TO 4300-BROWSE-FILE-FORWARD
 10216              ELSE
 10217                IF PI-CSR-BROWSE
 10218                   GO TO 4200-BROWSE-CSR-FORWARD
 10219                ELSE
 10220                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10221        ELSE
 10222           GO TO 3900-RE-DISPLAY-RECORD.
 10223
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 189
* EL6311.cbl
 10225
 10226******************************************************************
 10227*                                                                *
 10228*            A D D   I S S U E   R O U T I N E                   *
 10229*                                                                *
 10230******************************************************************
 10231
 10232***************************************************************
 10233*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10234*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10235*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10236*     4. LINK TO THE EDIT ROUTINE.                            *
 10237*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10238*     6. WRITE THE NEW ISSUE RECORD.                          *
 10239*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10240*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10241*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10242*        ELSE                                                 *
 10243*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10244***************************************************************
 10245
 10246 1200-ADD-ISSUE-ROUTINE.
 10247     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10248
 10249
 10250* EXEC CICS GETMAIN
 10251*        SET     (ADDRESS OF PENDING-BUSINESS)
 10252*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10253*    END-EXEC.
 10254*    MOVE '," L                  $   #00010107' TO DFHEIV0
 10255     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10257     MOVE X'2020233030303130313037' TO DFHEIV0(25:11)
 10258     CALL 'kxdfhei1' USING DFHEIV0,
 10259           DFHEIV20,
 10260           ERPNDB-RECORD-LENGTH,
 10261           DFHEIV99
 10262     SET ADDRESS OF PENDING-BUSINESS TO
 10263         DFHEIV20
 10264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10265
 10266
 10267
 10268* EXEC CICS HANDLE CONDITION
 10269*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10270*    END-EXEC.
 10271*    MOVE '"$I                   ! # #00010112' TO DFHEIV0
 10272     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10274     MOVE X'2320233030303130313132' TO DFHEIV0(25:11)
 10275     CALL 'kxdfhei1' USING DFHEIV0
 10276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10277
 10278
 10279     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10280     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10281     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10282
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 190
* EL6311.cbl
 10283
 10284* EXEC CICS READ
 10285*        INTO    (PENDING-BUSINESS)
 10286*        DATASET (FILE-ID-ERPNDB)
 10287*        RIDFLD  (ERPNDB-KEY)
 10288*    END-EXEC.
 10289     MOVE LENGTH OF
 10290      PENDING-BUSINESS
 10291       TO DFHEIV11
 10292*    MOVE '&"IL       E          (   #00010120' TO DFHEIV0
 10293     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10295     MOVE X'2020233030303130313230' TO DFHEIV0(25:11)
 10296     CALL 'kxdfhei1' USING DFHEIV0,
 10297           FILE-ID-ERPNDB,
 10298           PENDING-BUSINESS,
 10299           DFHEIV11,
 10300           ERPNDB-KEY,
 10301           DFHEIV99,
 10302           DFHEIV99,
 10303           DFHEIV99
 10304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10305
 10306
 10307     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10308
 10309     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10310     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10311     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10312     MOVE SPACES                 TO PENDING-BUSINESS.
 10313     MOVE 'PB'                   TO PB-RECORD-ID.
 10314     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10315     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10316     MOVE SPACES                 TO PB-CERT-SFX.
 10317     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10318     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10319                                    PB-ALT-CHG-SEQ-NO.
 10320
 10321     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10322     MOVE '1'                    TO PB-RECORD-TYPE.
 10323
 10324     IF BSUFIXL NOT = ZEROS
 10325        MOVE BSUFIXI             TO PB-CERT-SFX.
 10326
 10327     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10328
 10329     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10330     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10331
 10332     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10333                                    PB-I-LF-PREM-CALC
 10334                                    PB-I-LF-ALT-PREM-CALC
 10335                                    PB-I-LF-RATE
 10336                                    PB-I-LF-ALT-RATE
 10337                                    PB-I-LF-REI-RATE
 10338                                    PB-I-LF-ALT-REI-RATE
 10339                                    PB-I-RATE-DEV-PCT-LF
 10340                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 191
* EL6311.cbl
 10341                                    PB-I-AH-RATE
 10342                                    PB-I-AH-REI-RATE
 10343                                    PB-I-AH-RATE-TRM
 10344                                    PB-I-RATE-DEV-PCT-AH
 10345                                    PB-I-BUSINESS-TYPE
 10346                                    PB-I-LIFE-COMMISSION
 10347                                    PB-I-JOINT-COMMISSION
 10348                                    PB-I-JOINT-AGE
 10349                                    PB-I-AH-COMMISSION
 10350                                    PB-I-CURR-SEQ
 10351                                    PB-CHG-COUNT
 10352                                    PB-LF-BILLED-AMTS
 10353                                    PB-AH-BILLED-AMTS
 10354                                    PB-CALC-TOLERANCE
 10355                                    PB-I-EXTENTION-DAYS
 10356*                                   PB-I-MICROFILM-NO
 10357                                    PB-I-TERM-IN-DAYS.
 10358
 10359     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10360                                    PB-I-LF-EXPIRE-DT
 10361                                    PB-I-AH-EXPIRE-DT
 10362                                    PB-BILLED-DT
 10363                                    PB-ACCT-EFF-DT
 10364                                    PB-ACCT-EXP-DT
 10365                                    PB-I-1ST-PMT-DT.
 10366
 10367     MOVE 'X'                    TO PB-FATAL-FLAG.
 10368
 10369     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10370
 10371     IF BLSTNML GREATER THAN ZEROS
 10372         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10373
 10374*    IF BMICRNOL  GREATER  ZEROS
 10375*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10376*    ELSE
 10377*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10378     IF BVINL > ZEROS
 10379        MOVE BVINI               TO PB-I-VIN
 10380     END-IF
 10381     IF B1STNML GREATER THAN ZEROS
 10382         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10383
 10384     IF BINITL  GREATER THAN ZEROS
 10385         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10386
 10387     IF BBIRTHL GREATER THAN ZERO
 10388         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10389     ELSE
 10390         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10391
 10392     IF B1STPMTL GREATER THAN ZERO
 10393         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10394     ELSE
 10395         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10396
 10397     IF BAGEL    GREATER THAN ZEROS
 10398         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 192
* EL6311.cbl
 10399        ELSE
 10400         MOVE ZEROS              TO PB-I-AGE.
 10401
 10402     IF BSEXL    GREATER THAN ZEROS
 10403         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10404
 10405     IF BTERM-LEN (1) GREATER THAN ZEROS
 10406        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10407     ELSE
 10408        MOVE ZEROS               TO PB-I-LF-TERM.
 10409
 10410     IF BTERM-LEN (2) GREATER THAN ZEROS
 10411        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10412     ELSE
 10413        MOVE ZEROS               TO PB-I-AH-TERM.
 10414
 10415     IF BLNTRML       GREATER THAN ZEROS
 10416         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10417        ELSE
 10418         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10419
 10420     IF BFREQL        GREATER THAN ZEROS
 10421         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10422        ELSE
 10423         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10424
 10425     IF BSKPCDL       GREATER THAN ZEROS
 10426         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10427
 10428     IF BMODEL        GREATER THAN ZEROS
 10429         MOVE BMODEI             TO PB-I-TERM-TYPE
 10430                                    PI-BMODE.
 10431
 10432     IF BPMTSL        GREATER THAN ZEROS
 10433         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10434                                    PI-BPMTS
 10435        ELSE
 10436         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10437                                    PI-BPMTS.
 10438
 10439     IF BPMTAMTL      GREATER THAN ZEROS
 10440         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10441        ELSE
 10442         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10443
 10444     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10445        IF BTYPE  (1)   NOT = ZEROS
 10446           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10447                                    PI-BTYPE (1)
 10448           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10449           MOVE SPACES           TO PB-I-LF-ABBR
 10450        ELSE
 10451           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10452                                    PB-I-LF-ABBR
 10453           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10454     ELSE
 10455        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10456                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 193
* EL6311.cbl
 10457        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10458
 10459     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10460         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10461     ELSE
 10462         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10463
 10464     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10465         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10466     ELSE
 10467         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10468
 10469     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10470         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10471            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10472            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10473         ELSE
 10474            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10475*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10476*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10477         END-IF
 10478     ELSE
 10479         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10480
 10481     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10482         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10483
 10484     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10485         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10486         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10487     ELSE
 10488         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10489
 10490     IF  BALT-PREM-LEN     (2) > ZEROS
 10491         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10492     ELSE
 10493         MOVE ZEROS            TO PB-I-TOT-FEES.
 10494
 10495     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10496        IF BTYPE      (2)   NOT = ZEROS
 10497           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10498                                  PI-BTYPE (2)
 10499           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10500           MOVE SPACES         TO PB-I-AH-ABBR
 10501        ELSE
 10502           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10503                                  PB-I-AH-ABBR
 10504           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10505     ELSE
 10506        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10507                                  PB-I-AH-ABBR
 10508        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10509
 10510     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10511         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10512     ELSE
 10513         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10514
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 194
* EL6311.cbl
 10515     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10516         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10517            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10518            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10519         ELSE
 10520            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10521*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10522*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10523         END-IF
 10524     ELSE
 10525         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10526
 10527     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10528         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10529
 10530     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10531        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10532     ELSE
 10533        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10534
 10535     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10536        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10537     ELSE
 10538        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10539
 10540     IF BINDGRPL  GREATER THAN ZEROS
 10541         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10542
 10543     IF BRTCLSL   GREATER THAN ZEROS
 10544         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10545
 10546     IF BSIGL     GREATER THAN ZEROS
 10547         MOVE BSIGI              TO PB-I-SIG-SW.
 10548     IF BAPRL > ZEROS
 10549         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10550     ELSE
 10551        if pi-company-id = 'CID'
 10552           move +99.9999         to pb-i-loan-apr
 10553        else
 10554           MOVE ZEROS            TO PB-I-LOAN-APR
 10555        end-if
 10556     end-if
 10557     IF BMEMBERL  GREATER THAN ZEROS
 10558         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10559
 10560     IF BLNOFCRL  GREATER THAN ZEROS
 10561         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10562
 10563     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10564        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10565     ELSE
 10566        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10567
 10568     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10569        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10570     ELSE
 10571        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10572
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 195
* EL6311.cbl
 10573     IF BDAYSL   GREATER THAN ZEROS
 10574        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10575                                    PB-I-EXTENTION-DAYS
 10576     ELSE
 10577        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10578                                    PB-I-EXTENTION-DAYS.
 10579
 10580     IF BDAYSL GREATER THAN ZEROS
 10581        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10582
 10583     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10584        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10585           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10586
 10587     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10588        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10589           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10590
 10591     IF B1STPMTL GREATER THAN ZEROS
 10592        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10593
 10594     IF PB-EXT-DAYS-PROCESSING
 10595        IF PB-I-EXTENTION-DAYS = ZEROS
 10596           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10597
 10598     IF PB-EXPIRE-DT-PROCESSING
 10599        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10600           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10601             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10602
 10603     IF PB-1ST-PMT-DT-PROCESSING
 10604        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10605           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10606
 10607     IF BREINL GREATER THAN ZEROS
 10608        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10609
 10610     IF BENTRYL NOT = ZEROS
 10611        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10612        IF PI-COMPANY-ID = 'CID'
 10613           AND (PB-BATCH-ENTRY = 'P')
 10614           AND (PB-STATE = 'VA')
 10615           PERFORM 1500-UPDATE-ERNOTE
 10616                                 THRU 1500-EXIT
 10617        END-IF
 10618     END-IF
 10619     IF BUNWRITL NOT = ZEROS
 10620        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10621
 10622     IF BFORCEL NOT = ZEROS
 10623        MOVE BFORCEI             TO PB-FORCE-CODE.
 10624
 10625     IF BBILCDL NOT = ZEROS
 10626        MOVE BBILCDI             TO PB-RECORD-BILL.
 10627
 10628     IF BLIVESL GREATER THAN ZEROS
 10629        MOVE WS-BLIVES           TO PB-I-LIVES
 10630     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 196
* EL6311.cbl
 10631        MOVE ZEROS               TO PB-I-LIVES.
 10632
 10633     IF BBILLEDL GREATER THAN ZEROS
 10634        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10635     ELSE
 10636        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10637
 10638*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10639
 10640 1260-WRITE-PB-RECORD.
 10641     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10642                                    PB-INPUT-BY.
 10643     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10644     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10645                                    PB-INPUT-DT.
 10646
 10647     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10648     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10649                                    PB-CONTROL-BY-ORIG-BATCH.
 10650
 10651
 10652     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10653     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10654     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10655     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10656     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10657
 10658     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10659
 10660     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10661
 10662     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10663     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10664     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10665
 10666     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10667     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10668
 10669 1275-WRITE-PENDING-BUSINESS.
 10670     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10671     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10672     MOVE 'A'                    TO JP-RECORD-TYPE.
 10673     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10674
 10675
 10676* EXEC CICS HANDLE CONDITION
 10677*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10678*    END-EXEC.
 10679*    MOVE '"$%                   ! $ #00010494' TO DFHEIV0
 10680     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10682     MOVE X'2420233030303130343934' TO DFHEIV0(25:11)
 10683     CALL 'kxdfhei1' USING DFHEIV0
 10684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10685
 10686
 10687
 10688* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 197
* EL6311.cbl
 10689*        DATASET (FILE-ID-ERPNDB)
 10690*        FROM    (PENDING-BUSINESS)
 10691*        RIDFLD  (PB-CONTROL-PRIMARY)
 10692*    END-EXEC.
 10693     MOVE LENGTH OF
 10694      PENDING-BUSINESS
 10695       TO DFHEIV11
 10696*    MOVE '&$ L                  ''   #00010498' TO DFHEIV0
 10697     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10698     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10699     MOVE X'2020233030303130343938' TO DFHEIV0(25:11)
 10700     CALL 'kxdfhei1' USING DFHEIV0,
 10701           FILE-ID-ERPNDB,
 10702           PENDING-BUSINESS,
 10703           DFHEIV11,
 10704           PB-CONTROL-PRIMARY,
 10705           DFHEIV99,
 10706           DFHEIV99
 10707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10708
 10709
 10710     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10711
 10712     PERFORM 8400-LOG-JOURNAL-RECORD.
 10713
 10714******************************************************************
 10715*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10716******************************************************************
 10717     display ' made it to add orig cert '
 10718     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10719     MOVE ' '                    TO WS-ERMAIL-SW
 10720
 10721* EXEC CICS READ
 10722*       DATASET   (FILE-ID-ERMAIL)
 10723*       SET       (ADDRESS OF MAILING-DATA)
 10724*       RIDFLD    (ERMAIL-KEY)
 10725*       RESP      (WS-RESPONSE)
 10726*    END-EXEC
 10727*    MOVE '&"S        E          (  N#00010514' TO DFHEIV0
 10728     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10730     MOVE X'204E233030303130353134' TO DFHEIV0(25:11)
 10731     CALL 'kxdfhei1' USING DFHEIV0,
 10732           FILE-ID-ERMAIL,
 10733           DFHEIV20,
 10734           DFHEIV99,
 10735           ERMAIL-KEY,
 10736           DFHEIV99,
 10737           DFHEIV99,
 10738           DFHEIV99
 10739     SET ADDRESS OF MAILING-DATA TO
 10740         DFHEIV20
 10741     MOVE EIBRESP  TO WS-RESPONSE
 10742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10743     IF RESP-NORMAL
 10744        SET ERMAIL-FOUND TO TRUE
 10745     END-IF
 10746
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 198
* EL6311.cbl
 10747     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10748     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10749     MOVE 'OC'                   TO OC-RECORD-ID
 10750     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10751                                 TO OC-CONTROL-PRIMARY (1:33)
 10752     MOVE 'I'                    TO OC-RECORD-TYPE
 10753     MOVE +4096                  TO OC-KEY-SEQ-NO
 10754     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10755     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10756     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10757     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10758     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10759     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10760     MOVE PB-I-AGE               TO OC-INS-AGE
 10761     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10762     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10763     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10764     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10765     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10766     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10767     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10768     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10769     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10770     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10771     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10772     IF PB-I-JOINT-COMMISSION > +0
 10773         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10774     ELSE
 10775         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10776     END-IF
 10777     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10778     MOVE +0                     TO OC-LF-CANCEL-AMT
 10779                                    OC-LF-ITD-CANCEL-AMT
 10780     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10781     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10782     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10783     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10784     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10785     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10786     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10787     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10788     MOVE +0                     TO OC-AH-CANCEL-AMT
 10789                                    OC-AH-ITD-CANCEL-AMT
 10790     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10791     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10792     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10793     IF ERMAIL-FOUND
 10794        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10795     END-IF
 10796     IF NOT CERT-TRL-REC-NOT-FOUND
 10797        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10798                           OC-INS-AGE-DEFAULT-FLAG
 10799        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10800                           OC-JNT-AGE-DEFAULT-FLAG
 10801     END-IF
 10802     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10803     .
 10804 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 199
* EL6311.cbl
 10805
 10806* EXEC CICS WRITE
 10807*       DATASET   ('ELCRTO')
 10808*       FROM      (ORIGINAL-CERTIFICATE)
 10809*       RIDFLD    (OC-CONTROL-PRIMARY)
 10810*       RESP      (WS-RESPONSE)
 10811*    END-EXEC
 10812     MOVE LENGTH OF
 10813      ORIGINAL-CERTIFICATE
 10814       TO DFHEIV11
 10815     MOVE 'ELCRTO' TO DFHEIV1
 10816*    MOVE '&$ L                  ''  N#00010582' TO DFHEIV0
 10817     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10819     MOVE X'204E233030303130353832' TO DFHEIV0(25:11)
 10820     CALL 'kxdfhei1' USING DFHEIV0,
 10821           DFHEIV1,
 10822           ORIGINAL-CERTIFICATE,
 10823           DFHEIV11,
 10824           OC-CONTROL-PRIMARY,
 10825           DFHEIV99,
 10826           DFHEIV99
 10827     MOVE EIBRESP  TO WS-RESPONSE
 10828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10829     display ' just wrote 1275 ' ws-response
 10830     IF RESP-DUPKEY
 10831        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10832        GO TO 1275-WRITE-ELCRTO
 10833     ELSE
 10834        IF NOT RESP-NORMAL
 10835           MOVE -1               TO BMAINTL
 10836           MOVE ER-7450          TO EMI-ERROR
 10837           PERFORM 9900-ERROR-FORMAT
 10838                                 THRU 9900-EXIT
 10839           GO TO 8200-SEND-DATAONLY
 10840        END-IF
 10841     END-IF
 10842******************************************************************
 10843*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10844******************************************************************
 10845
 10846
 10847* EXEC CICS READ
 10848*        INTO    (PENDING-BUSINESS)
 10849*        DATASET (FILE-ID-ERPNDB)
 10850*        RIDFLD  (ERPNDB-KEY)
 10851*        UPDATE
 10852*    END-EXEC.
 10853     MOVE LENGTH OF
 10854      PENDING-BUSINESS
 10855       TO DFHEIV11
 10856*    MOVE '&"IL       EU         (   #00010605' TO DFHEIV0
 10857     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10859     MOVE X'2020233030303130363035' TO DFHEIV0(25:11)
 10860     CALL 'kxdfhei1' USING DFHEIV0,
 10861           FILE-ID-ERPNDB,
 10862           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 200
* EL6311.cbl
 10863           DFHEIV11,
 10864           ERPNDB-KEY,
 10865           DFHEIV99,
 10866           DFHEIV99,
 10867           DFHEIV99
 10868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10869
 10870
 10871     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10872     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10873     MOVE 'B'                    TO JP-RECORD-TYPE.
 10874     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10875
 10876     PERFORM 8400-LOG-JOURNAL-RECORD.
 10877
 10878     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10879
 10880
 10881* EXEC CICS REWRITE
 10882*        DATASET (FILE-ID-ERPNDB)
 10883*        FROM    (PENDING-BUSINESS)
 10884*    END-EXEC.
 10885     MOVE LENGTH OF
 10886      PENDING-BUSINESS
 10887       TO DFHEIV11
 10888*    MOVE '&& L                  %   #00010621' TO DFHEIV0
 10889     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10890     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10891     MOVE X'2020233030303130363231' TO DFHEIV0(25:11)
 10892     CALL 'kxdfhei1' USING DFHEIV0,
 10893           FILE-ID-ERPNDB,
 10894           PENDING-BUSINESS,
 10895           DFHEIV11,
 10896           DFHEIV99
 10897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10898
 10899
 10900     MOVE 'C'                    TO JP-RECORD-TYPE.
 10901     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10902
 10903     PERFORM 8400-LOG-JOURNAL-RECORD.
 10904
 10905     IF WS-ERRORS-PRESENT
 10906         GO TO 3900-RE-DISPLAY-RECORD.
 10907
 10908     MOVE ZEROS                  TO EMI-ERROR.
 10909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10910     MOVE LOW-VALUES             TO EL631BI.
 10911     MOVE  -1                    TO BMAINTL.
 10912     GO TO 8100-SEND-INITIAL-MAP.
 10913
 10914 1280-BATCH-HDR-NOT-FOUND.
 10915     MOVE -1                     TO BMAINTL.
 10916     MOVE ER-7450                TO EMI-ERROR.
 10917     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10918     GO TO 8200-SEND-DATAONLY.
 10919
 10920 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 201
* EL6311.cbl
 10921
 10922******************************************************************
 10923*                                                                *
 10924*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10925*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10926*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10927*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10928*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10929*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10930*                                                                *
 10931******************************************************************
 10932
 10933     IF LCP-ONCTR-01 =  0
 10934         ADD 1 TO LCP-ONCTR-01
 10935        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10936
 10937     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10938
 10939     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10940         NEXT SENTENCE
 10941     ELSE
 10942         ADD +1 TO PB-BATCH-SEQ-NO
 10943                   PB-CSR-BATCH-SEQ-NO
 10944         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10945         GO TO 1275-WRITE-PENDING-BUSINESS.
 10946
 10947     MOVE -1                     TO BCERTNOL.
 10948     MOVE AL-UABON               TO BCERTNOA.
 10949     MOVE AL-UNBON               TO BEFFDTA.
 10950
 10951     MOVE 1                      TO EMI-SUB
 10952                                    EMI-SWITCH1
 10953                                    EMI-SWITCH-AREA-1
 10954                                    EMI-SWITCH-AREA-2.
 10955
 10956     MOVE SPACES                 TO EMI-ERROR-LINES.
 10957
 10958
 10959* EXEC CICS SYNCPOINT ROLLBACK
 10960*    END-EXEC.
 10961*    MOVE '6"R                   !   #00010684' TO DFHEIV0
 10962     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10964     MOVE X'2020233030303130363834' TO DFHEIV0(25:11)
 10965     CALL 'kxdfhei1' USING DFHEIV0
 10966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10967
 10968
 10969     MOVE ER-2247                TO EMI-ERROR.
 10970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10971     GO TO 8200-SEND-DATAONLY.
 10972
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 202
* EL6311.cbl
 10974
 10975
 10976 1295-READ-CERT-TRAILER.
 10977
 10978
 10979* EXEC CICS GETMAIN
 10980*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10981*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10982*        INITIMG (GETMAIN-SPACE)
 10983*    END-EXEC
 10984*    MOVE ',"IL                  $   #00010696' TO DFHEIV0
 10985     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10986     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10987     MOVE X'2020233030303130363936' TO DFHEIV0(25:11)
 10988     CALL 'kxdfhei1' USING DFHEIV0,
 10989           DFHEIV20,
 10990           ELCRTT-RECORD-LENGTH,
 10991           GETMAIN-SPACE
 10992     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10993         DFHEIV20
 10994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10995
 10996     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10997     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10998     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10999
 11000
 11001* EXEC CICS HANDLE CONDITION
 11002*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11003*    END-EXEC.
 11004*    MOVE '"$I                   ! % #00010706' TO DFHEIV0
 11005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11007     MOVE X'2520233030303130373036' TO DFHEIV0(25:11)
 11008     CALL 'kxdfhei1' USING DFHEIV0
 11009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11010
 11011
 11012
 11013* EXEC CICS READ
 11014*        DATASET  (CRTT-ID)
 11015*        RIDFLD   (ELCRTT-KEY)
 11016*        INTO     (CERTIFICATE-TRAILERS)
 11017*    END-EXEC.
 11018     MOVE LENGTH OF
 11019      CERTIFICATE-TRAILERS
 11020       TO DFHEIV11
 11021*    MOVE '&"IL       E          (   #00010710' TO DFHEIV0
 11022     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11024     MOVE X'2020233030303130373130' TO DFHEIV0(25:11)
 11025     CALL 'kxdfhei1' USING DFHEIV0,
 11026           CRTT-ID,
 11027           CERTIFICATE-TRAILERS,
 11028           DFHEIV11,
 11029           ELCRTT-KEY,
 11030           DFHEIV99,
 11031           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 203
* EL6311.cbl
 11032           DFHEIV99
 11033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11034
 11035
 11036     GO TO 1295-EXIT.
 11037
 11038 1295-CERT-TRL-REC-NOTFND.
 11039     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11040
 11041 1295-EXIT.
 11042     EXIT.
 11043
 11044******************************************************************
 11045*                                                                *
 11046*          C H A N G E   I S S U E   R O U T I N E               *
 11047*                                                                *
 11048******************************************************************
 11049
 11050***************************************************************
 11051*                                                             *
 11052*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11053*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11054*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11055*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11056*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11057*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11058*     5. LINK TO THE EDIT ROUTINE.                            *
 11059*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11060*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11061*              THE EDIT ROUTINE.                              *
 11062*     7. REWRITE THE NEW ISSUE                                *
 11063*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11064*                                                             *
 11065***************************************************************
 11066
 11067 1300-CHANGE-ISSUE-ROUTINE.
 11068     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11069
 11070     IF BCHGL NOT = ZEROS
 11071        MOVE ER-2196             TO EMI-ERROR
 11072        MOVE AL-UABON            TO BMAINTA
 11073        MOVE -1                  TO BMAINTL
 11074        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11075        GO TO 8200-SEND-DATAONLY.
 11076
 11077     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11078
 11079     IF BSUFIXL NOT = ZEROS
 11080        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11081     ELSE
 11082        MOVE SPACE               TO WS-NEW-SUFFIX.
 11083
 11084     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11085     PERFORM 8600-DEEDIT.
 11086     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11087     MOVE '4'                    TO DC-OPTION-CODE.
 11088     PERFORM 9700-DATE-LINK.
 11089     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 204
* EL6311.cbl
 11090        MOVE ER-0348             TO EMI-ERROR
 11091        MOVE -1                  TO BEFFDTL
 11092        MOVE AL-UABON            TO BEFFDTA
 11093        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11094        GO TO 8200-SEND-DATAONLY
 11095     ELSE
 11096        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11097        MOVE AL-UANON            TO BEFFDTA
 11098        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11099
 11100 1325-PROCESS-ISSUE-CHANGES.
 11101
 11102* EXEC CICS HANDLE CONDITION
 11103*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11104*    END-EXEC.
 11105*    MOVE '"$I                   ! & #00010781' TO DFHEIV0
 11106     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11108     MOVE X'2620233030303130373831' TO DFHEIV0(25:11)
 11109     CALL 'kxdfhei1' USING DFHEIV0
 11110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11111
 11112
 11113     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11114     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11115     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11116
 11117
 11118* EXEC CICS GETMAIN
 11119*        SET      (ADDRESS OF PENDING-BUSINESS)
 11120*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11121*        INITIMG  (GETMAIN-SPACE)
 11122*     END-EXEC.
 11123*    MOVE ',"IL                  $   #00010789' TO DFHEIV0
 11124     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11125     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11126     MOVE X'2020233030303130373839' TO DFHEIV0(25:11)
 11127     CALL 'kxdfhei1' USING DFHEIV0,
 11128           DFHEIV20,
 11129           ERPNDB-RECORD-LENGTH,
 11130           GETMAIN-SPACE
 11131     SET ADDRESS OF PENDING-BUSINESS TO
 11132         DFHEIV20
 11133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11134
 11135
 11136
 11137* EXEC CICS READ
 11138*        INTO    (PENDING-BUSINESS)
 11139*        DATASET (FILE-ID-ERPNDB)
 11140*        RIDFLD  (ERPNDB-KEY)
 11141*    END-EXEC.
 11142     MOVE LENGTH OF
 11143      PENDING-BUSINESS
 11144       TO DFHEIV11
 11145*    MOVE '&"IL       E          (   #00010795' TO DFHEIV0
 11146     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 205
* EL6311.cbl
 11148     MOVE X'2020233030303130373935' TO DFHEIV0(25:11)
 11149     CALL 'kxdfhei1' USING DFHEIV0,
 11150           FILE-ID-ERPNDB,
 11151           PENDING-BUSINESS,
 11152           DFHEIV11,
 11153           ERPNDB-KEY,
 11154           DFHEIV99,
 11155           DFHEIV99,
 11156           DFHEIV99
 11157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11158
 11159
 11160     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11161
 11162
 11163* EXEC CICS HANDLE CONDITION
 11164*         NOTFND     (1385-REC-NOT-FOUND)
 11165*    END-EXEC.
 11166*    MOVE '"$I                   ! '' #00010803' TO DFHEIV0
 11167     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11169     MOVE X'2720233030303130383033' TO DFHEIV0(25:11)
 11170     CALL 'kxdfhei1' USING DFHEIV0
 11171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11172
 11173
 11174**********************************************************
 11175*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11176*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11177**********************************************************
 11178
 11179
 11180* EXEC CICS READ
 11181*        DATASET (FILE-ID-ERPNDB)
 11182*        INTO    (PENDING-BUSINESS)
 11183*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11184*    END-EXEC.
 11185     MOVE LENGTH OF
 11186      PENDING-BUSINESS
 11187       TO DFHEIV11
 11188*    MOVE '&"IL       E          (   #00010812' TO DFHEIV0
 11189     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11191     MOVE X'2020233030303130383132' TO DFHEIV0(25:11)
 11192     CALL 'kxdfhei1' USING DFHEIV0,
 11193           FILE-ID-ERPNDB,
 11194           PENDING-BUSINESS,
 11195           DFHEIV11,
 11196           PI-PREV-CONTROL-PRIMARY,
 11197           DFHEIV99,
 11198           DFHEIV99,
 11199           DFHEIV99
 11200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11201
 11202
 11203********** DO NOT ALLOW CHANGES IF THRU A/R
 11204     IF BMAINTI = 'C'
 11205         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 206
* EL6311.cbl
 11206             MOVE ER-4005          TO EMI-ERROR
 11207             MOVE -1               TO BMAINTL
 11208             MOVE AL-UABON         TO BMAINTA
 11209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11210             GO TO 8200-SEND-DATAONLY.
 11211**********
 11212
 11213     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11214        MOVE -1                 TO BMAINTL
 11215        MOVE ER-2197            TO EMI-ERROR
 11216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11217        GO TO 8200-SEND-DATAONLY.
 11218
 11219     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11220        MOVE ER-2196             TO EMI-ERROR
 11221        MOVE AL-UABON            TO BMAINTA
 11222        MOVE -1                  TO BMAINTL
 11223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11224        GO TO 8200-SEND-DATAONLY.
 11225
 11226     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11227
 11228     IF PB-BILLED-DT = LOW-VALUES AND
 11229        PB-CHG-COUNT = ZEROS
 11230        NEXT SENTENCE
 11231     ELSE
 11232        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11233            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11234           OR
 11235           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11236            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11237           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11238
 11239
 11240* EXEC CICS READ
 11241*        DATASET (FILE-ID-ERPNDB)
 11242*        INTO    (PENDING-BUSINESS)
 11243*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11244*        UPDATE
 11245*    END-EXEC.
 11246     MOVE LENGTH OF
 11247      PENDING-BUSINESS
 11248       TO DFHEIV11
 11249*    MOVE '&"IL       EU         (   #00010854' TO DFHEIV0
 11250     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11251     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11252     MOVE X'2020233030303130383534' TO DFHEIV0(25:11)
 11253     CALL 'kxdfhei1' USING DFHEIV0,
 11254           FILE-ID-ERPNDB,
 11255           PENDING-BUSINESS,
 11256           DFHEIV11,
 11257           PI-PREV-CONTROL-PRIMARY,
 11258           DFHEIV99,
 11259           DFHEIV99,
 11260           DFHEIV99
 11261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11262
 11263
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 207
* EL6311.cbl
 11264     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11265     MOVE 'B'                    TO JP-RECORD-TYPE
 11266     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11267     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11268
 11269     PERFORM 8400-LOG-JOURNAL-RECORD.
 11270
 11271     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11272        PB-CHG-COUNT NOT = ZEROS
 11273        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11274            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11275           OR
 11276           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11277            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11278            MOVE LOW-VALUES             TO PB-BILLED-DT
 11279            ADD +1                      TO PB-CHG-COUNT.
 11280
 11281     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11282     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11283     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11284     MOVE '5'                    TO DC-OPTION-CODE.
 11285     PERFORM 9700-DATE-LINK
 11286     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11287
 11288*    IF BMICRNOL  GREATER  ZEROS
 11289*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11290
 11291     IF BVINL > ZEROS
 11292        MOVE BVINI               TO PB-I-VIN
 11293     END-IF
 11294     IF (BFORCEL NOT = ZEROS)
 11295        AND (PB-COMPANY-ID = 'DCC')
 11296        AND (BFORCEI = ' ')
 11297        AND (PB-FORCE-CODE = 'O')
 11298        COMPUTE PB-I-AH-PREMIUM-AMT =
 11299           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11300        PERFORM 1800-REMOVE-CERT-NOTES
 11301                                 THRU 1800-EXIT
 11302        PERFORM 1900-DELETE-ERPYAJ
 11303                                 THRU 1900-EXIT
 11304        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11305     END-IF
 11306     IF (BFORCEL NOT = ZEROS)
 11307        AND (PB-COMPANY-ID = 'DCC')
 11308        AND (BFORCEI = 'O')
 11309        AND (PB-FORCE-CODE NOT = 'O')
 11310        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11311           PB-I-AH-PREM-CALC
 11312        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11313        MOVE SPACE               TO DC-OPTION-CODE
 11314        PERFORM 9700-DATE-LINK
 11315        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11316        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11317        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11318        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11319        PERFORM 1500-UPDATE-ERNOTE
 11320                                 THRU 1500-EXIT
 11321        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 208
* EL6311.cbl
 11322                                 THRU 1600-EXIT
 11323     END-IF
 11324     IF BLSTNML  GREATER THAN ZEROS
 11325         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11326
 11327     IF B1STNML  GREATER THAN ZEROS
 11328         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11329
 11330     IF BINITL   GREATER THAN ZEROS
 11331         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11332
 11333     IF BBIRTHL  GREATER THAN ZERO
 11334         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11335
 11336     IF B1STPMTL GREATER THAN ZERO
 11337         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11338
 11339     IF BAGEL    GREATER THAN ZEROS
 11340         MOVE BAGEI              TO PB-I-AGE.
 11341
 11342     MOVE 'N'                    TO WS-INS-AGE-SET
 11343                                    WS-JNT-AGE-SET.
 11344     IF BAGEL    GREATER THAN ZEROS
 11345        MOVE 'Y'                TO WS-INS-AGE-SET
 11346        IF BAGEI = ZERO AND
 11347             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11348           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11349           MOVE 'AGE*'          TO BAGEDEFO
 11350        ELSE
 11351           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11352           MOVE 'AGE '          TO BAGEDEFO
 11353        END-IF
 11354        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11355     END-IF.
 11356
 11357     IF BSEXL    GREATER THAN ZEROS
 11358         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11359
 11360     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11361        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11362
 11363     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11364        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11365
 11366     IF BLNTRML  GREATER THAN ZEROS
 11367         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11368
 11369     IF BFREQL   GREATER THAN ZEROS
 11370         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11371
 11372     IF BSKPCDL  GREATER THAN ZEROS
 11373         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11374
 11375     IF BMODEL   GREATER THAN ZEROS
 11376         MOVE BMODEI             TO PB-I-TERM-TYPE
 11377                                    PI-BMODE.
 11378
 11379     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 209
* EL6311.cbl
 11380         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11381                                    PI-BPMTS.
 11382
 11383     IF BPMTAMTL GREATER THAN ZEROS
 11384         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11385
 11386     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11387         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11388
 11389     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11390         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11391
 11392     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11393
 11394     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11395         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11396            SUBTRACT PB-I-LF-PREMIUM-AMT
 11397                     FROM WS-B-LF-ISS-PRM-ENTERED
 11398            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11399            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11400            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11401         ELSE
 11402            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11403*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11404*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11405         END-IF
 11406     END-IF.
 11407
 11408     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11409            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11410                     FROM WS-B-LF-ISS-PRM-ENTERED
 11411         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11412         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11413
 11414     IF  BALT-PREM-LEN     (2)  > ZEROS
 11415         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11416
 11417     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11418         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11419
 11420     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11421         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11422            SUBTRACT PB-I-AH-PREMIUM-AMT
 11423                     FROM WS-B-AH-ISS-PRM-ENTERED
 11424            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11425            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11426            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11427         ELSE
 11428            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11429*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11430*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11431         END-IF
 11432     END-IF
 11433
 11434     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11435        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11436
 11437     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 210
* EL6311.cbl
 11438        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11439
 11440     IF BINDGRPL            GREATER THAN ZEROS
 11441         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11442
 11443     IF BRTCLSL             GREATER THAN ZEROS
 11444         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11445
 11446     IF BSIGL               GREATER THAN ZEROS
 11447         MOVE BSIGI              TO PB-I-SIG-SW.
 11448
 11449     IF BAPRL               GREATER THAN ZEROS
 11450         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11451
 11452     IF BMEMBERL            GREATER THAN ZEROS
 11453         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11454
 11455     IF BLNOFCRL            GREATER THAN ZEROS
 11456         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11457
 11458     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11459        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11460
 11461     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11462        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11463
 11464     IF BDAYSL              GREATER THAN ZEROS
 11465        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11466                                    PB-I-EXTENTION-DAYS.
 11467
 11468     IF BDAYSL GREATER THAN ZEROS
 11469        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11470
 11471     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11472        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11473           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11474
 11475     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11476        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11477           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11478
 11479     IF B1STPMTL GREATER THAN ZEROS
 11480        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11481
 11482     IF PB-EXT-DAYS-PROCESSING
 11483        IF PB-I-EXTENTION-DAYS = ZEROS
 11484           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11485
 11486     IF PB-EXPIRE-DT-PROCESSING
 11487        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11488           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11489             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11490
 11491     IF PB-1ST-PMT-DT-PROCESSING
 11492        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11493           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11494
 11495     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 211
* EL6311.cbl
 11496        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11497
 11498     IF BFORCEL NOT = ZEROS
 11499        MOVE BFORCEI             TO PB-FORCE-CODE.
 11500     IF (BENTRYL NOT = ZEROS)
 11501        AND (PB-COMPANY-ID = 'CID')
 11502        AND (PB-STATE = 'VA')
 11503        AND (BENTRYI NOT = 'P')
 11504        AND (PB-BATCH-ENTRY = 'P')
 11505        PERFORM 1800-REMOVE-CERT-NOTES
 11506                                 THRU 1800-EXIT
 11507     END-IF
 11508     IF BENTRYL NOT = ZEROS
 11509        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11510        IF PI-COMPANY-ID = 'CID'
 11511           AND (PB-BATCH-ENTRY = 'P')
 11512           AND (PB-STATE = 'VA')
 11513           PERFORM 1500-UPDATE-ERNOTE
 11514                                 THRU 1500-EXIT
 11515        END-IF
 11516     END-IF
 11517
 11518     IF BUNWRITL NOT = ZEROS
 11519        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11520
 11521     IF BBILCDL NOT = ZEROS
 11522        MOVE BBILCDI             TO PB-RECORD-BILL.
 11523
 11524     IF BLIVESL GREATER THAN ZEROS
 11525        MOVE WS-BLIVES           TO PB-I-LIVES.
 11526
 11527
 11528*DMD CUSTOM CODING*************START
 11529     IF PI-COMPANY-ID NOT = 'DMD'
 11530         MOVE ZEROS               TO BBILLEDL.
 11531*DMD CUSTOM CODING*************END
 11532
 11533     IF BBILLEDL GREATER THAN ZEROS
 11534        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11535
 11536
 11537*****************************************************************
 11538*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11539*****************************************************************
 11540
 11541     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11542        IF BTYPE  (1)   = ZEROS OR SPACES
 11543           IF REMOVE-LF-COVERAGE
 11544               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11545                                        PI-BTYPE (1)
 11546               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11547                                        WS-B-LF-ISS-PRM-ENTERED
 11548               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11549                                        WS-B-LF-ISS-PRM-ENTERED
 11550               SUBTRACT PB-I-LF-PREM-CALC FROM
 11551                                        WS-B-LF-ISS-PRM-COMPUTED
 11552               MOVE ZEROS            TO PB-I-LF-TERM
 11553                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 212
* EL6311.cbl
 11554                                        PB-I-LF-PREMIUM-AMT
 11555                                        PB-I-LF-BENEFIT-CD
 11556                                        PB-I-LF-PREM-CALC
 11557                                        PB-I-LF-CRIT-PER
 11558                                        PB-I-LF-ALT-BENEFIT-AMT
 11559                                        PB-I-LF-ALT-PREMIUM-AMT
 11560               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11561           ELSE
 11562               NEXT SENTENCE
 11563        ELSE
 11564           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11565                                    PI-BTYPE (1).
 11566     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11567        IF BTYPE  (2)   = ZEROS OR SPACES
 11568           IF  REMOVE-AH-COVERAGE
 11569               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11570                                        PI-BTYPE (2)
 11571               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11572                                        WS-B-AH-ISS-PRM-ENTERED
 11573               SUBTRACT PB-I-AH-PREM-CALC FROM
 11574                                        WS-B-AH-ISS-PRM-COMPUTED
 11575               MOVE ZEROS            TO PB-I-AH-TERM
 11576                                        PB-I-AH-BENEFIT-AMT
 11577                                        PB-I-AH-PREMIUM-AMT
 11578                                        PB-I-AH-BENEFIT-CD
 11579                                        PB-I-AH-PREM-CALC
 11580                                        PB-I-AH-CRIT-PER
 11581               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11582           ELSE
 11583               NEXT SENTENCE
 11584        ELSE
 11585           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11586                                    PI-BTYPE (2).
 11587 1360-REWRITE-PB-RECORD.
 11588     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11589
 11590     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11591     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11592
 11593     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11594
 11595     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11596     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11597
 11598     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11599         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11600
 11601     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11602         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11603
 11604     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11605
 11606     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11607
 11608     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11609
 11610     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11611     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 213
* EL6311.cbl
 11612     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11613
 11614     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11615     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11616
 11617 1375-REWRITE-PB-RECORD.
 11618     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11619     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11620     MOVE 'C'                    TO JP-RECORD-TYPE.
 11621     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11622
 11623
 11624* EXEC CICS REWRITE
 11625*        DATASET (FILE-ID-ERPNDB)
 11626*        FROM    (PENDING-BUSINESS)
 11627*    END-EXEC.
 11628     MOVE LENGTH OF
 11629      PENDING-BUSINESS
 11630       TO DFHEIV11
 11631*    MOVE '&& L                  %   #00011220' TO DFHEIV0
 11632     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11633     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11634     MOVE X'2020233030303131323230' TO DFHEIV0(25:11)
 11635     CALL 'kxdfhei1' USING DFHEIV0,
 11636           FILE-ID-ERPNDB,
 11637           PENDING-BUSINESS,
 11638           DFHEIV11,
 11639           DFHEIV99
 11640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11641
 11642
 11643     PERFORM 8400-LOG-JOURNAL-RECORD.
 11644******************************************************************
 11645*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11646******************************************************************
 11647     display ' made it to update orig cert '
 11648     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11649     MOVE ' '                    TO WS-ERMAIL-SW
 11650
 11651* EXEC CICS READ
 11652*       DATASET   (FILE-ID-ERMAIL)
 11653*       SET       (ADDRESS OF MAILING-DATA)
 11654*       RIDFLD    (ERMAIL-KEY)
 11655*       RESP      (WS-RESPONSE)
 11656*    END-EXEC
 11657*    MOVE '&"S        E          (  N#00011232' TO DFHEIV0
 11658     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11659     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11660     MOVE X'204E233030303131323332' TO DFHEIV0(25:11)
 11661     CALL 'kxdfhei1' USING DFHEIV0,
 11662           FILE-ID-ERMAIL,
 11663           DFHEIV20,
 11664           DFHEIV99,
 11665           ERMAIL-KEY,
 11666           DFHEIV99,
 11667           DFHEIV99,
 11668           DFHEIV99
 11669     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 214
* EL6311.cbl
 11670         DFHEIV20
 11671     MOVE EIBRESP  TO WS-RESPONSE
 11672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11673     IF RESP-NORMAL
 11674        SET ERMAIL-FOUND TO TRUE
 11675     END-IF
 11676
 11677     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11678     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11679                                 TO ELCRTO-KEY
 11680     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11681     MOVE +0                     TO ELCRTO-SEQ-NO
 11682
 11683* EXEC CICS READ
 11684*       DATASET   ('ELCRTO')
 11685*       INTO      (ORIGINAL-CERTIFICATE)
 11686*       RIDFLD    (ELCRTO-KEY)
 11687*       GTEQ
 11688*       RESP      (WS-RESPONSE)
 11689*    END-EXEC
 11690     MOVE LENGTH OF
 11691      ORIGINAL-CERTIFICATE
 11692       TO DFHEIV11
 11693     MOVE 'ELCRTO' TO DFHEIV1
 11694*    MOVE '&"IL       G          (  N#00011247' TO DFHEIV0
 11695     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11696     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11697     MOVE X'204E233030303131323437' TO DFHEIV0(25:11)
 11698     CALL 'kxdfhei1' USING DFHEIV0,
 11699           DFHEIV1,
 11700           ORIGINAL-CERTIFICATE,
 11701           DFHEIV11,
 11702           ELCRTO-KEY,
 11703           DFHEIV99,
 11704           DFHEIV99,
 11705           DFHEIV99
 11706     MOVE EIBRESP  TO WS-RESPONSE
 11707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11708     display ' just read gteq ' ws-response
 11709     IF RESP-NORMAL
 11710        AND (OC-CONTROL-PRIMARY (1:33) =
 11711                 PB-CONTROL-BY-ACCOUNT (1:33))
 11712        AND (OC-RECORD-TYPE = 'I')
 11713        display ' resp norm, key =, type i '
 11714        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11715           display ' end proc blank '
 11716           display ' csr edit session ' PI-CSR-SESSION-SW
 11717           IF NOT CSR-EDIT-SESSION
 11718
 11719* EXEC CICS READ
 11720*                DATASET   ('ELCRTO')
 11721*                INTO      (ORIGINAL-CERTIFICATE)
 11722*                RIDFLD    (OC-CONTROL-PRIMARY)
 11723*                UPDATE
 11724*                RESP      (WS-RESPONSE)
 11725*             END-EXEC
 11726     MOVE LENGTH OF
 11727      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 215
* EL6311.cbl
 11728       TO DFHEIV11
 11729     MOVE 'ELCRTO' TO DFHEIV1
 11730*    MOVE '&"IL       EU         (  N#00011264' TO DFHEIV0
 11731     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11732     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11733     MOVE X'204E233030303131323634' TO DFHEIV0(25:11)
 11734     CALL 'kxdfhei1' USING DFHEIV0,
 11735           DFHEIV1,
 11736           ORIGINAL-CERTIFICATE,
 11737           DFHEIV11,
 11738           OC-CONTROL-PRIMARY,
 11739           DFHEIV99,
 11740           DFHEIV99,
 11741           DFHEIV99
 11742     MOVE EIBRESP  TO WS-RESPONSE
 11743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11744              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11745              IF RESP-NORMAL
 11746                 display ' good read upd '
 11747                 MOVE PB-I-INSURED-LAST-NAME TO
 11748                         OC-INS-LAST-NAME
 11749                 MOVE PB-I-INSURED-FIRST-NAME TO
 11750                         OC-INS-FIRST-NAME
 11751                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11752                         OC-INS-MIDDLE-INIT
 11753                 MOVE PB-I-AGE         TO OC-INS-AGE
 11754                 MOVE PB-I-JOINT-LAST-NAME   TO
 11755                         OC-JNT-LAST-NAME
 11756                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11757                         OC-JNT-FIRST-NAME
 11758                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11759                         OC-JNT-MIDDLE-INIT
 11760                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11761                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11762                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11763                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11764                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11765                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11766                         OC-LF-ALT-BEN-AMT
 11767                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11768                         OC-LF-ALT-PRM-AMT
 11769                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11770                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11771                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11772                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11773                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11774                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11775                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11776                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11777                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11778                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11779                 IF OC-CANCEL-TRAN-IND = 'N'
 11780                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11781                    MOVE +0            TO OC-LF-CANCEL-AMT
 11782                                          OC-LF-ITD-CANCEL-AMT
 11783                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11784                    MOVE +0            TO OC-AH-CANCEL-AMT
 11785                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 216
* EL6311.cbl
 11786                 END-IF
 11787                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11788                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11789                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11790                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11791                 IF ERMAIL-FOUND
 11792                    MOVE MA-CRED-BENE-NAME
 11793                                 TO OC-CRED-BENE-NAME
 11794                 END-IF
 11795                 IF NOT CERT-TRL-REC-NOT-FOUND
 11796                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11797                           OC-INS-AGE-DEFAULT-FLAG
 11798                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11799                           OC-JNT-AGE-DEFAULT-FLAG
 11800                 END-IF
 11801
 11802* EXEC CICS REWRITE
 11803*                   DATASET   ('ELCRTO')
 11804*                   FROM      (ORIGINAL-CERTIFICATE)
 11805*                   RESP      (WS-RESPONSE)
 11806*                END-EXEC
 11807     MOVE LENGTH OF
 11808      ORIGINAL-CERTIFICATE
 11809       TO DFHEIV11
 11810     MOVE 'ELCRTO' TO DFHEIV1
 11811*    MOVE '&& L                  %  N#00011328' TO DFHEIV0
 11812     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11813     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11814     MOVE X'204E233030303131333238' TO DFHEIV0(25:11)
 11815     CALL 'kxdfhei1' USING DFHEIV0,
 11816           DFHEIV1,
 11817           ORIGINAL-CERTIFICATE,
 11818           DFHEIV11,
 11819           DFHEIV99
 11820     MOVE EIBRESP  TO WS-RESPONSE
 11821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11822                 display ' just rewrote ' ws-response
 11823              END-IF
 11824           END-IF
 11825        ELSE
 11826           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11827           MOVE 'OC'             TO OC-RECORD-ID
 11828           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11829           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11830           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11831           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11832           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11833           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11834           MOVE PB-I-AGE         TO OC-INS-AGE
 11835           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11836           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11837           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11838           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11839           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11840           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11841           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11842           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11843           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 217
* EL6311.cbl
 11844           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11845           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11846           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11847           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11848           MOVE +0               TO OC-LF-CANCEL-AMT
 11849                                    OC-LF-ITD-CANCEL-AMT
 11850           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11851           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11852           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11853           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11854           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11855           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11856           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11857           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11858           MOVE +0               TO OC-AH-CANCEL-AMT
 11859                                    OC-AH-ITD-CANCEL-AMT
 11860           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11861           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11862           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11863           IF ERMAIL-FOUND
 11864              MOVE MA-CRED-BENE-NAME
 11865                                 TO OC-CRED-BENE-NAME
 11866           END-IF
 11867           IF NOT CERT-TRL-REC-NOT-FOUND
 11868              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11869                           OC-INS-AGE-DEFAULT-FLAG
 11870              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11871                           OC-JNT-AGE-DEFAULT-FLAG
 11872           END-IF
 11873           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11874
 11875* EXEC CICS WRITE
 11876*             DATASET   ('ELCRTO')
 11877*             FROM      (ORIGINAL-CERTIFICATE)
 11878*             RIDFLD    (OC-CONTROL-PRIMARY)
 11879*             RESP      (WS-RESPONSE)
 11880*          END-EXEC
 11881     MOVE LENGTH OF
 11882      ORIGINAL-CERTIFICATE
 11883       TO DFHEIV11
 11884     MOVE 'ELCRTO' TO DFHEIV1
 11885*    MOVE '&$ L                  ''  N#00011385' TO DFHEIV0
 11886     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11887     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11888     MOVE X'204E233030303131333835' TO DFHEIV0(25:11)
 11889     CALL 'kxdfhei1' USING DFHEIV0,
 11890           DFHEIV1,
 11891           ORIGINAL-CERTIFICATE,
 11892           DFHEIV11,
 11893           OC-CONTROL-PRIMARY,
 11894           DFHEIV99,
 11895           DFHEIV99
 11896     MOVE EIBRESP  TO WS-RESPONSE
 11897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11898        END-IF
 11899     ELSE
 11900        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11901        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 218
* EL6311.cbl
 11902        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11903                                 TO OC-CONTROL-PRIMARY (1:33)
 11904        MOVE 'I'                 TO OC-RECORD-TYPE
 11905        MOVE +4096               TO OC-KEY-SEQ-NO
 11906        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11907        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11908        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11909        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11910        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11911        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11912        MOVE PB-I-AGE            TO OC-INS-AGE
 11913        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11914        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11915        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11916        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11917        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11918        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11919        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11920        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11921        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11922        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11923        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11924        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11925        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11926        MOVE +0                  TO OC-LF-CANCEL-AMT
 11927                                    OC-LF-ITD-CANCEL-AMT
 11928        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11929        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11930        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11931        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11932        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11933        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11934        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11935        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11936        MOVE +0                  TO OC-AH-CANCEL-AMT
 11937                                    OC-AH-ITD-CANCEL-AMT
 11938        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11939        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11940        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11941        IF ERMAIL-FOUND
 11942           MOVE MA-CRED-BENE-NAME
 11943                                 TO OC-CRED-BENE-NAME
 11944        END-IF
 11945        IF NOT CERT-TRL-REC-NOT-FOUND
 11946           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11947                           OC-INS-AGE-DEFAULT-FLAG
 11948           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11949                           OC-JNT-AGE-DEFAULT-FLAG
 11950        END-IF
 11951        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11952
 11953* EXEC CICS WRITE
 11954*          DATASET   ('ELCRTO')
 11955*          FROM      (ORIGINAL-CERTIFICATE)
 11956*          RIDFLD    (OC-CONTROL-PRIMARY)
 11957*          RESP      (WS-RESPONSE)
 11958*       END-EXEC
 11959     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 219
* EL6311.cbl
 11960      ORIGINAL-CERTIFICATE
 11961       TO DFHEIV11
 11962     MOVE 'ELCRTO' TO DFHEIV1
 11963*    MOVE '&$ L                  ''  N#00011445' TO DFHEIV0
 11964     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11966     MOVE X'204E233030303131343435' TO DFHEIV0(25:11)
 11967     CALL 'kxdfhei1' USING DFHEIV0,
 11968           DFHEIV1,
 11969           ORIGINAL-CERTIFICATE,
 11970           DFHEIV11,
 11971           OC-CONTROL-PRIMARY,
 11972           DFHEIV99,
 11973           DFHEIV99
 11974     MOVE EIBRESP  TO WS-RESPONSE
 11975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11976     END-IF
 11977******************************************************************
 11978*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11979******************************************************************
 11980
 11981     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11982     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11983
 11984
 11985* EXEC CICS READ
 11986*        INTO    (PENDING-BUSINESS)
 11987*        DATASET (FILE-ID-ERPNDB)
 11988*        RIDFLD  (ERPNDB-KEY)
 11989*        UPDATE
 11990*    END-EXEC.
 11991     MOVE LENGTH OF
 11992      PENDING-BUSINESS
 11993       TO DFHEIV11
 11994*    MOVE '&"IL       EU         (   #00011459' TO DFHEIV0
 11995     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11996     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11997     MOVE X'2020233030303131343539' TO DFHEIV0(25:11)
 11998     CALL 'kxdfhei1' USING DFHEIV0,
 11999           FILE-ID-ERPNDB,
 12000           PENDING-BUSINESS,
 12001           DFHEIV11,
 12002           ERPNDB-KEY,
 12003           DFHEIV99,
 12004           DFHEIV99,
 12005           DFHEIV99
 12006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12007
 12008
 12009     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12010     MOVE 'B'                    TO JP-RECORD-TYPE.
 12011     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12012
 12013     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12014
 12015     PERFORM 8400-LOG-JOURNAL-RECORD.
 12016
 12017     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 220
* EL6311.cbl
 12018
 12019     MOVE 'C'                    TO JP-RECORD-TYPE.
 12020     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12021
 12022
 12023* EXEC CICS REWRITE
 12024*        DATASET    (FILE-ID-ERPNDB)
 12025*        FROM       (PENDING-BUSINESS)
 12026*    END-EXEC.
 12027     MOVE LENGTH OF
 12028      PENDING-BUSINESS
 12029       TO DFHEIV11
 12030*    MOVE '&& L                  %   #00011479' TO DFHEIV0
 12031     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12032     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12033     MOVE X'2020233030303131343739' TO DFHEIV0(25:11)
 12034     CALL 'kxdfhei1' USING DFHEIV0,
 12035           FILE-ID-ERPNDB,
 12036           PENDING-BUSINESS,
 12037           DFHEIV11,
 12038           DFHEIV99
 12039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12040
 12041
 12042     PERFORM 8400-LOG-JOURNAL-RECORD.
 12043
 12044     IF WS-ERRORS-PRESENT
 12045        GO TO 3900-RE-DISPLAY-RECORD.
 12046
 12047     MOVE ZEROS                  TO EMI-ERROR.
 12048     MOVE -1                     TO BMAINTL.
 12049     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12050     GO TO 3900-RE-DISPLAY-RECORD.
 12051
 12052 1380-BATCH-HDR-NOT-FOUND.
 12053     MOVE -1                     TO BMAINTL.
 12054     MOVE ER-7450                TO EMI-ERROR.
 12055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12056     GO TO 8200-SEND-DATAONLY.
 12057
 12058 1385-REC-NOT-FOUND.
 12059     MOVE -1                     TO BMAINTL.
 12060     MOVE ER-7451                TO EMI-ERROR.
 12061     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12062     GO TO 8200-SEND-DATAONLY.
 12063
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 221
* EL6311.cbl
 12065
 12066 1386-UPDATE-AGE-FLAGS.
 12067
 12068
 12069* EXEC CICS GETMAIN
 12070*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12071*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12072*        INITIMG (GETMAIN-SPACE)
 12073*    END-EXEC
 12074*    MOVE ',"IL                  $   #00011510' TO DFHEIV0
 12075     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12076     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12077     MOVE X'2020233030303131353130' TO DFHEIV0(25:11)
 12078     CALL 'kxdfhei1' USING DFHEIV0,
 12079           DFHEIV20,
 12080           ELCRTT-RECORD-LENGTH,
 12081           GETMAIN-SPACE
 12082     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12083         DFHEIV20
 12084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12085
 12086
 12087* EXEC CICS HANDLE CONDITION
 12088*        NOTFND   (1386-NOTFND)
 12089*    END-EXEC.
 12090*    MOVE '"$I                   ! ( #00011516' TO DFHEIV0
 12091     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12093     MOVE X'2820233030303131353136' TO DFHEIV0(25:11)
 12094     CALL 'kxdfhei1' USING DFHEIV0
 12095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12096
 12097
 12098     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12099     MOVE 'C'                TO ELCRTT-REC-TYPE
 12100
 12101
 12102* EXEC CICS READ
 12103*        UPDATE
 12104*        DATASET  (CRTT-ID)
 12105*        RIDFLD   (ELCRTT-KEY)
 12106*        INTO     (CERTIFICATE-TRAILERS)
 12107*    END-EXEC.
 12108     MOVE LENGTH OF
 12109      CERTIFICATE-TRAILERS
 12110       TO DFHEIV11
 12111*    MOVE '&"IL       EU         (   #00011523' TO DFHEIV0
 12112     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12113     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12114     MOVE X'2020233030303131353233' TO DFHEIV0(25:11)
 12115     CALL 'kxdfhei1' USING DFHEIV0,
 12116           CRTT-ID,
 12117           CERTIFICATE-TRAILERS,
 12118           DFHEIV11,
 12119           ELCRTT-KEY,
 12120           DFHEIV99,
 12121           DFHEIV99,
 12122           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 222
* EL6311.cbl
 12123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12124
 12125
 12126     IF WS-INS-AGE-SET = 'Y'
 12127        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12128     END-IF
 12129     IF WS-JNT-AGE-SET = 'Y'
 12130        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12131     END-IF
 12132
 12133
 12134* EXEC CICS REWRITE
 12135*       DATASET  (CRTT-ID)
 12136*       FROM     (CERTIFICATE-TRAILERS)
 12137*    END-EXEC.
 12138     MOVE LENGTH OF
 12139      CERTIFICATE-TRAILERS
 12140       TO DFHEIV11
 12141*    MOVE '&& L                  %   #00011537' TO DFHEIV0
 12142     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12143     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12144     MOVE X'2020233030303131353337' TO DFHEIV0(25:11)
 12145     CALL 'kxdfhei1' USING DFHEIV0,
 12146           CRTT-ID,
 12147           CERTIFICATE-TRAILERS,
 12148           DFHEIV11,
 12149           DFHEIV99
 12150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12151
 12152
 12153     GO TO 1386-EXIT.
 12154
 12155 1386-NOTFND.
 12156
 12157     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12158     MOVE 'CS'         TO CS-RECORD-ID.
 12159     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12160     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12161     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12162     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12163     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12164
 12165* EXEC CICS WRITE
 12166*       DATASET  (CRTT-ID)
 12167*       RIDFLD   (ELCRTT-KEY)
 12168*       FROM     (CERTIFICATE-TRAILERS)
 12169*    END-EXEC.
 12170     MOVE LENGTH OF
 12171      CERTIFICATE-TRAILERS
 12172       TO DFHEIV11
 12173*    MOVE '&$ L                  ''   #00011553' TO DFHEIV0
 12174     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12175     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12176     MOVE X'2020233030303131353533' TO DFHEIV0(25:11)
 12177     CALL 'kxdfhei1' USING DFHEIV0,
 12178           CRTT-ID,
 12179           CERTIFICATE-TRAILERS,
 12180           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 223
* EL6311.cbl
 12181           ELCRTT-KEY,
 12182           DFHEIV99,
 12183           DFHEIV99
 12184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12185
 12186
 12187 1386-EXIT.
 12188     EXIT.
 12189
 12190 1390-UPDATE-ERPNDM.
 12191
 12192
 12193* EXEC CICS HANDLE CONDITION
 12194*        NOTFND (1399-EXIT)
 12195*    END-EXEC.
 12196*    MOVE '"$I                   ! ) #00011564' TO DFHEIV0
 12197     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12199     MOVE X'2920233030303131353634' TO DFHEIV0(25:11)
 12200     CALL 'kxdfhei1' USING DFHEIV0
 12201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12202
 12203
 12204     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12205
 12206
 12207* EXEC CICS READ
 12208*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12209*        DATASET (FILE-ID-ERPNDM)
 12210*        RIDFLD  (ERPNDM-KEY)
 12211*        UPDATE
 12212*    END-EXEC.
 12213*    MOVE '&"S        EU         (   #00011570' TO DFHEIV0
 12214     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12215     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12216     MOVE X'2020233030303131353730' TO DFHEIV0(25:11)
 12217     CALL 'kxdfhei1' USING DFHEIV0,
 12218           FILE-ID-ERPNDM,
 12219           DFHEIV20,
 12220           DFHEIV99,
 12221           ERPNDM-KEY,
 12222           DFHEIV99,
 12223           DFHEIV99,
 12224           DFHEIV99
 12225     SET ADDRESS OF PENDING-MAILING-DATA TO
 12226         DFHEIV20
 12227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12228
 12229
 12230     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12231     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12232     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12233
 12234     IF BLSTNML GREATER THAN ZEROS
 12235         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12236
 12237     IF B1STNML GREATER  THAN ZEROS
 12238         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 224
* EL6311.cbl
 12239
 12240     IF BINITL GREATER THAN ZEROS
 12241         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12242
 12243     IF BAGEL GREATER THAN ZEROS
 12244         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12245
 12246     IF BBIRTHL GREATER THAN ZEROS
 12247         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12248
 12249     IF BSEXL GREATER THAN ZEROS
 12250         MOVE  BSEXI             TO PM-INSURED-SEX.
 12251
 12252
 12253* EXEC CICS REWRITE
 12254*        DATASET (FILE-ID-ERPNDM)
 12255*        FROM    (PENDING-MAILING-DATA)
 12256*    END-EXEC.
 12257     MOVE LENGTH OF
 12258      PENDING-MAILING-DATA
 12259       TO DFHEIV11
 12260*    MOVE '&& L                  %   #00011599' TO DFHEIV0
 12261     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12262     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12263     MOVE X'2020233030303131353939' TO DFHEIV0(25:11)
 12264     CALL 'kxdfhei1' USING DFHEIV0,
 12265           FILE-ID-ERPNDM,
 12266           PENDING-MAILING-DATA,
 12267           DFHEIV11,
 12268           DFHEIV99
 12269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12270
 12271
 12272 1399-EXIT.
 12273     EXIT.
 12274
 12275******************************************************************
 12276*                                                                *
 12277*          D E L E T E   I S S U E   R O U T I N E               *
 12278*                                                                *
 12279******************************************************************
 12280
 12281 1400-DELETE-ISSUE-ROUTINE.
 12282     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12283
 12284     IF BCHGL NOT = ZEROS
 12285        MOVE ER-2196             TO EMI-ERROR
 12286        MOVE AL-UABON            TO BMAINTA
 12287        MOVE -1                  TO BMAINTL
 12288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12289        GO TO 8200-SEND-DATAONLY.
 12290
 12291
 12292* EXEC CICS HANDLE CONDITION
 12293*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12294*    END-EXEC.
 12295*    MOVE '"$I                   ! * #00011623' TO DFHEIV0
 12296     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 225
* EL6311.cbl
 12297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12298     MOVE X'2A20233030303131363233' TO DFHEIV0(25:11)
 12299     CALL 'kxdfhei1' USING DFHEIV0
 12300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12301
 12302
 12303     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12304     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12305     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12306
 12307
 12308* EXEC CICS READ
 12309*        SET     (ADDRESS OF PENDING-BUSINESS)
 12310*        DATASET (FILE-ID-ERPNDB)
 12311*        RIDFLD  (ERPNDB-KEY)
 12312*    END-EXEC.
 12313*    MOVE '&"S        E          (   #00011631' TO DFHEIV0
 12314     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12315     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12316     MOVE X'2020233030303131363331' TO DFHEIV0(25:11)
 12317     CALL 'kxdfhei1' USING DFHEIV0,
 12318           FILE-ID-ERPNDB,
 12319           DFHEIV20,
 12320           DFHEIV99,
 12321           ERPNDB-KEY,
 12322           DFHEIV99,
 12323           DFHEIV99,
 12324           DFHEIV99
 12325     SET ADDRESS OF PENDING-BUSINESS TO
 12326         DFHEIV20
 12327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12328
 12329
 12330     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12331
 12332     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12333
 12334     IF BSUFIXL NOT = ZEROS
 12335        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12336     ELSE
 12337        MOVE SPACE               TO WS-NEW-SUFFIX.
 12338
 12339     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12340     PERFORM 8600-DEEDIT.
 12341     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12342     MOVE '4'                    TO DC-OPTION-CODE.
 12343     PERFORM 9700-DATE-LINK.
 12344     IF DATE-CONVERSION-ERROR
 12345        MOVE ER-0348             TO EMI-ERROR
 12346        MOVE -1                  TO BEFFDTL
 12347        MOVE AL-UABON            TO BEFFDTA
 12348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12349        GO TO 8200-SEND-DATAONLY
 12350     ELSE
 12351        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12352        MOVE AL-UANON            TO BEFFDTA
 12353        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12354
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 226
* EL6311.cbl
 12355
 12356* EXEC CICS HANDLE CONDITION
 12357*         NOTFND    (1490-RECORD-NOT-FOUND)
 12358*    END-EXEC.
 12359*    MOVE '"$I                   ! + #00011662' TO DFHEIV0
 12360     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12362     MOVE X'2B20233030303131363632' TO DFHEIV0(25:11)
 12363     CALL 'kxdfhei1' USING DFHEIV0
 12364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12365
 12366
 12367
 12368* EXEC CICS READ
 12369*        SET     (ADDRESS OF PENDING-BUSINESS)
 12370*        DATASET (FILE-ID-ERPNDB)
 12371*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12372*        UPDATE
 12373*    END-EXEC.
 12374*    MOVE '&"S        EU         (   #00011666' TO DFHEIV0
 12375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12376     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12377     MOVE X'2020233030303131363636' TO DFHEIV0(25:11)
 12378     CALL 'kxdfhei1' USING DFHEIV0,
 12379           FILE-ID-ERPNDB,
 12380           DFHEIV20,
 12381           DFHEIV99,
 12382           PI-PREV-CONTROL-PRIMARY,
 12383           DFHEIV99,
 12384           DFHEIV99,
 12385           DFHEIV99
 12386     SET ADDRESS OF PENDING-BUSINESS TO
 12387         DFHEIV20
 12388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12389
 12390
 12391     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12392        MOVE -1                 TO BMAINTL
 12393        MOVE ER-2197            TO EMI-ERROR
 12394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12395        GO TO 8200-SEND-DATAONLY.
 12396
 12397     IF PB-BILLED-DT NOT = LOW-VALUES
 12398        MOVE -1                 TO BMAINTL
 12399        MOVE ER-2129            TO EMI-ERROR
 12400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12401        GO TO 8200-SEND-DATAONLY.
 12402
 12403     IF PB-CHG-COUNT NOT = ZEROS
 12404        MOVE ER-2336            TO EMI-ERROR
 12405        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12406        MOVE AL-UABON            TO BMAINTA
 12407        MOVE -1                  TO BMAINTL
 12408        GO TO 8200-SEND-DATAONLY.
 12409
 12410     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12411        PB-CHG-COUNT NOT = ZEROS
 12412        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 227
* EL6311.cbl
 12413        MOVE AL-UABON            TO BMAINTA
 12414        MOVE -1                  TO BMAINTL
 12415        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12416        GO TO 8200-SEND-DATAONLY.
 12417******************************************************************
 12418*                                                                *
 12419*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12420*                                                                *
 12421******************************************************************
 12422     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12423     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12424     MOVE +0                     TO ELCRTO-SEQ-NO
 12425
 12426* EXEC CICS READ
 12427*       DATASET   ('ELCRTO')
 12428*       INTO      (ORIGINAL-CERTIFICATE)
 12429*       RIDFLD    (ELCRTO-KEY)
 12430*       GTEQ
 12431*       RESP      (WS-RESPONSE)
 12432*    END-EXEC
 12433     MOVE LENGTH OF
 12434      ORIGINAL-CERTIFICATE
 12435       TO DFHEIV11
 12436     MOVE 'ELCRTO' TO DFHEIV1
 12437*    MOVE '&"IL       G          (  N#00011707' TO DFHEIV0
 12438     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12439     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12440     MOVE X'204E233030303131373037' TO DFHEIV0(25:11)
 12441     CALL 'kxdfhei1' USING DFHEIV0,
 12442           DFHEIV1,
 12443           ORIGINAL-CERTIFICATE,
 12444           DFHEIV11,
 12445           ELCRTO-KEY,
 12446           DFHEIV99,
 12447           DFHEIV99,
 12448           DFHEIV99
 12449     MOVE EIBRESP  TO WS-RESPONSE
 12450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12451     IF RESP-NORMAL
 12452        AND (OC-CONTROL-PRIMARY (1:33) =
 12453                 PB-CONTROL-BY-ACCOUNT (1:33))
 12454        AND (OC-RECORD-TYPE = 'I')
 12455
 12456* EXEC CICS READ
 12457*          DATASET   ('ELCRTO')
 12458*          INTO      (ORIGINAL-CERTIFICATE)
 12459*          RIDFLD    (ELCRTO-KEY)
 12460*          UPDATE
 12461*          RESP      (WS-RESPONSE)
 12462*       END-EXEC
 12463     MOVE LENGTH OF
 12464      ORIGINAL-CERTIFICATE
 12465       TO DFHEIV11
 12466     MOVE 'ELCRTO' TO DFHEIV1
 12467*    MOVE '&"IL       EU         (  N#00011718' TO DFHEIV0
 12468     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12469     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12470     MOVE X'204E233030303131373138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 228
* EL6311.cbl
 12471     CALL 'kxdfhei1' USING DFHEIV0,
 12472           DFHEIV1,
 12473           ORIGINAL-CERTIFICATE,
 12474           DFHEIV11,
 12475           ELCRTO-KEY,
 12476           DFHEIV99,
 12477           DFHEIV99,
 12478           DFHEIV99
 12479     MOVE EIBRESP  TO WS-RESPONSE
 12480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12481        IF RESP-NORMAL
 12482
 12483* EXEC CICS DELETE
 12484*             DATASET   ('ELCRTO')
 12485*          END-EXEC
 12486     MOVE 'ELCRTO' TO DFHEIV1
 12487*    MOVE '&(                    &   #00011726' TO DFHEIV0
 12488     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12490     MOVE X'2020233030303131373236' TO DFHEIV0(25:11)
 12491     CALL 'kxdfhei1' USING DFHEIV0,
 12492           DFHEIV1,
 12493           DFHEIV99,
 12494           DFHEIV99,
 12495           DFHEIV99,
 12496           DFHEIV99
 12497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12498        END-IF
 12499     END-IF
 12500******************************************************************
 12501*                                                                *
 12502*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12503*                                                                *
 12504******************************************************************
 12505
 12506* EXEC CICS HANDLE CONDITION
 12507*        NOTFND    (1405-DELETE-CERTIFICATE)
 12508*    END-EXEC.
 12509*    MOVE '"$I                   ! , #00011736' TO DFHEIV0
 12510     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12512     MOVE X'2C20233030303131373336' TO DFHEIV0(25:11)
 12513     CALL 'kxdfhei1' USING DFHEIV0
 12514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12515
 12516
 12517
 12518* EXEC CICS READ
 12519*        EQUAL
 12520*        DATASET   (FILE-ID-ERPNDM)
 12521*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12522*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12523*        UPDATE
 12524*    END-EXEC.
 12525*    MOVE '&"S        EU         (   #00011740' TO DFHEIV0
 12526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12527     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12528     MOVE X'2020233030303131373430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 229
* EL6311.cbl
 12529     CALL 'kxdfhei1' USING DFHEIV0,
 12530           FILE-ID-ERPNDM,
 12531           DFHEIV20,
 12532           DFHEIV99,
 12533           PI-PREV-CONTROL-PRIMARY,
 12534           DFHEIV99,
 12535           DFHEIV99,
 12536           DFHEIV99
 12537     SET ADDRESS OF PENDING-MAILING-DATA TO
 12538         DFHEIV20
 12539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12540
 12541
 12542     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12543     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12544     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12545
 12546     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12547
 12548
 12549* EXEC CICS DELETE
 12550*        DATASET   (FILE-ID-ERPNDM)
 12551*    END-EXEC.
 12552*    MOVE '&(                    &   #00011754' TO DFHEIV0
 12553     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12554     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12555     MOVE X'2020233030303131373534' TO DFHEIV0(25:11)
 12556     CALL 'kxdfhei1' USING DFHEIV0,
 12557           FILE-ID-ERPNDM,
 12558           DFHEIV99,
 12559           DFHEIV99,
 12560           DFHEIV99,
 12561           DFHEIV99
 12562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12563
 12564
 12565******************************************************************
 12566*                PROCESS   CERTIFICATE                           *
 12567******************************************************************
 12568
 12569 1405-DELETE-CERTIFICATE.
 12570
 12571* EXEC CICS HANDLE CONDITION
 12572*         NOTFND  (1420-CONTINUE-DELETE)
 12573*    END-EXEC.
 12574*    MOVE '"$I                   ! - #00011763' TO DFHEIV0
 12575     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12577     MOVE X'2D20233030303131373633' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12583     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12584     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12585     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12586
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 230
* EL6311.cbl
 12587
 12588* EXEC CICS READ
 12589*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12590*        DATASET (FILE-ID-ELCERT)
 12591*        RIDFLD  (ELCERT-KEY)
 12592*        UPDATE
 12593*    END-EXEC.
 12594*    MOVE '&"S        EU         (   #00011772' TO DFHEIV0
 12595     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12596     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12597     MOVE X'2020233030303131373732' TO DFHEIV0(25:11)
 12598     CALL 'kxdfhei1' USING DFHEIV0,
 12599           FILE-ID-ELCERT,
 12600           DFHEIV20,
 12601           DFHEIV99,
 12602           ELCERT-KEY,
 12603           DFHEIV99,
 12604           DFHEIV99,
 12605           DFHEIV99
 12606     SET ADDRESS OF CERTIFICATE-MASTER TO
 12607         DFHEIV20
 12608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12609
 12610
 12611     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12612
 12613     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12614     MOVE 'B'                    TO JP-RECORD-TYPE
 12615     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12616
 12617     PERFORM 8400-LOG-JOURNAL-RECORD.
 12618
 12619     IF CERT-NOTES-ARE-NOT-PRESENT
 12620        MOVE ' '                 TO WS-CERT-NOTE-SW
 12621     ELSE
 12622        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12623
 12624     IF INSURED-ADDR-PRESENT
 12625        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12626
 12627******************************************************************
 12628******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12629******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12630******************************************************************
 12631******************************************************************
 12632
 12633     IF CERT-ADDED-BATCH AND
 12634        (NOT NO-CLAIM-ATTACHED
 12635         OR
 12636         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12637        GO TO 1410-REWRITE-CERT.
 12638
 12639******************************************************************
 12640******************************************************************
 12641
 12642     IF CERT-ADDED-BATCH  AND
 12643        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12644        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 231
* EL6311.cbl
 12645
 12646     IF NO-CLAIM-ATTACHED
 12647        NEXT SENTENCE
 12648     ELSE
 12649        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12650        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12651        GO TO 1410-REWRITE-CERT.
 12652
 12653     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12654     MOVE 'D'                      TO JP-RECORD-TYPE.
 12655     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12656
 12657
 12658* EXEC CICS DELETE
 12659*         DATASET    (FILE-ID-ELCERT)
 12660*    END-EXEC.
 12661*    MOVE '&(                    &   #00011825' TO DFHEIV0
 12662     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12663     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12664     MOVE X'2020233030303131383235' TO DFHEIV0(25:11)
 12665     CALL 'kxdfhei1' USING DFHEIV0,
 12666           FILE-ID-ELCERT,
 12667           DFHEIV99,
 12668           DFHEIV99,
 12669           DFHEIV99,
 12670           DFHEIV99
 12671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12672
 12673
 12674     PERFORM 8400-LOG-JOURNAL-RECORD.
 12675
 12676******************************************************************
 12677*                                                                *
 12678*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12679*                                                                *
 12680******************************************************************
 12681
 12682     IF  CERT-NOTES-ARE-PRESENT
 12683         NEXT SENTENCE
 12684     ELSE
 12685         GO TO 1407-DELETE-MAILING.
 12686
 12687
 12688* EXEC CICS HANDLE CONDITION
 12689*         NOTFND  (1406-DELETE-ERNOTE)
 12690*    END-EXEC.
 12691*    MOVE '"$I                   ! . #00011842' TO DFHEIV0
 12692     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12694     MOVE X'2E20233030303131383432' TO DFHEIV0(25:11)
 12695     CALL 'kxdfhei1' USING DFHEIV0
 12696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12697
 12698
 12699     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12700     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12701     MOVE 0                     TO ERCNOT-SEQUENCE.
 12702
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 232
* EL6311.cbl
 12703 1406-DELETE-ERCNOT-LOOP.
 12704
 12705
 12706* EXEC CICS READ
 12707*        GTEQ
 12708*        DATASET   (FILE-ID-ERCNOT)
 12709*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12710*        RIDFLD    (ERCNOT-KEY)
 12711*    END-EXEC.
 12712*    MOVE '&"S        G          (   #00011852' TO DFHEIV0
 12713     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12715     MOVE X'2020233030303131383532' TO DFHEIV0(25:11)
 12716     CALL 'kxdfhei1' USING DFHEIV0,
 12717           FILE-ID-ERCNOT,
 12718           DFHEIV20,
 12719           DFHEIV99,
 12720           ERCNOT-KEY,
 12721           DFHEIV99,
 12722           DFHEIV99,
 12723           DFHEIV99
 12724     SET ADDRESS OF CERT-NOTE-FILE TO
 12725         DFHEIV20
 12726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12727
 12728
 12729     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12730     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12731         GO TO 1406-DELETE-ERNOTE
 12732     END-IF.
 12733
 12734     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12735     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12736     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12737
 12738     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12739
 12740
 12741* EXEC CICS DELETE
 12742*        DATASET   (FILE-ID-ERCNOT)
 12743*        RIDFLD    (ERCNOT-KEY)
 12744*        END-EXEC.
 12745*    MOVE '&(  R                 &   #00011870' TO DFHEIV0
 12746     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12747     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12748     MOVE X'2020233030303131383730' TO DFHEIV0(25:11)
 12749     CALL 'kxdfhei1' USING DFHEIV0,
 12750           FILE-ID-ERCNOT,
 12751           ERCNOT-KEY,
 12752           DFHEIV99,
 12753           DFHEIV99,
 12754           DFHEIV99
 12755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12756
 12757
 12758     PERFORM 8400-LOG-JOURNAL-RECORD.
 12759
 12760     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 233
* EL6311.cbl
 12761
 12762 1406-DELETE-ERNOTE.
 12763
 12764
 12765* EXEC CICS HANDLE CONDITION
 12766*         NOTFND  (1407-DELETE-MAILING)
 12767*    END-EXEC.
 12768*    MOVE '"$I                   ! / #00011881' TO DFHEIV0
 12769     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12771     MOVE X'2F20233030303131383831' TO DFHEIV0(25:11)
 12772     CALL 'kxdfhei1' USING DFHEIV0
 12773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12774
 12775
 12776
 12777* EXEC CICS READ
 12778*        EQUAL
 12779*        DATASET   (FILE-ID-ERNOTE)
 12780*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12781*        RIDFLD    (ELCERT-KEY)
 12782*        UPDATE
 12783*    END-EXEC.
 12784*    MOVE '&"S        EU         (   #00011885' TO DFHEIV0
 12785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12787     MOVE X'2020233030303131383835' TO DFHEIV0(25:11)
 12788     CALL 'kxdfhei1' USING DFHEIV0,
 12789           FILE-ID-ERNOTE,
 12790           DFHEIV20,
 12791           DFHEIV99,
 12792           ELCERT-KEY,
 12793           DFHEIV99,
 12794           DFHEIV99,
 12795           DFHEIV99
 12796     SET ADDRESS OF CERTIFICATE-NOTE TO
 12797         DFHEIV20
 12798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12799
 12800
 12801     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12802     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12803     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12804
 12805     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12806
 12807
 12808* EXEC CICS DELETE
 12809*        DATASET   (FILE-ID-ERNOTE)
 12810*        END-EXEC.
 12811*    MOVE '&(                    &   #00011899' TO DFHEIV0
 12812     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12813     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12814     MOVE X'2020233030303131383939' TO DFHEIV0(25:11)
 12815     CALL 'kxdfhei1' USING DFHEIV0,
 12816           FILE-ID-ERNOTE,
 12817           DFHEIV99,
 12818           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 234
* EL6311.cbl
 12819           DFHEIV99,
 12820           DFHEIV99
 12821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12822
 12823
 12824     PERFORM 8400-LOG-JOURNAL-RECORD.
 12825
 12826******************************************************************
 12827*                                                                *
 12828*                DELETE MAILING ADDRESS RECORDS                  *
 12829*                                                                *
 12830******************************************************************
 12831
 12832 1407-DELETE-MAILING.
 12833     IF CERT-ADDRESS-PRESENT
 12834        NEXT SENTENCE
 12835     ELSE
 12836        GO TO 1420-CONTINUE-DELETE.
 12837
 12838
 12839* EXEC CICS HANDLE CONDITION
 12840*         NOTFND  (1420-CONTINUE-DELETE)
 12841*    END-EXEC.
 12842*    MOVE '"$I                   ! 0 #00011917' TO DFHEIV0
 12843     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12845     MOVE X'3020233030303131393137' TO DFHEIV0(25:11)
 12846     CALL 'kxdfhei1' USING DFHEIV0
 12847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12848
 12849
 12850
 12851* EXEC CICS READ
 12852*        EQUAL
 12853*        DATASET   (FILE-ID-ERMAIL)
 12854*        SET       (ADDRESS OF MAILING-DATA)
 12855*        RIDFLD    (ELCERT-KEY)
 12856*        UPDATE
 12857*    END-EXEC.
 12858*    MOVE '&"S        EU         (   #00011921' TO DFHEIV0
 12859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12860     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12861     MOVE X'2020233030303131393231' TO DFHEIV0(25:11)
 12862     CALL 'kxdfhei1' USING DFHEIV0,
 12863           FILE-ID-ERMAIL,
 12864           DFHEIV20,
 12865           DFHEIV99,
 12866           ELCERT-KEY,
 12867           DFHEIV99,
 12868           DFHEIV99,
 12869           DFHEIV99
 12870     SET ADDRESS OF MAILING-DATA TO
 12871         DFHEIV20
 12872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12873
 12874
 12875     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12876     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 235
* EL6311.cbl
 12877     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12878
 12879     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12880
 12881
 12882* EXEC CICS DELETE
 12883*        DATASET   (FILE-ID-ERMAIL)
 12884*    END-EXEC.
 12885*    MOVE '&(                    &   #00011935' TO DFHEIV0
 12886     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12887     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12888     MOVE X'2020233030303131393335' TO DFHEIV0(25:11)
 12889     CALL 'kxdfhei1' USING DFHEIV0,
 12890           FILE-ID-ERMAIL,
 12891           DFHEIV99,
 12892           DFHEIV99,
 12893           DFHEIV99,
 12894           DFHEIV99
 12895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12896
 12897
 12898     GO TO 1420-CONTINUE-DELETE.
 12899
 12900 1410-REWRITE-CERT.
 12901     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12902     MOVE 'C'                      TO JP-RECORD-TYPE.
 12903     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12904     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12905
 12906
 12907* EXEC CICS REWRITE
 12908*         DATASET    (FILE-ID-ELCERT)
 12909*         FROM       (CERTIFICATE-MASTER)
 12910*         END-EXEC.
 12911     MOVE LENGTH OF
 12912      CERTIFICATE-MASTER
 12913       TO DFHEIV11
 12914*    MOVE '&& L                  %   #00011947' TO DFHEIV0
 12915     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12916     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12917     MOVE X'2020233030303131393437' TO DFHEIV0(25:11)
 12918     CALL 'kxdfhei1' USING DFHEIV0,
 12919           FILE-ID-ELCERT,
 12920           CERTIFICATE-MASTER,
 12921           DFHEIV11,
 12922           DFHEIV99
 12923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12924
 12925
 12926     PERFORM 8400-LOG-JOURNAL-RECORD.
 12927
 12928 1420-CONTINUE-DELETE.
 12929     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12930     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12931
 12932     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12933     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12934
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 236
* EL6311.cbl
 12935     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12936
 12937 1450-DELETE-PB-RECORD.
 12938     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12939     MOVE 'D'                      TO JP-RECORD-TYPE
 12940     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12941
 12942
 12943* EXEC CICS DELETE
 12944*        DATASET    (FILE-ID-ERPNDB)
 12945*    END-EXEC.
 12946*    MOVE '&(                    &   #00011968' TO DFHEIV0
 12947     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12948     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12949     MOVE X'2020233030303131393638' TO DFHEIV0(25:11)
 12950     CALL 'kxdfhei1' USING DFHEIV0,
 12951           FILE-ID-ERPNDB,
 12952           DFHEIV99,
 12953           DFHEIV99,
 12954           DFHEIV99,
 12955           DFHEIV99
 12956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12957
 12958
 12959     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12960
 12961     PERFORM 8400-LOG-JOURNAL-RECORD.
 12962
 12963     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12964     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12965     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12966
 12967
 12968* EXEC CICS HANDLE CONDITION
 12969*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12970*    END-EXEC.
 12971*    MOVE '"$I                   ! 1 #00011980' TO DFHEIV0
 12972     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12974     MOVE X'3120233030303131393830' TO DFHEIV0(25:11)
 12975     CALL 'kxdfhei1' USING DFHEIV0
 12976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12977
 12978
 12979
 12980* EXEC CICS READ
 12981*        SET     (ADDRESS OF PENDING-BUSINESS)
 12982*        DATASET (FILE-ID-ERPNDB)
 12983*        RIDFLD  (ERPNDB-KEY)
 12984*        UPDATE
 12985*    END-EXEC.
 12986*    MOVE '&"S        EU         (   #00011984' TO DFHEIV0
 12987     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12988     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12989     MOVE X'2020233030303131393834' TO DFHEIV0(25:11)
 12990     CALL 'kxdfhei1' USING DFHEIV0,
 12991           FILE-ID-ERPNDB,
 12992           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 237
* EL6311.cbl
 12993           DFHEIV99,
 12994           ERPNDB-KEY,
 12995           DFHEIV99,
 12996           DFHEIV99,
 12997           DFHEIV99
 12998     SET ADDRESS OF PENDING-BUSINESS TO
 12999         DFHEIV20
 13000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13001
 13002
 13003     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13004
 13005     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13006
 13007     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13008        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13009        MOVE 'D'                   TO JP-RECORD-TYPE
 13010        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13011
 13012* EXEC CICS DELETE
 13013*            DATASET    (FILE-ID-ERPNDB)
 13014*       END-EXEC
 13015*    MOVE '&(                    &   #00011999' TO DFHEIV0
 13016     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13017     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13018     MOVE X'2020233030303131393939' TO DFHEIV0(25:11)
 13019     CALL 'kxdfhei1' USING DFHEIV0,
 13020           FILE-ID-ERPNDB,
 13021           DFHEIV99,
 13022           DFHEIV99,
 13023           DFHEIV99,
 13024           DFHEIV99
 13025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13026        PERFORM 8400-LOG-JOURNAL-RECORD
 13027     ELSE
 13028        MOVE 'B'                 TO JP-RECORD-TYPE
 13029        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13030        PERFORM 8400-LOG-JOURNAL-RECORD
 13031        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13032        MOVE 'C'                 TO JP-RECORD-TYPE
 13033        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13034
 13035* EXEC CICS REWRITE
 13036*            DATASET    (FILE-ID-ERPNDB)
 13037*            FROM       (PENDING-BUSINESS)
 13038*       END-EXEC
 13039     MOVE LENGTH OF
 13040      PENDING-BUSINESS
 13041       TO DFHEIV11
 13042*    MOVE '&& L                  %   #00012010' TO DFHEIV0
 13043     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13044     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13045     MOVE X'2020233030303132303130' TO DFHEIV0(25:11)
 13046     CALL 'kxdfhei1' USING DFHEIV0,
 13047           FILE-ID-ERPNDB,
 13048           PENDING-BUSINESS,
 13049           DFHEIV11,
 13050           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 238
* EL6311.cbl
 13051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13052        PERFORM 8400-LOG-JOURNAL-RECORD.
 13053
 13054******************************************************************
 13055*                                                                *
 13056*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13057*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13058*                                                                *
 13059******************************************************************
 13060
 13061     IF NOT PI-AR-PROCESSING
 13062        GO TO 1475-DELETE-FINISHED.
 13063
 13064     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13065        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13066        NEXT SENTENCE
 13067     ELSE
 13068        GO TO 1475-DELETE-FINISHED.
 13069
 13070
 13071* EXEC CICS HANDLE CONDITION
 13072*         NOTFND    (1475-DELETE-FINISHED)
 13073*         END-EXEC.
 13074*    MOVE '"$I                   ! 2 #00012032' TO DFHEIV0
 13075     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13077     MOVE X'3220233030303132303332' TO DFHEIV0(25:11)
 13078     CALL 'kxdfhei1' USING DFHEIV0
 13079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13080
 13081
 13082     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13083     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13084
 13085
 13086* EXEC CICS READ
 13087*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13088*        DATASET (FILE-ID-ERRQST)
 13089*        RIDFLD  (ERRQST-KEY)
 13090*        UPDATE
 13091*    END-EXEC.
 13092*    MOVE '&"S        EU         (   #00012039' TO DFHEIV0
 13093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13094     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13095     MOVE X'2020233030303132303339' TO DFHEIV0(25:11)
 13096     CALL 'kxdfhei1' USING DFHEIV0,
 13097           FILE-ID-ERRQST,
 13098           DFHEIV20,
 13099           DFHEIV99,
 13100           ERRQST-KEY,
 13101           DFHEIV99,
 13102           DFHEIV99,
 13103           DFHEIV99
 13104     SET ADDRESS OF AR-REQUEST-RECORD TO
 13105         DFHEIV20
 13106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13107
 13108
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 239
* EL6311.cbl
 13109     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13110
 13111     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13112
 13113     MOVE 'D'                      TO JP-RECORD-TYPE.
 13114     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13115
 13116
 13117* EXEC CICS DELETE
 13118*         DATASET    (FILE-ID-ERRQST)
 13119*    END-EXEC.
 13120*    MOVE '&(                    &   #00012053' TO DFHEIV0
 13121     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13122     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13123     MOVE X'2020233030303132303533' TO DFHEIV0(25:11)
 13124     CALL 'kxdfhei1' USING DFHEIV0,
 13125           FILE-ID-ERRQST,
 13126           DFHEIV99,
 13127           DFHEIV99,
 13128           DFHEIV99,
 13129           DFHEIV99
 13130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13131
 13132
 13133     PERFORM 8400-LOG-JOURNAL-RECORD.
 13134
 13135 1475-DELETE-FINISHED.
 13136     MOVE ZEROS                  TO EMI-ERROR.
 13137     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13138     MOVE LOW-VALUES             TO EL631BI.
 13139     MOVE -1                     TO BMAINTL.
 13140     GO TO 8100-SEND-INITIAL-MAP.
 13141
 13142 1480-BATCH-HDR-NOT-FOUND.
 13143     MOVE -1                     TO BMAINTL.
 13144     MOVE ER-7450                TO EMI-ERROR.
 13145     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13146     GO TO 8200-SEND-DATAONLY.
 13147
 13148 1490-RECORD-NOT-FOUND.
 13149     MOVE -1                     TO BMAINTL.
 13150     MOVE ER-7451                TO EMI-ERROR.
 13151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13152     GO TO 8200-SEND-DATAONLY.
 13153
 13154******************************************************************
 13155*            O V E R   C H A R G E   P R O C E S S I N G         *
 13156******************************************************************
 13157 1500-UPDATE-ERNOTE.
 13158     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13159     MOVE 'A'                    TO WS-NOTE-SW
 13160     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13161     .
 13162 1500-EXIT.
 13163     EXIT.
 13164 1510-ADD-ERNOTE-REC.
 13165
 13166* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 240
* EL6311.cbl
 13167*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13168*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13169*        INITIMG (GETMAIN-SPACE)
 13170*    END-EXEC
 13171*    MOVE ',"IL                  $   #00012089' TO DFHEIV0
 13172     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13173     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13174     MOVE X'2020233030303132303839' TO DFHEIV0(25:11)
 13175     CALL 'kxdfhei1' USING DFHEIV0,
 13176           DFHEIV20,
 13177           ERNOTE-RECORD-LENGTH,
 13178           GETMAIN-SPACE
 13179     SET ADDRESS OF CERTIFICATE-NOTE TO
 13180         DFHEIV20
 13181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13182     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13183                                 TO ERNOTE-KEY
 13184
 13185* EXEC CICS READ
 13186*       DATASET    (FILE-ID-ERNOTE)
 13187*       RIDFLD     (ERNOTE-KEY)
 13188*       INTO       (CERTIFICATE-NOTE)
 13189*       RESP       (WS-RESPONSE)
 13190*       UPDATE
 13191*    END-EXEC
 13192     MOVE LENGTH OF
 13193      CERTIFICATE-NOTE
 13194       TO DFHEIV11
 13195*    MOVE '&"IL       EU         (  N#00012096' TO DFHEIV0
 13196     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13197     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13198     MOVE X'204E233030303132303936' TO DFHEIV0(25:11)
 13199     CALL 'kxdfhei1' USING DFHEIV0,
 13200           FILE-ID-ERNOTE,
 13201           CERTIFICATE-NOTE,
 13202           DFHEIV11,
 13203           ERNOTE-KEY,
 13204           DFHEIV99,
 13205           DFHEIV99,
 13206           DFHEIV99
 13207     MOVE EIBRESP  TO WS-RESPONSE
 13208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13209     IF RESP-NORMAL
 13210        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13211           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13212        END-IF
 13213        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13214           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13215        END-IF
 13216        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13217           (N1 > +10)
 13218           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13219           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13220        END-PERFORM
 13221        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13222          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13223
 13224* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 241
* EL6311.cbl
 13225*            DATASET    (FILE-ID-ERNOTE)
 13226*          END-EXEC
 13227*    MOVE '&*                    #   #00012117' TO DFHEIV0
 13228     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13229     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13230     MOVE X'2020233030303132313137' TO DFHEIV0(25:11)
 13231     CALL 'kxdfhei1' USING DFHEIV0,
 13232           FILE-ID-ERNOTE,
 13233           DFHEIV99
 13234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13235        ELSE
 13236          PERFORM VARYING N1 FROM +1 BY +1
 13237           UNTIL (N1 > +10)
 13238           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13239          END-PERFORM
 13240          IF (N1 < +11)
 13241            IF N1 >= CN-BILLING-START-LINE-NO AND
 13242              N1 <= CN-BILLING-END-LINE-NO
 13243              IF PI-COMPANY-ID = 'DCC'
 13244                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13245              ELSE
 13246                 MOVE WS-VA-NO-COMM-MESS
 13247                                    TO CN-LINE (N1)
 13248              END-IF
 13249            ELSE
 13250              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13251               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13252                IF PI-COMPANY-ID = 'DCC'
 13253                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13254                ELSE
 13255                  MOVE WS-VA-NO-COMM-MESS
 13256                                    TO CN-LINE (N1)
 13257                END-IF
 13258                MOVE N1             TO CN-BILLING-END-LINE-NO
 13259              ELSE
 13260                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13261                  IF PI-COMPANY-ID = 'DCC'
 13262                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13263                  ELSE
 13264                     MOVE WS-VA-NO-COMM-MESS
 13265                                    TO CN-LINE (N1)
 13266                  END-IF
 13267                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13268                                      CN-BILLING-START-LINE-NO
 13269                ELSE
 13270                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13271                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13272                     IF PI-COMPANY-ID = 'DCC'
 13273                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13274                     ELSE
 13275                       MOVE WS-VA-NO-COMM-MESS
 13276                                    TO CN-LINE (N1)
 13277                     END-IF
 13278                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13279                  ELSE
 13280                     PERFORM 1700-SQUEEZE-IT-IN
 13281                                 THRU 1700-EXIT
 13282                  END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 242
* EL6311.cbl
 13283                END-IF
 13284              END-IF
 13285            END-IF
 13286            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13287            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13288            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13289
 13290* EXEC CICS REWRITE
 13291*              DATASET    (FILE-ID-ERNOTE)
 13292*              FROM       (CERTIFICATE-NOTE)
 13293*              RESP       (WS-RESPONSE)
 13294*           END-EXEC
 13295     MOVE LENGTH OF
 13296      CERTIFICATE-NOTE
 13297       TO DFHEIV11
 13298*    MOVE '&& L                  %  N#00012174' TO DFHEIV0
 13299     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13300     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13301     MOVE X'204E233030303132313734' TO DFHEIV0(25:11)
 13302     CALL 'kxdfhei1' USING DFHEIV0,
 13303           FILE-ID-ERNOTE,
 13304           CERTIFICATE-NOTE,
 13305           DFHEIV11,
 13306           DFHEIV99
 13307     MOVE EIBRESP  TO WS-RESPONSE
 13308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13309          END-IF
 13310        END-IF
 13311     ELSE
 13312        MOVE SPACES              TO CERTIFICATE-NOTE
 13313        MOVE 'CN'                TO CN-RECORD-ID
 13314        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13315                                 TO CN-CONTROL-PRIMARY
 13316                                    ERNOTE-KEY
 13317        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13318                                    CN-BILLING-END-LINE-NO
 13319        IF PI-COMPANY-ID = 'DCC'
 13320           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13321        ELSE
 13322           MOVE WS-VA-NO-COMM-MESS
 13323                                 TO CN-LINE (1)
 13324        END-IF
 13325        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13326        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13327        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13328
 13329* EXEC CICS WRITE
 13330*          DATASET    (FILE-ID-ERNOTE)
 13331*          FROM       (CERTIFICATE-NOTE)
 13332*          RIDFLD     (ERNOTE-KEY)
 13333*          RESP       (WS-RESPONSE)
 13334*       END-EXEC
 13335     MOVE LENGTH OF
 13336      CERTIFICATE-NOTE
 13337       TO DFHEIV11
 13338*    MOVE '&$ L                  ''  N#00012198' TO DFHEIV0
 13339     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13340     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 243
* EL6311.cbl
 13341     MOVE X'204E233030303132313938' TO DFHEIV0(25:11)
 13342     CALL 'kxdfhei1' USING DFHEIV0,
 13343           FILE-ID-ERNOTE,
 13344           CERTIFICATE-NOTE,
 13345           DFHEIV11,
 13346           ERNOTE-KEY,
 13347           DFHEIV99,
 13348           DFHEIV99
 13349     MOVE EIBRESP  TO WS-RESPONSE
 13350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13351     END-IF
 13352     .
 13353 1510-EXIT.
 13354     EXIT.
 13355 1520-UPDATE-ELCERT.
 13356     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13357                                 TO ELCERT-KEY
 13358
 13359* EXEC CICS READ
 13360*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13361*        DATASET (FILE-ID-ELCERT)
 13362*        RIDFLD  (ELCERT-KEY)
 13363*        UPDATE
 13364*        RESP    (WS-RESPONSE)
 13365*    END-EXEC
 13366*    MOVE '&"S        EU         (  N#00012211' TO DFHEIV0
 13367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13368     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13369     MOVE X'204E233030303132323131' TO DFHEIV0(25:11)
 13370     CALL 'kxdfhei1' USING DFHEIV0,
 13371           FILE-ID-ELCERT,
 13372           DFHEIV20,
 13373           DFHEIV99,
 13374           ELCERT-KEY,
 13375           DFHEIV99,
 13376           DFHEIV99,
 13377           DFHEIV99
 13378     SET ADDRESS OF CERTIFICATE-MASTER TO
 13379         DFHEIV20
 13380     MOVE EIBRESP  TO WS-RESPONSE
 13381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13382     IF RESP-NORMAL
 13383        IF WS-NOTE-SW = 'A'
 13384           IF CM-NOTE-SW = ' '
 13385              MOVE '2'             TO CM-NOTE-SW
 13386           ELSE
 13387             IF CM-NOTE-SW = '1'
 13388                MOVE '3'           TO CM-NOTE-SW
 13389             ELSE
 13390               IF CM-NOTE-SW = '4'
 13391                  MOVE '6'         TO CM-NOTE-SW
 13392               ELSE
 13393                 IF CM-NOTE-SW = '5'
 13394                    MOVE '7'       TO CM-NOTE-SW
 13395                 END-IF
 13396               END-IF
 13397             END-IF
 13398           END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 244
* EL6311.cbl
 13399        ELSE
 13400           IF CM-NOTE-SW = '2'
 13401              MOVE ' '             TO CM-NOTE-SW
 13402           ELSE
 13403             IF CM-NOTE-SW = '3'
 13404                MOVE '1'           TO CM-NOTE-SW
 13405             ELSE
 13406               IF CM-NOTE-SW = '6'
 13407                  MOVE '4'         TO CM-NOTE-SW
 13408               ELSE
 13409                 IF CM-NOTE-SW = '7'
 13410                    MOVE '5'       TO CM-NOTE-SW
 13411                 END-IF
 13412               END-IF
 13413             END-IF
 13414           END-IF
 13415        END-IF
 13416
 13417* EXEC CICS REWRITE
 13418*          DATASET    (FILE-ID-ELCERT)
 13419*          FROM       (CERTIFICATE-MASTER)
 13420*          RESP       (WS-RESPONSE)
 13421*       END-EXEC
 13422     MOVE LENGTH OF
 13423      CERTIFICATE-MASTER
 13424       TO DFHEIV11
 13425*    MOVE '&& L                  %  N#00012252' TO DFHEIV0
 13426     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13427     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13428     MOVE X'204E233030303132323532' TO DFHEIV0(25:11)
 13429     CALL 'kxdfhei1' USING DFHEIV0,
 13430           FILE-ID-ELCERT,
 13431           CERTIFICATE-MASTER,
 13432           DFHEIV11,
 13433           DFHEIV99
 13434     MOVE EIBRESP  TO WS-RESPONSE
 13435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13436        IF RESP-NORMAL
 13437           CONTINUE
 13438        ELSE
 13439           MOVE WS-RESPONSE TO EMI-ERROR
 13440           PERFORM 9900-ERROR-FORMAT
 13441                                 THRU 9900-EXIT
 13442           GO TO 8200-SEND-DATAONLY
 13443        END-IF
 13444     ELSE
 13445        MOVE -1                  TO BMAINTL
 13446        MOVE 0249                TO EMI-ERROR
 13447        PERFORM 9900-ERROR-FORMAT
 13448                                 THRU 9900-EXIT
 13449        GO TO 8200-SEND-DATAONLY
 13450     END-IF
 13451     .
 13452 1520-EXIT.
 13453     EXIT.
 13454 1600-UPDATE-ERPYAJ.
 13455     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13456                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 245
* EL6311.cbl
 13457     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13458                                 THRU 1620-EXIT
 13459     .
 13460 1600-EXIT.
 13461     EXIT.
 13462 1610-ADD-ERPYAJ-BANK-REC.
 13463
 13464* EXEC CICS GETMAIN
 13465*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13466*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13467*        INITIMG (GETMAIN-SPACE)
 13468*    END-EXEC
 13469*    MOVE ',"IL                  $   #00012284' TO DFHEIV0
 13470     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13471     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13472     MOVE X'2020233030303132323834' TO DFHEIV0(25:11)
 13473     CALL 'kxdfhei1' USING DFHEIV0,
 13474           DFHEIV20,
 13475           ERPYAJ-RECORD-LENGTH,
 13476           GETMAIN-SPACE
 13477     SET ADDRESS OF PENDING-PAY-ADJ TO
 13478         DFHEIV20
 13479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13480     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13481     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13482     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13483     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13484     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13485     MOVE +10                    TO ERPYAJ-SEQ-NO
 13486     MOVE 'R'                    TO ERPYAJ-TYPE
 13487     IF REVERSAL
 13488        MOVE 'C'                 TO ERPYAJ-TYPE
 13489     END-IF
 13490     MOVE SPACES                 TO PENDING-PAY-ADJ
 13491     MOVE 'PY'                   TO PY-RECORD-ID
 13492     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13493     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13494     IF REVERSAL
 13495        MOVE PB-I-DCC-OVER-CHG-AMT
 13496                                 TO PY-ENTRY-AMT
 13497     END-IF
 13498     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13499                                    PY-INPUT-DT
 13500*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13501*                                   PY-INPUT-DT
 13502     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13503     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13504     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13505     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13506     IF PB-CARRIER = '2'
 13507        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13508     ELSE
 13509        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13510     END-IF
 13511     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13512                                    PY-BILLED-DATE
 13513                                    PY-AR-DATE
 13514                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 246
* EL6311.cbl
 13515                                    PY-CHECK-WRITTEN-DT
 13516     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13517                                    PY-CHECK-QUE-SEQUENCE
 13518     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13519     PERFORM WITH TEST AFTER
 13520        UNTIL (NOT RESP-DUPKEY)
 13521           AND (NOT RESP-DUPREC)
 13522
 13523* EXEC CICS WRITE
 13524*          DATASET    (FILE-ID-ERPYAJ)
 13525*          FROM       (PENDING-PAY-ADJ)
 13526*          RIDFLD     (ERPYAJ-KEY)
 13527*          RESP       (WS-RESPONSE)
 13528*       END-EXEC
 13529     MOVE LENGTH OF
 13530      PENDING-PAY-ADJ
 13531       TO DFHEIV11
 13532*    MOVE '&$ L                  ''  N#00012331' TO DFHEIV0
 13533     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13535     MOVE X'204E233030303132333331' TO DFHEIV0(25:11)
 13536     CALL 'kxdfhei1' USING DFHEIV0,
 13537           FILE-ID-ERPYAJ,
 13538           PENDING-PAY-ADJ,
 13539           DFHEIV11,
 13540           ERPYAJ-KEY,
 13541           DFHEIV99,
 13542           DFHEIV99
 13543     MOVE EIBRESP  TO WS-RESPONSE
 13544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13545        IF RESP-DUPKEY OR RESP-DUPREC
 13546           ADD +1                TO ERPYAJ-SEQ-NO
 13547           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13548        END-IF
 13549     END-PERFORM
 13550     .
 13551 1610-EXIT.
 13552     EXIT.
 13553 1620-ADD-ERPYAJ-DLR-REC.
 13554     MOVE 'C'                    TO ERPYAJ-TYPE
 13555     IF REVERSAL
 13556        MOVE 'R'                 TO ERPYAJ-TYPE
 13557     END-IF
 13558     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13559                                    ERPYAJ-ACCOUNT
 13560     ADD +1                      TO ERPYAJ-SEQ-NO
 13561     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13562     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13563     IF PB-CARRIER = '2'
 13564        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13565     ELSE
 13566        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13567     END-IF
 13568     PERFORM WITH TEST AFTER
 13569        UNTIL (NOT RESP-DUPKEY)
 13570           AND (NOT RESP-DUPREC)
 13571
 13572* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 247
* EL6311.cbl
 13573*          DATASET    (FILE-ID-ERPYAJ)
 13574*          FROM       (PENDING-PAY-ADJ)
 13575*          RIDFLD     (ERPYAJ-KEY)
 13576*          RESP       (WS-RESPONSE)
 13577*       END-EXEC
 13578     MOVE LENGTH OF
 13579      PENDING-PAY-ADJ
 13580       TO DFHEIV11
 13581*    MOVE '&$ L                  ''  N#00012363' TO DFHEIV0
 13582     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13583     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13584     MOVE X'204E233030303132333633' TO DFHEIV0(25:11)
 13585     CALL 'kxdfhei1' USING DFHEIV0,
 13586           FILE-ID-ERPYAJ,
 13587           PENDING-PAY-ADJ,
 13588           DFHEIV11,
 13589           ERPYAJ-KEY,
 13590           DFHEIV99,
 13591           DFHEIV99
 13592     MOVE EIBRESP  TO WS-RESPONSE
 13593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13594        IF RESP-DUPKEY OR RESP-DUPREC
 13595           ADD +1                TO ERPYAJ-SEQ-NO
 13596           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13597        END-IF
 13598     END-PERFORM
 13599     .
 13600 1620-EXIT.
 13601     EXIT.
 13602 1700-SQUEEZE-IT-IN.
 13603     IF (N1 > CN-BILLING-END-LINE-NO)
 13604        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13605           N1 = +1
 13606           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13607           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13608              IF PI-COMPANY-ID = 'DCC'
 13609                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13610              ELSE
 13611                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13612              END-IF
 13613              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13614              MOVE +2 TO N1
 13615           END-IF
 13616        END-PERFORM
 13617     ELSE
 13618        IF (N1 < CN-BILLING-START-LINE-NO)
 13619           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13620              N1 = +10
 13621              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13622              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13623                 IF PI-COMPANY-ID = 'DCC'
 13624                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13625                 ELSE
 13626                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13627                 END-IF
 13628                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13629                 MOVE +9 TO N1
 13630              END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 248
* EL6311.cbl
 13631           END-PERFORM
 13632        END-IF
 13633     END-IF
 13634     .
 13635 1700-EXIT.
 13636     EXIT.
 13637 1800-REMOVE-CERT-NOTES.
 13638     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13639                                 TO ERNOTE-KEY
 13640
 13641* EXEC CICS READ
 13642*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13643*       DATASET    (FILE-ID-ERNOTE)
 13644*       RIDFLD     (ERNOTE-KEY)
 13645*       RESP       (WS-RESPONSE)
 13646*       UPDATE
 13647*    END-EXEC
 13648*    MOVE '&"S        EU         (  N#00012415' TO DFHEIV0
 13649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13650     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13651     MOVE X'204E233030303132343135' TO DFHEIV0(25:11)
 13652     CALL 'kxdfhei1' USING DFHEIV0,
 13653           FILE-ID-ERNOTE,
 13654           DFHEIV20,
 13655           DFHEIV99,
 13656           ERNOTE-KEY,
 13657           DFHEIV99,
 13658           DFHEIV99,
 13659           DFHEIV99
 13660     SET ADDRESS OF CERTIFICATE-NOTE TO
 13661         DFHEIV20
 13662     MOVE EIBRESP  TO WS-RESPONSE
 13663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13664     IF RESP-NORMAL
 13665        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13666           (N1 > +10)
 13667           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13668           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13669        END-PERFORM
 13670        IF N1 < +11
 13671           MOVE SPACES              TO CN-LINE (N1)
 13672           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13673              N1 <= CN-BILLING-END-LINE-NO
 13674              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13675              IF CN-BILLING-END-LINE-NO <
 13676                               CN-BILLING-START-LINE-NO
 13677                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13678                                     CN-BILLING-START-LINE-NO
 13679              END-IF
 13680              PERFORM 1820-SQUEEZE-ERNOTE
 13681                                  THRU 1820-EXIT
 13682           END-IF
 13683           IF CN-LINES = SPACES
 13684
 13685* EXEC CICS DELETE
 13686*                DATASET    (FILE-ID-ERNOTE)
 13687*                RESP       (WS-RESPONSE)
 13688*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 249
* EL6311.cbl
 13689*    MOVE '&(                    &  N#00012442' TO DFHEIV0
 13690     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13691     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13692     MOVE X'204E233030303132343432' TO DFHEIV0(25:11)
 13693     CALL 'kxdfhei1' USING DFHEIV0,
 13694           FILE-ID-ERNOTE,
 13695           DFHEIV99,
 13696           DFHEIV99,
 13697           DFHEIV99,
 13698           DFHEIV99
 13699     MOVE EIBRESP  TO WS-RESPONSE
 13700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13701              IF RESP-NORMAL
 13702                 MOVE 'D'        TO WS-NOTE-SW
 13703                 PERFORM 1520-UPDATE-ELCERT
 13704                                 THRU 1520-EXIT
 13705              END-IF
 13706           ELSE
 13707
 13708* EXEC CICS REWRITE
 13709*                DATASET    (FILE-ID-ERNOTE)
 13710*                FROM       (CERTIFICATE-NOTE)
 13711*                RESP       (WS-RESPONSE)
 13712*             END-EXEC
 13713     MOVE LENGTH OF
 13714      CERTIFICATE-NOTE
 13715       TO DFHEIV11
 13716*    MOVE '&& L                  %  N#00012452' TO DFHEIV0
 13717     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13718     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13719     MOVE X'204E233030303132343532' TO DFHEIV0(25:11)
 13720     CALL 'kxdfhei1' USING DFHEIV0,
 13721           FILE-ID-ERNOTE,
 13722           CERTIFICATE-NOTE,
 13723           DFHEIV11,
 13724           DFHEIV99
 13725     MOVE EIBRESP  TO WS-RESPONSE
 13726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13727           END-IF
 13728        END-IF
 13729     END-IF
 13730     .
 13731 1800-EXIT.
 13732     EXIT.
 13733 1820-SQUEEZE-ERNOTE.
 13734     MOVE CN-BILLING-START-LINE-NO TO N2
 13735     IF N2 = 0
 13736         MOVE +1                 TO N2
 13737     END-IF
 13738     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13739        (N1 > +9)
 13740        IF CN-LINE (N1) = SPACES
 13741           MOVE CN-LINE (N1 + +1)
 13742                                 TO CN-LINE (N1)
 13743           MOVE SPACES           TO CN-LINE (N1 + +1)
 13744        END-IF
 13745     END-PERFORM
 13746     .
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 250
* EL6311.cbl
 13747 1820-EXIT.
 13748     EXIT.
 13749 1900-DELETE-ERPYAJ.
 13750     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13751     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13752     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13753     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13754     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13755     MOVE +10                    TO ERPYAJ-SEQ-NO
 13756     MOVE 'R'                    TO ERPYAJ-TYPE
 13757     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13758
 13759* EXEC CICS STARTBR
 13760*       DATASET    (FILE-ID-ERPYAJ)
 13761*       RIDFLD     (ERPYAJ-KEY)
 13762*       RESP       (WS-RESPONSE)
 13763*    END-EXEC
 13764     MOVE 0
 13765       TO DFHEIV11
 13766*    MOVE '&,         G          &  N#00012488' TO DFHEIV0
 13767     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13768     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13769     MOVE X'204E233030303132343838' TO DFHEIV0(25:11)
 13770     CALL 'kxdfhei1' USING DFHEIV0,
 13771           FILE-ID-ERPYAJ,
 13772           ERPYAJ-KEY,
 13773           DFHEIV99,
 13774           DFHEIV11,
 13775           DFHEIV99
 13776     MOVE EIBRESP  TO WS-RESPONSE
 13777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13778     IF RESP-NORMAL
 13779        CONTINUE
 13780     ELSE
 13781        GO TO 1900-GET-DEALER
 13782     END-IF
 13783     .
 13784 1900-READNEXT-ERPYAJ-B.
 13785*  GET THE BANK ERPYAJ RECORD
 13786
 13787* EXEC CICS READNEXT
 13788*       DATASET    (FILE-ID-ERPYAJ)
 13789*       RIDFLD     (ERPYAJ-KEY)
 13790*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13791*       RESP       (WS-RESPONSE)
 13792*    END-EXEC
 13793     MOVE 0
 13794       TO DFHEIV11
 13795*    MOVE '&.S                   )  N#00012501' TO DFHEIV0
 13796     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13797     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13798     MOVE X'204E233030303132353031' TO DFHEIV0(25:11)
 13799     CALL 'kxdfhei1' USING DFHEIV0,
 13800           FILE-ID-ERPYAJ,
 13801           DFHEIV20,
 13802           DFHEIV99,
 13803           ERPYAJ-KEY,
 13804           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 251
* EL6311.cbl
 13805           DFHEIV11,
 13806           DFHEIV99,
 13807           DFHEIV99
 13808     SET ADDRESS OF PENDING-PAY-ADJ TO
 13809         DFHEIV20
 13810     MOVE EIBRESP  TO WS-RESPONSE
 13811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13812     IF RESP-NORMAL
 13813        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13814           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13815              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13816                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13817
 13818* EXEC CICS READ
 13819*                   DATASET    (FILE-ID-ERPYAJ)
 13820*                   RIDFLD     (ERPYAJ-KEY)
 13821*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13822*                   RESP       (WS-RESPONSE)
 13823*                   UPDATE
 13824*                END-EXEC
 13825*    MOVE '&"S        EU         (  N#00012512' TO DFHEIV0
 13826     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13827     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13828     MOVE X'204E233030303132353132' TO DFHEIV0(25:11)
 13829     CALL 'kxdfhei1' USING DFHEIV0,
 13830           FILE-ID-ERPYAJ,
 13831           DFHEIV20,
 13832           DFHEIV99,
 13833           ERPYAJ-KEY,
 13834           DFHEIV99,
 13835           DFHEIV99,
 13836           DFHEIV99
 13837     SET ADDRESS OF PENDING-PAY-ADJ TO
 13838         DFHEIV20
 13839     MOVE EIBRESP  TO WS-RESPONSE
 13840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13841                 IF RESP-NORMAL
 13842
 13843* EXEC CICS DELETE
 13844*                      DATASET   (FILE-ID-ERPYAJ)
 13845*                      RESP      (WS-RESPONSE)
 13846*                   END-EXEC
 13847*    MOVE '&(                    &  N#00012520' TO DFHEIV0
 13848     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13850     MOVE X'204E233030303132353230' TO DFHEIV0(25:11)
 13851     CALL 'kxdfhei1' USING DFHEIV0,
 13852           FILE-ID-ERPYAJ,
 13853           DFHEIV99,
 13854           DFHEIV99,
 13855           DFHEIV99,
 13856           DFHEIV99
 13857     MOVE EIBRESP  TO WS-RESPONSE
 13858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13859                 END-IF
 13860              ELSE
 13861                 SET REVERSAL    TO TRUE
 13862                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 252
* EL6311.cbl
 13863                                 THRU 1600-EXIT
 13864                 GO TO 1900-EXIT
 13865              END-IF
 13866           ELSE
 13867              GO TO 1900-READNEXT-ERPYAJ-B
 13868           END-IF
 13869        END-IF
 13870
 13871* EXEC CICS ENDBR
 13872*          DATASET   (FILE-ID-ERPYAJ)
 13873*       END-EXEC
 13874     MOVE 0
 13875       TO DFHEIV11
 13876*    MOVE '&2                    $   #00012535' TO DFHEIV0
 13877     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13878     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13879     MOVE X'2020233030303132353335' TO DFHEIV0(25:11)
 13880     CALL 'kxdfhei1' USING DFHEIV0,
 13881           FILE-ID-ERPYAJ,
 13882           DFHEIV11,
 13883           DFHEIV99
 13884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13885     END-IF
 13886     .
 13887 1900-GET-DEALER.
 13888     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13889     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13890     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13891     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13892     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13893     MOVE +10                    TO ERPYAJ-SEQ-NO
 13894     MOVE 'C'                    TO ERPYAJ-TYPE
 13895     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13896
 13897* EXEC CICS STARTBR
 13898*       DATASET    (FILE-ID-ERPYAJ)
 13899*       RIDFLD     (ERPYAJ-KEY)
 13900*       RESP       (WS-RESPONSE)
 13901*    END-EXEC
 13902     MOVE 0
 13903       TO DFHEIV11
 13904*    MOVE '&,         G          &  N#00012549' TO DFHEIV0
 13905     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13906     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13907     MOVE X'204E233030303132353439' TO DFHEIV0(25:11)
 13908     CALL 'kxdfhei1' USING DFHEIV0,
 13909           FILE-ID-ERPYAJ,
 13910           ERPYAJ-KEY,
 13911           DFHEIV99,
 13912           DFHEIV11,
 13913           DFHEIV99
 13914     MOVE EIBRESP  TO WS-RESPONSE
 13915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13916     IF RESP-NORMAL
 13917        CONTINUE
 13918     ELSE
 13919        GO TO 1900-EXIT
 13920     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 253
* EL6311.cbl
 13921     .
 13922 1900-READNEXT-ERPYAJ-D.
 13923*  GET THE DEALER ERPYAJ RECORD
 13924
 13925* EXEC CICS READNEXT
 13926*       DATASET    (FILE-ID-ERPYAJ)
 13927*       RIDFLD     (ERPYAJ-KEY)
 13928*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13929*       RESP       (WS-RESPONSE)
 13930*    END-EXEC
 13931     MOVE 0
 13932       TO DFHEIV11
 13933*    MOVE '&.S                   )  N#00012562' TO DFHEIV0
 13934     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13935     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13936     MOVE X'204E233030303132353632' TO DFHEIV0(25:11)
 13937     CALL 'kxdfhei1' USING DFHEIV0,
 13938           FILE-ID-ERPYAJ,
 13939           DFHEIV20,
 13940           DFHEIV99,
 13941           ERPYAJ-KEY,
 13942           DFHEIV99,
 13943           DFHEIV11,
 13944           DFHEIV99,
 13945           DFHEIV99
 13946     SET ADDRESS OF PENDING-PAY-ADJ TO
 13947         DFHEIV20
 13948     MOVE EIBRESP  TO WS-RESPONSE
 13949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13950     IF RESP-NORMAL
 13951        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13952           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13953              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13954                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13955
 13956* EXEC CICS READ
 13957*                   DATASET    (FILE-ID-ERPYAJ)
 13958*                   RIDFLD     (ERPYAJ-KEY)
 13959*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13960*                   RESP       (WS-RESPONSE)
 13961*                   UPDATE
 13962*                END-EXEC
 13963*    MOVE '&"S        EU         (  N#00012573' TO DFHEIV0
 13964     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13965     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13966     MOVE X'204E233030303132353733' TO DFHEIV0(25:11)
 13967     CALL 'kxdfhei1' USING DFHEIV0,
 13968           FILE-ID-ERPYAJ,
 13969           DFHEIV20,
 13970           DFHEIV99,
 13971           ERPYAJ-KEY,
 13972           DFHEIV99,
 13973           DFHEIV99,
 13974           DFHEIV99
 13975     SET ADDRESS OF PENDING-PAY-ADJ TO
 13976         DFHEIV20
 13977     MOVE EIBRESP  TO WS-RESPONSE
 13978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 254
* EL6311.cbl
 13979                 IF RESP-NORMAL
 13980
 13981* EXEC CICS DELETE
 13982*                      DATASET   (FILE-ID-ERPYAJ)
 13983*                      RESP      (WS-RESPONSE)
 13984*                   END-EXEC
 13985*    MOVE '&(                    &  N#00012581' TO DFHEIV0
 13986     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13988     MOVE X'204E233030303132353831' TO DFHEIV0(25:11)
 13989     CALL 'kxdfhei1' USING DFHEIV0,
 13990           FILE-ID-ERPYAJ,
 13991           DFHEIV99,
 13992           DFHEIV99,
 13993           DFHEIV99,
 13994           DFHEIV99
 13995     MOVE EIBRESP  TO WS-RESPONSE
 13996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13997                 END-IF
 13998              ELSE
 13999                 SET REVERSAL    TO TRUE
 14000              END-IF
 14001           ELSE
 14002              GO TO 1900-READNEXT-ERPYAJ-D
 14003           END-IF
 14004        END-IF
 14005
 14006* EXEC CICS ENDBR
 14007*          DATASET   (FILE-ID-ERPYAJ)
 14008*       END-EXEC
 14009     MOVE 0
 14010       TO DFHEIV11
 14011*    MOVE '&2                    $   #00012593' TO DFHEIV0
 14012     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14013     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14014     MOVE X'2020233030303132353933' TO DFHEIV0(25:11)
 14015     CALL 'kxdfhei1' USING DFHEIV0,
 14016           FILE-ID-ERPYAJ,
 14017           DFHEIV11,
 14018           DFHEIV99
 14019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14020     END-IF
 14021     .
 14022 1900-EXIT.
 14023     EXIT.
 14024******************************************************************
 14025*            C A N C E L   M A I N L I N E                       *
 14026******************************************************************
 14027
 14028 2000-CANCEL-MAINLINE.
 14029     IF PI-DISPLAY-ORIGINAL-BATCH
 14030        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14031           MOVE ER-0023             TO EMI-ERROR
 14032           MOVE -1                  TO CMAINTL
 14033           MOVE AL-UABON            TO CMAINTA
 14034           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035           GO TO 8200-SEND-DATAONLY
 14036        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 255
* EL6311.cbl
 14037           NEXT SENTENCE
 14038     ELSE
 14039        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14040           MOVE ER-0023             TO EMI-ERROR
 14041           MOVE -1                  TO CMAINTL
 14042           MOVE AL-UABON            TO CMAINTA
 14043           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14044           GO TO 8200-SEND-DATAONLY.
 14045
 14046     IF CMAINTI = 'S'
 14047        GO TO 2100-SHOW-REQUEST.
 14048
 14049     IF NOT MODIFY-CAP
 14050         MOVE 'UPDATE'       TO SM-READ
 14051         PERFORM 9995-SECURITY-VIOLATION
 14052         MOVE ER-0070        TO EMI-ERROR
 14053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14054         GO TO 8100-SEND-INITIAL-MAP.
 14055
 14056     IF CMAINTL GREATER THAN ZEROS
 14057        IF PI-PF6-FUNCTION
 14058           IF CMAINTI NOT = 'A'
 14059              MOVE AL-UABON  TO CMAINTA
 14060              MOVE -1        TO CMAINTL
 14061              MOVE ER-2260   TO EMI-ERROR
 14062              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14063              GO TO 8200-SEND-DATAONLY.
 14064
 14065     IF CCERTNOL = ZEROS
 14066       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14067         NEXT SENTENCE
 14068     ELSE
 14069         IF CCERTNOL NOT = ZEROS
 14070             MOVE AL-UANON       TO CCERTNOA
 14071         ELSE
 14072             MOVE -1             TO CCERTNOL
 14073             MOVE  1             TO SET-CURSOR-SW
 14074             MOVE ER-2218       TO EMI-ERROR
 14075             MOVE AL-UABON       TO CCERTNOA
 14076             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14077
 14078     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14079        NEXT SENTENCE
 14080     ELSE
 14081        IF CEFFDTL NOT = ZEROS
 14082           MOVE AL-UNNON         TO CEFFDTA
 14083           MOVE CEFFDTI TO DEEDIT-FIELD
 14084           PERFORM 8600-DEEDIT
 14085           MOVE 4                TO DC-OPTION-CODE
 14086           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14087           PERFORM 9700-DATE-LINK
 14088           IF NO-CONVERSION-ERROR
 14089              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14090              ELSE
 14091              MOVE -1            TO CEFFDTL
 14092              MOVE  1            TO SET-CURSOR-SW
 14093              MOVE ER-2226      TO EMI-ERROR
 14094              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 256
* EL6311.cbl
 14095              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14096          ELSE
 14097          MOVE -1                 TO CEFFDTL
 14098          MOVE  1                 TO SET-CURSOR-SW
 14099          MOVE ER-2220            TO EMI-ERROR
 14100          MOVE AL-UNBON           TO CEFFDTA
 14101          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14102
 14103     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14104
 14105     IF CCERTNOL NOT = ZEROS
 14106        MOVE CCERTNOI                TO WS-NEW-PRIME
 14107     ELSE
 14108        MOVE SPACES                  TO WS-NEW-PRIME.
 14109
 14110     IF CSUFIXL NOT = ZEROS
 14111        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14112     ELSE
 14113        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14114
 14115     IF CEFFDTL NOT = ZEROS
 14116        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14117     ELSE
 14118        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14119
 14120     IF CMAINTI = 'A' OR 'K' OR 'S'
 14121        NEXT SENTENCE
 14122     ELSE
 14123        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14124        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14125           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14126           WS-PB-RECORD-TYPE NOT = '2'
 14127           IF CMAINTI = 'C'
 14128              MOVE ER-2287          TO EMI-ERROR
 14129              MOVE -1               TO CCERTNOL
 14130              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14131              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14132              GO TO 8200-SEND-DATAONLY
 14133             ELSE
 14134              MOVE ER-2260          TO EMI-ERROR
 14135              MOVE -1               TO CCERTNOL
 14136              MOVE AL-UABON         TO CCERTNOA
 14137              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14138              GO TO 8200-SEND-DATAONLY.
 14139
 14140     IF CMAINTI = 'D'
 14141        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14142
 14143     IF CLSTNML GREATER THAN ZEROS
 14144         MOVE AL-UANON           TO CLSTNMA.
 14145
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 257
* EL6311.cbl
 14147
 14148******************************************************************
 14149*                                                                *
 14150*           E D I T   C A N C E L   C O V E R A G E S            *
 14151*                                                                *
 14152******************************************************************
 14153
 14154 2015-EDIT-COVERAGES.
 14155     IF CCANDT1L      GREATER THAN ZEROS OR
 14156        CREFND1L      GREATER THAN ZEROS OR
 14157        CCANDT2L      GREATER THAN ZEROS OR
 14158        CREFND2L      GREATER THAN ZEROS OR
 14159        CMTHD1L       GREATER THAN ZEROS OR
 14160        CMTHD2L       GREATER THAN ZEROS OR
 14161        CLIVESL       GREATER THAN ZEROS OR
 14162        CPAYEEL       GREATER THAN ZEROS OR
 14163        CFORCEL       GREATER THAN ZEROS OR
 14164        CBILCDL       GREATER THAN ZEROS OR
 14165        CCANREAL      GREATER THAN ZEROS
 14166            NEXT SENTENCE
 14167         ELSE
 14168            GO TO 2030-EDIT-COMPLETE.
 14169
 14170     IF CCANDT1L = ZEROS
 14171        AND (CMAINTI = 'C' OR 'K')
 14172        NEXT SENTENCE
 14173     ELSE
 14174        IF CCANDT1L      GREATER THAN ZEROS
 14175            MOVE AL-UNNON            TO CCANDT1A
 14176            IF CCANDT1I = SPACES
 14177               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14178            ELSE
 14179               MOVE CCANDT1I            TO DEEDIT-FIELD
 14180               PERFORM 8600-DEEDIT
 14181               IF DEEDIT-FIELD-V0   NUMERIC
 14182                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14183                  MOVE 4                TO DC-OPTION-CODE
 14184                  PERFORM 9700-DATE-LINK
 14185                  IF NO-CONVERSION-ERROR
 14186                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14187                  ELSE
 14188                      MOVE -1        TO CCANDT1L
 14189                      MOVE ER-2227   TO EMI-ERROR
 14190                      MOVE AL-UNBON  TO CCANDT1A
 14191                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14192               ELSE
 14193                  MOVE -1         TO CCANDT1L
 14194                  MOVE ER-2223    TO EMI-ERROR
 14195                  MOVE AL-UNBON   TO CCANDT1A
 14196                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14197        ELSE
 14198            IF CREFND1L GREATER THAN ZEROS
 14199               MOVE -1             TO CCANDT1L
 14200               MOVE ER-2222        TO EMI-ERROR
 14201               MOVE AL-UNBOF       TO CCANDT1A
 14202               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14203
 14204     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 258
* EL6311.cbl
 14205        AND (CMAINTI = 'C' OR 'K')
 14206         NEXT SENTENCE
 14207     ELSE
 14208         IF CREFND1L NOT = ZEROS
 14209            MOVE AL-UNNON        TO CREFND1A
 14210
 14211* EXEC CICS BIF DEEDIT
 14212*               FIELD  (CREFND1I)
 14213*               LENGTH (11)
 14214*           END-EXEC
 14215     MOVE 11
 14216       TO DFHEIV11
 14217*    MOVE '@"L                   #   #00012786' TO DFHEIV0
 14218     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14219     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14220     MOVE X'2020233030303132373836' TO DFHEIV0(25:11)
 14221     CALL 'kxdfhei1' USING DFHEIV0,
 14222           CREFND1I,
 14223           DFHEIV11
 14224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14225            MOVE CREFND1I        TO WS-CREFND1
 14226*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14227*           PERFORM 8600-DEEDIT
 14228*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14229            IF WS-CREFND1  = ZEROS
 14230               AND CMAINTI = 'A'
 14231             MOVE ER-2437        TO EMI-ERROR
 14232             MOVE -1             TO CREFND1L
 14233             MOVE AL-UNBON       TO CREFND1A
 14234             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14235
 14236     IF CCANREAL > +0
 14237        MOVE AL-UANON            TO CCANREAA
 14238        IF CCANREAI = 'R' OR ' '
 14239           CONTINUE
 14240        ELSE
 14241           MOVE ER-9841        TO EMI-ERROR
 14242           MOVE -1             TO CCANREAL
 14243           MOVE AL-UABON       TO CCANREAA
 14244           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14245        END-IF
 14246     END-IF
 14247     IF CMTHD1L EQUAL +0
 14248        NEXT SENTENCE
 14249     ELSE
 14250        IF CMTHD1L NOT = +0
 14251           MOVE AL-UNNON        TO CMTHD1A
 14252           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14253                         OR '5' OR '6' OR '8' OR '9'
 14254                         OR 'R' OR ' '
 14255              NEXT SENTENCE
 14256           ELSE
 14257              MOVE ER-0582        TO EMI-ERROR
 14258              MOVE -1             TO CMTHD1L
 14259              MOVE AL-UNBON       TO CMTHD1A
 14260              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14261
 14262     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 259
* EL6311.cbl
 14263        AND (CMAINTI = 'C' OR 'K')
 14264         NEXT SENTENCE
 14265     ELSE
 14266         IF CCANDT2L  GREATER THAN ZEROS
 14267             MOVE AL-UNNON       TO CCANDT2A
 14268             IF CCANDT2I = SPACES
 14269                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14270             ELSE
 14271                MOVE CCANDT2I       TO DEEDIT-FIELD
 14272                PERFORM 8600-DEEDIT
 14273                IF DEEDIT-FIELD-V0   NUMERIC
 14274                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14275                   MOVE 4                TO DC-OPTION-CODE
 14276                   PERFORM 9700-DATE-LINK
 14277                   IF NO-CONVERSION-ERROR
 14278                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14279                   ELSE
 14280                      MOVE -1       TO CCANDT2L
 14281                      MOVE ER-2227  TO EMI-ERROR
 14282                      MOVE AL-UNBON TO CCANDT2A
 14283                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14284                ELSE
 14285                   MOVE -1         TO CCANDT2L
 14286                   MOVE ER-2223    TO EMI-ERROR
 14287                   MOVE AL-UNBON   TO CCANDT2A
 14288                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14289         ELSE
 14290            IF CREFND2L GREATER THAN ZEROS
 14291               MOVE -1             TO CCANDT2L
 14292               MOVE ER-2222        TO EMI-ERROR
 14293               MOVE AL-UNBOF       TO CCANDT2A
 14294               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14295
 14296     IF CREFND2L = ZEROS
 14297        AND (CMAINTI = 'C' OR 'K')
 14298         NEXT SENTENCE
 14299     ELSE
 14300         IF CREFND2L NOT = ZEROS
 14301            MOVE AL-UNNON        TO CREFND2A
 14302
 14303* EXEC CICS BIF DEEDIT
 14304*               FIELD  (CREFND2I)
 14305*               LENGTH (11)
 14306*           END-EXEC
 14307     MOVE 11
 14308       TO DFHEIV11
 14309*    MOVE '@"L                   #   #00012867' TO DFHEIV0
 14310     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14311     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14312     MOVE X'2020233030303132383637' TO DFHEIV0(25:11)
 14313     CALL 'kxdfhei1' USING DFHEIV0,
 14314           CREFND2I,
 14315           DFHEIV11
 14316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14317            MOVE CREFND2I        TO WS-CREFND2
 14318*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14319*           PERFORM 8600-DEEDIT
 14320*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 260
* EL6311.cbl
 14321            IF WS-CREFND2  = ZEROS
 14322               AND CMAINTI = 'A'
 14323             MOVE ER-2437        TO EMI-ERROR
 14324             MOVE -1             TO CREFND2L
 14325             MOVE AL-UNBON       TO CREFND2A
 14326             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14327
 14328     IF CMTHD2L EQUAL +0
 14329        NEXT SENTENCE
 14330     ELSE
 14331        IF CMTHD2L NOT = +0
 14332           MOVE AL-UNNON        TO CMTHD2A
 14333           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14334                         OR '5' OR '6' OR '8' OR '9'
 14335                         OR ' ' OR 'R'
 14336              NEXT SENTENCE
 14337           ELSE
 14338              MOVE ER-0582        TO EMI-ERROR
 14339              MOVE -1             TO CMTHD2L
 14340              MOVE AL-UNBON       TO CMTHD2A
 14341              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14342
 14343     IF CLIVESL GREATER THAN ZEROS
 14344         MOVE CLIVESI            TO DEEDIT-FIELD
 14345         PERFORM 8600-DEEDIT
 14346         IF DEEDIT-FIELD-V0 NUMERIC
 14347             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14348             MOVE AL-UNNON       TO CLIVESA
 14349         ELSE
 14350             MOVE -1             TO CLIVESL
 14351             MOVE AL-UNBON       TO CLIVESA
 14352             MOVE ER-2223        TO EMI-ERROR
 14353             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14354
 14355     IF CFORCEL  NOT = ZEROS
 14356         IF FORCE-CAP
 14357            MOVE AL-UANON            TO CFORCEA
 14358         ELSE
 14359            MOVE ER-2945             TO EMI-ERROR
 14360            MOVE AL-UABON            TO CFORCEA
 14361            MOVE -1                  TO CFORCEL
 14362            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14363
 14364     IF CPAYEEL GREATER THAN ZEROS
 14365        MOVE AL-UANON            TO CPAYEEA.
 14366
 14367     IF CBILCDL NOT = ZEROS
 14368        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14369                             AND 'A' AND 'B' AND 'E'
 14370           MOVE ER-2225              TO EMI-ERROR
 14371           MOVE AL-UABON             TO CBILCDA
 14372           MOVE -1                   TO CBILCDL
 14373           MOVE  1                   TO SET-CURSOR-SW
 14374           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14375        ELSE
 14376           MOVE AL-UANON             TO CBILCDA.
 14377
 14378 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 261
* EL6311.cbl
 14379     IF EMI-ERROR = ZEROS
 14380         NEXT SENTENCE
 14381     ELSE
 14382         GO TO 8200-SEND-DATAONLY.
 14383
 14384     IF CMAINTI = 'A'
 14385        GO TO 2200-ADD-CANCEL-ROUTINE.
 14386
 14387     IF CMAINTI = 'C'
 14388        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14389
 14390     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14391
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 262
* EL6311.cbl
 14393
 14394******************************************************************
 14395*                                                                *
 14396*                   S H O W   C A N C E L                        *
 14397*                                                                *
 14398******************************************************************
 14399
 14400 2100-SHOW-REQUEST.
 14401     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14402
 14403     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14404        MOVE -1                  TO CMAINTL
 14405        GO TO 8200-SEND-DATAONLY.
 14406
 14407     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14408
 14409     IF CSUFIXL NOT = ZEROS
 14410        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14411       ELSE
 14412        MOVE SPACE            TO WS-NEW-SUFFIX.
 14413
 14414     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14415     PERFORM 8600-DEEDIT.
 14416     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14417     MOVE '4'                    TO DC-OPTION-CODE.
 14418     PERFORM 9700-DATE-LINK.
 14419     IF DATE-CONVERSION-ERROR
 14420        MOVE ER-0348             TO EMI-ERROR
 14421        MOVE -1                  TO CEFFDTL
 14422        MOVE AL-UABON            TO CEFFDTA
 14423        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14424        GO TO 8200-SEND-DATAONLY
 14425     ELSE
 14426        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14427        MOVE AL-UANON            TO CEFFDTA
 14428        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14429
 14430     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14431
 14432     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14433        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14434        MOVE 'Y'                    TO WS-SHOW-SW
 14435        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14436           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14437        ELSE
 14438           IF PI-FILE-BROWSE
 14439              GO TO 4300-BROWSE-FILE-FORWARD
 14440           ELSE
 14441              IF PI-CSR-BROWSE
 14442                 GO TO 4200-BROWSE-CSR-FORWARD
 14443              ELSE
 14444                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14445     ELSE
 14446        GO TO 3900-RE-DISPLAY-RECORD.
 14447
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 263
* EL6311.cbl
 14449
 14450
 14451******************************************************************
 14452*                                                                *
 14453*            A D D   C A N C E L   R O U T I N E                 *
 14454*                                                                *
 14455******************************************************************
 14456
 14457 2200-ADD-CANCEL-ROUTINE.
 14458     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14459
 14460
 14461* EXEC CICS GETMAIN
 14462*        SET     (ADDRESS OF PENDING-BUSINESS)
 14463*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14464*    END-EXEC.
 14465*    MOVE '," L                  $   #00013014' TO DFHEIV0
 14466     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14467     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14468     MOVE X'2020233030303133303134' TO DFHEIV0(25:11)
 14469     CALL 'kxdfhei1' USING DFHEIV0,
 14470           DFHEIV20,
 14471           ERPNDB-RECORD-LENGTH,
 14472           DFHEIV99
 14473     SET ADDRESS OF PENDING-BUSINESS TO
 14474         DFHEIV20
 14475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14476
 14477
 14478
 14479* EXEC CICS HANDLE CONDITION
 14480*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14481*    END-EXEC.
 14482*    MOVE '"$I                   ! 3 #00013019' TO DFHEIV0
 14483     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14485     MOVE X'3320233030303133303139' TO DFHEIV0(25:11)
 14486     CALL 'kxdfhei1' USING DFHEIV0
 14487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14488
 14489
 14490     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14491     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14492     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14493
 14494
 14495* EXEC CICS READ
 14496*        INTO    (PENDING-BUSINESS)
 14497*        DATASET (FILE-ID-ERPNDB)
 14498*        RIDFLD  (ERPNDB-KEY)
 14499*    END-EXEC.
 14500     MOVE LENGTH OF
 14501      PENDING-BUSINESS
 14502       TO DFHEIV11
 14503*    MOVE '&"IL       E          (   #00013027' TO DFHEIV0
 14504     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14506     MOVE X'2020233030303133303237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 264
* EL6311.cbl
 14507     CALL 'kxdfhei1' USING DFHEIV0,
 14508           FILE-ID-ERPNDB,
 14509           PENDING-BUSINESS,
 14510           DFHEIV11,
 14511           ERPNDB-KEY,
 14512           DFHEIV99,
 14513           DFHEIV99,
 14514           DFHEIV99
 14515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14516
 14517
 14518     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14519
 14520     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14521     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14522     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14523     MOVE SPACES                 TO PENDING-BUSINESS.
 14524     MOVE 'PB'                   TO PB-RECORD-ID.
 14525     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14526     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14527     MOVE SPACES                 TO PB-CERT-SFX.
 14528     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14529     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14530                                    PB-ALT-CHG-SEQ-NO.
 14531
 14532     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14533     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14534     MOVE '2'                    TO PB-RECORD-TYPE.
 14535
 14536     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14537     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14538
 14539
 14540     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14541                                    PB-ALT-CHG-SEQ-NO
 14542                                    PB-C-LF-REF-CALC
 14543                                    PB-C-AH-REF-CALC
 14544                                    PB-C-LF-RFND-CLP
 14545                                    PB-C-AH-RFND-CLP
 14546                                    PB-CI-INSURED-AGE
 14547                                    PB-CI-LF-TERM
 14548                                    PB-CI-AH-TERM
 14549                                    PB-CI-LF-BENEFIT-CD
 14550                                    PB-CI-LF-BENEFIT-AMT
 14551                                    PB-CI-LF-ALT-BENEFIT-AMT
 14552                                    PB-CI-LF-PREMIUM-AMT
 14553                                    PB-CI-LF-ALT-PREMIUM-AMT
 14554                                    PB-CI-AH-BENEFIT-CD
 14555                                    PB-CI-AH-BENEFIT-AMT
 14556                                    PB-CI-AH-PREMIUM-AMT
 14557                                    PB-CI-PAY-FREQUENCY
 14558                                    PB-CI-LOAN-APR
 14559                                    PB-CI-LOAN-TERM
 14560                                    PB-CI-LIFE-COMMISSION
 14561                                    PB-CI-AH-COMMISSION
 14562                                    PB-CI-CURR-SEQ
 14563                                    PB-CI-AH-CANCEL-AMT
 14564                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 265
* EL6311.cbl
 14565                                    PB-CI-RATE-DEV-PCT-LF
 14566                                    PB-CI-RATE-DEV-PCT-AH
 14567                                    PB-CI-EXTENTION-DAYS
 14568                                    PB-CI-TERM-IN-DAYS
 14569                                    PB-CI-LIVES
 14570                                    PB-CI-LF-CRIT-PER
 14571                                    PB-CI-AH-CRIT-PER
 14572                                    PB-C-LF-REM-TERM
 14573                                    PB-C-AH-REM-TERM
 14574                                    PB-CHG-COUNT
 14575                                    PB-LF-BILLED-AMTS
 14576                                    PB-AH-BILLED-AMTS
 14577                                    PB-C-NH-INT-ON-REFS
 14578*                                   PB-C-MICROFILM-NO
 14579                                    PB-CALC-TOLERANCE.
 14580
 14581     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14582                                    PB-CI-AH-SETTLEMENT-DT
 14583                                    PB-CI-DEATH-DT
 14584                                    PB-CI-LF-PRIOR-CANCEL-DT
 14585                                    PB-CI-AH-PRIOR-CANCEL-DT
 14586                                    PB-CI-ENTRY-DT
 14587                                    PB-CI-LF-EXPIRE-DT
 14588                                    PB-CI-AH-EXPIRE-DT
 14589                                    PB-CI-LOAN-1ST-PMT-DT
 14590                                    PB-C-LF-CANCEL-DT
 14591                                    PB-C-AH-CANCEL-DT
 14592                                    PB-CREDIT-ACCEPT-DT
 14593                                    PB-BILLED-DT
 14594                                    PB-ACCT-EFF-DT
 14595                                    PB-ACCT-EXP-DT.
 14596
 14597     MOVE 'X'                    TO PB-FATAL-FLAG.
 14598
 14599     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14600
 14601     IF CSUFIXL     GREATER THAN ZEROS
 14602        MOVE CSUFIXI             TO PB-CERT-SFX.
 14603
 14604*    IF CMICRNOL  GREATER  ZEROS
 14605*        IF CMICRNOI  NUMERIC
 14606*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14607*            MOVE AL-UNNON       TO  CMICRNOA
 14608*        ELSE
 14609*            MOVE -1             TO  CMICRNOL
 14610*            MOVE AL-UNBON       TO  CMICRNOA
 14611*            MOVE ER-2701        TO  EMI-ERROR
 14612*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14613
 14614     IF CLSTNML     GREATER THAN ZEROS
 14615        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14616
 14617     IF CCANREAL > ZEROS
 14618        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14619     END-IF
 14620     IF CPCYNL > ZEROS
 14621        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14622     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 266
* EL6311.cbl
 14623     IF CCANDT1L    GREATER THAN ZEROS
 14624        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14625
 14626     IF CCANDT2L    GREATER THAN ZEROS
 14627        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14628
 14629     IF CMTHD1L    GREATER THAN +0
 14630        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14631
 14632     IF CMTHD2L    GREATER THAN +0
 14633        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14634
 14635     IF CREFND1L    GREATER THAN ZEROS
 14636        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14637        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14638     ELSE
 14639        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14640
 14641     IF CREFND2L    GREATER THAN ZEROS
 14642        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14643        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14644     ELSE
 14645        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14646
 14647     IF CLIVESL     GREATER THAN ZEROS
 14648        MOVE WS-CLIVES           TO PB-C-LIVES
 14649     ELSE
 14650        MOVE ZEROS               TO PB-C-LIVES.
 14651
 14652     IF CPAYEEL     GREATER THAN ZEROS
 14653        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14654
 14655     IF CFORCEL     GREATER THAN ZEROS
 14656        MOVE CFORCEI             TO PB-FORCE-CODE.
 14657
 14658     IF CBILCDL     GREATER THAN ZEROS
 14659        MOVE CBILCDI             TO PB-RECORD-BILL.
 14660
 14661*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14662
 14663 2260-WRITE-PB-RECORD.
 14664     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14665                                    PB-INPUT-BY.
 14666     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14667     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14668                                    PB-INPUT-DT.
 14669
 14670     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14671     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14672                                    PB-CONTROL-BY-ORIG-BATCH.
 14673
 14674     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14675     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14676     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14677     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14678     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14679
 14680     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 267
* EL6311.cbl
 14681
 14682     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14683
 14684     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14685     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14686     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14687
 14688     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14689     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14690
 14691 2275-WRITE-PENDING-BUSINESS.
 14692     MOVE 'A'                    TO JP-RECORD-TYPE.
 14693     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14694     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14695     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14696
 14697
 14698* EXEC CICS HANDLE CONDITION
 14699*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14700*    END-EXEC.
 14701*    MOVE '"$%                   ! 4 #00013212' TO DFHEIV0
 14702     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14704     MOVE X'3420233030303133323132' TO DFHEIV0(25:11)
 14705     CALL 'kxdfhei1' USING DFHEIV0
 14706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14707
 14708
 14709
 14710* EXEC CICS WRITE
 14711*        DATASET (FILE-ID-ERPNDB)
 14712*        FROM    (PENDING-BUSINESS)
 14713*        RIDFLD  (PB-CONTROL-PRIMARY)
 14714*    END-EXEC.
 14715     MOVE LENGTH OF
 14716      PENDING-BUSINESS
 14717       TO DFHEIV11
 14718*    MOVE '&$ L                  ''   #00013216' TO DFHEIV0
 14719     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14721     MOVE X'2020233030303133323136' TO DFHEIV0(25:11)
 14722     CALL 'kxdfhei1' USING DFHEIV0,
 14723           FILE-ID-ERPNDB,
 14724           PENDING-BUSINESS,
 14725           DFHEIV11,
 14726           PB-CONTROL-PRIMARY,
 14727           DFHEIV99,
 14728           DFHEIV99
 14729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14730
 14731
 14732     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14733
 14734     PERFORM 8400-LOG-JOURNAL-RECORD.
 14735
 14736******************************************************************
 14737*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14738******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 268
* EL6311.cbl
 14739
 14740     display ' made it to add orig CANCEL cert '
 14741     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14742     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14743     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14744     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14745
 14746
 14747* EXEC CICS READ
 14748*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14749*        DATASET (FILE-ID-ELCERT)
 14750*        RIDFLD  (ELCERT-KEY)
 14751*        RESP    (WS-RESPONSE)
 14752*    END-EXEC.
 14753*    MOVE '&"S        E          (  N#00013236' TO DFHEIV0
 14754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14756     MOVE X'204E233030303133323336' TO DFHEIV0(25:11)
 14757     CALL 'kxdfhei1' USING DFHEIV0,
 14758           FILE-ID-ELCERT,
 14759           DFHEIV20,
 14760           DFHEIV99,
 14761           ELCERT-KEY,
 14762           DFHEIV99,
 14763           DFHEIV99,
 14764           DFHEIV99
 14765     SET ADDRESS OF CERTIFICATE-MASTER TO
 14766         DFHEIV20
 14767     MOVE EIBRESP  TO WS-RESPONSE
 14768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14769
 14770
 14771     IF NOT RESP-NORMAL
 14772        GO TO 2276-BYPASS-CRTO
 14773     END-IF
 14774
 14775     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14776     MOVE ' '                    TO WS-ERMAIL-SW
 14777
 14778
 14779* EXEC CICS READ
 14780*       DATASET   (FILE-ID-ERMAIL)
 14781*       SET       (ADDRESS OF MAILING-DATA)
 14782*       RIDFLD    (ERMAIL-KEY)
 14783*       RESP      (WS-RESPONSE)
 14784*    END-EXEC
 14785*    MOVE '&"S        E          (  N#00013250' TO DFHEIV0
 14786     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14787     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14788     MOVE X'204E233030303133323530' TO DFHEIV0(25:11)
 14789     CALL 'kxdfhei1' USING DFHEIV0,
 14790           FILE-ID-ERMAIL,
 14791           DFHEIV20,
 14792           DFHEIV99,
 14793           ERMAIL-KEY,
 14794           DFHEIV99,
 14795           DFHEIV99,
 14796           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 269
* EL6311.cbl
 14797     SET ADDRESS OF MAILING-DATA TO
 14798         DFHEIV20
 14799     MOVE EIBRESP  TO WS-RESPONSE
 14800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14801
 14802     IF RESP-NORMAL
 14803        SET ERMAIL-FOUND TO TRUE
 14804     END-IF
 14805
 14806     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14807
 14808     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14809     MOVE 'OC'                   TO OC-RECORD-ID
 14810     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14811                                 TO OC-CONTROL-PRIMARY (1:33)
 14812     MOVE 'I'                    TO OC-RECORD-TYPE
 14813     MOVE +4096                  TO OC-KEY-SEQ-NO
 14814     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14815     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14816     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14817
 14818     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14819     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14820     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14821     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14822     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14823     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14824     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14825     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14826     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14827     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14828     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14829     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14830     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14831     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14832     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14833     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14834     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14835     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14836     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14837     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14838     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14839     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14840     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14841     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14842     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14843     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14844     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14845     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14846     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14847     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14848     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14849     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14850
 14851     IF ERMAIL-FOUND
 14852        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14853     END-IF
 14854     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 270
* EL6311.cbl
 14855        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14856                           OC-INS-AGE-DEFAULT-FLAG
 14857        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14858                           OC-JNT-AGE-DEFAULT-FLAG
 14859     END-IF
 14860     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14861     .
 14862 2275-WRITE-ELCRTO.
 14863
 14864
 14865* EXEC CICS WRITE
 14866*       DATASET   ('ELCRTO')
 14867*       FROM      (ORIGINAL-CERTIFICATE)
 14868*       RIDFLD    (OC-CONTROL-PRIMARY)
 14869*       RESP      (WS-RESPONSE)
 14870*    END-EXEC
 14871     MOVE LENGTH OF
 14872      ORIGINAL-CERTIFICATE
 14873       TO DFHEIV11
 14874     MOVE 'ELCRTO' TO DFHEIV1
 14875*    MOVE '&$ L                  ''  N#00013319' TO DFHEIV0
 14876     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14877     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14878     MOVE X'204E233030303133333139' TO DFHEIV0(25:11)
 14879     CALL 'kxdfhei1' USING DFHEIV0,
 14880           DFHEIV1,
 14881           ORIGINAL-CERTIFICATE,
 14882           DFHEIV11,
 14883           OC-CONTROL-PRIMARY,
 14884           DFHEIV99,
 14885           DFHEIV99
 14886     MOVE EIBRESP  TO WS-RESPONSE
 14887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14888
 14889     display ' just wrote 2275 ' ws-response
 14890     IF RESP-DUPKEY
 14891        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14892        GO TO 2275-WRITE-ELCRTO
 14893     ELSE
 14894        IF NOT RESP-NORMAL
 14895           MOVE -1               TO BMAINTL
 14896           MOVE ER-7450          TO EMI-ERROR
 14897           PERFORM 9900-ERROR-FORMAT
 14898                                 THRU 9900-EXIT
 14899           GO TO 8200-SEND-DATAONLY
 14900        END-IF
 14901     END-IF.
 14902
 14903 2276-BYPASS-CRTO.
 14904******************************************************************
 14905*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14906******************************************************************
 14907
 14908
 14909* EXEC CICS READ
 14910*        INTO    (PENDING-BUSINESS)
 14911*        DATASET (FILE-ID-ERPNDB)
 14912*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 271
* EL6311.cbl
 14913*        UPDATE
 14914*    END-EXEC.
 14915     MOVE LENGTH OF
 14916      PENDING-BUSINESS
 14917       TO DFHEIV11
 14918*    MOVE '&"IL       EU         (   #00013345' TO DFHEIV0
 14919     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14920     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14921     MOVE X'2020233030303133333435' TO DFHEIV0(25:11)
 14922     CALL 'kxdfhei1' USING DFHEIV0,
 14923           FILE-ID-ERPNDB,
 14924           PENDING-BUSINESS,
 14925           DFHEIV11,
 14926           ERPNDB-KEY,
 14927           DFHEIV99,
 14928           DFHEIV99,
 14929           DFHEIV99
 14930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14931
 14932
 14933     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14934     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14935     MOVE 'B'                    TO JP-RECORD-TYPE.
 14936     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14937
 14938     PERFORM 8400-LOG-JOURNAL-RECORD.
 14939
 14940     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14941
 14942
 14943* EXEC CICS REWRITE
 14944*        DATASET (FILE-ID-ERPNDB)
 14945*        FROM    (PENDING-BUSINESS)
 14946*    END-EXEC.
 14947     MOVE LENGTH OF
 14948      PENDING-BUSINESS
 14949       TO DFHEIV11
 14950*    MOVE '&& L                  %   #00013361' TO DFHEIV0
 14951     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14952     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14953     MOVE X'2020233030303133333631' TO DFHEIV0(25:11)
 14954     CALL 'kxdfhei1' USING DFHEIV0,
 14955           FILE-ID-ERPNDB,
 14956           PENDING-BUSINESS,
 14957           DFHEIV11,
 14958           DFHEIV99
 14959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14960
 14961
 14962     MOVE 'C'                    TO JP-RECORD-TYPE.
 14963     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14964
 14965     PERFORM 8400-LOG-JOURNAL-RECORD.
 14966
 14967     IF WS-ERRORS-PRESENT
 14968        GO TO 3900-RE-DISPLAY-RECORD.
 14969
 14970     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 272
* EL6311.cbl
 14971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14972     MOVE LOW-VALUES             TO EL631CI.
 14973     MOVE  -1                    TO CMAINTL.
 14974     GO TO 8100-SEND-INITIAL-MAP.
 14975
 14976 2280-BATCH-HDR-NOT-FOUND.
 14977     MOVE -1                     TO BMAINTL.
 14978     MOVE ER-7450                TO EMI-ERROR.
 14979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14980     GO TO 8200-SEND-DATAONLY.
 14981
 14982 2290-DUPLICATE-ALT-INDEX.
 14983
 14984******************************************************************
 14985*                                                                *
 14986*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14987*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14988*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14989*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14990*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14991*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14992*                                                                *
 14993******************************************************************
 14994
 14995     IF LCP-ONCTR-02 =  0
 14996         ADD 1 TO LCP-ONCTR-02
 14997        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14998
 14999     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15000
 15001     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15002         NEXT SENTENCE
 15003     ELSE
 15004         ADD +1 TO PB-BATCH-SEQ-NO
 15005                   PB-CSR-BATCH-SEQ-NO
 15006         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15007         GO TO 2275-WRITE-PENDING-BUSINESS.
 15008
 15009     MOVE -1                     TO CCERTNOL.
 15010     MOVE AL-UABON               TO CCERTNOA.
 15011     MOVE AL-UNBON               TO CEFFDTA.
 15012
 15013     MOVE 1                      TO EMI-SUB
 15014                                    EMI-SWITCH1
 15015                                    EMI-SWITCH-AREA-1
 15016                                    EMI-SWITCH-AREA-2.
 15017
 15018     MOVE SPACES                 TO EMI-ERROR-LINES.
 15019
 15020
 15021* EXEC CICS SYNCPOINT ROLLBACK
 15022*    END-EXEC.
 15023*    MOVE '6"R                   !   #00013424' TO DFHEIV0
 15024     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15026     MOVE X'2020233030303133343234' TO DFHEIV0(25:11)
 15027     CALL 'kxdfhei1' USING DFHEIV0
 15028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 273
* EL6311.cbl
 15029
 15030
 15031     MOVE ER-2247                TO EMI-ERROR.
 15032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15033     GO TO 8200-SEND-DATAONLY.
 15034
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 274
* EL6311.cbl
 15036
 15037******************************************************************
 15038*                                                                *
 15039*          C H A N G E   C A N C E L   R O U T I N E             *
 15040*                                                                *
 15041******************************************************************
 15042
 15043***************************************************************
 15044*                                                             *
 15045*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15046*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15047*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15048*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15049*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15050*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15051*     5. LINK TO THE EDIT ROUTINE.                            *
 15052*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15053*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15054*              THE EDIT ROUTINE.                              *
 15055*     7. REWRITE THE NEW ISSUE                                *
 15056*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15057*                                                             *
 15058***************************************************************
 15059 2300-CHANGE-CANCEL-ROUTINE.
 15060     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15061
 15062     IF CCHGL NOT = ZEROS
 15063        MOVE ER-2196             TO EMI-ERROR
 15064        MOVE AL-UABON            TO CMAINTA
 15065        MOVE -1                  TO CMAINTL
 15066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15067        GO TO 8200-SEND-DATAONLY.
 15068
 15069     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15070
 15071     IF CSUFIXL NOT = ZEROS
 15072        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15073     ELSE
 15074        MOVE SPACE               TO WS-NEW-SUFFIX.
 15075
 15076     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15077     PERFORM 8600-DEEDIT.
 15078     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15079     MOVE '4'                    TO DC-OPTION-CODE.
 15080
 15081     PERFORM 9700-DATE-LINK.
 15082
 15083     IF DATE-CONVERSION-ERROR
 15084        MOVE ER-0348             TO EMI-ERROR
 15085        MOVE -1                  TO CEFFDTL
 15086        MOVE AL-UABON            TO CEFFDTA
 15087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15088        GO TO 8200-SEND-DATAONLY
 15089     ELSE
 15090        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15091        MOVE AL-UANON            TO CEFFDTA
 15092        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15093
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 275
* EL6311.cbl
 15094 2325-PROCESS-CANCEL-CHANGES.
 15095
 15096* EXEC CICS HANDLE CONDITION
 15097*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15098*    END-EXEC.
 15099*    MOVE '"$I                   ! 5 #00013491' TO DFHEIV0
 15100     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15102     MOVE X'3520233030303133343931' TO DFHEIV0(25:11)
 15103     CALL 'kxdfhei1' USING DFHEIV0
 15104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15105
 15106
 15107     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15108     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15109     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15110
 15111
 15112* EXEC CICS GETMAIN
 15113*        SET      (ADDRESS OF PENDING-BUSINESS)
 15114*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15115*        INITIMG  (GETMAIN-SPACE)
 15116*     END-EXEC.
 15117*    MOVE ',"IL                  $   #00013499' TO DFHEIV0
 15118     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15119     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15120     MOVE X'2020233030303133343939' TO DFHEIV0(25:11)
 15121     CALL 'kxdfhei1' USING DFHEIV0,
 15122           DFHEIV20,
 15123           ERPNDB-RECORD-LENGTH,
 15124           GETMAIN-SPACE
 15125     SET ADDRESS OF PENDING-BUSINESS TO
 15126         DFHEIV20
 15127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15128
 15129
 15130
 15131* EXEC CICS READ
 15132*        INTO    (PENDING-BUSINESS)
 15133*        DATASET (FILE-ID-ERPNDB)
 15134*        RIDFLD  (ERPNDB-KEY)
 15135*    END-EXEC.
 15136     MOVE LENGTH OF
 15137      PENDING-BUSINESS
 15138       TO DFHEIV11
 15139*    MOVE '&"IL       E          (   #00013505' TO DFHEIV0
 15140     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15142     MOVE X'2020233030303133353035' TO DFHEIV0(25:11)
 15143     CALL 'kxdfhei1' USING DFHEIV0,
 15144           FILE-ID-ERPNDB,
 15145           PENDING-BUSINESS,
 15146           DFHEIV11,
 15147           ERPNDB-KEY,
 15148           DFHEIV99,
 15149           DFHEIV99,
 15150           DFHEIV99
 15151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 276
* EL6311.cbl
 15152
 15153
 15154     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15155
 15156
 15157* EXEC CICS HANDLE CONDITION
 15158*         NOTFND     (2385-REC-NOT-FOUND)
 15159*    END-EXEC.
 15160*    MOVE '"$I                   ! 6 #00013513' TO DFHEIV0
 15161     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15163     MOVE X'3620233030303133353133' TO DFHEIV0(25:11)
 15164     CALL 'kxdfhei1' USING DFHEIV0
 15165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15166
 15167
 15168**********************************************************
 15169*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15170*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15171**********************************************************
 15172
 15173
 15174* EXEC CICS READ
 15175*        DATASET (FILE-ID-ERPNDB)
 15176*        INTO    (PENDING-BUSINESS)
 15177*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15178*    END-EXEC.
 15179     MOVE LENGTH OF
 15180      PENDING-BUSINESS
 15181       TO DFHEIV11
 15182*    MOVE '&"IL       E          (   #00013522' TO DFHEIV0
 15183     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15185     MOVE X'2020233030303133353232' TO DFHEIV0(25:11)
 15186     CALL 'kxdfhei1' USING DFHEIV0,
 15187           FILE-ID-ERPNDB,
 15188           PENDING-BUSINESS,
 15189           DFHEIV11,
 15190           PI-PREV-CONTROL-PRIMARY,
 15191           DFHEIV99,
 15192           DFHEIV99,
 15193           DFHEIV99
 15194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15195
 15196
 15197********** DO NOT ALLOW CHANGES IF THRU A/R
 15198     IF BMAINTI = 'C'
 15199         IF PB-EL860-INTERNAL-PROCESS
 15200             MOVE ER-4005          TO EMI-ERROR
 15201             MOVE -1               TO BMAINTL
 15202             MOVE AL-UABON         TO BMAINTA
 15203             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15204             GO TO 8200-SEND-DATAONLY.
 15205**********
 15206
 15207     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15208        MOVE -1                 TO CMAINTL
 15209        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 277
* EL6311.cbl
 15210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15211        GO TO 8200-SEND-DATAONLY.
 15212
 15213     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15214        MOVE ER-2196             TO EMI-ERROR
 15215        MOVE AL-UABON            TO CMAINTA
 15216        MOVE -1                  TO CMAINTL
 15217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15218        GO TO 8200-SEND-DATAONLY.
 15219     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15220
 15221     IF PB-BILLED-DT = LOW-VALUES AND
 15222        PB-CHG-COUNT = ZEROS
 15223        NEXT SENTENCE
 15224     ELSE
 15225        IF (CREFND1L GREATER THAN ZEROS AND
 15226            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15227           OR
 15228           (CREFND2L GREATER THAN ZEROS AND
 15229            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15230           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15231     if ((crefnd1l <> zeros)
 15232        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15233                      or
 15234        ((crefnd2l <> zeros)
 15235        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15236        continue
 15237     else
 15238        go to 2330-continue-change
 15239     end-if
 15240
 15241     move zeros                  to ws-check-amts
 15242     move ' '                    to ws-stop-sw
 15243                                    ws-check-sw
 15244                                    ws-proc-check-sw
 15245                                    ws-chek-browse-sw
 15246
 15247     perform 2500-browse-checks  thru 2500-exit
 15248
 15249     if i-have-processed-checks
 15250        or i-have-checks
 15251        continue
 15252     else
 15253        go to 2330-continue-change
 15254     end-if
 15255
 15256     display ' pb lf can ' pb-c-lf-cancel-amt
 15257     display ' ws lf can ' ws-crefnd1
 15258     if crefnd1l <> zeros
 15259        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15260        move ws-crefnd1 to ws-new-ref-total
 15261     else
 15262        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15263     end-if
 15264     display ' pb ah can ' pb-c-ah-cancel-amt
 15265     display ' ws ah can ' ws-crefnd2
 15266     display ' chk amts  ' ws-check-amts
 15267     if crefnd2l <> zeros
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 278
* EL6311.cbl
 15268        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15269        compute ws-new-ref-total = ws-new-ref-total +
 15270           ws-crefnd2
 15271     else
 15272        compute ws-new-ref-total = ws-new-ref-total +
 15273           pb-c-ah-cancel-amt
 15274     end-if
 15275
 15276     if zeros = (ws-lf-diff + ws-ah-diff)
 15277        move er-3449             to emi-error
 15278        perform 9900-error-format thru 9900-exit
 15279        go to 2330-continue-change
 15280     end-if
 15281
 15282     if ws-new-ref-total < ws-check-amts
 15283        move er-3447             to emi-error
 15284        perform 9900-error-format thru 9900-exit
 15285        move al-uabon            to cmainta
 15286        move -1                  to cmaintl
 15287        go to 8200-send-dataonly
 15288     end-if
 15289
 15290     if (ws-new-ref-total > ws-check-amts)
 15291        and (ws-check-amts not = zeros)
 15292        move er-3448             to emi-error
 15293        move al-uabon            to crefnd1a
 15294                                    crefnd2a
 15295        perform 9900-error-format thru 9900-exit
 15296     end-if
 15297
 15298*     if (ws-lf-diff + ws-ah-diff) < zeros
 15299*        move er-3447             to emi-error
 15300*        perform 9900-error-format thru 9900-exit
 15301*        move al-uabon            to cmainta
 15302*        move -1                  to cmaintl
 15303*        go to 8200-send-dataonly
 15304*     end-if
 15305     .
 15306 2330-continue-change.
 15307
 15308
 15309* EXEC CICS READ
 15310*        DATASET (FILE-ID-ERPNDB)
 15311*        INTO    (PENDING-BUSINESS)
 15312*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15313*        UPDATE
 15314*    END-EXEC.
 15315     MOVE LENGTH OF
 15316      PENDING-BUSINESS
 15317       TO DFHEIV11
 15318*    MOVE '&"IL       EU         (   #00013639' TO DFHEIV0
 15319     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15320     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15321     MOVE X'2020233030303133363339' TO DFHEIV0(25:11)
 15322     CALL 'kxdfhei1' USING DFHEIV0,
 15323           FILE-ID-ERPNDB,
 15324           PENDING-BUSINESS,
 15325           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 279
* EL6311.cbl
 15326           PI-PREV-CONTROL-PRIMARY,
 15327           DFHEIV99,
 15328           DFHEIV99,
 15329           DFHEIV99
 15330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15331
 15332
 15333     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15334     MOVE 'B'                    TO JP-RECORD-TYPE
 15335     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15336     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15337
 15338     PERFORM 8400-LOG-JOURNAL-RECORD.
 15339
 15340     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15341          PB-CHG-COUNT NOT = ZEROS
 15342        IF (CREFND1L GREATER THAN ZEROS AND
 15343            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15344           OR
 15345           (CREFND2L GREATER THAN ZEROS AND
 15346            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15347            ADD +1                      TO PB-CHG-COUNT
 15348            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15349
 15350*    IF CMICRNOL  GREATER  ZEROS
 15351*        IF CMICRNOI  NUMERIC
 15352*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15353*            MOVE AL-UNNON       TO  CMICRNOA
 15354*        ELSE
 15355*            MOVE -1             TO  CMICRNOL
 15356*            MOVE AL-UNBON       TO  CMICRNOA
 15357*            MOVE ER-2701        TO  EMI-ERROR
 15358*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15359
 15360     IF CSUFIXL GREATER THAN ZEROS
 15361        MOVE CSUFIXI             TO PB-CERT-SFX.
 15362
 15363     IF CLSTNML GREATER THAN ZEROS
 15364         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15365
 15366     IF CCANREAL > ZEROS
 15367        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15368     END-IF
 15369     IF CPCYNL > ZEROS
 15370        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15371     END-IF
 15372     IF CCANDT1L    GREATER THAN ZEROS
 15373        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15374
 15375     IF CCANDT2L    GREATER THAN ZEROS
 15376        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15377
 15378     IF CMTHD1L    GREATER THAN +0
 15379        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15380
 15381     IF CMTHD2L    GREATER THAN +0
 15382        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15383
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 280
* EL6311.cbl
 15384     IF CREFND1L    GREATER THAN ZEROS
 15385        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15386        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15387        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15388        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15389
 15390     IF CREFND2L    GREATER THAN ZEROS
 15391        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15392        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15393        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15394        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15395
 15396     IF CLIVESL     GREATER THAN ZEROS
 15397        MOVE WS-CLIVES           TO PB-C-LIVES.
 15398
 15399     IF CPAYEEL     GREATER THAN ZEROS
 15400        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15401
 15402     IF CFORCEL     GREATER THAN ZEROS
 15403        MOVE CFORCEI             TO PB-FORCE-CODE.
 15404
 15405     IF CBILCDL     GREATER THAN ZEROS
 15406        MOVE CBILCDI             TO PB-RECORD-BILL.
 15407
 15408 2360-REWRITE-PB-RECORD.
 15409     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15410     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15411     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15412     MOVE 'C'                    TO JP-RECORD-TYPE.
 15413     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15414     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15415     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15416
 15417     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15418
 15419     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15420     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15421
 15422     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15423
 15424     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15425
 15426     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15427     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15428     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15429
 15430     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15431     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15432
 15433 2375-REWRITE-PENDING-BUSINESS.
 15434     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15435     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15436     MOVE 'C'                    TO JP-RECORD-TYPE.
 15437     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15438
 15439
 15440* EXEC CICS REWRITE
 15441*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 281
* EL6311.cbl
 15442*        FROM    (PENDING-BUSINESS)
 15443*    END-EXEC.
 15444     MOVE LENGTH OF
 15445      PENDING-BUSINESS
 15446       TO DFHEIV11
 15447*    MOVE '&& L                  %   #00013752' TO DFHEIV0
 15448     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15450     MOVE X'2020233030303133373532' TO DFHEIV0(25:11)
 15451     CALL 'kxdfhei1' USING DFHEIV0,
 15452           FILE-ID-ERPNDB,
 15453           PENDING-BUSINESS,
 15454           DFHEIV11,
 15455           DFHEIV99
 15456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15457
 15458
 15459     PERFORM 8400-LOG-JOURNAL-RECORD.
 15460
 15461******************************************************************
 15462*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15463******************************************************************
 15464
 15465     display ' made it to update orig cancel cert '
 15466
 15467     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15468     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15469     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15470     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15471
 15472
 15473* EXEC CICS READ
 15474*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15475*        DATASET (FILE-ID-ELCERT)
 15476*        RIDFLD  (ELCERT-KEY)
 15477*        RESP    (WS-RESPONSE)
 15478*    END-EXEC.
 15479*    MOVE '&"S        E          (  N#00013770' TO DFHEIV0
 15480     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15481     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15482     MOVE X'204E233030303133373730' TO DFHEIV0(25:11)
 15483     CALL 'kxdfhei1' USING DFHEIV0,
 15484           FILE-ID-ELCERT,
 15485           DFHEIV20,
 15486           DFHEIV99,
 15487           ELCERT-KEY,
 15488           DFHEIV99,
 15489           DFHEIV99,
 15490           DFHEIV99
 15491     SET ADDRESS OF CERTIFICATE-MASTER TO
 15492         DFHEIV20
 15493     MOVE EIBRESP  TO WS-RESPONSE
 15494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15495
 15496
 15497     IF NOT RESP-NORMAL
 15498        GO TO 2376-BYPASS-CRTO
 15499     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 282
* EL6311.cbl
 15500
 15501
 15502     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15503     MOVE ' '                    TO WS-ERMAIL-SW
 15504
 15505
 15506* EXEC CICS READ
 15507*       DATASET   (FILE-ID-ERMAIL)
 15508*       SET       (ADDRESS OF MAILING-DATA)
 15509*       RIDFLD    (ERMAIL-KEY)
 15510*       RESP      (WS-RESPONSE)
 15511*    END-EXEC
 15512*    MOVE '&"S        E          (  N#00013785' TO DFHEIV0
 15513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15515     MOVE X'204E233030303133373835' TO DFHEIV0(25:11)
 15516     CALL 'kxdfhei1' USING DFHEIV0,
 15517           FILE-ID-ERMAIL,
 15518           DFHEIV20,
 15519           DFHEIV99,
 15520           ERMAIL-KEY,
 15521           DFHEIV99,
 15522           DFHEIV99,
 15523           DFHEIV99
 15524     SET ADDRESS OF MAILING-DATA TO
 15525         DFHEIV20
 15526     MOVE EIBRESP  TO WS-RESPONSE
 15527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15528
 15529     IF RESP-NORMAL
 15530        SET ERMAIL-FOUND TO TRUE
 15531     END-IF
 15532
 15533     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15534
 15535     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15536                                 TO ELCRTO-KEY
 15537     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15538     MOVE +0                     TO ELCRTO-SEQ-NO
 15539
 15540
 15541* EXEC CICS READ
 15542*       DATASET   ('ELCRTO')
 15543*       INTO      (ORIGINAL-CERTIFICATE)
 15544*       RIDFLD    (ELCRTO-KEY)
 15545*       GTEQ
 15546*       RESP      (WS-RESPONSE)
 15547*    END-EXEC
 15548     MOVE LENGTH OF
 15549      ORIGINAL-CERTIFICATE
 15550       TO DFHEIV11
 15551     MOVE 'ELCRTO' TO DFHEIV1
 15552*    MOVE '&"IL       G          (  N#00013803' TO DFHEIV0
 15553     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15555     MOVE X'204E233030303133383033' TO DFHEIV0(25:11)
 15556     CALL 'kxdfhei1' USING DFHEIV0,
 15557           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 283
* EL6311.cbl
 15558           ORIGINAL-CERTIFICATE,
 15559           DFHEIV11,
 15560           ELCRTO-KEY,
 15561           DFHEIV99,
 15562           DFHEIV99,
 15563           DFHEIV99
 15564     MOVE EIBRESP  TO WS-RESPONSE
 15565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15566
 15567     display ' just read gteq ' ws-response
 15568     IF RESP-NORMAL
 15569        AND (OC-CONTROL-PRIMARY (1:33) =
 15570                 PB-CONTROL-BY-ACCOUNT (1:33))
 15571        AND (OC-RECORD-TYPE = 'I')
 15572        display ' resp norm, key =, type i '
 15573        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15574           display ' end proc blank '
 15575           display ' csr edit session ' PI-CSR-SESSION-SW
 15576           IF NOT CSR-EDIT-SESSION
 15577
 15578* EXEC CICS READ
 15579*                DATASET   ('ELCRTO')
 15580*                INTO      (ORIGINAL-CERTIFICATE)
 15581*                RIDFLD    (OC-CONTROL-PRIMARY)
 15582*                UPDATE
 15583*                RESP      (WS-RESPONSE)
 15584*             END-EXEC
 15585     MOVE LENGTH OF
 15586      ORIGINAL-CERTIFICATE
 15587       TO DFHEIV11
 15588     MOVE 'ELCRTO' TO DFHEIV1
 15589*    MOVE '&"IL       EU         (  N#00013821' TO DFHEIV0
 15590     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15592     MOVE X'204E233030303133383231' TO DFHEIV0(25:11)
 15593     CALL 'kxdfhei1' USING DFHEIV0,
 15594           DFHEIV1,
 15595           ORIGINAL-CERTIFICATE,
 15596           DFHEIV11,
 15597           OC-CONTROL-PRIMARY,
 15598           DFHEIV99,
 15599           DFHEIV99,
 15600           DFHEIV99
 15601     MOVE EIBRESP  TO WS-RESPONSE
 15602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15603              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15604              IF RESP-NORMAL
 15605                 display ' good read upd '
 15606                 IF OC-ISSUE-TRAN-IND = 'N'
 15607                    MOVE CM-INSURED-LAST-NAME   TO
 15608                         OC-INS-LAST-NAME
 15609                    MOVE CM-INSURED-FIRST-NAME  TO
 15610                         OC-INS-FIRST-NAME
 15611                    MOVE CM-INSURED-INITIAL2    TO
 15612                         OC-INS-MIDDLE-INIT
 15613                    MOVE CM-INSURED-ISSUE-AGE   TO
 15614                         OC-INS-AGE
 15615                    MOVE CM-JT-LAST-NAME        TO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 284
* EL6311.cbl
 15616                         OC-JNT-LAST-NAME
 15617                    MOVE CM-JT-FIRST-NAME       TO
 15618                         OC-JNT-FIRST-NAME
 15619                    MOVE CM-JT-INITIAL          TO
 15620                         OC-JNT-MIDDLE-INIT
 15621                    MOVE CM-INSURED-JOINT-AGE   TO
 15622                         OC-JNT-AGE
 15623                    MOVE CM-LF-BENEFIT-CD       TO
 15624                         OC-LF-BENCD
 15625                    MOVE CM-LF-ORIG-TERM        TO
 15626                         OC-LF-TERM
 15627                    MOVE CM-LF-BENEFIT-AMT      TO
 15628                         OC-LF-BEN-AMT
 15629                    MOVE CM-LF-PREMIUM-AMT      TO
 15630                         OC-LF-PRM-AMT
 15631                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15632                         OC-LF-ALT-BEN-AMT
 15633                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15634                         OC-LF-ALT-PRM-AMT
 15635                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15636                         OC-LF-EXP-DT
 15637                    MOVE CM-LIFE-COMM-PCT       TO
 15638                         OC-LF-COMM-PCT
 15639                    MOVE CM-AH-BENEFIT-CD       TO
 15640                         OC-AH-BENCD
 15641                    MOVE CM-AH-ORIG-TERM        TO
 15642                         OC-AH-TERM
 15643                    MOVE CM-AH-BENEFIT-AMT      TO
 15644                         OC-AH-BEN-AMT
 15645                    MOVE CM-AH-PREMIUM-AMT      TO
 15646                         OC-AH-PRM-AMT
 15647                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15648                         OC-AH-EXP-DT
 15649                    MOVE CM-AH-COMM-PCT         TO
 15650                         OC-AH-COMM-PCT
 15651                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15652                         OC-AH-CP
 15653                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15654                         OC-1ST-PMT-DT
 15655                 END-IF
 15656                 MOVE PB-C-LF-CANCEL-DT      TO
 15657                         OC-LF-CANCEL-DT
 15658                 MOVE PB-C-LF-CANCEL-AMT     TO
 15659                         OC-LF-CANCEL-AMT
 15660                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15661                         OC-LF-ITD-CANCEL-AMT
 15662                 MOVE PB-C-AH-CANCEL-DT      TO
 15663                         OC-AH-CANCEL-DT
 15664                 MOVE PB-C-AH-CANCEL-AMT     TO
 15665                         OC-AH-CANCEL-AMT
 15666                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15667                         OC-AH-ITD-CANCEL-AMT
 15668                 MOVE 'Y'                    TO
 15669                         OC-CANCEL-TRAN-IND
 15670                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15671                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15672                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15673                 IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 285
* EL6311.cbl
 15674                    MOVE MA-CRED-BENE-NAME
 15675                                 TO OC-CRED-BENE-NAME
 15676                 END-IF
 15677                 IF NOT CERT-TRL-REC-NOT-FOUND
 15678                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15679                           OC-INS-AGE-DEFAULT-FLAG
 15680                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15681                           OC-JNT-AGE-DEFAULT-FLAG
 15682                 END-IF
 15683
 15684* EXEC CICS REWRITE
 15685*                   DATASET   ('ELCRTO')
 15686*                   FROM      (ORIGINAL-CERTIFICATE)
 15687*                   RESP      (WS-RESPONSE)
 15688*                END-EXEC
 15689     MOVE LENGTH OF
 15690      ORIGINAL-CERTIFICATE
 15691       TO DFHEIV11
 15692     MOVE 'ELCRTO' TO DFHEIV1
 15693*    MOVE '&& L                  %  N#00013908' TO DFHEIV0
 15694     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15695     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15696     MOVE X'204E233030303133393038' TO DFHEIV0(25:11)
 15697     CALL 'kxdfhei1' USING DFHEIV0,
 15698           DFHEIV1,
 15699           ORIGINAL-CERTIFICATE,
 15700           DFHEIV11,
 15701           DFHEIV99
 15702     MOVE EIBRESP  TO WS-RESPONSE
 15703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15704                 display ' just rewrote ' ws-response
 15705              END-IF
 15706           END-IF
 15707        ELSE
 15708           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15709           MOVE 'OC'             TO OC-RECORD-ID
 15710           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15711           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15712           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15713           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15714           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15715           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15716           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15717           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15718           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15719           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15720           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15721           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15722           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15723           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15724           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15725           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15726           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15727           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15728           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15729           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15730           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15731           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 286
* EL6311.cbl
 15732           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15733           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15734           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15735           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15736           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15737           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15738           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15739           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15740           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15741           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15742           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15743           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15744           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15745           IF ERMAIL-FOUND
 15746              MOVE MA-CRED-BENE-NAME
 15747                                 TO OC-CRED-BENE-NAME
 15748           END-IF
 15749           IF NOT CERT-TRL-REC-NOT-FOUND
 15750              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15751                           OC-INS-AGE-DEFAULT-FLAG
 15752              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15753                           OC-JNT-AGE-DEFAULT-FLAG
 15754           END-IF
 15755           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15756
 15757* EXEC CICS WRITE
 15758*             DATASET   ('ELCRTO')
 15759*             FROM      (ORIGINAL-CERTIFICATE)
 15760*             RIDFLD    (OC-CONTROL-PRIMARY)
 15761*             RESP      (WS-RESPONSE)
 15762*          END-EXEC
 15763     MOVE LENGTH OF
 15764      ORIGINAL-CERTIFICATE
 15765       TO DFHEIV11
 15766     MOVE 'ELCRTO' TO DFHEIV1
 15767*    MOVE '&$ L                  ''  N#00013965' TO DFHEIV0
 15768     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15769     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15770     MOVE X'204E233030303133393635' TO DFHEIV0(25:11)
 15771     CALL 'kxdfhei1' USING DFHEIV0,
 15772           DFHEIV1,
 15773           ORIGINAL-CERTIFICATE,
 15774           DFHEIV11,
 15775           OC-CONTROL-PRIMARY,
 15776           DFHEIV99,
 15777           DFHEIV99
 15778     MOVE EIBRESP  TO WS-RESPONSE
 15779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15780        END-IF
 15781     ELSE
 15782        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15783        MOVE 'OC'                TO OC-RECORD-ID
 15784        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15785                                 TO OC-CONTROL-PRIMARY (1:33)
 15786        MOVE 'I'                 TO OC-RECORD-TYPE
 15787        MOVE +4096               TO OC-KEY-SEQ-NO
 15788        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15789        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 287
* EL6311.cbl
 15790        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15791        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15792        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15793        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15794        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15795        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15796        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15797        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15798        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15799        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15800        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15801        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15802        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15803        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15804        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15805        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15806        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15807        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15808        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15809        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15810        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15811        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15812        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15813        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15814        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15815        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15816        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15817        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15818        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15819        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15820        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15821        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15822        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15823        IF ERMAIL-FOUND
 15824           MOVE MA-CRED-BENE-NAME
 15825                                 TO OC-CRED-BENE-NAME
 15826        END-IF
 15827        IF NOT CERT-TRL-REC-NOT-FOUND
 15828           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15829                           OC-INS-AGE-DEFAULT-FLAG
 15830           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15831                           OC-JNT-AGE-DEFAULT-FLAG
 15832        END-IF
 15833        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15834
 15835
 15836* EXEC CICS WRITE
 15837*          DATASET   ('ELCRTO')
 15838*          FROM      (ORIGINAL-CERTIFICATE)
 15839*          RIDFLD    (OC-CONTROL-PRIMARY)
 15840*          RESP      (WS-RESPONSE)
 15841*       END-EXEC
 15842     MOVE LENGTH OF
 15843      ORIGINAL-CERTIFICATE
 15844       TO DFHEIV11
 15845     MOVE 'ELCRTO' TO DFHEIV1
 15846*    MOVE '&$ L                  ''  N#00014026' TO DFHEIV0
 15847     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 288
* EL6311.cbl
 15848     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15849     MOVE X'204E233030303134303236' TO DFHEIV0(25:11)
 15850     CALL 'kxdfhei1' USING DFHEIV0,
 15851           DFHEIV1,
 15852           ORIGINAL-CERTIFICATE,
 15853           DFHEIV11,
 15854           OC-CONTROL-PRIMARY,
 15855           DFHEIV99,
 15856           DFHEIV99
 15857     MOVE EIBRESP  TO WS-RESPONSE
 15858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15859     END-IF.
 15860
 15861 2376-BYPASS-CRTO.
 15862******************************************************************
 15863*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15864******************************************************************
 15865
 15866
 15867* EXEC CICS HANDLE CONDITION
 15868*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15869*    END-EXEC.
 15870*    MOVE '"$I                   ! 7 #00014039' TO DFHEIV0
 15871     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15873     MOVE X'3720233030303134303339' TO DFHEIV0(25:11)
 15874     CALL 'kxdfhei1' USING DFHEIV0
 15875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15876
 15877
 15878
 15879* EXEC CICS READ
 15880*        INTO    (PENDING-BUSINESS)
 15881*        DATASET (FILE-ID-ERPNDB)
 15882*        RIDFLD  (ERPNDB-KEY)
 15883*        UPDATE
 15884*    END-EXEC.
 15885     MOVE LENGTH OF
 15886      PENDING-BUSINESS
 15887       TO DFHEIV11
 15888*    MOVE '&"IL       EU         (   #00014043' TO DFHEIV0
 15889     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15890     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15891     MOVE X'2020233030303134303433' TO DFHEIV0(25:11)
 15892     CALL 'kxdfhei1' USING DFHEIV0,
 15893           FILE-ID-ERPNDB,
 15894           PENDING-BUSINESS,
 15895           DFHEIV11,
 15896           ERPNDB-KEY,
 15897           DFHEIV99,
 15898           DFHEIV99,
 15899           DFHEIV99
 15900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15901
 15902
 15903     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15904     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15905     MOVE 'B'                    TO JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 289
* EL6311.cbl
 15906     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15907
 15908     PERFORM 8400-LOG-JOURNAL-RECORD.
 15909
 15910     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15911
 15912
 15913* EXEC CICS REWRITE
 15914*        DATASET (FILE-ID-ERPNDB)
 15915*        FROM    (PENDING-BUSINESS)
 15916*    END-EXEC.
 15917     MOVE LENGTH OF
 15918      PENDING-BUSINESS
 15919       TO DFHEIV11
 15920*    MOVE '&& L                  %   #00014059' TO DFHEIV0
 15921     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15922     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15923     MOVE X'2020233030303134303539' TO DFHEIV0(25:11)
 15924     CALL 'kxdfhei1' USING DFHEIV0,
 15925           FILE-ID-ERPNDB,
 15926           PENDING-BUSINESS,
 15927           DFHEIV11,
 15928           DFHEIV99
 15929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15930
 15931
 15932     MOVE 'C'                    TO JP-RECORD-TYPE.
 15933     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15934
 15935     PERFORM 8400-LOG-JOURNAL-RECORD.
 15936
 15937     IF WS-ERRORS-PRESENT
 15938         GO TO 3900-RE-DISPLAY-RECORD.
 15939
 15940     MOVE ZEROS                  TO EMI-ERROR
 15941     MOVE -1                     TO CMAINTL
 15942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15943     GO TO 3900-RE-DISPLAY-RECORD.
 15944
 15945 2380-BATCH-HDR-NOT-FOUND.
 15946     MOVE -1                     TO BMAINTL.
 15947     MOVE ER-7450                TO EMI-ERROR.
 15948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15949     GO TO 8200-SEND-DATAONLY.
 15950
 15951 2385-REC-NOT-FOUND.
 15952     MOVE -1                     TO BMAINTL.
 15953     MOVE ER-7451                TO EMI-ERROR.
 15954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15955     GO TO 8200-SEND-DATAONLY.
 15956
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 290
* EL6311.cbl
 15958
 15959******************************************************************
 15960*                                                                *
 15961*          D E L E T E   C A N C E L   R O U T I N E             *
 15962*                                                                *
 15963******************************************************************
 15964
 15965 2400-DELETE-CANCEL-ROUTINE.
 15966     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15967
 15968     IF CCHGL NOT = ZEROS
 15969        MOVE ER-2196             TO EMI-ERROR
 15970        MOVE AL-UABON            TO CMAINTA
 15971        MOVE -1                  TO CMAINTL
 15972        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15973        GO TO 8200-SEND-DATAONLY.
 15974
 15975
 15976* EXEC CICS HANDLE CONDITION
 15977*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15978*    END-EXEC.
 15979*    MOVE '"$I                   ! 8 #00014107' TO DFHEIV0
 15980     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15982     MOVE X'3820233030303134313037' TO DFHEIV0(25:11)
 15983     CALL 'kxdfhei1' USING DFHEIV0
 15984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15985
 15986
 15987     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15988     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15989     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15990
 15991
 15992* EXEC CICS READ
 15993*        SET     (ADDRESS OF PENDING-BUSINESS)
 15994*        DATASET (FILE-ID-ERPNDB)
 15995*        RIDFLD  (ERPNDB-KEY)
 15996*    END-EXEC.
 15997*    MOVE '&"S        E          (   #00014115' TO DFHEIV0
 15998     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16000     MOVE X'2020233030303134313135' TO DFHEIV0(25:11)
 16001     CALL 'kxdfhei1' USING DFHEIV0,
 16002           FILE-ID-ERPNDB,
 16003           DFHEIV20,
 16004           DFHEIV99,
 16005           ERPNDB-KEY,
 16006           DFHEIV99,
 16007           DFHEIV99,
 16008           DFHEIV99
 16009     SET ADDRESS OF PENDING-BUSINESS TO
 16010         DFHEIV20
 16011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16012
 16013
 16014     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16015
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 291
* EL6311.cbl
 16016     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16017
 16018     IF CSUFIXL NOT = ZEROS
 16019        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16020     ELSE
 16021        MOVE SPACE               TO WS-NEW-SUFFIX.
 16022
 16023     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16024
 16025     PERFORM 8600-DEEDIT.
 16026     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16027     MOVE '4'                    TO DC-OPTION-CODE.
 16028     PERFORM 9700-DATE-LINK.
 16029
 16030     IF DATE-CONVERSION-ERROR
 16031        MOVE ER-0348             TO EMI-ERROR
 16032        MOVE -1                  TO CEFFDTL
 16033        MOVE AL-UABON            TO CEFFDTA
 16034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16035        GO TO 8200-SEND-DATAONLY
 16036     ELSE
 16037        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16038        MOVE AL-UANON            TO CEFFDTA
 16039        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16040
 16041
 16042* EXEC CICS HANDLE CONDITION
 16043*         NOTFND    (2490-RECORD-NOT-FOUND)
 16044*    END-EXEC.
 16045*    MOVE '"$I                   ! 9 #00014148' TO DFHEIV0
 16046     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16048     MOVE X'3920233030303134313438' TO DFHEIV0(25:11)
 16049     CALL 'kxdfhei1' USING DFHEIV0
 16050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16051
 16052
 16053
 16054* EXEC CICS READ
 16055*        SET     (ADDRESS OF PENDING-BUSINESS)
 16056*        DATASET (FILE-ID-ERPNDB)
 16057*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16058*        UPDATE
 16059*    END-EXEC.
 16060*    MOVE '&"S        EU         (   #00014152' TO DFHEIV0
 16061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16062     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16063     MOVE X'2020233030303134313532' TO DFHEIV0(25:11)
 16064     CALL 'kxdfhei1' USING DFHEIV0,
 16065           FILE-ID-ERPNDB,
 16066           DFHEIV20,
 16067           DFHEIV99,
 16068           PI-PREV-CONTROL-PRIMARY,
 16069           DFHEIV99,
 16070           DFHEIV99,
 16071           DFHEIV99
 16072     SET ADDRESS OF PENDING-BUSINESS TO
 16073         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 292
* EL6311.cbl
 16074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16075
 16076
 16077     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16078        MOVE -1                 TO CMAINTL
 16079        MOVE ER-2197            TO EMI-ERROR
 16080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16081        GO TO 8200-SEND-DATAONLY.
 16082
 16083     IF PB-BILLED-DT NOT = LOW-VALUES
 16084        MOVE -1                 TO CMAINTL
 16085        MOVE ER-2129            TO EMI-ERROR
 16086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16087        GO TO 8200-SEND-DATAONLY.
 16088
 16089     IF PB-CHG-COUNT NOT = ZEROS
 16090        MOVE ER-2336            TO EMI-ERROR
 16091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16092        MOVE AL-UABON            TO CMAINTA
 16093        MOVE -1                  TO CMAINTL
 16094        GO TO 8200-SEND-DATAONLY.
 16095
 16096     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16097        PB-CHG-COUNT NOT = ZEROS
 16098        MOVE ER-2196             TO EMI-ERROR
 16099        MOVE AL-UABON            TO CMAINTA
 16100        MOVE -1                  TO CMAINTL
 16101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16102        GO TO 8200-SEND-DATAONLY.
 16103
 16104     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16105        MOVE ER-2900 TO EMI-ERROR
 16106        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16107        MOVE AL-UABON         TO CMAINTA
 16108        MOVE -1               TO CMAINTL
 16109        GO TO 8200-SEND-DATAONLY.
 16110     move ' '                    to ws-stop-sw
 16111                                    ws-check-sw
 16112                                    ws-proc-check-sw
 16113                                    ws-chek-browse-sw
 16114
 16115     perform 2500-browse-checks  thru 2500-exit
 16116     if i-have-processed-checks
 16117        move er-3446             to emi-error
 16118        perform 9900-error-format thru 9900-exit
 16119        move al-uabon            to cmainta
 16120        move -1                  to cmaintl
 16121        go to 8200-send-dataonly
 16122     end-if
 16123
 16124* EXEC CICS HANDLE CONDITION
 16125*         NOTFND  (2475-CONTINUE-DELETE)
 16126*    END-EXEC
 16127*    MOVE '"$I                   ! : #00014205' TO DFHEIV0
 16128     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16130     MOVE X'3A20233030303134323035' TO DFHEIV0(25:11)
 16131     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 293
* EL6311.cbl
 16132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16133
 16134     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16135     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16136     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16137     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16138
 16139
 16140* EXEC CICS READ
 16141*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16142*        DATASET (FILE-ID-ELCERT)
 16143*        RIDFLD  (ELCERT-KEY)
 16144*        UPDATE
 16145*    END-EXEC.
 16146*    MOVE '&"S        EU         (   #00014214' TO DFHEIV0
 16147     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16148     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16149     MOVE X'2020233030303134323134' TO DFHEIV0(25:11)
 16150     CALL 'kxdfhei1' USING DFHEIV0,
 16151           FILE-ID-ELCERT,
 16152           DFHEIV20,
 16153           DFHEIV99,
 16154           ELCERT-KEY,
 16155           DFHEIV99,
 16156           DFHEIV99,
 16157           DFHEIV99
 16158     SET ADDRESS OF CERTIFICATE-MASTER TO
 16159         DFHEIV20
 16160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16161
 16162
 16163     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16164
 16165     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16166     MOVE 'B'                    TO JP-RECORD-TYPE.
 16167     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16168     PERFORM 8400-LOG-JOURNAL-RECORD.
 16169
 16170     IF PB-CI-LIVES NOT NUMERIC
 16171         MOVE ZERO                    TO PB-CI-LIVES.
 16172
 16173     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16174        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16175           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16176           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16177           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16178                                            CM-LF-CANCEL-DT
 16179           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16180        ELSE
 16181           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16182           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16183           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16184           MOVE PB-CI-LIVES              TO CM-LIVES.
 16185
 16186     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16187        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16188           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16189               MOVE CM-LF-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 294
* EL6311.cbl
 16190                                        TO CM-LF-CURRENT-STATUS
 16191               MOVE SPACE
 16192                                        TO CM-LF-STATUS-AT-CANCEL
 16193           ELSE
 16194               MOVE PB-CI-LF-POLICY-STATUS
 16195                                        TO CM-LF-CURRENT-STATUS
 16196        ELSE
 16197           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16198
 16199
 16200     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16201        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16202           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16203           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16204           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16205                                            CM-AH-CANCEL-DT
 16206           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16207        ELSE
 16208           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16209           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16210           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16211           MOVE PB-CI-LIVES              TO CM-LIVES.
 16212
 16213     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16214        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16215           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16216               MOVE CM-AH-STATUS-AT-CANCEL
 16217                                        TO CM-AH-CURRENT-STATUS
 16218               MOVE SPACE
 16219                                        TO CM-AH-STATUS-AT-CANCEL
 16220           ELSE
 16221               MOVE PB-CI-AH-POLICY-STATUS
 16222                                        TO CM-AH-CURRENT-STATUS
 16223        ELSE
 16224           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16225
 16226 2450-REWRITE-CERT.
 16227     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16228     MOVE 'C'                      TO JP-RECORD-TYPE.
 16229     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16230
 16231
 16232* EXEC CICS REWRITE
 16233*        DATASET  (FILE-ID-ELCERT)
 16234*        FROM     (CERTIFICATE-MASTER)
 16235*    END-EXEC.
 16236     MOVE LENGTH OF
 16237      CERTIFICATE-MASTER
 16238       TO DFHEIV11
 16239*    MOVE '&& L                  %   #00014289' TO DFHEIV0
 16240     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16241     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16242     MOVE X'2020233030303134323839' TO DFHEIV0(25:11)
 16243     CALL 'kxdfhei1' USING DFHEIV0,
 16244           FILE-ID-ELCERT,
 16245           CERTIFICATE-MASTER,
 16246           DFHEIV11,
 16247           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 295
* EL6311.cbl
 16248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16249
 16250
 16251     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16252
 16253     PERFORM 8400-LOG-JOURNAL-RECORD.
 16254
 16255     move ' '                    to ws-stop-sw
 16256                                    ws-proc-check-sw
 16257                                    ws-chek-browse-sw
 16258
 16259     if i-have-checks
 16260        perform until i-say-stop
 16261           perform 2510-startbr-erchek
 16262                                 thru 2510-exit
 16263           if resp-normal
 16264              perform 2520-readnext-erchek
 16265                                 thru 2520-exit
 16266           end-if
 16267           if (not resp-normal)
 16268              or (pb-control-by-account (1:33) not =
 16269                 ch-control-primary (1:33))
 16270                 set i-say-stop to true
 16271           else
 16272              perform 2530-readupd-erchek
 16273                                 thru 2530-exit
 16274              if resp-normal
 16275                 perform 2540-delete-erchek
 16276                                 thru 2540-exit
 16277              end-if
 16278              if ws-chek-browse-sw = 'Y'
 16279                 perform 2525-endbr-erchek
 16280                                 thru 2525-exit
 16281                 move ' '        to ws-chek-browse-sw
 16282              end-if
 16283           end-if
 16284        end-perform
 16285     end-if
 16286
 16287     if ws-chek-browse-sw = 'Y'
 16288        perform 2525-endbr-erchek thru 2525-exit
 16289     end-if
 16290     .
 16291 2475-CONTINUE-DELETE.
 16292     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16293     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16294
 16295     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16296     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16297
 16298     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16299
 16300     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16301     MOVE 'D'                    TO JP-RECORD-TYPE
 16302     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16303
 16304
 16305* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 296
* EL6311.cbl
 16306*        DATASET    (FILE-ID-ERPNDB)
 16307*    END-EXEC.
 16308*    MOVE '&(                    &   #00014347' TO DFHEIV0
 16309     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16310     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16311     MOVE X'2020233030303134333437' TO DFHEIV0(25:11)
 16312     CALL 'kxdfhei1' USING DFHEIV0,
 16313           FILE-ID-ERPNDB,
 16314           DFHEIV99,
 16315           DFHEIV99,
 16316           DFHEIV99,
 16317           DFHEIV99
 16318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16319
 16320
 16321     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16322
 16323     PERFORM 8400-LOG-JOURNAL-RECORD.
 16324
 16325     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16326     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16327
 16328
 16329* EXEC CICS HANDLE CONDITION
 16330*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16331*    END-EXEC.
 16332*    MOVE '"$I                   ! ; #00014358' TO DFHEIV0
 16333     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16335     MOVE X'3B20233030303134333538' TO DFHEIV0(25:11)
 16336     CALL 'kxdfhei1' USING DFHEIV0
 16337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16338
 16339
 16340
 16341* EXEC CICS READ
 16342*        SET     (ADDRESS OF PENDING-BUSINESS)
 16343*        DATASET (FILE-ID-ERPNDB)
 16344*        RIDFLD  (ERPNDB-KEY)
 16345*        UPDATE
 16346*    END-EXEC.
 16347*    MOVE '&"S        EU         (   #00014362' TO DFHEIV0
 16348     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16349     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16350     MOVE X'2020233030303134333632' TO DFHEIV0(25:11)
 16351     CALL 'kxdfhei1' USING DFHEIV0,
 16352           FILE-ID-ERPNDB,
 16353           DFHEIV20,
 16354           DFHEIV99,
 16355           ERPNDB-KEY,
 16356           DFHEIV99,
 16357           DFHEIV99,
 16358           DFHEIV99
 16359     SET ADDRESS OF PENDING-BUSINESS TO
 16360         DFHEIV20
 16361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16362
 16363
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 297
* EL6311.cbl
 16364     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16365     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16366
 16367     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16368        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16369        MOVE 'D'                 TO JP-RECORD-TYPE
 16370        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16371
 16372* EXEC CICS DELETE
 16373*            DATASET    (FILE-ID-ERPNDB)
 16374*       END-EXEC
 16375*    MOVE '&(                    &   #00014376' TO DFHEIV0
 16376     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16377     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16378     MOVE X'2020233030303134333736' TO DFHEIV0(25:11)
 16379     CALL 'kxdfhei1' USING DFHEIV0,
 16380           FILE-ID-ERPNDB,
 16381           DFHEIV99,
 16382           DFHEIV99,
 16383           DFHEIV99,
 16384           DFHEIV99
 16385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16386        PERFORM 8400-LOG-JOURNAL-RECORD
 16387     ELSE
 16388        MOVE 'B'                 TO JP-RECORD-TYPE
 16389        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16390        PERFORM 8400-LOG-JOURNAL-RECORD
 16391        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16392        MOVE 'C'                 TO JP-RECORD-TYPE
 16393        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16394
 16395* EXEC CICS REWRITE
 16396*            DATASET    (FILE-ID-ERPNDB)
 16397*            FROM       (PENDING-BUSINESS)
 16398*       END-EXEC
 16399     MOVE LENGTH OF
 16400      PENDING-BUSINESS
 16401       TO DFHEIV11
 16402*    MOVE '&& L                  %   #00014387' TO DFHEIV0
 16403     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16404     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16405     MOVE X'2020233030303134333837' TO DFHEIV0(25:11)
 16406     CALL 'kxdfhei1' USING DFHEIV0,
 16407           FILE-ID-ERPNDB,
 16408           PENDING-BUSINESS,
 16409           DFHEIV11,
 16410           DFHEIV99
 16411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16412        PERFORM 8400-LOG-JOURNAL-RECORD.
 16413
 16414******************************************************************
 16415*                                                                *
 16416*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16417*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16418*                                                                *
 16419******************************************************************
 16420
 16421     IF NOT PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 298
* EL6311.cbl
 16422        GO TO 2480-DELETE-FINISHED.
 16423
 16424     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16425        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16426        NEXT SENTENCE
 16427     ELSE
 16428        GO TO 2480-DELETE-FINISHED.
 16429
 16430
 16431* EXEC CICS HANDLE CONDITION
 16432*         NOTFND    (2480-DELETE-FINISHED)
 16433*    END-EXEC.
 16434*    MOVE '"$I                   ! < #00014409' TO DFHEIV0
 16435     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16437     MOVE X'3C20233030303134343039' TO DFHEIV0(25:11)
 16438     CALL 'kxdfhei1' USING DFHEIV0
 16439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16440
 16441
 16442     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16443     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16444
 16445
 16446* EXEC CICS READ
 16447*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16448*        DATASET (FILE-ID-ERRQST)
 16449*        RIDFLD  (ERRQST-KEY)
 16450*        UPDATE
 16451*    END-EXEC.
 16452*    MOVE '&"S        EU         (   #00014416' TO DFHEIV0
 16453     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16454     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16455     MOVE X'2020233030303134343136' TO DFHEIV0(25:11)
 16456     CALL 'kxdfhei1' USING DFHEIV0,
 16457           FILE-ID-ERRQST,
 16458           DFHEIV20,
 16459           DFHEIV99,
 16460           ERRQST-KEY,
 16461           DFHEIV99,
 16462           DFHEIV99,
 16463           DFHEIV99
 16464     SET ADDRESS OF AR-REQUEST-RECORD TO
 16465         DFHEIV20
 16466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16467
 16468
 16469     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16470
 16471     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16472
 16473     MOVE 'D'                      TO JP-RECORD-TYPE.
 16474     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16475
 16476
 16477* EXEC CICS DELETE
 16478*         DATASET    (FILE-ID-ERRQST)
 16479*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 299
* EL6311.cbl
 16480*    MOVE '&(                    &   #00014430' TO DFHEIV0
 16481     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16482     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16483     MOVE X'2020233030303134343330' TO DFHEIV0(25:11)
 16484     CALL 'kxdfhei1' USING DFHEIV0,
 16485           FILE-ID-ERRQST,
 16486           DFHEIV99,
 16487           DFHEIV99,
 16488           DFHEIV99,
 16489           DFHEIV99
 16490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16491
 16492
 16493     PERFORM 8400-LOG-JOURNAL-RECORD.
 16494
 16495 2480-DELETE-FINISHED.
 16496     MOVE ZEROS                  TO EMI-ERROR.
 16497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16498     MOVE LOW-VALUES             TO EL631CI.
 16499     MOVE -1                     TO CMAINTL.
 16500     GO TO 8100-SEND-INITIAL-MAP.
 16501
 16502 2485-BATCH-HDR-NOT-FOUND.
 16503     MOVE -1                     TO CMAINTL
 16504     MOVE AL-UABON               TO CMAINTA.
 16505     MOVE ER-7450                TO EMI-ERROR.
 16506     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16507     GO TO 8200-SEND-DATAONLY.
 16508
 16509 2490-RECORD-NOT-FOUND.
 16510     MOVE -1                     TO CMAINTL
 16511     MOVE AL-UABON               TO CMAINTA.
 16512     MOVE ER-7451                TO EMI-ERROR.
 16513     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16514     GO TO 8200-SEND-DATAONLY.
 16515***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16516***                                                            ***
 16517***     2500  B R O W S E   C H E C K S                        ***
 16518***  We perform this routine from 2 different places.          ***
 16519***  1. If the user changes the refund amount on a cancel, we  ***
 16520***    want to.........                                        ***
 16521***    a. determine if prior checks have been processed        ***
 16522***    b. If the amt is larger, display message instructing    ***
 16523***     them to create another check to make up the difference.***
 16524***    c. If the amt is less, do not allow the change and      ***
 16525***     display a FATAL error suggesting they deal with check  ***
 16526***     records befor continuing.                              ***
 16527***  2. If the user wants to delete a cancel record we......   ***
 16528***    a. browse through all the checks and if there is a      ***
 16529***     processed check, send FATAL message.                   ***
 16530***    b. If there is a non-released check, then delete that   ***
 16531***     check after you delete the pending cancel record.      ***
 16532***                                                            ***
 16533***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16534
 16535 2500-browse-checks.
 16536
 16537     perform 2510-startbr-erchek thru 2510-exit
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 300
* EL6311.cbl
 16538
 16539     if not resp-normal
 16540        go to 2500-exit
 16541     end-if
 16542
 16543     perform until i-say-stop
 16544        perform 2520-readnext-erchek
 16545                                 thru 2520-exit
 16546        if (not resp-normal)
 16547           or (pb-control-by-account (1:33) not =
 16548              ch-control-primary (1:33))
 16549              set i-say-stop to true
 16550        else
 16551           if (ch-approval-status) = ' '
 16552              and (ch-void-dt = low-values)
 16553              and (ch-released-dt = low-values)
 16554              set i-have-checks to true
 16555           else
 16556              if ch-void-dt = low-values
 16557                 set i-have-processed-checks to true
 16558              end-if
 16559           end-if
 16560           if (ch-credit-accept-dt = low-values)
 16561              and (ch-void-dt = low-values)
 16562              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16563              compute ws-check-amts = ws-check-amts +
 16564                 ch-amount-paid
 16565           end-if
 16566        end-if
 16567     end-perform
 16568
 16569     if ws-chek-browse-sw = 'Y'
 16570        perform 2525-endbr-erchek thru 2525-exit
 16571     end-if
 16572
 16573    .
 16574 2500-exit.
 16575     exit.
 16576
 16577 2510-startbr-erchek.
 16578
 16579     move pb-control-by-account  to erchek-key
 16580     move +0                     to chek-record-seq
 16581
 16582
 16583* exec cics startbr
 16584*       dataset   ('ERCHEK')
 16585*       ridfld    (erchek-key)
 16586*       gteq
 16587*       resp      (ws-response)
 16588*    end-exec
 16589     MOVE 'ERCHEK' TO DFHEIV1
 16590     MOVE 0
 16591       TO DFHEIV11
 16592*    MOVE '&,         G          &  N#00014523' TO DFHEIV0
 16593     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16594     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16595     MOVE X'204E233030303134353233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 301
* EL6311.cbl
 16596     CALL 'kxdfhei1' USING DFHEIV0,
 16597           DFHEIV1,
 16598           erchek-key,
 16599           DFHEIV99,
 16600           DFHEIV11,
 16601           DFHEIV99
 16602     MOVE EIBRESP  TO ws-response
 16603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16604
 16605     IF RESP-NORMAL
 16606        move 'Y'                 to ws-chek-browse-sw
 16607     end-if
 16608
 16609     .
 16610 2510-exit.
 16611     exit.
 16612
 16613 2520-readnext-erchek.
 16614
 16615
 16616* EXEC CICS READNEXT
 16617*       SET     (ADDRESS OF CHECK-RECORDS)
 16618*       DATASET ('ERCHEK')
 16619*       RIDFLD  (ERCHEK-KEY)
 16620*       RESP    (WS-RESPONSE)
 16621*    END-EXEC
 16622     MOVE 'ERCHEK' TO DFHEIV1
 16623     MOVE 0
 16624       TO DFHEIV11
 16625*    MOVE '&.S                   )  N#00014540' TO DFHEIV0
 16626     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16627     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16628     MOVE X'204E233030303134353430' TO DFHEIV0(25:11)
 16629     CALL 'kxdfhei1' USING DFHEIV0,
 16630           DFHEIV1,
 16631           DFHEIV20,
 16632           DFHEIV99,
 16633           ERCHEK-KEY,
 16634           DFHEIV99,
 16635           DFHEIV11,
 16636           DFHEIV99,
 16637           DFHEIV99
 16638     SET ADDRESS OF CHECK-RECORDS TO
 16639         DFHEIV20
 16640     MOVE EIBRESP  TO WS-RESPONSE
 16641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16642
 16643     .
 16644 2520-exit.
 16645     exit.
 16646
 16647 2525-endbr-erchek.
 16648
 16649
 16650* exec cics endbr
 16651*       dataset  ('ERCHEK')
 16652*    end-exec
 16653     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 302
* EL6311.cbl
 16654     MOVE 0
 16655       TO DFHEIV11
 16656*    MOVE '&2                    $   #00014553' TO DFHEIV0
 16657     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16659     MOVE X'2020233030303134353533' TO DFHEIV0(25:11)
 16660     CALL 'kxdfhei1' USING DFHEIV0,
 16661           DFHEIV1,
 16662           DFHEIV11,
 16663           DFHEIV99
 16664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16665
 16666     .
 16667 2525-exit.
 16668     exit.
 16669
 16670 2530-readupd-erchek.
 16671
 16672
 16673* EXEC CICS READ
 16674*       UPDATE
 16675*       SET     (ADDRESS OF CHECK-RECORDS)
 16676*       DATASET ('ERCHEK')
 16677*       RIDFLD  (ERCHEK-KEY)
 16678*       RESP    (WS-RESPONSE)
 16679*    END-EXEC
 16680     MOVE 'ERCHEK' TO DFHEIV1
 16681*    MOVE '&"S        EU         (  N#00014563' TO DFHEIV0
 16682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16683     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16684     MOVE X'204E233030303134353633' TO DFHEIV0(25:11)
 16685     CALL 'kxdfhei1' USING DFHEIV0,
 16686           DFHEIV1,
 16687           DFHEIV20,
 16688           DFHEIV99,
 16689           ERCHEK-KEY,
 16690           DFHEIV99,
 16691           DFHEIV99,
 16692           DFHEIV99
 16693     SET ADDRESS OF CHECK-RECORDS TO
 16694         DFHEIV20
 16695     MOVE EIBRESP  TO WS-RESPONSE
 16696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16697
 16698     .
 16699 2530-exit.
 16700     exit.
 16701
 16702 2540-delete-erchek.
 16703
 16704
 16705* EXEC CICS DELETE
 16706*       DATASET ('ERCHEK')
 16707*       RESP    (WS-RESPONSE)
 16708*    END-EXEC
 16709     MOVE 'ERCHEK' TO DFHEIV1
 16710*    MOVE '&(                    &  N#00014577' TO DFHEIV0
 16711     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 303
* EL6311.cbl
 16712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16713     MOVE X'204E233030303134353737' TO DFHEIV0(25:11)
 16714     CALL 'kxdfhei1' USING DFHEIV0,
 16715           DFHEIV1,
 16716           DFHEIV99,
 16717           DFHEIV99,
 16718           DFHEIV99,
 16719           DFHEIV99
 16720     MOVE EIBRESP  TO WS-RESPONSE
 16721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16722
 16723     .
 16724 2540-exit.
 16725     exit.
 16726***************************************************************
 16727*                                                             *
 16728*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16729*                                                             *
 16730***************************************************************
 16731
 16732***************************************************************
 16733*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16734*     AN ALREADY BILLED RECORD.                               *
 16735***************************************************************
 16736
 16737 2700-BUILD-CORRECTION-RECORD.
 16738     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16739     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16740     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16741     MOVE '5'                    TO DC-OPTION-CODE.
 16742     PERFORM 9700-DATE-LINK.
 16743     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16744
 16745     IF PB-CHG-COUNT = ZEROS
 16746        MOVE +1                  TO WS-SEQ-SAVE
 16747     ELSE
 16748        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16749
 16750     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16751     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16752
 16753     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16754
 16755     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16756     MOVE 'A'                    TO JP-RECORD-TYPE.
 16757     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16758
 16759
 16760* EXEC CICS WRITE
 16761*        DATASET    (FILE-ID-ERPNDB)
 16762*        FROM       (PENDING-BUSINESS)
 16763*        RIDFLD     (PB-CONTROL-PRIMARY)
 16764*    END-EXEC.
 16765     MOVE LENGTH OF
 16766      PENDING-BUSINESS
 16767       TO DFHEIV11
 16768*    MOVE '&$ L                  ''   #00014618' TO DFHEIV0
 16769     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 304
* EL6311.cbl
 16770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16771     MOVE X'2020233030303134363138' TO DFHEIV0(25:11)
 16772     CALL 'kxdfhei1' USING DFHEIV0,
 16773           FILE-ID-ERPNDB,
 16774           PENDING-BUSINESS,
 16775           DFHEIV11,
 16776           PB-CONTROL-PRIMARY,
 16777           DFHEIV99,
 16778           DFHEIV99
 16779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16780
 16781
 16782     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16783
 16784     PERFORM 8400-LOG-JOURNAL-RECORD.
 16785
 16786 2799-EXIT.
 16787      EXIT.
 16788
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 305
* EL6311.cbl
 16790
 16791******************************************************************
 16792*                                                                *
 16793*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16794*                                                                *
 16795******************************************************************
 16796
 16797 2800-REWRITE-ISSUE-CERT-KEY.
 16798     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16799
 16800     IF  BCERTNOL GREATER THAN ZEROS
 16801         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16802
 16803     IF  BSUFIXL  GREATER THAN ZEROS
 16804         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16805
 16806     IF  BEFFDTL  GREATER THAN ZEROS
 16807         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16808
 16809 2810-READ-BY-ACCOUNT.
 16810
 16811* EXEC CICS HANDLE CONDITION
 16812*         NOTFND    (2820-PROCESS-REWRITE)
 16813*    END-EXEC.
 16814*    MOVE '"$I                   ! = #00014652' TO DFHEIV0
 16815     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16817     MOVE X'3D20233030303134363532' TO DFHEIV0(25:11)
 16818     CALL 'kxdfhei1' USING DFHEIV0
 16819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16820
 16821
 16822
 16823* EXEC CICS READ
 16824*        SET     (ADDRESS OF PENDING-BUSINESS)
 16825*        DATASET (FILE-ID-ERPNDB2)
 16826*        RIDFLD  (ERPNDB-ALT-KEY)
 16827*    END-EXEC.
 16828*    MOVE '&"S        E          (   #00014656' TO DFHEIV0
 16829     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16831     MOVE X'2020233030303134363536' TO DFHEIV0(25:11)
 16832     CALL 'kxdfhei1' USING DFHEIV0,
 16833           FILE-ID-ERPNDB2,
 16834           DFHEIV20,
 16835           DFHEIV99,
 16836           ERPNDB-ALT-KEY,
 16837           DFHEIV99,
 16838           DFHEIV99,
 16839           DFHEIV99
 16840     SET ADDRESS OF PENDING-BUSINESS TO
 16841         DFHEIV20
 16842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16843
 16844
 16845     GO TO 2890-DUPLICATE-RECORD.
 16846
 16847  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 306
* EL6311.cbl
 16848
 16849* EXEC CICS HANDLE CONDITION
 16850*         NOTFND    (2885-RECORD-MISSING)
 16851*    END-EXEC.
 16852*    MOVE '"$I                   ! > #00014665' TO DFHEIV0
 16853     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16855     MOVE X'3E20233030303134363635' TO DFHEIV0(25:11)
 16856     CALL 'kxdfhei1' USING DFHEIV0
 16857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16858
 16859
 16860     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16861
 16862
 16863* EXEC CICS READ
 16864*        SET     (ADDRESS OF PENDING-BUSINESS)
 16865*        DATASET (FILE-ID-ERPNDB)
 16866*        RIDFLD  (ERPNDB-KEY)
 16867*        UPDATE
 16868*    END-EXEC.
 16869*    MOVE '&"S        EU         (   #00014671' TO DFHEIV0
 16870     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16871     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16872     MOVE X'2020233030303134363731' TO DFHEIV0(25:11)
 16873     CALL 'kxdfhei1' USING DFHEIV0,
 16874           FILE-ID-ERPNDB,
 16875           DFHEIV20,
 16876           DFHEIV99,
 16877           ERPNDB-KEY,
 16878           DFHEIV99,
 16879           DFHEIV99,
 16880           DFHEIV99
 16881     SET ADDRESS OF PENDING-BUSINESS TO
 16882         DFHEIV20
 16883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16884
 16885
 16886     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16887     MOVE 'D'                    TO JP-RECORD-TYPE.
 16888     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16889     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16890
 16891     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16892
 16893     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16894     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16895     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16896
 16897
 16898* EXEC CICS DELETE
 16899*        DATASET    (FILE-ID-ERPNDB)
 16900*    END-EXEC.
 16901*    MOVE '&(                    &   #00014689' TO DFHEIV0
 16902     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16904     MOVE X'2020233030303134363839' TO DFHEIV0(25:11)
 16905     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 307
* EL6311.cbl
 16906           FILE-ID-ERPNDB,
 16907           DFHEIV99,
 16908           DFHEIV99,
 16909           DFHEIV99,
 16910           DFHEIV99
 16911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16912
 16913
 16914     PERFORM 8400-LOG-JOURNAL-RECORD.
 16915
 16916
 16917* EXEC CICS GETMAIN
 16918*        SET      (ADDRESS OF PENDING-BUSINESS)
 16919*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16920*        INITIMG  (GETMAIN-SPACE)
 16921*    END-EXEC.
 16922*    MOVE ',"IL                  $   #00014695' TO DFHEIV0
 16923     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16925     MOVE X'2020233030303134363935' TO DFHEIV0(25:11)
 16926     CALL 'kxdfhei1' USING DFHEIV0,
 16927           DFHEIV20,
 16928           ERPNDB-RECORD-LENGTH,
 16929           GETMAIN-SPACE
 16930     SET ADDRESS OF PENDING-BUSINESS TO
 16931         DFHEIV20
 16932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16933
 16934
 16935     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16936
 16937
 16938* EXEC CICS HANDLE CONDITION
 16939*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16940*    END-EXEC.
 16941*    MOVE '"$I                   ! ? #00014703' TO DFHEIV0
 16942     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16944     MOVE X'3F20233030303134373033' TO DFHEIV0(25:11)
 16945     CALL 'kxdfhei1' USING DFHEIV0
 16946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16947
 16948
 16949
 16950* EXEC CICS READ
 16951*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16952*        DATASET (FILE-ID-ELCERT)
 16953*        RIDFLD  (ELCERT-KEY)
 16954*        UPDATE
 16955*    END-EXEC.
 16956*    MOVE '&"S        EU         (   #00014707' TO DFHEIV0
 16957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16958     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16959     MOVE X'2020233030303134373037' TO DFHEIV0(25:11)
 16960     CALL 'kxdfhei1' USING DFHEIV0,
 16961           FILE-ID-ELCERT,
 16962           DFHEIV20,
 16963           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 308
* EL6311.cbl
 16964           ELCERT-KEY,
 16965           DFHEIV99,
 16966           DFHEIV99,
 16967           DFHEIV99
 16968     SET ADDRESS OF CERTIFICATE-MASTER TO
 16969         DFHEIV20
 16970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16971
 16972
 16973     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16974     MOVE 'B'                    TO JP-RECORD-TYPE
 16975     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16976     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16977
 16978     IF INSURED-ADDR-PRESENT
 16979        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16980
 16981     IF CERT-NOTES-ARE-NOT-PRESENT
 16982        MOVE SPACE               TO WS-CERT-NOTE-SW
 16983     ELSE
 16984        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16985
 16986     IF CERT-ADDED-BATCH      OR
 16987        CERT-AND-CLAIM-ONLINE OR
 16988        CERT-WAS-CREATED-FOR-CLAIM
 16989        NEXT SENTENCE
 16990     ELSE
 16991        GO TO 2825-DELETE-CERTIFICATE.
 16992
 16993     PERFORM 8400-LOG-JOURNAL-RECORD.
 16994
 16995*********************************************************
 16996** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16997     IF CERT-ADDED-BATCH
 16998         GO TO 2822-REWRITE-ELCERT.
 16999*********************************************************
 17000
 17001     IF NO-CLAIM-ATTACHED
 17002        NEXT SENTENCE
 17003     ELSE
 17004        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17005        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17006
 17007 2822-REWRITE-ELCERT.
 17008     MOVE 'C'                    TO JP-RECORD-TYPE
 17009     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17010
 17011     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17012
 17013
 17014* EXEC CICS REWRITE
 17015*         DATASET    (FILE-ID-ELCERT)
 17016*         FROM       (CERTIFICATE-MASTER)
 17017*    END-EXEC.
 17018     MOVE LENGTH OF
 17019      CERTIFICATE-MASTER
 17020       TO DFHEIV11
 17021*    MOVE '&& L                  %   #00014754' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 309
* EL6311.cbl
 17022     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17023     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17024     MOVE X'2020233030303134373534' TO DFHEIV0(25:11)
 17025     CALL 'kxdfhei1' USING DFHEIV0,
 17026           FILE-ID-ELCERT,
 17027           CERTIFICATE-MASTER,
 17028           DFHEIV11,
 17029           DFHEIV99
 17030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17031
 17032
 17033     PERFORM 8400-LOG-JOURNAL-RECORD.
 17034
 17035     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17036
 17037 2825-DELETE-CERTIFICATE.
 17038     MOVE 'D'                      TO JP-RECORD-TYPE.
 17039     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17040
 17041     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17042
 17043
 17044* EXEC CICS DELETE
 17045*         DATASET    (FILE-ID-ELCERT)
 17046*    END-EXEC.
 17047*    MOVE '&(                    &   #00014769' TO DFHEIV0
 17048     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17049     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17050     MOVE X'2020233030303134373639' TO DFHEIV0(25:11)
 17051     CALL 'kxdfhei1' USING DFHEIV0,
 17052           FILE-ID-ELCERT,
 17053           DFHEIV99,
 17054           DFHEIV99,
 17055           DFHEIV99,
 17056           DFHEIV99
 17057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17058
 17059
 17060     PERFORM 8400-LOG-JOURNAL-RECORD.
 17061
 17062******************************************************************
 17063*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17064******************************************************************
 17065
 17066     IF CERT-NOTES-ARE-PRESENT
 17067        NEXT SENTENCE
 17068     ELSE
 17069        GO TO 2827-DELETE-MAILING.
 17070
 17071
 17072* EXEC CICS HANDLE CONDITION
 17073*         NOTFND  (2827-DELETE-MAILING)
 17074*    END-EXEC.
 17075*    MOVE '"$I                   ! @ #00014784' TO DFHEIV0
 17076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17078     MOVE X'4020233030303134373834' TO DFHEIV0(25:11)
 17079     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 310
* EL6311.cbl
 17080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17081
 17082
 17083
 17084* EXEC CICS READ
 17085*        EQUAL
 17086*        DATASET   (FILE-ID-ERNOTE)
 17087*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17088*        RIDFLD    (ELCERT-KEY)
 17089*        UPDATE
 17090*    END-EXEC.
 17091*    MOVE '&"S        EU         (   #00014788' TO DFHEIV0
 17092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17093     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17094     MOVE X'2020233030303134373838' TO DFHEIV0(25:11)
 17095     CALL 'kxdfhei1' USING DFHEIV0,
 17096           FILE-ID-ERNOTE,
 17097           DFHEIV20,
 17098           DFHEIV99,
 17099           ELCERT-KEY,
 17100           DFHEIV99,
 17101           DFHEIV99,
 17102           DFHEIV99
 17103     SET ADDRESS OF CERTIFICATE-NOTE TO
 17104         DFHEIV20
 17105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17106
 17107
 17108     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17109     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17110     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17111
 17112     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17113
 17114
 17115* EXEC CICS DELETE
 17116*        DATASET   (FILE-ID-ERNOTE)
 17117*    END-EXEC.
 17118*    MOVE '&(                    &   #00014802' TO DFHEIV0
 17119     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17121     MOVE X'2020233030303134383032' TO DFHEIV0(25:11)
 17122     CALL 'kxdfhei1' USING DFHEIV0,
 17123           FILE-ID-ERNOTE,
 17124           DFHEIV99,
 17125           DFHEIV99,
 17126           DFHEIV99,
 17127           DFHEIV99
 17128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17129
 17130
 17131     PERFORM 8400-LOG-JOURNAL-RECORD.
 17132
 17133******************************************************************
 17134*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17135******************************************************************
 17136
 17137 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 311
* EL6311.cbl
 17138     IF CERT-ADDRESS-PRESENT
 17139        NEXT SENTENCE
 17140     ELSE
 17141        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17142
 17143
 17144* EXEC CICS HANDLE CONDITION
 17145*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17146*    END-EXEC.
 17147*    MOVE '"$I                   ! A #00014818' TO DFHEIV0
 17148     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17150     MOVE X'4120233030303134383138' TO DFHEIV0(25:11)
 17151     CALL 'kxdfhei1' USING DFHEIV0
 17152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17153
 17154
 17155     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17156
 17157
 17158* EXEC CICS READ
 17159*        EQUAL
 17160*        DATASET   (FILE-ID-ERMAIL)
 17161*        SET       (ADDRESS OF MAILING-DATA)
 17162*        RIDFLD    (ERMAIL-KEY)
 17163*        UPDATE
 17164*    END-EXEC.
 17165*    MOVE '&"S        EU         (   #00014824' TO DFHEIV0
 17166     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17168     MOVE X'2020233030303134383234' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0,
 17170           FILE-ID-ERMAIL,
 17171           DFHEIV20,
 17172           DFHEIV99,
 17173           ERMAIL-KEY,
 17174           DFHEIV99,
 17175           DFHEIV99,
 17176           DFHEIV99
 17177     SET ADDRESS OF MAILING-DATA TO
 17178         DFHEIV20
 17179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17180
 17181
 17182     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17183     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17184     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17185
 17186     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17187
 17188
 17189* EXEC CICS DELETE
 17190*        DATASET   (FILE-ID-ERMAIL)
 17191*    END-EXEC.
 17192*    MOVE '&(                    &   #00014838' TO DFHEIV0
 17193     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17194     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17195     MOVE X'2020233030303134383338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 312
* EL6311.cbl
 17196     CALL 'kxdfhei1' USING DFHEIV0,
 17197           FILE-ID-ERMAIL,
 17198           DFHEIV99,
 17199           DFHEIV99,
 17200           DFHEIV99,
 17201           DFHEIV99
 17202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17203
 17204
 17205     PERFORM 8400-LOG-JOURNAL-RECORD.
 17206
 17207 2830-BUILD-NEW-ISSUE-RECORD.
 17208     MOVE SPACES                 TO ELCERT-KEY.
 17209
 17210     IF  BCERTNOL GREATER THAN ZEROS
 17211         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17212
 17213     IF  BSUFIXL  GREATER THAN ZEROS
 17214         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17215
 17216     IF BEFFDTL GREATER THAN ZEROS
 17217        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17218
 17219 2870-WRITE-PENDING-BUSINESS.
 17220     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17221     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17222     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17223     MOVE '5'                    TO DC-OPTION-CODE.
 17224     PERFORM 9700-DATE-LINK.
 17225     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17226
 17227     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17228
 17229     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17230     MOVE 'A'                    TO JP-RECORD-TYPE.
 17231     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17232
 17233
 17234* EXEC CICS WRITE
 17235*        DATASET  (FILE-ID-ERPNDB)
 17236*        FROM     (PENDING-BUSINESS)
 17237*        RIDFLD   (PB-CONTROL-PRIMARY)
 17238*    END-EXEC.
 17239     MOVE LENGTH OF
 17240      PENDING-BUSINESS
 17241       TO DFHEIV11
 17242*    MOVE '&$ L                  ''   #00014870' TO DFHEIV0
 17243     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17244     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17245     MOVE X'2020233030303134383730' TO DFHEIV0(25:11)
 17246     CALL 'kxdfhei1' USING DFHEIV0,
 17247           FILE-ID-ERPNDB,
 17248           PENDING-BUSINESS,
 17249           DFHEIV11,
 17250           PB-CONTROL-PRIMARY,
 17251           DFHEIV99,
 17252           DFHEIV99
 17253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 313
* EL6311.cbl
 17254
 17255
 17256     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17257
 17258     PERFORM 8400-LOG-JOURNAL-RECORD.
 17259
 17260     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17261
 17262 2885-RECORD-MISSING.
 17263     MOVE -1                     TO BMAINTL
 17264     MOVE AL-UABON               TO BMAINTA
 17265     MOVE ER-2902                TO EMI-ERROR.
 17266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17267     GO TO 8200-SEND-DATAONLY.
 17268
 17269 2890-DUPLICATE-RECORD.
 17270     MOVE -1                     TO BMAINTL.
 17271     MOVE AL-UABON               TO BCERTNOA.
 17272     MOVE AL-UNBON               TO BEFFDTA.
 17273     MOVE SPACE                  TO BMAINTI.
 17274
 17275     MOVE 1                      TO EMI-SUB
 17276                                    EMI-SWITCH1
 17277                                    EMI-SWITCH-AREA-1
 17278                                    EMI-SWITCH-AREA-2.
 17279
 17280     MOVE SPACES                 TO EMI-ERROR-LINES.
 17281
 17282
 17283* EXEC CICS SYNCPOINT ROLLBACK
 17284*    END-EXEC.
 17285*    MOVE '6"R                   !   #00014902' TO DFHEIV0
 17286     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17288     MOVE X'2020233030303134393032' TO DFHEIV0(25:11)
 17289     CALL 'kxdfhei1' USING DFHEIV0
 17290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17291
 17292
 17293     MOVE ER-2247                TO EMI-ERROR.
 17294     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17295     GO TO 8200-SEND-DATAONLY.
 17296
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 314
* EL6311.cbl
 17298
 17299******************************************************************
 17300*                                                                *
 17301*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17302*                                                                *
 17303******************************************************************
 17304
 17305 2900-REWRITE-CAN-CERT-KEY.
 17306     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17307
 17308     IF  CCERTNOL GREATER THAN ZEROS
 17309         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17310
 17311     IF  CSUFIXL  GREATER THAN ZEROS
 17312         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17313
 17314     IF  CEFFDTL  GREATER THAN ZEROS
 17315         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17316
 17317 2910-READ-BY-ACCOUNT.
 17318
 17319* EXEC CICS HANDLE CONDITION
 17320*         NOTFND    (2920-PROCESS-REWRITE)
 17321*    END-EXEC.
 17322*    MOVE '"$I                   ! B #00014930' TO DFHEIV0
 17323     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17325     MOVE X'4220233030303134393330' TO DFHEIV0(25:11)
 17326     CALL 'kxdfhei1' USING DFHEIV0
 17327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17328
 17329
 17330
 17331* EXEC CICS READ
 17332*        SET     (ADDRESS OF PENDING-BUSINESS)
 17333*        DATASET (FILE-ID-ERPNDB2)
 17334*        RIDFLD  (ERPNDB-ALT-KEY)
 17335*    END-EXEC.
 17336*    MOVE '&"S        E          (   #00014934' TO DFHEIV0
 17337     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17338     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17339     MOVE X'2020233030303134393334' TO DFHEIV0(25:11)
 17340     CALL 'kxdfhei1' USING DFHEIV0,
 17341           FILE-ID-ERPNDB2,
 17342           DFHEIV20,
 17343           DFHEIV99,
 17344           ERPNDB-ALT-KEY,
 17345           DFHEIV99,
 17346           DFHEIV99,
 17347           DFHEIV99
 17348     SET ADDRESS OF PENDING-BUSINESS TO
 17349         DFHEIV20
 17350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17351
 17352
 17353     GO TO 2990-DUPLICATE-RECORD.
 17354
 17355  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 315
* EL6311.cbl
 17356
 17357* EXEC CICS HANDLE CONDITION
 17358*         NOTFND    (2985-RECORD-MISSING)
 17359*    END-EXEC.
 17360*    MOVE '"$I                   ! C #00014943' TO DFHEIV0
 17361     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17363     MOVE X'4320233030303134393433' TO DFHEIV0(25:11)
 17364     CALL 'kxdfhei1' USING DFHEIV0
 17365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17366
 17367
 17368     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17369
 17370
 17371* EXEC CICS READ
 17372*        SET     (ADDRESS OF PENDING-BUSINESS)
 17373*        DATASET (FILE-ID-ERPNDB)
 17374*        RIDFLD  (ERPNDB-KEY)
 17375*        UPDATE
 17376*    END-EXEC.
 17377*    MOVE '&"S        EU         (   #00014949' TO DFHEIV0
 17378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17379     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17380     MOVE X'2020233030303134393439' TO DFHEIV0(25:11)
 17381     CALL 'kxdfhei1' USING DFHEIV0,
 17382           FILE-ID-ERPNDB,
 17383           DFHEIV20,
 17384           DFHEIV99,
 17385           ERPNDB-KEY,
 17386           DFHEIV99,
 17387           DFHEIV99,
 17388           DFHEIV99
 17389     SET ADDRESS OF PENDING-BUSINESS TO
 17390         DFHEIV20
 17391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17392
 17393
 17394     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17395     MOVE 'D'                    TO JP-RECORD-TYPE.
 17396     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17397     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17398
 17399     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17400
 17401     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17402     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17403     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17404
 17405
 17406* EXEC CICS DELETE
 17407*        DATASET    (FILE-ID-ERPNDB)
 17408*    END-EXEC.
 17409*    MOVE '&(                    &   #00014967' TO DFHEIV0
 17410     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17411     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17412     MOVE X'2020233030303134393637' TO DFHEIV0(25:11)
 17413     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 316
* EL6311.cbl
 17414           FILE-ID-ERPNDB,
 17415           DFHEIV99,
 17416           DFHEIV99,
 17417           DFHEIV99,
 17418           DFHEIV99
 17419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17420
 17421
 17422     PERFORM 8400-LOG-JOURNAL-RECORD.
 17423
 17424
 17425* EXEC CICS GETMAIN
 17426*        SET      (ADDRESS OF PENDING-BUSINESS)
 17427*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17428*        INITIMG  (GETMAIN-SPACE)
 17429*    END-EXEC.
 17430*    MOVE ',"IL                  $   #00014973' TO DFHEIV0
 17431     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17432     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17433     MOVE X'2020233030303134393733' TO DFHEIV0(25:11)
 17434     CALL 'kxdfhei1' USING DFHEIV0,
 17435           DFHEIV20,
 17436           ERPNDB-RECORD-LENGTH,
 17437           GETMAIN-SPACE
 17438     SET ADDRESS OF PENDING-BUSINESS TO
 17439         DFHEIV20
 17440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17441
 17442
 17443     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17444
 17445 2950-PROCESS-CANCELS.
 17446
 17447
 17448* EXEC CICS HANDLE CONDITION
 17449*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17450*    END-EXEC.
 17451*    MOVE '"$I                   ! D #00014983' TO DFHEIV0
 17452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17454     MOVE X'4420233030303134393833' TO DFHEIV0(25:11)
 17455     CALL 'kxdfhei1' USING DFHEIV0
 17456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17457
 17458
 17459
 17460* EXEC CICS READ
 17461*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17462*        DATASET (FILE-ID-ELCERT)
 17463*        RIDFLD  (ELCERT-KEY)
 17464*        UPDATE
 17465*    END-EXEC.
 17466*    MOVE '&"S        EU         (   #00014987' TO DFHEIV0
 17467     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17469     MOVE X'2020233030303134393837' TO DFHEIV0(25:11)
 17470     CALL 'kxdfhei1' USING DFHEIV0,
 17471           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 317
* EL6311.cbl
 17472           DFHEIV20,
 17473           DFHEIV99,
 17474           ELCERT-KEY,
 17475           DFHEIV99,
 17476           DFHEIV99,
 17477           DFHEIV99
 17478     SET ADDRESS OF CERTIFICATE-MASTER TO
 17479         DFHEIV20
 17480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17481
 17482
 17483     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17484
 17485     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17486     MOVE 'B'                      TO JP-RECORD-TYPE.
 17487     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17488     PERFORM 8400-LOG-JOURNAL-RECORD.
 17489
 17490     IF PB-CI-LIVES NOT NUMERIC
 17491         MOVE ZERO                    TO PB-CI-LIVES.
 17492
 17493     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17494        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17495        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17496        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17497                                         CM-LF-CANCEL-DT
 17498     ELSE
 17499        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17500        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17501        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17502        MOVE PB-CI-LIVES              TO CM-LIVES.
 17503
 17504     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17505        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17506            MOVE CM-LF-STATUS-AT-CANCEL
 17507                                     TO CM-LF-CURRENT-STATUS
 17508            MOVE SPACE
 17509                                     TO CM-LF-STATUS-AT-CANCEL
 17510        ELSE
 17511            MOVE PB-CI-LF-POLICY-STATUS
 17512                                     TO CM-LF-CURRENT-STATUS
 17513     ELSE
 17514        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17515
 17516     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17517        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17518        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17519        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17520                                         CM-AH-CANCEL-DT
 17521     ELSE
 17522        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17523        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17524        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17525        MOVE PB-CI-LIVES              TO CM-LIVES.
 17526
 17527     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17528        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17529            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 318
* EL6311.cbl
 17530                                     TO CM-AH-CURRENT-STATUS
 17531            MOVE SPACE
 17532                                     TO CM-AH-STATUS-AT-CANCEL
 17533        ELSE
 17534            MOVE PB-CI-AH-POLICY-STATUS
 17535                                     TO CM-AH-CURRENT-STATUS
 17536     ELSE
 17537        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17538
 17539 2975-REWRITE-CERT.
 17540     MOVE 'C'                      TO JP-RECORD-TYPE.
 17541     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17542
 17543
 17544* EXEC CICS REWRITE
 17545*        DATASET    (FILE-ID-ELCERT)
 17546*        FROM       (CERTIFICATE-MASTER)
 17547*    END-EXEC.
 17548     MOVE LENGTH OF
 17549      CERTIFICATE-MASTER
 17550       TO DFHEIV11
 17551*    MOVE '&& L                  %   #00015054' TO DFHEIV0
 17552     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17553     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17554     MOVE X'2020233030303135303534' TO DFHEIV0(25:11)
 17555     CALL 'kxdfhei1' USING DFHEIV0,
 17556           FILE-ID-ELCERT,
 17557           CERTIFICATE-MASTER,
 17558           DFHEIV11,
 17559           DFHEIV99
 17560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17561
 17562
 17563     PERFORM 8400-LOG-JOURNAL-RECORD.
 17564
 17565 2960-BUILD-NEW-CANCEL-RECORD.
 17566     IF  CCERTNOL GREATER THAN ZEROS
 17567         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17568
 17569     IF  CSUFIXL  GREATER THAN ZEROS
 17570         MOVE CSUFIXI             TO PB-CERT-SFX.
 17571
 17572     IF  CEFFDTL  GREATER  THAN ZEROS
 17573         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17574
 17575 2970-WRITE-PENDING-BUSINESS.
 17576     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17577     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17578     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17579     MOVE '5'                    TO DC-OPTION-CODE.
 17580     PERFORM 9700-DATE-LINK.
 17581     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17582
 17583     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17584
 17585     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17586                                    PB-CI-INSURED-SEX
 17587                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 319
* EL6311.cbl
 17588                                    PB-CI-AH-BENEFIT-CD
 17589                                    PB-CI-RATE-CLASS
 17590                                    PB-CI-RATE-DEV-LF
 17591                                    PB-CI-RATE-DEV-AH
 17592                                    PB-CI-LF-ABBR
 17593                                    PB-CI-AH-ABBR
 17594                                    PB-CI-OB-FLAG
 17595                                    PB-CI-LF-POLICY-STATUS
 17596                                    PB-CI-AH-POLICY-STATUS
 17597                                    PB-CI-INDV-GRP-CD
 17598                                    PB-CI-BENEFICIARY-NAME
 17599                                    PB-CI-NOTE-SW
 17600                                    PB-CI-SOC-SEC-NO
 17601                                    PB-CI-MEMBER-NO
 17602                                    PB-CI-INT-CODE
 17603                                    PB-CI-COMP-EXCP-SW
 17604                                    PB-CI-ENTRY-STATUS
 17605                                    PB-CI-CREDIT-INTERFACE-SW-1
 17606                                    PB-CI-CREDIT-INTERFACE-SW-2
 17607                                    PB-CI-ENTRY-BATCH.
 17608
 17609     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17610                                    PB-CI-AH-SETTLEMENT-DT
 17611                                    PB-CI-DEATH-DT
 17612                                    PB-CI-LF-PRIOR-CANCEL-DT
 17613                                    PB-CI-AH-PRIOR-CANCEL-DT
 17614                                    PB-CI-LOAN-1ST-PMT-DT
 17615                                    PB-CI-ENTRY-DT
 17616                                    PB-CI-LF-EXPIRE-DT
 17617                                    PB-CI-AH-EXPIRE-DT.
 17618
 17619     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17620                                    PB-CI-LF-TERM
 17621                                    PB-CI-LF-BENEFIT-AMT
 17622                                    PB-CI-LF-ALT-BENEFIT-AMT
 17623                                    PB-CI-LF-PREMIUM-AMT
 17624                                    PB-CI-LF-ALT-PREMIUM-AMT
 17625                                    PB-CI-AH-TERM
 17626                                    PB-CI-AH-BENEFIT-AMT
 17627                                    PB-CI-AH-PREMIUM-AMT
 17628                                    PB-CI-RATE-DEV-PCT-LF
 17629                                    PB-CI-RATE-DEV-PCT-AH
 17630                                    PB-CI-LIFE-COMMISSION
 17631                                    PB-CI-AH-COMMISSION
 17632                                    PB-CI-PAY-FREQUENCY
 17633                                    PB-CI-LOAN-APR
 17634                                    PB-CI-LOAN-TERM
 17635                                    PB-CI-CURR-SEQ
 17636                                    PB-CI-AH-CANCEL-AMT
 17637                                    PB-CI-LF-CANCEL-AMT
 17638                                    PB-CI-EXTENTION-DAYS
 17639                                    PB-CI-TERM-IN-DAYS
 17640                                    PB-CI-LOAN-OFFICER
 17641                                    PB-CI-LIVES
 17642                                    PB-CI-LF-CRIT-PER
 17643                                    PB-CI-AH-CRIT-PER
 17644                                    PB-C-LF-REM-TERM
 17645                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 320
* EL6311.cbl
 17646
 17647     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17648     MOVE 'A'                    TO JP-RECORD-TYPE.
 17649     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17650
 17651
 17652* EXEC CICS HANDLE CONDITION
 17653*        DUPREC   (2990-DUPLICATE-RECORD)
 17654*    END-EXEC.
 17655*    MOVE '"$%                   ! E #00015147' TO DFHEIV0
 17656     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17658     MOVE X'4520233030303135313437' TO DFHEIV0(25:11)
 17659     CALL 'kxdfhei1' USING DFHEIV0
 17660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17661
 17662
 17663
 17664* EXEC CICS WRITE
 17665*        DATASET  (FILE-ID-ERPNDB)
 17666*        FROM     (PENDING-BUSINESS)
 17667*        RIDFLD   (PB-CONTROL-PRIMARY)
 17668*    END-EXEC.
 17669     MOVE LENGTH OF
 17670      PENDING-BUSINESS
 17671       TO DFHEIV11
 17672*    MOVE '&$ L                  ''   #00015151' TO DFHEIV0
 17673     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17674     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17675     MOVE X'2020233030303135313531' TO DFHEIV0(25:11)
 17676     CALL 'kxdfhei1' USING DFHEIV0,
 17677           FILE-ID-ERPNDB,
 17678           PENDING-BUSINESS,
 17679           DFHEIV11,
 17680           PB-CONTROL-PRIMARY,
 17681           DFHEIV99,
 17682           DFHEIV99
 17683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17684
 17685
 17686     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17687
 17688     PERFORM 8400-LOG-JOURNAL-RECORD.
 17689
 17690     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17691
 17692 2985-RECORD-MISSING.
 17693     MOVE -1                     TO CMAINTL
 17694     MOVE AL-UABON               TO CMAINTA.
 17695
 17696     MOVE ER-2902                TO EMI-ERROR.
 17697     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17698     GO TO 8200-SEND-DATAONLY.
 17699
 17700 2990-DUPLICATE-RECORD.
 17701     MOVE SPACE                  TO CMAINTI.
 17702     MOVE -1                     TO CMAINTL.
 17703     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 321
* EL6311.cbl
 17704     MOVE AL-UNBON               TO CEFFDTA.
 17705
 17706     MOVE 1                      TO EMI-SUB
 17707                                    EMI-SWITCH1
 17708                                    EMI-SWITCH-AREA-1
 17709                                    EMI-SWITCH-AREA-2.
 17710     MOVE SPACES                 TO EMI-ERROR-LINES.
 17711
 17712
 17713* EXEC CICS SYNCPOINT ROLLBACK
 17714*    END-EXEC.
 17715*    MOVE '6"R                   !   #00015183' TO DFHEIV0
 17716     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17717     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17718     MOVE X'2020233030303135313833' TO DFHEIV0(25:11)
 17719     CALL 'kxdfhei1' USING DFHEIV0
 17720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17721
 17722
 17723     MOVE ER-2247                TO EMI-ERROR.
 17724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17725     GO TO 8200-SEND-DATAONLY.
 17726
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 322
* EL6311.cbl
 17728
 17729***************************************************************
 17730*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17731*     PREMIUM FOR A SINGLE BATCH.                             *
 17732*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17733***************************************************************
 17734
 17735 3000-BATCH-MAINLINE.
 17736     IF PI-PREV-KEY NOT = SPACES
 17737         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17738     ELSE
 17739         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17740
 17741     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17742
 17743 3010-READNEXT.
 17744
 17745* EXEC CICS READ
 17746*         DATASET    (FILE-ID-ERPNDB)
 17747*         SET        (ADDRESS OF PENDING-BUSINESS)
 17748*         RIDFLD     (ERPNDB-KEY)
 17749*         GTEQ
 17750*    END-EXEC.
 17751*    MOVE '&"S        G          (   #00015207' TO DFHEIV0
 17752     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17754     MOVE X'2020233030303135323037' TO DFHEIV0(25:11)
 17755     CALL 'kxdfhei1' USING DFHEIV0,
 17756           FILE-ID-ERPNDB,
 17757           DFHEIV20,
 17758           DFHEIV99,
 17759           ERPNDB-KEY,
 17760           DFHEIV99,
 17761           DFHEIV99,
 17762           DFHEIV99
 17763     SET ADDRESS OF PENDING-BUSINESS TO
 17764         DFHEIV20
 17765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17766
 17767
 17768     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17769        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17770          GO TO 3030-END-BATCH.
 17771
 17772     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17773
 17774     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17775        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17776          GO TO 3020-BUMP-SEQ.
 17777
 17778     IF PB-ISSUE
 17779        ADD +1                   TO WS-ISS-TOTAL-CNT
 17780        IF PB-FATAL-ERRORS
 17781           ADD +1                      TO WS-ISS-FATAL-CNT
 17782           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17783           GO TO 3020-BUMP-SEQ
 17784        ELSE
 17785           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 323
* EL6311.cbl
 17786              ADD +1                      TO WS-ISS-FORCE-CNT
 17787              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17788              GO TO 3020-BUMP-SEQ
 17789           ELSE
 17790              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17791                 ADD +1                      TO WS-ISS-HOLD-CNT
 17792                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17793                 GO TO 3020-BUMP-SEQ
 17794              ELSE
 17795                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17796                     THRU  3299-EXIT
 17797                 GO TO 3020-BUMP-SEQ.
 17798
 17799     IF PB-CANCELLATION
 17800        ADD +1                   TO WS-CAN-TOTAL-CNT
 17801        IF PB-FATAL-ERRORS
 17802           ADD +1                 TO WS-CAN-FATAL-CNT
 17803           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17804           GO TO 3020-BUMP-SEQ
 17805        ELSE
 17806           IF PB-UNFORCED-ERRORS
 17807              ADD +1                 TO WS-CAN-FORCE-CNT
 17808              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17809              GO TO 3020-BUMP-SEQ
 17810           ELSE
 17811              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17812                 ADD +1                 TO WS-CAN-HOLD-CNT
 17813                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17814                 GO TO 3020-BUMP-SEQ
 17815              ELSE
 17816                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17817                     THRU  3499-EXIT
 17818                 GO TO 3020-BUMP-SEQ.
 17819
 17820     IF PB-BATCH-TRAILER
 17821         GO TO 3030-END-BATCH.
 17822
 17823 3020-BUMP-SEQ.
 17824     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17825     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17826     GO TO 3010-READNEXT.
 17827
 17828 3030-END-BATCH.
 17829     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17830     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17831     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17832     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17833
 17834     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17835                                          - WS-ISS-FORCE-CNT
 17836                                          - WS-ISS-HOLD-CNT).
 17837
 17838     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17839     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17840
 17841     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17842     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17843     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 324
* EL6311.cbl
 17844     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17845     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17846                                          - WS-CAN-FORCE-CNT
 17847                                          - WS-CAN-HOLD-CNT).
 17848     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17849     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17850
 17851     COMPUTE WS-NET-TOTAL-CNT
 17852         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17853     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17854     COMPUTE WS-NET-FATAL-CNT
 17855         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17856     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17857     COMPUTE WS-NET-FORCE-CNT
 17858         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17859     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17860     COMPUTE WS-NET-HOLD-CNT
 17861         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17862     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17863
 17864     COMPUTE WS-NET-AVAIL-CNT
 17865          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17866                              - WS-ISS-FORCE-CNT
 17867                              - WS-ISS-HOLD-CNT)
 17868          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17869                              - WS-CAN-FORCE-CNT
 17870                              - WS-CAN-HOLD-CNT).
 17871     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17872
 17873     COMPUTE WS-NET-GOOD-PREM
 17874         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17875     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17876     COMPUTE WS-NET-BAD-PREM
 17877         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17878     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17879
 17880     MOVE 0000                   TO EMI-ERROR.
 17881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17882     MOVE -1                     TO DPFENTRL.
 17883     GO TO 8200-SEND-DATAONLY.
 17884
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 325
* EL6311.cbl
 17886
 17887******************************************************************
 17888*                                                                *
 17889*           A D D    B A D   I S S U E   P R E M I U M           *
 17890*                                                                *
 17891******************************************************************
 17892
 17893 3100-ADD-BAD-ISSUE-PREM.
 17894     IF PB-OVERRIDE-LIFE
 17895       OR PB-OVERRIDE-BOTH
 17896           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17897           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17898       ELSE
 17899           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17900           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17901
 17902     IF PB-OVERRIDE-AH
 17903       OR PB-OVERRIDE-BOTH
 17904           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17905       ELSE
 17906           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17907
 17908 3199-EXIT.
 17909     EXIT.
 17910
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 326
* EL6311.cbl
 17912
 17913******************************************************************
 17914*                                                                *
 17915*       A D D   G O O D   I S S U E   P R E M I U M              *
 17916*                                                                *
 17917******************************************************************
 17918
 17919 3200-ADD-GOOD-ISSUE-PREM.
 17920     IF PB-OVERRIDE-LIFE
 17921       OR PB-OVERRIDE-BOTH
 17922           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17923           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17924       ELSE
 17925           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17926           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17927
 17928     IF PB-OVERRIDE-AH
 17929       OR PB-OVERRIDE-BOTH
 17930           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17931       ELSE
 17932           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17933
 17934 3299-EXIT.
 17935     EXIT.
 17936
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 327
* EL6311.cbl
 17938
 17939
 17940******************************************************************
 17941*                                                                *
 17942*        A D D   B A D   C A N C E L   P R E M I U M             *
 17943*                                                                *
 17944******************************************************************
 17945
 17946 3300-ADD-BAD-CANCEL-PREM.
 17947     IF PB-OVERRIDE-LIFE
 17948       OR PB-OVERRIDE-BOTH
 17949           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17950       ELSE
 17951           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17952
 17953     IF PB-OVERRIDE-AH
 17954       OR PB-OVERRIDE-BOTH
 17955           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17956       ELSE
 17957           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17958
 17959 3399-EXIT.
 17960     EXIT.
 17961
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 328
* EL6311.cbl
 17963
 17964******************************************************************
 17965*                                                                *
 17966*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17967*                                                                *
 17968******************************************************************
 17969
 17970 3400-ADD-GOOD-CANCEL-PREM.
 17971     IF PB-OVERRIDE-LIFE
 17972       OR PB-OVERRIDE-BOTH
 17973           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17974       ELSE
 17975           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17976
 17977     IF PB-OVERRIDE-AH
 17978       OR PB-OVERRIDE-BOTH
 17979           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17980       ELSE
 17981           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17982
 17983 3499-EXIT.
 17984     EXIT.
 17985
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 329
* EL6311.cbl
 17987
 17988******************************************************************
 17989*                                                                *
 17990*           E D I T   B A T C H   D A T A                        *
 17991*                                                                *
 17992******************************************************************
 17993
 17994 3500-EDIT-BATCH-DATA.
 17995     IF PI-PREV-KEY NOT = SPACES
 17996        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17997     ELSE
 17998        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17999
 18000     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18001     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18002
 18003
 18004* EXEC CICS HANDLE CONDITION
 18005*         NOTFND      (3590-NOT-FOUND)
 18006*    END-EXEC.
 18007*    MOVE '"$I                   ! F #00015449' TO DFHEIV0
 18008     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18010     MOVE X'4620233030303135343439' TO DFHEIV0(25:11)
 18011     CALL 'kxdfhei1' USING DFHEIV0
 18012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18013
 18014
 18015     IF DRISSL   GREATER THAN ZEROS OR
 18016        DRISSL   GREATER THAN ZEROS OR
 18017        DRLFPRML GREATER THAN ZEROS OR
 18018        DRAHPRML GREATER THAN ZEROS OR
 18019        DRCANCL  GREATER THAN ZEROS OR
 18020        DRLFRFDL GREATER THAN ZEROS OR
 18021        DRAHRFDL GREATER THAN ZEROS
 18022              NEXT SENTENCE
 18023          ELSE
 18024              MOVE ER-3224    TO EMI-ERROR
 18025              MOVE -1         TO DPFENTRL
 18026              MOVE AL-UNBON   TO DPFENTRA
 18027              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18028              GO TO 8200-SEND-DATAONLY.
 18029
 18030     IF NOT MODIFY-CAP
 18031         MOVE 'UPDATE'       TO SM-READ
 18032         PERFORM 9995-SECURITY-VIOLATION
 18033         MOVE ER-0070        TO EMI-ERROR
 18034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18035         GO TO 8100-SEND-INITIAL-MAP.
 18036
 18037        IF DRISSL GREATER THAN ZEROS
 18038           MOVE AL-UNNON         TO DRISSA
 18039           MOVE DRISSI           TO DEEDIT-FIELD
 18040           PERFORM 8600-DEEDIT
 18041           IF DEEDIT-FIELD-V0  NUMERIC
 18042              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18043           ELSE
 18044              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 330
* EL6311.cbl
 18045              MOVE -1         TO DRISSL
 18046              MOVE AL-UNBON   TO DRISSA
 18047              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18048
 18049        IF DRLFPRML GREATER THAN ZEROS
 18050           MOVE AL-UNNON         TO DRLFPRMA
 18051
 18052* EXEC CICS BIF DEEDIT
 18053*              FIELD  (DRLFPRMI)
 18054*              LENGTH (11)
 18055*          END-EXEC
 18056     MOVE 11
 18057       TO DFHEIV11
 18058*    MOVE '@"L                   #   #00015489' TO DFHEIV0
 18059     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18060     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18061     MOVE X'2020233030303135343839' TO DFHEIV0(25:11)
 18062     CALL 'kxdfhei1' USING DFHEIV0,
 18063           DRLFPRMI,
 18064           DFHEIV11
 18065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18066           IF DRLFPRMI NUMERIC
 18067              MOVE DRLFPRMI   TO WS-DRLFPRM
 18068*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18069*          PERFORM 8600-DEEDIT
 18070*          IF DEEDIT-FIELD-V2  NUMERIC
 18071*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18072           ELSE
 18073              MOVE ER-2223    TO EMI-ERROR
 18074              MOVE -1         TO DRLFPRML
 18075              MOVE AL-UNBON   TO DRLFPRMA
 18076              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18077
 18078        IF DRAHPRML GREATER THAN ZEROS
 18079           MOVE AL-UNNON         TO DRAHPRMA
 18080
 18081* EXEC CICS BIF DEEDIT
 18082*              FIELD  (DRAHPRMI)
 18083*              LENGTH (11)
 18084*          END-EXEC
 18085     MOVE 11
 18086       TO DFHEIV11
 18087*    MOVE '@"L                   #   #00015507' TO DFHEIV0
 18088     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18089     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18090     MOVE X'2020233030303135353037' TO DFHEIV0(25:11)
 18091     CALL 'kxdfhei1' USING DFHEIV0,
 18092           DRAHPRMI,
 18093           DFHEIV11
 18094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18095           IF DRAHPRMI NUMERIC
 18096              MOVE DRAHPRMI   TO WS-DRAHPRM
 18097*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18098*          PERFORM 8600-DEEDIT
 18099*          IF DEEDIT-FIELD-V2  NUMERIC
 18100*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18101           ELSE
 18102              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 331
* EL6311.cbl
 18103              MOVE -1         TO DRAHPRML
 18104              MOVE AL-UNBON   TO DRAHPRMA
 18105              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18106
 18107        IF DRCANCL GREATER THAN ZEROS
 18108           MOVE AL-UNNON         TO DRCANCA
 18109           MOVE DRCANCI          TO DEEDIT-FIELD
 18110           PERFORM 8600-DEEDIT
 18111           IF DEEDIT-FIELD-V0  NUMERIC
 18112              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18113           ELSE
 18114              MOVE ER-2223    TO EMI-ERROR
 18115              MOVE -1         TO DRCANCL
 18116              MOVE AL-UNBON   TO DRCANCL
 18117              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18118
 18119        IF DRLFRFDL GREATER THAN ZEROS
 18120           MOVE AL-UNNON         TO DRLFRFDA
 18121
 18122* EXEC CICS BIF DEEDIT
 18123*              FIELD  (DRLFRFDI)
 18124*              LENGTH (11)
 18125*          END-EXEC
 18126     MOVE 11
 18127       TO DFHEIV11
 18128*    MOVE '@"L                   #   #00015537' TO DFHEIV0
 18129     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18130     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18131     MOVE X'2020233030303135353337' TO DFHEIV0(25:11)
 18132     CALL 'kxdfhei1' USING DFHEIV0,
 18133           DRLFRFDI,
 18134           DFHEIV11
 18135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18136           IF DRLFRFDI NUMERIC
 18137              MOVE DRLFRFDI   TO WS-DRLFRFD
 18138*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18139*          PERFORM 8600-DEEDIT
 18140*          IF DEEDIT-FIELD-V2  NUMERIC
 18141*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18142           ELSE
 18143              MOVE ER-2223    TO EMI-ERROR
 18144              MOVE -1         TO DRLFRFDL
 18145              MOVE AL-UNBON   TO DRLFRFDA
 18146              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18147
 18148        IF DRAHRFDL GREATER THAN ZEROS
 18149           MOVE AL-UNNON         TO DRAHRFDA
 18150
 18151* EXEC CICS BIF DEEDIT
 18152*              FIELD  (DRAHRFDI)
 18153*              LENGTH (11)
 18154*          END-EXEC
 18155     MOVE 11
 18156       TO DFHEIV11
 18157*    MOVE '@"L                   #   #00015555' TO DFHEIV0
 18158     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18159     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18160     MOVE X'2020233030303135353535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 332
* EL6311.cbl
 18161     CALL 'kxdfhei1' USING DFHEIV0,
 18162           DRAHRFDI,
 18163           DFHEIV11
 18164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18165           IF DRAHRFDI NUMERIC
 18166              MOVE DRAHRFDI   TO WS-DRAHRFD
 18167*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18168*          PERFORM 8600-DEEDIT
 18169*          IF DEEDIT-FIELD-V2  NUMERIC
 18170*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18171           ELSE
 18172              MOVE ER-2223    TO EMI-ERROR
 18173              MOVE -1         TO DRAHRFDL
 18174              MOVE AL-UNBON   TO DRAHRFDA
 18175              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18176
 18177     IF EMI-ERROR = ZEROS
 18178        GO 3600-UPDATE-BATCH-HEADER.
 18179
 18180     GO TO 8200-SEND-DATAONLY.
 18181
 18182 3590-NOT-FOUND.
 18183     MOVE ER-2192                TO EMI-ERROR.
 18184     MOVE -1                     TO DPFENTRL.
 18185     MOVE AL-UNBON               TO DPFENTRA.
 18186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18187     GO TO 8200-SEND-DATAONLY.
 18188
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 333
* EL6311.cbl
 18190
 18191******************************************************************
 18192*                                                                *
 18193*           U P D A T E   B A T C H   H E A D E R                *
 18194*                                                                *
 18195******************************************************************
 18196
 18197 3600-UPDATE-BATCH-HEADER.
 18198
 18199* EXEC CICS HANDLE CONDITION
 18200*         NOTFND      (3690-NOT-FOUND)
 18201*    END-EXEC.
 18202*    MOVE '"$I                   ! G #00015592' TO DFHEIV0
 18203     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18205     MOVE X'4720233030303135353932' TO DFHEIV0(25:11)
 18206     CALL 'kxdfhei1' USING DFHEIV0
 18207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18208
 18209
 18210
 18211* EXEC CICS READ
 18212*        DATASET (FILE-ID-ERPNDB)
 18213*        RIDFLD  (ERPNDB-KEY)
 18214*        SET     (ADDRESS OF PENDING-BUSINESS)
 18215*        UPDATE
 18216*    END-EXEC.
 18217*    MOVE '&"S        EU         (   #00015596' TO DFHEIV0
 18218     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18219     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18220     MOVE X'2020233030303135353936' TO DFHEIV0(25:11)
 18221     CALL 'kxdfhei1' USING DFHEIV0,
 18222           FILE-ID-ERPNDB,
 18223           DFHEIV20,
 18224           DFHEIV99,
 18225           ERPNDB-KEY,
 18226           DFHEIV99,
 18227           DFHEIV99,
 18228           DFHEIV99
 18229     SET ADDRESS OF PENDING-BUSINESS TO
 18230         DFHEIV20
 18231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18232
 18233
 18234     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18235     MOVE 'B'                    TO JP-RECORD-TYPE.
 18236     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18237
 18238     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18239
 18240     PERFORM 8400-LOG-JOURNAL-RECORD.
 18241
 18242     IF DRISSL GREATER THAN ZEROS
 18243        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18244
 18245     IF DRCANCL GREATER THAN ZEROS
 18246        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18247
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 334
* EL6311.cbl
 18248
 18249     IF DRLFPRML GREATER THAN ZEROS
 18250        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18251
 18252     IF DRAHPRML GREATER THAN ZEROS
 18253        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18254
 18255     IF DRLFRFDL GREATER THAN ZEROS
 18256        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18257
 18258     IF DRAHRFDL GREATER THAN ZEROS
 18259        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18260
 18261 3670-REWRITE-BATCH-HEADER.
 18262     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18263        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18264        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18265        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18266        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18267        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18268        MOVE SPACE               TO PB-OUT-BAL-CD
 18269     ELSE
 18270        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18271
 18272     MOVE 'C'                    TO JP-RECORD-TYPE.
 18273     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18274
 18275
 18276* EXEC CICS REWRITE
 18277*         DATASET      (FILE-ID-ERPNDB)
 18278*         FROM         (PENDING-BUSINESS)
 18279*    END-EXEC.
 18280     MOVE LENGTH OF
 18281      PENDING-BUSINESS
 18282       TO DFHEIV11
 18283*    MOVE '&& L                  %   #00015644' TO DFHEIV0
 18284     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18285     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18286     MOVE X'2020233030303135363434' TO DFHEIV0(25:11)
 18287     CALL 'kxdfhei1' USING DFHEIV0,
 18288           FILE-ID-ERPNDB,
 18289           PENDING-BUSINESS,
 18290           DFHEIV11,
 18291           DFHEIV99
 18292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18293
 18294
 18295     PERFORM 8400-LOG-JOURNAL-RECORD.
 18296
 18297     GO TO 7200-DISPLAY-BATCHES.
 18298
 18299 3690-NOT-FOUND.
 18300     MOVE ER-2192                TO EMI-ERROR.
 18301     MOVE -1                     TO DPFENTRL.
 18302     MOVE AL-UNBON               TO DPFENTRA.
 18303     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18304     GO TO 8200-SEND-DATAONLY.
 18305
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 335
* EL6311.cbl
 18307
 18308******************************************************************
 18309*                                                                *
 18310*           R E - D I S P L A Y   R E C O R D                    *
 18311*                                                                *
 18312******************************************************************
 18313
 18314 3900-RE-DISPLAY-RECORD.
 18315
 18316* EXEC CICS HANDLE CONDITION
 18317*         NOTFND   (3990-NOT-FOUND)
 18318*    END-EXEC.
 18319*    MOVE '"$I                   ! H #00015669' TO DFHEIV0
 18320     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18322     MOVE X'4820233030303135363639' TO DFHEIV0(25:11)
 18323     CALL 'kxdfhei1' USING DFHEIV0
 18324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18325
 18326
 18327     IF PI-DISPLAY-ORIGINAL-BATCH
 18328         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18329     ELSE
 18330         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18331
 18332
 18333* EXEC CICS READ
 18334*         DATASET   (FILE-ID)
 18335*         RIDFLD    (PI-PREV-KEY)
 18336*         SET       (ADDRESS OF PENDING-BUSINESS)
 18337*    END-EXEC.
 18338*    MOVE '&"S        E          (   #00015678' TO DFHEIV0
 18339     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18340     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18341     MOVE X'2020233030303135363738' TO DFHEIV0(25:11)
 18342     CALL 'kxdfhei1' USING DFHEIV0,
 18343           FILE-ID,
 18344           DFHEIV20,
 18345           DFHEIV99,
 18346           PI-PREV-KEY,
 18347           DFHEIV99,
 18348           DFHEIV99,
 18349           DFHEIV99
 18350     SET ADDRESS OF PENDING-BUSINESS TO
 18351         DFHEIV20
 18352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18353
 18354
 18355     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18356
 18357     IF PB-ISSUE
 18358         GO TO 7000-DISPLAY-ISSUES.
 18359
 18360     IF PB-CANCELLATION
 18361         GO TO 7100-DISPLAY-CANCELS.
 18362
 18363     IF PB-BATCH-TRAILER
 18364         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 336
* EL6311.cbl
 18365
 18366 3990-NOT-FOUND.
 18367     MOVE LOW-VALUES             TO EL631BI.
 18368
 18369     IF PI-MAP-NAME = EL631B
 18370         MOVE -1                  TO BMAINTL
 18371     ELSE
 18372         MOVE -1                  TO CMAINTL.
 18373
 18374     GO TO 8100-SEND-INITIAL-MAP.
 18375
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 337
* EL6311.cbl
 18377
 18378***************************************************************
 18379*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18380*                                                             *
 18381*      1. START BROWSE WITH                                   *
 18382*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18383*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18384*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18385*                                                             *
 18386*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18387*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18388*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18389*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18390*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18391*               AND IS IT TO BE DISPLAYED.                    *
 18392*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18393*               DISPLAYED.                                    *
 18394*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18395*               DISPLAYED.                                    *
 18396*                                                             *
 18397*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18398*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18399***************************************************************
 18400
 18401 4000-BROWSE-DETAIL-FORWARD.
 18402     IF FIRST-TIME
 18403        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18404     ELSE
 18405        IF SHOW-RECORD
 18406           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18407           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18408           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18409           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18410           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18411        ELSE
 18412           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18413
 18414
 18415* EXEC CICS HANDLE CONDITION
 18416*         NOTFND   (4050-END-RECORDS)
 18417*         ENDFILE  (4050-END-RECORDS)
 18418*    END-EXEC.
 18419*    MOVE '"$I''                  ! I #00015743' TO DFHEIV0
 18420     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18422     MOVE X'4920233030303135373433' TO DFHEIV0(25:11)
 18423     CALL 'kxdfhei1' USING DFHEIV0
 18424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18425
 18426
 18427
 18428* EXEC CICS STARTBR
 18429*         DATASET   (FILE-ID-ERPNDB2)
 18430*         RIDFLD    (ERPNDB-ALT-KEY)
 18431*    END-EXEC.
 18432     MOVE 0
 18433       TO DFHEIV11
 18434*    MOVE '&,         G          &   #00015748' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 338
* EL6311.cbl
 18435     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18436     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18437     MOVE X'2020233030303135373438' TO DFHEIV0(25:11)
 18438     CALL 'kxdfhei1' USING DFHEIV0,
 18439           FILE-ID-ERPNDB2,
 18440           ERPNDB-ALT-KEY,
 18441           DFHEIV99,
 18442           DFHEIV11,
 18443           DFHEIV99
 18444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18445
 18446
 18447     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18448
 18449     IF FIRST-TIME OR SHOW-RECORD
 18450        MOVE SPACE               TO WS-FIRST-TIME-SW
 18451        GO TO 4005-READ-NEXT-RECORD.
 18452
 18453
 18454* EXEC CICS READNEXT
 18455*         DATASET    (FILE-ID-ERPNDB2)
 18456*         SET        (ADDRESS OF PENDING-BUSINESS)
 18457*         RIDFLD     (ERPNDB-ALT-KEY)
 18458*    END-EXEC.
 18459     MOVE 0
 18460       TO DFHEIV11
 18461*    MOVE '&.S                   )   #00015759' TO DFHEIV0
 18462     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18463     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18464     MOVE X'2020233030303135373539' TO DFHEIV0(25:11)
 18465     CALL 'kxdfhei1' USING DFHEIV0,
 18466           FILE-ID-ERPNDB2,
 18467           DFHEIV20,
 18468           DFHEIV99,
 18469           ERPNDB-ALT-KEY,
 18470           DFHEIV99,
 18471           DFHEIV11,
 18472           DFHEIV99,
 18473           DFHEIV99
 18474     SET ADDRESS OF PENDING-BUSINESS TO
 18475         DFHEIV20
 18476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18477
 18478
 18479 4005-READ-NEXT-RECORD.
 18480
 18481* EXEC CICS READNEXT
 18482*         DATASET    (FILE-ID-ERPNDB2)
 18483*         SET        (ADDRESS OF PENDING-BUSINESS)
 18484*         RIDFLD     (ERPNDB-ALT-KEY)
 18485*    END-EXEC.
 18486     MOVE 0
 18487       TO DFHEIV11
 18488*    MOVE '&.S                   )   #00015766' TO DFHEIV0
 18489     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18490     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18491     MOVE X'2020233030303135373636' TO DFHEIV0(25:11)
 18492     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 339
* EL6311.cbl
 18493           FILE-ID-ERPNDB2,
 18494           DFHEIV20,
 18495           DFHEIV99,
 18496           ERPNDB-ALT-KEY,
 18497           DFHEIV99,
 18498           DFHEIV11,
 18499           DFHEIV99,
 18500           DFHEIV99
 18501     SET ADDRESS OF PENDING-BUSINESS TO
 18502         DFHEIV20
 18503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18504
 18505
 18506     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18507
 18508     IF WS-BATCH-PREFIX = '#CL'
 18509        GO TO 4005-READ-NEXT-RECORD.
 18510
 18511     IF SHOW-RECORD
 18512        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18513           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18514           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18515           PB-STATE         NOT = PI-PB-STATE          OR
 18516           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18517           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18518           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18519           GO TO 4050-END-RECORDS
 18520        ELSE
 18521           GO TO 4010-CHECK-REC-TYPE.
 18522
 18523     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18524        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18525        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18526        PB-STATE            NOT = PI-PB-STATE          OR
 18527        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18528        GO TO 4050-END-RECORDS.
 18529
 18530     IF PB-BATCH-TRAILER
 18531        GO TO 4005-READ-NEXT-RECORD.
 18532
 18533     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18534        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18535           GO TO 4005-READ-NEXT-RECORD
 18536        ELSE
 18537           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18538              GO TO 4010-CHECK-REC-TYPE
 18539           ELSE
 18540              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18541                 GO TO 4010-CHECK-REC-TYPE
 18542              ELSE
 18543                 GO TO 4005-READ-NEXT-RECORD.
 18544
 18545     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18546        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18547           GO TO 4005-READ-NEXT-RECORD.
 18548
 18549 4010-CHECK-REC-TYPE.
 18550     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 340
* EL6311.cbl
 18551         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18552             NEXT SENTENCE
 18553         ELSE
 18554             GO TO 4005-READ-NEXT-RECORD.
 18555
 18556     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18557         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18558             NEXT SENTENCE
 18559        ELSE
 18560             GO TO 4005-READ-NEXT-RECORD.
 18561
 18562     IF NOT DISPLAY-CHANGE-RECORDS AND
 18563            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18564        GO TO 4005-READ-NEXT-RECORD.
 18565
 18566     IF DISPLAY-HOLD-RECORDS AND
 18567        NOT PB-RECORD-ON-HOLD
 18568          GO TO 4005-READ-NEXT-RECORD.
 18569
 18570     IF PB-ISSUE
 18571        IF DISPLAY-CHK-REQ-RECORDS
 18572            GO TO 4005-READ-NEXT-RECORD.
 18573
 18574     IF PB-ISSUE
 18575        IF ISSUE-WITH-WARNING
 18576           IF PB-WARNING-ERRORS
 18577              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18578                  GO TO 4005-READ-NEXT-RECORD
 18579              ELSE
 18580                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18581                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18582                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18583                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18584                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18585                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18586                 GO TO 7000-DISPLAY-ISSUES
 18587           ELSE
 18588              GO TO 4005-READ-NEXT-RECORD.
 18589
 18590     IF PB-ISSUE
 18591        IF (ISSUES-IN-ERROR AND
 18592            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18593            ALL-ISSUES
 18594            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18595            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18596            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18597            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18598            MOVE PB-SV-STATE            TO PI-SV-STATE
 18599            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18600            GO TO 7000-DISPLAY-ISSUES
 18601        ELSE
 18602            GO TO 4005-READ-NEXT-RECORD.
 18603
 18604     IF PB-CANCELLATION
 18605        IF DISPLAY-CHK-REQ-RECORDS
 18606           IF PB-C-REFUND-REQUESTED
 18607              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18608              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 341
* EL6311.cbl
 18609              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18610              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18611              MOVE PB-SV-STATE            TO PI-SV-STATE
 18612              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18613              GO TO 7100-DISPLAY-CANCELS
 18614           ELSE
 18615               GO TO 4005-READ-NEXT-RECORD.
 18616
 18617     IF PB-CANCELLATION
 18618        IF CANCEL-WITH-WARNING
 18619           IF PB-WARNING-ERRORS
 18620              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18621                  GO TO 4005-READ-NEXT-RECORD
 18622              ELSE
 18623                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18624                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18625                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18626                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18627                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18628                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18629                 GO TO 7100-DISPLAY-CANCELS
 18630           ELSE
 18631              GO TO 4005-READ-NEXT-RECORD.
 18632
 18633     IF PB-CANCELLATION
 18634        IF (CANCEL-IN-ERROR  AND
 18635            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18636            ALL-CANCELS
 18637            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18638            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18639            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18640            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18641            MOVE PB-SV-STATE            TO PI-SV-STATE
 18642            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18643            GO TO 7100-DISPLAY-CANCELS.
 18644
 18645     GO TO 4005-READ-NEXT-RECORD.
 18646
 18647 4050-END-RECORDS.
 18648******************************************************************
 18649*                                                                *
 18650*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18651*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18652*         PROGRAM.                                               *
 18653*                                                                *
 18654******************************************************************
 18655
 18656     IF BROWSE-STARTED
 18657        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18658
 18659* EXEC CICS ENDBR
 18660*            DATASET  (FILE-ID-ERPNDB2)
 18661*       END-EXEC.
 18662     MOVE 0
 18663       TO DFHEIV11
 18664*    MOVE '&2                    $   #00015924' TO DFHEIV0
 18665     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18666     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 342
* EL6311.cbl
 18667     MOVE X'2020233030303135393234' TO DFHEIV0(25:11)
 18668     CALL 'kxdfhei1' USING DFHEIV0,
 18669           FILE-ID-ERPNDB2,
 18670           DFHEIV11,
 18671           DFHEIV99
 18672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18673
 18674
 18675     IF  EIBTRNID NOT = TRANS-EXB1
 18676         IF PENDING-BUS-RECS-FOUND
 18677             NEXT SENTENCE
 18678           ELSE
 18679             MOVE '9'            TO PI-BROWSE-SW
 18680             GO TO 9400-CLEAR.
 18681
 18682     IF SHOW-RECORD
 18683        MOVE ER-2253            TO EMI-ERROR
 18684       ELSE
 18685        MOVE ER-2254            TO EMI-ERROR.
 18686
 18687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18688
 18689     IF PI-MAP-NAME = SPACES
 18690        MOVE -1                  TO DPFENTRL
 18691        MOVE EL631D               TO PI-MAP-NAME
 18692        GO TO 8100-SEND-INITIAL-MAP.
 18693
 18694     IF PI-MAP-NAME = EL631B
 18695        MOVE -1                  TO BMAINTL
 18696     ELSE
 18697        IF PI-MAP-NAME = EL631C
 18698           MOVE -1               TO CMAINTL
 18699        ELSE
 18700           MOVE -1               TO DPFENTRL.
 18701
 18702     GO TO 8200-SEND-DATAONLY.
 18703
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 343
* EL6311.cbl
 18705
 18706***************************************************************
 18707*                                                             *
 18708*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18709*                                                             *
 18710*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18711*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18712*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18713*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18714*                                                             *
 18715*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18716*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18717*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18718*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18719*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18720*                AND IS IT TO BE DISPLAYED.                   *
 18721*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18722*                DISPLAYED.                                   *
 18723*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18724*                DISPLAYED.                                   *
 18725*                                                             *
 18726*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18727*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18728*                                                             *
 18729*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18730*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18731*                THEY ARE NOT TO BE DISPLAYED.                *
 18732*                                                             *
 18733***************************************************************
 18734
 18735 4100-BROWSE-PRIMARY-FORWARD.
 18736     IF FIRST-TIME  OR SHOW-RECORD
 18737        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18738        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18739        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18740     ELSE
 18741        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18742        IF ERPNDB-BATCH-SEQ-NO = +9999
 18743           GO TO 4150-END-BATCH
 18744        ELSE
 18745           IF DISPLAY-CHANGE-RECORDS
 18746              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18747           ELSE
 18748              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18749              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18750
 18751     IF FIRST-TIME
 18752         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18753            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18754              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18755
 18756
 18757* EXEC CICS HANDLE CONDITION
 18758*         ENDFILE  (4150-END-BATCH)
 18759*    END-EXEC.
 18760*    MOVE '"$''                   ! J #00016009' TO DFHEIV0
 18761     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 344
* EL6311.cbl
 18763     MOVE X'4A20233030303136303039' TO DFHEIV0(25:11)
 18764     CALL 'kxdfhei1' USING DFHEIV0
 18765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18766
 18767
 18768 4105-READ-NEXT.
 18769
 18770* EXEC CICS HANDLE CONDITION
 18771*         NOTFND    (4150-END-BATCH)
 18772*    END-EXEC.
 18773*    MOVE '"$I                   ! K #00016014' TO DFHEIV0
 18774     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18776     MOVE X'4B20233030303136303134' TO DFHEIV0(25:11)
 18777     CALL 'kxdfhei1' USING DFHEIV0
 18778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18779
 18780
 18781     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18782
 18783     IF PI-DISPLAY-ORIGINAL-BATCH
 18784        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18785     ELSE
 18786        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18787
 18788
 18789* EXEC CICS READ
 18790*         DATASET   (FILE-ID)
 18791*         SET       (ADDRESS OF PENDING-BUSINESS)
 18792*         RIDFLD    (ERPNDB-KEY)
 18793*         GTEQ
 18794*    END-EXEC.
 18795*    MOVE '&"S        G          (   #00016025' TO DFHEIV0
 18796     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18798     MOVE X'2020233030303136303235' TO DFHEIV0(25:11)
 18799     CALL 'kxdfhei1' USING DFHEIV0,
 18800           FILE-ID,
 18801           DFHEIV20,
 18802           DFHEIV99,
 18803           ERPNDB-KEY,
 18804           DFHEIV99,
 18805           DFHEIV99,
 18806           DFHEIV99
 18807     SET ADDRESS OF PENDING-BUSINESS TO
 18808         DFHEIV20
 18809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18810
 18811
 18812     IF PI-DISPLAY-ORIGINAL-BATCH
 18813        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18814           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18815           GO TO 4150-END-BATCH
 18816        ELSE
 18817           IF PB-BATCH-TRAILER
 18818              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18819              GO TO 4105-READ-NEXT
 18820           ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 345
* EL6311.cbl
 18821              NEXT SENTENCE
 18822     ELSE
 18823        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18824           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18825           GO TO 4150-END-BATCH.
 18826
 18827     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18828
 18829     IF WS-BATCH-PREFIX = '#CL'
 18830         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18831         GO TO 4105-READ-NEXT.
 18832
 18833     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18834     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18835     MOVE PB-STATE               TO PI-PB-STATE.
 18836     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18837
 18838     IF PB-BATCH-TRAILER
 18839        IF SHOW-RECORD
 18840           GO TO 4150-END-BATCH
 18841        ELSE
 18842           MOVE ER-2251         TO EMI-ERROR
 18843           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18844           MOVE 1               TO PI-BROWSE-TYPE
 18845           GO TO 7200-DISPLAY-BATCHES.
 18846
 18847     IF SHOW-RECORD
 18848           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18849              GO TO 4110-BUMP-SEQ
 18850           ELSE
 18851              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18852                 GO TO 4110-BUMP-SEQ
 18853              ELSE
 18854                 GO TO 4107-CHECK-REC-TYPE.
 18855
 18856     IF NOT  PI-PRIMARY-WITH-SELECT
 18857        GO TO 4107-CHECK-REC-TYPE.
 18858
 18859     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18860        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18861           GO TO 4110-BUMP-SEQ
 18862        ELSE
 18863           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18864              GO TO 4107-CHECK-REC-TYPE
 18865           ELSE
 18866              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18867                 GO TO 4107-CHECK-REC-TYPE
 18868              ELSE
 18869                 GO TO 4110-BUMP-SEQ.
 18870
 18871     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18872        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18873           GO TO 4110-BUMP-SEQ.
 18874
 18875 4107-CHECK-REC-TYPE.
 18876     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18877         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18878             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 346
* EL6311.cbl
 18879           ELSE
 18880             GO TO 4110-BUMP-SEQ.
 18881
 18882     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18883         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18884             NEXT SENTENCE
 18885           ELSE
 18886             GO TO 4110-BUMP-SEQ.
 18887
 18888     IF NOT DISPLAY-CHANGE-RECORDS AND
 18889        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18890           GO TO 4110-BUMP-SEQ.
 18891
 18892     IF DISPLAY-HOLD-RECORDS AND
 18893        NOT PB-RECORD-ON-HOLD
 18894          GO TO 4110-BUMP-SEQ.
 18895
 18896     IF PB-ISSUE
 18897        IF DISPLAY-CHK-REQ-RECORDS
 18898            GO TO 4110-BUMP-SEQ.
 18899
 18900     IF PB-ISSUE
 18901        IF ISSUE-WITH-WARNING
 18902           IF PB-WARNING-ERRORS
 18903              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18904                  GO TO 4110-BUMP-SEQ
 18905              ELSE
 18906                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18907                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18908                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18909                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18910                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18911                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18912                 GO TO 7000-DISPLAY-ISSUES
 18913        ELSE
 18914            GO TO 4110-BUMP-SEQ.
 18915
 18916     IF PB-ISSUE
 18917        IF (ISSUES-IN-ERROR AND
 18918            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18919            ALL-ISSUES
 18920            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18921            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18922            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18923            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18924            MOVE PB-SV-STATE            TO PI-SV-STATE
 18925            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18926            GO TO 7000-DISPLAY-ISSUES
 18927        ELSE
 18928            GO TO 4110-BUMP-SEQ.
 18929
 18930     IF PB-CANCELLATION
 18931        IF DISPLAY-CHK-REQ-RECORDS
 18932           IF PB-C-REFUND-REQUESTED
 18933              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18934              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18935              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18936              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 347
* EL6311.cbl
 18937              MOVE PB-SV-STATE            TO PI-SV-STATE
 18938              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18939              GO TO 7100-DISPLAY-CANCELS
 18940           ELSE
 18941              GO TO 4110-BUMP-SEQ.
 18942
 18943     IF PB-CANCELLATION
 18944        IF CANCEL-WITH-WARNING
 18945           IF PB-WARNING-ERRORS
 18946              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18947                  GO TO 4110-BUMP-SEQ
 18948              ELSE
 18949                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18950                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18951                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18952                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18953                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18954                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18955                 GO TO 7100-DISPLAY-CANCELS
 18956           ELSE
 18957              GO TO 4110-BUMP-SEQ.
 18958
 18959     IF PB-CANCELLATION
 18960        IF (CANCEL-IN-ERROR  AND
 18961            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18962            ALL-CANCELS
 18963            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18964            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18965            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18966            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18967            MOVE PB-SV-STATE            TO PI-SV-STATE
 18968            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18969            GO TO 7100-DISPLAY-CANCELS.
 18970
 18971 4110-BUMP-SEQ.
 18972     IF NOT DISPLAY-CHANGE-RECORDS
 18973        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18974        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18975     ELSE
 18976        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18977           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18978           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18979        ELSE
 18980           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18981           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18982
 18983     GO TO 4105-READ-NEXT.
 18984
 18985 4150-END-BATCH.
 18986******************************************************************
 18987*                                                                *
 18988*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18989*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18990*         PROGRAM.                                               *
 18991*                                                                *
 18992******************************************************************
 18993
 18994     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 348
* EL6311.cbl
 18995         IF PENDING-BUS-RECS-FOUND
 18996             NEXT SENTENCE
 18997           ELSE
 18998             MOVE '9'            TO PI-BROWSE-SW
 18999             GO TO 9400-CLEAR.
 19000
 19001     IF SHOW-RECORD
 19002        MOVE ER-2253             TO EMI-ERROR
 19003     ELSE
 19004        MOVE ER-2251             TO EMI-ERROR.
 19005
 19006     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19007
 19008     IF PI-MAP-NAME = SPACES
 19009        MOVE -1                  TO BMAINTL
 19010        MOVE EL631B              TO PI-MAP-NAME
 19011        GO TO 8100-SEND-INITIAL-MAP.
 19012
 19013     IF PI-MAP-NAME = EL631B
 19014        MOVE -1                  TO BMAINTL
 19015     ELSE
 19016        IF PI-MAP-NAME = EL631C
 19017           MOVE -1               TO CMAINTL
 19018        ELSE
 19019           MOVE -1               TO DPFENTRL.
 19020
 19021     GO TO 8200-SEND-DATAONLY.
 19022
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 349
* EL6311.cbl
 19024
 19025***************************************************************
 19026*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19027*                                                             *
 19028*      1. START BROWSE WITH                                   *
 19029*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19030*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19031*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19032*                                                             *
 19033*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19034*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19035*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19036*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19037*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19038*               AND IS IT TO BE DISPLAYED.                    *
 19039*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19040*               DISPLAYED.                                    *
 19041*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19042*               DISPLAYED.                                    *
 19043*                                                             *
 19044*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19045*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19046***************************************************************
 19047
 19048 4200-BROWSE-CSR-FORWARD.
 19049
 19050     IF FIRST-TIME
 19051        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19052     ELSE
 19053        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19054
 19055
 19056* EXEC CICS HANDLE CONDITION
 19057*         NOTFND   (4250-END-RECORDS)
 19058*         ENDFILE  (4250-END-RECORDS)
 19059*    END-EXEC.
 19060*    MOVE '"$I''                  ! L #00016275' TO DFHEIV0
 19061     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19063     MOVE X'4C20233030303136323735' TO DFHEIV0(25:11)
 19064     CALL 'kxdfhei1' USING DFHEIV0
 19065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19066
 19067
 19068
 19069* EXEC CICS STARTBR
 19070*         DATASET   (FILE-ID-ERPNDB4)
 19071*         RIDFLD    (ERPNDB-CSR-KEY)
 19072*    END-EXEC.
 19073     MOVE 0
 19074       TO DFHEIV11
 19075*    MOVE '&,         G          &   #00016280' TO DFHEIV0
 19076     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19077     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19078     MOVE X'2020233030303136323830' TO DFHEIV0(25:11)
 19079     CALL 'kxdfhei1' USING DFHEIV0,
 19080           FILE-ID-ERPNDB4,
 19081           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 350
* EL6311.cbl
 19082           DFHEIV99,
 19083           DFHEIV11,
 19084           DFHEIV99
 19085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19086
 19087
 19088     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19089
 19090     IF FIRST-TIME
 19091        MOVE SPACE               TO WS-FIRST-TIME-SW
 19092        GO TO 4205-READ-NEXT-RECORD.
 19093
 19094
 19095* EXEC CICS READNEXT
 19096*         DATASET    (FILE-ID-ERPNDB4)
 19097*         SET        (ADDRESS OF PENDING-BUSINESS)
 19098*         RIDFLD     (ERPNDB-CSR-KEY)
 19099*    END-EXEC.
 19100     MOVE 0
 19101       TO DFHEIV11
 19102*    MOVE '&.S                   )   #00016291' TO DFHEIV0
 19103     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19104     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19105     MOVE X'2020233030303136323931' TO DFHEIV0(25:11)
 19106     CALL 'kxdfhei1' USING DFHEIV0,
 19107           FILE-ID-ERPNDB4,
 19108           DFHEIV20,
 19109           DFHEIV99,
 19110           ERPNDB-CSR-KEY,
 19111           DFHEIV99,
 19112           DFHEIV11,
 19113           DFHEIV99,
 19114           DFHEIV99
 19115     SET ADDRESS OF PENDING-BUSINESS TO
 19116         DFHEIV20
 19117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19118
 19119
 19120 4205-READ-NEXT-RECORD.
 19121
 19122
 19123* EXEC CICS READNEXT
 19124*         DATASET    (FILE-ID-ERPNDB4)
 19125*         SET        (ADDRESS OF PENDING-BUSINESS)
 19126*         RIDFLD     (ERPNDB-CSR-KEY)
 19127*    END-EXEC.
 19128     MOVE 0
 19129       TO DFHEIV11
 19130*    MOVE '&.S                   )   #00016299' TO DFHEIV0
 19131     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19132     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19133     MOVE X'2020233030303136323939' TO DFHEIV0(25:11)
 19134     CALL 'kxdfhei1' USING DFHEIV0,
 19135           FILE-ID-ERPNDB4,
 19136           DFHEIV20,
 19137           DFHEIV99,
 19138           ERPNDB-CSR-KEY,
 19139           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 351
* EL6311.cbl
 19140           DFHEIV11,
 19141           DFHEIV99,
 19142           DFHEIV99
 19143     SET ADDRESS OF PENDING-BUSINESS TO
 19144         DFHEIV20
 19145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19146
 19147
 19148     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19149
 19150     IF WS-BATCH-PREFIX = '#CL'
 19151        GO TO 4205-READ-NEXT-RECORD.
 19152
 19153     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19154        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19155        GO TO 4250-END-RECORDS.
 19156
 19157     IF PB-BATCH-TRAILER
 19158        GO TO 4205-READ-NEXT-RECORD.
 19159
 19160     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19161        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19162           GO TO 4205-READ-NEXT-RECORD
 19163        ELSE
 19164           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19165              GO TO 4210-CHECK-REC-TYPE
 19166           ELSE
 19167              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19168                 GO TO 4210-CHECK-REC-TYPE
 19169              ELSE
 19170                 GO TO 4205-READ-NEXT-RECORD.
 19171
 19172     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19173        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19174           GO TO 4205-READ-NEXT-RECORD.
 19175
 19176 4210-CHECK-REC-TYPE.
 19177     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19178         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19179             NEXT SENTENCE
 19180         ELSE
 19181             GO TO 4205-READ-NEXT-RECORD.
 19182
 19183     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19184         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19185             NEXT SENTENCE
 19186        ELSE
 19187             GO TO 4205-READ-NEXT-RECORD.
 19188
 19189     IF NOT DISPLAY-CHANGE-RECORDS AND
 19190            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19191        GO TO 4205-READ-NEXT-RECORD.
 19192
 19193     IF DISPLAY-HOLD-RECORDS AND
 19194        NOT PB-RECORD-ON-HOLD
 19195          GO TO 4205-READ-NEXT-RECORD.
 19196
 19197     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 352
* EL6311.cbl
 19198        IF DISPLAY-CHK-REQ-RECORDS
 19199            GO TO 4205-READ-NEXT-RECORD.
 19200
 19201     IF PB-ISSUE
 19202        IF ISSUE-WITH-WARNING
 19203           IF PB-WARNING-ERRORS
 19204              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19205                  GO TO 4205-READ-NEXT-RECORD
 19206              ELSE
 19207                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19208                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19209                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19210                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19211                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19212                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19213                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19214                 GO TO 7000-DISPLAY-ISSUES
 19215           ELSE
 19216              GO TO 4205-READ-NEXT-RECORD.
 19217
 19218     IF PB-ISSUE
 19219        IF (ISSUES-IN-ERROR AND
 19220            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19221            ALL-ISSUES
 19222            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19223            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19224            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19225            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19226            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19227            MOVE PB-SV-STATE            TO PI-SV-STATE
 19228            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19229            GO TO 7000-DISPLAY-ISSUES
 19230        ELSE
 19231            GO TO 4205-READ-NEXT-RECORD.
 19232
 19233     IF PB-CANCELLATION
 19234        IF DISPLAY-CHK-REQ-RECORDS
 19235           IF PB-C-REFUND-REQUESTED
 19236              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19237              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19238              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19239              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19240              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19241              MOVE PB-SV-STATE            TO PI-SV-STATE
 19242              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19243              GO TO 7100-DISPLAY-CANCELS
 19244           ELSE
 19245               GO TO 4205-READ-NEXT-RECORD.
 19246
 19247     IF PB-CANCELLATION
 19248        IF CANCEL-WITH-WARNING
 19249           IF PB-WARNING-ERRORS
 19250              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19251                  GO TO 4205-READ-NEXT-RECORD
 19252              ELSE
 19253                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19254                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19255                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 353
* EL6311.cbl
 19256                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19257                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19258                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19259                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19260                 GO TO 7100-DISPLAY-CANCELS
 19261           ELSE
 19262              GO TO 4205-READ-NEXT-RECORD.
 19263
 19264     IF PB-CANCELLATION
 19265        IF (CANCEL-IN-ERROR  AND
 19266            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19267            ALL-CANCELS
 19268            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19269            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19270            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19271            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19272            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19273            MOVE PB-SV-STATE            TO PI-SV-STATE
 19274            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19275            GO TO 7100-DISPLAY-CANCELS.
 19276
 19277     GO TO 4205-READ-NEXT-RECORD.
 19278
 19279 4250-END-RECORDS.
 19280******************************************************************
 19281*                                                                *
 19282*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19283*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19284*         PROGRAM.                                               *
 19285*                                                                *
 19286******************************************************************
 19287
 19288     IF BROWSE-STARTED
 19289        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19290
 19291* EXEC CICS ENDBR
 19292*            DATASET  (FILE-ID-ERPNDB4)
 19293*       END-EXEC.
 19294     MOVE 0
 19295       TO DFHEIV11
 19296*    MOVE '&2                    $   #00016447' TO DFHEIV0
 19297     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19298     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19299     MOVE X'2020233030303136343437' TO DFHEIV0(25:11)
 19300     CALL 'kxdfhei1' USING DFHEIV0,
 19301           FILE-ID-ERPNDB4,
 19302           DFHEIV11,
 19303           DFHEIV99
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19305
 19306
 19307     IF  EIBTRNID NOT = TRANS-EXB1
 19308         IF PENDING-BUS-RECS-FOUND
 19309             NEXT SENTENCE
 19310           ELSE
 19311             MOVE '9'            TO PI-BROWSE-SW
 19312             GO TO 9400-CLEAR.
 19313
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 354
* EL6311.cbl
 19314     IF SHOW-RECORD
 19315        MOVE ER-2253            TO EMI-ERROR
 19316       ELSE
 19317        MOVE ER-2254            TO EMI-ERROR.
 19318
 19319     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19320
 19321     IF PI-MAP-NAME = SPACES
 19322        MOVE -1                  TO DPFENTRL
 19323        MOVE EL631D               TO PI-MAP-NAME
 19324        GO TO 8100-SEND-INITIAL-MAP.
 19325
 19326     IF PI-MAP-NAME = EL631B
 19327        MOVE -1                  TO BMAINTL
 19328     ELSE
 19329        IF PI-MAP-NAME = EL631C
 19330           MOVE -1               TO CMAINTL
 19331        ELSE
 19332           MOVE -1               TO DPFENTRL.
 19333
 19334     GO TO 8200-SEND-DATAONLY.
 19335
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 355
* EL6311.cbl
 19337
 19338***************************************************************
 19339*                                                             *
 19340*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19341*                                                             *
 19342*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19343*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19344*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19345*                                                             *
 19346*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19347*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19348*          A. IS IT WITHIN THE SAME COMPANY                   *
 19349*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19350*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19351*                AND IS IT TO BE DISPLAYED.                   *
 19352*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19353*                DISPLAYED.                                   *
 19354*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19355*                DISPLAYED.                                   *
 19356*                                                             *
 19357*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19358*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19359*                                                             *
 19360*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19361*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19362*                THEY ARE NOT TO BE DISPLAYED.                *
 19363*                                                             *
 19364***************************************************************
 19365
 19366 4300-BROWSE-FILE-FORWARD.
 19367     IF FIRST-TIME OR SHOW-RECORD
 19368        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19369        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19370        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19371     ELSE
 19372        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19373        IF ERPNDB-BATCH-SEQ-NO = +9999
 19374           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19375        ELSE
 19376           IF DISPLAY-CHANGE-RECORDS
 19377              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19378           ELSE
 19379              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19380              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19381
 19382
 19383* EXEC CICS HANDLE CONDITION
 19384*         ENDFILE  (4350-END-BATCH)
 19385*         NOTFND   (4350-END-BATCH)
 19386*    END-EXEC.
 19387*    MOVE '"$''I                  ! M #00016526' TO DFHEIV0
 19388     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19390     MOVE X'4D20233030303136353236' TO DFHEIV0(25:11)
 19391     CALL 'kxdfhei1' USING DFHEIV0
 19392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19393
 19394
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 356
* EL6311.cbl
 19395 4305-READ-NEXT.
 19396     IF PI-DISPLAY-ORIGINAL-BATCH
 19397        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19398     ELSE
 19399        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19400
 19401
 19402* EXEC CICS READ
 19403*         DATASET   (FILE-ID)
 19404*         SET       (ADDRESS OF PENDING-BUSINESS)
 19405*         RIDFLD    (ERPNDB-KEY)
 19406*         GTEQ
 19407*    END-EXEC.
 19408*    MOVE '&"S        G          (   #00016537' TO DFHEIV0
 19409     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19411     MOVE X'2020233030303136353337' TO DFHEIV0(25:11)
 19412     CALL 'kxdfhei1' USING DFHEIV0,
 19413           FILE-ID,
 19414           DFHEIV20,
 19415           DFHEIV99,
 19416           ERPNDB-KEY,
 19417           DFHEIV99,
 19418           DFHEIV99,
 19419           DFHEIV99
 19420     SET ADDRESS OF PENDING-BUSINESS TO
 19421         DFHEIV20
 19422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19423
 19424
 19425     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19426        GO TO 4350-END-BATCH.
 19427
 19428     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19429                                    WS-BATCH-NO.
 19430
 19431     IF  WS-BATCH-PREFIX = '#CL'
 19432         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19433         GO TO 4305-READ-NEXT.
 19434
 19435     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19436     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19437     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19438     MOVE PB-STATE               TO PI-PB-STATE.
 19439     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19440
 19441     IF PB-BATCH-TRAILER
 19442        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19443        GO TO 4305-READ-NEXT.
 19444
 19445     IF SHOW-RECORD
 19446           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19447              GO TO 4310-BUMP-SEQ
 19448           ELSE
 19449              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19450                 GO TO 4310-BUMP-SEQ
 19451              ELSE
 19452                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 357
* EL6311.cbl
 19453
 19454     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19455        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19456           GO TO 4310-BUMP-SEQ
 19457        ELSE
 19458           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19459              GO TO 4307-CHECK-REC-TYPE
 19460           ELSE
 19461              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19462                 GO TO 4307-CHECK-REC-TYPE
 19463              ELSE
 19464                 GO TO 4310-BUMP-SEQ.
 19465
 19466     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19467        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19468           GO TO 4310-BUMP-SEQ.
 19469
 19470 4307-CHECK-REC-TYPE.
 19471     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19472         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19473             NEXT SENTENCE
 19474         ELSE
 19475             GO TO 4310-BUMP-SEQ.
 19476
 19477     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19478         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19479             NEXT SENTENCE
 19480        ELSE
 19481             GO TO 4310-BUMP-SEQ.
 19482
 19483     IF NOT DISPLAY-CHANGE-RECORDS AND
 19484            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19485        GO TO 4310-BUMP-SEQ.
 19486
 19487     IF DISPLAY-HOLD-RECORDS AND
 19488        NOT PB-RECORD-ON-HOLD
 19489          GO TO 4310-BUMP-SEQ.
 19490
 19491     IF PB-ISSUE
 19492        IF DISPLAY-CHK-REQ-RECORDS
 19493           GO TO 4310-BUMP-SEQ.
 19494
 19495     IF PB-ISSUE
 19496        IF ISSUE-WITH-WARNING
 19497           IF PB-WARNING-ERRORS
 19498              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19499                  GO TO 4310-BUMP-SEQ
 19500              ELSE
 19501                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19502                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19503                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19504                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19505                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19506                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19507                 GO TO 7000-DISPLAY-ISSUES
 19508           ELSE
 19509              GO TO 4310-BUMP-SEQ.
 19510
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 358
* EL6311.cbl
 19511     IF PB-ISSUE
 19512        IF (ISSUES-IN-ERROR AND
 19513            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19514            ALL-ISSUES
 19515            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19516            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19517            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19518            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19519            MOVE PB-SV-STATE            TO PI-SV-STATE
 19520            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19521            GO TO 7000-DISPLAY-ISSUES
 19522        ELSE
 19523            GO TO 4310-BUMP-SEQ.
 19524
 19525     IF PB-CANCELLATION
 19526        IF DISPLAY-CHK-REQ-RECORDS
 19527           IF PB-C-REFUND-REQUESTED
 19528              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19529              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19530              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19531              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19532              MOVE PB-SV-STATE            TO PI-SV-STATE
 19533              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19534              GO TO 7100-DISPLAY-CANCELS
 19535           ELSE
 19536              GO TO 4310-BUMP-SEQ.
 19537
 19538     IF PB-CANCELLATION
 19539        IF CANCEL-WITH-WARNING
 19540           IF PB-WARNING-ERRORS
 19541              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19542                  GO TO 4310-BUMP-SEQ
 19543              ELSE
 19544                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19545                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19546                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19547                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19548                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19549                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19550                 GO TO 7100-DISPLAY-CANCELS
 19551           ELSE
 19552              GO TO 4310-BUMP-SEQ.
 19553
 19554     IF PB-CANCELLATION
 19555        IF (CANCEL-IN-ERROR  AND
 19556            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19557            ALL-CANCELS
 19558            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19559            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19560            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19561            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19562            MOVE PB-SV-STATE            TO PI-SV-STATE
 19563            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19564            GO TO 7100-DISPLAY-CANCELS.
 19565
 19566 4310-BUMP-SEQ.
 19567     IF NOT DISPLAY-CHANGE-RECORDS
 19568        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 359
* EL6311.cbl
 19569        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19570     ELSE
 19571        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19572           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19573           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19574        ELSE
 19575           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19576           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19577
 19578     GO TO 4305-READ-NEXT.
 19579
 19580 4350-END-BATCH.
 19581
 19582******************************************************************
 19583*                                                                *
 19584*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19585*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19586*         PROGRAM.                                               *
 19587*                                                                *
 19588******************************************************************
 19589
 19590     IF  EIBTRNID NOT = TRANS-EXB1
 19591         IF PENDING-BUS-RECS-FOUND
 19592             NEXT SENTENCE
 19593           ELSE
 19594             MOVE '9'            TO PI-BROWSE-SW
 19595             GO TO 9400-CLEAR.
 19596
 19597     IF SHOW-RECORD
 19598        MOVE ER-2253            TO EMI-ERROR
 19599     ELSE
 19600        MOVE ER-2251            TO EMI-ERROR.
 19601
 19602     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19603
 19604     IF PI-MAP-NAME = SPACES
 19605        MOVE -1                  TO BMAINTL
 19606        MOVE EL631B               TO PI-MAP-NAME
 19607        GO TO 8100-SEND-INITIAL-MAP.
 19608
 19609     IF PI-MAP-NAME = EL631B
 19610        MOVE -1                  TO BMAINTL
 19611     ELSE
 19612        IF PI-MAP-NAME = EL631C
 19613           MOVE -1               TO CMAINTL
 19614        ELSE
 19615           MOVE -1               TO DPFENTRL.
 19616
 19617     GO TO 8200-SEND-DATAONLY.
 19618
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 360
* EL6311.cbl
 19620
 19621******************************************************************
 19622*                                                                *
 19623*        B R O W S E   D E T A I L   B A C K W A R D             *
 19624*                                                                *
 19625******************************************************************
 19626
 19627 4500-BROWSE-DETAIL-BACKWARD.
 19628
 19629     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19630
 19631
 19632* EXEC CICS HANDLE CONDITION
 19633*         NOTFND   (4570-NOT-FOUND)
 19634*         ENDFILE  (4550-END-RECORDS)
 19635*    END-EXEC
 19636*    MOVE '"$I''                  ! N #00016750' TO DFHEIV0
 19637     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19639     MOVE X'4E20233030303136373530' TO DFHEIV0(25:11)
 19640     CALL 'kxdfhei1' USING DFHEIV0
 19641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19642
 19643
 19644* EXEC CICS STARTBR
 19645*         DATASET   (FILE-ID-ERPNDB2)
 19646*         RIDFLD    (ERPNDB-ALT-KEY)
 19647*    END-EXEC.
 19648     MOVE 0
 19649       TO DFHEIV11
 19650*    MOVE '&,         G          &   #00016755' TO DFHEIV0
 19651     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19652     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19653     MOVE X'2020233030303136373535' TO DFHEIV0(25:11)
 19654     CALL 'kxdfhei1' USING DFHEIV0,
 19655           FILE-ID-ERPNDB2,
 19656           ERPNDB-ALT-KEY,
 19657           DFHEIV99,
 19658           DFHEIV11,
 19659           DFHEIV99
 19660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19661
 19662
 19663     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19664                                    WS-FIRST-TIME-SW.
 19665
 19666 4505-READ-PREV-RECORD.
 19667
 19668* EXEC CICS READPREV
 19669*         DATASET    (FILE-ID-ERPNDB2)
 19670*         SET        (ADDRESS OF PENDING-BUSINESS)
 19671*         RIDFLD     (ERPNDB-ALT-KEY)
 19672*    END-EXEC.
 19673     MOVE 0
 19674       TO DFHEIV11
 19675*    MOVE '&0S                   )   #00016764' TO DFHEIV0
 19676     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19677     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 361
* EL6311.cbl
 19678     MOVE X'2020233030303136373634' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0,
 19680           FILE-ID-ERPNDB2,
 19681           DFHEIV20,
 19682           DFHEIV99,
 19683           ERPNDB-ALT-KEY,
 19684           DFHEIV99,
 19685           DFHEIV11,
 19686           DFHEIV99,
 19687           DFHEIV99
 19688     SET ADDRESS OF PENDING-BUSINESS TO
 19689         DFHEIV20
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19694
 19695     IF WS-BATCH-PREFIX = '#CL'
 19696         GO TO 4505-READ-PREV-RECORD.
 19697
 19698     IF FIRST-TIME
 19699         MOVE SPACE               TO WS-FIRST-TIME-SW
 19700         GO TO 4505-READ-PREV-RECORD.
 19701
 19702     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19703        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19704        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19705        PB-STATE         NOT = PI-PB-STATE    OR
 19706        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19707          GO TO 4550-END-RECORDS.
 19708
 19709
 19710     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19711
 19712     IF PB-BATCH-TRAILER
 19713        GO TO 4505-READ-PREV-RECORD.
 19714
 19715     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19716
 19717     IF  WS-BATCH-PREFIX = '#CL'
 19718         GO TO 4505-READ-PREV-RECORD.
 19719
 19720     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19721        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19722           GO TO 4505-READ-PREV-RECORD
 19723        ELSE
 19724           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19725              GO TO 4510-CHECK-REC-TYPE
 19726           ELSE
 19727              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19728                 GO TO 4510-CHECK-REC-TYPE
 19729              ELSE
 19730                 GO TO 4505-READ-PREV-RECORD.
 19731
 19732     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19733        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19734           GO TO 4505-READ-PREV-RECORD.
 19735
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 362
* EL6311.cbl
 19736 4510-CHECK-REC-TYPE.
 19737     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19738         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19739             NEXT SENTENCE
 19740         ELSE
 19741             GO TO 4505-READ-PREV-RECORD.
 19742
 19743     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19744         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19745             NEXT SENTENCE
 19746        ELSE
 19747             GO TO 4505-READ-PREV-RECORD.
 19748
 19749     IF NOT DISPLAY-CHANGE-RECORDS AND
 19750            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19751        GO TO 4505-READ-PREV-RECORD.
 19752
 19753     IF DISPLAY-HOLD-RECORDS AND
 19754        NOT PB-RECORD-ON-HOLD
 19755          GO TO 4505-READ-PREV-RECORD.
 19756
 19757     IF PB-ISSUE
 19758        IF DISPLAY-CHK-REQ-RECORDS
 19759           GO TO 4505-READ-PREV-RECORD.
 19760
 19761     IF PB-ISSUE
 19762        IF ISSUE-WITH-WARNING
 19763           IF PB-WARNING-ERRORS
 19764              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19765                  GO TO 4505-READ-PREV-RECORD
 19766              ELSE
 19767                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19768                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19769                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19770                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19771                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19772                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19773                 GO TO 7000-DISPLAY-ISSUES
 19774           ELSE
 19775              GO TO 4505-READ-PREV-RECORD.
 19776
 19777     IF PB-ISSUE
 19778        IF (ISSUES-IN-ERROR AND
 19779            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19780            ALL-ISSUES
 19781            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19782            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19783            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19784            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19785            MOVE PB-SV-STATE            TO PI-SV-STATE
 19786            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19787            GO TO 7000-DISPLAY-ISSUES
 19788        ELSE
 19789            GO TO 4505-READ-PREV-RECORD.
 19790
 19791     IF PB-CANCELLATION
 19792        IF DISPLAY-CHK-REQ-RECORDS
 19793           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 363
* EL6311.cbl
 19794              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19795              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19796              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19797              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19798              MOVE PB-SV-STATE            TO PI-SV-STATE
 19799              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19800              GO TO 7100-DISPLAY-CANCELS
 19801           ELSE
 19802              GO TO 4505-READ-PREV-RECORD.
 19803
 19804     IF PB-CANCELLATION
 19805        IF CANCEL-WITH-WARNING
 19806           IF PB-WARNING-ERRORS
 19807              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19808                  GO TO 4505-READ-PREV-RECORD
 19809              ELSE
 19810                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19811                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19812                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19813                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19814                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19815                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19816                 GO TO 7100-DISPLAY-CANCELS
 19817           ELSE
 19818              GO TO 4505-READ-PREV-RECORD.
 19819
 19820     IF PB-CANCELLATION
 19821        IF (CANCEL-IN-ERROR  AND
 19822            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19823            ALL-CANCELS
 19824            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19825            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19826            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19827            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19828            MOVE PB-SV-STATE            TO PI-SV-STATE
 19829            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19830            GO TO 7100-DISPLAY-CANCELS.
 19831
 19832     GO TO 4505-READ-PREV-RECORD.
 19833
 19834 4550-END-RECORDS.
 19835     IF PI-MAP-NAME = EL631B
 19836        MOVE -1                  TO BMAINTL
 19837     ELSE
 19838        IF PI-MAP-NAME = EL631C
 19839           MOVE -1               TO CMAINTL
 19840        ELSE
 19841           MOVE -1               TO DPFENTRL.
 19842
 19843     MOVE ER-2255               TO EMI-ERROR.
 19844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19845     GO TO 8200-SEND-DATAONLY.
 19846
 19847 4570-NOT-FOUND.
 19848
 19849******************************************************************
 19850*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19851******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 364
* EL6311.cbl
 19852
 19853
 19854* EXEC CICS RESETBR
 19855*         DATASET    (FILE-ID-ERPNDB2)
 19856*         RIDFLD     (ERPNDB-ALT-KEY)
 19857*    END-EXEC.
 19858     MOVE 0
 19859       TO DFHEIV11
 19860*    MOVE '&4         G          &   #00016930' TO DFHEIV0
 19861     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19862     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19863     MOVE X'2020233030303136393330' TO DFHEIV0(25:11)
 19864     CALL 'kxdfhei1' USING DFHEIV0,
 19865           FILE-ID-ERPNDB2,
 19866           ERPNDB-ALT-KEY,
 19867           DFHEIV99,
 19868           DFHEIV11,
 19869           DFHEIV99
 19870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19871
 19872
 19873
 19874* EXEC CICS READNEXT
 19875*         DATASET    (FILE-ID-ERPNDB2)
 19876*         SET        (ADDRESS OF PENDING-BUSINESS)
 19877*         RIDFLD     (ERPNDB-ALT-KEY)
 19878*    END-EXEC.
 19879     MOVE 0
 19880       TO DFHEIV11
 19881*    MOVE '&.S                   )   #00016935' TO DFHEIV0
 19882     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19883     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19884     MOVE X'2020233030303136393335' TO DFHEIV0(25:11)
 19885     CALL 'kxdfhei1' USING DFHEIV0,
 19886           FILE-ID-ERPNDB2,
 19887           DFHEIV20,
 19888           DFHEIV99,
 19889           ERPNDB-ALT-KEY,
 19890           DFHEIV99,
 19891           DFHEIV11,
 19892           DFHEIV99,
 19893           DFHEIV99
 19894     SET ADDRESS OF PENDING-BUSINESS TO
 19895         DFHEIV20
 19896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19897
 19898
 19899
 19900* EXEC CICS READPREV
 19901*         DATASET    (FILE-ID-ERPNDB2)
 19902*         SET        (ADDRESS OF PENDING-BUSINESS)
 19903*         RIDFLD     (ERPNDB-ALT-KEY)
 19904*    END-EXEC.
 19905     MOVE 0
 19906       TO DFHEIV11
 19907*    MOVE '&0S                   )   #00016941' TO DFHEIV0
 19908     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19909     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 365
* EL6311.cbl
 19910     MOVE X'2020233030303136393431' TO DFHEIV0(25:11)
 19911     CALL 'kxdfhei1' USING DFHEIV0,
 19912           FILE-ID-ERPNDB2,
 19913           DFHEIV20,
 19914           DFHEIV99,
 19915           ERPNDB-ALT-KEY,
 19916           DFHEIV99,
 19917           DFHEIV11,
 19918           DFHEIV99,
 19919           DFHEIV99
 19920     SET ADDRESS OF PENDING-BUSINESS TO
 19921         DFHEIV20
 19922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19923
 19924
 19925 4580-READ-PREV-RECORD.
 19926
 19927* EXEC CICS READPREV
 19928*         DATASET    (FILE-ID-ERPNDB2)
 19929*         SET        (ADDRESS OF PENDING-BUSINESS)
 19930*         RIDFLD     (ERPNDB-ALT-KEY)
 19931*    END-EXEC.
 19932     MOVE 0
 19933       TO DFHEIV11
 19934*    MOVE '&0S                   )   #00016948' TO DFHEIV0
 19935     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19936     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19937     MOVE X'2020233030303136393438' TO DFHEIV0(25:11)
 19938     CALL 'kxdfhei1' USING DFHEIV0,
 19939           FILE-ID-ERPNDB2,
 19940           DFHEIV20,
 19941           DFHEIV99,
 19942           ERPNDB-ALT-KEY,
 19943           DFHEIV99,
 19944           DFHEIV11,
 19945           DFHEIV99,
 19946           DFHEIV99
 19947     SET ADDRESS OF PENDING-BUSINESS TO
 19948         DFHEIV20
 19949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19950
 19951
 19952     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19953
 19954     IF WS-BATCH-PREFIX = '#CL'
 19955        GO TO 4580-READ-PREV-RECORD.
 19956
 19957     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19958     GO TO 4505-READ-PREV-RECORD.
 19959
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 366
* EL6311.cbl
 19961
 19962******************************************************************
 19963*                                                                *
 19964*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19965*                                                                *
 19966******************************************************************
 19967
 19968 4600-BROWSE-PRIMARY-BACKWARD.
 19969        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19970
 19971     IF ERPNDB-BATCH-SEQ-NO = +9999
 19972        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19973
 19974        IF ERPNDB-BATCH-SEQ-NO = +0000
 19975           GO TO 4650-END-BATCH
 19976        ELSE
 19977           IF PI-MAP-NAME NOT = EL631D
 19978              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19979                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19980              ELSE
 19981                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19982                 IF DISPLAY-CHANGE-RECORDS
 19983                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19984                 ELSE
 19985                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19986
 19987
 19988* EXEC CICS HANDLE CONDITION
 19989*         NOTFND    (4680-NOT-FOUND)
 19990*         ENDFILE   (4680-NOT-FOUND)
 19991*    END-EXEC.
 19992*    MOVE '"$I''                  ! O #00016989' TO DFHEIV0
 19993     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19995     MOVE X'4F20233030303136393839' TO DFHEIV0(25:11)
 19996     CALL 'kxdfhei1' USING DFHEIV0
 19997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19998
 19999
 20000 4605-READ-NEXT.
 20001     IF ERPNDB-BATCH-SEQ-NO = +0000
 20002        GO TO 4650-END-BATCH.
 20003
 20004     IF PI-DISPLAY-ORIGINAL-BATCH
 20005        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20006     ELSE
 20007        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20008
 20009
 20010* EXEC CICS READ
 20011*         DATASET   (FILE-ID)
 20012*         SET       (ADDRESS OF PENDING-BUSINESS)
 20013*         RIDFLD    (ERPNDB-KEY)
 20014*    END-EXEC.
 20015*    MOVE '&"S        E          (   #00017003' TO DFHEIV0
 20016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20018     MOVE X'2020233030303137303033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 367
* EL6311.cbl
 20019     CALL 'kxdfhei1' USING DFHEIV0,
 20020           FILE-ID,
 20021           DFHEIV20,
 20022           DFHEIV99,
 20023           ERPNDB-KEY,
 20024           DFHEIV99,
 20025           DFHEIV99,
 20026           DFHEIV99
 20027     SET ADDRESS OF PENDING-BUSINESS TO
 20028         DFHEIV20
 20029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20030
 20031
 20032     IF NOT  PI-PRIMARY-WITH-SELECT
 20033        GO TO 4607-CHECK-REC-TYPE.
 20034
 20035     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20036
 20037     IF  WS-BATCH-PREFIX = '#CL'
 20038         GO TO 4610-BUMP-SEQ.
 20039
 20040     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20041        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20042           GO TO 4610-BUMP-SEQ
 20043        ELSE
 20044           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20045              GO TO 4607-CHECK-REC-TYPE
 20046           ELSE
 20047              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20048                 GO TO 4607-CHECK-REC-TYPE
 20049              ELSE
 20050                 GO TO 4610-BUMP-SEQ.
 20051
 20052     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20053        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20054           GO TO 4610-BUMP-SEQ.
 20055
 20056 4607-CHECK-REC-TYPE.
 20057     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20058         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20059             NEXT SENTENCE
 20060         ELSE
 20061             GO TO 4610-BUMP-SEQ.
 20062
 20063     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20064         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20065             NEXT SENTENCE
 20066        ELSE
 20067             GO TO 4610-BUMP-SEQ.
 20068
 20069     IF NOT DISPLAY-CHANGE-RECORDS AND
 20070            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20071        GO TO 4610-BUMP-SEQ.
 20072
 20073     IF DISPLAY-HOLD-RECORDS AND
 20074        NOT PB-RECORD-ON-HOLD
 20075          GO TO 4610-BUMP-SEQ.
 20076
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 368
* EL6311.cbl
 20077     IF PB-ISSUE
 20078        IF DISPLAY-CHK-REQ-RECORDS
 20079           GO TO 4610-BUMP-SEQ.
 20080
 20081     IF PB-ISSUE
 20082        IF ISSUE-WITH-WARNING
 20083           IF PB-WARNING-ERRORS
 20084              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20085                  GO TO 4610-BUMP-SEQ
 20086              ELSE
 20087                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20088                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20089                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20090                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20091                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20092                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20093                 GO TO 7000-DISPLAY-ISSUES
 20094           ELSE
 20095              GO TO 4610-BUMP-SEQ.
 20096
 20097     IF PB-ISSUE
 20098        IF (ISSUES-IN-ERROR AND
 20099            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20100            ALL-ISSUES
 20101            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20102            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20103            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20104            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20105            MOVE PB-SV-STATE            TO PI-SV-STATE
 20106            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20107            GO TO 7000-DISPLAY-ISSUES
 20108        ELSE
 20109            GO TO 4610-BUMP-SEQ.
 20110
 20111     IF PB-CANCELLATION
 20112        IF DISPLAY-CHK-REQ-RECORDS
 20113           IF PB-C-REFUND-REQUESTED
 20114              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20115              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20116              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20117              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20118              MOVE PB-SV-STATE            TO PI-SV-STATE
 20119              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20120              GO TO 7100-DISPLAY-CANCELS
 20121           ELSE
 20122              GO TO 4610-BUMP-SEQ.
 20123
 20124     IF PB-CANCELLATION
 20125        IF CANCEL-WITH-WARNING
 20126           IF PB-WARNING-ERRORS
 20127              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20128                  GO TO 4610-BUMP-SEQ
 20129              ELSE
 20130                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20131                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20132                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20133                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20134                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 369
* EL6311.cbl
 20135                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20136                 GO TO 7100-DISPLAY-CANCELS
 20137           ELSE
 20138              GO TO 4610-BUMP-SEQ.
 20139
 20140     IF PB-CANCELLATION
 20141        IF (CANCEL-IN-ERROR  AND
 20142            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20143            ALL-CANCELS
 20144            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20145            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20146            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20147            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20148            MOVE PB-SV-STATE            TO PI-SV-STATE
 20149            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20150            GO TO 7100-DISPLAY-CANCELS.
 20151
 20152 4610-BUMP-SEQ.
 20153     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20154        GO TO 4650-END-BATCH.
 20155
 20156     IF DISPLAY-CHANGE-RECORDS
 20157        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20158           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20159        ELSE
 20160           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20161           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20162        ELSE
 20163           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20164           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20165
 20166        GO TO 4605-READ-NEXT.
 20167
 20168 4650-END-BATCH.
 20169     IF PI-MAP-NAME = EL631B
 20170        MOVE -1                  TO BMAINTL
 20171     ELSE
 20172        IF PI-MAP-NAME = EL631C
 20173           MOVE -1               TO CMAINTL
 20174        ELSE
 20175           MOVE -1               TO DPFENTRL.
 20176
 20177     MOVE ER-2252               TO EMI-ERROR.
 20178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20179     GO TO 8200-SEND-DATAONLY.
 20180
 20181 4680-NOT-FOUND.
 20182     IF DISPLAY-CHANGE-RECORDS
 20183        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20184           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20185        ELSE
 20186           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20187           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20188     ELSE
 20189        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20190
 20191     GO TO 4605-READ-NEXT.
 20192
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 370
* EL6311.cbl
 20194
 20195******************************************************************
 20196*                                                                *
 20197*        B R O W S E   F I L E   B A C K W A R D S               *
 20198*                                                                *
 20199******************************************************************
 20200
 20201 4800-BROWSE-FILE-BACKWARD.
 20202
 20203* EXEC CICS HANDLE CONDITION
 20204*         NOTFND   (4860-NOT-FOUND)
 20205*         ENDFILE  (4850-END-RECORDS)
 20206*    END-EXEC.
 20207*    MOVE '"$I''                  ! P #00017179' TO DFHEIV0
 20208     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20209     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20210     MOVE X'5020233030303137313739' TO DFHEIV0(25:11)
 20211     CALL 'kxdfhei1' USING DFHEIV0
 20212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20213
 20214
 20215     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20216
 20217     IF PI-DISPLAY-ORIGINAL-BATCH
 20218        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20219     ELSE
 20220        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20221
 20222
 20223* EXEC CICS STARTBR
 20224*         DATASET   (FILE-ID)
 20225*         RIDFLD    (ERPNDB-KEY)
 20226*    END-EXEC.
 20227     MOVE 0
 20228       TO DFHEIV11
 20229*    MOVE '&,         G          &   #00017191' TO DFHEIV0
 20230     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20231     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20232     MOVE X'2020233030303137313931' TO DFHEIV0(25:11)
 20233     CALL 'kxdfhei1' USING DFHEIV0,
 20234           FILE-ID,
 20235           ERPNDB-KEY,
 20236           DFHEIV99,
 20237           DFHEIV11,
 20238           DFHEIV99
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20240
 20241
 20242     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20243
 20244
 20245* EXEC CICS READPREV
 20246*         DATASET    (FILE-ID-ERPNDB)
 20247*         SET        (ADDRESS OF PENDING-BUSINESS)
 20248*         RIDFLD     (ERPNDB-KEY)
 20249*    END-EXEC.
 20250     MOVE 0
 20251       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 371
* EL6311.cbl
 20252*    MOVE '&0S                   )   #00017198' TO DFHEIV0
 20253     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20254     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20255     MOVE X'2020233030303137313938' TO DFHEIV0(25:11)
 20256     CALL 'kxdfhei1' USING DFHEIV0,
 20257           FILE-ID-ERPNDB,
 20258           DFHEIV20,
 20259           DFHEIV99,
 20260           ERPNDB-KEY,
 20261           DFHEIV99,
 20262           DFHEIV11,
 20263           DFHEIV99,
 20264           DFHEIV99
 20265     SET ADDRESS OF PENDING-BUSINESS TO
 20266         DFHEIV20
 20267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20268
 20269
 20270 4810-READ-PREV-RECORD.
 20271
 20272* EXEC CICS READPREV
 20273*         DATASET    (FILE-ID-ERPNDB)
 20274*         SET        (ADDRESS OF PENDING-BUSINESS)
 20275*         RIDFLD     (ERPNDB-KEY)
 20276*    END-EXEC.
 20277     MOVE 0
 20278       TO DFHEIV11
 20279*    MOVE '&0S                   )   #00017205' TO DFHEIV0
 20280     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20281     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20282     MOVE X'2020233030303137323035' TO DFHEIV0(25:11)
 20283     CALL 'kxdfhei1' USING DFHEIV0,
 20284           FILE-ID-ERPNDB,
 20285           DFHEIV20,
 20286           DFHEIV99,
 20287           ERPNDB-KEY,
 20288           DFHEIV99,
 20289           DFHEIV11,
 20290           DFHEIV99,
 20291           DFHEIV99
 20292     SET ADDRESS OF PENDING-BUSINESS TO
 20293         DFHEIV20
 20294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20295
 20296
 20297     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20298        GO TO 4850-END-RECORDS.
 20299
 20300     IF PB-BATCH-TRAILER
 20301        GO TO 4810-READ-PREV-RECORD.
 20302
 20303     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20304
 20305     IF  WS-BATCH-PREFIX = '#CL'
 20306         GO TO 4810-READ-PREV-RECORD.
 20307
 20308     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20309        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 372
* EL6311.cbl
 20310           GO TO 4810-READ-PREV-RECORD
 20311        ELSE
 20312           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20313              GO TO 4820-CHECK-REC-TYPE
 20314           ELSE
 20315              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20316                 GO TO 4820-CHECK-REC-TYPE
 20317              ELSE
 20318                 GO TO 4810-READ-PREV-RECORD.
 20319
 20320     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20321        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20322           GO TO 4810-READ-PREV-RECORD.
 20323
 20324 4820-CHECK-REC-TYPE.
 20325     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20326         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20327             NEXT SENTENCE
 20328         ELSE
 20329             GO TO 4810-READ-PREV-RECORD.
 20330
 20331     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20332         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20333             NEXT SENTENCE
 20334        ELSE
 20335             GO TO 4810-READ-PREV-RECORD.
 20336
 20337     IF NOT DISPLAY-CHANGE-RECORDS AND
 20338            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20339        GO TO 4810-READ-PREV-RECORD.
 20340
 20341     IF DISPLAY-HOLD-RECORDS AND
 20342        NOT PB-RECORD-ON-HOLD
 20343          GO TO 4810-READ-PREV-RECORD.
 20344
 20345     IF PB-ISSUE
 20346        IF DISPLAY-CHK-REQ-RECORDS
 20347           GO TO 4810-READ-PREV-RECORD.
 20348
 20349     IF PB-ISSUE
 20350        IF ISSUE-WITH-WARNING
 20351           IF PB-WARNING-ERRORS
 20352              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20353                  GO TO 4810-READ-PREV-RECORD
 20354              ELSE
 20355                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20356                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20357                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20358                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20359                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20360                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20361                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20362                 GO TO 7000-DISPLAY-ISSUES
 20363           ELSE
 20364              GO TO 4810-READ-PREV-RECORD.
 20365
 20366     IF PB-ISSUE
 20367        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 373
* EL6311.cbl
 20368            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20369            ALL-ISSUES
 20370            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20371            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20372            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20373            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20374            MOVE PB-SV-STATE            TO PI-SV-STATE
 20375            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20376            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20377            GO TO 7000-DISPLAY-ISSUES
 20378        ELSE
 20379            GO TO 4810-READ-PREV-RECORD.
 20380
 20381     IF PB-CANCELLATION
 20382        IF DISPLAY-CHK-REQ-RECORDS
 20383           IF PB-C-REFUND-REQUESTED
 20384              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20385              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20386              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20387              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20388              MOVE PB-SV-STATE            TO PI-SV-STATE
 20389              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20390              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20391              GO TO 7100-DISPLAY-CANCELS
 20392           ELSE
 20393              GO TO 4810-READ-PREV-RECORD.
 20394
 20395     IF PB-CANCELLATION
 20396        IF CANCEL-WITH-WARNING
 20397           IF PB-WARNING-ERRORS
 20398              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20399                  GO TO 4810-READ-PREV-RECORD
 20400              ELSE
 20401                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20402                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20403                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20404                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20405                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20406                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20407                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20408                 GO TO 7100-DISPLAY-CANCELS
 20409           ELSE
 20410              GO TO 4810-READ-PREV-RECORD.
 20411
 20412     IF PB-CANCELLATION
 20413        IF (CANCEL-IN-ERROR  AND
 20414            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20415            ALL-CANCELS
 20416            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20417            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20418            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20419            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20420            MOVE PB-SV-STATE            TO PI-SV-STATE
 20421            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20422            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20423            GO TO 7100-DISPLAY-CANCELS.
 20424
 20425     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 374
* EL6311.cbl
 20426
 20427 4850-END-RECORDS.
 20428     MOVE ER-2252                TO EMI-ERROR.
 20429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20430
 20431     IF PI-MAP-NAME = EL631B
 20432        MOVE -1                  TO BPFENTRL
 20433     ELSE
 20434        MOVE -1                  TO CPFENTRL.
 20435
 20436     GO TO 8200-SEND-DATAONLY.
 20437
 20438 4860-NOT-FOUND.
 20439
 20440******************************************************************
 20441*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20442******************************************************************
 20443
 20444
 20445* EXEC CICS RESETBR
 20446*         DATASET    (FILE-ID-ERPNDB)
 20447*         RIDFLD     (ERPNDB-KEY)
 20448*     END-EXEC.
 20449     MOVE 0
 20450       TO DFHEIV11
 20451*    MOVE '&4         G          &   #00017358' TO DFHEIV0
 20452     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20454     MOVE X'2020233030303137333538' TO DFHEIV0(25:11)
 20455     CALL 'kxdfhei1' USING DFHEIV0,
 20456           FILE-ID-ERPNDB,
 20457           ERPNDB-KEY,
 20458           DFHEIV99,
 20459           DFHEIV11,
 20460           DFHEIV99
 20461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20462
 20463
 20464
 20465* EXEC CICS READNEXT
 20466*         DATASET    (FILE-ID-ERPNDB)
 20467*         SET        (ADDRESS OF PENDING-BUSINESS)
 20468*         RIDFLD     (ERPNDB-KEY)
 20469*    END-EXEC.
 20470     MOVE 0
 20471       TO DFHEIV11
 20472*    MOVE '&.S                   )   #00017363' TO DFHEIV0
 20473     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20475     MOVE X'2020233030303137333633' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0,
 20477           FILE-ID-ERPNDB,
 20478           DFHEIV20,
 20479           DFHEIV99,
 20480           ERPNDB-KEY,
 20481           DFHEIV99,
 20482           DFHEIV11,
 20483           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 375
* EL6311.cbl
 20484           DFHEIV99
 20485     SET ADDRESS OF PENDING-BUSINESS TO
 20486         DFHEIV20
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20488
 20489
 20490
 20491* EXEC CICS READPREV
 20492*         DATASET    (FILE-ID-ERPNDB)
 20493*         SET        (ADDRESS OF PENDING-BUSINESS)
 20494*         RIDFLD     (ERPNDB-KEY)
 20495*    END-EXEC.
 20496     MOVE 0
 20497       TO DFHEIV11
 20498*    MOVE '&0S                   )   #00017369' TO DFHEIV0
 20499     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20500     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20501     MOVE X'2020233030303137333639' TO DFHEIV0(25:11)
 20502     CALL 'kxdfhei1' USING DFHEIV0,
 20503           FILE-ID-ERPNDB,
 20504           DFHEIV20,
 20505           DFHEIV99,
 20506           ERPNDB-KEY,
 20507           DFHEIV99,
 20508           DFHEIV11,
 20509           DFHEIV99,
 20510           DFHEIV99
 20511     SET ADDRESS OF PENDING-BUSINESS TO
 20512         DFHEIV20
 20513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20514
 20515
 20516     GO TO 4810-READ-PREV-RECORD.
 20517
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 376
* EL6311.cbl
 20519
 20520******************************************************************
 20521*                                                                *
 20522*           B R O W S E   C S R   B A C K W A R D                *
 20523*                                                                *
 20524******************************************************************
 20525
 20526 4900-BROWSE-CSR-BACKWARD.
 20527
 20528     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20529
 20530
 20531* EXEC CICS HANDLE CONDITION
 20532*         NOTFND   (4970-NOT-FOUND)
 20533*         ENDFILE  (4950-END-RECORDS)
 20534*    END-EXEC
 20535*    MOVE '"$I''                  ! Q #00017389' TO DFHEIV0
 20536     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20538     MOVE X'5120233030303137333839' TO DFHEIV0(25:11)
 20539     CALL 'kxdfhei1' USING DFHEIV0
 20540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20541
 20542
 20543* EXEC CICS STARTBR
 20544*         DATASET   (FILE-ID-ERPNDB4)
 20545*         RIDFLD    (ERPNDB-CSR-KEY)
 20546*    END-EXEC.
 20547     MOVE 0
 20548       TO DFHEIV11
 20549*    MOVE '&,         G          &   #00017394' TO DFHEIV0
 20550     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20552     MOVE X'2020233030303137333934' TO DFHEIV0(25:11)
 20553     CALL 'kxdfhei1' USING DFHEIV0,
 20554           FILE-ID-ERPNDB4,
 20555           ERPNDB-CSR-KEY,
 20556           DFHEIV99,
 20557           DFHEIV11,
 20558           DFHEIV99
 20559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20560
 20561
 20562     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20563                                    WS-FIRST-TIME-SW.
 20564
 20565 4905-READ-PREV-RECORD.
 20566
 20567* EXEC CICS READPREV
 20568*         DATASET    (FILE-ID-ERPNDB4)
 20569*         SET        (ADDRESS OF PENDING-BUSINESS)
 20570*         RIDFLD     (ERPNDB-CSR-KEY)
 20571*    END-EXEC.
 20572     MOVE 0
 20573       TO DFHEIV11
 20574*    MOVE '&0S                   )   #00017403' TO DFHEIV0
 20575     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20576     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 377
* EL6311.cbl
 20577     MOVE X'2020233030303137343033' TO DFHEIV0(25:11)
 20578     CALL 'kxdfhei1' USING DFHEIV0,
 20579           FILE-ID-ERPNDB4,
 20580           DFHEIV20,
 20581           DFHEIV99,
 20582           ERPNDB-CSR-KEY,
 20583           DFHEIV99,
 20584           DFHEIV11,
 20585           DFHEIV99,
 20586           DFHEIV99
 20587     SET ADDRESS OF PENDING-BUSINESS TO
 20588         DFHEIV20
 20589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20590
 20591
 20592     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20593
 20594     IF WS-BATCH-PREFIX = '#CL'
 20595         GO TO 4905-READ-PREV-RECORD.
 20596
 20597     IF FIRST-TIME
 20598         MOVE SPACE               TO WS-FIRST-TIME-SW
 20599         GO TO 4905-READ-PREV-RECORD.
 20600
 20601     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20602        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20603        GO TO 4950-END-RECORDS.
 20604
 20605     IF PB-BATCH-TRAILER
 20606        GO TO 4905-READ-PREV-RECORD.
 20607
 20608     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20609
 20610     IF  WS-BATCH-PREFIX = '#CL'
 20611         GO TO 4905-READ-PREV-RECORD.
 20612
 20613     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20614        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20615           GO TO 4905-READ-PREV-RECORD
 20616        ELSE
 20617           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20618              GO TO 4910-CHECK-REC-TYPE
 20619           ELSE
 20620              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20621                 GO TO 4910-CHECK-REC-TYPE
 20622              ELSE
 20623                 GO TO 4905-READ-PREV-RECORD.
 20624
 20625     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20626        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20627           GO TO 4905-READ-PREV-RECORD.
 20628
 20629 4910-CHECK-REC-TYPE.
 20630     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20631         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20632             NEXT SENTENCE
 20633         ELSE
 20634             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 378
* EL6311.cbl
 20635
 20636     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20637         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20638             NEXT SENTENCE
 20639        ELSE
 20640             GO TO 4905-READ-PREV-RECORD.
 20641
 20642     IF NOT DISPLAY-CHANGE-RECORDS AND
 20643            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20644        GO TO 4905-READ-PREV-RECORD.
 20645
 20646     IF DISPLAY-HOLD-RECORDS AND
 20647        NOT PB-RECORD-ON-HOLD
 20648          GO TO 4905-READ-PREV-RECORD.
 20649
 20650     IF PB-ISSUE
 20651        IF DISPLAY-CHK-REQ-RECORDS
 20652           GO TO 4905-READ-PREV-RECORD.
 20653
 20654     IF PB-ISSUE
 20655        IF ISSUE-WITH-WARNING
 20656           IF PB-WARNING-ERRORS
 20657              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20658                  GO TO 4505-READ-PREV-RECORD
 20659              ELSE
 20660                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20661                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20662                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20663                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20664                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20665                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20666                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20667                 GO TO 7000-DISPLAY-ISSUES
 20668           ELSE
 20669              GO TO 4905-READ-PREV-RECORD.
 20670
 20671     IF PB-ISSUE
 20672        IF (ISSUES-IN-ERROR AND
 20673            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20674            ALL-ISSUES
 20675            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20676            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20677            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20678            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20679            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20680            MOVE PB-SV-STATE            TO PI-SV-STATE
 20681            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20682            GO TO 7000-DISPLAY-ISSUES
 20683        ELSE
 20684            GO TO 4905-READ-PREV-RECORD.
 20685
 20686     IF PB-CANCELLATION
 20687        IF DISPLAY-CHK-REQ-RECORDS
 20688           IF PB-C-REFUND-REQUESTED
 20689              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20690              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20691              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20692              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 379
* EL6311.cbl
 20693              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20694              MOVE PB-SV-STATE            TO PI-SV-STATE
 20695              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20696              GO TO 7100-DISPLAY-CANCELS
 20697           ELSE
 20698              GO TO 4905-READ-PREV-RECORD.
 20699
 20700     IF PB-CANCELLATION
 20701        IF CANCEL-WITH-WARNING
 20702           IF PB-WARNING-ERRORS
 20703              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20704                  GO TO 4505-READ-PREV-RECORD
 20705              ELSE
 20706                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20707                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20708                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20709                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20710                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20711                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20712                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20713                 GO TO 7100-DISPLAY-CANCELS
 20714           ELSE
 20715              GO TO 4905-READ-PREV-RECORD.
 20716
 20717     IF PB-CANCELLATION
 20718        IF (CANCEL-IN-ERROR  AND
 20719            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20720            ALL-CANCELS
 20721            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20722            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20723            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20724            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20725            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20726            MOVE PB-SV-STATE            TO PI-SV-STATE
 20727            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20728            GO TO 7100-DISPLAY-CANCELS.
 20729
 20730     GO TO 4905-READ-PREV-RECORD.
 20731
 20732 4950-END-RECORDS.
 20733     IF PI-MAP-NAME = EL631B
 20734        MOVE -1                  TO BMAINTL
 20735     ELSE
 20736        IF PI-MAP-NAME = EL631C
 20737           MOVE -1               TO CMAINTL
 20738        ELSE
 20739           MOVE -1               TO DPFENTRL.
 20740
 20741     MOVE ER-2255               TO EMI-ERROR.
 20742     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20743     GO TO 8200-SEND-DATAONLY.
 20744
 20745 4970-NOT-FOUND.
 20746
 20747******************************************************************
 20748*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20749******************************************************************
 20750
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 380
* EL6311.cbl
 20751
 20752* EXEC CICS RESETBR
 20753*         DATASET    (FILE-ID-ERPNDB4)
 20754*         RIDFLD     (ERPNDB-CSR-KEY)
 20755*    END-EXEC.
 20756     MOVE 0
 20757       TO DFHEIV11
 20758*    MOVE '&4         G          &   #00017568' TO DFHEIV0
 20759     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20760     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20761     MOVE X'2020233030303137353638' TO DFHEIV0(25:11)
 20762     CALL 'kxdfhei1' USING DFHEIV0,
 20763           FILE-ID-ERPNDB4,
 20764           ERPNDB-CSR-KEY,
 20765           DFHEIV99,
 20766           DFHEIV11,
 20767           DFHEIV99
 20768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20769
 20770
 20771
 20772* EXEC CICS READNEXT
 20773*         DATASET    (FILE-ID-ERPNDB4)
 20774*         SET        (ADDRESS OF PENDING-BUSINESS)
 20775*         RIDFLD     (ERPNDB-CSR-KEY)
 20776*    END-EXEC.
 20777     MOVE 0
 20778       TO DFHEIV11
 20779*    MOVE '&.S                   )   #00017573' TO DFHEIV0
 20780     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20781     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20782     MOVE X'2020233030303137353733' TO DFHEIV0(25:11)
 20783     CALL 'kxdfhei1' USING DFHEIV0,
 20784           FILE-ID-ERPNDB4,
 20785           DFHEIV20,
 20786           DFHEIV99,
 20787           ERPNDB-CSR-KEY,
 20788           DFHEIV99,
 20789           DFHEIV11,
 20790           DFHEIV99,
 20791           DFHEIV99
 20792     SET ADDRESS OF PENDING-BUSINESS TO
 20793         DFHEIV20
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796
 20797
 20798* EXEC CICS READPREV
 20799*         DATASET    (FILE-ID-ERPNDB4)
 20800*         SET        (ADDRESS OF PENDING-BUSINESS)
 20801*         RIDFLD     (ERPNDB-CSR-KEY)
 20802*    END-EXEC.
 20803     MOVE 0
 20804       TO DFHEIV11
 20805*    MOVE '&0S                   )   #00017579' TO DFHEIV0
 20806     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20807     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20808     MOVE X'2020233030303137353739' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 381
* EL6311.cbl
 20809     CALL 'kxdfhei1' USING DFHEIV0,
 20810           FILE-ID-ERPNDB4,
 20811           DFHEIV20,
 20812           DFHEIV99,
 20813           ERPNDB-CSR-KEY,
 20814           DFHEIV99,
 20815           DFHEIV11,
 20816           DFHEIV99,
 20817           DFHEIV99
 20818     SET ADDRESS OF PENDING-BUSINESS TO
 20819         DFHEIV20
 20820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20821
 20822
 20823 4980-READ-PREV-RECORD.
 20824
 20825* EXEC CICS READPREV
 20826*         DATASET    (FILE-ID-ERPNDB4)
 20827*         SET        (ADDRESS OF PENDING-BUSINESS)
 20828*         RIDFLD     (ERPNDB-CSR-KEY)
 20829*    END-EXEC.
 20830     MOVE 0
 20831       TO DFHEIV11
 20832*    MOVE '&0S                   )   #00017586' TO DFHEIV0
 20833     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20834     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20835     MOVE X'2020233030303137353836' TO DFHEIV0(25:11)
 20836     CALL 'kxdfhei1' USING DFHEIV0,
 20837           FILE-ID-ERPNDB4,
 20838           DFHEIV20,
 20839           DFHEIV99,
 20840           ERPNDB-CSR-KEY,
 20841           DFHEIV99,
 20842           DFHEIV11,
 20843           DFHEIV99,
 20844           DFHEIV99
 20845     SET ADDRESS OF PENDING-BUSINESS TO
 20846         DFHEIV20
 20847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20848
 20849
 20850     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20851
 20852     IF WS-BATCH-PREFIX = '#CL'
 20853        GO TO 4980-READ-PREV-RECORD.
 20854
 20855     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20856     GO TO 4905-READ-PREV-RECORD.
 20857
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 382
* EL6311.cbl
 20859
 20860
 20861******************************************************************
 20862*                                                                *
 20863*        B R O W S E   B A T C H   H E A D E R S                 *
 20864*                                                                *
 20865******************************************************************
 20866
 20867 5000-BROWSE-BATCH-HEADERS.
 20868
 20869     IF EIBTRNID NOT = TRANS-EXB1
 20870        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20871        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20872        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20873        GO TO 5010-READ-NEXT-RECORD.
 20874
 20875     IF EIBAID = DFHPF4
 20876        MOVE '0'                TO PI-EDIT-SW
 20877        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20878        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20879        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20880        GO TO 5010-READ-NEXT-RECORD.
 20881
 20882     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20883     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20884     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20885
 20886
 20887* EXEC CICS HANDLE CONDITION
 20888*         ENDFILE  (5050-NOT-FOUND)
 20889*    END-EXEC.
 20890*    MOVE '"$''                   ! R #00017628' TO DFHEIV0
 20891     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20893     MOVE X'5220233030303137363238' TO DFHEIV0(25:11)
 20894     CALL 'kxdfhei1' USING DFHEIV0
 20895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20896
 20897
 20898 5010-READ-NEXT-RECORD.
 20899
 20900* EXEC CICS HANDLE CONDITION
 20901*         NOTFND    (5050-NOT-FOUND)
 20902*    END-EXEC.
 20903*    MOVE '"$I                   ! S #00017633' TO DFHEIV0
 20904     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20906     MOVE X'5320233030303137363333' TO DFHEIV0(25:11)
 20907     CALL 'kxdfhei1' USING DFHEIV0
 20908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20909
 20910
 20911
 20912* EXEC CICS READ
 20913*         DATASET   (FILE-ID-ERPNDB)
 20914*         SET       (ADDRESS OF PENDING-BUSINESS)
 20915*         RIDFLD    (ERPNDB-KEY)
 20916*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 383
* EL6311.cbl
 20917*    END-EXEC.
 20918*    MOVE '&"S        G          (   #00017637' TO DFHEIV0
 20919     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20921     MOVE X'2020233030303137363337' TO DFHEIV0(25:11)
 20922     CALL 'kxdfhei1' USING DFHEIV0,
 20923           FILE-ID-ERPNDB,
 20924           DFHEIV20,
 20925           DFHEIV99,
 20926           ERPNDB-KEY,
 20927           DFHEIV99,
 20928           DFHEIV99,
 20929           DFHEIV99
 20930     SET ADDRESS OF PENDING-BUSINESS TO
 20931         DFHEIV20
 20932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20933
 20934
 20935     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20936         GO TO 5050-NOT-FOUND.
 20937
 20938     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20939
 20940     IF WS-BATCH-PREFIX = '#CL'
 20941         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20942         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20943         GO TO 5010-READ-NEXT-RECORD.
 20944
 20945     IF NOT PB-BATCH-TRAILER
 20946         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20947         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20948         GO TO 5010-READ-NEXT-RECORD.
 20949
 20950     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20951         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20952             NEXT SENTENCE
 20953         ELSE
 20954             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20955             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20956             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20957             GO TO 5010-READ-NEXT-RECORD.
 20958
 20959     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20960         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20961             NEXT SENTENCE
 20962        ELSE
 20963             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20964             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20965             GO TO 5010-READ-NEXT-RECORD.
 20966
 20967     IF EIBAID = DFHPF4
 20968        MOVE '0'                TO PI-EDIT-SW
 20969        GO TO 7200-DISPLAY-BATCHES.
 20970
 20971     IF PI-CSR-BROWSE
 20972        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20973           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20974           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 384
* EL6311.cbl
 20975           GO TO 5010-READ-NEXT-RECORD.
 20976
 20977     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20978       IF PI-PB-CARRIER    = SPACES AND
 20979          PI-PB-GROUPING   = SPACES AND
 20980          PI-PB-STATE      = SPACES AND
 20981          PI-PB-ACCOUNT    = SPACES
 20982            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20983            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20984            GO TO 7200-DISPLAY-BATCHES
 20985         ELSE
 20986           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20987              PI-PB-GROUPING   = PB-GROUPING AND
 20988              PI-PB-STATE      = PB-STATE    AND
 20989              PI-PB-ACCOUNT    = PB-ACCOUNT
 20990              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20991              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20992              GO TO 7200-DISPLAY-BATCHES.
 20993
 20994     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20995     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20996
 20997
 20998* EXEC CICS HANDLE CONDITION
 20999*         NOTFND    (5050-NOT-FOUND)
 21000*    END-EXEC.
 21001*    MOVE '"$I                   ! T #00017706' TO DFHEIV0
 21002     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21004     MOVE X'5420233030303137373036' TO DFHEIV0(25:11)
 21005     CALL 'kxdfhei1' USING DFHEIV0
 21006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21007
 21008
 21009
 21010* EXEC CICS READ
 21011*         DATASET   (FILE-ID-ERPNDB)
 21012*         SET       (ADDRESS OF PENDING-BUSINESS)
 21013*         RIDFLD    (ERPNDB-KEY)
 21014*         GTEQ
 21015*    END-EXEC.
 21016*    MOVE '&"S        G          (   #00017710' TO DFHEIV0
 21017     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21019     MOVE X'2020233030303137373130' TO DFHEIV0(25:11)
 21020     CALL 'kxdfhei1' USING DFHEIV0,
 21021           FILE-ID-ERPNDB,
 21022           DFHEIV20,
 21023           DFHEIV99,
 21024           ERPNDB-KEY,
 21025           DFHEIV99,
 21026           DFHEIV99,
 21027           DFHEIV99
 21028     SET ADDRESS OF PENDING-BUSINESS TO
 21029         DFHEIV20
 21030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21031
 21032
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 385
* EL6311.cbl
 21033     GO TO 5010-READ-NEXT-RECORD.
 21034
 21035 5050-NOT-FOUND.
 21036
 21037******************************************************************
 21038*                                                                *
 21039*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21040*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21041*         PROGRAM.                                               *
 21042*                                                                *
 21043******************************************************************
 21044
 21045     IF EIBTRNID NOT = TRANS-EXB1
 21046        IF PENDING-BUS-RECS-FOUND
 21047            NEXT SENTENCE
 21048          ELSE
 21049            MOVE '9'            TO PI-BROWSE-SW
 21050            GO TO 9400-CLEAR.
 21051
 21052     MOVE ER-2256                TO EMI-ERROR.
 21053     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21054
 21055     IF PI-MAP-NAME = SPACES
 21056        MOVE EL631D              TO PI-MAP-NAME
 21057        MOVE -1                  TO DPFENTRL
 21058        GO TO 8100-SEND-INITIAL-MAP.
 21059
 21060     IF PI-MAP-NAME = EL631B
 21061        MOVE -1                  TO BMAINTL
 21062     ELSE
 21063        IF PI-MAP-NAME = EL631C
 21064           MOVE -1               TO CMAINTL
 21065        ELSE
 21066           MOVE -1               TO DPFENTRL
 21067           GO TO 8200-SEND-DATAONLY.
 21068
 21069     GO TO 8100-SEND-INITIAL-MAP.
 21070
 21071     .
 21072 5100-PROCESS-POL-RESC.
 21073     MOVE ZEROS                  TO CG-LF-BENCD
 21074                                    CG-AH-BENCD
 21075                                    CG-LF-CAN-AMT
 21076                                    CG-AH-CAN-AMT
 21077     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21078                                    CG-AH-CAN-DT
 21079     MOVE SPACES                 TO CG-BATCH-NO
 21080     MOVE '4'                    TO CG-OPTION-CODE
 21081     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21082     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21083     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21084     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21085     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21086     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21087     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21088     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21089     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21090     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 386
* EL6311.cbl
 21091     MOVE PI-PREV-ALT-KEY (1:33)
 21092                                 TO CG-CERT-KEY
 21093     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21094     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21095                                    CG-AH-CAN-AMT
 21096     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21097                                    CG-AH-CAN-DT
 21098     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21099     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21100      display 'about to cancel ' cg-cert-key
 21101
 21102* EXEC CICS LINK
 21103*        PROGRAM  ('ELCANC')
 21104*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21105*    END-EXEC
 21106     MOVE LENGTH OF
 21107      CANCEL-GEN-PASS-AREA
 21108       TO DFHEIV11
 21109     MOVE 'ELCANC' TO DFHEIV1
 21110*    MOVE '."C                   (   #00017785' TO DFHEIV0
 21111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21113     MOVE X'2020233030303137373835' TO DFHEIV0(25:11)
 21114     CALL 'kxdfhei1' USING DFHEIV0,
 21115           DFHEIV1,
 21116           CANCEL-GEN-PASS-AREA,
 21117           DFHEIV11,
 21118           DFHEIV99,
 21119           DFHEIV99,
 21120           DFHEIV99,
 21121           DFHEIV99
 21122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21123     IF CG-SUCCESS
 21124        CONTINUE
 21125     ELSE
 21126        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21127        MOVE '3'                 TO EMI-SWITCH1
 21128        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21129        EVALUATE TRUE
 21130           WHEN CG-DATE-ERROR
 21131             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21132           WHEN CG-CERT-NOT-FOUND
 21133             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21134           WHEN CG-AMOUNT-ERROR
 21135             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21136           WHEN CG-OPTION-ERROR
 21137             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21138           WHEN CG-PREV-CAN
 21139             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21140           WHEN CG-INVALID-DATA
 21141             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21142           WHEN CG-NO-ACCT-MSTR
 21143             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21144           WHEN CG-SFX-A-EXIST
 21145             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21146           WHEN CG-MISC-ERROR
 21147             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21148           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 387
* EL6311.cbl
 21149             MOVE ' ERROR - ELCANC - RETURN '
 21150                                 TO EMI-ERROR-TEXT (1) (12:25)
 21151        END-EVALUATE
 21152        GO TO 8200-SEND-DATAONLY
 21153     END-IF
 21154     .
 21155 5100-EXIT.
 21156     EXIT.
 21157
 21158******************************************************************
 21159*                                                                *
 21160*        B R O W S E   B A T C H   B A C K W A R D S             *
 21161*                                                                *
 21162******************************************************************
 21163
 21164 5500-BROWSE-BATCH-BACKWARD.
 21165
 21166* EXEC CICS HANDLE CONDITION
 21167*         NOTFND   (5550-END-RECORDS)
 21168*         ENDFILE  (5550-END-RECORDS)
 21169*    END-EXEC.
 21170*    MOVE '"$I''                  ! U #00017831' TO DFHEIV0
 21171     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21173     MOVE X'5520233030303137383331' TO DFHEIV0(25:11)
 21174     CALL 'kxdfhei1' USING DFHEIV0
 21175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21176
 21177
 21178 5505-START-BROWSE.
 21179     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21180     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21181     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21182
 21183
 21184* EXEC CICS STARTBR
 21185*         DATASET   (FILE-ID-ERPNDB)
 21186*         RIDFLD    (ERPNDB-ALT-KEY)
 21187*    END-EXEC.
 21188     MOVE 0
 21189       TO DFHEIV11
 21190*    MOVE '&,         G          &   #00017841' TO DFHEIV0
 21191     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21192     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21193     MOVE X'2020233030303137383431' TO DFHEIV0(25:11)
 21194     CALL 'kxdfhei1' USING DFHEIV0,
 21195           FILE-ID-ERPNDB,
 21196           ERPNDB-ALT-KEY,
 21197           DFHEIV99,
 21198           DFHEIV11,
 21199           DFHEIV99
 21200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21201
 21202
 21203     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21204
 21205
 21206* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 388
* EL6311.cbl
 21207*         DATASET    (FILE-ID-ERPNDB)
 21208*         SET        (ADDRESS OF PENDING-BUSINESS)
 21209*         RIDFLD     (ERPNDB-KEY)
 21210*    END-EXEC.
 21211     MOVE 0
 21212       TO DFHEIV11
 21213*    MOVE '&.S                   )   #00017848' TO DFHEIV0
 21214     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21215     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21216     MOVE X'2020233030303137383438' TO DFHEIV0(25:11)
 21217     CALL 'kxdfhei1' USING DFHEIV0,
 21218           FILE-ID-ERPNDB,
 21219           DFHEIV20,
 21220           DFHEIV99,
 21221           ERPNDB-KEY,
 21222           DFHEIV99,
 21223           DFHEIV11,
 21224           DFHEIV99,
 21225           DFHEIV99
 21226     SET ADDRESS OF PENDING-BUSINESS TO
 21227         DFHEIV20
 21228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21229
 21230
 21231
 21232* EXEC CICS READPREV
 21233*         DATASET    (FILE-ID-ERPNDB)
 21234*         SET        (ADDRESS OF PENDING-BUSINESS)
 21235*         RIDFLD     (ERPNDB-KEY)
 21236*    END-EXEC.
 21237     MOVE 0
 21238       TO DFHEIV11
 21239*    MOVE '&0S                   )   #00017854' TO DFHEIV0
 21240     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21241     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21242     MOVE X'2020233030303137383534' TO DFHEIV0(25:11)
 21243     CALL 'kxdfhei1' USING DFHEIV0,
 21244           FILE-ID-ERPNDB,
 21245           DFHEIV20,
 21246           DFHEIV99,
 21247           ERPNDB-KEY,
 21248           DFHEIV99,
 21249           DFHEIV11,
 21250           DFHEIV99,
 21251           DFHEIV99
 21252     SET ADDRESS OF PENDING-BUSINESS TO
 21253         DFHEIV20
 21254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21255
 21256
 21257
 21258* EXEC CICS READPREV
 21259*         DATASET    (FILE-ID-ERPNDB)
 21260*         SET        (ADDRESS OF PENDING-BUSINESS)
 21261*         RIDFLD     (ERPNDB-KEY)
 21262*    END-EXEC.
 21263     MOVE 0
 21264       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 389
* EL6311.cbl
 21265*    MOVE '&0S                   )   #00017860' TO DFHEIV0
 21266     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21267     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21268     MOVE X'2020233030303137383630' TO DFHEIV0(25:11)
 21269     CALL 'kxdfhei1' USING DFHEIV0,
 21270           FILE-ID-ERPNDB,
 21271           DFHEIV20,
 21272           DFHEIV99,
 21273           ERPNDB-KEY,
 21274           DFHEIV99,
 21275           DFHEIV11,
 21276           DFHEIV99,
 21277           DFHEIV99
 21278     SET ADDRESS OF PENDING-BUSINESS TO
 21279         DFHEIV20
 21280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21281
 21282
 21283     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21284        GO TO 5550-END-RECORDS.
 21285
 21286     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21287
 21288     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21289
 21290     IF  WS-BATCH-PREFIX = '#CL'
 21291             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21292
 21293* EXEC CICS ENDBR
 21294*                 DATASET  (FILE-ID-ERPNDB)
 21295*            END-EXEC
 21296     MOVE 0
 21297       TO DFHEIV11
 21298*    MOVE '&2                    $   #00017875' TO DFHEIV0
 21299     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21300     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21301     MOVE X'2020233030303137383735' TO DFHEIV0(25:11)
 21302     CALL 'kxdfhei1' USING DFHEIV0,
 21303           FILE-ID-ERPNDB,
 21304           DFHEIV11,
 21305           DFHEIV99
 21306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21307         GO TO 5505-START-BROWSE.
 21308
 21309     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21310         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21311             NEXT SENTENCE
 21312         ELSE
 21313             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21314
 21315* EXEC CICS ENDBR
 21316*                 DATASET  (FILE-ID-ERPNDB)
 21317*            END-EXEC
 21318     MOVE 0
 21319       TO DFHEIV11
 21320*    MOVE '&2                    $   #00017885' TO DFHEIV0
 21321     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 390
* EL6311.cbl
 21323     MOVE X'2020233030303137383835' TO DFHEIV0(25:11)
 21324     CALL 'kxdfhei1' USING DFHEIV0,
 21325           FILE-ID-ERPNDB,
 21326           DFHEIV11,
 21327           DFHEIV99
 21328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21329             GO TO 5505-START-BROWSE.
 21330
 21331
 21332     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21333         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21334             NEXT SENTENCE
 21335        ELSE
 21336             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21337
 21338* EXEC CICS ENDBR
 21339*                 DATASET  (FILE-ID-ERPNDB)
 21340*            END-EXEC
 21341     MOVE 0
 21342       TO DFHEIV11
 21343*    MOVE '&2                    $   #00017896' TO DFHEIV0
 21344     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21345     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21346     MOVE X'2020233030303137383936' TO DFHEIV0(25:11)
 21347     CALL 'kxdfhei1' USING DFHEIV0,
 21348           FILE-ID-ERPNDB,
 21349           DFHEIV11,
 21350           DFHEIV99
 21351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21352             GO TO 5505-START-BROWSE.
 21353
 21354     IF NOT PB-BATCH-TRAILER
 21355        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21356
 21357* EXEC CICS ENDBR
 21358*            DATASET  (FILE-ID-ERPNDB)
 21359*       END-EXEC
 21360     MOVE 0
 21361       TO DFHEIV11
 21362*    MOVE '&2                    $   #00017903' TO DFHEIV0
 21363     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21365     MOVE X'2020233030303137393033' TO DFHEIV0(25:11)
 21366     CALL 'kxdfhei1' USING DFHEIV0,
 21367           FILE-ID-ERPNDB,
 21368           DFHEIV11,
 21369           DFHEIV99
 21370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21371        GO TO 5505-START-BROWSE.
 21372
 21373     IF PI-CSR-BROWSE
 21374        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21375           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21376
 21377* EXEC CICS ENDBR
 21378*               DATASET  (FILE-ID-ERPNDB)
 21379*          END-EXEC
 21380     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 391
* EL6311.cbl
 21381       TO DFHEIV11
 21382*    MOVE '&2                    $   #00017911' TO DFHEIV0
 21383     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21384     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21385     MOVE X'2020233030303137393131' TO DFHEIV0(25:11)
 21386     CALL 'kxdfhei1' USING DFHEIV0,
 21387           FILE-ID-ERPNDB,
 21388           DFHEIV11,
 21389           DFHEIV99
 21390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21391           GO TO 5505-START-BROWSE.
 21392
 21393     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21394        IF PI-PB-CARRIER    = SPACES AND
 21395           PI-PB-GROUPING   = SPACES AND
 21396           PI-PB-STATE      = SPACES AND
 21397           PI-PB-ACCOUNT    = SPACES
 21398             GO TO 7200-DISPLAY-BATCHES
 21399          ELSE
 21400            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21401               PI-PB-GROUPING   = PB-GROUPING AND
 21402               PI-PB-STATE      = PB-STATE    AND
 21403               PI-PB-ACCOUNT    = PB-ACCOUNT
 21404                 GO TO 7200-DISPLAY-BATCHES.
 21405
 21406     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21407
 21408
 21409* EXEC CICS ENDBR
 21410*         DATASET  (FILE-ID-ERPNDB)
 21411*    END-EXEC.
 21412     MOVE 0
 21413       TO DFHEIV11
 21414*    MOVE '&2                    $   #00017931' TO DFHEIV0
 21415     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21416     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21417     MOVE X'2020233030303137393331' TO DFHEIV0(25:11)
 21418     CALL 'kxdfhei1' USING DFHEIV0,
 21419           FILE-ID-ERPNDB,
 21420           DFHEIV11,
 21421           DFHEIV99
 21422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21423
 21424
 21425     GO TO 5505-START-BROWSE.
 21426
 21427 5550-END-RECORDS.
 21428     MOVE ER-2257                TO EMI-ERROR.
 21429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21430     MOVE -1                     TO DPFENTRL.
 21431
 21432     GO TO 8200-SEND-DATAONLY.
 21433
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 392
* EL6311.cbl
 21435
 21436******************************************************************
 21437*                                                                *
 21438*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21439*                                                                *
 21440******************************************************************
 21441
 21442 6000-CREATE-TEMP-STORAGE.
 21443
 21444
 21445* EXEC CICS HANDLE CONDITION
 21446*        QIDERR  (6050-QID-ERROR)
 21447*    END-EXEC.
 21448*    MOVE '"$N                   ! V #00017954' TO DFHEIV0
 21449     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21451     MOVE X'5620233030303137393534' TO DFHEIV0(25:11)
 21452     CALL 'kxdfhei1' USING DFHEIV0
 21453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21454
 21455
 21456
 21457* EXEC CICS WRITEQ TS
 21458*        QUEUE    (QID)
 21459*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21460*        LENGTH   (WS-COMM-LENGTH)
 21461*        ITEM     (W-ONE)
 21462*    END-EXEC.
 21463*    MOVE '*" I                  ''   #00017958' TO DFHEIV0
 21464     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21465     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21466     MOVE X'2020233030303137393538' TO DFHEIV0(25:11)
 21467     CALL 'kxdfhei1' USING DFHEIV0,
 21468           QID,
 21469           PROGRAM-INTERFACE-BLOCK,
 21470           WS-COMM-LENGTH,
 21471           W-ONE,
 21472           DFHEIV99,
 21473           DFHEIV99
 21474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21475
 21476
 21477 6000-EXIT.
 21478      EXIT.
 21479
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 393
* EL6311.cbl
 21481
 21482******************************************************************
 21483*                                                                *
 21484*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21485*                                                                *
 21486******************************************************************
 21487
 21488 6050-RECOVER-TEMP-STORAGE.
 21489     IF PGM-NAME = XCTL-EL6312
 21490        GO TO 6050-EXIT.
 21491
 21492     IF PGM-NAME = XCTL-EL6313
 21493        GO TO 6050-EXIT.
 21494
 21495     IF PGM-NAME = XCTL-EL6315
 21496         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21497     END-IF
 21498
 21499     IF PGM-NAME = XCTL-EL6316
 21500         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21501     END-IF
 21502
 21503
 21504* EXEC CICS HANDLE CONDITION
 21505*        QIDERR  (6050-QID-ERROR)
 21506*    END-EXEC.
 21507*    MOVE '"$N                   ! W #00017991' TO DFHEIV0
 21508     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21510     MOVE X'5720233030303137393931' TO DFHEIV0(25:11)
 21511     CALL 'kxdfhei1' USING DFHEIV0
 21512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21513
 21514
 21515
 21516* EXEC CICS READQ TS
 21517*         QUEUE   (QID)
 21518*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21519*         LENGTH  (WS-COMM-LENGTH)
 21520*         ITEM    (W-ONE)
 21521*     END-EXEC.
 21522*    MOVE '*$II   L              ''   #00017995' TO DFHEIV0
 21523     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21525     MOVE X'2020233030303137393935' TO DFHEIV0(25:11)
 21526     CALL 'kxdfhei1' USING DFHEIV0,
 21527           QID,
 21528           PROGRAM-INTERFACE-BLOCK,
 21529           WS-COMM-LENGTH,
 21530           W-ONE,
 21531           DFHEIV99,
 21532           DFHEIV99
 21533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21534
 21535
 21536 6050-DELETE-TEMP-STORAGE.
 21537
 21538
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 394
* EL6311.cbl
 21539* EXEC CICS DELETEQ TS
 21540*        QUEUE   (QID)
 21541*    END-EXEC.
 21542*    MOVE '*&                    #   #00018004' TO DFHEIV0
 21543     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21544     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21545     MOVE X'2020233030303138303034' TO DFHEIV0(25:11)
 21546     CALL 'kxdfhei1' USING DFHEIV0,
 21547           QID,
 21548           DFHEIV99
 21549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21550
 21551
 21552     GO TO 6050-EXIT.
 21553
 21554 6050-QID-ERROR.
 21555     MOVE ER-0033                TO EMI-ERROR
 21556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21557
 21558 6050-EXIT.
 21559      EXIT.
 21560
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 395
* EL6311.cbl
 21562
 21563******************************************************************
 21564*                                                                *
 21565*            T E R M   C O N V E R S I O N                       *
 21566*                                                                *
 21567******************************************************************
 21568
 21569 6100-TERM-CONVERSION.
 21570
 21571     IF PI-BPMTS = ZERO
 21572         GO TO 6199-EXIT.
 21573
 21574     IF PI-BMODE = ' ' OR 'M'
 21575         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21576         GO TO 6105-ROUND-TERM.
 21577
 21578     IF PI-BMODE = 'S'
 21579         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21580         GO TO 6105-ROUND-TERM.
 21581
 21582     IF PI-BMODE = 'W'
 21583         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21584         GO TO 6105-ROUND-TERM.
 21585
 21586     IF PI-BMODE = 'B'
 21587         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21588         GO TO 6105-ROUND-TERM.
 21589
 21590     IF PI-BMODE = 'T'
 21591         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21592
 21593 6105-ROUND-TERM.
 21594
 21595     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21596         ADD +1                  TO WS-CALC-TERM-WHOLE
 21597         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21598
 21599     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21600         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21601
 21602     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21603         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21604                                      WS-BTERM    (WS-SUB1)
 21605         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21606
 21607     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21608         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21609             MOVE -1               TO BMODEL
 21610             MOVE ER-2593          TO EMI-ERROR
 21611             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21613
 21614 6124-CHECK-BENEFIT.
 21615
 21616     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21617        GO TO 6126-COMPUTE-BENEFIT.
 21618
 21619     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 396
* EL6311.cbl
 21620
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 397
* EL6311.cbl
 21622******************************************************************
 21623**         COMPUTE TERM AND BENEFIT
 21624******************************************************************
 21625 6125-COMPUTE-TERM-BENEFIT.
 21626
 21627     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21628        PI-BPMTAMT = ZERO
 21629         GO TO 6199-EXIT.
 21630
 21631     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21632                                     WS-BTERM  (WS-SUB1).
 21633     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21634
 21635 6126-COMPUTE-BENEFIT.
 21636
 21637     IF PI-BMODE = 'M' OR  ' '
 21638         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21639
 21640     IF PI-BMODE = 'W'
 21641         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21642
 21643     IF PI-BMODE = 'S'
 21644         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21645
 21646     IF PI-BMODE = 'B'
 21647         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21648
 21649     IF PI-BMODE = 'T'
 21650         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21651
 21652     IF WS-SUB1 = +1
 21653        COMPUTE WS-BBEN (WS-SUB1) =
 21654                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21655
 21656     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21657     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21658     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21659
 21660 6199-EXIT.
 21661     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 398
* EL6311.cbl
 21663
 21664******************************************************************
 21665*                                                                *
 21666*             D I S P L A Y   I S S U E S                        *
 21667*                                                                *
 21668******************************************************************
 21669
 21670 6200-CREATE-VADS.
 21671     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21672     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21673     MOVE SPACES                 TO WS-PASS-VADS-REC
 21674
 21675* EXEC CICS GETMAIN
 21676*       SET      (ADDRESS OF PENDING-BUSINESS)
 21677*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21678*       INITIMG  (GETMAIN-SPACE)
 21679*       RESP     (WS-RESPONSE)
 21680*    END-EXEC
 21681*    MOVE ',"IL                  $  N#00018130' TO DFHEIV0
 21682     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21683     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21684     MOVE X'204E233030303138313330' TO DFHEIV0(25:11)
 21685     CALL 'kxdfhei1' USING DFHEIV0,
 21686           DFHEIV20,
 21687           ERPNDB-RECORD-LENGTH,
 21688           GETMAIN-SPACE
 21689     SET ADDRESS OF PENDING-BUSINESS TO
 21690         DFHEIV20
 21691     MOVE EIBRESP  TO WS-RESPONSE
 21692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21693
 21694* EXEC CICS READ
 21695*       INTO    (PENDING-BUSINESS)
 21696*       DATASET (FILE-ID-ERPNDB)
 21697*       RIDFLD  (ERPNDB-KEY)
 21698*       RESP    (WS-RESPONSE)
 21699*    END-EXEC
 21700     MOVE LENGTH OF
 21701      PENDING-BUSINESS
 21702       TO DFHEIV11
 21703*    MOVE '&"IL       E          (  N#00018136' TO DFHEIV0
 21704     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21705     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21706     MOVE X'204E233030303138313336' TO DFHEIV0(25:11)
 21707     CALL 'kxdfhei1' USING DFHEIV0,
 21708           FILE-ID-ERPNDB,
 21709           PENDING-BUSINESS,
 21710           DFHEIV11,
 21711           ERPNDB-KEY,
 21712           DFHEIV99,
 21713           DFHEIV99,
 21714           DFHEIV99
 21715     MOVE EIBRESP  TO WS-RESPONSE
 21716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21717     IF RESP-NORMAL
 21718        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21719        IF (RESP-NORMAL)
 21720           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 399
* EL6311.cbl
 21721              AM-CONTROL-PRIMARY (1:20))
 21722           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21723        ELSE
 21724           MOVE 'ACCOUNT NOT FOUND'
 21725                                 TO VD-ACCOUNT-NAME
 21726        END-IF
 21727        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21728                                    TO M1
 21729        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21730        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21731           (A2 > M1)
 21732           OR (WS-WORK-FIELD (A2:1) = '*')
 21733           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21734           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21735        END-PERFORM
 21736        IF A2 > M1
 21737           CONTINUE
 21738        ELSE
 21739           MOVE WS-WORK-FIELD (1:A2 - 1)
 21740                                    TO VD-ACCOUNT-NAME
 21741        END-IF
 21742        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21743        MOVE PB-CARRIER          TO VD-CARRIER
 21744        MOVE PB-GROUPING         TO VD-GROUPING
 21745        MOVE PB-STATE            TO VD-STATE
 21746        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21747        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21748        MOVE PB-CERT-NO          TO VD-CERT-NO
 21749        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21750        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21751        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21752        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21753        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21754        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21755        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21756        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21757        MOVE PB-CSR-ID           TO VD-CSR-ID
 21758        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21759        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21760        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21761        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21762        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21763        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21764        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21765        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21766        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21767        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21768        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21769        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21770        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21771     END-IF
 21772     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21773
 21774
 21775* EXEC CICS GETMAIN
 21776*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21777*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21778*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 400
* EL6311.cbl
 21779*       RESP     (WS-RESPONSE)
 21780*    END-EXEC
 21781*    MOVE ',"IL                  $  N#00018199' TO DFHEIV0
 21782     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21783     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21784     MOVE X'204E233030303138313939' TO DFHEIV0(25:11)
 21785     CALL 'kxdfhei1' USING DFHEIV0,
 21786           DFHEIV20,
 21787           ERPNDM-RECORD-LENGTH,
 21788           GETMAIN-SPACE
 21789     SET ADDRESS OF PENDING-MAILING-DATA TO
 21790         DFHEIV20
 21791     MOVE EIBRESP  TO WS-RESPONSE
 21792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21793
 21794
 21795* EXEC CICS READ
 21796*       INTO    (PENDING-MAILING-DATA)
 21797*       DATASET (FILE-ID-ERPNDM)
 21798*       RIDFLD  (ERPNDM-KEY)
 21799*       RESP    (WS-RESPONSE)
 21800*    END-EXEC
 21801     MOVE LENGTH OF
 21802      PENDING-MAILING-DATA
 21803       TO DFHEIV11
 21804*    MOVE '&"IL       E          (  N#00018206' TO DFHEIV0
 21805     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21807     MOVE X'204E233030303138323036' TO DFHEIV0(25:11)
 21808     CALL 'kxdfhei1' USING DFHEIV0,
 21809           FILE-ID-ERPNDM,
 21810           PENDING-MAILING-DATA,
 21811           DFHEIV11,
 21812           ERPNDM-KEY,
 21813           DFHEIV99,
 21814           DFHEIV99,
 21815           DFHEIV99
 21816     MOVE EIBRESP  TO WS-RESPONSE
 21817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21818
 21819     IF RESP-NORMAL
 21820        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21821        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21822        MOVE PM-CITY              TO VD-INSURED-CITY
 21823        MOVE PM-STATE             TO VD-INSURED-STATE
 21824        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21825     END-IF
 21826
 21827     MOVE 'VAC1'                  TO VD-LETTER-ID
 21828     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21829     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21830     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21831     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21832     MOVE +0                      TO VD-ARCHIVE-NO
 21833     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21834     .
 21835 6200-EXIT.
 21836     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 401
* EL6311.cbl
 21837 6210-READ-ERACCT.
 21838     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21839     MOVE LOW-VALUES             TO ERACCT-FILL
 21840
 21841* EXEC CICS READ
 21842*         DATASET   ('ERACCT')
 21843*         INTO      (ACCOUNT-MASTER)
 21844*         RIDFLD    (ERACCT-KEY)
 21845*         GTEQ
 21846*         RESP      (WS-RESPONSE)
 21847*    END-EXEC
 21848     MOVE LENGTH OF
 21849      ACCOUNT-MASTER
 21850       TO DFHEIV11
 21851     MOVE 'ERACCT' TO DFHEIV1
 21852*    MOVE '&"IL       G          (  N#00018234' TO DFHEIV0
 21853     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21854     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21855     MOVE X'204E233030303138323334' TO DFHEIV0(25:11)
 21856     CALL 'kxdfhei1' USING DFHEIV0,
 21857           DFHEIV1,
 21858           ACCOUNT-MASTER,
 21859           DFHEIV11,
 21860           ERACCT-KEY,
 21861           DFHEIV99,
 21862           DFHEIV99,
 21863           DFHEIV99
 21864     MOVE EIBRESP  TO WS-RESPONSE
 21865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21866     .
 21867 6210-EXIT.
 21868     EXIT.
 21869
 21870 6220-READ-ERMAIL.
 21871
 21872     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21873     MOVE ' '                    TO WS-ERMAIL-SW
 21874
 21875
 21876* EXEC CICS READ
 21877*       DATASET   (FILE-ID-ERMAIL)
 21878*       SET       (ADDRESS OF MAILING-DATA)
 21879*       RIDFLD    (ERMAIL-KEY)
 21880*       RESP      (WS-RESPONSE)
 21881*    END-EXEC
 21882*    MOVE '&"S        E          (  N#00018250' TO DFHEIV0
 21883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21885     MOVE X'204E233030303138323530' TO DFHEIV0(25:11)
 21886     CALL 'kxdfhei1' USING DFHEIV0,
 21887           FILE-ID-ERMAIL,
 21888           DFHEIV20,
 21889           DFHEIV99,
 21890           ERMAIL-KEY,
 21891           DFHEIV99,
 21892           DFHEIV99,
 21893           DFHEIV99
 21894     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 402
* EL6311.cbl
 21895         DFHEIV20
 21896     MOVE EIBRESP  TO WS-RESPONSE
 21897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21898
 21899     IF RESP-NORMAL
 21900        SET ERMAIL-FOUND TO TRUE
 21901     END-IF
 21902     .
 21903 6220-EXIT.
 21904     EXIT.
 21905
 21906 6400-CHECK-FOR-RES-REF-CLAIM.
 21907     display 'made it to 6400- for ' pi-cert-no
 21908     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21909
 21910     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21911                                    W-CL-COMP-CD.
 21912     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21913                                    W-CL-CERT-NO.
 21914     MOVE SPACES                 TO MSTR-CERT-SFX.
 21915
 21916
 21917* EXEC CICS HANDLE CONDITION
 21918*        NOTFND  (6400-CONTINUE)
 21919*        ENDFILE (6400-CONTINUE)
 21920*    END-EXEC.
 21921*    MOVE '"$I''                  ! X #00018274' TO DFHEIV0
 21922     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21923     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21924     MOVE X'5820233030303138323734' TO DFHEIV0(25:11)
 21925     CALL 'kxdfhei1' USING DFHEIV0
 21926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21927
 21928
 21929
 21930* EXEC CICS IGNORE CONDITION
 21931*        DUPKEY
 21932*    END-EXEC.
 21933*    MOVE '"*$                   !   #00018279' TO DFHEIV0
 21934     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21936     MOVE X'2020233030303138323739' TO DFHEIV0(25:11)
 21937     CALL 'kxdfhei1' USING DFHEIV0
 21938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21939
 21940
 21941
 21942* EXEC CICS STARTBR
 21943*        DATASET   (CLMS-ID)
 21944*        RIDFLD    (ELMSTR-KEY)
 21945*        GENERIC   EQUAL
 21946*        KEYLENGTH (ELMSTR-LENGTH)
 21947*    END-EXEC.
 21948     MOVE 0
 21949       TO DFHEIV11
 21950*    MOVE '&,   KG    E          &   #00018283' TO DFHEIV0
 21951     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21952     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 403
* EL6311.cbl
 21953     MOVE X'2020233030303138323833' TO DFHEIV0(25:11)
 21954     CALL 'kxdfhei1' USING DFHEIV0,
 21955           CLMS-ID,
 21956           ELMSTR-KEY,
 21957           ELMSTR-LENGTH,
 21958           DFHEIV11,
 21959           DFHEIV99
 21960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21961
 21962
 21963     display 'browse started'
 21964     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21965
 21966 6400-NEXT-CLAIM.
 21967
 21968
 21969* EXEC CICS READNEXT
 21970*        DATASET   (CLMS-ID)
 21971*        RIDFLD    (ELMSTR-KEY)
 21972*        SET       (ADDRESS OF CLAIM-MASTER)
 21973*    END-EXEC.
 21974     MOVE 0
 21975       TO DFHEIV11
 21976*    MOVE '&.S                   )   #00018295' TO DFHEIV0
 21977     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21978     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21979     MOVE X'2020233030303138323935' TO DFHEIV0(25:11)
 21980     CALL 'kxdfhei1' USING DFHEIV0,
 21981           CLMS-ID,
 21982           DFHEIV20,
 21983           DFHEIV99,
 21984           ELMSTR-KEY,
 21985           DFHEIV99,
 21986           DFHEIV11,
 21987           DFHEIV99,
 21988           DFHEIV99
 21989     SET ADDRESS OF CLAIM-MASTER TO
 21990         DFHEIV20
 21991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21992
 21993
 21994     display 'read claim for ' mstr-cert-no
 21995     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21996        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21997         GO TO 6400-CONTINUE
 21998     END-IF.
 21999
 22000     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22001        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22002        PI-STATE       NOT = CL-CERT-STATE     OR
 22003        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22004        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22005         GO TO 6400-NEXT-CLAIM
 22006     END-IF.
 22007
 22008     display 'found claim ' cl-claim-no
 22009        ' with denial type ' cl-denial-type
 22010     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 404
* EL6311.cbl
 22011         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22012         GO TO 6400-CONTINUE
 22013     END-IF.
 22014
 22015     GO TO 6400-NEXT-CLAIM.
 22016
 22017 6400-CONTINUE.
 22018
 22019     IF WS-BROWSE-STARTED-SW = 'Y'
 22020
 22021* EXEC CICS ENDBR
 22022*            DATASET   (CLMS-ID)
 22023*        END-EXEC
 22024     MOVE 0
 22025       TO DFHEIV11
 22026*    MOVE '&2                    $   #00018327' TO DFHEIV0
 22027     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22028     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22029     MOVE X'2020233030303138333237' TO DFHEIV0(25:11)
 22030     CALL 'kxdfhei1' USING DFHEIV0,
 22031           CLMS-ID,
 22032           DFHEIV11,
 22033           DFHEIV99
 22034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22035         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22036     END-IF.
 22037
 22038 6400-EXIT.
 22039     EXIT.
 22040
 22041 7000-DISPLAY-ISSUES.
 22042
 22043     IF PI-DISPLAY-ORIGINAL-BATCH
 22044        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22045        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22046     ELSE
 22047        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22048
 22049     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22050
 22051     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22052     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22053
 22054     MOVE LOW-VALUES                 TO EL631BI.
 22055     MOVE ZEROS                      TO PI-BPMTAMT
 22056                                        PI-BPMTS.
 22057     MOVE SPACE                      TO PI-BMODE
 22058                                        PI-BTYPE (1)
 22059                                        PI-BTYPE (2).
 22060     MOVE EL631B                     TO PI-MAP-NAME.
 22061     MOVE 'Y'                        TO PI-BROWSE-SW.
 22062     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22063                                        PI-HIGH-SEQ-NO.
 22064
 22065     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22066        MOVE AL-SABOF                TO BCHGTA
 22067        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22068        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 405
* EL6311.cbl
 22069     ELSE
 22070        MOVE AL-SADOF                TO BCHGTA
 22071                                        BCHGA
 22072        MOVE PB-CHG-COUNT            TO BCHGO.
 22073
 22074     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22075     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22076     MOVE WS-HR-MINS                 TO BMANTATO.
 22077
 22078     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22079        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22080        MOVE SPACE                   TO DC-OPTION-CODE
 22081        PERFORM 9700-DATE-LINK
 22082        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22083        MOVE 'INACTIVE'              TO BMOENDTO
 22084     ELSE
 22085        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22086        MOVE SPACE                   TO DC-OPTION-CODE
 22087        PERFORM 9700-DATE-LINK
 22088        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22089        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22090        MOVE SPACE                   TO DC-OPTION-CODE
 22091        PERFORM 9700-DATE-LINK
 22092        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22093
 22094*    MOVE PB-I-REFERENCE             TO BREFO.
 22095
 22096*    IF PI-COMPANY-ID EQUAL 'HER'
 22097*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22098*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22099*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22100*                MOVE WS-MEMBER-NO-1-8
 22101*                                TO  BMICRNOO.
 22102
 22103*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22104*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22105*            MOVE PB-I-MICROFILM-NO
 22106*                                TO  BMICRNOO.
 22107     IF PB-I-VIN NOT = SPACES
 22108        MOVE PB-I-VIN            TO BVINO
 22109     END-IF
 22110
 22111     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22112     MOVE PB-CERT-SFX                TO BSUFIXO.
 22113     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22114     MOVE SPACE                      TO DC-OPTION-CODE.
 22115     PERFORM 9700-DATE-LINK.
 22116     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22117
 22118     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22119     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22120     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22121     MOVE PB-I-INSURED-SEX           TO BSEXO
 22122
 22123     IF PB-I-AGE NOT = ZEROS
 22124         MOVE PB-I-AGE               TO BAGEO.
 22125
 22126     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 406
* EL6311.cbl
 22127                                 TO ELCERT-KEY
 22128     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22129     IF NOT CERT-TRL-REC-NOT-FOUND
 22130         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22131             MOVE 'AGE*'             TO BAGEDEFO
 22132         ELSE
 22133             MOVE 'AGE '             TO BAGEDEFO
 22134         END-IF
 22135     ELSE
 22136         MOVE 'AGE '             TO BAGEDEFO
 22137     END-IF
 22138
 22139     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22140         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22141         MOVE SPACE                  TO DC-OPTION-CODE
 22142         PERFORM 9700-DATE-LINK
 22143         IF NO-CONVERSION-ERROR
 22144            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22145
 22146     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22147         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22148         MOVE SPACE                  TO DC-OPTION-CODE
 22149         PERFORM 9700-DATE-LINK
 22150         IF NO-CONVERSION-ERROR
 22151            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22152
 22153     IF PB-I-EXTENTION-DAYS NUMERIC
 22154        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22155           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22156        ELSE
 22157           IF PB-I-TERM-IN-DAYS NUMERIC
 22158              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22159                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22160
 22161     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22162        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22163
 22164     MOVE PB-FORCE-CODE              TO BFORCEO.
 22165     MOVE PB-I-TERM-TYPE             TO BMODEO
 22166                                        PI-BMODE.
 22167
 22168     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22169        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22170
 22171     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22172         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22173                                        PI-BPMTS.
 22174
 22175     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22176         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22177           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22178                                        PI-BPMTAMT.
 22179
 22180     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22181     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22182     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22183     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22184     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 407
* EL6311.cbl
 22185     MOVE PB-I-SIG-SW                TO BSIGO.
 22186     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22187     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22188     MOVE PB-RECORD-BILL             TO BBILCDO.
 22189     MOVE PB-FORCE-CODE              TO BFORCEO.
 22190
 22191     IF (PB-I-LIVES NUMERIC)
 22192        AND (PB-I-LIVES > ZEROS)
 22193        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22194        IF (RESP-NORMAL)
 22195           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22196           CONTINUE
 22197        ELSE
 22198           MOVE PB-I-LIVES       TO BLIVESO
 22199        END-IF
 22200     END-IF
 22201
 22202     IF PB-I-NUM-BILLED NUMERIC AND
 22203        PB-I-NUM-BILLED GREATER THAN ZEROS
 22204        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22205*    ELSE
 22206*       MOVE ZEROS                   TO BBILLEDO.
 22207
 22208     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22209
 22210     IF PB-I-LOAN-APR NOT = +99.9999
 22211        MOVE PB-I-LOAN-APR           TO BAPRO.
 22212
 22213     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22214        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22215
 22216     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22217        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22218           MOVE AL-SANOF                TO BORIGHDA
 22219           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22220           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22221
 22222     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22223
 22224     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22225        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22226
 22227     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22228        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22229                                        PI-BTYPE (1).
 22230
 22231     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22232        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22233
 22234     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22235        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22236
 22237     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22238        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22239
 22240     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22241        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22242
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 408
* EL6311.cbl
 22243     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22244        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22245
 22246     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22247         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22248         MOVE SPACE                  TO DC-OPTION-CODE
 22249         PERFORM 9700-DATE-LINK
 22250         IF NO-CONVERSION-ERROR
 22251            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22252
 22253     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22254        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22255        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22256        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22257        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22258                 GIVING BDIFFO (1)
 22259     ELSE
 22260        MOVE SPACES                  TO BBEN-CD     (1)
 22261                                        BBEN-ABBR   (1).
 22262
 22263     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22264        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22265        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22266                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22267
 22268     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22269       IF PB-RECORD-ON-HOLD
 22270          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22271
 22272     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22273       IF PB-RECORD-RETURNED
 22274          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22275
 22276     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22277        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22278             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22279
 22280     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22281
 22282     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22283        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22284
 22285     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22286        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22287                                        PI-BTYPE (2).
 22288
 22289     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22290        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22291
 22292     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22293        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22294
 22295     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22296        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22297
 22298     IF PB-I-TOT-FEES NOT NUMERIC
 22299        MOVE ZEROS               TO PB-I-TOT-FEES
 22300     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 409
* EL6311.cbl
 22301     IF PB-I-TOT-FEES > ZEROS
 22302        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22303
 22304     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22305         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22306         MOVE SPACE                  TO DC-OPTION-CODE
 22307         PERFORM 9700-DATE-LINK
 22308         IF NO-CONVERSION-ERROR
 22309            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22310
 22311     IF PB-I-TOT-FEES > ZEROS
 22312        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22313        SUBTRACT PB-I-TOT-FEES FROM
 22314                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22315
 22316     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22317        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22318        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22319        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22320        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22321                 GIVING BDIFFO (2)
 22322     ELSE
 22323        MOVE SPACES                  TO BBEN-CD     (2)
 22324                                        BBEN-ABBR   (2).
 22325
 22326     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22327       IF PB-RECORD-ON-HOLD
 22328          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22329
 22330     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22331       IF PB-RECORD-RETURNED
 22332          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22333
 22334     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22335        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22336             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22337
 22338     MOVE PB-CSR-ID                  TO BCSRO.
 22339
 22340     IF PI-COMPANY-ID  =  'DMD'
 22341        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22342            NEXT SENTENCE
 22343        ELSE
 22344            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22345               MOVE 'NEW CERT'       TO BNCERTLI
 22346               MOVE EC-NEW-CERT      TO BNCERTO.
 22347
 22348     IF PI-COMPANY-ID  =  'DMD'
 22349        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22350            NEXT SENTENCE
 22351        ELSE
 22352           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22353               MOVE 'NEW STATE'      TO BNSTATLI
 22354               MOVE EC-NEW-STATE     TO BNSTATO.
 22355
 22356 7000-CONTINUE.
 22357     MOVE 'C'                        TO BMAINTI.
 22358     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 410
* EL6311.cbl
 22359
 22360     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22361        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22362
 22363     IF PI-6315-FINALIZED = 'Y'   AND
 22364        PB-UNFORCED-ERRORS
 22365          MOVE -1                TO BFORCEL
 22366          MOVE  1                TO SET-CURSOR-SW
 22367     END-IF
 22368
 22369     IF NO-CURSOR-SET
 22370        MOVE -1                      TO BMAINTL.
 22371
 22372     GO TO 8100-SEND-INITIAL-MAP.
 22373
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 411
* EL6311.cbl
 22375
 22376******************************************************************
 22377*                                                                *
 22378*             D I S P L A Y   C A N C E L S                      *
 22379*                                                                *
 22380******************************************************************
 22381
 22382 7100-DISPLAY-CANCELS.
 22383     IF PI-DISPLAY-ORIGINAL-BATCH
 22384        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22385        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22386     ELSE
 22387        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22388
 22389     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22390
 22391     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22392     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22393
 22394     MOVE LOW-VALUES                 TO EL631CI.
 22395     MOVE EL631C                     TO PI-MAP-NAME.
 22396     MOVE 'Y'                        TO PI-BROWSE-SW.
 22397     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22398                                        PI-HIGH-SEQ-NO.
 22399
 22400     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22401        MOVE AL-SABOF                TO CCHGTA
 22402        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22403        MOVE AL-SANON                TO CCHGA
 22404      ELSE
 22405        MOVE AL-SADOF                TO CCHGTA
 22406                                        CCHGA
 22407        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22408
 22409*    MOVE PB-C-REFERENCE             TO CREFO.
 22410
 22411*    IF PB-C-MICROFILM-NO IS NUMERIC
 22412*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22413*          MOVE PB-C-MICROFILM-NO
 22414*                                TO CMICRNOO
 22415*          MOVE AL-UNNON         TO CMICRNOA
 22416*       END-IF
 22417*    END-IF
 22418     IF PB-C-NH-INT-ON-REFS NUMERIC
 22419        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22420           MOVE PB-C-NH-INT-ON-REFS
 22421                                 TO CNHINTO
 22422           MOVE AL-SANOF         TO CNHINTA
 22423        END-IF
 22424     END-IF
 22425     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22426     MOVE PB-CERT-SFX                TO CSUFIXO.
 22427     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22428     MOVE SPACE                      TO DC-OPTION-CODE.
 22429     PERFORM 9700-DATE-LINK.
 22430     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22431
 22432     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 412
* EL6311.cbl
 22433        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22434        MOVE SPACE                   TO DC-OPTION-CODE
 22435        PERFORM 9700-DATE-LINK
 22436        IF NO-CONVERSION-ERROR
 22437           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22438
 22439     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22440        NEXT SENTENCE
 22441     ELSE
 22442        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22443
 22444     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22445        NEXT SENTENCE
 22446     ELSE
 22447        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22448
 22449     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22450        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22451        MOVE SPACE                   TO DC-OPTION-CODE
 22452        PERFORM 9700-DATE-LINK
 22453        IF NO-CONVERSION-ERROR
 22454           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22455
 22456     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22457         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22458
 22459     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22460         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22461
 22462     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22463        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22464        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22465                 GIVING CDRFND1O.
 22466
 22467     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22468        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22469        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22470                 GIVING CDRFND2O.
 22471
 22472     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22473       IF PB-RECORD-ON-HOLD
 22474          MOVE 'ON HOLD'             TO CBILIT1O.
 22475
 22476     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22477       IF PB-RECORD-RETURNED
 22478          MOVE 'RETURNED'            TO CBILIT1O.
 22479
 22480     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22481        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22482             MOVE 'OVERRIDE'         TO CBILIT1O.
 22483
 22484     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22485       IF PB-RECORD-ON-HOLD
 22486          MOVE 'ON HOLD'             TO CBILIT2O.
 22487
 22488     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22489       IF PB-RECORD-RETURNED
 22490          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 413
* EL6311.cbl
 22491
 22492     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22493        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22494             MOVE 'OVERRIDE'         TO CBILIT2O.
 22495
 22496     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22497     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22498     IF PB-C-POST-CARD-IND = 'Y'
 22499        MOVE 'Y'                     TO CPCYNO
 22500     ELSE
 22501        MOVE 'N'                     TO CPCYNO
 22502     END-IF
 22503     MOVE PB-FORCE-CODE              TO CFORCEO.
 22504     MOVE PB-RECORD-BILL             TO CBILCDO.
 22505     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22506     MOVE SPACES                     TO CINITSO.
 22507     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22508         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22509     ELSE
 22510         MOVE PB-CI-INITIALS         TO CINITSO
 22511     END-IF.
 22512
 22513     IF PB-CI-CANCEL-FEE NUMERIC
 22514        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22515        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22516     ELSE
 22517        MOVE ZEROES                  TO W-CANCEL-FEE.
 22518
 22519     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22520
 22521     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22522        ADD PB-CI-LF-PREMIUM-AMT
 22523             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22524
 22525     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22526        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22527
 22528     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22529     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22530     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22531     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22532
 22533     IF PB-C-LIVES NUMERIC
 22534        MOVE PB-C-LIVES              TO CLIVESO.
 22535
 22536     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22537        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22538
 22539     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22540        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22541        MOVE SPACE                   TO DC-OPTION-CODE
 22542        PERFORM 9700-DATE-LINK
 22543        IF NO-CONVERSION-ERROR
 22544           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22545
 22546     IF  PB-C-REFUND-CREATED
 22547         MOVE 'YES'                  TO CRFNDSWO
 22548     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 414
* EL6311.cbl
 22549         IF PB-C-REFUND-REQUESTED
 22550            MOVE 'REQ'               TO CRFNDSWO
 22551         ELSE
 22552            MOVE 'NO'                TO CRFNDSWO.
 22553
 22554     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22555     MOVE SPACE                      TO DC-OPTION-CODE.
 22556     PERFORM 9700-DATE-LINK.
 22557     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22558     MOVE PB-INPUT-BY                TO CENTBYO.
 22559
 22560     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22561        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22562        MOVE SPACE                   TO DC-OPTION-CODE
 22563        PERFORM 9700-DATE-LINK
 22564        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22565        MOVE 'INACTIVE'              TO CMOENDTO
 22566     ELSE
 22567        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22568        MOVE SPACE                   TO DC-OPTION-CODE
 22569        PERFORM 9700-DATE-LINK
 22570        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22571        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22572        MOVE SPACE                   TO DC-OPTION-CODE
 22573        PERFORM 9700-DATE-LINK
 22574        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22575
 22576     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22577
 22578     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22579     MOVE WS-HR-MINS                 TO CMANTATO.
 22580
 22581     EVALUATE PB-LF-REFUND-TYPE
 22582        WHEN '1'
 22583           MOVE 'RULE78'            TO CLFREFNO
 22584        WHEN '2'
 22585           MOVE 'PRORAT'            TO CLFREFNO
 22586        WHEN '3'
 22587           MOVE 'CALIF'             TO CLFREFNO
 22588        WHEN '4'
 22589           MOVE 'IRREG'             TO CLFREFNO
 22590        WHEN '5'
 22591           MOVE 'NETPAY'            TO CLFREFNO
 22592        WHEN '6'
 22593           MOVE 'ATCP'              TO CLFREFNO
 22594        WHEN '7'
 22595           MOVE 'UTAH'              TO CLFREFNO
 22596        WHEN '8'
 22597           MOVE 'MEAN'              TO CLFREFNO
 22598        WHEN '9'
 22599           MOVE 'SUM '              TO CLFREFNO
 22600        WHEN 'B'
 22601           MOVE 'BALN'              TO CLFREFNO
 22602     END-EVALUATE.
 22603
 22604     EVALUATE TRUE
 22605        WHEN PB-AH-REFUND-TYPE =  '1'
 22606           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 415
* EL6311.cbl
 22607        WHEN PB-AH-REFUND-TYPE =  '2'
 22608           MOVE 'PRORAT'            TO CAHREFNO
 22609        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22610           MOVE 'CALIF'             TO CAHREFNO
 22611        WHEN PB-AH-REFUND-TYPE =  '4'
 22612           MOVE 'IRREG'             TO CAHREFNO
 22613        WHEN PB-AH-REFUND-TYPE =  '5'
 22614           MOVE 'NETPAY'            TO CAHREFNO
 22615        WHEN PB-AH-REFUND-TYPE =  '6'
 22616           MOVE 'ATCP'              TO CAHREFNO
 22617        WHEN PB-AH-REFUND-TYPE =  '7'
 22618           MOVE 'UTAH'              TO CAHREFNO
 22619        WHEN PB-AH-REFUND-TYPE =  '8'
 22620           MOVE 'MEAN'              TO CAHREFNO
 22621        WHEN PB-AH-REFUND-TYPE =  '9'
 22622           MOVE 'SUM '              TO CAHREFNO
 22623        WHEN PB-AH-REFUND-TYPE =  'B'
 22624           MOVE 'BALN'              TO CAHREFNO
 22625     END-EVALUATE.
 22626
 22627     MOVE PB-REIN-CD                 TO CREINCDO.
 22628
 22629     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22630        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22631        MOVE SPACE                   TO DC-OPTION-CODE
 22632        PERFORM 9700-DATE-LINK
 22633        IF NO-CONVERSION-ERROR
 22634           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22635
 22636     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22637        MOVE 999999                  TO WS-EXP-DT-EDIT
 22638        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22639        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22640     ELSE
 22641        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22642           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22643           MOVE SPACE                   TO DC-OPTION-CODE
 22644           PERFORM 9700-DATE-LINK
 22645           IF NO-CONVERSION-ERROR
 22646              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22647
 22648     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22649        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22650           MOVE AL-SANOF                TO CORIGHDA
 22651           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22652           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22653
 22654     MOVE PB-CSR-ID              TO CCSRO.
 22655
 22656     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22657     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22658
 22659     MOVE 'C'                    TO CMAINTI.
 22660     MOVE AL-UANON               TO CMAINTA.
 22661
 22662     IF PI-6316-FINALIZED = 'Y'  AND
 22663        PB-UNFORCED-ERRORS
 22664          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 416
* EL6311.cbl
 22665          MOVE  1                TO SET-CURSOR-SW
 22666     END-IF
 22667
 22668     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22669        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22670
 22671     IF NO-CURSOR-SET
 22672        MOVE -1                  TO CMAINTL.
 22673
 22674     GO TO 8100-SEND-INITIAL-MAP.
 22675
 22676
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 417
* EL6311.cbl
 22678***************************************************************
 22679*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22680*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22681***************************************************************
 22682
 22683 7200-DISPLAY-BATCHES.
 22684     MOVE EL631D                 TO PI-MAP-NAME.
 22685     MOVE LOW-VALUES             TO EL631DI.
 22686
 22687     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22688
 22689
 22690* EXEC CICS HANDLE CONDITION
 22691*         NOTFND   (3690-NOT-FOUND)
 22692*    END-EXEC.
 22693*    MOVE '"$I                   ! Y #00018984' TO DFHEIV0
 22694     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22696     MOVE X'5920233030303138393834' TO DFHEIV0(25:11)
 22697     CALL 'kxdfhei1' USING DFHEIV0
 22698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22699
 22700
 22701     IF PI-DISPLAY-SCREEN
 22702        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22703     ELSE
 22704        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22705
 22706     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22707     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22708
 22709
 22710* EXEC CICS READ
 22711*         DATASET   (FILE-ID-ERPNDB)
 22712*         RIDFLD    (ERPNDB-KEY)
 22713*         SET       (ADDRESS OF PENDING-BUSINESS)
 22714*    END-EXEC.
 22715*    MOVE '&"S        E          (   #00018996' TO DFHEIV0
 22716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22718     MOVE X'2020233030303138393936' TO DFHEIV0(25:11)
 22719     CALL 'kxdfhei1' USING DFHEIV0,
 22720           FILE-ID-ERPNDB,
 22721           DFHEIV20,
 22722           DFHEIV99,
 22723           ERPNDB-KEY,
 22724           DFHEIV99,
 22725           DFHEIV99,
 22726           DFHEIV99
 22727     SET ADDRESS OF PENDING-BUSINESS TO
 22728         DFHEIV20
 22729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22730
 22731
 22732     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22733     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22734     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22735     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 418
* EL6311.cbl
 22736     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22737
 22738     MOVE EL631D                 TO PI-MAP-NAME.
 22739     MOVE LOW-VALUES             TO EL631DI.
 22740     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22741
 22742*    IF PI-AR-PROCESSING
 22743*       MOVE PB-REFERENCE        TO DREFO.
 22744
 22745     MOVE PB-CSR-ID              TO DCSRO.
 22746
 22747     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22748        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22749        MOVE SPACE               TO DC-OPTION-CODE
 22750        PERFORM 9700-DATE-LINK
 22751        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22752        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22753        MOVE 'INACTIVE'          TO DLDATEO
 22754     ELSE
 22755        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22756        MOVE SPACE               TO DC-OPTION-CODE
 22757        PERFORM 9700-DATE-LINK
 22758        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22759
 22760     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22761     MOVE SPACE                  TO DC-OPTION-CODE.
 22762     PERFORM 9700-DATE-LINK.
 22763     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22764
 22765     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22766        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22767     ELSE
 22768        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22769        MOVE SPACE               TO DC-OPTION-CODE
 22770        PERFORM 9700-DATE-LINK
 22771        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22772
 22773     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22774     MOVE SPACE                  TO DC-OPTION-CODE.
 22775     PERFORM 9700-DATE-LINK.
 22776     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22777
 22778     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22779     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22780
 22781     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22782        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22783                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22784
 22785     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22786     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22787     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22788
 22789     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22790        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22791                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22792
 22793     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 419
* EL6311.cbl
 22794     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22795     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22796
 22797     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22798        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22799                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22800
 22801     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22802     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22803
 22804     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22805        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22806                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22807
 22808     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22809     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22810     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22811
 22812     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22813        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22814                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22815
 22816     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22817     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22818     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22819
 22820     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22821        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22822                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22823
 22824     MOVE -1                     TO DPFENTRL.
 22825     GO TO 8100-SEND-INITIAL-MAP.
 22826
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 420
* EL6311.cbl
 22828
 22829***************************************************************
 22830*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22831*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22832*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22833*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22834*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22835*     ARE THEN SET ACCORDINGLY.                               *
 22836*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22837*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22838*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22839***************************************************************
 22840
 22841******************************************************************
 22842*                                                                *
 22843*            E R R O R   A N A L Y S I S                         *
 22844*                                                                *
 22845******************************************************************
 22846
 22847******************************************************************
 22848*                                                                *
 22849*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22850*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22851*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22852*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22853*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22854*                                                                *
 22855*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22856*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22857*                                                                *
 22858******************************************************************
 22859
 22860 7300-FORMAT-ERRORS.
 22861     MOVE ' '                    TO PI-ERRORS-SW
 22862     IF PB-COMMON-ERRORS = LOW-VALUES
 22863        IF PB-FATAL-ERRORS
 22864           MOVE ER-2695          TO EMI-ERROR
 22865           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22866           GO TO 7399-EXIT.
 22867
 22868     MOVE +0                     TO WS-SUB4.
 22869
 22870 7310-ERROR-LOOP.
 22871
 22872     ADD +1                      TO WS-SUB4.
 22873
 22874     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22875        GO TO 7350-SET-ERROR-FLAGS.
 22876
 22877     IF PI-COMPANY-ID = 'UCL'
 22878         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22879             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22880             MOVE ' '                   TO DC-OPTION-CODE
 22881             PERFORM 9700-DATE-LINK
 22882             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22883
 22884     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22885     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 421
* EL6311.cbl
 22886     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22887
 22888     GO TO 7310-ERROR-LOOP.
 22889
 22890
 22891 7350-SET-ERROR-FLAGS.
 22892
 22893     IF EMI-FATAL-CTR NOT = ZEROS
 22894        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22895        MOVE 'X'                 TO PB-FATAL-FLAG
 22896                                    PI-ERRORS-SW
 22897        GO TO 7355-SET-ERROR-FLAGS.
 22898
 22899     move ' ' to pi-unforced-sw
 22900     IF EMI-FORCABLE-CTR NOT = ZEROS
 22901        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22902        IF PB-ISSUE
 22903           IF PB-ISSUE-FORCE
 22904              MOVE 'F'           TO PB-FORCE-ER-CD
 22905              MOVE ER-2600       TO EMI-ERROR
 22906              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22907             ELSE
 22908              MOVE 'X'           TO PB-FORCE-ER-CD
 22909*                                   PI-ERRORS-SW
 22910          ELSE
 22911           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22912              MOVE 'F'           TO PB-FORCE-ER-CD
 22913                                    pi-unforced-sw
 22914              MOVE ER-2600       TO EMI-ERROR
 22915              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22916             ELSE
 22917              MOVE 'X'           TO PB-FORCE-ER-CD
 22918                                    pi-unforced-sw.
 22919*                                   PI-ERRORS-SW.
 22920
 22921     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22922     IF PB-ISSUE
 22923         MOVE 'I'                TO ENDT-RECORD-TYPE
 22924     ELSE
 22925         MOVE 'C'                TO ENDT-RECORD-TYPE
 22926     END-IF
 22927     MOVE +0                     TO ENDT-SEQ-NO
 22928
 22929
 22930* EXEC CICS READ
 22931*        DATASET   (FILE-ID-ERENDT)
 22932*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22933*        RIDFLD    (ERENDT-KEY)
 22934*        RESP      (WS-RESPONSE)
 22935*        GTEQ
 22936*    END-EXEC
 22937*    MOVE '&"S        G          (  N#00019199' TO DFHEIV0
 22938     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22940     MOVE X'204E233030303139313939' TO DFHEIV0(25:11)
 22941     CALL 'kxdfhei1' USING DFHEIV0,
 22942           FILE-ID-ERENDT,
 22943           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 422
* EL6311.cbl
 22944           DFHEIV99,
 22945           ERENDT-KEY,
 22946           DFHEIV99,
 22947           DFHEIV99,
 22948           DFHEIV99
 22949     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22950         DFHEIV20
 22951     MOVE EIBRESP  TO WS-RESPONSE
 22952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22953
 22954     IF RESP-NORMAL
 22955        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22956        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22957            MOVE ER-0280          TO EMI-ERROR
 22958            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22959            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22960            EVALUATE TRUE
 22961              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22962                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22963              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22964                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22965              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22966                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22967            END-EVALUATE
 22968        END-IF
 22969     END-IF
 22970
 22971
 22972
 22973     IF FIRST-ENTRY OR
 22974        EIBAID = DFHPF1 OR DFHPF2
 22975        MOVE '0'                TO PI-EDIT-SW
 22976        GO TO 7399-EXIT.
 22977
 22978 7355-SET-ERROR-FLAGS.
 22979
 22980     IF EMI-WARNING-CTR NOT = ZEROS
 22981        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22982        MOVE 'W'                 TO PB-WARN-ER-CD.
 22983
 22984     IF PB-UNFORCED-ERRORS OR
 22985        PB-FATAL-ERRORS    OR
 22986        PB-RECORD-ON-HOLD  OR
 22987        PB-RECORD-RETURNED OR
 22988        PB-CANCELLATION
 22989          NEXT SENTENCE
 22990        ELSE
 22991          GO TO 7399-EXIT.
 22992
 22993
 22994* EXEC CICS  HANDLE CONDITION
 22995*           NOTFND   (7399-EXIT)
 22996*    END-EXEC.
 22997*    MOVE '"$I                   ! Z #00019246' TO DFHEIV0
 22998     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23000     MOVE X'5A20233030303139323436' TO DFHEIV0(25:11)
 23001     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 423
* EL6311.cbl
 23002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23003
 23004
 23005     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23006     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23007     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23008     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23009
 23010
 23011* EXEC CICS READ
 23012*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23013*        DATASET (FILE-ID-ELCERT)
 23014*        RIDFLD  (ELCERT-KEY)
 23015*        UPDATE
 23016*    END-EXEC.
 23017*    MOVE '&"S        EU         (   #00019255' TO DFHEIV0
 23018     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23020     MOVE X'2020233030303139323535' TO DFHEIV0(25:11)
 23021     CALL 'kxdfhei1' USING DFHEIV0,
 23022           FILE-ID-ELCERT,
 23023           DFHEIV20,
 23024           DFHEIV99,
 23025           ELCERT-KEY,
 23026           DFHEIV99,
 23027           DFHEIV99,
 23028           DFHEIV99
 23029     SET ADDRESS OF CERTIFICATE-MASTER TO
 23030         DFHEIV20
 23031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23032
 23033
 23034
 23035     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23036     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23037
 23038     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23039        GO TO 7360-REWRITE-CERT-MASTER.
 23040
 23041     IF PB-ISSUE
 23042        IF PB-RECORD-RETURNED
 23043            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23044            GO TO 7360-REWRITE-CERT-MASTER
 23045        ELSE
 23046            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23047            GO TO 7360-REWRITE-CERT-MASTER.
 23048
 23049     IF PB-RECORD-RETURNED
 23050         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23051         GO TO 7360-REWRITE-CERT-MASTER.
 23052
 23053     IF (PB-C-LF-CANCEL-VOIDED)
 23054        or (pb-c-ah-cancel-voided)
 23055        IF (PB-UNFORCED-ERRORS OR
 23056            PB-FATAL-ERRORS    OR
 23057            PB-RECORD-ON-HOLD)
 23058            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23059            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 424
* EL6311.cbl
 23060        ELSE
 23061            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23062            GO TO 7360-REWRITE-CERT-MASTER.
 23063
 23064     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23065                            OR PB-RECORD-ON-HOLD)
 23066        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23067     ELSE
 23068        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23069
 23070 7360-REWRITE-CERT-MASTER.
 23071
 23072     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23073        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23074
 23075* EXEC CICS UNLOCK
 23076*            DATASET    (FILE-ID-ELCERT)
 23077*       END-EXEC
 23078*    MOVE '&*                    #   #00019302' TO DFHEIV0
 23079     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23080     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23081     MOVE X'2020233030303139333032' TO DFHEIV0(25:11)
 23082     CALL 'kxdfhei1' USING DFHEIV0,
 23083           FILE-ID-ELCERT,
 23084           DFHEIV99
 23085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23086        GO TO 7399-EXIT.
 23087
 23088
 23089* EXEC CICS REWRITE
 23090*         DATASET    (FILE-ID-ELCERT)
 23091*         FROM       (CERTIFICATE-MASTER)
 23092*    END-EXEC.
 23093     MOVE LENGTH OF
 23094      CERTIFICATE-MASTER
 23095       TO DFHEIV11
 23096*    MOVE '&& L                  %   #00019307' TO DFHEIV0
 23097     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23098     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23099     MOVE X'2020233030303139333037' TO DFHEIV0(25:11)
 23100     CALL 'kxdfhei1' USING DFHEIV0,
 23101           FILE-ID-ELCERT,
 23102           CERTIFICATE-MASTER,
 23103           DFHEIV11,
 23104           DFHEIV99
 23105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23106
 23107
 23108 7399-EXIT.
 23109      EXIT.
 23110
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 425
* EL6311.cbl
 23112
 23113*************************************************************
 23114*                                                           *
 23115*              S E T   A T T R I B U T E S                  *
 23116*                                                           *
 23117*************************************************************
 23118
 23119 7400-SET-ATTRIBUTES.
 23120
 23121     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23122        GO TO 7499-EXIT.
 23123
 23124**2601**
 23125
 23126     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23127        IF PB-ISSUE
 23128           MOVE AL-UABON         TO BEFFDTA
 23129           GO TO 7499-EXIT
 23130         ELSE
 23131           MOVE AL-UABON         TO CEFFDTA
 23132           GO TO 7499-EXIT.
 23133
 23134**2604**
 23135
 23136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23137        IF PB-ISSUE
 23138           MOVE AL-UABON         TO BTYPE1A
 23139           MOVE -1               TO BTYPE1L
 23140           MOVE  1               TO SET-CURSOR-SW
 23141           GO TO 7499-EXIT.
 23142
 23143**2605**
 23144
 23145     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23146        IF PB-ISSUE
 23147           MOVE AL-UABON         TO BTYPE2A
 23148           MOVE -1               TO BTYPE2L
 23149           MOVE  1               TO SET-CURSOR-SW
 23150           GO TO 7499-EXIT.
 23151
 23152**2606**
 23153
 23154     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23155        IF PB-ISSUE
 23156           MOVE AL-UABON         TO BSIGA
 23157           MOVE -1               TO BSIGL
 23158           MOVE  1               TO SET-CURSOR-SW
 23159           GO TO 7499-EXIT.
 23160
 23161**2607**
 23162
 23163     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23164        IF PB-ISSUE
 23165           MOVE AL-UABON         TO BSIGA
 23166           MOVE -1               TO BSIGL
 23167           MOVE  1               TO SET-CURSOR-SW
 23168           GO TO 7499-EXIT.
 23169
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 426
* EL6311.cbl
 23170**2615**
 23171
 23172     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23173        IF PB-ISSUE
 23174           MOVE AL-UABOF         TO BREINA
 23175           MOVE -1               TO BREINL
 23176           GO TO 7499-EXIT.
 23177
 23178**2622**
 23179
 23180     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23181        IF PB-ISSUE
 23182           MOVE AL-UABON         TO BEFFDTA
 23183           GO TO 7499-EXIT
 23184        ELSE
 23185           MOVE AL-UABON         TO CEFFDTA
 23186           GO TO 7499-EXIT.
 23187
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 427
* EL6311.cbl
 23189
 23190*************************************************************
 23191*                                                           *
 23192*              I S S U E   E R R O R S                      *
 23193*                                                           *
 23194*************************************************************
 23195
 23196 7420-ISSUE-ERRORS.
 23197
 23198**2626**
 23199
 23200     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23201        MOVE AL-UABON            TO BCERTNOA
 23202        GO TO 7499-EXIT.
 23203
 23204**2627**
 23205
 23206     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23207        MOVE AL-UNBON            TO BAGEA
 23208        MOVE -1                  TO BAGEL
 23209        MOVE  1                  TO SET-CURSOR-SW
 23210        GO TO 7499-EXIT.
 23211
 23212**2628**
 23213
 23214     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23215        MOVE AL-UNBON            TO BAGEA
 23216        MOVE -1                  TO BAGEL
 23217        MOVE  1                  TO SET-CURSOR-SW
 23218        GO TO 7499-EXIT.
 23219
 23220**2629**
 23221
 23222     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23223        MOVE AL-UABON            TO BSEXA
 23224        MOVE -1                  TO BSEXL
 23225        MOVE  1                  TO SET-CURSOR-SW
 23226        GO TO 7499-EXIT.
 23227
 23228**2630**
 23229
 23230     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23231        MOVE -1                  TO BTYPE1L
 23232        MOVE  1                  TO SET-CURSOR-SW
 23233        GO TO 7499-EXIT.
 23234
 23235**2631**
 23236
 23237     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23238        MOVE -1                  TO BTYPE1L
 23239        MOVE  1                  TO SET-CURSOR-SW
 23240        GO TO 7499-EXIT.
 23241
 23242**2632**
 23243
 23244     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23245        MOVE AL-UNBON            TO BBEN1A
 23246        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 428
* EL6311.cbl
 23247        MOVE  1                  TO SET-CURSOR-SW
 23248        GO TO 7499-EXIT.
 23249
 23250**2633**
 23251
 23252     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23253        MOVE AL-UNBON            TO BPREM1A
 23254        MOVE -1                  TO BPREM1L
 23255        MOVE  1                  TO SET-CURSOR-SW
 23256        GO TO 7499-EXIT.
 23257
 23258**2634**
 23259
 23260     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23261        MOVE -1                  TO BTYPE2L
 23262        MOVE  1                  TO SET-CURSOR-SW
 23263        GO TO 7499-EXIT.
 23264
 23265**2635**
 23266
 23267     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23268        MOVE AL-UNBON            TO BBEN2A
 23269        MOVE -1                  TO BBEN2L
 23270        MOVE  1                  TO SET-CURSOR-SW
 23271        GO TO 7499-EXIT.
 23272
 23273**2636**
 23274
 23275     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23276        MOVE AL-UNBON            TO BPREM2A
 23277        MOVE -1                  TO BPREM2L
 23278        MOVE  1                  TO SET-CURSOR-SW
 23279        GO TO 7499-EXIT.
 23280
 23281**2639**
 23282
 23283     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23284        MOVE AL-UNBON            TO BBEN1A
 23285        MOVE -1                  TO BBEN1L
 23286        MOVE  1                  TO SET-CURSOR-SW
 23287        GO TO 7499-EXIT.
 23288
 23289**2640**
 23290
 23291     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23292        MOVE AL-UNBON            TO BBEN2A
 23293        MOVE -1                  TO BBEN2L
 23294        MOVE  1                  TO SET-CURSOR-SW
 23295        GO TO 7499-EXIT.
 23296
 23297**2647**
 23298
 23299     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23300        MOVE AL-UNBON            TO BTERM1A
 23301        MOVE -1                  TO BTERM1L
 23302        MOVE  1                  TO SET-CURSOR-SW
 23303        GO TO 7499-EXIT.
 23304
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 429
* EL6311.cbl
 23305**2648**
 23306
 23307     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23308        MOVE AL-UNBON            TO BLNTRMA
 23309        MOVE -1                  TO BLNTRML
 23310        MOVE  1                  TO SET-CURSOR-SW
 23311        GO TO 7499-EXIT.
 23312
 23313**2649**
 23314
 23315     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23316        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23317            MOVE AL-UNBON            TO BPREM1A
 23318            MOVE -1                  TO BPREM1L
 23319            MOVE  1                  TO SET-CURSOR-SW
 23320            GO TO 7499-EXIT
 23321     ELSE
 23322        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23323           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23324            MOVE AL-UNBON            TO BPREM2A
 23325            MOVE -1                  TO BPREM2L
 23326            MOVE  1                  TO SET-CURSOR-SW
 23327            GO TO 7499-EXIT.
 23328
 23329**2650**
 23330
 23331     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23332        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23333            MOVE AL-UNBON        TO BPREM1A
 23334            MOVE -1              TO BPREM1L
 23335            MOVE  1              TO SET-CURSOR-SW
 23336            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23337                MOVE AL-UNBON        TO BPREM2A
 23338                MOVE -1              TO BPREM2L
 23339                MOVE  1              TO SET-CURSOR-SW
 23340                GO TO 7499-EXIT
 23341            ELSE
 23342                GO TO 7499-EXIT
 23343        ELSE
 23344            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23345                MOVE AL-UNBON        TO BPREM2A
 23346                MOVE -1              TO BPREM2L
 23347                MOVE  1              TO SET-CURSOR-SW
 23348                GO TO 7499-EXIT
 23349            ELSE
 23350                GO TO 7499-EXIT.
 23351
 23352**2651**
 23353
 23354     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23355        MOVE AL-UABON            TO BSIGA
 23356        MOVE -1                  TO BSIGL
 23357        MOVE  1                  TO SET-CURSOR-SW
 23358        GO TO 7499-EXIT.
 23359
 23360**2653**
 23361
 23362     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 430
* EL6311.cbl
 23363        MOVE AL-UABON            TO BFREQA
 23364        MOVE -1                  TO BFREQL
 23365        MOVE  1                  TO SET-CURSOR-SW
 23366        GO TO 7499-EXIT.
 23367
 23368**2654**
 23369
 23370     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23371        MOVE AL-UABON            TO BFREQA
 23372        MOVE -1                  TO BFREQL
 23373        MOVE  1                  TO SET-CURSOR-SW
 23374        GO TO 7499-EXIT.
 23375
 23376**2655**
 23377
 23378     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23379        MOVE AL-UABON            TO BFREQA
 23380        MOVE -1                  TO BFREQL
 23381        MOVE  1                  TO SET-CURSOR-SW
 23382        GO TO 7499-EXIT.
 23383
 23384**2656**
 23385
 23386     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23387        MOVE AL-UNBON            TO BAPRA
 23388        MOVE -1                  TO BAPRL
 23389        MOVE  1                  TO SET-CURSOR-SW
 23390        GO TO 7499-EXIT.
 23391
 23392**2657**
 23393
 23394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23395        MOVE AL-UNBON            TO BAPRA
 23396        MOVE -1                  TO BAPRL
 23397        MOVE  1                  TO SET-CURSOR-SW
 23398        GO TO 7499-EXIT.
 23399
 23400**2658**
 23401
 23402     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23403        MOVE AL-UNBON            TO BTERM2A
 23404        MOVE -1                  TO BTERM2L
 23405        MOVE  1                  TO SET-CURSOR-SW
 23406        GO TO 7499-EXIT.
 23407
 23408**2660**
 23409
 23410     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23411        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23412        MOVE -1                  TO BLSTNML
 23413        MOVE  1                  TO SET-CURSOR-SW
 23414        GO TO 7499-EXIT.
 23415
 23416
 23417**2662**
 23418
 23419     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23420        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 431
* EL6311.cbl
 23421        MOVE -1                  TO BAGEL
 23422        MOVE  1                  TO SET-CURSOR-SW
 23423        GO TO 7499-EXIT.
 23424
 23425**2663**
 23426
 23427     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23428        MOVE AL-UNBON            TO BAGEA
 23429        MOVE -1                  TO BAGEL
 23430        MOVE  1                  TO SET-CURSOR-SW
 23431        GO TO 7499-EXIT.
 23432
 23433**2664**
 23434
 23435     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23436        MOVE AL-UABON            TO BREINA
 23437        MOVE -1                  TO BREINL
 23438        MOVE  1                  TO SET-CURSOR-SW
 23439        GO TO 7499-EXIT.
 23440
 23441**2667**
 23442
 23443     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23444        MOVE AL-UNBON            TO BBEN2A
 23445        MOVE -1                  TO BBEN2L
 23446        MOVE  1                  TO SET-CURSOR-SW
 23447        GO TO 7499-EXIT.
 23448
 23449**2668**
 23450
 23451     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23452        MOVE AL-UABON            TO BEFFDTA
 23453        GO TO 7499-EXIT.
 23454
 23455**2669**
 23456
 23457     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23458       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23459       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23460        MOVE AL-UNBON            TO BAGEA
 23461        MOVE -1                  TO BAGEL
 23462        MOVE  1                  TO SET-CURSOR-SW
 23463        GO TO 7499-EXIT.
 23464
 23465**2670**
 23466
 23467     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23468        MOVE AL-UABON            TO BFORCEA
 23469        MOVE -1                  TO BFORCEL
 23470        MOVE  1                  TO SET-CURSOR-SW
 23471        GO TO 7499-EXIT.
 23472
 23473**2671**
 23474
 23475     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23476        MOVE AL-UABON            TO BEFFDTA
 23477        GO TO 7499-EXIT.
 23478
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 432
* EL6311.cbl
 23479**2672**
 23480
 23481     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23482        MOVE AL-UABON            TO BEFFDTA
 23483        GO TO 7499-EXIT.
 23484
 23485**2673**
 23486
 23487     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23488        MOVE AL-UABON            TO BEFFDTA
 23489        GO TO 7499-EXIT.
 23490
 23491**2674**
 23492
 23493     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23494        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23495        MOVE -1                  TO BTYPE1L
 23496        MOVE  1                  TO SET-CURSOR-SW
 23497        GO TO 7499-EXIT.
 23498
 23499**2677**
 23500
 23501     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23502        MOVE AL-UNBON            TO BTERM1A
 23503        MOVE -1                  TO BTERM1L
 23504        MOVE  1                  TO SET-CURSOR-SW
 23505        GO TO 7499-EXIT.
 23506
 23507**2678**
 23508
 23509     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23510        MOVE AL-UNBON            TO BTERM2A
 23511        MOVE -1                  TO BTERM2L
 23512        MOVE  1                  TO SET-CURSOR-SW
 23513        GO TO 7499-EXIT.
 23514
 23515**2679**
 23516
 23517     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23518        MOVE AL-UABON            TO BTYPE1A
 23519        MOVE -1                  TO BTYPE1L
 23520        MOVE  1                  TO SET-CURSOR-SW
 23521        GO TO 7499-EXIT.
 23522
 23523**2680**
 23524
 23525     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23526        MOVE AL-UABOF            TO B1STPMTA
 23527        MOVE -1                  TO B1STPMTL
 23528        MOVE  1                  TO SET-CURSOR-SW
 23529        GO TO 7499-EXIT.
 23530
 23531**2681**
 23532
 23533     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23534        MOVE AL-UABON            TO BDAYSA
 23535        MOVE -1                  TO BDAYSL
 23536        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 433
* EL6311.cbl
 23537        GO TO 7499-EXIT.
 23538
 23539**2682**
 23540
 23541     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23542        MOVE AL-UABON            TO BTERM1A
 23543        MOVE -1                  TO BTERM1L
 23544        MOVE  1                  TO SET-CURSOR-SW
 23545        GO TO 7499-EXIT.
 23546
 23547**2683**
 23548
 23549     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23550        MOVE AL-UABON            TO BSKPCDA
 23551        MOVE -1                  TO BSKPCDL
 23552        MOVE  1                  TO SET-CURSOR-SW
 23553        GO TO 7499-EXIT.
 23554
 23555**2684**
 23556
 23557     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23558        MOVE AL-UABON            TO BTYPE2A
 23559        MOVE -1                  TO BTYPE2L
 23560        MOVE  1                  TO SET-CURSOR-SW
 23561        GO TO 7499-EXIT.
 23562
 23563**2686**
 23564
 23565     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23566        MOVE AL-UABON            TO BTYPE2A
 23567        MOVE -1                  TO BTYPE2L
 23568        MOVE  1                  TO SET-CURSOR-SW
 23569        GO TO 7499-EXIT.
 23570
 23571**2689**
 23572
 23573     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23574        MOVE AL-UABON            TO BSIGA
 23575        MOVE -1                  TO BSIGL
 23576        MOVE  1                  TO SET-CURSOR-SW
 23577        GO TO 7499-EXIT.
 23578
 23579**2690**
 23580
 23581     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23582        MOVE AL-UABOF            TO BLNOFCRA
 23583        MOVE -1                  TO BLNOFCRL
 23584        MOVE  1                  TO SET-CURSOR-SW
 23585        GO TO 7499-EXIT.
 23586
 23587**2693**
 23588
 23589     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23590        MOVE AL-UABOF            TO BLNOFCRA
 23591        MOVE AL-UNBON            TO BBEN1A
 23592        MOVE -1                  TO BBEN1L
 23593        MOVE  1                  TO SET-CURSOR-SW
 23594        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 434
* EL6311.cbl
 23595
 23596**2720**
 23597
 23598     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23599        MOVE AL-UNBON            TO BBEN1A
 23600        MOVE -1                  TO BBEN1L
 23601        MOVE  1                  TO SET-CURSOR-SW
 23602        GO TO 7499-EXIT.
 23603
 23604**2709**
 23605
 23606*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23607*       MOVE AL-UNBON            TO BBEN1A
 23608*       MOVE -1                  TO BBEN1L
 23609*       MOVE  1                  TO SET-CURSOR-SW
 23610*       GO TO 7499-EXIT.
 23611
 23612*************************************************************
 23613*                                                           *
 23614*            C A N C E L   E R R O R S                      *
 23615*                                                           *
 23616*************************************************************
 23617
 23618**2726**
 23619
 23620     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23621        MOVE AL-UABON            TO CCERTNOA
 23622        GO TO 7499-EXIT.
 23623
 23624**2728**
 23625
 23626     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23627        MOVE AL-UABON            TO CCERTNOA
 23628        GO TO 7499-EXIT.
 23629
 23630**2729**
 23631
 23632     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23633        MOVE AL-UABON            TO CCERTNOA
 23634        GO TO 7499-EXIT.
 23635
 23636**2730**
 23637
 23638     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23639        MOVE AL-UABON            TO CCERTNOA
 23640        GO TO 7499-EXIT.
 23641
 23642**2731**
 23643
 23644     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23645        MOVE AL-UABON            TO CCANDT1A
 23646        MOVE -1                  TO CCANDT1L
 23647        MOVE  1                  TO SET-CURSOR-SW
 23648        GO TO 7499-EXIT.
 23649
 23650**2732**
 23651
 23652     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 435
* EL6311.cbl
 23653        MOVE AL-UABON            TO CCANDT1A
 23654        MOVE -1                  TO CCANDT1L
 23655        MOVE  1                  TO SET-CURSOR-SW
 23656        GO TO 7499-EXIT.
 23657
 23658**2733**
 23659
 23660     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23661        MOVE AL-UABON            TO CCANDT1A
 23662        MOVE -1                  TO CCANDT1L
 23663        MOVE  1                  TO SET-CURSOR-SW
 23664        GO TO 7499-EXIT.
 23665
 23666**2734**
 23667
 23668     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23669        MOVE AL-UNBON            TO CREFND1A
 23670        MOVE -1                  TO CREFND1L
 23671        MOVE  1                  TO SET-CURSOR-SW
 23672        GO TO 7499-EXIT.
 23673
 23674**2735**
 23675
 23676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23677        MOVE AL-UABON            TO CCANDT2A
 23678        MOVE -1                  TO CCANDT2L
 23679        MOVE  1                  TO SET-CURSOR-SW
 23680        GO TO 7499-EXIT.
 23681
 23682**2736**
 23683
 23684     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23685        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23686            MOVE AL-UNBON        TO CREFND1A
 23687            MOVE -1              TO CREFND1L
 23688            MOVE  1              TO SET-CURSOR-SW
 23689            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23690                MOVE AL-UNBON        TO CREFND2A
 23691                MOVE -1              TO CREFND2L
 23692                MOVE  1              TO SET-CURSOR-SW
 23693                GO TO 7499-EXIT
 23694            ELSE
 23695                GO TO 7499-EXIT
 23696        ELSE
 23697            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23698                MOVE AL-UNBON        TO CREFND2A
 23699                MOVE -1              TO CREFND2L
 23700                MOVE  1              TO SET-CURSOR-SW
 23701                GO TO 7499-EXIT
 23702            ELSE
 23703                GO TO 7499-EXIT.
 23704
 23705**2738**
 23706
 23707     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23708        MOVE -1                  TO CREFND2L
 23709        MOVE  1                  TO SET-CURSOR-SW
 23710        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 436
* EL6311.cbl
 23711
 23712**2739**
 23713
 23714     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23715        MOVE -1                  TO CREFND1L
 23716        MOVE  1                  TO SET-CURSOR-SW
 23717        GO TO 7499-EXIT.
 23718
 23719**2741**
 23720
 23721     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23722        MOVE -1                  TO CREFND1L
 23723        MOVE  1                  TO SET-CURSOR-SW
 23724        GO TO 7499-EXIT.
 23725
 23726**2743**
 23727
 23728     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23729        MOVE AL-UNBON            TO CCANDT1A
 23730        MOVE -1                  TO CCANDT1L
 23731        MOVE  1                  TO SET-CURSOR-SW
 23732        GO TO 7499-EXIT.
 23733
 23734**2744**
 23735
 23736     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23737        MOVE AL-UNBON            TO CCANDT2A
 23738        MOVE -1                  TO CCANDT2L
 23739        MOVE  1                  TO SET-CURSOR-SW
 23740        GO TO 7499-EXIT.
 23741
 23742**2747**
 23743
 23744     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23745        MOVE AL-UABON            TO CLSTNMA
 23746        MOVE -1                  TO CLSTNML
 23747        MOVE  1                  TO SET-CURSOR-SW
 23748        GO TO 7499-EXIT.
 23749
 23750**2749**
 23751
 23752     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23753        MOVE AL-UABON            TO CFORCEA
 23754        MOVE -1                  TO CFORCEL
 23755        MOVE  1                  TO SET-CURSOR-SW
 23756        GO TO 7499-EXIT.
 23757
 23758**2753**
 23759
 23760     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23761        MOVE AL-UNBON            TO CCANDT1A
 23762        MOVE -1                  TO CCANDT1L
 23763        MOVE  1                  TO SET-CURSOR-SW
 23764        GO TO 7499-EXIT.
 23765
 23766**2755**
 23767
 23768     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 437
* EL6311.cbl
 23769        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23770            MOVE AL-UNBON        TO CREFND1A
 23771            MOVE -1              TO CREFND1L
 23772            MOVE  1              TO SET-CURSOR-SW
 23773            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23774                MOVE AL-UNBON        TO CREFND2A
 23775                MOVE -1              TO CREFND2L
 23776                MOVE  1              TO SET-CURSOR-SW
 23777                GO TO 7499-EXIT
 23778            ELSE
 23779                GO TO 7499-EXIT
 23780        ELSE
 23781            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23782                MOVE AL-UNBON        TO CREFND2A
 23783                MOVE -1              TO CREFND2L
 23784                MOVE  1              TO SET-CURSOR-SW
 23785            ELSE
 23786                GO TO 7499-EXIT.
 23787
 23788**2757**
 23789
 23790     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23791        MOVE AL-UNBON            TO CLIVESA
 23792        MOVE -1                  TO CLIVESL
 23793        MOVE  1                  TO SET-CURSOR-SW
 23794        GO TO 7499-EXIT.
 23795
 23796**2771**
 23797
 23798     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23799        MOVE AL-UABON            TO CCANDT2A
 23800        MOVE -1                  TO CCANDT2L
 23801        MOVE  1                  TO SET-CURSOR-SW
 23802        GO TO 7499-EXIT.
 23803
 23804**2774**
 23805
 23806     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23807        MOVE AL-UABON            TO CCANDT1A
 23808        MOVE -1                  TO CCANDT1L
 23809        MOVE  1                  TO SET-CURSOR-SW
 23810        GO TO 7499-EXIT.
 23811
 23812**2775**
 23813
 23814     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23815        MOVE AL-UABON            TO CCANDT2A
 23816        MOVE -1                  TO CCANDT2L
 23817        MOVE  1                  TO SET-CURSOR-SW
 23818        GO TO 7499-EXIT.
 23819
 23820**2776**
 23821
 23822     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23823        MOVE AL-UABON            TO CCANDT1A
 23824        MOVE -1                  TO CCANDT1L
 23825        MOVE  1                  TO SET-CURSOR-SW
 23826        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 438
* EL6311.cbl
 23827
 23828
 23829**2777**
 23830
 23831     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23832        MOVE AL-UABON            TO CCANDT2A
 23833        MOVE -1                  TO CCANDT2L
 23834        MOVE  1                  TO SET-CURSOR-SW
 23835        GO TO 7499-EXIT.
 23836
 23837**2794**
 23838
 23839     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23840        MOVE AL-UABON            TO CFORCEA
 23841        MOVE -1                  TO CFORCEL
 23842        MOVE  1                  TO SET-CURSOR-SW
 23843        GO TO 7499-EXIT.
 23844
 23845**2799**
 23846
 23847     IF PI-COMPANY-ID = 'UCL'
 23848         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23849             MOVE AL-UNBON            TO BEFFDTA
 23850             MOVE -1                  TO BEFFDTL
 23851             MOVE  1                  TO SET-CURSOR-SW
 23852             GO TO 7499-EXIT.
 23853
 23854 7499-EXIT.
 23855      EXIT.
 23856
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 439
* EL6311.cbl
 23858
 23859 7500-READ-ERLOFC.
 23860     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23861                                     ERLOFC-KEY.
 23862
 23863     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23864
 23865     IF ST-ACCNT-CNTL
 23866         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23867
 23868     IF CARR-GROUP-ST-ACCNT-CNTL
 23869         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23870         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23871         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23872
 23873     IF CARR-ST-ACCNT-CNTL
 23874         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23875         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23876
 23877     IF CARR-ACCNT-CNTL
 23878         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23879
 23880     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23881
 23882     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23883
 23884
 23885* EXEC CICS HANDLE CONDITION
 23886*        NOTFND   (7550-OFFICER-NOTFND)
 23887*    END-EXEC.
 23888*    MOVE '"$I                   ! [ #00020088' TO DFHEIV0
 23889     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23891     MOVE X'5B20233030303230303838' TO DFHEIV0(25:11)
 23892     CALL 'kxdfhei1' USING DFHEIV0
 23893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23894
 23895
 23896
 23897* EXEC CICS READ
 23898*        DATASET   (FILE-ID-ERLOFC)
 23899*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23900*        RIDFLD    (ERLOFC-KEY)
 23901*        EQUAL
 23902*    END-EXEC.
 23903*    MOVE '&"S        E          (   #00020092' TO DFHEIV0
 23904     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23906     MOVE X'2020233030303230303932' TO DFHEIV0(25:11)
 23907     CALL 'kxdfhei1' USING DFHEIV0,
 23908           FILE-ID-ERLOFC,
 23909           DFHEIV20,
 23910           DFHEIV99,
 23911           ERLOFC-KEY,
 23912           DFHEIV99,
 23913           DFHEIV99,
 23914           DFHEIV99
 23915     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 440
* EL6311.cbl
 23916         DFHEIV20
 23917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23918
 23919
 23920     GO TO 7599-EXIT.
 23921
 23922 7550-OFFICER-NOTFND.
 23923     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23924
 23925 7599-EXIT.
 23926      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 441
* EL6311.cbl
 23928******************************************************************
 23929*                                                                *
 23930*            S  E N D    I N I T I A L   M A P                   *
 23931*                                                                *
 23932******************************************************************
 23933
 23934 8100-SEND-INITIAL-MAP.
 23935     MOVE EIBTIME                TO TIME-IN.
 23936
 23937     IF EIBAID = DFHPF11
 23938        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23939        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23940
 23941
 23942     IF PI-COMPANY-ID = CLIENT-GIC
 23943        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23944                                       BCPREM-ATTRB (2).
 23945
 23946     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23947                         CLIENT-PEM OR
 23948                         CLIENT-CSO)
 23949        AND PI-DISPLAY-ORIGINAL-BATCH
 23950          IF PI-MAP-NAME = EL631B
 23951             MOVE AL-SADOF               TO BPF5HDRA
 23952                                            BPF4HDRA
 23953          ELSE
 23954             IF PI-MAP-NAME = EL631C
 23955                MOVE AL-SADOF            TO CPF5HDRA
 23956                                            CPF4HDRA.
 23957
 23958     IF PI-MAP-NAME = EL631B
 23959        MOVE AL-SADOF               TO BPF5HDRA
 23960     ELSE
 23961        MOVE AL-SADOF               TO CPF5HDRA
 23962     END-IF
 23963
 23964*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23965     IF PI-MAP-NAME = EL631B
 23966          IF PI-COMPANY-ID NOT = 'DMD'
 23967             MOVE AL-SANOF            TO BBILLEDA
 23968             MOVE AL-SADOF            TO DMDBILA.
 23969*DMD CUSTOM CODING*************END
 23970
 23971     IF PI-PROCESSOR-ID = 'LGXX'
 23972        IF PI-MAP-NAME = EL631B
 23973           MOVE AL-SABOF                    TO BREFHDGA
 23974           MOVE AL-SANOF                    TO BREFA
 23975        ELSE
 23976           IF PI-MAP-NAME = EL631C
 23977              MOVE AL-SABOF                 TO CREFHDGA
 23978              MOVE AL-SANOF                 TO CREFA.
 23979
 23980*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23981     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23982        NEXT SENTENCE
 23983     ELSE
 23984        IF PI-MAP-NAME = EL631C
 23985           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 442
* EL6311.cbl
 23986                                       CCANFEEA.
 23987
 23988     IF PI-MAP-NAME = EL631D
 23989        IF PI-AR-PROCESSING
 23990           MOVE AL-SANOF            TO DREFHDGA
 23991        ELSE
 23992           MOVE AL-SADOF            TO DREFHDGA.
 23993
 23994     IF (PI-COMPANY-ID NOT = 'DCC')
 23995        AND (PI-MAP-NAME = EL631B)
 23996        MOVE AL-SADOF            TO BVINHA
 23997                                    BVINA
 23998     END-IF
 23999     IF PI-MAP-NAME = EL631B
 24000        IF CSR-EDIT-SESSION
 24001           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24002                                 TO BHEADO
 24003           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24004        ELSE
 24005           MOVE AL-SADOF         TO BF15HDRA
 24006           MOVE '4=B-HDR      '  TO BPF4HDRO
 24007        END-IF
 24008        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24009        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24010        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24011        MOVE WS-CURRENT-DT          TO BDATEO
 24012        MOVE TIME-OUT               TO BTIMEO
 24013        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24014        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24015        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24016        IF   WS-DISPLAY-SCREEN
 24017             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24018             MOVE PB-SV-CARRIER     TO BCARRO
 24019             MOVE PB-SV-GROUPING    TO BGROUPO
 24020             MOVE PB-SV-STATE       TO BSTATEO
 24021             MOVE PB-ACCOUNT        TO BACCTO
 24022        ELSE
 24023             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24024     ELSE
 24025        IF PI-MAP-NAME = EL631C
 24026           MOVE '4=B-HDR      '     TO CPF4HDRO
 24027           IF CSR-EDIT-SESSION
 24028              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24029                                 TO CHEADO
 24030           ELSE
 24031              MOVE AL-SADOF      TO CF15HDRA
 24032           END-IF
 24033           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24034           MOVE WS-CURRENT-DT          TO CDATEO
 24035           MOVE TIME-OUT               TO CTIMEO
 24036           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24037           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24038           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24039           MOVE WS-C-HDG               TO CLFHDGO
 24040           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24041           MOVE WS-C-HDG               TO CAHHDGO
 24042           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24043           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 443
* EL6311.cbl
 24044           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24045           IF   WS-DISPLAY-SCREEN
 24046                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24047                MOVE PB-SV-CARRIER     TO CCARRO
 24048                MOVE PB-SV-GROUPING    TO CGROUPO
 24049                MOVE PB-SV-STATE       TO CSTATEO
 24050                MOVE PB-ACCOUNT        TO CACCTO
 24051           ELSE
 24052                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24053        ELSE
 24054           MOVE WS-CURRENT-DT          TO DDATEO
 24055           MOVE TIME-OUT               TO DTIMEO
 24056           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24057                                          WS-REFUND-HDG-OVERRIDE
 24058           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24059           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24060           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24061                                          WS-REFUND-HDG-OVERRIDE
 24062           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24063           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24064           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24065           IF CSR-EDIT-SESSION
 24066              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24067                                 TO DHEADO
 24068           END-IF
 24069           IF  WS-DISPLAY-SCREEN
 24070               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24071               MOVE PB-CARRIER         TO DCARRO
 24072               MOVE PB-GROUPING        TO DGROUPO
 24073               MOVE PB-STATE           TO DSTATEO
 24074               MOVE PB-ACCOUNT         TO DACCTO
 24075               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24076           ELSE
 24077               MOVE EL631D             TO PI-MAP-NAME
 24078               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24079               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24080
 24081     MOVE SPACE                        TO WS-DISPLAY-SW.
 24082
 24083
 24084* EXEC CICS SEND
 24085*        MAP      (PI-MAP-NAME)
 24086*        MAPSET   (MAPSET-EL6311S)
 24087*        FROM     (EL631BI)
 24088*        ERASE
 24089*        CURSOR
 24090*    END-EXEC.
 24091     MOVE LENGTH OF
 24092      EL631BI
 24093       TO DFHEIV12
 24094     MOVE -1
 24095       TO DFHEIV11
 24096*    MOVE '8$     CT  E    H L F ,   #00020262' TO DFHEIV0
 24097     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 24098     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24099     MOVE X'2020233030303230323632' TO DFHEIV0(25:11)
 24100     CALL 'kxdfhei1' USING DFHEIV0,
 24101           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 444
* EL6311.cbl
 24102           EL631BI,
 24103           DFHEIV12,
 24104           MAPSET-EL6311S,
 24105           DFHEIV99,
 24106           DFHEIV99,
 24107           DFHEIV99,
 24108           DFHEIV11,
 24109           DFHEIV99,
 24110           DFHEIV99,
 24111           DFHEIV99
 24112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24113
 24114
 24115     GO TO 9100-RETURN-TRAN.
 24116
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 445
* EL6311.cbl
 24118
 24119******************************************************************
 24120*                                                                *
 24121*              S E N D    D A T A O N L Y                        *
 24122*                                                                *
 24123******************************************************************
 24124
 24125 8200-SEND-DATAONLY.
 24126     MOVE EIBTIME                TO TIME-IN.
 24127
 24128     IF PI-COMPANY-ID = CLIENT-GIC
 24129        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24130                                       BCPREM-ATTRB (2).
 24131
 24132     IF PI-MAP-NAME = EL631B
 24133        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24134        MOVE WS-CURRENT-DT          TO BDATEO
 24135        MOVE TIME-OUT               TO BTIMEO
 24136        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24137        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24138        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24139        MOVE SPACES                 TO BPFENTRO
 24140        MOVE AL-UANOF               TO BPFENTRA
 24141
 24142*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24143        IF PI-COMPANY-ID NOT = 'DMD'
 24144             MOVE AL-SANOF            TO BBILLEDA
 24145             MOVE AL-SADOF            TO DMDBILA
 24146         ELSE
 24147            NEXT SENTENCE
 24148*DMD CUSTOM CODING*************END
 24149     ELSE
 24150        IF PI-MAP-NAME = EL631C
 24151           MOVE WS-CURRENT-DT          TO CDATEO
 24152           MOVE TIME-OUT               TO CTIMEO
 24153           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24154           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24155           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24156           MOVE SPACES                 TO CPFENTRO
 24157           MOVE AL-UANOF               TO CPFENTRA
 24158        ELSE
 24159           MOVE WS-CURRENT-DT          TO DDATEO
 24160           MOVE TIME-OUT               TO DTIMEO
 24161           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24162
 24163
 24164* EXEC CICS SEND
 24165*        MAP      (PI-MAP-NAME)
 24166*        MAPSET   (MAPSET-EL6311S)
 24167*        FROM     (EL631BI)
 24168*        DATAONLY
 24169*        CURSOR
 24170*    END-EXEC.
 24171     MOVE LENGTH OF
 24172      EL631BI
 24173       TO DFHEIV12
 24174     MOVE -1
 24175       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 446
* EL6311.cbl
 24176*    MOVE '8$D    CT       H L F ,   #00020318' TO DFHEIV0
 24177     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24178     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24179     MOVE X'2020233030303230333138' TO DFHEIV0(25:11)
 24180     CALL 'kxdfhei1' USING DFHEIV0,
 24181           PI-MAP-NAME,
 24182           EL631BI,
 24183           DFHEIV12,
 24184           MAPSET-EL6311S,
 24185           DFHEIV99,
 24186           DFHEIV99,
 24187           DFHEIV99,
 24188           DFHEIV11,
 24189           DFHEIV99,
 24190           DFHEIV99,
 24191           DFHEIV99
 24192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24193
 24194
 24195     GO TO 9100-RETURN-TRAN.
 24196
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 447
* EL6311.cbl
 24198
 24199******************************************************************
 24200*                                                                *
 24201*           U T I L I T Y   R O U T I N E S                      *
 24202*                                                                *
 24203******************************************************************
 24204
 24205 8300-SEND-TEXT.
 24206
 24207* EXEC CICS SEND TEXT
 24208*        FROM     (LOGOFF-TEXT)
 24209*        LENGTH   (LOGOFF-LENGTH)
 24210*        ERASE
 24211*        FREEKB
 24212*    END-EXEC.
 24213*    MOVE '8&      T  E F  H   F -   #00020337' TO DFHEIV0
 24214     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24215     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24216     MOVE X'2020233030303230333337' TO DFHEIV0(25:11)
 24217     CALL 'kxdfhei1' USING DFHEIV0,
 24218           LOGOFF-TEXT,
 24219           LOGOFF-LENGTH,
 24220           DFHEIV99,
 24221           DFHEIV99,
 24222           DFHEIV99,
 24223           DFHEIV99,
 24224           DFHEIV99,
 24225           DFHEIV99,
 24226           DFHEIV99,
 24227           DFHEIV99,
 24228           DFHEIV99,
 24229           DFHEIV99
 24230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24231
 24232
 24233
 24234* EXEC CICS RETURN
 24235*    END-EXEC.
 24236*    MOVE '.(                    ''   #00020344' TO DFHEIV0
 24237     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24238     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24239     MOVE X'2020233030303230333434' TO DFHEIV0(25:11)
 24240     CALL 'kxdfhei1' USING DFHEIV0,
 24241           DFHEIV99,
 24242           DFHEIV99,
 24243           DFHEIV99,
 24244           DFHEIV99,
 24245           DFHEIV99,
 24246           DFHEIV99
 24247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24248
 24249
 24250 8400-LOG-JOURNAL-RECORD.
 24251     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24252     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24253
 24254*    EXEC CICS JOURNAL
 24255*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 448
* EL6311.cbl
 24256*        JTYPEID     ('EL')
 24257*        FROM        (JOURNAL-RECORD)
 24258*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24259*    END-EXEC.
 24260
 24261 8600-DEEDIT.
 24262
 24263* EXEC CICS BIF DEEDIT
 24264*         FIELD   (DEEDIT-FIELD)
 24265*         LENGTH  (15)
 24266*    END-EXEC.
 24267     MOVE 15
 24268       TO DFHEIV11
 24269*    MOVE '@"L                   #   #00020359' TO DFHEIV0
 24270     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24271     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24272     MOVE X'2020233030303230333539' TO DFHEIV0(25:11)
 24273     CALL 'kxdfhei1' USING DFHEIV0,
 24274           DEEDIT-FIELD,
 24275           DFHEIV11
 24276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24277
 24278
 24279 8800-UNAUTHORIZED-ACCESS.
 24280     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24281     GO TO 8300-SEND-TEXT.
 24282
 24283 8810-PF23.
 24284     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24285     MOVE XCTL-EL005             TO PGM-NAME.
 24286     GO TO 9300-XCTL.
 24287
 24288 9100-RETURN-TRAN.
 24289     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24290
 24291     IF  PI-MAP-NAME =  EL631B
 24292         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24293
 24294     IF  PI-MAP-NAME =  EL631C
 24295         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24296
 24297     IF  PI-MAP-NAME =  EL631D
 24298         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24299
 24300
 24301* EXEC CICS RETURN
 24302*        TRANSID    (TRANS-EXB1)
 24303*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24304*        LENGTH     (1300)
 24305*    END-EXEC.
 24306     MOVE 1300
 24307       TO DFHEIV11
 24308*    MOVE '.(CT                  ''   #00020385' TO DFHEIV0
 24309     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24311     MOVE X'2020233030303230333835' TO DFHEIV0(25:11)
 24312     CALL 'kxdfhei1' USING DFHEIV0,
 24313           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 449
* EL6311.cbl
 24314           PROGRAM-INTERFACE-BLOCK,
 24315           DFHEIV11,
 24316           DFHEIV99,
 24317           DFHEIV99,
 24318           DFHEIV99
 24319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24320
 24321
 24322 9200-RETURN-MAIN-MENU.
 24323     MOVE XCTL-EL626             TO PGM-NAME.
 24324     GO TO 9300-XCTL.
 24325
 24326 9300-XCTL.
 24327
 24328* EXEC CICS XCTL
 24329*        PROGRAM    (PGM-NAME)
 24330*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24331*        LENGTH     (PI-COMM-LENGTH)
 24332*    END-EXEC.
 24333*    MOVE '.$C                   %   #00020396' TO DFHEIV0
 24334     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24335     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24336     MOVE X'2020233030303230333936' TO DFHEIV0(25:11)
 24337     CALL 'kxdfhei1' USING DFHEIV0,
 24338           PGM-NAME,
 24339           PROGRAM-INTERFACE-BLOCK,
 24340           PI-COMM-LENGTH,
 24341           DFHEIV99
 24342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24343
 24344
 24345 9400-CLEAR.
 24346     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24347     GO TO 9300-XCTL.
 24348
 24349 9500-PF12.
 24350     MOVE XCTL-EL010             TO PGM-NAME.
 24351     GO TO 9300-XCTL.
 24352
 24353 9600-PGMID-ERROR.
 24354
 24355* EXEC CICS HANDLE CONDITION
 24356*        PGMIDERR    (8300-SEND-TEXT)
 24357*    END-EXEC.
 24358*    MOVE '"$L                   ! \ #00020411' TO DFHEIV0
 24359     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24361     MOVE X'5C20233030303230343131' TO DFHEIV0(25:11)
 24362     CALL 'kxdfhei1' USING DFHEIV0
 24363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24364
 24365
 24366     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24367     MOVE ' '                    TO PI-ENTRY-CD-1.
 24368     MOVE XCTL-EL005             TO PGM-NAME.
 24369     MOVE PGM-NAME               TO LOGOFF-PGM.
 24370     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24371     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 450
* EL6311.cbl
 24372
 24373 9700-DATE-LINK.
 24374     MOVE LINK-ELDATCV           TO PGM-NAME.
 24375
 24376* EXEC CICS LINK
 24377*        PROGRAM    (PGM-NAME)
 24378*        COMMAREA   (DATE-CONVERSION-DATA)
 24379*        LENGTH     (DC-COMM-LENGTH)
 24380*    END-EXEC.
 24381*    MOVE '."C                   (   #00020424' TO DFHEIV0
 24382     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24384     MOVE X'2020233030303230343234' TO DFHEIV0(25:11)
 24385     CALL 'kxdfhei1' USING DFHEIV0,
 24386           PGM-NAME,
 24387           DATE-CONVERSION-DATA,
 24388           DC-COMM-LENGTH,
 24389           DFHEIV99,
 24390           DFHEIV99,
 24391           DFHEIV99,
 24392           DFHEIV99
 24393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24394
 24395
 24396 9800-LINK-PENDING-EDIT.
 24397     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24398     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24399
 24400     MOVE LINK-EL050             TO PGM-NAME
 24401     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24402     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24403                                    WK-CO-TOL-CLAIM
 24404                                    WK-CO-TOL-PREM
 24405                                    WK-CO-TOL-REFUND
 24406                                    WK-CO-TOL-PREM-PCT
 24407                                    WK-CO-TOL-REFUND-PCT
 24408                                    WK-REFUND-OVS-AMT
 24409                                    WK-REFUND-OVS-PCT
 24410                                    WK-ACCT-ADDR
 24411                                    WK-LIFE-EDIT-ADDR
 24412                                    WK-AH-EDIT-ADDR
 24413                                    WK-LIFE-BEN-ADDR
 24414                                    WK-AH-BEN-ADDR
 24415                                    WK-STATE-ADDR
 24416                                    WK-PLAN-ADDR
 24417                                    WK-FORM-ADDR
 24418     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24419
 24420     MOVE '6'                    TO WK-ENTRY-SW.
 24421
 24422     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24423
 24424     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24425                                    EC-AM-EXPIRATION-DT
 24426                                    EC-AM-EFFECTIVE-DT
 24427                                    EC-CM-LF-CANCEL-DT
 24428                                    EC-CM-AH-CANCEL-DT
 24429                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 451
* EL6311.cbl
 24430
 24431     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24432                                    EC-CO-TOL-REFUND
 24433                                    EC-CO-MIN-AGE
 24434                                    EC-CO-MIN-PREMIUM
 24435                                    EC-CO-MIN-TERM
 24436                                    EC-CO-MAX-TERM
 24437                                    EC-ST-TOL-PREM
 24438                                    EC-ST-TOL-REFUND
 24439                                    EC-AM-LF-TOL-PREM
 24440                                    EC-AM-AH-TOL-PREM
 24441                                    EC-AM-LF-MAX-ATT-AGE
 24442                                    EC-AM-LF-MAX-AGE
 24443                                    EC-AM-LF-MAX-TERM
 24444                                    EC-AM-LF-MAX-TOT-BEN
 24445                                    EC-AM-AH-MAX-ATT-AGE
 24446                                    EC-AM-AH-MAX-AGE
 24447                                    EC-AM-AH-MAX-TERM
 24448                                    EC-AM-AH-MAX-TOT-BEN
 24449                                    EC-AM-AH-MAX-MON-BEN
 24450                                    EC-RT-LF-MAX-ATT-AGE
 24451                                    EC-RT-LF-MAX-AGE
 24452                                    EC-RT-LF-MAX-TERM
 24453                                    EC-RT-LF-MAX-TOT-BEN
 24454                                    EC-RT-AH-MAX-ATT-AGE
 24455                                    EC-RT-AH-MAX-AGE
 24456                                    EC-RT-AH-MAX-TERM
 24457                                    EC-RT-AH-MAX-TOT-BEN
 24458                                    EC-RT-AH-MAX-MON-BEN
 24459                                    EC-RT-AH-RATE
 24460                                    EC-RT-LF-RATE
 24461                                    EC-RT-LF-NSP-RATE
 24462                                    EC-RT-AH-NSP-RATE
 24463                                    EC-CM-LF-PRIOR-REFUND
 24464                                    EC-CM-AH-PRIOR-REFUND.
 24465
 24466     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24467                                    EC-ST-TOL-PREM-PCT
 24468                                    EC-AM-LF-TOL-REFUND
 24469                                    EC-AM-LF-DEV-PERCENT
 24470                                    EC-CO-TOL-REFUND-PCT
 24471                                    EC-ST-TOL-REFUND-PCT
 24472                                    EC-AM-AH-TOL-REFUND
 24473                                    EC-AM-AH-DEV-PERCENT.
 24474
 24475
 24476* EXEC CICS LINK
 24477*         PROGRAM   (PGM-NAME)
 24478*         COMMAREA  (PASSED-RECORD)
 24479*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24480*    END-EXEC.
 24481*    MOVE '."C                   (   #00020509' TO DFHEIV0
 24482     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24484     MOVE X'2020233030303230353039' TO DFHEIV0(25:11)
 24485     CALL 'kxdfhei1' USING DFHEIV0,
 24486           PGM-NAME,
 24487           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 452
* EL6311.cbl
 24488           WS-EDIT-PASS-LENGTH,
 24489           DFHEIV99,
 24490           DFHEIV99,
 24491           DFHEIV99,
 24492           DFHEIV99
 24493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24494
 24495
 24496     MOVE '1'                    TO PI-EDIT-SW.
 24497     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24498
 24499     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24500
 24501     IF PI-COMPANY-ID = 'UCL'
 24502         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24503
 24504     IF VALID-PB-ID
 24505        GO TO 9800-EXIT.
 24506
 24507     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24508
 24509     IF PI-MAP-NAME = EL631B
 24510        MOVE -1                  TO BMAINTL
 24511       ELSE
 24512        MOVE -1                  TO CMAINTL.
 24513
 24514     GO TO 8200-SEND-DATAONLY.
 24515
 24516 9800-EXIT.
 24517      EXIT.
 24518
 24519 9900-ERROR-FORMAT.
 24520
 24521     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24522
 24523     IF NOT EMI-ERRORS-COMPLETE
 24524         MOVE LINK-EL001         TO PGM-NAME
 24525
 24526* EXEC CICS LINK
 24527*            PROGRAM    (PGM-NAME)
 24528*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24529*            LENGTH     (EMI-COMM-LENGTH)
 24530*        END-EXEC.
 24531*    MOVE '."C                   (   #00020544' TO DFHEIV0
 24532     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24534     MOVE X'2020233030303230353434' TO DFHEIV0(25:11)
 24535     CALL 'kxdfhei1' USING DFHEIV0,
 24536           PGM-NAME,
 24537           ERROR-MESSAGE-INTERFACE-BLOCK,
 24538           EMI-COMM-LENGTH,
 24539           DFHEIV99,
 24540           DFHEIV99,
 24541           DFHEIV99,
 24542           DFHEIV99
 24543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24544
 24545
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 453
* EL6311.cbl
 24546 9900-EXIT.
 24547     EXIT.
 24548
 24549 9990-ABEND.
 24550     MOVE LINK-EL004             TO PGM-NAME.
 24551     MOVE DFHEIBLK               TO EMI-LINE1.
 24552
 24553* EXEC CICS LINK
 24554*        PROGRAM   (PGM-NAME)
 24555*        COMMAREA  (EMI-LINE1)
 24556*        LENGTH    (72)
 24557*    END-EXEC.
 24558     MOVE 72
 24559       TO DFHEIV11
 24560*    MOVE '."C                   (   #00020556' TO DFHEIV0
 24561     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24563     MOVE X'2020233030303230353536' TO DFHEIV0(25:11)
 24564     CALL 'kxdfhei1' USING DFHEIV0,
 24565           PGM-NAME,
 24566           EMI-LINE1,
 24567           DFHEIV11,
 24568           DFHEIV99,
 24569           DFHEIV99,
 24570           DFHEIV99,
 24571           DFHEIV99
 24572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24573
 24574
 24575     IF PI-MAP-NAME = EL631B
 24576        MOVE -1                  TO BMAINTL
 24577       ELSE
 24578        MOVE -1                  TO CMAINTL.
 24579
 24580     IF EIBTRNID NOT = TRANS-EXB1
 24581        GO TO 8100-SEND-INITIAL-MAP
 24582       ELSE
 24583        GO TO 8200-SEND-DATAONLY.
 24584
 24585 9995-SECURITY-VIOLATION.
 24586*                            COPY ELCSCTP.
 24587******************************************************************
 24588*                                                                *
 24589*                            ELCSCTP                             *
 24590*                            VMOD=2.001                          *
 24591*                                                                *
 24592*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24593******************************************************************
 24594
 24595
 24596     MOVE EIBDATE          TO SM-JUL-DATE.
 24597     MOVE EIBTRMID         TO SM-TERMID.
 24598     MOVE THIS-PGM         TO SM-PGM.
 24599     MOVE EIBTIME          TO TIME-IN.
 24600     MOVE TIME-OUT         TO SM-TIME.
 24601     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24602
 24603
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 454
* EL6311.cbl
 24604* EXEC CICS LINK
 24605*         PROGRAM  ('EL003')
 24606*         COMMAREA (SECURITY-MESSAGE)
 24607*         LENGTH   (80)
 24608*    END-EXEC.
 24609     MOVE 'EL003' TO DFHEIV1
 24610     MOVE 80
 24611       TO DFHEIV11
 24612*    MOVE '."C                   (   #00020590' TO DFHEIV0
 24613     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24614     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24615     MOVE X'2020233030303230353930' TO DFHEIV0(25:11)
 24616     CALL 'kxdfhei1' USING DFHEIV0,
 24617           DFHEIV1,
 24618           SECURITY-MESSAGE,
 24619           DFHEIV11,
 24620           DFHEIV99,
 24621           DFHEIV99,
 24622           DFHEIV99,
 24623           DFHEIV99
 24624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24625
 24626
 24627******************************************************************
 24628
 24629
 24630 9999-DFHBACK SECTION.
 24631     MOVE '9%                    "   ' TO DFHEIV0
 24632     MOVE 'EL6311' TO DFHEIV1
 24633     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24634     GOBACK.
 24635 9999-DFHEXIT.
 24636     IF DFHEIGDJ EQUAL 0001
 24637         NEXT SENTENCE
 24638     ELSE IF DFHEIGDJ EQUAL 2
 24639         GO TO 9600-PGMID-ERROR,
 24640               9990-ABEND,
 24641               9990-ABEND,
 24642               0010-MAIN-LOGIC
 24643         DEPENDING ON DFHEIGDI
 24644     ELSE IF DFHEIGDJ EQUAL 3
 24645         GO TO 1280-BATCH-HDR-NOT-FOUND
 24646         DEPENDING ON DFHEIGDI
 24647     ELSE IF DFHEIGDJ EQUAL 4
 24648         GO TO 1290-DUPLICATE-ALT-INDEX
 24649         DEPENDING ON DFHEIGDI
 24650     ELSE IF DFHEIGDJ EQUAL 5
 24651         GO TO 1295-CERT-TRL-REC-NOTFND
 24652         DEPENDING ON DFHEIGDI
 24653     ELSE IF DFHEIGDJ EQUAL 6
 24654         GO TO 1380-BATCH-HDR-NOT-FOUND
 24655         DEPENDING ON DFHEIGDI
 24656     ELSE IF DFHEIGDJ EQUAL 7
 24657         GO TO 1385-REC-NOT-FOUND
 24658         DEPENDING ON DFHEIGDI
 24659     ELSE IF DFHEIGDJ EQUAL 8
 24660         GO TO 1386-NOTFND
 24661         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 455
* EL6311.cbl
 24662     ELSE IF DFHEIGDJ EQUAL 9
 24663         GO TO 1399-EXIT
 24664         DEPENDING ON DFHEIGDI
 24665     ELSE IF DFHEIGDJ EQUAL 10
 24666         GO TO 1480-BATCH-HDR-NOT-FOUND
 24667         DEPENDING ON DFHEIGDI
 24668     ELSE IF DFHEIGDJ EQUAL 11
 24669         GO TO 1490-RECORD-NOT-FOUND
 24670         DEPENDING ON DFHEIGDI
 24671     ELSE IF DFHEIGDJ EQUAL 12
 24672         GO TO 1405-DELETE-CERTIFICATE
 24673         DEPENDING ON DFHEIGDI
 24674     ELSE IF DFHEIGDJ EQUAL 13
 24675         GO TO 1420-CONTINUE-DELETE
 24676         DEPENDING ON DFHEIGDI
 24677     ELSE IF DFHEIGDJ EQUAL 14
 24678         GO TO 1406-DELETE-ERNOTE
 24679         DEPENDING ON DFHEIGDI
 24680     ELSE IF DFHEIGDJ EQUAL 15
 24681         GO TO 1407-DELETE-MAILING
 24682         DEPENDING ON DFHEIGDI
 24683     ELSE IF DFHEIGDJ EQUAL 16
 24684         GO TO 1420-CONTINUE-DELETE
 24685         DEPENDING ON DFHEIGDI
 24686     ELSE IF DFHEIGDJ EQUAL 17
 24687         GO TO 1480-BATCH-HDR-NOT-FOUND
 24688         DEPENDING ON DFHEIGDI
 24689     ELSE IF DFHEIGDJ EQUAL 18
 24690         GO TO 1475-DELETE-FINISHED
 24691         DEPENDING ON DFHEIGDI
 24692     ELSE IF DFHEIGDJ EQUAL 19
 24693         GO TO 2280-BATCH-HDR-NOT-FOUND
 24694         DEPENDING ON DFHEIGDI
 24695     ELSE IF DFHEIGDJ EQUAL 20
 24696         GO TO 2290-DUPLICATE-ALT-INDEX
 24697         DEPENDING ON DFHEIGDI
 24698     ELSE IF DFHEIGDJ EQUAL 21
 24699         GO TO 2380-BATCH-HDR-NOT-FOUND
 24700         DEPENDING ON DFHEIGDI
 24701     ELSE IF DFHEIGDJ EQUAL 22
 24702         GO TO 2385-REC-NOT-FOUND
 24703         DEPENDING ON DFHEIGDI
 24704     ELSE IF DFHEIGDJ EQUAL 23
 24705         GO TO 2380-BATCH-HDR-NOT-FOUND
 24706         DEPENDING ON DFHEIGDI
 24707     ELSE IF DFHEIGDJ EQUAL 24
 24708         GO TO 2485-BATCH-HDR-NOT-FOUND
 24709         DEPENDING ON DFHEIGDI
 24710     ELSE IF DFHEIGDJ EQUAL 25
 24711         GO TO 2490-RECORD-NOT-FOUND
 24712         DEPENDING ON DFHEIGDI
 24713     ELSE IF DFHEIGDJ EQUAL 26
 24714         GO TO 2475-CONTINUE-DELETE
 24715         DEPENDING ON DFHEIGDI
 24716     ELSE IF DFHEIGDJ EQUAL 27
 24717         GO TO 2485-BATCH-HDR-NOT-FOUND
 24718         DEPENDING ON DFHEIGDI
 24719     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 456
* EL6311.cbl
 24720         GO TO 2480-DELETE-FINISHED
 24721         DEPENDING ON DFHEIGDI
 24722     ELSE IF DFHEIGDJ EQUAL 29
 24723         GO TO 2820-PROCESS-REWRITE
 24724         DEPENDING ON DFHEIGDI
 24725     ELSE IF DFHEIGDJ EQUAL 30
 24726         GO TO 2885-RECORD-MISSING
 24727         DEPENDING ON DFHEIGDI
 24728     ELSE IF DFHEIGDJ EQUAL 31
 24729         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24730         DEPENDING ON DFHEIGDI
 24731     ELSE IF DFHEIGDJ EQUAL 32
 24732         GO TO 2827-DELETE-MAILING
 24733         DEPENDING ON DFHEIGDI
 24734     ELSE IF DFHEIGDJ EQUAL 33
 24735         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24736         DEPENDING ON DFHEIGDI
 24737     ELSE IF DFHEIGDJ EQUAL 34
 24738         GO TO 2920-PROCESS-REWRITE
 24739         DEPENDING ON DFHEIGDI
 24740     ELSE IF DFHEIGDJ EQUAL 35
 24741         GO TO 2985-RECORD-MISSING
 24742         DEPENDING ON DFHEIGDI
 24743     ELSE IF DFHEIGDJ EQUAL 36
 24744         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24745         DEPENDING ON DFHEIGDI
 24746     ELSE IF DFHEIGDJ EQUAL 37
 24747         GO TO 2990-DUPLICATE-RECORD
 24748         DEPENDING ON DFHEIGDI
 24749     ELSE IF DFHEIGDJ EQUAL 38
 24750         GO TO 3590-NOT-FOUND
 24751         DEPENDING ON DFHEIGDI
 24752     ELSE IF DFHEIGDJ EQUAL 39
 24753         GO TO 3690-NOT-FOUND
 24754         DEPENDING ON DFHEIGDI
 24755     ELSE IF DFHEIGDJ EQUAL 40
 24756         GO TO 3990-NOT-FOUND
 24757         DEPENDING ON DFHEIGDI
 24758     ELSE IF DFHEIGDJ EQUAL 41
 24759         GO TO 4050-END-RECORDS,
 24760               4050-END-RECORDS
 24761         DEPENDING ON DFHEIGDI
 24762     ELSE IF DFHEIGDJ EQUAL 42
 24763         GO TO 4150-END-BATCH
 24764         DEPENDING ON DFHEIGDI
 24765     ELSE IF DFHEIGDJ EQUAL 43
 24766         GO TO 4150-END-BATCH
 24767         DEPENDING ON DFHEIGDI
 24768     ELSE IF DFHEIGDJ EQUAL 44
 24769         GO TO 4250-END-RECORDS,
 24770               4250-END-RECORDS
 24771         DEPENDING ON DFHEIGDI
 24772     ELSE IF DFHEIGDJ EQUAL 45
 24773         GO TO 4350-END-BATCH,
 24774               4350-END-BATCH
 24775         DEPENDING ON DFHEIGDI
 24776     ELSE IF DFHEIGDJ EQUAL 46
 24777         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 15-Apr-14 13:47 Page 457
* EL6311.cbl
 24778               4550-END-RECORDS
 24779         DEPENDING ON DFHEIGDI
 24780     ELSE IF DFHEIGDJ EQUAL 47
 24781         GO TO 4680-NOT-FOUND,
 24782               4680-NOT-FOUND
 24783         DEPENDING ON DFHEIGDI
 24784     ELSE IF DFHEIGDJ EQUAL 48
 24785         GO TO 4860-NOT-FOUND,
 24786               4850-END-RECORDS
 24787         DEPENDING ON DFHEIGDI
 24788     ELSE IF DFHEIGDJ EQUAL 49
 24789         GO TO 4970-NOT-FOUND,
 24790               4950-END-RECORDS
 24791         DEPENDING ON DFHEIGDI
 24792     ELSE IF DFHEIGDJ EQUAL 50
 24793         GO TO 5050-NOT-FOUND
 24794         DEPENDING ON DFHEIGDI
 24795     ELSE IF DFHEIGDJ EQUAL 51
 24796         GO TO 5050-NOT-FOUND
 24797         DEPENDING ON DFHEIGDI
 24798     ELSE IF DFHEIGDJ EQUAL 52
 24799         GO TO 5050-NOT-FOUND
 24800         DEPENDING ON DFHEIGDI
 24801     ELSE IF DFHEIGDJ EQUAL 53
 24802         GO TO 5550-END-RECORDS,
 24803               5550-END-RECORDS
 24804         DEPENDING ON DFHEIGDI
 24805     ELSE IF DFHEIGDJ EQUAL 54
 24806         GO TO 6050-QID-ERROR
 24807         DEPENDING ON DFHEIGDI
 24808     ELSE IF DFHEIGDJ EQUAL 55
 24809         GO TO 6050-QID-ERROR
 24810         DEPENDING ON DFHEIGDI
 24811     ELSE IF DFHEIGDJ EQUAL 56
 24812         GO TO 6400-CONTINUE,
 24813               6400-CONTINUE
 24814         DEPENDING ON DFHEIGDI
 24815     ELSE IF DFHEIGDJ EQUAL 57
 24816         GO TO 3690-NOT-FOUND
 24817         DEPENDING ON DFHEIGDI
 24818     ELSE IF DFHEIGDJ EQUAL 58
 24819         GO TO 7399-EXIT
 24820         DEPENDING ON DFHEIGDI
 24821     ELSE IF DFHEIGDJ EQUAL 59
 24822         GO TO 7550-OFFICER-NOTFND
 24823         DEPENDING ON DFHEIGDI
 24824     ELSE IF DFHEIGDJ EQUAL 60
 24825         GO TO 8300-SEND-TEXT
 24826         DEPENDING ON DFHEIGDI.
 24827     MOVE '9%                    "   ' TO DFHEIV0
 24828     MOVE 'EL6311' TO DFHEIV1
 24829     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24830     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14900     Code:       98454
