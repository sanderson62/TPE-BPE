* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL689 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 04/20/94 15:10:07.
     8*                            VMOD=2.037
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12*DATE-COMPILED.
    13*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL689.cbl
    14*
    15******************************************************************
    16
    17* W-FILE-USED REFERENCE LIST:
    18* (1)  ELCNTL - COMPANY
    19* (2)  ELCNTL - LIFE BENEFIT
    20* (3)  ELCNTL - A&H BENEFIT
    21* (4)  ELCNTL - CARRIER
    22* (5)  MAIL
    23* (6)  ERACCT
    24* (7)  USED FOR SYSTEM VARIABLES ?
    25* (8)  ELCERT
    26* (9)  PENDING BUSINESS
    27* (10) COMPENSATION
    28* (11) ELCNTL - PROCESSOR DATA ?
    29* (12) ERCHEK
    30* (13) ERPYAJ
    31* (14) NOT USED
    32* (15) NOT USED
    33* (16) NOT USED
    34* (17) NOT USED
    35* (18) NOT USED
    36* (19) NOT USED
    37* (20) NOT USED
    38*
    39******************************************************************
    40*                   C H A N G E   L O G
    41*
    42* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    43*-----------------------------------------------------------------
    44*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    45* EFFECTIVE    NUMBER
    46*-----------------------------------------------------------------
    47* 101501    2001100100006  SMVA  ADD USERID to screen header
    48*                                ADJUSTED REDEFINES EL689AI FILLER
    49* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    50* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    51* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    52* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    53* 092908    2008013100006  PEMA  MOVE VAR 154
    54* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    55* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    56* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    57* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    58* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    59* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    60* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    61* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    62* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    63* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    64* 122011  CR2011022800001  AJRA  NAPERSOFT
    65* 090612  IR2012090600001  AJRA  NAPERSOFT
    66* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    67* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    68* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    69* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    70* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    71* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL689.cbl
    72* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
    73* 121213  CR2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    74* 123113  CR2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    75* 010814  CR2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    76* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    77* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    78******************************************************************
    79
    80 DATA DIVISION.
    81 WORKING-STORAGE SECTION.
    82 01  DFH-START PIC X(04).
    83 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    84 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    85                                   USAGE POINTER.
    86 77  FILLER  PIC X(32) VALUE '********************************'.
    87 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    88 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    89
*   90 EXEC SQL
*   91    INCLUDE SQLDA
*   92 END-EXEC
    93 01 SQLDA sync.
    94    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    95    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    96    05 SQLN                  PIC S9(4) COMP-5 value 0.
    97    05 SQLD                  PIC S9(4) COMP-5 value 0.
    98    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    99       10 SQLTYPE            PIC S9(4) COMP-5.
   100       10 SQLLEN             PIC S9(4) COMP-5.
   101$IF P64 SET
   102X      *> For 64-bit environments, ensure that SQLDATA is
   103X      *> aligned on an 8-byte boundary.
   104X      10 FILLER             PIC S9(9) COMP-5.
   105$END
   106       10 SQLDATA            USAGE POINTER.
   107       10 SQLIND             USAGE POINTER.
   108       10 SQLNAME.
   109          15 SQLNAMEL        PIC S9(4) COMP-5.
   110          15 SQLNAMEC        PIC X(30).
   111
   112* Values for SQLTYPE
   113
   114 78  ESQL-DATE-CHAR              VALUE 384.
   115 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   116 78  ESQL-DATE-REC               VALUE 386.
   117 78  ESQL-DATE-REC-NULL          VALUE 387.
   118 78  ESQL-TIME-CHAR              VALUE 388.
   119 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   120 78  ESQL-TIME-REC               VALUE 390.
   121 78  ESQL-TIME-REC-NULL          VALUE 391.
   122 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   123 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   124 78  ESQL-TIMESTAMP-REC          VALUE 394.
   125 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   126 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   127 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   128 78  ESQL-TS-OFFSET-REC          VALUE 398.
   129 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL689.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-LONGVARBINARY          VALUE 404.
   131 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   132 78  ESQL-LONGVARCHAR            VALUE 408.
   133 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   134 78  ESQL-BINARY                 VALUE 444.
   135 78  ESQL-BINARY-NULL            VALUE 445.
   136 78  ESQL-VARBINARY              VALUE 446.
   137 78  ESQL-VARBINARY-NULL         VALUE 447.
   138 78  ESQL-VARCHAR                VALUE 448.
   139 78  ESQL-VARCHAR-NULL           VALUE 449.
   140
   141 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   142 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   143
   144 78  ESQL-CHAR                   VALUE 452.
   145 78  ESQL-CHAR-NULL              VALUE 453.
   146
   147 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   148 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   149
   150 78  ESQL-DOUBLE                 VALUE 480.
   151 78  ESQL-DOUBLE-NULL            VALUE 481.
   152 78  ESQL-REAL                   VALUE 482.
   153 78  ESQL-REAL-NULL              VALUE 483.
   154 78  ESQL-DECIMAL                VALUE 484.
   155 78  ESQL-DECIMAL-NULL           VALUE 485.
   156 78  ESQL-INTEGER                VALUE 496.
   157 78  ESQL-INTEGER-NULL           VALUE 497.
   158 78  ESQL-SMALLINT               VALUE 500.
   159 78  ESQL-SMALLINT-NULL          VALUE 501.
   160 78  ESQL-TINYINT                VALUE 502.
   161 78  ESQL-TINYINT-NULL           VALUE 503.
   162
*  163 EXEC SQL
*  164    INCLUDE SQLCA
*  165 END-EXEC
   166 01 SQLCA.
   167     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   168     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   169     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   170     05  SQLERRM.
   171         49  SQLERRML    PIC S9(4) COMP-5.
   172         49  SQLERRMC    PIC X(70).
   173     05  SQLERRP         PIC X(8).
   174     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   175     05  SQLWARN.
   176         10  SQLWARN0    PIC X.
   177         10  SQLWARN1    PIC X.
   178         10  SQLWARN2    PIC X.
   179         10  SQLWARN3    PIC X.
   180         10  SQLWARN4    PIC X.
   181         10  SQLWARN5    PIC X.
   182         10  SQLWARN6    PIC X.
   183         10  SQLWARN7    PIC X.
   184     05  SQLEXT.
   185         10  SQLWARN8    PIC X.
   186         10  SQLWARN9    PIC X.
   187         10  SQLWARN10   PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL689.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   189     05  SQLSTATE    PIC X(5).
   190
   191 EXEC SQL
   192    BEGIN DECLARE SECTION
   193 END-EXEC
   194
   195 01  SQLCMD                      PIC X(1024).
   196 01  SVR                         PIC X(32).
   197 01  USR                         PIC X(32).
   198 01  PASS                        PIC X(32).
   199 01  USR-PASS                    PIC X(64).
   200
   201 01  WS-SQL-DATA.
   202     05  WS-CYCLE-DATE           PIC X(10).
   203     05  WS-NEXT-BUS-DT          PIC X(10).
   204
   205 EXEC SQL
   206    END DECLARE SECTION
   207 END-EXEC
   208
   209 01  P pointer.
   210 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   211 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   212 01  var-ptr pointer.
   213 01  env-var-len                 pic 9(4)  binary.
   214 01  rc                          pic 9(9)  binary.
   215 01  WS-KIXHOST                  PIC X(10).
   216 01  WS-KIXSYS.
   217     05  WS-KIX-FIL1             PIC X(10).
   218     05  WS-KIX-APPS             PIC X(10).
   219     05  WS-KIX-ENV              PIC X(10).
   220     05  WS-KIX-MYENV            PIC X(10).
   221     05  WS-KIX-SYS              PIC X(10).
   222 01 srch-commarea.
   223*                                copy ELCADLTRSPI.
   224******************************************************************
   225*                   C H A N G E   L O G
   226*
   227* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   228*-----------------------------------------------------------------
   229*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   230* EFFECTIVE    NUMBER
   231*-----------------------------------------------------------------
   232* 060611    2011022800001  PEMA  NEW COPYBOOK
   233* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   234* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   235******************************************************************
   236****************************************
   237*  commarea for NaperSoft On Demand Admin services letters
   238*  (business logic input & output)
   239****************************************
   240     03  BL-INPUT.
   241         05  BL-DATA-SRCE        PIC X.
   242         05  BL-LETTER-ID        PIC XXXX.
   243         05  BL-CARRIER          PIC X.
   244         05  BL-GROUP            PIC X(6).
   245         05  BL-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL689.cbl
   246         05  BL-ACCOUNT          PIC X(10).
   247         05  BL-EFF-DT           PIC X(10).
   248         05  BL-CERT-NO          PIC X(11).
   249         05  BL-BATCH-NO         PIC X(6).
   250         05  BL-BATCH-SEQ        PIC 9(8).
   251         05  BL-RESP-NO          PIC X(10).
   252         05  BL-NO-OF-COPIES     PIC 99.
   253         05  BL-PROC-ID          PIC XXXX.
   254         05  BL-COMP-ID          PIC XXX.
   255         05  BL-PRINT-NOW-SW     PIC X.
   256         05  BL-ENC-CD           PIC XXX.
   257         05  BL-RESEND-DT        PIC X(10).
   258         05  BL-FOLLOW-UP-DT     PIC X(10).
   259         05  BL-ARCHIVE-NO       PIC 9(8).
   260         05  BL-FUNC             PIC X(8).
   261         05  BL-COMMENTS         PIC X(100).
   262         05  FILLER REDEFINES BL-COMMENTS.
   263             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   264             10  BL-LETTER-TO-ACCT PIC X.
   265             10  BL-LETTER-TO-BENE PIC X.
   266             10  BL-WRITE-ERARCH   PIC X.
   267                 88  ERARCH-QWS      VALUE 'Q'.
   268                 88  ERARCH-BATCH    VALUE 'B'.
   269                 88  ERARCH-TEMP     VALUE 'T'.
   270             10  BL-PROCESS-TYPE PIC X(07).
   271             10  BL-CERT-FORM-ID PIC X(05).
   272             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   273             10  BL-SOURCE-SCREEN PIC X(8).
   274             10  FILLER          PIC X(25).
   275     03  BL-OUTPUT.
   276         05  BL-STATUS                   PIC X.
   277             88  BL-OK                      VALUE "P".
   278             88  BL-FAIL                  VALUE "F".
   279         05  BL-MESSAGE          PIC X(50).
   280     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   281     03  FILLER                  PIC X(31).
   282 01  W-WORK-AREAS.
   283     12  FILLER                  PIC  X(18)
   284                                      VALUE 'PROGRAM WORK AREA:'.
   285
   286     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   287     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   288     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   289     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   290     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   291     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   292     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   293     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   294     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   295     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   296
   297     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   298     12  W-DIFFERENCE            PIC S9(07)V9(02)
   299                                            VALUE +0   COMP-3.
   300     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   301     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   302     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   303     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL689.cbl
   304     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   305     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   306     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   307     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   308     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   309     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   310     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   311     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   312     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   313     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   314     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   315     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   316     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   317     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   318     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   319     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   320     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   321     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   322     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   323     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   324     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   325                                            VALUE +0   COMP-3.
   326
   327     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   328     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   329         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   330     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   331     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   332     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   333     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   334     12  W-SAVE-REVISION         PIC  9(03) value 0.
   335     12  W-DISPLAY-3             PIC  9(03) value 0.
   336     12  W-DISPLAY-8             PIC  9(08) value 0.
   337     12  W-DISPLAY-7             PIC  9(07) value 0.
   338     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   339     12  W-EDIT-3-0              PIC  ZZ9.
   340     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   341     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   342     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   343     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   344
   345     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   346         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   347
   348     12  W-ARCH-SUPPRESS         PIC 99999999.
   349     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   350                                 PIC  X(08).
   351     12  W-COMP-WORK-AREA.
   352         16  W-CWA-CHAR OCCURS 10 TIMES
   353                                 PIC  X(01).
   354     12  W-INCOMING-ARCHIVE      PIC  X(08).
   355     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   356                                 PIC  9(08).
   357
   358     12  W-BATCH-BREAKDOWN.
   359         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   360         16  W-BATCH-SEQ         PIC S9(04) COMP.
   361     12  W-BEN-HOLD              PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL689.cbl
   362     12  W-BENEFIT-WORK          PIC  X(03).
   363     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   364         16  W-ELIM-DAYS         PIC  X(02).
   365         16  FILLER              PIC  X(01).
   366     12  W-CALL-PGM              PIC  X(08).
   367     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   368
   369     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   370     12  W-LINE-CONTROL-RECORD.
   371         16  W-LC-LINE-WIDTH     PIC  9(02).
   372         16  FILLER              PIC  X(01).
   373         16  W-LC-PARAGRAPH-INDENT
   374                                 PIC  9(02).
   375         16  FILLER              PIC  X(01).
   376         16  W-LC-MAX-LINES-PER-PAGE
   377                                 PIC  9(02).
   378         16  FILLER              PIC  X(01).
   379         16  W-LC-LINE-ADJUST    PIC  9(02).
   380         16  FILLER              PIC  X(01).
   381         16  W-LC-LINE-INDENT-1  PIC  9(02).
   382         16  FILLER              PIC  X(01).
   383         16  W-LC-LINE-INDENT-2  PIC  9(02).
   384         16  FILLER              PIC  X(01).
   385         16  W-LC-LINE-INDENT-3  PIC  9(02).
   386         16  FILLER              PIC  X(01).
   387         16  W-LC-LINE-INDENT-4  PIC  9(02).
   388         16  FILLER              PIC  X(01).
   389         16  W-LC-LINE-INDENT-5  PIC  9(02).
   390         16  FILLER              PIC  X(01).
   391         16  W-LC-TOP-MARGIN     PIC  9(02).
   392         16  FILLER              PIC  X(01).
   393         16  W-LC-CASE-IND       PIC  X(01).
   394             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   395         16  FILLER              PIC  X(01).
   396         16  W-LC-PAGE-IND       PIC  X(01).
   397             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   398     12  W-DATE-WORK             PIC  9(07).
   399     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   400         16  FILLER              PIC  X(02).
   401         16  W-DT-WORK           PIC  9(05).
   402
   403     12  W-DEEDIT-FIELD          PIC  X(15).
   404     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   405
   406     12  W-EDIT-DATE-1.
   407         16  W-ED1-MM            PIC  X(02).
   408         16  FILLER              PIC  X(01) VALUE '/'.
   409         16  W-ED1-DD            PIC  X(02).
   410         16  FILLER              PIC  X(01) VALUE '/'.
   411         16  W-ED1-YY            PIC  X(02).
   412
   413     12  W-EDIT-DATE-2.
   414         16  W-ED2-DD            PIC  X(02).
   415         16  FILLER              PIC  X(01) VALUE '/'.
   416         16  W-ED2-MM            PIC  X(02).
   417         16  FILLER              PIC  X(01) VALUE '/'.
   418         16  W-ED2-YY            PIC  X(02).
   419
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL689.cbl
   420     12  W-EDIT-A-DATE.
   421         16  W-EDIT-A-MM                  PIC X(2).
   422         16  FILLER                       PIC X(1).
   423         16  W-EDIT-A-DD                  PIC X(2).
   424         16  FILLER                       PIC X(1).
   425         16  W-EDIT-A-CCYY.
   426             20  W-EDIT-A-CC              PIC X(2).
   427             20  W-EDIT-A-YY              PIC X(2).
   428
   429     12  W-LABEL-HOLD-AREA.
   430         16  W-LABEL-LINES OCCURS 6 TIMES.
   431             20  W-LABEL-ZIP.
   432                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   433                 24  W-LABEL-DASH     PIC  X(01).
   434                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   435             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   436                 24  W-LAB-CAN-POSTAL-CD-1
   437                                      PIC  X(03).
   438                 24  W-LAB-CAN-DASH   PIC  X(01).
   439                 24  W-LAB-CAN-POSTAL-CD-2
   440                                      PIC  X(03).
   441                 24  W-LAB-CAN-FILLER PIC  X(03).
   442             20  FILLER               PIC  X(10).
   443             20  W-LAST-ZIP.
   444                 24  W-LAST-1ST-ZIP   PIC  X(05).
   445                 24  W-LABEL-DASH-LAST
   446                                      PIC  X(01).
   447                 24  W-LAST-2ND-ZIP   PIC  X(04).
   448             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   449                 24  W-LAST-CAN-POSTAL-CD-1
   450                                      PIC  X(03).
   451                 24  W-LAST-CAN-DASH  PIC  X(01).
   452                 24  W-LAST-CAN-POSTAL-CD-2
   453                                      PIC  X(03).
   454                 24  W-LAST-CAN-FILLER
   455                                      PIC  X(03).
   456
   457     12  W-LAST-CHAR             PIC  X(01).
   458         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   459     12  W-LAST-SQ-CHAR          PIC  X(01).
   460
   461     12  W-LINE-NUM.
   462         16  W-LINE1             PIC  X(01).
   463         16  W-LINE23            PIC  9(02).
   464     12  W-LIN-NUM REDEFINES W-LINE-NUM
   465                                 PIC  9(03).
   466
   467     12  W-NAME-LAST             PIC  X(15).
   468     12  W-NAME-FIRST.
   469         16  W-NAME-FIRST-INIT   PIC  X(01).
   470         16  W-NAME-FIRST-REMAIN PIC  X(14).
   471     12  W-NAME-MIDDLE.
   472         16  FILLER              PIC  X(01).
   473         16  W-NAME-MIDDLE-2     PIC  X(01).
   474         16  FILLER              PIC  X(13).
   475
   476     12  W-PAGE-PRT.
   477         16  FILLER              PIC  X(34) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL689.cbl
   478         16  W-PAGE-NUMBER       PIC  Z9.
   479         16  FILLER              PIC  X(01) VALUE '.'.
   480         16  FILLER              PIC  X(33) VALUE SPACES.
   481
   482     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   483     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   484         16  FILLER              PIC  9(01).
   485         16  W-PHI-AREA          PIC  9(03).
   486         16  W-PHI-PFX           PIC  9(03).
   487         16  W-PHI-SFX           PIC  9(04).
   488     12  W-PHONE-OUT.
   489         16  W-PO-AREA           PIC  X(03).
   490         16  FILLER              PIC  X(01) VALUE '-'.
   491         16  W-PO-PFX            PIC  X(03).
   492         16  FILLER              PIC  X(01) VALUE '-'.
   493         16  W-PO-SFX            PIC  X(04).
   494
   495     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   496     12  W-SAVE-BIN-NEXT-BUS-DT  PIC  X(02) VALUE SPACES.
   497     12  W-SAVE-NEXT-BUS-DT-EDIT-A PIC X(10)   VALUE SPACES.
   498     12  W-SAVE-CYCLE-DAY-OF-WEEK PIC S9   COMP-3 VALUE +0.
   499     12  W-SAVE-EDIT-A-DATE      PIC  X(10) VALUE SPACES.
   500     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   501     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   502
   503     12  W-SINGLE-LINE           PIC  X(70).
   504     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   505         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   506                                 PIC  X(01).
   507
   508     12  W-SQUEEZED-LINE.
   509         16  W-SQ-CHAR OCCURS 70 TIMES
   510                       INDEXED BY W-SQ-NDX
   511                                 PIC  X(01).
   512
   513     12  W-TIME-IN               PIC S9(07).
   514     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   515         16  FILLER              PIC  X(01).
   516         16  W-TIME-OUT          PIC  99V9(02).
   517         16  FILLER              PIC  X(02).
   518
   519     12  W-TS-NAME-TEXT.
   520         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   521         16  W-TS-ID-TIME
   522             REDEFINES W-TS-ID-TEXT
   523                                 PIC S9(07) COMP-3.
   524         16  W-TS-TERM-TEXT.
   525             20 W-TS-TERM-PREFIX PIC  X(02).
   526             20 FILLER           PIC  X(02).
   527     12  W-TS-NAME-SCREEN.
   528         16  FILLER              PIC  X(04) VALUE '689X'.
   529         16  W-TS-TERM-SCREEN    PIC  X(04).
   530
   531     12  W-WORK-LINE.
   532         16  W-WORK-CHAR OCCURS 70 TIMES
   533                       INDEXED BY W-WC-NDX
   534                                  W-WC-NDX2
   535                                  W-WC-NDX3
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL689.cbl
   536                                 PIC  X(01).
   537
   538     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   539     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   540         16  W-WORK-ZIP5         PIC  X(05).
   541         16  W-WORK-ZIP4         PIC  X(04).
   542     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   543         16  W-CAN-POSTAL-CD-1.
   544             20  FILLER          PIC  X(01).
   545                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   546             20  FILLER          PIC  X(02).
   547         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   548         16  W-FILLER            PIC  X(03).
   549
   550**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   551*                   COPY ELCZREC.
   552******************************************************************
   553*                                                                *
   554*                                                                *
   555*                            ELCZREC.                            *
   556*                                                                *
   557*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   558*                                                                *
   559******************************************************************
   560*-----------------------------------------------------------------
   561*                   C H A N G E   L O G
   562*
   563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   564*-----------------------------------------------------------------
   565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   566* EFFECTIVE    NUMBER
   567*-----------------------------------------------------------------
   568* 122011    2011022800001  AJRA  NEW FILE
   569* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   570* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   571* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   572* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   573*-----------------------------------------------------------------
   574 01  W-Z-CONTROL-DATA.
   575     05  W-NUMBER-OF-COPIES      PIC  9.
   576     05  FILLER                  PIC  X.
   577     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   578     05  FILLER                  PIC  X.
   579     05  W-DAYS-TO-RESEND        PIC  999.
   580     05  FILLER                  PIC  X.
   581     05  W-FORM-TO-RESEND        PIC  X(4).
   582     05  W-ADD-BAR-CODE          PIC  X.
   583     05  W-PROMPT-LETTER         PIC  X.
   584     05  W-HAS-RETURN-ENV        PIC  X.
   585     05  W-ENCLOSURE-CD          PIC  XXX.
   586     05  W-SIG-FLAG-DEFAULT      PIC  X.
   587     05  W-AUTO-CLOSE-IND        PIC  X.
   588     05  FILLER                  PIC  X.
   589     05  W-LETTER-TO-BENE        PIC  X.
   590     05  FILLER                  PIC  X.
   591     05  W-LETTER-TO-ACCT        PIC  X.
   592     05  FILLER                  PIC  X.
   593     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL689.cbl
   594     05  FILLER                  PIC  X.
   595     05  W-PRINT-CERTIFICATE     PIC  X.
   596     05  FILLER                  PIC  X.
   597     05  W-REFUND-REQUIRED       PIC  X.
   598     05  FILLER                  PIC  X.
   599     05  W-ONBASE-CODE           PIC  XX.
   600     05  FILLER                  PIC  X.
   601     05  W-ACCT-SUMM             PIC  X.
   602     05  FILLER                  PIC  X.
   603     05  W-CSO-SUMM              PIC  X.
   604     05  FILLER                  PIC  X.
   605     05  W-REASONS-REQUIRED      PIC  X.
   606     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL689.cbl
   608 01  W-SWITCH-INDICATORS-AREA.
   609     12  FILLER                  PIC  X(16)
   610                                      VALUE 'PROGRAM SWITCHS:'.
   611     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   612         88  W-ADDRESS-ONLY      VALUE 'Y'.
   613         88  W-FULL-DATA         VALUE ' '.
   614     12  W-ACCT-BROWSE-STARTED-SW
   615                                 PIC  X(01) VALUE 'N'.
   616         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   617     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   618     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   619         88  W-CERT-FOUND                   VALUE 'Y'.
   620     12  W-CHARACTER-TYPE        PIC  X(01).
   621         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   622         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   623         88  W-SPACE             VALUE ' '.
   624     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   625         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   626     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   627         88  W-DATA-SHRINKING    VALUE 'Y'.
   628     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   629         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   630     12  W-FIRST-BAD-VARIABLE-IND
   631                                 PIC  X(01) VALUE SPACES.
   632         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   633     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   634         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   635         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   636     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   637         88  W-FORM-CHANGED                 VALUE 'Y'.
   638     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   639         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   640         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   641     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   642         88  W-HOLD-ON                      VALUE 'Y'.
   643         88  W-HOLD-OFF                     VALUE ' '.
   644     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   645         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   646         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   647     12  W-KEY-FIELDS-CHANGED-IND
   648                                 PIC  X(01) VALUE ' '.
   649         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   650         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   651     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   652         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   653     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   654         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   655                                                   'T' 'U'.
   656         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   657                                                   'G' 'H'.
   658         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   659         88  W-DO-NOT-ADJUST                VALUE 'N'.
   660         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   661         88  W-AS-IS                        VALUE 'A' 'N'.
   662         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   663                                                   '4' '5'.
   664
   665     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL689.cbl
   666         88  W-PNDB-FOUND                   VALUE 'Y'.
   667     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   668         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   669     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   670         88  W-REVERSE-DATE                 VALUE 'Y'.
   671     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   672         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   673         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   674
   675     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   676         88  W-VALID-ENDT                   VALUE 'Y'.
   677     12  W-RESPONSE              PIC S9(8)   COMP.
   678         88  RESP-NORMAL                  VALUE +00.
   679         88  RESP-NOTFND                  VALUE +13.
   680         88  RESP-DUPREC                  VALUE +14.
   681         88  RESP-DUPKEY                  VALUE +15.
   682         88  RESP-NOTOPEN                 VALUE +19.
   683         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL689.cbl
   685 01  WS-SAVE-AREA.
   686     12  WS-SAV-AM-DEFN-1.
   687         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   688             20  WS-SAV-AM-AGT             PIC  X(10).
   689             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   690             20  FILLER                    PIC  X(15).
   691     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   692     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   693     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   694     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   695     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   696     12  WS-SAV-AM-NAME                    PIC  X(30).
   697     12  WS-SAV-AM-PERSON                  PIC  X(30).
   698     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   699     12  WS-SAV-AM-CITY                    PIC  X(30).
   700     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   701     12  WS-SAV-AM-ZIP.
   702         16  WS-SAV-AM-ZIP-PRIME.
   703             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   704                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   705                     'A' THRU 'Z'.
   706             20  FILLER                    PIC  X(04).
   707         16  FILLER                        PIC  X(04).
   708     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   709                        WS-SAV-AM-ZIP      PIC  X(09).
   710     12  WS-SAV-AM-TEL-NO.
   711         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   712         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   713         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   714 01  W-KEY-AREAS.
   715     12  FILLER                    PIC  X(13)
   716                                      VALUE 'PROGRAM KEYS:'.
   717
   718     12  W-ACCT-SAVE-KEY           PIC  X(20).
   719     12  W-ACCT-KEY.
   720         16  W-ACCT-PARTIAL-KEY.
   721             20  W-ACCT-COMPANY-CD PIC  X(01).
   722             20  W-ACCT-CARRIER    PIC  X(01).
   723             20  W-ACCT-GROUPING   PIC  X(06).
   724             20  W-ACCT-STATE      PIC  X(02).
   725             20  W-ACCT-ACCOUNT    PIC  X(10).
   726         16  W-ACCT-EXP-DT         PIC  X(02).
   727
   728     12  W-ARCH-SAVE-KEY         PIC  X(05).
   729     12  W-ARCH-KEY.
   730         16  W-ARCH-PARTIAL-KEY.
   731             20  W-ARCH-COMPANY-CD
   732                                 PIC  X(01).
   733             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   734         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   735
   736     12  W-ARCT-KEY.
   737         16  W-ARCT-PARTIAL-KEY.
   738             20  W-ARCT-COMPANY-CD
   739                                 PIC  X(01).
   740             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   741         16  W-ARCT-REC-TYPE     PIC  X(01).
   742         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL689.cbl
   743
   744     12  W-CERT-KEY.
   745         16  W-CERT-COMPANY-CD   PIC  X(01).
   746         16  W-CERT-CARRIER      PIC  X(01).
   747         16  W-CERT-GROUPING     PIC  X(06).
   748         16  W-CERT-STATE        PIC  X(02).
   749         16  W-CERT-ACCOUNT      PIC  X(10).
   750         16  W-CERT-EFF-DT       PIC  X(02).
   751         16  W-CERT-CERT-NO.
   752             20  W-CERT-CERT-PRIME
   753                                 PIC  X(10).
   754             20  W-CERT-CERT-SFX PIC  X(01).
   755
   756     12  W-CHEK-KEY.
   757         16  W-CHEK-COMPANY-CD   PIC  X(01).
   758         16  W-CHEK-CARRIER      PIC  X(01).
   759         16  W-CHEK-GROUPING     PIC  X(06).
   760         16  W-CHEK-STATE        PIC  X(02).
   761         16  W-CHEK-ACCOUNT      PIC  X(10).
   762         16  W-CHEK-EFF-DT       PIC  X(02).
   763         16  W-CHEK-CERT-NO.
   764             20  W-CHEK-CERT-PRIME
   765                                 PIC  X(10).
   766             20  W-CHEK-CERT-SFX PIC  X(01).
   767         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   768
   769     12  W-CNTL-KEY.
   770         16  W-CNTL-COMPANY-ID   PIC  X(03).
   771         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   772         16  W-CNTL-GENL.
   773             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   774             20  W-CNTL-GEN2.
   775                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   776                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   777         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   778
   779     12  W-COMP-SAVE-KEY         PIC  X(29).
   780     12  W-COMP-KEY.
   781         16  W-COMP-COMPANY-CD   PIC  X(01).
   782         16  W-COMP-CARRIER      PIC  X(01).
   783         16  W-COMP-GROUPING     PIC  X(06).
   784         16  W-COMP-RESP-PERSON.
   785             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   786                                INDEXED BY W-COMP-NDX
   787                                 PIC  X(01).
   788         16  W-COMP-ACCOUNT      PIC  X(10).
   789         16  W-COMP-TYPE         PIC  X(01).
   790
   791     12  W-DELETE-KEY.
   792         16  W-DELETE-PARTIAL-KEY.
   793             20  W-DELETE-COMPANY-CD
   794                                 PIC  X(01).
   795             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   796         16  W-DELETE-RECORD-TYPE
   797                                 PIC  X(01).
   798         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   799
   800     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL689.cbl
   801         16  W-MAIL-COMPANY-CD   PIC  X(01).
   802         16  W-MAIL-CARRIER      PIC  X(01).
   803         16  W-MAIL-GROUPING     PIC  X(06).
   804         16  W-MAIL-STATE        PIC  X(02).
   805         16  W-MAIL-ACCOUNT      PIC  X(10).
   806         16  W-MAIL-EFF-DT       PIC  X(02).
   807         16  W-MAIL-CERT-NO.
   808             20  W-MAIL-CERT-PRIME
   809                                 PIC  X(10).
   810             20  W-MAIL-CERT-SFX PIC  X(01).
   811
   812     12  W-PNDB-KEY.
   813         16  W-PNDB-COMPANY-CD   PIC  X(01).
   814         16  W-PNDB-ENTRY        PIC  X(06).
   815         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   816         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   817
   818     12  W-PNDB2-KEY.
   819         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   820         16  W-PNDB2-CARRIER     PIC  X(01).
   821         16  W-PNDB2-GROUPING    PIC  X(06).
   822         16  W-PNDB2-STATE       PIC  X(02).
   823         16  W-PNDB2-ACCOUNT     PIC  X(10).
   824         16  W-PNDB2-EFF-DT      PIC  X(02).
   825         16  W-PNDB2-CERT-NO.
   826             20  W-PNDB2-CERT-PRIME
   827                                 PIC  X(10).
   828             20  W-PNDB2-CERT-SFX
   829                                 PIC  X(01).
   830         16  W-PNDB2-ALT-CHG-SEQ-NO
   831                                 PIC S9(04)  COMP.
   832         16  W-PNDB2-TYPE        PIC  X(01).
   833
   834     12  W-PYAJ-KEY.
   835         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   836         16  W-PYAJ-CARRIER      PIC  X(01).
   837         16  W-PYAJ-GROUPING     PIC  X(06).
   838         16  W-PYAJ-FIN-RESP     PIC  X(10).
   839         16  W-PYAJ-ACCOUNT      PIC  X(10).
   840         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   841         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   842
   843     12  W-SC-QUID-KEY.
   844         16  W-SC-QUID-TERMINAL  PIC  X(04).
   845         16  W-SC-QUID-SYSTEM    PIC  X(04).
   846
   847     12  W-TEXT-SAVE-KEY         PIC  X(05).
   848     12  W-TEXT-KEY.
   849         16  W-TEXT-PARTIAL-KEY.
   850             20  W-TEXT-COMPANY-CD
   851                                 PIC  X(01).
   852             20  W-TEXT-LETTER   PIC  X(04).
   853         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   854         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   855
   856     12  W-ERENDT-KEY-BY-ARCH.
   857         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   858         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL689.cbl
   859
   860     12  W-ELEOBC-KEY.
   861         16  W-EOBC-COMPANY-CD   PIC X.
   862         16  W-EOBC-REC-TYPE     PIC X.
   863         16  W-EOBC-CODE         PIC X(4).
   864         16  FILLER              PIC X(9).
   865     12  W-ERNOTE-KEY.
   866         16  W-NOTE-COMPANY-CD   PIC X.
   867         16  W-NOTE-CARRIER      PIC X.
   868         16  W-NOTE-GROUPING     PIC X(6).
   869         16  W-NOTE-STATE        PIC XX.
   870         16  W-NOTE-ACCOUNT      PIC X(10).
   871         16  W-NOTE-CERT-EFF-DT  PIC XX.
   872         16  W-NOTE-CERT-PRIME   PIC X(10).
   873         16  W-NOTE-CERT-SFX     PIC X.
   874     12  W-SAVE-KEY.
   875         16  W-SV-COMPANY-CD     PIC X.
   876         16  W-SV-CARRIER        PIC X.
   877         16  W-SV-GROUPING       PIC X(6).
   878         16  W-SV-STATE          PIC XX.
   879         16  W-SV-ACCOUNT        PIC X(10).
   880         16  W-SV-CERT-EFF-DT    PIC XX.
   881         16  W-SV-CERT-PRIME     PIC X(10).
   882         16  W-SV-CERT-SFX       PIC X.
   883     12  W-BILLING-NOTE.
   884         16  W-BN-NOTE           PIC X(25).
   885         16  W-BN-LTRID          PIC X(4).
   886         16  FILLER              PIC X(3).
   887         16  W-BN-DATE           PIC X(8).
   888         16  FILLER              PIC X(3).
   889         16  W-BN-USERID         PIC X(4).
   890         16  FILLER              PIC X(30).
   891     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   892     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   893     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   894         88  NO-CERT-RW                 VALUE 'N'.
   895         88  CERT-RW                    VALUE 'Y'.
   896
   897     12  W-ELENCC-KEY.
   898         16  W-ENCC-COMPANY-CD   PIC X.
   899         16  W-ENCC-REC-TYPE     PIC X.
   900         16  W-ENCC-ENC-CODE     PIC X(5).
   901         16  FILLER              PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL689.cbl
   903 01  FILLER                      PIC  X(22)
   904                                 VALUE 'INTERFACE AREA STARTS:'.
   905*    COPY ELCINTF.
   906******************************************************************
   907*                                                                *
   908*                                                                *
   909*                            ELCINTF.                            *
   910*                            VMOD=2.017                          *
   911*                                                                *
   912*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   913*                                                                *
   914*       LENGTH = 1024                                            *
   915*                                                                *
   916******************************************************************
   917*                   C H A N G E   L O G
   918*
   919* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   920*-----------------------------------------------------------------
   921*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   922* EFFECTIVE    NUMBER
   923*-----------------------------------------------------------------
   924* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   925******************************************************************
   926 01  PROGRAM-INTERFACE-BLOCK.
   927     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   928     12  PI-CALLING-PROGRAM              PIC X(8).
   929     12  PI-SAVED-PROGRAM-1              PIC X(8).
   930     12  PI-SAVED-PROGRAM-2              PIC X(8).
   931     12  PI-SAVED-PROGRAM-3              PIC X(8).
   932     12  PI-SAVED-PROGRAM-4              PIC X(8).
   933     12  PI-SAVED-PROGRAM-5              PIC X(8).
   934     12  PI-SAVED-PROGRAM-6              PIC X(8).
   935     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   936     12  PI-COMPANY-ID                   PIC XXX.
   937     12  PI-COMPANY-CD                   PIC X.
   938
   939     12  PI-COMPANY-PASSWORD             PIC X(8).
   940
   941     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   942
   943     12  PI-CONTROL-IN-PROGRESS.
   944         16  PI-CARRIER                  PIC X.
   945         16  PI-GROUPING                 PIC X(6).
   946         16  PI-STATE                    PIC XX.
   947         16  PI-ACCOUNT                  PIC X(10).
   948         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   949                                         PIC X(10).
   950         16  PI-CLAIM-CERT-GRP.
   951             20  PI-CLAIM-NO             PIC X(7).
   952             20  PI-CERT-NO.
   953                 25  PI-CERT-PRIME       PIC X(10).
   954                 25  PI-CERT-SFX         PIC X.
   955             20  PI-CERT-EFF-DT          PIC XX.
   956         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   957             20  PI-PLAN-CODE            PIC X(2).
   958             20  PI-REVISION-NUMBER      PIC X(3).
   959             20  PI-PLAN-EFF-DT          PIC X(2).
   960             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL689.cbl
   961             20  FILLER                  PIC X(11).
   962         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   963             20  PI-OE-REFERENCE-1.
   964                 25  PI-OE-REF-1-PRIME   PIC X(18).
   965                 25  PI-OE-REF-1-SUFF    PIC XX.
   966
   967     12  PI-SESSION-IN-PROGRESS          PIC X.
   968         88  CLAIM-SESSION                   VALUE '1'.
   969         88  CREDIT-SESSION                  VALUE '2'.
   970         88  WARRANTY-SESSION                VALUE '3'.
   971         88  MORTGAGE-SESSION                VALUE '4'.
   972         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   973
   974
   975*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   976
   977     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   978     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   979
   980     12  PI-CREDIT-USER                  PIC X.
   981         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   982         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   983
   984     12  PI-CLAIM-USER                   PIC X.
   985         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   986         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   987
   988     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   989         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   990         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   991         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   992         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   993         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   994
   995     12  PI-PROCESSOR-ID                 PIC X(4).
   996
   997     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   998
   999     12  PI-MEMBER-CAPTION               PIC X(10).
  1000
  1001     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1002         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1003
  1004     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1005     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1006     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1007     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1008
  1009     12  PI-AH-OVERRIDE-L1               PIC X.
  1010     12  PI-AH-OVERRIDE-L2               PIC XX.
  1011     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1012     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1013
  1014     12  PI-NEW-SYSTEM                   PIC X(2).
  1015
  1016     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1017     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1018         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL689.cbl
  1019     12  PI-CRDTCRD-SYSTEM.
  1020         16  PI-CRDTCRD-USER             PIC X.
  1021             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1022             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1023         16  PI-CC-MONTH-END-DT          PIC XX.
  1024     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1025
  1026     12  PI-OE-REFERENCE-2.
  1027         16  PI-OE-REF-2-PRIME           PIC X(10).
  1028         16  PI-OE-REF-2-SUFF            PIC X.
  1029
  1030     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1031
  1032     12  PI-LANGUAGE-TYPE                PIC X.
  1033             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1034             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1035             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1036
  1037     12  PI-POLICY-LINKAGE-IND           PIC X.
  1038         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1039         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1040                                                   LOW-VALUES.
  1041
  1042     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1043     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1044         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1045         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1046
  1047     12  PI-PROCESSOR-CSR-IND            PIC X.
  1048         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1049         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1050
  1051     12  FILLER                          PIC X(3).
  1052
  1053     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1054
  1055     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1056         PI-SYSTEM-LEVEL.
  1057
  1058         16  PI-ENTRY-CODES.
  1059             20  PI-ENTRY-CD-1           PIC X.
  1060             20  PI-ENTRY-CD-2           PIC X.
  1061
  1062         16  PI-RETURN-CODES.
  1063             20  PI-RETURN-CD-1          PIC X.
  1064             20  PI-RETURN-CD-2          PIC X.
  1065
  1066         16  PI-UPDATE-STATUS-SAVE.
  1067             20  PI-UPDATE-BY            PIC X(4).
  1068             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1069
  1070         16  PI-LOWER-CASE-LETTERS       PIC X.
  1071             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1072
  1073*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1074*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1075*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1076
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL689.cbl
  1077         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1078             88  ST-ACCNT-CNTL               VALUE ' '.
  1079             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1080             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1081             88  ACCNT-CNTL                  VALUE '3'.
  1082             88  CARR-ACCNT-CNTL             VALUE '4'.
  1083
  1084         16  PI-PROCESSOR-CAP-LIST.
  1085             20  PI-SYSTEM-CONTROLS.
  1086                24 PI-SYSTEM-DISPLAY     PIC X.
  1087                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1088                24 PI-SYSTEM-MODIFY      PIC X.
  1089                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1090             20  FILLER                  PIC XX.
  1091             20  PI-DISPLAY-CAP          PIC X.
  1092                 88  DISPLAY-CAP             VALUE 'Y'.
  1093             20  PI-MODIFY-CAP           PIC X.
  1094                 88  MODIFY-CAP              VALUE 'Y'.
  1095             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1096                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1097             20  PI-FORCE-CAP            PIC X.
  1098                 88  FORCE-CAP               VALUE 'Y'.
  1099
  1100         16  PI-PROGRAM-CONTROLS.
  1101             20  PI-PGM-PRINT-OPT        PIC X.
  1102             20  PI-PGM-FORMAT-OPT       PIC X.
  1103             20  PI-PGM-PROCESS-OPT      PIC X.
  1104             20  PI-PGM-TOTALS-OPT       PIC X.
  1105
  1106         16  PI-HELP-INTERFACE.
  1107             20  PI-LAST-ERROR-NO        PIC X(4).
  1108             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1109
  1110         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1111             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1112
  1113         16  PI-CR-CONTROL-IN-PROGRESS.
  1114             20  PI-CR-CARRIER           PIC X.
  1115             20  PI-CR-GROUPING          PIC X(6).
  1116             20  PI-CR-STATE             PIC XX.
  1117             20  PI-CR-ACCOUNT           PIC X(10).
  1118             20  PI-CR-FIN-RESP          PIC X(10).
  1119             20  PI-CR-TYPE              PIC X.
  1120
  1121         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1122
  1123         16  PI-CR-MONTH-END-DT          PIC XX.
  1124
  1125         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1126             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1127             88  PI-ZERO-CARRIER             VALUE '1'.
  1128             88  PI-ZERO-GROUPING            VALUE '2'.
  1129             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1130
  1131         16  PI-CARRIER-SECURITY         PIC X.
  1132             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1133
  1134         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL689.cbl
  1135             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1136             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1137
  1138         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1139             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1140                                         INDEXED BY PI-ACCESS-NDX
  1141                                         PIC X.
  1142
  1143         16  PI-GA-BILLING-CONTROL       PIC X.
  1144             88  PI-GA-BILLING               VALUE '1'.
  1145
  1146         16  PI-MAIL-PROCESSING          PIC X.
  1147             88  PI-MAIL-YES                 VALUE 'Y'.
  1148
  1149         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1150
  1151         16  PI-AR-SYSTEM.
  1152             20  PI-AR-PROCESSING-CNTL   PIC X.
  1153                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1154             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1155             20  PI-AR-MONTH-END-DT      PIC XX.
  1156
  1157         16  PI-MP-SYSTEM.
  1158             20  PI-MORTGAGE-USER            PIC X.
  1159                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1160                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1161             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1162                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1163                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1164                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1165                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1166                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1167             20  PI-MP-MONTH-END-DT          PIC XX.
  1168             20  PI-MP-REFERENCE-NO.
  1169                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1170                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1171
  1172         16  PI-LABEL-CONTROL            PIC X(01).
  1173             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1174             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1175
  1176         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1177             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1178
  1179         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1180             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1181             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1182
  1183         16  FILLER                      PIC X(14).
  1184
  1185     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1186******************************************************************
  1187     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1188*    COPY ELC1042.
  1189******************************************************************
  1190*                                                                *
  1191*                                                                *
  1192*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL689.cbl
  1193*                            VMOD=2.002                          *
  1194*                                                                *
  1195*    NOTE                                                        *
  1196*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1197*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1198*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1199*        TO THESE PROGRAMS.                                      *
  1200*                                                                *
  1201*    NOTE                                                        *
  1202*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1203*        USE ONLY!                                               *
  1204*                                                                *
  1205******************************************************************
  1206
  1207         16  PI-1042-WA.
  1208             20  PI-ACTION       PIC  X(01).
  1209                 88 PI-SHOW-MODE           VALUE '1'.
  1210                 88 PI-CLEAR-MODE          VALUE '2'.
  1211                 88 PI-CREATE-MODE         VALUE '3'.
  1212             20  PI-COMM-CONTROL PIC  X(12).
  1213             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1214             20  PI-EOF-SW       PIC  X(01).
  1215                 88  PI-FILE-EOF           VALUE 'Y'.
  1216             20  PI-FILETYP      PIC  X(01).
  1217             20  PI-FORM-SQUEEZE-CONTROL
  1218                                 PIC  X(01).
  1219                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1220                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1221             20  PI-LAST-CONTROL PIC  X(12).
  1222             20  PI-TEMP-STOR-ITEMS
  1223                                 PIC S9(04) COMP.
  1224             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1225             20  PI-UPDATE-SW    PIC  9(01).
  1226                 88 ANY-UPDATES            VALUE 1.
  1227             20  PI-104-SCREEN-SENT-IND
  1228                                 PIC  X(01).
  1229                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1230                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1231             20  PI-1042-SCREEN-SENT-IND
  1232                                 PIC  X(01).
  1233                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1234                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1235             20  PI-1042-ARCHIVE-IND
  1236                                 PIC  X(01).
  1237                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1238             20  FILLER          PIC  X(29).
  1239*    COPY ELC689PI.
  1240******************************************************************
  1241*                                                                *
  1242*                            ELC689PI                            *
  1243*                            VMOD=2.003                          *
  1244*                                                                *
  1245*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1246*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1247*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1248*                                                                *
  1249*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1250*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL689.cbl
  1251*    BETWEEN PROGRAMS.                                           *
  1252*                                                                *
  1253*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1254*                                                                *
  1255*               EL631 - EL689  - EL6891 - EL6892                 *
  1256*                                                                *
  1257******************************************************************
  1258*                   C H A N G E   L O G
  1259*
  1260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1261*-----------------------------------------------------------------
  1262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1263* EFFECTIVE    NUMBER
  1264*-----------------------------------------------------------------
  1265* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1266* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1267* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1268******************************************************************
  1269
  1270
  1271         16  PI-689-WORK-AREA.
  1272             20  PI-689-ALT-PRINTER-ID
  1273                                 PIC  X(04).
  1274             20  PI-689-ARCHIVE-NUMBER
  1275                                 PIC  9(08).
  1276             20  PI-689-ARCHIVE-SW
  1277                                 PIC  X(01).
  1278                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1279             20  PI-689-DATA-SOURCE
  1280                                 PIC  X(01).
  1281                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1282                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1283                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1284                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1285                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1286             20  PI-689-ERROR-IND
  1287                                 PIC  X(01).
  1288                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1289             20  PI-689-ERROR    PIC  9(04).
  1290                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1291                 88  PI-689-FATAL-ERROR
  1292                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1293                            0042 0047 0051 0066 0067 0070
  1294                            0168 0169 0174 0175 0176 0177 0179
  1295                            0180 0181 0182 0184 0185 0189 0190
  1296                            0191
  1297                            0215 0279 0280
  1298                            0412 0413 0454
  1299                            0533 0537
  1300                            2055 2114 2208 2209 2216 2232 2369
  1301                            2398 2433 2908 2999
  1302                            3000 3770 3771 3775
  1303                            7250 7365 7367 7368 7369 7370 7371
  1304                            7272 7373 7374 7376 7377 7378 7379
  1305                            7381 7388 7390 7393 7395 7396 7398
  1306                            9095 9096 9281 9298 9299 9320 9327
  1307                            9426 9427.
  1308                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL689.cbl
  1309                     VALUES 0004 0008 0013 0023 0029 0033
  1310                            0042 0047 0066 0067 0070
  1311                            0168 0169 0174 0175 0176 0177
  1312                            0181 0182 0184 0185 0189 0190
  1313                            0279 0280
  1314                            0412 0413 0454
  1315                            2055 2208 2209 2216 2232
  1316                            2398 2999
  1317                            3000 3770 3771 3775
  1318                            7250 7365 7369 7370 7371
  1319                            7272 7373 7374 7376 7377 7378 7379
  1320                            7381 7388 7390 7393 7396 7398
  1321                            9095 9096 9299 9320 9426.
  1322             20  PI-689-FOLLOW-UP-DATE
  1323                                 PIC  X(02).
  1324             20  PI-689-FORM-NUMBER
  1325                                 PIC  X(04).
  1326             20  PI-689-LABEL-SOURCE
  1327                                 PIC X(01).
  1328                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1329                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1330                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1331                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1332                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1333                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1334                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1335             20  PI-689-NUMBER-COPIES
  1336                                 PIC  9(01).
  1337             20  PI-689-NUMBER-LABEL-LINES
  1338                                 PIC  9(01).
  1339             20  PI-689-NUMBER-TEXT-RECORDS
  1340                                 PIC  9(03).
  1341             20  PI-689-PRINT-ORDER-SW
  1342                                 PIC  X(01).
  1343                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1344                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1345                 88  PI-689-PRINT-LATER     VALUE '3'.
  1346                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1347             20  PI-689-PRINT-RESTRICTION
  1348                                 PIC  X(01).
  1349                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1350                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1351                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1352             20  PI-689-PRINT-SW PIC  X(01).
  1353                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1354             20  PI-689-RESEND-DATE-1
  1355                                 PIC  X(02).
  1356             20  PI-689-RESEND-LETR-1
  1357                                 PIC X(4).
  1358             20  PI-689-TEMP-STOR-ID
  1359                                 PIC  X(08).
  1360             20  PI-689-USE-SCREEN-IND
  1361                                 PIC  X(01).
  1362                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1363             20  PI-689-ARCH-POINTER
  1364                                 PIC S9(08) COMP.
  1365                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1366             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL689.cbl
  1367                                 PIC S9(08) COMP.
  1368                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1369             20  PI-689-VARIABLE-DATA-GRP.
  1370                 24  PI-689-VARIABLE-DATA-1
  1371                                 PIC  X(30).
  1372                 24  PI-689-VARIABLE-DATA-2
  1373                                 PIC  X(30).
  1374                 24  PI-689-VARIABLE-DATA-3
  1375                                 PIC  X(30).
  1376                 24  PI-689-VARIABLE-DATA-4
  1377                                 PIC  X(30).
  1378
  1379         16  PI-689-KEY-DATA-FIELDS.
  1380             20  PI-689-ACCOUNT  PIC  X(10).
  1381             20  PI-689-CARRIER  PIC  X(01).
  1382             20  PI-689-CERT-NO.
  1383                 24  PI-689-CERT-PRIME
  1384                                 PIC  X(10).
  1385                 24  PI-689-CERT-SFX
  1386                                 PIC  X(01).
  1387             20  PI-689-CHG-SEQ-NO
  1388                                 PIC S9(04)    COMP.
  1389             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1390                                 PIC  X(02).
  1391             20  PI-689-ENTRY-BATCH
  1392                                 PIC  X(06).
  1393             20  PI-689-EFF-DATE PIC  X(02).
  1394             20  PI-689-EXP-DATE PIC  X(02).
  1395             20  PI-689-GROUPING PIC  X(06).
  1396             20  PI-689-RESP-PERSON
  1397                                 PIC  X(10).
  1398             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1399             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1400                                 PIC  X(04).
  1401             20  PI-689-STATE    PIC  X(02).
  1402             20  PI-689-TYPE     PIC  X(01).
  1403             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1404             20  PI-689-ALT-SEQ-NO
  1405                                 PIC S9(04)    COMP.
  1406         16  PI-689-DATE-EDIT    PIC  X(08).
  1407         16  PI-689-FOLLOW-UP-EDIT
  1408                                 PIC  X(08).
  1409         16  PI-689-RESEND1-EDIT PIC  X(08).
  1410         16  PI-689-SEQ-EDIT     PIC  X(08).
  1411         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1412         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1413             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1414         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1415         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1416         16  PI-PROMPT-IND       PIC X(1).
  1417         16  PI-CERT-FORM-ID     PIC X(5).
  1418         16  PI-PRINT-NOW        PIC X(1).
  1419         16  PI-ENCLOSURE-CD     PIC X(3).
  1420         16  PI-CERT-REQ-IND     PIC X(1).
  1421         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1422         16  PI-REASON-REQ-IND   PIC X(1).
  1423         16  FILLER              PIC X(244).
  1424*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL689.cbl
  1425*        16  FILLER                        PIC X(280).
  1426
  1427 01  FILLER                      PIC  X(20)
  1428                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL689.cbl
  1430 01  FILLER                      PIC  X(16)
  1431                        VALUE 'MAP AREA STARTS:'.
  1432*    COPY EL689S.
  1433 01  EL689AI.
  1434     05  FILLER            PIC  X(0012).
  1435*    -------------------------------
  1436     05  RUNDTEL PIC S9(0004) COMP.
  1437     05  RUNDTEF PIC  X(0001).
  1438     05  FILLER REDEFINES RUNDTEF.
  1439         10  RUNDTEA PIC  X(0001).
  1440     05  RUNDTEI PIC  X(0008).
  1441*    -------------------------------
  1442     05  RUNTIMEL PIC S9(0004) COMP.
  1443     05  RUNTIMEF PIC  X(0001).
  1444     05  FILLER REDEFINES RUNTIMEF.
  1445         10  RUNTIMEA PIC  X(0001).
  1446     05  RUNTIMEI PIC  X(0005).
  1447*    -------------------------------
  1448     05  HOSTL PIC S9(0004) COMP.
  1449     05  HOSTF PIC  X(0001).
  1450     05  FILLER REDEFINES HOSTF.
  1451         10  HOSTA PIC  X(0001).
  1452     05  HOSTI PIC  X(0010).
  1453*    -------------------------------
  1454     05  SYSL PIC S9(0004) COMP.
  1455     05  SYSF PIC  X(0001).
  1456     05  FILLER REDEFINES SYSF.
  1457         10  SYSA PIC  X(0001).
  1458     05  SYSI PIC  X(0008).
  1459*    -------------------------------
  1460     05  COMPANYL PIC S9(0004) COMP.
  1461     05  COMPANYF PIC  X(0001).
  1462     05  FILLER REDEFINES COMPANYF.
  1463         10  COMPANYA PIC  X(0001).
  1464     05  COMPANYI PIC  X(0003).
  1465*    -------------------------------
  1466     05  USERIDL PIC S9(0004) COMP.
  1467     05  USERIDF PIC  X(0001).
  1468     05  FILLER REDEFINES USERIDF.
  1469         10  USERIDA PIC  X(0001).
  1470     05  USERIDI PIC  X(0004).
  1471*    -------------------------------
  1472     05  MAINTL PIC S9(0004) COMP.
  1473     05  MAINTF PIC  X(0001).
  1474     05  FILLER REDEFINES MAINTF.
  1475         10  MAINTA PIC  X(0001).
  1476     05  MAINTI PIC  X(0001).
  1477*    -------------------------------
  1478     05  FORML PIC S9(0004) COMP.
  1479     05  FORMF PIC  X(0001).
  1480     05  FILLER REDEFINES FORMF.
  1481         10  FORMA PIC  X(0001).
  1482     05  FORMI PIC  X(0004).
  1483*    -------------------------------
  1484     05  ARCHNUML PIC S9(0004) COMP.
  1485     05  ARCHNUMF PIC  X(0001).
  1486     05  FILLER REDEFINES ARCHNUMF.
  1487         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL689.cbl
  1488     05  ARCHNUMI PIC  99999999.
  1489*    -------------------------------
  1490     05  PRTNOWL PIC S9(0004) COMP.
  1491     05  PRTNOWF PIC  X(0001).
  1492     05  FILLER REDEFINES PRTNOWF.
  1493         10  PRTNOWA PIC  X(0001).
  1494     05  PRTNOWI PIC  X(0001).
  1495*    -------------------------------
  1496     05  CARRIERL PIC S9(0004) COMP.
  1497     05  CARRIERF PIC  X(0001).
  1498     05  FILLER REDEFINES CARRIERF.
  1499         10  CARRIERA PIC  X(0001).
  1500     05  CARRIERI PIC  X(0001).
  1501*    -------------------------------
  1502     05  GROUPL PIC S9(0004) COMP.
  1503     05  GROUPF PIC  X(0001).
  1504     05  FILLER REDEFINES GROUPF.
  1505         10  GROUPA PIC  X(0001).
  1506     05  GROUPI PIC  X(0006).
  1507*    -------------------------------
  1508     05  STATEL PIC S9(0004) COMP.
  1509     05  STATEF PIC  X(0001).
  1510     05  FILLER REDEFINES STATEF.
  1511         10  STATEA PIC  X(0001).
  1512     05  STATEI PIC  X(0002).
  1513*    -------------------------------
  1514     05  ACCTL PIC S9(0004) COMP.
  1515     05  ACCTF PIC  X(0001).
  1516     05  FILLER REDEFINES ACCTF.
  1517         10  ACCTA PIC  X(0001).
  1518     05  ACCTI PIC  X(0010).
  1519*    -------------------------------
  1520     05  CERTL PIC S9(0004) COMP.
  1521     05  CERTF PIC  X(0001).
  1522     05  FILLER REDEFINES CERTF.
  1523         10  CERTA PIC  X(0001).
  1524     05  CERTI PIC  X(0010).
  1525*    -------------------------------
  1526     05  SFXL PIC S9(0004) COMP.
  1527     05  SFXF PIC  X(0001).
  1528     05  FILLER REDEFINES SFXF.
  1529         10  SFXA PIC  X(0001).
  1530     05  SFXI PIC  X(0001).
  1531*    -------------------------------
  1532     05  TYPEL PIC S9(0004) COMP.
  1533     05  TYPEF PIC  X(0001).
  1534     05  FILLER REDEFINES TYPEF.
  1535         10  TYPEA PIC  X(0001).
  1536     05  TYPEI PIC  X(0001).
  1537*    -------------------------------
  1538     05  DATEL PIC S9(0004) COMP.
  1539     05  DATEF PIC  X(0001).
  1540     05  FILLER REDEFINES DATEF.
  1541         10  DATEA PIC  X(0001).
  1542     05  DATEI PIC  X(0008).
  1543*    -------------------------------
  1544     05  FOLLOWL PIC S9(0004) COMP.
  1545     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL689.cbl
  1546     05  FILLER REDEFINES FOLLOWF.
  1547         10  FOLLOWA PIC  X(0001).
  1548     05  FOLLOWI PIC  X(0008).
  1549*    -------------------------------
  1550     05  RESEND1L PIC S9(0004) COMP.
  1551     05  RESEND1F PIC  X(0001).
  1552     05  FILLER REDEFINES RESEND1F.
  1553         10  RESEND1A PIC  X(0001).
  1554     05  RESEND1I PIC  X(0008).
  1555*    -------------------------------
  1556     05  ENCL PIC S9(0004) COMP.
  1557     05  ENCF PIC  X(0001).
  1558     05  FILLER REDEFINES ENCF.
  1559         10  ENCA PIC  X(0001).
  1560     05  ENCI PIC  X(0003).
  1561*    -------------------------------
  1562     05  ENDARCHL PIC S9(0004) COMP.
  1563     05  ENDARCHF PIC  X(0001).
  1564     05  FILLER REDEFINES ENDARCHF.
  1565         10  ENDARCHA PIC  X(0001).
  1566     05  ENDARCHI PIC  99999999.
  1567*    -------------------------------
  1568     05  CERTIDL PIC S9(0004) COMP.
  1569     05  CERTIDF PIC  X(0001).
  1570     05  FILLER REDEFINES CERTIDF.
  1571         10  CERTIDA PIC  X(0001).
  1572     05  CERTIDI PIC  X(0005).
  1573*    -------------------------------
  1574     05  ADDRSL PIC S9(0004) COMP.
  1575     05  ADDRSF PIC  X(0001).
  1576     05  FILLER REDEFINES ADDRSF.
  1577         10  ADDRSA PIC  X(0001).
  1578     05  ADDRSI PIC  X(0001).
  1579*    -------------------------------
  1580     05  PRINTERL PIC S9(0004) COMP.
  1581     05  PRINTERF PIC  X(0001).
  1582     05  FILLER REDEFINES PRINTERF.
  1583         10  PRINTERA PIC  X(0001).
  1584     05  PRINTERI PIC  X(0004).
  1585*    -------------------------------
  1586     05  COPIESL PIC S9(0004) COMP.
  1587     05  COPIESF PIC  X(0001).
  1588     05  FILLER REDEFINES COPIESF.
  1589         10  COPIESA PIC  X(0001).
  1590     05  COPIESI PIC  X(0001).
  1591*    -------------------------------
  1592     05  DATASORL PIC S9(0004) COMP.
  1593     05  DATASORF PIC  X(0001).
  1594     05  FILLER REDEFINES DATASORF.
  1595         10  DATASORA PIC  X(0001).
  1596     05  DATASORI PIC  X(0001).
  1597*    -------------------------------
  1598     05  ADDRLBLL PIC S9(0004) COMP.
  1599     05  ADDRLBLF PIC  X(0001).
  1600     05  FILLER REDEFINES ADDRLBLF.
  1601         10  ADDRLBLA PIC  X(0001).
  1602     05  ADDRLBLI PIC  X(0001).
  1603*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL689.cbl
  1604     05  RPERSONL PIC S9(0004) COMP.
  1605     05  RPERSONF PIC  X(0001).
  1606     05  FILLER REDEFINES RPERSONF.
  1607         10  RPERSONA PIC  X(0001).
  1608     05  RPERSONI PIC  X(0010).
  1609*    -------------------------------
  1610     05  BENTRYL PIC S9(0004) COMP.
  1611     05  BENTRYF PIC  X(0001).
  1612     05  FILLER REDEFINES BENTRYF.
  1613         10  BENTRYA PIC  X(0001).
  1614     05  BENTRYI PIC  X(0006).
  1615*    -------------------------------
  1616     05  SEQL PIC S9(0004) COMP.
  1617     05  SEQF PIC  X(0001).
  1618     05  FILLER REDEFINES SEQF.
  1619         10  SEQA PIC  X(0001).
  1620     05  SEQI PIC  X(0008).
  1621*    -------------------------------
  1622     05  BCSEQL PIC S9(0004) COMP.
  1623     05  BCSEQF PIC  X(0001).
  1624     05  FILLER REDEFINES BCSEQF.
  1625         10  BCSEQA PIC  X(0001).
  1626     05  BCSEQI PIC  X(0004).
  1627*    -------------------------------
  1628     05  L1L PIC S9(0004) COMP.
  1629     05  L1F PIC  X(0001).
  1630     05  FILLER REDEFINES L1F.
  1631         10  L1A PIC  X(0001).
  1632     05  L1I PIC  X(0003).
  1633*    -------------------------------
  1634     05  TEXT1L PIC S9(0004) COMP.
  1635     05  TEXT1F PIC  X(0001).
  1636     05  FILLER REDEFINES TEXT1F.
  1637         10  TEXT1A PIC  X(0001).
  1638     05  TEXT1I PIC  X(0070).
  1639*    -------------------------------
  1640     05  L2L PIC S9(0004) COMP.
  1641     05  L2F PIC  X(0001).
  1642     05  FILLER REDEFINES L2F.
  1643         10  L2A PIC  X(0001).
  1644     05  L2I PIC  X(0003).
  1645*    -------------------------------
  1646     05  TEXT2L PIC S9(0004) COMP.
  1647     05  TEXT2F PIC  X(0001).
  1648     05  FILLER REDEFINES TEXT2F.
  1649         10  TEXT2A PIC  X(0001).
  1650     05  TEXT2I PIC  X(0070).
  1651*    -------------------------------
  1652     05  L3L PIC S9(0004) COMP.
  1653     05  L3F PIC  X(0001).
  1654     05  FILLER REDEFINES L3F.
  1655         10  L3A PIC  X(0001).
  1656     05  L3I PIC  X(0003).
  1657*    -------------------------------
  1658     05  TEXT3L PIC S9(0004) COMP.
  1659     05  TEXT3F PIC  X(0001).
  1660     05  FILLER REDEFINES TEXT3F.
  1661         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL689.cbl
  1662     05  TEXT3I PIC  X(0070).
  1663*    -------------------------------
  1664     05  L4L PIC S9(0004) COMP.
  1665     05  L4F PIC  X(0001).
  1666     05  FILLER REDEFINES L4F.
  1667         10  L4A PIC  X(0001).
  1668     05  L4I PIC  X(0003).
  1669*    -------------------------------
  1670     05  TEXT4L PIC S9(0004) COMP.
  1671     05  TEXT4F PIC  X(0001).
  1672     05  FILLER REDEFINES TEXT4F.
  1673         10  TEXT4A PIC  X(0001).
  1674     05  TEXT4I PIC  X(0070).
  1675*    -------------------------------
  1676     05  L5L PIC S9(0004) COMP.
  1677     05  L5F PIC  X(0001).
  1678     05  FILLER REDEFINES L5F.
  1679         10  L5A PIC  X(0001).
  1680     05  L5I PIC  X(0003).
  1681*    -------------------------------
  1682     05  TEXT5L PIC S9(0004) COMP.
  1683     05  TEXT5F PIC  X(0001).
  1684     05  FILLER REDEFINES TEXT5F.
  1685         10  TEXT5A PIC  X(0001).
  1686     05  TEXT5I PIC  X(0070).
  1687*    -------------------------------
  1688     05  L6L PIC S9(0004) COMP.
  1689     05  L6F PIC  X(0001).
  1690     05  FILLER REDEFINES L6F.
  1691         10  L6A PIC  X(0001).
  1692     05  L6I PIC  X(0003).
  1693*    -------------------------------
  1694     05  TEXT6L PIC S9(0004) COMP.
  1695     05  TEXT6F PIC  X(0001).
  1696     05  FILLER REDEFINES TEXT6F.
  1697         10  TEXT6A PIC  X(0001).
  1698     05  TEXT6I PIC  X(0070).
  1699*    -------------------------------
  1700     05  L7L PIC S9(0004) COMP.
  1701     05  L7F PIC  X(0001).
  1702     05  FILLER REDEFINES L7F.
  1703         10  L7A PIC  X(0001).
  1704     05  L7I PIC  X(0003).
  1705*    -------------------------------
  1706     05  TEXT7L PIC S9(0004) COMP.
  1707     05  TEXT7F PIC  X(0001).
  1708     05  FILLER REDEFINES TEXT7F.
  1709         10  TEXT7A PIC  X(0001).
  1710     05  TEXT7I PIC  X(0070).
  1711*    -------------------------------
  1712     05  L8L PIC S9(0004) COMP.
  1713     05  L8F PIC  X(0001).
  1714     05  FILLER REDEFINES L8F.
  1715         10  L8A PIC  X(0001).
  1716     05  L8I PIC  X(0003).
  1717*    -------------------------------
  1718     05  TEXT8L PIC S9(0004) COMP.
  1719     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL689.cbl
  1720     05  FILLER REDEFINES TEXT8F.
  1721         10  TEXT8A PIC  X(0001).
  1722     05  TEXT8I PIC  X(0070).
  1723*    -------------------------------
  1724     05  L9L PIC S9(0004) COMP.
  1725     05  L9F PIC  X(0001).
  1726     05  FILLER REDEFINES L9F.
  1727         10  L9A PIC  X(0001).
  1728     05  L9I PIC  X(0003).
  1729*    -------------------------------
  1730     05  TEXT9L PIC S9(0004) COMP.
  1731     05  TEXT9F PIC  X(0001).
  1732     05  FILLER REDEFINES TEXT9F.
  1733         10  TEXT9A PIC  X(0001).
  1734     05  TEXT9I PIC  X(0070).
  1735*    -------------------------------
  1736     05  L10L PIC S9(0004) COMP.
  1737     05  L10F PIC  X(0001).
  1738     05  FILLER REDEFINES L10F.
  1739         10  L10A PIC  X(0001).
  1740     05  L10I PIC  X(0003).
  1741*    -------------------------------
  1742     05  TEXT10L PIC S9(0004) COMP.
  1743     05  TEXT10F PIC  X(0001).
  1744     05  FILLER REDEFINES TEXT10F.
  1745         10  TEXT10A PIC  X(0001).
  1746     05  TEXT10I PIC  X(0070).
  1747*    -------------------------------
  1748     05  L11L PIC S9(0004) COMP.
  1749     05  L11F PIC  X(0001).
  1750     05  FILLER REDEFINES L11F.
  1751         10  L11A PIC  X(0001).
  1752     05  L11I PIC  X(0003).
  1753*    -------------------------------
  1754     05  TEXT11L PIC S9(0004) COMP.
  1755     05  TEXT11F PIC  X(0001).
  1756     05  FILLER REDEFINES TEXT11F.
  1757         10  TEXT11A PIC  X(0001).
  1758     05  TEXT11I PIC  X(0070).
  1759*    -------------------------------
  1760     05  L12L PIC S9(0004) COMP.
  1761     05  L12F PIC  X(0001).
  1762     05  FILLER REDEFINES L12F.
  1763         10  L12A PIC  X(0001).
  1764     05  L12I PIC  X(0003).
  1765*    -------------------------------
  1766     05  TEXT12L PIC S9(0004) COMP.
  1767     05  TEXT12F PIC  X(0001).
  1768     05  FILLER REDEFINES TEXT12F.
  1769         10  TEXT12A PIC  X(0001).
  1770     05  TEXT12I PIC  X(0070).
  1771*    -------------------------------
  1772     05  ERRMSGL PIC S9(0004) COMP.
  1773     05  ERRMSGF PIC  X(0001).
  1774     05  FILLER REDEFINES ERRMSGF.
  1775         10  ERRMSGA PIC  X(0001).
  1776     05  ERRMSGI PIC  X(0079).
  1777*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL689.cbl
  1778     05  ENTERPFL PIC S9(0004) COMP.
  1779     05  ENTERPFF PIC  X(0001).
  1780     05  FILLER REDEFINES ENTERPFF.
  1781         10  ENTERPFA PIC  X(0001).
  1782     05  ENTERPFI PIC  99.
  1783*    -------------------------------
  1784     05  PF8HDL PIC S9(0004) COMP.
  1785     05  PF8HDF PIC  X(0001).
  1786     05  FILLER REDEFINES PF8HDF.
  1787         10  PF8HDA PIC  X(0001).
  1788     05  PF8HDI PIC  X(0022).
  1789 01  EL689AO REDEFINES EL689AI.
  1790     05  FILLER            PIC  X(0012).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  RUNDTEO PIC  X(0008).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  RUNTIMEO PIC  99.99.
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  HOSTO PIC  X(0010).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  SYSO PIC  X(0008).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  COMPANYO PIC  X(0003).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  USERIDO PIC  X(0004).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  MAINTO PIC  X(0001).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  FORMO PIC  X(0004).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  ARCHNUMO PIC  99999999.
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  PRTNOWO PIC  X(0001).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  CARRIERO PIC  X(0001).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  GROUPO PIC  X(0006).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  STATEO PIC  X(0002).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  ACCTO PIC  X(0010).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL689.cbl
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  SFXO PIC  X(0001).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  TYPEO PIC  X(0001).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  DATEO PIC  X(0008).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  FOLLOWO PIC  X(0008).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  RESEND1O PIC  X(0008).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  ENCO PIC  X(0003).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  ENDARCHO PIC  99999999.
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  CERTIDO PIC  X(0005).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  ADDRSO PIC  X(0001).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  PRINTERO PIC  X(0004).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  COPIESO PIC  X(0001).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  DATASORO PIC  X(0001).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  ADDRLBLO PIC  X(0001).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  RPERSONO PIC  X(0010).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  BENTRYO PIC  X(0006).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  SEQO PIC  X(0008).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  BCSEQO PIC  X(0004).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  L1O PIC  X(0003).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  TEXT1O PIC  X(0070).
  1893*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL689.cbl
  1894     05  FILLER            PIC  X(0003).
  1895     05  L2O PIC  X(0003).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  TEXT2O PIC  X(0070).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  L3O PIC  X(0003).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  TEXT3O PIC  X(0070).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  L4O PIC  X(0003).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  TEXT4O PIC  X(0070).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  L5O PIC  X(0003).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  TEXT5O PIC  X(0070).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  L6O PIC  X(0003).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  TEXT6O PIC  X(0070).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  L7O PIC  X(0003).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  TEXT7O PIC  X(0070).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  L8O PIC  X(0003).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  TEXT8O PIC  X(0070).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  L9O PIC  X(0003).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  TEXT9O PIC  X(0070).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  L10O PIC  X(0003).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  TEXT10O PIC  X(0070).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  L11O PIC  X(0003).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL689.cbl
  1952     05  TEXT11O PIC  X(0070).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  L12O PIC  X(0003).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  TEXT12O PIC  X(0070).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  ERRMSGO PIC  X(0079).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  ENTERPFO PIC  X(0002).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  PF8HDO PIC  X(0022).
  1968*    -------------------------------
  1969 01  W-MAP-REDEF REDEFINES EL689AI.
  1970*    12  FILLER                  PIC X(218).
  1971     12  FILLER                  PIC X(267).
  1972     12  EL689RI.
  1973         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1974             20  W-SC-LINEL      PIC S9(04) COMP.
  1975             20  W-SC-LINEA      PIC  X(01).
  1976             20  W-SC-LINE       PIC  X(03).
  1977             20  W-SC-TEXTL      PIC S9(04) COMP.
  1978             20  W-SC-TEXTA      PIC  X(01).
  1979             20  W-SC-TEXT       PIC  X(70).
  1980*    12  FILLER                  PIC  X(87).
  1981     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL689.cbl
  1983 01  W-CONSTANT-AREA.
  1984     12  FILLER                  PIC  X(18)
  1985                                 VALUE 'PROGRAM CONSTANTS:'.
  1986     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1987     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1988     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1989     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1990     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1991     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1992     12  W-ENCC-LENGTH           PIC S9(04)  COMP  VALUE +400.
  1993     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1994     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1995     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1996     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1997     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1998     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1999
  2000     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  2001     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  2002     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  2003     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  2004     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  2005     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  2006     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  2007     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  2008     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  2009     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  2010     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  2011     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  2012     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  2013     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  2014     12  W-ENCC-FILE-ID          PIC  X(08) VALUE 'ELENCC'.
  2015     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  2016     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  2017     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  2018     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  2019     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  2020     12  W-LOWER-CASE            PIC  X(26)
  2021         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  2022     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  2023     12  W-MAP.
  2024         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  2025         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  2026         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  2027     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  2028     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  2029     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  2030     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  2031     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  2032     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  2033     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  2034
  2035     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  2036     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  2037     12  W-TOP-FORM              PIC  X(70)
  2038                              VALUE '*****TOP OF FORM *****'.
  2039     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  2040     12  W-UPPER-CASE            PIC  X(26)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL689.cbl
  2041         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  2042     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  2043     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  2044     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL689.cbl
  2046 01  W-VARIABLE-PROCESS-CNTLS.
  2047     12  FILLER                  PIC  X(26)
  2048                        VALUE 'VARIABLE WORK AREA STARTS:'.
  2049     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  2050     12  W-VAR-HOLD.
  2051         16  W-V1                PIC  X(01).
  2052         16  W-V2                PIC  X(01).
  2053         16  W-V3                PIC  X(01).
  2054     12  FILLER REDEFINES W-VAR-HOLD.
  2055         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  2056     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  2057         88  W-SQUEEZE-FIELD          VALUE '#'.
  2058
  2059 01  W-SUPPORTED-VARIABLES.
  2060
  2061*****************COMPANY VARIABLES - ELCNTL ********************
  2062*****COMPANY NAME
  2063     12  FILLER                  PIC  X(03) VALUE '001'.
  2064     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2065     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2066     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2067     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2068
  2069*****FULL COMPANY ADDRESS
  2070     12  FILLER                  PIC  X(03) VALUE '002'.
  2071     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2073     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2074     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2075
  2076     12  FILLER                  PIC  X(03) VALUE '003'.
  2077     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2078     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2079     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2080     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2081
  2082     12  FILLER                  PIC  X(03) VALUE '004'.
  2083     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2085     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2086     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2087
  2088     12  FILLER                  PIC  X(03) VALUE '005'.
  2089     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2090     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2091     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2092     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2093
  2094     12  FILLER                  PIC  X(03) VALUE '006'.
  2095     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2096     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2097     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2098     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2099
  2100*****REMAINING 4 ARE NOT CURRENTLY USED
  2101     12  FILLER                  PIC  X(03) VALUE '007'.
  2102     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2103     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL689.cbl
  2104     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2105     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2106
  2107     12  FILLER                  PIC  X(03) VALUE '008'.
  2108     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2109     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2110     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2111     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2112
  2113     12  FILLER                  PIC  X(03) VALUE '009'.
  2114     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2115     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2116     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2117     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2118
  2119     12  FILLER                  PIC  X(03) VALUE '010'.
  2120     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2121     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2122     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2123     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2124
  2125************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  2126*****LIFE BENEFIT DESCRIPTION
  2127     12  FILLER                  PIC  X(03) VALUE '011'.
  2128     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2129     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2130     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2131     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2132
  2133*****REMAINING 3 ARE NOT CURRENTLY USED
  2134     12  FILLER                  PIC  X(03) VALUE '012'.
  2135     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2136     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2137     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2138     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2139
  2140     12  FILLER                  PIC  X(03) VALUE '013'.
  2141     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2142     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2143     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2144     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2145
  2146     12  FILLER                  PIC  X(03) VALUE '014'.
  2147     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2148     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2149     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2150     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2151
  2152************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2153*****AH BENEFIT DESCRIPTION
  2154     12  FILLER                  PIC  X(03) VALUE '015'.
  2155     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2156     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2157     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2158     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2159
  2160*****ELIMINATION PERIOD
  2161     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL689.cbl
  2162     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2163     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2164     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2165     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2166
  2167*****REMAINING 3 ARE NOT CURRENTLY USED
  2168     12  FILLER                  PIC  X(03) VALUE '017'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2170     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2171     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2172     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2173
  2174     12  FILLER                  PIC  X(03) VALUE '018'.
  2175     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2176     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2177     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2178     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2179
  2180     12  FILLER                  PIC  X(03) VALUE '019'.
  2181     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2182     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2183     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2184     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2185
  2186*****************CARRIER VARIABLES - ELCNTL ********************
  2187*****CARRIER NAME
  2188     12  FILLER                  PIC  X(03) VALUE '020'.
  2189     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2190     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2191     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2192     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2193
  2194*****FULL CARRIER ADDRESS
  2195     12  FILLER                  PIC  X(03) VALUE '021'.
  2196     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2197     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2198     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2199     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2200
  2201     12  FILLER                  PIC  X(03) VALUE '022'.
  2202     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2203     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2204     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2205     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2206
  2207     12  FILLER                  PIC  X(03) VALUE '023'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2209     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2210     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2211     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2212
  2213     12  FILLER                  PIC  X(03) VALUE '024'.
  2214     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2215     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2216     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2217     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2218
  2219     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL689.cbl
  2220     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2221     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2222     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2223     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2224
  2225*****CARRIER PHONE NUMBER
  2226     12  FILLER                  PIC  X(03) VALUE '026'.
  2227     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2228     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2229     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2230     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2231
  2232*****REMAINING 4 ARE NOT CURRENTLY USED
  2233     12  FILLER                  PIC  X(03) VALUE '027'.
  2234     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2235     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2236     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2237     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2238
  2239     12  FILLER                  PIC  X(03) VALUE '028'.
  2240     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2241     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2242     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2243     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2244
  2245     12  FILLER                  PIC  X(03) VALUE '029'.
  2246     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2247     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2248     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2249     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2250
  2251     12  FILLER                  PIC  X(03) VALUE '030'.
  2252     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2253     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2254     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2255     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2256
  2257***************** MAIL VARIABLES - ELMAIL **********************
  2258*****FULL MAIL ADDRESS
  2259     12  FILLER                  PIC  X(03) VALUE '031'.
  2260     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2261     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2262     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2263     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2264
  2265     12  FILLER                  PIC  X(03) VALUE '032'.
  2266     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2267     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2268     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2269     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2270
  2271     12  FILLER                  PIC  X(03) VALUE '033'.
  2272     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2273     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2274     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2275     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2276
  2277     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL689.cbl
  2278     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2279     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2280     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2281     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2282
  2283     12  FILLER                  PIC  X(03) VALUE '035'.
  2284     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2285     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2286     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2287     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2288
  2289     12  FILLER                  PIC  X(03) VALUE '036'.
  2290     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2291     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2292     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2293     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2294**** CRED BENE NAME FROM ERMAIL
  2295     12  FILLER                  PIC  X(03) VALUE '037'.
  2296     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2297     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2298     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2299     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2300*****REMAINING 2 ARE NOT CURRENTLY USED
  2301     12  FILLER                  PIC  X(03) VALUE '038'.
  2302     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2303     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2304     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2305     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2306
  2307     12  FILLER                  PIC  X(03) VALUE '039'.
  2308     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2309     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2310     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2311     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2312
  2313*************** ACCOUNT VARIABLES - ERACCT *********************
  2314*****ACCOUNT NAME
  2315     12  FILLER                  PIC  X(03) VALUE '040'.
  2316     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2317     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2318     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2319     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2320
  2321*****FULL ACCOUNT ADDRESS
  2322     12  FILLER                  PIC  X(03) VALUE '041'.
  2323     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2324     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2325     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2326     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2327
  2328     12  FILLER                  PIC  X(03) VALUE '042'.
  2329     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2330     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2331     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2332     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2333
  2334     12  FILLER                  PIC  X(03) VALUE '043'.
  2335     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL689.cbl
  2336     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2337     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2338     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2339
  2340     12  FILLER                  PIC  X(03) VALUE '044'.
  2341     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2342     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2343     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2344     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2345
  2346     12  FILLER                  PIC  X(03) VALUE '045'.
  2347     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2348     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2349     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2350     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2351
  2352*****ACCOUNT PHONE NUMBER
  2353     12  FILLER                  PIC  X(03) VALUE '046'.
  2354     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2355     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2356     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2357     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2358
  2359*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2360     12  FILLER                  PIC  X(03) VALUE '047'.
  2361     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2362     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2363     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2364     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2365
  2366****ACCOUNT CSR CODE
  2367     12  FILLER                  PIC  X(03) VALUE '048'.
  2368     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2369     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2370     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2371     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2372****ACCOUNT ACCOUNT NUMBER
  2373     12  FILLER                  PIC  X(03) VALUE '049'.
  2374     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2375     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2376     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2377     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2378
  2379**** CRED BENE ADDRESS LINE 1 ERMAIL
  2380     12  FILLER                  PIC  X(03) VALUE '050'.
  2381     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2382     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2383     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2384     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2385
  2386**** CRED BENE ADDRESS LINE 2 ERMAIL
  2387     12  FILLER                  PIC  X(03) VALUE '051'.
  2388     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2389     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2390     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2391     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2392
  2393**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL689.cbl
  2394     12  FILLER                  PIC  X(03) VALUE '052'.
  2395     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2396     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2397     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2398     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2399
  2400**** CRED BENE ZIP  1 ERMAIL
  2401     12  FILLER                  PIC  X(03) VALUE '053'.
  2402     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2403     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2404     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2405     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2406
  2407*****REMAINING 6 ARE NOT CURRENTLY USED
  2408     12  FILLER                  PIC  X(03) VALUE '054'.
  2409     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2410     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2411     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2412     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2413
  2414     12  FILLER                  PIC  X(03) VALUE '055'.
  2415     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2416     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2417     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2418     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2419
  2420     12  FILLER                  PIC  X(03) VALUE '056'.
  2421     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2422     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2423     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2424     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2425
  2426     12  FILLER                  PIC  X(03) VALUE '057'.
  2427     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2428     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2429     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2430     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2431
  2432     12  FILLER                  PIC  X(03) VALUE '058'.
  2433     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2434     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2435     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2436     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2437
  2438     12  FILLER                  PIC  X(03) VALUE '059'.
  2439     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2440     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2441     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2442     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2443
  2444*************** NON FILE VARIABLES *****************************
  2445*****CURRENT DATE
  2446     12  FILLER                  PIC  X(03) VALUE '060'.
  2447     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2448     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2449     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2450     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2451
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL689.cbl
  2452*****FULL CURRENT DATE
  2453     12  FILLER                  PIC  X(03) VALUE '061'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2455     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2456     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2457     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2458
  2459*****FORM
  2460     12  FILLER                  PIC  X(03) VALUE '062'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2462     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2463     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2464     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2465
  2466*****VARIABLE 1
  2467     12  FILLER                  PIC  X(03) VALUE '063'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2469     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2470     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2471     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2472
  2473*****VARIABLE 2
  2474     12  FILLER                  PIC  X(03) VALUE '064'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2476     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2477     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2478     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2479
  2480*****VARIABLE 3
  2481     12  FILLER                  PIC  X(03) VALUE '065'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2483     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2484     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2485     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2486
  2487*****VARIABLE 4
  2488     12  FILLER                  PIC  X(03) VALUE '066'.
  2489     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2490     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2491     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2492     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2493
  2494*****REMAINING 3 ARE NOT CURRENTLY USED
  2495     12  FILLER                  PIC  X(03) VALUE '067'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2497     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2498     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2499     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2500
  2501     12  FILLER                  PIC  X(03) VALUE '068'.
  2502     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2503     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2504     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2505     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2506
  2507     12  FILLER                  PIC  X(03) VALUE '069'.
  2508     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2509     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL689.cbl
  2510     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2511     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2512
  2513************** CERTIFICATE VARIABLES - ELCERT *****************
  2514*****CARRIER CODE IN CERT
  2515     12  FILLER                  PIC  X(03) VALUE '070'.
  2516     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2517     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2518     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2519     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2520
  2521*****GROUPING CODE IN CERT
  2522     12  FILLER                  PIC  X(03) VALUE '071'.
  2523     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2524     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2525     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2526     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2527
  2528*****ACCOUNT NUMBER IN CERT
  2529     12  FILLER                  PIC  X(03) VALUE '072'.
  2530     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2531     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2532     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2533     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2534
  2535*****CERTIFICATE NUMBER
  2536     12  FILLER                  PIC  X(03) VALUE '073'.
  2537     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2538     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2539     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2540     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2541
  2542*****CERT EFFECTIVE DATE
  2543     12  FILLER                  PIC  X(03) VALUE '074'.
  2544     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2545     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2546     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2547     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2548
  2549*****CERT EXPIRATION DATE (LIFE)
  2550     12  FILLER                  PIC  X(03) VALUE '075'.
  2551     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2552     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2553     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2554     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2555
  2556*****CERT EXPIRATION DATE (AH)
  2557     12  FILLER                  PIC  X(03) VALUE '076'.
  2558     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2559     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2560     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2561     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2562
  2563*****LIFE TERM
  2564     12  FILLER                  PIC  X(03) VALUE '077'.
  2565     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2566     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2567     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL689.cbl
  2568     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2569
  2570*****AH  TERM
  2571     12  FILLER                  PIC  X(03) VALUE '078'.
  2572     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2573     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2574     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2575     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2576
  2577*****LIFE COVERAGE AMOUNT
  2578     12  FILLER                  PIC  X(03) VALUE '079'.
  2579     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2580     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2581     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2582     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2583
  2584*****AH MONTHLY BENEFIT
  2585     12  FILLER                  PIC  X(03) VALUE '080'.
  2586     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2587     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2588     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2589     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2590
  2591*****LIFE CANCEL DATE
  2592     12  FILLER                  PIC  X(03) VALUE '081'.
  2593     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2594     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2595     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2596     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2597
  2598*****AH CANCEL DATE
  2599     12  FILLER                  PIC  X(03) VALUE '082'.
  2600     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2601     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2602     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2603     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2604
  2605*****LIFE COVERAGE FORM NUMBER
  2606     12  FILLER                  PIC  X(03) VALUE '083'.
  2607     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2608     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2609     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2610     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2611
  2612*****UNUSED
  2613     12  FILLER                  PIC  X(03) VALUE '084'.
  2614     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2615     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2616     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2617     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2618
  2619*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2620     12  FILLER                  PIC  X(03) VALUE '085'.
  2621     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2622     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2623     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2624     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2625
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL689.cbl
  2626*****LOAN NUMBER
  2627     12  FILLER                  PIC  X(03) VALUE '086'.
  2628     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2629     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2630     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2631     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2632
  2633*****LOAN BALANCE
  2634     12  FILLER                  PIC  X(03) VALUE '087'.
  2635     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2636     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2637     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2638     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2639
  2640*****MEMBER NUMBER
  2641     12  FILLER                  PIC  X(03) VALUE '088'.
  2642     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2643     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2644     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2645     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2646
  2647*****INSURED SOC SEC NUMBER
  2648     12  FILLER                  PIC  X(03) VALUE '089'.
  2649     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2650     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2651     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2652     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2653
  2654*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2655     12  FILLER                  PIC  X(03) VALUE '090'.
  2656     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2657     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2658     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2659     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2660
  2661*****INSURED FIRST NAME (CERTIFICATE)
  2662     12  FILLER                  PIC  X(03) VALUE '091'.
  2663     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2664     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2665     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2666     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2667
  2668*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2669     12  FILLER                  PIC  X(03) VALUE '092'.
  2670     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2671     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2672     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2673     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2674
  2675*****ORIG TERM * MON BEN
  2676     12  FILLER                  PIC  X(03) VALUE '093'.
  2677     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2678     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2679     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2680     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2681
  2682*****INSURED'S NAME (LAST, FIRST, INIT)
  2683     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL689.cbl
  2684     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2685     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2686     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2687     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2688
  2689*****INSURED'S NAME (FIRST, INIT, LAST)
  2690     12  FILLER                  PIC  X(03) VALUE  '095'.
  2691     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2692     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2693     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2694     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2695
  2696*****TITLE (MR/MS)
  2697     12  FILLER                  PIC  X(03) VALUE '096'.
  2698     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2699     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2700     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2701     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2702
  2703*****LIFE PREMIUM (CERTIFICATE)
  2704     12  FILLER                  PIC  X(03) VALUE '097'.
  2705     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2706     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2707     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2708     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2709
  2710*****A/H PREMIUM (CERTIFICATE)
  2711     12  FILLER                  PIC  X(03) VALUE '098'.
  2712     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2713     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2714     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2715     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2716
  2717*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2718     12  FILLER                  PIC  X(03) VALUE '099'.
  2719     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2720     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2721     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2722     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2723
  2724*****JOINT'S FIRST NAME (CERTIFICATE)
  2725     12  FILLER                  PIC  X(03) VALUE '100'.
  2726     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2727     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2728     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2729     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2730
  2731*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2732     12  FILLER                  PIC  X(03) VALUE '101'.
  2733     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2734     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2735     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2736     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2737
  2738*****JOINT'S NAME (LAST, FIRST, INIT)
  2739     12  FILLER                  PIC  X(03) VALUE '102'.
  2740     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2741     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL689.cbl
  2742     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2743     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2744
  2745*****JOINT'S NAME (FIRST, INIT, LAST)
  2746     12  FILLER                  PIC  X(03) VALUE '103'.
  2747     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2748     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2749     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2750     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2751
  2752*****INSURED'S FIRST AND LAST NAME
  2753     12  FILLER                  PIC  X(03) VALUE '104'.
  2754     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2755     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2756     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2757     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2758
  2759*****JOINT'S FIRST AND LAST NAME
  2760     12  FILLER                  PIC  X(03) VALUE '105'.
  2761     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2762     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2763     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2764     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2765
  2766*****ENTERED LIFE REFUND (CERT)
  2767     12  FILLER                  PIC  X(03) VALUE '106'.
  2768     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2769     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2770     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2771     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2772
  2773*****ENTERED A/H REFUND (CERT)
  2774     12  FILLER                  PIC  X(03) VALUE '107'.
  2775     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2776     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2777     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2778     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2779
  2780*****INSURED'S LAST NAME
  2781     12  FILLER                  PIC  X(03) VALUE '108'.
  2782     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2783     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2784     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2785     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2786
  2787*****BENEFICIARY
  2788     12  FILLER                  PIC  X(03) VALUE  '109'.
  2789     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2790     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2791     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2792     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2793
  2794************** PENDING VARIABLES - ERPNDB *********************
  2795*****INSURED DATE OF BIRTH
  2796     12  FILLER                  PIC  X(03) VALUE '110'.
  2797     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2798     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2799     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL689.cbl
  2800     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2801
  2802*****ENTERED LIFE PREMIUM (PENDING)
  2803     12  FILLER                  PIC  X(03) VALUE '111'.
  2804     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2805     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2806     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2807     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2808
  2809*****ENTERED A/H PREMIUM (PENDING)
  2810     12  FILLER                  PIC  X(03) VALUE '112'.
  2811     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2812     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2813     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2814     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2815
  2816*****CALCULATED LIFE PREMIUM (PENDING)
  2817     12  FILLER                  PIC  X(03) VALUE '113'.
  2818     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2819     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2820     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2821     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2822
  2823*****CALCULATED A/H PREMIUM (PENDING)
  2824     12  FILLER                  PIC  X(03) VALUE '114'.
  2825     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2826     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2827     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2828     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2829
  2830*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2831     12  FILLER                  PIC  X(03) VALUE '115'.
  2832     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2833     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2834     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2835     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2836
  2837*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2838     12  FILLER                  PIC  X(03) VALUE '116'.
  2839     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2840     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2841     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2842     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2843
  2844*****PRIOR CANCEL DATE
  2845     12  FILLER                  PIC  X(03) VALUE '117'.
  2846     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2847     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2848     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2849     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2850
  2851*****ENTERED LIFE REFUND (PENDING)
  2852     12  FILLER                  PIC  X(03) VALUE '118'.
  2853     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2854     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2855     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2856     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2857
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL689.cbl
  2858*****ENTERED A/H REFUND (PENDING)
  2859     12  FILLER                  PIC  X(03) VALUE '119'.
  2860     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2861     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2862     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2863     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2864
  2865*****CALCULATED LIFE REFUND (PENDING)
  2866     12  FILLER                  PIC  X(03) VALUE '120'.
  2867     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2868     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2869     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2870     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2871
  2872*****CALCULATED A/H REFUND (PENDING)
  2873     12  FILLER                  PIC  X(03) VALUE '121'.
  2874     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2875     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2876     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2877     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2878
  2879*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2880     12  FILLER                  PIC  X(03) VALUE '122'.
  2881     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2882     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2883     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2884     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2885
  2886*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2887     12  FILLER                  PIC  X(03) VALUE '123'.
  2888     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2889     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2890     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2891     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2892
  2893*****INSUREDS AGE
  2894     12  FILLER                  PIC  X(03) VALUE '124'.
  2895     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2896     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2897     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2898     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2899
  2900*****LIFE BENEFIT (PENDING)
  2901     12  FILLER                  PIC  X(03) VALUE '125'.
  2902     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2903     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2904     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2905     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2906
  2907*****A/H BENEFIT (PENDING)
  2908     12  FILLER                  PIC  X(03) VALUE '126'.
  2909     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2910     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2911     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2912     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2913
  2914*****LIFE RATE
  2915     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL689.cbl
  2916     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2917     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2918     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2919     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2920
  2921*****A/H RATE
  2922     12  FILLER                  PIC  X(03) VALUE '128'.
  2923     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2924     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2925     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2926     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2927
  2928*****TERM (PENDING)
  2929     12  FILLER                  PIC  X(03) VALUE '129'.
  2930     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2931     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2932     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2933     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2934
  2935*****BATCH NUMBER
  2936     12  FILLER                  PIC  X(03) VALUE '130'.
  2937     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2938     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2939     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2940     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2941
  2942*****TOTAL OF LIFE AND A&H REFUND
  2943     12  FILLER                  PIC  X(03) VALUE '131'.
  2944     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2945     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2946     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2947     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2948
  2949*****NH INTEREST ON REFUNDS
  2950     12  FILLER                  PIC  X(03) VALUE '132'.
  2951     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2952     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2953     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2954     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2955*****GREATER OF THE LIFE AND AH CANCEL DATE
  2956     12  FILLER                  PIC  X(03) VALUE '133'.
  2957     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2958     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2959     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2960     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2961
  2962*****THE NEXT 6 NOT CURRENTLY USED
  2963     12  FILLER                  PIC  X(03) VALUE '134'.
  2964     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2965     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2966     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2967     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2968
  2969     12  FILLER                  PIC  X(03) VALUE '135'.
  2970     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2971     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2972     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2973     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL689.cbl
  2974
  2975     12  FILLER                  PIC  X(03) VALUE '136'.
  2976     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2977     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2978     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2979     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2980
  2981     12  FILLER                  PIC  X(03) VALUE '137'.
  2982     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2983     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2984     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2985     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2986
  2987     12  FILLER                  PIC  X(03) VALUE '138'.
  2988     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2989     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2990     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2991     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2992
  2993     12  FILLER                  PIC  X(03) VALUE '139'.
  2994     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2995     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2996     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2997     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2998
  2999************** COMPENSATION VARIABLES - ERCOMP ****************
  3000*****COMPENSATION ACCT NAME
  3001     12  FILLER                  PIC  X(03) VALUE '140'.
  3002     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3003     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3004     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3005     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3006
  3007*****FULL COMPENSATION ADDRESS TYPE 'A'
  3008     12  FILLER                  PIC  X(03) VALUE '141'.
  3009     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3010     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3011     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3012     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3013
  3014     12  FILLER                  PIC  X(03) VALUE '142'.
  3015     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3016     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3017     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3018     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3019
  3020     12  FILLER                  PIC  X(03) VALUE '143'.
  3021     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3022     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3023     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3024     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3025
  3026     12  FILLER                  PIC  X(03) VALUE '144'.
  3027     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3028     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3029     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3030     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3031
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL689.cbl
  3032     12  FILLER                  PIC  X(03) VALUE '145'.
  3033     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3034     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3035     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3036     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3037
  3038     12  FILLER                  PIC  X(03) VALUE '146'.
  3039     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3040     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3041     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3042     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3043
  3044*****COMPENSATION PHONE NUMBER
  3045     12  FILLER                  PIC  X(03) VALUE '147'.
  3046     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3047     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3048     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3049     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3050
  3051*****COMPENSATION CSR NAME
  3052     12  FILLER                  PIC  X(03) VALUE '148'.
  3053     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3054     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3055     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3056     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3057
  3058*****COMPENSATION LAST STATEMENT DATE
  3059     12  FILLER                  PIC  X(03) VALUE '149'.
  3060     12  FILLER                  PIC S9(04) COMP VALUE +18.
  3061     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3062     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3063     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3064
  3065*****COMPENSATION ENDING BALANCE
  3066     12  FILLER                  PIC  X(03) VALUE '150'.
  3067     12  FILLER                  PIC S9(04) COMP VALUE +14.
  3068     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3069     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3070     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3071
  3072******************  PROCESSOR DATA - ELCNTL (2) ****************
  3073*****EXECUTING PROCESSOR NAME
  3074     12  FILLER                  PIC  X(03) VALUE '151'.
  3075     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3076     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3077     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3078     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3079
  3080*****PROCESSOR TITLE
  3081     12  FILLER                  PIC  X(03) VALUE '152'.
  3082     12  FILLER                  PIC S9(04) COMP VALUE +26.
  3083     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3084     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3085     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3086
  3087*****PROCESSOR
  3088     12  FILLER                  PIC  X(03) VALUE '153'.
  3089     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL689.cbl
  3090     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3091     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3092     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3093
  3094*****CSR TITLE
  3095     12  FILLER                  PIC  X(03) VALUE '154'.
  3096     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3097     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3098     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3099     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3100*****REMAINING 2 ARE NOT CURRENTLY USED
  3101     12  FILLER                  PIC  X(03) VALUE '155'.
  3102     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3103     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3104     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3105     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3106
  3107     12  FILLER                  PIC  X(03) VALUE '156'.
  3108     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3109     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3110     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3111     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3112
  3113******************  CHECK DATA - ERCHEK    *********************
  3114*****CHECK AMOUNT
  3115     12  FILLER                  PIC  X(03) VALUE '157'.
  3116     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3117     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3118     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3119     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3120
  3121*****CHECK NUMBER
  3122     12  FILLER                  PIC  X(03) VALUE '158'.
  3123     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3124     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3125     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3126     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3127
  3128*****PAYEE 1 NAME
  3129     12  FILLER                  PIC  X(03) VALUE '159'.
  3130     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3131     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3132     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3133     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3134
  3135*****PAYEE 2 NAME
  3136     12  FILLER                  PIC  X(03) VALUE '160'.
  3137     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3138     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3139     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3140     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3141
  3142*****ADDRSS 1
  3143     12  FILLER                  PIC  X(03) VALUE '161'.
  3144     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3145     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3146     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3147     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL689.cbl
  3148
  3149*****ADDRESS 2
  3150     12  FILLER                  PIC  X(03) VALUE '162'.
  3151     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3152     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3153     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3154     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3155
  3156*****PAYEE CITY STATE
  3157     12  FILLER                  PIC  X(03) VALUE '163'.
  3158     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3159     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3160     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3161     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3162
  3163*****ZIP CODE
  3164     12  FILLER                  PIC  X(03) VALUE '164'.
  3165     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3166     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3167     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3168     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3169
  3170*****CHECK CONTROL
  3171     12  FILLER                  PIC  X(03) VALUE '165'.
  3172     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3173     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3174     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3175     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3176
  3177*****REASON FOR CHECK
  3178     12  FILLER                  PIC  X(03) VALUE '166'.
  3179     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3180     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3181     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3182     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3183
  3184*****REMAINING 3 ARE NOT CURRENTLY USED
  3185     12  FILLER                  PIC  X(03) VALUE '167'.
  3186     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3187     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3188     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3189     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3190
  3191     12  FILLER                  PIC  X(03) VALUE '168'.
  3192     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3193     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3194     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3195     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3196
  3197     12  FILLER                  PIC  X(03) VALUE '169'.
  3198     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3199     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3200     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3201     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3202
  3203
  3204*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3205*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL689.cbl
  3206     12  FILLER                  PIC  X(03) VALUE '170'.
  3207     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3208     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3209     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3210     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3211
  3212*****CHECK NUMBER - PYAJ
  3213     12  FILLER                  PIC  X(03) VALUE '171'.
  3214     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3215     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3216     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3217     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3218
  3219*****CHECK CONTROL - PYAJ
  3220     12  FILLER                  PIC  X(03) VALUE '172'.
  3221     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3222     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3223     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3224     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3225
  3226***** COMMENT - PYAJ
  3227     12  FILLER                  PIC  X(03) VALUE '173'.
  3228     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3229     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3230     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3231     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3232
  3233*****NEW FIELDS.
  3234*****COMPENSATION FULL ADDRESS TYPE 'G'
  3235     12  FILLER                  PIC  X(03) VALUE '174'.
  3236     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3237     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3238     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3239     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3240
  3241     12  FILLER                  PIC  X(03) VALUE '175'.
  3242     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3243     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3244     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3245     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3246
  3247     12  FILLER                  PIC  X(03) VALUE '176'.
  3248     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3249     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3250     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3251     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3252
  3253     12  FILLER                  PIC  X(03) VALUE '177'.
  3254     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3255     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3256     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3257     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3258
  3259     12  FILLER                  PIC  X(03) VALUE '178'.
  3260     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3261     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3262     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3263     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL689.cbl
  3264
  3265     12  FILLER                  PIC  X(03) VALUE '179'.
  3266     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3267     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3268     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3269     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3270
  3271*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3272     12  FILLER                  PIC  X(03) VALUE '180'.
  3273     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3274     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3275     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3276     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3277**** COMPENSATION BILLING SWITCH
  3278     12  FILLER                  PIC XXX    VALUE '181'.
  3279     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3280     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3281     12  FILLER                  PIC X      VALUE ALL 'N'.
  3282     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3283*****COMPENSATION FAX NUMBER
  3284     12  FILLER                  PIC  X(03) VALUE '182'.
  3285     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3286     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3287     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3288     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3289**** COMPENSATION STATUS
  3290     12  FILLER                  PIC XXX    VALUE '183'.
  3291     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3292     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3293     12  FILLER                  PIC X      VALUE ALL 'N'.
  3294     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3295***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3296*****COMPENSATION FULL ADDRESS TYPE 'B'
  3297     12  FILLER                  PIC  X(03) VALUE '184'.
  3298     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3299     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3300     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3301     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3302
  3303     12  FILLER                  PIC  X(03) VALUE '185'.
  3304     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3305     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3306     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3307     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3308
  3309     12  FILLER                  PIC  X(03) VALUE '186'.
  3310     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3311     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3312     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3313     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3314
  3315     12  FILLER                  PIC  X(03) VALUE '187'.
  3316     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3317     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3318     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3319     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3320
  3321     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL689.cbl
  3322     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3323     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3324     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3325     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3326
  3327     12  FILLER                  PIC  X(03) VALUE '189'.
  3328     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3329     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3330     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3331     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3332
  3333
  3334 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3335*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3336     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3337                        INDEXED BY W-VG-NDX.
  3338         16  W-VARIABLE-ID         PIC  X(03).
  3339         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3340         16  W-VG-TEXT.
  3341             20  W-VAR-CHAR
  3342                        OCCURS 30 TIMES
  3343                        INDEXED BY W-VC-NDX
  3344                                   PIC  X(01).
  3345         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3346             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3347
  3348         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3349
  3350 01  W-VAR-END                   PIC  X(23)
  3351                        VALUE ':VARIABLE WORK AREA END'.
  3352
  3353 01  W-PROGRAM-TABLE-AREA.
  3354     12  FILLER                  PIC  X(15)
  3355                                 VALUE 'PROGRAM TABLES:'.
  3356
  3357     12  W-RECORD-TABLE              VALUE SPACES.
  3358         16  W-RC-GRP OCCURS 500 TIMES
  3359                       INDEXED BY W-RG-NDX
  3360                                  W-RG-NDX1.
  3361             20  W-RC-TEXT.
  3362                 24  W-RC-CHAR OCCURS 70 TIMES
  3363                                INDEXED BY W-RC-NDX
  3364                                           W-RC-NDX1
  3365                                 PIC  X(01).
  3366             20  W-RC-PC         PIC  9(02).
  3367             20  W-RC-SC         PIC  X(01).
  3368
  3369     12  FILLER REDEFINES W-RECORD-TABLE.
  3370         16  W-REC-CHAR OCCURS 36500 TIMES
  3371                        INDEXED BY W-RVS-NDX
  3372                                   W-RVS-NDX2
  3373                                 PIC  X(01).
  3374     12  FILLER REDEFINES W-RECORD-TABLE.
  3375         16  W-TS-GROUP OCCURS 10 TIMES
  3376                        INDEXED BY W-TS-NDX
  3377                                 PIC X(3650).
  3378
  3379     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL689.cbl
  3380                                 VALUE 'TEXT TABLE:'.
  3381     12  W-TX-TABLE                  VALUE SPACES.
  3382         16  W-TX-GRP OCCURS 500 TIMES
  3383                       INDEXED BY W-TG-NDX
  3384                                  W-TG-NDX2.
  3385             20  W-TX-TEXT.
  3386                 24  W-TX-CHAR OCCURS 70 TIMES
  3387                                    INDEXED BY W-TX-NDX
  3388                                               W-TX-NDX1
  3389                                               W-TX-NDX2
  3390                                 PIC  X(01).
  3391             20  W-TX-PC         PIC  9(02).
  3392             20  W-TX-SC         PIC  X(01).
  3393
  3394     12  FILLER                  PIC  X(11)
  3395                                 VALUE 'FILE TABLE:'.
  3396     12  W-FILE-TABLE                VALUE SPACES.
  3397         16  W-FILE-USE-IND OCCURS 20 TIMES
  3398                       INDEXED BY W-FILE-NDX
  3399                                 PIC  X(01).
  3400             88  W-FILE-NOT-USED     VALUE SPACE.
  3401             88  W-FILE-USED         VALUE 'Y'.
  3402
  3403     12  FILLER                  PIC  X(14)
  3404                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL689.cbl
  3406 01  ERROR-MESSAGES.
  3407     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3408     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3409     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3410     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3411     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3412     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3413     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3414     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3415     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3416     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3417     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3418     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3419     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3420     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3421     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3422     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3423     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3424     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3425     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3426     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3427     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3428     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3429     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3430     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3431     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3432     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3433     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3434     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3435     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3436     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3437     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3438     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3439     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3440     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3441     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3442     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3443     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3444     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3445     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3446     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3447     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3448     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3449     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3450     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3451     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3452     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3453     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3454     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3455     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3456     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3457     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3458     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3459     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3460     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3461     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3462     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3463     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL689.cbl
  3464     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3465     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3466     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3467     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3468     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3469     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3470     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3471     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3472     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3473     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3474     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3475     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3476     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3477     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3478     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3479     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3480     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3481     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3482     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3483     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3484     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3485     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3486     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3487     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3488     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3489     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3490     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3491     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3492     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3493     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3494     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3495     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3496     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3497     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3498     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3499     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3500     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3501     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3502     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3503     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3504     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL689.cbl
  3506*    COPY ELCAID.
  3507******************************************************************
  3508*                                                                *
  3509*                            ELCAID.                             *
  3510*                            VMOD=2.001                          *
  3511*                                                                *
  3512*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3513*                                                                *
  3514*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3515*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3516******************************************************************
  3517
  3518 01  DFHAID.
  3519   02  DFHNULL   PIC  X  VALUE  ' '.
  3520   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3521   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3522   02  DFHPEN    PIC  X  VALUE  '='.
  3523   02  DFHOPID   PIC  X  VALUE  'W'.
  3524   02  DFHPA1    PIC  X  VALUE  '%'.
  3525   02  DFHPA2    PIC  X  VALUE  '>'.
  3526   02  DFHPA3    PIC  X  VALUE  ','.
  3527   02  DFHPF1    PIC  X  VALUE  '1'.
  3528   02  DFHPF2    PIC  X  VALUE  '2'.
  3529   02  DFHPF3    PIC  X  VALUE  '3'.
  3530   02  DFHPF4    PIC  X  VALUE  '4'.
  3531   02  DFHPF5    PIC  X  VALUE  '5'.
  3532   02  DFHPF6    PIC  X  VALUE  '6'.
  3533   02  DFHPF7    PIC  X  VALUE  '7'.
  3534   02  DFHPF8    PIC  X  VALUE  '8'.
  3535   02  DFHPF9    PIC  X  VALUE  '9'.
  3536   02  DFHPF10   PIC  X  VALUE  ':'.
  3537   02  DFHPF11   PIC  X  VALUE  '#'.
  3538   02  DFHPF12   PIC  X  VALUE  '@'.
  3539   02  DFHPF13   PIC  X  VALUE  'A'.
  3540   02  DFHPF14   PIC  X  VALUE  'B'.
  3541   02  DFHPF15   PIC  X  VALUE  'C'.
  3542   02  DFHPF16   PIC  X  VALUE  'D'.
  3543   02  DFHPF17   PIC  X  VALUE  'E'.
  3544   02  DFHPF18   PIC  X  VALUE  'F'.
  3545   02  DFHPF19   PIC  X  VALUE  'G'.
  3546   02  DFHPF20   PIC  X  VALUE  'H'.
  3547   02  DFHPF21   PIC  X  VALUE  'I'.
  3548*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3549   02  DFHPF22   PIC  X  VALUE  '['.
  3550   02  DFHPF23   PIC  X  VALUE  '.'.
  3551   02  DFHPF24   PIC  X  VALUE  '<'.
  3552   02  DFHMSRE   PIC  X  VALUE  'X'.
  3553   02  DFHSTRF   PIC  X  VALUE  'h'.
  3554   02  DFHTRIG   PIC  X  VALUE  '"'.
  3555 01  FILLER    REDEFINES DFHAID.
  3556     12  FILLER                  PIC  X(08).
  3557     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL689.cbl
  3559*    COPY ELCATTR.
  3560******************************************************************
  3561*                                                                *
  3562*                            ELCATTR.                            *
  3563*                            VMOD=2.001                          *
  3564*                                                                *
  3565*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3566*                                                                *
  3567*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3568*                                                                *
  3569*                   POS 1   P=PROTECTED                          *
  3570*                           U=UNPROTECTED                        *
  3571*                           S=ASKIP                              *
  3572*                   POS 2   A=ALPHA/NUMERIC                      *
  3573*                           N=NUMERIC                            *
  3574*                   POS 3   N=NORMAL                             *
  3575*                           B=BRIGHT                             *
  3576*                           D=DARK                               *
  3577*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3578*                           OF=MODIFIED DATA TAG OFF             *
  3579*                                                                *
  3580*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3581******************************************************************
  3582 01  ATTRIBUTE-LIST.
  3583     12  AL-PABOF            PIC X       VALUE 'Y'.
  3584     12  AL-PABON            PIC X       VALUE 'Z'.
  3585     12  AL-PADOF            PIC X       VALUE '%'.
  3586     12  AL-PADON            PIC X       VALUE '_'.
  3587     12  AL-PANOF            PIC X       VALUE '-'.
  3588     12  AL-PANON            PIC X       VALUE '/'.
  3589     12  AL-SABOF            PIC X       VALUE '8'.
  3590     12  AL-SABON            PIC X       VALUE '9'.
  3591     12  AL-SADOF            PIC X       VALUE '@'.
  3592     12  AL-SADON            PIC X       VALUE QUOTE.
  3593     12  AL-SANOF            PIC X       VALUE '0'.
  3594     12  AL-SANON            PIC X       VALUE '1'.
  3595     12  AL-UABOF            PIC X       VALUE 'H'.
  3596     12  AL-UABON            PIC X       VALUE 'I'.
  3597     12  AL-UADOF            PIC X       VALUE '<'.
  3598     12  AL-UADON            PIC X       VALUE '('.
  3599     12  AL-UANOF            PIC X       VALUE ' '.
  3600     12  AL-UANON            PIC X       VALUE 'A'.
  3601     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3602     12  AL-UNBON            PIC X       VALUE 'R'.
  3603     12  AL-UNDOF            PIC X       VALUE '*'.
  3604     12  AL-UNDON            PIC X       VALUE ')'.
  3605     12  AL-UNNOF            PIC X       VALUE '&'.
  3606     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL689.cbl
  3608*    COPY ELCDATE.
  3609******************************************************************
  3610*                                                                *
  3611*                                                                *
  3612*                            ELCDATE.                            *
  3613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3614*                            VMOD=2.003
  3615*                                                                *
  3616*                                                                *
  3617*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3618*                 LENGTH = 200                                   *
  3619******************************************************************
  3620
  3621 01  DATE-CONVERSION-DATA.
  3622     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3623     12  DC-OPTION-CODE                PIC X.
  3624         88  BIN-TO-GREG                VALUE ' '.
  3625         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3626         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3627         88  YMD-GREG-TO-BIN            VALUE '3'.
  3628         88  MDY-GREG-TO-BIN            VALUE '4'.
  3629         88  JULIAN-TO-BIN              VALUE '5'.
  3630         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3631         88  FIND-CENTURY               VALUE '7'.
  3632         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3633         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3634         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3635         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3636         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3637         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3638         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3639         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3640         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3641         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3642         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3643         88  BIN-3-TO-GREG              VALUE 'I'.
  3644         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3645         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3646         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3647         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3648         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3649         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3650         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3651         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3652         88  THREE-CHARACTER-BIN
  3653                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3654         88  GREGORIAN-TO-BIN
  3655                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3656         88  BIN-TO-GREGORIAN
  3657                  VALUES ' ' '1' 'I' '8' 'G'.
  3658         88  JULIAN-TO-BINARY
  3659                  VALUES '5' 'C' 'E' 'F'.
  3660     12  DC-ERROR-CODE                 PIC X.
  3661         88  NO-CONVERSION-ERROR        VALUE ' '.
  3662         88  DATE-CONVERSION-ERROR
  3663                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3664         88  DATE-IS-ZERO               VALUE '1'.
  3665         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL689.cbl
  3666         88  DATE-IS-INVALID            VALUE '3'.
  3667         88  DATE1-GREATER-DATE2        VALUE '4'.
  3668         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3669         88  DATE-INVALID-OPTION        VALUE '9'.
  3670         88  INVALID-CENTURY            VALUE 'A'.
  3671         88  ONLY-CENTURY               VALUE 'B'.
  3672         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3673         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3674     12  DC-END-OF-MONTH               PIC X.
  3675         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3676     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3677         88  USE-NORMAL-PROCESS         VALUE ' '.
  3678         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3679         88  ADJUST-UP-100-YRS          VALUE '2'.
  3680     12  FILLER                        PIC X.
  3681     12  DC-CONVERSION-DATES.
  3682         16  DC-BIN-DATE-1             PIC XX.
  3683         16  DC-BIN-DATE-2             PIC XX.
  3684         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3685         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3686                       DC-GREG-DATE-1-EDIT.
  3687             20  DC-EDIT1-MONTH        PIC 99.
  3688             20  SLASH1-1              PIC X.
  3689             20  DC-EDIT1-DAY          PIC 99.
  3690             20  SLASH1-2              PIC X.
  3691             20  DC-EDIT1-YEAR         PIC 99.
  3692         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3693         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3694                     DC-GREG-DATE-2-EDIT.
  3695             20  DC-EDIT2-MONTH        PIC 99.
  3696             20  SLASH2-1              PIC X.
  3697             20  DC-EDIT2-DAY          PIC 99.
  3698             20  SLASH2-2              PIC X.
  3699             20  DC-EDIT2-YEAR         PIC 99.
  3700         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3701         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3702                     DC-GREG-DATE-1-YMD.
  3703             20  DC-YMD-YEAR           PIC 99.
  3704             20  DC-YMD-MONTH          PIC 99.
  3705             20  DC-YMD-DAY            PIC 99.
  3706         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3707         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3708                      DC-GREG-DATE-1-MDY.
  3709             20  DC-MDY-MONTH          PIC 99.
  3710             20  DC-MDY-DAY            PIC 99.
  3711             20  DC-MDY-YEAR           PIC 99.
  3712         16  DC-GREG-DATE-1-ALPHA.
  3713             20  DC-ALPHA-MONTH        PIC X(10).
  3714             20  DC-ALPHA-DAY          PIC 99.
  3715             20  FILLER                PIC XX.
  3716             20  DC-ALPHA-CENTURY.
  3717                 24 DC-ALPHA-CEN-N     PIC 99.
  3718             20  DC-ALPHA-YEAR         PIC 99.
  3719         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3720         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3721         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3722         16  DC-JULIAN-DATE            PIC 9(05).
  3723         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL689.cbl
  3724                                       PIC 9(05).
  3725         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3726             20  DC-JULIAN-YEAR        PIC 99.
  3727             20  DC-JULIAN-DAYS        PIC 999.
  3728         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3729         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3730         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3731     12  DATE-CONVERSION-VARIBLES.
  3732         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3733         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3734             20  FILLER                PIC 9(3).
  3735             20  HOLD-CEN-1-CCYY.
  3736                 24  HOLD-CEN-1-CC     PIC 99.
  3737                 24  HOLD-CEN-1-YY     PIC 99.
  3738             20  HOLD-CEN-1-MO         PIC 99.
  3739             20  HOLD-CEN-1-DA         PIC 99.
  3740         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3741             20  HOLD-CEN-1-R-MO       PIC 99.
  3742             20  HOLD-CEN-1-R-DA       PIC 99.
  3743             20  HOLD-CEN-1-R-CCYY.
  3744                 24  HOLD-CEN-1-R-CC   PIC 99.
  3745                 24  HOLD-CEN-1-R-YY   PIC 99.
  3746             20  FILLER                PIC 9(3).
  3747         16  HOLD-CENTURY-1-X.
  3748             20  FILLER                PIC X(3)  VALUE SPACES.
  3749             20  HOLD-CEN-1-X-CCYY.
  3750                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3751                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3752             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3753             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3754         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3755             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3756             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3757             20  HOLD-CEN-1-R-X-CCYY.
  3758                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3759                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3760             20  FILLER                PIC XXX.
  3761         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3762         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3763         16  DC-JULIAN-DATE-1          PIC 9(07).
  3764         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3765             20  DC-JULIAN-1-CCYY.
  3766                 24  DC-JULIAN-1-CC    PIC 99.
  3767                 24  DC-JULIAN-1-YR    PIC 99.
  3768             20  DC-JULIAN-DA-1        PIC 999.
  3769         16  DC-JULIAN-DATE-2          PIC 9(07).
  3770         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3771             20  DC-JULIAN-2-CCYY.
  3772                 24  DC-JULIAN-2-CC    PIC 99.
  3773                 24  DC-JULIAN-2-YR    PIC 99.
  3774             20  DC-JULIAN-DA-2        PIC 999.
  3775         16  DC-GREG-DATE-A-EDIT.
  3776             20  DC-EDITA-MONTH        PIC 99.
  3777             20  SLASHA-1              PIC X VALUE '/'.
  3778             20  DC-EDITA-DAY          PIC 99.
  3779             20  SLASHA-2              PIC X VALUE '/'.
  3780             20  DC-EDITA-CCYY.
  3781                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL689.cbl
  3782                 24  DC-EDITA-YEAR     PIC 99.
  3783         16  DC-GREG-DATE-B-EDIT.
  3784             20  DC-EDITB-MONTH        PIC 99.
  3785             20  SLASHB-1              PIC X VALUE '/'.
  3786             20  DC-EDITB-DAY          PIC 99.
  3787             20  SLASHB-2              PIC X VALUE '/'.
  3788             20  DC-EDITB-CCYY.
  3789                 24  DC-EDITB-CENT     PIC 99.
  3790                 24  DC-EDITB-YEAR     PIC 99.
  3791         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3792         16  DC-GREG-DATE-CYMD-R REDEFINES
  3793                              DC-GREG-DATE-CYMD.
  3794             20  DC-CYMD-CEN           PIC 99.
  3795             20  DC-CYMD-YEAR          PIC 99.
  3796             20  DC-CYMD-MONTH         PIC 99.
  3797             20  DC-CYMD-DAY           PIC 99.
  3798         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3799         16  DC-GREG-DATE-MDCY-R REDEFINES
  3800                              DC-GREG-DATE-MDCY.
  3801             20  DC-MDCY-MONTH         PIC 99.
  3802             20  DC-MDCY-DAY           PIC 99.
  3803             20  DC-MDCY-CEN           PIC 99.
  3804             20  DC-MDCY-YEAR          PIC 99.
  3805    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3806        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3807    12  DC-EL310-DATE                  PIC X(21).
  3808    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL689.cbl
  3810*    COPY ELCNWA.
  3811*****************************************************************
  3812*                                                               *
  3813*                                                               *
  3814*                            ELCNWA.                            *
  3815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3816*                            VMOD=2.003                         *
  3817*                                                               *
  3818*            M O V E   N A M E   W O R K   A R E A.             *
  3819*                                                               *
  3820*****************************************************************.
  3821
  3822 01  WS-NAME-WORK-AREA.
  3823     05  WS-INSURED-LAST-NAME        PIC X(15).
  3824     05  WS-INSURED-1ST-NAME         PIC X(12).
  3825     05  WS-INSURED-MID-INIT         PIC X.
  3826
  3827     05  WS-NAME-WORK.
  3828         10  WS-NW                   PIC X
  3829             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3830
  3831     05  WS-NAME-WORK2.
  3832         10  WS-NW2                  PIC X
  3833             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3834                                        NWA-INDEX0.
  3835
  3836     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3837                                     COMP-3.
  3838
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL689.cbl
  3840*    COPY ELCEMIB.
  3841******************************************************************
  3842*                                                                *
  3843*                                                                *
  3844*                            ELCEMIB.                            *
  3845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3846*                            VMOD=2.005                          *
  3847*                                                                *
  3848*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3849*                                                                *
  3850******************************************************************
  3851 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3852     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3853     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3854     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3855     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3856     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3857     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3858     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3859     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3860     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3861         88  EMI-NO-ERRORS                    VALUE '1'.
  3862         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3863         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3864     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3865         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3866     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3867         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3868         88  EMI-AREA1-FULL                   VALUE '2'.
  3869     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3870         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3871         88  EMI-AREA2-FULL                   VALUE '2'.
  3872     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3873         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3874         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3875         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3876         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3877         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3878     12  EMI-ERROR-LINES.
  3879         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3880         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3881         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3882         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3883             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3884                 24  EMI-ERR-NUM         PIC X(4).
  3885                 24  EMI-FILLER          PIC X.
  3886                 24  EMI-SEV             PIC X.
  3887                 24  FILLER              PIC X.
  3888             20  FILLER                  PIC X(02).
  3889     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3890         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3891             20  EMI-ERROR-NUMBER    PIC X(4).
  3892             20  EMI-FILL            PIC X.
  3893             20  EMI-SEVERITY        PIC X.
  3894             20  FILLER              PIC X.
  3895             20  EMI-ERROR-TEXT.
  3896                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3897                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL689.cbl
  3898     12  EMI-SEVERITY-SAVE           PIC X.
  3899         88  EMI-NOTE                    VALUE 'N'.
  3900         88  EMI-WARNING                 VALUE 'W'.
  3901         88  EMI-FORCABLE                VALUE 'F'.
  3902         88  EMI-FATAL                   VALUE 'X'.
  3903     12  EMI-MESSAGE-FLAG            PIC X.
  3904         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3905         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3906     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3907     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3908         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3909         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3910         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3911     12  emi-claim-no                pic x(7).
  3912     12  emi-claim-type              pic x(6).
  3913     12  FILLER                      PIC X(124)  VALUE SPACES.
  3914     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3915     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3916     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3917     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3918 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL689.cbl
  3920*    COPY ELCLOGOF.
  3921******************************************************************
  3922*                                                                *
  3923*                                                                *
  3924*                            ELCLOGOF.                           *
  3925*                            VMOD=2.001                          *
  3926*                                                                *
  3927*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3928*                                                                *
  3929******************************************************************
  3930 01  CLASIC-LOGOFF.
  3931     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3932     12  LOGOFF-TEXT.
  3933         16  FILLER          PIC X(5)    VALUE SPACES.
  3934         16  LOGOFF-MSG.
  3935             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3936             20  FILLER      PIC X       VALUE SPACES.
  3937             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3938         16  FILLER          PIC X(80)
  3939           VALUE '* YOU ARE NOW LOGGED OFF'.
  3940         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3941         16  FILLER          PIC X       VALUE QUOTE.
  3942         16  LOGOFF-SYS-MSG  PIC X(17)
  3943           VALUE 'S CLAS-IC SYSTEM '.
  3944     12  TEXT-MESSAGES.
  3945         16  UNACCESS-MSG    PIC X(29)
  3946             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3947         16  PGMIDERR-MSG    PIC X(17)
  3948             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL689.cbl
  3950*    COPY ELCSCTM.
  3951******************************************************************
  3952*                                                                *
  3953*                                                                *
  3954*                            ELCSCTM                             *
  3955*                            VMOD=2.001                          *
  3956*                                                                *
  3957*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3958*                                                                *
  3959******************************************************************
  3960 01  SECURITY-MESSAGE.
  3961     12  FILLER                          PIC X(30)
  3962            VALUE '** LOGIC SECURITY VIOLATION -'.
  3963     12  SM-READ                         PIC X(6).
  3964     12  FILLER                          PIC X(5)
  3965            VALUE ' PGM='.
  3966     12  SM-PGM                          PIC X(6).
  3967     12  FILLER                          PIC X(5)
  3968            VALUE ' OPR='.
  3969     12  SM-PROCESSOR-ID                 PIC X(4).
  3970     12  FILLER                          PIC X(6)
  3971            VALUE ' TERM='.
  3972     12  SM-TERMID                       PIC X(4).
  3973     12  FILLER                          PIC XX   VALUE SPACE.
  3974     12  SM-JUL-DATE                     PIC 9(5).
  3975     12  FILLER                          PIC X    VALUE SPACE.
  3976     12  SM-TIME                         PIC 99.99.
  3977
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL689.cbl
  3979*    COPY ELCSCRTY.
  3980******************************************************************
  3981*                                                                *
  3982*                                                                *
  3983*                            ELCSCRTY                            *
  3984*                            VMOD=2.001                          *
  3985*                                                                *
  3986*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3987*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3988*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3989*                                                                *
  3990******************************************************************
  3991 01  SECURITY-CONTROL.
  3992     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3993     12  FILLER                       PIC XX    VALUE 'SC'.
  3994     12  SC-CREDIT-CODES.
  3995         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3996             20  SC-CREDIT-DISPLAY    PIC X.
  3997             20  SC-CREDIT-UPDATE     PIC X.
  3998     12  SC-CLAIMS-CODES.
  3999         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  4000             20  SC-CLAIMS-DISPLAY    PIC X.
  4001             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL689.cbl
  4003
  4004 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL689.cbl
  4006****************************************************************
  4007*
  4008* Copyright (c) 2007 by Clerity Solutions, Inc.
  4009* All rights reserved.
  4010*
  4011****************************************************************
  4012 01  DFHEIV.
  4013   02  DFHEIV0               PIC X(35).
  4014   02  DFHEIV1               PIC X(08).
  4015   02  DFHEIV2               PIC X(08).
  4016   02  DFHEIV3               PIC X(08).
  4017   02  DFHEIV4               PIC X(06).
  4018   02  DFHEIV5               PIC X(04).
  4019   02  DFHEIV6               PIC X(04).
  4020   02  DFHEIV7               PIC X(02).
  4021   02  DFHEIV8               PIC X(02).
  4022   02  DFHEIV9               PIC X(01).
  4023   02  DFHEIV10              PIC S9(7) COMP-3.
  4024   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4025   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4026   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4027   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4028   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4029   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4030   02  DFHEIV17              PIC X(04).
  4031   02  DFHEIV18              PIC X(04).
  4032   02  DFHEIV19              PIC X(04).
  4033   02  DFHEIV20              USAGE IS POINTER.
  4034   02  DFHEIV21              USAGE IS POINTER.
  4035   02  DFHEIV22              USAGE IS POINTER.
  4036   02  DFHEIV23              USAGE IS POINTER.
  4037   02  DFHEIV24              USAGE IS POINTER.
  4038   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4039   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4040   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4041   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4042   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4043   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4044   02  FILLER                PIC X(02).
  4045   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4046   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4047   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4048   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4049   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4050 LINKAGE  SECTION.
  4051*****************************************************************
  4052*                                                               *
  4053* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4054* All rights reserved.                                          *
  4055*                                                               *
  4056*****************************************************************
  4057 01  dfheiblk.
  4058     02  eibtime          pic s9(7) comp-3.
  4059     02  eibdate          pic s9(7) comp-3.
  4060     02  eibtrnid         pic x(4).
  4061     02  eibtaskn         pic s9(7) comp-3.
  4062     02  eibtrmid         pic x(4).
  4063     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL689.cbl
  4064     02  eibcposn         pic s9(4) comp.
  4065     02  eibcalen         pic s9(4) comp.
  4066     02  eibaid           pic x(1).
  4067     02  eibfiller1       pic x(1).
  4068     02  eibfn            pic x(2).
  4069     02  eibfiller2       pic x(2).
  4070     02  eibrcode         pic x(6).
  4071     02  eibfiller3       pic x(2).
  4072     02  eibds            pic x(8).
  4073     02  eibreqid         pic x(8).
  4074     02  eibrsrce         pic x(8).
  4075     02  eibsync          pic x(1).
  4076     02  eibfree          pic x(1).
  4077     02  eibrecv          pic x(1).
  4078     02  eibsend          pic x(1).
  4079     02  eibatt           pic x(1).
  4080     02  eibeoc           pic x(1).
  4081     02  eibfmh           pic x(1).
  4082     02  eibcompl         pic x(1).
  4083     02  eibsig           pic x(1).
  4084     02  eibconf          pic x(1).
  4085     02  eiberr           pic x(1).
  4086     02  eibrldbk         pic x(1).
  4087     02  eiberrcd         pic x(4).
  4088     02  eibsynrb         pic x(1).
  4089     02  eibnodat         pic x(1).
  4090     02  eibfiller5       pic x(2).
  4091     02  eibresp          pic 9(09) comp.
  4092     02  eibresp2         pic 9(09) comp.
  4093     02  dfheigdj         pic s9(4) comp.
  4094     02  dfheigdk         pic s9(4) comp.
  4095 01  DFHCOMMAREA                 PIC X(1024).
  4096 01  var  pic x(30).
  4097
  4098*    COPY ERCACCT.
  4099******************************************************************
  4100*                                                                *
  4101*                                                                *
  4102*                            ERCACCT                             *
  4103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4104*                            VMOD=2.031                          *
  4105*                                                                *
  4106*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4107*                                                                *
  4108*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4109*   VSAM ACCOUNT MASTER FILES.                                   *
  4110*                                                                *
  4111*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4112*                                                                *
  4113*   FILE TYPE = VSAM,KSDS                                        *
  4114*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4115*                                                                *
  4116*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4117*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4118*                                                                *
  4119*   LOG = NO                                                     *
  4120*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4121*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL689.cbl
  4122*                                                                *
  4123******************************************************************
  4124*                   C H A N G E   L O G
  4125*
  4126* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4127*-----------------------------------------------------------------
  4128*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4129* EFFECTIVE    NUMBER
  4130*-----------------------------------------------------------------
  4131* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4132* 092705    2005050300006  PEMA  ADD SPP LEASES
  4133* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4134* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4135* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4136* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4137* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4138******************************************************************
  4139
  4140 01  ACCOUNT-MASTER.
  4141     12  AM-RECORD-ID                      PIC XX.
  4142         88  VALID-AM-ID                      VALUE 'AM'.
  4143
  4144     12  AM-CONTROL-PRIMARY.
  4145         16  AM-COMPANY-CD                 PIC X.
  4146         16  AM-MSTR-CNTRL.
  4147             20  AM-CONTROL-A.
  4148                 24  AM-CARRIER            PIC X.
  4149                 24  AM-GROUPING.
  4150                     28 AM-GROUPING-PREFIX PIC XXX.
  4151                     28 AM-GROUPING-PRIME  PIC XXX.
  4152                 24  AM-STATE              PIC XX.
  4153                 24  AM-ACCOUNT.
  4154                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4155                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4156             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4157                                           PIC X(19).
  4158             20  AM-CNTRL-B.
  4159                 24  AM-EXPIRATION-DT      PIC XX.
  4160                 24  FILLER                PIC X(4).
  4161             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4162                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4163
  4164     12  AM-CONTROL-BY-VAR-GRP.
  4165         16  AM-COMPANY-CD-A1              PIC X.
  4166         16  AM-VG-CARRIER                 PIC X.
  4167         16  AM-VG-GROUPING                PIC X(6).
  4168         16  AM-VG-STATE                   PIC XX.
  4169         16  AM-VG-ACCOUNT                 PIC X(10).
  4170         16  AM-VG-DATE.
  4171             20  AM-VG-EXPIRATION-DT       PIC XX.
  4172             20  FILLER                    PIC X(4).
  4173         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4174                                           PIC 9(11)      COMP-3.
  4175     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4176         16  FILLER                        PIC X(10).
  4177         16  AM-VG-KEY3.
  4178             20  AM-VG3-ACCOUNT            PIC X(10).
  4179             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL689.cbl
  4180         16  FILLER                        PIC X(4).
  4181     12  AM-MAINT-INFORMATION.
  4182         16  AM-LAST-MAINT-DT              PIC XX.
  4183         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4184         16  AM-LAST-MAINT-USER            PIC X(4).
  4185         16  FILLER                        PIC XX.
  4186
  4187     12  AM-EFFECTIVE-DT                   PIC XX.
  4188     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4189
  4190     12  AM-PREV-DATES  COMP-3.
  4191         16  AM-PREV-EXP-DT                PIC 9(11).
  4192         16  AM-PREV-EFF-DT                PIC 9(11).
  4193
  4194     12  AM-REPORT-CODE-1                  PIC X(10).
  4195     12  AM-REPORT-CODE-2                  PIC X(10).
  4196
  4197     12  AM-CITY-CODE                      PIC X(4).
  4198     12  AM-COUNTY-PARISH                  PIC X(6).
  4199
  4200     12  AM-NAME                           PIC X(30).
  4201     12  AM-PERSON                         PIC X(30).
  4202     12  AM-ADDRS                          PIC X(30).
  4203     12  AM-CITY.
  4204         16  AM-ADDR-CITY                  PIC X(28).
  4205         16  AM-ADDR-STATE                 PIC XX.
  4206     12  AM-ZIP.
  4207         16  AM-ZIP-PRIME.
  4208             20  AM-ZIP-PRI-1ST            PIC X.
  4209                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4210             20  FILLER                    PIC X(4).
  4211         16  AM-ZIP-PLUS4                  PIC X(4).
  4212     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4213         16  AM-CAN-POSTAL-1               PIC XXX.
  4214         16  AM-CAN-POSTAL-2               PIC XXX.
  4215         16  FILLER                        PIC XXX.
  4216     12  AM-TEL-NO.
  4217         16  AM-AREA-CODE                  PIC 999.
  4218         16  AM-TEL-PRE                    PIC 999.
  4219         16  AM-TEL-NBR                    PIC 9(4).
  4220     12  AM-TEL-LOC                        PIC X.
  4221         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4222         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4223
  4224     12  AM-COMM-STRUCTURE.
  4225         16  AM-DEFN-1.
  4226             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4227                 24  AM-AGT.
  4228                     28  AM-AGT-PREFIX     PIC X(4).
  4229                     28  AM-AGT-PRIME      PIC X(6).
  4230                 24  AM-COM-TYP            PIC X.
  4231                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4232                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4233                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4234                 24  AM-RECALC-LV-INDIC    PIC X.
  4235                 24  AM-RETRO-LV-INDIC     PIC X.
  4236                 24  AM-GL-CODES           PIC X.
  4237                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL689.cbl
  4238                 24  FILLER                PIC X(01).
  4239         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4240             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4241                 24  FILLER                PIC X(11).
  4242                 24  AM-L-COMA             PIC XXX.
  4243                 24  AM-J-COMA             PIC XXX.
  4244                 24  AM-A-COMA             PIC XXX.
  4245                 24  FILLER                PIC X(6).
  4246
  4247     12  AM-COMM-CHANGE-STATUS             PIC X.
  4248         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4249
  4250     12  AM-CSR-CODE                       PIC X(4).
  4251
  4252     12  AM-BILLING-STATUS                 PIC X.
  4253         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4254         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4255     12  AM-AUTO-REFUND-SW                 PIC X.
  4256         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4257         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4258     12  AM-GPCD                           PIC 99.
  4259     12  AM-IG                             PIC X.
  4260         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4261         88  AM-HAS-GROUP                     VALUE '2'.
  4262     12  AM-STATUS                         PIC X.
  4263         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4264         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4265         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4266         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4267         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4268         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4269     12  AM-REMIT-TO                       PIC 99.
  4270     12  AM-ID-NO                          PIC X(11).
  4271
  4272     12  AM-CAL-TABLE                      PIC XX.
  4273     12  AM-LF-DEVIATION                   PIC XXX.
  4274     12  AM-AH-DEVIATION                   PIC XXX.
  4275     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4276     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4277     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4278     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4279     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4280     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4281
  4282     12  AM-USER-FIELDS.
  4283         16  AM-FLD-1                      PIC XX.
  4284         16  AM-FLD-2                      PIC XX.
  4285         16  AM-FLD-3                      PIC XX.
  4286         16  AM-FLD-4                      PIC XX.
  4287         16  AM-FLD-5                      PIC XX.
  4288
  4289     12  AM-1ST-PROD-DATE.
  4290         16  AM-1ST-PROD-YR                PIC XX.
  4291         16  AM-1ST-PROD-MO                PIC XX.
  4292         16  AM-1ST-PROD-DA                PIC XX.
  4293     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4294     12  AM-CERTS-PURGED-DATE.
  4295         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL689.cbl
  4296         16  AM-PUR-MO                     PIC XX.
  4297         16  AM-PUR-DA                     PIC XX.
  4298     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4299     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4300     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4301     12  AM-INACTIVE-DATE.
  4302         16  AM-INA-MO                     PIC 99.
  4303         16  AM-INA-DA                     PIC 99.
  4304         16  AM-INA-YR                     PIC 99.
  4305     12  AM-AR-HI-CERT-DATE                PIC XX.
  4306
  4307     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4308     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4309
  4310     12  AM-OB-PAYMENT-MODE                PIC X.
  4311         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4312         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4313         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4314         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4315
  4316     12  AM-AH-ONLY-INDICATOR              PIC X.
  4317         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4318         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4319
  4320     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4321
  4322     12  AM-OVER-SHORT.
  4323         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4324         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4325
  4326     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4327     12  AM-DCC-CLP-STATE                  PIC XX.
  4328
  4329     12  AM-RECALC-COMM                    PIC X.
  4330     12  AM-RECALC-REIN                    PIC X.
  4331
  4332     12  AM-REI-TABLE                      PIC XXX.
  4333     12  AM-REI-ET-LF                      PIC X.
  4334     12  AM-REI-ET-AH                      PIC X.
  4335     12  AM-REI-PE-LF                      PIC X.
  4336     12  AM-REI-PE-AH                      PIC X.
  4337     12  AM-REI-PRT-ST                     PIC X.
  4338     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4339     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4340     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4341     12  AM-REI-GROUP-A                    PIC X(6).
  4342     12  AM-REI-MORT                       PIC X(4).
  4343     12  AM-REI-PRT-OW                     PIC X.
  4344     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4345     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4346     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4347     12  AM-REI-GROUP-B                    PIC X(6).
  4348
  4349     12  AM-TRUST-TYPE                     PIC X(2).
  4350
  4351     12  AM-EMPLOYER-STMT-USED             PIC X.
  4352     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4353
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL689.cbl
  4354     12  AM-STD-AH-TYPE                    PIC XX.
  4355     12  AM-EARN-METHODS.
  4356         16  AM-EARN-METHOD-R              PIC X.
  4357             88 AM-REF-RL-R78                 VALUE 'R'.
  4358             88 AM-REF-RL-PR                  VALUE 'P'.
  4359             88 AM-REF-RL-MEAN                VALUE 'M'.
  4360             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4361         16  AM-EARN-METHOD-L              PIC X.
  4362             88 AM-REF-LL-R78                 VALUE 'R'.
  4363             88 AM-REF-LL-PR                  VALUE 'P'.
  4364             88 AM-REF-LL-MEAN                VALUE 'M'.
  4365             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4366         16  AM-EARN-METHOD-A              PIC X.
  4367             88 AM-REF-AH-R78                 VALUE 'R'.
  4368             88 AM-REF-AH-PR                  VALUE 'P'.
  4369             88 AM-REF-AH-MEAN                VALUE 'M'.
  4370             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4371             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4372             88 AM-REF-AH-NET                 VALUE 'N'.
  4373
  4374     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4375     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4376     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4377
  4378     12  AM-RET-Y-N                        PIC X.
  4379     12  AM-RET-P-E                        PIC X.
  4380     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4381     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4382     12  AM-RET-GRP                        PIC X(6).
  4383     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4384         16  AM-POOL-PRIME                 PIC XXX.
  4385         16  AM-POOL-SUB                   PIC XXX.
  4386     12  AM-RETRO-EARNINGS.
  4387         16  AM-RET-EARN-R                 PIC X.
  4388         16  AM-RET-EARN-L                 PIC X.
  4389         16  AM-RET-EARN-A                 PIC X.
  4390     12  AM-RET-ST-TAX-USE                 PIC X.
  4391         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4392         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4393     12  AM-RETRO-BEG-EARNINGS.
  4394         16  AM-RET-BEG-EARN-R             PIC X.
  4395         16  AM-RET-BEG-EARN-L             PIC X.
  4396         16  AM-RET-BEG-EARN-A             PIC X.
  4397     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4398     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4399
  4400     12  AM-USER-SELECT-OPTIONS.
  4401         16  AM-USER-SELECT-1              PIC X(10).
  4402         16  AM-USER-SELECT-2              PIC X(10).
  4403         16  AM-USER-SELECT-3              PIC X(10).
  4404         16  AM-USER-SELECT-4              PIC X(10).
  4405         16  AM-USER-SELECT-5              PIC X(10).
  4406
  4407     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4408
  4409     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4410
  4411     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL689.cbl
  4412         88  RPT045A-OFF                   VALUE 'N'.
  4413
  4414     12  AM-INSURANCE-LIMITS.
  4415         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4416         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4417
  4418     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4419         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4420
  4421     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4422         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4423         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4424
  4425     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4426
  4427     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4428     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4429     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4430     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4431     12  AM-DCC-UEF-STATE                  PIC XX.
  4432     12  FILLER                            PIC XXX.
  4433     12  AM-REPORT-CODE-3                  PIC X(10).
  4434*    12  FILLER                            PIC X(22).
  4435
  4436     12  AM-RESERVE-DATE.
  4437         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4438         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4439         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4440
  4441     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4442     12  AM-NOTIFICATION-TYPES.
  4443         16  AM-NOTIF-OF-LETTERS           PIC X.
  4444         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4445         16  AM-NOTIF-OF-REPORTS           PIC X.
  4446         16  AM-NOTIF-OF-STATUS            PIC X.
  4447
  4448     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4449         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4450         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4451         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4452         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4453
  4454     12  AM-BENEFIT-CONTROLS.
  4455         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4456             20  AM-BENEFIT-CODE           PIC XX.
  4457             20  AM-BENEFIT-TYPE           PIC X.
  4458             20  AM-BENEFIT-REVISION       PIC XXX.
  4459             20  AM-BENEFIT-REM-TERM       PIC X.
  4460             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4461             20  FILLER                    PIC XX.
  4462         16  FILLER                        PIC X(80).
  4463
  4464     12  AM-TRANSFER-DATA.
  4465         16  AM-TRANSFERRED-FROM.
  4466             20  AM-TRNFROM-CARRIER        PIC X.
  4467             20  AM-TRNFROM-GROUPING.
  4468                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4469                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL689.cbl
  4470             20  AM-TRNFROM-STATE          PIC XX.
  4471             20  AM-TRNFROM-ACCOUNT.
  4472                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4473                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4474             20  AM-TRNFROM-DTE            PIC XX.
  4475         16  AM-TRANSFERRED-TO.
  4476             20  AM-TRNTO-CARRIER          PIC X.
  4477             20  AM-TRNTO-GROUPING.
  4478                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4479                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4480             20  AM-TRNTO-STATE            PIC XX.
  4481             20  AM-TRNTO-ACCOUNT.
  4482                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4483                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4484             20  AM-TRNTO-DTE              PIC XX.
  4485         16  FILLER                        PIC X(10).
  4486
  4487     12  AM-SAVED-REMIT-TO                 PIC 99.
  4488
  4489     12  AM-COMM-STRUCTURE-SAVED.
  4490         16  AM-DEFN-1-SAVED.
  4491             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4492                 24  AM-AGT-SV             PIC X(10).
  4493                 24  AM-COM-TYP-SV         PIC X.
  4494                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4495                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4496                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4497                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4498                 24  FILLER                PIC X.
  4499                 24  AM-GL-CODES-SV        PIC X.
  4500                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4501                 24  FILLER                PIC X.
  4502         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4503             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4504                 24  FILLER                PIC X(11).
  4505                 24  AM-L-COMA-SV          PIC XXX.
  4506                 24  AM-J-COMA-SV          PIC XXX.
  4507                 24  AM-A-COMA-SV          PIC XXX.
  4508                 24  FILLER                PIC X(6).
  4509
  4510     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4511         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4512            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4513            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4514            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4515
  4516     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4517     12  FILLER                            PIC X(120).
  4518
  4519     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4520         16  AM-CONTROL-NAME               PIC X(30).
  4521         16  AM-EXECUTIVE-ONE.
  4522             20  AM-EXEC1-NAME             PIC X(15).
  4523             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4524                                                          COMP-3.
  4525             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4526                                                          COMP-3.
  4527         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL689.cbl
  4528             20  AM-EXEC2-NAME             PIC X(15).
  4529             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4530                                                          COMP-3.
  4531             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4532                                                          COMP-3.
  4533
  4534     12  AM-RETRO-ADDITIONAL-DATA.
  4535         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4536         16  AM-RETRO-PREM-P-E             PIC X.
  4537         16  AM-RETRO-CLMS-P-I             PIC X.
  4538         16  AM-RETRO-RET-BRACKET-LF.
  4539             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4540                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4541                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4542             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4543                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4544                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4545             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4546                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4547                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4548         16  AM-RETRO-RET-BRACKET-AH.
  4549             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4550                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4551                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4552                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4553             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4554                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4555                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4556             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4557                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4558                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4559
  4560     12  AM-COMMENTS.
  4561         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4562
  4563     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4564         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4565         16  AM-FLI-BILLING-CODE           PIC X.
  4566         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4567         16  AM-FLI-UNITED-IDENT           PIC X.
  4568         16  AM-FLI-INTEREST-LOST-DATA.
  4569             20  AM-FLI-BANK-NO            PIC X(5).
  4570             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4571             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4572             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4573         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4574             20  AM-FLI-AGT                PIC X(9).
  4575             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4576             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4577         16  FILLER                        PIC X(102).
  4578
  4579     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4580         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4581             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4582             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4583             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4584             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4585             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL689.cbl
  4586         16  FILLER                          PIC X(10).
  4587******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL689.cbl
  4589*    COPY ERCARCH.
  4590******************************************************************
  4591*                                                                *
  4592*                            ERCARCH.                            *
  4593*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4594*                            VMOD=2.002                          *
  4595*                                                                *
  4596*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4597*                                                                *
  4598*   FILE TYPE = VSAM,KSDS                                        *
  4599*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4600*                                                                *
  4601*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4602*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4603*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4604*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4605*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4606*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4607*                                                                *
  4608*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4609******************************************************************
  4610*                   C H A N G E   L O G
  4611*
  4612* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4613*-----------------------------------------------------------------
  4614*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4615* EFFECTIVE    NUMBER
  4616*-----------------------------------------------------------------
  4617* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4618* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4619* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4620******************************************************************
  4621 01  LETTER-ARCHIVE.
  4622     12  LA-RECORD-ID                PIC  X(02).
  4623         88  LA-VALID-ID                VALUE 'LA'.
  4624
  4625     12  LA-CONTROL-PRIMARY.
  4626         16  LA-COMPANY-CD           PIC  X(01).
  4627         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4628
  4629     12  LA-CONTROL-BY-CERT-RESP.
  4630         16  LA-COMPANY-CD-A2        PIC  X(01).
  4631         16  LA-CERT-NO-A2.
  4632             20  LA-CERT-PRIME-A2    PIC  X(10).
  4633             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4634         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4635             20  LA-RESP-PERSON-A2   PIC  X(10).
  4636             20  LA-TYPE-A2          PIC  X(01).
  4637         16  LA-CARRIER-A2           PIC  X(01).
  4638         16  LA-GROUPING-A2          PIC  X(06).
  4639         16  LA-STATE-A2             PIC  X(02).
  4640         16  LA-ACCOUNT-A2           PIC  X(10).
  4641         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4642         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4643
  4644     12  LA-CONTROL-BY-FORM.
  4645         16  LA-COMPANY-CD-A3        PIC  X(01).
  4646         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL689.cbl
  4647         16  LA-CARRIER-A3           PIC  X(01).
  4648         16  LA-GROUPING-A3          PIC  X(06).
  4649         16  LA-STATE-A3             PIC  X(02).
  4650         16  LA-ACCOUNT-A3           PIC  X(10).
  4651         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4652
  4653     12  LA-CONTROL-BY-PROCESSOR.
  4654         16  LA-COMPANY-CD-A4        PIC  X(01).
  4655         16  LA-PROCESSOR-CD         PIC  X(04).
  4656         16  LA-CARRIER-A4           PIC  X(01).
  4657         16  LA-GROUPING-A4          PIC  X(06).
  4658         16  LA-STATE-A4             PIC  X(02).
  4659         16  LA-ACCOUNT-A4           PIC  X(10).
  4660         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4661
  4662     12  LA-CONTROL-BY-KEY-FIELDS.
  4663         16  LA-COMPANY-CD-A5        PIC  X(01).
  4664         16  LA-CARRIER-A5           PIC  X(01).
  4665         16  LA-GROUPING-A5          PIC  X(06).
  4666         16  LA-STATE-A5             PIC  X(02).
  4667         16  LA-ACCOUNT-A5           PIC  X(10).
  4668         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4669
  4670     12  LA-CONTROL-BY-GROUP-CODE.
  4671         16  LA-COMPANY-CD-A6        PIC  X(01).
  4672         16  LA-ENTRY-A6.
  4673             20  LA-FILLER           PIC  X(02).
  4674             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4675         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4676
  4677     12  FILLER                      PIC  X(09).
  4678
  4679     12  LA-HEADER-RECORD.
  4680         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4681         16  LA-CREATION-DATE        PIC  X(02).
  4682         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4683         16  LA-FINAL-ACT-DATE       REDEFINES
  4684               LA-FOLLOW-UP-DATE     PIC  X(02).
  4685         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4686         16  LA-NO-OF-COPIES         PIC S9(01).
  4687         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4688         16  LA-REPLY-DATE           PIC  X(02).
  4689         16  LA-RESEND-DATES.
  4690             20  LA-RESEND-DATE      PIC  X(02).
  4691             20  LA-SENT-DATE        PIC  X(02).
  4692             20  FILLER              PIC  X(08).
  4693         16  LA-SOURCE-INFORMATION.
  4694             20  LA-DATA-SOURCE      PIC  X(01).
  4695             20  LA-ADDR-SOURCE      PIC  X(01).
  4696         16  LA-STATUS               PIC  X(01).
  4697             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4698             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4699             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4700             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4701             88  LA-STATUS-PURGED         VALUE 'P'.
  4702             88  LA-STATUS-VOIDED         VALUE 'V'.
  4703         16  LA-LAST-RESENT-PRINT-DATE
  4704                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL689.cbl
  4705         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4706             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4707                                          VALUE 'C'.
  4708             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4709                                          VALUE 'F'.
  4710             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4711                                          VALUE 'P'.
  4712         16  LA-PURGED-DATE          PIC  X(02).
  4713         16  LA-VOIDED-DATE          PIC  X(02).
  4714         16  LA-RESEND-LETR          PIC  X(4).
  4715         16  FILLER                  PIC  X(08).
  4716*        16  LA-RESEND-LETR-2        PIC  X(4).
  4717*        16  LA-RESEND-LETR-3        PIC  X(4).
  4718*        16  FILLER                  PIC  X(59).
  4719         16  LA-ARCHIVE-STATUS       PIC  X.
  4720             88  LA-TEMP                VALUE 'T'.
  4721             88  LA-QWS                 VALUE 'Q'.
  4722             88  LA-BATCH               VALUE 'B'.
  4723         16  LA-FINAL-ACT-IND        PIC  X(1).
  4724         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4725         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4726         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4727                                     PIC X(4).
  4728         16  FILLER                  PIC  X(42).
  4729*        16  FILLER                  PIC  X(71).
  4730         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4731         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4732         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4733                                     PIC  X(4).
  4734         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4735
  4736******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL689.cbl
  4738*    COPY ERCARCT.
  4739******************************************************************
  4740*                                                                *
  4741*                            ERCARCT.                            *
  4742*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4743*                            VMOD=2.002                          *
  4744*                                                                *
  4745*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4746*                                                                *
  4747*   FILE TYPE = VSAM,KSDS                                        *
  4748*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4749*                                                                *
  4750*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4751*                                                                *
  4752*   LOG = NO                                                     *
  4753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4754******************************************************************
  4755*                   C H A N G E   L O G
  4756*
  4757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4758*-----------------------------------------------------------------
  4759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4760* EFFECTIVE    NUMBER
  4761*-----------------------------------------------------------------
  4762* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4763******************************************************************
  4764 01  LETTER-ARCHIVE-TEXT.
  4765     12  LT-RECORD-ID                PIC  X(02).
  4766         88  LT-VALID-ID                VALUE 'LT'.
  4767
  4768     12  LT-CONTROL-PRIMARY.
  4769         16  LT-COMPANY-CD           PIC  X(01).
  4770         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4771         16  LT-RECORD-TYPE          PIC  X(01).
  4772             88  LT-ADDRESS-DATA        VALUE '1'.
  4773             88  LT-TEXT-DATA           VALUE '2'.
  4774             88  LT-COMMENT-DATA        VALUE '3'.
  4775         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4776
  4777     12  FILLER                      PIC  X(28).
  4778     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4779
  4780     12  LT-TEXT-RECORD.
  4781         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4782                            INDEXED BY LT-NDX.
  4783             20  LT-TEXT-LINE        PIC  X(70).
  4784             20  LT-SKIP-CONTROL     PIC  X(02).
  4785                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4786                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4787             20  FILLER              PIC  X(08).
  4788
  4789     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4790         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4791             20  LT-COMMENT-LINE     PIC X(69).
  4792             20  LT-COMMENT-CHG-DT   PIC X(02).
  4793             20  LT-COMMENT-CHG-BY   PIC X(04).
  4794             20  FILLER              PIC X(05).
  4795
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL689.cbl
  4797*    COPY ELCCERT.
  4798******************************************************************
  4799*                                                                *
  4800*                            ELCCERT.                            *
  4801*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4802*                            VMOD=2.013                          *
  4803*                                                                *
  4804*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4805*                                                                *
  4806*   FILE TYPE = VSAM,KSDS                                        *
  4807*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4808*                                                                *
  4809*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4810*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4811*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4812*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4813*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4814*                                                                *
  4815*   LOG = YES                                                    *
  4816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4817******************************************************************
  4818*                   C H A N G E   L O G
  4819*
  4820* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4821*-----------------------------------------------------------------
  4822*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4823* EFFECTIVE    NUMBER
  4824*-----------------------------------------------------------------
  4825* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4826* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4827* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4828* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4829* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4830* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4831* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4832* 032612  CR2011110200001  PEMA  AHL CHANGES
  4833******************************************************************
  4834
  4835 01  CERTIFICATE-MASTER.
  4836     12  CM-RECORD-ID                      PIC XX.
  4837         88  VALID-CM-ID                      VALUE 'CM'.
  4838
  4839     12  CM-CONTROL-PRIMARY.
  4840         16  CM-COMPANY-CD                 PIC X.
  4841         16  CM-CARRIER                    PIC X.
  4842         16  CM-GROUPING.
  4843             20  CM-GROUPING-PREFIX        PIC X(3).
  4844             20  CM-GROUPING-PRIME         PIC X(3).
  4845         16  CM-STATE                      PIC XX.
  4846         16  CM-ACCOUNT.
  4847             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4848             20  CM-ACCOUNT-PRIME          PIC X(6).
  4849         16  CM-CERT-EFF-DT                PIC XX.
  4850         16  CM-CERT-NO.
  4851             20  CM-CERT-PRIME             PIC X(10).
  4852             20  CM-CERT-SFX               PIC X.
  4853
  4854     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL689.cbl
  4855         16  CM-COMPANY-CD-A1              PIC X.
  4856         16  CM-INSURED-LAST-NAME          PIC X(15).
  4857         16  CM-INSURED-INITIALS.
  4858             20  CM-INSURED-INITIAL1       PIC X.
  4859             20  CM-INSURED-INITIAL2       PIC X.
  4860
  4861     12  CM-CONTROL-BY-SSN.
  4862         16  CM-COMPANY-CD-A2              PIC X.
  4863         16  CM-SOC-SEC-NO.
  4864             20  CM-SSN-STATE              PIC XX.
  4865             20  CM-SSN-ACCOUNT            PIC X(6).
  4866             20  CM-SSN-LN3.
  4867                 25  CM-INSURED-INITIALS-A2.
  4868                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4869                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4870                 25 CM-PART-LAST-NAME-A2         PIC X.
  4871
  4872     12  CM-CONTROL-BY-CERT-NO.
  4873         16  CM-COMPANY-CD-A4              PIC X.
  4874         16  CM-CERT-NO-A4                 PIC X(11).
  4875
  4876     12  CM-CONTROL-BY-MEMB.
  4877         16  CM-COMPANY-CD-A5              PIC X.
  4878         16  CM-MEMBER-NO.
  4879             20  CM-MEMB-STATE             PIC XX.
  4880             20  CM-MEMB-ACCOUNT           PIC X(6).
  4881             20  CM-MEMB-LN4.
  4882                 25  CM-INSURED-INITIALS-A5.
  4883                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4884                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4885                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4886
  4887     12  CM-INSURED-PROFILE-DATA.
  4888         16  CM-INSURED-FIRST-NAME.
  4889             20  CM-INSURED-1ST-INIT       PIC X.
  4890             20  FILLER                    PIC X(9).
  4891         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4892         16  CM-INSURED-SEX                PIC X.
  4893             88  CM-SEX-MALE                  VALUE 'M'.
  4894             88  CM-SEX-FEMAL                 VALUE 'F'.
  4895         16  CM-INSURED-JOINT-AGE          PIC 99.
  4896         16  CM-JOINT-INSURED-NAME.
  4897             20  CM-JT-LAST-NAME           PIC X(15).
  4898             20  CM-JT-FIRST-NAME.
  4899                 24  CM-JT-1ST-INIT        PIC X.
  4900                 24  FILLER                PIC X(9).
  4901             20  CM-JT-INITIAL             PIC X.
  4902
  4903     12  CM-LIFE-DATA.
  4904         16  CM-LF-BENEFIT-CD              PIC XX.
  4905         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4906         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4907         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4908         16  CM-LF-DEV-CODE                PIC XXX.
  4909         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4910         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4911         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4912         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL689.cbl
  4913         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4914         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4915         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4916         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4917         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4918         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4919         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4920         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4921         16  cm-temp-epiq                  pic xx.
  4922             88  EPIQ-CLASS                  value 'EQ'.
  4923*        16  FILLER                        PIC XX.
  4924
  4925     12  CM-AH-DATA.
  4926         16  CM-AH-BENEFIT-CD              PIC XX.
  4927         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4928         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4929         16  CM-AH-DEV-CODE                PIC XXX.
  4930         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4931         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4932         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4933         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4934         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4935         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4936         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4937         16  CM-AH-PAID-THRU-DT            PIC XX.
  4938             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4939         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4940         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4941         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4942         16  FILLER                        PIC X.
  4943
  4944     12  CM-LOAN-INFORMATION.
  4945         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4946         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4947                                           PIC S9(5)V99  COMP-3.
  4948         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4949         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4950         16  CM-PAY-FREQUENCY              PIC S99.
  4951         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4952         16  CM-RATE-CLASS                 PIC XX.
  4953         16  CM-BENEFICIARY                PIC X(25).
  4954         16  CM-POLICY-FORM-NO             PIC X(12).
  4955         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4956         16  CM-LAST-ADD-ON-DT             PIC XX.
  4957         16  CM-DEDUCTIBLE-AMOUNTS.
  4958             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4959             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4960         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4961             20  CM-RESIDENT-STATE         PIC XX.
  4962             20  CM-RATE-CODE              PIC X(4).
  4963             20  FILLER                    PIC XX.
  4964         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4965             20  CM-LOAN-OFFICER           PIC X(5).
  4966             20  FILLER                    PIC XXX.
  4967         16  CM-CSR-CODE                   PIC XXX.
  4968         16  CM-UNDERWRITING-CODE          PIC X.
  4969             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4970         16  CM-POST-CARD-IND              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL689.cbl
  4971         16  CM-NH-INTERFACE-SW            PIC X.
  4972         16  CM-PREMIUM-TYPE               PIC X.
  4973             88  CM-SING-PRM                  VALUE '1'.
  4974             88  CM-O-B-COVERAGE              VALUE '2'.
  4975             88  CM-OPEN-END                  VALUE '3'.
  4976         16  CM-IND-GRP-TYPE               PIC X.
  4977             88  CM-INDIVIDUAL                VALUE 'I'.
  4978             88  CM-GROUP                     VALUE 'G'.
  4979         16  CM-SKIP-CODE                  PIC X.
  4980             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4981             88  SKIP-JULY                    VALUE '1'.
  4982             88  SKIP-AUGUST                  VALUE '2'.
  4983             88  SKIP-SEPTEMBER               VALUE '3'.
  4984             88  SKIP-JULY-AUG                VALUE '4'.
  4985             88  SKIP-AUG-SEPT                VALUE '5'.
  4986             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4987             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4988             88  SKIP-JUNE                    VALUE '8'.
  4989             88  SKIP-JUNE-JULY               VALUE '9'.
  4990             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4991             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4992         16  CM-PAYMENT-MODE               PIC X.
  4993             88  PAY-MONTHLY                  VALUE SPACE.
  4994             88  PAY-WEEKLY                   VALUE '1'.
  4995             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4996             88  PAY-BI-WEEKLY                VALUE '3'.
  4997             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4998         16  CM-LOAN-NUMBER                PIC X(8).
  4999         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5000         16  CM-OLD-LOF                    PIC XXX.
  5001*        16  CM-LOAN-OFFICER               PIC XXX.
  5002         16  CM-REIN-TABLE                 PIC XXX.
  5003         16  CM-SPECIAL-REIN-CODE          PIC X.
  5004         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5005         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5006         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5007
  5008     12  CM-STATUS-DATA.
  5009         16  CM-ENTRY-STATUS               PIC X.
  5010         16  CM-ENTRY-DT                   PIC XX.
  5011
  5012         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5013         16  CM-LF-CANCEL-DT               PIC XX.
  5014         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5015
  5016         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5017         16  CM-LF-DEATH-DT                PIC XX.
  5018         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5019
  5020         16  CM-LF-CURRENT-STATUS          PIC X.
  5021             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5022                                                'M' '4' '5' '9'.
  5023             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5024             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5025             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5026             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5027             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5028             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL689.cbl
  5029             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5030             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5031             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5032             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5033             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5034             88  CM-LF-DECLINED               VALUE 'D'.
  5035             88  CM-LF-VOIDED                 VALUE 'V'.
  5036
  5037         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5038         16  CM-AH-CANCEL-DT               PIC XX.
  5039         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5040
  5041         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5042         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5043         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5044
  5045         16  CM-AH-CURRENT-STATUS          PIC X.
  5046             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5047                                                'M' '4' '5' '9'.
  5048             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5049             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5050             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5051             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5052             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5053             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5054             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5055             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5056             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5057             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5058             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5059             88  CM-AH-DECLINED               VALUE 'D'.
  5060             88  CM-AH-VOIDED                 VALUE 'V'.
  5061
  5062         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5063             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5064             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5065             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5066         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5067
  5068         16  CM-ENTRY-BATCH                PIC X(6).
  5069         16  CM-LF-EXIT-BATCH              PIC X(6).
  5070         16  CM-AH-EXIT-BATCH              PIC X(6).
  5071         16  CM-LAST-MONTH-END             PIC XX.
  5072
  5073     12  CM-NOTE-SW                        PIC X.
  5074         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5075         88  CERT-NOTES-PRESENT               VALUE '1'.
  5076         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5077         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5078         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5079         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5080         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5081         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5082     12  CM-COMP-EXCP-SW                   PIC X.
  5083         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5084         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5085     12  CM-INSURED-ADDRESS-SW             PIC X.
  5086         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL689.cbl
  5087         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5088
  5089*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5090     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5091     12  FILLER                            PIC X.
  5092
  5093*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5094     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5095     12  FILLER                            PIC X.
  5096*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5097     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5098
  5099     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5100         88  CERT-ADDED-BATCH                 VALUE ' '.
  5101         88  CERT-ADDED-ONLINE                VALUE '1'.
  5102         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5103         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5104         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5105     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5106         88  CERT-AS-LOADED                   VALUE ' '.
  5107         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5108         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5109         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5110         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5111         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5112         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5113         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5114
  5115     12  CM-ACCOUNT-COMM-PCTS.
  5116         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5117         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5118
  5119     12  CM-USER-FIELD                     PIC X.
  5120     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5121     12  CM-CLP-STATE                      PIC XX.
  5122     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5123     12  CM-USER-RESERVED                  PIC XXX.
  5124     12  FILLER REDEFINES CM-USER-RESERVED.
  5125         16  CM-AH-CLASS-CD                PIC XX.
  5126         16  F                             PIC X.
  5127******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL689.cbl
  5129*    COPY ERCCHEK.
  5130******************************************************************
  5131*                                                                *
  5132*                                                                *
  5133*                            ERCCHEK                             *
  5134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5135*                            VMOD=2.008                          *
  5136*                                                                *
  5137*   FILE DESCRIPTION = CHECK RECORDS                             *
  5138*                                                                *
  5139*   FILE TYPE = VSAM,KSDS                                        *
  5140*   RECORD SIZE = 600    RECFORM = FIXED                         *
  5141*                                                                *
  5142*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  5143*       ALTERNATE INDEX = NONE                                   *
  5144*                                                                *
  5145*   LOG = YES                                                    *
  5146*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5147******************************************************************
  5148*                   C H A N G E   L O G
  5149*
  5150* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5151*-----------------------------------------------------------------
  5152*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5153* EFFECTIVE    NUMBER
  5154*-----------------------------------------------------------------
  5155* 021414    2003053000001  PEMA  changes for auto chk request
  5156******************************************************************
  5157 01  CHECK-RECORDS.
  5158     12  CH-RECORD-ID                      PIC XX.
  5159         88  VALID-CH-ID                      VALUE 'CH'.
  5160
  5161     12  CH-CONTROL-PRIMARY.
  5162         16  CH-COMPANY-CD                 PIC X.
  5163         16  CH-CARRIER                    PIC X.
  5164         16  CH-GROUPING                   PIC X(6).
  5165         16  CH-STATE                      PIC XX.
  5166         16  CH-ACCOUNT                    PIC X(10).
  5167         16  CH-CERT-EFF-DT                PIC XX.
  5168         16  CH-CERT-NO.
  5169             20  CH-CERT-PRIME             PIC X(10).
  5170             20  CH-CERT-SFX               PIC X.
  5171         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5172
  5173     12  CH-RECORDED-DT                    PIC XX.
  5174     12  CH-RECORDED-BY                    PIC X(4).
  5175     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5176
  5177     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5178     12  CH-CHECK-NO                       PIC X(7).
  5179     12  CH-REASON-FOR-CHECK               PIC X(25).
  5180     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5181     12  FILLER                            PIC X.
  5182
  5183     12  CH-PAYEE-INFO.
  5184         16  CH-PAYEE-NAME-1               PIC X(30).
  5185         16  CH-PAYEE-NAME-2               PIC X(30).
  5186         16  CH-PAYEE-ADDRESS-1            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL689.cbl
  5187         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5188         16  CH-PAYEE-CITY-ST.
  5189             20  CH-PAYEE-CITY             PIC X(28).
  5190             20  CH-PAYEE-STATE            PIC XX.
  5191         16  CH-PAYEE-ZIP-CODE.
  5192             20  CH-PAYEE-ZIP.
  5193                 24  CH-ZIP-PRI-1ST        PIC X.
  5194                     88  CH-CANADIAN-POST-CODE
  5195                                           VALUES 'A' THRU 'Z'.
  5196                 24  FILLER                PIC X(4).
  5197             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5198         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5199             20  CH-CAN-POSTAL-1           PIC XXX.
  5200             20  CH-CAN-POSTAL-2           PIC XXX.
  5201             20  FILLER                    PIC XXX.
  5202
  5203     12  CH-CHECK-STUB-TEXT.
  5204         16  CH-STUB-LINE-1                PIC X(30).
  5205         16  CH-TEXT-LINE-1                PIC X(50).
  5206         16  CH-TEXT-LINE-2                PIC X(50).
  5207         16  CH-TEXT-LINE-3                PIC X(40).
  5208     12  CH-RETURN-TO                      PIC X(30).
  5209
  5210     12  CH-COMPENSATION-CONTROL.
  5211         16  CH-COMP-CARRIER               PIC X.
  5212         16  CH-COMP-GROUPING              PIC X(6).
  5213         16  CH-COMP-FIN-RESP              PIC X(10).
  5214         16  CH-COMP-ACCOUNT               PIC X(10).
  5215
  5216     12  CH-CREDIT-SELECT-DT               PIC XX.
  5217     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5218     12  CH-PAYEE-CODE                     PIC X(6).
  5219
  5220     12  CH-VOID-DATA.
  5221         20  CH-VOID-DT                    PIC XX.
  5222         20  CH-VOID-BY                    PIC X(4).
  5223         20  CH-VOID-REASON                PIC X(25).
  5224
  5225     12  CH-APPROVAL-DATA.
  5226         20  CH-APPROVAL-DT                PIC XX.
  5227         20  CH-APPROVAL-STATUS            PIC X.
  5228             88  CH-IN-LIMBO                  VALUE ' '.
  5229             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  5230             88  CH-APPROVED                  VALUE 'A'.
  5231             88  CH-DENIED                    VALUE 'D'.
  5232         20  CH-APPROVED-BY                PIC XXXX.
  5233     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5234             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5235     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5236
  5237     12  ch-released-dt                    pic xx.
  5238     12  ch-check-cashed-dt                pic xx.
  5239     12  FILLER                            PIC X.
  5240*    12  CH-CHECK-REFERENCE                PIC X(12).
  5241     12  CH-CHECK-ORIGIN-SW                PIC X.
  5242             88  CH-REFUND-CHECK              VALUE 'R'.
  5243             88  CH-MAINT-CHECK               VALUE 'M'.
  5244
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL689.cbl
  5245     12  CH-CANC-DT                        PIC XX.
  5246     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5247     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5248
  5249     12  CH-INSURED-NAME                   PIC X(28).
  5250
  5251     12  ch-released-by                    pic x(4).
  5252     12  ch-csr                            pic x(4).
  5253     12  ch-deduct-commission              pic x.
  5254         88  ch-deduct-comm                  value 'Y'.
  5255         88  ch-do-not-deduct-comm           value 'N'.
  5256
  5257     12  FILLER                            PIC X(11).
  5258*    12  CH-LETTER-TABLE.
  5259*        16  CH-LETTERS OCCURS 3 TIMES
  5260*                       INDEXED BY CH-LT-NDX
  5261*                                          PIC X(04).
  5262
  5263     12  FILLER                            PIC X(07).
  5264
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL689.cbl
  5266*    COPY ELCCNTL.
  5267******************************************************************
  5268*                                                                *
  5269*                                                                *
  5270*                            ELCCNTL.                            *
  5271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5272*                            VMOD=2.059                          *
  5273*                                                                *
  5274*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5275*                                                                *
  5276*   FILE TYPE = VSAM,KSDS                                        *
  5277*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5278*                                                                *
  5279*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5280*       ALTERNATE INDEX = NONE                                   *
  5281*                                                                *
  5282*   LOG = YES                                                    *
  5283*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5284******************************************************************
  5285*                   C H A N G E   L O G
  5286*
  5287* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5288*-----------------------------------------------------------------
  5289*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5290* EFFECTIVE    NUMBER
  5291*-----------------------------------------------------------------
  5292* 082503                   PEMA  ADD BENEFIT GROUP
  5293* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5294* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5295* 092705    2005050300006  PEMA  ADD SPP LEASES
  5296* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5297* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5298* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5299* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5300* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5301* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5302* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5303* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5304* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5305* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5306******************************************************************
  5307*
  5308 01  CONTROL-FILE.
  5309     12  CF-RECORD-ID                       PIC XX.
  5310         88  VALID-CF-ID                        VALUE 'CF'.
  5311
  5312     12  CF-CONTROL-PRIMARY.
  5313         16  CF-COMPANY-ID                  PIC XXX.
  5314         16  CF-RECORD-TYPE                 PIC X.
  5315             88  CF-COMPANY-MASTER              VALUE '1'.
  5316             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5317             88  CF-STATE-MASTER                VALUE '3'.
  5318             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5319             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5320             88  CF-CARRIER-MASTER              VALUE '6'.
  5321             88  CF-MORTALITY-MASTER            VALUE '7'.
  5322             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5323             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL689.cbl
  5324             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5325             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5326             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5327             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5328             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5329             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5330             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5331             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5332             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5333         16  CF-ACCESS-CD-GENL              PIC X(4).
  5334         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5335             20  CF-PROCESSOR               PIC X(4).
  5336         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5337             20  CF-STATE-CODE              PIC XX.
  5338             20  FILLER                     PIC XX.
  5339         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5340             20  FILLER                     PIC XX.
  5341             20  CF-HI-BEN-IN-REC           PIC XX.
  5342         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5343             20  FILLER                     PIC XXX.
  5344             20  CF-CARRIER-CNTL            PIC X.
  5345         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5346             20  FILLER                     PIC XX.
  5347             20  CF-HI-TYPE-IN-REC          PIC 99.
  5348         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5349             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5350                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5351             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5352             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5353         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5354             20  FILLER                     PIC X.
  5355             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5356         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5357             20  FILLER                     PIC XX.
  5358             20  CF-MORTGAGE-PLAN           PIC XX.
  5359         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5360
  5361     12  CF-LAST-MAINT-DT                   PIC XX.
  5362     12  CF-LAST-MAINT-BY                   PIC X(4).
  5363     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5364
  5365     12  CF-RECORD-BODY                     PIC X(728).
  5366
  5367
  5368****************************************************************
  5369*             COMPANY MASTER RECORD                            *
  5370****************************************************************
  5371
  5372     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5373         16  CF-COMPANY-ADDRESS.
  5374             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5375             20  CF-CL-IN-CARE-OF           PIC X(30).
  5376             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5377             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5378             20  CF-CL-CITY-STATE           PIC X(30).
  5379             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5380             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5381         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL689.cbl
  5382         16  CF-COMPANY-PASSWORD            PIC X(8).
  5383         16  CF-SECURITY-OPTION             PIC X.
  5384             88  ALL-SECURITY                   VALUE '1'.
  5385             88  COMPANY-VERIFY                 VALUE '2'.
  5386             88  PROCESSOR-VERIFY               VALUE '3'.
  5387             88  NO-SECURITY                    VALUE '4'.
  5388             88  ALL-BUT-TERM                   VALUE '5'.
  5389         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5390             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5391         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5392             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5393         16  CF-INFORCE-LOCATION            PIC X.
  5394             88  CERTS-ARE-ONLINE               VALUE '1'.
  5395             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5396             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5397         16  CF-LOWER-CASE-LETTERS          PIC X.
  5398         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5399             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5400             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5401             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5402             88  CF-ACCNT-CNTL                  VALUE '3'.
  5403             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5404
  5405         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5406         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5407
  5408         16  CF-LGX-CREDIT-USER             PIC X.
  5409             88  CO-IS-NOT-USER                 VALUE 'N'.
  5410             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5411
  5412         16 CF-CREDIT-CALC-CODES.
  5413             20  CF-CR-REM-TERM-CALC PIC X.
  5414               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5415               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5416               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5417               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5418               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5419               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5420               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5421             20  CF-CR-R78-METHOD           PIC X.
  5422               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5423               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5424
  5425         16  CF-CLAIM-CONTROL-COUNTS.
  5426             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5427                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5428
  5429             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5430                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5431
  5432             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5433                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5434
  5435             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5436                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5437
  5438         16  CF-CURRENT-MONTH-END           PIC XX.
  5439
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL689.cbl
  5440         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5441             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5442             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5443             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5444             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5445                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5446                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5447             20  CF-CO-PREM-REJECT-SW       PIC X.
  5448                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5449                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5450             20  CF-CO-REF-REJECT-SW        PIC X.
  5451                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5452                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5453
  5454         16  CF-CO-REPORTING-DT             PIC XX.
  5455         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5456         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5457           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5458           88  CF-CO-MONTH-END                  VALUE '1'.
  5459
  5460         16  CF-LGX-CLAIM-USER              PIC X.
  5461             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5462             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5463
  5464         16  CF-CREDIT-EDIT-CONTROLS.
  5465             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5466             20  CF-MIN-AGE                 PIC 99.
  5467             20  CF-DEFAULT-AGE             PIC 99.
  5468             20  CF-MIN-TERM                PIC S999      COMP-3.
  5469             20  CF-MAX-TERM                PIC S999      COMP-3.
  5470             20  CF-DEFAULT-SEX             PIC X.
  5471             20  CF-JOINT-AGE-INPUT         PIC X.
  5472                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5473             20  CF-BIRTH-DATE-INPUT        PIC X.
  5474                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5475             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5476                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5477                 88  CF-ZERO-CARRIER            VALUE '1'.
  5478                 88  CF-ZERO-GROUPING           VALUE '2'.
  5479                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5480             20  CF-EDIT-SW                 PIC X.
  5481                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5482             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5483             20  CF-CR-PR-METHOD            PIC X.
  5484               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5485               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5486             20  FILLER                     PIC X.
  5487
  5488         16  CF-CREDIT-MISC-CONTROLS.
  5489             20  CF-REIN-TABLE-SW           PIC X.
  5490                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5491             20  CF-COMP-TABLE-SW           PIC X.
  5492                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5493             20  CF-EXPERIENCE-RETENTION-AGE
  5494                                            PIC S9        COMP-3.
  5495             20  CF-CONVERSION-DT           PIC XX.
  5496             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5497             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL689.cbl
  5498                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5499                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5500
  5501             20  CF-CR-CHECK-NO-CONTROL.
  5502                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5503                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5504                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5505                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5506                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5507                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5508
  5509                 24  CF-CR-CHECK-COUNT       REDEFINES
  5510                     CF-CR-CHECK-COUNTER      PIC X(4).
  5511
  5512                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5513                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5514
  5515                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5516                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5517                 24  CF-MAIL-PROCESSING       PIC X.
  5518                     88  MAIL-PROCESSING          VALUE 'Y'.
  5519
  5520         16  CF-MISC-SYSTEM-CONTROL.
  5521             20  CF-SYSTEM-C                 PIC X.
  5522                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5523             20  CF-SYSTEM-D                 PIC X.
  5524                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5525             20  CF-SOC-SEC-NO-SW            PIC X.
  5526                 88  SOC-SEC-NO-USED             VALUE '1'.
  5527             20  CF-MEMBER-NO-SW             PIC X.
  5528                 88  MEMBER-NO-USED              VALUE '1'.
  5529             20  CF-TAX-ID-NUMBER            PIC X(11).
  5530             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5531             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5532                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5533                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5534                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5535                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5536             20  CF-SYSTEM-E                 PIC X.
  5537                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5538
  5539         16  CF-LGX-LIFE-USER               PIC X.
  5540             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5541             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5542
  5543         16  CF-CR-MONTH-END-DT             PIC XX.
  5544
  5545         16  CF-FILE-MAINT-DATES.
  5546             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5547                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5548             20  CF-LAST-BATCH       REDEFINES
  5549                 CF-LAST-BATCH-NO               PIC X(4).
  5550             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5551             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5552             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5553             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5554             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5555             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL689.cbl
  5556             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5557             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5558             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5559             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5560
  5561         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5562         16  FILLER                         PIC X.
  5563
  5564         16  CF-ALT-MORT-CODE               PIC X(4).
  5565         16  CF-MEMBER-CAPTION              PIC X(10).
  5566
  5567         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5568             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5569             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5570             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5571             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5572             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5573
  5574         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5575
  5576         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5577         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5578         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5579         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5580
  5581         16  CF-AH-OVERRIDE-L1              PIC X.
  5582         16  CF-AH-OVERRIDE-L2              PIC XX.
  5583         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5584         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5585
  5586         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5587         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5588
  5589         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5590         16  CF-AR-LAST-EL860-DT            PIC XX.
  5591         16  CF-MP-MONTH-END-DT             PIC XX.
  5592
  5593         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5594         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5595             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5596
  5597         16  CF-AR-MONTH-END-DT             PIC XX.
  5598
  5599         16  CF-CRDTCRD-USER                PIC X.
  5600             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5601             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5602
  5603         16  CF-CC-MONTH-END-DT             PIC XX.
  5604
  5605         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5606
  5607         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5608             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5609             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5610             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5611         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5612         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5613         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL689.cbl
  5614         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5615             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5616             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5617         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5618         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5619         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5620             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5621         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5622
  5623         16  CF-CL-ZIP-CODE.
  5624             20  CF-CL-ZIP-PRIME.
  5625                 24  CF-CL-ZIP-1ST          PIC X.
  5626                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5627                 24  FILLER                 PIC X(4).
  5628             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5629         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5630             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5631             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5632             20  FILLER                     PIC XXX.
  5633
  5634         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5635         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5636         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5637         16  CF-CO-OPTION-START-DATE        PIC XX.
  5638         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5639           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5640                                                      '3' '4'.
  5641           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5642           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5643           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5644           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5645           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5646           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5647
  5648         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5649
  5650         16  CF-PAYMENT-APPROVAL-LEVELS.
  5651             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5652             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5653             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5654             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5655             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5656             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5657
  5658         16  CF-END-USER-REPORTING-USER     PIC X.
  5659             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5660             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5661
  5662         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5663             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5664             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5665
  5666         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5667
  5668         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5669         16  FILLER                         PIC X.
  5670
  5671         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL689.cbl
  5672             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5673             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5674             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5675
  5676         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5677
  5678         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5679             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5680             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5681
  5682         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5683             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5684             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5685
  5686         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5687
  5688         16  CF-CO-ACH-ID-CODE              PIC  X.
  5689             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5690             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5691             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5692         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5693         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5694         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5695         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5696         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5697         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5698         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5699         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5700         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5701                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5702         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5703                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5704
  5705         16  CF-CO-OVER-SHORT.
  5706             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5707             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5708
  5709*         16  FILLER                         PIC X(102).
  5710         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5711             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5712             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5713
  5714         16  CF-AH-APPROVAL-DAYS.
  5715             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5716             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5717             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5718             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5719
  5720         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5721
  5722         16  CF-APPROV-LEV-5.
  5723             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5724             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5725             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5726
  5727         16  FILLER                         PIC X(68).
  5728****************************************************************
  5729*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL689.cbl
  5730****************************************************************
  5731
  5732     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5733         16  CF-PROCESSOR-NAME              PIC X(30).
  5734         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5735         16  CF-PROCESSOR-TITLE             PIC X(26).
  5736         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5737                 88  MESSAGE-YES                VALUE 'Y'.
  5738                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5739
  5740*****************************************************
  5741****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5742****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5743****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5744****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5745*****************************************************
  5746
  5747         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5748             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5749             20  CF-APPLICATION-FORCE       PIC X.
  5750             20  CF-INDIVIDUAL-APP.
  5751                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5752                     28  CF-BROWSE-APP      PIC X.
  5753                     28  CF-UPDATE-APP      PIC X.
  5754
  5755         16  CF-CURRENT-TERM-ON             PIC X(4).
  5756         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5757             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5758             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5759             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5760             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5761             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5762             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5763             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5764         16  CF-PROCESSOR-CARRIER           PIC X.
  5765             88  NO-CARRIER-SECURITY            VALUE ' '.
  5766         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5767             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5768         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5769             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5770         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5771             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5772
  5773         16  CF-PROC-SYS-ACCESS-SW.
  5774             20  CF-PROC-CREDIT-CLAIMS-SW.
  5775                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5776                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5777                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5778                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5779             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5780                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5781                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5782             20  CF-PROC-LIFE-GNRLDGR-SW.
  5783                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5784                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5785                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5786                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5787             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL689.cbl
  5788                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5789                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5790         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5791             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5792             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5793         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5794
  5795         16  CF-APPROVAL-LEVEL                  PIC X.
  5796             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5797             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5798             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5799             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5800             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5801
  5802         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5803
  5804         16  CF-LANGUAGE-TYPE                   PIC X.
  5805             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5806             88  CF-LANG-IS-FR                      VALUE 'F'.
  5807
  5808         16  CF-CSR-IND                         PIC X.
  5809         16  FILLER                             PIC X(239).
  5810
  5811****************************************************************
  5812*             PROCESSOR/REMINDERS RECORD                       *
  5813****************************************************************
  5814
  5815     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5816         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5817             20  CF-START-REMIND-DT         PIC XX.
  5818             20  CF-END-REMIND-DT           PIC XX.
  5819             20  CF-REMINDER-TEXT           PIC X(50).
  5820         16  FILLER                         PIC X(296).
  5821
  5822
  5823****************************************************************
  5824*             STATE MASTER RECORD                              *
  5825****************************************************************
  5826
  5827     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5828         16  CF-STATE-ABBREVIATION          PIC XX.
  5829         16  CF-STATE-NAME                  PIC X(25).
  5830         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5831         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5832             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5833             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5834             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5835             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5836                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5837                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5838             20  CF-ST-PREM-REJECT-SW       PIC X.
  5839                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5840                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5841             20  CF-ST-REF-REJECT-SW        PIC X.
  5842                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5843                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5844         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5845         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL689.cbl
  5846         16  CF-ST-REFUND-RULES.
  5847             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5848             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5849             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5850         16  CF-ST-FST-PMT-EXTENSION.
  5851             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5852             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5853                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5854                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5855                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5856                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5857         16  CF-ST-STATE-CALL.
  5858             20  CF-ST-CALL-UNEARNED        PIC X.
  5859             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5860             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5861         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5862             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5863             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5864         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5865         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5866         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5867         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5868         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5869         16  FILLER                         PIC X.
  5870         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5871             20  CF-ST-BENEFIT-CD           PIC XX.
  5872             20  CF-ST-BENEFIT-KIND         PIC X.
  5873                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5874                 88  CF-ST-AH-KIND              VALUE 'A'.
  5875             20  CF-ST-REM-TERM-CALC        PIC X.
  5876                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5877                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5878                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5879                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5880                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5881                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5882                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5883                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5884
  5885             20  CF-ST-REFUND-CALC          PIC X.
  5886                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5887                 88  ST-REFD-BY-R78             VALUE '1'.
  5888                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5889                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5890                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5891                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5892                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5893                 88  ST-REFD-UTAH               VALUE '7'.
  5894                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5895                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5896                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5897
  5898             20  CF-ST-EARNING-CALC         PIC X.
  5899                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5900                 88  ST-EARN-BY-R78             VALUE '1'.
  5901                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5902                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5903                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL689.cbl
  5904                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5905                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5906                 88  ST-EARN-MEAN               VALUE '8'.
  5907                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5908
  5909             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5910                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5911                 88  ST-OVRD-BY-R78             VALUE '1'.
  5912                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5913                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5914                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5915                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5916                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5917                 88  ST-OVRD-MEAN               VALUE '8'.
  5918                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5919             20  FILLER                     PIC X.
  5920
  5921         16  CF-ST-COMMISSION-CAPS.
  5922             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5923             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5924             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5925             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5926         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5927                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5928
  5929         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5930
  5931         16  CF-ST-STATUTORY-INTEREST.
  5932             20  CF-ST-STAT-DATE-FROM       PIC X.
  5933                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5934                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5935             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5936             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5937             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5938             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5939             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5940
  5941         16  CF-ST-OVER-SHORT.
  5942             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5943             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5944
  5945         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5946
  5947         16  CF-ST-RT-CALC                  PIC X.
  5948
  5949         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5950         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5951         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5952         16  CF-ST-RF-LR-CALC               PIC X.
  5953         16  CF-ST-RF-LL-CALC               PIC X.
  5954         16  CF-ST-RF-LN-CALC               PIC X.
  5955         16  CF-ST-RF-AH-CALC               PIC X.
  5956         16  CF-ST-RF-CP-CALC               PIC X.
  5957*        16  FILLER                         PIC X(206).
  5958*CIDMOD         16  FILLER                         PIC X(192).
  5959         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5960             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5961         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL689.cbl
  5962         16  CF-ST-VFY-2ND-BENE             PIC X.
  5963         16  CF-ST-CAUSAL-STATE             PIC X.
  5964         16  FILLER                         PIC X(185).
  5965
  5966****************************************************************
  5967*             BENEFIT MASTER RECORD                            *
  5968****************************************************************
  5969
  5970     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5971         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5972             20  CF-BENEFIT-CODE            PIC XX.
  5973             20  CF-BENEFIT-NUMERIC  REDEFINES
  5974                 CF-BENEFIT-CODE            PIC XX.
  5975             20  CF-BENEFIT-ALPHA           PIC XXX.
  5976             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5977             20  CF-BENEFIT-COMMENT         PIC X(10).
  5978
  5979             20  CF-LF-COVERAGE-TYPE        PIC X.
  5980                 88  CF-REDUCING                VALUE 'R'.
  5981                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5982
  5983             20  CF-SPECIAL-CALC-CD         PIC X.
  5984                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5985                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5986                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5987                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5988                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5989                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5990                 88  CF-FARM-PLAN               VALUE 'F'.
  5991                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5992                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5993                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5994                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5995                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5996                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5997                 88  CF-PRUDENTIAL              VALUE 'P'.
  5998                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5999                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  6000                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  6001                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  6002                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  6003                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  6004
  6005             20  CF-JOINT-INDICATOR         PIC X.
  6006                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  6007
  6008*            20  FILLER                     PIC X(12).
  6009             20  cf-maximum-benefits        pic s999 comp-3.
  6010             20  FILLER                     PIC X(09).
  6011             20  CF-BENEFIT-CATEGORY        PIC X.
  6012             20  CF-LOAN-TYPE               PIC X(8).
  6013
  6014             20  CF-CO-REM-TERM-CALC        PIC X.
  6015                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  6016                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  6017                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  6018                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  6019                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL689.cbl
  6020
  6021             20  CF-CO-EARNINGS-CALC        PIC X.
  6022                 88  CO-EARN-BY-R78             VALUE '1'.
  6023                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  6024                 88  CO-EARN-AS-CALIF           VALUE '3'.
  6025                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  6026                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  6027                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  6028                 88  CO-EARN-AS-MEAN            VALUE '8'.
  6029                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  6030
  6031             20  CF-CO-REFUND-CALC          PIC X.
  6032                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  6033                 88  CO-REFD-BY-R78             VALUE '1'.
  6034                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  6035                 88  CO-REFD-AS-CALIF           VALUE '3'.
  6036                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  6037                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  6038                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  6039                 88  CO-REFD-MEAN               VALUE '8'.
  6040                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  6041                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  6042                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  6043
  6044             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  6045                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  6046                 88  CO-OVRD-BY-R78             VALUE '1'.
  6047                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  6048                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  6049                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  6050                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  6051                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  6052                 88  CO-OVRD-MEAN               VALUE '8'.
  6053                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  6054
  6055             20  CF-CO-BEN-I-G-CD           PIC X.
  6056                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  6057                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6058                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6059
  6060         16  FILLER                         PIC X(304).
  6061
  6062
  6063****************************************************************
  6064*             CARRIER MASTER RECORD                            *
  6065****************************************************************
  6066
  6067     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6068         16  CF-ADDRESS-DATA.
  6069             20  CF-MAIL-TO-NAME            PIC X(30).
  6070             20  CF-IN-CARE-OF              PIC X(30).
  6071             20  CF-ADDRESS-LINE-1          PIC X(30).
  6072             20  CF-ADDRESS-LINE-2          PIC X(30).
  6073             20  CF-CITY-STATE              PIC X(30).
  6074             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6075             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6076
  6077         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL689.cbl
  6078             20  CF-CLAIM-NO-METHOD         PIC X.
  6079                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6080                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6081                 88  CLAIM-NO-SEQ               VALUE '3'.
  6082                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6083             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6084                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6085                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6086                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6087
  6088         16  CF-CHECK-NO-CONTROL.
  6089             20  CF-CHECK-NO-METHOD         PIC X.
  6090                 88  CHECK-NO-MANUAL            VALUE '1'.
  6091                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6092                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6093                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6094             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6095                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6096
  6097         16  CF-DOMICILE-STATE              PIC XX.
  6098
  6099         16  CF-EXPENSE-CONTROLS.
  6100             20  CF-EXPENSE-METHOD          PIC X.
  6101                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6102                 88  DOLLARS-PER-PMT            VALUE '2'.
  6103                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6104                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6105             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6106             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6107
  6108         16  CF-CORRESPONDENCE-CONTROL.
  6109             20  CF-LETTER-RESEND-OPT       PIC X.
  6110                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6111                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6112             20  FILLER                     PIC X(4).
  6113
  6114         16  CF-RESERVE-CONTROLS.
  6115             20  CF-MANUAL-SW               PIC X.
  6116                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6117             20  CF-FUTURE-SW               PIC X.
  6118                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6119             20  CF-PTC-SW                  PIC X.
  6120                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6121             20  CF-IBNR-SW                 PIC X.
  6122                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6123             20  CF-PTC-LF-SW               PIC X.
  6124                 88  CF-LF-PTC-USED             VALUE '1'.
  6125             20  CF-CDT-ACCESS-METHOD       PIC X.
  6126                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6127                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6128                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6129             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6130
  6131         16  CF-CLAIM-CALC-METHOD           PIC X.
  6132             88  360-PLUS-MONTHS                VALUE '1'.
  6133             88  365-PLUS-MONTHS                VALUE '2'.
  6134             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6135             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL689.cbl
  6136             88  365-DAILY                      VALUE '5'.
  6137
  6138         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6139         16  FILLER                         PIC X(11).
  6140
  6141         16  CF-LIMIT-AMOUNTS.
  6142             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6143             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6144             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6145             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6146             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6147             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6148             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6149             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6150             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6151             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6152
  6153         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6154         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6155         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6156
  6157         16  CF-ZIP-CODE.
  6158             20  CF-ZIP-PRIME.
  6159                 24  CF-ZIP-1ST             PIC X.
  6160                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6161                 24  FILLER                 PIC X(4).
  6162             20  CF-ZIP-PLUS4               PIC X(4).
  6163         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6164             20  CF-CAN-POSTAL-1            PIC XXX.
  6165             20  CF-CAN-POSTAL-2            PIC XXX.
  6166             20  FILLER                     PIC XXX.
  6167
  6168         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6169         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6170         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6171
  6172         16  CF-RATING-SWITCH               PIC X.
  6173             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6174             88  CF-NO-RATING                   VALUE 'N'.
  6175
  6176         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6177
  6178         16  CF-CARRIER-OVER-SHORT.
  6179             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6180             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6181
  6182         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6183         16  CF-SECPAY-SWITCH               PIC X.
  6184             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6185             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6186         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6187         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6188         16  FILLER                         PIC X(444).
  6189*        16  FILLER                         PIC X(452).
  6190
  6191
  6192****************************************************************
  6193*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL689.cbl
  6194****************************************************************
  6195
  6196     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6197         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6198                                INDEXED BY CF-MORT-NDX.
  6199             20  CF-MORT-TABLE              PIC X(5).
  6200             20  CF-MORT-TABLE-TYPE         PIC X.
  6201                 88  CF-MORT-JOINT              VALUE 'J'.
  6202                 88  CF-MORT-SINGLE             VALUE 'S'.
  6203                 88  CF-MORT-COMBINED           VALUE 'C'.
  6204                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6205                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6206             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6207             20  CF-MORT-AGE-METHOD         PIC XX.
  6208                 88  CF-AGE-LAST                VALUE 'AL'.
  6209                 88  CF-AGE-NEAR                VALUE 'AN'.
  6210             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6211             20  CF-MORT-ADJUSTMENT-DIRECTION
  6212                                            PIC X.
  6213                 88  CF-MINUS                   VALUE '-'.
  6214                 88  CF-PLUS                    VALUE '+'.
  6215             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6216             20  CF-MORT-JOINT-CODE         PIC X.
  6217                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6218             20  CF-MORT-PC-Q               PIC X.
  6219                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6220             20  CF-MORT-TABLE-CODE         PIC X(4).
  6221             20  CF-MORT-COMMENTS           PIC X(15).
  6222             20  FILLER                     PIC X(14).
  6223
  6224         16  FILLER                         PIC X(251).
  6225
  6226
  6227****************************************************************
  6228*             BUSSINESS TYPE MASTER RECORD                     *
  6229****************************************************************
  6230
  6231     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6232* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6233* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6234* AND RECORD 05 IS TYPES 81-99
  6235         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6236             20  CF-BUSINESS-TITLE          PIC  X(19).
  6237             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6238                                            PIC S9V9(4) COMP-3.
  6239             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6240             20  FILLER                     PIC  X.
  6241         16  FILLER                         PIC  X(248).
  6242
  6243
  6244****************************************************************
  6245*             TERMINAL MASTER RECORD                           *
  6246****************************************************************
  6247
  6248     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6249
  6250         16  CF-COMPANY-TERMINALS.
  6251             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL689.cbl
  6252                                  PIC X(4).
  6253         16  FILLER               PIC X(248).
  6254
  6255
  6256****************************************************************
  6257*             LIFE EDIT MASTER RECORD                          *
  6258****************************************************************
  6259
  6260     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6261         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6262             20  CF-LIFE-CODE-IN            PIC XX.
  6263             20  CF-LIFE-CODE-OUT           PIC XX.
  6264         16  FILLER                         PIC X(248).
  6265
  6266
  6267****************************************************************
  6268*             AH EDIT MASTER RECORD                            *
  6269****************************************************************
  6270
  6271     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6272         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6273             20  CF-AH-CODE-IN              PIC XXX.
  6274             20  CF-AH-CODE-OUT             PIC XX.
  6275         16  FILLER                         PIC X(248).
  6276
  6277
  6278****************************************************************
  6279*             CREDIBILITY TABLES                               *
  6280****************************************************************
  6281
  6282     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6283         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6284                             INDEXED BY CF-CRDB-NDX.
  6285             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6286             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6287             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6288         16  FILLER                         PIC  X(332).
  6289
  6290
  6291****************************************************************
  6292*             REPORT CUSTOMIZATION RECORD                      *
  6293****************************************************************
  6294
  6295     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6296         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6297             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6298             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6299             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6300**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6301****       A T-TRANSFER.                                   ****
  6302             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6303
  6304         16  FILLER                         PIC XX.
  6305
  6306         16  CF-CARRIER-CNTL-OPT.
  6307             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6308                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6309                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL689.cbl
  6310             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6311                                            PIC X.
  6312         16  CF-GROUP-CNTL-OPT.
  6313             20  CF-GROUP-OPT-SEQ           PIC 9.
  6314                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6315                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6316             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6317                                            PIC X(6).
  6318         16  CF-STATE-CNTL-OPT.
  6319             20  CF-STATE-OPT-SEQ           PIC 9.
  6320                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6321                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6322             20  CF-STATE-SELECT OCCURS 3 TIMES
  6323                                            PIC XX.
  6324         16  CF-ACCOUNT-CNTL-OPT.
  6325             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6326                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6327                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6328             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6329                                            PIC X(10).
  6330         16  CF-BUS-TYP-CNTL-OPT.
  6331             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6332                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6333                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6334             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6335                                            PIC XX.
  6336         16  CF-LF-TYP-CNTL-OPT.
  6337             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6338                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6339                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6340             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6341                                            PIC XX.
  6342         16  CF-AH-TYP-CNTL-OPT.
  6343             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6344                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6345                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6346             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6347                                            PIC XX.
  6348         16  CF-REPTCD1-CNTL-OPT.
  6349             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6350                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6351                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6352             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6353                                            PIC X(10).
  6354         16  CF-REPTCD2-CNTL-OPT.
  6355             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6356                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6357                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6358             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6359                                            PIC X(10).
  6360         16  CF-USER1-CNTL-OPT.
  6361             20  CF-USER1-OPT-SEQ           PIC 9.
  6362                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6363                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6364             20  CF-USER1-SELECT OCCURS 3 TIMES
  6365                                            PIC X(10).
  6366         16  CF-USER2-CNTL-OPT.
  6367             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL689.cbl
  6368                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6369                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6370             20  CF-USER2-SELECT OCCURS 3 TIMES
  6371                                            PIC X(10).
  6372         16  CF-USER3-CNTL-OPT.
  6373             20  CF-USER3-OPT-SEQ           PIC 9.
  6374                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6375                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6376             20  CF-USER3-SELECT OCCURS 3 TIMES
  6377                                            PIC X(10).
  6378         16  CF-USER4-CNTL-OPT.
  6379             20  CF-USER4-OPT-SEQ           PIC 9.
  6380                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6381                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6382             20  CF-USER4-SELECT OCCURS 3 TIMES
  6383                                            PIC X(10).
  6384         16  CF-USER5-CNTL-OPT.
  6385             20  CF-USER5-OPT-SEQ           PIC 9.
  6386                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6387                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6388             20  CF-USER5-SELECT OCCURS 3 TIMES
  6389                                            PIC X(10).
  6390         16  CF-REINS-CNTL-OPT.
  6391             20  CF-REINS-OPT-SEQ           PIC 9.
  6392                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6393                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6394             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6395                 24  CF-REINS-PRIME         PIC XXX.
  6396                 24  CF-REINS-SUB           PIC XXX.
  6397
  6398         16  CF-AGENT-CNTL-OPT.
  6399             20  CF-AGENT-OPT-SEQ           PIC 9.
  6400                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6401                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6402             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6403                                            PIC X(10).
  6404
  6405         16  FILLER                         PIC X(43).
  6406
  6407         16  CF-LOSS-RATIO-SELECT.
  6408             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6409             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6410         16  CF-ENTRY-DATE-SELECT.
  6411             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6412             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6413         16  CF-EFFECTIVE-DATE-SELECT.
  6414             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6415             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6416
  6417         16  CF-EXCEPTION-LIST-IND          PIC X.
  6418             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6419
  6420         16  FILLER                         PIC X(318).
  6421
  6422****************************************************************
  6423*                  EXCEPTION REPORTING RECORD                  *
  6424****************************************************************
  6425
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL689.cbl
  6426     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6427         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6428             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6429
  6430         16  CF-COMBINED-LIFE-AH-OPT.
  6431             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6432             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6433             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6434             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6435
  6436         16  CF-LIFE-OPT.
  6437             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6438             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6439             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6440             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6441             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6442             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6443             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6444             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6445             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6446             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6447
  6448         16  CF-AH-OPT.
  6449             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6450             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6451             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6452             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6453             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6454             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6455             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6456             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6457             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6458             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6459
  6460         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6461             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6462             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6463             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6464
  6465         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6466
  6467         16  FILLER                         PIC X(673).
  6468
  6469
  6470****************************************************************
  6471*             MORTGAGE SYSTEM PLAN RECORD                      *
  6472****************************************************************
  6473
  6474     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6475         16  CF-PLAN-TYPE                   PIC X.
  6476             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6477             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6478             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6479         16  CF-PLAN-ABBREV                 PIC XXX.
  6480         16  CF-PLAN-DESCRIPT               PIC X(10).
  6481         16  CF-PLAN-NOTES                  PIC X(20).
  6482         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6483         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL689.cbl
  6484             20  CF-PLAN-TERM-DATA.
  6485                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6486                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6487             20  CF-PLAN-AGE-DATA.
  6488                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6489                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6490                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6491             20  CF-PLAN-BENEFIT-DATA.
  6492                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6493                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6494                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6495                                            PIC S9(7)V99  COMP-3.
  6496         16  CF-PLAN-POLICY-FORMS.
  6497             20  CF-POLICY-FORM             PIC X(12).
  6498             20  CF-MASTER-APPLICATION      PIC X(12).
  6499             20  CF-MASTER-POLICY           PIC X(12).
  6500         16  CF-PLAN-RATING.
  6501             20  CF-RATE-CODE               PIC X(5).
  6502             20  CF-SEX-RATING              PIC X.
  6503                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6504                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6505             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6506             20  CF-SUB-STD-TYPE            PIC X.
  6507                 88  CF-PCT-OF-PREM            VALUE '1'.
  6508                 88  CF-PCT-OF-BENE            VALUE '2'.
  6509         16  CF-PLAN-PREM-TOLERANCES.
  6510             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6511             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6512         16  CF-PLAN-PYMT-TOLERANCES.
  6513             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6514             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6515         16  CF-PLAN-MISC-DATA.
  6516             20  FILLER                     PIC X.
  6517             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6518             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6519         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6520         16  CF-PLAN-IND-GRP                PIC X.
  6521             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6522                                                     '1'.
  6523             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6524                                                     '2'.
  6525         16  CF-MIB-SEARCH-SW               PIC X.
  6526             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6527             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6528             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6529             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6530         16  CF-ALPHA-SEARCH-SW             PIC X.
  6531             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6532             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6533             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6534             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6535             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6536             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6537             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6538             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6539             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6540             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6541                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL689.cbl
  6542                                                     'X' 'Y' 'Z'.
  6543         16  CF-EFF-DT-RULE-SW              PIC X.
  6544             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6545             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6546             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6547             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6548             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6549         16  FILLER                         PIC X(4).
  6550         16  CF-HEALTH-QUESTIONS            PIC X.
  6551             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6552         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6553         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6554         16  CF-PLAN-SNGL-JNT               PIC X.
  6555             88  CF-COMBINED-PLAN              VALUE 'C'.
  6556             88  CF-JNT-PLAN                   VALUE 'J'.
  6557             88  CF-SNGL-PLAN                  VALUE 'S'.
  6558         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6559         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6560         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6561         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6562         16  CF-RERATE-CNTL                 PIC  X.
  6563             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6564             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6565             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6566             88  CF-AUTO-RECALC                 VALUE '4'.
  6567         16  CF-BENEFIT-TYPE                PIC  X.
  6568             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6569             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6570         16  CF-POLICY-FEE                  PIC S999V99
  6571                                                    COMP-3.
  6572         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6573         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6574         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6575         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6576         16  FILLER                         PIC  X(32).
  6577         16  CF-TERMINATION-FORM            PIC  X(04).
  6578         16  FILLER                         PIC  X(08).
  6579         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6580                                                       COMP-3.
  6581         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6582         16  CF-ISSUE-LETTER                PIC  X(4).
  6583         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6584         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6585             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6586             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6587         16  CF-MP-REFUND-CALC              PIC X.
  6588             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6589             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6590             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6591             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6592             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6593             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6594             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6595             88  CF-MP-REFD-MEAN                VALUE '8'.
  6596         16  CF-ALT-RATE-CODE               PIC  X(5).
  6597
  6598
  6599         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL689.cbl
  6600****************************************************************
  6601*             MORTGAGE COMPANY MASTER RECORD                   *
  6602****************************************************************
  6603
  6604     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6605         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6606         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6607             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6608             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6609             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6610             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6611             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6612
  6613         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6614         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6615         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6616         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6617         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6618
  6619         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6620             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6621         16  CF-MP-RECON-USE-IND            PIC X(1).
  6622             88  CF-MP-USE-RECON             VALUE 'Y'.
  6623         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6624             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6625         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6626             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6627             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6628         16  FILLER                         PIC X(1).
  6629         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6630             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6631         16  CF-MORTG-MIB-VERSION           PIC X.
  6632             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6633             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6634             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6635         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6636             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6637                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6638             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6639                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6640             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6641                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6642             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6643                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6644             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6645                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6646             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6647                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6648         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6649         16  FILLER                         PIC X(7).
  6650         16  CF-MORTG-DESTINATION-SYMBOL.
  6651             20  CF-MORTG-MIB-COMM          PIC X(5).
  6652             20  CF-MORTG-MIB-TERM          PIC X(5).
  6653         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6654             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6655         16  FILLER                         PIC X(03).
  6656         16  CF-MP-CHECK-NO-CONTROL.
  6657             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL689.cbl
  6658                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6659                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6660                                                ' ' LOW-VALUES.
  6661                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6662                                               VALUE '3'.
  6663         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6664         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6665         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6666             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6667                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6668             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6669                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6670             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6671                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6672             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6673                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6674             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6675                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6676             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6677                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6678         16  CF-MORTG-BILLING-AREA.
  6679             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6680                                            PIC X.
  6681         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6682         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6683         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6684         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6685             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6686             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6687         16  FILLER                         PIC X.
  6688         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6689             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6690             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6691         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6692         16  FILLER                         PIC X(8).
  6693         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6694         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6695         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6696         16  CF-ACH-COMPANY-ID.
  6697             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6698                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6699                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6700                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6701             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6702         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6703             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6704         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6705             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6706             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6707         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6708         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6709         16  FILLER                         PIC X(536).
  6710
  6711****************************************************************
  6712*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6713****************************************************************
  6714
  6715     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL689.cbl
  6716         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6717             20  CF-FEMALE-HEIGHT.
  6718                 24  CF-FEMALE-FT           PIC 99.
  6719                 24  CF-FEMALE-IN           PIC 99.
  6720             20  CF-FEMALE-MIN-WT           PIC 999.
  6721             20  CF-FEMALE-MAX-WT           PIC 999.
  6722         16  FILLER                         PIC X(428).
  6723
  6724     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6725         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6726             20  CF-MALE-HEIGHT.
  6727                 24  CF-MALE-FT             PIC 99.
  6728                 24  CF-MALE-IN             PIC 99.
  6729             20  CF-MALE-MIN-WT             PIC 999.
  6730             20  CF-MALE-MAX-WT             PIC 999.
  6731         16  FILLER                         PIC X(428).
  6732******************************************************************
  6733*             AUTOMATIC ACTIVITY RECORD                          *
  6734******************************************************************
  6735     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6736         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6737             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6738             20  CF-SYS-LETTER-ID           PIC X(04).
  6739             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6740             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6741             20  CF-SYS-RESET-SW            PIC X(01).
  6742             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6743             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6744
  6745         16  FILLER                         PIC X(50).
  6746
  6747         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6748             20  CF-USER-ACTIVE-SW          PIC X(01).
  6749             20  CF-USER-LETTER-ID          PIC X(04).
  6750             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6751             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6752             20  CF-USER-RESET-SW           PIC X(01).
  6753             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6754             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6755             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6756
  6757         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL689.cbl
  6759*    COPY ERCCOMP.
  6760******************************************************************
  6761*                                                                *
  6762*                                                                *
  6763*                            ERCCOMP                             *
  6764*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6765*                            VMOD=2.019                          *
  6766*                                                                *
  6767*   ONLINE CREDIT SYSTEM                                         *
  6768*                                                                *
  6769*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6770*                                                                *
  6771*   FILE TYPE = VSAM,KSDS                                        *
  6772*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6773*                                                                *
  6774*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6775*       ALTERNATE PATH = NONE                                    *
  6776*                                                                *
  6777*   LOG = NO                                                     *
  6778*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6779*                                                                *
  6780******************************************************************
  6781*                   C H A N G E   L O G
  6782*
  6783* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6784*-----------------------------------------------------------------
  6785*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6786* EFFECTIVE    NUMBER
  6787*-----------------------------------------------------------------
  6788* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6789* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6790* 092205    2005050300006  PEMA  ADD LEASE FEE
  6791* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6792* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6793* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6794* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6795* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6796* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6797******************************************************************
  6798
  6799 01  COMPENSATION-MASTER.
  6800     12  CO-RECORD-ID                          PIC XX.
  6801         88  VALID-CO-ID                          VALUE 'CO'.
  6802
  6803     12  CO-CONTROL-PRIMARY.
  6804         16  CO-COMPANY-CD                     PIC X.
  6805         16  CO-CONTROL.
  6806             20  CO-CTL-1.
  6807                 24  CO-CARR-GROUP.
  6808                     28  CO-CARRIER            PIC X.
  6809                     28  CO-GROUPING.
  6810                         32  CO-GROUP-PREFIX   PIC XXX.
  6811                         32  CO-GROUP-PRIME    PIC XXX.
  6812                 24  CO-RESP-NO.
  6813                     28  CO-RESP-PREFIX        PIC X(4).
  6814                     28  CO-RESP-PRIME         PIC X(6).
  6815             20  CO-CTL-2.
  6816                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL689.cbl
  6817                     28  CO-ACCT-PREFIX        PIC X(4).
  6818                     28  CO-ACCT-PRIME         PIC X(6).
  6819         16  CO-TYPE                           PIC X.
  6820             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6821             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6822             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6823
  6824     12  CO-MAINT-INFORMATION.
  6825         16  CO-LAST-MAINT-DT                  PIC XX.
  6826         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6827         16  CO-LAST-MAINT-USER                PIC X(4).
  6828     12  FILLER                                PIC XX.
  6829     12  CO-STMT-TYPE                          PIC XXX.
  6830     12  CO-COMP-TYPE                          PIC X.
  6831         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6832     12  CO-STMT-OWNER                         PIC X(4).
  6833     12  CO-BALANCE-CONTROL                    PIC X.
  6834         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6835         88  CO-NO-BALANCE                        VALUE 'N'.
  6836
  6837     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6838         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6839         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6840         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6841
  6842     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6843         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6844         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6845
  6846     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6847     12  CO-GA-DIRECT-DEP                      PIC X.
  6848     12  CO-FUTURE-SPACE                       PIC X.
  6849         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6850
  6851     12  CO-ACCT-NAME                          PIC X(30).
  6852     12  CO-MAIL-NAME                          PIC X(30).
  6853     12  CO-ADDR-1                             PIC X(30).
  6854     12  CO-ADDR-2                             PIC X(30).
  6855     12  CO-ADDR-3.
  6856         16  CO-ADDR-CITY                      PIC X(27).
  6857         16  CO-ADDR-STATE                     PIC XX.
  6858     12  CO-CSO-1099                           PIC X.
  6859     12  CO-ZIP.
  6860         16  CO-ZIP-PRIME.
  6861             20  CO-ZIP-PRI-1ST                PIC X.
  6862                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6863             20  FILLER                        PIC X(4).
  6864         16  CO-ZIP-PLUS4                      PIC X(4).
  6865     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6866         16  CO-CAN-POSTAL-1                   PIC XXX.
  6867         16  CO-CAN-POSTAL-2                   PIC XXX.
  6868         16  FILLER                            PIC XXX.
  6869     12  CO-SOC-SEC                            PIC X(13).
  6870     12  CO-TELEPHONE.
  6871         16  CO-AREA-CODE                      PIC XXX.
  6872         16  CO-PREFIX                         PIC XXX.
  6873         16  CO-PHONE                          PIC X(4).
  6874
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL689.cbl
  6875     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6876
  6877     12  CO-AR-BAL-LEVEL                       PIC X.
  6878         88  CO-AR-REF-LVL                        VALUE '1'.
  6879         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6880         88  CO-AR-BILL-LVL                       VALUE '2'.
  6881         88  CO-AR-AGT-LVL                        VALUE '3'.
  6882         88  CO-AR-FR-LVL                         VALUE '4'.
  6883
  6884     12  CO-AR-NORMAL-PRINT                    PIC X.
  6885         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6886         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6887
  6888     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6889
  6890     12  CO-AR-REPORTING                       PIC X.
  6891         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6892         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6893
  6894     12  CO-AR-PULL-CHECK                      PIC X.
  6895         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6896         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6897
  6898     12  CO-AR-BALANCE-PRINT                   PIC X.
  6899         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6900
  6901     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6902         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6903         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6904         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6905
  6906     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6907
  6908     12  CO-USER-CODE                          PIC X.
  6909     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6910
  6911******************************************************************
  6912*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6913*    THE LAST MONTH END RUN.
  6914******************************************************************
  6915
  6916     12  CO-LAST-ACTIVITY-DATE.
  6917         16  CO-ACT-YEAR                       PIC 99.
  6918         16  CO-ACT-MONTH                      PIC 99.
  6919         16  CO-ACT-DAY                        PIC 99.
  6920
  6921     12  CO-LAST-STMT-DT.
  6922         16  CO-LAST-STMT-YEAR                 PIC 99.
  6923         16  CO-LAST-STMT-MONTH                PIC 99.
  6924         16  CO-LAST-STMT-DAY                  PIC 99.
  6925
  6926     12  CO-MO-END-TOTALS.
  6927         16  CO-MONTHLY-TOTALS.
  6928             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6929             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6930             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6931             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6932             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL689.cbl
  6933
  6934         16  CO-AGING-TOTALS.
  6935             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6936             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6937             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6938             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6939
  6940         16  CO-YTD-TOTALS.
  6941             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6942             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6943
  6944         16  CO-OVER-UNDER-TOTALS.
  6945             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6946             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6947
  6948     12  CO-MISCELLANEOUS-TOTALS.
  6949         16  CO-FICA-TOTALS.
  6950             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6951             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6952
  6953         16  CO-CLAIM-TOTALS.
  6954             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6955             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6956
  6957******************************************************************
  6958*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6959*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6960******************************************************************
  6961
  6962     12  CO-CURRENT-TOTALS.
  6963         16  CO-CURRENT-LAST-STMT-DT.
  6964             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6965             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6966             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6967
  6968         16  CO-CURRENT-MONTHLY-TOTALS.
  6969             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6970             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6971             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6972             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6973             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6974
  6975         16  CO-CURRENT-AGING-TOTALS.
  6976             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6977             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6978             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6979             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6980
  6981         16  CO-CURRENT-YTD-TOTALS.
  6982             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6983             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6984
  6985     12  CO-PAID-COMM-TOTALS.
  6986         16  CO-YTD-PAID-COMMS.
  6987             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6988             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6989
  6990     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL689.cbl
  6991         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6992         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6993
  6994     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6995         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6996         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6997         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6998         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6999         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7000         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7001         88  CO-FINAL-LETTER                  VALUE 'F'.
  7002         88  CO-RECONCILING                   VALUE 'R'.
  7003         88  CO-PHONE-CALL                    VALUE 'P'.
  7004         88  CO-LEGAL                         VALUE 'L'.
  7005         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7006         88  CO-WRITE-OFF                     VALUE 'W'.
  7007         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7008
  7009     12  CO-CSR-CODE                       PIC X(4).
  7010
  7011     12  CO-GA-STATUS-INFO.
  7012         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7013         16  CO-GA-TERMINATION-DT          PIC XX.
  7014         16  CO-GA-STATUS-CODE             PIC X.
  7015             88  CO-GA-ACTIVE                 VALUE 'A'.
  7016             88  CO-GA-INACTIVE               VALUE 'I'.
  7017             88  CO-GA-PENDING                VALUE 'P'.
  7018         16  CO-GA-COMMENTS.
  7019             20  CO-GA-COMMENT-1           PIC X(40).
  7020             20  CO-GA-COMMENT-2           PIC X(40).
  7021             20  CO-GA-COMMENT-3           PIC X(40).
  7022             20  CO-GA-COMMENT-4           PIC X(40).
  7023
  7024     12  CO-RPTCD2                         PIC X(10).
  7025     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7026         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7027         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7028
  7029     12  CO-TYPE-AGENT                     PIC X(01).
  7030         88  CO-CORPORATION                   VALUE 'C'.
  7031         88  CO-PARTNERSHIP                   VALUE 'P'.
  7032         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7033         88  CO-TRUST                         VALUE 'T'.
  7034         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7035
  7036     12  CO-FAXNO.
  7037         16  CO-FAX-AREA-CODE                  PIC XXX.
  7038         16  CO-FAX-PREFIX                     PIC XXX.
  7039         16  CO-FAX-PHONE                      PIC X(4).
  7040
  7041     12  CO-BANK-INFORMATION.
  7042         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7043         16  CO-BANK-TRANSIT-NON REDEFINES
  7044             CO-BANK-TRANSIT-NO                PIC 9(8).
  7045
  7046         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7047     12  CO-MISC-DEDUCT-INFO REDEFINES
  7048                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL689.cbl
  7049         16  CO-MD-GL-ACCT                     PIC X(10).
  7050         16  CO-MD-DIV                         PIC XX.
  7051         16  CO-MD-CENTER                      PIC X(4).
  7052         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7053         16  CO-CREATE-AP-CHECK                PIC X.
  7054         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7055         16  FILLER                            PIC XXX.
  7056     12  CO-ACH-STATUS                         PIC X.
  7057         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7058         88  CO-ACH-PENDING                        VALUE 'P'.
  7059
  7060     12  CO-BILL-SW                            PIC X.
  7061     12  CO-CONTROL-NAME                       PIC X(30).
  7062     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7063     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7064     12  CO-CLP-STATE                          PIC XX.
  7065     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7066     12  CO-SPP-REFUND-EDIT                    PIC X.
  7067
  7068******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL689.cbl
  7070*    COPY ERCMAIL.
  7071******************************************************************
  7072*                                                                *
  7073*                                                                *
  7074*                            ERCMAIL                             *
  7075*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7076*                            VMOD=2.003                          *
  7077*                                                                *
  7078*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7079*                                                                *
  7080*   FILE TYPE = VSAM,KSDS                                        *
  7081*   RECORD SIZE = 374   RECFORM = FIX                            *
  7082*                                                                *
  7083*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7084*   ALTERNATE PATH    = NOT USED                                 *
  7085*                                                                *
  7086*   LOG = YES                                                    *
  7087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7088******************************************************************
  7089*                   C H A N G E   L O G
  7090*
  7091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7092*-----------------------------------------------------------------
  7093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7094* EFFECTIVE    NUMBER
  7095*-----------------------------------------------------------------
  7096* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7097* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7098* 111108                   PEMA  ADD CRED BENE ADDR2
  7099******************************************************************
  7100
  7101 01  MAILING-DATA.
  7102     12  MA-RECORD-ID                      PIC XX.
  7103         88  VALID-MA-ID                       VALUE 'MA'.
  7104
  7105     12  MA-CONTROL-PRIMARY.
  7106         16  MA-COMPANY-CD                 PIC X.
  7107         16  MA-CARRIER                    PIC X.
  7108         16  MA-GROUPING.
  7109             20  MA-GROUPING-PREFIX        PIC XXX.
  7110             20  MA-GROUPING-PRIME         PIC XXX.
  7111         16  MA-STATE                      PIC XX.
  7112         16  MA-ACCOUNT.
  7113             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7114             20  MA-ACCOUNT-PRIME          PIC X(6).
  7115         16  MA-CERT-EFF-DT                PIC XX.
  7116         16  MA-CERT-NO.
  7117             20  MA-CERT-PRIME             PIC X(10).
  7118             20  MA-CERT-SFX               PIC X.
  7119
  7120     12  FILLER                            PIC XX.
  7121
  7122     12  MA-ACCESS-CONTROL.
  7123         16  MA-SOURCE-SYSTEM              PIC XX.
  7124             88  MA-FROM-CREDIT                VALUE 'CR'.
  7125             88  MA-FROM-VSI                   VALUE 'VS'.
  7126             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7127             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL689.cbl
  7128         16  MA-RECORD-ADD-DT              PIC XX.
  7129         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7130         16  MA-LAST-MAINT-DT              PIC XX.
  7131         16  MA-LAST-MAINT-BY              PIC XXXX.
  7132         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7133
  7134     12  MA-PROFILE-INFO.
  7135         16  MA-QUALIFY-CODE-1             PIC XX.
  7136         16  MA-QUALIFY-CODE-2             PIC XX.
  7137         16  MA-QUALIFY-CODE-3             PIC XX.
  7138         16  MA-QUALIFY-CODE-4             PIC XX.
  7139         16  MA-QUALIFY-CODE-5             PIC XX.
  7140
  7141         16  MA-INSURED-LAST-NAME          PIC X(15).
  7142         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7143         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7144         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7145         16  MA-INSURED-BIRTH-DT           PIC XX.
  7146         16  MA-INSURED-SEX                PIC X.
  7147             88  MA-SEX-MALE                   VALUE 'M'.
  7148             88  MA-SEX-FEMALE                 VALUE 'F'.
  7149         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7150
  7151         16  MA-ADDRESS-CORRECTED          PIC X.
  7152         16  MA-JOINT-BIRTH-DT             PIC XX.
  7153*        16  FILLER                        PIC X(12).
  7154
  7155         16  MA-ADDRESS-LINE-1             PIC X(30).
  7156         16  MA-ADDRESS-LINE-2             PIC X(30).
  7157         16  MA-CITY-STATE.
  7158             20  MA-CITY                   PIC X(28).
  7159             20  MA-ADDR-STATE             PIC XX.
  7160         16  MA-ZIP.
  7161             20  MA-ZIP-CODE.
  7162                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7163                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7164                 24  FILLER                PIC X(4).
  7165             20  MA-ZIP-PLUS4              PIC X(4).
  7166         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7167             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7168             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7169             20  FILLER                    PIC X(3).
  7170
  7171         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7172
  7173         16  FILLER                        PIC XXX.
  7174*        16  FILLER                        PIC X(10).
  7175
  7176     12  MA-CRED-BENE-INFO.
  7177         16  MA-CRED-BENE-NAME                 PIC X(25).
  7178         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7179         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7180         16  MA-CRED-BENE-CTYST.
  7181             20  MA-CRED-BENE-CITY             PIC X(28).
  7182             20  MA-CRED-BENE-STATE            PIC XX.
  7183         16  MA-CRED-BENE-ZIP.
  7184             20  MA-CB-ZIP-CODE.
  7185                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL689.cbl
  7186                     88  MA-CB-CANADIAN-POST-CODE
  7187                                           VALUE 'A' THRU 'Z'.
  7188                 24  FILLER                    PIC X(4).
  7189             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7190         16  MA-CB-CANADIAN-POSTAL-CODE
  7191                            REDEFINES MA-CRED-BENE-ZIP.
  7192             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7193             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7194             20  FILLER                        PIC X(3).
  7195     12  MA-POST-CARD-MAIL-DATA.
  7196         16  MA-MAIL-DATA OCCURS 7.
  7197             20  MA-MAIL-TYPE              PIC X.
  7198                 88  MA-12MO-MAILING           VALUE '1'.
  7199                 88  MA-EXP-MAILING            VALUE '2'.
  7200             20  MA-MAIL-STATUS            PIC X.
  7201                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7202                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7203                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7204             20  MA-MAIL-DATE              PIC XX.
  7205     12  FILLER                            PIC XX.
  7206     12  FILLER                            PIC XX.
  7207*    12  FILLER                            PIC X(30).
  7208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL689.cbl
  7210*    COPY ERCPNDB.
  7211******************************************************************
  7212*                                                                *
  7213*                                                                *
  7214*                            ERCPNDB.                            *
  7215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7216*                            VMOD=2.025                          *
  7217*                                                                *
  7218*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7219*                                                                *
  7220******************************************************************
  7221*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7222*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7223******************************************************************
  7224*                                                                *
  7225*                                                                *
  7226*   FILE TYPE = VSAM,KSDS                                        *
  7227*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7228*                                                                *
  7229*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7230*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7231*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7232*                                                 RKP=13,LEN=36  *
  7233*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7234*                                      AND CHG-SEQ.)             *
  7235*                                                RKP=49,LEN=11   *
  7236*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7237*                                      AND CHG-SEQ.)             *
  7238*                                                RKP=60,LEN=15   *
  7239*                                                                *
  7240*   LOG = NO                                                     *
  7241*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7242******************************************************************
  7243******************************************************************
  7244*                   C H A N G E   L O G
  7245*
  7246* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7247*-----------------------------------------------------------------
  7248*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7249* EFFECTIVE    NUMBER
  7250*-----------------------------------------------------------------
  7251* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7252* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7253* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7254* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7255* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7256* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7257* 032306                   PEMA  ADD BOW LOAN NUMBER
  7258* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7259* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7260* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7261* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7262* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7263* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7264* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7265* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7266* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  7267******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL689.cbl
  7268
  7269 01  PENDING-BUSINESS.
  7270     12  PB-RECORD-ID                     PIC XX.
  7271         88  VALID-PB-ID                        VALUE 'PB'.
  7272
  7273     12  PB-CONTROL-PRIMARY.
  7274         16  PB-COMPANY-CD                PIC X.
  7275         16  PB-ENTRY-BATCH               PIC X(6).
  7276         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7277         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7278
  7279     12  PB-CONTROL-BY-ACCOUNT.
  7280         16  PB-COMPANY-CD-A1             PIC X.
  7281         16  PB-CARRIER                   PIC X.
  7282         16  PB-GROUPING.
  7283             20  PB-GROUPING-PREFIX       PIC XXX.
  7284             20  PB-GROUPING-PRIME        PIC XXX.
  7285         16  PB-STATE                     PIC XX.
  7286         16  PB-ACCOUNT.
  7287             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7288             20  PB-ACCOUNT-PRIME         PIC X(6).
  7289         16  PB-CERT-EFF-DT               PIC XX.
  7290         16  PB-CERT-NO.
  7291             20  PB-CERT-PRIME            PIC X(10).
  7292             20  PB-CERT-SFX              PIC X.
  7293         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7294
  7295         16  PB-RECORD-TYPE               PIC X.
  7296             88  PB-MAILING-DATA                VALUE '0'.
  7297             88  PB-ISSUE                       VALUE '1'.
  7298             88  PB-CANCELLATION                VALUE '2'.
  7299             88  PB-BATCH-TRAILER               VALUE '9'.
  7300
  7301     12  PB-CONTROL-BY-ORIG-BATCH.
  7302         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7303         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7304         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7305         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7306
  7307     12  PB-CONTROL-BY-CSR.
  7308         16  PB-CSR-COMPANY-CD            PIC X.
  7309         16  PB-CSR-ID                    PIC X(4).
  7310         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7311         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7312         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7313******************************************************************
  7314*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7315******************************************************************
  7316
  7317     12  PB-LAST-MAINT-DT                 PIC XX.
  7318     12  PB-LAST-MAINT-BY                 PIC X(4).
  7319     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7320
  7321     12  PB-RECORD-BODY                   PIC X(375).
  7322
  7323     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7324         16  PB-CERT-ORIGIN               PIC X.
  7325             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL689.cbl
  7326         16  PB-I-NAME.
  7327             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7328             20  PB-I-INSURED-FIRST-NAME.
  7329                 24  PB-I-INSURED-1ST-INIT PIC X.
  7330                 24  FILLER                PIC X(9).
  7331             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7332         16  PB-I-AGE                     PIC S99   COMP-3.
  7333         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7334         16  PB-I-BIRTHDAY                PIC XX.
  7335         16  PB-I-INSURED-SEX             PIC X.
  7336             88  PB-SEX-MALE     VALUE 'M'.
  7337             88  PB-SEX-FEMALE   VALUE 'F'.
  7338
  7339         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7340         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7341         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7342         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7343         16  PB-I-SKIP-CODE               PIC X.
  7344             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7345             88  PB-SKIP-JULY              VALUE '1'.
  7346             88  PB-SKIP-AUGUST            VALUE '2'.
  7347             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7348             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7349             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7350             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7351             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7352             88  PB-SKIP-JUNE              VALUE '8'.
  7353             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7354             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7355             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7356         16  PB-I-TERM-TYPE               PIC X.
  7357             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7358             88  PB-PAID-WEEKLY            VALUE 'W'.
  7359             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7360             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7361             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7362         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7363         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7364         16  PB-I-DATA-ENTRY-SW           PIC X.
  7365             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7366             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7367             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7368             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7369         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7370         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7371*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7372         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7373         16  FILLER                       PIC X.
  7374
  7375         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7376             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7377             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7378                                                   '90' THRU '99'.
  7379         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7380                                          PIC XX.
  7381         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7382         16  PB-I-AMOUNT-FINANCED REDEFINES
  7383                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL689.cbl
  7384         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  7385         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7386                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7387         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7388         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7389         16  PB-I-CLP-AMOUNT REDEFINES
  7390                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7391         16  PB-I-LF-CALC-FLAG            PIC X.
  7392             88 PB-COMP-LF-PREM               VALUE '?'.
  7393         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7394         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7395         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7396         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7397         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7398         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7399         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7400         16  PB-I-LF-ABBR                 PIC XXX.
  7401         16  PB-I-LF-INPUT-CD             PIC XX.
  7402
  7403         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7404             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7405             88  PB-INVALID-AH               VALUE '  ' '00'
  7406                                                   '90' THRU '99'.
  7407         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7408         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7409         16  PB-I-AH-CALC-FLAG            PIC X.
  7410             88 PB-COMP-AH-PREM                  VALUE '?'.
  7411         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7412         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7413         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7414         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7415         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7416         16  PB-I-AH-ABBR                 PIC XXX.
  7417         16  PB-I-AH-INPUT-CD             PIC XXX.
  7418
  7419         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7420         16  PB-I-REIN-TABLE              PIC XXX.
  7421         16  PB-I-BUSINESS-TYPE           PIC 99.
  7422         16  PB-I-INDV-GRP-CD             PIC X.
  7423         16  PB-I-MORT-CODE.
  7424             20  PB-I-TABLE               PIC X.
  7425             20  PB-I-INTEREST            PIC XX.
  7426             20  PB-I-MORT-TYP            PIC X.
  7427         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7428         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7429         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7430         16  PB-I-INDV-GRP-OVRD           PIC X.
  7431         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7432         16  PB-I-SIG-SW                  PIC X.
  7433             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7434         16  PB-I-RATE-CLASS              PIC XX.
  7435         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7436         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7437         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7438         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7439         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7440         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7441         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL689.cbl
  7442         16  PB-I-BENEFIT-TYPE            PIC XXX.
  7443         16  PB-I-OB-FLAG                 PIC X.
  7444             88  PB-I-OB                      VALUE 'B'.
  7445             88  PB-I-SUMMARY                 VALUE 'Z'.
  7446         16  PB-I-ENTRY-STATUS            PIC X.
  7447             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7448                                              'M' '5' '9' '2'.
  7449             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7450             88  PB-I-POLICY-PENDING          VALUE '2'.
  7451             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7452             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7453             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  7454             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7455             88  PB-I-REIN-ONLY               VALUE '9'.
  7456             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7457             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7458             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7459             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7460         16  PB-I-INT-CODE                PIC X.
  7461             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7462             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7463         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7464         16  PB-I-SOC-SEC-NO              PIC X(11).
  7465         16  PB-I-MEMBER-NO               PIC X(12).
  7466         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7467*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7468         16  PB-I-OLD-LOF                 PIC XXX.
  7469         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7470         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7471         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7472         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7473         16  PB-I-LIFE-INDICATOR          PIC X.
  7474             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7475         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7476         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7477                                          PIC S9(5)V99    COMP-3.
  7478         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7479             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7480             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7481         16  PB-I-1ST-PMT-DT              PIC XX.
  7482         16  PB-I-JOINT-INSURED.
  7483             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7484             20 PB-I-JOINT-FIRST-NAME.
  7485                24  PB-I-JOINT-FIRST-INIT PIC X.
  7486                24  FILLER                PIC X(9).
  7487             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7488*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7489         16  PB-I-BENEFICIARY-NAME.
  7490             20  PB-I-BANK-NUMBER         PIC X(10).
  7491             20  FILLER                   PIC X(15).
  7492         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7493         16  PB-I-REFERENCE               PIC X(12).
  7494         16  FILLER REDEFINES PB-I-REFERENCE.
  7495             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7496             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7497             20  PB-I-CLP-STATE           PIC XX.
  7498         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7499             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL689.cbl
  7500             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7501             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  7502         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7503         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7504         16  PB-I-RESIDENT-STATE          PIC XX.
  7505         16  PB-I-RATE-CODE               PIC X(4).
  7506         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7507         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7508         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7509         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7510         16  PB-I-BANK-NOCHRGB            PIC 99.
  7511         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7512         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7513
  7514     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7515         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7516             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7517         16  PB-C-CANCEL-ORIGIN           PIC X.
  7518             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7519         16  PB-C-LF-CANCEL-DT            PIC XX.
  7520         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7521         16  PB-C-LF-CALC-REQ             PIC X.
  7522             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7523         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7524         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7525         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7526             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7527         16  PB-C-AH-CANCEL-DT            PIC XX.
  7528         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7529         16  PB-C-AH-CALC-REQ             PIC X.
  7530             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7531         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7532         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7533         16  PB-C-LAST-NAME               PIC X(15).
  7534         16  PB-C-REFUND-SW               PIC X.
  7535             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7536             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7537         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7538         16  PB-C-PAYEE-CODE              PIC X(6).
  7539         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7540         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7541         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7542         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7543         16  PB-C-REFERENCE               PIC X(12).
  7544         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7545         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7546         16  PB-C-POST-CARD-IND           PIC X.
  7547         16  PB-C-CANCEL-REASON           PIC X.
  7548         16  PB-C-REF-INTERFACE-SW        PIC X.
  7549         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7550         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7551         16  FILLER                       PIC X(01).
  7552*        16  FILLER                       PIC X(18).
  7553         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7554*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7555         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7556         16  PB-CANCELED-CERT-DATA.
  7557             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL689.cbl
  7558                 24  PB-CI-LAST-NAME      PIC X(15).
  7559                 24  PB-CI-INITIALS       PIC XX.
  7560             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7561             20  PB-CI-INSURED-SEX        PIC X.
  7562             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7563             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7564             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7565             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7566             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7567             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7568             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7569             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7570             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7571             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7572             20  PB-CI-RATE-CLASS         PIC XX.
  7573             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7574             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7575             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7576             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7577             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7578             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7579             20  PB-CI-LF-ABBR            PIC X(3).
  7580             20  PB-CI-AH-ABBR            PIC X(3).
  7581             20  PB-CI-OB-FLAG            PIC X.
  7582                 88  PB-CI-OB                VALUE 'B'.
  7583             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7584                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7585                                           'M' '4' '5' '9' '2'.
  7586                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7587                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7588                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7589                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7590                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7591                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  7592                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7593                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7594                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7595                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7596                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7597                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7598                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7599             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7600                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7601                                           'M' '4' '5' '9' '2'.
  7602                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7603                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7604                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7605                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7606                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7607                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  7608                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7609                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7610                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7611                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7612                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7613                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7614                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7615             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL689.cbl
  7616             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7617             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7618             20  PB-CI-MEMBER-NO          PIC X(12).
  7619             20  PB-CI-INT-CODE           PIC X.
  7620                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7621                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7622             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7623             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7624             20  PB-CI-COMP-EXCP-SW       PIC X.
  7625                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7626                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7627             20  PB-CI-ENTRY-STATUS       PIC X.
  7628             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7629             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7630             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7631             20  PB-CI-DEATH-DT           PIC XX.
  7632             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7633             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7634             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7635             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7636             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7637             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7638             20  PB-CI-ENTRY-DT              PIC XX.
  7639             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7640             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7641             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7642             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7643             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7644             20  PB-CI-OLD-LOF               PIC XXX.
  7645*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7646             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7647             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7648             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7649             20  PB-CI-INDV-GRP-CD           PIC X.
  7650             20  PB-CI-BENEFICIARY-NAME.
  7651                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7652                 24  FILLER                  PIC X(15).
  7653             20  PB-CI-NOTE-SW               PIC X.
  7654             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7655             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7656             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7657             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7658             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7659             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7660             20  PB-CI-FIRST-NAME            PIC X(10).
  7661             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7662
  7663         16  FILLER                       PIC X(13).
  7664*032306  16  FILLER                       PIC X(27).
  7665*        16  FILLER                       PIC X(46).
  7666
  7667     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7668         16  FILLER                       PIC X(10).
  7669         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7670         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7671         16  PB-M-INSURED-MID-INIT        PIC X.
  7672         16  PB-M-INSURED-AGE             PIC 99.
  7673         16  PB-M-INSURED-BIRTHDAY        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL689.cbl
  7674         16  PB-M-INSURED-SEX             PIC X.
  7675         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7676         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7677         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  7678         16  PB-M-INSURED-CITY-STATE.
  7679             20  PB-M-INSURED-CITY        PIC X(28).
  7680             20  PB-M-INSURED-STATE       PIC XX.
  7681         16  PB-M-INSURED-ZIP-CODE.
  7682             20  PB-M-INSURED-ZIP-PRIME.
  7683                 24  PB-M-INSURED-ZIP-1   PIC X.
  7684                     88  PB-M-CANADIAN-POST-CODE
  7685                                             VALUE 'A' THRU 'Z'.
  7686                 24  FILLER               PIC X(4).
  7687             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7688         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7689                                        PB-M-INSURED-ZIP-CODE.
  7690             20  PM-M-INS-CAN-POST1       PIC XXX.
  7691             20  PM-M-INS-CAN-POST2       PIC XXX.
  7692             20  FILLER                   PIC XXX.
  7693         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7694         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7695         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7696         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7697         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7698         16  PB-M-CRED-BENE-CITYST.
  7699             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7700             20  PB-M-CRED-BENE-STATE     PIC XX.
  7701         16  FILLER                       PIC X(92).
  7702
  7703     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7704         16  FILLER                       PIC X(10).
  7705         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7706         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7707         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7708         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7709         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7710         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7711         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7712         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7713         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7714         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7715         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7716         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7717         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7718         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7719         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7720         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7721         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7722         16  PB-ACCOUNT-NAME              PIC X(30).
  7723         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7724         16  PB-REFERENCE                 PIC X(12).
  7725         16  PB-B-RECEIVED-DT             PIC XX.
  7726         16  FILLER                       PIC X(234).
  7727
  7728     12  PB-RECORD-STATUS.
  7729         16  PB-CREDIT-SELECT-DT          PIC XX.
  7730         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7731         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL689.cbl
  7732         16  PB-BILLING-STATUS            PIC X.
  7733             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7734             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7735             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  7736         16  PB-RECORD-BILL               PIC X.
  7737             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7738             88  PB-RECORD-RETURNED           VALUE 'R'.
  7739             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7740             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7741             88  PB-OVERRIDE-AH               VALUE 'A'.
  7742             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7743         16  PB-BATCH-ENTRY               PIC X.
  7744             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7745             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7746             88  PB-REISSUED-CERT             VALUE 'E'.
  7747             88  PB-CASH-CERT                 VALUE 'C'.
  7748             88  PB-MONTHLY-CERT              VALUE 'M'.
  7749             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7750             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7751             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7752         16  PB-FORCE-CODE                PIC X.
  7753             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7754             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7755             88  PB-CANCEL-FORCE              VALUE '8'.
  7756             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7757             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7758             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7759             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7760             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7761             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7762             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7763         16  PB-FATAL-FLAG                PIC X.
  7764             88  PB-FATAL-ERRORS              VALUE 'X'.
  7765         16  PB-FORCE-ER-CD               PIC X.
  7766             88  PB-FORCE-ERRORS              VALUE 'F'.
  7767             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7768         16  PB-WARN-ER-CD                PIC X.
  7769             88  PB-WARNING-ERRORS            VALUE 'W'.
  7770         16  FILLER                       PIC X.
  7771         16  PB-OUT-BAL-CD                PIC X.
  7772             88  PB-OUT-OF-BAL                VALUE 'O'.
  7773         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7774         16  PB-AH-OVERRIDE-L1            PIC X.
  7775         16  PB-INPUT-DT                  PIC XX.
  7776         16  PB-INPUT-BY                  PIC X(4).
  7777         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7778         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7779         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7780         16  PB-LF-EARNING-METHOD         PIC X.
  7781         16  PB-AH-EARNING-METHOD         PIC X.
  7782         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7783         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7784         16  PB-REIN-CD                   PIC XXX.
  7785         16  PB-LF-REFUND-TYPE            PIC X.
  7786         16  PB-AH-REFUND-TYPE            PIC X.
  7787         16  PB-ACCT-EFF-DT               PIC XX.
  7788         16  PB-ACCT-EXP-DT               PIC XX.
  7789         16  PB-COMPANY-ID                PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL689.cbl
  7790         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7791         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7792         16  PB-SV-CARRIER                PIC X.
  7793         16  PB-SV-GROUPING               PIC X(6).
  7794         16  PB-SV-STATE                  PIC XX.
  7795         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7796         16  PB-GA-BILLING-INFO.
  7797             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7798                                          PIC XX.
  7799         16  PB-SV-REMIT-TO  REDEFINES
  7800             PB-GA-BILLING-INFO           PIC X(10).
  7801         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7802         16  PB-I-LOAN-OFFICER            PIC X(5).
  7803         16  PB-I-VIN                     PIC X(17).
  7804
  7805         16  FILLER                       PIC X(04).
  7806         16  IMNET-BYPASS-SW              PIC X.
  7807
  7808******************************************************************
  7809*                COMMON EDIT ERRORS                              *
  7810******************************************************************
  7811
  7812     12  PB-COMMON-ERRORS.
  7813         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7814                                           PIC S9(4)     COMP.
  7815
  7816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL689.cbl
  7818*    COPY ERCPYAJ.
  7819******************************************************************
  7820*                                                                *
  7821*                            ERCPYAJ                             *
  7822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7823*                            VMOD=2.015                          *
  7824*                                                                *
  7825*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7826*                                                                *
  7827*                                                                *
  7828*   FILE TYPE = VSAM,KSDS                                        *
  7829*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7830*                                                                *
  7831*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7832*       ALTERNATE PATHS = NONE                                   *
  7833*                                                                *
  7834*   LOG = YES                                                    *
  7835*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7836******************************************************************
  7837******************************************************************
  7838*                   C H A N G E   L O G
  7839*
  7840* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7841*-----------------------------------------------------------------
  7842*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7843* EFFECTIVE    NUMBER
  7844*-----------------------------------------------------------------
  7845* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7846* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7847******************************************************************
  7848
  7849 01  PENDING-PAY-ADJ.
  7850     12  PY-RECORD-ID                     PIC XX.
  7851         88  VALID-PY-ID                        VALUE 'PY'.
  7852
  7853     12  PY-CONTROL-PRIMARY.
  7854         16  PY-COMPANY-CD                PIC X.
  7855         16  PY-CARRIER                   PIC X.
  7856         16  PY-GROUPING                  PIC X(6).
  7857         16  PY-FIN-RESP                  PIC X(10).
  7858         16  PY-ACCOUNT                   PIC X(10).
  7859         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7860                                          PIC X(10).
  7861         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7862         16  PY-RECORD-TYPE               PIC X.
  7863             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7864             88  PY-DEPOSIT                   VALUE 'D'.
  7865             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7866             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7867             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7868             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7869             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7870             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7871             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7872             88  PY-FICA-ENTRY                VALUE 'F'.
  7873             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7874             88  PY-POLICY-FEE                VALUE 'W'.
  7875             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL689.cbl
  7876
  7877     12  PY-PYMT-TYPE                     PIC X.
  7878             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7879             88  PY-REINS-PYMT                VALUE 'R'.
  7880             88  PY-EXP-PYMT                  VALUE 'E'.
  7881
  7882     12  PY-BIL-INV                       PIC X(6).
  7883     12  PY-REF-NO                        PIC X(12).
  7884
  7885     12  PY-LAST-MAINT-DT                 PIC XX.
  7886     12  PY-LAST-MAINT-BY                 PIC X(4).
  7887     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7888
  7889     12  PY-PYADJ-RECORD.
  7890         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7891         16  PY-ENTRY-COMMENT             PIC X(30).
  7892         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7893             20  PY-GL-ACCOUNT            PIC X(10).
  7894             20  PY-GL-STATE              PIC X(02).
  7895             20  PY-GL-CANC-SW            PIC X(01).
  7896                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7897                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7898             20  PY-GL-COMMENT            PIC X(10).
  7899             20  FILLER      REDEFINES PY-GL-COMMENT.
  7900                 24  PY-GL-CHECK-NO       PIC 9(06).
  7901                 24  FILLER               PIC X(04).
  7902             20  FILLER                   PIC X(07).
  7903         16  PY-SAVE-ACCOUNT              PIC X(10).
  7904         16  PY-SAVE-TYPE                 PIC X(01).
  7905
  7906         16  PY-LETTERS.
  7907             20  PY-LETTER OCCURS 3 TIMES
  7908                           INDEXED BY PY-LET-NDX
  7909                                          PIC X(04).
  7910
  7911         16  PY-ERCOMP-TYPE               PIC X.
  7912             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7913             88  PY-GA-TYPE                   VALUE 'G'.
  7914             88  PY-BANK-TYPE                 VALUE 'B'.
  7915         16  FILLER                       PIC X(05).
  7916
  7917     12  PY-RECORD-STATUS.
  7918         16  PY-CREDIT-SELECT-DT          PIC XX.
  7919         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7920         16  PY-BILLED-DATE               PIC XX.
  7921         16  PY-REPORTED-DT               PIC XX.
  7922         16  PY-PMT-APPLIED               PIC X.
  7923             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7924             88  PY-GA-PMT                    VALUE 'G'.
  7925             88  PY-OVWRITE-PMT               VALUE 'O'.
  7926             88  PY-NON-AR-PMT                VALUE 'N'.
  7927         16  FILLER                       PIC X(5).
  7928         16  PY-INPUT-DT                  PIC XX.
  7929         16  PY-CHECK-NUMBER              PIC X(6).
  7930         16  PY-VOID-SW                   PIC X.
  7931             88  PY-CHECK-VOIDED              VALUE 'V'.
  7932         16  PY-CHECK-ORIGIN-SW           PIC X.
  7933             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL689.cbl
  7934             88  PY-REFUND-CHECK              VALUE 'R'.
  7935             88  PY-GA-CHECK                  VALUE 'G'.
  7936             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7937             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7938         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7939         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7940         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7941         16  PY-BILL-FLAG                 PIC X.
  7942             88  PY-BILLED                    VALUE 'B'.
  7943         16  PY-AR-FLAG                   PIC X.
  7944             88  PY-AR-CYCLE                  VALUE 'C'.
  7945             88  PY-AR-MONTH-END              VALUE 'M'.
  7946         16  PY-AR-DATE                   PIC XX.
  7947
  7948     12  PY-GL-CODES.
  7949         16  PY-GL-DB                     PIC X(14).
  7950         16  PY-GL-CR                     PIC X(14).
  7951         16  PY-GL-FLAG                   PIC X.
  7952         16  PY-GL-DATE                   PIC XX.
  7953
  7954     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7955     12  FILLER                           PIC X(3).
  7956******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL689.cbl
  7958*    COPY ELCTEXT.
  7959******************************************************************
  7960*                                                                *
  7961*                                                                *
  7962*                            ELCTEXT.                            *
  7963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7964*                            VMOD=2.008                          *
  7965*                                                                *
  7966*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7967*                                     FORM LETTERS,              *
  7968*                                     CERT FORM DISPLAY.
  7969*                                                                *
  7970*   FILE TYPE = VSAM,KSDS                                        *
  7971*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7972*                                                                *
  7973*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7974*       ALTERNATE INDEX = NONE                                   *
  7975*                                                                *
  7976*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7977*       ALTERNATE INDEX = NONE                                   *
  7978*                                                                *
  7979*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7980*       ALTERNATE INDEX = NONE                                   *
  7981*                                                                *
  7982*   LOG = NO                                                     *
  7983*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7984******************************************************************
  7985 01  TEXT-FILES.
  7986     12  TEXT-FILE-ID                PIC XX.
  7987         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7988         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7989         88  HELP-FILE-TEXT             VALUE 'TH'.
  7990
  7991     12  TX-CONTROL-PRIMARY.
  7992         16  TX-COMPANY-CD           PIC X.
  7993             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7994         16  TX-ACCESS-CD-GENL       PIC X(12).
  7995
  7996         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7997             20  TX-LETTER-NO        PIC X(4).
  7998             20  FILLER              PIC X(8).
  7999
  8000         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8001             20  TX-FORM-NO          PIC X(12).
  8002
  8003         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8004             20  TX-HELP-TYPE        PIC X.
  8005                 88  HELP-FOR-GENERAL   VALUE ' '.
  8006                 88  HELP-BY-SCREEN     VALUE 'S'.
  8007                 88  HELP-BY-ERROR      VALUE 'E'.
  8008             20  TX-SCREEN-OR-ERROR  PIC X(4).
  8009                 88  GENERAL-INFO-HELP  VALUE '0000'.
  8010             20  TX-HELP-FOR-COMPANY  PIC XXX.
  8011                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  8012             20  FILLER              PIC X(4).
  8013
  8014         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  8015
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL689.cbl
  8016     12  TX-PROCESS-CONTROL          PIC XX.
  8017         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  8018
  8019     12  TX-TEXT-LINE                PIC X(70).
  8020
  8021     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  8022         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  8023         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  8024         88  TX-VALID-FORM-SQUEEZE-VALUE
  8025                                        VALUE 'Y' ' '.
  8026
  8027     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  8028         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  8029         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  8030         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  8031         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  8032         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  8033         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  8034         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  8035                                              'K' 'N' ' '
  8036                                              'Z'.
  8037
  8038     12  TX-ARCHIVE-SW               PIC X.
  8039         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  8040         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  8041         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  8042
  8043     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  8044     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  8045
  8046     12  TX-BSR-CODE                 PIC X.
  8047         88  TX-BSR-LETTER              VALUE 'B'.
  8048         88  TX-NON-BSR-LETTER          VALUE ' '.
  8049
  8050     12  FILLER                      PIC X.
  8051*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL689.cbl
  8053*    COPY ERCENDT.
  8054******************************************************************
  8055*                                                                *
  8056*                                                                *
  8057*                            ERCENDT.                            *
  8058*                            VMOD=2.001                          *
  8059*                                                                *
  8060*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  8061*                                                                *
  8062*   FILE TYPE = VSAM,KSDS                                        *
  8063*   RECORD SIZE = 579  RECFORM = FIXED                           *
  8064*                                                                *
  8065*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  8066*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  8067*                                                                *
  8068*   LOG = NO                                                     *
  8069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8070******************************************************************
  8071*-----------------------------------------------------------------
  8072*                   C H A N G E   L O G
  8073*
  8074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8075*-----------------------------------------------------------------
  8076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8077* EFFECTIVE    NUMBER
  8078*-----------------------------------------------------------------
  8079* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  8080*                                WITH OPEN CLAIMS
  8081* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  8082* 110612    2012101700002  AJRA  ADD NEW FIELDS
  8083* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8084*-----------------------------------------------------------------
  8085 01  ENDORSEMENT-RECORD.
  8086     12  EN-RECORD-ID                PIC XX.
  8087         88  VALID-EN-ID                VALUE 'EN'.
  8088     12  EN-CONTROL-PRIMARY.
  8089         16  EN-COMPANY-CD           PIC X.
  8090         16  EN-CARRIER              PIC X.
  8091         16  EN-GROUPING             PIC X(6).
  8092         16  EN-STATE                PIC XX.
  8093         16  EN-ACCOUNT              PIC X(10).
  8094         16  EN-CERT-EFF-DT          PIC XX.
  8095         16  EN-CERT-NO.
  8096             20  EN-CERT-PRIME       PIC X(10).
  8097             20  EN-CERT-SFX         PIC X.
  8098         16  EN-REC-TYPE             PIC X.
  8099             88  EN-ISSUE               VALUE 'I'.
  8100             88  EN-CANCELLATION        VALUE 'C'.
  8101         16  EN-SEQ-NO               PIC 9(04) BINARY.
  8102     12  EN-CONTROL-BY-ARCH-NO.
  8103         16  EN-COMPANY-CD-A1              PIC X.
  8104         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  8105     12  EN-LAST-MAINT-DT            PIC XX.
  8106     12  EN-LAST-MAINT-BY            PIC X(4).
  8107     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  8108     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  8109     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8110         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL689.cbl
  8111         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  8112         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  8113         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  8114         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  8115         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  8116         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  8117         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  8118         16  EN-LF-ORIG-BENCD        PIC XX.
  8119         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  8120         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8121         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8122         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  8123         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  8124         16  EN-LF-ORIG-EXP-DT       PIC XX.
  8125*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  8126         16  EN-ORIG-CRED-BENE       PIC X(25).
  8127         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8128         16  FILLER                  PIC X.
  8129         16  EN-AH-ORIG-BENCD        PIC XX.
  8130         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  8131         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8132         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8133         16  EN-AH-ORIG-EXP-DT       PIC XX.
  8134*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  8135*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  8136         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8137         16  F                       PIC X(09).
  8138         16  EN-AH-ORIG-CP           PIC 99.
  8139         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  8140         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  8141         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  8142         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  8143         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  8144         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  8145         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8146         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8147         16  EN-LF-NEW-BENCD         PIC XX.
  8148         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8149         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8150         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8151         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8152         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8153         16  EN-LF-NEW-EXP-DT        PIC XX.
  8154         16  EN-NEW-CRED-BENE        PIC X(25).
  8155         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8156         16  FILLER                  PIC X.
  8157         16  EN-AH-NEW-BENCD         PIC XX.
  8158         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8159         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8160         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8161         16  EN-AH-NEW-EXP-DT        PIC XX.
  8162*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8163*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8164*        16  F                       PIC X(12).
  8165         16  EN-AH-NEW-CP            PIC 99.
  8166         16  EN-SIG-SW               PIC X.
  8167         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8168         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL689.cbl
  8169         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8170         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8171         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8172         16  FILLER                  PIC X(33).
  8173     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8174         16  EN-LF-ORIG-REF-DT       PIC XX.
  8175         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8176         16  EN-AH-ORIG-REF-DT       PIC XX.
  8177         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8178         16  EN-LF-NEW-REF-DT        PIC XX.
  8179         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8180         16  EN-AH-NEW-REF-DT        PIC XX.
  8181         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8182         16  EN-FLAG-CERT            PIC X.
  8183         16  EN-INS-LAST-NAME        PIC X(15).
  8184         16  EN-INS-FIRST-NAME       PIC X(10).
  8185         16  EN-INS-MIDDLE-INIT      PIC X.
  8186         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8187         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8188         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8189         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8190         16  FILLER                  PIC X(262).
  8191     12  EN-MONEY-SW             PIC X.
  8192     12  EN-HEALTH-APP           PIC X.
  8193     12  EN-VOUCHER-SW           PIC X.
  8194     12  EN-PAYEE                PIC X(14).
  8195     12  EN-INPUT-DT             PIC XX.
  8196     12  EN-PROCESS-DT           PIC XX.
  8197     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8198     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8199     12  EN-REASON-CODES.
  8200         16  F OCCURS 12.
  8201             20  EN-REASON-CODE  PIC X(4).
  8202     12  EN-TEMPLATE-USED        PIC X(8).
  8203     12  EN-DOCU-TYPE            PIC X.
  8204         88  EN-VERI-DOCU          VALUE 'V'.
  8205         88  EN-GCE-DOCU           VALUE 'G'.
  8206         88  EN-CANC-DOCU          VALUE 'C'.
  8207     12  EN-COMMENTS1            PIC X(13).
  8208     12  EN-COMMENTS2            PIC X(70).
  8209     12  EN-COMM-CHGBK           PIC X.
  8210         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8211         88  EN-CHG-ACCT           VALUE 'Y'.
  8212     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8213     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8214     12  EN-BATCH-NUMBER         PIC X(6).
  8215     12  EN-ACCT-SUMM            PIC X.
  8216     12  EN-CSO-SUMM             PIC X.
  8217     12  FILLER                  PIC X(13).
  8218******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL689.cbl
  8220*    COPY ERCNOTE.
  8221******************************************************************
  8222*                                                                *
  8223*                                                                *
  8224*                            ERCNOTE                             *
  8225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8226*                            VMOD=2.003                          *
  8227*                                                                *
  8228*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8229*                                                                *
  8230*        FILE TYPE= VSAM,KSDS                                    *
  8231*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8232*                                                                *
  8233*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  8234*                                                                *
  8235*        LOG = YES                                               *
  8236*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8237*                                                                *
  8238******************************************************************
  8239*                   C H A N G E   L O G
  8240*
  8241* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8242*-----------------------------------------------------------------
  8243*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8244* EFFECTIVE    NUMBER
  8245*-----------------------------------------------------------------
  8246* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8247*                                FILE WILL CONTAIN BILLING NOTES O
  8248******************************************************************
  8249
  8250 01  CERTIFICATE-NOTE.
  8251     12  CN-RECORD-ID                PIC  XX.
  8252         88  VALID-CN-ID                  VALUE 'CN'.
  8253
  8254     12  CN-CONTROL-PRIMARY.
  8255         16  CN-COMPANY-CD           PIC X.
  8256         16  CN-CARRIER              PIC X.
  8257         16  CN-GROUPING.
  8258             20 CN-GROUPING-PREFIX   PIC XXX.
  8259             20 CN-GROUPING-PRIME    PIC XXX.
  8260         16  CN-STATE                PIC XX.
  8261         16  CN-ACCOUNT.
  8262             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8263             20 CN-ACCOUNT-PRIME     PIC X(6).
  8264         16  CN-CERT-EFF-DT          PIC XX.
  8265         16  CN-CERT-NO.
  8266             20  CN-CERT-PRIME       PIC X(10).
  8267             20  CN-CERT-SFX         PIC X.
  8268
  8269     12  CN-BILLING-START-LINE-NO    PIC 99.
  8270     12  CN-BILLING-END-LINE-NO      PIC 99.
  8271
  8272     12  CN-LINES.
  8273         16  CN-LINE OCCURS 10       PIC X(77).
  8274
  8275     12  CN-LAST-MAINT-DT            PIC XX.
  8276     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8277     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL689.cbl
  8278     12  FILLER                      PIC X(6).
  8279******************************************************************
  8280*    COPY ELCEOBC.
  8281******************************************************************
  8282*                                                                *
  8283*                                                                *
  8284*                            ELCEOBC                             *
  8285*                            VMOD=2.001                          *
  8286*                                                                *
  8287*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8288*                                                                *
  8289*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8290*   VSAM EOB CODE TABLE                                          *
  8291*                                                                *
  8292*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8293*                                                                *
  8294*   FILE TYPE = VSAM,KSDS                                        *
  8295*   RECORD SIZE = 350   RECFORM = FIX                            *
  8296*                                                                *
  8297*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8298*                                                                *
  8299*   LOG = NO                                                     *
  8300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8301*                                                                *
  8302*                                                                *
  8303******************************************************************
  8304*                   C H A N G E   L O G
  8305*
  8306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8307*-----------------------------------------------------------------
  8308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8309* EFFECTIVE    NUMBER
  8310*-----------------------------------------------------------------
  8311* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8312* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8313* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  8314******************************************************************
  8315 01  EOB-CODES.
  8316     12  EO-RECORD-ID                      PIC XX.
  8317         88  VALID-DN-ID                      VALUE 'EO'.
  8318     12  EO-CONTROL-PRIMARY.
  8319         16  EO-COMPANY-CD                 PIC X.
  8320         16  EO-RECORD-TYPE                PIC X.
  8321             88  EO-EOB-RECS                  VALUE '1'.
  8322             88  EO-VERIF-RECS                VALUE '2'.
  8323             88  EO-GCE-RECS                  VALUE '3'.
  8324             88  EO-CANC-RECS                 VALUE '4'.
  8325             88  EO-BILL-NOTE-RECS            VALUE '5'.
  8326         16  EO-EOB-CODE                   PIC X(4).
  8327         16  FILLER                        PIC X(9).
  8328     12  EO-MAINT-INFORMATION.
  8329         16  EO-LAST-MAINT-DT              PIC XX.
  8330         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8331         16  EO-LAST-MAINT-USER            PIC X(4).
  8332         16  FILLER                        PIC XX.
  8333     12  EO-DESCRIPTION                    PIC X(275).
  8334     12  FILLER                            PIC X(46).
  8335******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL689.cbl
  8337*    COPY ELCENCC.
  8338******************************************************************
  8339*                                                                *
  8340*                                                                *
  8341*                            ELCENCC                             *
  8342*                            VMOD=2.001                          *
  8343*                                                                *
  8344*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  8345*                                                                *
  8346*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  8347*   A NAPERSOFT DOCUMENT                                         *
  8348*                                                                *
  8349*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  8350*                                                                *
  8351*   FILE TYPE = VSAM,KSDS                                        *
  8352*   RECORD SIZE = 400   RECFORM = FIX                            *
  8353*                                                                *
  8354*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  8355*                                                                *
  8356*   LOG = NO                                                     *
  8357*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8358*                                                                *
  8359*                                                                *
  8360******************************************************************
  8361*                   C H A N G E   L O G
  8362*
  8363* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8364*-----------------------------------------------------------------
  8365*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8366* EFFECTIVE    NUMBER
  8367*-----------------------------------------------------------------
  8368* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  8369******************************************************************
  8370 01  ENCLOSURE-CODES.
  8371     12  NC-RECORD-ID                      PIC XX.
  8372         88  VALID-NC-ID                      VALUE 'NC'.
  8373     12  NC-CONTROL-PRIMARY.
  8374         16  NC-COMPANY-CD                 PIC X.
  8375         16  NC-REC-TYPE                   PIC X.
  8376             88  NC-CLAIMS                   VALUE '1'.
  8377             88  NC-ADMIN                    VALUE '2'.
  8378         16  NC-ENC-CODE                   PIC X(5).
  8379         16  FILLER                        PIC X(09).
  8380     12  NC-MAINT-INFORMATION.
  8381         16  NC-LAST-MAINT-DT              PIC XX.
  8382         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8383         16  NC-LAST-MAINT-USER            PIC X(4).
  8384         16  FILLER                        PIC XX.
  8385     12  NC-OUTPUT-STACK                   PIC XXX.
  8386     12  NC-ENCLOSURE-LINE                 PIC X(100).
  8387     12  NC-ATTACHMENTS                    PIC X(100).
  8388     12  NC-FUTURE                         PIC X(50).
  8389     12  FILLER                            PIC X(117).
  8390******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL689.cbl
  8392 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8393                          ACCOUNT-MASTER LETTER-ARCHIVE
  8394                          LETTER-ARCHIVE-TEXT
  8395                          CERTIFICATE-MASTER CHECK-RECORDS
  8396                          CONTROL-FILE COMPENSATION-MASTER
  8397                          MAILING-DATA PENDING-BUSINESS
  8398                          PENDING-PAY-ADJ TEXT-FILES
  8399                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8400                          EOB-CODES ENCLOSURE-CODES.
  8401 0000-DFHEXIT SECTION.
  8402     MOVE '9#                    $   ' TO DFHEIV0.
  8403     MOVE 'EL689' TO DFHEIV1.
  8404     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8405     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8406
  8407     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8408     MOVE '5'                    TO DC-OPTION-CODE.
  8409     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8410     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8411     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8412                                    W-CURRENT-SAVE.
  8413     MOVE DC-GREG-DATE-A-EDIT    TO W-SAVE-EDIT-A-DATE
  8414     MOVE DC-DAY-OF-WEEK         TO W-SAVE-CYCLE-DAY-OF-WEEK
  8415
  8416     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8417     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8418                                 TO EMI-SAVE-AREA.
  8419
  8420     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8421                                    W-TS-TERM-SCREEN.
  8422
  8423     IF  EIBCALEN EQUAL 0
  8424         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8425         GO TO 8300-SEND-TEXT
  8426     END-IF.
  8427     set P to address of KIXSYS
  8428     CALL "getenv" using by value P returning var-ptr
  8429     if var-ptr = null then
  8430        display ' kixsys not set '
  8431     else
  8432        set address of var to var-ptr
  8433        move 0 to env-var-len
  8434        inspect var tallying env-var-len
  8435          for characters before X'00'
  8436*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8437        unstring var (1:env-var-len) delimited by '/'
  8438           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8439              WS-KIX-SYS
  8440        end-unstring
  8441*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8442*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8443     end-if
  8444     set P to address of KIXHOST
  8445     CALL "getenv" using by value P returning var-ptr
  8446     if var-ptr = null then
  8447        display ' kixhost not set '
  8448     else
  8449        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL689.cbl
  8450        move 0 to env-var-len
  8451        inspect var tallying env-var-len
  8452          for characters before X'00'
  8453*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8454        MOVE var(1:env-var-len)  to ws-kixhost
  8455*       unstring var (1:env-var-len) delimited by '/'
  8456*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8457*             WS-KIX-SYS
  8458*       end-unstring
  8459        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8460*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8461     end-if
  8462
  8463**** This routine will connect to the Logic Database on SQL Server
  8464**** and call a stored procedure to determine the next business da
  8465
  8466     PERFORM 4500-CONNECT-TO-DB  THRU 4500-EXIT
  8467     IF SQLCODE = 0
  8468        PERFORM 4600-GET-NEXT-BUS-DT  THRU 4600-EXIT
  8469        IF SQLCODE = 0
  8470            MOVE WS-NEXT-BUS-DT TO W-SAVE-NEXT-BUS-DT-EDIT-A
  8471                                   W-EDIT-A-DATE
  8472            MOVE W-EDIT-A-YY    TO DC-YMD-YEAR
  8473            MOVE W-EDIT-A-MM    TO DC-YMD-MONTH
  8474            MOVE W-EDIT-A-DD    TO DC-YMD-DAY
  8475            MOVE '3'            TO DC-OPTION-CODE
  8476            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8477            IF NO-CONVERSION-ERROR
  8478               MOVE DC-BIN-DATE-1 TO W-SAVE-BIN-NEXT-BUS-DT
  8479            ELSE
  8480               MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8481               MOVE '6'         TO DC-OPTION-CODE
  8482               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8483               IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8484                  MOVE 3        TO DC-ELAPSED-DAYS
  8485               ELSE
  8486                 IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8487                    MOVE 2     TO DC-ELAPSED-DAYS
  8488                 ELSE
  8489                    MOVE 1     TO DC-ELAPSED-DAYS
  8490                 END-IF
  8491               END-IF
  8492               PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8493               IF NO-CONVERSION-ERROR
  8494                   MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8495                   MOVE DC-GREG-DATE-A-EDIT TO
  8496                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8497               ELSE
  8498                   MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8499                   MOVE W-SAVE-EDIT-A-DATE TO
  8500                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8501               END-IF
  8502            END-IF
  8503        ELSE
  8504            MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8505            MOVE '6'         TO DC-OPTION-CODE
  8506            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8507            IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL689.cbl
  8508               MOVE 3        TO DC-ELAPSED-DAYS
  8509            ELSE
  8510              IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8511                 MOVE 2     TO DC-ELAPSED-DAYS
  8512              ELSE
  8513                 MOVE 1     TO DC-ELAPSED-DAYS
  8514              END-IF
  8515            END-IF
  8516            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8517            IF NO-CONVERSION-ERROR
  8518                MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8519                MOVE DC-GREG-DATE-A-EDIT TO
  8520                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8521            ELSE
  8522                MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8523                MOVE W-SAVE-EDIT-A-DATE TO
  8524                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8525            END-IF
  8526        END-IF
  8527     ELSE
  8528        MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8529        MOVE '6'         TO DC-OPTION-CODE
  8530        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8531        IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8532           MOVE 3        TO DC-ELAPSED-DAYS
  8533        ELSE
  8534          IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8535             MOVE 2     TO DC-ELAPSED-DAYS
  8536          ELSE
  8537             MOVE 1     TO DC-ELAPSED-DAYS
  8538          END-IF
  8539        END-IF
  8540        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8541        IF NO-CONVERSION-ERROR
  8542            MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8543            MOVE DC-GREG-DATE-A-EDIT TO
  8544                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8545        ELSE
  8546            MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8547            MOVE W-SAVE-EDIT-A-DATE TO
  8548                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8549        END-IF
  8550     END-IF
  8551     PERFORM 4700-DISCONNECT THRU 4700-EXIT
  8552
  8553     IF  PI-689-CREATE-NO-SCREENS
  8554         GO TO 0600-BYPASS-SCREEN-CNTL
  8555     END-IF.
  8556
  8557     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8558         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8559             MOVE PI-SAVED-PROGRAM-5
  8560                                 TO PI-SAVED-PROGRAM-6
  8561             MOVE PI-SAVED-PROGRAM-4
  8562                                 TO PI-SAVED-PROGRAM-5
  8563             MOVE PI-SAVED-PROGRAM-3
  8564                                 TO PI-SAVED-PROGRAM-4
  8565             MOVE PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL689.cbl
  8566                                 TO PI-SAVED-PROGRAM-3
  8567             MOVE PI-SAVED-PROGRAM-1
  8568                                 TO PI-SAVED-PROGRAM-2
  8569             MOVE PI-RETURN-TO-PROGRAM
  8570                                 TO PI-SAVED-PROGRAM-1
  8571             MOVE PI-CALLING-PROGRAM
  8572                                 TO PI-RETURN-TO-PROGRAM
  8573             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8574             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8575             MOVE LOW-VALUES     TO EL689AO
  8576             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8577             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8578                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8579             END-IF
  8580             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8581                     AND
  8582                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8583                 GO TO 0400-EL6311-INCOMING
  8584             ELSE
  8585                 MOVE PI-689-ARCHIVE-NUMBER
  8586                                 TO W-INCOMING-ARCHIVE
  8587                 MOVE LOW-VALUES TO PI-1042-WA
  8588                                    PI-689-WORK-AREA
  8589                 MOVE ZEROS      TO PI-CURRENT-LINE
  8590                                    PI-TEMP-STOR-ITEMS
  8591                                    PI-TOTAL-LINES
  8592                                    PI-UPDATE-SW
  8593                                    PI-689-NUMBER-LABEL-LINES
  8594                                    PI-689-NUMBER-TEXT-RECORDS
  8595                                    PI-689-ERROR
  8596                 MOVE SPACES     TO PI-689-PRINT-SW
  8597                                    PI-689-ALT-PRINTER-ID
  8598                                    PI-689-LBL-OVERRIDE
  8599                                    PI-COMM-CONTROL
  8600                                    PI-689-FORM-NUMBER
  8601                                    PI-689-TEMP-STOR-ID
  8602                                    PI-689-LABEL-SOURCE
  8603                                    PI-689-USE-SCREEN-IND
  8604                 MOVE '2'        TO PI-ACTION
  8605                 MOVE -1         TO MAINTL
  8606                 MOVE PI-LOWER-CASE-LETTERS
  8607                                 TO W-LC-CASE-IND
  8608                 IF  W-INCOMING-ARCHIVE NUMERIC
  8609                         AND
  8610                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8611                     MOVE 'S'    TO MAINTI
  8612                     MOVE +1     TO MAINTL
  8613                     MOVE AL-UANON
  8614                                 TO MAINTA
  8615                     MOVE W-INCOMING-ARCH-NO
  8616                                 TO ARCHNUMI
  8617                     MOVE +8     TO ARCHNUML
  8618                     MOVE AL-UNNON
  8619                                 TO ARCHNUMA
  8620                     GO TO 1000-SHOW
  8621                 ELSE
  8622                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8623                 END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL689.cbl
  8624             END-IF
  8625         ELSE
  8626             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8627             MOVE PI-RETURN-TO-PROGRAM
  8628                                     TO PI-CALLING-PROGRAM
  8629             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8630             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8631             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8632             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8633             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8634             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8635             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8636             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8637             MOVE LOW-VALUES         TO EL689AO
  8638             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8639             SET W-RG-NDX            TO PI-CURRENT-LINE
  8640             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8641                 VARYING
  8642                     W-SC-NDX FROM 1 BY 1
  8643                 UNTIL
  8644                     W-SC-NDX GREATER THAN
  8645                     W-NUM-LINES-PER-SCREEN
  8646             MOVE PI-689-ALT-PRINTER-ID
  8647                                     TO PRINTERO
  8648             MOVE AL-UANON           TO PRINTERA
  8649             MOVE -1                 TO PRINTERL
  8650             GO TO 8100-SEND-INITIAL-MAP
  8651         END-IF
  8652     END-IF.
  8653
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL689.cbl
  8655 0200-RECEIVE.
  8656
  8657     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8658     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8659     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8660             OR
  8661         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8662         MOVE 'Y'                TO W-HOLD-IND.
  8663
  8664     MOVE W-TRANSACTION          TO EIBTRNID.
  8665     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8666     MOVE ZEROS                  TO W-LAST-ERROR.
  8667     MOVE LOW-VALUES             TO EL689AI.
  8668     MOVE '104A'                 TO W-TS-ID-TEXT.
  8669     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8670                                    W-TS-TERM-SCREEN.
  8671
  8672
  8673* EXEC CICS HANDLE AID
  8674*        CLEAR    (9300-DFHCLEAR)
  8675*        PA1      (9200-PA)
  8676*        PA2      (9200-PA)
  8677*        PA3      (9200-PA)
  8678*    END-EXEC.
  8679*    MOVE '"&=!"#               V! " #00008575' TO DFHEIV0
  8680     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8681     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8682     MOVE X'2220233030303038353735' TO DFHEIV0(25:11)
  8683     CALL 'kxdfhei1' USING DFHEIV0
  8684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8685
  8686
  8687
  8688* EXEC CICS HANDLE CONDITION
  8689*        PGMIDERR (9700-PGMID-ERROR)
  8690*        ERROR    (9800-ABEND)
  8691*        MAPFAIL  (0325-MAPFAIL)
  8692*    END-EXEC.
  8693*    MOVE '"$L.?                 ! # #00008582' TO DFHEIV0
  8694     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8696     MOVE X'2320233030303038353832' TO DFHEIV0(25:11)
  8697     CALL 'kxdfhei1' USING DFHEIV0
  8698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8699
  8700
  8701
  8702* EXEC CICS SYNCPOINT
  8703*    END-EXEC.
  8704*    MOVE '6"                    !   #00008588' TO DFHEIV0
  8705     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8706     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8707     MOVE X'2020233030303038353838' TO DFHEIV0(25:11)
  8708     CALL 'kxdfhei1' USING DFHEIV0
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8710
  8711
  8712     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL689.cbl
  8713*    IF  W-LC-USE-BOTH-CASES
  8714
  8715* EXEC CICS RECEIVE
  8716*            MAP      (W-MAP)
  8717*            MAPSET   (W-MAPSET)
  8718*            INTO     (EL689AI)
  8719*            ASIS
  8720*        END-EXEC
  8721     MOVE LENGTH OF
  8722      EL689AI
  8723       TO DFHEIV11
  8724*    MOVE '8"TAI  L              ''   #00008593' TO DFHEIV0
  8725     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8726     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8727     MOVE X'2020233030303038353933' TO DFHEIV0(25:11)
  8728     CALL 'kxdfhei1' USING DFHEIV0,
  8729           W-MAP,
  8730           EL689AI,
  8731           DFHEIV11,
  8732           W-MAPSET,
  8733           DFHEIV99,
  8734           DFHEIV99
  8735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8736     ELSE
  8737
  8738* EXEC CICS RECEIVE
  8739*            MAP      (W-MAP)
  8740*            MAPSET   (W-MAPSET)
  8741*            INTO     (EL689AI)
  8742*        END-EXEC.
  8743     MOVE LENGTH OF
  8744      EL689AI
  8745       TO DFHEIV11
  8746*    MOVE '8"T I  L              ''   #00008600' TO DFHEIV0
  8747     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8748     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8749     MOVE X'2020233030303038363030' TO DFHEIV0(25:11)
  8750     CALL 'kxdfhei1' USING DFHEIV0,
  8751           W-MAP,
  8752           EL689AI,
  8753           DFHEIV11,
  8754           W-MAPSET,
  8755           DFHEIV99,
  8756           DFHEIV99
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8758
  8759
  8760     IF  NOT DISPLAY-CAP
  8761         MOVE 'READ'             TO SM-READ
  8762         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8763         MOVE ER-9097            TO EMI-ERROR
  8764         MOVE -1                 TO MAINTL
  8765         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8766         GO TO 8100-SEND-INITIAL-MAP.
  8767
  8768     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8769
  8770     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL689.cbl
  8771         GO TO 0300-CHECK-PFKEYS.
  8772
  8773     IF  EIBAID NOT EQUAL DFHENTER
  8774         MOVE ER-0004            TO EMI-ERROR
  8775         GO TO 0320-INPUT-ERROR.
  8776
  8777     IF  ENTERPFI NUMERIC
  8778             AND
  8779         ENTERPFI GREATER THAN 0
  8780             AND
  8781         ENTERPFI LESS THAN 25
  8782         MOVE PF-VALUES (ENTERPFI)
  8783                                 TO EIBAID
  8784     ELSE
  8785         MOVE ER-0029            TO EMI-ERROR
  8786         GO TO 0320-INPUT-ERROR.
  8787
  8788 0300-CHECK-PFKEYS.
  8789
  8790     IF  EIBAID EQUAL DFHPF23
  8791         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8792         MOVE ZEROS              TO PI-TOTAL-LINES
  8793                                    PI-CURRENT-LINE
  8794         MOVE EIBAID             TO PI-ENTRY-CD-1
  8795         MOVE W-XCTL-005         TO W-CALL-PGM
  8796         GO TO 9400-XCTL.
  8797
  8798     IF  EIBAID EQUAL DFHPF24
  8799         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8800         MOVE ZEROS              TO PI-TOTAL-LINES
  8801                                    PI-CURRENT-LINE
  8802         MOVE W-XCTL-626         TO W-CALL-PGM
  8803         GO TO 9400-XCTL.
  8804
  8805     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8806                                    W-FORM-CHANGED-IND.
  8807
  8808     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8809             OR
  8810         PI-SHOW-MODE
  8811         NEXT SENTENCE
  8812     ELSE
  8813         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8814                 AND
  8815             FORML NOT EQUAL ZEROS
  8816                 AND
  8817             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8818             MOVE FORMI          TO PI-689-FORM-NUMBER
  8819             MOVE LOW-VALUES     TO EL689AI
  8820                                    PI-1042-WA
  8821                                    PI-689-FOLLOW-UP-DATE
  8822                                    PI-689-PRINT-RESTRICTION
  8823                                    PI-689-RESEND-DATE-1
  8824                                    PI-689-RESEND1-EDIT
  8825                                    PI-689-FOLLOW-UP-DATE
  8826                                    PI-689-FOLLOW-UP-EDIT
  8827                                    PI-689-ERROR-IND
  8828             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL689.cbl
  8829                                    PI-689-NUMBER-COPIES
  8830                                    PI-689-NUMBER-LABEL-LINES
  8831                                    PI-689-NUMBER-TEXT-RECORDS
  8832                                    PI-CURRENT-LINE
  8833                                    PI-TEMP-STOR-ITEMS
  8834                                    PI-TOTAL-LINES
  8835                                    PI-UPDATE-SW
  8836             MOVE SPACES         TO PI-689-PRINT-SW
  8837                                    PI-689-ALT-PRINTER-ID
  8838                                    PI-COMM-CONTROL
  8839                                    PI-689-TEMP-STOR-ID
  8840                                    PI-689-USE-SCREEN-IND
  8841                                    PI-689-RESEND-LETR-1
  8842                                    PI-CERT-FORM-ID
  8843                                    PI-CERT-REQ-IND
  8844                                    PI-REASON-REQ-IND
  8845             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8846             MOVE DFHENTER       TO EIBAID
  8847             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8848             GO TO 0330-FUNCTION-CHECK
  8849         ELSE
  8850             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8851                     OR
  8852                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8853                         AND
  8854                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8855                             OR
  8856                         ADDRSI NOT EQUAL LOW-VALUES))
  8857                     OR
  8858                 PI-689-CARRIER NOT EQUAL CARRIERI
  8859                     OR
  8860                 PI-689-GROUPING NOT EQUAL GROUPI
  8861                     OR
  8862                 PI-689-STATE NOT EQUAL STATEI
  8863                     OR
  8864                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8865                     OR
  8866                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8867                     OR
  8868                 PI-689-CERT-SFX NOT EQUAL SFXI
  8869                     OR
  8870                 PI-689-TYPE NOT EQUAL TYPEI
  8871                     OR
  8872                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8873                     OR
  8874                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8875                     OR
  8876                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8877                     OR
  8878                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8879                     OR
  8880                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8881                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8882                 MOVE DFHENTER   TO EIBAID
  8883                 GO TO 0330-FUNCTION-CHECK.
  8884
  8885*    IF  EIBAID EQUAL DFHPF1
  8886*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL689.cbl
  8887*        GO TO 4000-ROLL-PAGE.
  8888
  8889*    IF  EIBAID EQUAL DFHPF2
  8890*        MOVE -7                 TO W-ROLL-COUNTER
  8891*        GO TO 4000-ROLL-PAGE.
  8892
  8893*    IF  EIBAID EQUAL DFHPF3
  8894*        IF  W-HOLD-ON
  8895*            MOVE ER-7245        TO EMI-ERROR
  8896*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8897*            MOVE -1             TO MAINTL
  8898*            MOVE AL-UABON       TO MAINTA
  8899*            GO TO 8200-SEND-DATAONLY
  8900*        ELSE
  8901*            GO TO 0330-FUNCTION-CHECK.
  8902*    IF (EIBAID = DFHPF8)
  8903*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8904*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8905*       MOVE ER-0029             TO EMI-ERROR
  8906*       GO TO 0320-INPUT-ERROR
  8907*    END-IF
  8908*    IF EIBAID = DFHPF4 OR DFHPF8
  8909*        IF  W-HOLD-ON
  8910*            MOVE ER-7245        TO EMI-ERROR
  8911*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8912*            MOVE -1             TO MAINTL
  8913*            MOVE AL-UABON       TO MAINTA
  8914*            GO TO 8200-SEND-DATAONLY
  8915*        ELSE
  8916*            GO TO 0330-FUNCTION-CHECK.
  8917
  8918*    IF  EIBAID = DFHPF5
  8919*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8920*        GO TO 4000-ROLL-PAGE.
  8921
  8922*    IF  EIBAID = DFHPF6
  8923*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8924*        GO TO 4000-ROLL-PAGE.
  8925
  8926     IF  EIBAID EQUAL DFHPF7
  8927         IF PI-PROMPT-IND EQUAL 'Y'
  8928             MOVE ER-0894        TO EMI-ERROR
  8929             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8930             MOVE -1             TO MAINTL
  8931             MOVE AL-UABON       TO MAINTA
  8932             GO TO 8200-SEND-DATAONLY
  8933         END-IF
  8934     END-IF.
  8935
  8936     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8937         IF  W-HOLD-ON
  8938             MOVE ER-7245        TO EMI-ERROR
  8939             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8940             MOVE -1             TO MAINTL
  8941             MOVE AL-UABON       TO MAINTA
  8942             GO TO 8200-SEND-DATAONLY
  8943         ELSE
  8944             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL689.cbl
  8945
  8946     IF  EIBAID EQUAL DFHENTER
  8947         GO TO 0330-FUNCTION-CHECK.
  8948
  8949     MOVE ER-0029                TO EMI-ERROR.
  8950
  8951 0320-INPUT-ERROR.
  8952
  8953     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8954
  8955     IF  ENTERPFL EQUAL 0
  8956         MOVE -1                 TO MAINTL
  8957         MOVE AL-UABON           TO MAINTA
  8958     ELSE
  8959         MOVE AL-UNBON           TO ENTERPFA
  8960         MOVE -1                 TO ENTERPFL.
  8961
  8962     GO TO 8200-SEND-DATAONLY.
  8963
  8964 0325-MAPFAIL.
  8965***********************************************************
  8966*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8967*      LETTERS ON A 3275 PRINTER.                         *
  8968***********************************************************
  8969
  8970     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8971
  8972     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8973     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8974             VARYING
  8975         W-SC-NDX FROM 1 BY 1
  8976             UNTIL
  8977         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8978
  8979     MOVE -1                     TO MAINTL.
  8980     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL689.cbl
  8982 0330-FUNCTION-CHECK.
  8983
  8984     IF  MAINTI EQUAL 'S'
  8985*        IF EIBAID = DFHPF4 OR DFHPF8
  8986*            GO TO 7900-PRINT-LETTER-NOW
  8987*        ELSE
  8988             GO TO 1000-SHOW.
  8989
  8990     IF  NOT MODIFY-CAP
  8991         MOVE 'UPDATE'           TO SM-READ
  8992         PERFORM 9995-SECURITY-VIOLATION
  8993         MOVE ER-0070            TO EMI-ERROR
  8994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8995         MOVE -1                 TO MAINTL
  8996         GO TO 8100-SEND-INITIAL-MAP.
  8997
  8998     IF  W-FORM-CHANGED
  8999             OR
  9000         W-KEY-FIELDS-CHANGED
  9001         GO TO 0330-EDIT.
  9002
  9003     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9004
  9005
  9006*    IF  EIBAID EQUAL DFHPF3
  9007*        IF  PI-NO-CARRIER-SECURITY
  9008*                AND
  9009*            PI-NO-ACCOUNT-SECURITY
  9010*            GO TO 5000-EDIT-MODE.
  9011
  9012     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  9013         IF  PI-NO-CARRIER-SECURITY
  9014                 AND
  9015             PI-NO-ACCOUNT-SECURITY
  9016             GO TO 5400-LETTER-RELEASE
  9017         ELSE
  9018             IF  PI-689-PRINT-PERFORMED
  9019                 GO TO 5400-LETTER-RELEASE
  9020             ELSE
  9021                 MOVE AL-UNBON TO ENTERPFA
  9022                 MOVE -1       TO ENTERPFL
  9023                 MOVE ER-2398  TO EMI-ERROR
  9024                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9025                 GO TO 8200-SEND-DATAONLY.
  9026
  9027*    IF  EIBAID = DFHPF4 OR DFHPF8
  9028*        GO TO 7900-PRINT-LETTER-NOW.
  9029
  9030 0330-EDIT.
  9031
  9032     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  9033             OR
  9034         W-SC-TEXTL (2) NOT EQUAL ZEROS
  9035             OR
  9036         W-SC-TEXTL (3) NOT EQUAL ZEROS
  9037             OR
  9038         W-SC-TEXTL (4) NOT EQUAL ZEROS
  9039             OR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL689.cbl
  9040         W-SC-TEXTL (5) NOT EQUAL ZEROS
  9041             OR
  9042         W-SC-TEXTL (6) NOT EQUAL ZEROS
  9043             OR
  9044         W-SC-TEXTL (7) NOT EQUAL ZEROS
  9045             OR
  9046         W-SC-TEXTL (8) NOT EQUAL ZEROS
  9047             OR
  9048         W-SC-TEXTL (9) NOT EQUAL ZEROS
  9049             OR
  9050         W-SC-TEXTL (10) NOT EQUAL ZEROS
  9051             OR
  9052         W-SC-TEXTL (11) NOT EQUAL ZEROS
  9053         IF  W-KEY-FIELDS-CHANGED
  9054                 OR
  9055             W-FORM-CHANGED
  9056             MOVE ER-7250        TO EMI-ERROR
  9057             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9058             MOVE -1             TO MAINTL
  9059             MOVE AL-UABON       TO MAINTA
  9060         ELSE
  9061             PERFORM 4100-SET-NDX THRU 4100-EXIT
  9062             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  9063                     VARYING
  9064                 W-SC-NDX FROM 1 BY 1
  9065                     UNTIL
  9066                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  9067             MOVE ER-7398        TO EMI-ERROR
  9068             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9069             MOVE -1             TO MAINTL
  9070             MOVE AL-UABON       TO MAINTA
  9071             GO TO 8200-SEND-DATAONLY.
  9072
  9073     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9074
  9075     IF  W-KEY-FIELDS-CHANGED
  9076             OR
  9077         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  9078         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9079         IF  MAINTI EQUAL 'C'
  9080             GO TO 2000-CREATE
  9081         ELSE
  9082             NEXT SENTENCE
  9083     ELSE
  9084         IF  W-FORM-CHANGED
  9085             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9086             IF  MAINTI EQUAL 'C'
  9087                 GO TO 2000-CREATE
  9088             ELSE
  9089                 NEXT SENTENCE
  9090         ELSE
  9091             MOVE -1             TO MAINTL
  9092             GO TO 8200-SEND-DATAONLY.
  9093
  9094     MOVE ER-0023                TO EMI-ERROR.
  9095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9096     MOVE -1                     TO MAINTL.
  9097     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL689.cbl
  9098     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL689.cbl
  9100 0350-EDIT-ROUTINE.
  9101
  9102     IF  MAINTI EQUAL 'C'
  9103             AND
  9104         FORML EQUAL ZEROS
  9105         MOVE -1                 TO FORML
  9106         MOVE ER-0177            TO EMI-ERROR
  9107         MOVE AL-UABON           TO FORMA
  9108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9109
  9110     IF PRTNOWL > ZEROS
  9111        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  9112           MOVE PRTNOWI          TO PI-PRINT-NOW
  9113           MOVE AL-UANON         TO PRTNOWA
  9114        END-IF
  9115     END-IF
  9116     IF ENDARCHL > ZEROS
  9117        IF ENDARCHI NUMERIC
  9118            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  9119            MOVE AL-UNNON       TO ENDARCHA
  9120            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  9121            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  9122            MOVE 'N'            TO W-VALID-ENDT-SW
  9123            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  9124            IF NOT W-VALID-ENDT
  9125                MOVE -1         TO ENDARCHL
  9126                MOVE ER-1565    TO EMI-ERROR
  9127                MOVE AL-UNBON   TO ENDARCHA
  9128                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9129            END-IF
  9130        END-IF
  9131     ELSE
  9132        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  9133     END-IF
  9134     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  9135*    IF  PRTRESTL NOT EQUAL ZEROS
  9136*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  9137
  9138     IF  FOLLOWL NOT EQUAL ZEROS
  9139         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  9140         PERFORM 8600-DEEDIT
  9141         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9142         MOVE '4'                TO DC-OPTION-CODE
  9143         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9144         IF  DATE-CONVERSION-ERROR
  9145             MOVE ER-0182        TO EMI-ERROR
  9146             MOVE -1             TO FOLLOWL
  9147             MOVE AL-UABON       TO FOLLOWA
  9148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9149         ELSE
  9150             MOVE DC-GREG-DATE-1-EDIT
  9151                                 TO FOLLOWO
  9152                                    PI-689-FOLLOW-UP-EDIT
  9153             MOVE AL-UANON       TO FOLLOWA
  9154             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  9155     ELSE
  9156         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  9157
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL689.cbl
  9158     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  9159         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  9160                 W-SAVE-BIN-DATE
  9161             MOVE ER-0533        TO EMI-ERROR
  9162             MOVE AL-UABON       TO FOLLOWA
  9163             MOVE -1             TO FOLLOWL
  9164             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9165
  9166     IF  RESEND1L NOT EQUAL ZEROS
  9167         MOVE RESEND1I           TO W-DEEDIT-FIELD
  9168         PERFORM 8600-DEEDIT
  9169         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9170         MOVE '4'                TO DC-OPTION-CODE
  9171         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9172         IF  DATE-CONVERSION-ERROR
  9173             MOVE ER-0185        TO EMI-ERROR
  9174             MOVE -1             TO RESEND1L
  9175             MOVE AL-UABON       TO RESEND1A
  9176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9177         ELSE
  9178             MOVE DC-GREG-DATE-1-EDIT
  9179                                 TO RESEND1O
  9180                                    PI-689-RESEND1-EDIT
  9181             MOVE AL-UANON       TO RESEND1A
  9182             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  9183     ELSE
  9184         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  9185
  9186     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  9187         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  9188                 W-SAVE-BIN-DATE
  9189             MOVE ER-0537        TO EMI-ERROR
  9190             MOVE AL-UABON       TO RESEND1A
  9191             MOVE -1             TO RESEND1L
  9192             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9193
  9194     IF ENCL > ZEROS
  9195        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  9196                                          PI-ENCLOSURE-CD
  9197        MOVE SPACES             TO W-ELENCC-KEY
  9198        MOVE PI-COMPANY-CD      TO W-ENCC-COMPANY-CD
  9199        MOVE '2'                TO W-ENCC-REC-TYPE
  9200        MOVE ENCI               TO W-ENCC-ENC-CODE
  9201
  9202
  9203* EXEC CICS READ
  9204*           DATASET    (W-ENCC-FILE-ID)
  9205*           SET        (ADDRESS OF ENCLOSURE-CODES)
  9206*           RIDFLD     (W-ELENCC-KEY)
  9207*           RESP       (W-RESPONSE)
  9208*       END-EXEC
  9209*    MOVE '&"S        E          (  N#00009048' TO DFHEIV0
  9210     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9212     MOVE X'204E233030303039303438' TO DFHEIV0(25:11)
  9213     CALL 'kxdfhei1' USING DFHEIV0,
  9214           W-ENCC-FILE-ID,
  9215           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL689.cbl
  9216           DFHEIV99,
  9217           W-ELENCC-KEY,
  9218           DFHEIV99,
  9219           DFHEIV99,
  9220           DFHEIV99
  9221     SET ADDRESS OF ENCLOSURE-CODES TO
  9222         DFHEIV20
  9223     MOVE EIBRESP  TO W-RESPONSE
  9224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9225
  9226        IF RESP-NORMAL
  9227           MOVE ENCI             TO PI-ENCLOSURE-CD
  9228                                    W-ENCLOSURE-CD
  9229           MOVE AL-UANON         TO ENCA
  9230        ELSE
  9231           MOVE ER-1560          TO EMI-ERROR
  9232           MOVE -1               TO ENCL
  9233           MOVE AL-UABON         TO ENCA
  9234           PERFORM 9900-ERROR-FORMAT
  9235                                 THRU 9900-EXIT
  9236        END-IF
  9237     END-IF
  9238
  9239
  9240     IF NOT PI-CREATE-LABELS
  9241         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  9242         MOVE AL-PANON           TO ADDRLBLA
  9243         GO TO 0350-BYPASS-OVERRIDE.
  9244
  9245     IF  ADDRLBLL GREATER THAN ZEROS
  9246          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9247          IF ADDRLBLI = 'N' OR 'Y'
  9248              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  9249              MOVE AL-UANON      TO ADDRLBLA
  9250          ELSE
  9251             MOVE ER-3783        TO EMI-ERROR
  9252             MOVE -1             TO ADDRLBLL
  9253             MOVE AL-UABON       TO ADDRLBLA
  9254             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9255
  9256 0350-BYPASS-OVERRIDE.
  9257
  9258     IF  PI-BYPASS-LABELS
  9259             OR
  9260         FORMI EQUAL '9999'
  9261             OR
  9262         PI-689-LABELS-OVERRIDEN
  9263         MOVE SPACES             TO PI-689-LABEL-SOURCE
  9264         MOVE LOW-VALUES         TO ADDRSI
  9265         MOVE AL-UANOF           TO ADDRSA
  9266         MOVE ZEROS              TO ADDRSL
  9267     ELSE
  9268         IF  ADDRSL GREATER THAN ZEROS
  9269             MOVE ADDRSI         TO W-LABEL-SOURCE
  9270             IF  W-LABEL-SOURCE-VALID
  9271                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  9272             ELSE
  9273                 MOVE -1         TO ADDRSL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL689.cbl
  9274                 MOVE ER-0176    TO EMI-ERROR
  9275                 MOVE AL-UABON   TO ADDRSA
  9276                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9277         ELSE
  9278             IF  MAINTI EQUAL 'C'
  9279                 MOVE -1         TO ADDRSL
  9280                 MOVE ER-0176    TO EMI-ERROR
  9281                 MOVE AL-UABON   TO ADDRSA
  9282                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9283
  9284     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9285     IF  PRINTERL GREATER ZERO
  9286         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9287         MOVE AL-UANON           TO PRINTERA
  9288         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  9289                                    PI-ALT-DMD-PRT-ID
  9290     ELSE
  9291         IF  PI-NO-CARRIER-SECURITY
  9292                 AND
  9293             PI-NO-ACCOUNT-SECURITY
  9294             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  9295                 MOVE PI-PROCESSOR-PRINTER
  9296                                 TO PI-689-ALT-PRINTER-ID
  9297                                    PRINTERI
  9298                 MOVE AL-UABON   TO PRINTERA
  9299             ELSE
  9300                 MOVE PI-COMPANY-ID
  9301                                 TO W-CNTL-COMPANY-ID
  9302                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  9303                 MOVE SPACES     TO W-CNTL-GENL
  9304                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  9305
  9306* EXEC CICS HANDLE CONDITION
  9307*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  9308*                     NOTFND     (7945-NOT-FOUND)
  9309*                END-EXEC
  9310*    MOVE '"$JI                  ! $ #00009134' TO DFHEIV0
  9311     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9313     MOVE X'2420233030303039313334' TO DFHEIV0(25:11)
  9314     CALL 'kxdfhei1' USING DFHEIV0
  9315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9316
  9317* EXEC CICS READ
  9318*                     DATASET    (W-CNTL-FILE-ID)
  9319*                     SET        (ADDRESS OF CONTROL-FILE)
  9320*                     RIDFLD     (W-CNTL-KEY)
  9321*                END-EXEC
  9322*    MOVE '&"S        E          (   #00009138' TO DFHEIV0
  9323     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9325     MOVE X'2020233030303039313338' TO DFHEIV0(25:11)
  9326     CALL 'kxdfhei1' USING DFHEIV0,
  9327           W-CNTL-FILE-ID,
  9328           DFHEIV20,
  9329           DFHEIV99,
  9330           W-CNTL-KEY,
  9331           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL689.cbl
  9332           DFHEIV99,
  9333           DFHEIV99
  9334     SET ADDRESS OF CONTROL-FILE TO
  9335         DFHEIV20
  9336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9337                 MOVE CF-FORMS-PRINTER-ID
  9338                                 TO PI-689-ALT-PRINTER-ID
  9339                                    PRINTERI
  9340                                    W-TS-TERM-TEXT
  9341                 MOVE AL-UABON   TO PRINTERA
  9342         ELSE
  9343             MOVE AL-UABON       TO PRINTERA
  9344             MOVE -1             TO PRINTERL
  9345             MOVE ER-9283        TO EMI-ERROR
  9346             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9347
  9348     IF  COPIESL NOT EQUAL ZEROS
  9349         IF  COPIESI NOT NUMERIC
  9350                 OR
  9351             COPIESI EQUAL '0'
  9352             MOVE ER-0184        TO EMI-ERROR
  9353             MOVE -1             TO COPIESL
  9354             MOVE AL-UABON       TO COPIESA
  9355             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9356         ELSE
  9357             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  9358             MOVE AL-UANON       TO COPIESA
  9359     ELSE
  9360         IF FORMI EQUAL '9999'
  9361             MOVE 1              TO PI-689-NUMBER-COPIES
  9362                                    COPIESL
  9363                                    COPIESO.
  9364
  9365     IF  FORML NOT EQUAL ZEROS
  9366         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9367         MOVE FORMI              TO PI-689-FORM-NUMBER.
  9368
  9369     MOVE SPACES                 TO W-HOLD-IND.
  9370
  9371     IF PI-CERT-REQ-IND = 'Y'
  9372       IF  CERTIDL NOT EQUAL ZEROS
  9373         IF CERTIDI NUMERIC
  9374             MOVE AL-UANON      TO CERTIDA
  9375             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9376         ELSE
  9377             MOVE ER-1778       TO EMI-ERROR
  9378             MOVE -1            TO CERTIDL
  9379             MOVE AL-UABON      TO CERTIDA
  9380             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9381         END-IF
  9382       ELSE
  9383          MOVE ER-0715       TO EMI-ERROR
  9384          MOVE -1            TO CERTIDL
  9385          MOVE AL-UABON      TO CERTIDA
  9386          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9387       END-IF
  9388     END-IF.
  9389
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL689.cbl
  9390     IF PI-REASON-REQ-IND = 'Y'
  9391        IF PI-ENDT-ARCH-NO NOT > ZERO
  9392          MOVE ER-9840       TO EMI-ERROR
  9393          MOVE -1            TO FORML
  9394          MOVE AL-UABON      TO FORMA
  9395          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9396        END-IF
  9397     END-IF.
  9398
  9399     IF  NOT EMI-NO-ERRORS
  9400         IF  EMI-ERROR EQUAL ER-7250
  9401             GO TO 0350-EXIT
  9402         ELSE
  9403            MOVE -1             TO MAINTL
  9404            GO TO 8200-SEND-DATAONLY.
  9405
  9406 0350-EXIT.
  9407      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL689.cbl
  9409 0355-CHECK-ERENDT.
  9410
  9411*     EXEC CICS GETMAIN
  9412*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9413*          LENGTH   (W-ENDT-LENGTH)
  9414*     END-EXEC
  9415
  9416
  9417* EXEC CICS READ
  9418*         DATASET    ('ERENDT2')
  9419*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9420*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9421*         RESP       (W-RESPONSE)
  9422*    END-EXEC
  9423     MOVE 'ERENDT2' TO DFHEIV1
  9424*    MOVE '&"S        E          (  N#00009222' TO DFHEIV0
  9425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9427     MOVE X'204E233030303039323232' TO DFHEIV0(25:11)
  9428     CALL 'kxdfhei1' USING DFHEIV0,
  9429           DFHEIV1,
  9430           DFHEIV20,
  9431           DFHEIV99,
  9432           W-ERENDT-KEY-BY-ARCH,
  9433           DFHEIV99,
  9434           DFHEIV99,
  9435           DFHEIV99
  9436     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9437         DFHEIV20
  9438     MOVE EIBRESP  TO W-RESPONSE
  9439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9440
  9441     IF (RESP-NORMAL)
  9442         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9443            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9444            EN-CARRIER     =  PI-689-CARRIER     AND
  9445            EN-GROUPING    =  PI-689-GROUPING    AND
  9446            EN-STATE       =  PI-689-STATE       AND
  9447            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9448            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9449            EN-CERT-NO     =  PI-689-CERT-NO
  9450               SET W-VALID-ENDT TO TRUE
  9451         END-IF
  9452         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9453            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9454            EN-CARRIER     =  PI-CARRIER         AND
  9455            EN-GROUPING    =  PI-GROUPING        AND
  9456            EN-STATE       =  PI-STATE           AND
  9457            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9458            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9459            EN-CERT-NO     =  PI-CERT-NO
  9460               SET W-VALID-ENDT TO TRUE
  9461         END-IF
  9462     END-IF
  9463      .
  9464
  9465 0355-EXIT.
  9466      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL689.cbl
  9468 0360-EDIT-PRINT-RESTRICTIONS.
  9469
  9470*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9471*                                TO W-UPPER-CASE.
  9472*
  9473*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9474*                                     OR 'P' OR LOW-VALUES)
  9475*            AND
  9476*        PRTRESTI EQUAL 'C'
  9477*            AND
  9478*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9479*        MOVE ER-7243            TO EMI-ERROR
  9480*        MOVE -1                 TO PRTRESTL
  9481*        MOVE AL-UABON           TO PRTRESTA
  9482*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9483*        GO TO 0360-EXIT.
  9484*
  9485*    IF  PRTRESTL NOT EQUAL ZEROS
  9486*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9487*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9488*            MOVE AL-UANON       TO PRTRESTA
  9489*        ELSE
  9490*            IF  PRTRESTI EQUAL ' '
  9491*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9492*                MOVE AL-UANON   TO PRTRESTA
  9493*            ELSE
  9494*                MOVE ER-7393    TO EMI-ERROR
  9495*                MOVE -1         TO PRTRESTL
  9496*                MOVE AL-UABON   TO PRTRESTA
  9497*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9498*
  9499*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9500*            AND
  9501*        W-HOLD-ON
  9502*            AND
  9503*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9504*        MOVE ER-7243            TO EMI-ERROR
  9505*        MOVE -1                 TO PRTRESTL
  9506*        MOVE AL-UABON           TO PRTRESTA
  9507*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9508     .
  9509 0360-EXIT.
  9510      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL689.cbl
  9512 0400-EL6311-INCOMING.
  9513
  9514     MOVE ZEROS                  TO PI-CURRENT-LINE
  9515                                    PI-TEMP-STOR-ITEMS
  9516                                    PI-TOTAL-LINES
  9517                                    PI-UPDATE-SW
  9518                                    PI-689-NUMBER-LABEL-LINES
  9519                                    PI-689-ERROR
  9520                                    PI-689-NUMBER-TEXT-RECORDS.
  9521     MOVE SPACES                 TO PI-689-PRINT-SW
  9522                                    PI-689-ALT-PRINTER-ID
  9523                                    PI-COMM-CONTROL
  9524                                    PI-689-FORM-NUMBER
  9525                                    PI-689-TEMP-STOR-ID
  9526                                    PI-689-LABEL-SOURCE
  9527                                    PI-689-USE-SCREEN-IND.
  9528
  9529     IF PI-CREATE-LABELS
  9530         MOVE  AL-UANON          TO ADDRLBLA
  9531         MOVE  +1                TO ADDRLBLL.
  9532
  9533     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9534                                    PI-689-LBL-OVERRIDE.
  9535
  9536     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9537     MOVE '2'                    TO PI-ACTION.
  9538     MOVE -1                     TO MAINTL.
  9539
  9540     MOVE AL-UANON               TO PRTNOWA.
  9541     MOVE +1                     TO PRTNOWL.
  9542     MOVE 'N'                    TO PRTNOWI
  9543                                    PI-PRINT-NOW.
  9544
  9545     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9546         MOVE AL-UANON           TO CARRIERA
  9547         MOVE +1                 TO CARRIERL
  9548         MOVE PI-689-CARRIER     TO CARRIERI.
  9549
  9550     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9551         MOVE +6                 TO GROUPL
  9552         MOVE AL-UANON           TO GROUPA
  9553         MOVE PI-689-GROUPING    TO GROUPI.
  9554
  9555     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9556         MOVE +2                 TO STATEL
  9557         MOVE AL-UANON           TO STATEA
  9558         MOVE PI-689-STATE       TO STATEI.
  9559
  9560     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9561         MOVE +10                TO ACCTL
  9562         MOVE AL-UANON           TO ACCTA
  9563         MOVE PI-689-ACCOUNT     TO ACCTI.
  9564
  9565     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9566         MOVE +10                TO CERTL
  9567         MOVE AL-UANON           TO CERTA
  9568         MOVE PI-689-CERT-PRIME  TO CERTI.
  9569
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL689.cbl
  9570     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9571         MOVE +1                 TO SFXL
  9572         MOVE AL-UANON           TO SFXA
  9573         MOVE PI-689-CERT-SFX    TO SFXI.
  9574
  9575     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9576         MOVE +6                 TO BENTRYL
  9577         MOVE AL-UANON           TO BENTRYA
  9578         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9579
  9580     MOVE +4                     TO BCSEQL.
  9581     MOVE AL-UANON               TO BCSEQA.
  9582     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9583
  9584     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9585         MOVE +8                 TO SEQL
  9586         MOVE AL-UANON           TO SEQA
  9587         MOVE PI-689-SEQ-NO      TO SEQI.
  9588
  9589     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9590         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9591         MOVE ' '                TO DC-OPTION-CODE
  9592         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9593         MOVE +8                 TO DATEL
  9594         MOVE DC-GREG-DATE-1-EDIT
  9595                                 TO DATEI
  9596         MOVE AL-UANON           TO DATEA.
  9597
  9598     MOVE -1                     TO MAINTL.
  9599     MOVE '4'                    TO DATASORI
  9600                                    PI-689-DATA-SOURCE.
  9601     MOVE +1                     TO DATASORL.
  9602     MOVE AL-UANON               TO DATASORA.
  9603
  9604     GO TO 8100-SEND-INITIAL-MAP.
  9605
  9606 0400-EXIT.
  9607      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL689.cbl
  9609 0450-SPECIAL-INPUT-PROCESS.
  9610
  9611     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9612             AND
  9613         PI-CARRIER GREATER THAN LOW-VALUES
  9614         MOVE '1'                TO DATASORI
  9615                                    PI-689-DATA-SOURCE
  9616         MOVE PI-CARRIER         TO CARRIERI
  9617         MOVE PI-GROUPING        TO GROUPI
  9618         MOVE PI-STATE           TO STATEI
  9619         MOVE PI-ACCOUNT         TO ACCTI
  9620         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9621         MOVE ' '                TO DC-OPTION-CODE
  9622         PERFORM 9500-LINK-DATE-CONVERT
  9623             THRU 9500-EXIT
  9624         MOVE DC-GREG-DATE-1-EDIT
  9625                                 TO DATEI
  9626         MOVE 'N'                TO PRTNOWI
  9627                                    PI-PRINT-NOW
  9628         MOVE AL-UANON           TO ACCTA
  9629                                    CARRIERA
  9630                                    DATEA
  9631                                    DATASORA
  9632                                    GROUPA
  9633                                    STATEA
  9634                                    PRTNOWA
  9635         MOVE +1                 TO CARRIERL
  9636                                    DATASORL
  9637                                    PRTNOWL
  9638         MOVE -1                 TO MAINTL
  9639         MOVE +6                 TO GROUPL
  9640         MOVE +2                 TO STATEL
  9641         MOVE +8                 TO DATEL
  9642         MOVE +10                TO ACCTL
  9643     ELSE
  9644         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9645                 AND
  9646             PI-CARRIER GREATER THAN LOW-VALUES
  9647             MOVE '3'            TO DATASORI
  9648                                    PI-689-DATA-SOURCE
  9649             MOVE PI-CR-CARRIER  TO CARRIERI
  9650             MOVE PI-CR-GROUPING TO GROUPI
  9651             MOVE PI-CR-ACCOUNT  TO ACCTI
  9652             MOVE PI-CR-FIN-RESP TO RPERSONI
  9653             MOVE PI-CR-TYPE     TO TYPEI
  9654             MOVE 'N'            TO PRTNOWI
  9655                                    PI-PRINT-NOW
  9656             MOVE AL-UANON       TO CARRIERA
  9657                                    GROUPA
  9658                                    ACCTA
  9659                                    DATASORA
  9660                                    RPERSONA
  9661                                    TYPEA
  9662                                    PRTNOWA
  9663             MOVE +1             TO CARRIERL
  9664                                    DATASORL
  9665                                    TYPEL
  9666                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL689.cbl
  9667             MOVE -1             TO MAINTL
  9668             MOVE +6             TO GROUPL
  9669             MOVE +10            TO ACCTL
  9670                                    RPERSONL
  9671         ELSE
  9672             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9673                     AND
  9674                 PI-CARRIER GREATER THAN LOW-VALUES
  9675                 MOVE '2'        TO DATASORI
  9676                                    PI-689-DATA-SOURCE
  9677                 MOVE PI-CARRIER TO CARRIERI
  9678                 MOVE PI-GROUPING
  9679                                 TO GROUPI
  9680                 MOVE PI-STATE   TO STATEI
  9681                 MOVE PI-ACCOUNT TO ACCTI
  9682                 MOVE PI-CERT-PRIME
  9683                                 TO CERTI
  9684                 MOVE PI-CERT-SFX
  9685                                 TO SFXI
  9686                 MOVE PI-CERT-EFF-DT
  9687                                 TO DC-BIN-DATE-1
  9688                 MOVE ' '        TO DC-OPTION-CODE
  9689                 PERFORM 9500-LINK-DATE-CONVERT
  9690                     THRU 9500-EXIT
  9691                 MOVE DC-GREG-DATE-1-EDIT
  9692                                 TO DATEI
  9693                 MOVE 'N'        TO PRTNOWI
  9694                                    PI-PRINT-NOW
  9695                 MOVE AL-UANON   TO CARRIERA
  9696                                    GROUPA
  9697                                    STATEA
  9698                                    ACCTA
  9699                                    CERTA
  9700                                    SFXA
  9701                                    DATEA
  9702                                    ADDRSA
  9703                                    DATASORA
  9704                                    PRTNOWA
  9705                 MOVE +1         TO CARRIERL
  9706                                    SFXL
  9707                                    DATASORL
  9708                                    ADDRSL
  9709                                    PRTNOWL
  9710                 MOVE -1         TO MAINTL
  9711                 MOVE +6         TO GROUPL
  9712                 MOVE +2         TO STATEL
  9713                 MOVE +8         TO DATEL
  9714                 MOVE +10        TO ACCTL
  9715                                    CERTL.
  9716
  9717     IF PI-CREATE-LABELS
  9718         MOVE  AL-UANON          TO ADDRLBLA
  9719         MOVE  +1                TO ADDRLBLL.
  9720
  9721     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9722                                    PI-689-LBL-OVERRIDE.
  9723
  9724     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL689.cbl
  9725     GO TO 8100-SEND-INITIAL-MAP.
  9726
  9727 0450-EXIT.
  9728      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL689.cbl
  9730 0600-BYPASS-SCREEN-CNTL.
  9731***************************************************************
  9732*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9733*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9734*     PERFORMING ANY SCREEN IO.                               *
  9735***************************************************************
  9736
  9737
  9738* EXEC CICS HANDLE CONDITION
  9739*        PGMIDERR (9700-PGMID-ERROR)
  9740*        MAPFAIL  (0325-MAPFAIL)
  9741*        ERROR    (9800-ABEND)
  9742*    END-EXEC.
  9743*    MOVE '"$L?.                 ! % #00009525' TO DFHEIV0
  9744     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9746     MOVE X'2520233030303039353235' TO DFHEIV0(25:11)
  9747     CALL 'kxdfhei1' USING DFHEIV0
  9748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9749
  9750
  9751     MOVE LOW-VALUES             TO EL689AI.
  9752
  9753     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9754
  9755     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9756     MOVE +4                     TO FORML.
  9757
  9758     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9759         MOVE PI-689-NUMBER-COPIES
  9760                                 TO COPIESI
  9761         MOVE +1                 TO COPIESL.
  9762
  9763     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9764     MOVE +1                     TO ADDRSL.
  9765     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9766     MOVE +1                     TO DATASORL.
  9767
  9768*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9769*        MOVE PI-689-PRINT-RESTRICTION
  9770*                                TO PRTRESTI
  9771*        MOVE +1                 TO PRTRESTL.
  9772
  9773     MOVE SPACES                 TO PI-689-PRINT-SW
  9774                                    PI-689-LBL-OVERRIDE.
  9775     MOVE ZEROS                  TO PI-TOTAL-LINES
  9776                                    PI-CURRENT-LINE
  9777                                    PI-TEMP-STOR-ITEMS
  9778                                    PI-UPDATE-SW
  9779                                    PI-689-ERROR
  9780                                    PI-689-NUMBER-LABEL-LINES
  9781                                    PI-689-NUMBER-TEXT-RECORDS.
  9782
  9783     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9784         MOVE +4                 TO PRINTERL
  9785         MOVE PI-689-ALT-PRINTER-ID
  9786                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9787
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL689.cbl
  9788     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9789
  9790     IF  PI-689-SOURCE-VARIABLE
  9791         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9792
  9793     MOVE SPACES                 TO W-CNTL-KEY
  9794     MOVE LOW-VALUES             TO W-ACCT-KEY
  9795                                    W-CERT-KEY
  9796                                    W-CHEK-KEY
  9797                                    W-COMP-KEY
  9798                                    W-MAIL-KEY
  9799                                    W-PNDB-KEY
  9800                                    W-PNDB2-KEY
  9801                                    W-PYAJ-KEY.
  9802
  9803     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9804     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9805                                    W-CERT-COMPANY-CD
  9806                                    W-CHEK-COMPANY-CD
  9807                                    W-COMP-COMPANY-CD
  9808                                    W-MAIL-COMPANY-CD
  9809                                    W-PNDB-COMPANY-CD
  9810                                    W-PNDB2-COMPANY-CD
  9811                                    W-PYAJ-COMPANY-CD.
  9812
  9813     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9814         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9815                                    W-CERT-CARRIER
  9816                                    W-MAIL-CARRIER
  9817                                    W-CERT-CARRIER
  9818                                    W-COMP-CARRIER
  9819                                    W-CHEK-CARRIER
  9820                                    W-PNDB2-CARRIER
  9821                                    W-PYAJ-CARRIER.
  9822
  9823     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9824         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9825                                    W-CERT-GROUPING
  9826                                    W-CHEK-GROUPING
  9827                                    W-COMP-GROUPING
  9828                                    W-MAIL-GROUPING
  9829                                    W-PNDB2-GROUPING
  9830                                    W-PYAJ-GROUPING.
  9831
  9832     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9833         MOVE PI-689-STATE       TO W-ACCT-STATE
  9834                                    W-CERT-STATE
  9835                                    W-CHEK-STATE
  9836                                    W-MAIL-STATE
  9837                                    W-PNDB2-STATE.
  9838
  9839     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9840         IF PI-689-DATA-SOURCE = '3' OR '6'
  9841             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9842                                    W-PYAJ-ACCOUNT
  9843         ELSE
  9844             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9845                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL689.cbl
  9846                                    W-CHEK-ACCOUNT
  9847                                    W-MAIL-ACCOUNT
  9848                                    W-PNDB2-ACCOUNT.
  9849
  9850     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9851         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9852                                    W-CHEK-EFF-DT
  9853                                    W-MAIL-EFF-DT
  9854                                    W-PNDB2-EFF-DT.
  9855
  9856     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9857         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9858                                    W-CHEK-CERT-PRIME
  9859                                    W-MAIL-CERT-PRIME
  9860                                    W-PNDB2-CERT-PRIME
  9861
  9862         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9863             MOVE PI-689-CERT-SFX
  9864                                 TO W-CERT-CERT-SFX
  9865                                    W-CHEK-CERT-SFX
  9866                                    W-MAIL-CERT-SFX
  9867                                    W-PNDB2-CERT-SFX
  9868         ELSE
  9869             MOVE SPACES         TO W-CERT-CERT-SFX
  9870                                    W-CHEK-CERT-SFX
  9871                                    W-MAIL-CERT-SFX
  9872                                    W-PNDB2-CERT-SFX.
  9873
  9874     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9875         IF PI-689-DATA-SOURCE = '3' OR '6'
  9876             MOVE PI-689-RESP-PERSON
  9877                                 TO W-COMP-RESP-PERSON
  9878                                    W-PYAJ-FIN-RESP.
  9879
  9880     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9881         IF PI-689-DATA-SOURCE = '3' OR '6'
  9882             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9883                                    W-PYAJ-RECORD-TYPE
  9884         ELSE
  9885             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9886
  9887     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9888         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9889                                    W-PYAJ-FILE-SEQ-NO
  9890                                    W-CHEK-SEQ-NO.
  9891
  9892     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9893         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9894                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9895
  9896     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9897         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9898
  9899     IF  PI-689-NO-ERRORS-DETECTED
  9900         PERFORM 2000-CREATE THRU 2000-EXIT
  9901         IF  NOT PI-689-FATAL-ERROR
  9902                 AND
  9903             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL689.cbl
  9904             IF  PI-689-PRINT-ONLY
  9905                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9906             ELSE
  9907                 IF  PI-689-PRINT-FIRST
  9908                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9909                     IF  NOT PI-689-FATAL-ERROR
  9910                         IF  PI-689-ARCHIVE-LETTER
  9911                             PERFORM 5400-LETTER-RELEASE
  9912                                 THRU 5400-EXIT
  9913                         ELSE
  9914                             MOVE ER-7390
  9915                                 TO PI-689-ERROR
  9916                     ELSE
  9917                         NEXT SENTENCE
  9918                 ELSE
  9919                     IF  NOT PI-689-ARCHIVE-LETTER
  9920                         MOVE ER-7390
  9921                                 TO PI-689-ERROR
  9922                     ELSE
  9923                         PERFORM 5400-LETTER-RELEASE
  9924                             THRU 5400-EXIT
  9925                         IF  NOT PI-689-FATAL-ERROR
  9926                             IF  PI-689-PRINT-SECOND
  9927                                 PERFORM 7900-PRINT-LETTER-NOW
  9928                                     THRU 7900-EXIT.
  9929
  9930 0600-EXIT.
  9931     EXIT.
  9932
  9933 0620-RETURN-TO-CALLER.
  9934
  9935     MOVE PROGRAM-INTERFACE-BLOCK
  9936                                 TO DFHCOMMAREA.
  9937
  9938* EXEC CICS RETURN
  9939*    END-EXEC.
  9940*    MOVE '.(                    ''   #00009717' TO DFHEIV0
  9941     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9942     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9943     MOVE X'2020233030303039373137' TO DFHEIV0(25:11)
  9944     CALL 'kxdfhei1' USING DFHEIV0,
  9945           DFHEIV99,
  9946           DFHEIV99,
  9947           DFHEIV99,
  9948           DFHEIV99,
  9949           DFHEIV99,
  9950           DFHEIV99
  9951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9952
  9953
  9954 0700-GET-VARIABLE-LABEL.
  9955
  9956     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9957         MOVE '(VARIABLE NOT PROVIDED)'
  9958                                 TO W-RC-TEXT (1)
  9959                                    W-VG-TEXT (48)
  9960         GO TO 0700-EXIT.
  9961
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL689.cbl
  9962     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9963                                    W-VG-TEXT (48).
  9964     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9965                                    W-VG-TEXT (49).
  9966     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9967                                    W-VG-TEXT (50).
  9968     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9969                                    W-VG-TEXT (51).
  9970     SET W-RG-NDX                TO +5.
  9971
  9972 0700-EXIT.
  9973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL689.cbl
  9975 0800-EDIT-KEY-FIELDS.
  9976***************************************************************
  9977*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9978*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9979*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9980*     PROCESSING.                                             *
  9981***************************************************************
  9982     MOVE SPACES                 TO W-CNTL-KEY
  9983     MOVE LOW-VALUES             TO W-ACCT-KEY
  9984                                    W-CERT-KEY
  9985                                    W-CHEK-KEY
  9986                                    W-COMP-KEY
  9987                                    W-MAIL-KEY
  9988                                    W-PNDB-KEY
  9989                                    W-PNDB2-KEY
  9990                                    W-PYAJ-KEY.
  9991
  9992     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9993     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9994                                    W-CERT-COMPANY-CD
  9995                                    W-CHEK-COMPANY-CD
  9996                                    W-COMP-COMPANY-CD
  9997                                    W-MAIL-COMPANY-CD
  9998                                    W-PNDB-COMPANY-CD
  9999                                    W-PNDB2-COMPANY-CD
 10000                                    W-PYAJ-COMPANY-CD.
 10001
 10002     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
 10003     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
 10004     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
 10005     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
 10006     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
 10007     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
 10008     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
 10009     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
 10010     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
 10011     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
 10012     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
 10013     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
 10014     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
 10015     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
 10016     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
 10017
 10018     IF  DATASORI NUMERIC
 10019         MOVE DATASORI           TO W-DATA-SOURCE
 10020                                    PI-689-DATA-SOURCE
 10021         GO TO 0800-SOURCE-ACCOUNT
 10022               0800-SOURCE-CERTIFICATE
 10023               0800-SOURCE-COMPENSATION
 10024               0800-SOURCE-PENDING
 10025               0800-SOURCE-CHEK
 10026               0800-SOURCE-PAYMENTS-ADJS
 10027                                 DEPENDING ON W-DATA-SOURCE.
 10028
 10029     IF  FORMI NOT EQUAL '9999'
 10030         MOVE ER-7365            TO EMI-ERROR
 10031         MOVE -1                 TO MAINTL
 10032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL689.cbl
 10033         GO TO 8200-SEND-DATAONLY
 10034
 10035     ELSE
 10036         GO TO 0800-EXIT.
 10037
 10038 0800-SOURCE-ACCOUNT.
 10039
 10040     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
 10041             OR
 10042         W-ACCT-CARRIER EQUAL LOW-VALUES
 10043             OR
 10044         W-ACCT-GROUPING EQUAL LOW-VALUES
 10045             OR
 10046         W-ACCT-STATE EQUAL LOW-VALUES
 10047             OR
 10048         W-ACCT-ACCOUNT EQUAL LOW-VALUES
 10049             OR
 10050         W-ACCT-EXP-DT EQUAL LOW-VALUES
 10051         MOVE ER-7376            TO EMI-ERROR
 10052         MOVE -1                 TO MAINTL
 10053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10054
 10055     GO TO 0800-ERROR-TEST.
 10056
 10057 0800-SOURCE-CERTIFICATE.
 10058
 10059     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
 10060             OR
 10061         W-CERT-CARRIER EQUAL LOW-VALUES
 10062             OR
 10063         W-CERT-GROUPING EQUAL LOW-VALUES
 10064             OR
 10065         W-CERT-STATE EQUAL LOW-VALUES
 10066             OR
 10067         W-CERT-ACCOUNT EQUAL LOW-VALUES
 10068             OR
 10069         W-CERT-EFF-DT EQUAL LOW-VALUES
 10070             OR
 10071         W-CERT-CERT-NO EQUAL LOW-VALUES
 10072         MOVE ER-7377            TO EMI-ERROR
 10073         MOVE -1                 TO MAINTL
 10074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10075
 10076     GO TO 0800-ERROR-TEST.
 10077
 10078 0800-SOURCE-COMPENSATION.
 10079
 10080     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
 10081             OR
 10082         W-COMP-CARRIER EQUAL LOW-VALUES
 10083             OR
 10084         W-COMP-GROUPING EQUAL LOW-VALUES
 10085             OR
 10086         W-COMP-RESP-PERSON EQUAL LOW-VALUES
 10087             OR
 10088         W-COMP-TYPE EQUAL LOW-VALUES
 10089             OR
 10090         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL689.cbl
 10091                 AND
 10092             W-COMP-ACCOUNT EQUAL LOW-VALUES)
 10093         MOVE ER-7378            TO EMI-ERROR
 10094         MOVE -1                 TO MAINTL
 10095         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10096
 10097     GO TO 0800-ERROR-TEST.
 10098
 10099 0800-SOURCE-PENDING.
 10100
 10101     IF  BENTRYL EQUAL ZEROS
 10102         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
 10103                 OR
 10104             W-PNDB2-CARRIER EQUAL LOW-VALUES
 10105                 OR
 10106             W-PNDB2-GROUPING EQUAL LOW-VALUES
 10107                 OR
 10108             W-PNDB2-STATE EQUAL LOW-VALUES
 10109                 OR
 10110             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
 10111                 OR
 10112             W-PNDB2-EFF-DT EQUAL LOW-VALUES
 10113                 OR
 10114             W-PNDB2-CERT-NO EQUAL LOW-VALUES
 10115                 OR
 10116             W-PNDB2-TYPE EQUAL LOW-VALUES
 10117                 OR
 10118             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
 10119             MOVE ER-7379        TO EMI-ERROR
 10120             MOVE -1             TO MAINTL
 10121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10122         ELSE
 10123             NEXT SENTENCE
 10124     ELSE
 10125         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
 10126                 OR
 10127             W-PNDB-ENTRY EQUAL LOW-VALUES
 10128                 OR
 10129             W-PNDB-SEQ-NO EQUAL ZEROS
 10130             MOVE ER-7379        TO EMI-ERROR
 10131             MOVE -1             TO MAINTL
 10132             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10133
 10134     GO TO 0800-ERROR-TEST.
 10135
 10136 0800-SOURCE-CHEK.
 10137
 10138     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
 10139             OR
 10140         W-CHEK-CARRIER EQUAL LOW-VALUES
 10141             OR
 10142         W-CHEK-GROUPING EQUAL LOW-VALUES
 10143             OR
 10144         W-CHEK-STATE EQUAL LOW-VALUES
 10145             OR
 10146         W-CHEK-ACCOUNT EQUAL LOW-VALUES
 10147             OR
 10148         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL689.cbl
 10149             OR
 10150         W-CHEK-CERT-NO EQUAL LOW-VALUES
 10151         MOVE ER-7381            TO EMI-ERROR
 10152         MOVE -1                 TO MAINTL
 10153         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10154
 10155     GO TO 0800-ERROR-TEST.
 10156
 10157 0800-SOURCE-PAYMENTS-ADJS.
 10158
 10159     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
 10160             OR
 10161         W-PYAJ-CARRIER EQUAL LOW-VALUES
 10162             OR
 10163         W-PYAJ-GROUPING EQUAL LOW-VALUES
 10164             OR
 10165         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 10166             OR
 10167         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
 10168             OR
 10169         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
 10170         MOVE ER-7396            TO EMI-ERROR
 10171         MOVE -1                 TO MAINTL
 10172         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10173
 10174     GO TO 0800-ERROR-TEST.
 10175
 10176 0800-ERROR-TEST.
 10177
 10178     IF  NOT EMI-NO-ERRORS
 10179         IF  EMI-ERROR EQUAL ER-7250
 10180             GO TO 0800-EXIT
 10181         ELSE
 10182             GO TO 8200-SEND-DATAONLY.
 10183
 10184 0800-EXIT.
 10185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL689.cbl
 10187 0900-EDIT-CARRIER.
 10188
 10189     IF  CARRIERL EQUAL ZEROES
 10190         MOVE LOW-VALUES         TO PI-689-CARRIER
 10191                                    W-ACCT-CARRIER
 10192                                    W-CERT-CARRIER
 10193                                    W-COMP-CARRIER
 10194                                    W-CHEK-CARRIER
 10195                                    W-MAIL-CARRIER
 10196                                    W-PNDB2-CARRIER
 10197                                    W-PYAJ-CARRIER
 10198     ELSE
 10199         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
 10200
 10201 0900-EXIT.
 10202     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL689.cbl
 10204 0905-EDIT-GROUPING.
 10205
 10206     IF  GROUPL EQUAL ZEROES
 10207         MOVE LOW-VALUES         TO PI-689-GROUPING
 10208                                    W-ACCT-GROUPING
 10209                                    W-CERT-GROUPING
 10210                                    W-CHEK-GROUPING
 10211                                    W-COMP-GROUPING
 10212                                    W-MAIL-GROUPING
 10213                                    W-PNDB2-GROUPING
 10214                                    W-PYAJ-GROUPING
 10215     ELSE
 10216         MOVE AL-UANON           TO GROUPA
 10217         MOVE GROUPI             TO PI-689-GROUPING
 10218                                    W-ACCT-GROUPING
 10219                                    W-CERT-GROUPING
 10220                                    W-CHEK-GROUPING
 10221                                    W-COMP-GROUPING
 10222                                    W-MAIL-GROUPING
 10223                                    W-PNDB2-GROUPING
 10224                                    W-PYAJ-GROUPING.
 10225
 10226 0905-EXIT.
 10227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL689.cbl
 10229 0910-EDIT-STATE.
 10230
 10231     IF  STATEL EQUAL ZEROES
 10232         MOVE LOW-VALUES         TO PI-689-STATE
 10233                                    W-ACCT-STATE
 10234                                    W-CERT-STATE
 10235                                    W-CHEK-STATE
 10236                                    W-MAIL-STATE
 10237                                    W-PNDB2-STATE
 10238     ELSE
 10239         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
 10240
 10241 0910-EXIT.
 10242     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL689.cbl
 10244 0915-EDIT-ACCOUNT.
 10245
 10246     IF  ACCTL EQUAL ZEROES
 10247         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10248                                    W-ACCT-ACCOUNT
 10249                                    W-CERT-ACCOUNT
 10250                                    W-CHEK-ACCOUNT
 10251                                    W-COMP-ACCOUNT
 10252                                    W-MAIL-ACCOUNT
 10253                                    W-PNDB2-ACCOUNT
 10254                                    W-PYAJ-ACCOUNT
 10255     ELSE
 10256         MOVE AL-UANON           TO ACCTA
 10257         MOVE ACCTI              TO PI-689-ACCOUNT
 10258                                    W-ACCT-ACCOUNT
 10259                                    W-CERT-ACCOUNT
 10260                                    W-CHEK-ACCOUNT
 10261                                    W-COMP-ACCOUNT
 10262                                    W-MAIL-ACCOUNT
 10263                                    W-PYAJ-ACCOUNT
 10264                                    W-PNDB2-ACCOUNT.
 10265
 10266 0915-EXIT.
 10267     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL689.cbl
 10269 0920-EDIT-EXP-DATE.
 10270
 10271     IF  DATEL NOT EQUAL ZEROS
 10272         IF  DATEI EQUAL '99/99/99' OR '999999'
 10273             MOVE '99/99/99'     TO DATEO
 10274                                    PI-689-DATE-EDIT
 10275             MOVE AL-UANON       TO DATEA
 10276             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
 10277                                    W-ACCT-EXP-DT
 10278         ELSE
 10279             MOVE DATEI          TO W-DEEDIT-FIELD
 10280             PERFORM 8600-DEEDIT
 10281             MOVE W-DEEDIT-FIELD-V0
 10282                                 TO DC-GREG-DATE-1-MDY
 10283             MOVE '4'            TO DC-OPTION-CODE
 10284             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10285             IF  DATE-CONVERSION-ERROR
 10286                 MOVE ER-0454    TO EMI-ERROR
 10287                 MOVE -1         TO DATEL
 10288                 MOVE AL-UABON   TO DATEA
 10289                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10290             ELSE
 10291                 MOVE DC-GREG-DATE-1-EDIT
 10292                                 TO DATEO
 10293                                    PI-689-DATE-EDIT
 10294                 MOVE AL-UANON   TO DATEA
 10295                 MOVE DC-BIN-DATE-1
 10296                                 TO PI-689-EXP-DATE
 10297                                    W-ACCT-EXP-DT
 10298     ELSE
 10299         MOVE LOW-VALUES         TO PI-689-EXP-DATE
 10300                                    W-ACCT-EXP-DT
 10301                                    PI-689-DATE-EDIT.
 10302
 10303 0920-EXIT.
 10304     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL689.cbl
 10306 0925-EDIT-EFF-DATE.
 10307
 10308     IF  CERTL EQUAL ZERO
 10309             AND
 10310         DATASORI NOT EQUAL '2'
 10311         GO TO 0925-EXIT.
 10312
 10313     IF  DATEL NOT EQUAL ZEROS
 10314         MOVE DATEI              TO W-DEEDIT-FIELD
 10315         PERFORM 8600-DEEDIT
 10316         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 10317         MOVE '4'                TO DC-OPTION-CODE
 10318         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10319
 10320         IF  DATE-CONVERSION-ERROR
 10321             MOVE ER-0215        TO EMI-ERROR
 10322             MOVE -1             TO DATEL
 10323             MOVE AL-UABON       TO DATEA
 10324             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10325         ELSE
 10326             MOVE DC-GREG-DATE-1-EDIT
 10327                                 TO DATEO
 10328                                    PI-689-DATE-EDIT
 10329             MOVE AL-UANON       TO DATEA
 10330             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
 10331                                    W-CERT-EFF-DT
 10332                                    W-CHEK-EFF-DT
 10333                                    W-MAIL-EFF-DT
 10334                                    W-PNDB2-EFF-DT
 10335     ELSE
 10336         MOVE LOW-VALUES         TO PI-689-EFF-DATE
 10337                                    W-PNDB2-EFF-DT
 10338                                    W-CHEK-EFF-DT
 10339                                    W-MAIL-EFF-DT
 10340                                    W-CERT-EFF-DT
 10341                                    PI-689-DATE-EDIT.
 10342
 10343 0925-EXIT.
 10344     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL689.cbl
 10346 0930-EDIT-CERTIFICATE.
 10347
 10348     IF  CERTL EQUAL ZEROES
 10349         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
 10350                                    W-CERT-CERT-PRIME
 10351                                    W-CHEK-CERT-PRIME
 10352                                    W-MAIL-CERT-PRIME
 10353                                    W-PNDB2-CERT-PRIME
 10354                                    PI-689-CERT-SFX
 10355                                    W-CERT-CERT-SFX
 10356                                    W-CHEK-CERT-SFX
 10357                                    W-MAIL-CERT-SFX
 10358                                    W-PNDB2-CERT-SFX
 10359     ELSE
 10360         MOVE AL-UANON           TO CERTA
 10361         MOVE CERTI              TO PI-689-CERT-PRIME
 10362                                    W-CERT-CERT-PRIME
 10363                                    W-CHEK-CERT-PRIME
 10364                                    W-MAIL-CERT-PRIME
 10365                                    W-PNDB2-CERT-PRIME
 10366         IF  SFXL EQUAL ZEROES
 10367                 OR
 10368             SFXI EQUAL LOW-VALUES
 10369             MOVE SPACES         TO PI-689-CERT-SFX
 10370                                    W-CERT-CERT-SFX
 10371                                    W-CHEK-CERT-SFX
 10372                                    W-MAIL-CERT-SFX
 10373                                    W-PNDB2-CERT-SFX
 10374         ELSE
 10375             MOVE AL-UANON       TO SFXA
 10376             MOVE SFXI           TO PI-689-CERT-SFX
 10377                                    W-CERT-CERT-SFX
 10378                                    W-CHEK-CERT-SFX
 10379                                    W-MAIL-CERT-SFX
 10380                                    W-PNDB2-CERT-SFX.
 10381
 10382 0930-EXIT.
 10383     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL689.cbl
 10385 0935-EDIT-RESP-PERSON.
 10386
 10387     IF  RPERSONL EQUAL ZEROES
 10388         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10389                                    W-COMP-RESP-PERSON
 10390                                    W-PYAJ-FIN-RESP
 10391     ELSE
 10392         MOVE AL-UANON           TO RPERSONA
 10393         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10394                                    W-PYAJ-FIN-RESP
 10395                                    W-COMP-RESP-PERSON.
 10396
 10397 0935-EXIT.
 10398     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL689.cbl
 10400 0940-EDIT-ACCOUNT.
 10401
 10402     IF  ACCTL EQUAL ZEROES
 10403         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10404                                    W-COMP-ACCOUNT
 10405                                    W-PYAJ-ACCOUNT
 10406     ELSE
 10407         MOVE AL-UANON           TO ACCTA
 10408         MOVE ACCTI              TO PI-689-ACCOUNT
 10409                                    W-PYAJ-ACCOUNT
 10410                                    W-COMP-ACCOUNT.
 10411
 10412 0940-EXIT.
 10413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL689.cbl
 10415 0945-EDIT-TYPE.
 10416
 10417     IF  TYPEL EQUAL ZEROES
 10418         MOVE LOW-VALUES         TO PI-689-TYPE
 10419                                    W-COMP-TYPE
 10420                                    W-PYAJ-RECORD-TYPE
 10421     ELSE
 10422         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10423         IF TYPEI = 'C' OR 'G' OR 'A'
 10424             MOVE AL-UANON       TO TYPEA
 10425             MOVE TYPEI          TO PI-689-TYPE
 10426                                    W-COMP-TYPE
 10427                                    W-PYAJ-RECORD-TYPE
 10428         ELSE
 10429             MOVE ER-7368        TO EMI-ERROR
 10430             MOVE -1             TO TYPEL
 10431             MOVE AL-UABON       TO TYPEA
 10432             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10433
 10434 0945-EXIT.
 10435     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL689.cbl
 10437 0950-EDIT-ENTRY.
 10438
 10439     IF  BENTRYL EQUAL ZEROES
 10440         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10441                                    W-PNDB-ENTRY
 10442     ELSE
 10443         MOVE AL-UANON           TO BENTRYA
 10444         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10445                                    W-PNDB-ENTRY.
 10446
 10447 0950-EXIT.
 10448     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL689.cbl
 10450 0955-EDIT-SEQUENCE.
 10451
 10452     IF  SEQL NOT EQUAL ZEROS
 10453         IF  SEQI NOT NUMERIC
 10454                 OR
 10455             SEQI EQUAL '0'
 10456             MOVE ER-7367        TO EMI-ERROR
 10457             MOVE -1             TO SEQL
 10458             MOVE AL-UABON       TO SEQA
 10459             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10460         ELSE
 10461             MOVE AL-UANON       TO SEQA
 10462             MOVE SEQI           TO PI-689-SEQ-NO
 10463                                    W-CHEK-SEQ-NO
 10464                                    W-PYAJ-FILE-SEQ-NO
 10465                                    W-PNDB-SEQ-NO
 10466                                    PI-689-SEQ-EDIT
 10467     ELSE
 10468         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10469
 10470 0955-EXIT.
 10471     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL689.cbl
 10473 0960-EDIT-BATCH-SEQ.
 10474
 10475     IF  BCSEQL NOT EQUAL ZEROS
 10476         IF  BCSEQI NOT NUMERIC
 10477             MOVE ER-7368        TO EMI-ERROR
 10478             MOVE -1             TO BCSEQL
 10479             MOVE AL-UABON       TO BCSEQA
 10480             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10481         ELSE
 10482             MOVE AL-UANON       TO BCSEQA
 10483             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10484                                    W-PNDB-CHG-SEQ-NO
 10485                                    W-PNDB2-ALT-CHG-SEQ-NO
 10486                                    PI-689-BCSEQ-EDIT
 10487     ELSE
 10488         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10489
 10490 0960-EXIT.
 10491     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL689.cbl
 10493 0965-EDIT-TYPE.
 10494
 10495     IF  TYPEL EQUAL ZEROES
 10496         MOVE LOW-VALUES         TO PI-689-TYPE
 10497                                    W-PNDB2-TYPE
 10498     ELSE
 10499         IF  DATASORI NOT EQUAL '4'
 10500             GO TO 0965-EXIT
 10501         ELSE
 10502             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10503                 MOVE AL-UANON   TO TYPEA
 10504                 MOVE TYPEI      TO PI-689-TYPE
 10505                                    W-PNDB2-TYPE
 10506             ELSE
 10507                 MOVE ER-7370    TO EMI-ERROR
 10508                 MOVE -1         TO TYPEL
 10509                 MOVE AL-UABON   TO TYPEA
 10510                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10511
 10512 0965-EXIT.
 10513     EXIT.
 10514
 10515 0970-EDIT-CSO.
 10516
 10517     IF ENDARCHL > ZEROS
 10518        IF ENDARCHI NUMERIC
 10519            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10520            MOVE AL-UNNON       TO ENDARCHA
 10521            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10522            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10523            MOVE 'N'            TO W-VALID-ENDT-SW
 10524            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10525            IF NOT W-VALID-ENDT
 10526                MOVE -1         TO ENDARCHL
 10527                MOVE ER-1565    TO EMI-ERROR
 10528                MOVE AL-UNBON   TO ENDARCHA
 10529                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10530            END-IF
 10531        END-IF
 10532     ELSE
 10533        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10534     END-IF
 10535
 10536     IF PI-CERT-REQ-IND = 'Y'
 10537       IF  CERTIDL NOT EQUAL ZEROS
 10538         IF CERTIDI NUMERIC
 10539             MOVE AL-UANON      TO CERTIDA
 10540             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10541         ELSE
 10542             MOVE ER-1778       TO EMI-ERROR
 10543             MOVE -1            TO CERTIDL
 10544             MOVE AL-UABON      TO CERTIDA
 10545             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10546         END-IF
 10547       ELSE
 10548          MOVE ER-0715       TO EMI-ERROR
 10549          MOVE -1            TO CERTIDL
 10550          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL689.cbl
 10551          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10552       END-IF
 10553     END-IF.
 10554
 10555 0970-EXIT.
 10556      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 212
* EL689.cbl
 10558 0990-CARRIER-VALIDITY-CHECK.
 10559
 10560     IF  CARRIERI EQUAL SPACES
 10561         GO TO 0990-EXIT.
 10562
 10563     MOVE SPACES                 TO W-CNTL-KEY.
 10564     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10565     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10566     MOVE CARRIERI               TO W-CNTL-GEN4.
 10567     MOVE +0                     TO W-CNTL-SEQ-NO.
 10568
 10569
 10570* EXEC CICS HANDLE CONDITION
 10571*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10572*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10573*    END-EXEC.
 10574*    MOVE '"$IJ                  ! & #00010335' TO DFHEIV0
 10575     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10577     MOVE X'2620233030303130333335' TO DFHEIV0(25:11)
 10578     CALL 'kxdfhei1' USING DFHEIV0
 10579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10580
 10581
 10582
 10583* EXEC CICS READ
 10584*        DATASET (W-CNTL-FILE-ID)
 10585*        SET     (ADDRESS OF CONTROL-FILE)
 10586*        RIDFLD  (W-CNTL-KEY)
 10587*    END-EXEC.
 10588*    MOVE '&"S        E          (   #00010340' TO DFHEIV0
 10589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10591     MOVE X'2020233030303130333430' TO DFHEIV0(25:11)
 10592     CALL 'kxdfhei1' USING DFHEIV0,
 10593           W-CNTL-FILE-ID,
 10594           DFHEIV20,
 10595           DFHEIV99,
 10596           W-CNTL-KEY,
 10597           DFHEIV99,
 10598           DFHEIV99,
 10599           DFHEIV99
 10600     SET ADDRESS OF CONTROL-FILE TO
 10601         DFHEIV20
 10602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10603
 10604
 10605     IF  PI-NO-CARRIER-SECURITY
 10606             OR
 10607         PI-CARRIER-SECURITY EQUAL CARRIERI
 10608         MOVE AL-UANON           TO CARRIERA
 10609         MOVE CARRIERI           TO PI-689-CARRIER
 10610                                    W-ACCT-CARRIER
 10611                                    W-CERT-CARRIER
 10612                                    W-CHEK-CARRIER
 10613                                    W-COMP-CARRIER
 10614                                    W-MAIL-CARRIER
 10615                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 213
* EL689.cbl
 10616                                    W-PYAJ-CARRIER
 10617     ELSE
 10618         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10619         MOVE ER-9095            TO EMI-ERROR
 10620         MOVE -1                 TO MAINTL
 10621         MOVE AL-UANON           TO MAINTA
 10622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10623
 10624     GO TO 0990-EXIT.
 10625
 10626 0990-CARRIER-NOT-FOUND.
 10627
 10628     MOVE -1                     TO CARRIERL.
 10629     MOVE AL-UABON               TO CARRIERA.
 10630     MOVE ER-2208                TO EMI-ERROR.
 10631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10632
 10633 0990-EXIT.
 10634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 214
* EL689.cbl
 10636 0994-STATE-VALIDITY-CHECK.
 10637
 10638     IF  STATEI EQUAL SPACES
 10639         GO TO 0994-EXIT.
 10640
 10641     MOVE SPACES                 TO W-CNTL-KEY.
 10642     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10643     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10644     MOVE STATEI                 TO W-CNTL-GEN1.
 10645     MOVE +0                     TO W-CNTL-SEQ-NO.
 10646
 10647
 10648* EXEC CICS HANDLE CONDITION
 10649*        NOTFND  (0994-STATE-NOT-FOUND)
 10650*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10651*    END-EXEC.
 10652*    MOVE '"$IJ                  ! '' #00010388' TO DFHEIV0
 10653     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10655     MOVE X'2720233030303130333838' TO DFHEIV0(25:11)
 10656     CALL 'kxdfhei1' USING DFHEIV0
 10657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10658
 10659
 10660
 10661* EXEC CICS READ
 10662*        DATASET (W-CNTL-FILE-ID)
 10663*        SET     (ADDRESS OF CONTROL-FILE)
 10664*        RIDFLD  (W-CNTL-KEY)
 10665*    END-EXEC.
 10666*    MOVE '&"S        E          (   #00010393' TO DFHEIV0
 10667     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10669     MOVE X'2020233030303130333933' TO DFHEIV0(25:11)
 10670     CALL 'kxdfhei1' USING DFHEIV0,
 10671           W-CNTL-FILE-ID,
 10672           DFHEIV20,
 10673           DFHEIV99,
 10674           W-CNTL-KEY,
 10675           DFHEIV99,
 10676           DFHEIV99,
 10677           DFHEIV99
 10678     SET ADDRESS OF CONTROL-FILE TO
 10679         DFHEIV20
 10680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10681
 10682
 10683     MOVE AL-UANON               TO STATEA.
 10684     MOVE STATEI                 TO PI-689-STATE
 10685                                    W-ACCT-STATE
 10686                                    W-CERT-STATE
 10687                                    W-CHEK-STATE
 10688                                    W-MAIL-STATE
 10689                                    W-PNDB2-STATE.
 10690
 10691     GO TO 0994-EXIT.
 10692
 10693 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 215
* EL689.cbl
 10694
 10695     MOVE -1                     TO STATEL.
 10696     MOVE AL-UABON               TO STATEA.
 10697     MOVE ER-2209                TO EMI-ERROR.
 10698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10699
 10700 0994-EXIT.
 10701     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 216
* EL689.cbl
 10703 1000-SHOW.
 10704***************************************************************
 10705*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10706*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10707*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10708*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10709***************************************************************
 10710
 10711     MOVE SPACES                 TO W-RECORD-TABLE.
 10712
 10713     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10714          MOVE PI-689-LBL-OVERRIDE
 10715                                 TO ADDRLBLI
 10716          MOVE +1                TO ADDRLBLL
 10717          MOVE AL-UANON          TO ADDRLBLA
 10718     ELSE
 10719          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10720          MOVE +1                TO ADDRLBLL
 10721          MOVE AL-UANON          TO ADDRLBLA.
 10722
 10723     IF  ARCHNUML EQUAL ZEROS
 10724         MOVE -1                 TO ARCHNUML
 10725         MOVE AL-UNBON           TO ARCHNUMA
 10726         MOVE ER-0174            TO EMI-ERROR
 10727         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10728         GO TO 8200-SEND-DATAONLY.
 10729
 10730     IF  ARCHNUMI NOT NUMERIC
 10731         MOVE -1                 TO ARCHNUML
 10732         MOVE AL-UNBON           TO ARCHNUMA
 10733         MOVE ER-0175            TO EMI-ERROR
 10734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10735         GO TO 8200-SEND-DATAONLY.
 10736
 10737     IF  PI-SHOW-MODE
 10738
 10739         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10740             MOVE -1             TO MAINTL
 10741             GO TO 8200-SEND-DATAONLY
 10742         ELSE
 10743             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10744
 10745     MOVE +0                     TO W-ARCH-SEQ-NO
 10746                                    W-ARCT-SEQ-NO.
 10747     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10748                                    W-ARCT-COMPANY-CD.
 10749     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10750                                    W-ARCT-NUMBER
 10751                                    PI-689-ARCHIVE-NUMBER.
 10752     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10753     MOVE '1'                    TO PI-ACTION.
 10754     MOVE SPACES                 TO PI-689-PRINT-SW
 10755                                    PI-689-FORM-NUMBER
 10756                                    W-DELETE-KEY.
 10757     SET W-RG-NDX                TO W-ZEROS.
 10758
 10759
 10760* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 217
* EL689.cbl
 10761*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10762*         NOTFND     (1070-ARCH-NOT-FOUND)
 10763*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10764*    END-EXEC.
 10765*    MOVE '"$JI''                 ! ( #00010475' TO DFHEIV0
 10766     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10768     MOVE X'2820233030303130343735' TO DFHEIV0(25:11)
 10769     CALL 'kxdfhei1' USING DFHEIV0
 10770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10771
 10772
 10773
 10774* EXEC CICS READ
 10775*        DATASET (W-ARCH-FILE-ID)
 10776*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10777*        RIDFLD  (W-ARCH-KEY)
 10778*    END-EXEC.
 10779*    MOVE '&"S        E          (   #00010481' TO DFHEIV0
 10780     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10782     MOVE X'2020233030303130343831' TO DFHEIV0(25:11)
 10783     CALL 'kxdfhei1' USING DFHEIV0,
 10784           W-ARCH-FILE-ID,
 10785           DFHEIV20,
 10786           DFHEIV99,
 10787           W-ARCH-KEY,
 10788           DFHEIV99,
 10789           DFHEIV99,
 10790           DFHEIV99
 10791     SET ADDRESS OF LETTER-ARCHIVE TO
 10792         DFHEIV20
 10793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10794
 10795
 10796     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10797
 10798*    EXEC CICS HANDLE CONDITION
 10799*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10800*         NOTFND     (1020-ARCT-ENDBR)
 10801*         ENDFILE    (1020-ARCT-ENDBR)
 10802*    END-EXEC.
 10803*
 10804*1005-START-BROWSE.
 10805*
 10806*    EXEC CICS STARTBR
 10807*         DATASET    (W-ARCT-FILE-ID)
 10808*         RIDFLD     (W-ARCT-KEY)
 10809*         GTEQ
 10810*    END-EXEC.
 10811*
 10812*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10813*
 10814*1010-READ-NEXT.
 10815*
 10816*    EXEC CICS READNEXT
 10817*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10818*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 218
* EL689.cbl
 10819*         RIDFLD    (W-ARCT-KEY)
 10820*    END-EXEC.
 10821*
 10822*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10823*        IF  LT-ADDRESS-DATA
 10824*            IF  PI-CREATE-LABELS  AND
 10825*                NOT PI-689-LABELS-OVERRIDEN
 10826*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10827*                        VARYING
 10828*                    LT-NDX FROM 1 BY 1
 10829*                        UNTIL
 10830*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10831*                GO TO 1010-READ-NEXT
 10832*            ELSE
 10833*                MOVE LT-CONTROL-PRIMARY
 10834*                                TO W-DELETE-KEY
 10835*                GO TO 1010-READ-NEXT
 10836*        ELSE
 10837*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10838*                    VARYING
 10839*                LT-NDX FROM 1 BY 1
 10840*                    UNTIL
 10841*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10842*                    OR
 10843*                LT-NDX GREATER THAN +20
 10844*            GO TO 1010-READ-NEXT.
 10845*
 10846*1020-ARCT-ENDBR.
 10847*
 10848*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10849*        EXEC CICS ENDBR
 10850*             DATASET   (W-ARCT-FILE-ID)
 10851*        END-EXEC.
 10852*
 10853*    IF  W-RG-NDX EQUAL ZEROS
 10854*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10855*
 10856*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10857*            AND
 10858*        PI-BYPASS-LABELS
 10859*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10860*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10861*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10862*
 10863*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10864*    MOVE 1                      TO PI-CURRENT-LINE.
 10865*    SET W-RG-NDX                TO +1.
 10866*
 10867*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10868*            VARYING
 10869*        W-SC-NDX FROM 1 BY 1
 10870*            UNTIL
 10871*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10872
 10873     MOVE -1                     TO MAINTL.
 10874     GO TO 8100-SEND-INITIAL-MAP.
 10875
 10876 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 219
* EL689.cbl
 10877     EXIT.
 10878
 10879 1030-TEXT-BUILD.
 10880
 10881     SET W-RG-NDX UP BY 1.
 10882     MOVE LT-SKIP-CONTROL (LT-NDX)
 10883                                 TO W-PRINT-CONTROL.
 10884
 10885     IF  W-PRINT-CONTROL EQUAL 99
 10886         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10887         SET W-RG-NDX UP BY 1
 10888     ELSE
 10889         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10890
 10891     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10892     MOVE LT-SKIP-CONTROL (LT-NDX)
 10893                                 TO W-RC-PC (W-RG-NDX).
 10894     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10895
 10896 1030-EXIT.
 10897     EXIT.
 10898
 10899 1040-FORMAT-HEADER-DATA.
 10900
 10901     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10902     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10903     MOVE LA-CARRIER-A2          TO CARRIERO.
 10904     MOVE LA-CERT-NO-A2          TO CERTO.
 10905     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10906     MOVE LA-DATA-SOURCE         TO DATASORO.
 10907
 10908     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10909         MOVE ZEROES             TO DATEO
 10910
 10911     ELSE
 10912         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10913         MOVE ' '                TO DC-OPTION-CODE
 10914         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10915         MOVE DC-GREG-DATE-1-EDIT
 10916                                 TO DATEO.
 10917
 10918     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10919         MOVE ZEROES             TO FOLLOWO
 10920     ELSE
 10921         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10922         MOVE ' '                TO DC-OPTION-CODE
 10923         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10924         MOVE DC-GREG-DATE-1-EDIT
 10925                                 TO FOLLOWO.
 10926
 10927     MOVE LA-FORM-A3             TO FORMO.
 10928     MOVE LA-GROUPING-A2         TO GROUPO.
 10929     MOVE LA-NO-OF-COPIES        TO COPIESO
 10930                                    PI-689-NUMBER-COPIES.
 10931
 10932*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10933*        MOVE LA-PRINT-RESTRICTION
 10934*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 220
* EL689.cbl
 10935*    ELSE
 10936*        MOVE SPACES             TO PRTRESTO.
 10937
 10938     IF  LA-RESEND-DATE = LOW-VALUES
 10939         MOVE ZEROES             TO RESEND1O
 10940     ELSE
 10941         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10942         MOVE ' '                TO DC-OPTION-CODE
 10943         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10944         MOVE DC-GREG-DATE-1-EDIT
 10945                                 TO RESEND1O.
 10946
 10947     MOVE LA-STATE-A2            TO STATEO.
 10948
 10949     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10950
 10951 1040-EXIT.
 10952     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 221
* EL689.cbl
 10954 1050-MOVE-LABELS.
 10955
 10956     SET W-RG-NDX                TO LT-NDX.
 10957     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10958     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10959     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10960
 10961 1050-EXIT.
 10962     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 222
* EL689.cbl
 10964 1060-DELETE-ADDRESS-RECORD.
 10965
 10966
 10967* EXEC CICS DELETE
 10968*        DATASET (W-ARCT-FILE-ID)
 10969*        RIDFLD  (W-DELETE-KEY)
 10970*    END-EXEC.
 10971*    MOVE '&(  R                 &   #00010657' TO DFHEIV0
 10972     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10973     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10974     MOVE X'2020233030303130363537' TO DFHEIV0(25:11)
 10975     CALL 'kxdfhei1' USING DFHEIV0,
 10976           W-ARCT-FILE-ID,
 10977           W-DELETE-KEY,
 10978           DFHEIV99,
 10979           DFHEIV99,
 10980           DFHEIV99
 10981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10982
 10983
 10984
 10985* EXEC CICS READ
 10986*        DATASET (W-ARCH-FILE-ID)
 10987*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10988*        RIDFLD  (W-ARCH-KEY)
 10989*        UPDATE
 10990*    END-EXEC.
 10991*    MOVE '&"S        EU         (   #00010662' TO DFHEIV0
 10992     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10993     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10994     MOVE X'2020233030303130363632' TO DFHEIV0(25:11)
 10995     CALL 'kxdfhei1' USING DFHEIV0,
 10996           W-ARCH-FILE-ID,
 10997           DFHEIV20,
 10998           DFHEIV99,
 10999           W-ARCH-KEY,
 11000           DFHEIV99,
 11001           DFHEIV99,
 11002           DFHEIV99
 11003     SET ADDRESS OF LETTER-ARCHIVE TO
 11004         DFHEIV20
 11005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11006
 11007
 11008     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 11009
 11010
 11011* EXEC CICS REWRITE
 11012*         FROM      (LETTER-ARCHIVE)
 11013*         DATASET   (W-ARCH-FILE-ID)
 11014*    END-EXEC.
 11015     MOVE LENGTH OF
 11016      LETTER-ARCHIVE
 11017       TO DFHEIV11
 11018*    MOVE '&& L                  %   #00010671' TO DFHEIV0
 11019     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11020     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11021     MOVE X'2020233030303130363731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 223
* EL689.cbl
 11022     CALL 'kxdfhei1' USING DFHEIV0,
 11023           W-ARCH-FILE-ID,
 11024           LETTER-ARCHIVE,
 11025           DFHEIV11,
 11026           DFHEIV99
 11027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11028
 11029
 11030 1060-EXIT.
 11031     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 224
* EL689.cbl
 11033 1070-ARCH-NOT-FOUND.
 11034
 11035     MOVE ER-7371                TO EMI-ERROR.
 11036     MOVE -1                     TO ARCHNUML.
 11037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11038     GO TO 8100-SEND-INITIAL-MAP.
 11039
 11040 1080-ARCHIVE-TEXT-NOT-FOUND.
 11041
 11042     MOVE ER-7372                TO EMI-ERROR.
 11043     MOVE -1                     TO ARCHNUML.
 11044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11045     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 225
* EL689.cbl
 11047 2000-CREATE.
 11048***************************************************************
 11049*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 11050*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 11051*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 11052*    WILL BE DISPLAYED ON THE SCREEN.                         *
 11053*                                                             *
 11054***************************************************************
 11055
 11056***************************************************************
 11057*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 11058*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 11059*    THEN FORCE AN ERROR.                                     *
 11060***************************************************************
 11061
 11062     IF  PI-689-CREATE-NO-SCREENS
 11063         GO TO 2000-GET-TEXT.
 11064
 11065     IF  PI-CREATE-MODE
 11066         IF  PI-689-PRINT-PERFORMED
 11067                 AND
 11068             FORMI NOT EQUAL 9999
 11069             MOVE ER-0279    TO EMI-ERROR
 11070             MOVE -1         TO MAINTL
 11071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11072             GO TO 8200-SEND-DATAONLY.
 11073
 11074     IF  ARCHNUML GREATER THAN ZEROS
 11075         MOVE ER-9320            TO EMI-ERROR
 11076         MOVE -1                 TO ARCHNUML
 11077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11078         GO TO 8200-SEND-DATAONLY.
 11079
 11080***************************************************************
 11081*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 11082*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 11083***************************************************************
 11084
 11085     IF  FORMI EQUAL '9999'
 11086         MOVE 16                 TO PI-TOTAL-LINES
 11087         MOVE 1                  TO PI-CURRENT-LINE
 11088         MOVE SPACES             TO W-FILE-TABLE
 11089                                    W-LINE-CONTROL-RECORD
 11090                                    W-RECORD-TABLE
 11091                                    W-SINGLE-LINE
 11092                                    W-SQUEEZED-LINE
 11093                                    W-TS-WORK-AREA
 11094                                    W-TX-TABLE
 11095         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 11096         MOVE '3'                TO PI-ACTION
 11097         MOVE FORMI              TO PI-689-FORM-NUMBER
 11098                                    PI-COMM-CONTROL
 11099         MOVE ZEROS              TO PI-UPDATE-SW
 11100         MOVE W-PGM-EL1042       TO W-CALL-PGM
 11101         GO TO 9400-XCTL.
 11102
 11103 2000-GET-TEXT.
 11104
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 226
* EL689.cbl
 11105     MOVE SPACES                 TO W-FILE-TABLE
 11106                                    W-LINE-CONTROL-RECORD
 11107                                    W-RECORD-TABLE
 11108                                    W-SINGLE-LINE
 11109                                    W-SQUEEZED-LINE
 11110                                    W-TS-WORK-AREA
 11111                                    W-TX-TABLE.
 11112     SET W-TG-NDX                TO +1
 11113     MOVE ZEROS                  TO W-INITIAL-COLUMN
 11114                                    W-LINE-COUNT
 11115                                    W-LINE-INDENT-1
 11116                                    W-LINE-INDENT-2
 11117                                    W-LINE-INDENT-3
 11118                                    W-LINE-INDENT-4
 11119                                    W-LINE-INDENT-5
 11120                                    W-PAGE
 11121                                    W-PARAGRAPH-INDENT
 11122                                    W-TOP-MARGIN
 11123                                    W-WORK-INDENT.
 11124     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 11125     MOVE +70                    TO W-LAST-COLUMN.
 11126     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 11127     MOVE +1                     TO W-START-COLUMN.
 11128     MOVE +71                    TO W-TOO-FAR.
 11129
 11130     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 11131     MOVE FORMI                  TO W-TEXT-LETTER.
 11132     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 11133     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 11134
 11135
 11136* EXEC CICS HANDLE CONDITION
 11137*         NOTFND     (2001-NOT-FOUND)
 11138*         ENDFILE    (2001-NOT-FOUND)
 11139*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 11140*    END-EXEC.
 11141*    MOVE '"$I''J                 ! ) #00010781' TO DFHEIV0
 11142     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 11143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11144     MOVE X'2920233030303130373831' TO DFHEIV0(25:11)
 11145     CALL 'kxdfhei1' USING DFHEIV0
 11146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11147
 11148
 11149
 11150* EXEC CICS STARTBR
 11151*         DATASET    (W-TEXT-FILE-ID)
 11152*         RIDFLD     (W-TEXT-KEY)
 11153*         GTEQ
 11154*    END-EXEC.
 11155     MOVE 0
 11156       TO DFHEIV11
 11157*    MOVE '&,         G          &   #00010787' TO DFHEIV0
 11158     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11159     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11160     MOVE X'2020233030303130373837' TO DFHEIV0(25:11)
 11161     CALL 'kxdfhei1' USING DFHEIV0,
 11162           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 227
* EL689.cbl
 11163           W-TEXT-KEY,
 11164           DFHEIV99,
 11165           DFHEIV11,
 11166           DFHEIV99
 11167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11168
 11169
 11170
 11171* EXEC CICS HANDLE CONDITION
 11172*         ENDFILE    (2000-ENDBR)
 11173*    END-EXEC.
 11174*    MOVE '"$''                   ! * #00010793' TO DFHEIV0
 11175     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 11176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11177     MOVE X'2A20233030303130373933' TO DFHEIV0(25:11)
 11178     CALL 'kxdfhei1' USING DFHEIV0
 11179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11180
 11181
 11182 2000-READ-NEXT.
 11183
 11184     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 11185         MOVE ER-0051            TO EMI-ERROR
 11186         MOVE -1                 TO MAINTL
 11187         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11188         GO TO 2000-ENDBR.
 11189
 11190
 11191* EXEC CICS READNEXT
 11192*         DATASET    (W-TEXT-FILE-ID)
 11193*         SET        (ADDRESS OF TEXT-FILES)
 11194*         RIDFLD     (W-TEXT-KEY)
 11195*    END-EXEC.
 11196     MOVE 0
 11197       TO DFHEIV11
 11198*    MOVE '&.S                   )   #00010805' TO DFHEIV0
 11199     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11200     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11201     MOVE X'2020233030303130383035' TO DFHEIV0(25:11)
 11202     CALL 'kxdfhei1' USING DFHEIV0,
 11203           W-TEXT-FILE-ID,
 11204           DFHEIV20,
 11205           DFHEIV99,
 11206           W-TEXT-KEY,
 11207           DFHEIV99,
 11208           DFHEIV11,
 11209           DFHEIV99,
 11210           DFHEIV99
 11211     SET ADDRESS OF TEXT-FILES TO
 11212         DFHEIV20
 11213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11214
 11215
 11216     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 11217         GO TO 2000-ENDBR.
 11218
 11219     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 11220
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 228
* EL689.cbl
 11221     MOVE TX-FORM-SQUEEZE-CONTROL
 11222                                 TO W-FORM-SQUEEZE-IND.
 11223
 11224     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 11225         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 11226
 11227     IF  TX-FORM-CONTROL-LINE
 11228         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 11229         GO TO 2000-READ-NEXT.
 11230
 11231     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 11232         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 11233         GO TO 2000-READ-NEXT.
 11234
 11235     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 11236     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 11237     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 11238     MOVE TX-LINE-SQUEEZE-CONTROL
 11239                                 TO W-TX-SC (W-TG-NDX).
 11240
 11241     SET W-TG-NDX UP BY 1.
 11242     GO TO 2000-READ-NEXT.
 11243
 11244 2000-ENDBR.
 11245
 11246
 11247* EXEC CICS ENDBR
 11248*        DATASET     (W-TEXT-FILE-ID)
 11249*    END-EXEC.
 11250     MOVE 0
 11251       TO DFHEIV11
 11252*    MOVE '&2                    $   #00010841' TO DFHEIV0
 11253     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11254     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11255     MOVE X'2020233030303130383431' TO DFHEIV0(25:11)
 11256     CALL 'kxdfhei1' USING DFHEIV0,
 11257           W-TEXT-FILE-ID,
 11258           DFHEIV11,
 11259           DFHEIV99
 11260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11261
 11262
 11263     IF  W-TEXT-BROWSE-NOT-STARTED
 11264         MOVE ER-0006            TO EMI-ERROR
 11265         MOVE -1                 TO FORML
 11266         MOVE AL-UABON           TO FORMA
 11267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11268         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11269
 11270     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 11271     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 11272     MOVE 1                      TO PI-CURRENT-LINE.
 11273
 11274     IF  COPIESL NOT GREATER THAN ZEROS
 11275         MOVE +1                 TO COPIESI
 11276                                    PI-689-NUMBER-COPIES
 11277         MOVE +1                 TO COPIESL
 11278         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 229
* EL689.cbl
 11279
 11280***************************************************************
 11281*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 11282*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 11283***************************************************************
 11284
 11285     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 11286
 11287*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 11288*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 11289*            MOVE ER-7243        TO EMI-ERROR
 11290*            MOVE -1             TO PRTRESTL
 11291*            MOVE AL-UABON       TO PRTRESTA
 11292*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11293
 11294     IF  PI-CREATE-LABELS AND
 11295         NOT  PI-689-LABELS-OVERRIDEN
 11296         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11297         SET W-RG-NDX UP BY +1
 11298     ELSE
 11299         SET W-RG-NDX            TO +1.
 11300
 11301     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 11302     SET W-RG-NDX UP BY W-TOP-MARGIN.
 11303
 11304     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 11305
 11306     SET PI-TOTAL-LINES          TO W-RG-NDX.
 11307
 11308     IF  W-FIRST-BAD-VARIABLE-FOUND
 11309         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 11310         MOVE W-FIRST-BAD-VARIABLE
 11311                                 TO PI-CURRENT-LINE
 11312     ELSE
 11313         SET W-RG-NDX            TO 1.
 11314
 11315     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11316             VARYING
 11317         W-SC-NDX FROM 1 BY 1
 11318             UNTIL
 11319         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11320     IF  PI-689-CREATE-NO-SCREENS
 11321         GO TO 2000-EXIT
 11322     ELSE
 11323         IF  W-FORM-CHANGED
 11324             MOVE '3'            TO PI-ACTION
 11325             MOVE -1             TO MAINTL
 11326             GO TO 8100-SEND-INITIAL-MAP
 11327         ELSE
 11328             MOVE '3'            TO PI-ACTION
 11329             MOVE -1             TO MAINTL
 11330             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11331
 11332 2000-EXIT.
 11333     EXIT.
 11334
 11335 2001-NOT-FOUND.
 11336
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 230
* EL689.cbl
 11337     MOVE ER-0006                TO EMI-ERROR.
 11338     MOVE -1                     TO FORML.
 11339     MOVE AL-UABON               TO FORMA.
 11340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11341     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 231
* EL689.cbl
 11343 2100-PROCESS-FORM-CONTROL-LINE.
 11344
 11345     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 11346
 11347     IF  W-LC-LINE-WIDTH NUMERIC
 11348             AND
 11349         W-LC-LINE-WIDTH GREATER THAN ZEROS
 11350         COMPUTE W-INITIAL-COLUMN
 11351             = (70 - W-LC-LINE-WIDTH) / 2
 11352         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 11353         COMPUTE W-LAST-COLUMN ROUNDED
 11354             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 11355         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 11356     ELSE
 11357         MOVE 70                 TO W-LC-LINE-WIDTH.
 11358
 11359     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 11360             AND
 11361         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 11362         MOVE W-LC-PARAGRAPH-INDENT
 11363                                 TO W-PARAGRAPH-INDENT.
 11364
 11365     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 11366             AND
 11367         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 11368         MOVE W-LC-MAX-LINES-PER-PAGE
 11369                                 TO W-MAX-LINES-PER-PAGE.
 11370
 11371     IF  W-LC-LINE-ADJUST NUMERIC
 11372             AND
 11373         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11374         COMPUTE W-TOTAL-LINE-LENGTH
 11375             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11376         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11377             ADD W-LC-LINE-ADJUST
 11378                                 TO W-INITIAL-COLUMN
 11379                                    W-LAST-COLUMN
 11380                                    W-START-COLUMN
 11381                                    W-TOO-FAR.
 11382
 11383     IF  W-LC-LINE-INDENT-1 NUMERIC
 11384             AND
 11385         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11386         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11387     ELSE
 11388         MOVE +0                 TO W-LINE-INDENT-1.
 11389
 11390     IF  W-LC-LINE-INDENT-2 NUMERIC
 11391             AND
 11392         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11393         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11394     ELSE
 11395         MOVE +0                 TO W-LINE-INDENT-2.
 11396
 11397     IF  W-LC-LINE-INDENT-3 NUMERIC
 11398             AND
 11399         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11400         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 232
* EL689.cbl
 11401     ELSE
 11402         MOVE +0                 TO W-LINE-INDENT-3.
 11403
 11404     IF  W-LC-LINE-INDENT-4 NUMERIC
 11405             AND
 11406         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11407         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11408     ELSE
 11409         MOVE +0                 TO W-LINE-INDENT-4.
 11410
 11411     IF  W-LC-LINE-INDENT-5 NUMERIC
 11412             AND
 11413         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11414         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11415
 11416     ELSE
 11417         MOVE +0                 TO W-LINE-INDENT-5.
 11418
 11419     IF  W-LC-TOP-MARGIN NUMERIC
 11420         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11421     ELSE
 11422         MOVE +0                 TO W-TOP-MARGIN.
 11423
 11424     IF W-LC-CASE-IND = 'Y' OR 'N'
 11425         NEXT SENTENCE
 11426     ELSE
 11427         MOVE PI-LOWER-CASE-LETTERS
 11428                                 TO W-LC-CASE-IND.
 11429
 11430 2100-EXIT.
 11431     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 233
* EL689.cbl
 11433 2150-PROCESS-Z-CONTROLS.
 11434
 11435     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11436
 11437     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11438        IF W-DAYS-TO-RESEND NUMERIC
 11439           IF W-DAYS-TO-RESEND > ZEROS
 11440              MOVE '6'           TO DC-OPTION-CODE
 11441              MOVE W-SAVE-BIN-NEXT-BUS-DT
 11442                                 TO DC-BIN-DATE-1
 11443              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11444              MOVE W-DAYS-TO-RESEND
 11445                                 TO DC-ELAPSED-DAYS
 11446              PERFORM 9500-LINK-DATE-CONVERT
 11447                                 THRU 9500-EXIT
 11448              IF NO-CONVERSION-ERROR
 11449                 MOVE DC-BIN-DATE-2
 11450                                 TO PI-689-RESEND-DATE-1
 11451                 MOVE DC-GREG-DATE-1-EDIT
 11452                                 TO RESEND1O
 11453                                    PI-689-RESEND1-EDIT
 11454                 MOVE AL-UANON
 11455                                 TO RESEND1A
 11456                 MOVE +8         TO RESEND1L
 11457              ELSE
 11458                 MOVE ER-3770
 11459                                 TO EMI-ERROR
 11460                 MOVE -1         TO MAINTL
 11461                 PERFORM 9900-ERROR-FORMAT
 11462                                 THRU 9900-EXIT
 11463                 GO TO 8200-SEND-DATAONLY
 11464              END-IF
 11465           END-IF
 11466        END-IF
 11467     END-IF
 11468     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11469        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11470     END-IF
 11471     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11472         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11473            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11474                 MOVE '6'        TO DC-OPTION-CODE
 11475                 MOVE W-SAVE-BIN-DATE
 11476                                 TO DC-BIN-DATE-1
 11477                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11478                 MOVE W-DAYS-TO-FOLLOW-UP
 11479                                 TO DC-ELAPSED-DAYS
 11480                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11481                 IF  NO-CONVERSION-ERROR
 11482                     MOVE DC-BIN-DATE-2
 11483                                 TO PI-689-FOLLOW-UP-DATE
 11484                     MOVE DC-GREG-DATE-1-EDIT
 11485                                 TO FOLLOWO
 11486                     MOVE AL-UANON
 11487                                 TO FOLLOWA
 11488                     MOVE +8     TO FOLLOWL
 11489                 ELSE
 11490                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 234
* EL689.cbl
 11491                                 TO EMI-ERROR
 11492                     MOVE -1     TO MAINTL
 11493                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11494                     GO TO 8200-SEND-DATAONLY.
 11495
 11496     IF  COPIESI NOT NUMERIC
 11497             OR
 11498         COPIESI NOT GREATER THAN ZEROS
 11499         IF  W-NUMBER-OF-COPIES NUMERIC
 11500             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11501                 MOVE W-NUMBER-OF-COPIES
 11502                                 TO COPIESI
 11503                                    PI-689-NUMBER-COPIES
 11504                 MOVE AL-UNNON   TO COPIESA
 11505                 MOVE +1         TO COPIESL
 11506             ELSE
 11507                 MOVE +1         TO COPIESI
 11508                                    PI-689-NUMBER-COPIES
 11509                 MOVE AL-UNNON   TO COPIESA
 11510                 MOVE +1         TO COPIESL
 11511         ELSE
 11512             MOVE +1             TO COPIESI
 11513                                    PI-689-NUMBER-COPIES
 11514             MOVE AL-UNNON       TO COPIESA
 11515             MOVE +1             TO COPIESL.
 11516
 11517     IF W-PROMPT-LETTER EQUAL 'Y'
 11518         MOVE 'Y'                TO PI-PROMPT-IND
 11519         MOVE ER-0894            TO EMI-ERROR
 11520         MOVE -1                 TO MAINTL
 11521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11522     END-IF.
 11523
 11524     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11525                                           ENCO
 11526     MOVE AL-UANON                      TO ENCA
 11527     MOVE +3                            TO ENCL
 11528
 11529     IF W-PRINT-CERTIFICATE = 'Y'
 11530        MOVE 'Y' TO PI-CERT-REQ-IND
 11531        IF CERTIDL > ZEROS
 11532            IF CERTIDI NUMERIC
 11533              MOVE AL-UANON      TO CERTIDA
 11534              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11535            ELSE
 11536              MOVE ER-1778       TO EMI-ERROR
 11537              MOVE -1            TO CERTIDL
 11538              MOVE AL-UABON      TO CERTIDA
 11539              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11540           END-IF
 11541        ELSE
 11542              MOVE ER-0715       TO EMI-ERROR
 11543              MOVE -1            TO CERTIDL
 11544              MOVE AL-UABON      TO CERTIDA
 11545              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11546        END-IF
 11547     END-IF.
 11548
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 235
* EL689.cbl
 11549     IF W-REASONS-REQUIRED = 'Y'
 11550        MOVE 'Y' TO PI-REASON-REQ-IND
 11551        IF PI-ENDT-ARCH-NO NOT > ZERO
 11552          MOVE ER-9840       TO EMI-ERROR
 11553          MOVE -1            TO FORML
 11554          MOVE AL-UABON      TO FORMA
 11555          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11556        END-IF
 11557     END-IF.
 11558
 11559*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11560*                                       SPACES
 11561*        IF  W-PRINT-RESTRICTED
 11562*            MOVE W-PRINT-RESTRICTED-IND
 11563*                                TO PRTRESTI
 11564*                                   PI-689-PRINT-RESTRICTION
 11565*            MOVE AL-UANON       TO PRTRESTA
 11566*            MOVE +1             TO PRTRESTL.
 11567     .
 11568 2150-EXIT.
 11569     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 236
* EL689.cbl
 11571 2200-CHECK-FOR-VARIABLE.
 11572
 11573     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11574         GO TO 2200-EXIT.
 11575
 11576     SET W-TX-NDX                TO +1.
 11577
 11578 2200-CONTINUE.
 11579
 11580     SEARCH W-TX-CHAR
 11581         VARYING
 11582             W-TX-NDX
 11583         AT END
 11584             GO TO 2200-EXIT
 11585         WHEN
 11586             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11587             NEXT SENTENCE.
 11588
 11589     SET W-TX-NDX UP BY +1.
 11590
 11591     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11592         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11593         GO TO 2200-CONTINUE.
 11594
 11595 2200-EXIT.
 11596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 237
* EL689.cbl
 11598 2220-BUILD-VARIABLE-NUMBER.
 11599
 11600     SET W-TX-NDX UP BY +1.
 11601     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11602     SET W-TX-NDX UP BY +1.
 11603     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11604     SET W-TX-NDX UP BY +1.
 11605     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11606
 11607     IF  W-VAR-RELATIVE-NUM NUMERIC
 11608         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11609         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11610
 11611 2220-EXIT.
 11612     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 238
* EL689.cbl
 11614 4000-ROLL-PAGE.
 11615
 11616     IF  ENTERPFL NOT EQUAL ZEROS
 11617         MOVE -1                 TO ENTERPFL
 11618     ELSE
 11619         MOVE -1                 TO MAINTL.
 11620
 11621     IF  PI-TOTAL-LINES EQUAL 0
 11622         MOVE ER-0047            TO EMI-ERROR
 11623         MOVE -1                 TO MAINTL
 11624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625         GO TO 8200-SEND-DATAONLY.
 11626
 11627     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11628         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11629
 11630     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11631             OR
 11632         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11633         MOVE ER-0067            TO EMI-ERROR
 11634         MOVE -1                 TO MAINTL
 11635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11636         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11637
 11638*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11639*            AND
 11640*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11641*        MOVE ER-0066            TO EMI-ERROR
 11642*        MOVE -1                 TO MAINTL
 11643*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644*        COMPUTE W-TEMP-CURRENT-LINE
 11645*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11646*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11647*                OR
 11648*            W-TEMP-CURRENT-LINE = ZEROS
 11649*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11650
 11651     IF  EMI-ERROR NOT EQUAL ER-0191
 11652             AND
 11653         MAINTI NOT EQUAL 'S'
 11654         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11655         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11656         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11657                 VARYING
 11658             W-SC-NDX FROM 1 BY 1
 11659                 UNTIL
 11660             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11661
 11662     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11663                         ER-0191
 11664         NEXT SENTENCE
 11665     ELSE
 11666         GO TO 8200-SEND-DATAONLY.
 11667
 11668     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11669     SET W-RG-NDX                TO PI-CURRENT-LINE
 11670     MOVE LOW-VALUES             TO EL689RI
 11671*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 239
* EL689.cbl
 11672     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11673     SET W-RG-NDX                TO PI-CURRENT-LINE
 11674     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11675             VARYING
 11676         W-SC-NDX FROM 1 BY 1
 11677             UNTIL
 11678         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11679
 11680     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 240
* EL689.cbl
 11682 4100-SET-NDX.
 11683
 11684     IF  PI-CURRENT-LINE EQUAL 0
 11685         SET W-RG-NDX            TO 1
 11686     ELSE
 11687         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11688
 11689 4100-EXIT.
 11690      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 241
* EL689.cbl
 11692 4200-UPDATE-TABLE-FROM-SCREEN.
 11693
 11694     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11695         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11696         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11697             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11698                 MOVE ER-0051    TO EMI-ERROR
 11699                 MOVE -1         TO MAINTL
 11700                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11701                 GO TO 8200-SEND-DATAONLY
 11702             ELSE
 11703                 MOVE W-SC-TEXT (W-SC-NDX)
 11704                                 TO W-RC-TEXT (W-RG-NDX)
 11705                 ADD 1           TO PI-TOTAL-LINES
 11706         ELSE
 11707             MOVE W-SC-TEXT (W-SC-NDX)
 11708                                 TO W-RC-TEXT (W-RG-NDX).
 11709
 11710     SET W-RG-NDX UP BY 1.
 11711
 11712 4200-EXIT.
 11713      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 242
* EL689.cbl
 11715
 11716
 11717 4500-CONNECT-TO-DB.
 11718
 11719     MOVE 'NTCSO2_LOGIC'         TO SVR
 11720     MOVE 'sa'                   TO USR
 11721     MOVE 'ntcso2'               TO PASS
 11722
 11723     STRING
 11724         USR DELIMITED SPACE
 11725         "." DELIMITED SIZE
 11726         PASS DELIMITED SPACE INTO USR-PASS
 11727     END-STRING
 11728
 11729     EXEC SQL
 11730        CONNECT TO :SVR USER :USR-PASS
 11731     END-EXEC
 11732
 11733     IF SQLCODE NOT = 0
 11734        DISPLAY "ERROR: CANNOT CONNECT "
 11735        DISPLAY SQLCODE
 11736        DISPLAY SQLERRMC
 11737        GO TO 4500-EXIT
 11738     END-IF
 11739
 11740     .
 11741 4500-EXIT.
 11742     EXIT.
 11743
 11744
 11745
 11746 4600-GET-NEXT-BUS-DT.
 11747
 11748     MOVE W-SAVE-EDIT-A-DATE     TO WS-CYCLE-DATE
 11749     MOVE SPACES                 TO WS-NEXT-BUS-DT
 11750
 11751     IF WS-KIXHOST = 'logictest'
 11752        EXEC SQL
 11753          CALL NaperTestCalcNextBusDt
 11754                        @cycledate = :WS-CYCLE-DATE,
 11755                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11756        END-EXEC
 11757     ELSE
 11758        EXEC SQL
 11759          CALL NaperProdCalcNextBusDt
 11760                        @cycledate = :WS-CYCLE-DATE,
 11761                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11762        END-EXEC
 11763     END-IF
 11764
 11765     IF SQLCODE NOT = 0
 11766        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
 11767        DISPLAY ' SQL RETURN CODE ' SQLCODE
 11768        DISPLAY ' SQL ERR MESS    ' SQLERRMC
 11769        GO TO 4600-EXIT
 11770     END-IF
 11771
 11772     .
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 243
* EL689.cbl
 11773 4600-EXIT.
 11774     EXIT.
 11775
 11776
 11777
 11778 4700-DISCONNECT.
 11779
 11780     EXEC SQL
 11781        DISCONNECT
 11782     END-EXEC
 11783     .
 11784 4700-EXIT.
 11785     EXIT.
 11786
 11787 5000-EDIT-MODE.
 11788***************************************************************
 11789*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11790*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11791*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11792***************************************************************
 11793
 11794     IF  PI-SHOW-MODE
 11795         MOVE ER-0188            TO EMI-ERROR
 11796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11797         MOVE -1                 TO MAINTL
 11798         MOVE AL-UABON           TO MAINTA
 11799         GO TO 8200-SEND-DATAONLY.
 11800
 11801     IF  PI-CURRENT-LINE EQUAL ZEROS
 11802         MOVE ER-0187            TO EMI-ERROR
 11803         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804         MOVE -1                 TO MAINTL
 11805         GO TO 8200-SEND-DATAONLY.
 11806
 11807     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11808     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11809     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11810             VARYING
 11811         W-SC-NDX FROM 1 BY 1
 11812             UNTIL
 11813         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11814
 11815     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11816
 11817     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11818     MOVE ZEROS                  TO PI-UPDATE-SW.
 11819     MOVE '1'                    TO PI-ENTRY-CD-1.
 11820     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11821     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 244
* EL689.cbl
 11823 5400-LETTER-RELEASE.
 11824***************************************************************
 11825*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11826*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11827*    THE ARCHIVE FILE.                                        *
 11828*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11829*        1. CHECK SECURITY.                                   *
 11830*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11831*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11832*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11833*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11834*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11835***************************************************************
 11836
 11837     IF  NOT MODIFY-CAP
 11838         MOVE ER-0070            TO EMI-ERROR
 11839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11840         MOVE -1                 TO MAINTL
 11841         GO TO 8200-SEND-DATAONLY.
 11842
 11843     IF  PI-SHOW-MODE
 11844         MOVE ER-0188            TO EMI-ERROR
 11845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11846         MOVE -1                 TO MAINTL
 11847         MOVE AL-UABON           TO MAINTA
 11848         GO TO 8200-SEND-DATAONLY.
 11849
 11850      IF  ARCHNUML GREATER THAN ZEROS
 11851          MOVE ER-9320            TO EMI-ERROR
 11852          MOVE -1                 TO ARCHNUML
 11853          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11854          GO TO 8200-SEND-DATAONLY.
 11855
 11856*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11857*        MOVE ER-0187            TO EMI-ERROR
 11858*        MOVE -1                 TO MAINTL
 11859*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11860*        GO TO 8200-SEND-DATAONLY.
 11861
 11862*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11863*
 11864*    IF  NOT PI-689-CREATE-NO-SCREENS
 11865*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11866*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11867*                VARYING
 11868*            W-SC-NDX FROM 1 BY 1
 11869*                UNTIL
 11870*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11871*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11872*                OR
 11873*            PI-689-FATAL-ERROR
 11874*            GO TO 8200-SEND-DATAONLY.
 11875*
 11876*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11877*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11878*            VARYING
 11879*        W-RVS-NDX FROM +1 BY +1
 11880*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 245
* EL689.cbl
 11881*        W-RVS-NDX > +36500
 11882*            OR
 11883*        W-REMAINING-VAR-FOUND.
 11884*
 11885*    IF  NOT PI-689-CREATE-NO-SCREENS
 11886*        IF  W-REMAINING-VAR-FOUND
 11887*            GO TO 4000-ROLL-PAGE.
 11888
 11889*    MOVE SPACES                 TO W-CNTL-KEY.
 11890*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11891*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11892*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11893*
 11894*    EXEC CICS HANDLE CONDITION
 11895*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11896*         NOTFND     (5470-CNTL-NOT-FOUND)
 11897*    END-EXEC.
 11898*
 11899*    EXEC CICS READ
 11900*         DATASET    (W-CNTL-FILE-ID)
 11901*         SET        (ADDRESS OF CONTROL-FILE)
 11902*         RIDFLD     (W-CNTL-KEY)
 11903*         UPDATE
 11904*    END-EXEC.
 11905*
 11906*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11907*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11908*                                   CF-CREDIT-START-ARCH-NUM.
 11909*
 11910*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11911*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11912*                                TO W-ARCH-NUMBER
 11913*                                   W-ARCT-NUMBER.
 11914*
 11915*    EXEC CICS REWRITE
 11916*         FROM      (CONTROL-FILE)
 11917*         DATASET   (W-CNTL-FILE-ID)
 11918*    END-EXEC
 11919
 11920*    EXEC CICS HANDLE CONDITION
 11921*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11922*    END-EXEC.
 11923*
 11924*    EXEC CICS GETMAIN
 11925*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11926*       LENGTH   (W-ARCH-LENGTH)
 11927*    END-EXEC
 11928*
 11929*    MOVE SPACES                 TO LETTER-ARCHIVE
 11930*    MOVE 'LA'                   TO LA-RECORD-ID.
 11931*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11932*                                   LA-ARCHIVE-NO-A2
 11933*                                   LA-ARCHIVE-NO-A3
 11934*                                   LA-ARCHIVE-NO-A4
 11935*                                   LA-ARCHIVE-NO-A5
 11936*                                   LA-ARCHIVE-NO-A6
 11937*                                   PI-689-ARCHIVE-NUMBER.
 11938*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 246
* EL689.cbl
 11939*                                   LA-COMPANY-CD-A2
 11940*                                   LA-COMPANY-CD-A3
 11941*                                   LA-COMPANY-CD-A4
 11942*                                   LA-COMPANY-CD-A5
 11943*                                   LA-COMPANY-CD-A6.
 11944*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11945*                                   LA-CARRIER-A3
 11946*                                   LA-CARRIER-A4
 11947*                                   LA-CARRIER-A5.
 11948*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11949*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11950*                                   LA-GROUPING-A3
 11951*                                   LA-GROUPING-A4
 11952*                                   LA-GROUPING-A5.
 11953*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11954*                                   LA-ACCOUNT-A3
 11955*                                   LA-ACCOUNT-A4
 11956*                                   LA-ACCOUNT-A5.
 11957*    MOVE PI-689-STATE           TO LA-STATE-A2
 11958*                                   LA-STATE-A3
 11959*                                   LA-STATE-A4
 11960*                                   LA-STATE-A5.
 11961*
 11962*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11963*            AND
 11964*        PI-689-RESP-PERSON GREATER THAN SPACES
 11965*        MOVE PI-689-RESP-PERSON
 11966*                                TO LA-RESP-PERSON-A2
 11967*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11968*    ELSE
 11969*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11970*            MOVE PI-689-CERT-PRIME
 11971*                                TO LA-CERT-PRIME-A2
 11972*            MOVE PI-689-CERT-SFX
 11973*                                TO LA-CERT-SUFFIX-A2
 11974*        ELSE
 11975*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11976*                                   LA-TYPE-A2.
 11977*
 11978*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11979*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11980*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11981*                AND
 11982*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11983*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11984*            MOVE 'CK'           TO LA-FILLER
 11985*        ELSE
 11986*            NEXT SENTENCE
 11987*    ELSE
 11988*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11989*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11990*            MOVE 'CK'           TO LA-FILLER
 11991*        ELSE
 11992*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11993*
 11994*    MOVE ZEROS                  TO W-SEQ-CTR.
 11995*
 11996*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 247
* EL689.cbl
 11997*
 11998*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11999*                                   LA-INITIAL-PRINT-DATE
 12000*                                   LA-SENT-DATE
 12001*                                   LA-REPLY-DATE.
 12002*    MOVE 'A'                    TO LA-STATUS.
 12003*
 12004*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 12005*            OR
 12006*        PI-689-NUMBER-COPIES EQUAL ZEROS
 12007*        MOVE  1                 TO LA-NO-OF-COPIES
 12008*    ELSE
 12009*        MOVE PI-689-NUMBER-COPIES
 12010*                                TO LA-NO-OF-COPIES.
 12011*
 12012*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 12013*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 12014*    MOVE PI-689-PRINT-RESTRICTION
 12015*                                TO LA-PRINT-RESTRICTION
 12016*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 12017*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 12018*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 12019*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 12020*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 12021*
 12022*    IF  PI-689-PRINT-PERFORMED
 12023*        MOVE SPACES             TO PI-689-PRINT-SW
 12024*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 12025*        IF  LA-RESEND-DATE = LOW-VALUES
 12026*            MOVE 'C'            TO LA-STATUS.
 12027*
 12028*    MOVE PI-689-NUMBER-LABEL-LINES
 12029*                                TO LA-NUMBER-LABEL-LINES.
 12030*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 12031*
 12032*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 12033*
 12034*    MOVE PI-689-NUMBER-TEXT-RECORDS
 12035*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 12036*
 12037*    EXEC CICS HANDLE CONDITION
 12038*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 12039*    END-EXEC.
 12040*
 12041*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 12042*    MOVE ER-0280                TO EMI-ERROR.
 12043*    MOVE -1                     TO MAINTL.
 12044*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12045*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12046*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 12047     .
 12048 5400-END.
 12049     DISPLAY ' MADE IT TO 5400 '
 12050     MOVE SPACES                 TO BL-INPUT
 12051     MOVE ZEROS                  TO BL-ARCHIVE-NO
 12052     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 12053     MOVE PI-689-CARRIER         TO BL-CARRIER
 12054     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 248
* EL689.cbl
 12055     MOVE PI-689-STATE           TO BL-STATE
 12056     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 12057     IF PI-689-EFF-DATE NOT = LOW-VALUES
 12058        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 12059        MOVE ' '                 TO DC-OPTION-CODE
 12060        PERFORM 9500-LINK-DATE-CONVERT
 12061                                 THRU 9500-EXIT
 12062        IF NO-CONVERSION-ERROR
 12063           MOVE DC-GREG-DATE-1-EDIT
 12064                                 TO BL-EFF-DT
 12065        END-IF
 12066     END-IF
 12067     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 12068     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 12069     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 12070     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 12071     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 12072     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 12073     IF PI-ENDT-ARCH-NO > ZERO
 12074         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 12075     END-IF
 12076     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 12077     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 12078*    MOVE 'ALWA'                 TO BL-PROC-ID
 12079     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 12080*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 12081     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 12082     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 12083        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 12084        MOVE ' '                 TO DC-OPTION-CODE
 12085        PERFORM 9500-LINK-DATE-CONVERT
 12086                                 THRU 9500-EXIT
 12087        IF NO-CONVERSION-ERROR
 12088           MOVE DC-GREG-DATE-B-EDIT
 12089                                 TO BL-RESEND-DT
 12090        END-IF
 12091     END-IF
 12092     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 12093        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 12094        MOVE ' '                 TO DC-OPTION-CODE
 12095        PERFORM 9500-LINK-DATE-CONVERT
 12096                                 THRU 9500-EXIT
 12097        IF NO-CONVERSION-ERROR
 12098           MOVE DC-GREG-DATE-B-EDIT
 12099                                 TO BL-FOLLOW-UP-DT
 12100        END-IF
 12101     END-IF
 12102*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 12103*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 12104     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 12105     if eibaid = dfhpf7
 12106        move 'B'                 TO BL-WRITE-ERARCH
 12107     else
 12108        move 'T'                 to bl-write-erarch
 12109     end-if
 12110    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 12111*****************************************
 12112* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 249
* EL689.cbl
 12113*****************************************
 12114
 12115* exec cics link
 12116*       program('NSRASBL')
 12117*       commarea(srch-commarea)
 12118*    end-exec.
 12119     MOVE LENGTH OF
 12120      srch-commarea
 12121       TO DFHEIV11
 12122     MOVE 'NSRASBL' TO DFHEIV1
 12123*    MOVE '."C                   (   #00011696' TO DFHEIV0
 12124     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12126     MOVE X'2020233030303131363936' TO DFHEIV0(25:11)
 12127     CALL 'kxdfhei1' USING DFHEIV0,
 12128           DFHEIV1,
 12129           srch-commarea,
 12130           DFHEIV11,
 12131           DFHEIV99,
 12132           DFHEIV99,
 12133           DFHEIV99,
 12134           DFHEIV99
 12135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12136
 12137     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 12138        bl-message ' ' bl-archive-no
 12139     move bl-archive-no to w-arch-number
 12140
 12141     if eibaid = dfhpf7
 12142        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 12143        MOVE ER-0280                TO EMI-ERROR
 12144        MOVE -1                     TO MAINTL
 12145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12146        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12147        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 12148        MOVE '2'                    TO PI-ACTION
 12149        MOVE ZEROS                  TO PI-TOTAL-LINES
 12150                                       PI-CURRENT-LINE
 12151        MOVE SPACES                 TO PI-689-PRINT-SW
 12152                                       PI-689-FORM-NUMBER
 12153        GO TO 9300-DFHCLEAR
 12154     else
 12155        move w-arch-number          to archnumo
 12156        MOVE ER-1818                TO EMI-ERROR
 12157        MOVE -1                     TO MAINTL
 12158        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12159     end-if
 12160     MOVE -1                     TO MAINTL
 12161     GO TO 8200-SEND-DATAONLY
 12162     .
 12163 5400-EXIT.
 12164     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 250
* EL689.cbl
 12166 5410-CREATE-TEXT-RECORDS.
 12167
 12168*    EXEC CICS HANDLE CONDITION
 12169*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 12170*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 12171*    END-EXEC.
 12172*
 12173*    IF  PI-689-CREATE-NO-SCREENS
 12174*        IF  PI-689-GET-ARCT-MAIN
 12175*            EXEC CICS GETMAIN
 12176*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12177*                 LENGTH   (W-ARCT-LENGTH)
 12178*            END-EXEC
 12179*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 12180*                                    LETTER-ARCHIVE-TEXT
 12181*            MOVE LCP-WS-ADDR-COMP
 12182*                                TO PI-689-ARCT-POINTER
 12183*        ELSE
 12184*            MOVE PI-689-ARCT-POINTER
 12185*                                TO LCP-WS-ADDR-COMP
 12186*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 12187*                                TO LCP-WS-ADDR-PNTR
 12188*    ELSE
 12189*        EXEC CICS GETMAIN
 12190*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12191*             LENGTH   (W-ARCT-LENGTH)
 12192*        END-EXEC.
 12193*
 12194*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12195*
 12196*    MOVE ZEROS                  TO W-SEQ-CTR
 12197*
 12198*    IF  PI-CREATE-LABELS AND
 12199*        NOT PI-689-LABELS-OVERRIDEN
 12200*        MOVE '1'                TO LT-RECORD-TYPE
 12201*        MOVE +0                 TO LT-LINE-SEQ-NO
 12202*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 12203*                VARYING
 12204*            W-RG-NDX FROM 1 BY 1
 12205*                UNTIL
 12206*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 12207*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12208*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 12209*    ELSE
 12210*        SET W-RG-NDX            TO +1.
 12211*
 12212*    SET LT-NDX                  TO W-ZEROS.
 12213*
 12214*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 12215*            VARYING
 12216*        W-RG-NDX FROM W-RG-NDX BY +1
 12217*            UNTIL
 12218*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 12219
 12220 5410-EXIT.
 12221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 251
* EL689.cbl
 12223 5415-INITIALIZE-TEXT.
 12224
 12225     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 12226     MOVE 'LT'                   TO LT-RECORD-ID.
 12227
 12228     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 12229     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 12230
 12231     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 12232                                    LT-NUM-LINES-ON-RECORD.
 12233
 12234 5415-EXIT.
 12235     EXIT.
 12236
 12237 5440-ADD-BILLING-NOTE.
 12238
 12239     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 12240     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 12241     MOVE '5'                    TO W-EOBC-REC-TYPE
 12242
 12243
 12244* EXEC CICS STARTBR
 12245*        DATASET   ('ELEOBC')
 12246*        RIDFLD    (W-ELEOBC-KEY)
 12247*        GTEQ
 12248*        RESP      (W-RESPONSE)
 12249*    END-EXEC
 12250     MOVE 'ELEOBC' TO DFHEIV1
 12251     MOVE 0
 12252       TO DFHEIV11
 12253*    MOVE '&,         G          &  N#00011806' TO DFHEIV0
 12254     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12255     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12256     MOVE X'204E233030303131383036' TO DFHEIV0(25:11)
 12257     CALL 'kxdfhei1' USING DFHEIV0,
 12258           DFHEIV1,
 12259           W-ELEOBC-KEY,
 12260           DFHEIV99,
 12261           DFHEIV11,
 12262           DFHEIV99
 12263     MOVE EIBRESP  TO W-RESPONSE
 12264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12265
 12266     IF NOT RESP-NORMAL
 12267        GO TO 5440-EXIT
 12268     END-IF
 12269      .
 12270 5440-READNEXT-ELEOBC.
 12271
 12272
 12273* EXEC CICS READNEXT
 12274*       INTO    (EOB-CODES)
 12275*       DATASET ('ELEOBC')
 12276*       RIDFLD  (W-ELEOBC-KEY)
 12277*       RESP    (W-RESPONSE)
 12278*    END-EXEC
 12279     MOVE LENGTH OF
 12280      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 252
* EL689.cbl
 12281       TO DFHEIV12
 12282     MOVE 'ELEOBC' TO DFHEIV1
 12283     MOVE 0
 12284       TO DFHEIV11
 12285*    MOVE '&.IL                  )  N#00011819' TO DFHEIV0
 12286     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12287     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12288     MOVE X'204E233030303131383139' TO DFHEIV0(25:11)
 12289     CALL 'kxdfhei1' USING DFHEIV0,
 12290           DFHEIV1,
 12291           EOB-CODES,
 12292           DFHEIV12,
 12293           W-ELEOBC-KEY,
 12294           DFHEIV99,
 12295           DFHEIV11,
 12296           DFHEIV99,
 12297           DFHEIV99
 12298     MOVE EIBRESP  TO W-RESPONSE
 12299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12300
 12301     IF RESP-NORMAL
 12302         IF EO-RECORD-TYPE NOT = '5'
 12303             GO TO 5440-EXIT
 12304         END-IF
 12305     ELSE
 12306         GO TO 5440-EXIT
 12307     END-IF
 12308
 12309     IF EO-RECORD-TYPE = '5' AND
 12310        EO-EOB-CODE = PI-689-FORM-NUMBER
 12311           CONTINUE
 12312     ELSE
 12313         GO TO 5440-READNEXT-ELEOBC
 12314     END-IF
 12315
 12316     MOVE SPACES TO W-BILLING-NOTE
 12317     MOVE EO-DESCRIPTION TO W-BN-NOTE
 12318     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 12319     MOVE W-SAVE-DATE TO W-BN-DATE
 12320     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 12321     MOVE +25 TO W-LEN
 12322
 12323     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 12324     .
 12325 5440-EXIT.
 12326     EXIT.
 12327
 12328 5441-UPDATE-BILLING-NOTE.
 12329
 12330     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 12331     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 12332     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 12333     MOVE PI-689-STATE           TO W-SV-STATE
 12334     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 12335     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 12336     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 12337     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 12338     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 253
* EL689.cbl
 12339
 12340
 12341* EXEC CICS READ
 12342*       DATASET    (W-NOTE-FILE-ID)
 12343*       RIDFLD     (W-ERNOTE-KEY)
 12344*       INTO       (CERTIFICATE-NOTE)
 12345*       RESP       (W-RESPONSE)
 12346*       UPDATE
 12347*    END-EXEC
 12348     MOVE LENGTH OF
 12349      CERTIFICATE-NOTE
 12350       TO DFHEIV11
 12351*    MOVE '&"IL       EU         (  N#00011865' TO DFHEIV0
 12352     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12353     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12354     MOVE X'204E233030303131383635' TO DFHEIV0(25:11)
 12355     CALL 'kxdfhei1' USING DFHEIV0,
 12356           W-NOTE-FILE-ID,
 12357           CERTIFICATE-NOTE,
 12358           DFHEIV11,
 12359           W-ERNOTE-KEY,
 12360           DFHEIV99,
 12361           DFHEIV99,
 12362           DFHEIV99
 12363     MOVE EIBRESP  TO W-RESPONSE
 12364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12365
 12366     IF RESP-NORMAL
 12367       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12368          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12369       END-IF
 12370       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12371          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12372       END-IF
 12373       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12374           (NOTE-SUB > +10) OR
 12375           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 12376                             W-BILLING-NOTE (1:W-LEN))
 12377       END-PERFORM
 12378       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 12379                              W-BILLING-NOTE (1:W-LEN)
 12380
 12381* EXEC CICS UNLOCK
 12382*           DATASET    (W-NOTE-FILE-ID)
 12383*        END-EXEC
 12384*    MOVE '&*                    #   #00011887' TO DFHEIV0
 12385     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12386     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12387     MOVE X'2020233030303131383837' TO DFHEIV0(25:11)
 12388     CALL 'kxdfhei1' USING DFHEIV0,
 12389           W-NOTE-FILE-ID,
 12390           DFHEIV99
 12391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12392       ELSE
 12393         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12394           (NOTE-SUB > +10) OR
 12395           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 12396         END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 254
* EL689.cbl
 12397         IF (NOTE-SUB < +11)
 12398           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 12399              NOTE-SUB <= CN-BILLING-END-LINE-NO
 12400                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12401           ELSE
 12402             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12403              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 12404                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 12405                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 12406             ELSE
 12407               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12408                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 12409                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12410                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 12411               ELSE
 12412                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 12413                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 12414                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 12415                                       CN-BILLING-START-LINE-NO
 12416                 ELSE
 12417                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 12418                 END-IF
 12419               END-IF
 12420             END-IF
 12421           END-IF
 12422           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12423           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12424           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12425
 12426* EXEC CICS REWRITE
 12427*             DATASET    (W-NOTE-FILE-ID)
 12428*             FROM       (CERTIFICATE-NOTE)
 12429*             RESP       (W-RESPONSE)
 12430*          END-EXEC
 12431     MOVE LENGTH OF
 12432      CERTIFICATE-NOTE
 12433       TO DFHEIV11
 12434*    MOVE '&& L                  %  N#00011923' TO DFHEIV0
 12435     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12436     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12437     MOVE X'204E233030303131393233' TO DFHEIV0(25:11)
 12438     CALL 'kxdfhei1' USING DFHEIV0,
 12439           W-NOTE-FILE-ID,
 12440           CERTIFICATE-NOTE,
 12441           DFHEIV11,
 12442           DFHEIV99
 12443     MOVE EIBRESP  TO W-RESPONSE
 12444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12445           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12446         END-IF
 12447       END-IF
 12448     ELSE
 12449        MOVE SPACES              TO CERTIFICATE-NOTE
 12450        MOVE 'CN'                TO CN-RECORD-ID
 12451        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12452                                    W-ERNOTE-KEY
 12453        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12454                                    CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 255
* EL689.cbl
 12455        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12456        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12457        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12458        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12459
 12460* EXEC CICS WRITE
 12461*          DATASET    (W-NOTE-FILE-ID)
 12462*          FROM       (CERTIFICATE-NOTE)
 12463*          RIDFLD     (W-ERNOTE-KEY)
 12464*          RESP       (W-RESPONSE)
 12465*       END-EXEC
 12466     MOVE LENGTH OF
 12467      CERTIFICATE-NOTE
 12468       TO DFHEIV11
 12469*    MOVE '&$ L                  ''  N#00011942' TO DFHEIV0
 12470     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12472     MOVE X'204E233030303131393432' TO DFHEIV0(25:11)
 12473     CALL 'kxdfhei1' USING DFHEIV0,
 12474           W-NOTE-FILE-ID,
 12475           CERTIFICATE-NOTE,
 12476           DFHEIV11,
 12477           W-ERNOTE-KEY,
 12478           DFHEIV99,
 12479           DFHEIV99
 12480     MOVE EIBRESP  TO W-RESPONSE
 12481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12482
 12483        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12484     END-IF
 12485
 12486     .
 12487 5441-EXIT.
 12488     EXIT.
 12489
 12490
 12491 5442-SQUEEZE-IT-IN.
 12492
 12493     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12494        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12495           NOTE-SUB = +10
 12496           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12497           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12498             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12499             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12500             MOVE +9 TO NOTE-SUB
 12501           END-IF
 12502        END-PERFORM
 12503     ELSE
 12504        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12505           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12506             UNTIL NOTE-SUB = +1
 12507             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12508             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12509                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12510                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12511                MOVE +2          TO NOTE-SUB
 12512             END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 256
* EL689.cbl
 12513           END-PERFORM
 12514        END-IF
 12515     END-IF
 12516
 12517     .
 12518 5442-EXIT.
 12519     EXIT.
 12520
 12521 5445-CERTIFICATE-UPDATE.
 12522
 12523     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12524
 12525
 12526* EXEC CICS READ
 12527*        DATASET  (W-CERT-FILE-ID)
 12528*        RIDFLD   (W-CERT-KEY)
 12529*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12530*        RESP     (W-RESPONSE)
 12531*        UPDATE
 12532*    END-EXEC
 12533*    MOVE '&"S        EU         (  N#00011991' TO DFHEIV0
 12534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12535     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12536     MOVE X'204E233030303131393931' TO DFHEIV0(25:11)
 12537     CALL 'kxdfhei1' USING DFHEIV0,
 12538           W-CERT-FILE-ID,
 12539           DFHEIV20,
 12540           DFHEIV99,
 12541           W-CERT-KEY,
 12542           DFHEIV99,
 12543           DFHEIV99,
 12544           DFHEIV99
 12545     SET ADDRESS OF CERTIFICATE-MASTER TO
 12546         DFHEIV20
 12547     MOVE EIBRESP  TO W-RESPONSE
 12548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12549
 12550     IF RESP-NORMAL
 12551        EVALUATE CM-NOTE-SW
 12552           WHEN '2'
 12553           WHEN '3'
 12554           WHEN '6'
 12555           WHEN '7'
 12556              SET NO-CERT-RW     TO TRUE
 12557           WHEN ' '
 12558              MOVE '2'           TO CM-NOTE-SW
 12559           WHEN '1'
 12560              MOVE '3'           TO CM-NOTE-SW
 12561           WHEN '4'
 12562              MOVE '6'           TO CM-NOTE-SW
 12563           WHEN '5'
 12564              MOVE '7'           TO CM-NOTE-SW
 12565        END-EVALUATE
 12566     END-IF
 12567     IF NOT NO-CERT-RW
 12568
 12569* EXEC CICS REWRITE
 12570*          FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 257
* EL689.cbl
 12571*          DATASET  (W-CERT-FILE-ID)
 12572*          RESP     (W-RESPONSE)
 12573*       END-EXEC
 12574     MOVE LENGTH OF
 12575      CERTIFICATE-MASTER
 12576       TO DFHEIV11
 12577*    MOVE '&& L                  %  N#00012017' TO DFHEIV0
 12578     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12579     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12580     MOVE X'204E233030303132303137' TO DFHEIV0(25:11)
 12581     CALL 'kxdfhei1' USING DFHEIV0,
 12582           W-CERT-FILE-ID,
 12583           CERTIFICATE-MASTER,
 12584           DFHEIV11,
 12585           DFHEIV99
 12586     MOVE EIBRESP  TO W-RESPONSE
 12587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12588     ELSE
 12589
 12590* EXEC CICS UNLOCK
 12591*          DATASET  (W-CERT-FILE-ID)
 12592*       END-EXEC
 12593*    MOVE '&*                    #   #00012023' TO DFHEIV0
 12594     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12595     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12596     MOVE X'2020233030303132303233' TO DFHEIV0(25:11)
 12597     CALL 'kxdfhei1' USING DFHEIV0,
 12598           W-CERT-FILE-ID,
 12599           DFHEIV99
 12600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12601     END-IF
 12602
 12603     .
 12604 5445-EXIT.
 12605     EXIT.
 12606
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 258
* EL689.cbl
 12608 5460-DUPLICATE-ARCHIVE-RCD.
 12609
 12610     IF  NOT PI-689-CREATE-NO-SCREENS
 12611
 12612* EXEC CICS SYNCPOINT ROLLBACK
 12613*        END-EXEC.
 12614*    MOVE '6"R                   !   #00012036' TO DFHEIV0
 12615     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12617     MOVE X'2020233030303132303336' TO DFHEIV0(25:11)
 12618     CALL 'kxdfhei1' USING DFHEIV0
 12619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12620
 12621
 12622     MOVE ER-9426                TO EMI-ERROR.
 12623     MOVE -1                     TO MAINTL.
 12624     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12625     GO TO 8200-SEND-DATAONLY.
 12626
 12627 5465-DUPLICATE-ARCH-TEXT.
 12628
 12629     IF  NOT PI-689-CREATE-NO-SCREENS
 12630
 12631* EXEC CICS SYNCPOINT ROLLBACK
 12632*        END-EXEC.
 12633*    MOVE '6"R                   !   #00012047' TO DFHEIV0
 12634     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12636     MOVE X'2020233030303132303437' TO DFHEIV0(25:11)
 12637     CALL 'kxdfhei1' USING DFHEIV0
 12638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12639
 12640
 12641     MOVE ER-7369                TO EMI-ERROR.
 12642     MOVE -1                     TO MAINTL.
 12643     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12644     GO TO 8200-SEND-DATAONLY.
 12645
 12646 5470-CNTL-NOT-FOUND.
 12647
 12648     MOVE ER-9299                TO EMI-ERROR.
 12649     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12650     MOVE -1                     TO MAINTL.
 12651     MOVE AL-UANON               TO MAINTA.
 12652     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 259
* EL689.cbl
 12654 5500-FORMAT-TEXT.
 12655
 12656     SET LT-NDX UP BY +1.
 12657
 12658     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12659         SET W-RG-NDX UP BY 1
 12660         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12661         MOVE W-RC-TEXT (W-RG-NDX)
 12662                                 TO LT-TEXT-LINE (LT-NDX)
 12663     ELSE
 12664         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12665             MOVE ZEROS          TO W-PRINT-CONTROL
 12666             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12667                     VARYING
 12668                 W-RG-NDX FROM W-RG-NDX BY 1
 12669                     UNTIL
 12670                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12671                     OR
 12672                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12673             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12674                 GO TO 5500-WRITE-TEST
 12675             ELSE
 12676                 MOVE W-PRINT-CONTROL
 12677                                 TO LT-SKIP-CONTROL (LT-NDX)
 12678                 MOVE W-RC-TEXT (W-RG-NDX)
 12679                                 TO LT-TEXT-LINE (LT-NDX)
 12680         ELSE
 12681             MOVE W-RC-TEXT (W-RG-NDX)
 12682                                 TO LT-TEXT-LINE (LT-NDX)
 12683             MOVE ZEROS          TO W-PRINT-CONTROL.
 12684
 12685     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12686
 12687 5500-WRITE-TEST.
 12688
 12689     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12690         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12691             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12692             MOVE '2'            TO LT-RECORD-TYPE
 12693             ADD +1              TO W-SEQ-CTR
 12694             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12695             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12696         ELSE
 12697             NEXT SENTENCE
 12698     ELSE
 12699         IF  LT-NDX EQUAL +20
 12700             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12701             MOVE '2'            TO LT-RECORD-TYPE
 12702             ADD +1              TO W-SEQ-CTR
 12703             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12704             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12705             SET LT-NDX          TO W-ZEROS
 12706             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12707
 12708 5500-EXIT.
 12709      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 260
* EL689.cbl
 12711 5505-FIND-USED-LINE.
 12712
 12713     ADD +1                      TO W-PRINT-CONTROL.
 12714
 12715 5505-EXIT.
 12716      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 261
* EL689.cbl
 12718 5600-FORMAT-ADDRESS-LINE.
 12719
 12720     SET LT-NDX                  TO W-RG-NDX.
 12721     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12722
 12723 5600-EXIT.
 12724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 262
* EL689.cbl
 12726 5650-WRITE-ARCHIVE.
 12727
 12728
 12729* EXEC CICS WRITE
 12730*         DATASET   (W-ARCH-FILE-ID)
 12731*         FROM      (LETTER-ARCHIVE)
 12732*         RIDFLD    (LA-CONTROL-PRIMARY)
 12733*    END-EXEC.
 12734     MOVE LENGTH OF
 12735      LETTER-ARCHIVE
 12736       TO DFHEIV11
 12737*    MOVE '&$ L                  ''   #00012137' TO DFHEIV0
 12738     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12739     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12740     MOVE X'2020233030303132313337' TO DFHEIV0(25:11)
 12741     CALL 'kxdfhei1' USING DFHEIV0,
 12742           W-ARCH-FILE-ID,
 12743           LETTER-ARCHIVE,
 12744           DFHEIV11,
 12745           LA-CONTROL-PRIMARY,
 12746           DFHEIV99,
 12747           DFHEIV99
 12748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12749
 12750
 12751 5650-EXIT.
 12752     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 263
* EL689.cbl
 12754 5655-WRITE-ARCHIVE-TEXT.
 12755
 12756
 12757* EXEC CICS WRITE
 12758*         DATASET   (W-ARCT-FILE-ID)
 12759*         FROM      (LETTER-ARCHIVE-TEXT)
 12760*         RIDFLD    (LT-CONTROL-PRIMARY)
 12761*    END-EXEC.
 12762     MOVE LENGTH OF
 12763      LETTER-ARCHIVE-TEXT
 12764       TO DFHEIV11
 12765*    MOVE '&$ L                  ''   #00012148' TO DFHEIV0
 12766     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12768     MOVE X'2020233030303132313438' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0,
 12770           W-ARCT-FILE-ID,
 12771           LETTER-ARCHIVE-TEXT,
 12772           DFHEIV11,
 12773           LT-CONTROL-PRIMARY,
 12774           DFHEIV99,
 12775           DFHEIV99
 12776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12777
 12778
 12779 5655-EXIT.
 12780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 264
* EL689.cbl
 12782 6000-RESOLVE-VARIABLES.
 12783***************************************************************
 12784*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12785*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12786*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12787*    RESOLVE ALL OF THE SYMBOLS.                              *
 12788*                                                             *
 12789***************************************************************
 12790
 12791     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12792     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12793     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12794     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12795     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12796*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12797     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12798     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12799     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12800     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12801     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12802     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12803     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12804     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12805
 12806     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12807
 12808 6000-EXIT.
 12809     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 265
* EL689.cbl
 12811 6200-GET-COMPANY-DATA.
 12812
 12813     IF  ADDRSI EQUAL '3'
 12814             AND
 12815         PI-CREATE-LABELS
 12816             AND
 12817         NOT PI-689-LABELS-OVERRIDEN
 12818         NEXT SENTENCE
 12819     ELSE
 12820         IF  W-FILE-NOT-USED (1)
 12821             GO TO 6200-EXIT.
 12822
 12823     MOVE SPACES                 TO W-CNTL-KEY.
 12824     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12825     MOVE +0                     TO W-CNTL-SEQ-NO.
 12826     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12827
 12828
 12829* EXEC CICS HANDLE CONDITION
 12830*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12831*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12832*    END-EXEC.
 12833*    MOVE '"$JI                  ! + #00012203' TO DFHEIV0
 12834     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12836     MOVE X'2B20233030303132323033' TO DFHEIV0(25:11)
 12837     CALL 'kxdfhei1' USING DFHEIV0
 12838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12839
 12840
 12841
 12842* EXEC CICS READ
 12843*         DATASET   (W-CNTL-FILE-ID)
 12844*         SET       (ADDRESS OF CONTROL-FILE)
 12845*         RIDFLD    (W-CNTL-KEY)
 12846*    END-EXEC.
 12847*    MOVE '&"S        E          (   #00012208' TO DFHEIV0
 12848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12850     MOVE X'2020233030303132323038' TO DFHEIV0(25:11)
 12851     CALL 'kxdfhei1' USING DFHEIV0,
 12852           W-CNTL-FILE-ID,
 12853           DFHEIV20,
 12854           DFHEIV99,
 12855           W-CNTL-KEY,
 12856           DFHEIV99,
 12857           DFHEIV99,
 12858           DFHEIV99
 12859     SET ADDRESS OF CONTROL-FILE TO
 12860         DFHEIV20
 12861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12862
 12863
 12864     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12865     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12866                                    W-VG-TEXT (25).
 12867     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12868     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 266
* EL689.cbl
 12869     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12870     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12871
 12872     IF  CF-CL-CAN-POST-CODE
 12873         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12874                                 TO W-CANADIAN-POSTAL-CODES
 12875         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12876         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12877         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12878                                    W-LAB-CAN-FILLER (6)
 12879         GO TO 6200-CONTINUE.
 12880
 12881     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12882         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12883         MOVE SPACES             TO W-LABEL-ZIP (6)
 12884         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12885
 12886         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12887             MOVE '-'            TO W-LABEL-DASH (6)
 12888             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12889             GO TO 6200-CONTINUE
 12890         ELSE
 12891             MOVE SPACES         TO W-LABEL-DASH (6)
 12892                                    W-LABEL-2ND-ZIP (6)
 12893             GO TO 6200-CONTINUE.
 12894
 12895     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12896         GO TO 6200-CONTINUE.
 12897
 12898     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12899
 12900     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12901         COMPUTE W-WORK-ZIP-NUMERIC
 12902             = W-WORK-ZIP-NUMERIC * 10000.
 12903
 12904     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12905     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12906
 12907     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12908         MOVE '-'                TO W-LABEL-DASH (6)
 12909         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12910         GO TO 6200-CONTINUE
 12911     ELSE
 12912         MOVE SPACES             TO W-LABEL-DASH (6)
 12913                                    W-LABEL-2ND-ZIP (6)
 12914         GO TO 6200-CONTINUE.
 12915
 12916 6200-CONTINUE.
 12917
 12918     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12919
 12920     IF  ADDRSI EQUAL '3'
 12921             AND
 12922         PI-CREATE-LABELS
 12923             AND
 12924         NOT PI-689-LABELS-OVERRIDEN
 12925         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12926         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 267
* EL689.cbl
 12927         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12928         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12929         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12930         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12931         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12932         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12933         SET W-RG-NDX UP BY +1
 12934     ELSE
 12935         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 12936         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 12937         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 12938         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 12939         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 12940         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 12941
 12942     GO TO 6200-EXIT.
 12943
 12944 6200-CNTL1-NOT-FOUND.
 12945
 12946     MOVE ER-9299                TO EMI-ERROR.
 12947     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12948     MOVE -1                     TO ADDRSL.
 12949     MOVE AL-UANON               TO ADDRSA.
 12950     GO TO 8200-SEND-DATAONLY.
 12951
 12952 6200-EXIT.
 12953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 268
* EL689.cbl
 12955 6250-GET-CNTL2-DATA.
 12956
 12957     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 12958         GO TO 6250-EXIT.
 12959
 12960     IF  W-FILE-NOT-USED (11)
 12961         GO TO 6250-EXIT.
 12962
 12963     MOVE SPACES                 TO W-CNTL-KEY.
 12964     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12965     MOVE +0                     TO W-CNTL-SEQ-NO.
 12966     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12967     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 12968
 12969
 12970* EXEC CICS HANDLE CONDITION
 12971*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12972*         NOTFND     (6250-CNTL2-NOT-FOUND)
 12973*    END-EXEC.
 12974*    MOVE '"$JI                  ! , #00012319' TO DFHEIV0
 12975     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12977     MOVE X'2C20233030303132333139' TO DFHEIV0(25:11)
 12978     CALL 'kxdfhei1' USING DFHEIV0
 12979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12980
 12981
 12982
 12983* EXEC CICS READ
 12984*         DATASET    (W-CNTL-FILE-ID)
 12985*         SET        (ADDRESS OF CONTROL-FILE)
 12986*         RIDFLD     (W-CNTL-KEY)
 12987*    END-EXEC.
 12988*    MOVE '&"S        E          (   #00012324' TO DFHEIV0
 12989     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12990     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12991     MOVE X'2020233030303132333234' TO DFHEIV0(25:11)
 12992     CALL 'kxdfhei1' USING DFHEIV0,
 12993           W-CNTL-FILE-ID,
 12994           DFHEIV20,
 12995           DFHEIV99,
 12996           W-CNTL-KEY,
 12997           DFHEIV99,
 12998           DFHEIV99,
 12999           DFHEIV99
 13000     SET ADDRESS OF CONTROL-FILE TO
 13001         DFHEIV20
 13002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13003
 13004
 13005     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 13006     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 13007     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 13008     GO TO 6250-EXIT.
 13009
 13010 6250-CNTL2-NOT-FOUND.
 13011
 13012     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 269
* EL689.cbl
 13013     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13014     MOVE -1                     TO MAINTL.
 13015     MOVE AL-UANON               TO MAINTA.
 13016     GO TO 8200-SEND-DATAONLY.
 13017
 13018 6250-EXIT.
 13019     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 270
* EL689.cbl
 13021 6300-GET-CARRIER-DATA.
 13022
 13023     IF  ADDRSI EQUAL '2'
 13024             AND
 13025         PI-CREATE-LABELS
 13026             AND
 13027         NOT PI-689-LABELS-OVERRIDEN
 13028         NEXT SENTENCE
 13029     ELSE
 13030         IF  W-FILE-NOT-USED (4)
 13031             GO TO 6300-EXIT.
 13032
 13033     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 13034         MOVE SPACES             TO W-CNTL-KEY
 13035         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 13036         MOVE +0                 TO W-CNTL-SEQ-NO
 13037         MOVE '6'                TO W-CNTL-RECORD-TYPE
 13038         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 13039     ELSE
 13040         MOVE ER-9327            TO EMI-ERROR
 13041         MOVE -1                 TO CARRIERL
 13042         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13043         GO TO 6300-EXIT.
 13044
 13045
 13046* EXEC CICS HANDLE CONDITION
 13047*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13048*         NOTFND     (6300-CNTL6-NOT-FOUND)
 13049*    END-EXEC.
 13050*    MOVE '"$JI                  ! - #00012370' TO DFHEIV0
 13051     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13053     MOVE X'2D20233030303132333730' TO DFHEIV0(25:11)
 13054     CALL 'kxdfhei1' USING DFHEIV0
 13055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13056
 13057
 13058
 13059* EXEC CICS READ
 13060*         DATASET    (W-CNTL-FILE-ID)
 13061*         SET        (ADDRESS OF CONTROL-FILE)
 13062*         RIDFLD     (W-CNTL-KEY)
 13063*    END-EXEC.
 13064*    MOVE '&"S        E          (   #00012375' TO DFHEIV0
 13065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13067     MOVE X'2020233030303132333735' TO DFHEIV0(25:11)
 13068     CALL 'kxdfhei1' USING DFHEIV0,
 13069           W-CNTL-FILE-ID,
 13070           DFHEIV20,
 13071           DFHEIV99,
 13072           W-CNTL-KEY,
 13073           DFHEIV99,
 13074           DFHEIV99,
 13075           DFHEIV99
 13076     SET ADDRESS OF CONTROL-FILE TO
 13077         DFHEIV20
 13078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 271
* EL689.cbl
 13079
 13080
 13081     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13082     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 13083     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 13084     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13085     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13086     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 13087
 13088     IF  CF-CANADIAN-POST-CODE
 13089         MOVE CF-CANADIAN-POSTAL-CODE
 13090                                 TO W-CANADIAN-POSTAL-CODES
 13091         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13092         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13093         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13094                                    W-LAB-CAN-FILLER (6)
 13095         GO TO 6300-CONTINUE.
 13096
 13097     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 13098         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 13099         MOVE SPACES             TO W-LABEL-ZIP (6)
 13100         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13101         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13102             MOVE '-'            TO W-LABEL-DASH (6)
 13103             MOVE W-WORK-ZIP4
 13104                                 TO W-LABEL-2ND-ZIP (6)
 13105             GO TO 6300-CONTINUE
 13106         ELSE
 13107             MOVE SPACES         TO W-LABEL-DASH (6)
 13108                                    W-LABEL-2ND-ZIP (6)
 13109             GO TO 6300-CONTINUE.
 13110
 13111     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 13112         GO TO 6300-CONTINUE.
 13113
 13114     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 13115
 13116     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 13117         COMPUTE W-WORK-ZIP-NUMERIC
 13118             = W-WORK-ZIP-NUMERIC * 10000.
 13119
 13120     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13121     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 13122
 13123     IF  W-WORK-ZIP4 GREATER THAN '0000'
 13124         MOVE '-'                TO W-LABEL-DASH (6)
 13125         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 13126         GO TO 6300-CONTINUE
 13127     ELSE
 13128         MOVE SPACES             TO W-LABEL-DASH (6)
 13129                                    W-LABEL-2ND-ZIP (6)
 13130         GO TO 6300-CONTINUE.
 13131
 13132 6300-CONTINUE.
 13133
 13134     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13135
 13136     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 272
* EL689.cbl
 13137             AND
 13138         PI-CREATE-LABELS
 13139             AND
 13140         NOT PI-689-LABELS-OVERRIDEN
 13141         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 13142         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 13143         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 13144         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 13145         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 13146         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 13147         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13148         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13149         SET W-RG-NDX UP BY +1
 13150     ELSE
 13151         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 13152         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 13153         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 13154         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 13155         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 13156         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 13157
 13158     IF  W-FULL-DATA
 13159         MOVE ZEROS              TO W-PHONE-IN
 13160         MOVE CF-PHONE-NO        TO W-PHONE-IN
 13161         MOVE W-PHI-AREA         TO W-PO-AREA
 13162         MOVE W-PHI-PFX          TO W-PO-PFX
 13163         MOVE W-PHI-SFX          TO W-PO-SFX
 13164         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 13165
 13166     GO TO 6300-EXIT.
 13167
 13168 6300-CNTL6-NOT-FOUND.
 13169
 13170     MOVE ER-9298                TO EMI-ERROR.
 13171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13172     MOVE -1                     TO ADDRSL.
 13173     MOVE AL-UANON               TO ADDRSA.
 13174     GO TO 8200-SEND-DATAONLY.
 13175
 13176 6300-EXIT.
 13177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 273
* EL689.cbl
 13179 6350-GET-CSR-DATA.
 13180     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 13181        GO TO 6350-EXIT
 13182     END-IF
 13183*    IF W-FILE-NOT-USED (11)
 13184*       GO TO 6350-EXIT
 13185*    END-IF
 13186     MOVE SPACES                 TO W-CNTL-KEY
 13187     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 13188     MOVE +0                     TO W-CNTL-SEQ-NO
 13189     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 13190     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 13191
 13192* EXEC CICS HANDLE CONDITION
 13193*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13194*         NOTFND     (6350-CNTL2-NOT-FOUND)
 13195*    END-EXEC
 13196*    MOVE '"$JI                  ! . #00012491' TO DFHEIV0
 13197     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13199     MOVE X'2E20233030303132343931' TO DFHEIV0(25:11)
 13200     CALL 'kxdfhei1' USING DFHEIV0
 13201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13202
 13203* EXEC CICS READ
 13204*         DATASET    (W-CNTL-FILE-ID)
 13205*         SET        (ADDRESS OF CONTROL-FILE)
 13206*         RIDFLD     (W-CNTL-KEY)
 13207*    END-EXEC
 13208*    MOVE '&"S        E          (   #00012495' TO DFHEIV0
 13209     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13211     MOVE X'2020233030303132343935' TO DFHEIV0(25:11)
 13212     CALL 'kxdfhei1' USING DFHEIV0,
 13213           W-CNTL-FILE-ID,
 13214           DFHEIV20,
 13215           DFHEIV99,
 13216           W-CNTL-KEY,
 13217           DFHEIV99,
 13218           DFHEIV99,
 13219           DFHEIV99
 13220     SET ADDRESS OF CONTROL-FILE TO
 13221         DFHEIV20
 13222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13223     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13224     GO TO 6350-EXIT
 13225     .
 13226 6350-CNTL2-NOT-FOUND.
 13227     MOVE ER-9299                TO EMI-ERROR.
 13228     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13229     MOVE -1                     TO MAINTL.
 13230     MOVE AL-UANON               TO MAINTA.
 13231     GO TO 8200-SEND-DATAONLY.
 13232 6350-EXIT.
 13233     EXIT.
 13234 6400-GET-PENDING-DATA.
 13235
 13236     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 274
* EL689.cbl
 13237        AND (PI-CREATE-LABELS)
 13238        AND (NOT PI-689-LABELS-OVERRIDEN)
 13239        CONTINUE
 13240     ELSE
 13241        IF PI-689-DATA-SOURCE = '4'
 13242           CONTINUE
 13243        ELSE
 13244           IF W-FILE-NOT-USED (9)
 13245              GO TO 6400-EXIT
 13246           END-IF
 13247        END-IF
 13248     END-IF
 13249     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 13250         MOVE ER-9327            TO EMI-ERROR
 13251         MOVE -1                 TO MAINTL
 13252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13253         GO TO 6400-EXIT.
 13254
 13255 6400-READ-PNDB-ONLY.
 13256
 13257
 13258* EXEC CICS HANDLE CONDITION
 13259*         NOTOPEN (8060-PNDB-NOT-OPEN)
 13260*         NOTFND  (8070-PNDB-NOT-FOUND)
 13261*    END-EXEC.
 13262*    MOVE '"$JI                  ! / #00012534' TO DFHEIV0
 13263     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13265     MOVE X'2F20233030303132353334' TO DFHEIV0(25:11)
 13266     CALL 'kxdfhei1' USING DFHEIV0
 13267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13268
 13269
 13270
 13271* EXEC CICS READ
 13272*         DATASET (W-PNDB-FILE-ID)
 13273*         SET     (ADDRESS OF PENDING-BUSINESS)
 13274*         RIDFLD  (W-PNDB-KEY)
 13275*    END-EXEC.
 13276*    MOVE '&"S        E          (   #00012539' TO DFHEIV0
 13277     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13279     MOVE X'2020233030303132353339' TO DFHEIV0(25:11)
 13280     CALL 'kxdfhei1' USING DFHEIV0,
 13281           W-PNDB-FILE-ID,
 13282           DFHEIV20,
 13283           DFHEIV99,
 13284           W-PNDB-KEY,
 13285           DFHEIV99,
 13286           DFHEIV99,
 13287           DFHEIV99
 13288     SET ADDRESS OF PENDING-BUSINESS TO
 13289         DFHEIV20
 13290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13291
 13292
 13293     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 13294
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 275
* EL689.cbl
 13295     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13296         MOVE PB-SV-CARRIER      TO PB-CARRIER
 13297                                    PI-689-CARRIER
 13298         MOVE PB-SV-GROUPING     TO PB-GROUPING
 13299                                    PI-689-GROUPING
 13300         MOVE PB-SV-STATE        TO PB-STATE
 13301                                    PI-689-STATE
 13302         MOVE PB-CONTROL-BY-ACCOUNT
 13303                                 TO W-CERT-KEY
 13304                                    W-MAIL-KEY
 13305                                    W-ACCT-KEY
 13306         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 13307         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 13308         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 13309
 13310 6400-ONLY-STOP.
 13311
 13312     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 13313
 13314     IF  NOT PB-ISSUE
 13315         GO TO 6400-CANCEL.
 13316
 13317     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 13318     MOVE SPACES                 TO DC-OPTION-CODE.
 13319     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13320
 13321     IF  NO-CONVERSION-ERROR
 13322         MOVE DC-GREG-DATE-1-EDIT
 13323                                 TO W-VG-TEXT (110).
 13324
 13325     MOVE PB-I-AGE               TO W-EDIT-3-0.
 13326     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 13327     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 13328     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 13329     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 13330     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 13331     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 13332     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 13333     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 13334     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 13335     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 13336     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 13337     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 13338     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 13339     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 13340     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 13341     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 13342     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 13343     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 13344     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 13345
 13346     COMPUTE W-DIFFERENCE
 13347         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 13348
 13349     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13350     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 13351
 13352     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 276
* EL689.cbl
 13353         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 13354
 13355     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13356     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 13357
 13358 6400-CANCEL.
 13359
 13360     IF  NOT PB-CANCELLATION
 13361         GO TO 6400-EXIT.
 13362
 13363     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 13364                                 TO DC-BIN-DATE-1.
 13365     MOVE SPACES                 TO DC-OPTION-CODE.
 13366     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13367
 13368     IF  NO-CONVERSION-ERROR
 13369         MOVE DC-GREG-DATE-1-EDIT
 13370                                 TO W-VG-TEXT (117).
 13371
 13372     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 13373     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 13374     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 13375     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 13376     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 13377     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 13378     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 13379     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 13380     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 13381     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13382
 13383     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 13384        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 13385     END-IF
 13386     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 13387     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13388     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 13389     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 13390        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 13391     END-IF
 13392     MOVE SPACES                 TO DC-OPTION-CODE
 13393     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13394
 13395     IF NO-CONVERSION-ERROR
 13396        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13397     END-IF
 13398
 13399     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 13400                           - PB-C-LF-CANCEL-AMT.
 13401
 13402     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13403     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 13404
 13405     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 13406                           - PB-C-AH-CANCEL-AMT.
 13407
 13408     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13409     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 13410
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 277
* EL689.cbl
 13411 6400-EXIT.
 13412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 278
* EL689.cbl
 13414 6450-GET-CERT-DATA.
 13415     IF  W-FILE-NOT-USED (8)
 13416         GO TO 6450-EXIT.
 13417
 13418     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13419         MOVE ER-9327            TO EMI-ERROR
 13420         MOVE -1                 TO MAINTL
 13421         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13422         GO TO 6450-EXIT.
 13423
 13424 6450-READ-CERT-ONLY.
 13425
 13426
 13427* EXEC CICS HANDLE CONDITION
 13428*         NOTOPEN (8030-CERT-NOT-OPEN)
 13429*         NOTFND  (8035-CERT-NOT-FOUND)
 13430*    END-EXEC.
 13431*    MOVE '"$JI                  ! 0 #00012678' TO DFHEIV0
 13432     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13434     MOVE X'3020233030303132363738' TO DFHEIV0(25:11)
 13435     CALL 'kxdfhei1' USING DFHEIV0
 13436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13437
 13438
 13439
 13440* EXEC CICS READ
 13441*         DATASET (W-CERT-FILE-ID)
 13442*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 13443*         RIDFLD  (W-CERT-KEY)
 13444*    END-EXEC.
 13445*    MOVE '&"S        E          (   #00012683' TO DFHEIV0
 13446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13448     MOVE X'2020233030303132363833' TO DFHEIV0(25:11)
 13449     CALL 'kxdfhei1' USING DFHEIV0,
 13450           W-CERT-FILE-ID,
 13451           DFHEIV20,
 13452           DFHEIV99,
 13453           W-CERT-KEY,
 13454           DFHEIV99,
 13455           DFHEIV99,
 13456           DFHEIV99
 13457     SET ADDRESS OF CERTIFICATE-MASTER TO
 13458         DFHEIV20
 13459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13460
 13461
 13462     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13463
 13464 6450-ONLY-STOP.
 13465
 13466     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13467
 13468     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13469
 13470     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13471     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 279
* EL689.cbl
 13472     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13473     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13474     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13475
 13476     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13477     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13478     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13479     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13480     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13481
 13482     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13483     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13484     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13485     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13486     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13487     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13488
 13489     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13490     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13491     MOVE SPACES                 TO W-NAME-MIDDLE.
 13492     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13493     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13494
 13495     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13496     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13497
 13498     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13499     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13500     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13501     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13502     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13503                                    W-LABEL-JOINT-NAME.
 13504
 13505     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13506     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13507     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13508     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13509     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13510
 13511     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13512     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13513     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13514     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13515     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13516     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13517
 13518     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13519     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13520     MOVE SPACES                 TO W-NAME-MIDDLE.
 13521     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13522     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13523
 13524     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13525     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13526
 13527     COMPUTE W-WORK-AMOUNT
 13528         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13529     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 280
* EL689.cbl
 13530     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13531     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13532     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13533
 13534     IF  CM-SEX-FEMAL
 13535         MOVE 'MS.'              TO W-VG-TEXT (96)
 13536
 13537     ELSE
 13538         MOVE 'MR.'              TO W-VG-TEXT (96).
 13539
 13540     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13541                                 TO W-VG-TEXT (70).
 13542     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13543     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13544     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13545     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13546     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13547     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13548     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13549     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13550     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13551     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13552     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13553     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13554     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13555     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13556     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13557     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13558     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13559     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13560     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13561     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13562     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13563     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13564     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13565     IF PI-689-DATA-SOURCE NOT = '4'
 13566     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13567        + CM-AH-ITD-CANCEL-AMT
 13568     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13569     IF CM-NH-INT-ON-REFS NOT NUMERIC
 13570        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 13571     END-IF
 13572     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 13573     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13574     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13575     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13576        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13577     END-IF
 13578     MOVE SPACES                 TO DC-OPTION-CODE
 13579     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13580
 13581     IF NO-CONVERSION-ERROR
 13582        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13583     END-IF
 13584     END-IF
 13585     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13586     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13587     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 281
* EL689.cbl
 13588
 13589     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13590     MOVE SPACES                 TO DC-OPTION-CODE.
 13591     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13592
 13593     IF  NO-CONVERSION-ERROR
 13594         MOVE DC-GREG-DATE-1-EDIT
 13595                                 TO W-VG-TEXT (81).
 13596
 13597     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13598     MOVE SPACES                 TO DC-OPTION-CODE.
 13599     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13600
 13601     IF  NO-CONVERSION-ERROR
 13602         MOVE DC-GREG-DATE-1-EDIT
 13603                                 TO W-VG-TEXT (82).
 13604
 13605     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13606     MOVE SPACES                 TO DC-OPTION-CODE.
 13607     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13608
 13609     IF  NO-CONVERSION-ERROR
 13610         MOVE DC-GREG-DATE-1-EDIT
 13611                                 TO W-VG-TEXT (74).
 13612
 13613     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13614
 13615     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13616         MOVE CM-PMT-EXTENSION-DAYS
 13617                                 TO DC-ELAPSED-DAYS
 13618     ELSE
 13619         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13620
 13621     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13622     MOVE '6'                    TO DC-OPTION-CODE.
 13623     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13624
 13625     IF  NO-CONVERSION-ERROR
 13626         MOVE DC-GREG-DATE-1-EDIT
 13627                                 TO W-VG-TEXT (75).
 13628
 13629     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13630     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13631     MOVE '6'                    TO DC-OPTION-CODE.
 13632     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13633
 13634     IF  NO-CONVERSION-ERROR
 13635         MOVE DC-GREG-DATE-1-EDIT
 13636                                 TO W-VG-TEXT (76).
 13637
 13638 6450-EXIT.
 13639     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 282
* EL689.cbl
 13641 6500-GET-ACCOUNT-DATA.
 13642
 13643     IF  ADDRSI EQUAL '1'
 13644             AND
 13645         PI-CREATE-LABELS
 13646             AND
 13647         NOT PI-689-LABELS-OVERRIDEN
 13648         NEXT SENTENCE
 13649     ELSE
 13650         IF  W-FILE-NOT-USED (6)
 13651             GO TO 6500-EXIT
 13652         END-IF
 13653     END-IF.
 13654
 13655 6500-READ-ACCT-ONLY.
 13656
 13657     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13658         MOVE ER-9327            TO EMI-ERROR
 13659         MOVE -1                 TO MAINTL
 13660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13661         GO TO 6500-EXIT.
 13662
 13663
 13664* EXEC CICS HANDLE CONDITION
 13665*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13666*         NOTFND     (6500-ACCT-NOT-FOUND)
 13667*         ENDFILE    (6500-ONLY-STOP)
 13668*    END-EXEC.
 13669*    MOVE '"$JI''                 ! 1 #00012890' TO DFHEIV0
 13670     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13672     MOVE X'3120233030303132383930' TO DFHEIV0(25:11)
 13673     CALL 'kxdfhei1' USING DFHEIV0
 13674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13675
 13676
 13677
 13678* EXEC CICS STARTBR
 13679*         RIDFLD     (W-ACCT-KEY)
 13680*         DATASET    (W-ACCT-FILE-ID)
 13681*         KEYLENGTH  (20)
 13682*         GENERIC
 13683*    END-EXEC.
 13684     MOVE 20
 13685       TO DFHEIV11
 13686     MOVE 0
 13687       TO DFHEIV12
 13688*    MOVE '&,   KG    G          &   #00012896' TO DFHEIV0
 13689     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13690     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13691     MOVE X'2020233030303132383936' TO DFHEIV0(25:11)
 13692     CALL 'kxdfhei1' USING DFHEIV0,
 13693           W-ACCT-FILE-ID,
 13694           W-ACCT-KEY,
 13695           DFHEIV11,
 13696           DFHEIV12,
 13697           DFHEIV99
 13698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 283
* EL689.cbl
 13699
 13700
 13701     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13702     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13703
 13704 6500-READNEXT.
 13705
 13706
 13707* EXEC CICS READNEXT
 13708*         DATASET    (W-ACCT-FILE-ID)
 13709*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13710*         RIDFLD     (W-ACCT-KEY)
 13711*    END-EXEC.
 13712     MOVE 0
 13713       TO DFHEIV11
 13714*    MOVE '&.S                   )   #00012908' TO DFHEIV0
 13715     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13716     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13717     MOVE X'2020233030303132393038' TO DFHEIV0(25:11)
 13718     CALL 'kxdfhei1' USING DFHEIV0,
 13719           W-ACCT-FILE-ID,
 13720           DFHEIV20,
 13721           DFHEIV99,
 13722           W-ACCT-KEY,
 13723           DFHEIV99,
 13724           DFHEIV11,
 13725           DFHEIV99,
 13726           DFHEIV99
 13727     SET ADDRESS OF ACCOUNT-MASTER TO
 13728         DFHEIV20
 13729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13730
 13731
 13732     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13733         IF  PRIOR-MATCH-ACCT-PKEY
 13734             CONTINUE
 13735*            GO TO 6500-ONLY-STOP
 13736         ELSE
 13737             IF  W-FILE-NOT-USED (6)
 13738                 PERFORM 6500-ENDBR
 13739                 GO TO 6500-EXIT
 13740             ELSE
 13741                 GO TO 6500-ACCT-NOT-FOUND
 13742             END-IF
 13743         END-IF
 13744     ELSE
 13745         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13746         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13747         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13748         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13749         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13750         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13751         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13752         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13753         MOVE SPACES               TO WS-SAV-AM-CITY
 13754*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13755         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13756            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 284
* EL689.cbl
 13757         END-STRING
 13758         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13759         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13760         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13761         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13762         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13763         GO TO 6500-READNEXT
 13764     END-IF
 13765     .
 13766 6500-ONLY-STOP.
 13767
 13768     IF  NOT PI-NO-CARRIER-SECURITY
 13769             AND
 13770         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13771         MOVE -1                 TO CARRIERL
 13772         MOVE AL-UANON           TO CARRIERA
 13773         MOVE ER-9095            TO EMI-ERROR
 13774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13775         PERFORM 6500-ENDBR
 13776         GO TO 8200-SEND-DATAONLY.
 13777
 13778     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13779     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13780     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13781     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13782     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13783
 13784     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13785     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13786
 13787     IF  SAVE-AM-CANADIAN-POST-CODE
 13788         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13789                                 TO W-CANADIAN-POSTAL-CODES
 13790         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13791         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13792         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13793                                    W-LAB-CAN-FILLER (5)
 13794     ELSE
 13795         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13796
 13797         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13798             MOVE '-'            TO W-LABEL-DASH (5)
 13799             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13800         ELSE
 13801             MOVE SPACES         TO W-LABEL-DASH (5)
 13802                                    W-LABEL-2ND-ZIP (5).
 13803
 13804     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13805
 13806     IF  ADDRSI EQUAL '1'
 13807             AND
 13808         PI-CREATE-LABELS
 13809             AND
 13810         NOT PI-689-LABELS-OVERRIDEN
 13811         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13812                                    W-VG-TEXT (40)
 13813         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13814                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 285
* EL689.cbl
 13815         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13816                                    W-VG-TEXT (42)
 13817         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13818                                    W-VG-TEXT (43)
 13819         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13820                                    W-VG-TEXT (44)
 13821         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13822                                    W-VG-TEXT (45)
 13823         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13824         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13825         SET W-RG-NDX UP BY +1
 13826     ELSE
 13827         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13828         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13829         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13830         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13831         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13832         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13833
 13834     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13835             OR
 13836         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13837         MOVE SPACES             TO W-VG-TEXT (46)
 13838     ELSE
 13839         MOVE ZEROS                  TO W-PHONE-IN
 13840         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13841         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13842         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13843         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13844
 13845     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13846        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13847     ELSE
 13848        MOVE SPACES                   TO W-VG-TEXT (47)
 13849     END-IF.
 13850     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13851     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13852                                 TO W-VG-TEXT (49)
 13853
 13854     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13855     PERFORM 6500-ENDBR.
 13856
 13857     GO TO 6500-EXIT.
 13858
 13859 6500-ENDBR.
 13860
 13861     IF  W-ACCT-BROWSE-STARTED
 13862         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13863
 13864* EXEC CICS ENDBR
 13865*            DATASET (W-ACCT-FILE-ID)
 13866*        END-EXEC
 13867     MOVE 0
 13868       TO DFHEIV11
 13869*    MOVE '&2                    $   #00013045' TO DFHEIV0
 13870     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13872     MOVE X'2020233030303133303435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 286
* EL689.cbl
 13873     CALL 'kxdfhei1' USING DFHEIV0,
 13874           W-ACCT-FILE-ID,
 13875           DFHEIV11,
 13876           DFHEIV99
 13877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13878     END-IF.
 13879
 13880 6500-ACCT-NOT-FOUND.
 13881
 13882     PERFORM 6500-ENDBR.
 13883
 13884     IF  DATASORI NOT EQUAL '1'
 13885         MOVE ER-0179            TO EMI-ERROR
 13886         GO TO 6500-EXIT.
 13887
 13888     MOVE ER-0179                TO EMI-ERROR.
 13889     MOVE -1                     TO MAINTL.
 13890     MOVE AL-UNBON               TO MAINTA.
 13891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13892     GO TO 8200-SEND-DATAONLY.
 13893
 13894 6500-EXIT.
 13895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 287
* EL689.cbl
 13897 6600-GET-COMPENSATION-DATA.
 13898
 13899     IF  ADDRSI EQUAL '4'
 13900             AND
 13901         PI-CREATE-LABELS
 13902             AND
 13903         NOT PI-689-LABELS-OVERRIDEN
 13904         NEXT SENTENCE
 13905     ELSE
 13906         IF  W-FILE-NOT-USED (10)
 13907             GO TO 6600-EXIT.
 13908
 13909     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13910         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13911         GO TO 6600-START.
 13912
 13913     IF  PI-ZERO-CARRIER
 13914             OR
 13915         PI-ZERO-CAR-GROUP
 13916         MOVE ZEROS              TO W-COMP-CARRIER.
 13917
 13918     IF  PI-ZERO-GROUPING
 13919             OR
 13920         PI-ZERO-CAR-GROUP
 13921         MOVE ZEROS              TO W-COMP-GROUPING.
 13922
 13923     IF  W-FILE-NOT-USED (6)
 13924         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13925         IF  EMI-ERROR EQUAL ER-0179
 13926             MOVE ER-9327        TO EMI-ERROR
 13927             MOVE -1             TO MAINTL
 13928             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13929             GO TO 6600-EXIT.
 13930
 13931     MOVE  'A'                   TO W-COMP-TYPE.
 13932
 13933     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 13934         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 13935                                 TO W-COMP-RESP-PERSON
 13936     ELSE
 13937         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13938
 13939     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 13940        (W-NDX > +10)
 13941            OR
 13942         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F')
 13943     END-PERFORM
 13944
 13945     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F'
 13946         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 13947     ELSE
 13948         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13949
 13950     PERFORM 6500-ENDBR.
 13951     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13952
 13953     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 13954         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 288
* EL689.cbl
 13955         MOVE -1                 TO MAINTL
 13956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13957         GO TO 6600-EXIT.
 13958
 13959 6600-START.
 13960
 13961
 13962* EXEC CICS HANDLE CONDITION
 13963*         NOTOPEN (8080-COMP-NOT-OPEN)
 13964*         NOTFND  (6600-COMP-NOT-FOUND)
 13965*    END-EXEC.
 13966*    MOVE '"$JI                  ! 2 #00013131' TO DFHEIV0
 13967     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13969     MOVE X'3220233030303133313331' TO DFHEIV0(25:11)
 13970     CALL 'kxdfhei1' USING DFHEIV0
 13971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13972
 13973
 13974
 13975* EXEC CICS STARTBR
 13976*         RIDFLD  (W-COMP-KEY)
 13977*         DATASET (W-COMP-FILE-ID)
 13978*    END-EXEC.
 13979     MOVE 0
 13980       TO DFHEIV11
 13981*    MOVE '&,         G          &   #00013136' TO DFHEIV0
 13982     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13983     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13984     MOVE X'2020233030303133313336' TO DFHEIV0(25:11)
 13985     CALL 'kxdfhei1' USING DFHEIV0,
 13986           W-COMP-FILE-ID,
 13987           W-COMP-KEY,
 13988           DFHEIV99,
 13989           DFHEIV11,
 13990           DFHEIV99
 13991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13992
 13993
 13994     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 13995
 13996 6600-READNEXT.
 13997
 13998
 13999* EXEC CICS READNEXT
 14000*         DATASET (W-COMP-FILE-ID)
 14001*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14002*         RIDFLD  (W-COMP-KEY)
 14003*    END-EXEC.
 14004     MOVE 0
 14005       TO DFHEIV11
 14006*    MOVE '&.S                   )   #00013145' TO DFHEIV0
 14007     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14008     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14009     MOVE X'2020233030303133313435' TO DFHEIV0(25:11)
 14010     CALL 'kxdfhei1' USING DFHEIV0,
 14011           W-COMP-FILE-ID,
 14012           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 289
* EL689.cbl
 14013           DFHEIV99,
 14014           W-COMP-KEY,
 14015           DFHEIV99,
 14016           DFHEIV11,
 14017           DFHEIV99,
 14018           DFHEIV99
 14019     SET ADDRESS OF COMPENSATION-MASTER TO
 14020         DFHEIV20
 14021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14022
 14023
 14024     IF CO-CONTROL-PRIMARY
 14025           NOT = W-COMP-SAVE-KEY
 14026        GO TO 6600-COMP-NOT-FOUND.
 14027
 14028     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14029     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 14030                                    W-VG-TEXT (140).
 14031     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14032     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14033     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14034*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14035     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14036        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14037     END-STRING
 14038
 14039     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14040
 14041     IF  CO-CANADIAN-POST-CODE
 14042         MOVE CO-CANADIAN-POSTAL-CODE
 14043                                 TO W-CANADIAN-POSTAL-CODES
 14044         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14045         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14046         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14047                                    W-LAB-CAN-FILLER (6)
 14048     ELSE
 14049         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14050
 14051         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14052             MOVE '-'            TO W-LABEL-DASH (6)
 14053             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14054         ELSE
 14055             MOVE SPACES         TO W-LABEL-DASH (6)
 14056                                    W-LABEL-2ND-ZIP (6).
 14057
 14058     IF  CO-TELEPHONE NOT NUMERIC
 14059             OR
 14060         CO-TELEPHONE = ZEROS
 14061         MOVE SPACES             TO W-VG-TEXT (147)
 14062     ELSE
 14063         MOVE ZEROS              TO W-PHONE-IN
 14064         MOVE CO-AREA-CODE       TO W-PO-AREA
 14065         MOVE CO-PREFIX          TO W-PO-PFX
 14066         MOVE CO-PHONE           TO W-PO-SFX
 14067         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 14068
 14069     IF (CO-FAXNO NOT NUMERIC)
 14070        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 290
* EL689.cbl
 14071        MOVE SPACES              TO W-VG-TEXT (182)
 14072     ELSE
 14073        MOVE ZEROS               TO W-PHONE-IN
 14074        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 14075        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 14076        MOVE CO-FAX-PHONE        TO W-PO-SFX
 14077        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 14078     END-IF
 14079     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 14080        MOVE SPACES              TO W-VG-TEXT (183)
 14081     ELSE
 14082        EVALUATE CO-GA-STATUS-CODE
 14083           WHEN 'A'
 14084              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 14085           WHEN 'I'
 14086              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 14087           WHEN 'P'
 14088              MOVE 'PENDING'     TO W-VG-TEXT (183)
 14089        END-EVALUATE
 14090     END-IF
 14091     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 14092        MOVE SPACES              TO W-VG-TEXT (181)
 14093     ELSE
 14094        EVALUATE CO-BILL-SW
 14095           WHEN 'B'
 14096              MOVE 'BILLED'      TO W-VG-TEXT (181)
 14097           WHEN 'R'
 14098              MOVE 'REMIT'       TO W-VG-TEXT (181)
 14099           WHEN 'T'
 14100              MOVE 'T'           TO W-VG-TEXT (181)
 14101           WHEN 'S'
 14102              MOVE 'S'           TO W-VG-TEXT (181)
 14103        END-EVALUATE
 14104     END-IF
 14105     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14106
 14107     IF  ADDRSI EQUAL '4'
 14108             AND
 14109         PI-CREATE-LABELS
 14110             AND
 14111         NOT PI-689-LABELS-OVERRIDEN
 14112         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14113                                    W-VG-TEXT (141)
 14114         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14115                                    W-VG-TEXT (142)
 14116         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14117                                    W-VG-TEXT (143)
 14118         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14119                                    W-VG-TEXT (144)
 14120         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14121                                    W-VG-TEXT (145)
 14122         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14123                                    W-VG-TEXT (146)
 14124         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14125         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14126         SET W-RG-NDX UP BY +1
 14127     ELSE
 14128         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 291
* EL689.cbl
 14129         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 14130         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 14131         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 14132         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 14133         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 14134
 14135     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 14136
 14137     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 14138     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 14139     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 14140
 14141     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 14142     MOVE '3'                    TO DC-OPTION-CODE.
 14143     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14144
 14145     IF  NO-CONVERSION-ERROR
 14146         MOVE DC-GREG-DATE-1-ALPHA
 14147                                 TO W-VG-TEXT (149).
 14148
 14149     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 14150     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 14151
 14152     PERFORM 6600-ENDBR.
 14153     GO TO 6600-EXIT.
 14154
 14155 6600-ENDBR.
 14156
 14157     IF  W-COMP-BROWSE-STARTED
 14158         MOVE 'N'                      TO W-COMP-BROWSE-SW
 14159
 14160* EXEC CICS ENDBR
 14161*             DATASET(W-COMP-FILE-ID)
 14162*        END-EXEC.
 14163     MOVE 0
 14164       TO DFHEIV11
 14165*    MOVE '&2                    $   #00013286' TO DFHEIV0
 14166     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14167     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14168     MOVE X'2020233030303133323836' TO DFHEIV0(25:11)
 14169     CALL 'kxdfhei1' USING DFHEIV0,
 14170           W-COMP-FILE-ID,
 14171           DFHEIV11,
 14172           DFHEIV99
 14173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14174
 14175
 14176 6600-COMP-NOT-FOUND.
 14177
 14178     PERFORM 6600-ENDBR.
 14179
 14180     IF ADDRSL GREATER ZERO
 14181         IF ADDRSI = '4'
 14182            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 14183                MOVE ER-7378                TO EMI-ERROR
 14184                MOVE -1                     TO TYPEL
 14185                MOVE AL-UNBON               TO TYPEA
 14186                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 292
* EL689.cbl
 14187                GO TO 8200-SEND-DATAONLY
 14188            ELSE
 14189                MOVE ER-2114                TO EMI-ERROR
 14190                MOVE -1                     TO ADDRSL
 14191                MOVE AL-UNBON               TO ADDRSA
 14192                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14193                GO TO 8200-SEND-DATAONLY.
 14194
 14195 6600-EXIT.
 14196     EXIT.
 14197 6620-GET-G-DATA.
 14198
 14199     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 14200
 14201     IF  CO-RPTCD2 GREATER THAN SPACES
 14202         MOVE SPACES             TO W-COMP-RESP-PERSON
 14203         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 14204         MOVE +10                TO W-CWA-NDX
 14205         PERFORM 6622-FIND-LAST-NON-SPACE
 14206         SET W-COMP-NDX          TO +10
 14207         PERFORM 6625-FILL-IN-RESP-PERSON.
 14208         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 14209
 14210     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 14211     MOVE 'G'                    TO W-COMP-TYPE.
 14212     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 14213
 14214
 14215* EXEC CICS RESETBR
 14216*         RIDFLD  (W-COMP-KEY)
 14217*         DATASET (W-COMP-FILE-ID)
 14218*    END-EXEC.
 14219     MOVE 0
 14220       TO DFHEIV11
 14221*    MOVE '&4         G          &   #00013328' TO DFHEIV0
 14222     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14224     MOVE X'2020233030303133333238' TO DFHEIV0(25:11)
 14225     CALL 'kxdfhei1' USING DFHEIV0,
 14226           W-COMP-FILE-ID,
 14227           W-COMP-KEY,
 14228           DFHEIV99,
 14229           DFHEIV11,
 14230           DFHEIV99
 14231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14232
 14233
 14234
 14235* EXEC CICS READNEXT
 14236*         DATASET (W-COMP-FILE-ID)
 14237*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14238*         RIDFLD  (W-COMP-KEY)
 14239*    END-EXEC.
 14240     MOVE 0
 14241       TO DFHEIV11
 14242*    MOVE '&.S                   )   #00013333' TO DFHEIV0
 14243     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14244     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 293
* EL689.cbl
 14245     MOVE X'2020233030303133333333' TO DFHEIV0(25:11)
 14246     CALL 'kxdfhei1' USING DFHEIV0,
 14247           W-COMP-FILE-ID,
 14248           DFHEIV20,
 14249           DFHEIV99,
 14250           W-COMP-KEY,
 14251           DFHEIV99,
 14252           DFHEIV11,
 14253           DFHEIV99,
 14254           DFHEIV99
 14255     SET ADDRESS OF COMPENSATION-MASTER TO
 14256         DFHEIV20
 14257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14258
 14259
 14260     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14261         GO TO 6620-EXIT.
 14262
 14263     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14264     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14265     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14266     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14267     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14268*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14269     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14270        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14271     END-STRING
 14272
 14273     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14274
 14275     IF  CO-CANADIAN-POST-CODE
 14276         MOVE CO-CANADIAN-POSTAL-CODE
 14277                                 TO W-CANADIAN-POSTAL-CODES
 14278         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14279         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14280         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14281                                    W-LAB-CAN-FILLER (6)
 14282     ELSE
 14283         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14284         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14285             MOVE '-'            TO W-LABEL-DASH (6)
 14286             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14287         ELSE
 14288             MOVE SPACES         TO W-LABEL-DASH (6)
 14289                                    W-LABEL-2ND-ZIP (6).
 14290
 14291     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14292
 14293     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 14294     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 14295     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 14296     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 14297     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 14298     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 14299
 14300 6620-EXIT.
 14301     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 294
* EL689.cbl
 14303 6622-FIND-LAST-NON-SPACE.
 14304
 14305     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 14306         SUBTRACT +1 FROM W-CWA-NDX
 14307         GO TO 6622-FIND-LAST-NON-SPACE.
 14308
 14309 6622-EXIT.
 14310     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 295
* EL689.cbl
 14312 6625-FILL-IN-RESP-PERSON.
 14313
 14314     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 14315     SET W-COMP-NDX DOWN BY +1.
 14316     SUBTRACT +1 FROM W-CWA-NDX.
 14317
 14318     IF  W-CWA-NDX GREATER THAN ZEROS
 14319         GO TO 6625-FILL-IN-RESP-PERSON.
 14320
 14321 6625-EXIT.
 14322     EXIT.
 14323 6626-GET-B-DATA.
 14324     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 14325     IF W-FILE-USED (8)
 14326        PERFORM 6450-READ-CERT-ONLY
 14327        IF W-CERT-FOUND
 14328           MOVE CM-BENEFICIARY (1:10)
 14329                                 TO W-COMP-RESP-PERSON
 14330        ELSE
 14331           MOVE SPACES           TO W-COMP-RESP-PERSON
 14332           GO TO 6626-EXIT
 14333        END-IF
 14334     ELSE
 14335        MOVE CM-BENEFICIARY (1:10)
 14336                                 TO W-COMP-RESP-PERSON
 14337     END-IF
 14338     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 14339     MOVE 'B'                    TO W-COMP-TYPE
 14340     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 14341
 14342
 14343* EXEC CICS RESETBR
 14344*         RIDFLD  (W-COMP-KEY)
 14345*         DATASET (W-COMP-FILE-ID)
 14346*    END-EXEC.
 14347     MOVE 0
 14348       TO DFHEIV11
 14349*    MOVE '&4         G          &   #00013421' TO DFHEIV0
 14350     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14351     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14352     MOVE X'2020233030303133343231' TO DFHEIV0(25:11)
 14353     CALL 'kxdfhei1' USING DFHEIV0,
 14354           W-COMP-FILE-ID,
 14355           W-COMP-KEY,
 14356           DFHEIV99,
 14357           DFHEIV11,
 14358           DFHEIV99
 14359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14360
 14361
 14362
 14363* EXEC CICS READNEXT
 14364*         DATASET (W-COMP-FILE-ID)
 14365*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14366*         RIDFLD  (W-COMP-KEY)
 14367*    END-EXEC.
 14368     MOVE 0
 14369       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 296
* EL689.cbl
 14370*    MOVE '&.S                   )   #00013426' TO DFHEIV0
 14371     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14372     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14373     MOVE X'2020233030303133343236' TO DFHEIV0(25:11)
 14374     CALL 'kxdfhei1' USING DFHEIV0,
 14375           W-COMP-FILE-ID,
 14376           DFHEIV20,
 14377           DFHEIV99,
 14378           W-COMP-KEY,
 14379           DFHEIV99,
 14380           DFHEIV11,
 14381           DFHEIV99,
 14382           DFHEIV99
 14383     SET ADDRESS OF COMPENSATION-MASTER TO
 14384         DFHEIV20
 14385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14386
 14387
 14388     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14389         GO TO 6626-EXIT.
 14390
 14391     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14392     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14393     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14394     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14395     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14396*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14397     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14398        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14399     END-STRING
 14400
 14401     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14402
 14403     IF  CO-CANADIAN-POST-CODE
 14404         MOVE CO-CANADIAN-POSTAL-CODE
 14405                                 TO W-CANADIAN-POSTAL-CODES
 14406         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14407         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14408         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14409                                    W-LAB-CAN-FILLER (6)
 14410     ELSE
 14411         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14412         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14413             MOVE '-'            TO W-LABEL-DASH (6)
 14414             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14415         ELSE
 14416             MOVE SPACES         TO W-LABEL-DASH (6)
 14417                                    W-LABEL-2ND-ZIP (6).
 14418
 14419     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14420
 14421     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 14422     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 14423     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 14424     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 14425     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 14426     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 14427
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 297
* EL689.cbl
 14428 6626-EXIT.
 14429     EXIT.
 14430 6630-GET-CSR-NAME.
 14431
 14432     MOVE SPACES                 TO W-CNTL-KEY.
 14433     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 14434     MOVE +0                     TO W-CNTL-SEQ-NO.
 14435     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 14436     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 14437
 14438
 14439* EXEC CICS HANDLE CONDITION
 14440*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 14441*         NOTFND     (6630-CNTL2-NOT-FOUND)
 14442*    END-EXEC.
 14443*    MOVE '"$JI                  ! 3 #00013482' TO DFHEIV0
 14444     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14446     MOVE X'3320233030303133343832' TO DFHEIV0(25:11)
 14447     CALL 'kxdfhei1' USING DFHEIV0
 14448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14449
 14450
 14451
 14452* EXEC CICS READ
 14453*         DATASET    (W-CNTL-FILE-ID)
 14454*         SET        (ADDRESS OF CONTROL-FILE)
 14455*         RIDFLD     (W-CNTL-KEY)
 14456*    END-EXEC.
 14457*    MOVE '&"S        E          (   #00013487' TO DFHEIV0
 14458     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14460     MOVE X'2020233030303133343837' TO DFHEIV0(25:11)
 14461     CALL 'kxdfhei1' USING DFHEIV0,
 14462           W-CNTL-FILE-ID,
 14463           DFHEIV20,
 14464           DFHEIV99,
 14465           W-CNTL-KEY,
 14466           DFHEIV99,
 14467           DFHEIV99,
 14468           DFHEIV99
 14469     SET ADDRESS OF CONTROL-FILE TO
 14470         DFHEIV20
 14471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14472
 14473
 14474     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14475     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14476     GO TO 6630-EXIT.
 14477
 14478 6630-CNTL2-NOT-FOUND.
 14479
 14480*    MOVE ER-8965                TO EMI-ERROR.
 14481*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14482*    MOVE -1                     TO MAINTL.
 14483*    MOVE AL-UANON               TO MAINTA.
 14484*    GO TO 8200-SEND-DATAONLY
 14485     .
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 298
* EL689.cbl
 14486 6630-EXIT.
 14487     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 299
* EL689.cbl
 14489 6700-GET-MAIL-DATA.
 14490
 14491     IF  ADDRSI EQUAL '5'
 14492             AND
 14493         PI-CREATE-LABELS
 14494             AND
 14495         NOT PI-689-LABELS-OVERRIDEN
 14496         NEXT SENTENCE
 14497     ELSE
 14498         IF  W-FILE-NOT-USED (5)
 14499             GO TO 6700-EXIT.
 14500
 14501     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14502         MOVE ER-9327            TO EMI-ERROR
 14503         MOVE -1                 TO MAINTL
 14504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14505         GO TO 6700-EXIT.
 14506
 14507
 14508* EXEC CICS HANDLE CONDITION
 14509*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14510*         NOTFND  (6700-MAIL-NOT-FOUND)
 14511*    END-EXEC.
 14512*    MOVE '"$JI                  ! 4 #00013526' TO DFHEIV0
 14513     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14515     MOVE X'3420233030303133353236' TO DFHEIV0(25:11)
 14516     CALL 'kxdfhei1' USING DFHEIV0
 14517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14518
 14519
 14520
 14521* EXEC CICS READ
 14522*         DATASET(W-MAIL-FILE-ID)
 14523*         SET    (ADDRESS OF MAILING-DATA)
 14524*         RIDFLD (W-MAIL-KEY)
 14525*    END-EXEC.
 14526*    MOVE '&"S        E          (   #00013531' TO DFHEIV0
 14527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14529     MOVE X'2020233030303133353331' TO DFHEIV0(25:11)
 14530     CALL 'kxdfhei1' USING DFHEIV0,
 14531           W-MAIL-FILE-ID,
 14532           DFHEIV20,
 14533           DFHEIV99,
 14534           W-MAIL-KEY,
 14535           DFHEIV99,
 14536           DFHEIV99,
 14537           DFHEIV99
 14538     SET ADDRESS OF MAILING-DATA TO
 14539         DFHEIV20
 14540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14541
 14542
 14543     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14544     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14545     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14546     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 300
* EL689.cbl
 14547
 14548     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14549     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14550     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14551     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14552     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14553*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14554     STRING MA-CITY ' ' MA-ADDR-STATE
 14555        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14556     END-STRING
 14557
 14558     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14559     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14560
 14561     IF  MA-CANADIAN-POST-CODE
 14562         MOVE MA-CANADIAN-POSTAL-CODE
 14563                                 TO W-CANADIAN-POSTAL-CODES
 14564         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14565         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14566         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14567                                    W-LAB-CAN-FILLER (6)
 14568     ELSE
 14569         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14570         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14571             MOVE '-'            TO W-LABEL-DASH (6)
 14572             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14573         ELSE
 14574             MOVE SPACES         TO W-LABEL-DASH (6)
 14575                                    W-LABEL-2ND-ZIP (6).
 14576
 14577     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14578
 14579     IF  ADDRSI EQUAL '5'
 14580             AND
 14581         PI-CREATE-LABELS
 14582             AND
 14583         NOT PI-689-LABELS-OVERRIDEN
 14584         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14585                                    W-VG-TEXT (31)
 14586         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14587                                    W-VG-TEXT (32)
 14588         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14589                                    W-VG-TEXT (33)
 14590         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14591                                    W-VG-TEXT (34)
 14592         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14593                                    W-VG-TEXT (35)
 14594         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14595                                    W-VG-TEXT (36)
 14596         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14597         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14598         SET W-RG-NDX UP BY +1
 14599     ELSE
 14600         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14601         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14602         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14603         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14604         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 301
* EL689.cbl
 14605         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14606     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14607     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14608     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14609     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14610     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14611        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14612     END-STRING
 14613
 14614     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14615     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14616
 14617     IF  MA-CB-CANADIAN-POST-CODE
 14618         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14619                                 TO W-CANADIAN-POSTAL-CODES
 14620         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14621         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14622         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14623                                    W-LAB-CAN-FILLER (5)
 14624     ELSE
 14625         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14626         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14627             MOVE '-'            TO W-LABEL-DASH (5)
 14628             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14629         ELSE
 14630             MOVE SPACES         TO W-LABEL-DASH (5)
 14631                                    W-LABEL-2ND-ZIP (5)
 14632         END-IF
 14633     END-IF
 14634     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14635     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14636     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14637     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14638     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14639     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14640     GO TO 6700-EXIT.
 14641
 14642 6700-MAIL-NOT-FOUND.
 14643
 14644     IF  ADDRSL GREATER ZERO
 14645         IF ADDRSI = '5'
 14646            MOVE ER-3000         TO EMI-ERROR
 14647            MOVE -1              TO ADDRSL
 14648            MOVE AL-UNBON        TO ADDRSA
 14649            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14650            GO TO 8200-SEND-DATAONLY.
 14651
 14652 6700-EXIT.
 14653     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 302
* EL689.cbl
 14655 6750-GET-LIFE-BENEFIT-DATA.
 14656
 14657     IF  W-FILE-NOT-USED (2)
 14658         GO TO 6750-EXIT.
 14659
 14660     MOVE SPACES                 TO W-CNTL-GEN2.
 14661
 14662     IF  DATASORI EQUAL '2'
 14663         IF  W-FILE-NOT-USED (8)
 14664             PERFORM 6450-READ-CERT-ONLY
 14665             IF  W-CERT-FOUND
 14666                 MOVE CM-LF-BENEFIT-CD
 14667                                 TO W-BEN-HOLD
 14668                                    W-CNTL-GEN2
 14669             ELSE
 14670                 NEXT SENTENCE
 14671         ELSE
 14672             MOVE CM-LF-BENEFIT-CD
 14673                                 TO W-BEN-HOLD
 14674                                    W-CNTL-GEN2
 14675     ELSE
 14676         IF  DATASORI EQUAL '4'
 14677             IF  W-FILE-NOT-USED (9)
 14678                 PERFORM 6400-READ-PNDB-ONLY
 14679                 IF  W-PNDB-FOUND
 14680                     IF  PI-689-TYPE = '1'
 14681                         MOVE PB-I-LF-BENEFIT-CD
 14682                                 TO W-BEN-HOLD
 14683                                    W-CNTL-GEN2
 14684                     ELSE
 14685                         MOVE PB-CI-LF-BENEFIT-CD
 14686                                 TO W-BEN-HOLD
 14687                                    W-CNTL-GEN2
 14688             ELSE
 14689                 NEXT SENTENCE
 14690         ELSE
 14691             IF  W-FILE-USED (8)
 14692                 MOVE CM-LF-BENEFIT-CD
 14693                                 TO W-BEN-HOLD
 14694                                    W-CNTL-GEN2
 14695             ELSE
 14696                 IF  W-FILE-USED (9)
 14697                     IF  PI-689-TYPE = '1'
 14698                         MOVE PB-I-LF-BENEFIT-CD
 14699                                 TO W-BEN-HOLD
 14700                                    W-CNTL-GEN2
 14701                     ELSE
 14702                         MOVE PB-CI-LF-BENEFIT-CD
 14703                                 TO W-BEN-HOLD
 14704                                    W-CNTL-GEN2.
 14705
 14706     IF  W-CNTL-GEN2 EQUAL SPACES
 14707         MOVE ER-9327            TO EMI-ERROR
 14708         MOVE -1                 TO MAINTL
 14709         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14710         GO TO 6750-EXIT.
 14711
 14712     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 303
* EL689.cbl
 14713     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14714     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14715
 14716
 14717* EXEC CICS HANDLE CONDITION
 14718*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14719*         NOTFND  (6750-EXIT)
 14720*    END-EXEC.
 14721*    MOVE '"$JI                  ! 5 #00013710' TO DFHEIV0
 14722     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14724     MOVE X'3520233030303133373130' TO DFHEIV0(25:11)
 14725     CALL 'kxdfhei1' USING DFHEIV0
 14726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14727
 14728
 14729
 14730* EXEC CICS READ
 14731*         DATASET (W-CNTL-FILE-ID)
 14732*         SET     (ADDRESS OF CONTROL-FILE)
 14733*         GTEQ
 14734*         RIDFLD  (W-CNTL-KEY)
 14735*    END-EXEC.
 14736*    MOVE '&"S        G          (   #00013715' TO DFHEIV0
 14737     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14739     MOVE X'2020233030303133373135' TO DFHEIV0(25:11)
 14740     CALL 'kxdfhei1' USING DFHEIV0,
 14741           W-CNTL-FILE-ID,
 14742           DFHEIV20,
 14743           DFHEIV99,
 14744           W-CNTL-KEY,
 14745           DFHEIV99,
 14746           DFHEIV99,
 14747           DFHEIV99
 14748     SET ADDRESS OF CONTROL-FILE TO
 14749         DFHEIV20
 14750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14751
 14752
 14753     MOVE 1                      TO W-NDX.
 14754
 14755 6750-LOOP.
 14756
 14757     IF  W-NDX = 9
 14758         GO TO 6750-EXIT.
 14759
 14760     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14761         ADD 1                   TO W-NDX
 14762         GO TO 6750-LOOP.
 14763
 14764     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14765         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14766                                 TO W-VG-TEXT (11).
 14767
 14768 6750-EXIT.
 14769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 304
* EL689.cbl
 14771 6800-GET-A-H-BENEFIT-DATA.
 14772
 14773     IF  W-FILE-NOT-USED (3)
 14774         GO TO 6800-EXIT.
 14775
 14776     MOVE SPACES                 TO W-CNTL-GEN2.
 14777
 14778     IF  DATASORI EQUAL '2'
 14779         IF  W-FILE-NOT-USED (8)
 14780             PERFORM 6450-READ-CERT-ONLY
 14781             IF  W-CERT-FOUND
 14782                 MOVE CM-AH-BENEFIT-CD
 14783                                 TO W-BEN-HOLD
 14784                                    W-CNTL-GEN2
 14785             ELSE
 14786                 NEXT SENTENCE
 14787         ELSE
 14788             MOVE CM-AH-BENEFIT-CD
 14789                                 TO W-BEN-HOLD
 14790                                    W-CNTL-GEN2
 14791     ELSE
 14792         IF  DATASORI EQUAL '4'
 14793             IF  W-FILE-NOT-USED (9)
 14794                 PERFORM 6400-READ-PNDB-ONLY
 14795                 IF  W-PNDB-FOUND
 14796                     IF  PI-689-TYPE = '1'
 14797                         MOVE PB-I-AH-BENEFIT-CD
 14798                                 TO W-BEN-HOLD
 14799                                    W-CNTL-GEN2
 14800                     ELSE
 14801                         MOVE PB-CI-AH-BENEFIT-CD
 14802                                 TO W-BEN-HOLD
 14803                                    W-CNTL-GEN2
 14804             ELSE
 14805                 NEXT SENTENCE
 14806         ELSE
 14807             IF  W-FILE-USED (8)
 14808                 MOVE CM-AH-BENEFIT-CD
 14809                                 TO W-BEN-HOLD
 14810                                    W-CNTL-GEN2
 14811             ELSE
 14812                 IF  W-FILE-USED (9)
 14813                     IF  PI-689-TYPE = '1'
 14814                         MOVE PB-I-AH-BENEFIT-CD
 14815                                 TO W-BEN-HOLD
 14816                                    W-CNTL-GEN2
 14817                     ELSE
 14818                         MOVE PB-CI-AH-BENEFIT-CD
 14819                                 TO W-BEN-HOLD
 14820                                    W-CNTL-GEN2.
 14821
 14822     IF  W-CNTL-GEN2 EQUAL SPACES
 14823         MOVE ER-9327            TO EMI-ERROR
 14824         MOVE -1                 TO MAINTL
 14825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14826         GO TO 6800-EXIT.
 14827
 14828     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 305
* EL689.cbl
 14829     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14830     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14831
 14832
 14833* EXEC CICS HANDLE CONDITION
 14834*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14835*         NOTFND  (6800-EXIT)
 14836*    END-EXEC.
 14837*    MOVE '"$JI                  ! 6 #00013801' TO DFHEIV0
 14838     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14839     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14840     MOVE X'3620233030303133383031' TO DFHEIV0(25:11)
 14841     CALL 'kxdfhei1' USING DFHEIV0
 14842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14843
 14844
 14845
 14846* EXEC CICS READ
 14847*         DATASET (W-CNTL-FILE-ID)
 14848*         SET     (ADDRESS OF CONTROL-FILE)
 14849*         RIDFLD  (W-CNTL-KEY)
 14850*         GTEQ
 14851*    END-EXEC.
 14852*    MOVE '&"S        G          (   #00013806' TO DFHEIV0
 14853     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14854     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14855     MOVE X'2020233030303133383036' TO DFHEIV0(25:11)
 14856     CALL 'kxdfhei1' USING DFHEIV0,
 14857           W-CNTL-FILE-ID,
 14858           DFHEIV20,
 14859           DFHEIV99,
 14860           W-CNTL-KEY,
 14861           DFHEIV99,
 14862           DFHEIV99,
 14863           DFHEIV99
 14864     SET ADDRESS OF CONTROL-FILE TO
 14865         DFHEIV20
 14866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14867
 14868
 14869     MOVE 1                      TO W-NDX.
 14870
 14871 6800-LOOP-AH.
 14872
 14873     IF  W-NDX = 9
 14874         GO TO 6800-EXIT.
 14875
 14876     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14877         ADD 1                   TO W-NDX
 14878         GO TO 6800-LOOP-AH.
 14879
 14880     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14881         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14882                                 TO W-VG-TEXT (15)
 14883         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14884                                 TO W-BENEFIT-WORK
 14885         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14886
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 306
* EL689.cbl
 14887 6800-EXIT.
 14888     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 307
* EL689.cbl
 14890 6850-GET-CHECK-DATA.
 14891
 14892     IF  ADDRSI EQUAL '6'
 14893             AND
 14894         PI-CREATE-LABELS
 14895             AND
 14896         NOT PI-689-LABELS-OVERRIDEN
 14897         NEXT SENTENCE
 14898     ELSE
 14899         IF  W-FILE-NOT-USED (12)
 14900             GO TO 6850-EXIT.
 14901
 14902     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14903         MOVE ER-9327            TO EMI-ERROR
 14904         MOVE -1                 TO MAINTL
 14905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14906         GO TO 6850-EXIT.
 14907
 14908
 14909* EXEC CICS HANDLE CONDITION
 14910*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14911*         NOTFND  (6850-CHEK-NOT-FOUND)
 14912*    END-EXEC.
 14913*    MOVE '"$JI                  ! 7 #00013852' TO DFHEIV0
 14914     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14916     MOVE X'3720233030303133383532' TO DFHEIV0(25:11)
 14917     CALL 'kxdfhei1' USING DFHEIV0
 14918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14919
 14920
 14921
 14922* EXEC CICS READ
 14923*         DATASET (W-CHEK-FILE-ID)
 14924*         SET     (ADDRESS OF CHECK-RECORDS)
 14925*         RIDFLD  (W-CHEK-KEY)
 14926*    END-EXEC.
 14927*    MOVE '&"S        E          (   #00013857' TO DFHEIV0
 14928     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14930     MOVE X'2020233030303133383537' TO DFHEIV0(25:11)
 14931     CALL 'kxdfhei1' USING DFHEIV0,
 14932           W-CHEK-FILE-ID,
 14933           DFHEIV20,
 14934           DFHEIV99,
 14935           W-CHEK-KEY,
 14936           DFHEIV99,
 14937           DFHEIV99,
 14938           DFHEIV99
 14939     SET ADDRESS OF CHECK-RECORDS TO
 14940         DFHEIV20
 14941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14942
 14943
 14944     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 14945     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 14946     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 14947     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 308
* EL689.cbl
 14948                                    PI-689-CONTROL.
 14949     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 14950     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 14951
 14952     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14953     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 14954     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 14955     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 14956     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 14957     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 14958
 14959     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 14960     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14961
 14962     IF  CH-CANADIAN-POST-CODE
 14963         MOVE CH-CANADIAN-POSTAL-CODE
 14964                                 TO W-CANADIAN-POSTAL-CODES
 14965         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14966         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14967         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14968                                    W-LAB-CAN-FILLER (6)
 14969     ELSE
 14970         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14971         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14972             MOVE '-'            TO W-LABEL-DASH (6)
 14973             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14974         ELSE
 14975             MOVE SPACES         TO W-LABEL-DASH (6)
 14976                                    W-LABEL-2ND-ZIP (6).
 14977
 14978     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14979
 14980     IF  ADDRSI EQUAL '6'
 14981             AND
 14982         PI-CREATE-LABELS
 14983             AND
 14984         NOT PI-689-LABELS-OVERRIDEN
 14985         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14986                                    W-VG-TEXT (159)
 14987         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14988                                    W-VG-TEXT (160)
 14989         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14990                                    W-VG-TEXT (161)
 14991         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14992                                    W-VG-TEXT (162)
 14993         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14994                                    W-VG-TEXT (163)
 14995         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14996                                    W-VG-TEXT (164)
 14997         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14998         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14999         SET W-RG-NDX UP BY +1
 15000     ELSE
 15001         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 15002         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 15003         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 15004         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 15005         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 309
* EL689.cbl
 15006         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 15007
 15008     GO TO 6850-EXIT.
 15009
 15010 6850-CHEK-NOT-FOUND.
 15011
 15012     IF  ADDRSL GREATER ZERO
 15013         IF ADDRSI = '6'
 15014            MOVE ER-2908         TO EMI-ERROR
 15015            MOVE -1              TO ADDRSL
 15016            MOVE AL-UNBON        TO ADDRSA
 15017            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15018            GO TO 8200-SEND-DATAONLY.
 15019
 15020 6850-EXIT.
 15021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 310
* EL689.cbl
 15023 6900-GET-PYAJ-DATA.
 15024
 15025     IF  W-FILE-NOT-USED (13)
 15026         GO TO 6900-EXIT.
 15027
 15028     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 15029         MOVE ER-9327            TO EMI-ERROR
 15030         MOVE -1                 TO MAINTL
 15031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15032         GO TO 6900-EXIT.
 15033
 15034
 15035* EXEC CICS HANDLE CONDITION
 15036*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 15037*         NOTFND  (6900-PYAJ-NOT-FOUND)
 15038*    END-EXEC.
 15039*    MOVE '"$JI                  ! 8 #00013953' TO DFHEIV0
 15040     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15042     MOVE X'3820233030303133393533' TO DFHEIV0(25:11)
 15043     CALL 'kxdfhei1' USING DFHEIV0
 15044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15045
 15046
 15047 6900-READ-NEXT.
 15048
 15049
 15050* EXEC CICS READ
 15051*         DATASET (W-PYAJ-FILE-ID)
 15052*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 15053*         RIDFLD  (W-PYAJ-KEY)
 15054*         GTEQ
 15055*    END-EXEC.
 15056*    MOVE '&"S        G          (   #00013960' TO DFHEIV0
 15057     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15059     MOVE X'2020233030303133393630' TO DFHEIV0(25:11)
 15060     CALL 'kxdfhei1' USING DFHEIV0,
 15061           W-PYAJ-FILE-ID,
 15062           DFHEIV20,
 15063           DFHEIV99,
 15064           W-PYAJ-KEY,
 15065           DFHEIV99,
 15066           DFHEIV99,
 15067           DFHEIV99
 15068     SET ADDRESS OF PENDING-PAY-ADJ TO
 15069         DFHEIV20
 15070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15071
 15072
 15073     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 15074             OR
 15075         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 15076             OR
 15077         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 15078             OR
 15079         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 15080             OR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 311
* EL689.cbl
 15081         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 15082         GO TO 6900-PYAJ-NOT-FOUND.
 15083
 15084     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 15085             AND
 15086         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 15087         GO TO 6900-PYAJ-NOT-FOUND.
 15088
 15089     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 15090         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 15091         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 15092         GO TO 6900-READ-NEXT.
 15093
 15094     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 15095     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 15096
 15097     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 15098     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 15099
 15100     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 15101                                    PI-689-CONTROL.
 15102     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 15103     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 15104
 15105     GO TO 6900-EXIT.
 15106
 15107 6900-PYAJ-NOT-FOUND.
 15108
 15109     MOVE ER-7395                TO EMI-ERROR
 15110     MOVE -1                     TO DATASORL
 15111     MOVE AL-UNBON               TO DATASORA
 15112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15113     GO TO 8200-SEND-DATAONLY.
 15114
 15115 6900-EXIT.
 15116     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 312
* EL689.cbl
 15118 6950-MOVE-SYSTEM-DATA.
 15119
 15120     IF  W-FILE-NOT-USED (7)
 15121         GO TO 6950-EXIT.
 15122
 15123     MOVE EIBDATE                TO W-DATE-WORK.
 15124     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 15125     MOVE '5'                    TO DC-OPTION-CODE.
 15126     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 15127     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 15128     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 15129
 15130     MOVE FORMI                  TO W-VG-TEXT (62).
 15131
 15132     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 15133         MOVE PI-689-VARIABLE-DATA-1
 15134                                 TO W-VG-TEXT (63)
 15135         MOVE PI-689-VARIABLE-DATA-2
 15136                                 TO W-VG-TEXT (64)
 15137         MOVE PI-689-VARIABLE-DATA-3
 15138                                 TO W-VG-TEXT (65)
 15139         MOVE PI-689-VARIABLE-DATA-4
 15140                                 TO W-VG-TEXT (66)
 15141     ELSE
 15142         MOVE '(VARIABLE NOT PROVIDED)'
 15143                                 TO W-VG-TEXT (63).
 15144
 15145 6950-EXIT.
 15146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 313
* EL689.cbl
 15148 7000-FORMAT-SCREEN.
 15149
 15150     IF  MAINTI EQUAL 'S'
 15151             OR
 15152         PI-SHOW-MODE
 15153         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 15154     ELSE
 15155         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 15156
 15157     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 15158         SET W-LINE23            TO W-RG-NDX
 15159         MOVE 'A'                TO W-LINE1
 15160     ELSE
 15161         SET W-LIN-NUM           TO W-RG-NDX
 15162         COMPUTE W-LIN-NUM
 15163             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 15164
 15165     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 15166     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 15167     SET W-RG-NDX UP BY 1.
 15168
 15169 7000-EXIT.
 15170      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 314
* EL689.cbl
 15172 7100-FORMAT-LAST-NAME-1ST.
 15173*****************************************************************
 15174*             M O V E   N A M E   R O U T I N E                 *
 15175*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15176*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15177*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15178*                  FIELD                   VALUE                *
 15179*           W-NAME-LAST    (CL15)      SMITH                    *
 15180*           W-NAME-FIRST   (CL15)      JOHN                     *
 15181*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15182*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15183*     CONTAIN                                                   *
 15184*                SMITH, JOHN ALLEN                              *
 15185*     OR                                                        *
 15186*                SMITH, JOHN A.                                 *
 15187*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15188*     COPYBOOK, ELCNWA.                                         *
 15189*****************************************************************.
 15190
 15191     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15192     MOVE ZERO                   TO WS-NAME-SW.
 15193     SET NWA-INDEX               TO +1.
 15194
 15195     IF  W-NAME-LAST EQUAL SPACES
 15196             AND
 15197         W-NAME-MIDDLE EQUAL SPACES
 15198         MOVE +1                 TO WS-NAME-SW.
 15199
 15200     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15201     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15202
 15203     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15204     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15205
 15206     SET NWA-INDEX UP BY +1.
 15207
 15208     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15209         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15210             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15211             SET NWA-INDEX UP BY +1
 15212             MOVE '.'            TO WS-NW (NWA-INDEX)
 15213             SET NWA-INDEX UP BY +2
 15214         ELSE
 15215             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15216             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15217
 15218 7100-EXIT.
 15219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 315
* EL689.cbl
 15221 7110-MOVE-NAME.
 15222
 15223     IF  WS-NAME-SW GREATER THAN +1
 15224         GO TO 7110-EXIT.
 15225
 15226     IF  WS-NAME-WORK2 = SPACES
 15227         GO TO 7110-EXIT.
 15228
 15229     SET NWA-INDEX2            TO +1.
 15230     SET NWA-INDEX3            TO +2.
 15231
 15232 7110-MOVE-NAME-CYCLE.
 15233
 15234     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15235
 15236     IF  NWA-INDEX LESS THAN +30
 15237         SET NWA-INDEX UP BY +1
 15238     ELSE
 15239         ADD +2                TO WS-NAME-SW
 15240         GO TO 7110-EXIT.
 15241
 15242     IF  NWA-INDEX2 LESS THAN +20
 15243         SET NWA-INDEX3 UP BY +1
 15244         SET NWA-INDEX2 UP BY +1.
 15245
 15246     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15247             AND
 15248         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15249         IF  WS-NAME-SW EQUAL ZERO
 15250             MOVE ','            TO WS-NW (NWA-INDEX)
 15251             SET NWA-INDEX UP BY +2
 15252             MOVE +1             TO WS-NAME-SW
 15253             GO TO 7110-EXIT
 15254         ELSE
 15255             GO TO 7110-EXIT.
 15256
 15257     GO TO 7110-MOVE-NAME-CYCLE.
 15258
 15259 7110-EXIT.
 15260     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 316
* EL689.cbl
 15262 7200-FORMAT-NAME-STRAIGHT.
 15263*****************************************************************
 15264*           M O V E   N A M E   R O U T I N E                   *
 15265*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15266*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15267*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15268*                  FIELD                   VALUE                *
 15269*           W-NAME-LAST    (CL15)      SMITH                    *
 15270*           W-NAME-FIRST   (CL15)      JOHN                     *
 15271*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15272*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15273*     CONTAIN                                                   *
 15274*              JOHN A. SMITH                                    *
 15275*     OR                                                        *
 15276*              JOHN ALLEN SMITH                                 *
 15277*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15278*     COPYBOOK, ELCNWA.                                         *
 15279*****************************************************************
 15280
 15281     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15282     MOVE ZERO                   TO WS-NAME-SW.
 15283     SET NWA-INDEX               TO +1.
 15284
 15285     IF  W-NAME-FIRST EQUAL SPACES
 15286             AND
 15287         W-NAME-MIDDLE EQUAL SPACES
 15288         MOVE W-NAME-LAST        TO WS-NAME-WORK
 15289         GO TO 7200-EXIT.
 15290
 15291     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15292     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15293
 15294     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15295         SET NWA-INDEX UP BY +1
 15296
 15297         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15298             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15299             SET NWA-INDEX UP BY +1
 15300             MOVE '.'            TO WS-NW (NWA-INDEX)
 15301             SET NWA-INDEX UP BY +1
 15302
 15303         ELSE
 15304             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15305             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15306
 15307     SET NWA-INDEX UP BY +1
 15308     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15309     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15310
 15311 7200-EXIT.
 15312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 317
* EL689.cbl
 15314 7290-MOVE-NAME.
 15315
 15316     IF  WS-NAME-SW GREATER THAN +1
 15317         GO TO 7290-EXIT.
 15318
 15319     IF  WS-NAME-WORK2 EQUAL SPACES
 15320         GO TO 7290-EXIT.
 15321
 15322     SET NWA-INDEX2            TO +1.
 15323     SET NWA-INDEX3            TO +2.
 15324
 15325 7290-MOVE-NAME-CYCLE.
 15326
 15327     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15328
 15329     IF  NWA-INDEX LESS THAN +30
 15330         SET NWA-INDEX UP BY +1
 15331     ELSE
 15332         ADD +2                TO WS-NAME-SW
 15333         GO TO 7290-EXIT.
 15334
 15335     IF  NWA-INDEX2 LESS THAN +20
 15336         SET NWA-INDEX2 UP BY +1
 15337         SET NWA-INDEX3 UP BY +1.
 15338
 15339     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15340             AND
 15341         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15342         GO TO 7290-EXIT.
 15343
 15344     GO TO 7290-MOVE-NAME-CYCLE.
 15345
 15346 7290-EXIT.
 15347     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 318
* EL689.cbl
 15349 7300-LABEL-MOVE.
 15350
 15351     IF  W-LABEL-HOLD-AREA = SPACES
 15352         MOVE +0                 TO W-NUMB-LABEL-LINES
 15353         GO TO 7300-EXIT.
 15354
 15355     IF  W-LABEL-LINES (1) = SPACES
 15356         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 15357         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15358         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15359         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15360         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15361         MOVE SPACES             TO W-LABEL-LINES (6)
 15362         GO TO 7300-LABEL-MOVE.
 15363
 15364     IF  W-LABEL-LINES (2) = SPACES
 15365             AND
 15366         W-LABEL-LINES (3) = SPACES
 15367             AND
 15368         W-LABEL-LINES (4) = SPACES
 15369             AND
 15370         W-LABEL-LINES (5) = SPACES
 15371             AND
 15372         W-LABEL-LINES (6) = SPACES
 15373         MOVE 1                  TO W-NDX
 15374                                    W-NUMB-LABEL-LINES
 15375         GO TO 7300-EXIT.
 15376
 15377 7300-TRY-2.
 15378
 15379     IF  W-LABEL-LINES (2) = SPACES
 15380         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15381         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15382         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15383         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15384         MOVE SPACES             TO W-LABEL-LINES (6)
 15385         GO TO 7300-TRY-2.
 15386
 15387     IF  W-LABEL-LINES (3) = SPACES
 15388             AND
 15389         W-LABEL-LINES (4) = SPACES
 15390             AND
 15391         W-LABEL-LINES (5) = SPACES
 15392             AND
 15393         W-LABEL-LINES (6) = SPACES
 15394         MOVE 2                  TO W-NDX
 15395         GO TO 7300-MOVE-ZIP.
 15396
 15397 7300-TRY-3.
 15398
 15399     IF  W-LABEL-LINES (3) = SPACES
 15400         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15401         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15402         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15403         MOVE SPACES             TO W-LABEL-LINES (6)
 15404         GO TO 7300-TRY-3.
 15405
 15406     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 319
* EL689.cbl
 15407             AND
 15408         W-LABEL-LINES (5) = SPACES
 15409             AND
 15410         W-LABEL-LINES (6) = SPACES
 15411         MOVE 3                   TO W-NDX
 15412         GO TO 7300-MOVE-ZIP.
 15413
 15414 7300-TRY-4.
 15415
 15416     IF  W-LABEL-LINES (4) = SPACES
 15417         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15418         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15419         MOVE SPACES             TO W-LABEL-LINES (6)
 15420         GO TO 7300-TRY-4.
 15421
 15422     IF  W-LABEL-LINES (5) = SPACES
 15423             AND
 15424         W-LABEL-LINES (6) = SPACES
 15425         MOVE 4                  TO W-NDX
 15426         GO TO 7300-MOVE-ZIP.
 15427
 15428 7300-TRY-5.
 15429
 15430     IF  W-LABEL-LINES (5) = SPACES
 15431         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15432         MOVE SPACES             TO W-LABEL-LINES (6)
 15433         GO TO 7300-TRY-5
 15434     ELSE
 15435         IF  W-LABEL-LINES (6) = SPACES
 15436             MOVE 5              TO W-NDX
 15437             GO TO 7300-MOVE-ZIP
 15438         ELSE
 15439             MOVE 6              TO W-NDX.
 15440
 15441 7300-MOVE-ZIP.
 15442
 15443     COMPUTE W-NDX2 = W-NDX - 1.
 15444
 15445     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15446*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15447
 15448         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15449                 MOVE W-LABEL-ZIP (W-NDX)
 15450                                 TO W-LAST-ZIP (W-NDX2)
 15451                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15452                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15453                 GO TO 7300-EXIT.
 15454
 15455     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15456
 15457 7300-EXIT.
 15458     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 320
* EL689.cbl
 15460 7400-CREATE-LETTER.
 15461****************************************************************
 15462*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15463*    RECORDS.                                                  *
 15464****************************************************************
 15465
 15466     SET W-SQ-NDX                TO W-START-COLUMN.
 15467     MOVE SPACES                 TO W-SQUEEZED-LINE
 15468                                    W-WORK-LINE.
 15469     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15470     MOVE +1                     TO W-LAST-WC-SPACE.
 15471     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15472
 15473     SET W-TG-NDX                TO +1.
 15474
 15475     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15476            VARYING
 15477         W-TG-NDX FROM W-TG-NDX BY +1
 15478            UNTIL
 15479         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15480
 15481     IF  W-FORM-SQUEEZE-ON
 15482             AND
 15483         W-SQUEEZED-LINE GREATER THAN SPACES
 15484         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15485
 15486     PERFORM 7640-PAGING THRU 7640-EXIT.
 15487
 15488 7400-EXIT.
 15489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 321
* EL689.cbl
 15491 7410-TEXT-LINE-PROCESS.
 15492***************************************************************
 15493*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15494*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15495*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15496*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15497*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15498*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15499***************************************************************
 15500
 15501
 15502     SET W-WC-NDX                TO W-ZEROS.
 15503     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15504
 15505     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15506
 15507     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15508             VARYING
 15509         W-TX-NDX FROM +1 BY +1
 15510             UNTIL
 15511         W-TX-NDX GREATER THAN +70.
 15512
 15513****************************************************************
 15514*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15515*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15516*    LINE SQUEEZE CONTROL.                                     *
 15517****************************************************************
 15518     IF  W-FORM-SQUEEZE-ON
 15519
 15520         IF  W-WORK-LINE GREATER THAN SPACES
 15521                 OR
 15522             W-AS-IS
 15523             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15524
 15525         ELSE
 15526             NEXT SENTENCE
 15527****************************************************************
 15528*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15529*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15530****************************************************************
 15531     ELSE
 15532         IF  W-WORK-LINE GREATER THAN SPACES
 15533             MOVE W-TX-PC (W-TG-NDX)
 15534                                 TO W-PRINT-CONTROL
 15535             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15536             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15537             MOVE SPACES         TO W-WORK-LINE.
 15538
 15539 7410-EXIT.
 15540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 322
* EL689.cbl
 15542 7420-TEXT-CHAR-PROCESS.
 15543****************************************************************
 15544*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15545*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15546*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15547*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15548****************************************************************
 15549
 15550     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15551             AND
 15552         W-LAST-CHAR EQUAL '@'
 15553         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15554
 15555     SET W-WC-NDX UP BY +1.
 15556
 15557     IF  W-WC-NDX GREATER THAN +70
 15558         IF  W-FORM-SQUEEZE-ON
 15559                 AND
 15560             NOT W-AS-IS
 15561             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15562                     VARYING
 15563                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15564                     UNTIL
 15565                 W-WC-NDX EQUAL +71
 15566             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15567
 15568             IF  W-WORK-LINE GREATER THAN SPACES
 15569                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15570                 MOVE SPACES     TO W-WORK-LINE
 15571                                    W-LINE-SQUEEZE-IND
 15572                 SET W-WC-NDX    TO +1
 15573             ELSE
 15574                 SET W-WC-NDX    TO +1
 15575         ELSE
 15576             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15577
 15578     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15579                                 TO W-CHARACTER-TYPE.
 15580
 15581     SET W-WC-NDX2               TO W-WC-NDX.
 15582     SET W-WC-NDX2 DOWN BY +1.
 15583
 15584     IF  W-PUNCTUATION
 15585             AND
 15586         W-WC-NDX2 GREATER THAN W-ZEROS
 15587             AND
 15588         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15589         SET W-WC-NDX DOWN BY +1.
 15590
 15591     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15592                                 TO W-LAST-CHAR
 15593                                    W-WORK-CHAR (W-WC-NDX).
 15594
 15595     IF  W-LAST-CHAR EQUAL SPACES
 15596         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15597         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15598
 15599 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 323
* EL689.cbl
 15600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 324
* EL689.cbl
 15602 7430-PROCESS-VARIABLE.
 15603******************************************************************
 15604*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15605*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15606*    ITS CORRESPONDING VALUES.                                   *
 15607******************************************************************
 15608
 15609     SET W-TX-NDX UP BY +1.
 15610
 15611     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15612         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15613                                 TO W-V1
 15614         SET W-TX-NDX UP BY +1
 15615
 15616         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15617             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15618                                 TO W-V2
 15619             SET W-TX-NDX UP BY +1
 15620             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15621                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15622                                 TO W-V3
 15623                 SET W-TX-NDX UP BY +1
 15624                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15625                                 TO W-FIELD-SQUEEZE-IND
 15626                 GO TO 7430-CONTINUE
 15627             ELSE
 15628                 SET W-TX-NDX DOWN BY +3
 15629                 MOVE ER-0180    TO EMI-ERROR
 15630                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15631                 MOVE -1         TO MAINTL
 15632                 MOVE HIGH-VALUES
 15633                                 TO W-LAST-CHAR
 15634         ELSE
 15635             SET W-TX-NDX DOWN BY +2
 15636             MOVE ER-0180        TO EMI-ERROR
 15637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15638             MOVE -1             TO MAINTL
 15639             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15640     ELSE
 15641         SET W-TX-NDX DOWN BY +1
 15642         MOVE ER-7246            TO EMI-ERROR
 15643         MOVE -1                 TO MAINTL
 15644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15645         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15646
 15647****************************************************************
 15648*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15649*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15650*    ACTION.                                                   *
 15651****************************************************************
 15652
 15653     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15654         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15655         GO TO 7430-EXIT
 15656     ELSE
 15657         GO TO 7430-EXIT.
 15658
 15659 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 325
* EL689.cbl
 15660
 15661     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15662             OR
 15663         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15664         SET W-TX-NDX DOWN BY +4
 15665         MOVE ER-0180            TO EMI-ERROR
 15666         MOVE -1                 TO MAINTL
 15667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15668         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15669         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15670             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15671             GO TO 7430-EXIT
 15672         ELSE
 15673             GO TO 7430-EXIT.
 15674
 15675     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15676
 15677     SET W-WC-NDX DOWN BY +1.
 15678
 15679     IF  (W-FORM-SQUEEZE-OFF
 15680                 AND
 15681             NOT W-SQUEEZE-FIELD)
 15682             OR
 15683         (W-FORM-SQUEEZE-ON
 15684                 AND
 15685             W-AS-IS)
 15686         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15687                 VARYING
 15688             W-VC-NDX FROM +1 BY +1
 15689                 UNTIL
 15690             W-VC-NDX GREATER THAN
 15691                 W-VARIABLE-SIZE (W-VG-NDX)
 15692
 15693         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15694             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15695             SET W-TX-NDX DOWN BY +5
 15696             IF  W-TX-NDX GREATER THAN +70
 15697                 SET W-TX-NDX    TO +70
 15698                 GO TO 7430-EXIT
 15699             ELSE
 15700                 GO TO 7430-EXIT
 15701         ELSE
 15702             COMPUTE W-ADJUST-SHORT
 15703                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15704             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15705             GO TO 7430-EXIT.
 15706
 15707     IF  W-SQUEEZE-FIELD
 15708         SET W-TX-NDX UP BY +1.
 15709
 15710     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15711
 15712     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15713             VARYING
 15714         W-VC-NDX FROM +1 BY +1
 15715             UNTIL
 15716         W-VC-NDX GREATER THAN
 15717             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 326
* EL689.cbl
 15718
 15719     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15720
 15721     IF  W-FORM-SQUEEZE-ON
 15722         GO TO 7430-EXIT.
 15723
 15724     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15725         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15726         SET W-TX-NDX DOWN BY +6
 15727         IF  W-TX-NDX GREATER THAN +70
 15728             SET W-TX-NDX        TO +70.
 15729
 15730     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15731         SET W-WC-NDX DOWN BY +1.
 15732
 15733 7430-EXIT.
 15734     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 327
* EL689.cbl
 15736 7435-MOVE-VARIABLE-DIRECT.
 15737
 15738     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15739             AND
 15740         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15741             AND
 15742         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15743             AND
 15744         (W-VC-NDX GREATER THAN +1
 15745                 AND
 15746             W-LAST-CHAR NOT EQUAL SPACE
 15747                 AND
 15748             NOT W-LAST-CHAR-PUNC)
 15749         IF  W-LC-USE-BOTH-CASES
 15750             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15751                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15752         ELSE
 15753             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15754                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15755
 15756     SET W-WC-NDX UP BY +1.
 15757     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15758                                 TO W-WORK-CHAR (W-WC-NDX)
 15759                                    W-LAST-CHAR.
 15760
 15761 7435-EXIT.
 15762     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 328
* EL689.cbl
 15764 7437-FIND-NEXT-CHARACTER.
 15765*DELIBERATELY LEFT BLANK.
 15766 7437-EXIT.
 15767     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 329
* EL689.cbl
 15769 7440-BACK-TO-NEAREST-WORD.
 15770
 15771     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15772
 15773 7440-EXIT.
 15774     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 330
* EL689.cbl
 15776 7450-SQUEEZING.
 15777
 15778     IF  W-NEW-PARAGRAPH
 15779         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15780         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15781         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15782             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15783             MOVE W-TX-PC (W-TG-NDX)
 15784                                 TO W-PRINT-CONTROL
 15785             MOVE SPACES         TO W-SQUEEZED-LINE
 15786             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15787             SET W-SQ-NDX UP BY W-WORK-INDENT
 15788         ELSE
 15789             MOVE W-TX-PC (W-TG-NDX)
 15790                                 TO W-PRINT-CONTROL
 15791             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15792             SET W-SQ-NDX UP BY W-WORK-INDENT
 15793     ELSE
 15794         IF  W-DO-NOT-ADJUST
 15795             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15796             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15797                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15798                 MOVE W-WORK-LINE
 15799                                 TO W-SQUEEZED-LINE
 15800                 MOVE W-TX-PC (W-TG-NDX)
 15801                                 TO W-PRINT-CONTROL
 15802                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15803                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15804                 MOVE SPACES     TO W-SQUEEZED-LINE
 15805                 GO TO 7450-EXIT
 15806             ELSE
 15807                 MOVE W-WORK-LINE
 15808                                 TO W-SQUEEZED-LINE
 15809                 MOVE W-TX-PC (W-TG-NDX)
 15810                                 TO W-PRINT-CONTROL
 15811                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15812                 MOVE SPACES     TO W-SQUEEZED-LINE
 15813                                    W-WORK-LINE
 15814                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15815                 GO TO 7450-EXIT
 15816         ELSE
 15817             IF  W-ADJUST-TO-LINE-LENGTH
 15818                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15819
 15820                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15821                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15822                     SET W-SQ-NDX
 15823                                 TO W-INITIAL-COLUMN
 15824                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15825                             VARYING
 15826                         W-WC-NDX FROM 1 BY 1
 15827                             UNTIL
 15828                         W-SQ-NDX EQUAL W-TOO-FAR
 15829                     MOVE W-TX-PC (W-TG-NDX)
 15830                                 TO W-PRINT-CONTROL
 15831                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15832                     SET W-SQ-NDX
 15833                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 331
* EL689.cbl
 15834                     MOVE SPACES TO W-SQUEEZED-LINE
 15835                                    W-WORK-LINE
 15836                     GO TO 7450-EXIT
 15837                 ELSE
 15838                     SET W-SQ-NDX
 15839                                 TO W-INITIAL-COLUMN
 15840                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15841                             VARYING
 15842                         W-WC-NDX FROM 1 BY 1
 15843                             UNTIL
 15844                         W-SQ-NDX EQUAL W-TOO-FAR
 15845                     MOVE W-TX-PC (W-TG-NDX)
 15846                                 TO W-PRINT-CONTROL
 15847                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15848                     MOVE SPACES TO W-SQUEEZED-LINE
 15849                                    W-WORK-LINE
 15850                     SET W-SQ-NDX
 15851                                 TO W-INITIAL-COLUMN
 15852                     GO TO 7450-EXIT
 15853             ELSE
 15854                 IF  W-CONTINUE-PARAGRAPH
 15855                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15856                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15857                         PERFORM 7610-SET-CONP-INDENT
 15858                             THRU 7610-EXIT
 15859                         MOVE SPACES
 15860                                 TO W-LINE-SQUEEZE-IND
 15861                         MOVE W-TX-PC (W-TG-NDX)
 15862                                 TO W-PRINT-CONTROL
 15863                         MOVE SPACES
 15864                                 TO W-SQUEEZED-LINE
 15865                         SET W-SQ-NDX
 15866                                 TO W-INITIAL-COLUMN
 15867                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15868                     ELSE
 15869                         PERFORM 7610-SET-CONP-INDENT
 15870                             THRU 7610-EXIT
 15871                         MOVE SPACES
 15872                                 TO W-LINE-SQUEEZE-IND
 15873                         MOVE W-TX-PC (W-TG-NDX)
 15874                                 TO W-PRINT-CONTROL
 15875                         MOVE SPACES
 15876                                 TO W-SQUEEZED-LINE
 15877                         SET W-SQ-NDX
 15878                                 TO W-INITIAL-COLUMN
 15879                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15880
 15881
 15882     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15883             VARYING
 15884         W-WC-NDX FROM +1 BY +1
 15885             UNTIL
 15886         W-WC-NDX GREATER THAN +70.
 15887
 15888 7450-EXIT.
 15889     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 332
* EL689.cbl
 15891 7460-REMAIN-CHAR-CHECK.
 15892
 15893     IF  W-TX-NDX EQUAL W-WC-NDX
 15894         MOVE W-TX-PC (W-TG-NDX)
 15895                                 TO W-PRINT-CONTROL
 15896         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15897         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15898         MOVE SPACES             TO W-WORK-LINE
 15899         SET W-WC-NDX            TO +1
 15900     ELSE
 15901         SET W-TX-NDX1           TO W-TX-NDX
 15902         SEARCH W-TX-CHAR
 15903             VARYING W-TX-NDX1
 15904             AT END
 15905                 MOVE W-TX-PC (W-TG-NDX)
 15906                                 TO W-PRINT-CONTROL
 15907                 MOVE W-WORK-LINE
 15908                                 TO W-SQUEEZED-LINE
 15909                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15910                 MOVE SPACES     TO W-WORK-LINE
 15911                 SET W-WC-NDX    TO +1
 15912                 SET W-TX-NDX    TO +1
 15913                 SET W-TG-NDX UP BY +1
 15914             WHEN
 15915                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15916                 MOVE ER-9427    TO EMI-ERROR
 15917                 MOVE -1         TO MAINTL
 15918                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15919                 MOVE W-TX-PC (W-TG-NDX)
 15920                                 TO W-PRINT-CONTROL
 15921                 MOVE W-WORK-LINE
 15922                                 TO W-SQUEEZED-LINE
 15923                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15924                 MOVE SPACES     TO W-WORK-LINE
 15925                 SET W-WC-NDX    TO +1.
 15926
 15927 7460-EXIT.
 15928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 333
* EL689.cbl
 15930 7470-MOVE-CHAR.
 15931
 15932     IF  W-FIRST-CHAR-NOT-FOUND
 15933             AND
 15934         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15935         MOVE SPACES             TO W-LAST-CHAR
 15936         GO TO 7470-EXIT.
 15937
 15938     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 15939
 15940     IF  W-SQUEEZE-FIELD
 15941             AND
 15942         W-LAST-CHAR EQUAL SPACES
 15943             AND
 15944         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15945         GO TO 7470-EXIT.
 15946
 15947     SET W-WC-NDX UP BY +1.
 15948
 15949     IF  W-WC-NDX GREATER THAN +70
 15950         IF  W-FORM-SQUEEZE-ON
 15951             GO TO 7470-EXIT
 15952         ELSE
 15953             MOVE ER-9427        TO EMI-ERROR
 15954             MOVE -1             TO MAINTL
 15955             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15956             GO TO 7470-EXIT.
 15957
 15958     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15959             AND
 15960         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15961             AND
 15962         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15963             AND
 15964         (W-VC-NDX GREATER THAN +1
 15965                 AND
 15966             W-LAST-CHAR NOT EQUAL SPACE
 15967                 AND
 15968             NOT W-LAST-CHAR-PUNC)
 15969         IF  W-LC-USE-BOTH-CASES
 15970             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15971                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15972         ELSE
 15973             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15974                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15975
 15976     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15977                                 TO W-WORK-CHAR (W-WC-NDX)
 15978                                    W-LAST-CHAR.
 15979
 15980     IF  W-LAST-CHAR EQUAL SPACES
 15981         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 15982
 15983 7470-EXIT.
 15984     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 334
* EL689.cbl
 15986 7480-UPDATE-SQUEEZED-LINE.
 15987****************************************************************
 15988*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 15989*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 15990*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 15991*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 15992*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 15993*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 15994****************************************************************
 15995
 15996     SET W-SQ-NDX UP BY +1.
 15997
 15998     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 15999         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 16000                                 TO W-CHARACTER-TYPE
 16001         IF  W-PUNCTUATION
 16002                 OR
 16003             W-SPACE
 16004             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 16005             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16006             MOVE SPACES         TO W-SQUEEZED-LINE
 16007             SET W-SQ-NDX        TO W-START-COLUMN
 16008             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16009             SET W-LAST-SQUEEZED-SPACE
 16010                                 TO W-SQ-NDX
 16011         ELSE
 16012             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16013             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16014             MOVE SPACES         TO W-SQUEEZED-LINE
 16015             SET W-SQ-NDX        TO W-START-COLUMN
 16016             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16017             SET W-LAST-SQUEEZED-SPACE
 16018                                 TO W-SQ-NDX.
 16019
 16020     IF  W-WC-NDX GREATER THAN +70
 16021         GO TO 7480-EXIT.
 16022
 16023     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16024
 16025     IF  W-END-OF-SENTENCE
 16026         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 16027         SET W-WORK-NDX          TO W-SQ-NDX
 16028         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 16029         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 16030             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 16031         ELSE
 16032             NEXT SENTENCE
 16033     ELSE
 16034         IF  W-PUNCTUATION
 16035                 AND
 16036             W-LAST-SQ-CHAR EQUAL SPACES
 16037             SET W-SQ-NDX DOWN BY +1
 16038             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 16039         ELSE
 16040             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 16041                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 16042                     IF  W-END-OF-SENTENCE-WORKING
 16043                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 335
* EL689.cbl
 16044                                 TO W-END-OF-SENTENCE-IND
 16045                         SET W-LAST-SQUEEZED-SPACE
 16046                                 TO W-SQ-NDX
 16047                     ELSE
 16048                         SET W-SQ-NDX DOWN BY +1
 16049                         GO TO 7480-EXIT
 16050                 ELSE
 16051                     SET W-LAST-SQUEEZED-SPACE
 16052                                 TO W-SQ-NDX
 16053             ELSE
 16054                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 16055
 16056     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 16057                                    W-LAST-SQ-CHAR.
 16058
 16059     IF  W-WC-NDX EQUAL +70
 16060             AND
 16061         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 16062             AND
 16063         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 16064         SET W-SQ-NDX UP BY +1
 16065         SET W-LAST-SQUEEZED-SPACE
 16066                                 TO W-SQ-NDX
 16067         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 16068                                    W-LAST-SQ-CHAR.
 16069
 16070 7480-EXIT.
 16071     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 336
* EL689.cbl
 16073 7485-FIND-NEXT-CHARACTER.
 16074
 16075     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16076
 16077     IF  W-PUNCTUATION
 16078         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16079     ELSE
 16080         SET W-WC-NDX            TO W-WC-NDX
 16081         SEARCH W-WORK-CHAR
 16082             VARYING W-WC-NDX
 16083             AT END
 16084                 GO TO 7485-EXIT
 16085             WHEN
 16086                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 16087                 GO TO 7485-EXIT.
 16088
 16089 7485-EXIT.
 16090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 337
* EL689.cbl
 16092 7490-REMOVE-LAST-WORD.
 16093
 16094*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 16095     IF  W-WC-NDX EQUAL +1
 16096         GO TO 7490-EXIT.
 16097
 16098     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 16099
 16100     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 16101             VARYING
 16102         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 16103             UNTIL
 16104         W-SQ-NDX EQUAL W-TOO-FAR.
 16105
 16106     SET W-WORK-NDX              TO W-WC-NDX.
 16107     COMPUTE W-LAST-WC-SPACE
 16108         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 16109     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 16110
 16111 7490-EXIT.
 16112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 338
* EL689.cbl
 16114 7500-CLEAR-SQUEEZED-EXCESS.
 16115
 16116     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 16117
 16118 7500-EXIT.
 16119     EXIT.
 16120
 16121 7505-MOVE-STRAIGHT.
 16122
 16123     SET W-SQ-NDX UP BY +1.
 16124
 16125     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 16126
 16127 7505-EXIT.
 16128     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 339
* EL689.cbl
 16130 7510-MOVE-TO-TABLE.
 16131
 16132     IF  W-PRINT-CONTROL NOT NUMERIC
 16133         MOVE 00                 TO W-PRINT-CONTROL
 16134         ADD +1                  TO W-LINE-COUNT
 16135     ELSE
 16136         IF  W-PRINT-CONTROL EQUAL 99
 16137             PERFORM 7640-PAGING THRU 7640-EXIT
 16138             MOVE 00             TO W-PRINT-CONTROL
 16139             SET W-RG-NDX UP BY +1
 16140             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 16141             MOVE +1             TO W-LINE-COUNT
 16142             SET W-RG-NDX UP BY W-TOP-MARGIN
 16143         ELSE
 16144           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 16145             COMPUTE W-LINE-COUNT
 16146                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 16147
 16148     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 16149         PERFORM 7640-PAGING THRU 7640-EXIT
 16150         MOVE 00                 TO W-PRINT-CONTROL
 16151         SET W-RG-NDX UP BY +1
 16152         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 16153         SET W-RG-NDX UP BY W-TOP-MARGIN
 16154         MOVE +1                 TO W-LINE-COUNT.
 16155
 16156     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 16157     SET W-RG-NDX UP BY +1.
 16158     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 16159     MOVE 00                     TO W-PRINT-CONTROL.
 16160
 16161     IF  W-FIRST-BAD-VARIABLE-FOUND
 16162             AND
 16163         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 16164         SET W-FIRST-BAD-VARIABLE
 16165                                 TO W-RG-NDX.
 16166
 16167 7510-EXIT.
 16168     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 340
* EL689.cbl
 16170 7600-SET-PARA-INDENT.
 16171
 16172     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 16173         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 16174     ELSE
 16175     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 16176         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16177         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16178     ELSE
 16179     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 16180         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16181         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16182     ELSE
 16183     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 16184         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16185         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16186     ELSE
 16187     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 16188         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16189         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16190     ELSE
 16191     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 16192         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 16193         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 16194
 16195     SET W-TG-NDX2               TO W-TG-NDX.
 16196     SET W-TG-NDX2 UP BY +1.
 16197
 16198     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16199         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16200     ELSE
 16201         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16202
 16203 7600-EXIT.
 16204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 341
* EL689.cbl
 16206 7610-SET-CONP-INDENT.
 16207
 16208     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 16209         MOVE +0                 TO W-WORK-INDENT
 16210     ELSE
 16211     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 16212         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16213     ELSE
 16214     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 16215         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16216     ELSE
 16217     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 16218         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16219     ELSE
 16220     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 16221         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16222     ELSE
 16223     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 16224         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 16225
 16226     SET W-TG-NDX2               TO W-TG-NDX.
 16227     SET W-TG-NDX2 UP BY +1.
 16228
 16229     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16230         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16231     ELSE
 16232         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16233
 16234 7610-EXIT.
 16235     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 342
* EL689.cbl
 16237 7630-NEXT-LINE.
 16238
 16239     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 16240         MOVE ZEROS              TO W-NEXT-INDENT
 16241     ELSE
 16242     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 16243         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 16244     ELSE
 16245     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 16246         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 16247     ELSE
 16248     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 16249         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 16250     ELSE
 16251     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 16252         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 16253     ELSE
 16254     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 16255         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 16256     ELSE
 16257         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16258         SUBTRACT W-PARAGRAPH-INDENT
 16259                                  FROM W-NEXT-INDENT.
 16260
 16261 7630-EXIT.
 16262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 343
* EL689.cbl
 16264 7640-PAGING.
 16265
 16266     IF  NOT W-LC-CREATE-PAGES
 16267         GO TO 7640-EXIT.
 16268
 16269     IF  W-LINE-COUNT GREATER ZEROS
 16270             AND
 16271         W-RG-NDX GREATER THAN +1
 16272         ADD +1                  TO W-PAGE
 16273         MOVE W-PAGE             TO W-PAGE-NUMBER
 16274         COMPUTE W-PAGE-LINE
 16275             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 16276         IF  W-PAGE-LINE GREATER THAN +2
 16277             SET W-RG-NDX UP BY W-PAGE-LINE
 16278             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 16279         ELSE
 16280             SET W-RG-NDX UP BY +2
 16281             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 16282
 16283 7640-EXIT.
 16284     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 344
* EL689.cbl
 16286 7700-READ-TEXT-TS.
 16287**************************************************************
 16288*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 16289*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 16290*  AND EL1042.                                               *
 16291**************************************************************
 16292
 16293
 16294* EXEC CICS HANDLE CONDITION
 16295*         QIDERR     (7700-TS-ERROR)
 16296*         ITEMERR    (7700-TS-ERROR)
 16297*    END-EXEC.
 16298*    MOVE '"$N<                  ! 9 #00015187' TO DFHEIV0
 16299     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 16300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16301     MOVE X'3920233030303135313837' TO DFHEIV0(25:11)
 16302     CALL 'kxdfhei1' USING DFHEIV0
 16303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16304
 16305
 16306     SET W-TS-NDX                TO 1.
 16307     MOVE 1                      TO W-TS-ITEM.
 16308
 16309 7700-LOOP.
 16310
 16311     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 16312         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 16313             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16314             GO TO 7700-EXIT
 16315         ELSE
 16316             GO TO 7700-EXIT.
 16317
 16318
 16319* EXEC CICS READQ TS
 16320*         INTO     (W-TS-WORK-AREA)
 16321*         QUEUE    (W-TS-NAME-TEXT)
 16322*         LENGTH   (W-TS-LENGTH)
 16323*         ITEM     (W-TS-ITEM)
 16324*    END-EXEC.
 16325*    MOVE '*$II   L              ''   #00015204' TO DFHEIV0
 16326     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16327     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16328     MOVE X'2020233030303135323034' TO DFHEIV0(25:11)
 16329     CALL 'kxdfhei1' USING DFHEIV0,
 16330           W-TS-NAME-TEXT,
 16331           W-TS-WORK-AREA,
 16332           W-TS-LENGTH,
 16333           W-TS-ITEM,
 16334           DFHEIV99,
 16335           DFHEIV99
 16336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16337
 16338
 16339     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 16340     SET W-TS-NDX UP BY 1.
 16341     ADD 1                       TO W-TS-ITEM.
 16342     GO TO 7700-LOOP.
 16343
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 345
* EL689.cbl
 16344 7700-TS-ERROR.
 16345
 16346     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 16347         MOVE ER-0033            TO EMI-ERROR
 16348         MOVE -1                 TO MAINTL
 16349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16350         GO TO 8200-SEND-DATAONLY.
 16351
 16352 7700-EXIT.
 16353      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 346
* EL689.cbl
 16355 7740-RESTORE-SCREEN.
 16356
 16357     MOVE 'C'                    TO MAINTI.
 16358     MOVE +1                     TO MAINTL.
 16359     MOVE AL-UANON               TO MAINTA.
 16360
 16361     MOVE PI-689-FORM-NUMBER     TO FORMI.
 16362     MOVE +4                     TO FORML.
 16363     MOVE AL-UANON               TO FORMA.
 16364
 16365*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 16366*        MOVE PI-689-PRINT-RESTRICTION
 16367*                                TO PRTRESTL
 16368*        MOVE +1                 TO PRTRESTL
 16369*        MOVE AL-UANON           TO PRTRESTA.
 16370
 16371     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 16372         MOVE PI-689-FOLLOW-UP-EDIT
 16373                                 TO FOLLOWI
 16374         MOVE +8                 TO FOLLOWL
 16375         MOVE AL-UANON           TO FOLLOWA.
 16376
 16377     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 16378         MOVE PI-689-RESEND1-EDIT
 16379                                 TO RESEND1I
 16380         MOVE +8                 TO RESEND1L
 16381         MOVE AL-UANON           TO RESEND1A.
 16382     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 16383         MOVE PI-689-ALT-PRINTER-ID
 16384                                 TO PRINTERI
 16385         MOVE +1                 TO PRINTERL
 16386         MOVE AL-UANON           TO PRINTERA.
 16387
 16388     IF  PI-BYPASS-LABELS
 16389          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 16390          MOVE +1                TO ADDRLBLL
 16391          MOVE AL-UANON          TO ADDRLBLA
 16392     ELSE
 16393          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 16394               MOVE PI-689-LBL-OVERRIDE
 16395                                 TO ADDRLBLI
 16396               MOVE +1           TO ADDRLBLL
 16397               MOVE AL-UANON     TO ADDRLBLA.
 16398
 16399     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 16400         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 16401         MOVE +1                     TO COPIESL
 16402         MOVE AL-UNNON               TO COPIESA.
 16403
 16404     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 16405         MOVE PI-689-LABEL-SOURCE
 16406                                 TO ADDRSI
 16407         MOVE +1                 TO ADDRSL
 16408         MOVE AL-UANON           TO ADDRSA.
 16409
 16410     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 16411     MOVE +1                     TO DATASORL.
 16412     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 347
* EL689.cbl
 16413
 16414     IF  PI-689-CARRIER GREATER THAN SPACES
 16415         MOVE PI-689-CARRIER     TO CARRIERI
 16416         MOVE +1                 TO CARRIERL
 16417         MOVE AL-UANON           TO CARRIERA.
 16418
 16419     IF  PI-689-GROUPING GREATER THAN SPACES
 16420         MOVE PI-689-GROUPING    TO GROUPI
 16421         MOVE +6                 TO GROUPL
 16422         MOVE AL-UANON           TO GROUPA.
 16423
 16424     IF  PI-689-STATE GREATER THAN SPACES
 16425         MOVE PI-689-STATE       TO STATEI
 16426         MOVE +2                 TO STATEL
 16427         MOVE AL-UANON           TO STATEA.
 16428
 16429     IF  PI-689-ACCOUNT GREATER THAN SPACES
 16430         MOVE PI-689-ACCOUNT     TO ACCTI
 16431         MOVE +10                TO ACCTL
 16432         MOVE AL-UANON           TO ACCTA.
 16433
 16434     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16435         MOVE PI-689-CERT-PRIME  TO CERTI
 16436         MOVE +10                TO CERTL
 16437         MOVE AL-UANON           TO CERTA.
 16438
 16439     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16440         MOVE PI-689-CERT-SFX    TO SFXI
 16441         MOVE +1                 TO SFXL
 16442         MOVE AL-UANON           TO SFXA.
 16443
 16444     IF  PI-689-TYPE GREATER THAN SPACES
 16445         MOVE PI-689-TYPE        TO TYPEI
 16446         MOVE +1                 TO TYPEL
 16447         MOVE AL-UANON           TO TYPEA.
 16448
 16449     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16450         MOVE PI-689-RESP-PERSON TO RPERSONI
 16451         MOVE +10                TO RPERSONL
 16452         MOVE AL-UANON           TO RPERSONA.
 16453
 16454     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16455         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16456         MOVE +6                 TO BENTRYL
 16457         MOVE AL-UANON           TO BENTRYA.
 16458
 16459     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16460         MOVE PI-689-SEQ-EDIT    TO SEQI
 16461         MOVE +8                 TO SEQL
 16462         MOVE AL-UNNON           TO SEQA.
 16463
 16464     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16465         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16466         MOVE +4                 TO BCSEQL
 16467         MOVE AL-UNNON           TO BCSEQA.
 16468
 16469     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16470         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 348
* EL689.cbl
 16471         MOVE +8                 TO DATEL
 16472         MOVE AL-UNNON           TO DATEA.
 16473
 16474     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16475        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16476        MOVE +5                  TO CERTIDL
 16477        MOVE AL-UNNON            TO CERTIDA
 16478     END-IF.
 16479
 16480     IF PI-PRINT-NOW GREATER THAN SPACES
 16481        MOVE PI-PRINT-NOW        TO PRTNOWI
 16482        MOVE +1                  TO PRTNOWL
 16483        MOVE AL-UNNON            TO PRTNOWA
 16484     END-IF.
 16485     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16486        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16487        MOVE +8                  TO ENDARCHL
 16488        MOVE AL-UNNON            TO ENDARCHA
 16489     END-IF
 16490
 16491     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16492     MOVE +3                     TO ENCL.
 16493     MOVE AL-UANON               TO ENCA.
 16494
 16495 7749-EXIT.
 16496     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 349
* EL689.cbl
 16498 7760-PUT-TEMP-STORAGE.
 16499**************************************************************
 16500*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16501*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16502*  EL1042 AND EL6892.                                        *
 16503**************************************************************
 16504
 16505     SET W-TS-NDX                TO 1.
 16506     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16507
 16508     MOVE -1                     TO MAINTL.
 16509     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16510             VARYING
 16511         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16512             UNTIL
 16513         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16514
 16515 7760-EXIT.
 16516      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 350
* EL689.cbl
 16518 7780-DELETE-TEMP-STOR-TEXT.
 16519
 16520
 16521* EXEC CICS HANDLE CONDITION
 16522*         QIDERR      (7780-EXIT)
 16523*    END-EXEC.
 16524*    MOVE '"$N                   ! : #00015392' TO DFHEIV0
 16525     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16527     MOVE X'3A20233030303135333932' TO DFHEIV0(25:11)
 16528     CALL 'kxdfhei1' USING DFHEIV0
 16529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16530
 16531
 16532
 16533* EXEC CICS DELETEQ TS
 16534*         QUEUE       (W-TS-NAME-TEXT)
 16535*    END-EXEC.
 16536*    MOVE '*&                    #   #00015396' TO DFHEIV0
 16537     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16538     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16539     MOVE X'2020233030303135333936' TO DFHEIV0(25:11)
 16540     CALL 'kxdfhei1' USING DFHEIV0,
 16541           W-TS-NAME-TEXT,
 16542           DFHEIV99
 16543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16544
 16545
 16546 7780-EXIT.
 16547     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 351
* EL689.cbl
 16549 7840-WRITE-TS.
 16550
 16551     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16552     SET W-TS-NDX UP BY 1.
 16553     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16554
 16555
 16556* EXEC CICS WRITEQ TS
 16557*         FROM    (W-TS-WORK-AREA)
 16558*         QUEUE   (W-TS-NAME-TEXT)
 16559*         LENGTH  (W-TS-LENGTH)
 16560*         ITEM    (PI-TEMP-STOR-ITEMS)
 16561*    END-EXEC.
 16562*    MOVE '*" I                  ''   #00015409' TO DFHEIV0
 16563     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 16564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16565     MOVE X'2020233030303135343039' TO DFHEIV0(25:11)
 16566     CALL 'kxdfhei1' USING DFHEIV0,
 16567           W-TS-NAME-TEXT,
 16568           W-TS-WORK-AREA,
 16569           W-TS-LENGTH,
 16570           PI-TEMP-STOR-ITEMS,
 16571           DFHEIV99,
 16572           DFHEIV99
 16573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16574
 16575
 16576 7840-EXIT.
 16577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 352
* EL689.cbl
 16579 7900-PRINT-LETTER-NOW.
 16580***************************************************************
 16581*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16582*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16583*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16584*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16585*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16586*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16587***************************************************************
 16588
 16589*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16590*            AND
 16591*        PI-SHOW-MODE
 16592*        IF  PRINTERL GREATER ZERO
 16593*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16594*                                                    W-UPPER-CASE
 16595*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16596*                                   PI-ALT-DMD-PRT-ID.
 16597*
 16598*    IF  EIBAID EQUAL DFHPF8
 16599*            AND
 16600*        PI-SHOW-MODE
 16601*            AND
 16602*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16603*        MOVE ER-7247            TO EMI-ERROR
 16604*        MOVE -1                 TO MAINTL
 16605*        MOVE AL-UABON           TO MAINTA
 16606*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16607*        GO TO 8200-SEND-DATAONLY.
 16608
 16609     IF  PI-TOTAL-LINES EQUAL 0
 16610         MOVE ER-0187            TO EMI-ERROR
 16611         MOVE -1                 TO MAINTL
 16612         MOVE AL-UABON           TO MAINTA
 16613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16614         GO TO 8200-SEND-DATAONLY.
 16615
 16616     IF  EMI-ERROR NOT EQUAL ER-0191
 16617         IF  PI-689-CREATE-NO-SCREENS
 16618*                OR
 16619*            (EIBAID = DFHPF4 OR DFHPF8)
 16620             SET W-RG-NDX        TO +1
 16621         ELSE
 16622             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16623             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16624                     VARYING
 16625                 W-SC-NDX FROM 1 BY 1
 16626                     UNTIL
 16627                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16628
 16629     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16630
 16631     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16632         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16633                 VARYING
 16634             W-RVS-NDX FROM +1 BY +1
 16635                 UNTIL
 16636             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 353
* EL689.cbl
 16637                 OR
 16638             W-REMAINING-VAR-FOUND
 16639         IF  W-REMAINING-VAR-FOUND
 16640             GO TO 4000-ROLL-PAGE.
 16641
 16642*    IF EIBAID = DFHPF4 OR DFHPF8
 16643*       PERFORM 7700-READ-TEXT-TS
 16644*                                THRU 7700-EXIT
 16645*
 16646*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16647*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16648*                VARYING
 16649*            W-SC-NDX FROM 1 BY 1
 16650*                UNTIL
 16651*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16652*
 16653*       PERFORM 7760-PUT-TEMP-STORAGE
 16654*                                THRU 7760-EXIT
 16655*    END-IF
 16656     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16657         MOVE PI-689-ALT-PRINTER-ID
 16658                                 TO W-TS-TERM-TEXT
 16659     ELSE
 16660         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16661             MOVE PI-PROCESSOR-PRINTER
 16662                                 TO W-TS-TERM-TEXT
 16663         ELSE
 16664             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16665             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16666             MOVE SPACES         TO W-CNTL-GENL
 16667             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16668
 16669* EXEC CICS HANDLE CONDITION
 16670*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16671*                 NOTFND     (7945-NOT-FOUND)
 16672*            END-EXEC
 16673*    MOVE '"$JI                  ! ; #00015508' TO DFHEIV0
 16674     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16676     MOVE X'3B20233030303135353038' TO DFHEIV0(25:11)
 16677     CALL 'kxdfhei1' USING DFHEIV0
 16678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16679
 16680* EXEC CICS READ
 16681*                 DATASET    (W-CNTL-FILE-ID)
 16682*                 SET        (ADDRESS OF CONTROL-FILE)
 16683*                 RIDFLD     (W-CNTL-KEY)
 16684*            END-EXEC
 16685*    MOVE '&"S        E          (   #00015512' TO DFHEIV0
 16686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16688     MOVE X'2020233030303135353132' TO DFHEIV0(25:11)
 16689     CALL 'kxdfhei1' USING DFHEIV0,
 16690           W-CNTL-FILE-ID,
 16691           DFHEIV20,
 16692           DFHEIV99,
 16693           W-CNTL-KEY,
 16694           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 354
* EL689.cbl
 16695           DFHEIV99,
 16696           DFHEIV99
 16697     SET ADDRESS OF CONTROL-FILE TO
 16698         DFHEIV20
 16699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16700             MOVE CF-FORMS-PRINTER-ID
 16701                                 TO W-TS-TERM-TEXT.
 16702
 16703***********************************************************
 16704*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16705*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16706***********************************************************
 16707
 16708     SET W-TS-NDX                TO 1.
 16709     MOVE EIBTIME                TO W-TS-ID-TIME.
 16710     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16711     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16712
 16713     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16714             VARYING
 16715         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16716             UNTIL
 16717         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16718
 16719*    IF  EIBAID EQUAL DFHPF8
 16720*        MOVE '1'                TO PI-689-PRINT-SW
 16721*    ELSE
 16722         MOVE SPACES             TO PI-689-PRINT-SW.
 16723
 16724
 16725* EXEC CICS HANDLE CONDITION
 16726*         TERMIDERR  (7935-TERM-ERROR)
 16727*         TRANSIDERR (7940-TRAN-ERROR)
 16728*    END-EXEC.
 16729*    MOVE '"$[\                  ! < #00015541' TO DFHEIV0
 16730     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16732     MOVE X'3C20233030303135353431' TO DFHEIV0(25:11)
 16733     CALL 'kxdfhei1' USING DFHEIV0
 16734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16735
 16736
 16737
 16738* EXEC CICS START
 16739*             INTERVAL    (0)
 16740*             TRANSID     (W-PRINT-TRANS)
 16741*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16742*             LENGTH      (PI-COMM-LENGTH)
 16743*             TERMID      (W-TS-TERM-TEXT)
 16744*    END-EXEC.
 16745     MOVE 0 TO DFHEIV10
 16746*    MOVE '0(ILFT                1   #00015546' TO DFHEIV0
 16747     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16748     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16749     MOVE X'2020233030303135353436' TO DFHEIV0(25:11)
 16750     CALL 'kxdfhei1' USING DFHEIV0,
 16751           DFHEIV10,
 16752           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 355
* EL689.cbl
 16753           DFHEIV99,
 16754           PROGRAM-INTERFACE-BLOCK,
 16755           PI-COMM-LENGTH,
 16756           W-TS-TERM-TEXT,
 16757           DFHEIV99,
 16758           DFHEIV99,
 16759           DFHEIV99,
 16760           DFHEIV99,
 16761           DFHEIV99,
 16762           DFHEIV99,
 16763           DFHEIV99,
 16764           DFHEIV99,
 16765           DFHEIV99,
 16766           DFHEIV99
 16767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16768
 16769
 16770
 16771* EXEC CICS SYNCPOINT
 16772*    END-EXEC.
 16773*    MOVE '6"                    !   #00015554' TO DFHEIV0
 16774     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16776     MOVE X'2020233030303135353534' TO DFHEIV0(25:11)
 16777     CALL 'kxdfhei1' USING DFHEIV0
 16778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16779
 16780
 16781     IF  PI-689-CREATE-NO-SCREENS
 16782         GO TO 7900-EXIT.
 16783
 16784*    IF  EIBAID EQUAL DFHPF8
 16785*            AND
 16786*        PI-SHOW-MODE
 16787*            AND
 16788*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16789*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16790
 16791     MOVE ER-0189                TO EMI-ERROR.
 16792     MOVE -1                     TO MAINTL.
 16793
 16794     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16795     MOVE -1                     TO MAINTL
 16796     MOVE AL-UABON               TO MAINTA
 16797     MOVE '104A'                 TO W-TS-ID-TEXT
 16798     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16799                                    W-TS-TERM-SCREEN
 16800     GO TO 8200-SEND-DATAONLY.
 16801
 16802 7900-EXIT.
 16803     EXIT.
 16804
 16805 7915-SEARCH-REMAINING-VARS.
 16806
 16807     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16808         SET W-RVS-NDX2          TO W-RVS-NDX
 16809         SET W-RVS-NDX2 UP BY +1
 16810         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 356
* EL689.cbl
 16811             SET W-RVS-NDX2 UP BY +1
 16812             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16813                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16814                 COMPUTE PI-CURRENT-LINE
 16815                     = PI-CURRENT-LINE / 73
 16816                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16817                 MOVE +0         TO W-ROLL-COUNTER
 16818                 MOVE ER-0191    TO EMI-ERROR
 16819                 MOVE -1         TO MAINTL
 16820                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16821
 16822 7915-EXIT.
 16823     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 357
* EL689.cbl
 16825 7920-UPDATE-INITIAL-PRINT.
 16826
 16827
 16828* EXEC CICS HANDLE CONDITION
 16829*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16830*         NOTFND     (1070-ARCH-NOT-FOUND)
 16831*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16832*    END-EXEC.
 16833*    MOVE '"$JI''                 ! = #00015603' TO DFHEIV0
 16834     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16836     MOVE X'3D20233030303135363033' TO DFHEIV0(25:11)
 16837     CALL 'kxdfhei1' USING DFHEIV0
 16838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16839
 16840     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16841     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16842
 16843* EXEC CICS READ
 16844*        DATASET (W-ARCH-FILE-ID)
 16845*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16846*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16847*        UPDATE
 16848*    END-EXEC.
 16849*    MOVE '&"S        EU         (   #00015610' TO DFHEIV0
 16850     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16851     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16852     MOVE X'2020233030303135363130' TO DFHEIV0(25:11)
 16853     CALL 'kxdfhei1' USING DFHEIV0,
 16854           W-ARCH-FILE-ID,
 16855           DFHEIV20,
 16856           DFHEIV99,
 16857           W-ARCH-PARTIAL-KEY,
 16858           DFHEIV99,
 16859           DFHEIV99,
 16860           DFHEIV99
 16861     SET ADDRESS OF LETTER-ARCHIVE TO
 16862         DFHEIV20
 16863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16864
 16865
 16866     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16867
 16868     IF  LA-RESEND-DATE = LOW-VALUES
 16869         MOVE 'C'                TO LA-STATUS.
 16870
 16871
 16872* EXEC CICS REWRITE
 16873*         FROM      (LETTER-ARCHIVE)
 16874*         DATASET   (W-ARCH-FILE-ID)
 16875*    END-EXEC.
 16876     MOVE LENGTH OF
 16877      LETTER-ARCHIVE
 16878       TO DFHEIV11
 16879*    MOVE '&& L                  %   #00015622' TO DFHEIV0
 16880     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16881     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16882     MOVE X'2020233030303135363232' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 358
* EL689.cbl
 16883     CALL 'kxdfhei1' USING DFHEIV0,
 16884           W-ARCH-FILE-ID,
 16885           LETTER-ARCHIVE,
 16886           DFHEIV11,
 16887           DFHEIV99
 16888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16889
 16890
 16891 7920-EXIT.
 16892     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 359
* EL689.cbl
 16894 7935-TERM-ERROR.
 16895
 16896     MOVE ER-0412                TO EMI-ERROR.
 16897     MOVE SPACES                 TO PI-689-PRINT-SW.
 16898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16899     MOVE -1                     TO MAINTL.
 16900     GO TO 8200-SEND-DATAONLY.
 16901
 16902 7940-TRAN-ERROR.
 16903
 16904     MOVE ER-0413                TO EMI-ERROR.
 16905     MOVE SPACES                 TO PI-689-PRINT-SW.
 16906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16907     MOVE -1                     TO MAINTL.
 16908     GO TO 8200-SEND-DATAONLY.
 16909
 16910 7945-NOT-FOUND.
 16911
 16912     MOVE ER-0190                TO EMI-ERROR.
 16913     MOVE -1                     TO MAINTL.
 16914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16915     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 360
* EL689.cbl
 16917 8010-ARCH-NOT-OPEN.
 16918
 16919     MOVE ER-7388                TO EMI-ERROR.
 16920     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16921     MOVE -1                     TO MAINTL.
 16922     GO TO 8200-SEND-DATAONLY.
 16923
 16924 8015-ARCT-NOT-OPEN.
 16925
 16926     MOVE ER-7373                TO EMI-ERROR.
 16927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16928     MOVE -1                     TO MAINTL.
 16929     GO TO 8200-SEND-DATAONLY.
 16930
 16931 8020-ACCT-NOT-OPEN.
 16932
 16933     MOVE ER-0168 TO EMI-ERROR
 16934     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16935     MOVE -1                     TO MAINTL.
 16936     GO TO 8200-SEND-DATAONLY.
 16937
 16938 8030-CERT-NOT-OPEN.
 16939
 16940     MOVE ER-0169 TO EMI-ERROR.
 16941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16942     MOVE -1                     TO MAINTL.
 16943     GO TO 8200-SEND-DATAONLY.
 16944
 16945 8035-CERT-NOT-FOUND.
 16946
 16947     MOVE ER-2369 TO EMI-ERROR.
 16948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16949     MOVE -1                     TO MAINTL.
 16950     GO TO 8200-SEND-DATAONLY.
 16951
 16952 8040-CNTL-NOT-OPEN.
 16953
 16954     MOVE ER-0042                TO EMI-ERROR.
 16955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16956     MOVE -1                     TO MAINTL.
 16957     GO TO 8200-SEND-DATAONLY.
 16958
 16959 8045-CHEK-NOT-OPEN.
 16960
 16961     MOVE ER-3775                TO EMI-ERROR.
 16962     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16963     MOVE -1                     TO MAINTL.
 16964     GO TO 8200-SEND-DATAONLY.
 16965
 16966 8050-TEXT-NOT-OPEN.
 16967
 16968     MOVE ER-0013                TO EMI-ERROR.
 16969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16970     MOVE -1                     TO MAINTL.
 16971     GO TO 8200-SEND-DATAONLY.
 16972
 16973 8060-PNDB-NOT-OPEN.
 16974
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 361
* EL689.cbl
 16975     MOVE ER-2216 TO EMI-ERROR.
 16976     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16977     MOVE -1                     TO MAINTL.
 16978     GO TO 8200-SEND-DATAONLY.
 16979
 16980 8070-PNDB-NOT-FOUND.
 16981
 16982     MOVE ER-7374 TO EMI-ERROR.
 16983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16984     MOVE -1                     TO MAINTL.
 16985     GO TO 8200-SEND-DATAONLY.
 16986
 16987 8080-COMP-NOT-OPEN.
 16988
 16989     MOVE ER-2055 TO EMI-ERROR
 16990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16991     MOVE -1                     TO MAINTL.
 16992     GO TO 8200-SEND-DATAONLY.
 16993
 16994 8085-PYAJ-NOT-OPEN.
 16995
 16996     MOVE ER-2232 TO EMI-ERROR
 16997     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16998     MOVE -1                     TO MAINTL.
 16999     GO TO 8200-SEND-DATAONLY.
 17000
 17001 8090-MAIL-NOT-OPEN.
 17002
 17003     MOVE ER-2999                TO EMI-ERROR.
 17004     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17005     MOVE -1                     TO MAINTL.
 17006     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 362
* EL689.cbl
 17008 8100-SEND-INITIAL-MAP.
 17009
 17010     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 17011     IF  PI-689-CREATE-NO-SCREENS
 17012         MOVE '9999'             TO PI-689-ERROR
 17013         GO TO 0620-RETURN-TO-CALLER.
 17014
 17015     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17016
 17017     IF  NOT EMI-NO-ERRORS
 17018         MOVE EMI-MESSAGE-AREA (1)
 17019                                 TO ERRMSGO
 17020     ELSE
 17021         MOVE SPACES             TO ERRMSGO.
 17022     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 17023                                 TO SYSO
 17024     MOVE WS-KIXHOST             TO HOSTO
 17025     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 17026        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 17027        MOVE AL-SADOF            TO PF8HDA
 17028     END-IF
 17029     IF NOT PI-CREATE-LABELS
 17030         MOVE AL-PANON           TO ADDRLBLA.
 17031
 17032
 17033* EXEC CICS SEND
 17034*        MAP    (W-MAP)
 17035*        MAPSET (W-MAPSET)
 17036*        FROM   (EL689AO)
 17037*        ERASE
 17038*        CURSOR
 17039*    END-EXEC.
 17040     MOVE LENGTH OF
 17041      EL689AO
 17042       TO DFHEIV12
 17043     MOVE -1
 17044       TO DFHEIV11
 17045*    MOVE '8$     CT  E    H L F ,   #00015768' TO DFHEIV0
 17046     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17047     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17048     MOVE X'2020233030303135373638' TO DFHEIV0(25:11)
 17049     CALL 'kxdfhei1' USING DFHEIV0,
 17050           W-MAP,
 17051           EL689AO,
 17052           DFHEIV12,
 17053           W-MAPSET,
 17054           DFHEIV99,
 17055           DFHEIV99,
 17056           DFHEIV99,
 17057           DFHEIV11,
 17058           DFHEIV99,
 17059           DFHEIV99,
 17060           DFHEIV99
 17061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17062
 17063
 17064     GO TO 9000-RETURN-TRANS.
 17065
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 363
* EL689.cbl
 17066 8100-EXIT.
 17067     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 364
* EL689.cbl
 17069 8200-SEND-DATAONLY.
 17070
 17071     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 17072     IF  PI-689-CREATE-NO-SCREENS
 17073         MOVE '9999'             TO PI-689-ERROR
 17074         GO TO 0620-RETURN-TO-CALLER.
 17075
 17076     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17077
 17078     IF EMI-ERROR = ER-0715
 17079         DISPLAY 'ER 0715'
 17080         MOVE -1          TO CERTIDL
 17081         MOVE +0          TO MAINTL
 17082     END-IF
 17083
 17084     IF  NOT EMI-NO-ERRORS
 17085         MOVE EMI-MESSAGE-AREA (1)
 17086                                 TO ERRMSGO
 17087     ELSE
 17088         MOVE SPACES             TO ERRMSGO.
 17089
 17090
 17091* EXEC CICS SEND
 17092*        MAP    (W-MAP)
 17093*        MAPSET (W-MAPSET)
 17094*        FROM   (EL689AO)
 17095*        DATAONLY
 17096*        CURSOR
 17097*    END-EXEC.
 17098     MOVE LENGTH OF
 17099      EL689AO
 17100       TO DFHEIV12
 17101     MOVE -1
 17102       TO DFHEIV11
 17103*    MOVE '8$D    CT       H L F ,   #00015802' TO DFHEIV0
 17104     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17105     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17106     MOVE X'2020233030303135383032' TO DFHEIV0(25:11)
 17107     CALL 'kxdfhei1' USING DFHEIV0,
 17108           W-MAP,
 17109           EL689AO,
 17110           DFHEIV12,
 17111           W-MAPSET,
 17112           DFHEIV99,
 17113           DFHEIV99,
 17114           DFHEIV99,
 17115           DFHEIV11,
 17116           DFHEIV99,
 17117           DFHEIV99,
 17118           DFHEIV99
 17119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17120
 17121
 17122     GO TO 9000-RETURN-TRANS.
 17123
 17124 8200-EXIT.
 17125     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 365
* EL689.cbl
 17127 8300-SEND-TEXT.
 17128
 17129     IF  PI-689-CREATE-NO-SCREENS
 17130         MOVE '9999'             TO PI-689-ERROR
 17131         GO TO 0620-RETURN-TO-CALLER.
 17132
 17133
 17134* EXEC CICS SEND TEXT
 17135*        FROM    (LOGOFF-TEXT)
 17136*        LENGTH  (LOGOFF-LENGTH)
 17137*        ERASE
 17138*        FREEKB
 17139*    END-EXEC.
 17140*    MOVE '8&      T  E F  H   F -   #00015821' TO DFHEIV0
 17141     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17142     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17143     MOVE X'2020233030303135383231' TO DFHEIV0(25:11)
 17144     CALL 'kxdfhei1' USING DFHEIV0,
 17145           LOGOFF-TEXT,
 17146           LOGOFF-LENGTH,
 17147           DFHEIV99,
 17148           DFHEIV99,
 17149           DFHEIV99,
 17150           DFHEIV99,
 17151           DFHEIV99,
 17152           DFHEIV99,
 17153           DFHEIV99,
 17154           DFHEIV99,
 17155           DFHEIV99,
 17156           DFHEIV99
 17157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17158
 17159
 17160     GO TO 9000-RETURN-TRANS.
 17161
 17162 8300-EXIT.
 17163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 366
* EL689.cbl
 17165 8350-SEND-DATAONLY-ERASEAUP.
 17166
 17167     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 17168     PERFORM 7760-PUT-TEMP-STORAGE
 17169                                 THRU 7760-EXIT
 17170     IF  PI-689-CREATE-NO-SCREENS
 17171         MOVE '9999'             TO PI-689-ERROR
 17172         GO TO 0620-RETURN-TO-CALLER.
 17173
 17174     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17175
 17176     IF EMI-ERROR = ER-0715
 17177         DISPLAY 'ER 0715'
 17178         MOVE -1          TO CERTIDL
 17179         MOVE +0          TO MAINTL
 17180     END-IF
 17181
 17182     IF  NOT EMI-NO-ERRORS
 17183         MOVE EMI-MESSAGE-AREA (1)
 17184                                 TO ERRMSGO
 17185     ELSE
 17186         MOVE SPACES             TO ERRMSGO.
 17187
 17188
 17189* EXEC CICS SEND
 17190*        MAP      (W-MAP)
 17191*        MAPSET   (W-MAPSET)
 17192*        FROM     (EL689AO)
 17193*        DATAONLY
 17194*        ERASEAUP
 17195*        CURSOR
 17196*    END-EXEC.
 17197     MOVE LENGTH OF
 17198      EL689AO
 17199       TO DFHEIV12
 17200     MOVE -1
 17201       TO DFHEIV11
 17202*    MOVE '8$D    CT  A    H L F ,   #00015856' TO DFHEIV0
 17203     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 17204     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17205     MOVE X'2020233030303135383536' TO DFHEIV0(25:11)
 17206     CALL 'kxdfhei1' USING DFHEIV0,
 17207           W-MAP,
 17208           EL689AO,
 17209           DFHEIV12,
 17210           W-MAPSET,
 17211           DFHEIV99,
 17212           DFHEIV99,
 17213           DFHEIV99,
 17214           DFHEIV11,
 17215           DFHEIV99,
 17216           DFHEIV99,
 17217           DFHEIV99
 17218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17219
 17220
 17221     GO TO 9000-RETURN-TRANS.
 17222
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 367
* EL689.cbl
 17223 8350-EXIT.
 17224     EXIT.
 17225
 17226 8600-DEEDIT.
 17227
 17228
 17229* EXEC CICS BIF DEEDIT
 17230*         FIELD    (W-DEEDIT-FIELD)
 17231*         LENGTH   (15)
 17232*    END-EXEC.
 17233     MOVE 15
 17234       TO DFHEIV11
 17235*    MOVE '@"L                   #   #00015872' TO DFHEIV0
 17236     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17237     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17238     MOVE X'2020233030303135383732' TO DFHEIV0(25:11)
 17239     CALL 'kxdfhei1' USING DFHEIV0,
 17240           W-DEEDIT-FIELD,
 17241           DFHEIV11
 17242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17243
 17244
 17245 8600-EXIT.
 17246     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 368
* EL689.cbl
 17248 9000-RETURN-TRANS.
 17249
 17250     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 17251     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 17252     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 17253     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 17254
 17255* EXEC CICS RETURN
 17256*        TRANSID    (W-TRANSACTION)
 17257*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 17258*        LENGTH     (PI-COMM-LENGTH)
 17259*    END-EXEC.
 17260*    MOVE '.(CT                  ''   #00015886' TO DFHEIV0
 17261     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17262     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17263     MOVE X'2020233030303135383836' TO DFHEIV0(25:11)
 17264     CALL 'kxdfhei1' USING DFHEIV0,
 17265           W-TRANSACTION,
 17266           PROGRAM-INTERFACE-BLOCK,
 17267           PI-COMM-LENGTH,
 17268           DFHEIV99,
 17269           DFHEIV99,
 17270           DFHEIV99
 17271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17272
 17273*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17274*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17275*    GO TO 0200-RECEIVE.
 17276
 17277 9000-EXIT.
 17278     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 369
* EL689.cbl
 17280 9200-PA.
 17281
 17282     MOVE ER-0008                TO EMI-ERROR.
 17283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17284     MOVE -1                     TO MAINTL.
 17285     GO TO 8200-SEND-DATAONLY.
 17286
 17287 9200-EXIT.
 17288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 370
* EL689.cbl
 17290 9300-DFHCLEAR.
 17291
 17292     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 17293         MOVE '2'                TO PI-ACTION.
 17294
 17295     IF  PI-CLEAR-MODE
 17296         MOVE PI-RETURN-TO-PROGRAM
 17297                                 TO W-CALL-PGM
 17298         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17299         GO TO 9400-XCTL
 17300     ELSE
 17301         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17302         MOVE LOW-VALUES         TO EL689AO
 17303                                    PI-1042-WA
 17304                                    PI-689-WORK-AREA
 17305         MOVE ZEROS              TO PI-CURRENT-LINE
 17306                                    PI-TEMP-STOR-ITEMS
 17307                                    PI-TOTAL-LINES
 17308                                    PI-UPDATE-SW
 17309                                    PI-689-NUMBER-LABEL-LINES
 17310         MOVE SPACES             TO PI-689-PRINT-SW
 17311                                    PI-689-ALT-PRINTER-ID
 17312                                    PI-COMM-CONTROL
 17313                                    PI-689-FORM-NUMBER
 17314                                    PI-689-TEMP-STOR-ID
 17315                                    PI-689-LABEL-SOURCE
 17316                                    PI-689-USE-SCREEN-IND
 17317         MOVE '2'                TO PI-ACTION
 17318         MOVE -1                 TO MAINTL
 17319         GO TO 8100-SEND-INITIAL-MAP.
 17320
 17321 9300-EXIT.
 17322     EXIT.
 17323
 17324 9400-XCTL.
 17325
 17326
 17327* EXEC CICS XCTL
 17328*        PROGRAM  (W-CALL-PGM)
 17329*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 17330*        LENGTH   (PI-COMM-LENGTH)
 17331*    END-EXEC.
 17332*    MOVE '.$C                   %   #00015944' TO DFHEIV0
 17333     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17334     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17335     MOVE X'2020233030303135393434' TO DFHEIV0(25:11)
 17336     CALL 'kxdfhei1' USING DFHEIV0,
 17337           W-CALL-PGM,
 17338           PROGRAM-INTERFACE-BLOCK,
 17339           PI-COMM-LENGTH,
 17340           DFHEIV99
 17341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17342
 17343
 17344 9400-EXIT.
 17345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 371
* EL689.cbl
 17347 9500-LINK-DATE-CONVERT.
 17348
 17349     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 17350             AND
 17351         DC-OPTION-CODE EQUAL ' '
 17352         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 17353         GO TO 9500-EXIT.
 17354
 17355
 17356* EXEC CICS LINK
 17357*        PROGRAM    ('ELDATCV')
 17358*        COMMAREA   (DATE-CONVERSION-DATA)
 17359*        LENGTH     (DC-COMM-LENGTH)
 17360*    END-EXEC.
 17361     MOVE 'ELDATCV' TO DFHEIV1
 17362*    MOVE '."C                   (   #00015961' TO DFHEIV0
 17363     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17365     MOVE X'2020233030303135393631' TO DFHEIV0(25:11)
 17366     CALL 'kxdfhei1' USING DFHEIV0,
 17367           DFHEIV1,
 17368           DATE-CONVERSION-DATA,
 17369           DC-COMM-LENGTH,
 17370           DFHEIV99,
 17371           DFHEIV99,
 17372           DFHEIV99,
 17373           DFHEIV99
 17374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17375
 17376
 17377     IF  NO-CONVERSION-ERROR
 17378             AND
 17379         PI-COMPANY-ID EQUAL 'AUK'
 17380             AND
 17381         W-REVERSE-DATE
 17382         MOVE DC-GREG-DATE-1-EDIT
 17383                                 TO W-EDIT-DATE-1
 17384         MOVE W-ED1-MM           TO W-ED2-MM
 17385         MOVE W-ED1-DD           TO W-ED2-DD
 17386         MOVE W-ED1-YY           TO W-ED2-YY
 17387         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 17388
 17389 9500-EXIT.
 17390     EXIT.
 17391
 17392 9600-FORMAT-DATE-TIME.
 17393
 17394     MOVE W-SAVE-DATE            TO RUNDTEO.
 17395     MOVE EIBTIME                TO W-TIME-IN.
 17396     MOVE W-TIME-OUT             TO RUNTIMEO.
 17397     MOVE PI-COMPANY-ID          TO COMPANYO.
 17398     MOVE PI-PROCESSOR-ID        TO USERIDO.
 17399     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17400
 17401 9600-EXIT.
 17402     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 372
* EL689.cbl
 17404 9700-PGMID-ERROR.
 17405
 17406     IF  PI-689-CREATE-NO-SCREENS
 17407         MOVE '9999'             TO PI-689-ERROR
 17408         GO TO 0620-RETURN-TO-CALLER.
 17409
 17410
 17411* EXEC CICS  HANDLE CONDITION
 17412*        PGMIDERR  (8300-SEND-TEXT)
 17413*    END-EXEC.
 17414*    MOVE '"$L                   ! > #00016000' TO DFHEIV0
 17415     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17417     MOVE X'3E20233030303136303030' TO DFHEIV0(25:11)
 17418     CALL 'kxdfhei1' USING DFHEIV0
 17419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17420
 17421
 17422     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 17423     MOVE ' '                    TO PI-ENTRY-CD-1.
 17424     MOVE W-XCTL-005             TO W-CALL-PGM
 17425                                    LOGOFF-PGM.
 17426     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 17427
 17428     PERFORM 9400-XCTL THRU 9400-EXIT.
 17429
 17430 9700-EXIT.
 17431     EXIT.
 17432
 17433 9800-ABEND.
 17434
 17435     IF  PI-689-CREATE-NO-SCREENS
 17436         MOVE '9999'             TO PI-689-ERROR
 17437         GO TO 0620-RETURN-TO-CALLER.
 17438
 17439     MOVE W-LINK-004             TO W-CALL-PGM.
 17440     MOVE DFHEIBLK               TO EMI-LINE1
 17441
 17442
 17443* EXEC CICS  LINK
 17444*        PROGRAM   (W-CALL-PGM)
 17445*        COMMAREA  (EMI-LINE1)
 17446*        LENGTH    (72)
 17447*    END-EXEC.
 17448     MOVE 72
 17449       TO DFHEIV11
 17450*    MOVE '."C                   (   #00016024' TO DFHEIV0
 17451     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17453     MOVE X'2020233030303136303234' TO DFHEIV0(25:11)
 17454     CALL 'kxdfhei1' USING DFHEIV0,
 17455           W-CALL-PGM,
 17456           EMI-LINE1,
 17457           DFHEIV11,
 17458           DFHEIV99,
 17459           DFHEIV99,
 17460           DFHEIV99,
 17461           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 373
* EL689.cbl
 17462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17463
 17464
 17465     GO TO 8200-SEND-DATAONLY.
 17466
 17467 9800-EXIT.
 17468     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 374
* EL689.cbl
 17470 9900-ERROR-FORMAT.
 17471
 17472     IF  PI-689-CREATE-NO-SCREENS
 17473         MOVE EMI-ERROR          TO PI-689-ERROR
 17474         IF  PI-689-FATAL-ERROR
 17475             GO TO 0620-RETURN-TO-CALLER
 17476         ELSE
 17477             GO TO 9900-EXIT.
 17478
 17479     IF  EMI-ERROR EQUAL ER-9097
 17480         NEXT SENTENCE
 17481     ELSE
 17482         IF  EMI-ERRORS-COMPLETE
 17483                 OR
 17484             EMI-ERROR EQUAL W-LAST-ERROR
 17485             GO TO 9900-EXIT.
 17486
 17487     MOVE W-LINK-001             TO W-CALL-PGM.
 17488
 17489
 17490* EXEC CICS LINK
 17491*        PROGRAM    (W-CALL-PGM)
 17492*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17493*        LENGTH     (EMI-COMM-LENGTH)
 17494*    END-EXEC.
 17495*    MOVE '."C                   (   #00016054' TO DFHEIV0
 17496     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17498     MOVE X'2020233030303136303534' TO DFHEIV0(25:11)
 17499     CALL 'kxdfhei1' USING DFHEIV0,
 17500           W-CALL-PGM,
 17501           ERROR-MESSAGE-INTERFACE-BLOCK,
 17502           EMI-COMM-LENGTH,
 17503           DFHEIV99,
 17504           DFHEIV99,
 17505           DFHEIV99,
 17506           DFHEIV99
 17507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17508
 17509
 17510     IF  EMI-SEVERITY (2) EQUAL 'X'
 17511             AND
 17512         EMI-SEVERITY (1) NOT EQUAL 'X'
 17513         MOVE EMI-MESSAGE-AREA (2)
 17514                                 TO EMI-MESSAGE-AREA (1).
 17515
 17516     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17517
 17518 9900-EXIT.
 17519     EXIT.
 17520
 17521 9905-INITIALIZE-SECURITY.
 17522******************************************************************
 17523*                                                                *
 17524*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17525*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17526*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17527*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 375
* EL689.cbl
 17528*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17529*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17530*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17531*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17532*                                                                *
 17533*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17534*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17535*                                                                *
 17536******************************************************************
 17537
 17538     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17539         MOVE 'Y'                TO PI-DISPLAY-CAP
 17540                                    PI-MODIFY-CAP
 17541     ELSE
 17542
 17543* EXEC CICS READQ TS
 17544*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17545*            INTO   (SECURITY-CONTROL)
 17546*            LENGTH (SC-COMM-LENGTH)
 17547*            ITEM   (1)
 17548*        END-EXEC
 17549     MOVE 1
 17550       TO DFHEIV11
 17551*    MOVE '*$II   L              ''   #00016092' TO DFHEIV0
 17552     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17553     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17554     MOVE X'2020233030303136303932' TO DFHEIV0(25:11)
 17555     CALL 'kxdfhei1' USING DFHEIV0,
 17556           PI-SECURITY-TEMP-STORE-ID,
 17557           SECURITY-CONTROL,
 17558           SC-COMM-LENGTH,
 17559           DFHEIV11,
 17560           DFHEIV99,
 17561           DFHEIV99
 17562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17563         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17564                                 TO PI-DISPLAY-CAP
 17565         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17566                                 TO PI-MODIFY-CAP.
 17567
 17568 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 376
* EL689.cbl
 17570 9995-SECURITY-VIOLATION.
 17571
 17572     MOVE EIBDATE                TO SM-JUL-DATE.
 17573     MOVE EIBTRMID               TO SM-TERMID.
 17574     MOVE W-THIS-PGM             TO SM-PGM.
 17575     MOVE EIBTIME                TO W-TIME-IN.
 17576     MOVE W-TIME-OUT             TO SM-TIME.
 17577     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17578
 17579
 17580* EXEC CICS LINK
 17581*         PROGRAM  ('EL003')
 17582*         COMMAREA (SECURITY-MESSAGE)
 17583*         LENGTH   (80)
 17584*    END-EXEC.
 17585     MOVE 'EL003' TO DFHEIV1
 17586     MOVE 80
 17587       TO DFHEIV11
 17588*    MOVE '."C                   (   #00016114' TO DFHEIV0
 17589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17591     MOVE X'2020233030303136313134' TO DFHEIV0(25:11)
 17592     CALL 'kxdfhei1' USING DFHEIV0,
 17593           DFHEIV1,
 17594           SECURITY-MESSAGE,
 17595           DFHEIV11,
 17596           DFHEIV99,
 17597           DFHEIV99,
 17598           DFHEIV99,
 17599           DFHEIV99
 17600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17601
 17602
 17603 9995-EXIT.
 17604     EXIT.
 17605
 17606 9999-GOBACK.
 17607
 17608
 17609* GOBACK.
 17610     MOVE '9%                    "   ' TO DFHEIV0
 17611     MOVE 'EL689' TO DFHEIV1
 17612     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17613     GOBACK.
 17614
 17615 9999-EXIT.
 17616     EXIT.
 17617
 17618 9999-DFHBACK SECTION.
 17619     MOVE '9%                    "   ' TO DFHEIV0
 17620     MOVE 'EL689' TO DFHEIV1
 17621     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17622     GOBACK.
 17623 9999-DFHEXIT.
 17624     IF DFHEIGDJ EQUAL 0001
 17625         NEXT SENTENCE
 17626     ELSE IF DFHEIGDJ EQUAL 2
 17627         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 377
* EL689.cbl
 17628               9200-PA,
 17629               9200-PA,
 17630               9200-PA
 17631         DEPENDING ON DFHEIGDI
 17632     ELSE IF DFHEIGDJ EQUAL 3
 17633         GO TO 9700-PGMID-ERROR,
 17634               9800-ABEND,
 17635               0325-MAPFAIL
 17636         DEPENDING ON DFHEIGDI
 17637     ELSE IF DFHEIGDJ EQUAL 4
 17638         GO TO 8040-CNTL-NOT-OPEN,
 17639               7945-NOT-FOUND
 17640         DEPENDING ON DFHEIGDI
 17641     ELSE IF DFHEIGDJ EQUAL 5
 17642         GO TO 9700-PGMID-ERROR,
 17643               0325-MAPFAIL,
 17644               9800-ABEND
 17645         DEPENDING ON DFHEIGDI
 17646     ELSE IF DFHEIGDJ EQUAL 6
 17647         GO TO 0990-CARRIER-NOT-FOUND,
 17648               8040-CNTL-NOT-OPEN
 17649         DEPENDING ON DFHEIGDI
 17650     ELSE IF DFHEIGDJ EQUAL 7
 17651         GO TO 0994-STATE-NOT-FOUND,
 17652               8040-CNTL-NOT-OPEN
 17653         DEPENDING ON DFHEIGDI
 17654     ELSE IF DFHEIGDJ EQUAL 8
 17655         GO TO 8010-ARCH-NOT-OPEN,
 17656               1070-ARCH-NOT-FOUND,
 17657               1070-ARCH-NOT-FOUND
 17658         DEPENDING ON DFHEIGDI
 17659     ELSE IF DFHEIGDJ EQUAL 9
 17660         GO TO 2001-NOT-FOUND,
 17661               2001-NOT-FOUND,
 17662               8050-TEXT-NOT-OPEN
 17663         DEPENDING ON DFHEIGDI
 17664     ELSE IF DFHEIGDJ EQUAL 10
 17665         GO TO 2000-ENDBR
 17666         DEPENDING ON DFHEIGDI
 17667     ELSE IF DFHEIGDJ EQUAL 11
 17668         GO TO 8040-CNTL-NOT-OPEN,
 17669               6200-CNTL1-NOT-FOUND
 17670         DEPENDING ON DFHEIGDI
 17671     ELSE IF DFHEIGDJ EQUAL 12
 17672         GO TO 8040-CNTL-NOT-OPEN,
 17673               6250-CNTL2-NOT-FOUND
 17674         DEPENDING ON DFHEIGDI
 17675     ELSE IF DFHEIGDJ EQUAL 13
 17676         GO TO 8040-CNTL-NOT-OPEN,
 17677               6300-CNTL6-NOT-FOUND
 17678         DEPENDING ON DFHEIGDI
 17679     ELSE IF DFHEIGDJ EQUAL 14
 17680         GO TO 8040-CNTL-NOT-OPEN,
 17681               6350-CNTL2-NOT-FOUND
 17682         DEPENDING ON DFHEIGDI
 17683     ELSE IF DFHEIGDJ EQUAL 15
 17684         GO TO 8060-PNDB-NOT-OPEN,
 17685               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 378
* EL689.cbl
 17686         DEPENDING ON DFHEIGDI
 17687     ELSE IF DFHEIGDJ EQUAL 16
 17688         GO TO 8030-CERT-NOT-OPEN,
 17689               8035-CERT-NOT-FOUND
 17690         DEPENDING ON DFHEIGDI
 17691     ELSE IF DFHEIGDJ EQUAL 17
 17692         GO TO 8020-ACCT-NOT-OPEN,
 17693               6500-ACCT-NOT-FOUND,
 17694               6500-ONLY-STOP
 17695         DEPENDING ON DFHEIGDI
 17696     ELSE IF DFHEIGDJ EQUAL 18
 17697         GO TO 8080-COMP-NOT-OPEN,
 17698               6600-COMP-NOT-FOUND
 17699         DEPENDING ON DFHEIGDI
 17700     ELSE IF DFHEIGDJ EQUAL 19
 17701         GO TO 8040-CNTL-NOT-OPEN,
 17702               6630-CNTL2-NOT-FOUND
 17703         DEPENDING ON DFHEIGDI
 17704     ELSE IF DFHEIGDJ EQUAL 20
 17705         GO TO 8090-MAIL-NOT-OPEN,
 17706               6700-MAIL-NOT-FOUND
 17707         DEPENDING ON DFHEIGDI
 17708     ELSE IF DFHEIGDJ EQUAL 21
 17709         GO TO 8040-CNTL-NOT-OPEN,
 17710               6750-EXIT
 17711         DEPENDING ON DFHEIGDI
 17712     ELSE IF DFHEIGDJ EQUAL 22
 17713         GO TO 8040-CNTL-NOT-OPEN,
 17714               6800-EXIT
 17715         DEPENDING ON DFHEIGDI
 17716     ELSE IF DFHEIGDJ EQUAL 23
 17717         GO TO 8045-CHEK-NOT-OPEN,
 17718               6850-CHEK-NOT-FOUND
 17719         DEPENDING ON DFHEIGDI
 17720     ELSE IF DFHEIGDJ EQUAL 24
 17721         GO TO 8085-PYAJ-NOT-OPEN,
 17722               6900-PYAJ-NOT-FOUND
 17723         DEPENDING ON DFHEIGDI
 17724     ELSE IF DFHEIGDJ EQUAL 25
 17725         GO TO 7700-TS-ERROR,
 17726               7700-TS-ERROR
 17727         DEPENDING ON DFHEIGDI
 17728     ELSE IF DFHEIGDJ EQUAL 26
 17729         GO TO 7780-EXIT
 17730         DEPENDING ON DFHEIGDI
 17731     ELSE IF DFHEIGDJ EQUAL 27
 17732         GO TO 8040-CNTL-NOT-OPEN,
 17733               7945-NOT-FOUND
 17734         DEPENDING ON DFHEIGDI
 17735     ELSE IF DFHEIGDJ EQUAL 28
 17736         GO TO 7935-TERM-ERROR,
 17737               7940-TRAN-ERROR
 17738         DEPENDING ON DFHEIGDI
 17739     ELSE IF DFHEIGDJ EQUAL 29
 17740         GO TO 8010-ARCH-NOT-OPEN,
 17741               1070-ARCH-NOT-FOUND,
 17742               1070-ARCH-NOT-FOUND
 17743         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 379
* EL689.cbl
 17744     ELSE IF DFHEIGDJ EQUAL 30
 17745         GO TO 8300-SEND-TEXT
 17746         DEPENDING ON DFHEIGDI.
 17747     MOVE '9%                    "   ' TO DFHEIV0
 17748     MOVE 'EL689' TO DFHEIV1
 17749     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17750     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      232180     Code:       60325
