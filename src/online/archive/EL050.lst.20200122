* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59* 092618  CR2018050200001  PEMA  Add check for open clm on issue
    60* 101019  CR2019100700001  PEMA  Disallow V status with claim
    61******************************************************************
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   3
* EL050.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER   PIC X(32) VALUE '********************************'.
    70 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    71 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    72
    73 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    74 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    75                                   USAGE POINTER.
    76 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    77 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    82                                   USAGE IS POINTER.
    83 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    88 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    89                                   USAGE IS POINTER.
    90
    91*    COPY ELC50WS.
    92*****************************************************************
    93*                                                               *
    94*                            ELC50WS.                           *
    95*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    96*                            VMOD=2.061.                        *
    97*                                                               *
    98*   THIS IS THE WORKING STORAGE FOR EL050                       *
    99*                                   EL517                       *
   100*****************************************************************
   101******************************************************************
   102*                   C H A N G E   L O G
   103*
   104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   105*-----------------------------------------------------------------
   106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   107* EFFECTIVE    NUMBER
   108*-----------------------------------------------------------------
   109* 123102                   PEMA  ADD DCC PROCESSING
   110* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   111* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   112* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   113* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   114* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   115* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   116* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   117* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   118* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   119* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   120* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   121* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   122* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   123* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   4
* EL050.cbl
   124* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   125* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   126* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   127* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   128* 030309  CR2009021700001  PEMA  ADD ER-2883
   129* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   132* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   133* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   134* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   135* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   136* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   137* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   138* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   139* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   140* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   141* 061412  CR2011022800001  AJRA  NAPERSOFT
   142* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   143* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   144* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   145* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   146* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   147* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   148* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   149* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   150* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   151* 091114  IR2014091000001  TANA  ADD ERROR 2898
   152* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   153* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   154* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   155* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   156* 100617  CR2017062000003  PEMA  Inforce state comm cap
   157* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   158* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   159* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   160* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   161* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   162* 092618  CR2018050200001  PEMA  Add check for open clm on issue
   163* 101019  CR2019100700001  PEMA  Add error 3281 V stat on claim
   164* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
   165*-----------------------------------------------------------------
   166
   167 01  WORK-AREAS.
   168
   169*****************************************************************
   170*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   171*****************************************************************
   172
   173     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   174     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   175     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   176     12  WS-NAME-EDIT-WORK-AREA.
   177         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   178         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   179             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   180         16  WS-WORK-NAME.
   181             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   5
* EL050.cbl
   182             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   183             20  FILLER           PIC X(10)     VALUE SPACES.
   184         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   185             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   186
   187*****************************************************************
   188*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   189*****************************************************************
   190
   191     12  WS-ERRESC-KEY.
   192         16 WS-ERRESC-SEARCH-KEY.
   193             20  WS-ERRESC-COMPANY-CD PIC  X.
   194             20  WS-ERRESC-CARRIER    PIC  X.
   195             20  WS-ERRESC-GROUP      PIC X(6).
   196             20  WS-ERRESC-STATE      PIC XX.
   197             20  WS-ERRESC-ACCOUNT    PIC X(10).
   198         16 WS-ERRESC-RESIDUAL-KEY.
   199             20  WS-ERRESC-AGENT      PIC X(10).
   200             20  WS-ERRESC-RES-STATE  PIC XX.
   201             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   202*                                          YYYYMMDD
   203     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   204     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   205
   206*RESIDENT STATE TAX MASTER(ERRESS)
   207*
   208     12  WS-ERRESS-KEY.
   209         16  WS-ERRESS-COMPANY-CD      PIC  X.
   210         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   211         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   212         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   213*                                          YYYYMMDD
   214
   215     12  WS-CONTRACT-DATE              PIC 9(8).
   216*                                          YYYYMMDD
   217     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   218     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   219         16 WS-YEAR-YY                 PIC   9999.
   220         16 FILLER                     PIC 9(4).
   221*                                          YYYYMMDD
   222     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   223     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   224     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   225     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   226
   227     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   228         88  DPRB-1ST-TIME                      VALUE ' '.
   229
   230*****************************************************************
   231*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   232*****************************************************************
   233
   234     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   235     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   236     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   237     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   238     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   239     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   6
* EL050.cbl
   240     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   241     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   242     12  ws-st-agent-sig-edit    pic x          value spaces.
   243     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   244     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   247         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   248         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   249     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   250         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   251         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   252     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   253
   254     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   255     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   256
   257     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   258     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   264     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   271     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   272     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   286     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   287     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   288     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   289     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   290     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   291     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   292     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   293     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   294     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   295     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   296     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   297     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   7
* EL050.cbl
   298     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   299     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   300     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   301     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   302     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   303     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   304     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   305     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   306     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   307     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   308     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   309     12  WS-2671-SW               PIC X         VALUE SPACE.
   310     12  WS-2672-SW               PIC X         VALUE SPACE.
   311     12  ws-9813-sw               pic x         value spaces.
   312     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   313         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   314     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   315         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   316     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   317
   318     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   319         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   320         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   321         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   322         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   323
   324     12  WS-CREDIT-EDIT-CONTROLS.
   325         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   326         16  WS-MIN-AGE           PIC 99                VALUE  0.
   327         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   328         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   329         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   330         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   331
   332     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   333     12  WS-AGE-FIELDS.
   334         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   335         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   336         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   337         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   338
   339     12  WS-SAVE-ALLOWABLE-BENEFIT.
   340         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   341         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   342         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   343         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   344         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   345         16  FILLER                      PIC XX.
   346
   347     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   348     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   349     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   350     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   351     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   352     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   353     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   354     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   355     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   8
* EL050.cbl
   356     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   357
   358     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   359     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   360     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   361     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   362     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   363     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   364     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   365     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   366         88  WS-REDUCING              VALUE 'R'.
   367         88  WS-LEVEL                 VALUE 'L' 'P'.
   368     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   369
   370     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   371     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   372     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   373     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   374     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   375     12  ws-ah-max-bens           pic 99        value zeros.
   376     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   377     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   378     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   379     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   380
   381     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   382     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   383     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   384     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   385     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   386     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   387     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   388     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   389     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   390     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   391     12  WS-ACCT-SIG-SW.
   392         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   393         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   394     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   395     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   396     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   397     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   398     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   399     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   400     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   401     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   402     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   403     12  WS-INITIALS.
   404         16  WS-INIT-1            PIC X         VALUE SPACES.
   405         16  WS-INIT-2            PIC X         VALUE SPACES.
   406
   407     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   408     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   409     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   410     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   411     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   412*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   413     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page   9
* EL050.cbl
   414     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   415     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   416     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   417     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   418     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   419     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   420     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   421     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   422     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   423     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   424     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   425     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   426     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   427     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   428     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   429     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   430     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   431     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   432     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   433     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   434     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   435******** FLA
   436     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   437     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   438     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   439     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   440     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   441********
   442     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   443     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   444     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   445     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   446     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   447     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   448     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   449     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   450     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   451     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   452
   453     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   454         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   455                                         '0' THRU '9'.
   456
   457     12  NUMBER-OF-MONTHS.
   458         16  SK-MO OCCURS 12 TIMES PIC X.
   459
   460     12  WS-WORK-DATE.
   461         16  WS-YEAR            PIC 99    VALUE 00.
   462         16  WS-MONTH           PIC 99    VALUE 00.
   463         16  WS-DAY             PIC 99    VALUE 00.
   464
   465     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   466     12  WS-WORK-CRIT-DEV       REDEFINES
   467         WS-WORK-LF-CRIT-PER    PIC X(03).
   468
   469     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   470     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   471
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  10
* EL050.cbl
   472     12  WS-WORK-DATE-FROM.
   473         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   474         16  FILLER             PIC X  VALUE SPACE.
   475         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   476         16  FILLER             PIC X         VALUE SPACE.
   477         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   478
   479     12  WS-WORK-DATE-THRU.
   480         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   481         16  FILLER             PIC X         VALUE SPACE.
   482         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   483         16  FILLER             PIC X         VALUE SPACE.
   484         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   485
   486     12  WS-LF-INPUT-CD.
   487         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   488         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   489
   490     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   491     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   492         16  WS-AH-INPUT-CD-1   PIC X.
   493         16  WS-AH-INPUT-CD-2-3 PIC XX.
   494
   495     12  WS-SWITCHES.
   496         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   497         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   498             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   499         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   500             88  BANK-ACCT-FOUND          VALUE 'Y'.
   501         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   502             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   503         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   504             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   505         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   506             88  COMP-MASTER-FOUND        VALUE 'Y'.
   507         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   508             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   509         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   510             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   511         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   512             88  STAT-MASTER-FOUND        VALUE 'Y'.
   513         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   514             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   515         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   516             88  ELCRTT-FOUND             VALUE 'Y'.
   517         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   518             88  ELCRTT-UPDATE            VALUE 'Y'.
   519         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   520             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   521         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   522             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   523         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   524             88  FORM-MASTER-FOUND        VALUE 'Y'.
   525         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   526             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   527         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   528             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   529         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  11
* EL050.cbl
   530             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   531         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   532             88  NO-BENEFIT-FOUND         VALUE 'N'.
   533         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   534             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   535         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   536             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   537         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   538             88  AH-BENEFIT-FOUND         VALUE ' '.
   539             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   540         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   541             88  LF-BENEFIT-FOUND         VALUE ' '.
   542             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   543         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   544             88  NO-STATE-RECORD          VALUE '1'.
   545         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   546             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   547         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   548             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   549         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   550             88  CERT-WAS-FOUND           VALUE ' '.
   551             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   552         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   553             88  BROWSE-STARTED           VALUE 'Y'.
   554         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   555             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   556         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   557             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   558         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   559             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   560         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   561             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   562         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   563             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   564         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   565             88  APP-CERT-USED            VALUE 'Y' 'A'.
   566         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   567             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   568             88  FIRST-TIME-THROUGH       VALUE '1'.
   569             88  CTBL-NOT-FOUND           VALUE '2'.
   570
   571         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   572             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   573
   574         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   575             88  DLO-ERROR-FOUND          VALUE 'Y'.
   576
   577********FLA
   578     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   579     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   580********
   581     12  RC-SW-1                  PIC X           VALUE '0'.
   582     12  RC-SW-2                  PIC X           VALUE '0'.
   583     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   584     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   585     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   586     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   587     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  12
* EL050.cbl
   588     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   589     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   590     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   591     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   592     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   593     12  LIT-SPACES               PIC X           VALUE SPACES.
   594     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   595     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   596     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   597     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   598     12  erpndm-unlock-sw         pic x           value spaces.
   599         88  need-to-unlock-erpndm  value 'Y'.
   600     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   601     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   602     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   603         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   604         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   605     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   606         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   607
   608 01  WS-EXTRA-PERIODS-BY-STATE.
   609     12  WS-INT-PERIODS          PIC 9.
   610     12  WS-EXTRA-PMTS           PIC 9.
   611 01  ws-net-only-state           pic x value 'N'.
   612 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   613     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   614     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   615 01  WS-CRI-SSN-WORK-AREA.
   616     05  WS-CRI-SOC-SEC-NO.
   617         10  WS-SS-REPT-CD       PIC X(5).
   618         10  WS-SS-LAST-NAME     PIC X(5).
   619         10  WS-SS-INITIAL       PIC X.
   620
   621     05  WS-CRI-REPORT-CODE.
   622         10  FILLER              PIC X(5).
   623         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   624
   625     05  WS-CRI-LAST-NAME.
   626         10  WS-CRI-NAME-MOVE    PIC X(5).
   627         10  FILLER              PIC X(10).
   628
   629 01  ws-state-commission-caps.
   630     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   631     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   632     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   633     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   634     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   635     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   636     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   637     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   638     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   639     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   640     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   641     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   642     05  ws-st-cap-limit-to      pic x.
   643     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   644     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   645     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  13
* EL050.cbl
   646     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   647     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   648     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   649     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   650     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   651     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   652     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   653     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   654     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   655 01  WS-NUM-TABLE                PIC X(26)  VALUE
   656     '12345678012345070923456789'.
   657 01  FILLER REDEFINES WS-NUM-TABLE.
   658     05  WS-NUM OCCURS 26        PIC 9.
   659 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   660 01  V1                          PIC S999 COMP-3.
   661 01  V2                          PIC S999 COMP-3.
   662 01  V3                          PIC S999 COMP-3.
   663 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   664 01  FILLER REDEFINES WS-WORK-VIN.
   665     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   666 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   667 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   668 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   669 01  WS-HEX-WORK.
   670     05  FILLER                  PIC X  VALUE LOW-VALUES.
   671     05  WS-HEX-BYTE             PIC X.
   672 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   673 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   674 01  WS-WORK-HIN-ROW-B.
   675     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   676
   677 01  ws-benefit-cd-chg-sw      pic x value spaces.
   678     88  benefit-code-chg           value 'Y'.
   679 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   680 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   681     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   682 01  WS-ROW-D-TABLE.
   683     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   684
   685 01  WS-HIN-TABLE-B.
   686     05  F                       PIC XX VALUE 'A2'.
   687     05  F                       PIC XX VALUE 'B3'.
   688     05  F                       PIC XX VALUE 'C4'.
   689     05  F                       PIC XX VALUE 'D5'.
   690     05  F                       PIC XX VALUE 'E6'.
   691     05  F                       PIC XX VALUE 'F7'.
   692     05  F                       PIC XX VALUE 'G8'.
   693     05  F                       PIC XX VALUE 'H9'.
   694     05  F                       PIC XX VALUE 'I1'.
   695     05  F                       PIC XX VALUE 'J2'.
   696     05  F                       PIC XX VALUE 'K3'.
   697     05  F                       PIC XX VALUE 'L4'.
   698     05  F                       PIC XX VALUE 'M5'.
   699     05  F                       PIC XX VALUE 'N6'.
   700     05  F                       PIC XX VALUE 'O0'.
   701     05  F                       PIC XX VALUE 'P7'.
   702     05  F                       PIC XX VALUE 'Q0'.
   703     05  F                       PIC XX VALUE 'R8'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  14
* EL050.cbl
   704     05  F                       PIC XX VALUE 'S9'.
   705     05  F                       PIC XX VALUE 'T2'.
   706     05  F                       PIC XX VALUE 'U3'.
   707     05  F                       PIC XX VALUE 'V4'.
   708     05  F                       PIC XX VALUE 'W5'.
   709     05  F                       PIC XX VALUE 'X6'.
   710     05  F                       PIC XX VALUE 'Y7'.
   711     05  F                       PIC XX VALUE 'Z8'.
   712 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   713     05  WS-VAL-IN               PIC X.
   714     05  WS-VAL-OUT              PIC 9.
   715 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   716 01  ws-greg-eff-date            pic x(10) value ' '.
   717 01  WS-COMPARE-BINARY-DATES.
   718     05  WS-971231                PIC XX VALUE X'92FF'.
   719     05  WS-931231                PIC XX VALUE X'8CFF'.
   720     05  WS-791231                PIC XX VALUE X'77FF'.
   721     05  WS-771001                PIC XX VALUE X'74A1'.
   722     05  WS-820301                PIC XX VALUE X'7B41'.
   723     05  WS-831031                PIC XX VALUE X'7DBF'.
   724     05  WS-831231                PIC XX VALUE X'7DFF'.
   725     05  WS-810831                PIC XX VALUE X'7A7F'.
   726     05  WS-830901                PIC XX VALUE X'7D81'.
   727
   728 01  FILE-ACCESS-IDS.
   729     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   730     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   731     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   732     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   733     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   734     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   735     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   736     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   737     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   738     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   739     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   740     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   741     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   742     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   743     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   744     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   745     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   746 01  DD-IU-SW                    PIC X   VALUE ' '.
   747     88  DD-IU-PRESENT                 VALUE 'Y'.
   748
   749 01  ACCESS-KEYS.
   750     12  ELMSTR-KEY.
   751         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   752         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   753     12  W-CLAIM-KEY.
   754         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   755         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   756
   757     12  ELCNTL-KEY.
   758         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   759         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   760         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   761         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  15
* EL050.cbl
   762
   763     12  ELCERT-KEY.
   764         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   765         16  CERT-CARRIER         PIC X       VALUE SPACE.
   766         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   767         16  CERT-STATE           PIC XX      VALUE SPACES.
   768         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   769         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   770         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   771
   772     12  ELCERT2-KEY.
   773         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   774         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   775
   776     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   777
   778     12  ELCERT-SAVE.
   779         16  FILLER                      PIC XX    VALUE SPACES.
   780
   781         16  WCS-CONTROL-PRIMARY.
   782             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   783             20  WCS-CARRIER             PIC X     VALUE SPACE.
   784             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   785             20  WCS-STATE               PIC XX    VALUE SPACES.
   786             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   787             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   788             20  WCS-CERT-NO.
   789                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   790                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   791
   792         16  CS-CONTROL-BY-NAME.
   793             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   794             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   795             20  CS-INSURED-INITIALS.
   796                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   797                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   798
   799         16  CS-CONTROL-BY-SSN.
   800             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   801             20  CS-SOC-SEC-NO.
   802                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   803                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   804                 24  CS-SSN-LN3.
   805                     28 CS-INSURED-INITIALS-A2   PIC XX
   806                                     VALUE SPACES.
   807                     28 CS-PART-LAST-NAME-A2     PIC X
   808                                     VALUE SPACE.
   809
   810         16  CS-CONTROL-BY-CERT-NO.
   811             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   812             20  CS-CERT-NO-A4           PIC X(11)
   813                                     VALUE SPACES.
   814
   815         16  CS-CONTROL-BY-MEMB.
   816             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   817             20  CS-MEMBER-NO.
   818                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   819                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  16
* EL050.cbl
   820                 24  CS-MEMB-LN4.
   821                     28 CS-INSURED-INITIALS-A5   PIC XX
   822                                      VALUE SPACES.
   823                     28 CS-PART-LAST-NAME-A5     PIC XX
   824                                      VALUE SPACES.
   825
   826         16  FILLER              PIC X(360) VALUE SPACES.
   827
   828     12  ERACCT-KEY.
   829         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   830         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   831         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   832         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   833         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   834         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   835
   836     12  ERCOMP-KEY.
   837         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   838         16  COMP-CARRIER         PIC X     VALUE SPACES.
   839         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   840         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   841         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   842         16  COMP-TYPE            PIC X     VALUE SPACES.
   843
   844     12  ERLOFC-KEY.
   845         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   846         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   847         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   848         16  LOFC-STATE           PIC XX    VALUE SPACES.
   849         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   850         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   851
   852     12  WS-ELCRTT-KEY.
   853         16  WS-ELCRTT-PRIMARY       PIC X(33).
   854         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   855
   856     12  ERBXRF-KEY.
   857         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   858         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   859         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   860         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   861
   862     12  ERAGTC-KEY.
   863         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   864         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   865         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   866         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   867         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   868         16  AGTC-TYPE            PIC X     VALUE SPACES.
   869
   870     12  ERPLAN-KEY.
   871         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   872         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   873         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   874         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   875         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   876         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   877         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  17
* EL050.cbl
   878         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   879
   880     12  ERFORM-KEY.
   881         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   882         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   883         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   884         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   885
   886     12  ERREIN-KEY.
   887         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   888         16  REIN-TYPE            PIC X     VALUE SPACES.
   889         16  REIN-TABLE-CO.
   890             20  REIN-CODE-1      PIC X     VALUE SPACE.
   891             20  REIN-CODE-2      PIC X     VALUE SPACE.
   892             20  REIN-CODE-3      PIC X     VALUE SPACE.
   893         16  FILLER               PIC X(3)  VALUE SPACES.
   894
   895     12  ERCTBL-KEY.
   896         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   897         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   898         16  CTBL-CNTRL-2.
   899             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   900             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   901
   902     12  ELCRTO-KEY.
   903         16  ELCRTO-COMPANY-CD       PIC X.
   904         16  ELCRTO-CARRIER          PIC X.
   905         16  ELCRTO-GROUPING         PIC X(6).
   906         16  ELCRTO-STATE            PIC XX.
   907         16  ELCRTO-ACCOUNT          PIC X(10).
   908         16  ELCRTO-CERT-EFF-DT      PIC XX.
   909         16  ELCRTO-CERT-NO.
   910             20  ELCRTO-CERT-PRIME   PIC X(10).
   911             20  ELCRTO-CERT-SFX     PIC X.
   912         16  ELCRTO-RECORD-TYPE      PIC X.
   913         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   914
   915
   916     12  WS-ACCESS.
   917         16  FILLER               PIC XX    VALUE SPACES.
   918         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   919
   920     12  WS-CARR-ACCESS.
   921         16  FILLER               PIC X(3)  VALUE SPACES.
   922         16  WS-CARR              PIC X     VALUE SPACE.
   923*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   924*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   925     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   926         88  WS-DMD-LF-RATING   VALUE 'Y'.
   927         88  WS-DMD-AH-RATING   VALUE 'Y'.
   928         88  WS-DMD-NO-RATING   VALUE 'N'.
   929
   930     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   931         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   932                                         'NJ' 'NL'
   933                                         'PJ' 'PL'
   934                                         'SJ' 'SL'.
   935     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  18
* EL050.cbl
   936         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   937                                         'NI' 'NJ' 'NL' 'NU'
   938                                         'PJ' 'PL' 'PI' 'PU'
   939                                         'SI' 'SJ' 'SL' 'SU'
   940                                         'MX' 'MY' 'MZ'.
   941 01  ERPDEF-KEY-SAVE             PIC X(18).
   942 01  ERPDEF-KEY.
   943     12  ERPDEF-COMPANY-CD       PIC X.
   944     12  ERPDEF-STATE            PIC XX.
   945     12  ERPDEF-PROD-CD          PIC XXX.
   946     12  F                       PIC X(7).
   947     12  ERPDEF-BEN-TYPE         PIC X.
   948     12  ERPDEF-BEN-CODE         PIC XX.
   949     12  ERPDEF-EXP-DT           PIC XX.
   950
   951 01  ELSTAT-KEY-SAVE             PIC X(20).
   952 01  ELSTAT-KEY.
   953     12  ELSTAT-COMPANY-ID       PIC XXX.
   954     12  ELSTAT-CARRIER          PIC X.
   955     12  ELSTAT-GROUP            PIC X(6).
   956     12  ELSTAT-STATE            PIC XX.
   957     12  ELSTAT-EXP-DT           PIC 9(8).
   958 01  WS-ERROR-VALUES.
   959     12  ER-1570                     PIC S9(4)   VALUE +1570.
   960     12  ER-1571                     PIC S9(4)   VALUE +1571.
   961     12  er-1572                     pic s9(4)   value +1572.
   962     12  er-1573                     pic s9(4)   value +1573.
   963     12  er-1574                     pic s9(4)   value +1574.
   964     12  ER-1575                     PIC S9(4)   VALUE +1575.
   965     12  er-1576                     pic s9(4)   value +1576.
   966     12  er-1583                     pic s9(4)   value +1583.
   967     12  er-1743                     pic s9(4)   value +1743.
   968     12  er-1744                     pic s9(4)   value +1744.
   969     12  er-1745                     pic s9(4)   value +1745.
   970     12  er-1746                     pic s9(4)   value +1746.
   971     12  er-1747                     pic s9(4)   value +1747.
   972     12  er-1748                     pic s9(4)   value +1748.
   973     12  er-1749                     pic s9(4)   value +1749.
   974     12  er-1750                     pic s9(4)   value +1750.
   975     12  er-1751                     pic s9(4)   value +1751.
   976     12  er-1752                     pic s9(4)   value +1752.
   977     12  er-1753                     pic s9(4)   value +1753.
   978     12  er-1754                     pic s9(4)   value +1754.
   979     12  er-1755                     pic s9(4)   value +1755.
   980     12  er-1756                     pic s9(4)   value +1756.
   981     12  er-1757                     pic s9(4)   value +1757.
   982     12  er-1758                     pic s9(4)   value +1758.
   983     12  er-1759                     pic s9(4)   value +1759.
   984     12  er-1760                     pic s9(4)   value +1760.
   985     12  er-1761                     pic s9(4)   value +1761.
   986     12  ER-1891                     PIC S9(4)   VALUE +1891.
   987     12  ER-1892                     PIC S9(4)   VALUE +1892.
   988     12  ER-1893                     PIC S9(4)   VALUE +1893.
   989     12  ER-1894                     PIC S9(4)   VALUE +1894.
   990     12  ER-1895                     PIC S9(4)   VALUE +1895.
   991     12  ER-1896                     PIC S9(4)   VALUE +1896.
   992     12  ER-1897                     PIC S9(4)   VALUE +1897.
   993     12  ER-1898                     PIC S9(4)   VALUE +1898.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  19
* EL050.cbl
   994     12  ER-1899                     PIC S9(4)   VALUE +1899.
   995     12  ER-1900                     PIC S9(4)   VALUE +1900.
   996     12  ER-1901                     PIC S9(4)   VALUE +1901.
   997     12  ER-1902                     PIC S9(4)   VALUE +1902.
   998     12  ER-1903                     PIC S9(4)   VALUE +1903.
   999     12  ER-1904                     PIC S9(4)   VALUE +1904.
  1000     12  ER-1905                     PIC S9(4)   VALUE +1905.
  1001     12  ER-1906                     PIC S9(4)   VALUE +1906.
  1002     12  ER-1907                     PIC S9(4)   VALUE +1907.
  1003     12  ER-1909                     PIC S9(4)   VALUE +1909.
  1004     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1005     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1006     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1007     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1008     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1009     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1010     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1011     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1012     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1013     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1014     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1015     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1016     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1017     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1018     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1019     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1020     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1021     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1022     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1023     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1024     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1025     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1026     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1027     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1028     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1029     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1030     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1031     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1032     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1033     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1034     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1035     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1036     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1037     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1038     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1039     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1040     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1041     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1042     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1043     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1044     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1045     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1046     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1047     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1048     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1049     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1050     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1051     12  ER-2619                     PIC S9(4)   VALUE +2619.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  20
* EL050.cbl
  1052     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1053     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1054     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1055     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1056     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1057     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1058     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1059     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1060     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1061     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1062     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1063     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1064     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1065     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1066     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1067     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1068     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1069     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1070     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1071     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1072     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1073     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1074     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1075     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1076     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1077     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1078     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1079     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1080     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1081     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1082     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1083     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1084     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1085     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1086     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1087     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1088     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1089     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1090     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1091     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1092     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1093     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1094     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1095     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1096     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1097     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1098     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1099     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1100     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1101     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1102     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1103     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1104     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1105     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1106     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1107     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1108     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1109     12  ER-2677                     PIC S9(4)   VALUE +2677.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  21
* EL050.cbl
  1110     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1111     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1112     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1113     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1114     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1115     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1116     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1117     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1118     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1119     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1120     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1121     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1122     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1123     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1124     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1125     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1126     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1127     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1128     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1129     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1130     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1131     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1132     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1133     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1134     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1135     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1136     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1137     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1138     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1139     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1140     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1141     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1142     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1143     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1144     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1145     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1146     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1147     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1148     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1149     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1150     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1151     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1152     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1153     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1154     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1155     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1156     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1157     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1158     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1159     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1160     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1161     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1162     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1163     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1164     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1165     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1166     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1167     12  ER-2745                     PIC S9(4)   VALUE +2745.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  22
* EL050.cbl
  1168     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1169     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1170     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1171     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1172     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1173     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1174     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1175     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1176     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1177     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1178     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1179     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1180     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1181     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1182     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1183     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1184     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1185     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1186     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1187     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1188     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1189     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1190     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1191     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1192     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1193     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1194     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1195     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1196     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1197     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1198     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1199     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1200     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1201     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1202     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1203     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1204     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1205     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1206     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1207     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1208     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1209     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1210     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1211     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1212     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1213     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1214     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1215     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1216     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1217     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1218     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1219     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1220     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1221     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1222     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1223     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1224     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1225     12  ER-2887                     PIC S9(4)   VALUE +2887.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  23
* EL050.cbl
  1226     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1227     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1228     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1229     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1230     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1231     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1232     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1233     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1234     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1235     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1236     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1237     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1238     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1239     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1240     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1241     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1242     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1243     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1244     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1245     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1246     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1247     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1248     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1249     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1250     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1251     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1252     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1253     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1254     12  ER-3069                     PIC S9(4)   VALUE +3069.
  1255     12  er-3270                     pic s9(4)   value +3270.
  1256     12  er-3273                     pic s9(4)   value +3273.
  1257     12  er-3281                     pic s9(4)   value +3281.
  1258     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1259     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1260     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1261     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1262     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1263     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1264     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1265     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1266     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1267     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1268     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1269     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1270     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1271     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1272     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1273     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1274     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1275     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1276     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1277     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1278     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1279     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1280     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1281     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1282     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1283     12  ER-8039                     PIC S9(4)   VALUE +8039.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  24
* EL050.cbl
  1284     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1285     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1286     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1287     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1288     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1289     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1290     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1291     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1292     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1293     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1294     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1295     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1296     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1297     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1298     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1299     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1300     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1301     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1302     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1303     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1304     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1305     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1306     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1307     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1308     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1309     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1310     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1311     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1312     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1313     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1314     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1315     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1316     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1317     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1318     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1319     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1320     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1321     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1322     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1323     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1324     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1325     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1326     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1327     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1328     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1329     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1330     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1331     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1332     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1333     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1334     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1335     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1336     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1337     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1338     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1339     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1340     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1341     12  ER-8313                     PIC S9(4)   VALUE +8313.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  25
* EL050.cbl
  1342     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1343     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1344     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1345     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1346     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1347     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1348     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1349     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1350     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1351     12  er-9823                     pic s9(4)   value +9823.
  1352     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1353******************************************************************
  1354***************   END OF ELC50WS     ****************************
  1355******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  26
* EL050.cbl
  1358 01  WORKING-STORAGE-WORK-AREAS.
  1359     12  WS-RESPONSE             PIC S9(8)  COMP.
  1360         88  WS-RESP-NORMAL           VALUE +00.
  1361         88  WS-RESP-ERROR            VALUE +01.
  1362         88  WS-RESP-NOTFND           VALUE +13.
  1363         88  WS-RESP-DUPREC           VALUE +14.
  1364         88  WS-RESP-ENDFILE          VALUE +20.
  1365     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1366     12  WORK-AREAS.
  1367         16  WK-CONV-GREG.
  1368             24  WCG-CENT             PIC XX.
  1369             24  WCG-REST             PIC X(4).
  1370         16  WORK-GREGORIAN-DATE.
  1371             24  WK-GREG-CENT         PIC XX.
  1372             24  WK-GREG-DATE-YYMMDD.
  1373                 28  WK-GREG-YYMM     PIC X(4).
  1374                 28  WK-GREG-DD       PIC XX.
  1375
  1376         16  WORK-SELECT-DATE.
  1377             24  WK-SELECT-CENT            PIC XX.
  1378             24  WK-SELECT-DATE-YYMMDD.
  1379                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1380                 28  FILLER                PIC XX.
  1381
  1382         16  WK-FORM-NO.
  1383             24  WK-FORM-BANK-ID       PIC X(5).
  1384             24  WK-FORM-UNDRWRTR      PIC X(1).
  1385             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1386
  1387         16  WK-MEMBER-NO.
  1388             24  WK-MEMBER-1-6        PIC X(6).
  1389             24  WK-MEMBER-7-12       PIC X(6).
  1390
  1391         16  WK-FULL-CERT-NO.
  1392             24  WK-CERT-POS-1-2      PIC X(2).
  1393             24  WK-CERT-POS-3        PIC X(1).
  1394             24  WK-CERT-POS-4        PIC X(1).
  1395             24  WK-CERT-POS-5-6      PIC X(2).
  1396             24  WK-CERT-POS-7        PIC X(1).
  1397             24  WK-CERT-POS-8-11     PIC X(4).
  1398
  1399         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1400             88  VALID-RATE-CODE        VALUE 'Y'.
  1401             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1402
  1403         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1404         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1405         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1406         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1407         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1408         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1409         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1410         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1411         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1412         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1413
  1414* DLO001
  1415 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  27
* EL050.cbl
  1416     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1417     12  DMPF-RETURN-CODE          PIC XX.
  1418         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1419         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1420         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1421         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1422         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1423         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1424
  1425* DLO002
  1426 01  WS-DLO-INTERNAL-POLICY-FORM.
  1427     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1428     12  DIPF-RETURN-CODE          PIC XX.
  1429         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1430         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1431         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1432         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1433         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1434         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1435
  1436* DLO003
  1437 01  WS-DLO-VALID-BANK-ID.
  1438     12  DVBI-BANK-ID              PIC X(5).
  1439     12  DVBI-BANK-ID-TYPE         PIC X.
  1440         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1441         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1442         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1443         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1444         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1445     12  DVBI-RETURN-CODE          PIC XX.
  1446         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1447         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1448         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1449         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1450         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1451         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1452         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1453         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1454         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1455
  1456* DLO007
  1457 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1458     12  DCUA-RES-STATE            PIC XX.
  1459     12  DCUA-BEN-TYPE             PIC XX.
  1460     12  DCUA-SYS-IDENT            PIC X.
  1461         88  DCUA-CLAIM                        VALUE 'C'.
  1462         88  DCUA-PREMIUM                      VALUE 'P'.
  1463     12  DCUA-COVERAGE-RULE        PIC X.
  1464     12  DCUA-CLIENT-ID            PIC X(10).
  1465     12  DCUA-EFF-DATE             PIC X(8).
  1466     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1467     12  DCUA-RETURN-CODE          PIC XX.
  1468         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1469     12  DCUA-CERT-NUMBER          PIC X(11).
  1470     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1471     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1472
  1473* DLO011
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  28
* EL050.cbl
  1474 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1475     12  DPRB-RATE-CODE            PIC X(4).
  1476     12  DPRB-COVERAGE-CATEG       PIC X.
  1477     12  DPRB-RETURN-CODE          PIC XX.
  1478         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1479         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1480         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1481         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1482         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1483         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1484         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1485         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1486         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1487     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1488     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1489     12  DPRB-BEN-TYPE             PIC XX.
  1490
  1491* DLO017
  1492 01  WS-DLO-VALID-RATE-CODE.
  1493     12  DVRC-RATE-CODE            PIC X(4).
  1494     12  DVRC-RETURN-CODE          PIC XX.
  1495         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1496         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1497         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1498         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1499         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1500         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1501
  1502* DLO019
  1503 01  WS-DLO-ORIG-COV-CAT.
  1504     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1505     12  DOCC-RETURN-CODE          PIC XX.
  1506     12  DOCC-ORIG-COV-CAT         PIC X.
  1507     12  DOCC-UNDERWITER           PIC XX.
  1508     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1509     12  DOCC-FILLER               PIC X(6).
  1510
  1511* DLO021
  1512 01  WS-DLO-VALID-LOAN-OFFICER.
  1513     12  DVLO-LOAN-OFFICER.
  1514         16  DVLO-BILL-TYPE        PIC X.
  1515         16  DVLO-BILL-SOURCE      PIC X.
  1516         16  DVLO-BATCH-TYPE       PIC X.
  1517     12  DVLO-RETURN-CODE          PIC XX.
  1518         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1519         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1520         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1521         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1522         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1523         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1524
  1525* DLO022
  1526 01  WS-DLO-VALID-STATE-CODE.
  1527     12  DVSC-STATE-CODE           PIC XX.
  1528     12  DVSC-RETURN-CODE          PIC XX.
  1529         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1530
  1531* DLO023
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  29
* EL050.cbl
  1532 01  WS-DLO-VALID-CODE-VALUES.
  1533     12  DVCV-SYSTEM-ID            PIC XX.
  1534         88  DVCV-CLAIMS                       VALUE 'CL'.
  1535         88  DVCV-CREDIT                       VALUE 'CR'.
  1536     12  DVCV-RECORD-TYPE          PIC XX.
  1537         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1538         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1539         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1540         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1541         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1542         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1543         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1544         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1545     12  DVCV-RECORD-KEY           PIC X(6).
  1546     12  DVCV-RETURN-CODE          PIC XX.
  1547         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1548         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1549         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1550         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1551         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1552         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1553         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1554     12  DVCV-CODE-DESC            PIC X(60).
  1555     12  DVCV-GEN-DESC-1           PIC X(20).
  1556     12  DVCV-GEN-DESC-2           PIC X(20).
  1557     12  DVCV-GEN-DESC-3           PIC X(20).
  1558
  1559 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1560 01  hldi-pass-area.
  1561     03  PA-VIN                  PIC X(17).
  1562     03  PA-ErrorCode            PIC X(10).
  1563     03  PA-ErrorDesc            PIC X(30).
  1564     03  PA-ModelYear            PIC 9(7).
  1565     03  PA-MakeName             PIC X(50).
  1566     03  PA-ModelName            PIC X(50).
  1567     03  PA-SeriesName           PIC X(50).
  1568 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1569 01  zipcd-pass-area.
  1570     03  PA-zip                  PIC X(5).
  1571     03  PA-ErrorCode-zip        PIC X(10).
  1572     03  PA-city                 PIC x(50).
  1573     03  PA-state                PIC Xx.
  1574 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1575 01  clmhs-pass-area.
  1576     03  pa-clmhs-state          pic xx.
  1577     03  pa-account              pic x(10).
  1578     03  pa-eff-dt               pic x(10).
  1579     03  pa-cert-no              pic x(11).
  1580     03  pa-clm-count            pic 9(5).
  1581****  this is for aggregate report.
  1582****  Length is erpndb + 100 of passed-key-area
  1583 01  ws-passed-key-length        pic s9(4) comp value +587.
  1584 01  ws-pass-to-pemaggo.
  1585     05  ws-passed-erpndb        pic x(585).
  1586     05  ws-exceed-limit-yn      pic x.
  1587     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  30
* EL050.cbl
  1589*    COPY ERCBXRF.
  1590******************************************************************
  1591*                                                                *
  1592*                                                                *
  1593*                            ERCBXRF                             *
  1594*                                                                *
  1595*   ONLINE CREDIT SYSTEM                                         *
  1596*                                                                *
  1597*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1598*                                                                *
  1599*   FILE TYPE = VSAM,KSDS                                        *
  1600*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1601*                                                                *
  1602*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1603*       ALTERNATE PATH = NONE                                    *
  1604*                                                                *
  1605*   LOG = NO                                                     *
  1606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1607*                                                                *
  1608******************************************************************
  1609
  1610 01  BANK-CROSS-REFERENCE.
  1611     12  BK-RECORD-ID                PIC XX.
  1612         88  VALID-BK-ID             VALUE 'BK'.
  1613
  1614     12  BK-CONTROL-PRIMARY.
  1615         16  BK-COMPANY-CD           PIC X.
  1616         16  BK-CARRIER              PIC X.
  1617         16  BK-GROUPING             PIC X(6).
  1618         16  BK-BANK-NO              PIC X(10).
  1619
  1620     12  BK-MAINT-INFORMATION.
  1621         16  BK-LAST-MAINT-DT        PIC XX.
  1622         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1623         16  BK-LAST-MAINT-USER      PIC X(4).
  1624         16  FILLER                  PIC X(9).
  1625
  1626     12  FILLER                      PIC X(37).
  1627
  1628     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1629
  1630     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1631                            DEPENDING ON BK-BANK-POINTER-CNT.
  1632         16  BK-AM-ACCOUNT           PIC X(10).
  1633         16  BK-AM-EXP-DT            PIC XX.
  1634         16  BK-AM-EFF-DT            PIC XX.
  1635         16  BK-AM-STATE             PIC XX.
  1636         16  FILLER                  PIC X(20).
  1637
  1638******************************************************************
  1639
  1640*    COPY ERCCOMP.
  1641******************************************************************
  1642*                                                                *
  1643*                                                                *
  1644*                            ERCCOMP                             *
  1645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1646*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  31
* EL050.cbl
  1647*                                                                *
  1648*   ONLINE CREDIT SYSTEM                                         *
  1649*                                                                *
  1650*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1651*                                                                *
  1652*   FILE TYPE = VSAM,KSDS                                        *
  1653*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1654*                                                                *
  1655*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1656*       ALTERNATE PATH = NONE                                    *
  1657*                                                                *
  1658*   LOG = NO                                                     *
  1659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1660*                                                                *
  1661******************************************************************
  1662*                   C H A N G E   L O G
  1663*
  1664* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1665*-----------------------------------------------------------------
  1666*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1667* EFFECTIVE    NUMBER
  1668*-----------------------------------------------------------------
  1669* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1670* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1671* 092205    2005050300006  PEMA  ADD LEASE FEE
  1672* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1673* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1674* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1675* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1676* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1677* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1678******************************************************************
  1679
  1680 01  COMPENSATION-MASTER.
  1681     12  CO-RECORD-ID                          PIC XX.
  1682         88  VALID-CO-ID                          VALUE 'CO'.
  1683
  1684     12  CO-CONTROL-PRIMARY.
  1685         16  CO-COMPANY-CD                     PIC X.
  1686         16  CO-CONTROL.
  1687             20  CO-CTL-1.
  1688                 24  CO-CARR-GROUP.
  1689                     28  CO-CARRIER            PIC X.
  1690                     28  CO-GROUPING.
  1691                         32  CO-GROUP-PREFIX   PIC XXX.
  1692                         32  CO-GROUP-PRIME    PIC XXX.
  1693                 24  CO-RESP-NO.
  1694                     28  CO-RESP-PREFIX        PIC X(4).
  1695                     28  CO-RESP-PRIME         PIC X(6).
  1696             20  CO-CTL-2.
  1697                 24  CO-ACCOUNT.
  1698                     28  CO-ACCT-PREFIX        PIC X(4).
  1699                     28  CO-ACCT-PRIME         PIC X(6).
  1700         16  CO-TYPE                           PIC X.
  1701             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1702             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1703             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1704
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  32
* EL050.cbl
  1705     12  CO-MAINT-INFORMATION.
  1706         16  CO-LAST-MAINT-DT                  PIC XX.
  1707         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1708         16  CO-LAST-MAINT-USER                PIC X(4).
  1709     12  FILLER                                PIC XX.
  1710     12  CO-STMT-TYPE                          PIC XXX.
  1711     12  CO-COMP-TYPE                          PIC X.
  1712         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1713     12  CO-STMT-OWNER                         PIC X(4).
  1714     12  CO-BALANCE-CONTROL                    PIC X.
  1715         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1716         88  CO-NO-BALANCE                        VALUE 'N'.
  1717
  1718     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1719         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1720         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1721         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1722
  1723     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1724         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1725         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1726
  1727     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1728     12  CO-GA-DIRECT-DEP                      PIC X.
  1729     12  CO-FUTURE-SPACE                       PIC X.
  1730         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1731
  1732     12  CO-ACCT-NAME                          PIC X(30).
  1733     12  CO-MAIL-NAME                          PIC X(30).
  1734     12  CO-ADDR-1                             PIC X(30).
  1735     12  CO-ADDR-2                             PIC X(30).
  1736     12  CO-ADDR-3.
  1737         16  CO-ADDR-CITY                      PIC X(27).
  1738         16  CO-ADDR-STATE                     PIC XX.
  1739     12  CO-CSO-1099                           PIC X.
  1740     12  CO-ZIP.
  1741         16  CO-ZIP-PRIME.
  1742             20  CO-ZIP-PRI-1ST                PIC X.
  1743                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1744             20  FILLER                        PIC X(4).
  1745         16  CO-ZIP-PLUS4                      PIC X(4).
  1746     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1747         16  CO-CAN-POSTAL-1                   PIC XXX.
  1748         16  CO-CAN-POSTAL-2                   PIC XXX.
  1749         16  FILLER                            PIC XXX.
  1750     12  CO-SOC-SEC                            PIC X(13).
  1751     12  CO-TELEPHONE.
  1752         16  CO-AREA-CODE                      PIC XXX.
  1753         16  CO-PREFIX                         PIC XXX.
  1754         16  CO-PHONE                          PIC X(4).
  1755
  1756     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1757
  1758     12  CO-AR-BAL-LEVEL                       PIC X.
  1759         88  CO-AR-REF-LVL                        VALUE '1'.
  1760         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1761         88  CO-AR-BILL-LVL                       VALUE '2'.
  1762         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  33
* EL050.cbl
  1763         88  CO-AR-FR-LVL                         VALUE '4'.
  1764
  1765     12  CO-AR-NORMAL-PRINT                    PIC X.
  1766         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1767         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1768
  1769     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1770
  1771     12  CO-AR-REPORTING                       PIC X.
  1772         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1773         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1774
  1775     12  CO-AR-PULL-CHECK                      PIC X.
  1776         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1777         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1778
  1779     12  CO-AR-BALANCE-PRINT                   PIC X.
  1780         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1781
  1782     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1783         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1784         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1785         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1786
  1787     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1788
  1789     12  CO-USER-CODE                          PIC X.
  1790     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1791
  1792******************************************************************
  1793*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1794*    THE LAST MONTH END RUN.
  1795******************************************************************
  1796
  1797     12  CO-LAST-ACTIVITY-DATE.
  1798         16  CO-ACT-YEAR                       PIC 99.
  1799         16  CO-ACT-MONTH                      PIC 99.
  1800         16  CO-ACT-DAY                        PIC 99.
  1801
  1802     12  CO-LAST-STMT-DT.
  1803         16  CO-LAST-STMT-YEAR                 PIC 99.
  1804         16  CO-LAST-STMT-MONTH                PIC 99.
  1805         16  CO-LAST-STMT-DAY                  PIC 99.
  1806
  1807     12  CO-MO-END-TOTALS.
  1808         16  CO-MONTHLY-TOTALS.
  1809             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1810             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1811             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1812             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1813             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1814
  1815         16  CO-AGING-TOTALS.
  1816             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1817             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1818             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1819             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1820
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  34
* EL050.cbl
  1821         16  CO-YTD-TOTALS.
  1822             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1823             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1824
  1825         16  CO-OVER-UNDER-TOTALS.
  1826             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1827             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1828
  1829     12  CO-MISCELLANEOUS-TOTALS.
  1830         16  CO-FICA-TOTALS.
  1831             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1832             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1833
  1834         16  CO-CLAIM-TOTALS.
  1835             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1836             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1837
  1838******************************************************************
  1839*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1840*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1841******************************************************************
  1842
  1843     12  CO-CURRENT-TOTALS.
  1844         16  CO-CURRENT-LAST-STMT-DT.
  1845             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1846             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1847             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1848
  1849         16  CO-CURRENT-MONTHLY-TOTALS.
  1850             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1851             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1852             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1853             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1854             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1855
  1856         16  CO-CURRENT-AGING-TOTALS.
  1857             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1858             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1859             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1860             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1861
  1862         16  CO-CURRENT-YTD-TOTALS.
  1863             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1864             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1865
  1866     12  CO-PAID-COMM-TOTALS.
  1867         16  CO-YTD-PAID-COMMS.
  1868             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1869             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1870
  1871     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1872         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1873         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1874
  1875     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1876         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1877         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1878         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  35
* EL050.cbl
  1879         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1880         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1881         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1882         88  CO-FINAL-LETTER                  VALUE 'F'.
  1883         88  CO-RECONCILING                   VALUE 'R'.
  1884         88  CO-PHONE-CALL                    VALUE 'P'.
  1885         88  CO-LEGAL                         VALUE 'L'.
  1886         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1887         88  CO-WRITE-OFF                     VALUE 'W'.
  1888         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1889
  1890     12  CO-CSR-CODE                       PIC X(4).
  1891
  1892     12  CO-GA-STATUS-INFO.
  1893         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1894         16  CO-GA-TERMINATION-DT          PIC XX.
  1895         16  CO-GA-STATUS-CODE             PIC X.
  1896             88  CO-GA-ACTIVE                 VALUE 'A'.
  1897             88  CO-GA-INACTIVE               VALUE 'I'.
  1898             88  CO-GA-PENDING                VALUE 'P'.
  1899         16  CO-GA-COMMENTS.
  1900             20  CO-GA-COMMENT-1           PIC X(40).
  1901             20  CO-GA-COMMENT-2           PIC X(40).
  1902             20  CO-GA-COMMENT-3           PIC X(40).
  1903             20  CO-GA-COMMENT-4           PIC X(40).
  1904
  1905     12  CO-RPTCD2                         PIC X(10).
  1906     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1907         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1908         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1909
  1910     12  CO-TYPE-AGENT                     PIC X(01).
  1911         88  CO-CORPORATION                   VALUE 'C'.
  1912         88  CO-PARTNERSHIP                   VALUE 'P'.
  1913         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1914         88  CO-TRUST                         VALUE 'T'.
  1915         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1916
  1917     12  CO-FAXNO.
  1918         16  CO-FAX-AREA-CODE                  PIC XXX.
  1919         16  CO-FAX-PREFIX                     PIC XXX.
  1920         16  CO-FAX-PHONE                      PIC X(4).
  1921
  1922     12  CO-BANK-INFORMATION.
  1923         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1924         16  CO-BANK-TRANSIT-NON REDEFINES
  1925             CO-BANK-TRANSIT-NO                PIC 9(8).
  1926
  1927         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1928     12  CO-MISC-DEDUCT-INFO REDEFINES
  1929                  CO-BANK-INFORMATION.
  1930         16  CO-MD-GL-ACCT                     PIC X(10).
  1931         16  CO-MD-DIV                         PIC XX.
  1932         16  CO-MD-CENTER                      PIC X(4).
  1933         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1934         16  CO-CREATE-AP-CHECK                PIC X.
  1935         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1936         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  36
* EL050.cbl
  1937     12  CO-ACH-STATUS                         PIC X.
  1938         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1939         88  CO-ACH-PENDING                        VALUE 'P'.
  1940
  1941     12  CO-BILL-SW                            PIC X.
  1942     12  CO-CONTROL-NAME                       PIC X(30).
  1943     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1944     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1945     12  CO-CLP-STATE                          PIC XX.
  1946     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1947     12  CO-SPP-REFUND-EDIT                    PIC X.
  1948
  1949******************************************************************
  1950
  1951*    COPY ERCAGTC.
  1952******************************************************************
  1953*                                                                *
  1954*                                                                *
  1955*                            ERCAGTC                             *
  1956*                            VMOD=2.001                          *
  1957*                                                                *
  1958*   ONLINE CREDIT SYSTEM                                         *
  1959*                                                                *
  1960*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1961*                                                                *
  1962*   FILE TYPE = VSAM,KSDS                                        *
  1963*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1964*                                                                *
  1965*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1966*       ALTERNATE PATH = NONE                                    *
  1967*                                                                *
  1968*   LOG = NO                                                     *
  1969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1970*                                                                *
  1971******************************************************************
  1972*                   C H A N G E   L O G
  1973*
  1974* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1975*-----------------------------------------------------------------
  1976*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1977* EFFECTIVE    NUMBER
  1978*-----------------------------------------------------------------
  1979* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1980* 111004                         NEW FILE AND COPYBOOK
  1981* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1982******************************************************************
  1983 01  AGENT-COMMISSIONS.
  1984     12  AG-RECORD-ID                          PIC XX.
  1985         88  VALID-CO-ID                          VALUE 'AG'.
  1986     12  AG-CONTROL-PRIMARY.
  1987         16  AG-COMPANY-CD                     PIC X.
  1988         16  AG-CONTROL.
  1989             20  AG-CTL-1.
  1990                 24  AG-CARR-GROUP.
  1991                     28  AG-CARRIER            PIC X.
  1992                     28  AG-GROUPING           PIC X(6).
  1993                 24  AG-BANK                   PIC X(10).
  1994             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  37
* EL050.cbl
  1995                 24  AG-EXP-DT                 PIC XX.
  1996         16  AG-TYPE                           PIC X.
  1997             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1998             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1999     12  AG-MAINT-INFORMATION.
  2000         16  AG-LAST-MAINT-DT                  PIC XX.
  2001         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2002         16  AG-LAST-MAINT-USER                PIC X(4).
  2003         16  FILLER                            PIC X(10).
  2004     12  AG-EFF-DT                             PIC XX.
  2005     12  AG-COMM-STRUCTURE.
  2006         16  AG-AGT-COMMS OCCURS 10.
  2007             20  AG-AGT                PIC X(10).
  2008             20  AG-COM-TYP            PIC X.
  2009             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2010             20  AG-RECALC-LV-INDIC    PIC X.
  2011             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2012             20  AG-LRCALC-LV-INDIC    PIC X.
  2013             20  FILLER                PIC X(05).
  2014     12  FILLER                  PIC X(145).
  2015******************************************************************
  2016*    COPY ERCRESS.
  2017******************************************************************
  2018*                                                                *
  2019*                            ERCRESS                             *
  2020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2021*                            VMOD=2.002                          *
  2022*                                                                *
  2023*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2024*                                                                *
  2025*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2026*   VSAM RESIDENT STATE TAX MASTER                              *
  2027*                                                                *
  2028*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2029*                                                                *
  2030*   FILE TYPE = VSAM,KSDS                                        *
  2031*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2032*                                                                *
  2033*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2034*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2035*                                                                *
  2036*   LOG = NO                                                     *
  2037*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2038*                                                                *
  2039*                                                                *
  2040******************************************************************
  2041
  2042 01  RESIDENT-STATE-TAX-MASTER.
  2043
  2044     10  ERRESS-PRIMARY-KEY.
  2045         15  RES-COMPANY-CD        PIC X.
  2046         15  RES-RESIDENT-STATE    PIC XX.
  2047         15  RES-COVERAGE-CATEGORY PIC X.
  2048         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2049*                                      YYYYMMDD
  2050*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2051
  2052     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  38
* EL050.cbl
  2053
  2054         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2055         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2056         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2057         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2058
  2059     10 RES-RECALC-SW              PIC   X.
  2060         88 RECALC                VALUE 'Y'.
  2061         88 NO-RECALC             VALUE 'N'.
  2062     10  RES-MAINT-BY              PIC X(4).
  2063     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2064     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2065*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  39
* EL050.cbl
  2067*    COPY ERCRESC.
  2068******************************************************************
  2069*                                                                *
  2070*                            ERCRESC                             *
  2071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2072*                            VMOD=2.003                          *
  2073*                                                                *
  2074*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2075*                                                                *
  2076*   FILE TYPE = VSAM,KSDS                                        *
  2077*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2078*                                                                *
  2079*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2080*       ALTERNATE PATH1 = NONE                                   *
  2081*                                                                *
  2082*   LOG = NO                                                     *
  2083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2084*                                                                *
  2085******************************************************************
  2086
  2087 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2088
  2089     10  ERRESC-RECORD-KEY.
  2090         15  RESC-COMPANY-CD           PIC   X.
  2091         15  RESC-CARRIER              PIC   X.
  2092         15  RESC-GROUP                PIC   X(6).
  2093         15  RESC-STATE                PIC   XX.
  2094         15  RESC-ACCOUNT              PIC   X(10).
  2095         15  RESC-AGENT                PIC   X(10).
  2096         15  RESC-RESIDENT-STATE       PIC   XX.
  2097         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2098*                                           YYYYMMDD
  2099     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2100
  2101     10  RESC-COMM-RECORD-DATA.
  2102         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2103             20 RESC-COVERAGE-CAT      PIC    X.
  2104             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2105             20 RESC-COMMISSION-TAB REDEFINES
  2106                RESC-COMMISSION-PER    PIC  XXX.
  2107
  2108     10  RESC-MAINT-BY                 PIC X(4).
  2109     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2110     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2111*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  40
* EL050.cbl
  2113*    COPY ERCPLAN.
  2114******************************************************************
  2115*                                                                *
  2116*                                                                *
  2117*                            ERCPLAN                             *
  2118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2119*                            VMOD=2.003                          *
  2120*                                                                *
  2121*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2122*                                                                *
  2123*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2124*   PLAN MASTER                                                  *
  2125*                                                                *
  2126*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2127*                                                                *
  2128*   FILE TYPE = VSAM,KSDS                                        *
  2129*   RECORD SIZE = 420   RECFORM = FIX                            *
  2130*                                                                *
  2131*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2132*       ALTERNATE PATH1 = N/A                                    *
  2133*                                                                *
  2134*   LOG = NO                                                     *
  2135*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2136*                                                                *
  2137*                                                                *
  2138******************************************************************
  2139
  2140 01  PLAN-MASTER.
  2141     12  PL-RECORD-ID                      PIC XX.
  2142         88  VALID-PL-ID                      VALUE 'PL'.
  2143
  2144     12  PL-CONTROL-PRIMARY.
  2145         16  PL-COMPANY-CD                 PIC X.
  2146         16  PL-MSTR-CNTRL.
  2147             20  PL-CONTROL-A.
  2148                 24  PL-CARRIER            PIC X.
  2149                 24  PL-GROUPING           PIC X(6).
  2150                 24  PL-STATE              PIC XX.
  2151                 24  PL-ACCOUNT            PIC X(10).
  2152             20  PL-BENEFIT-TYPE           PIC X.
  2153             20  PL-BENEFIT-CODE           PIC XX.
  2154             20  PL-REVISION-NO            PIC X(3).
  2155
  2156     12  PL-CONTROL-BY-VAR-GRP.
  2157         16  PL-COMPANY-CD-A1              PIC X.
  2158         16  PL-VG-CARRIER                 PIC X.
  2159         16  PL-VG-GROUPING                PIC X(6).
  2160         16  PL-VG-STATE                   PIC XX.
  2161         16  PL-VG-ACCOUNT                 PIC X(10).
  2162         16  PL-BENEFIT-TYPE-A1            PIC X.
  2163         16  PL-BENEFIT-CODE-A1            PIC XX.
  2164         16  PL-REVISION-NO-A1             PIC 999.
  2165
  2166     12  PL-MAINT-INFORMATION.
  2167         16  PL-LAST-MAINT-DT              PIC XX.
  2168         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2169         16  PL-LAST-MAINT-USER            PIC X(4).
  2170         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  41
* EL050.cbl
  2171
  2172     12  PL-LIABILITY-LIMITS.
  2173         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2174         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2175             20  PL-LM-AGE                 PIC S99        COMP-3.
  2176             20  PL-LM-DUR                 PIC S999       COMP-3.
  2177             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2178             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2179
  2180     12  FILLER                            PIC X(30).
  2181
  2182     12  PL-GL-ACCOUNT-NOS.
  2183         16  PL-PREMIUM-GL                 PIC X(8).
  2184         16  PL-COMM-GL                    PIC X(8).
  2185         16  PL-CLAIM-GL                   PIC X(8).
  2186     12  FILLER                            PIC X(24).
  2187     12  PL-TOLERANCES.
  2188         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2189         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2190         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2191         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2192         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2193         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2194     12  PL-OVER-SHORT.
  2195         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2196         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2197     12  FILLER                            PIC X(24).
  2198     12  PLAN-MISC.
  2199         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2200         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2201         16  PL-IG                         PIC X.
  2202         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2203         16  PL-POLICY-FORM                PIC X(12).
  2204         16  PL-EDIT-FOR-FORM              PIC X(01).
  2205         16  PL-DEV-CODE                   PIC XXX.
  2206         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2207         16  PL-CALC-METHOD                PIC X.
  2208         16  PL-BENEFIT-GROUP              PIC X(05).
  2209         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2210
  2211         16  FILLER                        PIC X(99).
  2212******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  42
* EL050.cbl
  2214*    COPY ELCCERT.
  2215******************************************************************
  2216*                                                                *
  2217*                            ELCCERT.                            *
  2218*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2219*                            VMOD=2.013                          *
  2220*                                                                *
  2221*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2222*                                                                *
  2223*   FILE TYPE = VSAM,KSDS                                        *
  2224*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2225*                                                                *
  2226*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2227*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2228*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2229*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2230*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2231*                                                                *
  2232*   LOG = YES                                                    *
  2233*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2234******************************************************************
  2235*                   C H A N G E   L O G
  2236*
  2237* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2238*-----------------------------------------------------------------
  2239*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2240* EFFECTIVE    NUMBER
  2241*-----------------------------------------------------------------
  2242* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2243* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2244* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2245* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2246* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2247* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2248* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2249* 032612  CR2011110200001  PEMA  AHL CHANGES
  2250* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2251* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2252* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2253******************************************************************
  2254
  2255 01  CERTIFICATE-MASTER.
  2256     12  CM-RECORD-ID                      PIC XX.
  2257         88  VALID-CM-ID                      VALUE 'CM'.
  2258
  2259     12  CM-CONTROL-PRIMARY.
  2260         16  CM-COMPANY-CD                 PIC X.
  2261         16  CM-CARRIER                    PIC X.
  2262         16  CM-GROUPING.
  2263             20  CM-GROUPING-PREFIX        PIC X(3).
  2264             20  CM-GROUPING-PRIME         PIC X(3).
  2265         16  CM-STATE                      PIC XX.
  2266         16  CM-ACCOUNT.
  2267             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2268             20  CM-ACCOUNT-PRIME          PIC X(6).
  2269         16  CM-CERT-EFF-DT                PIC XX.
  2270         16  CM-CERT-NO.
  2271             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  43
* EL050.cbl
  2272             20  CM-CERT-SFX               PIC X.
  2273
  2274     12  CM-CONTROL-BY-NAME.
  2275         16  CM-COMPANY-CD-A1              PIC X.
  2276         16  CM-INSURED-LAST-NAME          PIC X(15).
  2277         16  CM-INSURED-INITIALS.
  2278             20  CM-INSURED-INITIAL1       PIC X.
  2279             20  CM-INSURED-INITIAL2       PIC X.
  2280
  2281     12  CM-CONTROL-BY-SSN.
  2282         16  CM-COMPANY-CD-A2              PIC X.
  2283         16  CM-SOC-SEC-NO.
  2284             20  CM-SSN-STATE              PIC XX.
  2285             20  CM-SSN-ACCOUNT            PIC X(6).
  2286             20  CM-SSN-LN3.
  2287                 25  CM-INSURED-INITIALS-A2.
  2288                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2289                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2290                 25 CM-PART-LAST-NAME-A2         PIC X.
  2291
  2292     12  CM-CONTROL-BY-CERT-NO.
  2293         16  CM-COMPANY-CD-A4              PIC X.
  2294         16  CM-CERT-NO-A4                 PIC X(11).
  2295
  2296     12  CM-CONTROL-BY-MEMB.
  2297         16  CM-COMPANY-CD-A5              PIC X.
  2298         16  CM-MEMBER-NO.
  2299             20  CM-MEMB-STATE             PIC XX.
  2300             20  CM-MEMB-ACCOUNT           PIC X(6).
  2301             20  CM-MEMB-LN4.
  2302                 25  CM-INSURED-INITIALS-A5.
  2303                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2304                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2305                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2306
  2307     12  CM-INSURED-PROFILE-DATA.
  2308         16  CM-INSURED-FIRST-NAME.
  2309             20  CM-INSURED-1ST-INIT       PIC X.
  2310             20  FILLER                    PIC X(9).
  2311         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2312         16  CM-INSURED-SEX                PIC X.
  2313             88  CM-SEX-MALE                  VALUE 'M'.
  2314             88  CM-SEX-FEMAL                 VALUE 'F'.
  2315         16  CM-INSURED-JOINT-AGE          PIC 99.
  2316         16  CM-JOINT-INSURED-NAME.
  2317             20  CM-JT-LAST-NAME           PIC X(15).
  2318             20  CM-JT-FIRST-NAME.
  2319                 24  CM-JT-1ST-INIT        PIC X.
  2320                 24  FILLER                PIC X(9).
  2321             20  CM-JT-INITIAL             PIC X.
  2322
  2323     12  CM-LIFE-DATA.
  2324         16  CM-LF-BENEFIT-CD              PIC XX.
  2325         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2326         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2327         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2328         16  CM-LF-DEV-CODE                PIC XXX.
  2329         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  44
* EL050.cbl
  2330         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2331         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2332         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2333         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2334         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2335         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2336         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2337         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2338         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2339         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2340         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2341         16  cm-temp-epiq                  pic xx.
  2342             88  EPIQ-CLASS                  value 'EQ'.
  2343*        16  FILLER                        PIC XX.
  2344
  2345     12  CM-AH-DATA.
  2346         16  CM-AH-BENEFIT-CD              PIC XX.
  2347         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2348         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2349         16  CM-AH-DEV-CODE                PIC XXX.
  2350         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2351         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2352         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2353         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2354         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2355         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2356         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2357         16  CM-AH-PAID-THRU-DT            PIC XX.
  2358             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2359         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2360         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2361         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2362         16  FILLER                        PIC X.
  2363
  2364     12  CM-LOAN-INFORMATION.
  2365         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2366         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2367                                           PIC S9(5)V99  COMP-3.
  2368         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2369         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2370         16  CM-PAY-FREQUENCY              PIC S99.
  2371         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2372         16  CM-RATE-CLASS                 PIC XX.
  2373         16  CM-BENEFICIARY                PIC X(25).
  2374         16  CM-POLICY-FORM-NO             PIC X(12).
  2375         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2376         16  CM-LAST-ADD-ON-DT             PIC XX.
  2377         16  CM-DEDUCTIBLE-AMOUNTS.
  2378             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2379             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2380         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2381             20  CM-RESIDENT-STATE         PIC XX.
  2382             20  CM-RATE-CODE              PIC X(4).
  2383             20  FILLER                    PIC XX.
  2384         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2385             20  CM-LOAN-OFFICER           PIC X(5).
  2386             20  FILLER                    PIC XXX.
  2387         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  45
* EL050.cbl
  2388         16  CM-UNDERWRITING-CODE          PIC X.
  2389             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2390         16  CM-POST-CARD-IND              PIC X.
  2391         16  CM-REF-INTERFACE-SW           PIC X.
  2392         16  CM-PREMIUM-TYPE               PIC X.
  2393             88  CM-SING-PRM                  VALUE '1'.
  2394             88  CM-O-B-COVERAGE              VALUE '2'.
  2395             88  CM-OPEN-END                  VALUE '3'.
  2396         16  CM-IND-GRP-TYPE               PIC X.
  2397             88  CM-INDIVIDUAL                VALUE 'I'.
  2398             88  CM-GROUP                     VALUE 'G'.
  2399         16  CM-SKIP-CODE                  PIC X.
  2400             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2401             88  SKIP-JULY                    VALUE '1'.
  2402             88  SKIP-AUGUST                  VALUE '2'.
  2403             88  SKIP-SEPTEMBER               VALUE '3'.
  2404             88  SKIP-JULY-AUG                VALUE '4'.
  2405             88  SKIP-AUG-SEPT                VALUE '5'.
  2406             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2407             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2408             88  SKIP-JUNE                    VALUE '8'.
  2409             88  SKIP-JUNE-JULY               VALUE '9'.
  2410             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2411             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2412         16  CM-PAYMENT-MODE               PIC X.
  2413             88  PAY-MONTHLY                  VALUE SPACE.
  2414             88  PAY-WEEKLY                   VALUE '1'.
  2415             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2416             88  PAY-BI-WEEKLY                VALUE '3'.
  2417             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2418         16  CM-LOAN-NUMBER                PIC X(8).
  2419         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2420         16  CM-OLD-LOF                    PIC XXX.
  2421*        16  CM-LOAN-OFFICER               PIC XXX.
  2422         16  CM-REIN-TABLE                 PIC XXX.
  2423         16  CM-SPECIAL-REIN-CODE          PIC X.
  2424         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2425         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2426         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2427
  2428     12  CM-STATUS-DATA.
  2429         16  CM-ENTRY-STATUS               PIC X.
  2430         16  CM-ENTRY-DT                   PIC XX.
  2431
  2432         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2433         16  CM-LF-CANCEL-DT               PIC XX.
  2434         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2435
  2436         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2437         16  CM-LF-DEATH-DT                PIC XX.
  2438         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2439
  2440         16  CM-LF-CURRENT-STATUS          PIC X.
  2441             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2442                                                'M' '4' '5' '9'.
  2443             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2444             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2445             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  46
* EL050.cbl
  2446             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2447             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2448             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2449             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2450             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2451             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2452             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2453             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2454             88  CM-LF-DECLINED               VALUE 'D'.
  2455             88  CM-LF-VOIDED                 VALUE 'V'.
  2456
  2457         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2458         16  CM-AH-CANCEL-DT               PIC XX.
  2459         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2460
  2461         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2462         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2463         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2464
  2465         16  CM-AH-CURRENT-STATUS          PIC X.
  2466             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2467                                                'M' '4' '5' '9'.
  2468             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2469             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2470             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2471             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2472             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2473             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2474             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2475             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2476             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2477             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2478             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2479             88  CM-AH-DECLINED               VALUE 'D'.
  2480             88  CM-AH-VOIDED                 VALUE 'V'.
  2481
  2482         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2483             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2484             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2485             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2486         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2487
  2488         16  CM-ENTRY-BATCH                PIC X(6).
  2489         16  CM-LF-EXIT-BATCH              PIC X(6).
  2490         16  CM-AH-EXIT-BATCH              PIC X(6).
  2491         16  CM-LAST-MONTH-END             PIC XX.
  2492
  2493     12  CM-NOTE-SW                        PIC X.
  2494         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2495         88  CERT-NOTES-PRESENT               VALUE '1'.
  2496         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2497         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2498         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2499         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2500         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2501         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2502     12  CM-COMP-EXCP-SW                   PIC X.
  2503         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  47
* EL050.cbl
  2504         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2505     12  CM-INSURED-ADDRESS-SW             PIC X.
  2506         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2507         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2508
  2509*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2510     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2511     12  FILLER                            PIC X.
  2512
  2513*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2514     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2515     12  FILLER                            PIC X.
  2516*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2517     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2518
  2519     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2520         88  CERT-ADDED-BATCH                 VALUE ' '.
  2521         88  CERT-ADDED-ONLINE                VALUE '1'.
  2522         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2523         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2524         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2525     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2526         88  CERT-AS-LOADED                   VALUE ' '.
  2527         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2528         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2529         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2530         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2531         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2532         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2533         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2534
  2535     12  CM-ACCOUNT-COMM-PCTS.
  2536         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2537         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2538
  2539     12  CM-USER-FIELD                     PIC X.
  2540     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2541     12  CM-CLP-STATE                      PIC XX.
  2542     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2543     12  CM-USER-RESERVED                  PIC XXX.
  2544     12  FILLER REDEFINES CM-USER-RESERVED.
  2545         16  CM-AH-CLASS-CD                PIC XX.
  2546         16  F                             PIC X.
  2547******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  48
* EL050.cbl
  2549*    COPY ERCMAIL.
  2550******************************************************************
  2551*                                                                *
  2552*                                                                *
  2553*                            ERCMAIL                             *
  2554*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2555*                            VMOD=2.003                          *
  2556*                                                                *
  2557*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2558*                                                                *
  2559*   FILE TYPE = VSAM,KSDS                                        *
  2560*   RECORD SIZE = 374   RECFORM = FIX                            *
  2561*                                                                *
  2562*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2563*   ALTERNATE PATH    = NOT USED                                 *
  2564*                                                                *
  2565*   LOG = YES                                                    *
  2566*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2567******************************************************************
  2568*                   C H A N G E   L O G
  2569*
  2570* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2571*-----------------------------------------------------------------
  2572*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2573* EFFECTIVE    NUMBER
  2574*-----------------------------------------------------------------
  2575* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2576* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2577* 111108                   PEMA  ADD CRED BENE ADDR2
  2578******************************************************************
  2579
  2580 01  MAILING-DATA.
  2581     12  MA-RECORD-ID                      PIC XX.
  2582         88  VALID-MA-ID                       VALUE 'MA'.
  2583
  2584     12  MA-CONTROL-PRIMARY.
  2585         16  MA-COMPANY-CD                 PIC X.
  2586         16  MA-CARRIER                    PIC X.
  2587         16  MA-GROUPING.
  2588             20  MA-GROUPING-PREFIX        PIC XXX.
  2589             20  MA-GROUPING-PRIME         PIC XXX.
  2590         16  MA-STATE                      PIC XX.
  2591         16  MA-ACCOUNT.
  2592             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2593             20  MA-ACCOUNT-PRIME          PIC X(6).
  2594         16  MA-CERT-EFF-DT                PIC XX.
  2595         16  MA-CERT-NO.
  2596             20  MA-CERT-PRIME             PIC X(10).
  2597             20  MA-CERT-SFX               PIC X.
  2598
  2599     12  FILLER                            PIC XX.
  2600
  2601     12  MA-ACCESS-CONTROL.
  2602         16  MA-SOURCE-SYSTEM              PIC XX.
  2603             88  MA-FROM-CREDIT                VALUE 'CR'.
  2604             88  MA-FROM-VSI                   VALUE 'VS'.
  2605             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2606             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  49
* EL050.cbl
  2607         16  MA-RECORD-ADD-DT              PIC XX.
  2608         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2609         16  MA-LAST-MAINT-DT              PIC XX.
  2610         16  MA-LAST-MAINT-BY              PIC XXXX.
  2611         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2612
  2613     12  MA-PROFILE-INFO.
  2614         16  MA-QUALIFY-CODE-1             PIC XX.
  2615         16  MA-QUALIFY-CODE-2             PIC XX.
  2616         16  MA-QUALIFY-CODE-3             PIC XX.
  2617         16  MA-QUALIFY-CODE-4             PIC XX.
  2618         16  MA-QUALIFY-CODE-5             PIC XX.
  2619
  2620         16  MA-INSURED-LAST-NAME          PIC X(15).
  2621         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2622         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2623         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2624         16  MA-INSURED-BIRTH-DT           PIC XX.
  2625         16  MA-INSURED-SEX                PIC X.
  2626             88  MA-SEX-MALE                   VALUE 'M'.
  2627             88  MA-SEX-FEMALE                 VALUE 'F'.
  2628         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2629
  2630         16  MA-ADDRESS-CORRECTED          PIC X.
  2631         16  MA-JOINT-BIRTH-DT             PIC XX.
  2632*        16  FILLER                        PIC X(12).
  2633
  2634         16  MA-ADDRESS-LINE-1             PIC X(30).
  2635         16  MA-ADDRESS-LINE-2             PIC X(30).
  2636         16  MA-CITY-STATE.
  2637             20  MA-CITY                   PIC X(28).
  2638             20  MA-ADDR-STATE             PIC XX.
  2639         16  MA-ZIP.
  2640             20  MA-ZIP-CODE.
  2641                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2642                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2643                 24  FILLER                PIC X(4).
  2644             20  MA-ZIP-PLUS4              PIC X(4).
  2645         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2646             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2647             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2648             20  FILLER                    PIC X(3).
  2649
  2650         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2651
  2652         16  FILLER                        PIC XXX.
  2653*        16  FILLER                        PIC X(10).
  2654
  2655     12  MA-CRED-BENE-INFO.
  2656         16  MA-CRED-BENE-NAME                 PIC X(25).
  2657         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2658         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2659         16  MA-CRED-BENE-CTYST.
  2660             20  MA-CRED-BENE-CITY             PIC X(28).
  2661             20  MA-CRED-BENE-STATE            PIC XX.
  2662         16  MA-CRED-BENE-ZIP.
  2663             20  MA-CB-ZIP-CODE.
  2664                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  50
* EL050.cbl
  2665                     88  MA-CB-CANADIAN-POST-CODE
  2666                                           VALUE 'A' THRU 'Z'.
  2667                 24  FILLER                    PIC X(4).
  2668             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2669         16  MA-CB-CANADIAN-POSTAL-CODE
  2670                            REDEFINES MA-CRED-BENE-ZIP.
  2671             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2672             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2673             20  FILLER                        PIC X(3).
  2674     12  MA-POST-CARD-MAIL-DATA.
  2675         16  MA-MAIL-DATA OCCURS 7.
  2676             20  MA-MAIL-TYPE              PIC X.
  2677                 88  MA-12MO-MAILING           VALUE '1'.
  2678                 88  MA-EXP-MAILING            VALUE '2'.
  2679             20  MA-MAIL-STATUS            PIC X.
  2680                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2681                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2682                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2683             20  MA-MAIL-DATE              PIC XX.
  2684     12  FILLER                            PIC XX.
  2685     12  FILLER                            PIC XX.
  2686*    12  FILLER                            PIC X(30).
  2687******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  51
* EL050.cbl
  2689*    COPY ERCPNDM.
  2690******************************************************************
  2691*                                                                *
  2692*                                                                *
  2693*                            ERCPNDM                             *
  2694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2695*                            VMOD=2.003                          *
  2696*                                                                *
  2697*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2698*                                                                *
  2699*   FILE TYPE = VSAM,KSDS                                        *
  2700*   RECORD SIZE = 374   RECFORM = FIX                            *
  2701*                                                                *
  2702*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2703*   ALTERNATE PATH    = NOT USED                                 *
  2704*                                                                *
  2705*   LOG = YES                                                    *
  2706*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2707******************************************************************
  2708*                   C H A N G E   L O G
  2709*
  2710* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2711*-----------------------------------------------------------------
  2712*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2713* EFFECTIVE    NUMBER
  2714*-----------------------------------------------------------------
  2715* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2716* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2717* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2718* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2719******************************************************************
  2720
  2721 01  PENDING-MAILING-DATA.
  2722     12  PM-RECORD-ID                      PIC XX.
  2723         88  VALID-MA-ID                       VALUE 'PM'.
  2724
  2725     12  PM-CONTROL-PRIMARY.
  2726         16  PM-COMPANY-CD                 PIC X.
  2727         16  PM-ENTRY-BATCH                PIC X(6).
  2728         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2729         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2730
  2731     12  FILLER                            PIC X(14).
  2732
  2733     12  PM-ACCESS-CONTROL.
  2734         16  PM-SOURCE-SYSTEM              PIC XX.
  2735             88  PM-FROM-CREDIT                VALUE 'CR'.
  2736             88  PM-FROM-VSI                   VALUE 'VS'.
  2737             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2738             88  PM-FROM-OTHER                 VALUE 'OT'.
  2739         16  PM-RECORD-ADD-DT              PIC XX.
  2740         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2741         16  PM-LAST-MAINT-DT              PIC XX.
  2742         16  PM-LAST-MAINT-BY              PIC XXXX.
  2743         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2744
  2745     12  PM-PROFILE-INFO.
  2746         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  52
* EL050.cbl
  2747         16  PM-QUALIFY-CODE-2             PIC XX.
  2748         16  PM-QUALIFY-CODE-3             PIC XX.
  2749         16  PM-QUALIFY-CODE-4             PIC XX.
  2750         16  PM-QUALIFY-CODE-5             PIC XX.
  2751
  2752         16  PM-INSURED-LAST-NAME          PIC X(15).
  2753         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2754         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2755         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2756         16  PM-INSURED-BIRTH-DT           PIC XX.
  2757         16  PM-INSURED-SEX                PIC X.
  2758             88  PM-SEX-MALE                   VALUE 'M'.
  2759             88  PM-SEX-FEMALE                 VALUE 'F'.
  2760         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2761
  2762         16  PM-ADDRESS-CORRECTED          PIC X.
  2763         16  PM-JOINT-BIRTH-DT             PIC XX.
  2764*        16  FILLER                        PIC X(12).
  2765
  2766         16  PM-ADDRESS-LINE-1             PIC X(30).
  2767         16  PM-ADDRESS-LINE-2             PIC X(30).
  2768         16  PM-CITY-STATE.
  2769             20  PM-CITY                   PIC X(28).
  2770             20  PM-STATE                  PIC XX.
  2771         16  PM-ZIP.
  2772             20  PM-ZIP-CODE.
  2773                 24  PM-ZIP-1              PIC X.
  2774                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2775                 24  FILLER                PIC X(4).
  2776             20  PM-ZIP-PLUS4              PIC X(4).
  2777         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2778             20  PM-CAN-POST1              PIC XXX.
  2779             20  PM-CAN-POST2              PIC XXX.
  2780             20  FILLER                    PIC XXX.
  2781
  2782         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2783         16  pm-city-st-zip-verified       pic x.
  2784         16  FILLER                        PIC XX.
  2785
  2786     12  PM-CRED-BENE-INFO.
  2787         16  PM-CRED-BENE-NAME             PIC X(25).
  2788         16  PM-CRED-BENE-ADDR             PIC X(30).
  2789         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2790         16  PM-CRED-BENE-CTYST.
  2791             20  PM-CRED-BENE-CITY         PIC X(28).
  2792             20  PM-CRED-BENE-STATE        PIC XX.
  2793         16  PM-CRED-BENE-ZIP.
  2794             20  PM-CB-ZIP-CODE.
  2795                 24  PM-CB-ZIP-1           PIC X.
  2796                     88  PM-CB-CANADIAN-POST-CODE
  2797                                  VALUE 'A' THRU 'Z'.
  2798                 24  FILLER                PIC X(4).
  2799             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2800         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2801             20  PM-CB-CAN-POST1           PIC XXX.
  2802             20  PM-CB-CAN-POST2           PIC XXX.
  2803             20  FILLER                    PIC XXX.
  2804     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  53
* EL050.cbl
  2805         16  PM-MAIL-DATA OCCURS 7.
  2806             20  PM-MAIL-TYPE              PIC X.
  2807                 88  PM-12MO-MAILING           VALUE '1'.
  2808                 88  PM-EXP-MAILING            VALUE '2'.
  2809             20  PM-MAIL-STATUS            PIC X.
  2810                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2811                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2812                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2813             20  PM-MAIL-DATE              PIC XX.
  2814     12  FILLER                            PIC XX.
  2815     12  FILLER                            PIC X(12).
  2816*    12  FILLER                            PIC X(30).
  2817
  2818******************************************************************
  2819*                                COPY ERCLOFC.
  2820******************************************************************
  2821*                                                                *
  2822*                                                                *
  2823*                            ERCLOFC                             *
  2824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2825*                            VMOD=2.003                          *
  2826*                                                                *
  2827*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2828*                                                                *
  2829*   FILE TYPE = VSAM,KSDS                                        *
  2830*   RECORD SIZE = 670   RECFORM = FIX                            *
  2831*                                                                *
  2832*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2833*                                                                *
  2834*   LOG = YES                                                    *
  2835*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2836*                                                                *
  2837******************************************************************
  2838
  2839 01  LOAN-OFFICER-MASTER.
  2840     12  LO-RECORD-ID                PIC XX.
  2841         88  VALID-LO-ID                VALUE 'LO'.
  2842
  2843     12  LO-CONTROL-PRIMARY.
  2844         16  LO-COMPANY-CD           PIC X.
  2845         16  LO-CARRIER              PIC X.
  2846         16  LO-GROUPING.
  2847             20  LO-GROUPING-PREFIX  PIC XXX.
  2848             20  LO-GROUPING-PRIME   PIC XXX.
  2849         16  LO-STATE                PIC XX.
  2850         16  LO-ACCOUNT.
  2851             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2852             20  LO-ACCOUNT-PRIME    PIC X(6).
  2853         16  LO-OFFICER-CODE         PIC X(5).
  2854
  2855     12  LO-OFFICER-NAME             PIC X(30).
  2856
  2857     12  LO-LAST-MAINT-DT            PIC XX.
  2858     12  LO-LAST-USER                PIC X(4).
  2859     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2860
  2861     12  LO-COMP-CONTROL             PIC X.
  2862             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  54
* EL050.cbl
  2863             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2864     12  LO-DETAIL-CONTROL           PIC X.
  2865             88  LO-PRINT-DETAIL        VALUE 'D'.
  2866             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2867
  2868     12  LO-SV-CARRIER               PIC X.
  2869     12  LO-SV-GROUPING              PIC X(6).
  2870     12  LO-SV-STATE                 PIC XX.
  2871
  2872     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2873     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2874
  2875     12  LO-OFFICER-INFO.
  2876         16  FILLER OCCURS 12 TIMES.
  2877             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2878             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2879             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2880             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2881             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2882             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2883             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2884             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2885     12  FILLER                      PIC X(198).
  2886******************************************************************
  2887*                                COPY ERCPDEF.
  2888******************************************************************
  2889*                                                                *
  2890*                                                                *
  2891*                            ERCPDEF.                            *
  2892*                                                                *
  2893*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2894*                                                                *
  2895*    FILE TYPE = VSAM,KSDS                                       *
  2896*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2897*                                                                *
  2898*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2899*                                                                *
  2900*    LOG = YES                                                   *
  2901*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2902******************************************************************
  2903*                   C H A N G E   L O G
  2904*
  2905* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2906*-----------------------------------------------------------------
  2907*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2908* EFFECTIVE    NUMBER
  2909*-----------------------------------------------------------------
  2910* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2911* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2912* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2913* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2914******************************************************************
  2915 01  PRODUCT-MASTER.
  2916    12  PD-RECORD-ID                 PIC X(02).
  2917        88  VALID-PD-ID                  VALUE 'PD'.
  2918    12  PD-CONTROL-PRIMARY.
  2919        16  PD-COMPANY-CD            PIC X.
  2920        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  55
* EL050.cbl
  2921        16  PD-PRODUCT-CD            PIC XXX.
  2922        16  PD-FILLER                PIC X(7).
  2923        16  PD-BEN-TYPE              PIC X.
  2924        16  PD-BEN-CODE              PIC XX.
  2925        16  PD-PROD-EXP-DT           PIC XX.
  2926    12  FILLER                       PIC X(50).
  2927    12  PD-PRODUCT-DATA OCCURS 8.
  2928        16  PD-PROD-CODE             PIC X.
  2929            88  PD-PROD-LIFE           VALUE 'L'.
  2930            88  PD-PROD-PROP           VALUE 'P'.
  2931            88  PD-PROD-AH             VALUE 'A'.
  2932            88  PD-PROD-IU             VALUE 'I'.
  2933            88  PD-PROD-GAP            VALUE 'G'.
  2934            88  PD-PROD-FAML           VALUE 'F'.
  2935            88  PD-PROD-OTH            VALUE 'O'.
  2936        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2937        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2938        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2939        16  PD-MAX-TERM              PIC S999        COMP-3.
  2940        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2941        16  FILLER                   PIC X.
  2942        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2943        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2944        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2945        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2946        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2947        16  PD-REC-CRIT-PERIOD       PIC 99.
  2948        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2949            20  PD-RECURRING-YN      PIC X.
  2950            20  FILLER               PIC X.
  2951        16  PD-RTW-MOS               PIC 99.
  2952        16  PD-MAX-EXTENSION         PIC 99.
  2953        16  pd-ben-pct               pic sv999 comp-3.
  2954*       16  FILLER                   PIC XX.
  2955    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2956    12  PD-TERM-LIMITS OCCURS 15.
  2957        16  PD-LOW-TERM              PIC S999        COMP-3.
  2958        16  PD-HI-TERM               PIC S999        COMP-3.
  2959*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2960    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2961        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2962        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2963    12  PD-EARN-FACTORS.
  2964        16  FILLER OCCURS 15.
  2965            20  FILLER OCCURS 15.
  2966                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2967    12  PD-PRODUCT-DESC              PIC X(80).
  2968    12  PD-TRUNCATED                 PIC X.
  2969    12  FILLER                       PIC X(59).
  2970    12  PD-MAINT-INFORMATION.
  2971        16  PD-LAST-MAINT-DT         PIC X(02).
  2972        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2973        16  PD-LAST-MAINT-BY         PIC X(04).
  2974*                                COPY ELCSTATE.
  2975******************************************************************
  2976*                                                                *
  2977*                                                                *
  2978*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  56
* EL050.cbl
  2979*                                                                *
  2980*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2981*                                                                *
  2982*   FILE TYPE = VSAM,KSDS                                        *
  2983*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2984*                                                                *
  2985*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2986*       ALTERNATE INDEX = NONE                                   *
  2987*                                                                *
  2988*   LOG = YES                                                    *
  2989*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2990******************************************************************
  2991*                   C H A N G E   L O G
  2992*
  2993* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2994*-----------------------------------------------------------------
  2995*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2996* EFFECTIVE    NUMBER
  2997*-----------------------------------------------------------------
  2998* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2999******************************************************************
  3000*
  3001 01  STATE-FILE.
  3002     12  SF-RECORD-ID                       PIC XX.
  3003         88  VALID-CF-ID                        VALUE 'SF'.
  3004     12  SF-CONTROL-PRIMARY.
  3005         16  SF-COMPANY-ID                  PIC XXX.
  3006         16  SF-CARRIER-CODE                PIC X.
  3007         16  SF-GROUPING                    PIC X(6).
  3008         16  SF-STATE-CODE                  PIC XX.
  3009         16  SF-EXPIRE-DATE                 PIC 9(8).
  3010****************************************************************
  3011*             STATE CONTROLS
  3012****************************************************************
  3013     12  SF-LAST-MAINT-DT                   PIC XX.
  3014     12  SF-LAST-MAINT-BY                   PIC X(4).
  3015     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3016     12  SF-STATE-RT-CONTROLS.
  3017         16  SF-ST-RT-CALC                  PIC X.
  3018     12  SF-ST-TAX-CONTROLS.
  3019         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3020         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3021         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3022     12  SF-ST-REFUND-OPTIONS.
  3023         16  SF-ST-RF-LR-CALC               PIC X.
  3024         16  SF-ST-RF-LL-CALC               PIC X.
  3025         16  SF-ST-RF-LN-CALC               PIC X.
  3026         16  SF-ST-RF-AH-CALC               PIC X.
  3027         16  SF-ST-RF-CP-CALC               PIC X.
  3028     12  SF-ST-UNEARN-PREM-OPTIONS.
  3029         16  SF-ST-LUEP-R78                 PIC X.
  3030         16  SF-ST-LUEP-PRO                 PIC X.
  3031         16  SF-ST-LUEP-ST                  PIC X.
  3032         16  SF-ST-LUEP-DOM                 PIC X.
  3033         16  SF-ST-AUEP-R78                 PIC X.
  3034         16  SF-ST-AUEP-PRO                 PIC X.
  3035         16  SF-ST-AUEP-ST                  PIC X.
  3036         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  57
* EL050.cbl
  3037         16  SF-ST-CUEP-R78                 PIC X.
  3038         16  SF-ST-CUEP-PRO                 PIC X.
  3039         16  SF-ST-CUEP-ST                  PIC X.
  3040         16  SF-ST-CUEP-DOM                 PIC X.
  3041     12  SF-ST-EARN-PREM-OPTIONS.
  3042         16  SF-ST-LEP-R78                  PIC X.
  3043         16  SF-ST-LEP-PRO                  PIC X.
  3044         16  SF-ST-LEP-ST                   PIC X.
  3045         16  SF-ST-LEP-DOM                  PIC X.
  3046         16  SF-ST-AEP-R78                  PIC X.
  3047         16  SF-ST-AEP-PRO                  PIC X.
  3048         16  SF-ST-AEP-ST                   PIC X.
  3049         16  SF-ST-AEP-DOM                  PIC X.
  3050         16  SF-ST-CEP-R78                  PIC X.
  3051         16  SF-ST-CEP-PRO                  PIC X.
  3052         16  SF-ST-CEP-ST                   PIC X.
  3053         16  SF-ST-CEP-DOM                  PIC X.
  3054     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  58
* EL050.cbl
  3056*    COPY ELCCRTT.
  3057******************************************************************
  3058*                                                                *
  3059*                            ELCCRTT.                            *
  3060*                                                                *
  3061*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3062*                                                                *
  3063*   FILE TYPE = VSAM,KSDS                                        *
  3064*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3065*                                                                *
  3066*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3067*                                                                *
  3068*   LOG = YES                                                    *
  3069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3070******************************************************************
  3071*                   C H A N G E   L O G
  3072*
  3073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3074*-----------------------------------------------------------------
  3075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3076* EFFECTIVE    NUMBER
  3077*-----------------------------------------------------------------
  3078* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3079* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3080* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3081* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3082* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3083* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3084* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3085* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3086* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3087* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3088* 091318  CR2018073000001  PEMA  ADD Refund methods
  3089* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3090******************************************************************
  3091
  3092 01  CERTIFICATE-TRAILERS.
  3093     12  CS-RECORD-ID                      PIC XX.
  3094         88  VALID-CS-ID                      VALUE 'CS'.
  3095
  3096     12  CS-CONTROL-PRIMARY.
  3097         16  CS-COMPANY-CD                 PIC X.
  3098         16  CS-CARRIER                    PIC X.
  3099         16  CS-GROUPING                   PIC X(6).
  3100         16  CS-STATE                      PIC XX.
  3101         16  CS-ACCOUNT                    PIC X(10).
  3102         16  CS-CERT-EFF-DT                PIC XX.
  3103         16  CS-CERT-NO.
  3104             20  CS-CERT-PRIME             PIC X(10).
  3105             20  CS-CERT-SFX               PIC X.
  3106         16  CS-TRAILER-TYPE               PIC X.
  3107             88  COMM-TRLR           VALUE 'A'.
  3108             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3109             88  CERT-DATA-TRLR      VALUE 'C'.
  3110
  3111     12  CS-DATA-AREA                      PIC X(516).
  3112
  3113     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  59
* EL050.cbl
  3114         16  CS-BANK-COMMISSION-AREA.
  3115             20  CS-BANK-COMMS       OCCURS 10.
  3116                 24  CS-AGT                PIC X(10).
  3117                 24  CS-COM-TYP            PIC X.
  3118                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3119                 24  CS-RECALC-LV-INDIC    PIC X.
  3120                 24  FILLER                PIC X(10).
  3121         16  FILLER                        PIC X(256).
  3122
  3123     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3124****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3125         16  CS-MB-CLAIM-DATA OCCURS 24.
  3126             20  CS-CLAIM-NO               PIC X(7).
  3127             20  CS-CLAIM-TYPE             PIC X.
  3128                 88  CS-AH-CLM               VALUE 'A'.
  3129                 88  CS-IU-CLM               VALUE 'I'.
  3130                 88  CS-GP-CLM               VALUE 'G'.
  3131                 88  CS-LF-CLM               VALUE 'L'.
  3132                 88  CS-PR-CLM               VALUE 'P'.
  3133                 88  CS-FL-CLM               VALUE 'F'.
  3134                 88  CS-OT-CLM               VALUE 'O'.
  3135             20  CS-INSURED-TYPE           PIC X.
  3136                 88  CS-PRIM-INSURED          VALUE 'P'.
  3137                 88  CS-CO-BORROWER           VALUE 'C'.
  3138             20  CS-BENEFIT-PERIOD         PIC 99.
  3139             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3140             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3141             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3142         16  FILLER                        PIC X(12).
  3143     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3144         16  CS-VIN-NUMBER                 PIC X(17).
  3145         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3146         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3147         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3148         16  cs-agent-name.
  3149             20  cs-agent-fname            pic x(20).
  3150             20  cs-agent-mi               pic x.
  3151             20  cs-agent-lname            pic x(25).
  3152         16  cs-license-no                 pic x(15).
  3153         16  cs-npn-number                 pic x(10).
  3154         16  cs-agent-edit-status          pic x.
  3155             88  cs-ae-refer-to-manager      value 'M'.
  3156             88  cs-ae-cover-sheet           value 'C'.
  3157             88  cs-ae-sig-form              value 'S'.
  3158             88  cs-ae-verified              value 'V'.
  3159             88  cs-unidentified-signature   value 'U'.
  3160             88  cs-cert-returned            value 'R'.
  3161             88  cs-accept-no-commission     value 'N'.
  3162         16  cs-year                       pic 9999.
  3163         16  cs-make                       pic x(20).
  3164         16  cs-model                      pic x(20).
  3165         16  cs-future                     pic x(20).
  3166         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3167         16  cs-claim-verification-status  pic x.
  3168             88  cs-clm-ver-eligible         value 'A'.
  3169             88  cs-clm-ver-partial-elig     value 'B'.
  3170             88  cs-clm-ver-not-eligible     value 'C'.
  3171             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  60
* EL050.cbl
  3172             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3173             88  cs-clm-ver-ND-CERT          value 'F'.
  3174             88  cs-clm-ver-spec-other       value 'G'.
  3175             88  cs-clam-ver-pratial-corrected
  3176                                             value 'H'.
  3177             88  cs-clm-ver-no-matches       value 'I'.
  3178             88  cs-clm-ver-not-elig-corrected
  3179                                             value 'J'.
  3180             88  cs-clm-ver-needs-review     value 'R'.
  3181             88  cs-clm-ver-sent-to-claims   value 'W'.
  3182         16  CS-LF-REFUND-METHOD           PIC X.
  3183         16  CS-AH-REFUND-METHOD           PIC X.
  3184         16  FILLER                        PIC X(353). *> was 420
  3185*        16  FILLER                        PIC X(496).
  3186*    COPY ELCCRTO.
  3187******************************************************************
  3188*                                                                *
  3189*                            ELCCRTO.                            *
  3190*                                                                *
  3191*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3192*                                                                *
  3193*   FILE TYPE = VSAM,KSDS                                        *
  3194*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3195*                                                                *
  3196*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3197*                                                                *
  3198*   LOG = YES                                                    *
  3199*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3200******************************************************************
  3201*                   C H A N G E   L O G
  3202*
  3203* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3204*-----------------------------------------------------------------
  3205*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3206* EFFECTIVE    NUMBER
  3207*-----------------------------------------------------------------
  3208* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3209* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3210* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3211* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3212* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3213******************************************************************
  3214 01  ORIGINAL-CERTIFICATE.
  3215     12  OC-RECORD-ID                      PIC XX.
  3216         88  VALID-OC-ID                      VALUE 'OC'.
  3217     12  OC-CONTROL-PRIMARY.
  3218         16  OC-COMPANY-CD                 PIC X.
  3219         16  OC-CARRIER                    PIC X.
  3220         16  OC-GROUPING                   PIC X(6).
  3221         16  OC-STATE                      PIC XX.
  3222         16  OC-ACCOUNT                    PIC X(10).
  3223         16  OC-CERT-EFF-DT                PIC XX.
  3224         16  OC-CERT-NO.
  3225             20  OC-CERT-PRIME             PIC X(10).
  3226             20  OC-CERT-SFX               PIC X.
  3227         16  OC-RECORD-TYPE                PIC X.
  3228         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3229     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  61
* EL050.cbl
  3230     12  OC-LAST-MAINT-BY                  PIC X(4).
  3231     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3232     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3233     12  FILLER                            PIC X(49).
  3234     12  OC-ORIG-REC.
  3235         16  OC-INS-LAST-NAME              PIC X(15).
  3236         16  OC-INS-FIRST-NAME             PIC X(10).
  3237         16  OC-INS-MIDDLE-INIT            PIC X.
  3238         16  OC-INS-AGE                    PIC S999     COMP-3.
  3239         16  OC-JNT-LAST-NAME              PIC X(15).
  3240         16  OC-JNT-FIRST-NAME             PIC X(10).
  3241         16  OC-JNT-MIDDLE-INIT            PIC X.
  3242         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3243         16  OC-LF-BENCD                   PIC XX.
  3244         16  OC-LF-TERM                    PIC S999      COMP-3.
  3245         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3246         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3247         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3248         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3249         16  OC-LF-EXP-DT                  PIC XX.
  3250         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3251         16  OC-LF-CANCEL-DT               PIC XX.
  3252         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3253         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3254         16  OC-AH-BENCD                   PIC XX.
  3255         16  OC-AH-TERM                    PIC S999      COMP-3.
  3256         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3257         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3258         16  OC-AH-EXP-DT                  PIC XX.
  3259         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3260         16  OC-AH-CP                      PIC 99.
  3261         16  OC-AH-CANCEL-DT               PIC XX.
  3262         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3263         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3264         16  OC-CRED-BENE-NAME             PIC X(25).
  3265         16  OC-1ST-PMT-DT                 PIC XX.
  3266         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3267         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3268         16  OC-ISSUE-TRAN-IND             PIC X.
  3269         16  OC-CANCEL-TRAN-IND            PIC X.
  3270         16  FILLER                        PIC X(211).
  3271
  3272     12  FILLER                            PIC X(50).
  3273******************************************************************
  3274
  3275*    COPY ELCDATE.
  3276******************************************************************
  3277*                                                                *
  3278*                                                                *
  3279*                            ELCDATE.                            *
  3280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3281*                            VMOD=2.003
  3282*                                                                *
  3283*                                                                *
  3284*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3285*                 LENGTH = 200                                   *
  3286******************************************************************
  3287
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  62
* EL050.cbl
  3288 01  DATE-CONVERSION-DATA.
  3289     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3290     12  DC-OPTION-CODE                PIC X.
  3291         88  BIN-TO-GREG                VALUE ' '.
  3292         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3293         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3294         88  YMD-GREG-TO-BIN            VALUE '3'.
  3295         88  MDY-GREG-TO-BIN            VALUE '4'.
  3296         88  JULIAN-TO-BIN              VALUE '5'.
  3297         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3298         88  FIND-CENTURY               VALUE '7'.
  3299         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3300         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3301         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3302         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3303         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3304         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3305         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3306         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3307         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3308         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3309         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3310         88  BIN-3-TO-GREG              VALUE 'I'.
  3311         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3312         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3313         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3314         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3315         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3316         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3317         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3318         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3319         88  THREE-CHARACTER-BIN
  3320                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3321         88  GREGORIAN-TO-BIN
  3322                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3323         88  BIN-TO-GREGORIAN
  3324                  VALUES ' ' '1' 'I' '8' 'G'.
  3325         88  JULIAN-TO-BINARY
  3326                  VALUES '5' 'C' 'E' 'F'.
  3327     12  DC-ERROR-CODE                 PIC X.
  3328         88  NO-CONVERSION-ERROR        VALUE ' '.
  3329         88  DATE-CONVERSION-ERROR
  3330                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3331         88  DATE-IS-ZERO               VALUE '1'.
  3332         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3333         88  DATE-IS-INVALID            VALUE '3'.
  3334         88  DATE1-GREATER-DATE2        VALUE '4'.
  3335         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3336         88  DATE-INVALID-OPTION        VALUE '9'.
  3337         88  INVALID-CENTURY            VALUE 'A'.
  3338         88  ONLY-CENTURY               VALUE 'B'.
  3339         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3340         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3341     12  DC-END-OF-MONTH               PIC X.
  3342         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3343     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3344         88  USE-NORMAL-PROCESS         VALUE ' '.
  3345         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  63
* EL050.cbl
  3346         88  ADJUST-UP-100-YRS          VALUE '2'.
  3347     12  FILLER                        PIC X.
  3348     12  DC-CONVERSION-DATES.
  3349         16  DC-BIN-DATE-1             PIC XX.
  3350         16  DC-BIN-DATE-2             PIC XX.
  3351         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3352         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3353                       DC-GREG-DATE-1-EDIT.
  3354             20  DC-EDIT1-MONTH        PIC 99.
  3355             20  SLASH1-1              PIC X.
  3356             20  DC-EDIT1-DAY          PIC 99.
  3357             20  SLASH1-2              PIC X.
  3358             20  DC-EDIT1-YEAR         PIC 99.
  3359         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3360         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3361                     DC-GREG-DATE-2-EDIT.
  3362             20  DC-EDIT2-MONTH        PIC 99.
  3363             20  SLASH2-1              PIC X.
  3364             20  DC-EDIT2-DAY          PIC 99.
  3365             20  SLASH2-2              PIC X.
  3366             20  DC-EDIT2-YEAR         PIC 99.
  3367         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3368         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3369                     DC-GREG-DATE-1-YMD.
  3370             20  DC-YMD-YEAR           PIC 99.
  3371             20  DC-YMD-MONTH          PIC 99.
  3372             20  DC-YMD-DAY            PIC 99.
  3373         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3374         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3375                      DC-GREG-DATE-1-MDY.
  3376             20  DC-MDY-MONTH          PIC 99.
  3377             20  DC-MDY-DAY            PIC 99.
  3378             20  DC-MDY-YEAR           PIC 99.
  3379         16  DC-GREG-DATE-1-ALPHA.
  3380             20  DC-ALPHA-MONTH        PIC X(10).
  3381             20  DC-ALPHA-DAY          PIC 99.
  3382             20  FILLER                PIC XX.
  3383             20  DC-ALPHA-CENTURY.
  3384                 24 DC-ALPHA-CEN-N     PIC 99.
  3385             20  DC-ALPHA-YEAR         PIC 99.
  3386         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3387         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3388         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3389         16  DC-JULIAN-DATE            PIC 9(05).
  3390         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3391                                       PIC 9(05).
  3392         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3393             20  DC-JULIAN-YEAR        PIC 99.
  3394             20  DC-JULIAN-DAYS        PIC 999.
  3395         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3396         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3397         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3398     12  DATE-CONVERSION-VARIBLES.
  3399         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3400         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3401             20  FILLER                PIC 9(3).
  3402             20  HOLD-CEN-1-CCYY.
  3403                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  64
* EL050.cbl
  3404                 24  HOLD-CEN-1-YY     PIC 99.
  3405             20  HOLD-CEN-1-MO         PIC 99.
  3406             20  HOLD-CEN-1-DA         PIC 99.
  3407         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3408             20  HOLD-CEN-1-R-MO       PIC 99.
  3409             20  HOLD-CEN-1-R-DA       PIC 99.
  3410             20  HOLD-CEN-1-R-CCYY.
  3411                 24  HOLD-CEN-1-R-CC   PIC 99.
  3412                 24  HOLD-CEN-1-R-YY   PIC 99.
  3413             20  FILLER                PIC 9(3).
  3414         16  HOLD-CENTURY-1-X.
  3415             20  FILLER                PIC X(3)  VALUE SPACES.
  3416             20  HOLD-CEN-1-X-CCYY.
  3417                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3418                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3419             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3420             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3421         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3422             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3423             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3424             20  HOLD-CEN-1-R-X-CCYY.
  3425                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3426                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3427             20  FILLER                PIC XXX.
  3428         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3429         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3430         16  DC-JULIAN-DATE-1          PIC 9(07).
  3431         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3432             20  DC-JULIAN-1-CCYY.
  3433                 24  DC-JULIAN-1-CC    PIC 99.
  3434                 24  DC-JULIAN-1-YR    PIC 99.
  3435             20  DC-JULIAN-DA-1        PIC 999.
  3436         16  DC-JULIAN-DATE-2          PIC 9(07).
  3437         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3438             20  DC-JULIAN-2-CCYY.
  3439                 24  DC-JULIAN-2-CC    PIC 99.
  3440                 24  DC-JULIAN-2-YR    PIC 99.
  3441             20  DC-JULIAN-DA-2        PIC 999.
  3442         16  DC-GREG-DATE-A-EDIT.
  3443             20  DC-EDITA-MONTH        PIC 99.
  3444             20  SLASHA-1              PIC X VALUE '/'.
  3445             20  DC-EDITA-DAY          PIC 99.
  3446             20  SLASHA-2              PIC X VALUE '/'.
  3447             20  DC-EDITA-CCYY.
  3448                 24  DC-EDITA-CENT     PIC 99.
  3449                 24  DC-EDITA-YEAR     PIC 99.
  3450         16  DC-GREG-DATE-B-EDIT.
  3451             20  DC-EDITB-MONTH        PIC 99.
  3452             20  SLASHB-1              PIC X VALUE '/'.
  3453             20  DC-EDITB-DAY          PIC 99.
  3454             20  SLASHB-2              PIC X VALUE '/'.
  3455             20  DC-EDITB-CCYY.
  3456                 24  DC-EDITB-CENT     PIC 99.
  3457                 24  DC-EDITB-YEAR     PIC 99.
  3458         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3459         16  DC-GREG-DATE-CYMD-R REDEFINES
  3460                              DC-GREG-DATE-CYMD.
  3461             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  65
* EL050.cbl
  3462             20  DC-CYMD-YEAR          PIC 99.
  3463             20  DC-CYMD-MONTH         PIC 99.
  3464             20  DC-CYMD-DAY           PIC 99.
  3465         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3466         16  DC-GREG-DATE-MDCY-R REDEFINES
  3467                              DC-GREG-DATE-MDCY.
  3468             20  DC-MDCY-MONTH         PIC 99.
  3469             20  DC-MDCY-DAY           PIC 99.
  3470             20  DC-MDCY-CEN           PIC 99.
  3471             20  DC-MDCY-YEAR          PIC 99.
  3472    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3473        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3474    12  DC-EL310-DATE                  PIC X(21).
  3475    12  FILLER                         PIC X(28).
  3476
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  66
* EL050.cbl
  3478*    COPY ELCCALC.
  3479******************************************************************
  3480*                                                                *
  3481*                           ELCCALC.                            *
  3482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3483*                            VMOD=2.025                          *
  3484*                                                                *
  3485*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3486*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3487*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3488*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3489*                                                                *
  3490*  PASSED TO ELRTRM                                              *
  3491*  -----------------                                             *
  3492*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3493*  ORIGINAL TERM                                                 *
  3494*  BEGINNING DATE                                                *
  3495*  ENDING DATE                                                   *
  3496*  COMPANY I.D.                                                  *
  3497*  ACCOUNT MASTER USER FIELD                                     *
  3498*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3499*  FREE LOOK DAYS                                                *
  3500*                                                                *
  3501*  RETURNED FROM ELRTRM                                          *
  3502*  ---------------------                                         *
  3503*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3504*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3505*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3506*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3507*----------------------------------------------------------------*
  3508*  PASSED TO ELRAMT                                              *
  3509*  ----------------                                              *
  3510*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3511*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3512*  ORIGINAL AMOUNT                                               *
  3513*  ALTERNATE BENEFIT (BALLON)                                    *
  3514*  A.P.R. - NET PAY ONLY                                         *
  3515*  METHOD
  3516*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3517*  COMPANY I.D.                                                  *
  3518*  BENEFIT TYPE                                                  *
  3519*                                                                *
  3520*  RETURNED FROM ELRAMT                                          *
  3521*  --------------------                                          *
  3522*  REMAINING AMOUNT 1 - CURRENT                                  *
  3523*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3524*  REMAINING AMOUNT FACTOR
  3525*----------------------------------------------------------------*
  3526*  PASSED TO ELRESV                                              *
  3527*  -----------------                                             *
  3528*  CERTIFICATE EFFECTIVE DATE                                    *
  3529*  VALUATION DATE                                                *
  3530*  PAID THRU DATE                                                *
  3531*  BENEFIT                                                       *
  3532*  INCURRED DATE                                                 *
  3533*  REPORTED DATE                                                 *
  3534*  ISSUE AGE                                                     *
  3535*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  67
* EL050.cbl
  3536*  CDT PERCENT                                                   *
  3537*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3538* *CLAIM TYPE (LIFE, A/H)                                        *
  3539* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3540* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3541*                                                                *
  3542*  RETURNED FROM ELRESV                                          *
  3543*  --------------------                                          *
  3544*  CDT TABLE USED                                                *
  3545*  CDT FACTOR USED                                               *
  3546*  PAY TO CURRENT RESERVE                                        *
  3547*  I.B.N.R. - A/H ONLY                                           *
  3548*  FUTURE (ACCRUED) AH ONLY                                      *
  3549*----------------------------------------------------------------*
  3550*  PASSED TO ELRATE                                              *
  3551*  ----------------                                              *
  3552*  CERT ISSUE DATE                                               *
  3553*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3554*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3555*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3556*  STATE CODE (CLIENT DEFINED)                                   *
  3557*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3558*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3559*  DEVIATION CODE                                                *
  3560*  ISSUE AGE                                                     *
  3561*  ORIGINAL BENEFIT AMOUNT                                       *
  3562*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3563*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3564*  BENEFIT KIND (LIFE OR A/H)                                    *
  3565*  A.P.R.                                                        *
  3566*  METHOD
  3567*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3568*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3569*  COMPANY I.D. (3 CHARACTER)                                    *
  3570*  BENEFIT CODE                                                  *
  3571*  BENEFIT OVERRIDE CODE                                         *
  3572*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3573*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3574*  JOINT INDICATOR (CSL ONLY)                                    *
  3575*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3576*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3577*                                                                *
  3578*  RETURNED FROM ELRATE                                          *
  3579*  --------------------                                          *
  3580*  CALCULATED PREMIUM                                            *
  3581*  PREMIUM RATE                                                  *
  3582*  MORTALITY CODE                                                *
  3583*  MAX ATTAINED AGE                                              *
  3584*  MAX AGE                                                       *
  3585*  MAX TERM                                                      *
  3586*  MAX MONTHLY BENEFIT                                           *
  3587*  MAX TOTAL BENIFIT                                             *
  3588*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3589*----------------------------------------------------------------*
  3590*  PASSED TO ELRFND                                              *
  3591*  ----------------                                              *
  3592*  CERT ISSUE DATE                                               *
  3593*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  68
* EL050.cbl
  3594*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3595*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3596*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3597*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3598*  STATE CODE (CLIENT DEFINED)                                   *
  3599*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3600*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3601*  DEVIATION CODE                                                *
  3602*  ISSUE AGE                                                     *
  3603*  ORIGINAL BENEFIT AMOUNT                                       *
  3604*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3605*  PROCESS TYPE (CANCEL)                                         *
  3606*  BENEFIT KIND (LIFE OR A/H)                                    *
  3607*  A.P.R.                                                        *
  3608*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3609*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3610*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3611*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3612*  COMPANY I.D. (3 CHARACTER)                                    *
  3613*  BENEFIT CODE                                                  *
  3614*  BENEFIT OVERRIDE CODE                                         *
  3615*                                                                *
  3616*  RETURNED FROM ELRFND                                          *
  3617*  --------------------                                          *
  3618*  CALCULATED REFUND                                             *
  3619*----------------------------------------------------------------*
  3620*  PASSED TO ELEARN                                              *
  3621*  ----------------                                              *
  3622*  CERT ISSUE DATE                                               *
  3623*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3624*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3625*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3626*  STATE CODE (CLIENT DEFINED)                                   *
  3627*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3628*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3629*  DEVIATION CODE                                                *
  3630*  ISSUE AGE                                                     *
  3631*  ORIGINAL BENEFIT AMOUNT                                       *
  3632*  BENEFIT KIND (LIFE OR A/H)                                    *
  3633*  A.P.R.                                                        *
  3634*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3635*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3636*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3637*  COMPANY I.D. (3 CHARACTER)                                    *
  3638*  BENEFIT CODE                                                  *
  3639*  BENEFIT OVERRIDE CODE                                         *
  3640*                                                                *
  3641*  RETURNED FROM ELEARN                                          *
  3642*  --------------------                                          *
  3643*  INDICATED  EARNINGS                                           *
  3644*----------------------------------------------------------------*
  3645*                 LENGTH = 450                                   *
  3646*                                                                *
  3647******************************************************************
  3648******************************************************************
  3649*                   C H A N G E   L O G
  3650*
  3651* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  69
* EL050.cbl
  3652*-----------------------------------------------------------------
  3653*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3654* EFFECTIVE    NUMBER
  3655*-----------------------------------------------------------------
  3656* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3657* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3658* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3659* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3660* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3661* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3662* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3663* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3664* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3665* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3666* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3667******************************************************************
  3668
  3669 01  CALCULATION-PASS-AREA.
  3670     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3671                                     COMP.
  3672
  3673     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3674       88  NO-CP-ERROR                             VALUE ZERO.
  3675       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3676                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3677       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3678       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3679       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3680       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3681       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3682       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3683       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3684       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3685       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3686       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3687       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3688       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3689       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3690       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3691       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3692       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3693       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3694
  3695     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3696       88  NO-CP-ERROR-2                           VALUE ZERO.
  3697***********************  INPUT AREAS ****************************
  3698
  3699     12  CP-CALCULATION-AREA.
  3700         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3701         16  CP-CERT-EFF-DT        PIC XX.
  3702         16  CP-VALUATION-DT       PIC XX.
  3703         16  CP-PAID-THRU-DT       PIC XX.
  3704         16  CP-BENEFIT-TYPE       PIC X.
  3705           88  CP-AH                               VALUE 'A' 'D'
  3706                                                   'I' 'U'.
  3707           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3708           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3709         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  70
* EL050.cbl
  3710         16  CP-REPORTED-DT        PIC XX.
  3711         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3712         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3713         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-CDT-METHOD         PIC X.
  3718           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3719           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3720           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3721         16  CP-CLAIM-TYPE         PIC X.
  3722           88  CP-AH-CLAIM                         VALUE 'A'.
  3723           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3724         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-REM-TERM-METHOD    PIC X.
  3739           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3740           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3741           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3742           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3743           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3744           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3745           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3746         16  CP-EARNING-METHOD     PIC X.
  3747           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3748           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3749           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3750           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3751           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3752           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3753           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3754           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3755           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3756           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3757           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3758           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3759           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3760           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3761         16  CP-PROCESS-TYPE       PIC X.
  3762           88  CP-CLAIM                            VALUE '1'.
  3763           88  CP-CANCEL                           VALUE '2'.
  3764           88  CP-ISSUE                            VALUE '3'.
  3765         16  CP-SPECIAL-CALC-CD    PIC X.
  3766           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3767           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  71
* EL050.cbl
  3768           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3769           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3770           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3771           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3772           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3773           88  CP-FARM-PLAN                    VALUE 'F'.
  3774           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3775           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3776           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3777           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3778           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3779           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3780           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3781           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3782           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3783           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3784                                                     'W' 'X'.
  3785           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3786           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3787           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3788           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3789           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3790           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3791           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3792           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3793           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3794           88  CP-CSL-METH-1                   VALUE '5'.
  3795           88  CP-CSL-METH-2                   VALUE '6'.
  3796           88  CP-CSL-METH-3                   VALUE '7'.
  3797           88  CP-CSL-METH-4                   VALUE '8'.
  3798
  3799         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3802         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3803         16  CP-STATE              PIC XX          VALUE SPACE.
  3804         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3805         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3806           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3807               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3808         16  CP-R78-OPTION         PIC X.
  3809           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3810           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3811
  3812         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3813         16  CP-IBNR-RESERVE-SW    PIC X.
  3814         16  CP-CLAIM-STATUS       PIC X.
  3815         16  CP-RATE-FILE          PIC X.
  3816         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3817                                     COMP-3.
  3818
  3819         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3820         16  CP-AH-OVERRIDE-CODE   PIC X.
  3821
  3822         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3825                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  72
* EL050.cbl
  3826         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3833                                  PIC S9(7)V99 COMP-3.
  3834
  3835         16  CP-PAID-FROM-DATE     PIC X(02).
  3836         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3837         16  CP-EXT-DAYS-CALC      PIC X.
  3838           88  CP-EXT-NO-CHG                   VALUE ' '.
  3839           88  CP-EXT-CHG-LF                   VALUE '1'.
  3840           88  CP-EXT-CHG-AH                   VALUE '2'.
  3841           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3842         16  CP-DOMICILE-STATE     PIC XX.
  3843         16  CP-CARRIER            PIC X.
  3844         16  CP-REIN-FLAG          PIC X.
  3845         16  CP-REM-TRM-CALC-OPTION PIC X.
  3846           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3847                      '2' '3' '4' '5'.
  3848           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3849           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3850           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3851           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3852           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3853           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3854           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3855           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3856         16  CP-SIG-SWITCH         PIC X.
  3857         16  CP-RATING-METHOD      PIC X.
  3858           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3859           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3860           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3861           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3862           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3863           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3864           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3865           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3866           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3867         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3868                                     COMP-3.
  3869         16  CP-BEN-CATEGORY       PIC X.
  3870         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3871         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3872                                   PIC S99V9(5) COMP-3.
  3873         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3874         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3875                                   PIC S99V9(5) COMP-3.
  3876         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3877         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3878         16  CP-EXPIRE-DT          PIC XX.
  3879         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3880         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3881         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3882         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3883         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  73
* EL050.cbl
  3884             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3885             88  CP-CALC-CLP              VALUE 'C'.
  3886         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3887         16  CP-CANCEL-REASON      PIC X.
  3888         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3889         16  CP-PMT-MODE           PIC X.
  3890         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3891         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3892         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3893         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3894         16  FILLER                PIC X.
  3895
  3896***************    OUTPUT FROM ELRESV   ************************
  3897
  3898         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3899
  3900         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3901                                     COMP-3.
  3902         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3903                                     COMP-3.
  3904         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3905                                     COMP-3.
  3906         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  FILLER                PIC X(09).
  3909***************    OUTPUT FROM ELRTRM   *************************
  3910
  3911         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3914                                     COMP-3.
  3915         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3916                                     COMP-3.
  3917         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3918                                     COMP-3.
  3919         16  FILLER                PIC X(12).
  3920
  3921***************    OUTPUT FROM ELRAMT   *************************
  3922
  3923         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3924                                     COMP-3.
  3925         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3926                                     COMP-3.
  3927         16  FILLER                PIC X(12).
  3928
  3929***************    OUTPUT FROM ELRATE   *************************
  3930
  3931         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3932                                     COMP-3.
  3933         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3934                                     COMP-3.
  3935         16  CP-MORTALITY-CODE     PIC X(4).
  3936         16  CP-RATE-EDIT-FLAG     PIC X.
  3937             88  CP-RATES-NEED-APR                  VALUE '1'.
  3938         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3941         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  74
* EL050.cbl
  3942         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3943                                   PIC S9(7)V99 COMP-3.
  3944         16  FILLER                PIC X(07).
  3945
  3946***************    OUTPUT FROM ELRFND   *************************
  3947
  3948         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3949                                     COMP-3.
  3950         16  CP-REFUND-TYPE-USED   PIC X.
  3951           88  CP-R-AS-R78                         VALUE '1'.
  3952           88  CP-R-AS-PRORATA                     VALUE '2'.
  3953           88  CP-R-AS-CALIF                       VALUE '3'.
  3954           88  CP-R-AS-TEXAS                       VALUE '4'.
  3955           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3956           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3957           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3958           88  CP-R-AS-MEAN                        VALUE '8'.
  3959           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3960           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3961           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3962           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3963           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3964           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3965         16  FILLER                PIC X(12).
  3966
  3967***************    OUTPUT FROM ELEARN   *************************
  3968
  3969         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3970                                     COMP-3.
  3971         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3972                                     COMP-3.
  3973         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3974                                     COMP-3.
  3975         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3976                                     COMP-3.
  3977         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3978                                     COMP-3.
  3979         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3980                                     COMP-3.
  3981         16  CP-EARNING-TYPE-USED  PIC X.
  3982           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3983           88  CP-E-AS-R78                         VALUE '1'.
  3984           88  CP-E-AS-PRORATA                     VALUE '2'.
  3985           88  CP-E-AS-TEXAS                       VALUE '4'.
  3986           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3987           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3988           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3989           88  CP-E-AS-MEAN                        VALUE '8'.
  3990           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3991         16  FILLER                PIC X(12).
  3992
  3993***************    OUTPUT FROM ELPMNT   *************************
  3994
  3995         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3996                                     COMP-3.
  3997         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3998                                     COMP-3.
  3999         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  75
* EL050.cbl
  4000
  4001***************   MISC WORK AREAS    *****************************
  4002         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4003                                     COMP-3.
  4004         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4005                                     COMP-3.
  4006         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4007                                     COMP-3.
  4008         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4009                                     COMP-3.
  4010         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4011                                     COMP-3.
  4012         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4013                                     COMP-3.
  4014         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4015             88  OPEN-RATE-FILE                   VALUE 'O'.
  4016             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4017             88  IO-ERROR                         VALUE 'E'.
  4018
  4019         16  CP-FIRST-PAY-DATE     PIC XX.
  4020
  4021         16  CP-JOINT-INDICATOR    PIC X.
  4022
  4023         16  CP-RESERVE-REMAINING-TERM
  4024                                   PIC S9(4)V9    VALUE ZERO
  4025                                     COMP-3.
  4026
  4027         16  CP-INSURED-BIRTH-DT   PIC XX.
  4028
  4029         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4030                                     COMP-3.
  4031
  4032         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4033                                     COMP-3.
  4034
  4035         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4036                                     COMP-3.
  4037
  4038         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4039                                     COMP-3.
  4040
  4041         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4042                                     COMP-3.
  4043
  4044         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4045                                     COMP-3.
  4046
  4047         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4048                                     COMP-3.
  4049
  4050         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4051             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4052
  4053         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4054                                     COMP-3.
  4055         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4056                                     COMP-3.
  4057         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  76
* EL050.cbl
  4058         16  cp-extra-periods      pic 9 value zeros.
  4059         16  cp-net-only-state     pic x value spaces.
  4060         16  FILLER                PIC X(13).
  4061******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  77
* EL050.cbl
  4063******************************************************************
  4064*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4065*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4066*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4067*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4068*** MODIFICATION.                                              ***
  4069*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4070*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4071******************************************************************
  4072*    COPY ERCPNDB.
  4073******************************************************************
  4074*                                                                *
  4075*                                                                *
  4076*                            ERCPNDB.                            *
  4077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4078*                            VMOD=2.025                          *
  4079*                                                                *
  4080*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4081*                                                                *
  4082******************************************************************
  4083*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4084*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4085******************************************************************
  4086*                                                                *
  4087*                                                                *
  4088*   FILE TYPE = VSAM,KSDS                                        *
  4089*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4090*                                                                *
  4091*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4092*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4093*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4094*                                                 RKP=13,LEN=36  *
  4095*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4096*                                      AND CHG-SEQ.)             *
  4097*                                                RKP=49,LEN=11   *
  4098*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4099*                                      AND CHG-SEQ.)             *
  4100*                                                RKP=60,LEN=15   *
  4101*                                                                *
  4102*   LOG = NO                                                     *
  4103*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4104******************************************************************
  4105******************************************************************
  4106*                   C H A N G E   L O G
  4107*
  4108* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4109*-----------------------------------------------------------------
  4110*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4111* EFFECTIVE    NUMBER
  4112*-----------------------------------------------------------------
  4113* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4114* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4115* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4116* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4117* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4118* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4119* 032306                   PEMA  ADD BOW LOAN NUMBER
  4120* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  78
* EL050.cbl
  4121* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4122* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4123* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4124* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4125* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4127* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4128* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4129* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4130* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4131* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4132******************************************************************
  4133
  4134 01  PENDING-BUSINESS.
  4135     12  PB-RECORD-ID                     PIC XX.
  4136         88  VALID-PB-ID                        VALUE 'PB'.
  4137
  4138     12  PB-CONTROL-PRIMARY.
  4139         16  PB-COMPANY-CD                PIC X.
  4140         16  PB-ENTRY-BATCH               PIC X(6).
  4141         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4142         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4143
  4144     12  PB-CONTROL-BY-ACCOUNT.
  4145         16  PB-COMPANY-CD-A1             PIC X.
  4146         16  PB-CARRIER                   PIC X.
  4147         16  PB-GROUPING.
  4148             20  PB-GROUPING-PREFIX       PIC XXX.
  4149             20  PB-GROUPING-PRIME        PIC XXX.
  4150         16  PB-STATE                     PIC XX.
  4151         16  PB-ACCOUNT.
  4152             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4153             20  PB-ACCOUNT-PRIME         PIC X(6).
  4154         16  PB-CERT-EFF-DT               PIC XX.
  4155         16  PB-CERT-NO.
  4156             20  PB-CERT-PRIME            PIC X(10).
  4157             20  PB-CERT-SFX              PIC X.
  4158         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4159
  4160         16  PB-RECORD-TYPE               PIC X.
  4161             88  PB-MAILING-DATA                VALUE '0'.
  4162             88  PB-ISSUE                       VALUE '1'.
  4163             88  PB-CANCELLATION                VALUE '2'.
  4164             88  PB-BATCH-TRAILER               VALUE '9'.
  4165
  4166     12  PB-CONTROL-BY-ORIG-BATCH.
  4167         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4168         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4169         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4170         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4171
  4172     12  PB-CONTROL-BY-CSR.
  4173         16  PB-CSR-COMPANY-CD            PIC X.
  4174         16  PB-CSR-ID                    PIC X(4).
  4175         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4176         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4177         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4178******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  79
* EL050.cbl
  4179*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4180******************************************************************
  4181
  4182     12  PB-LAST-MAINT-DT                 PIC XX.
  4183     12  PB-LAST-MAINT-BY                 PIC X(4).
  4184     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4185
  4186     12  PB-RECORD-BODY                   PIC X(375).
  4187
  4188     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4189         16  PB-CERT-ORIGIN               PIC X.
  4190             88  CLASIC-CREATED-CERT         VALUE '1'.
  4191         16  PB-I-NAME.
  4192             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4193             20  PB-I-INSURED-FIRST-NAME.
  4194                 24  PB-I-INSURED-1ST-INIT PIC X.
  4195                 24  FILLER                PIC X(9).
  4196             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4197         16  PB-I-AGE                     PIC S99   COMP-3.
  4198         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4199         16  PB-I-BIRTHDAY                PIC XX.
  4200         16  PB-I-INSURED-SEX             PIC X.
  4201             88  PB-SEX-MALE     VALUE 'M'.
  4202             88  PB-SEX-FEMALE   VALUE 'F'.
  4203
  4204         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4205         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4206         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4207         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4208         16  PB-I-SKIP-CODE               PIC X.
  4209             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4210             88  PB-SKIP-JULY              VALUE '1'.
  4211             88  PB-SKIP-AUGUST            VALUE '2'.
  4212             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4213             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4214             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4215             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4216             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4217             88  PB-SKIP-JUNE              VALUE '8'.
  4218             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4219             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4220             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4221         16  PB-I-TERM-TYPE               PIC X.
  4222             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4223             88  PB-PAID-WEEKLY            VALUE 'W'.
  4224             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4225             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4226             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4227         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4228         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4229         16  PB-I-DATA-ENTRY-SW           PIC X.
  4230             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4231             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4232             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4233             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4234         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4235         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4236*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  80
* EL050.cbl
  4237         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4238         16  FILLER                       PIC X.
  4239
  4240         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4241             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4242             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4243                                                   '90' THRU '99'.
  4244         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4245                                          PIC XX.
  4246         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4247         16  PB-I-AMOUNT-FINANCED REDEFINES
  4248                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4249         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4250         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4251                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4252         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4253         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4254         16  PB-I-CLP-AMOUNT REDEFINES
  4255                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4256         16  PB-I-LF-CALC-FLAG            PIC X.
  4257             88 PB-COMP-LF-PREM               VALUE '?'.
  4258         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4259         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4260         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4261         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4262         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4263         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4264         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4265         16  PB-I-LF-ABBR                 PIC XXX.
  4266         16  PB-I-LF-INPUT-CD             PIC XX.
  4267
  4268         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4269             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4270             88  PB-INVALID-AH               VALUE '  ' '00'
  4271                                                   '90' THRU '99'.
  4272         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4273         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4274         16  PB-I-AH-CALC-FLAG            PIC X.
  4275             88 PB-COMP-AH-PREM                  VALUE '?'.
  4276         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4277         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4278         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4279         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4280         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4281         16  PB-I-AH-ABBR                 PIC XXX.
  4282         16  PB-I-AH-INPUT-CD             PIC XXX.
  4283
  4284         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4285         16  PB-I-REIN-TABLE              PIC XXX.
  4286         16  PB-I-BUSINESS-TYPE           PIC 99.
  4287         16  PB-I-INDV-GRP-CD             PIC X.
  4288         16  PB-I-MORT-CODE.
  4289             20  PB-I-TABLE               PIC X.
  4290             20  PB-I-INTEREST            PIC XX.
  4291             20  PB-I-MORT-TYP            PIC X.
  4292         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4293         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4294         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  81
* EL050.cbl
  4295         16  PB-I-INDV-GRP-OVRD           PIC X.
  4296         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4297         16  PB-I-SIG-SW                  PIC X.
  4298             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4299         16  PB-I-RATE-CLASS              PIC XX.
  4300         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4301         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4302         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4303         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4304         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4305         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4306         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4307         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4308         16  PB-I-OB-FLAG                 PIC X.
  4309             88  PB-I-OB                      VALUE 'B'.
  4310             88  PB-I-SUMMARY                 VALUE 'Z'.
  4311         16  PB-I-ENTRY-STATUS            PIC X.
  4312             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4313                                              'M' '5' '9' '2'.
  4314             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4315             88  PB-I-POLICY-PENDING          VALUE '2'.
  4316             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4317             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4318             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4319             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4320             88  PB-I-REIN-ONLY               VALUE '9'.
  4321             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4322             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4323             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4324             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4325         16  PB-I-INT-CODE                PIC X.
  4326             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4327             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4328         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4329         16  PB-I-SOC-SEC-NO              PIC X(11).
  4330         16  PB-I-MEMBER-NO               PIC X(12).
  4331         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4332*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4333         16  PB-I-OLD-LOF                 PIC XXX.
  4334         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4335         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4336         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4337         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4338         16  PB-I-LIFE-INDICATOR          PIC X.
  4339             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4340         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4341         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4342                                          PIC S9(5)V99    COMP-3.
  4343         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4344             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4345             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4346         16  PB-I-1ST-PMT-DT              PIC XX.
  4347         16  PB-I-JOINT-INSURED.
  4348             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4349             20 PB-I-JOINT-FIRST-NAME.
  4350                24  PB-I-JOINT-FIRST-INIT PIC X.
  4351                24  FILLER                PIC X(9).
  4352             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  82
* EL050.cbl
  4353*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4354         16  PB-I-BENEFICIARY-NAME.
  4355             20  PB-I-BANK-NUMBER         PIC X(10).
  4356             20  FILLER                   PIC X(15).
  4357         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4358         16  PB-I-REFERENCE               PIC X(12).
  4359         16  FILLER REDEFINES PB-I-REFERENCE.
  4360             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4361             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4362             20  PB-I-CLP-STATE           PIC XX.
  4363         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4364             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4365             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4366             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4367         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4368         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4369         16  PB-I-RESIDENT-STATE          PIC XX.
  4370         16  PB-I-RATE-CODE               PIC X(4).
  4371         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4372         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4373         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4374         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4375         16  PB-I-BANK-NOCHRGB            PIC 99.
  4376         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4377         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4378
  4379     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4380         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4381             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4382         16  PB-C-CANCEL-ORIGIN           PIC X.
  4383             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4384         16  PB-C-LF-CANCEL-DT            PIC XX.
  4385         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4386         16  PB-C-LF-CALC-REQ             PIC X.
  4387             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4388         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4389         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4390         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4391             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4392         16  PB-C-AH-CANCEL-DT            PIC XX.
  4393         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4394         16  PB-C-AH-CALC-REQ             PIC X.
  4395             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4396         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4397         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4398         16  PB-C-LAST-NAME               PIC X(15).
  4399         16  PB-C-REFUND-SW               PIC X.
  4400             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4401             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4402         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4403         16  PB-C-PAYEE-CODE              PIC X(6).
  4404         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4405         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4406         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4407         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4408         16  PB-C-REFERENCE               PIC X(12).
  4409         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4410         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  83
* EL050.cbl
  4411         16  PB-C-POST-CARD-IND           PIC X.
  4412         16  PB-C-CANCEL-REASON           PIC X.
  4413         16  PB-C-REF-INTERFACE-SW        PIC X.
  4414         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4415         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4416         16  FILLER                       PIC X(01).
  4417*        16  FILLER                       PIC X(18).
  4418         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4419*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4420         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4421         16  PB-CANCELED-CERT-DATA.
  4422             20  PB-CI-INSURED-NAME.
  4423                 24  PB-CI-LAST-NAME      PIC X(15).
  4424                 24  PB-CI-INITIALS       PIC XX.
  4425             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4426             20  PB-CI-INSURED-SEX        PIC X.
  4427             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4428             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4429             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4430             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4431             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4432             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4433             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4434             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4435             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4436             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4437             20  PB-CI-RATE-CLASS         PIC XX.
  4438             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4439             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4440             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4441             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4442             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4443             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4444             20  PB-CI-LF-ABBR            PIC X(3).
  4445             20  PB-CI-AH-ABBR            PIC X(3).
  4446             20  PB-CI-OB-FLAG            PIC X.
  4447                 88  PB-CI-OB                VALUE 'B'.
  4448             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4449                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4450                                           'M' '4' '5' '9' '2'.
  4451                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4452                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4453                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4454                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4455                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4456                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4457                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4458                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4459                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4460                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4461                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4462                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4463                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4464             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4465                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4466                                           'M' '4' '5' '9' '2'.
  4467                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4468                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  84
* EL050.cbl
  4469                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4470                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4471                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4472                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4473                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4474                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4475                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4476                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4477                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4478                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4479                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4480             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4481             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4482             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4483             20  PB-CI-MEMBER-NO          PIC X(12).
  4484             20  PB-CI-INT-CODE           PIC X.
  4485                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4486                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4487             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4488             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4489             20  PB-CI-COMP-EXCP-SW       PIC X.
  4490                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4491                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4492             20  PB-CI-ENTRY-STATUS       PIC X.
  4493             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4494             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4495             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4496             20  PB-CI-DEATH-DT           PIC XX.
  4497             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4498             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4499             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4500             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4501             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4502             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4503             20  PB-CI-ENTRY-DT              PIC XX.
  4504             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4505             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4506             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4507             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4508             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4509             20  PB-CI-OLD-LOF               PIC XXX.
  4510*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4511             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4512             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4513             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4514             20  PB-CI-INDV-GRP-CD           PIC X.
  4515             20  PB-CI-BENEFICIARY-NAME.
  4516                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4517                 24  FILLER                  PIC X(15).
  4518             20  PB-CI-NOTE-SW               PIC X.
  4519             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4520             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4521             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4522             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4523             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4524             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4525             20  PB-CI-FIRST-NAME            PIC X(10).
  4526             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  85
* EL050.cbl
  4527
  4528         16  FILLER                       PIC X(13).
  4529*032306  16  FILLER                       PIC X(27).
  4530*        16  FILLER                       PIC X(46).
  4531
  4532     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4533         16  FILLER                       PIC X(10).
  4534         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4535         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4536         16  PB-M-INSURED-MID-INIT        PIC X.
  4537         16  PB-M-INSURED-AGE             PIC 99.
  4538         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4539         16  PB-M-INSURED-SEX             PIC X.
  4540         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4541         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4542         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4543         16  PB-M-INSURED-CITY-STATE.
  4544             20  PB-M-INSURED-CITY        PIC X(28).
  4545             20  PB-M-INSURED-STATE       PIC XX.
  4546         16  PB-M-INSURED-ZIP-CODE.
  4547             20  PB-M-INSURED-ZIP-PRIME.
  4548                 24  PB-M-INSURED-ZIP-1   PIC X.
  4549                     88  PB-M-CANADIAN-POST-CODE
  4550                                             VALUE 'A' THRU 'Z'.
  4551                 24  FILLER               PIC X(4).
  4552             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4553         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4554                                        PB-M-INSURED-ZIP-CODE.
  4555             20  PM-M-INS-CAN-POST1       PIC XXX.
  4556             20  PM-M-INS-CAN-POST2       PIC XXX.
  4557             20  FILLER                   PIC XXX.
  4558         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4559         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4560         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4561         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4562         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4563         16  PB-M-CRED-BENE-CITYST.
  4564             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4565             20  PB-M-CRED-BENE-STATE     PIC XX.
  4566         16  FILLER                       PIC X(92).
  4567
  4568     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4569         16  FILLER                       PIC X(10).
  4570         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4571         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4572         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4573         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4574         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4575         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4576         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4577         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4578         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4579         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4580         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4581         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4582         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4583         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4584         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  86
* EL050.cbl
  4585         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4586         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4587         16  PB-ACCOUNT-NAME              PIC X(30).
  4588         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4589         16  PB-REFERENCE                 PIC X(12).
  4590         16  PB-B-RECEIVED-DT             PIC XX.
  4591         16  FILLER                       PIC X(234).
  4592
  4593     12  PB-RECORD-STATUS.
  4594         16  PB-CREDIT-SELECT-DT          PIC XX.
  4595         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4596         16  PB-BILLED-DT                 PIC XX.
  4597         16  PB-BILLING-STATUS            PIC X.
  4598             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4599             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4600             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4601         16  PB-RECORD-BILL               PIC X.
  4602             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4603             88  PB-RECORD-RETURNED           VALUE 'R'.
  4604             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4605             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4606             88  PB-OVERRIDE-AH               VALUE 'A'.
  4607             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4608         16  PB-BATCH-ENTRY               PIC X.
  4609             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4610             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4611             88  PB-REISSUED-CERT             VALUE 'E'.
  4612             88  PB-CASH-CERT                 VALUE 'C'.
  4613             88  PB-MONTHLY-CERT              VALUE 'M'.
  4614             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4615             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4616             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4617         16  PB-FORCE-CODE                PIC X.
  4618             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4619             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4620             88  PB-CANCEL-FORCE              VALUE '8'.
  4621             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4622             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4623             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4624             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4625             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4626             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4627             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4628             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4629         16  PB-FATAL-FLAG                PIC X.
  4630             88  PB-FATAL-ERRORS              VALUE 'X'.
  4631         16  PB-FORCE-ER-CD               PIC X.
  4632             88  PB-FORCE-ERRORS              VALUE 'F'.
  4633             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4634         16  PB-WARN-ER-CD                PIC X.
  4635             88  PB-WARNING-ERRORS            VALUE 'W'.
  4636         16  FILLER                       PIC X.
  4637         16  PB-OUT-BAL-CD                PIC X.
  4638             88  PB-OUT-OF-BAL                VALUE 'O'.
  4639         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4640         16  PB-AH-OVERRIDE-L1            PIC X.
  4641         16  PB-INPUT-DT                  PIC XX.
  4642         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  87
* EL050.cbl
  4643         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4644         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4645         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4646         16  PB-LF-EARNING-METHOD         PIC X.
  4647         16  PB-AH-EARNING-METHOD         PIC X.
  4648         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4649         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4650         16  PB-REIN-CD                   PIC XXX.
  4651         16  PB-LF-REFUND-TYPE            PIC X.
  4652         16  PB-AH-REFUND-TYPE            PIC X.
  4653         16  PB-ACCT-EFF-DT               PIC XX.
  4654         16  PB-ACCT-EXP-DT               PIC XX.
  4655         16  PB-COMPANY-ID                PIC X(3).
  4656         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4657         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4658         16  PB-SV-CARRIER                PIC X.
  4659         16  PB-SV-GROUPING               PIC X(6).
  4660         16  PB-SV-STATE                  PIC XX.
  4661         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4662         16  PB-GA-BILLING-INFO.
  4663             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4664                                          PIC XX.
  4665         16  PB-SV-REMIT-TO  REDEFINES
  4666             PB-GA-BILLING-INFO           PIC X(10).
  4667         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4668         16  PB-I-LOAN-OFFICER            PIC X(5).
  4669         16  PB-I-VIN                     PIC X(17).
  4670
  4671         16  FILLER                       PIC X(04).
  4672         16  IMNET-BYPASS-SW              PIC X.
  4673
  4674******************************************************************
  4675*                COMMON EDIT ERRORS                              *
  4676******************************************************************
  4677
  4678     12  PB-COMMON-ERRORS.
  4679         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4680                                           PIC S9(4)     COMP.
  4681
  4682******************************************************************
  4683
  4684* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4685*    COPY ELC50W1.
  4686******************************************************************
  4687*                                                                *
  4688*                                                                *
  4689*                             ELC50W1                            *
  4690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4691*                            VMOD=2.004                          *
  4692*                                                                *
  4693*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4694*                                                                *
  4695*                                                                *
  4696******************************************************************
  4697
  4698     12  WK-WORK-AREA.
  4699         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4700         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  88
* EL050.cbl
  4701         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4702         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4703         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4704         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4705         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4706         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4707         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4708         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4709         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4710         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4711         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4712         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4713         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4714         16  WK-CREDIT-EDIT-CONTROLS.
  4715             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4716             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4717             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4718             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4719             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4720             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4721         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4722         16  WK-SAVE-REIN-DATA.
  4723             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4724             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4725             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4726         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4727             88  ENTRY-FROM-EL6311       VALUE '6'.
  4728         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4729         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4730     12  WK-RECORD-ADDRESSES.
  4731         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4732         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4733         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4734         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4735         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4736         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4737         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4738         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4739     12  WK-OVER-SHORT-AREA.
  4740         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4741         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4742         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4743             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4744         16  FILLER                   PIC X(5) VALUE SPACES.
  4745
  4746*    COPY ELCEDITC.
  4747******************************************************************
  4748*                                                                *
  4749*                                                                *
  4750*                            ELCEDITC                            *
  4751*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4752*                            VMOD=2.012                          *
  4753*                                                                *
  4754*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4755*                     EL6313, EL050 AND EL517.                   *
  4756*                                                                *
  4757******************************************************************
  4758******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  89
* EL050.cbl
  4759*                   C H A N G E   L O G
  4760*
  4761* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4762*-----------------------------------------------------------------
  4763*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4764* EFFECTIVE    NUMBER
  4765*-----------------------------------------------------------------
  4766* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4767******************************************************************
  4768
  4769     12  EDIT-CRITERIA-DATA.
  4770         16  EC-CO-MONTH-END-DT       PIC XX.
  4771         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4772         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4773         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4774         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4775         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4776         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4777         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4778         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4779         16  EC-CO-REM-TERM-CALC      PIC X.
  4780               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4781               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4782               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4783               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4784
  4785         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4786               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4787               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4788               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4789               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4790               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4791               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4792               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4793               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4794               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4795               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4796
  4797         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4798               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4799               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4800               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4801               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4802               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4803               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4804               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4805               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4806
  4807         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4808                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4809                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4810
  4811         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4812                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4813                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4814                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4815                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4816                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  90
* EL050.cbl
  4817                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4818                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4819                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4820
  4821         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4822               88  EC-BR-REDUCING                   VALUE 'R'.
  4823               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4824
  4825         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4826         16  EC-BR-LF-DESC             PIC X(10).
  4827         16  EC-BR-AH-DESC             PIC X(10).
  4828         16  EC-BR-LF-COMMENT          PIC X(10).
  4829         16  EC-BR-AH-COMMENT          PIC X(10).
  4830
  4831         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4832               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4833               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4834               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4835               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4836
  4837         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4838               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4839               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4840               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4841               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4842
  4843         16  EC-BR-LF-REFUND-CALC      PIC X.
  4844                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4845                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4846                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4847                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4848                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4849                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4850                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4851
  4852         16  EC-BR-AH-REFUND-CALC      PIC X.
  4853                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4854                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4855                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4856                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4857                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4858                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4859                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4860                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4861
  4862         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4863                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4864                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4865                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4866
  4867         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4868                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4869                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4870                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4871
  4872         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4873         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4874         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  91
* EL050.cbl
  4875         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4876
  4877         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4878         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4879                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4880                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4881                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4882                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4883
  4884         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4885               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4886               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4887               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4888               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4889               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4890
  4891         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4892               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4893               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4894               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4895               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4896               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4897
  4898         16  EC-ST-LF-REFUND-CALC      PIC X.
  4899                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4900                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4901                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4902                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4903                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4904                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4905                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4906                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4907
  4908         16  EC-ST-AH-REFUND-CALC      PIC X.
  4909                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4910                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4911                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4912                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4913                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4914                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4915                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4916                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4917
  4918         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4919         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4920         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4921         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4922         16  EC-AM-EXPIRATION-DT       PIC XX.
  4923         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4924         16  EC-AM-CLASS-CD            PIC XX.
  4925         16  EC-AM-LF-DEVIATION        PIC XXX.
  4926         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4927         16  EC-AM-AH-DEVIATION        PIC XXX.
  4928         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4929         16  EC-AM-PHONE-NO            PIC X(10).
  4930
  4931         16  EC-AM-LF-REFUND-CALC      PIC X.
  4932                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  92
* EL050.cbl
  4933                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4934                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4935                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4936                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4937                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4938                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4939
  4940         16  EC-AM-AH-REFUND-CALC      PIC X.
  4941                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4942                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4943                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4944                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4945                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4946                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4947                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4948
  4949         16  EC-AM-BEN-I-G-CD          PIC X.
  4950                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4951                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4952                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4953
  4954         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4955         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4956         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4957         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4958         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4959         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4960         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4961         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4962         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4963
  4964         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4965         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4966         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4967         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4968         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4969         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4970         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4971         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4972         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4973         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4974         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4975         16  EC-RT-LF-NSP-ST           PIC XX.
  4976         16  EC-RT-AH-NSP-ST           PIC XX.
  4977         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4978         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4979
  4980         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4981             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4982                                             'M' '5' '9' '2'.
  4983             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4984             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4985             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4986             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4987             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4988             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4989             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4990             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  93
* EL050.cbl
  4991             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4992             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4993
  4994         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4995             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4996                                             'M' '5' '9' '2'.
  4997             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4998             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4999             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  5000             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  5001             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  5002             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  5003             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  5004             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  5005             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  5006             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  5007
  5008         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5009         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5010         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5011         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5012         16  EC-CM-DEATH-DT            PIC XX.
  5013
  5014*DMD CUSTOM CODING FIELDS BELOW
  5015*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5016         16  EC-BR-DMD-RATING-SW       PIC X.
  5017                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5018                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5019                 88  NO-DMD-RATING               VALUE 'N'.
  5020
  5021         16  EC-NEW-CERT               PIC X(11).
  5022         16  EC-NEW-STATE              PIC XX.
  5023         16  FILLER                    PIC X.
  5024*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5025         16  OVER-SHORT-EDIT-FIELDS.
  5026             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5027             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5028             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5029             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5030             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5031             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5032             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5033             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5034             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5035         16  FILLER                    PIC X(71).
  5036******************************************************************
  5037
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  94
* EL050.cbl
  5039*    COPY ELCDIFRD.
  5040******************************************************************
  5041*                                                                *
  5042*                                                                *
  5043*                            ELCDIFRD.                           *
  5044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5045*                            VMOD=2.004                          *
  5046*                                                                *
  5047*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5048*                                                                *
  5049******************************************************************
  5050*
  5051  01  WS-DIFFERENCE-CALCULATION.
  5052        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5053        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5054        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5055        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5056        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5057        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5058        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5059        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5060        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5061        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5062        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5063
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  95
* EL050.cbl
  5065****************************************************************
  5066*
  5067* Copyright (c) 2007-2013 Dell Inc.
  5068* All rights reserved.
  5069*
  5070****************************************************************
  5071 01  DFHEIV.
  5072   02  DFHEIV0               PIC X(35).
  5073   02  DFHEIV1               PIC X(08).
  5074   02  DFHEIV2               PIC X(08).
  5075   02  DFHEIV3               PIC X(08).
  5076   02  DFHEIV4               PIC X(06).
  5077   02  DFHEIV5               PIC X(04).
  5078   02  DFHEIV6               PIC X(04).
  5079   02  DFHEIV7               PIC X(02).
  5080   02  DFHEIV8               PIC X(02).
  5081   02  DFHEIV9               PIC X(01).
  5082   02  DFHEIV10              PIC S9(7) COMP-3.
  5083   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5084   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5085   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5086   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5087   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5088   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5089   02  DFHEIV17              PIC X(04).
  5090   02  DFHEIV18              PIC X(04).
  5091   02  DFHEIV19              PIC X(04).
  5092   02  DFHEIV20              USAGE IS POINTER.
  5093   02  DFHEIV21              USAGE IS POINTER.
  5094   02  DFHEIV22              USAGE IS POINTER.
  5095   02  DFHEIV23              USAGE IS POINTER.
  5096   02  DFHEIV24              USAGE IS POINTER.
  5097   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5098   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5099   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5100   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5101   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5102   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5103   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5104   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5105   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5106   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5107   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5108   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5109   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5110   02  FILLER                PIC X(02).
  5111   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5112   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5113   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5114   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5115   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5116   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5117   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5118 LINKAGE  SECTION.
  5119*****************************************************************
  5120*                                                               *
  5121* Copyright (c) 2007-2013 Dell Inc.                             *
  5122* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  96
* EL050.cbl
  5123*                                                               *
  5124*****************************************************************
  5125 01  dfheiblk.
  5126     02  eibtime          pic s9(7) comp-3.
  5127     02  eibdate          pic s9(7) comp-3.
  5128     02  eibtrnid         pic x(4).
  5129     02  eibtaskn         pic s9(7) comp-3.
  5130     02  eibtrmid         pic x(4).
  5131     02  dfheigdi         pic s9(4) comp.
  5132     02  eibcposn         pic s9(4) comp.
  5133     02  eibcalen         pic s9(4) comp.
  5134     02  eibaid           pic x(1).
  5135     02  eibfiller1       pic x(1).
  5136     02  eibfn            pic x(2).
  5137     02  eibfiller2       pic x(2).
  5138     02  eibrcode         pic x(6).
  5139     02  eibfiller3       pic x(2).
  5140     02  eibds            pic x(8).
  5141     02  eibreqid         pic x(8).
  5142     02  eibrsrce         pic x(8).
  5143     02  eibsync          pic x(1).
  5144     02  eibfree          pic x(1).
  5145     02  eibrecv          pic x(1).
  5146     02  eibsend          pic x(1).
  5147     02  eibatt           pic x(1).
  5148     02  eibeoc           pic x(1).
  5149     02  eibfmh           pic x(1).
  5150     02  eibcompl         pic x(1).
  5151     02  eibsig           pic x(1).
  5152     02  eibconf          pic x(1).
  5153     02  eiberr           pic x(1).
  5154     02  eibrldbk         pic x(1).
  5155     02  eiberrcd         pic x(4).
  5156     02  eibsynrb         pic x(1).
  5157     02  eibnodat         pic x(1).
  5158     02  eibfiller5       pic x(2).
  5159     02  eibresp          pic s9(8) comp.
  5160     02  eibresp2         pic s9(8) comp.
  5161     02  dfheigdj         pic s9(4) comp.
  5162     02  dfheigdk         pic s9(4) comp.
  5163
  5164 01  DFHCOMMAREA                   PIC X(1036).
  5165
  5166*01 PARMLIST .
  5167*    02  FILLER                    PIC S9(8)   COMP.
  5168*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5169*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5170*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5171*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5172*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5173*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5174*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5175
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  97
* EL050.cbl
  5177*    COPY ELCCNTL.
  5178******************************************************************
  5179*                                                                *
  5180*                                                                *
  5181*                            ELCCNTL.                            *
  5182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5183*                            VMOD=2.059                          *
  5184*                                                                *
  5185*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5186*                                                                *
  5187*   FILE TYPE = VSAM,KSDS                                        *
  5188*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5189*                                                                *
  5190*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5191*       ALTERNATE INDEX = NONE                                   *
  5192*                                                                *
  5193*   LOG = YES                                                    *
  5194*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5195******************************************************************
  5196*                   C H A N G E   L O G
  5197*
  5198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5199*-----------------------------------------------------------------
  5200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5201* EFFECTIVE    NUMBER
  5202*-----------------------------------------------------------------
  5203* 082503                   PEMA  ADD BENEFIT GROUP
  5204* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5205* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5206* 092705    2005050300006  PEMA  ADD SPP LEASES
  5207* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5208* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5209* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5210* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5211* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5212* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5213* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5214* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5215* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5216* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5217* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5218******************************************************************
  5219*
  5220 01  CONTROL-FILE.
  5221     12  CF-RECORD-ID                       PIC XX.
  5222         88  VALID-CF-ID                        VALUE 'CF'.
  5223
  5224     12  CF-CONTROL-PRIMARY.
  5225         16  CF-COMPANY-ID                  PIC XXX.
  5226         16  CF-RECORD-TYPE                 PIC X.
  5227             88  CF-COMPANY-MASTER              VALUE '1'.
  5228             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5229             88  CF-STATE-MASTER                VALUE '3'.
  5230             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5231             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5232             88  CF-CARRIER-MASTER              VALUE '6'.
  5233             88  CF-MORTALITY-MASTER            VALUE '7'.
  5234             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  98
* EL050.cbl
  5235             88  CF-TERMINAL-MASTER             VALUE '9'.
  5236             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5237             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5238             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5239             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5240             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5241             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5242             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5243             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5244             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5245         16  CF-ACCESS-CD-GENL              PIC X(4).
  5246         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5247             20  CF-PROCESSOR               PIC X(4).
  5248         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5249             20  CF-STATE-CODE              PIC XX.
  5250             20  FILLER                     PIC XX.
  5251         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5252             20  FILLER                     PIC XX.
  5253             20  CF-HI-BEN-IN-REC           PIC XX.
  5254         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5255             20  FILLER                     PIC XXX.
  5256             20  CF-CARRIER-CNTL            PIC X.
  5257         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5258             20  FILLER                     PIC XX.
  5259             20  CF-HI-TYPE-IN-REC          PIC 99.
  5260         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5261             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5262                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5263             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5264             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5265         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5266             20  FILLER                     PIC X.
  5267             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5268         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5269             20  FILLER                     PIC XX.
  5270             20  CF-MORTGAGE-PLAN           PIC XX.
  5271         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5272
  5273     12  CF-LAST-MAINT-DT                   PIC XX.
  5274     12  CF-LAST-MAINT-BY                   PIC X(4).
  5275     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5276
  5277     12  CF-RECORD-BODY                     PIC X(728).
  5278
  5279
  5280****************************************************************
  5281*             COMPANY MASTER RECORD                            *
  5282****************************************************************
  5283
  5284     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5285         16  CF-COMPANY-ADDRESS.
  5286             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5287             20  CF-CL-IN-CARE-OF           PIC X(30).
  5288             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5289             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5290             20  CF-CL-CITY-STATE           PIC X(30).
  5291             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5292             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page  99
* EL050.cbl
  5293         16  CF-COMPANY-CD                  PIC X.
  5294         16  CF-COMPANY-PASSWORD            PIC X(8).
  5295         16  CF-SECURITY-OPTION             PIC X.
  5296             88  ALL-SECURITY                   VALUE '1'.
  5297             88  COMPANY-VERIFY                 VALUE '2'.
  5298             88  PROCESSOR-VERIFY               VALUE '3'.
  5299             88  NO-SECURITY                    VALUE '4'.
  5300             88  ALL-BUT-TERM                   VALUE '5'.
  5301         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5302             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5303         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5304             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5305         16  CF-INFORCE-LOCATION            PIC X.
  5306             88  CERTS-ARE-ONLINE               VALUE '1'.
  5307             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5308             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5309         16  CF-LOWER-CASE-LETTERS          PIC X.
  5310         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5311             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5312             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5313             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5314             88  CF-ACCNT-CNTL                  VALUE '3'.
  5315             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5316
  5317         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5318         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5319
  5320         16  CF-LGX-CREDIT-USER             PIC X.
  5321             88  CO-IS-NOT-USER                 VALUE 'N'.
  5322             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5323
  5324         16 CF-CREDIT-CALC-CODES.
  5325             20  CF-CR-REM-TERM-CALC PIC X.
  5326               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5327               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5328               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5329               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5330               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5331               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5332               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5333             20  CF-CR-R78-METHOD           PIC X.
  5334               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5335               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5336
  5337         16  CF-CLAIM-CONTROL-COUNTS.
  5338             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5339                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5340
  5341             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5342                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5343
  5344             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5345                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5346
  5347             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5348                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5349
  5350         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 100
* EL050.cbl
  5351
  5352         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5353             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5354             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5355             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5356             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5357                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5358                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5359             20  CF-CO-PREM-REJECT-SW       PIC X.
  5360                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5361                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5362             20  CF-CO-REF-REJECT-SW        PIC X.
  5363                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5364                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5365
  5366         16  CF-CO-REPORTING-DT             PIC XX.
  5367         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5368         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5369           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5370           88  CF-CO-MONTH-END                  VALUE '1'.
  5371
  5372         16  CF-LGX-CLAIM-USER              PIC X.
  5373             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5374             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5375
  5376         16  CF-CREDIT-EDIT-CONTROLS.
  5377             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5378             20  CF-MIN-AGE                 PIC 99.
  5379             20  CF-DEFAULT-AGE             PIC 99.
  5380             20  CF-MIN-TERM                PIC S999      COMP-3.
  5381             20  CF-MAX-TERM                PIC S999      COMP-3.
  5382             20  CF-DEFAULT-SEX             PIC X.
  5383             20  CF-JOINT-AGE-INPUT         PIC X.
  5384                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5385             20  CF-BIRTH-DATE-INPUT        PIC X.
  5386                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5387             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5388                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5389                 88  CF-ZERO-CARRIER            VALUE '1'.
  5390                 88  CF-ZERO-GROUPING           VALUE '2'.
  5391                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5392             20  CF-EDIT-SW                 PIC X.
  5393                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5394             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5395             20  CF-CR-PR-METHOD            PIC X.
  5396               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5397               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5398             20  FILLER                     PIC X.
  5399
  5400         16  CF-CREDIT-MISC-CONTROLS.
  5401             20  CF-REIN-TABLE-SW           PIC X.
  5402                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5403             20  CF-COMP-TABLE-SW           PIC X.
  5404                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5405             20  CF-EXPERIENCE-RETENTION-AGE
  5406                                            PIC S9        COMP-3.
  5407             20  CF-CONVERSION-DT           PIC XX.
  5408             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 101
* EL050.cbl
  5409             20  CF-RUN-FREQUENCY-SW        PIC X.
  5410                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5411                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5412
  5413             20  CF-CR-CHECK-NO-CONTROL.
  5414                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5415                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5416                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5417                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5418                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5419                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5420
  5421                 24  CF-CR-CHECK-COUNT       REDEFINES
  5422                     CF-CR-CHECK-COUNTER      PIC X(4).
  5423
  5424                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5425                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5426
  5427                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5428                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5429                 24  CF-MAIL-PROCESSING       PIC X.
  5430                     88  MAIL-PROCESSING          VALUE 'Y'.
  5431
  5432         16  CF-MISC-SYSTEM-CONTROL.
  5433             20  CF-SYSTEM-C                 PIC X.
  5434                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5435             20  CF-SYSTEM-D                 PIC X.
  5436                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5437             20  CF-SOC-SEC-NO-SW            PIC X.
  5438                 88  SOC-SEC-NO-USED             VALUE '1'.
  5439             20  CF-MEMBER-NO-SW             PIC X.
  5440                 88  MEMBER-NO-USED              VALUE '1'.
  5441             20  CF-TAX-ID-NUMBER            PIC X(11).
  5442             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5443             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5444                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5445                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5446                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5447                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5448             20  CF-SYSTEM-E                 PIC X.
  5449                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5450
  5451         16  CF-LGX-LIFE-USER               PIC X.
  5452             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5453             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5454
  5455         16  CF-CR-MONTH-END-DT             PIC XX.
  5456
  5457         16  CF-FILE-MAINT-DATES.
  5458             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5459                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5460             20  CF-LAST-BATCH       REDEFINES
  5461                 CF-LAST-BATCH-NO               PIC X(4).
  5462             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5463             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5464             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5465             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5466             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 102
* EL050.cbl
  5467             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5468             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5469             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5470             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5471             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5472
  5473         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5474         16  FILLER                         PIC X.
  5475
  5476         16  CF-ALT-MORT-CODE               PIC X(4).
  5477         16  CF-MEMBER-CAPTION              PIC X(10).
  5478
  5479         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5480             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5481             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5482             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5483             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5484             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5485
  5486         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5487
  5488         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5489         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5490         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5491         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5492
  5493         16  CF-AH-OVERRIDE-L1              PIC X.
  5494         16  CF-AH-OVERRIDE-L2              PIC XX.
  5495         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5496         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5497
  5498         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5499         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5500
  5501         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5502         16  CF-AR-LAST-EL860-DT            PIC XX.
  5503         16  CF-MP-MONTH-END-DT             PIC XX.
  5504
  5505         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5506         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5507             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5508
  5509         16  CF-AR-MONTH-END-DT             PIC XX.
  5510
  5511         16  CF-CRDTCRD-USER                PIC X.
  5512             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5513             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5514
  5515         16  CF-CC-MONTH-END-DT             PIC XX.
  5516
  5517         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5518
  5519         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5520             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5521             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5522             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5523         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5524         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 103
* EL050.cbl
  5525         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5526         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5527             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5528             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5529         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5530         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5531         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5532             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5533         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5534
  5535         16  CF-CL-ZIP-CODE.
  5536             20  CF-CL-ZIP-PRIME.
  5537                 24  CF-CL-ZIP-1ST          PIC X.
  5538                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5539                 24  FILLER                 PIC X(4).
  5540             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5541         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5542             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5543             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5544             20  FILLER                     PIC XXX.
  5545
  5546         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5547         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5548         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5549         16  CF-CO-OPTION-START-DATE        PIC XX.
  5550         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5551           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5552                                                      '3' '4'.
  5553           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5554           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5555           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5556           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5557           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5558           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5559
  5560         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5561
  5562         16  CF-PAYMENT-APPROVAL-LEVELS.
  5563             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5564             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5565             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5566             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5567             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5568             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5569
  5570         16  CF-END-USER-REPORTING-USER     PIC X.
  5571             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5572             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5573
  5574         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5575             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5576             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5577
  5578         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5579
  5580         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5581         16  FILLER                         PIC X.
  5582
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 104
* EL050.cbl
  5583         16  CF-CREDIT-ARCHIVE-CNTL.
  5584             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5585             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5586             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5587
  5588         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5589
  5590         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5591             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5592             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5593
  5594         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5595             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5596             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5597
  5598         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5599
  5600         16  CF-CO-ACH-ID-CODE              PIC  X.
  5601             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5602             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5603             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5604         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5605         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5606         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5607         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5608         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5609         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5610         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5611         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5612         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5613                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5614         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5615                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5616
  5617         16  CF-CO-OVER-SHORT.
  5618             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5619             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5620
  5621*         16  FILLER                         PIC X(102).
  5622         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5623             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5624             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5625
  5626         16  CF-AH-APPROVAL-DAYS.
  5627             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5628             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5629             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5630             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5631
  5632         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5633
  5634         16  CF-APPROV-LEV-5.
  5635             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5636             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5637             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5638
  5639         16  FILLER                         PIC X(68).
  5640****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 105
* EL050.cbl
  5641*             PROCESSOR/USER RECORD                            *
  5642****************************************************************
  5643
  5644     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5645         16  CF-PROCESSOR-NAME              PIC X(30).
  5646         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5647         16  CF-PROCESSOR-TITLE             PIC X(26).
  5648         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5649                 88  MESSAGE-YES                VALUE 'Y'.
  5650                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5651
  5652*****************************************************
  5653****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5654****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5655****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5656****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5657*****************************************************
  5658
  5659         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5660             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5661             20  CF-APPLICATION-FORCE       PIC X.
  5662             20  CF-INDIVIDUAL-APP.
  5663                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5664                     28  CF-BROWSE-APP      PIC X.
  5665                     28  CF-UPDATE-APP      PIC X.
  5666
  5667         16  CF-CURRENT-TERM-ON             PIC X(4).
  5668         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5669             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5670             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5671             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5672             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5673             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5674             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5675             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5676         16  CF-PROCESSOR-CARRIER           PIC X.
  5677             88  NO-CARRIER-SECURITY            VALUE ' '.
  5678         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5679             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5680         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5681             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5682         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5683             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5684
  5685         16  CF-PROC-SYS-ACCESS-SW.
  5686             20  CF-PROC-CREDIT-CLAIMS-SW.
  5687                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5688                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5689                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5690                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5691             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5692                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5693                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5694             20  CF-PROC-LIFE-GNRLDGR-SW.
  5695                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5696                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5697                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5698                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 106
* EL050.cbl
  5699             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5700                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5701                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5702         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5703             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5704             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5705         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5706
  5707         16  CF-APPROVAL-LEVEL                  PIC X.
  5708             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5709             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5710             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5711             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5712             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5713
  5714         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5715
  5716         16  CF-LANGUAGE-TYPE                   PIC X.
  5717             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5718             88  CF-LANG-IS-FR                      VALUE 'F'.
  5719
  5720         16  CF-CSR-IND                         PIC X.
  5721         16  FILLER                             PIC X(239).
  5722
  5723****************************************************************
  5724*             PROCESSOR/REMINDERS RECORD                       *
  5725****************************************************************
  5726
  5727     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5728         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5729             20  CF-START-REMIND-DT         PIC XX.
  5730             20  CF-END-REMIND-DT           PIC XX.
  5731             20  CF-REMINDER-TEXT           PIC X(50).
  5732         16  FILLER                         PIC X(296).
  5733
  5734
  5735****************************************************************
  5736*             STATE MASTER RECORD                              *
  5737****************************************************************
  5738
  5739     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5740         16  CF-STATE-ABBREVIATION          PIC XX.
  5741         16  CF-STATE-NAME                  PIC X(25).
  5742         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5743         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5744             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5745             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5746             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5747             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5748                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5749                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5750             20  CF-ST-PREM-REJECT-SW       PIC X.
  5751                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5752                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5753             20  CF-ST-REF-REJECT-SW        PIC X.
  5754                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5755                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5756         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 107
* EL050.cbl
  5757         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5758         16  CF-ST-REFUND-RULES.
  5759             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5760             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5761             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5762         16  CF-ST-FST-PMT-EXTENSION.
  5763             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5764             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5765                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5766                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5767                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5768                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5769         16  CF-ST-STATE-CALL.
  5770             20  CF-ST-CALL-UNEARNED        PIC X.
  5771             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5772             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5773         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5774             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5775             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5776         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5777         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5778         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5779         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5780         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5781         16  FILLER                         PIC X.
  5782         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5783             20  CF-ST-BENEFIT-CD           PIC XX.
  5784             20  CF-ST-BENEFIT-KIND         PIC X.
  5785                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5786                 88  CF-ST-AH-KIND              VALUE 'A'.
  5787             20  CF-ST-REM-TERM-CALC        PIC X.
  5788                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5789                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5790                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5791                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5792                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5793                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5794                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5795                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5796
  5797             20  CF-ST-REFUND-CALC          PIC X.
  5798                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5799                 88  ST-REFD-BY-R78             VALUE '1'.
  5800                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5801                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5802                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5803                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5804                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5805                 88  ST-REFD-UTAH               VALUE '7'.
  5806                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5807                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5808                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5809
  5810             20  CF-ST-EARNING-CALC         PIC X.
  5811                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5812                 88  ST-EARN-BY-R78             VALUE '1'.
  5813                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5814                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 108
* EL050.cbl
  5815                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5816                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5817                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5818                 88  ST-EARN-MEAN               VALUE '8'.
  5819                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5820
  5821             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5822                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5823                 88  ST-OVRD-BY-R78             VALUE '1'.
  5824                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5825                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5826                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5827                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5828                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5829                 88  ST-OVRD-MEAN               VALUE '8'.
  5830                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5831             20  cf-st-extra-periods        pic 9.
  5832*            20  FILLER                     PIC X.
  5833
  5834         16  CF-ST-COMMISSION-CAPS.
  5835             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5836             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5837             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5838             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5839         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5840                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5841                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5842                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5843
  5844         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5845
  5846         16  CF-ST-STATUTORY-INTEREST.
  5847             20  CF-ST-STAT-DATE-FROM       PIC X.
  5848                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5849                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5850             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5851             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5852             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5853             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5854             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5855
  5856         16  CF-ST-OVER-SHORT.
  5857             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5858             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5859
  5860         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5861
  5862         16  CF-ST-RT-CALC                  PIC X.
  5863
  5864         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5865         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5866         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5867         16  CF-ST-RF-LR-CALC               PIC X.
  5868         16  CF-ST-RF-LL-CALC               PIC X.
  5869         16  CF-ST-RF-LN-CALC               PIC X.
  5870         16  CF-ST-RF-AH-CALC               PIC X.
  5871         16  CF-ST-RF-CP-CALC               PIC X.
  5872*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 109
* EL050.cbl
  5873*CIDMOD         16  FILLER                         PIC X(192).
  5874         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5875             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5876         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5877         16  CF-ST-VFY-2ND-BENE             PIC X.
  5878         16  CF-ST-CAUSAL-STATE             PIC X.
  5879         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5880         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5881         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5882             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5883         16  CF-ST-NET-ONLY-STATE           PIC X.
  5884             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5885         16  cf-commission-cap-required     pic x.
  5886         16  CF-ST-GA-COMMISSION-CAPS.
  5887             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5888             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5889             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5890             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5891         16  CF-ST-TOT-COMMISSION-CAPS.
  5892             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5893             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5894             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5895             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5896         16  FILLER                         PIC X(156).
  5897
  5898****************************************************************
  5899*             BENEFIT MASTER RECORD                            *
  5900****************************************************************
  5901
  5902     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5903         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5904             20  CF-BENEFIT-CODE            PIC XX.
  5905             20  CF-BENEFIT-NUMERIC  REDEFINES
  5906                 CF-BENEFIT-CODE            PIC XX.
  5907             20  CF-BENEFIT-ALPHA           PIC XXX.
  5908             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5909             20  CF-BENEFIT-COMMENT         PIC X(10).
  5910
  5911             20  CF-LF-COVERAGE-TYPE        PIC X.
  5912                 88  CF-REDUCING                VALUE 'R'.
  5913                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5914
  5915             20  CF-SPECIAL-CALC-CD         PIC X.
  5916                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5917                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5918                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5919                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5920                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5921                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5922                 88  CF-FARM-PLAN               VALUE 'F'.
  5923                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5924                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5925                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5926                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5927                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5928                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5929                 88  CF-PRUDENTIAL              VALUE 'P'.
  5930                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 110
* EL050.cbl
  5931                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5932                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5933                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5934                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5935                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5936
  5937             20  CF-JOINT-INDICATOR         PIC X.
  5938                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5939
  5940*            20  FILLER                     PIC X(12).
  5941             20  cf-maximum-benefits        pic s999 comp-3.
  5942             20  FILLER                     PIC X(09).
  5943             20  CF-BENEFIT-CATEGORY        PIC X.
  5944             20  CF-LOAN-TYPE               PIC X(8).
  5945
  5946             20  CF-CO-REM-TERM-CALC        PIC X.
  5947                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5948                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5949                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5950                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5951                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5952
  5953             20  CF-CO-EARNINGS-CALC        PIC X.
  5954                 88  CO-EARN-BY-R78             VALUE '1'.
  5955                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5956                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5957                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5958                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5959                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5960                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5961                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5962
  5963             20  CF-CO-REFUND-CALC          PIC X.
  5964                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5965                 88  CO-REFD-BY-R78             VALUE '1'.
  5966                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5967                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5968                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5969                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5970                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5971                 88  CO-REFD-MEAN               VALUE '8'.
  5972                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5973                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5974                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5975
  5976             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5977                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5978                 88  CO-OVRD-BY-R78             VALUE '1'.
  5979                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5980                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5981                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5982                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5983                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5984                 88  CO-OVRD-MEAN               VALUE '8'.
  5985                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5986
  5987             20  CF-CO-BEN-I-G-CD           PIC X.
  5988                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 111
* EL050.cbl
  5989                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5990                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5991
  5992         16  FILLER                         PIC X(304).
  5993
  5994
  5995****************************************************************
  5996*             CARRIER MASTER RECORD                            *
  5997****************************************************************
  5998
  5999     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6000         16  CF-ADDRESS-DATA.
  6001             20  CF-MAIL-TO-NAME            PIC X(30).
  6002             20  CF-IN-CARE-OF              PIC X(30).
  6003             20  CF-ADDRESS-LINE-1          PIC X(30).
  6004             20  CF-ADDRESS-LINE-2          PIC X(30).
  6005             20  CF-CITY-STATE              PIC X(30).
  6006             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6007             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6008
  6009         16  CF-CLAIM-NO-CONTROL.
  6010             20  CF-CLAIM-NO-METHOD         PIC X.
  6011                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6012                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6013                 88  CLAIM-NO-SEQ               VALUE '3'.
  6014                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6015             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6016                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6017                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6018                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6019
  6020         16  CF-CHECK-NO-CONTROL.
  6021             20  CF-CHECK-NO-METHOD         PIC X.
  6022                 88  CHECK-NO-MANUAL            VALUE '1'.
  6023                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6024                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6025                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6026             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6027                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6028
  6029         16  CF-DOMICILE-STATE              PIC XX.
  6030
  6031         16  CF-EXPENSE-CONTROLS.
  6032             20  CF-EXPENSE-METHOD          PIC X.
  6033                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6034                 88  DOLLARS-PER-PMT            VALUE '2'.
  6035                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6036                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6037             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6038             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6039
  6040         16  CF-CORRESPONDENCE-CONTROL.
  6041             20  CF-LETTER-RESEND-OPT       PIC X.
  6042                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6043                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6044             20  FILLER                     PIC X(4).
  6045
  6046         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 112
* EL050.cbl
  6047             20  CF-MANUAL-SW               PIC X.
  6048                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6049             20  CF-FUTURE-SW               PIC X.
  6050                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6051             20  CF-PTC-SW                  PIC X.
  6052                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6053             20  CF-IBNR-SW                 PIC X.
  6054                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6055             20  CF-PTC-LF-SW               PIC X.
  6056                 88  CF-LF-PTC-USED             VALUE '1'.
  6057             20  CF-CDT-ACCESS-METHOD       PIC X.
  6058                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6059                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6060                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6061             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6062
  6063         16  CF-CLAIM-CALC-METHOD           PIC X.
  6064             88  360-PLUS-MONTHS                VALUE '1'.
  6065             88  365-PLUS-MONTHS                VALUE '2'.
  6066             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6067             88  360-DAILY                      VALUE '4'.
  6068             88  365-DAILY                      VALUE '5'.
  6069
  6070         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6071         16  FILLER                         PIC X(11).
  6072
  6073         16  CF-LIMIT-AMOUNTS.
  6074             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6075             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6076             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6077             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6078             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6079             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6080             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6081             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6082             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6083             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6084
  6085         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6086         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6087         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6088
  6089         16  CF-ZIP-CODE.
  6090             20  CF-ZIP-PRIME.
  6091                 24  CF-ZIP-1ST             PIC X.
  6092                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6093                 24  FILLER                 PIC X(4).
  6094             20  CF-ZIP-PLUS4               PIC X(4).
  6095         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6096             20  CF-CAN-POSTAL-1            PIC XXX.
  6097             20  CF-CAN-POSTAL-2            PIC XXX.
  6098             20  FILLER                     PIC XXX.
  6099
  6100         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6101         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6102         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6103
  6104         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 113
* EL050.cbl
  6105             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6106             88  CF-NO-RATING                   VALUE 'N'.
  6107
  6108         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6109
  6110         16  CF-CARRIER-OVER-SHORT.
  6111             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6112             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6113
  6114         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6115         16  CF-SECPAY-SWITCH               PIC X.
  6116             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6117             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6118         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6119         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6120         16  FILLER                         PIC X(444).
  6121*        16  FILLER                         PIC X(452).
  6122
  6123
  6124****************************************************************
  6125*             MORTALITY MASTER RECORD                          *
  6126****************************************************************
  6127
  6128     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6129         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6130                                INDEXED BY CF-MORT-NDX.
  6131             20  CF-MORT-TABLE              PIC X(5).
  6132             20  CF-MORT-TABLE-TYPE         PIC X.
  6133                 88  CF-MORT-JOINT              VALUE 'J'.
  6134                 88  CF-MORT-SINGLE             VALUE 'S'.
  6135                 88  CF-MORT-COMBINED           VALUE 'C'.
  6136                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6137                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6138             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6139             20  CF-MORT-AGE-METHOD         PIC XX.
  6140                 88  CF-AGE-LAST                VALUE 'AL'.
  6141                 88  CF-AGE-NEAR                VALUE 'AN'.
  6142             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6143             20  CF-MORT-ADJUSTMENT-DIRECTION
  6144                                            PIC X.
  6145                 88  CF-MINUS                   VALUE '-'.
  6146                 88  CF-PLUS                    VALUE '+'.
  6147             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6148             20  CF-MORT-JOINT-CODE         PIC X.
  6149                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6150             20  CF-MORT-PC-Q               PIC X.
  6151                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6152             20  CF-MORT-TABLE-CODE         PIC X(4).
  6153             20  CF-MORT-COMMENTS           PIC X(15).
  6154             20  FILLER                     PIC X(14).
  6155
  6156         16  FILLER                         PIC X(251).
  6157
  6158
  6159****************************************************************
  6160*             BUSSINESS TYPE MASTER RECORD                     *
  6161****************************************************************
  6162
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 114
* EL050.cbl
  6163     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6164* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6165* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6166* AND RECORD 05 IS TYPES 81-99
  6167         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6168             20  CF-BUSINESS-TITLE          PIC  X(19).
  6169             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6170                                            PIC S9V9(4) COMP-3.
  6171             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6172             20  FILLER                     PIC  X.
  6173         16  FILLER                         PIC  X(248).
  6174
  6175
  6176****************************************************************
  6177*             TERMINAL MASTER RECORD                           *
  6178****************************************************************
  6179
  6180     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6181
  6182         16  CF-COMPANY-TERMINALS.
  6183             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6184                                  PIC X(4).
  6185         16  FILLER               PIC X(248).
  6186
  6187
  6188****************************************************************
  6189*             LIFE EDIT MASTER RECORD                          *
  6190****************************************************************
  6191
  6192     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6193         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6194             20  CF-LIFE-CODE-IN            PIC XX.
  6195             20  CF-LIFE-CODE-OUT           PIC XX.
  6196         16  FILLER                         PIC X(248).
  6197
  6198
  6199****************************************************************
  6200*             AH EDIT MASTER RECORD                            *
  6201****************************************************************
  6202
  6203     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6204         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6205             20  CF-AH-CODE-IN              PIC XXX.
  6206             20  CF-AH-CODE-OUT             PIC XX.
  6207         16  FILLER                         PIC X(248).
  6208
  6209
  6210****************************************************************
  6211*             CREDIBILITY TABLES                               *
  6212****************************************************************
  6213
  6214     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6215         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6216                             INDEXED BY CF-CRDB-NDX.
  6217             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6218             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6219             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6220         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 115
* EL050.cbl
  6221
  6222
  6223****************************************************************
  6224*             REPORT CUSTOMIZATION RECORD                      *
  6225****************************************************************
  6226
  6227     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6228         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6229             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6230             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6231             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6232**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6233****       A T-TRANSFER.                                   ****
  6234             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6235
  6236         16  FILLER                         PIC XX.
  6237
  6238         16  CF-CARRIER-CNTL-OPT.
  6239             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6240                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6241                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6242             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6243                                            PIC X.
  6244         16  CF-GROUP-CNTL-OPT.
  6245             20  CF-GROUP-OPT-SEQ           PIC 9.
  6246                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6247                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6248             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6249                                            PIC X(6).
  6250         16  CF-STATE-CNTL-OPT.
  6251             20  CF-STATE-OPT-SEQ           PIC 9.
  6252                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6253                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6254             20  CF-STATE-SELECT OCCURS 3 TIMES
  6255                                            PIC XX.
  6256         16  CF-ACCOUNT-CNTL-OPT.
  6257             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6258                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6259                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6260             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6261                                            PIC X(10).
  6262         16  CF-BUS-TYP-CNTL-OPT.
  6263             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6264                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6265                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6266             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6267                                            PIC XX.
  6268         16  CF-LF-TYP-CNTL-OPT.
  6269             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6270                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6271                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6272             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6273                                            PIC XX.
  6274         16  CF-AH-TYP-CNTL-OPT.
  6275             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6276                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6277                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6278             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 116
* EL050.cbl
  6279                                            PIC XX.
  6280         16  CF-REPTCD1-CNTL-OPT.
  6281             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6282                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6283                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6284             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6285                                            PIC X(10).
  6286         16  CF-REPTCD2-CNTL-OPT.
  6287             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6288                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6289                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6290             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6291                                            PIC X(10).
  6292         16  CF-USER1-CNTL-OPT.
  6293             20  CF-USER1-OPT-SEQ           PIC 9.
  6294                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6295                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6296             20  CF-USER1-SELECT OCCURS 3 TIMES
  6297                                            PIC X(10).
  6298         16  CF-USER2-CNTL-OPT.
  6299             20  CF-USER2-OPT-SEQ           PIC 9.
  6300                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6301                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6302             20  CF-USER2-SELECT OCCURS 3 TIMES
  6303                                            PIC X(10).
  6304         16  CF-USER3-CNTL-OPT.
  6305             20  CF-USER3-OPT-SEQ           PIC 9.
  6306                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6307                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6308             20  CF-USER3-SELECT OCCURS 3 TIMES
  6309                                            PIC X(10).
  6310         16  CF-USER4-CNTL-OPT.
  6311             20  CF-USER4-OPT-SEQ           PIC 9.
  6312                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6313                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6314             20  CF-USER4-SELECT OCCURS 3 TIMES
  6315                                            PIC X(10).
  6316         16  CF-USER5-CNTL-OPT.
  6317             20  CF-USER5-OPT-SEQ           PIC 9.
  6318                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6319                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6320             20  CF-USER5-SELECT OCCURS 3 TIMES
  6321                                            PIC X(10).
  6322         16  CF-REINS-CNTL-OPT.
  6323             20  CF-REINS-OPT-SEQ           PIC 9.
  6324                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6325                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6326             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6327                 24  CF-REINS-PRIME         PIC XXX.
  6328                 24  CF-REINS-SUB           PIC XXX.
  6329
  6330         16  CF-AGENT-CNTL-OPT.
  6331             20  CF-AGENT-OPT-SEQ           PIC 9.
  6332                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6333                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6334             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6335                                            PIC X(10).
  6336
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 117
* EL050.cbl
  6337         16  FILLER                         PIC X(43).
  6338
  6339         16  CF-LOSS-RATIO-SELECT.
  6340             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6341             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6342         16  CF-ENTRY-DATE-SELECT.
  6343             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6344             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6345         16  CF-EFFECTIVE-DATE-SELECT.
  6346             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6347             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6348
  6349         16  CF-EXCEPTION-LIST-IND          PIC X.
  6350             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6351
  6352         16  FILLER                         PIC X(318).
  6353
  6354****************************************************************
  6355*                  EXCEPTION REPORTING RECORD                  *
  6356****************************************************************
  6357
  6358     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6359         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6360             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6361
  6362         16  CF-COMBINED-LIFE-AH-OPT.
  6363             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6364             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6365             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6366             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6367
  6368         16  CF-LIFE-OPT.
  6369             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6370             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6371             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6372             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6373             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6374             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6375             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6376             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6377             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6378             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6379
  6380         16  CF-AH-OPT.
  6381             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6382             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6383             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6384             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6385             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6386             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6387             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6388             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6389             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6390             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6391
  6392         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6393             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6394             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 118
* EL050.cbl
  6395             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6396
  6397         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6398
  6399         16  FILLER                         PIC X(673).
  6400
  6401
  6402****************************************************************
  6403*             MORTGAGE SYSTEM PLAN RECORD                      *
  6404****************************************************************
  6405
  6406     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6407         16  CF-PLAN-TYPE                   PIC X.
  6408             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6409             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6410             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6411         16  CF-PLAN-ABBREV                 PIC XXX.
  6412         16  CF-PLAN-DESCRIPT               PIC X(10).
  6413         16  CF-PLAN-NOTES                  PIC X(20).
  6414         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6415         16  CF-PLAN-UNDERWRITING.
  6416             20  CF-PLAN-TERM-DATA.
  6417                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6418                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6419             20  CF-PLAN-AGE-DATA.
  6420                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6421                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6422                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6423             20  CF-PLAN-BENEFIT-DATA.
  6424                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6425                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6426                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6427                                            PIC S9(7)V99  COMP-3.
  6428         16  CF-PLAN-POLICY-FORMS.
  6429             20  CF-POLICY-FORM             PIC X(12).
  6430             20  CF-MASTER-APPLICATION      PIC X(12).
  6431             20  CF-MASTER-POLICY           PIC X(12).
  6432         16  CF-PLAN-RATING.
  6433             20  CF-RATE-CODE               PIC X(5).
  6434             20  CF-SEX-RATING              PIC X.
  6435                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6436                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6437             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6438             20  CF-SUB-STD-TYPE            PIC X.
  6439                 88  CF-PCT-OF-PREM            VALUE '1'.
  6440                 88  CF-PCT-OF-BENE            VALUE '2'.
  6441         16  CF-PLAN-PREM-TOLERANCES.
  6442             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6443             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6444         16  CF-PLAN-PYMT-TOLERANCES.
  6445             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6446             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6447         16  CF-PLAN-MISC-DATA.
  6448             20  FILLER                     PIC X.
  6449             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6450             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6451         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6452         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 119
* EL050.cbl
  6453             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6454                                                     '1'.
  6455             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6456                                                     '2'.
  6457         16  CF-MIB-SEARCH-SW               PIC X.
  6458             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6459             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6460             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6461             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6462         16  CF-ALPHA-SEARCH-SW             PIC X.
  6463             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6464             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6465             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6466             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6467             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6468             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6469             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6470             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6471             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6472             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6473                                                     'A' 'B' 'C'
  6474                                                     'X' 'Y' 'Z'.
  6475         16  CF-EFF-DT-RULE-SW              PIC X.
  6476             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6477             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6478             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6479             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6480             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6481         16  FILLER                         PIC X(4).
  6482         16  CF-HEALTH-QUESTIONS            PIC X.
  6483             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6484         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6485         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6486         16  CF-PLAN-SNGL-JNT               PIC X.
  6487             88  CF-COMBINED-PLAN              VALUE 'C'.
  6488             88  CF-JNT-PLAN                   VALUE 'J'.
  6489             88  CF-SNGL-PLAN                  VALUE 'S'.
  6490         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6491         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6492         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6493         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6494         16  CF-RERATE-CNTL                 PIC  X.
  6495             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6496             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6497             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6498             88  CF-AUTO-RECALC                 VALUE '4'.
  6499         16  CF-BENEFIT-TYPE                PIC  X.
  6500             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6501             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6502         16  CF-POLICY-FEE                  PIC S999V99
  6503                                                    COMP-3.
  6504         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6505         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6506         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6507         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6508         16  FILLER                         PIC  X(32).
  6509         16  CF-TERMINATION-FORM            PIC  X(04).
  6510         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 120
* EL050.cbl
  6511         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6512                                                       COMP-3.
  6513         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6514         16  CF-ISSUE-LETTER                PIC  X(4).
  6515         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6516         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6517             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6518             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6519         16  CF-MP-REFUND-CALC              PIC X.
  6520             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6521             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6522             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6523             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6524             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6525             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6526             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6527             88  CF-MP-REFD-MEAN                VALUE '8'.
  6528         16  CF-ALT-RATE-CODE               PIC  X(5).
  6529
  6530
  6531         16  FILLER                         PIC X(498).
  6532****************************************************************
  6533*             MORTGAGE COMPANY MASTER RECORD                   *
  6534****************************************************************
  6535
  6536     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6537         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6538         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6539             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6540             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6541             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6542             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6543             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6544
  6545         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6546         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6547         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6548         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6549         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6550
  6551         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6552             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6553         16  CF-MP-RECON-USE-IND            PIC X(1).
  6554             88  CF-MP-USE-RECON             VALUE 'Y'.
  6555         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6556             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6557         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6558             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6559             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6560         16  FILLER                         PIC X(1).
  6561         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6562             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6563         16  CF-MORTG-MIB-VERSION           PIC X.
  6564             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6565             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6566             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6567         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6568             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 121
* EL050.cbl
  6569                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6570             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6571                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6572             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6573                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6574             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6575                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6576             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6577                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6578             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6579                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6580         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6581         16  FILLER                         PIC X(7).
  6582         16  CF-MORTG-DESTINATION-SYMBOL.
  6583             20  CF-MORTG-MIB-COMM          PIC X(5).
  6584             20  CF-MORTG-MIB-TERM          PIC X(5).
  6585         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6586             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6587         16  FILLER                         PIC X(03).
  6588         16  CF-MP-CHECK-NO-CONTROL.
  6589             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6590                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6591                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6592                                                ' ' LOW-VALUES.
  6593                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6594                                               VALUE '3'.
  6595         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6596         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6597         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6598             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6599                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6600             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6601                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6602             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6603                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6604             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6605                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6606             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6607                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6608             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6609                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6610         16  CF-MORTG-BILLING-AREA.
  6611             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6612                                            PIC X.
  6613         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6614         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6615         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6616         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6617             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6618             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6619         16  FILLER                         PIC X.
  6620         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6621             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6622             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6623         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6624         16  FILLER                         PIC X(8).
  6625         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6626         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 122
* EL050.cbl
  6627         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6628         16  CF-ACH-COMPANY-ID.
  6629             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6630                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6631                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6632                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6633             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6634         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6635             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6636         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6637             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6638             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6639         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6640         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6641         16  FILLER                         PIC X(536).
  6642
  6643****************************************************************
  6644*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6645****************************************************************
  6646
  6647     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6648         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6649             20  CF-FEMALE-HEIGHT.
  6650                 24  CF-FEMALE-FT           PIC 99.
  6651                 24  CF-FEMALE-IN           PIC 99.
  6652             20  CF-FEMALE-MIN-WT           PIC 999.
  6653             20  CF-FEMALE-MAX-WT           PIC 999.
  6654         16  FILLER                         PIC X(428).
  6655
  6656     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6657         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6658             20  CF-MALE-HEIGHT.
  6659                 24  CF-MALE-FT             PIC 99.
  6660                 24  CF-MALE-IN             PIC 99.
  6661             20  CF-MALE-MIN-WT             PIC 999.
  6662             20  CF-MALE-MAX-WT             PIC 999.
  6663         16  FILLER                         PIC X(428).
  6664******************************************************************
  6665*             AUTOMATIC ACTIVITY RECORD                          *
  6666******************************************************************
  6667     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6668         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6669             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6670             20  CF-SYS-LETTER-ID           PIC X(04).
  6671             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6672             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6673             20  CF-SYS-RESET-SW            PIC X(01).
  6674             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6675             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6676
  6677         16  FILLER                         PIC X(50).
  6678
  6679         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6680             20  CF-USER-ACTIVE-SW          PIC X(01).
  6681             20  CF-USER-LETTER-ID          PIC X(04).
  6682             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6683             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6684             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 123
* EL050.cbl
  6685             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6686             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6687             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6688
  6689         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 124
* EL050.cbl
  6691*    COPY ERCACCT.
  6692******************************************************************
  6693*                                                                *
  6694*                                                                *
  6695*                            ERCACCT                             *
  6696*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6697*                            VMOD=2.031                          *
  6698*                                                                *
  6699*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6700*                                                                *
  6701*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6702*   VSAM ACCOUNT MASTER FILES.                                   *
  6703*                                                                *
  6704*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6705*                                                                *
  6706*   FILE TYPE = VSAM,KSDS                                        *
  6707*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6708*                                                                *
  6709*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6710*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6711*                                                                *
  6712*   LOG = NO                                                     *
  6713*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6714*                                                                *
  6715*                                                                *
  6716******************************************************************
  6717*                   C H A N G E   L O G
  6718*
  6719* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6720*-----------------------------------------------------------------
  6721*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6722* EFFECTIVE    NUMBER
  6723*-----------------------------------------------------------------
  6724* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6725* 092705    2005050300006  PEMA  ADD SPP LEASES
  6726* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6727* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6728* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6729* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6730* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6731* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6732******************************************************************
  6733
  6734 01  ACCOUNT-MASTER.
  6735     12  AM-RECORD-ID                      PIC XX.
  6736         88  VALID-AM-ID                      VALUE 'AM'.
  6737
  6738     12  AM-CONTROL-PRIMARY.
  6739         16  AM-COMPANY-CD                 PIC X.
  6740         16  AM-MSTR-CNTRL.
  6741             20  AM-CONTROL-A.
  6742                 24  AM-CARRIER            PIC X.
  6743                 24  AM-GROUPING.
  6744                     28 AM-GROUPING-PREFIX PIC XXX.
  6745                     28 AM-GROUPING-PRIME  PIC XXX.
  6746                 24  AM-STATE              PIC XX.
  6747                 24  AM-ACCOUNT.
  6748                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 125
* EL050.cbl
  6749                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6750             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6751                                           PIC X(19).
  6752             20  AM-CNTRL-B.
  6753                 24  AM-EXPIRATION-DT      PIC XX.
  6754                 24  FILLER                PIC X(4).
  6755             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6756                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6757
  6758     12  AM-CONTROL-BY-VAR-GRP.
  6759         16  AM-COMPANY-CD-A1              PIC X.
  6760         16  AM-VG-CARRIER                 PIC X.
  6761         16  AM-VG-GROUPING                PIC X(6).
  6762         16  AM-VG-STATE                   PIC XX.
  6763         16  AM-VG-ACCOUNT                 PIC X(10).
  6764         16  AM-VG-DATE.
  6765             20  AM-VG-EXPIRATION-DT       PIC XX.
  6766             20  FILLER                    PIC X(4).
  6767         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6768                                           PIC 9(11)      COMP-3.
  6769     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6770         16  FILLER                        PIC X(10).
  6771         16  AM-VG-KEY3.
  6772             20  AM-VG3-ACCOUNT            PIC X(10).
  6773             20  AM-VG3-EXP-DT             PIC XX.
  6774         16  FILLER                        PIC X(4).
  6775     12  AM-MAINT-INFORMATION.
  6776         16  AM-LAST-MAINT-DT              PIC XX.
  6777         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6778         16  AM-LAST-MAINT-USER            PIC X(4).
  6779         16  FILLER                        PIC XX.
  6780
  6781     12  AM-EFFECTIVE-DT                   PIC XX.
  6782     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6783
  6784     12  AM-PREV-DATES  COMP-3.
  6785         16  AM-PREV-EXP-DT                PIC 9(11).
  6786         16  AM-PREV-EFF-DT                PIC 9(11).
  6787
  6788     12  AM-REPORT-CODE-1                  PIC X(10).
  6789     12  AM-REPORT-CODE-2                  PIC X(10).
  6790
  6791     12  AM-CITY-CODE                      PIC X(4).
  6792     12  AM-COUNTY-PARISH                  PIC X(6).
  6793
  6794     12  AM-NAME                           PIC X(30).
  6795     12  AM-PERSON                         PIC X(30).
  6796     12  AM-ADDRS                          PIC X(30).
  6797     12  AM-CITY.
  6798         16  AM-ADDR-CITY                  PIC X(28).
  6799         16  AM-ADDR-STATE                 PIC XX.
  6800     12  AM-ZIP.
  6801         16  AM-ZIP-PRIME.
  6802             20  AM-ZIP-PRI-1ST            PIC X.
  6803                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6804             20  FILLER                    PIC X(4).
  6805         16  AM-ZIP-PLUS4                  PIC X(4).
  6806     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 126
* EL050.cbl
  6807         16  AM-CAN-POSTAL-1               PIC XXX.
  6808         16  AM-CAN-POSTAL-2               PIC XXX.
  6809         16  FILLER                        PIC XXX.
  6810     12  AM-TEL-NO.
  6811         16  AM-AREA-CODE                  PIC 999.
  6812         16  AM-TEL-PRE                    PIC 999.
  6813         16  AM-TEL-NBR                    PIC 9(4).
  6814     12  AM-TEL-LOC                        PIC X.
  6815         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6816         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6817
  6818     12  AM-COMM-STRUCTURE.
  6819         16  AM-DEFN-1.
  6820             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6821                 24  AM-AGT.
  6822                     28  AM-AGT-PREFIX     PIC X(4).
  6823                     28  AM-AGT-PRIME      PIC X(6).
  6824                 24  AM-COM-TYP            PIC X.
  6825                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6826                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6827                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6828                 24  AM-RECALC-LV-INDIC    PIC X.
  6829                 24  AM-RETRO-LV-INDIC     PIC X.
  6830                 24  AM-GL-CODES           PIC X.
  6831                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6832                 24  FILLER                PIC X(01).
  6833         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6834             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6835                 24  FILLER                PIC X(11).
  6836                 24  AM-L-COMA             PIC XXX.
  6837                 24  AM-J-COMA             PIC XXX.
  6838                 24  AM-A-COMA             PIC XXX.
  6839                 24  FILLER                PIC X(6).
  6840
  6841     12  AM-COMM-CHANGE-STATUS             PIC X.
  6842         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6843
  6844     12  AM-CSR-CODE                       PIC X(4).
  6845
  6846     12  AM-BILLING-STATUS                 PIC X.
  6847         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6848         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6849     12  AM-AUTO-REFUND-SW                 PIC X.
  6850         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6851         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6852     12  AM-GPCD                           PIC 99.
  6853     12  AM-IG                             PIC X.
  6854         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6855         88  AM-HAS-GROUP                     VALUE '2'.
  6856     12  AM-STATUS                         PIC X.
  6857         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6858         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6859         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6860         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6861         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6862         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6863         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6864         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 127
* EL050.cbl
  6865         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6866         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6867     12  AM-REMIT-TO                       PIC 99.
  6868     12  AM-ID-NO                          PIC X(11).
  6869
  6870     12  AM-CAL-TABLE                      PIC XX.
  6871     12  AM-LF-DEVIATION                   PIC XXX.
  6872     12  AM-AH-DEVIATION                   PIC XXX.
  6873     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6874     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6875     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6876     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6877     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6878     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6879
  6880     12  AM-USER-FIELDS.
  6881         16  AM-FLD-1                      PIC XX.
  6882         16  AM-FLD-2                      PIC XX.
  6883         16  AM-FLD-3                      PIC XX.
  6884         16  AM-FLD-4                      PIC XX.
  6885         16  AM-FLD-5                      PIC XX.
  6886
  6887     12  AM-1ST-PROD-DATE.
  6888         16  AM-1ST-PROD-YR                PIC XX.
  6889         16  AM-1ST-PROD-MO                PIC XX.
  6890         16  AM-1ST-PROD-DA                PIC XX.
  6891     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6892     12  AM-CERTS-PURGED-DATE.
  6893         16  AM-PUR-YR                     PIC XX.
  6894         16  AM-PUR-MO                     PIC XX.
  6895         16  AM-PUR-DA                     PIC XX.
  6896     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6897     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6898     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6899     12  AM-INACTIVE-DATE.
  6900         16  AM-INA-MO                     PIC 99.
  6901         16  AM-INA-DA                     PIC 99.
  6902         16  AM-INA-YR                     PIC 99.
  6903     12  AM-AR-HI-CERT-DATE                PIC XX.
  6904
  6905     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6906     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6907
  6908     12  AM-OB-PAYMENT-MODE                PIC X.
  6909         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6910         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6911         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6912         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6913
  6914     12  AM-AH-ONLY-INDICATOR              PIC X.
  6915         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6916         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6917
  6918     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6919
  6920     12  AM-OVER-SHORT.
  6921         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6922         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 128
* EL050.cbl
  6923
  6924     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6925     12  AM-DCC-CLP-STATE                  PIC XX.
  6926
  6927     12  AM-RECALC-COMM                    PIC X.
  6928     12  AM-RECALC-REIN                    PIC X.
  6929
  6930     12  AM-REI-TABLE                      PIC XXX.
  6931     12  AM-REI-ET-LF                      PIC X.
  6932     12  AM-REI-ET-AH                      PIC X.
  6933     12  AM-REI-PE-LF                      PIC X.
  6934     12  AM-REI-PE-AH                      PIC X.
  6935     12  AM-REI-PRT-ST                     PIC X.
  6936     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6937     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6938     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6939     12  AM-REI-GROUP-A                    PIC X(6).
  6940     12  AM-REI-MORT                       PIC X(4).
  6941     12  AM-REI-PRT-OW                     PIC X.
  6942     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6943     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6944     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6945     12  AM-REI-GROUP-B                    PIC X(6).
  6946
  6947     12  AM-TRUST-TYPE                     PIC X(2).
  6948
  6949     12  AM-EMPLOYER-STMT-USED             PIC X.
  6950     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6951
  6952     12  AM-STD-AH-TYPE                    PIC XX.
  6953     12  AM-EARN-METHODS.
  6954         16  AM-EARN-METHOD-R              PIC X.
  6955             88 AM-REF-RL-R78                 VALUE 'R'.
  6956             88 AM-REF-RL-PR                  VALUE 'P'.
  6957             88 AM-REF-RL-MEAN                VALUE 'M'.
  6958             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6959         16  AM-EARN-METHOD-L              PIC X.
  6960             88 AM-REF-LL-R78                 VALUE 'R'.
  6961             88 AM-REF-LL-PR                  VALUE 'P'.
  6962             88 AM-REF-LL-MEAN                VALUE 'M'.
  6963             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6964         16  AM-EARN-METHOD-A              PIC X.
  6965             88 AM-REF-AH-R78                 VALUE 'R'.
  6966             88 AM-REF-AH-PR                  VALUE 'P'.
  6967             88 AM-REF-AH-MEAN                VALUE 'M'.
  6968             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6969             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6970             88 AM-REF-AH-NET                 VALUE 'N'.
  6971
  6972     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6973     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6974     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6975
  6976     12  AM-RET-Y-N                        PIC X.
  6977     12  AM-RET-P-E                        PIC X.
  6978     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6979     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6980     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 129
* EL050.cbl
  6981     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6982         16  AM-POOL-PRIME                 PIC XXX.
  6983         16  AM-POOL-SUB                   PIC XXX.
  6984     12  AM-RETRO-EARNINGS.
  6985         16  AM-RET-EARN-R                 PIC X.
  6986         16  AM-RET-EARN-L                 PIC X.
  6987         16  AM-RET-EARN-A                 PIC X.
  6988     12  AM-RET-ST-TAX-USE                 PIC X.
  6989         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6990         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6991     12  AM-RETRO-BEG-EARNINGS.
  6992         16  AM-RET-BEG-EARN-R             PIC X.
  6993         16  AM-RET-BEG-EARN-L             PIC X.
  6994         16  AM-RET-BEG-EARN-A             PIC X.
  6995     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6996     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6997
  6998     12  AM-USER-SELECT-OPTIONS.
  6999         16  AM-USER-SELECT-1              PIC X(10).
  7000         16  AM-USER-SELECT-2              PIC X(10).
  7001         16  AM-USER-SELECT-3              PIC X(10).
  7002         16  AM-USER-SELECT-4              PIC X(10).
  7003         16  AM-USER-SELECT-5              PIC X(10).
  7004
  7005     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7006
  7007     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7008
  7009     12  AM-RPT045A-SWITCH                 PIC X.
  7010         88  RPT045A-OFF                   VALUE 'N'.
  7011
  7012     12  AM-INSURANCE-LIMITS.
  7013         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7014         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7015
  7016     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7017         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7018
  7019     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7020         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7021         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7022
  7023     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7024
  7025     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7026     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7027     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7028     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7029     12  AM-DCC-UEF-STATE                  PIC XX.
  7030     12  FILLER                            PIC XXX.
  7031     12  AM-REPORT-CODE-3                  PIC X(10).
  7032*    12  FILLER                            PIC X(22).
  7033
  7034     12  AM-RESERVE-DATE.
  7035         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7036         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7037         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7038
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 130
* EL050.cbl
  7039     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7040     12  AM-NOTIFICATION-TYPES.
  7041         16  AM-NOTIF-OF-LETTERS           PIC X.
  7042         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7043         16  AM-NOTIF-OF-REPORTS           PIC X.
  7044         16  AM-NOTIF-OF-STATUS            PIC X.
  7045
  7046     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7047         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7048         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7049         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7050         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7051
  7052     12  AM-BENEFIT-CONTROLS.
  7053         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7054             20  AM-BENEFIT-CODE           PIC XX.
  7055             20  AM-BENEFIT-TYPE           PIC X.
  7056             20  AM-BENEFIT-REVISION       PIC XXX.
  7057             20  AM-BENEFIT-REM-TERM       PIC X.
  7058             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7059             20  FILLER                    PIC XX.
  7060         16  FILLER                        PIC X(80).
  7061
  7062     12  AM-TRANSFER-DATA.
  7063         16  AM-TRANSFERRED-FROM.
  7064             20  AM-TRNFROM-CARRIER        PIC X.
  7065             20  AM-TRNFROM-GROUPING.
  7066                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7067                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7068             20  AM-TRNFROM-STATE          PIC XX.
  7069             20  AM-TRNFROM-ACCOUNT.
  7070                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7071                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7072             20  AM-TRNFROM-DTE            PIC XX.
  7073         16  AM-TRANSFERRED-TO.
  7074             20  AM-TRNTO-CARRIER          PIC X.
  7075             20  AM-TRNTO-GROUPING.
  7076                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7077                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7078             20  AM-TRNTO-STATE            PIC XX.
  7079             20  AM-TRNTO-ACCOUNT.
  7080                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7081                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7082             20  AM-TRNTO-DTE              PIC XX.
  7083         16  FILLER                        PIC X(10).
  7084
  7085     12  AM-SAVED-REMIT-TO                 PIC 99.
  7086
  7087     12  AM-COMM-STRUCTURE-SAVED.
  7088         16  AM-DEFN-1-SAVED.
  7089             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7090                 24  AM-AGT-SV             PIC X(10).
  7091                 24  AM-COM-TYP-SV         PIC X.
  7092                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7093                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7094                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7095                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7096                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 131
* EL050.cbl
  7097                 24  AM-GL-CODES-SV        PIC X.
  7098                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7099                 24  FILLER                PIC X.
  7100         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7101             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7102                 24  FILLER                PIC X(11).
  7103                 24  AM-L-COMA-SV          PIC XXX.
  7104                 24  AM-J-COMA-SV          PIC XXX.
  7105                 24  AM-A-COMA-SV          PIC XXX.
  7106                 24  FILLER                PIC X(6).
  7107
  7108     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7109         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7110            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7111            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7112            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7113
  7114     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7115     12  FILLER                            PIC X(120).
  7116
  7117     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7118         16  AM-CONTROL-NAME               PIC X(30).
  7119         16  AM-EXECUTIVE-ONE.
  7120             20  AM-EXEC1-NAME             PIC X(15).
  7121             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7122                                                          COMP-3.
  7123             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7124                                                          COMP-3.
  7125         16  AM-EXECUTIVE-TWO.
  7126             20  AM-EXEC2-NAME             PIC X(15).
  7127             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7128                                                          COMP-3.
  7129             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7130                                                          COMP-3.
  7131
  7132     12  AM-RETRO-ADDITIONAL-DATA.
  7133         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7134         16  AM-RETRO-PREM-P-E             PIC X.
  7135         16  AM-RETRO-CLMS-P-I             PIC X.
  7136         16  AM-RETRO-RET-BRACKET-LF.
  7137             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7138                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7139                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7140             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7141                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7142                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7143             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7144                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7145                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7146         16  AM-RETRO-RET-BRACKET-AH.
  7147             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7148                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7149                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7150                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7151             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7152                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7153                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7154             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 132
* EL050.cbl
  7155                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7156                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7157
  7158     12  AM-COMMENTS.
  7159         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7160
  7161     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7162         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7163         16  AM-FLI-BILLING-CODE           PIC X.
  7164         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7165         16  AM-FLI-UNITED-IDENT           PIC X.
  7166         16  AM-FLI-INTEREST-LOST-DATA.
  7167             20  AM-FLI-BANK-NO            PIC X(5).
  7168             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7169             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7170             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7171         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7172             20  AM-FLI-AGT                PIC X(9).
  7173             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7174             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7175         16  FILLER                        PIC X(102).
  7176
  7177     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7178         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7179             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7180             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7181             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7182             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7183             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7184         16  FILLER                          PIC X(10).
  7185******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 133
* EL050.cbl
  7187*    COPY ERCREIN.
  7188******************************************************************
  7189*                                                                *
  7190*                            ERCREIN                             *
  7191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7192*                            VMOD=2.010                          *
  7193*                                                                *
  7194*   ONLINE CREDIT SYSTEM                                         *
  7195*                                                                *
  7196*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7197*                                                                *
  7198*   FILE TYPE = VSAM,KSDS                                        *
  7199*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7200*                                                                *
  7201*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7202*       ALTERNATE PATH = NONE                                    *
  7203*                                                                *
  7204*   LOG = NO                                                     *
  7205*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7206*                                                                *
  7207******************************************************************
  7208*                   C H A N G E   L O G
  7209*
  7210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7211*-----------------------------------------------------------------
  7212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7213* EFFECTIVE    NUMBER
  7214*-----------------------------------------------------------------
  7215* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7216* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7217******************************************************************
  7218 01  REINSURANCE-RECORD.
  7219     12  RE-RECORD-ID                      PIC XX.
  7220         88  VALID-RE-ID                      VALUE 'RE'.
  7221
  7222     12  RE-CONTROL-PRIMARY.
  7223         16  RE-COMPANY-CD                 PIC X.
  7224         16  RE-KEY.
  7225             20  RE-CODE                   PIC X.
  7226                 88  RE-TABLE-RECORD          VALUE 'A'.
  7227                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7228             20  RE-TABLE                  PIC XXX.
  7229             20  FILLER                    PIC XXX.
  7230         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7231             20  FILLER                    PIC X.
  7232             20  RE-COMPANY.
  7233                 24  RE-COMP-PRIME         PIC XXX.
  7234                 24  RE-COMP-SUB           PIC XXX.
  7235
  7236     12  RE-MAINT-INFORMATION.
  7237         16  RE-LAST-MAINT-DT              PIC XX.
  7238         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7239         16  RE-LAST-MAINT-USER            PIC X(4).
  7240         16  FILLER                        PIC X(10).
  7241
  7242     12  RE-TABLE-DATA.
  7243         16  RE-100-COMP                   PIC 99.
  7244
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 134
* EL050.cbl
  7245         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7246             20  RE-REI-COMP-NO.
  7247                 24  RE-REI-COMP           PIC XXX.
  7248                 24  RE-REI-COMP-SUB       PIC XXX.
  7249             20  RE-LF-QC                  PIC X.
  7250             20  RE-AH-QC                  PIC X.
  7251             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7252             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7253             20  RE-LFAGE-LO               PIC 99.
  7254             20  RE-LFAGE-HI               PIC 99.
  7255             20  RE-AHAGE-LO               PIC 99.
  7256             20  RE-AHAGE-HI               PIC 99.
  7257             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7258             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7259             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7260             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7261             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7262             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7263             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7264             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7265             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7266             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7267             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7268             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7269             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7270             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7271             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7272             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7273             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7274             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7275             20  RE-LF-BEN-CODE            PIC X.
  7276             20  RE-AH-BEN-CODE            PIC X.
  7277             20  RE-INTERACTIVE            PIC X.
  7278             20  RE-REMAINING              PIC X.
  7279             20  RE-LF-RUNOFF-SW           PIC X.
  7280             20  RE-AH-RUNOFF-SW           PIC X.
  7281             20  FILLER                    PIC X(19).
  7282
  7283         16  RE-COMP-INFO-END              PIC X(6).
  7284         16  RE-NSP-ST-CD-LF               PIC XX.
  7285         16  RE-NSP-ST-CD-AH               PIC XX.
  7286         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7287             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7288
  7289         16  FILLER                        PIC X(27).
  7290
  7291     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7292         16  RE-NAME                       PIC X(30).
  7293         16  RE-LF-PE                      PIC X.
  7294         16  RE-AH-PE                      PIC X.
  7295         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7296         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7297         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7298         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7299         16  RE-PRT-ST                     PIC X.
  7300         16  RE-PRT-OW                     PIC X.
  7301         16  RE-MORT-CODE                  PIC X(4).
  7302         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 135
* EL050.cbl
  7303         16  RE-ZERO-LF-FEE                PIC X.
  7304         16  RE-ZERO-AH-FEE                PIC X.
  7305         16  RE-CEDE-NAME                  PIC X(30).
  7306         16  RE-LF-COMM                    PIC X.
  7307         16  RE-AH-COMM                    PIC X.
  7308         16  RE-LF-TAX                     PIC X.
  7309         16  RE-AH-TAX                     PIC X.
  7310         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7311         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7312         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7313
  7314         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7315             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7316
  7317         16  RE-LF-CEDING-FEE-BRACKETS.
  7318             20  RE-LF-FEE-METHOD          PIC X.
  7319                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7320                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7321                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7322                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7323             20  RE-LF-FEE-BASIS           PIC X.
  7324                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7325                 88  RE-LF-NET-CEDED               VALUE '2'.
  7326                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7327                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7328                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7329                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7330                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7331                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7332             20  FILLER                    PIC XXX.
  7333             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7334                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7335                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7336
  7337         16  RE-AH-CEDING-FEE-BRACKETS.
  7338             20  RE-AH-FEE-METHOD          PIC X.
  7339                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7340                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7341                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7342                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7343             20  RE-AH-FEE-BASIS           PIC X.
  7344                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7345                 88  RE-AH-NET-CEDED               VALUE '2'.
  7346                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7347                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7348                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7349                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7350                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7351                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7352             20  FILLER                    PIC XXX.
  7353             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7354                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7355                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7356
  7357         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7358
  7359         16  RE-OLD-CEDING-STMT            PIC X.
  7360
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 136
* EL050.cbl
  7361         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7362         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7363         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7364         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7365         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7366         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7367         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7368         16  RE-MORT-SW                    PIC X.
  7369         16  RE-CEDING-TYPE-FLAG           PIC X.
  7370             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7371             88  RE-CEDED                          VALUE 'C'.
  7372             88  RE-ASSUMED                        VALUE 'A'.
  7373             88  RE-PHANTOM                        VALUE 'P'.
  7374
  7375         16  RE-CEDING-STMT-OPT-A          PIC X.
  7376             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7377         16  RE-CEDING-STMT-OPT-B          PIC X.
  7378             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7379         16  RE-CEDING-STMT-OPT-C          PIC X.
  7380             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7381         16  RE-CEDING-STMT-OPT-D          PIC X.
  7382             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7383         16  RE-CEDING-STMT-OPT-E          PIC X.
  7384             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7385
  7386         16  RE-PRT-CRSV                   PIC X.
  7387
  7388         16  RE-GL-CENTER                  PIC X(4).
  7389
  7390         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7391
  7392         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7393
  7394         16  RE-EARN-STOP-CODE             PIC X.
  7395             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7396             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7397
  7398         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7399             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7400
  7401         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7402         16  FILLER                        PIC X(2281).
  7403
  7404         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7405
  7406******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 137
* EL050.cbl
  7408*    COPY ERCCTBL.
  7409******************************************************************
  7410*                                                                *
  7411*                                                                *
  7412*                            ERCCTBL                             *
  7413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7414*                            VMOD=2.003
  7415*                                                                *
  7416*   ONLINE CREDIT SYSTEM                                         *
  7417*                                                                *
  7418*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7419*                                                                *
  7420*   FILE TYPE = VSAM,KSDS                                        *
  7421*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7422*                                                                *
  7423*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7424*       ALTERNATE PATH = NONE                                    *
  7425*                                                                *
  7426*   LOG = NO                                                     *
  7427*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7428*                                                                *
  7429*                                                                *
  7430******************************************************************
  7431
  7432 01  COMM-TABLE-RECORD.
  7433     12  CT-RECORD-ID                      PIC XX.
  7434         88  VALID-CT-ID                      VALUE 'CT'.
  7435
  7436     12  CT-CONTROL-PRIMARY.
  7437         16  CT-COMPANY-CD                 PIC X.
  7438         16  CT-TABLE                      PIC XXX.
  7439         16  CT-CNTRL-2.
  7440             20  CT-BEN-TYPE               PIC X.
  7441             20  CT-BEN-CODE               PIC XX.
  7442
  7443     12  CT-MAINT-INFORMATION.
  7444         16  CT-LAST-MAINT-DT              PIC XX.
  7445         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7446         16  CT-LAST-MAINT-USER            PIC X(4).
  7447         16  FILLER                        PIC X(31).
  7448
  7449     12  CT-LIMITS.
  7450         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7451
  7452         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7453
  7454         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7455
  7456     12  CT-RATES.
  7457         16  CT-RTX          OCCURS 27 TIMES.
  7458             20  CT-RT                     PIC SV9(5)     COMP-3.
  7459             20  CT-RT-R   REDEFINES
  7460                 CT-RT                     PIC XXX.
  7461
  7462     12  FILLER                            PIC  X(42).
  7463
  7464******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 138
* EL050.cbl
  7466*    COPY ERCFORM.
  7467******************************************************************
  7468*                                                                *
  7469*                                                                *
  7470*                            ERCFORM.                            *
  7471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7472*                            VMOD=2.003                          *
  7473*                                                                *
  7474*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7475*                                                                *
  7476*    FILE TYPE = VSAM,KSDS                                       *
  7477*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7478*                                                                *
  7479*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7480*                                                                *
  7481*    LOG = YES                                                   *
  7482*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7483******************************************************************
  7484 01  FORM-MASTER.
  7485    12  FO-RECORD-ID                 PIC X(02).
  7486        88  VALID-FO-ID                  VALUE 'FO'.
  7487
  7488    12  FO-CONTROL-PRIMARY.
  7489        16  FO-COMPANY-CD            PIC X(01).
  7490        16  FO-STATE                 PIC X(02).
  7491        16  FO-FORM-ID               PIC X(12).
  7492        16  FO-FORM-EXP-DT           PIC X(02).
  7493
  7494    12  FO-POLICY-FORM-DATA.
  7495        16  FO-IND-GRP-CD            PIC X(01).
  7496        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7497        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7498        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7499        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7500        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7501        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7502        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7503        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7504        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7505        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7506        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7507        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7508        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7509        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7510        16  FO-APP-CERT-USE-CD       PIC X(01).
  7511
  7512    12  FILLER                       PIC X(29).
  7513
  7514    12  FO-FORM-PLAN-TABLE.
  7515        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7516            20  FO-PLAN-TYPE         PIC X(01).
  7517            20  FO-PLAN-ID           PIC X(02).
  7518            20  FO-PLAN-TERM         PIC 9(03).
  7519            20  FO-PLAN-REFUND-METHOD
  7520                                     PIC X.
  7521
  7522    12  FILLER                       PIC X(30).
  7523
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 139
* EL050.cbl
  7524    12  FO-COMMENTS-AREA.
  7525        16  FO-COMMENT-LINE-1        PIC X(78).
  7526
  7527    12  FILLER                       PIC X(20).
  7528
  7529    12  FO-MAINT-INFORMATION.
  7530        16  FO-LAST-MAINT-DT         PIC X(02).
  7531        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7532        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 140
* EL050.cbl
  7534*    COPY ELCMSTR.
  7535******************************************************************
  7536*                                                                *
  7537*                            ELCMSTR.                            *
  7538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7539*                            VMOD=2.012                          *
  7540*                                                                *
  7541*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7542*                                                                *
  7543*   FILE TYPE = VSAM,KSDS                                        *
  7544*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7545*                                                                *
  7546*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7547*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7548*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7549*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7550*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7551*                                                 RKP=75,LEN=21  *
  7552*                                                                *
  7553*   **** NOTE ****                                               *
  7554*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7555*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7556*                                                                *
  7557*   LOG = YES                                                    *
  7558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7559******************************************************************
  7560*                   C H A N G E   L O G
  7561*
  7562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7563*-----------------------------------------------------------------
  7564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7565* EFFECTIVE    NUMBER
  7566*-----------------------------------------------------------------
  7567* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7568* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7569* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7570* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7571* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7572* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7573* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7574******************************************************************
  7575 01  CLAIM-MASTER.
  7576     12  CL-RECORD-ID                PIC XX.
  7577         88  VALID-CL-ID         VALUE 'CL'.
  7578
  7579     12  CL-CONTROL-PRIMARY.
  7580         16  CL-COMPANY-CD           PIC X.
  7581         16  CL-CARRIER              PIC X.
  7582         16  CL-CLAIM-NO             PIC X(7).
  7583         16  CL-CERT-NO.
  7584             20  CL-CERT-PRIME       PIC X(10).
  7585             20  CL-CERT-SFX         PIC X.
  7586
  7587     12  CL-CONTROL-BY-NAME.
  7588         16  CL-COMPANY-CD-A1        PIC X.
  7589         16  CL-INSURED-LAST-NAME    PIC X(15).
  7590         16  CL-INSURED-NAME.
  7591             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 141
* EL050.cbl
  7592             20  CL-INSURED-MID-INIT PIC X.
  7593
  7594     12  CL-CONTROL-BY-SSN.
  7595         16  CL-COMPANY-CD-A2        PIC X.
  7596         16  CL-SOC-SEC-NO.
  7597             20  CL-SSN-STATE        PIC XX.
  7598             20  CL-SSN-ACCOUNT      PIC X(6).
  7599             20  CL-SSN-LN3          PIC X(3).
  7600
  7601     12  CL-CONTROL-BY-CERT-NO.
  7602         16  CL-COMPANY-CD-A4        PIC X.
  7603         16  CL-CERT-NO-A4.
  7604             20  CL-CERT-A4-PRIME    PIC X(10).
  7605             20  CL-CERT-A4-SFX      PIC X.
  7606
  7607     12  CL-CONTROL-BY-CCN.
  7608         16  CL-COMPANY-CD-A5        PIC X.
  7609         16  CL-CCN-A5.
  7610             20  CL-CCN.
  7611                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7612                 24  CL-CCN-PRIME-A5 PIC X(12).
  7613             20  CL-CCN-FILLER-A5    PIC X(4).
  7614
  7615     12  CL-INSURED-PROFILE-DATA.
  7616         16  CL-INSURED-BIRTH-DT     PIC XX.
  7617         16  CL-INSURED-SEX-CD       PIC X.
  7618             88  INSURED-IS-MALE        VALUE 'M'.
  7619             88  INSURED-IS-FEMALE      VALUE 'F'.
  7620             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7621         16  CL-INSURED-OCC-CD       PIC X(6).
  7622         16  FILLER                  PIC X(5).
  7623
  7624     12  CL-PROCESSING-INFO.
  7625         16  CL-PROCESSOR-ID         PIC X(4).
  7626         16  CL-CLAIM-STATUS         PIC X.
  7627             88  CLAIM-IS-OPEN          VALUE 'O'.
  7628             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7629         16  CL-CLAIM-TYPE           PIC X.
  7630*            88  AH-CLAIM               VALUE 'A'.
  7631*            88  LIFE-CLAIM             VALUE 'L'.
  7632*            88  PROPERTY-CLAIM         VALUE 'P'.
  7633*            88  IUI-CLAIM              VALUE 'I'.
  7634*            88  GAP-CLAIM              VALUE 'G'.
  7635*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7636*            88  OTHER-CLAIM            VALUE 'O'.
  7637         16  CL-CLAIM-PREM-TYPE      PIC X.
  7638             88  SINGLE-PREMIUM         VALUE '1'.
  7639             88  O-B-COVERAGE           VALUE '2'.
  7640             88  OPEN-END-COVERAGE      VALUE '3'.
  7641         16  CL-INCURRED-DT          PIC XX.
  7642         16  CL-REPORTED-DT          PIC XX.
  7643         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7644         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7645         16  CL-LAST-PMT-DT          PIC XX.
  7646         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7647         16  CL-PAID-THRU-DT         PIC XX.
  7648         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7649         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 142
* EL050.cbl
  7650         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7651         16  CL-PMT-CALC-METHOD      PIC X.
  7652             88  CL-360-DAY-YR          VALUE '1'.
  7653             88  CL-365-DAY-YR          VALUE '2'.
  7654             88  CL-FULL-MONTHS         VALUE '3'.
  7655         16  CL-CAUSE-CD             PIC X(6).
  7656
  7657         16  CL-PRIME-CERT-NO.
  7658             20  CL-PRIME-CERT-PRIME PIC X(10).
  7659             20  CL-PRIME-CERT-SFX   PIC X.
  7660
  7661         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7662             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7663             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7664
  7665         16  CL-MICROFILM-NO         PIC X(10).
  7666         16  FILLER REDEFINES CL-MICROFILM-NO.
  7667             20  CL-BENEFIT-PERIOD   PIC 99.
  7668             20  FILLER              PIC X(8).
  7669         16  CL-PROG-FORM-TYPE       PIC X.
  7670         16  CL-LAST-ADD-ON-DT       PIC XX.
  7671
  7672         16  CL-LAST-REOPEN-DT       PIC XX.
  7673         16  CL-LAST-CLOSE-DT        PIC XX.
  7674         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7675             88  FINAL-PAID             VALUE '1'.
  7676             88  CLAIM-DENIED           VALUE '2'.
  7677             88  AUTO-CLOSE             VALUE '3'.
  7678             88  MANUAL-CLOSE           VALUE '4'.
  7679             88  BENEFITS-CHANGED       VALUE 'C'.
  7680             88  SETUP-ERRORS           VALUE 'E'.
  7681         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7682         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7683         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7684             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7685         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7686         16  FILLER                  PIC X.
  7687
  7688     12  CL-CERTIFICATE-DATA.
  7689         16  CL-CERT-ORIGIN          PIC X.
  7690             88  CERT-WAS-ONLINE        VALUE '1'.
  7691             88  CERT-WAS-CREATED       VALUE '2'.
  7692             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7693         16  CL-CERT-KEY-DATA.
  7694             20  CL-CERT-CARRIER     PIC X.
  7695             20  CL-CERT-GROUPING    PIC X(6).
  7696             20  CL-CERT-STATE       PIC XX.
  7697             20  CL-CERT-ACCOUNT.
  7698                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7699                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7700             20  CL-CERT-EFF-DT      PIC XX.
  7701
  7702     12  CL-STATUS-CONTROLS.
  7703         16  CL-PRIORITY-CD          PIC X.
  7704             88  CONFIDENTIAL-DATA      VALUE '8'.
  7705             88  HIGHEST-PRIORITY       VALUE '9'.
  7706         16  CL-SUPV-ATTN-CD         PIC X.
  7707             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 143
* EL050.cbl
  7708             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7709         16  CL-PURGED-DT            PIC XX.
  7710         16  CL-RESTORED-DT          PIC XX.
  7711         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7712         16  CL-NEXT-RESEND-DT       PIC XX.
  7713         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7714         16  CL-CRITICAL-PERIOD      PIC 99.
  7715*        16  FILLER                  PIC XX.
  7716         16  CL-LAST-MAINT-DT        PIC XX.
  7717         16  CL-LAST-MAINT-USER      PIC X(4).
  7718         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7719         16  CL-LAST-MAINT-TYPE      PIC X.
  7720             88  CLAIM-SET-UP           VALUE ' '.
  7721             88  PAYMENT-MADE           VALUE '1'.
  7722             88  LETTER-SENT            VALUE '2'.
  7723             88  MASTER-WAS-ALTERED     VALUE '3'.
  7724             88  MASTER-WAS-RESTORED    VALUE '4'.
  7725             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7726             88  FILE-CONVERTED         VALUE '6'.
  7727             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7728             88  ERROR-CORRECTION       VALUE 'E'.
  7729         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7730         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7731         16  CL-BENEFICIARY          PIC X(10).
  7732         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7733         16  CL-DENIAL-TYPE          PIC X.
  7734             88  CL-TYPE-DENIAL          VALUE '1'.
  7735             88  CL-TYPE-RESCISSION      VALUE '2'.
  7736             88  CL-TYPE-REFORMATION     VALUE '3'.
  7737             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7738             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7739         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7740         16  filler                  pic x(3).
  7741*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7742*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7743*        16  CL-RTW-DT               PIC XX.
  7744
  7745     12  CL-TRAILER-CONTROLS.
  7746         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7747             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7748             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7749             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7750         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7751         16  FILLER                  PIC XX.
  7752         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7753         16  CL-ADDRESS-TRAILER-CNT.
  7754             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7755                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7756             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7757                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7758             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7759                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7760             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7761                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7762             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7763                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7764             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7765                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 144
* EL050.cbl
  7766             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7767                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7768
  7769     12  CL-CV-REFERENCE-NO.
  7770         16  CL-CV-REFNO-PRIME       PIC X(18).
  7771         16  CL-CV-REFNO-SFX         PIC XX.
  7772
  7773     12  CL-FILE-LOCATION            PIC X(4).
  7774
  7775     12  CL-PROCESS-ERRORS.
  7776         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7777             88  NO-FATAL-ERRORS        VALUE ZERO.
  7778         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7779             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7780
  7781     12  CL-PRODUCT-CD               PIC X.
  7782
  7783     12  CL-CURRENT-KEY-DATA.
  7784         16  CL-CURRENT-CARRIER      PIC X.
  7785         16  CL-CURRENT-GROUPING     PIC X(6).
  7786         16  CL-CURRENT-STATE        PIC XX.
  7787         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7788
  7789     12  CL-ASSOCIATES               PIC X.
  7790         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7791         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7792         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7793         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7794
  7795     12  CL-ACTIVITY-CODE            PIC 99.
  7796     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7797     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7798
  7799     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7800     12  CL-LAG-REPORT-CODE          PIC 9.
  7801     12  CL-LOAN-TYPE                PIC XX.
  7802     12  CL-LEGAL-STATE              PIC XX.
  7803
  7804     12  CL-YESNOSW                  PIC X.
  7805     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7806         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7807         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7808         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7809     12  cl-insured-type             pic x.
  7810         88  cl-claim-on-primary         value 'P'.
  7811         88  cl-claim-on-co-borrower     value 'C'.
  7812     12  cl-benefit-expiration-dt    PIC XX.
  7813
  7814 01  PLAN-RECORDS.
  7815     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7816     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7817
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 145
* EL050.cbl
  7819 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7820                          ACCOUNT-MASTER REINSURANCE-RECORD
  7821                          COMM-TABLE-RECORD FORM-MASTER
  7822                          CLAIM-MASTER PLAN-RECORDS.
  7823 0000-DFHEXIT SECTION.
  7824     MOVE '9#                    $   ' TO DFHEIV0.
  7825     MOVE 'EL050' TO DFHEIV1.
  7826     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7827
  7828     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7829
  7830
  7831* EXEC CICS  HANDLE CONDITION
  7832*           ERROR    (9300-ABEND)
  7833*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7834*    END-EXEC.
  7835*    MOVE '"$.J                  ! " #00007826' TO DFHEIV0
  7836     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7838     MOVE X'2220233030303037383236' TO DFHEIV0(25:11)
  7839     CALL 'kxdfhei1' USING DFHEIV0
  7840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7841
  7842
  7843 0000-COPY-PROCEDURE-DIV.
  7844*                          COPY ELC50PD.
  7845******************************************************************
  7846*                                                                *
  7847*                            ELC50PD                             *
  7848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7849*                            VMOD=2.188                          *
  7850*                                                                *
  7851******************************************************************
  7852*                   C H A N G E   L O G
  7853*
  7854* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7855*-----------------------------------------------------------------
  7856*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7857* EFFECTIVE    NUMBER
  7858*-----------------------------------------------------------------
  7859* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7860* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7861* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7862*                             2709 AND 2718
  7863* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7864* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7865* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7866* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7867* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7868*                                IS OPEN OR CNC DT < PD THRU
  7869* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7870* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7871* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7872* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7873* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7874* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7875* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7876* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 146
* EL050.cbl
  7877* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7878* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7879* 020906                   PEMA  EXPAND LOAN OFFICER
  7880* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7881* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7882* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7883* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7884* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7885* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7886* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7887* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7888* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7889* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7890* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7891* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7892* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7893* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7894* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7895* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7896* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7897* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7898* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7899* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7900* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7901* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7902* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7903* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7904* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7905*                                UPDATE VIN ON CERT TRAILER
  7906* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7907* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7908* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7909* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7910* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7911* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7912* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7913* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7914* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7915* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7916* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7917* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7918* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7919* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7920* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7921* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7922* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7923* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7924* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7925* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7926* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7927* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7928* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7929* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7930* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7931* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7932* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7933* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7934* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 147
* EL050.cbl
  7935* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7936* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7937* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7938* 032912  CR2011110200001  PEMA  AHL CHANGES
  7939* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7940* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7941* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7942* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7943* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7944* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7945* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7946* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7947* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7948* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7949* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7950* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7951* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7952* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7953* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7954* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7955* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7956* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7957* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7958* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7959* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7960* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7961* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7962* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7963* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7964* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7965* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7966*                                CERT #, ADD 2898 FORCIBLE ERROR
  7967* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7968* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7969* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7970* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7971* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7972* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7973* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7974* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7975* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7976* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7977* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7978* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7979* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7980* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7981* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7982* 100617  CR2017062000003  PEMA  New comm cap edits
  7983* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7984* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7985* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7986* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7987* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7988* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7989* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7990* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  7991* 092618  CR2018050200001  PEMA  Add check for open clm on issue
  7992* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 148
* EL050.cbl
  7993* 101019  CR2019100700001  PEMA  Disallow V status with claim
  7994* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
  7995******************************************************************
  7996************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7997******************************************************************
  7998
  7999     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  8000
  8001     MOVE SPACES                 TO PB-FATAL-FLAG
  8002                                    PB-FORCE-ER-CD
  8003                                    PB-WARN-ER-CD
  8004                                    PB-OUT-BAL-CD.
  8005
  8006     MOVE SPACE                  TO WS-IG-OVRD-AH
  8007                                    WS-IG-OVRD-LF
  8008                                    WS-IG-OVRD-AM
  8009                                    WS-IG-OVRD
  8010                                    WS-IG-OVRD-AH-PL
  8011                                    WS-IG-OVRD-LF-PL
  8012                                    WS-IG-OVRD-AH-BEN
  8013                                    WS-IG-OVRD-LF-BEN.
  8014
  8015******************************************************************
  8016*************       INITIALIZE COMMON ERRORS       ***************
  8017******************************************************************
  8018
  8019     MOVE +0                     TO PB-NO-OF-ERRORS.
  8020     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8021
  8022******************************************************************
  8023
  8024     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8025     SET JULIAN-TO-BIN           TO TRUE.
  8026*    MOVE 5                      TO DC-OPTION-CODE.
  8027     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8028     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8029
  8030     MOVE ZERO                   TO  SUB4.
  8031
  8032 0040-INITIALIZE-GA-BILL-DT.
  8033
  8034     ADD +1                      TO  SUB4.
  8035
  8036     IF  SUB4 GREATER THAN +5
  8037         GO TO 0050-CHECK-CNTL-FOUND.
  8038
  8039     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8040         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8041
  8042     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8043
  8044 0050-CHECK-CNTL-FOUND.
  8045
  8046     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8047        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8048                                         WS-AH-REM-TERM-CALC
  8049                                         EC-CO-REM-TERM-CALC
  8050        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 149
* EL050.cbl
  8051        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8052        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8053                                         WS-TOL-AH-CLAIM
  8054        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8055                                         WS-TOL-AH-PREM
  8056                                         EC-CO-TOL-PREM
  8057        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8058                                         WS-TOL-AH-REFUND
  8059                                         EC-CO-TOL-REFUND
  8060        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8061                                         WS-AH-REFUND-OVS-AMT
  8062                                         EC-CO-OVR-SHT-AMT
  8063        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8064                                         WS-TOL-AH-PREM-PCT
  8065                                         EC-CO-TOL-PREM-PCT
  8066        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8067                                         WS-TOL-AH-REFUND-PCT
  8068                                         EC-CO-TOL-REFUND-PCT
  8069        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8070                                         WS-AH-REFUND-OVS-PCT
  8071                                         EC-CO-OVR-SHT-PCT
  8072        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8073        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8074        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8075        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8076        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8077        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8078        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8079        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8080        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8081        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8082        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8083        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8084                                         EC-CO-MONTH-END-DT
  8085        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8086          GO TO 0100-READ-ACCT.
  8087
  8088     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8089     MOVE SPACES                 TO CNTL-ACCESS.
  8090     MOVE '1'                    TO CNTL-REC-TYPE.
  8091     MOVE +0                     TO CNTL-SEQ-NO.
  8092
  8093     MOVE '1' TO RC-SW-1.
  8094     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8095     IF NOT CF-COMPANY-MASTER
  8096         MOVE ZEROS             TO WK-CO-TOL-PREM
  8097                                   WK-CO-TOL-CLAIM
  8098                                   WK-CO-TOL-REFUND
  8099                                   WK-REFUND-OVS-AMT
  8100                                   WK-REFUND-OVS-PCT
  8101                                   WK-CO-TOL-PREM-PCT
  8102                                   WK-CO-TOL-REFUND-PCT
  8103                                   WK-DEFAULT-APR
  8104                                   WK-CO-MAX-CAP
  8105        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8106                                   WK-CR-R78-METHOD
  8107                                   WK-CO-REF-REJECT-SW
  8108                                   WK-CO-PREM-REJECT-SW
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 150
* EL050.cbl
  8109                                   WK-REM-TRM-CALC-OPTION
  8110                                   WK-BIRTH-DATE-INPUT
  8111                                   WK-JOINT-AGE-INPUT
  8112        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8113        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8114        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8115        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8116          GO TO 0099-COMPANY-NOT-FOUND.
  8117
  8118     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8119        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8120     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8121        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8122     IF CF-CO-TOL-CAP NOT NUMERIC
  8123        MOVE +0                    TO CF-CO-TOL-CAP.
  8124     IF CF-DEFAULT-APR NOT NUMERIC
  8125        MOVE +0                    TO CF-DEFAULT-APR.
  8126
  8127     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8128     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8129     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8130     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8131     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8132     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8133     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8134     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8135     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8136     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8137     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8138     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8139
  8140     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8141          CF-CO-OVR-SHT-AMT > +0
  8142        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8143
  8144     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8145          CF-CO-OVR-SHT-PCT > +0
  8146        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8147
  8148     IF CF-VALID-REM-TRM-OPTION
  8149         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8150     ELSE
  8151         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8152
  8153     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8154     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8155     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8156     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8157
  8158     GO TO 0050-CHECK-CNTL-FOUND.
  8159
  8160 0099-COMPANY-NOT-FOUND.
  8161
  8162     MOVE ER-2616                TO WS-ERROR.
  8163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8164
  8165 0100-READ-ACCT.
  8166
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 151
* EL050.cbl
  8167     MOVE SPACES                 TO DATE-RANGE-SW.
  8168
  8169     IF WK-ACCT-ADDR = ZEROS
  8170        GO TO 0102-ACCT-GETMAIN.
  8171
  8172     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8173     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8174     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8175
  8176     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8177        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8178        GO TO 0105-READ-ACCT
  8179     END-IF
  8180
  8181     IF PB-CARRIER NOT = SPACES
  8182        IF PB-CARRIER NOT = AM-VG-CARRIER
  8183           GO TO 0105-READ-ACCT.
  8184
  8185     IF PB-STATE NOT = SPACES
  8186        IF PB-STATE NOT = AM-VG-STATE
  8187           GO TO 0105-READ-ACCT.
  8188
  8189     IF PB-GROUPING NOT = SPACES
  8190        IF PB-GROUPING NOT = AM-VG-GROUPING
  8191           GO TO 0105-READ-ACCT.
  8192
  8193     MOVE 'X'                 TO DATE-RANGE-SW.
  8194
  8195     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8196        MOVE 'X'                 TO DATE-RANGE-SW
  8197        GO TO 0105-READ-ACCT.
  8198
  8199     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8200        GO TO 0105-READ-ACCT.
  8201
  8202     GO TO 0180-ACCOUNT-FOUND.
  8203
  8204 0102-ACCT-GETMAIN.
  8205     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8206     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8207
  8208 0105-READ-ACCT.
  8209     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8210     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8211     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8212     MOVE PB-STATE               TO ACCT-STATE.
  8213     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8214     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8215
  8216     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8217
  8218     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8219
  8220 0110-FIND-ACCT-TOLERANCES-LOOP.
  8221     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8222
  8223     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8224        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 152
* EL050.cbl
  8225        GO TO 0199-ACCT-NOT-FOUND
  8226     END-IF
  8227     IF PB-CARRIER NOT = SPACES
  8228        IF PB-CARRIER NOT = AM-VG-CARRIER
  8229           GO TO 0199-ACCT-NOT-FOUND.
  8230
  8231     IF PB-STATE NOT = SPACES
  8232        IF PB-STATE NOT = AM-VG-STATE
  8233           GO TO 0199-ACCT-NOT-FOUND.
  8234
  8235     IF PB-GROUPING NOT = SPACES
  8236        IF PB-GROUPING NOT = AM-VG-GROUPING
  8237           GO TO 0199-ACCT-NOT-FOUND.
  8238
  8239     MOVE 'X'                    TO DATE-RANGE-SW.
  8240
  8241     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8242        MOVE 'X'                 TO DATE-RANGE-SW
  8243        GO TO 0199-ACCT-NOT-FOUND.
  8244
  8245     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8246        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8247
  8248 0180-ACCOUNT-FOUND.
  8249     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8250     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8251     MOVE AM-STATE               TO PB-SV-STATE.
  8252     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8253
  8254     IF AM-CANCEL-FEE  NOT NUMERIC
  8255        MOVE ZEROS TO AM-CANCEL-FEE.
  8256
  8257     IF AM-MAX-MON-BEN NOT NUMERIC
  8258        MOVE ZEROS TO AM-MAX-MON-BEN.
  8259
  8260     IF AM-MAX-TOT-BEN NOT NUMERIC
  8261        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8262
  8263     IF AM-CLP-TOL-PCT NOT NUMERIC
  8264        MOVE +0                  TO AM-CLP-TOL-PCT
  8265     END-IF
  8266     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8267        MOVE +0                  TO AM-SPP-LEASE-COMM
  8268     END-IF
  8269     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8270        MOVE ER-2611             TO   WS-ERROR
  8271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8272
  8273     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8274        MOVE ER-2621             TO   WS-ERROR
  8275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8276
  8277     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8278        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8279        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8280        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8281         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8282
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 153
* EL050.cbl
  8283     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8284     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8285     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8286     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8287     IF AM-CLP-TOL-PCT NOT = ZEROS
  8288        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8289     END-IF
  8290     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8291        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8292     END-IF
  8293*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8294*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8295*                                   WS-ADMIN-FEES
  8296*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8297*          (SUB5 > +10)
  8298*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8299*             AND (AM-A-COM (SUB5) NUMERIC)
  8300*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8301*                + (AM-A-COM (SUB5) * 1000)
  8302*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8303*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8304*                + (AM-A-COM (SUB5) * 1000)
  8305*             END-IF
  8306*             IF AM-COM-TYP (SUB5) = 'N'
  8307*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8308*                + (AM-A-COM (SUB5) * 1000)
  8309*             END-IF
  8310*          END-IF
  8311*       END-PERFORM
  8312*    END-IF
  8313     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8314        AND (PB-ISSUE)
  8315        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8316                                    ws-cred-union-fees
  8317        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8318           (SUB5 > +10)
  8319           MOVE +0 TO WS-WK-RATE
  8320           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8321                                   'O' OR 'S')
  8322              IF (AM-A-COM (SUB5) NUMERIC)
  8323                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8324                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8325              ELSE
  8326                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8327                 IF PB-ISSUE
  8328                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8329                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8330                 ELSE
  8331                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8332                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8333                 END-IF
  8334                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8335                 MOVE ZEROS             TO WS-SUB1
  8336                                           WS-COMMISSION
  8337                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8338                 MOVE '0530'               TO CTBL-SW
  8339                 MOVE ' '                  TO WS-CTBL-READ-SW
  8340                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 154
* EL050.cbl
  8341                 IF FIRST-TIME-THROUGH
  8342                    MOVE 'AA'              TO CTBL-BEN-CODE
  8343                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8344                 END-IF
  8345                 IF CTBL-TABLE-FOUND
  8346                    IF PB-ISSUE
  8347                       COMPUTE WS-COMM-CK-AMT =
  8348                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8349                    ELSE
  8350                       COMPUTE WS-COMM-CK-AMT =
  8351                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8352                    END-IF
  8353                    PERFORM 8800-GET-COMP-RATE
  8354                              THRU 8800-EXIT
  8355                 END-IF
  8356              END-IF
  8357              if am-com-typ (sub5) = 'O' or 'S'
  8358                 compute ws-cred-union-fees rounded =
  8359                    ws-cred-union-fees +
  8360                    (pb-i-ah-premium-amt * ws-wk-rate)
  8361              else
  8362                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8363                + (WS-WK-RATE * 1000)
  8364              end-if
  8365           END-IF
  8366        END-PERFORM
  8367     END-IF
  8368     IF PB-COMPANY-ID EQUAL 'CRI'
  8369         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8370
  8371     IF PB-COMPANY-ID EQUAL 'NCL'
  8372         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8373     END-IF
  8374
  8375     GO TO 0200-READ-CERT.
  8376
  8377 0199-ACCT-NOT-FOUND.
  8378
  8379     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8380
  8381     IF DATE-RANGE-SW NOT = SPACES
  8382        MOVE ER-2601             TO WS-ERROR
  8383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8384     ELSE
  8385        MOVE ER-2619             TO WS-ERROR
  8386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8387
  8388     GO TO 9990-RETURN.
  8389
  8390 0200-READ-CERT.
  8391
  8392     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8393     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8394     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8395     MOVE PB-SV-STATE            TO CERT-STATE.
  8396     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8397     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8398     MOVE PB-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 155
* EL050.cbl
  8399
  8400     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8401
  8402     IF CERT-WAS-NOT-FOUND
  8403        GO TO 0299-CERT-NOT-FOUND.
  8404
  8405     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8406        MOVE ER-2759             TO WS-ERROR
  8407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8408        GO TO 0298-UNLOCK-RETURN.
  8409
  8410     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8411         MOVE ER-2758            TO WS-ERROR
  8412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8413         GO TO 0298-UNLOCK-RETURN.
  8414
  8415     IF PB-ISSUE
  8416        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8417           IF CERT-WAS-CREATED-FOR-CLAIM
  8418              NEXT SENTENCE
  8419            ELSE
  8420              MOVE ER-2626       TO WS-ERROR
  8421              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8422              GO TO 0298-UNLOCK-RETURN.
  8423
  8424     IF NOT PB-CANCELLATION
  8425        GO TO 0300-CONTINUE-EDIT.
  8426
  8427     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8428     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8429     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8430     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8431     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8432     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8433
  8434     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8435     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8436     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8437     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8438     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8439     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8440     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8441     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8442     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8443
  8444     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8445     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8446     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8447     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8448     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8449     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8450     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8451
  8452     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8453     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8454
  8455     MOVE CM-CREDIT-INTERFACE-SW-1
  8456                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 156
* EL050.cbl
  8457     MOVE CM-CREDIT-INTERFACE-SW-2
  8458                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8459
  8460     IF CM-O-B-COVERAGE
  8461         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8462
  8463     IF CM-LIVES NOT NUMERIC
  8464         MOVE ZERO                TO CM-LIVES.
  8465
  8466     IF CM-BILLED NOT NUMERIC
  8467         MOVE ZERO                TO CM-BILLED.
  8468
  8469     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8470         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8471         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8472         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8473         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8474         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8475         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8476         MOVE CM-LIVES             TO PB-CI-LIVES
  8477*The next line causes a problem with my change  I dont think it is
  8478*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8479
  8480     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8481     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8482     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8483     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8484     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8485     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8486
  8487     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8488     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8489     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8490     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8491
  8492     IF CM-LIFE-COMM-PCT NUMERIC
  8493         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8494     ELSE
  8495         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8496
  8497     IF CM-AH-COMM-PCT NUMERIC
  8498         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8499     ELSE
  8500         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8501
  8502     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8503
  8504     IF CM-LOAN-APR       NOT NUMERIC
  8505           MOVE ZERO               TO CM-LOAN-APR.
  8506
  8507     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8508           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8509
  8510     IF CM-LOAN-TERM      NOT NUMERIC
  8511           MOVE ZERO               TO CM-LOAN-TERM.
  8512
  8513     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8514           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 157
* EL050.cbl
  8515
  8516     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8517           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8518
  8519     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8520     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8521     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8522     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8523     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8524     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8525     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8526     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8527     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8528     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8529     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8530     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8531     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8532
  8533     IF CM-STATE = CM-SSN-STATE
  8534         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8535
  8536     IF CM-STATE NOT = CM-MEMB-STATE
  8537         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8538
  8539     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8540
  8541     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8542*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8543        IF CM-ADDL-CLP NOT NUMERIC
  8544           MOVE +0               TO CM-ADDL-CLP
  8545        END-IF
  8546        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8547        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8548           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8549        END-IF
  8550     END-IF
  8551     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8552        MOVE +0                  TO WS-ADMIN-FEES
  8553                                    WS-CSO-ADMIN-FEE
  8554                                    WS-COMM-AND-MFEE
  8555                                    WS-1ST-YR-ALLOW
  8556        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8557           (SUB5 > +10)
  8558           MOVE +0 TO WS-WK-RATE
  8559           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8560              IF (AM-A-COM (SUB5) NUMERIC)
  8561                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8562                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8563              ELSE
  8564                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8565                 IF PB-ISSUE
  8566                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8567                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8568                 ELSE
  8569                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8570                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8571                 END-IF
  8572                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 158
* EL050.cbl
  8573                 MOVE ZEROS             TO WS-SUB1
  8574                                           WS-COMMISSION
  8575                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8576                 MOVE '0530'               TO CTBL-SW
  8577                 MOVE ' '                  TO WS-CTBL-READ-SW
  8578                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8579                 IF FIRST-TIME-THROUGH
  8580                    MOVE 'AA'              TO CTBL-BEN-CODE
  8581                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8582                 END-IF
  8583                 IF CTBL-TABLE-FOUND
  8584                    IF PB-ISSUE
  8585                       COMPUTE WS-COMM-CK-AMT =
  8586                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8587                    ELSE
  8588                       COMPUTE WS-COMM-CK-AMT =
  8589                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8590                    END-IF
  8591                    PERFORM 8800-GET-COMP-RATE
  8592                              THRU 8800-EXIT
  8593                 END-IF
  8594              END-IF
  8595              IF AM-COM-TYP (SUB5) = 'I'
  8596                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8597                   + (WS-WK-RATE * 1000)
  8598              END-IF
  8599              IF AM-COM-TYP (SUB5) = 'N'
  8600                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8601                   + (WS-WK-RATE * 1000)
  8602              END-IF
  8603              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8604                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8605                   + (WS-WK-RATE * 1000)
  8606              END-IF
  8607              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8608                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8609                   + (WS-WK-RATE * 1000)
  8610              END-IF
  8611           END-IF
  8612        END-PERFORM
  8613     END-IF
  8614     GO TO 0300-CONTINUE-EDIT.
  8615
  8616 0298-UNLOCK-RETURN.
  8617      PERFORM 9250-UNLOCK-RETURN
  8618      GO TO 9990-RETURN.
  8619
  8620 0299-CERT-NOT-FOUND.
  8621
  8622     MOVE '1'                     TO CERT-STATUS-SW.
  8623
  8624     IF PB-COMPANY-ID = 'UCL'
  8625         IF WS-ERROR = ER-2799
  8626             GO TO 3000-CONTINUE-EDIT.
  8627
  8628     IF NOT PB-CANCELLATION
  8629         GO TO 0300-CONTINUE-EDIT.
  8630
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 159
* EL050.cbl
  8631     MOVE ER-2726                  TO  WS-ERROR.
  8632     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8633     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8634     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8635                                    PB-CI-LF-TERM
  8636                                    PB-C-LF-REM-TERM
  8637                                    PB-CI-AH-TERM
  8638                                    PB-C-AH-REM-TERM
  8639                                    PB-CI-LF-BENEFIT-CD
  8640                                    PB-CI-LF-BENEFIT-AMT
  8641                                    PB-CI-LF-ALT-BENEFIT-AMT
  8642                                    PB-CI-LF-PREMIUM-AMT
  8643                                    PB-CI-LF-ALT-PREMIUM-AMT
  8644                                    PB-CI-AH-BENEFIT-CD
  8645                                    PB-CI-AH-BENEFIT-AMT
  8646                                    PB-CI-AH-PREMIUM-AMT
  8647                                    PB-CI-PAY-FREQUENCY
  8648                                    PB-CI-LOAN-APR
  8649                                    PB-CI-LOAN-TERM
  8650                                    PB-CI-LIFE-COMMISSION
  8651                                    PB-CI-AH-COMMISSION
  8652                                    PB-CI-CURR-SEQ
  8653                                    PB-CI-AH-CANCEL-AMT
  8654                                    PB-CI-LF-CANCEL-AMT
  8655                                    PB-CI-RATE-DEV-PCT-LF
  8656                                    PB-CI-RATE-DEV-PCT-AH
  8657                                    PB-CI-EXTENTION-DAYS
  8658                                    PB-CI-TERM-IN-DAYS
  8659                                    PB-CI-LIVES
  8660                                    PB-CI-LF-CRIT-PER
  8661                                    PB-CI-AH-CRIT-PER
  8662                                    PB-CI-ADDL-CLP
  8663                                    PB-CI-DDF-IU-RATE-UP.
  8664
  8665     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8666                                    PB-CI-AH-SETTLEMENT-DT
  8667                                    PB-CI-DEATH-DT
  8668                                    PB-CI-LF-PRIOR-CANCEL-DT
  8669                                    PB-CI-AH-PRIOR-CANCEL-DT
  8670                                    PB-CI-ENTRY-DT
  8671                                    PB-CI-LF-EXPIRE-DT
  8672                                    PB-CI-AH-EXPIRE-DT
  8673                                    PB-CI-LOAN-1ST-PMT-DT.
  8674
  8675     IF ACCOUNT-MAST-FOUND
  8676        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8677        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8678
  8679
  8680 0300-CONTINUE-EDIT.
  8681
  8682     IF PB-ISSUE
  8683        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8684            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8685
  8686     IF PB-ISSUE
  8687        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8688            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 160
* EL050.cbl
  8689
  8690     IF PB-ISSUE
  8691       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8692          (AM-NO-AH-ONLY)
  8693           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8694               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8695                   MOVE ER-2679 TO WS-ERROR
  8696                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8697
  8698     IF PB-ISSUE
  8699        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8700        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8701        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8702     ELSE
  8703        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8704        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8705        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8706
  8707     MOVE 'N'                    TO PLAN-MASTER-SW
  8708                                    PLAN-MASTER-LIFE-SW
  8709                                    FORM-MASTER-SW
  8710                                    WS-APP-CERT-SW.
  8711
  8712     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8713                                    WS-PL-TOL-LF-REFUND
  8714                                    WS-PL-REF-OVS-AMT
  8715                                    WS-PL-TOL-LF-PREM-PCT
  8716                                    WS-PL-TOL-LF-REFUND-PCT
  8717                                    WS-PL-REF-OVS-PCT
  8718                                    WS-PL-TOL-LF-CLAIM.
  8719
  8720     IF PB-COMPANY-ID = 'NCL'
  8721       IF PB-ISSUE
  8722         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8723             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8724             IF FORM-MASTER-FOUND
  8725                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8726
  8727     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8728        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8729
  8730********************** MON CODE **********************
  8731     IF PB-COMPANY-ID = 'MON'
  8732     IF PB-ISSUE
  8733     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8734        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8735             PB-I-LOAN-APR = ZERO)
  8736               MOVE 14.0         TO PB-I-LOAN-APR.
  8737******************************************************
  8738
  8739     IF PB-COMPANY-ID = 'NCL'
  8740       IF PB-ISSUE
  8741           IF FORM-MASTER-FOUND
  8742             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8743                AM-DISMBR-COVERAGE
  8744                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8745                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8746                   MOVE '8'            TO  WS-LF-INPUT-CD-1
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 161
* EL050.cbl
  8747                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8748                                           PB-I-LIFE-BENEFIT-CD.
  8749
  8750     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8751
  8752     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8753         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8754         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8755         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8756         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8757         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8758           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8759             GO TO 0301-LIFE-BENEFIT-SEARCH
  8760         ELSE
  8761             NEXT SENTENCE
  8762     ELSE
  8763         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8764
  8765     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8766     MOVE '4'                    TO CNTL-REC-TYPE.
  8767     MOVE +0                     TO CNTL-SEQ-NO.
  8768     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8769
  8770     MOVE '1' TO RC-SW-2.
  8771     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8772
  8773     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8774        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8775         GO TO 0305-BENEFIT-NOT-FOUND.
  8776
  8777     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8778
  8779 0301-LIFE-BENEFIT-SEARCH.
  8780
  8781     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8782
  8783     IF NO-BENEFIT-FOUND
  8784        GO TO 0305-BENEFIT-NOT-FOUND.
  8785
  8786     IF WS-BEN-CD = '99'
  8787        GO TO 0305-BENEFIT-NOT-FOUND.
  8788
  8789     IF PB-COMPANY-ID = 'NCL'
  8790         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8791             GO TO 0304-LIFE-BENEFIT-FOUND.
  8792
  8793     MOVE +1                     TO SUB5.
  8794     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8795
  8796* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8797* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8798     IF PB-COMPANY-ID = 'DMD'
  8799         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8800
  8801 0302-EDIT-ACCT-LF-BENEFITS.
  8802
  8803     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8804        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 162
* EL050.cbl
  8805           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8806                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8807           GO TO 03XX-GET-LIFE-ERPLAN.
  8808
  8809     IF SUB5 LESS THAN +20
  8810        ADD +1                   TO SUB5
  8811        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8812
  8813     MOVE +1                     TO SUB5.
  8814
  8815     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8816        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8817
  8818 0303-EDIT-DMD-EXTRA-BENEFITS.
  8819
  8820     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8821        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8822           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8823                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8824           GO TO 03XX-GET-LIFE-ERPLAN.
  8825
  8826     IF SUB5 LESS THAN +30
  8827        ADD +1                   TO SUB5
  8828        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8829
  8830     MOVE +1                     TO SUB5.
  8831
  8832 03XX-EDIT-FOR-NINETY-LF.
  8833
  8834***************************************************************
  8835*                                                             *
  8836*    NINETY BENEFIT PLAN TYPES:                               *
  8837*                                                             *
  8838*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8839*      92 = ALL GROUP REDUCING BENEFITS                       *
  8840*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8841*      94 = ALL GROUP LEVEL BENEFITS                          *
  8842*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8843*           BENEFIT CONTROLS.                                 *
  8844*      99 = ALL BENEFITS                                      *
  8845*                                                             *
  8846***************************************************************
  8847
  8848     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8849                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8850
  8851     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8852       AND
  8853        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8854        GO TO 03XX-GET-LIFE-ERPLAN.
  8855
  8856     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8857       AND
  8858        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8859        IF CF-REDUCING (SUB3)
  8860           IF (PB-I-INDV-GRP-OVRD = 'I')
  8861              OR
  8862           ((AM-IG = '1') AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 163
* EL050.cbl
  8863           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8864              OR
  8865           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8866           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8867           (AM-IG NOT = '2'))
  8868              GO TO 03XX-GET-LIFE-ERPLAN.
  8869
  8870     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8871       AND
  8872        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8873        IF CF-REDUCING (SUB3)
  8874           IF (PB-I-INDV-GRP-OVRD = 'G')
  8875              OR
  8876           ((AM-IG = '2') AND
  8877           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8878              OR
  8879           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8880           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8881           (AM-IG NOT = '1'))
  8882              GO TO 03XX-GET-LIFE-ERPLAN.
  8883
  8884     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8885       AND
  8886        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8887        IF CF-LEVEL    (SUB3)
  8888           IF (PB-I-INDV-GRP-OVRD = 'I')
  8889              OR
  8890           ((AM-IG = '1') AND
  8891           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8892              OR
  8893           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8894           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8895            (AM-IG NOT = '2'))
  8896              GO TO 03XX-GET-LIFE-ERPLAN.
  8897
  8898     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8899       AND
  8900        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8901        IF CF-LEVEL    (SUB3)
  8902           IF (PB-I-INDV-GRP-OVRD = 'G')
  8903              OR
  8904           ((AM-IG = '2') AND
  8905           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8906              OR
  8907           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8908           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8909           (AM-IG NOT = '1'))
  8910              GO TO 03XX-GET-LIFE-ERPLAN.
  8911
  8912     IF SUB5 LESS THAN +20
  8913        ADD +1                   TO SUB5
  8914        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8915
  8916     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8917
  8918     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8919        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8920
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 164
* EL050.cbl
  8921     MOVE +1                     TO SUB5.
  8922
  8923 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8924
  8925     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8926                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8927
  8928     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8929       AND
  8930        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8931        GO TO 03XX-GET-LIFE-ERPLAN.
  8932
  8933     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8934       AND
  8935        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8936        IF CF-REDUCING (SUB3)
  8937           IF (PB-I-INDV-GRP-OVRD = 'I')
  8938              OR
  8939           ((AM-IG = '1') AND
  8940           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8941              OR
  8942           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8943           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8944           (AM-IG NOT = '2'))
  8945              GO TO 03XX-GET-LIFE-ERPLAN.
  8946
  8947     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8948       AND
  8949        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8950        IF CF-REDUCING (SUB3)
  8951           IF (PB-I-INDV-GRP-OVRD = 'G')
  8952              OR
  8953           ((AM-IG = '2') AND
  8954           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8955              OR
  8956           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8957           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8958           (AM-IG NOT = '1'))
  8959              GO TO 03XX-GET-LIFE-ERPLAN.
  8960
  8961     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8962       AND
  8963        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8964        IF CF-LEVEL    (SUB3)
  8965           IF (PB-I-INDV-GRP-OVRD = 'I')
  8966              OR
  8967           ((AM-IG = '1') AND
  8968           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8969              OR
  8970           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8971           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8972            (AM-IG NOT = '2'))
  8973              GO TO 03XX-GET-LIFE-ERPLAN.
  8974
  8975     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8976       AND
  8977        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8978        IF CF-LEVEL    (SUB3)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 165
* EL050.cbl
  8979           IF (PB-I-INDV-GRP-OVRD = 'G')
  8980              OR
  8981           ((AM-IG = '2') AND
  8982           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8983              OR
  8984           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8985           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8986           (AM-IG NOT = '1'))
  8987              GO TO 03XX-GET-LIFE-ERPLAN.
  8988
  8989     IF SUB5 LESS THAN +30
  8990        ADD +1                   TO SUB5
  8991        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8992
  8993     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8994
  8995 03XX-EDIT-FOR-NINETY-LF-CONT.
  8996
  8997     MOVE +99                    TO SUB5.
  8998
  8999     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9000        IF PB-ISSUE
  9001           MOVE ER-1924          TO  WS-ERROR
  9002           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9003
  9004     GO TO 0304-LIFE-BENEFIT-FOUND.
  9005
  9006 03XX-GET-LIFE-ERPLAN.
  9007
  9008     IF WK-PLAN-ADDR EQUAL +0
  9009        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  9010
  9011     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9012     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9013     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9014     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9015     MOVE 'Y'                    TO PLAN-MASTER-SW
  9016                                    PLAN-MASTER-LIFE-SW.
  9017     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9018
  9019 03XX-ERPLAN-LIFE-GETMAIN.
  9020
  9021     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9022     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9023
  9024 03XX-ERPLAN-LIFE-READ.
  9025
  9026     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9027     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9028     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9029     MOVE PB-SV-STATE            TO PLAN-STATE.
  9030     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9031     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9032     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9033     MOVE WS-SAVE-BENEFIT-REVISION
  9034                                 TO PLAN-REVISION-NO.
  9035
  9036     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 166
* EL050.cbl
  9037     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9038
  9039     IF PB-COMPANY-ID = 'NCL'
  9040       IF NOT LF-PLAN-MASTER-FOUND
  9041         IF NOT PB-POLICY-IS-DECLINED  AND
  9042            NOT PB-POLICY-IS-VOIDED
  9043             MOVE  ER-1921         TO  WS-ERROR
  9044             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9045             GO TO 0304-LIFE-BENEFIT-FOUND.
  9046
  9047     IF NOT LF-PLAN-MASTER-FOUND
  9048        GO TO 0304-LIFE-BENEFIT-FOUND.
  9049
  9050 XXXX-CHECK-LF-PLAN-KEY.
  9051
  9052     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9053        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9054        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9055        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9056        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9057        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9058        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9059        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9060        MOVE 'N'                 TO PLAN-MASTER-SW
  9061          GO TO 03XX-ERPLAN-LIFE-READ.
  9062
  9063     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9064
  9065     IF  PB-CANCELLATION
  9066         GO TO  0303-LF-ACCT-BEN-FOUND.
  9067
  9068     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9069        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9070           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9071           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9072              MOVE ER-2644             TO WS-ERROR
  9073              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9074           ELSE
  9075              NEXT SENTENCE
  9076        ELSE
  9077           IF PB-COMPANY-ID NOT = 'NCL'
  9078              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9079                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9080
  9081 0303-LF-ACCT-BEN-FOUND.
  9082
  9083     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9084
  9085     IF PL-DEV-CODE NOT = SPACES
  9086        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9087
  9088     IF PL-DEV-PCT NUMERIC AND
  9089        PL-DEV-PCT NOT = ZEROS
  9090        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9091
  9092     IF PL-TOL-PREM-AMT GREATER THAN +0
  9093        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9094
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 167
* EL050.cbl
  9095     IF PL-TOL-REF-AMT GREATER THAN +0
  9096        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9097
  9098     IF PL-TOL-PREM-PCT GREATER THAN +0
  9099        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9100
  9101     IF PL-TOL-REF-PCT GREATER THAN +0
  9102        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9103
  9104     IF PL-TOL-CLM-AMT GREATER THAN +0
  9105        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9106
  9107     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9108                          PL-OVER-SHORT-AMT > +0
  9109        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9110
  9111     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9112                          PL-OVER-SHORT-PCT > +0
  9113        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9114
  9115     IF PL-SALES-TAX NUMERIC AND
  9116                          PL-SALES-TAX > +0
  9117         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9118
  9119     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9120        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9121                                    WS-IG-OVRD-AM.
  9122
  9123 0304-LIFE-BENEFIT-FOUND.
  9124
  9125     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9126
  9127     IF PB-ISSUE
  9128        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9129     ELSE
  9130        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9131
  9132     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9133     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9134     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9135     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9136     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9137                                         WS-LF-REFUND-CALC.
  9138     if (ws-lf-earnings-calc = '5')
  9139        and (pb-i-loan-apr = zeros)
  9140        and (benefit-code-chg)
  9141        move +99.9999 to pb-i-loan-apr
  9142     end-if
  9143
  9144     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9145        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9146
  9147     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9148        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9149     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9150
  9151     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9152     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 168
* EL050.cbl
  9153     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9154     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9155     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9156     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9157
  9158     IF PB-COMPANY-ID = 'NCL'  AND
  9159        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9160         NEXT SENTENCE
  9161     ELSE
  9162         IF SUB5 NOT GREATER THAN +20
  9163            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9164               MOVE WS-SAVE-BENEFIT-REM-TERM
  9165                                      TO WS-AM-LF-BENE-REM-TERM
  9166                                         EC-BR-LF-REM-TERM-CALC.
  9167
  9168     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9169     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9170
  9171     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9172
  9173 0305-BENEFIT-NOT-FOUND.
  9174
  9175     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9176     MOVE ER-2604                TO WS-ERROR.
  9177     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9178
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 169
* EL050.cbl
  9180
  9181 0310-FIND-AH-BENEFIT-RECORD.
  9182
  9183     MOVE 'N'                    TO PLAN-MASTER-SW
  9184                                    PLAN-MASTER-AH-SW.
  9185
  9186     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9187                                    WS-PL-TOL-AH-REFUND
  9188                                    WS-AH-PL-REF-OVS-AMT
  9189                                    WS-PL-TOL-AH-PREM-PCT
  9190                                    WS-PL-TOL-AH-REFUND-PCT
  9191                                    WS-AH-PL-REF-OVS-PCT
  9192                                    WS-PL-TOL-AH-CLAIM.
  9193     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9194
  9195
  9196     if pb-issue
  9197        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9198           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9199        end-if
  9200        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9201           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9202           GO TO 0399-BENEFIT-NOT-FOUND
  9203        end-if
  9204     end-if
  9205
  9206     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9207        GO TO 0400-FIND-CARRIER.
  9208
  9209     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9210
  9211     IF WK-AH-BEN-ADDR NOT = ZEROS
  9212         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9213         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9214         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9215         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9216           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9217             GO TO 0311-AH-BENEFIT-SEARCH
  9218         ELSE
  9219             NEXT SENTENCE
  9220     ELSE
  9221         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9222
  9223     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9224     MOVE '5'                    TO CNTL-REC-TYPE.
  9225     MOVE +0                     TO CNTL-SEQ-NO.
  9226     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9227
  9228     MOVE '2' TO RC-SW-2.
  9229     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9230
  9231     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9232        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9233          GO TO 0399-BENEFIT-NOT-FOUND.
  9234
  9235     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9236
  9237 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 170
* EL050.cbl
  9238
  9239     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9240
  9241     IF NO-BENEFIT-FOUND
  9242         GO TO 0399-BENEFIT-NOT-FOUND.
  9243
  9244     IF WS-BEN-CD = '99'
  9245        GO TO 0399-BENEFIT-NOT-FOUND.
  9246
  9247     IF PB-COMPANY-ID  =  'NCL'
  9248         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9249             GO TO 0314-A-H-BENEFIT-FOUND.
  9250
  9251     MOVE +1                     TO SUB5.
  9252     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9253
  9254* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9255* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9256     IF PB-COMPANY-ID = 'DMD'
  9257         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9258
  9259 0312-EDIT-ACCT-AH-BENEFITS.
  9260
  9261     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9262        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9263           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9264                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9265           GO TO 03XX-GET-AH-ERPLAN.
  9266
  9267     IF SUB5 LESS THAN +20
  9268        ADD +1                   TO SUB5
  9269        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9270
  9271     MOVE +1                     TO SUB5.
  9272
  9273     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9274        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9275
  9276 0313-EDIT-DMD-EXTRA-BENEFITS.
  9277
  9278     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9279        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9280           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9281                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9282           GO TO 03XX-GET-AH-ERPLAN.
  9283
  9284     IF SUB5 LESS THAN +30
  9285        ADD +1                   TO SUB5
  9286        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9287
  9288     MOVE +1                     TO SUB5.
  9289
  9290 03XX-EDIT-FOR-NINETY-AH.
  9291
  9292***************************************************************
  9293*                                                             *
  9294*    NINETY BENEFIT PLAN TYPES:                               *
  9295*                                                             *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 171
* EL050.cbl
  9296*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9297*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9298*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9299*           BENEFIT CONTROLS.                                 *
  9300*      99 = ALL BENEFITS.                                     *
  9301*                                                             *
  9302***************************************************************
  9303
  9304     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9305                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9306
  9307     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9308       AND
  9309        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9310        GO TO 03XX-GET-AH-ERPLAN.
  9311
  9312     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9313       AND
  9314        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9315           IF (PB-I-INDV-GRP-OVRD = 'I')
  9316              OR
  9317           ((AM-IG = '1') AND
  9318           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9319              OR
  9320           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9321           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9322           (AM-IG NOT = '2'))
  9323              GO TO 03XX-GET-AH-ERPLAN.
  9324
  9325     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9326       AND
  9327        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9328           IF (PB-I-INDV-GRP-OVRD = 'G')
  9329              OR
  9330           ((AM-IG = '2') AND
  9331           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9332              OR
  9333           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9334           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9335           (AM-IG NOT = '1'))
  9336              GO TO 03XX-GET-AH-ERPLAN.
  9337
  9338     IF SUB5 LESS THAN +20
  9339        ADD +1                   TO SUB5
  9340        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9341
  9342     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9343        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9344
  9345     MOVE +1                    TO SUB5.
  9346
  9347 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9348
  9349     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9350                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9351
  9352     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9353       AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 172
* EL050.cbl
  9354        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9355        GO TO 03XX-GET-AH-ERPLAN.
  9356
  9357     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9358       AND
  9359        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9360           IF (PB-I-INDV-GRP-OVRD = 'I')
  9361              OR
  9362           ((AM-IG = '1') AND
  9363           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9364              OR
  9365           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9366           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9367           (AM-IG NOT = '2'))
  9368              GO TO 03XX-GET-AH-ERPLAN.
  9369
  9370     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9371       AND
  9372        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9373           IF (PB-I-INDV-GRP-OVRD = 'G')
  9374              OR
  9375           ((AM-IG = '2') AND
  9376           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9377              OR
  9378           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9379           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9380           (AM-IG NOT = '1'))
  9381              GO TO 03XX-GET-AH-ERPLAN.
  9382
  9383     IF SUB5 LESS THAN +30
  9384        ADD +1                   TO SUB5
  9385        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9386
  9387 03XX-EDIT-FOR-NINETY-AH-CONT.
  9388
  9389     MOVE +99                    TO SUB5.
  9390
  9391     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9392
  9393     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9394        IF PB-ISSUE
  9395           MOVE ER-1925          TO  WS-ERROR
  9396           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9397
  9398     GO TO 0314-A-H-BENEFIT-FOUND.
  9399
  9400 03XX-GET-AH-ERPLAN.
  9401
  9402     IF WK-PLAN-ADDR EQUAL +0
  9403         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9404
  9405     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9406     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9407     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9408     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9409     MOVE 'Y'                    TO PLAN-MASTER-SW
  9410                                    PLAN-MASTER-AH-SW.
  9411*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 173
* EL050.cbl
  9412     GO TO 03XX-ERPLAN-AH-READ.
  9413
  9414 03XX-ERPLAN-AH-GETMAIN.
  9415
  9416     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9417     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9418
  9419 03XX-ERPLAN-AH-READ.
  9420
  9421     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9422     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9423     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9424     MOVE PB-SV-STATE            TO PLAN-STATE.
  9425     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9426     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9427     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9428     MOVE WS-SAVE-BENEFIT-REVISION
  9429                                 TO PLAN-REVISION-NO.
  9430
  9431     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9432     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9433
  9434     IF PB-COMPANY-ID = 'NCL'
  9435       IF NOT AH-PLAN-MASTER-FOUND
  9436         IF NOT PB-POLICY-IS-DECLINED  AND
  9437            NOT PB-POLICY-IS-VOIDED
  9438             MOVE  ER-1922         TO  WS-ERROR
  9439             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9440             GO TO 0314-A-H-BENEFIT-FOUND.
  9441
  9442     IF NOT AH-PLAN-MASTER-FOUND
  9443        GO TO 0314-A-H-BENEFIT-FOUND.
  9444
  9445 XXXX-CHECK-AH-PLAN-KEY.
  9446
  9447     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9448        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9449        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9450        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9451        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9452        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9453        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9454        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9455        MOVE 'N'                 TO PLAN-MASTER-SW
  9456          GO TO 03XX-ERPLAN-AH-READ.
  9457
  9458     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9459
  9460     IF  PB-CANCELLATION
  9461         GO TO  0313-AH-ACCT-BEN-FOUND.
  9462
  9463     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9464       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9465          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9466          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9467             MOVE ER-2644             TO WS-ERROR
  9468             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9469          ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 174
* EL050.cbl
  9470             NEXT SENTENCE
  9471       ELSE
  9472          IF PB-COMPANY-ID NOT = 'NCL'
  9473             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9474                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9475
  9476 0313-AH-ACCT-BEN-FOUND.
  9477
  9478     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9479
  9480     IF PL-DEV-CODE NOT = SPACES
  9481        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9482
  9483     IF PL-DEV-PCT NUMERIC AND
  9484        PL-DEV-PCT NOT = ZEROS
  9485        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9486
  9487     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9488        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9489
  9490     IF PL-TOL-REF-AMT NOT EQUAL +0
  9491        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9492
  9493     IF PL-TOL-PREM-PCT GREATER THAN +0
  9494        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9495
  9496     IF PL-TOL-REF-PCT GREATER THAN +0
  9497        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9498
  9499     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9500        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9501
  9502     IF PL-OVER-SHORT-AMT NUMERIC AND
  9503                          PL-OVER-SHORT-AMT > +0
  9504        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9505
  9506     IF PL-OVER-SHORT-PCT NUMERIC AND
  9507                          PL-OVER-SHORT-PCT > +0
  9508        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9509
  9510     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9511        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9512        IF WS-IG-OVRD-AM EQUAL SPACES
  9513            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9514
  9515 0314-A-H-BENEFIT-FOUND.
  9516
  9517     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9518
  9519     IF PB-ISSUE
  9520        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9521       ELSE
  9522        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9523
  9524     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9525     if cf-maximum-benefits (sub3) numeric
  9526        move cf-maximum-benefits (sub3)
  9527                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 175
* EL050.cbl
  9528     else
  9529        move zeros               to ws-ah-max-bens
  9530     end-if
  9531     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9532     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9533     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9534                                         WS-AH-REFUND-CALC.
  9535
  9536     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9537        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9538
  9539     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9540        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9541     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9542
  9543     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9544     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9545     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9546     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9547     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9548     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9549
  9550     IF PB-COMPANY-ID = 'NCL'  AND
  9551        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9552         NEXT SENTENCE
  9553     ELSE
  9554         IF SUB5 NOT GREATER THAN +20
  9555            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9556                MOVE WS-SAVE-BENEFIT-REM-TERM
  9557                                      TO WS-AM-AH-BENE-REM-TERM
  9558                                         EC-BR-AH-REM-TERM-CALC.
  9559
  9560     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9561     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9562
  9563     GO TO 0400-FIND-CARRIER.
  9564
  9565 0399-BENEFIT-NOT-FOUND.
  9566
  9567     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9568     MOVE ER-2605                TO WS-ERROR.
  9569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9570
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 176
* EL050.cbl
  9572
  9573 0400-FIND-CARRIER.
  9574
  9575     MOVE PB-SV-CARRIER          TO WS-CARR.
  9576
  9577     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9578     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9579     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9580     MOVE '6'                    TO CNTL-REC-TYPE.
  9581
  9582*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9583     MOVE SPACE                  TO WS-DMD-RATING-SW
  9584                                    EC-BR-DMD-RATING-SW.
  9585
  9586     MOVE '2'                    TO RC-SW-1.
  9587     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9588
  9589     IF NOT CF-CARRIER-MASTER
  9590        GO TO 0400-CARRIER-NOT-FOUND.
  9591
  9592 0400-BUILD-CARR-TOL.
  9593
  9594     IF CF-CR-TOL-PREM NUMERIC AND
  9595        CF-CR-TOL-PREM GREATER THAN +0
  9596        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9597                                    WS-TOL-AH-PREM.
  9598
  9599     IF CF-CR-TOL-REFUND NUMERIC AND
  9600        CF-CR-TOL-REFUND GREATER THAN +0
  9601        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9602                                    WS-TOL-AH-REFUND.
  9603
  9604     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9605        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9606        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9607                                    WS-AH-REFUND-OVS-AMT.
  9608
  9609     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9610        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9611        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9612                                    WS-AH-REFUND-OVS-PCT.
  9613
  9614     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9615        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9616        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9617                                    WS-TOL-AH-PREM-PCT.
  9618
  9619     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9620        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9621        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9622                                     WS-TOL-AH-REFUND-PCT.
  9623
  9624     IF CF-COMPANY-ID EQUAL 'DMD'
  9625         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9626                                    EC-BR-DMD-RATING-SW.
  9627
  9628     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9629     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 177
* EL050.cbl
  9630        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9631     END-IF
  9632     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9633        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9634     END-IF
  9635     IF WS-TOL-CLP-PCT = ZEROS
  9636        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9637     END-IF
  9638
  9639     IF WS-SPP-LEASE-COMM = ZEROS
  9640        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9641     END-IF
  9642     GO TO 0400-FIND-ERPDEF.
  9643
  9644 0400-CARRIER-NOT-FOUND.
  9645
  9646     MOVE ER-2602                TO WS-ERROR.
  9647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9648
  9649 0400-FIND-ERPDEF.
  9650*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9651     IF (PB-COMPANY-ID = 'DCC')
  9652        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9653        CONTINUE
  9654     ELSE
  9655        GO TO 0400-FIND-ERCOMP
  9656     END-IF
  9657     MOVE ' '                    TO PDEF-MASTER-SW
  9658     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9659     MOVE PB-STATE               TO ERPDEF-STATE
  9660     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9661        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9662     END-IF
  9663     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9664     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9665     IF PB-ISSUE
  9666        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9667     ELSE
  9668        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9669     END-IF
  9670     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9671     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9672     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9673     IF PDEF-MASTER-FOUND
  9674        MOVE 'N'                 TO PDEF-MASTER-SW
  9675        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9676        IF PDEF-MASTER-FOUND
  9677           IF (ERPDEF-KEY-SAVE (1:16) =
  9678                        PD-CONTROL-PRIMARY (1:16))
  9679              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9680              CONTINUE
  9681           ELSE
  9682              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9683              IF (ERPDEF-KEY-SAVE (1:16) =
  9684                        PD-CONTROL-PRIMARY (1:16))
  9685                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9686                 CONTINUE
  9687              ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 178
* EL050.cbl
  9688                 MOVE 'N'        TO PDEF-MASTER-SW
  9689              END-IF
  9690           END-IF
  9691        END-IF
  9692        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9693     END-IF
  9694     IF PDEF-MASTER-FOUND
  9695        IF PD-TRUNCATED = 'Y'
  9696           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9697        END-IF
  9698     END-IF
  9699     .
  9700 0400-FIND-ERCOMP.
  9701     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9702        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9703           (WS-SUB1 > +10)
  9704           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9705                 OR 'A' OR 'N'
  9706              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9707              MOVE PB-CARRIER    TO COMP-CARRIER
  9708              MOVE PB-GROUPING   TO COMP-GROUPING
  9709              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9710              MOVE AM-AGT (WS-SUB1)
  9711                                 TO COMP-FIN-RESP
  9712              MOVE 'G'           TO COMP-TYPE
  9713              PERFORM 8582-READ-COMPENSATION-MASTER
  9714                                 THRU 8582-EXIT
  9715              IF COMP-MASTER-FOUND
  9716                 IF CO-GA-INACTIVE
  9717                    MOVE ER-2763 TO WS-ERROR
  9718                    PERFORM 9900-ERROR-FORMAT
  9719                                 THRU 9900-EXIT
  9720                    MOVE +11     TO WS-SUB1
  9721                 END-IF
  9722                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9723                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9724                    MOVE ER-2788 TO WS-ERROR
  9725                    PERFORM 9900-ERROR-FORMAT
  9726                                 THRU 9900-EXIT
  9727                    MOVE +11     TO WS-SUB1
  9728                 END-IF
  9729              END-IF
  9730           END-IF
  9731        END-PERFORM
  9732     END-IF
  9733     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9734        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9735           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9736                                    WS-CLP-STATE
  9737        ELSE
  9738           MOVE SPACES           TO PB-I-CLP-STATE
  9739                                    WS-CLP-STATE
  9740        END-IF
  9741     END-IF
  9742
  9743     IF (PB-COMPANY-ID = 'DCC')
  9744        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9745        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 179
* EL050.cbl
  9746        CONTINUE
  9747     ELSE
  9748        GO TO 0400-FIND-STATE-RECORD
  9749     END-IF
  9750     MOVE SPACES                 TO WS-CLP-STATE
  9751     MOVE +0                     TO WS-BANK-FEE
  9752                                    WS-BANK-LFEE
  9753                                    WS-BANK-NOCHRGB
  9754
  9755     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9756     IF (PB-ISSUE)
  9757        AND (PB-I-BANK-NUMBER NOT =
  9758            SPACES AND ZEROS AND LOW-VALUES)
  9759        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9760     ELSE
  9761        IF (PB-CANCELLATION)
  9762           AND (PB-CI-BANK-NUMBER NOT =
  9763                SPACES AND ZEROS AND LOW-VALUES)
  9764           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9765        END-IF
  9766     END-IF
  9767     IF COMP-FIN-RESP NOT = LOW-VALUES
  9768        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9769        MOVE PB-CARRIER          TO COMP-CARRIER
  9770        MOVE PB-GROUPING         TO COMP-GROUPING
  9771        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9772        MOVE 'B'                 TO COMP-TYPE
  9773        PERFORM 8582-READ-COMPENSATION-MASTER
  9774                                 THRU 8582-EXIT
  9775        IF COMP-MASTER-FOUND
  9776           IF CO-MAX-BANK-FEE NOT NUMERIC
  9777              MOVE +0            TO CO-MAX-BANK-FEE
  9778           END-IF
  9779           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9780              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9781           END-IF
  9782           IF CO-GA-INACTIVE
  9783              MOVE ER-2763       TO WS-ERROR
  9784              PERFORM 9900-ERROR-FORMAT
  9785                                 THRU 9900-EXIT
  9786           END-IF
  9787           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9788              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9789              MOVE ER-2788 TO WS-ERROR
  9790              PERFORM 9900-ERROR-FORMAT
  9791                                 THRU 9900-EXIT
  9792              MOVE +11     TO WS-SUB1
  9793           END-IF
  9794           IF WS-AH-BEN-CATEGORY = 'G'
  9795              MOVE CO-MAX-BANK-FEE
  9796                                 TO WS-BANK-FEE
  9797                                    PB-I-BANK-FEE
  9798           ELSE
  9799              MOVE CO-MAX-BANK-FEE-LEASE
  9800                                 TO WS-BANK-LFEE
  9801                                    PB-I-BANK-FEE
  9802           END-IF
  9803           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 180
* EL050.cbl
  9804              AND (WS-AH-REFUND-CALC = 'G'))
  9805                        OR
  9806              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9807              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9808              CONTINUE
  9809           ELSE
  9810              MOVE ER-2789 TO WS-ERROR
  9811              PERFORM 9900-ERROR-FORMAT
  9812                                 THRU 9900-EXIT
  9813           END-IF
  9814           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9815                                    PB-I-CLP-STATE
  9816           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9817           MOVE CO-CARRIER       TO BXRF-CARRIER
  9818           MOVE CO-GROUPING      TO BXRF-GROUPING
  9819           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9820           MOVE BXRF-MAX-REC-LENGTH
  9821                                 TO BXRF-REC-LENGTH
  9822           PERFORM 8584-READ-BANK-CROSS-REF
  9823                                 THRU 8584-EXIT
  9824           IF BXRF-MASTER-FOUND
  9825              MOVE ' '           TO BANK-ACCT-SW
  9826              MOVE BK-BANK-POINTER-CNT
  9827                                 TO BK-BANK-POINTER-CNT
  9828              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9829                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9830                 OR (BANK-ACCT-FOUND)
  9831                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9832                    AND (BK-AM-EXP-DT (WS-SUB1)
  9833                                 > PB-CERT-EFF-DT)
  9834                    AND (BK-AM-EFF-DT (WS-SUB1)
  9835                                 NOT > PB-CERT-EFF-DT)
  9836                    SET BANK-ACCT-FOUND TO TRUE
  9837                 END-IF
  9838              END-PERFORM
  9839              IF NOT BANK-ACCT-FOUND
  9840                 MOVE ZEROS      TO WS-BANK-FEE
  9841                                    WS-BANK-LFEE
  9842                 MOVE ER-2869    TO WS-ERROR
  9843                 PERFORM 9900-ERROR-FORMAT
  9844                                 THRU 9900-EXIT
  9845              ELSE
  9846                 PERFORM 5000-PROCESS-REPS
  9847                                 THRU 5000-EXIT
  9848                 IF AGENT-MASTER-FOUND
  9849                    MOVE +0      TO WS-BANK-FEE
  9850                                    WS-BANK-LFEE
  9851*                   MOVE AG-SPP-FEES (1)
  9852*                                TO PB-I-BANK-FEE
  9853*                                   WS-BANK-FEE
  9854                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9855                       (WS-SUB1 > +10)
  9856                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9857                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9858                       END-IF
  9859                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9860                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9861                       END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 181
* EL050.cbl
  9862                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9863                          AG-SPP-FEES (WS-SUB1)
  9864                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9865                          AG-SPP-LFEES (WS-SUB1)
  9866                    END-PERFORM
  9867                    IF WS-AH-BEN-CATEGORY = 'G'
  9868                       MOVE WS-BANK-FEE
  9869                                 TO PB-I-BANK-FEE
  9870                    ELSE
  9871                       MOVE WS-BANK-LFEE
  9872                                 TO PB-I-BANK-FEE
  9873                    END-IF
  9874                 END-IF
  9875              END-IF
  9876           END-IF
  9877        ELSE
  9878           MOVE ER-2879          TO WS-ERROR
  9879           PERFORM 9900-ERROR-FORMAT
  9880                                 THRU 9900-EXIT
  9881        END-IF
  9882     ELSE
  9883        MOVE ER-2879             TO WS-ERROR
  9884        PERFORM 9900-ERROR-FORMAT
  9885                                 THRU 9900-EXIT
  9886     END-IF
  9887     IF WS-AH-BEN-CATEGORY = 'G'
  9888        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9889        + WS-BANK-FEE
  9890     ELSE
  9891        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9892        + WS-BANK-LFEE
  9893     END-IF
  9894     .
  9895 0400-FIND-STATE-RECORD.
  9896
  9897     IF WK-STATE-ADDR NOT = ZEROS
  9898         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9899         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9900         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9901         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9902         IF PB-SV-STATE = CF-STATE-CODE
  9903             GO TO 0405-CONTINUE-EDIT
  9904         ELSE
  9905             NEXT SENTENCE
  9906     ELSE
  9907         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9908
  9909     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9910     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9911     MOVE '3'                    TO CNTL-REC-TYPE.
  9912     MOVE +0                     TO CNTL-SEQ-NO.
  9913
  9914     MOVE '3'                    TO RC-SW-2.
  9915     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9916
  9917     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9918        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9919        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 182
* EL050.cbl
  9920        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9921                                    WS-TOL-AH-CLAIM
  9922                                    WS-MINIMUM-REFUND
  9923                                    WS-TOL-LF-PREM
  9924                                    WS-TOL-AH-PREM
  9925                                    WS-TOL-LF-REFUND
  9926                                    WS-TOL-AH-REFUND
  9927                                    EC-ST-TOL-PREM-PCT
  9928                                    WS-TOL-LF-PREM-PCT
  9929                                    WS-TOL-AH-PREM-PCT
  9930                                    EC-ST-TOL-REFUND-PCT
  9931                                    WS-TOL-LF-REFUND-PCT
  9932                                    WS-TOL-AH-REFUND-PCT
  9933                                    EC-ST-TOL-PREM
  9934                                    EC-ST-TOL-REFUND
  9935                                    EC-ST-FST-PMT-DAYS-MAX
  9936                                    WS-FREE-LOOK-PERIOD
  9937                                    WS-ST-LF-PREM-TAX
  9938                                    WS-ST-AH-PREM-TAX-I
  9939                                    WS-ST-AH-PREM-TAX-G
  9940                                    WS-BANK-FEE
  9941                                    WS-BANK-LFEE
  9942                                    WS-TOL-CLP-PCT
  9943                                    WS-SPP-LEASE-COMM
  9944                                    WS-INT-PERIODS
  9945                                    WS-EXTRA-PMTS
  9946        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9947                                    EC-ST-FST-PMT-DAYS-CHG
  9948                                    WS-LF-REM-TERM-CALC
  9949                                    WS-LF-REFUND-CALC
  9950                                    EC-ST-LF-REM-TERM-CALC
  9951                                    EC-ST-LF-REFUND-CALC
  9952                                    WS-AH-REM-TERM-CALC
  9953                                    WS-AH-REFUND-CALC
  9954                                    WS-LF-BEN-CATEGORY
  9955                                    WS-AH-BEN-CATEGORY
  9956                                    WS-CLP-STATE
  9957                                    WS-ST-REFUND-CLAIM-FLAG
  9958                                    WS-ST-CAUSAL-STATE
  9959                                    ws-st-agent-sig-edit
  9960                                    EC-ST-AH-REM-TERM-CALC
  9961                                    EC-ST-AH-REFUND-CALC
  9962          GO TO 0499-STATE-NOT-FOUND.
  9963
  9964     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9965
  9966 0405-CONTINUE-EDIT.
  9967
  9968     IF (PB-COMPANY-ID <> 'AHL')
  9969        and (pb-issue)
  9970        MOVE +0                  TO SUB3
  9971        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9972        IF SUB3 > +0
  9973           MOVE ER-3270          TO WS-ERROR
  9974           PERFORM 9900-ERROR-FORMAT
  9975                                 THRU 9900-EXIT
  9976        else
  9977           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 183
* EL050.cbl
  9978              MOVE ER-2722       TO WS-ERROR
  9979              PERFORM 9900-ERROR-FORMAT
  9980                                 THRU 9900-EXIT
  9981           end-if
  9982        END-IF
  9983     END-IF
  9984     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9985
  9986     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9987        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9988                                    WS-TOL-AH-CLAIM.
  9989
  9990     IF CF-ST-REFUND-MIN NOT NUMERIC
  9991        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9992
  9993     IF CF-ST-REFUND-MIN NOT = ZEROS
  9994        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9995
  9996     IF CF-ST-TOL-PREM  NOT = ZEROS
  9997        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9998                                    WS-TOL-AH-PREM
  9999        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
 10000
 10001     IF CF-ST-TOL-REFUND NOT = ZEROS
 10002        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
 10003                                    WS-TOL-AH-REFUND
 10004        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
 10005
 10006     IF CF-ST-OVR-SHT-AMT NUMERIC AND
 10007        CF-ST-OVR-SHT-AMT GREATER THAN +0
 10008        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
 10009                                    WS-AH-REFUND-OVS-AMT
 10010                                    EC-ST-OVR-SHT-AMT.
 10011
 10012     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10013        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10014        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10015                                    WS-TOL-LF-PREM-PCT
 10016                                    WS-TOL-AH-PREM-PCT.
 10017
 10018     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10019        CF-ST-TOL-REF-PCT GREATER THAN +0
 10020        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10021                                    WS-TOL-LF-REFUND-PCT
 10022                                    WS-TOL-AH-REFUND-PCT.
 10023
 10024     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10025        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10026        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10027                                    WS-AH-REFUND-OVS-PCT
 10028                                    EC-ST-OVR-SHT-PCT.
 10029
 10030     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10031     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10032
 10033     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10034          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10035
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 184
* EL050.cbl
 10036     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10037     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10038     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10039
 10040     IF CF-ST-LF-PREM-TAX NUMERIC
 10041        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10042     END-IF
 10043     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10044        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10045     END-IF
 10046     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10047        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10048     END-IF
 10049
 10050     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10051         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10052     END-IF.
 10053
 10054     IF CF-ST-CAUSAL-STATE > SPACES
 10055         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10056     END-IF.
 10057     if cf-st-extra-interest-periods not numeric
 10058        move zeros               to cf-st-extra-interest-periods
 10059     end-if
 10060     if cf-st-extra-payments not numeric
 10061        move zeros               to cf-st-extra-payments
 10062     end-if
 10063
 10064     move cf-st-extra-interest-periods
 10065                                 to ws-int-periods
 10066     move cf-st-extra-payments   to ws-extra-pmts
 10067     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10068     move cf-st-net-only-state   to ws-net-only-state
 10069     if cf-st-comm-cap-sl not numeric
 10070        move zeros               to cf-st-comm-cap-sl
 10071     end-if
 10072     if cf-st-comm-cap-jl not numeric
 10073        move zeros               to cf-st-comm-cap-jl
 10074     end-if
 10075     if cf-st-comm-cap-sa not numeric
 10076        move zeros               to cf-st-comm-cap-sa
 10077     end-if
 10078     if cf-st-comm-cap-ja not numeric
 10079        move zeros               to cf-st-comm-cap-ja
 10080     end-if
 10081     if cf-st-ga-comm-cap-sl not numeric
 10082        move zeros               to cf-st-ga-comm-cap-sl
 10083     end-if
 10084     if cf-st-ga-comm-cap-jl not numeric
 10085        move zeros               to cf-st-ga-comm-cap-jl
 10086     end-if
 10087     if cf-st-ga-comm-cap-sa not numeric
 10088        move zeros               to cf-st-ga-comm-cap-sa
 10089     end-if
 10090     if cf-st-ga-comm-cap-ja not numeric
 10091        move zeros               to cf-st-ga-comm-cap-ja
 10092     end-if
 10093
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 185
* EL050.cbl
 10094     if cf-st-tot-comm-cap-sl not numeric
 10095        move zeros               to cf-st-tot-comm-cap-sl
 10096     end-if
 10097     if cf-st-tot-comm-cap-jl not numeric
 10098        move zeros               to cf-st-tot-comm-cap-jl
 10099     end-if
 10100     if cf-st-tot-comm-cap-sa not numeric
 10101        move zeros               to cf-st-tot-comm-cap-sa
 10102     end-if
 10103     if cf-st-tot-comm-cap-ja not numeric
 10104        move zeros               to cf-st-tot-comm-cap-ja
 10105     end-if
 10106
 10107     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10108     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10109     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10110     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10111     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10112     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10113     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10114     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10115     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10116     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10117     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10118     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10119     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10120     IF WS-LF-BENEFIT-CD = ZEROS
 10121        GO TO 0410-CHECK-AH.
 10122
 10123     IF CF-ST-RT-CALC NOT = SPACES
 10124        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10125                                    EC-ST-LF-REM-TERM-CALC
 10126     END-IF
 10127
 10128     IF WS-LF-COVERAGE-TYPE = 'R'
 10129        IF WS-LF-EARNINGS-CALC = '5'
 10130           IF CF-ST-RF-LN-CALC > '0'
 10131              MOVE CF-ST-RF-LN-CALC
 10132                                 TO WS-LF-REFUND-CALC
 10133                                    EC-ST-LF-REFUND-CALC
 10134           END-IF
 10135        ELSE
 10136           IF CF-ST-RF-LR-CALC > '0'
 10137              MOVE CF-ST-RF-LR-CALC
 10138                                 TO WS-LF-REFUND-CALC
 10139                                    EC-ST-LF-REFUND-CALC
 10140           END-IF
 10141        END-IF
 10142     ELSE
 10143        IF CF-ST-RF-LL-CALC > '0'
 10144           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10145                                    EC-ST-LF-REFUND-CALC
 10146        END-IF
 10147     END-IF
 10148
 10149     IF CF-ST-RT-CALC NOT = SPACES
 10150        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10151                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 186
* EL050.cbl
 10152     END-IF
 10153
 10154     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10155     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10156
 10157     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10158
 10159     IF NO-BENEFIT-FOUND
 10160        GO TO 0410-CHECK-AH.
 10161
 10162     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10163        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10164                                 TO EC-ST-LF-REM-TERM-CALC
 10165                                    WS-LF-REM-TERM-CALC
 10166     END-IF
 10167
 10168     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10169        MOVE CF-ST-REFUND-CALC (SUB3)
 10170                                 TO WS-LF-REFUND-CALC
 10171                                    EC-ST-LF-REFUND-CALC
 10172     END-IF
 10173*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10174     if cf-st-extra-periods (sub3) not numeric
 10175        move zeros               to cf-st-extra-periods (sub3)
 10176     end-if
 10177     if cf-st-extra-periods (sub3) > zeros
 10178        if ws-lf-ben-category = 'P'
 10179           move cf-st-extra-periods (sub3)
 10180                                 to ws-extra-pmts
 10181        else
 10182           if ws-lf-ben-category = 'I'
 10183              move cf-st-extra-periods (sub3)
 10184                                 to ws-int-periods
 10185           end-if
 10186        end-if
 10187     end-if
 10188     .
 10189 0410-CHECK-AH.
 10190
 10191     IF WS-AH-BENEFIT-CD = ZEROS
 10192        GO TO 0500-SET-ACCOUNT.
 10193
 10194     IF CF-ST-RT-CALC NOT = SPACES
 10195        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10196                                    EC-ST-AH-REM-TERM-CALC
 10197     END-IF
 10198
 10199     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10200        IF CF-ST-RF-CP-CALC > '0'
 10201           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10202                                    EC-ST-AH-REFUND-CALC
 10203        END-IF
 10204     ELSE
 10205        IF CF-ST-RF-AH-CALC > '0'
 10206           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10207                                    EC-ST-AH-REFUND-CALC
 10208        END-IF
 10209     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 187
* EL050.cbl
 10210     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10211     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10212
 10213     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10214
 10215     IF NO-BENEFIT-FOUND
 10216        GO TO 0500-SET-ACCOUNT.
 10217
 10218     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10219        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10220                                 TO WS-AH-REM-TERM-CALC
 10221                                    EC-ST-AH-REM-TERM-CALC
 10222     END-IF
 10223
 10224     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10225        MOVE CF-ST-REFUND-CALC (SUB3)
 10226                                 TO WS-AH-REFUND-CALC
 10227                                    EC-ST-AH-REFUND-CALC
 10228     END-IF
 10229
 10230*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10231
 10232     GO TO 0500-SET-ACCOUNT.
 10233
 10234 0499-STATE-NOT-FOUND.
 10235
 10236     MOVE ER-2603                TO WS-ERROR.
 10237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10238
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 188
* EL050.cbl
 10240
 10241 0500-SET-ACCOUNT.
 10242*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10243     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10244        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10245        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10246        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10247        MOVE '3'                 TO CNTL-REC-TYPE
 10248        MOVE +0                  TO CNTL-SEQ-NO
 10249
 10250        MOVE '3'                 TO RC-SW-2
 10251        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10252
 10253        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10254           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10255           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10256           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10257                                    WS-ST-AH-PREM-TAX-I
 10258                                    WS-ST-AH-PREM-TAX-G
 10259        ELSE
 10260           IF CF-ST-LF-PREM-TAX NUMERIC
 10261              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10262           END-IF
 10263           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10264              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10265           END-IF
 10266           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10267              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10268           END-IF
 10269        END-IF
 10270        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10271     END-IF
 10272*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10273*  FOR DCC ONLY
 10274     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10275
 10276        MOVE ' '                 TO STAT-MASTER-SW
 10277        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10278        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10279        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10280        MOVE PB-STATE            TO ELSTAT-STATE
 10281        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10282           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10283        END-IF
 10284
 10285        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10286        SET BIN-TO-GREG          TO TRUE
 10287        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10288        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10289        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10290
 10291        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10292        IF STAT-MASTER-FOUND
 10293           MOVE 'N'              TO STAT-MASTER-SW
 10294           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10295           IF STAT-MASTER-FOUND
 10296              IF (ELSTAT-KEY-SAVE (1:12) =
 10297                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 189
* EL050.cbl
 10298                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10299                    MOVE 'F'        TO STAT-MASTER-SW
 10300                 ELSE
 10301                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10302                    IF (STAT-MASTER-FOUND)
 10303                       AND (ELSTAT-KEY-SAVE (1:12) =
 10304                           SF-CONTROL-PRIMARY (1:12))
 10305                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10306                       MOVE 'F'     TO STAT-MASTER-SW
 10307                    END-IF
 10308                 END-IF
 10309              END-IF
 10310           END-IF
 10311        END-IF
 10312
 10313        IF STAT-MASTER-SW = 'F'
 10314           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10315              and (sf-st-lf-prem-tax > zeros)
 10316              MOVE SF-ST-LF-PREM-TAX
 10317                                 TO WS-ST-LF-PREM-TAX
 10318           END-IF
 10319           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10320              and (sf-st-ah-prem-tax-i > zeros)
 10321              MOVE SF-ST-AH-PREM-TAX-I
 10322                                 TO WS-ST-AH-PREM-TAX-I
 10323           END-IF
 10324           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10325              and (sf-st-ah-prem-tax-g > zeros)
 10326              MOVE SF-ST-AH-PREM-TAX-G
 10327                                 TO WS-ST-AH-PREM-TAX-G
 10328           END-IF
 10329        END-IF
 10330     END-IF
 10331     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10332        AND (PB-ISSUE)
 10333        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10334        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10335        AND (AM-GPCD = 06)
 10336        MOVE 'Y'                 TO WS-GOOD-HIN
 10337        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10338           MOVE PB-I-VIN         TO WS-WORK-VIN
 10339           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10340              (V1 > 16)
 10341              IF WS-WORK-VIN (V1:1) NUMERIC
 10342                 MOVE WS-WORK-VIN-N (V1)
 10343                                 TO WS-ROW-B-VAL (V1)
 10344              ELSE
 10345                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10346                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10347                    OR (V2 > 26)
 10348                 END-PERFORM
 10349                 IF V2 < 27
 10350                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10351                 ELSE
 10352                    MOVE 'N'     TO WS-GOOD-HIN
 10353                 END-IF
 10354              END-IF
 10355              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 190
* EL050.cbl
 10356                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10357              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10358                 WS-ROW-D-VAL (V1)
 10359           END-PERFORM
 10360           MOVE ZEROS            TO WS-VIN-REMAINDER
 10361           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10362             REMAINDER WS-VIN-REMAINDER
 10363           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10364              CONTINUE
 10365           ELSE
 10366              MOVE 'N'           TO WS-GOOD-HIN
 10367           END-IF
 10368        ELSE
 10369           MOVE 'N'              TO WS-GOOD-HIN
 10370        END-IF
 10371        IF WS-GOOD-HIN NOT = 'Y'
 10372           MOVE ER-3826           TO WS-ERROR
 10373           PERFORM 9900-ERROR-FORMAT
 10374                                 THRU 9900-EXIT
 10375        END-IF
 10376     END-IF
 10377     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10378        AND (PB-ISSUE)
 10379        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10380        AND (AM-GPCD NOT = 06)
 10381        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10382           perform 3400-edit-vin thru 3400-exit
 10383        ELSE
 10384          MOVE ER-3826           TO WS-ERROR
 10385          PERFORM 9900-ERROR-FORMAT
 10386                                 THRU 9900-EXIT
 10387        END-IF
 10388     END-IF
 10389     if (pb-company-id = 'CID')
 10390        and (pb-issue)
 10391        and (pb-i-vin not = spaces and low-values and zeros)
 10392        perform 3400-edit-vin    thru 3400-exit
 10393     end-if
 10394******************************************************************
 10395******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10396******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10397******* METHODS.
 10398******************************************************************
 10399     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10400        IF PB-CANCELLATION
 10401           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10402              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10403                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10404                IF FORM-MASTER-FOUND
 10405                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10406******************************************************************
 10407
 10408     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10409     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10410
 10411     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10412     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10413     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 191
* EL050.cbl
 10414     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10415
 10416
 10417     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10418     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10419     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10420
 10421     IF AM-LF-OB-RATE NOT NUMERIC
 10422         MOVE ZERO               TO AM-LF-OB-RATE.
 10423
 10424     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10425         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10426
 10427     IF AM-AH-OB-RATE NOT NUMERIC
 10428         MOVE ZERO               TO AM-AH-OB-RATE.
 10429
 10430     IF WS-LF-JOINT-INDICATOR = 'J'
 10431         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10432     ELSE
 10433         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10434
 10435     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10436
 10437     IF WS-IG-OVRD-AM  EQUAL SPACE
 10438         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10439
 10440     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10441         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10442                                       WS-IG-OVRD
 10443     ELSE
 10444         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10445             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10446                                       WS-IG-OVRD
 10447         ELSE
 10448             MOVE AM-IG             TO WS-IG-OVRD-AH
 10449                                       WS-IG-OVRD.
 10450
 10451     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10452         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10453                                       WS-IG-OVRD
 10454     ELSE
 10455         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10456             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10457                                       WS-IG-OVRD
 10458         ELSE
 10459             MOVE AM-IG             TO WS-IG-OVRD-LF
 10460                                       WS-IG-OVRD.
 10461
 10462     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10463     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10464     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10465     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10466*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10467     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10468                                              TO 'PRLDSFCTIA'.
 10469
 10470     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10471     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 192
* EL050.cbl
 10472     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10473     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10474
 10475     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10476     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10477     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10478     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10479     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10480     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10481     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10482
 10483     IF WS-ACCT-AH-DEV-PCT > +0
 10484        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10485     ELSE
 10486        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10487
 10488     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10489        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10490     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10491        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10492
 10493        IF AM-EARN-METHOD-L = 'S'
 10494            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10495                                        WS-LF-REFUND-CALC.
 10496
 10497        IF AM-EARN-METHOD-R = 'S'
 10498            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10499                                        WS-LF-REFUND-CALC.
 10500
 10501     IF WS-LF-COVERAGE-TYPE = 'R'
 10502         IF AM-EARN-METHOD-R = 'R'
 10503            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10504                                    WS-LF-REFUND-CALC.
 10505     IF WS-LF-COVERAGE-TYPE = 'R'
 10506         IF AM-EARN-METHOD-R = 'P'
 10507            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10508                                    WS-LF-REFUND-CALC.
 10509     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10510         IF AM-EARN-METHOD-L = 'R'
 10511            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10512                                    WS-LF-REFUND-CALC.
 10513     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10514         IF AM-EARN-METHOD-L = 'P'
 10515            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10516                                    WS-LF-REFUND-CALC.
 10517     IF WS-LF-COVERAGE-TYPE = 'R'
 10518         IF AM-EARN-METHOD-R = 'A'
 10519            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10520                                    WS-LF-REFUND-CALC.
 10521     IF WS-LF-COVERAGE-TYPE = 'R'
 10522         IF AM-EARN-METHOD-R = 'M'
 10523            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10524                                    WS-LF-REFUND-CALC.
 10525     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10526         IF AM-EARN-METHOD-L = 'A'
 10527            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10528                                    WS-LF-REFUND-CALC.
 10529     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 193
* EL050.cbl
 10530         IF AM-EARN-METHOD-L = 'M'
 10531            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10532                                    WS-LF-REFUND-CALC.
 10533
 10534     IF AM-EARN-METHOD-A = 'R'
 10535        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10536                                    WS-AH-REFUND-CALC.
 10537     IF AM-EARN-METHOD-A = 'P'
 10538        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10539                                    WS-AH-REFUND-CALC.
 10540     IF AM-EARN-METHOD-A = 'C'
 10541        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10542                                    WS-AH-REFUND-CALC.
 10543     IF AM-EARN-METHOD-A = 'A'
 10544        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10545                                    WS-AH-REFUND-CALC.
 10546     IF AM-EARN-METHOD-A = 'M'
 10547        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10548                                    WS-AH-REFUND-CALC.
 10549     IF AM-EARN-METHOD-A = 'N'
 10550        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10551                                    WS-AH-REFUND-CALC.
 10552     IF AM-EARN-METHOD-A = 'S'
 10553        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10554                                    WS-AH-REFUND-CALC.
 10555
 10556     IF AM-TOL-PREM NOT = ZEROS
 10557        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10558                                    WS-TOL-AH-PREM.
 10559
 10560     IF AM-OVR-SHT-AMT NUMERIC AND
 10561                  AM-OVR-SHT-AMT > 0
 10562        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10563                                    EC-AM-LF-OVR-SHT-AMT
 10564                                    WS-AH-REFUND-OVS-AMT
 10565                                    EC-AM-AH-OVR-SHT-AMT.
 10566
 10567     IF AM-OVR-SHT-PCT NUMERIC AND
 10568                    AM-OVR-SHT-PCT > 0
 10569        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10570                                    EC-AM-LF-OVR-SHT-PCT
 10571                                    WS-AH-REFUND-OVS-PCT
 10572                                    EC-AM-AH-OVR-SHT-PCT.
 10573
 10574     IF AM-TOL-REF-PCT NUMERIC AND
 10575                  AM-TOL-REF-PCT > 0
 10576        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10577                                    WS-TOL-AH-REFUND-PCT.
 10578
 10579     IF AM-TOL-REF  NOT = ZEROS  AND
 10580                  AM-TOL-REF NUMERIC
 10581        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10582                                    EC-AM-LF-TOL-REFUND
 10583                                    WS-TOL-AH-REFUND
 10584                                    EC-AM-AH-TOL-REFUND.
 10585
 10586     IF AM-TOL-CLM  NOT = ZEROS
 10587        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 194
* EL050.cbl
 10588                                    WS-TOL-AH-CLAIM.
 10589
 10590     IF AM-CLP-TOL-PCT NOT NUMERIC
 10591        MOVE +0                  TO AM-CLP-TOL-PCT
 10592     END-IF
 10593
 10594     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10595        MOVE +0                  TO AM-SPP-LEASE-COMM
 10596     END-IF
 10597     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10598        MOVE WS-PL-TOL-LF-PREM-PCT
 10599                                 TO WS-TOL-LF-PREM-PCT.
 10600
 10601     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10602        MOVE WS-PL-TOL-AH-PREM-PCT
 10603                                 TO WS-TOL-AH-PREM-PCT.
 10604
 10605     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10606        MOVE WS-PL-TOL-LF-REFUND-PCT
 10607                                 TO WS-TOL-LF-REFUND-PCT.
 10608
 10609     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10610        MOVE WS-PL-TOL-AH-REFUND-PCT
 10611                                 TO WS-TOL-AH-REFUND-PCT.
 10612
 10613     IF WS-PL-REF-OVS-AMT > +0
 10614        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10615
 10616     IF WS-PL-REF-OVS-PCT > +0
 10617        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10618
 10619     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10620        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10621     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10622        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10623     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10624        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10625     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10626        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10627     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10628        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10629     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10630        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10631
 10632     IF WS-AH-PL-REF-OVS-AMT > +0
 10633        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10634
 10635     IF WS-AH-PL-REF-OVS-PCT > +0
 10636        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10637
 10638     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10639     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10640
 10641     IF PB-CANCELLATION
 10642        GO TO 3000-CONTINUE-EDIT.
 10643
 10644     MOVE +1 TO SUB1.
 10645     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 195
* EL050.cbl
 10646     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10647
 10648     IF CF-COMPANY-ID = 'DMD'
 10649       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10650         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10651        ELSE
 10652         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10653
 10654  0525-FIND-ACCT-COMM.
 10655     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10656        NEXT SENTENCE
 10657      ELSE
 10658         ADD +1 TO SUB1
 10659         IF SUB1 LESS +11
 10660            GO TO 0525-FIND-ACCT-COMM
 10661          ELSE
 10662             GO TO 0550-st-comm-cap-check.
 10663
 10664     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10665     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10666                                    PB-I-LIFE-COMMISSION.
 10667***  IF PB-COMPANY-ID = 'CRI'
 10668     IF PB-PREM-ACCTNG-ONLY
 10669         GO TO 0550-st-comm-cap-check.
 10670
 10671     MOVE '0530' TO CTBL-SW.
 10672     MOVE ' '    TO WS-CTBL-READ-SW.
 10673
 10674
 10675 0530-GET-AH-COMP.
 10676     IF NO-AH-COVERAGE  OR
 10677        NO-AH-BENEFIT-MATCH
 10678           GO TO 0540-NEXT-READ-STEP.
 10679
 10680     IF AM-A-COM (SUB1) NUMERIC
 10681        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10682         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10683         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10684         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10685         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10686     ELSE
 10687          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10688          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10689          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10690          MOVE ZEROS             TO WS-SUB1
 10691                                    WS-COMMISSION
 10692          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10693          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10694          IF WS-COMMISSION > ZEROS
 10695             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10696             GO TO 0540-NEXT-READ-STEP
 10697          END-IF
 10698          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10699          IF CTBL-TABLE-FOUND
 10700             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10701                                        PB-I-AH-TERM
 10702             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10703             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 196
* EL050.cbl
 10704             GO TO 0540-NEXT-READ-STEP
 10705          ELSE
 10706             IF FIRST-TIME-THROUGH
 10707                 GO TO 0530-GET-AH-COMP
 10708             ELSE
 10709                 MOVE ER-2609                TO WS-ERROR
 10710                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10711
 10712 0540-NEXT-READ-STEP.
 10713     MOVE '0540' TO CTBL-SW.
 10714     MOVE ' '    TO WS-CTBL-READ-SW.
 10715
 10716 0540-GET-LF-COMP.
 10717     IF NO-LIFE-COVERAGE  OR
 10718        NO-LF-BENEFIT-MATCH
 10719           GO TO 0550-st-comm-cap-check.
 10720
 10721     IF WS-LF-JOINT-INDICATOR = 'J'
 10722        IF AM-J-COM (SUB1) NUMERIC
 10723           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10724           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10725           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10726           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10727           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10728        ELSE
 10729           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10730           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10731           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10732           MOVE ZEROS                TO WS-SUB1
 10733                                        WS-COMMISSION
 10734           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10735           IF WS-COMMISSION > ZEROS
 10736              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10737              GO TO 0550-st-comm-cap-check
 10738           END-IF
 10739           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10740           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10741           IF CTBL-TABLE-FOUND
 10742              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10743              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10744              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10745              GO TO 0550-st-comm-cap-check
 10746           ELSE
 10747              IF FIRST-TIME-THROUGH
 10748                  GO TO 0540-GET-LF-COMP
 10749              ELSE
 10750                  MOVE ER-2609                TO WS-ERROR
 10751                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10752                  GO TO 0550-st-comm-cap-check.
 10753
 10754     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10755        IF AM-L-COM (SUB1) NUMERIC
 10756           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10757           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10758           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10759           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10760           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10761        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 197
* EL050.cbl
 10762           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10763           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10764           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10765           MOVE ZEROS                TO WS-SUB1
 10766                                        WS-COMMISSION
 10767           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10768           IF WS-COMMISSION IS GREATER THAN ZEROS
 10769              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10770              GO TO 0550-st-comm-cap-check
 10771           END-IF
 10772           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10773           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10774           IF CTBL-TABLE-FOUND
 10775              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10776              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10777              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10778              GO TO 0550-st-comm-cap-check
 10779           ELSE
 10780              IF FIRST-TIME-THROUGH
 10781                  GO TO 0540-GET-LF-COMP
 10782              ELSE
 10783                  MOVE ER-2609                TO WS-ERROR
 10784                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10785
 10786 0550-st-comm-cap-check.
 10787
 10788     move +0                     to ws-tot-sl-wk-rate
 10789                                    ws-sl-wk-rate
 10790                                    ws-ga-sl-wk-rate
 10791                                    ws-tot-jl-wk-rate
 10792                                    ws-jl-wk-rate
 10793                                    ws-ga-jl-wk-rate
 10794                                    ws-tot-sa-wk-rate
 10795                                    ws-sa-wk-rate
 10796                                    ws-ga-sa-wk-rate
 10797                                    ws-tot-ja-wk-rate
 10798                                    ws-ja-wk-rate
 10799                                    ws-ga-ja-wk-rate
 10800     perform varying sub5 from +1 by +1 until
 10801        (sub5 > +10)
 10802        move +0                  to ws-wk-rate
 10803        if (am-gl-codes (sub5) <> 'Y')
 10804           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10805           if pb-i-lf-benefit-cd <> '  ' and '00'
 10806              move zeros         to ws-wk-rate
 10807              if (am-l-com (sub5) numeric)
 10808                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10809                 move am-l-com(sub5)
 10810                                 to ws-wk-rate
 10811              else
 10812                 move pb-company-cd to ctbl-company-cd
 10813                 move pb-i-lf-benefit-cd
 10814                                 to ctbl-ben-code
 10815                 move pb-i-lf-term  to ws-work-term
 10816                 move pb-life-override-l1
 10817                                 to ctbl-ben-type
 10818                 move zeros      to ws-sub1
 10819                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 198
* EL050.cbl
 10820                 move am-l-coma (sub5)
 10821                                 to ctbl-table
 10822                 move '0540'     to ctbl-sw
 10823                 perform 0552-get-it
 10824                                 thru 0552-exit
 10825              end-if
 10826              compute ws-tot-sl-wk-rate =
 10827                 ws-tot-sl-wk-rate + ws-wk-rate
 10828              if am-com-typ(sub5) = 'C' or 'D'
 10829                 compute ws-sl-wk-rate =
 10830                    ws-sl-wk-rate + ws-wk-rate
 10831              else
 10832                 if am-com-typ(sub5) = 'O' or 'P'
 10833                    compute ws-ga-sl-wk-rate =
 10834                       ws-ga-sl-wk-rate + ws-wk-rate
 10835                 end-if
 10836              end-if
 10837
 10838              move zeros         to ws-wk-rate
 10839              if (am-j-com (sub5) numeric)
 10840                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10841                 move am-j-com(sub5)
 10842                                 to ws-wk-rate
 10843              else
 10844                 move pb-company-cd to ctbl-company-cd
 10845                 move pb-i-lf-benefit-cd
 10846                                 to ctbl-ben-code
 10847                 move pb-i-lf-term  to ws-work-term
 10848                 move pb-life-override-l1
 10849                                 to ctbl-ben-type
 10850                 move zeros      to ws-sub1
 10851                                    ws-commission
 10852                 move am-j-coma (sub5)
 10853                                 to ctbl-table
 10854                 move '0540'     to ctbl-sw
 10855                 perform 0552-get-it
 10856                                 thru 0552-exit
 10857              end-if
 10858              compute ws-tot-jl-wk-rate =
 10859                 ws-tot-jl-wk-rate + ws-wk-rate
 10860              if am-com-typ(sub5) = 'C' or 'D'
 10861                 compute ws-jl-wk-rate =
 10862                    ws-jl-wk-rate + ws-wk-rate
 10863              else
 10864                 if am-com-typ(sub5) = 'O' or 'P'
 10865                    compute ws-ga-jl-wk-rate =
 10866                       ws-ga-jl-wk-rate + ws-wk-rate
 10867                 end-if
 10868              end-if
 10869           end-if
 10870           move zeros            to ws-wk-rate
 10871
 10872           if pb-i-ah-benefit-cd <> '  ' and '00'
 10873              if (am-a-com (sub5) numeric)
 10874                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10875                 move am-a-com(sub5)
 10876                                 to ws-wk-rate
 10877              else
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 199
* EL050.cbl
 10878                 move pb-company-cd to ctbl-company-cd
 10879                 move pb-i-ah-benefit-cd
 10880                                 to ctbl-ben-code
 10881                 move pb-i-ah-term  to ws-work-term
 10882                 move pb-ah-override-l1
 10883                                 to ctbl-ben-type
 10884                 move zeros      to ws-sub1
 10885                                    ws-commission
 10886                 move am-a-coma (sub5)
 10887                                 to ctbl-table
 10888                 move '0530'     to ctbl-sw
 10889                 perform 0552-get-it
 10890                                 thru 0552-exit
 10891              end-if
 10892              compute ws-tot-sa-wk-rate =
 10893                 ws-tot-sa-wk-rate + ws-wk-rate
 10894              if am-com-typ(sub5) = 'C' or 'D'
 10895                 compute ws-sa-wk-rate =
 10896                    ws-sa-wk-rate + ws-wk-rate
 10897              else
 10898                 if am-com-typ(sub5) = 'O' or 'P'
 10899                    compute ws-ga-sa-wk-rate =
 10900                       ws-ga-sa-wk-rate + ws-wk-rate
 10901                 end-if
 10902              end-if
 10903           end-if
 10904        end-if
 10905     end-perform
 10906
 10907     go to 0550-continue
 10908
 10909     .
 10910 0552-get-it.
 10911
 10912     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10913     MOVE ZEROS                  TO WS-SUB1
 10914                                    WS-COMMISSION
 10915     MOVE ' '                    TO WS-CTBL-READ-SW
 10916     PERFORM 8300-READ-CTBL-TABLE
 10917                                 THRU 8300-EXIT
 10918     IF FIRST-TIME-THROUGH
 10919        MOVE 'AA'                TO CTBL-BEN-CODE
 10920        PERFORM 8300-READ-CTBL-TABLE
 10921                                 THRU 8300-EXIT
 10922     END-IF
 10923     IF CTBL-TABLE-FOUND
 10924        if pb-life-override-l1 = ctbl-ben-type
 10925           move pb-i-lf-benefit-amt
 10926                                 to WS-COMM-CK-AMT
 10927        else
 10928           compute ws-comm-ck-amt =
 10929              pb-I-ah-benefit-amt * pb-i-ah-term
 10930        end-if
 10931        PERFORM 8800-GET-COMP-RATE
 10932                                 THRU 8800-EXIT
 10933     else
 10934        move zeros               to ws-wk-rate
 10935     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 200
* EL050.cbl
 10936
 10937     .
 10938 0552-exit.
 10939     exit.
 10940
 10941 0550-continue.
 10942
 10943     if ws-lf-joint-indicator = 'J'
 10944        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10945           and (ws-st-comm-cap-jl <> zeros)
 10946           MOVE ER-1956          TO WS-ERROR
 10947           PERFORM 9900-ERROR-FORMAT
 10948                                 THRU 9900-EXIT
 10949        end-if
 10950        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10951           and (ws-st-ga-comm-cap-jl <> zeros)
 10952           MOVE ER-1959          TO WS-ERROR
 10953           PERFORM 9900-ERROR-FORMAT
 10954                                 THRU 9900-EXIT
 10955        end-if
 10956        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10957           and (ws-st-tot-comm-cap-jl <> zeros)
 10958           MOVE ER-1962          TO WS-ERROR
 10959           PERFORM 9900-ERROR-FORMAT
 10960                                 THRU 9900-EXIT
 10961        end-if
 10962     else
 10963        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10964           and (ws-st-comm-cap-sl <> zeros)
 10965           MOVE ER-1955          TO WS-ERROR
 10966           PERFORM 9900-ERROR-FORMAT
 10967                                 THRU 9900-EXIT
 10968        end-if
 10969        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10970           and (ws-st-ga-comm-cap-sl <> zeros)
 10971           MOVE ER-1958          TO WS-ERROR
 10972           PERFORM 9900-ERROR-FORMAT
 10973                                 THRU 9900-EXIT
 10974        end-if
 10975        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10976           and (ws-st-tot-comm-cap-sl <> zeros)
 10977           MOVE ER-1961          TO WS-ERROR
 10978           PERFORM 9900-ERROR-FORMAT
 10979                                 THRU 9900-EXIT
 10980        end-if
 10981
 10982     if ws-ah-joint-indicator = 'J'
 10983        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10984           and (ws-st-comm-cap-ja <> zeros)
 10985           MOVE ER-1957          TO WS-ERROR
 10986           PERFORM 9900-ERROR-FORMAT
 10987                                 THRU 9900-EXIT
 10988        end-if
 10989        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10990           and (ws-st-ga-comm-cap-ja <> zeros)
 10991           MOVE ER-1960          TO WS-ERROR
 10992           PERFORM 9900-ERROR-FORMAT
 10993                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 201
* EL050.cbl
 10994        end-if
 10995        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10996           and (ws-st-tot-comm-cap-ja <> zeros)
 10997           MOVE ER-1963          TO WS-ERROR
 10998           PERFORM 9900-ERROR-FORMAT
 10999                                 THRU 9900-EXIT
 11000        end-if
 11001     else
 11002        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 11003           and (ws-st-comm-cap-sa <> zeros)
 11004           MOVE ER-1957          TO WS-ERROR
 11005           PERFORM 9900-ERROR-FORMAT
 11006                                 THRU 9900-EXIT
 11007        end-if
 11008        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 11009           and (ws-st-ga-comm-cap-sa <> zeros)
 11010           MOVE ER-1960          TO WS-ERROR
 11011           PERFORM 9900-ERROR-FORMAT
 11012                                 THRU 9900-EXIT
 11013        end-if
 11014        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11015           and (ws-st-tot-comm-cap-sa <> zeros)
 11016           MOVE ER-1963          TO WS-ERROR
 11017           PERFORM 9900-ERROR-FORMAT
 11018                                 THRU 9900-EXIT
 11019        end-if
 11020     end-if
 11021     .
 11022 0560-EDIT-CONTINUE.
 11023     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11024                                    WS-AH-PMF-COMM
 11025*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11026*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11027     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11028        (SUB1 > +10)
 11029        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11030           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11031           MOVE '0530'           TO CTBL-SW
 11032           MOVE ' '              TO WS-CTBL-READ-SW
 11033           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11034           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11035           MOVE '0540'           TO CTBL-SW
 11036           MOVE ' '              TO WS-CTBL-READ-SW
 11037           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11038        END-IF
 11039     END-PERFORM
 11040     GO TO 0564-EDIT-CONTINUE
 11041     .
 11042 0561-CHECK-AH.
 11043     IF (NO-AH-COVERAGE)
 11044        OR (NO-AH-BENEFIT-MATCH)
 11045        CONTINUE
 11046     ELSE
 11047        IF (AM-A-COM (SUB1) NUMERIC)
 11048           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11049           IF (AM-COM-TYP (SUB1) = 'A')
 11050              AND (WS-AH-PMF-COMM = ZEROS)
 11051              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 202
* EL050.cbl
 11052           END-IF
 11053           CONTINUE
 11054        ELSE
 11055           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11056           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11057           MOVE PB-AH-OVERRIDE-L1
 11058                                 TO CTBL-BEN-TYPE
 11059           MOVE ZEROS            TO WS-SUB1
 11060                                    WS-COMMISSION
 11061           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11062           PERFORM 8300-READ-CTBL-TABLE
 11063                                 THRU 8300-EXIT
 11064           IF CTBL-TABLE-FOUND
 11065              IF (AM-COM-TYP (SUB1) = 'A')
 11066                 AND (WS-AH-PMF-COMM = ZEROS)
 11067                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11068                                        PB-I-AH-TERM
 11069                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11070                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11071              END-IF
 11072              CONTINUE
 11073           ELSE
 11074              IF FIRST-TIME-THROUGH
 11075                 GO TO 0561-CHECK-AH
 11076              ELSE
 11077                 MOVE ER-2609    TO WS-ERROR
 11078                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11079              END-IF
 11080           END-IF
 11081        END-IF
 11082     END-IF
 11083     .
 11084 0561-EXIT.
 11085     EXIT.
 11086 0563-CHECK-LF.
 11087     IF (NO-LIFE-COVERAGE)
 11088        OR (NO-LF-BENEFIT-MATCH)
 11089        CONTINUE
 11090     ELSE
 11091        IF WS-LF-JOINT-INDICATOR = 'J'
 11092           IF AM-J-COM (SUB1) NUMERIC
 11093              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11094              IF (AM-COM-TYP (SUB1) = 'A')
 11095                 AND (WS-LF-PMF-COMM = ZEROS)
 11096                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11097              END-IF
 11098              CONTINUE
 11099           ELSE
 11100              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11101              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11102              MOVE PB-LIFE-OVERRIDE-L1
 11103                                 TO CTBL-BEN-TYPE
 11104              MOVE ZEROS         TO WS-SUB1
 11105                                    WS-COMMISSION
 11106              MOVE AM-J-COMA (SUB1)
 11107                                 TO CTBL-TABLE
 11108              PERFORM 8300-READ-CTBL-TABLE
 11109                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 203
* EL050.cbl
 11110              IF CTBL-TABLE-FOUND
 11111                 IF (AM-COM-TYP (SUB1) = 'A')
 11112                    AND (WS-LF-PMF-COMM = ZEROS)
 11113                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11114                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11115                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11116                 END-IF
 11117                 CONTINUE
 11118              ELSE
 11119                 IF FIRST-TIME-THROUGH
 11120                    GO TO 0563-CHECK-LF
 11121                 ELSE
 11122                    MOVE ER-2609 TO WS-ERROR
 11123                    PERFORM 9900-ERROR-FORMAT
 11124                                 THRU 9900-EXIT
 11125*                   GO TO 0560-EDIT-CONTINUE
 11126                 END-IF
 11127              END-IF
 11128           END-IF
 11129        ELSE
 11130           IF AM-L-COM (SUB1) NUMERIC
 11131              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11132              IF (AM-COM-TYP (SUB1) = 'A')
 11133                 AND (WS-LF-PMF-COMM = ZEROS)
 11134                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11135              END-IF
 11136              CONTINUE
 11137           ELSE
 11138              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11139              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11140              MOVE PB-LIFE-OVERRIDE-L1
 11141                                 TO CTBL-BEN-TYPE
 11142              MOVE ZEROS         TO WS-SUB1
 11143                                    WS-COMMISSION
 11144              MOVE AM-L-COMA (SUB1)
 11145                                 TO CTBL-TABLE
 11146              PERFORM 8300-READ-CTBL-TABLE
 11147                                 THRU 8300-EXIT
 11148              IF CTBL-TABLE-FOUND
 11149                 CONTINUE
 11150              ELSE
 11151                 IF FIRST-TIME-THROUGH
 11152                    GO TO 0563-CHECK-LF
 11153                 ELSE
 11154                    MOVE ER-2609 TO WS-ERROR
 11155                    PERFORM 9900-ERROR-FORMAT
 11156                                 THRU 9900-EXIT
 11157                 END-IF
 11158              END-IF
 11159           END-IF
 11160        END-IF
 11161     END-IF
 11162     .
 11163 0563-EXIT.
 11164     EXIT.
 11165 0564-EDIT-CONTINUE.
 11166
 11167     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 204
* EL050.cbl
 11168         IF PB-I-NUM-BILLED EQUAL ZEROS
 11169            MOVE ER-8148       TO WS-ERROR
 11170            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11171
 11172*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11173*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11174*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11175*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11176*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11177*         IF NO-CONVERSION-ERROR
 11178*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11179*         ELSE
 11180*             IF PB-COMPANY-ID EQUAL 'HAN'
 11181*                 MOVE ZEROS     TO PB-I-AGE.
 11182     IF PB-I-BIRTHDAY > LOW-VALUES
 11183        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11184        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11185        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11186        PERFORM 8500-DATE-CONVERT
 11187                                 THRU 8500-EXIT
 11188        IF NO-CONVERSION-ERROR
 11189           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11190           IF PB-I-AGE > ZEROS
 11191              IF WS-WORK-AGE NOT = PB-I-AGE
 11192                 MOVE ER-9501    TO WS-ERROR
 11193                 PERFORM 9900-ERROR-FORMAT
 11194                                 THRU 9900-EXIT
 11195              END-IF
 11196           ELSE
 11197              MOVE WS-WORK-AGE   TO PB-I-AGE
 11198           END-IF
 11199        END-IF
 11200     END-IF
 11201     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11202                                   WS-INS-AGE-SET
 11203     IF PB-I-AGE = ZEROS
 11204        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11205           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11206                                   WS-INS-AGE-SET
 11207           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11208
 11209     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11210                                   WS-AH-EDIT-AGE.
 11211
 11212     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11213        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11214        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11215        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11216        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11217        IF NO-CONVERSION-ERROR
 11218           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11219           IF PB-I-JOINT-AGE > 0
 11220              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11221                 MOVE ER-9503    TO WS-ERROR
 11222                 PERFORM 9900-ERROR-FORMAT
 11223                                 THRU 9900-EXIT
 11224              END-IF
 11225           ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 205
* EL050.cbl
 11226              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11227           END-IF
 11228        ELSE
 11229           MOVE ZEROS            TO PB-I-JOINT-AGE
 11230        END-IF
 11231     END-IF
 11232     IF PB-I-JOINT-AGE NOT NUMERIC
 11233        MOVE ZERO               TO PB-I-JOINT-AGE.
 11234
 11235     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11236                                   WS-JNT-AGE-SET
 11237     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11238        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11239           (WS-AH-JOINT-INDICATOR = 'J')
 11240           IF PB-I-JOINT-AGE = ZEROS
 11241               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11242                                          WS-JNT-AGE-SET
 11243               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11244           END-IF
 11245        END-IF
 11246     END-IF
 11247
 11248     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11249     IF WS-LF-JOINT-INDICATOR = 'J'
 11250        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11251        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11252            IF  PB-I-JOINT-AGE = ZERO
 11253                MOVE ER-2686       TO WS-ERROR
 11254                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11255            ELSE
 11256                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11257                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11258                    IF PB-COMPANY-ID NOT = 'LBL'
 11259                        MOVE ER-2685    TO WS-ERROR
 11260                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11261
 11262     IF WS-AH-JOINT-INDICATOR = 'J'
 11263        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11264            IF  PB-I-JOINT-AGE = ZERO
 11265                MOVE ER-2686       TO WS-ERROR
 11266                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11267            ELSE
 11268                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11269                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11270                                           WS-EDIT-AGE
 11271                    IF PB-COMPANY-ID NOT = 'LBL'
 11272                        MOVE ER-2685    TO WS-ERROR
 11273                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11274
 11275******************************************************************
 11276*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11277******************************************************************
 11278
 11279     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11280        (WS-AH-SPECIAL-CALC-CD = 'O')
 11281        NEXT SENTENCE
 11282     ELSE
 11283        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 206
* EL050.cbl
 11284          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11285           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11286            WS-AH-JOINT-INDICATOR = 'J')  AND
 11287           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11288            MOVE ER-2627             TO WS-ERROR
 11289            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11290
 11291     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11292        (WS-AH-SPECIAL-CALC-CD = 'O')
 11293         NEXT SENTENCE
 11294     ELSE
 11295         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11296            WS-AH-JOINT-INDICATOR = 'J'
 11297             IF PB-I-JOINT-INSURED = SPACES
 11298                 IF PB-COMPANY-ID NOT = 'JAL'
 11299                     MOVE ER-2696    TO WS-ERROR
 11300                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11301
 11302     IF PB-COMPANY-ID NOT = 'BOA'
 11303        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11304           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11305           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11306               PB-I-JOINT-INSURED NOT = SPACES)
 11307                MOVE ER-2691         TO WS-ERROR
 11308                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11309
 11310     IF PB-COMPANY-ID = 'BOA'
 11311        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11312           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11313            IF PB-I-JOINT-AGE NOT = ZEROS
 11314                MOVE ER-2691         TO WS-ERROR
 11315                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11316
 11317     IF PB-COMPANY-ID = 'CRI'
 11318        IF PB-I-SIG-SW = 'J'
 11319           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11320              WS-AH-JOINT-INDICATOR NOT = 'J'
 11321              MOVE ER-2675       TO WS-ERROR
 11322              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11323
 11324     IF PB-COMPANY-ID = 'CRI'
 11325        IF PB-I-SIG-SW = 'S'
 11326           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11327              WS-AH-JOINT-INDICATOR = 'J'
 11328              MOVE ER-2676       TO WS-ERROR
 11329              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11330
 11331     IF PB-COMPANY-ID = 'CVL'
 11332         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11333            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11334              MOVE ER-2783           TO WS-ERROR
 11335              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11336     IF (WS-LF-JOINT-INDICATOR = 'J')
 11337        AND (WS-AH-JOINT-INDICATOR = 'J')
 11338        AND (PB-I-LF-TERM > 120)
 11339        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11340        MOVE ER-2783             TO WS-ERROR
 11341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 207
* EL050.cbl
 11342     END-IF
 11343     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11344
 11345     IF PB-I-INDV-GRP-OVRD = 'I'
 11346        MOVE ER-2666             TO WS-ERROR
 11347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11348        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11349
 11350     IF PB-I-INDV-GRP-OVRD = 'G'
 11351        MOVE ER-2666             TO WS-ERROR
 11352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11353        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11354
 11355     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11356        NEXT SENTENCE
 11357     ELSE
 11358        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11359
 11360     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11361        IF WS-ERROR = ER-2666
 11362           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11363           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11364
 11365     IF PB-COMPANY-ID = 'CID'
 11366        IF PB-STATE = 'UT' OR 'MO'
 11367           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11368                 OR '76' OR '77')
 11369                      OR
 11370               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11371                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11372                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11373                   OR '2K' OR '2L'))
 11374              AND PB-I-INDV-GRP-CD = 'I'
 11375              MOVE ER-2721             TO WS-ERROR
 11376              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11377           END-IF
 11378        END-IF
 11379     END-IF
 11380
 11381     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11382     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11383        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11384     ELSE
 11385        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11386     END-IF
 11387
 11388*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11389*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11390     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11391                                    ACCOUNT-AH-CK-SW.
 11392
 11393     IF PB-REISSUED-CERT       OR
 11394        PB-REIN-ONLY-CERT      OR
 11395        PB-POLICY-IS-DECLINED  OR
 11396        PB-POLICY-IS-VOIDED
 11397*       OR PB-MONTHLY-CERT
 11398         GO TO 3000-CONTINUE-EDIT.
 11399
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 208
* EL050.cbl
 11400     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11401        IF WS-EDIT-AGE           > +65
 11402           MOVE ER-2709          TO WS-ERROR
 11403           PERFORM 9900-ERROR-FORMAT
 11404                                 THRU 9900-EXIT
 11405        ELSE
 11406           IF WS-EDIT-AGE        > +55
 11407              MOVE ER-2718       TO WS-ERROR
 11408              PERFORM 9900-ERROR-FORMAT
 11409                                 THRU 9900-EXIT
 11410           END-IF
 11411        END-IF
 11412     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11413        IF WS-EDIT-AGE           > +65
 11414           MOVE ER-2709          TO WS-ERROR
 11415           PERFORM 9900-ERROR-FORMAT
 11416                                 THRU 9900-EXIT
 11417        END-IF
 11418     END-IF
 11419     .
 11420
 11421 0565-LIFE-PLAN-LIMIT-EDITS.
 11422
 11423     IF NOT LF-PLAN-MASTER-FOUND
 11424        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11425                                    EC-AM-LF-MAX-TOT-BEN
 11426        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11427
 11428     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11429
 11430     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11431         IF PL-LM-AGE (1) = ZEROS
 11432             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11433
 11434     IF NO-LF-BENEFIT-MATCH          OR
 11435        WS-LF-BENEFIT-CD = ZEROS     OR
 11436        WS-LF-SPECIAL-CALC-CD = 'M'
 11437        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11438
 11439     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11440     MOVE +1                     TO SUB2.
 11441
 11442     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11443        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11444           MOVE +5   TO SUB2
 11445           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11446              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11447              (PL-LM-AGE (SUB2) EQUAL +0)
 11448              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11449              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11450
 11451     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11452
 11453     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11454                               + PB-I-LF-ALT-BENEFIT-AMT.
 11455
 11456 0568-CHECK-LIFE-ATT-AGE.
 11457
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 209
* EL050.cbl
 11458     IF PL-ATT-AGE NUMERIC AND
 11459        PL-ATT-AGE > +0
 11460        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11461     END-IF
 11462*    IF PL-ATT-AGE NUMERIC AND
 11463*       PL-ATT-AGE > +0
 11464*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11465*       IF PB-I-BIRTHDAY > LOW-VALUES
 11466*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11467*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11468*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11469*          SET BIN-PLUS-ELAPSED  TO TRUE
 11470*          PERFORM 8500-DATE-CONVERT
 11471*                                THRU 8500-EXIT
 11472*          IF NO-CONVERSION-ERROR
 11473*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11474*             MOVE ER-2669       TO WS-ERROR
 11475*             PERFORM 9900-ERROR-FORMAT
 11476*                                THRU 9900-EXIT
 11477*          END-IF
 11478*       ELSE
 11479*          IF WS-ATT-AGE >= PL-ATT-AGE
 11480*             MOVE ER-2669       TO WS-ERROR
 11481*             PERFORM 9900-ERROR-FORMAT
 11482*                                THRU 9900-EXIT
 11483*          END-IF
 11484*       END-IF
 11485*    END-IF
 11486     .
 11487 0570-CHECK-LIFE-LIMITS.
 11488
 11489     IF PB-COMPANY-ID EQUAL 'CRI'
 11490        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11491           IF SUB2 GREATER THAN +4
 11492              MOVE ER-2637 TO WS-ERROR
 11493              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11494              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11495
 11496     IF PB-COMPANY-ID  =  'NCL'
 11497        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11498            SUB2 GREATER THAN +8
 11499             MOVE 'U'         TO PB-BATCH-ENTRY
 11500             MOVE ER-2637     TO WS-ERROR
 11501             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11503
 11504     IF SUB2 > +8
 11505        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11506           AND (PB-I-SIG-SW = 'Y')
 11507           CONTINUE
 11508        ELSE
 11509           MOVE ER-2637          TO WS-ERROR
 11510           PERFORM 9900-ERROR-FORMAT
 11511                                 THRU 9900-EXIT
 11512        END-IF
 11513        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11514     END-IF
 11515     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 210
* EL050.cbl
 11516     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11517     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11518
 11519     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11520        ADD +1  TO SUB2
 11521        GO TO 0570-CHECK-LIFE-LIMITS.
 11522
 11523     IF PB-COMPANY-ID = 'NCL'
 11524         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11525
 11526     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11527        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11528        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11529           AND (PB-I-SIG-SW = 'Y')
 11530           CONTINUE
 11531        ELSE
 11532           MOVE ER-2637          TO WS-ERROR
 11533           PERFORM 9900-ERROR-FORMAT
 11534                                 THRU 9900-EXIT
 11535        END-IF
 11536     END-IF
 11537     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11538
 11539
 11540 0570-CHECK-NCL-LIFE-LIMITS.
 11541
 11542     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11543        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11544         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11545
 11546     IF APP-CERT-USED
 11547         IF SUB2  LESS THAN  +5
 11548             MOVE +5          TO SUB2
 11549             GO TO 0570-CHECK-LIFE-LIMITS.
 11550
 11551     MOVE ER-2637             TO WS-ERROR.
 11552     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11553
 11554     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11555
 11556 0575-CHECK-NCL-SIG-SWITCH.
 11557
 11558     IF NOT APP-CERT-USED
 11559         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11560
 11561     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11562        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11563        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11564        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11565         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11566
 11567     IF SUB2 GREATER THAN +4
 11568         IF PL-LM-AGE (5) = ZEROS  AND
 11569            PL-LM-AGE (6) = ZEROS  AND
 11570            PL-LM-AGE (7) = ZEROS  AND
 11571            PL-LM-AGE (8) = ZEROS
 11572             MOVE  ER-1927        TO WS-ERROR
 11573             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 211
* EL050.cbl
 11574             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11575         ELSE
 11576             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11577                 MOVE  ER-1920    TO WS-ERROR
 11578                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11579
 11580     IF PB-I-SIG-SW  = 'Y'
 11581       IF NOT PB-I-POLICY-ACCEPTED  AND
 11582          NOT PB-I-POLICY-DECLINED
 11583           MOVE 'U'               TO PB-BATCH-ENTRY
 11584           MOVE  ER-1926          TO WS-ERROR
 11585           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11586
 11587
 11588 0580-AH-PLAN-LIMIT-EDITS.
 11589
 11590     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11591        IF PB-I-AH-BENEFIT-AMT > +1250
 11592           MOVE ER-2702          TO WS-ERROR
 11593           PERFORM 9900-ERROR-FORMAT
 11594                                 THRU 9900-EXIT
 11595        END-IF
 11596     END-IF
 11597
 11598     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11599        AND (PB-MONTHLY-CERT)
 11600        IF PB-I-AH-BENEFIT-AMT > +3000
 11601           MOVE ER-2881          TO WS-ERROR
 11602           PERFORM 9900-ERROR-FORMAT
 11603                                 THRU 9900-EXIT
 11604        END-IF
 11605     END-IF
 11606     IF NOT AH-PLAN-MASTER-FOUND
 11607        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11608        GO TO 3000-CONTINUE-EDIT.
 11609
 11610     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11611
 11612     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11613         IF PL-LM-AGE (1) = ZEROS
 11614             GO TO 3000-CONTINUE-EDIT.
 11615
 11616     IF NO-AH-BENEFIT-MATCH          OR
 11617        WS-AH-BENEFIT-CD = ZEROS     OR
 11618        WS-AH-SPECIAL-CALC-CD = 'M'
 11619        GO TO 3000-CONTINUE-EDIT.
 11620
 11621     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11622     MOVE +1                     TO SUB2.
 11623
 11624     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11625        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11626           MOVE +5 TO SUB2
 11627           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11628              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11629              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11630              (PL-LM-AGE (SUB2) EQUAL +0)
 11631              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 212
* EL050.cbl
 11632              GO TO 3000-CONTINUE-EDIT.
 11633
 11634     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11635
 11636 0590-CHECK-AH-ATT-AGE.
 11637
 11638     IF PL-ATT-AGE NUMERIC AND
 11639        PL-ATT-AGE GREATER THAN +0
 11640        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11641     END-IF
 11642*       IF WS-ATT-AGE >= PL-ATT-AGE
 11643*          MOVE ER-3054          TO WS-ERROR
 11644*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11645     .
 11646 0597-CHECK-AH-LIMITS.
 11647
 11648     IF PB-COMPANY-ID EQUAL 'CRI'
 11649        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11650           IF SUB2 GREATER THAN +4
 11651              MOVE ER-2638       TO WS-ERROR
 11652              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11653              GO TO 3000-CONTINUE-EDIT.
 11654
 11655     IF PB-COMPANY-ID  =  'NCL'
 11656        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11657            SUB2 GREATER THAN +8
 11658             MOVE 'U'            TO PB-BATCH-ENTRY
 11659             MOVE ER-2638        TO WS-ERROR
 11660             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11661             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11662
 11663     IF SUB2 > +8
 11664        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11665           AND (PB-I-SIG-SW = 'Y')
 11666           CONTINUE
 11667        ELSE
 11668           MOVE ER-2638          TO WS-ERROR
 11669           PERFORM 9900-ERROR-FORMAT
 11670                                 THRU 9900-EXIT
 11671        END-IF
 11672        GO TO 3000-CONTINUE-EDIT
 11673     END-IF
 11674
 11675     IF PB-COMPANY-ID = 'CRI'
 11676        IF WS-ERROR = ER-2638
 11677           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11678
 11679     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11680     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11681     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11682     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11683
 11684     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11685        ADD +1                   TO SUB2
 11686        GO TO 0597-CHECK-AH-LIMITS.
 11687
 11688     IF PB-COMPANY-ID = 'NCL'
 11689         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 213
* EL050.cbl
 11690
 11691     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11692        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11693        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11694                                 > PL-LM-AMT (SUB2))
 11695        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11696           AND (PB-I-SIG-SW = 'Y')
 11697           CONTINUE
 11698        ELSE
 11699           MOVE ER-2638          TO WS-ERROR
 11700           PERFORM 9900-ERROR-FORMAT
 11701                                 THRU 9900-EXIT
 11702        END-IF
 11703     END-IF
 11704
 11705     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11706         IF  WS-ERROR    EQUAL    ER-2638
 11707             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11708                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11709                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11710                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11711                MOVE  ER-1910    TO  WS-ERROR
 11712                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11713
 11714     IF PB-COMPANY-ID = 'CRI'
 11715        IF WS-ERROR = ER-2638
 11716            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11717            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11718            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11719
 11720     GO TO 3000-CONTINUE-EDIT.
 11721
 11722 0597-CHECK-NCL-AH-LIMITS.
 11723
 11724     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11725        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11726        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11727                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11728         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11729
 11730     IF APP-CERT-USED
 11731         IF SUB2  LESS THAN  +5
 11732             MOVE +5             TO SUB2
 11733             GO TO 0597-CHECK-AH-LIMITS.
 11734
 11735     MOVE ER-2638                TO WS-ERROR.
 11736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11737
 11738     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11739
 11740 0599-CHECK-NCL-SIG-SWITCH.
 11741
 11742     IF NOT APP-CERT-USED
 11743         GO TO 3000-CONTINUE-EDIT.
 11744
 11745     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11746        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11747        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 214
* EL050.cbl
 11748        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11749         GO TO 3000-CONTINUE-EDIT.
 11750
 11751     IF SUB2 GREATER THAN +4
 11752         IF PL-LM-AGE (5) = ZEROS  AND
 11753            PL-LM-AGE (6) = ZEROS  AND
 11754            PL-LM-AGE (7) = ZEROS  AND
 11755            PL-LM-AGE (8) = ZEROS
 11756             MOVE  ER-1927        TO WS-ERROR
 11757             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11758             GO TO 3000-CONTINUE-EDIT
 11759         ELSE
 11760             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11761                 MOVE  ER-1920    TO WS-ERROR
 11762                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11763
 11764     IF PB-I-SIG-SW  = 'Y'
 11765       IF NOT PB-I-POLICY-ACCEPTED  AND
 11766          NOT PB-I-POLICY-DECLINED
 11767           MOVE 'U'               TO PB-BATCH-ENTRY
 11768           MOVE  ER-1926          TO WS-ERROR
 11769           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11770
 11771******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 215
* EL050.cbl
 11773
 11774 3000-CONTINUE-EDIT.
 11775
 11776     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11777     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11778     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11779     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11780     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11781
 11782     IF BROWSE-STARTED
 11783        PERFORM 9990-RETURN THRU 9990-EXIT
 11784        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11785
 11786     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11787        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11788        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11789        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11790*       MOVE 1                   TO DC-OPTION-CODE
 11791        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11792        IF DATE-CONVERSION-ERROR
 11793           MOVE ER-2622          TO WS-ERROR
 11794           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11795        ELSE
 11796           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11797              MOVE ER-2623       TO WS-ERROR
 11798              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11799           ELSE
 11800              MOVE ER-2622       TO WS-ERROR
 11801              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11802
 11803     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11804     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11805     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11806*    MOVE 1                      TO DC-OPTION-CODE.
 11807     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11808     IF DATE-CONVERSION-ERROR
 11809        GO TO 3005-EDIT-CONTINUE
 11810     ELSE
 11811        IF DC-ELAPSED-DAYS GREATER +180
 11812           MOVE ER-2613          TO WS-ERROR
 11813           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11814        ELSE
 11815           IF DC-ELAPSED-DAYS GREATER +90
 11816              MOVE ER-2612       TO WS-ERROR
 11817              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11818           ELSE
 11819             IF DC-ELAPSED-DAYS GREATER +60
 11820                MOVE ER-2614     TO WS-ERROR
 11821                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11822
 11823 3005-EDIT-CONTINUE.
 11824
 11825     IF PB-CANCELLATION
 11826         GO TO 3700-EDIT-CANCEL.
 11827
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 216
* EL050.cbl
 11829******************************************************************
 11830*                  E D I T   I S S U E                           *
 11831******************************************************************
 11832
 11833 3020-EDIT-ISSUE.
 11834
 11835      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11836      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11837      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11838      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11839      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11840
 11841     IF PB-ISSUE-FORCE
 11842        OR PB-ISSUE-DATE-FORCED
 11843        OR PB-FORCE-OFF
 11844        OR PB-OVERCHARGE-FORCE
 11845        or pb-exceeded-limit-forced
 11846        CONTINUE
 11847     ELSE
 11848        MOVE ER-2670             TO WS-ERROR
 11849        PERFORM 9900-ERROR-FORMAT
 11850                                 THRU 9900-EXIT
 11851     END-IF
 11852     .
 11853 3022-SET-POLICY-STATUS.
 11854
 11855     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11856
 11857     IF (PB-REISSUED-CERT)
 11858             OR
 11859        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11860         AND (PB-MONTHLY-CERT))
 11861         MOVE '5'                TO PB-I-ENTRY-STATUS
 11862         MOVE 'E'                TO PB-BATCH-ENTRY
 11863     END-IF
 11864
 11865     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11866        IF PB-MONTHLY-CERT
 11867           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11868        END-IF
 11869        IF PB-CASH-CERT
 11870           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11871        END-IF
 11872     END-IF
 11873     IF PB-POLICY-IS-DECLINED
 11874         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11875     IF PB-POLICY-IS-VOIDED
 11876         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11877     IF PB-NEEDS-UNDERWRITING
 11878         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11879     IF PB-REIN-ONLY-CERT
 11880         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11881     IF PB-PREM-ACCTNG-ONLY
 11882         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11883
 11884     MOVE SPACE                  TO PB-I-OB-FLAG.
 11885
 11886     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 217
* EL050.cbl
 11887         MOVE ER-2665            TO WS-ERROR
 11888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11889         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11890
 11891     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11892        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11893           MOVE 'Z'             TO PB-I-OB-FLAG.
 11894
 11895     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11896        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11897           MOVE 'Z'             TO PB-I-OB-FLAG.
 11898
 11899     IF ACCOUNT-MAST-FOUND
 11900         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11901         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11902         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11903         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11904         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11905         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11906         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11907     END-IF
 11908
 11909     IF ACCOUNT-MAST-FOUND
 11910        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11911         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11912
 11913     IF (ACCOUNT-MAST-FOUND)
 11914*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11915        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11916        IF PB-REISSUED-CERT
 11917           CONTINUE
 11918        ELSE
 11919           MOVE ER-2608          TO WS-ERROR
 11920           PERFORM 9900-ERROR-FORMAT
 11921                                 THRU 9900-EXIT
 11922         END-IF
 11923     END-IF
 11924
 11925     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11926        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11927        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11928
 11929**********   DMD CUSTOM CODE FOLLOWS  **********
 11930 3024-EDIT-DMD-FIELDS.
 11931     IF PB-COMPANY-ID NOT = 'DMD'
 11932        GO TO 3025-EDIT-REINSURANCE.
 11933
 11934*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11935*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11936*** ERROR IF THEY ARE NOT EQUAL.
 11937
 11938     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11939     SET BIN-TO-GREG               TO TRUE.
 11940     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11941     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11942**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11943
 11944     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 218
* EL050.cbl
 11945     SET BIN-TO-GREG               TO TRUE.
 11946     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11947     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11948**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11949
 11950     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11951        MOVE ER-8116               TO WS-ERROR
 11952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11953
 11954     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11955
 11956     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11957                                      WK-FULL-CERT-NO.
 11958     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11959
 11960     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11961
 11962     IF PB-VALID-LIFE
 11963        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11964     ELSE
 11965        IF PB-VALID-AH
 11966          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11967
 11968
 11969     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11970     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11971     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11972                                      DCUA-UNDRWRTR-CODE
 11973                                      DCUA-UNDRWRTR-GROUP-CODE
 11974                                      DCUA-RETURN-CODE.
 11975
 11976****************************************************************
 11977*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11978***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11979***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11980***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11981***   TO THIS RECORD.                                        ***
 11982****************************************************************
 11983     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11984     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11985     IF DCUA-SUCCESSFUL-PROCESS
 11986        GO TO 3024-EDIT-DL7-CONT.
 11987
 11988     IF DCUA-RETURN-CODE EQUAL '01'
 11989        MOVE ER-8110               TO WS-ERROR
 11990        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11992        GO TO 3024-EDIT-DL7-CONT.
 11993
 11994     IF DCUA-RETURN-CODE EQUAL '02'
 11995        MOVE ER-8111               TO WS-ERROR
 11996        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11998        GO TO 3024-EDIT-DL7-CONT.
 11999
 12000     IF DCUA-RETURN-CODE EQUAL '03'
 12001        MOVE ER-8074               TO WS-ERROR
 12002        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 219
* EL050.cbl
 12003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12004        GO TO 3024-EDIT-DL7-CONT.
 12005
 12006     IF DCUA-RETURN-CODE EQUAL '04'
 12007        MOVE ER-8075               TO WS-ERROR
 12008        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12010        GO TO 3024-EDIT-DL7-CONT.
 12011
 12012     IF DCUA-RETURN-CODE EQUAL '05'
 12013        MOVE ER-8076               TO WS-ERROR
 12014        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12016        GO TO 3024-EDIT-DL7-CONT.
 12017
 12018     IF DCUA-RETURN-CODE EQUAL '06'
 12019        MOVE ER-8077               TO WS-ERROR
 12020        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12021        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12022        GO TO 3024-EDIT-DL7-CONT.
 12023
 12024     IF DCUA-RETURN-CODE EQUAL '07'
 12025        MOVE ER-8078               TO WS-ERROR
 12026        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12027        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12028        GO TO 3024-EDIT-DL7-CONT.
 12029
 12030     IF DCUA-RETURN-CODE EQUAL 'E1'
 12031        MOVE ER-8079               TO WS-ERROR
 12032        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12034        GO TO 3024-EDIT-DL7-CONT.
 12035
 12036     IF DCUA-RETURN-CODE EQUAL 'E2'
 12037        MOVE ER-8080               TO WS-ERROR
 12038        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12040        GO TO 3024-EDIT-DL7-CONT.
 12041
 12042     IF DCUA-RETURN-CODE EQUAL 'E3'
 12043        MOVE ER-8098               TO WS-ERROR
 12044        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12045        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12046        GO TO 3024-EDIT-DL7-CONT.
 12047
 12048     IF DCUA-RETURN-CODE EQUAL 'C1'
 12049        MOVE ER-8099               TO WS-ERROR
 12050        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12051        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12052        GO TO 3024-EDIT-DL7-CONT.
 12053
 12054     IF DCUA-RETURN-CODE EQUAL 'U1'
 12055        MOVE ER-8109               TO WS-ERROR
 12056        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12057        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12058        GO TO 3024-EDIT-DL7-CONT.
 12059
 12060     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 220
* EL050.cbl
 12061        MOVE ER-8112               TO WS-ERROR
 12062        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12064        GO TO 3024-EDIT-DL7-CONT.
 12065
 12066     IF DCUA-RETURN-CODE EQUAL 'N2'
 12067        MOVE ER-8113               TO WS-ERROR
 12068        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12070        GO TO 3024-EDIT-DL7-CONT.
 12071
 12072     IF DCUA-RETURN-CODE EQUAL 'N3'
 12073        MOVE ER-8114               TO WS-ERROR
 12074        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12075        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12076        GO TO 3024-EDIT-DL7-CONT.
 12077
 12078     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12079     MOVE ER-8097                  TO WS-ERROR.
 12080     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12081     GO TO 3024-EDIT-DL7-CONT.
 12082
 12083 3024-EDIT-DL7-CONT.
 12084
 12085     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12086     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12087     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12088        NEXT SENTENCE
 12089     ELSE
 12090        MOVE ER-9263               TO WS-ERROR
 12091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12092
 12093******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12094******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12095     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12096        NEXT SENTENCE
 12097     ELSE
 12098        MOVE ER-8039               TO WS-ERROR
 12099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12100
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 221
* EL050.cbl
 12102****************************************************************
 12103*** VALIDATE STATE  : DLO022                                 ***
 12104****************************************************************
 12105     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12106     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12107
 12108     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12109     IF DVSC-SUCCESSFUL-EDIT
 12110        GO TO 3024-EDIT-DL22-CONT.
 12111
 12112     IF DVSC-RETURN-CODE EQUAL '01'
 12113        MOVE ER-8300               TO WS-ERROR
 12114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12115        GO TO 3024-EDIT-DL22-CONT.
 12116
 12117     IF DVSC-RETURN-CODE EQUAL '02'
 12118        MOVE ER-8301               TO WS-ERROR
 12119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12120        GO TO 3024-EDIT-DL22-CONT.
 12121
 12122     IF DVSC-RETURN-CODE EQUAL '03'
 12123        MOVE ER-8302               TO WS-ERROR
 12124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12125        GO TO 3024-EDIT-DL22-CONT.
 12126
 12127     IF DVSC-RETURN-CODE EQUAL 'N1'
 12128        MOVE ER-8304               TO WS-ERROR
 12129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12130        GO TO 3024-EDIT-DL22-CONT.
 12131
 12132     MOVE ER-8303                  TO WS-ERROR
 12133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12134
 12135 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 222
* EL050.cbl
 12137****************************************************************
 12138*** VALIDATE LOAN OFFICER : DLO021                           ***
 12139****************************************************************
 12140
 12141     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12142     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12143     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12144     IF DVLO-SUCCESSFUL-EDIT
 12145        GO TO 3024-EDIT-DL21-CONT.
 12146
 12147     IF DVLO-RETURN-CODE EQUAL '01'
 12148        MOVE ER-8081               TO WS-ERROR
 12149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12150        GO TO 3024-EDIT-DL21-CONT.
 12151
 12152     IF DVLO-RETURN-CODE EQUAL '02'
 12153        MOVE ER-8082               TO WS-ERROR
 12154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12155        GO TO 3024-EDIT-DL21-CONT.
 12156
 12157     IF DVLO-RETURN-CODE EQUAL '03'
 12158        MOVE ER-8083               TO WS-ERROR
 12159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12160        GO TO 3024-EDIT-DL21-CONT.
 12161
 12162     IF DVLO-RETURN-CODE EQUAL '04'
 12163        MOVE ER-8084               TO WS-ERROR
 12164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12165        GO TO 3024-EDIT-DL21-CONT.
 12166
 12167     IF DVLO-RETURN-CODE EQUAL '05'
 12168        MOVE ER-8085               TO WS-ERROR
 12169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170        GO TO 3024-EDIT-DL21-CONT.
 12171
 12172     MOVE ER-7825                  TO WS-ERROR
 12173     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12174     GO TO 3024-EDIT-DL21-CONT.
 12175
 12176 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 223
* EL050.cbl
 12178
 12179****************************************************************
 12180*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12181****************************************************************
 12182
 12183     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12184     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12185     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12186     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12187     IF DIPF-SUCCESSFUL-EDIT
 12188        GO TO 3024-EDIT-DL02-CONT.
 12189
 12190     IF DIPF-RETURN-CODE EQUAL '01'
 12191        MOVE ER-8086               TO WS-ERROR
 12192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12193        GO TO 3024-EDIT-DL02-CONT.
 12194
 12195     IF DIPF-RETURN-CODE EQUAL '02'
 12196        MOVE ER-8087               TO WS-ERROR
 12197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12198        GO TO 3024-EDIT-DL02-CONT.
 12199
 12200     IF DIPF-RETURN-CODE EQUAL '03'
 12201        MOVE ER-8088               TO WS-ERROR
 12202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12203        GO TO 3024-EDIT-DL02-CONT.
 12204
 12205     MOVE ER-8095                  TO WS-ERROR
 12206     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12207     GO TO 3024-EDIT-DL02-CONT.
 12208
 12209 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 224
* EL050.cbl
 12211
 12212****************************************************************
 12213*** VALIDATE BANK ID : DLO003                                ***
 12214****************************************************************
 12215
 12216     MOVE WK-GREG-CENT           TO WCG-CENT.
 12217     MOVE WK-GREG-YYMM           TO WCG-REST.
 12218     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12219        MOVE ER-8040               TO WS-ERROR
 12220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12221
 12222     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12223     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12224     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12225     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12226     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12227     IF DVBI-SUCCESSFUL-EDIT
 12228        GO TO 3024-EDIT-DL03-CONT.
 12229
 12230     IF DVBI-RETURN-CODE EQUAL '01'
 12231        MOVE ER-8089               TO WS-ERROR
 12232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12233        GO TO 3024-EDIT-DL03-CONT.
 12234
 12235     IF DVBI-RETURN-CODE EQUAL '02'
 12236        MOVE ER-8090               TO WS-ERROR
 12237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12238        GO TO 3024-EDIT-DL03-CONT.
 12239
 12240     IF DVBI-RETURN-CODE EQUAL '03'
 12241        MOVE ER-8091               TO WS-ERROR
 12242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12243        GO TO 3024-EDIT-DL03-CONT.
 12244
 12245     IF DVBI-RETURN-CODE EQUAL '04'
 12246        MOVE ER-8092               TO WS-ERROR
 12247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12248        GO TO 3024-EDIT-DL03-CONT.
 12249
 12250     IF DVBI-RETURN-CODE EQUAL '05'
 12251        MOVE ER-8093               TO WS-ERROR
 12252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12253        GO TO 3024-EDIT-DL03-CONT.
 12254
 12255     IF DVBI-RETURN-CODE EQUAL '06'
 12256        MOVE ER-8094               TO WS-ERROR
 12257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12258        GO TO 3024-EDIT-DL03-CONT.
 12259
 12260     MOVE ER-8096                  TO WS-ERROR
 12261     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12262     GO TO 3024-EDIT-DL03-CONT.
 12263
 12264 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 225
* EL050.cbl
 12266
 12267     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12268        NEXT SENTENCE
 12269     ELSE
 12270        MOVE ER-8042               TO WS-ERROR
 12271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12272
 12273     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12274     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12275     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12276
 12277     IF DMPF-RETURN-CODE = '01'
 12278        MOVE ER-8067               TO WS-ERROR
 12279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12280        GO TO 3024-EDIT-DL01-CONT.
 12281
 12282     IF DMPF-RETURN-CODE = '02'
 12283        MOVE ER-8068               TO WS-ERROR
 12284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12285        GO TO 3024-EDIT-DL01-CONT.
 12286
 12287     IF DMPF-RETURN-CODE = '03'
 12288        MOVE ER-8069               TO WS-ERROR
 12289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12290        GO TO 3024-EDIT-DL01-CONT.
 12291
 12292     IF DMPF-RETURN-CODE = 'E1'
 12293        MOVE ER-8070               TO WS-ERROR
 12294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12295        GO TO 3024-EDIT-DL01-CONT.
 12296
 12297     IF DMPF-RETURN-CODE = 'N1'
 12298        MOVE ER-8071               TO WS-ERROR
 12299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12300        GO TO 3024-EDIT-DL01-CONT.
 12301
 12302     IF DMPF-RETURN-CODE NOT = 'OK'
 12303        MOVE ER-8072               TO WS-ERROR
 12304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12305
 12306 3024-EDIT-DL01-CONT.
 12307******************************************************************
 12308***  VALIDATES RATE CODES : DLO017                             ***
 12309******************************************************************
 12310
 12311      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12312      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12313      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12314      IF DVRC-SUCCESSFUL-EDIT
 12315        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12316        GO TO 3024-CHECK-VALID-RATE.
 12317
 12318      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12319
 12320      IF DVRC-RETURN-CODE EQUAL '01'
 12321         MOVE ER-7817                   TO WS-ERROR
 12322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12323         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 226
* EL050.cbl
 12324
 12325      IF DVRC-RETURN-CODE EQUAL '02'
 12326         MOVE ER-7818                   TO WS-ERROR
 12327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12328         GO TO 3025-EDIT-REINSURANCE.
 12329
 12330      IF DVRC-RETURN-CODE EQUAL '03'
 12331         MOVE ER-7819                   TO WS-ERROR
 12332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12333         GO TO 3025-EDIT-REINSURANCE.
 12334
 12335       MOVE ER-7820                     TO WS-ERROR.
 12336       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12337       GO TO 3025-EDIT-REINSURANCE.
 12338
 12339******************************************************************
 12340***  GET PREMIUM RATES : DLO011                                ***
 12341******************************************************************
 12342
 12343 3024-CHECK-VALID-RATE.
 12344
 12345     IF VALID-RATE-CODE
 12346        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12347        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12348        MOVE SPACES                TO DPRB-RETURN-CODE
 12349        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12350     ELSE
 12351         GO TO 3025-EDIT-REINSURANCE.
 12352
 12353      IF DPRB-SUCCESSFUL-PROCESS
 12354         IF PB-VALID-LIFE
 12355             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12356             GO TO 3025-EDIT-REINSURANCE
 12357         ELSE
 12358             IF PB-VALID-AH
 12359                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12360                 GO TO 3025-EDIT-REINSURANCE.
 12361
 12362      IF DPRB-RETURN-CODE EQUAL '01'
 12363         MOVE ER-7812                   TO WS-ERROR
 12364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12365         GO TO 3025-EDIT-REINSURANCE.
 12366
 12367      IF DPRB-RETURN-CODE EQUAL '02'
 12368         MOVE ER-7813                   TO WS-ERROR
 12369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12370         GO TO 3025-EDIT-REINSURANCE.
 12371
 12372      IF DPRB-RETURN-CODE EQUAL '03'
 12373         MOVE ER-7814                   TO WS-ERROR
 12374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12375         GO TO 3025-EDIT-REINSURANCE.
 12376
 12377      IF DPRB-RETURN-CODE EQUAL '04'
 12378         IF NOT DPRB-1ST-TIME
 12379            MOVE ER-7815                   TO WS-ERROR
 12380            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12381            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 227
* EL050.cbl
 12382          ELSE
 12383         IF PB-VALID-LIFE
 12384            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12385          ELSE
 12386            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12387         END-IF
 12388         MOVE SPACES                TO DOCC-RETURN-CODE
 12389         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12390         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12391         IF DOCC-RETURN-CODE = 'OK'
 12392             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12393             GO TO 3024-CHECK-VALID-RATE
 12394           ELSE
 12395             MOVE ER-7823               TO WS-ERROR
 12396             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12397             GO TO 3025-EDIT-REINSURANCE.
 12398
 12399       MOVE ER-7816                     TO WS-ERROR.
 12400       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12401       GO TO 3025-EDIT-REINSURANCE.
 12402
 12403**********   DMD CUSTOM CODE ABOVE    **********
 12404
 12405 3025-EDIT-REINSURANCE.
 12406     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12407         GO TO 3027-EDIT-CONTINUE.
 12408
 12409     MOVE LOW-VALUES               TO ERREIN-KEY.
 12410     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12411     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12412                                      REIN-CODE-2
 12413                                      REIN-CODE-3.
 12414     MOVE 'A'                      TO REIN-TYPE.
 12415
 12416     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12417
 12418     MOVE '3026' TO REIN-SW.
 12419     MOVE ' '                   TO WS-REIN-READ-SW.
 12420
 12421     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12422     IF REIN-TABLE-NOT-FOUND
 12423         GO TO 3026-NO-SPEC-TABLE.
 12424
 12425     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12426     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12427                                   WS-NSP-ST-CD-LF.
 12428     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12429                                   WS-NSP-ST-CD-AH.
 12430
 12431     GO TO 3040-EDIT-CONTINUE.
 12432
 12433 3026-NO-SPEC-TABLE.
 12434
 12435     MOVE ER-2664                TO WS-ERROR.
 12436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12437     GO TO 3040-EDIT-CONTINUE.
 12438
 12439 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 228
* EL050.cbl
 12440
 12441     IF PB-I-REIN-TABLE = SPACES
 12442       GO TO 3040-EDIT-CONTINUE.
 12443
 12444     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12445          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12446          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12447           GO TO 3040-EDIT-CONTINUE.
 12448
 12449     MOVE LOW-VALUES            TO ERREIN-KEY.
 12450     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12451     MOVE 'A'                   TO REIN-TYPE.
 12452     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12453
 12454     MOVE '3028'                TO REIN-SW.
 12455     MOVE ' '                   TO WS-REIN-READ-SW.
 12456
 12457     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12458     IF REIN-TABLE-NOT-FOUND
 12459         GO TO 3028-NO-REIN-TABLE.
 12460
 12461     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12462     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12463                                   WS-NSP-ST-CD-LF.
 12464     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12465                                   WS-NSP-ST-CD-AH.
 12466
 12467     GO TO 3040-EDIT-CONTINUE.
 12468
 12469 3028-NO-REIN-TABLE.
 12470
 12471     MOVE ER-2615                TO WS-ERROR.
 12472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12473     GO TO 3040-EDIT-CONTINUE.
 12474
 12475 3040-EDIT-CONTINUE.
 12476
 12477     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12478         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12479
 12480     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12481         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12482
 12483     IF (NOT PB-REISSUED-CERT)
 12484        AND (NOT PB-MONTHLY-CERT)
 12485        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12486            MOVE '001'           TO PB-I-LF-TERM
 12487            MOVE 'M'             TO PB-I-INSURED-SEX.
 12488
 12489     IF (NOT PB-REISSUED-CERT)
 12490        AND (NOT PB-MONTHLY-CERT)
 12491        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12492            MOVE '001'           TO PB-I-AH-TERM
 12493            MOVE 'M'             TO PB-I-INSURED-SEX.
 12494
 12495 3040-EDIT-1ST-PMT-DT.
 12496     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12497     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 229
* EL050.cbl
 12498         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12499
 12500******************************************************************
 12501*                                                                *
 12502*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12503*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12504*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12505*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12506*                                                                *
 12507******************************************************************
 12508
 12509     IF PB-EFF-DT-PROCESSING
 12510        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12511                                    PB-I-LF-EXPIRE-DT
 12512                                    PB-I-AH-EXPIRE-DT
 12513        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12514        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12515        MOVE ZERO                TO DC-ELAPSED-DAYS
 12516        MOVE +1                  TO DC-ELAPSED-MONTHS
 12517        SET BIN-PLUS-ELAPSED     TO TRUE
 12518*       MOVE 6                   TO DC-OPTION-CODE
 12519        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12520        IF NO-CONVERSION-ERROR
 12521           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12522
 12523******************************************************************
 12524*                                                                *
 12525*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12526*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12527*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12528*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12529*                                                                *
 12530******************************************************************
 12531
 12532     IF PB-EXT-DAYS-PROCESSING
 12533          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12534                                         PB-I-LF-EXPIRE-DT
 12535                                         PB-I-AH-EXPIRE-DT
 12536          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12537          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12538          MOVE +1                     TO DC-ELAPSED-MONTHS
 12539          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12540          SET BIN-PLUS-ELAPSED        TO TRUE
 12541*         MOVE 6                      TO DC-OPTION-CODE
 12542          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12543          IF NO-CONVERSION-ERROR
 12544             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12545
 12546******************************************************************
 12547*                                                                *
 12548*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12549*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12550*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12551*        (EXPIRE DATE - (TERM -1))  *  -1.
 12552*                                                                *
 12553******************************************************************
 12554
 12555     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 230
* EL050.cbl
 12556        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12557           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12558              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12559              MOVE PB-I-AH-TERM      TO WS-TERM
 12560           ELSE
 12561              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12562              MOVE PB-I-LF-TERM      TO WS-TERM
 12563        ELSE
 12564           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12565              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12566              MOVE PB-I-LF-TERM      TO WS-TERM
 12567           ELSE
 12568              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12569              MOVE PB-I-AH-TERM      TO WS-TERM.
 12570
 12571     IF PB-EXPIRE-DT-PROCESSING
 12572        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12573        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12574        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12575        MOVE ZERO                TO DC-ELAPSED-DAYS
 12576                                    DC-ODD-DAYS-OVER
 12577          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12578          SET BIN-PLUS-ELAPSED    TO TRUE
 12579*         MOVE 6                  TO DC-OPTION-CODE
 12580          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12581          IF NO-CONVERSION-ERROR
 12582             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12583
 12584******************************************************************
 12585*                                                                *
 12586*            1ST PAYMENT DATE PROCESSING                         *
 12587*                                                                *
 12588******************************************************************
 12589
 12590     IF PB-1ST-PMT-DT-PROCESSING
 12591        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12592                                    PB-I-AH-EXPIRE-DT
 12593        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12594
 12595     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12596         NEXT SENTENCE
 12597     ELSE
 12598         MOVE ER-2680                 TO WS-ERROR
 12599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12600         GO TO 3060-ORIG-TERM-CHECK.
 12601
 12602     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12603     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12604     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12605*    MOVE 1                      TO DC-OPTION-CODE.
 12606     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12607                                    DC-ELAPSED-DAYS
 12608                                    DC-ODD-DAYS-OVER.
 12609
 12610     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12611
 12612     IF DATE-CONVERSION-ERROR
 12613        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 231
* EL050.cbl
 12614
 12615     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12616     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12617        AND (WS-LF-COVERAGE-TYPE = 'L')
 12618        IF (DC-ELAPSED-MONTHS > 1)
 12619                      OR
 12620           ((DC-ELAPSED-MONTHS = 1)
 12621           AND (DC-ODD-DAYS-OVER > 0))
 12622           MOVE ER-2882          TO WS-ERROR
 12623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12624        END-IF
 12625     END-IF
 12626     if dc-elapsed-months > 0
 12627        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12628        + dc-odd-days-over
 12629     end-if
 12630     IF PB-EXT-DAYS-PROCESSING
 12631        CONTINUE
 12632     ELSE
 12633        IF DC-ELAPSED-MONTHS = +0
 12634           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12635        ELSE
 12636           IF (WS-LF-EARNINGS-CALC = '4')
 12637              AND (DC-ELAPSED-MONTHS > ZERO)
 12638              AND (DC-ELAPSED-DAYS > ZERO)
 12639              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12640           ELSE
 12641              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12642                                 THRU 6499-EXIT
 12643              MOVE WS-ODD-DAYS-OVER
 12644                                 TO PB-I-EXTENTION-DAYS
 12645           END-IF
 12646        END-IF
 12647     END-IF
 12648******************************************************************
 12649*                                                                *
 12650*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12651*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12652*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12653*            AND ANY ODD DAYS.                                   *
 12654*                                                                *
 12655******************************************************************
 12656
 12657     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12658                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12659     IF WS-LF-EARNINGS-CALC NOT = '4'
 12660        IF DC-ELAPSED-DAYS > ZEROS
 12661           MOVE ER-2681          TO WS-ERROR
 12662           PERFORM 9900-ERROR-FORMAT
 12663                                 THRU 9900-EXIT
 12664        END-IF
 12665     END-IF
 12666
 12667     IF WS-LF-EARNINGS-CALC NOT = '4'
 12668        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12669           MOVE ER-2681          TO WS-ERROR
 12670           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12671
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 232
* EL050.cbl
 12672     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12673        (PB-I-LF-TERM NOT = ZERO) AND
 12674         NOT NO-LIFE-COVERAGE
 12675          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12676          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12677          IF WS-LF-EARNINGS-CALC = '4'
 12678             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12679             PB-I-PAY-FREQUENCY
 12680          END-IF
 12681          MOVE ZERO              TO DC-ELAPSED-DAYS
 12682                                    DC-ODD-DAYS-OVER
 12683          MOVE 1                 TO DC-END-OF-MONTH
 12684          SET BIN-PLUS-ELAPSED        TO TRUE
 12685*         MOVE 6                 TO DC-OPTION-CODE
 12686          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12687          IF NO-CONVERSION-ERROR
 12688             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12689             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12690                (WS-LF-SPECIAL-CALC-CD = 'L')
 12691                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12692                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12693                  MOVE +1             TO DC-ELAPSED-MONTHS
 12694                  SET BIN-PLUS-ELAPSED  TO TRUE
 12695*                 MOVE 6              TO DC-OPTION-CODE
 12696                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12697                  IF NO-CONVERSION-ERROR
 12698                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12699
 12700* okay, i had to move the new att age edit down here because the
 12701* expiration date could get recalculated and i need the exp date
 12702     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12703        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12704        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12705        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12706           AND ZEROS
 12707           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12708           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12709           SET ELAPSED-BETWEEN-BIN TO TRUE
 12710           PERFORM 8500-DATE-CONVERT
 12711                                 THRU 8500-EXIT
 12712           IF NO-CONVERSION-ERROR
 12713              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12714                 MOVE ER-2669       TO WS-ERROR
 12715*                PERFORM 9900-ERROR-FORMAT
 12716*                                THRU 9900-EXIT
 12717              END-IF
 12718           END-IF
 12719        ELSE
 12720           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12721           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12722              MOVE ER-2669       TO WS-ERROR
 12723*             PERFORM 9900-ERROR-FORMAT
 12724*                                THRU 9900-EXIT
 12725           ELSE
 12726              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12727                 MOVE ER-1570    TO WS-ERROR
 12728                 PERFORM 9900-ERROR-FORMAT
 12729                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 233
* EL050.cbl
 12730              END-IF
 12731           END-IF
 12732        END-IF
 12733        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12734           AND ZEROS
 12735           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12736           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12737           SET ELAPSED-BETWEEN-BIN TO TRUE
 12738           PERFORM 8500-DATE-CONVERT
 12739                                 THRU 8500-EXIT
 12740           IF NO-CONVERSION-ERROR
 12741              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12742                 MOVE ER-2669       TO WS-ERROR
 12743*                PERFORM 9900-ERROR-FORMAT
 12744*                                THRU 9900-EXIT
 12745              END-IF
 12746           END-IF
 12747        ELSE
 12748           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12749             (PB-I-LF-TERM / 12)
 12750           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12751              MOVE ER-2669       TO WS-ERROR
 12752*             PERFORM 9900-ERROR-FORMAT
 12753*                                THRU 9900-EXIT
 12754           ELSE
 12755              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12756                 MOVE ER-1571    TO WS-ERROR
 12757                 PERFORM 9900-ERROR-FORMAT
 12758                                 THRU 9900-EXIT
 12759              END-IF
 12760           END-IF
 12761        END-IF
 12762        IF WS-ERROR = ER-2669
 12763           PERFORM 9900-ERROR-FORMAT
 12764                                 THRU 9900-EXIT
 12765        END-IF
 12766     END-IF
 12767     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12768        (PB-I-AH-TERM NOT = ZERO) AND
 12769         NOT NO-AH-COVERAGE
 12770          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12771             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12772             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12773             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12774          ELSE
 12775             IF WS-LF-EARNINGS-CALC = '4'
 12776                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12777                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12778                PB-I-PAY-FREQUENCY
 12779             ELSE
 12780                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12781                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12782             END-IF
 12783          END-IF
 12784          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12785                                         DC-ODD-DAYS-OVER
 12786          MOVE 1                      TO DC-END-OF-MONTH
 12787          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 234
* EL050.cbl
 12788*         MOVE 6                      TO DC-OPTION-CODE
 12789          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12790          IF NO-CONVERSION-ERROR
 12791             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12792     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12793        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12794        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12795        IF PB-I-BIRTHDAY > LOW-VALUES
 12796           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12797           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12798           SET ELAPSED-BETWEEN-BIN TO TRUE
 12799           PERFORM 8500-DATE-CONVERT
 12800                                 THRU 8500-EXIT
 12801           IF NO-CONVERSION-ERROR
 12802              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12803                 MOVE ER-3054       TO WS-ERROR
 12804*                PERFORM 9900-ERROR-FORMAT
 12805*                                THRU 9900-EXIT
 12806              END-IF
 12807           END-IF
 12808        ELSE
 12809           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12810           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12811              MOVE ER-3054       TO WS-ERROR
 12812*             PERFORM 9900-ERROR-FORMAT
 12813*                                THRU 9900-EXIT
 12814           END-IF
 12815        END-IF
 12816        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12817           AND ZEROS
 12818           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12819           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12820           SET ELAPSED-BETWEEN-BIN TO TRUE
 12821           PERFORM 8500-DATE-CONVERT
 12822                                 THRU 8500-EXIT
 12823           IF NO-CONVERSION-ERROR
 12824              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12825                 MOVE ER-3054       TO WS-ERROR
 12826*                PERFORM 9900-ERROR-FORMAT
 12827*                                THRU 9900-EXIT
 12828              END-IF
 12829           END-IF
 12830        ELSE
 12831           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12832             (PB-I-AH-TERM / 12)
 12833           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12834              MOVE ER-3054       TO WS-ERROR
 12835*             PERFORM 9900-ERROR-FORMAT
 12836*                                THRU 9900-EXIT
 12837           END-IF
 12838        END-IF
 12839        IF WS-ERROR = ER-3054
 12840           PERFORM 9900-ERROR-FORMAT
 12841                                 THRU 9900-EXIT
 12842        END-IF
 12843     END-IF
 12844     MOVE SPACE                       TO DC-END-OF-MONTH.
 12845
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 235
* EL050.cbl
 12846     IF PB-COMPANY-ID = 'NCB'
 12847        GO TO 3040-EDIT-EXTENSION-DAYS.
 12848
 12849     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12850       AND
 12851        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12852        NEXT SENTENCE
 12853     ELSE
 12854        GO TO 3040-EDIT-EXTENSION-DAYS.
 12855
 12856     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12857        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12858        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12859     ELSE
 12860        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12861        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12862
 12863     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12864*    MOVE '1'      TO DC-OPTION-CODE
 12865     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12866     IF (NO-CONVERSION-ERROR)
 12867        AND (DC-ELAPSED-MONTHS > +1)
 12868        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12869        MOVE ER-2668   TO WS-ERROR
 12870        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12871
 12872 3040-EDIT-EXTENSION-DAYS.
 12873
 12874     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12875        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12876         GO TO 3050-EDIT-TERM-IN-DAYS
 12877     ELSE
 12878         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12879
 12880     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12881         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12882     ELSE
 12883        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12884           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12885           MOVE ER-2681         TO WS-ERROR
 12886           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12887
 12888     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12889        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12890        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12891         GO TO 3060-ORIG-TERM-CHECK.
 12892
 12893     GO TO 3060-ORIG-TERM-CHECK.
 12894
 12895 3050-EDIT-TERM-IN-DAYS.
 12896
 12897     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12898
 12899     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12900         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12901     ELSE
 12902         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12903            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 236
* EL050.cbl
 12904            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12905
 12906     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12907                                       REMAINDER WS-WORK-TERM.
 12908     IF WS-WORK-TERM GREATER THAN ZERO
 12909         ADD +1 TO PB-I-LF-TERM.
 12910
 12911     IF NOT NO-AH-COVERAGE
 12912         MOVE ER-2684            TO WS-ERROR
 12913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12914
 12915
 12916 3060-ORIG-TERM-CHECK.
 12917
 12918******************************************************************
 12919*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12920******************************************************************
 12921
 12922     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12923        NEXT SENTENCE
 12924     ELSE
 12925        IF NOT NO-LIFE-COVERAGE
 12926           IF PB-I-LF-TERM NUMERIC
 12927              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12928              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12929              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12930                  NEXT SENTENCE
 12931           ELSE
 12932              MOVE ER-2647       TO WS-ERROR
 12933              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12934
 12935     IF NOT NO-AH-COVERAGE
 12936         IF PB-I-AH-TERM NUMERIC
 12937            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12938            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12939            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12940             NEXT SENTENCE
 12941          ELSE
 12942              MOVE ER-2658       TO WS-ERROR
 12943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12944
 12945     IF PB-COMPANY-ID = 'NCB'
 12946        GO TO 3070-LOAN-TERM-CHECK.
 12947
 12948     IF POLICY-HAS-AH
 12949       AND
 12950        POLICY-HAS-LIFE
 12951       AND
 12952        PB-I-LF-TERM NUMERIC
 12953       AND
 12954        PB-I-AH-TERM NUMERIC
 12955        NEXT SENTENCE
 12956     ELSE
 12957        GO TO 3070-LOAN-TERM-CHECK.
 12958
 12959     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12960     IF WS-TEX-FACT-2 LESS THAN +0
 12961        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 237
* EL050.cbl
 12962
 12963     IF WS-TEX-FACT-2 GREATER THAN +1
 12964        MOVE ER-2668             TO WS-ERROR
 12965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12966
 12967 3070-LOAN-TERM-CHECK.
 12968
 12969     IF (WS-LF-BENEFIT-CD = ZERO)
 12970         OR (NO-LF-BENEFIT-MATCH)
 12971            GO TO 3125-EDIT-PMT-FREQ.
 12972*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12973*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12974*          AND 'V' AND 'W' AND 'X'
 12975*          GO TO 3125-EDIT-PMT-FREQ
 12976*       END-IF
 12977*    ELSE
 12978*       IF WS-AH-DCC-TRUNC = 'T'
 12979*          CONTINUE
 12980*       ELSE
 12981*          GO TO 3125-EDIT-PMT-FREQ
 12982*       END-IF
 12983*    END-IF
 12984     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12985                    OR
 12986        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12987        AND (WS-AH-DCC-TRUNC = 'T'))
 12988        CONTINUE
 12989     ELSE
 12990        GO TO 3125-EDIT-PMT-FREQ
 12991     END-IF
 12992     IF PB-I-LOAN-TERM NOT NUMERIC
 12993         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12994
 12995     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12996        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12997*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12998        PB-I-LOAN-TERM NOT GREATER THAN +360
 12999         NEXT SENTENCE
 13000     ELSE
 13001         MOVE ER-2648            TO WS-ERROR
 13002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13003
 13004     if  PB-I-LOAN-TERM > WS-MAX-TERM
 13005        MOVE ER-3058             TO WS-ERROR
 13006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13007     end-if
 13008
 13009     IF WS-STATE-ABBREVIATION = 'NC'
 13010        IF PB-I-LOAN-TERM > +59
 13011           CONTINUE
 13012        ELSE
 13013           MOVE ER-2792          TO WS-ERROR
 13014           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13015        END-IF
 13016     END-IF
 13017
 13018     .
 13019 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 238
* EL050.cbl
 13020     IF (WS-LF-BENEFIT-CD = ZERO)
 13021         OR (NO-LF-BENEFIT-MATCH)
 13022         or (pb-state = 'AL')
 13023            GO TO 3127-EDIT-LOAN-OFFICER.
 13024     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13025                    OR
 13026        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13027        AND (WS-AH-DCC-TRUNC = 'T'))
 13028                    OR
 13029         (PB-COMPANY-ID = 'AHL')
 13030        CONTINUE
 13031     ELSE
 13032        IF (PB-I-LOAN-TERM > ZEROS)
 13033           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13034           MOVE ER-1575          TO WS-ERROR
 13035           PERFORM 9900-ERROR-FORMAT
 13036                                 THRU 9900-EXIT
 13037        END-IF
 13038     END-IF
 13039     IF WS-LF-EARNINGS-CALC NOT = '4'
 13040         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13041            MOVE ER-2653         TO WS-ERROR
 13042            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13043            GO TO 3127-EDIT-LOAN-OFFICER
 13044         ELSE
 13045            GO TO 3127-EDIT-LOAN-OFFICER.
 13046
 13047     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13048         MOVE ER-2655            TO WS-ERROR
 13049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13050         GO TO 3127-EDIT-LOAN-OFFICER.
 13051
 13052     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13053         MOVE ER-2654            TO WS-ERROR
 13054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13055         GO TO 3127-EDIT-LOAN-OFFICER.
 13056
 13057     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13058         GIVING WS-TEX-FACT-2
 13059             REMAINDER WS-TEX-FACT-3.
 13060
 13061*    IF WS-TEX-FACT-3 NOT = ZERO
 13062*       MOVE ER-2654             TO WS-ERROR
 13063*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13064
 13065
 13066 3127-EDIT-LOAN-OFFICER.
 13067
 13068     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13069        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13070           MOVE ER-2690          TO WS-ERROR
 13071           PERFORM 9900-ERROR-FORMAT
 13072                                 THRU 9900-EXIT
 13073        ELSE
 13074           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13075           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13076           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13077           MOVE PB-SV-STATE      TO LOFC-STATE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 239
* EL050.cbl
 13078           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 13079           MOVE PB-I-LOAN-OFFICER
 13080                                 TO LOFC-CODE
 13081           PERFORM 8586-READ-LOAN-OFFICER
 13082                                 THRU 8586-EXIT
 13083           IF (NOT LOFC-MASTER-FOUND)
 13084              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13085              MOVE ER-3006       TO WS-ERROR
 13086              PERFORM 9900-ERROR-FORMAT
 13087                                 THRU 9900-EXIT
 13088           END-IF
 13089        END-IF
 13090     END-IF
 13091     .
 13092 3129-EDIT-APR.
 13093
 13094     IF (WS-LF-BENEFIT-CD = ZERO)
 13095        OR (NO-LF-BENEFIT-MATCH)
 13096        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13097           GO TO 3130-EDIT-AGE
 13098*       ELSE
 13099*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13100*             GO TO 3130-EDIT-AGE
 13101*          END-IF
 13102        END-IF
 13103     END-IF
 13104
 13105     IF (WS-STATE-ABBREVIATION = 'OH')
 13106         AND (PB-I-RATE-CLASS NOT = 'L ')
 13107         AND (PB-I-LF-TERM GREATER THAN 60)
 13108         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13109         GO TO 3129-APR-CONT.
 13110
 13111     IF (WS-STATE-ABBREVIATION = 'RI')
 13112         AND (PB-I-LF-TERM GREATER THAN 60)
 13113         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13114         GO TO 3129-APR-CONT.
 13115
 13116     IF (WS-STATE-ABBREVIATION = 'UT')
 13117         AND (PB-I-LF-TERM GREATER THAN 62)
 13118         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13119         AND (PB-CERT-EFF-DT LESS WS-830901)
 13120         GO TO 3129-APR-CONT.
 13121
 13122     IF PB-COMPANY-ID = 'LAP'
 13123        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13124           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13125              MOVE ER-2656         TO WS-ERROR
 13126              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13127              GO TO 3130-EDIT-AGE.
 13128
 13129     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13130        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13131        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13132        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13133        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13134        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13135         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 240
* EL050.cbl
 13136
 13137 3129-APR-CONT.
 13138     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13139         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13140         GO TO 3130-EDIT-AGE.
 13141
 13142     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13143         WS-AH-BENEFIT-CD (1:1) = 'S')
 13144        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13145        AND (PB-I-LOAN-APR = ZERO)
 13146        MOVE ER-2657             TO WS-ERROR
 13147        PERFORM 9900-ERROR-FORMAT
 13148                                 THRU 9900-EXIT
 13149        GO TO 3130-EDIT-AGE
 13150     END-IF
 13151*    IF PB-I-LOAN-APR = ZERO
 13152*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13153*    END-IF
 13154
 13155     if pb-i-loan-apr = +99.9999
 13156        move er-2656             to ws-error
 13157        PERFORM 9900-ERROR-FORMAT
 13158                                 THRU 9900-EXIT
 13159        GO TO 3130-EDIT-AGE
 13160     end-if
 13161*    IF PB-I-LOAN-APR = ZERO
 13162*       MOVE ER-2656             TO WS-ERROR
 13163*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13164*       GO TO 3130-EDIT-AGE.
 13165
 13166*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13167     if pb-i-loan-apr not = +99.9999
 13168        IF PB-I-LOAN-APR > +30.000
 13169           MOVE ER-2657          TO WS-ERROR
 13170           PERFORM 9900-ERROR-FORMAT
 13171                                 THRU 9900-EXIT
 13172        end-if
 13173     end-if
 13174     .
 13175 3130-EDIT-AGE.
 13176
 13177******************************************************************
 13178*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13179******************************************************************
 13180
 13181     IF NOT NO-LIFE-COVERAGE
 13182        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13183           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13184               MOVE ER-2628             TO WS-ERROR
 13185               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13186
 13187     IF NOT NO-AH-COVERAGE
 13188        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13189           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13190               MOVE ER-2628         TO WS-ERROR
 13191               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13192
 13193 3133-SEX-CODE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 241
* EL050.cbl
 13194     IF PB-I-INSURED-SEX = SPACE OR ZERO
 13195         IF WS-DEFAULT-SEX = 'M'
 13196             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13197          ELSE
 13198             IF WS-DEFAULT-SEX = 'F'
 13199             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13200
 13201     IF PB-I-INSURED-SEX = '1'
 13202         MOVE 'M' TO PB-I-INSURED-SEX.
 13203
 13204     IF PB-I-INSURED-SEX = '2'
 13205         MOVE 'F' TO PB-I-INSURED-SEX.
 13206
 13207 3134-SIG-SW-EDIT.
 13208     IF PB-I-SIG-SW = SPACE
 13209         MOVE 'N'                TO  PB-I-SIG-SW.
 13210
 13211     IF PB-COMPANY-ID = 'NCL'
 13212         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13213             NEXT SENTENCE
 13214         ELSE
 13215             MOVE ER-1923        TO  WS-ERROR
 13216             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13217     ELSE
 13218     IF PB-COMPANY-ID = 'CRI'
 13219         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13220             NEXT SENTENCE
 13221         ELSE
 13222             MOVE ER-2606        TO  WS-ERROR
 13223             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13224     ELSE
 13225     IF PB-COMPANY-ID = 'TMS'
 13226         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13227             NEXT SENTENCE
 13228         ELSE
 13229             MOVE ER-2689        TO  WS-ERROR
 13230             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13231     ELSE
 13232         IF PB-I-SIG-SW = 'Y' OR 'N'
 13233             NEXT SENTENCE
 13234         ELSE
 13235             MOVE ER-2651        TO  WS-ERROR
 13236             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13237
 13238     IF PB-COMPANY-ID = 'FLA'
 13239         IF (WS-EDIT-AGE GREATER 54  OR
 13240             WS-AH-EDIT-AGE GREATER 54)  AND
 13241            PB-I-SIG-SW = 'N'
 13242            MOVE ER-2651         TO  WS-ERROR
 13243            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13244
 13245 3135-NAME-EDIT.
 13246
 13247     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13248        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13249        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13250           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13251                                 TO PB-I-JOINT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 242
* EL050.cbl
 13252        END-PERFORM
 13253     END-IF
 13254     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13255        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13256        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13257           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13258                                 TO PB-I-JOINT-LAST-NAME
 13259        END-PERFORM
 13260     END-IF
 13261     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13262        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13263        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13264           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13265                                 TO PB-I-INSURED-FIRST-NAME
 13266        END-PERFORM
 13267     END-IF
 13268     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13269        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13270        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13271           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13272                                 TO PB-I-INSURED-LAST-NAME
 13273        END-PERFORM
 13274     END-IF
 13275     if PB-I-JOINT-COVERAGE *> and
 13276*       pb-i-insured-last-name <> spaces
 13277        if pb-i-insured-last-name = pb-i-joint-last-name and
 13278           pb-i-insured-first-name = pb-i-joint-first-name and
 13279           pb-i-birthday = pb-i-joint-birthday
 13280           move er-3069          to ws-error
 13281           perform 9900-error-format
 13282                                 thru 9900-exit
 13283        end-if
 13284     end-if
 13285     IF PB-I-INSURED-LAST-NAME = SPACES
 13286       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13287       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13288           MOVE ER-2660    TO WS-ERROR
 13289           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13290
 13291 3136-EDIT-SEX.
 13292
 13293******************************************************************
 13294*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13295******************************************************************
 13296
 13297     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13298        (WS-AH-SPECIAL-CALC-CD = 'O')
 13299        NEXT SENTENCE
 13300     ELSE
 13301        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13302           NEXT SENTENCE
 13303        ELSE
 13304           MOVE ER-2629            TO WS-ERROR
 13305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13306
 13307 3137-EDIT-EFF-DATE.
 13308
 13309     IF PB-REISSUED-CERT       OR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 243
* EL050.cbl
 13310        PB-POLICY-IS-DECLINED  OR
 13311        PB-POLICY-IS-VOIDED
 13312         GO TO 3139-EDIT-COVERAGE-CODES.
 13313
 13314     MOVE SPACE                  TO WS-2671-SW
 13315                                    WS-2672-SW.
 13316
 13317     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13318         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13319             MOVE ER-2703        TO WS-ERROR
 13320             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13321             GO TO 3139-EDIT-COVERAGE-CODES.
 13322
 13323     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13324         GO TO 3139-EDIT-COVERAGE-CODES.
 13325
 13326     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13327     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13328*    MOVE '1'                    TO DC-OPTION-CODE.
 13329     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13330     MOVE +0                     TO DC-ELAPSED-MONTHS
 13331                                    DC-ELAPSED-DAYS.
 13332     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13333
 13334     IF DATE-CONVERSION-ERROR
 13335         GO TO 3139-EDIT-COVERAGE-CODES.
 13336
 13337     IF DC-ELAPSED-DAYS GREATER +180
 13338         MOVE ER-2672            TO WS-ERROR
 13339         MOVE 'Y'                TO WS-2672-SW
 13340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13341     END-IF
 13342
 13343     IF WS-ERROR = ER-2671  AND
 13344        PB-COMPANY-ID  = 'LBL'
 13345        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13346        MOVE SPACE               TO WS-2671-SW
 13347        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13348
 13349     IF PB-ISSUE-DATE-FORCED  AND
 13350      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13351         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13352         MOVE ER-2673            TO WS-ERROR
 13353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13354         MOVE SPACE              TO WS-2671-SW
 13355                                    WS-2672-SW.
 13356
 13357     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13358         IF PB-ISSUE-DATE-FORCED
 13359             MOVE ER-2600          TO  WS-ERROR
 13360             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13361         ELSE
 13362             MOVE ER-2692          TO  WS-ERROR
 13363             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13364
 13365
 13366 3139-EDIT-COVERAGE-CODES.
 13367
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 244
* EL050.cbl
 13368     if pb-company-id not = 'AHL'
 13369        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13370           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13371           MOVE ER-2787          TO WS-ERROR
 13372           PERFORM 9900-ERROR-FORMAT
 13373                                 THRU 9900-EXIT
 13374        END-IF
 13375     end-if
 13376     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13377        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13378                                 > 250000.00
 13379           MOVE ER-2719          TO WS-ERROR
 13380           PERFORM 9900-ERROR-FORMAT
 13381                                 THRU 9900-EXIT
 13382        END-IF
 13383     END-IF
 13384
 13385     IF PB-POLICY-IS-DECLINED  OR
 13386        PB-POLICY-IS-VOIDED
 13387         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13388
 13389     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13390        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13391         MOVE ER-2630                TO WS-ERROR
 13392         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13393
 13394     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13395        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13396        PB-I-LF-PREMIUM-AMT = ZERO
 13397         GO TO 3140-CHECK-AH-FOR-ZERO.
 13398
 13399     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13400        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13401        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13402         GO TO 3140-CHECK-AH-FOR-ZERO.
 13403
 13404     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13405        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13406        MOVE ER-2631             TO WS-ERROR
 13407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13408     END-IF
 13409
 13410
 13411******************************************************************
 13412*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13413******************************************************************
 13414
 13415     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13416        NEXT SENTENCE
 13417     ELSE
 13418        IF PB-I-LF-BENEFIT-AMT = ZERO
 13419           MOVE ER-2632             TO WS-ERROR
 13420           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13421
 13422
 13423******************************************************************
 13424*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13425******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 245
* EL050.cbl
 13426
 13427     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13428        CONTINUE
 13429     ELSE
 13430        IF PB-I-LF-PREMIUM-AMT = ZERO
 13431           IF (NOT PB-COMP-LF-PREM)
 13432              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13433              and (ws-lf-ben-category not = 'C')
 13434              MOVE ER-2633       TO WS-ERROR
 13435              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13436           END-IF
 13437        END-IF
 13438     END-IF
 13439     .
 13440 3140-CHECK-AH-FOR-ZERO.
 13441
 13442     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13443        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13444        PB-I-AH-PREMIUM-AMT = ZERO
 13445         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13446
 13447     IF PB-COMPANY-ID = 'CSL'  AND
 13448        PB-I-AH-BENEFIT-CD = ZERO  AND
 13449        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13450        PB-I-AH-PREMIUM-AMT = ZERO
 13451         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13452
 13453     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13454        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13455        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13456         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13457
 13458     IF PB-I-AH-BENEFIT-CD = ZERO
 13459         MOVE ER-2634            TO WS-ERROR
 13460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13461
 13462******************************************************************
 13463*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13464******************************************************************
 13465
 13466     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13467        NEXT SENTENCE
 13468     ELSE
 13469        IF PB-I-AH-BENEFIT-AMT = ZERO
 13470           MOVE ER-2635             TO WS-ERROR
 13471           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13472
 13473******************************************************************
 13474*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13475******************************************************************
 13476
 13477     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13478        NEXT SENTENCE
 13479     ELSE
 13480        IF PB-I-AH-PREMIUM-AMT = ZERO
 13481            IF NOT PB-COMP-AH-PREM
 13482                MOVE ER-2636    TO WS-ERROR
 13483                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 246
* EL050.cbl
 13484
 13485
 13486 3140-EDIT-MAX-AMT-SIZES.
 13487* CUSTOM CODE FOR CLIENT    'DMD'
 13488     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13489                                     WS-RES-MUNI-TAX
 13490                                     PB-I-STATE-TAX
 13491                                     PB-I-MUNI-TAX.
 13492
 13493     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13494
 13495     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13496        GO TO 3150-RATE-OUTSTAND-BAL.
 13497
 13498     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13499        GO TO 3150-RATE-OUTSTAND-BAL.
 13500
 13501     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13502        GO TO 3150-RATE-OUTSTAND-BAL.
 13503
 13504     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13505                             OR 'RIC')
 13506        GO TO 3150-RATE-OUTSTAND-BAL.
 13507
 13508     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13509        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13510            GO TO 3150-RATE-OUTSTAND-BAL
 13511        ELSE
 13512           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13513               GO TO 3150-RATE-OUTSTAND-BAL.
 13514
 13515     IF NOT PB-NO-MONTHS-SKIPPED
 13516        GO TO 3150-RATE-OUTSTAND-BAL.
 13517
 13518     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13519        GO TO 3150-RATE-OUTSTAND-BAL.
 13520
 13521     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13522        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13523           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13524             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13525           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13526           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13527              MOVE ER-2693     TO WS-ERROR
 13528              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13529              GO TO 3150-RATE-OUTSTAND-BAL
 13530           ELSE
 13531              GO TO 3150-RATE-OUTSTAND-BAL.
 13532
 13533 3150-RATE-OUTSTAND-BAL.
 13534
 13535* DMD RATING TEST
 13536     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13537         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13538         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13539         MOVE ER-2687                 TO WS-ERROR
 13540         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13541         MOVE 'B'                     TO PB-I-OB-FLAG
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 247
* EL050.cbl
 13542         GO TO 3260-EDIT-CONTINUE.
 13543
 13544     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13545         IF  WS-ERROR    EQUAL    ER-2693
 13546             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13547                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13548                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13549                 MOVE  +0            TO  WS-ERROR.
 13550
 13551     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13552         IF  WS-ERROR    EQUAL    ER-2693
 13553             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13554                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13555                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13556                 MOVE  +0            TO  WS-ERROR.
 13557
 13558     IF PLAN-MASTER-AH-SW = 'Y'
 13559        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13560            IF  WS-ERROR    EQUAL    ER-2693
 13561              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13562                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13563                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13564                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13565                 MOVE  ER-1910           TO  WS-ERROR
 13566                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13567
 13568     IF PLAN-MASTER-AH-SW = 'Y'
 13569        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13570            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13571               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13572               MOVE  ER-1910           TO  WS-ERROR
 13573               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13574
 13575     IF PLAN-MASTER-AH-SW = 'Y'
 13576        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13577            IF  WS-ERROR    EQUAL    ER-2693
 13578                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13579                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13580                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13581                 MOVE  +0       TO  WS-ERROR.
 13582
 13583     IF WS-ERROR = ER-2693
 13584        IF PB-COMPANY-ID = 'JAL' AND
 13585           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13586           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13587           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13588
 13589     IF WS-ERROR = ER-2693
 13590        IF PB-COMPANY-ID = 'NCL'  AND
 13591           PB-I-AH-BENEFIT-CD = 'OA'
 13592           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13593           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13594
 13595     IF WS-ERROR = ER-2693
 13596        IF PB-COMPANY-ID = 'CNL' AND
 13597           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13598           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13599           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 248
* EL050.cbl
 13600
 13601     IF WS-ERROR = ER-2693
 13602        IF PB-COMPANY-ID = 'HER'
 13603           IF WS-LEVEL
 13604              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13605              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13606
 13607     IF ((LF-BENEFIT-FOUND) AND
 13608         (NOT NO-LIFE-COVERAGE)  AND
 13609         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13610       OR   ((AH-BENEFIT-FOUND) AND
 13611             (NOT NO-AH-COVERAGE)    AND
 13612             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13613         NEXT SENTENCE
 13614     ELSE
 13615         GO TO 3215-EDIT-RATES.
 13616
 13617     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13618        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13619           MOVE ER-2674          TO WS-ERROR
 13620           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13621           GO TO 3215-EDIT-RATES.
 13622
 13623     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13624        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13625           MOVE ER-2674          TO WS-ERROR
 13626           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13627           GO TO 3215-EDIT-RATES.
 13628
 13629     MOVE 'B'                    TO PB-I-OB-FLAG.
 13630
 13631     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13632         NEXT SENTENCE
 13633     ELSE
 13634         IF NOT NO-LIFE-COVERAGE
 13635             IF WS-ACCT-LF-OB-RT = ZERO
 13636                MOVE ER-2641    TO WS-ERROR
 13637                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13638
 13639     IF PB-COMPANY-ID = 'CRI'
 13640       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13641         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13642         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13643         IF WS-ERROR = ER-2675
 13644            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13645            MOVE ER-2687              TO WS-ERROR
 13646            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13647         ELSE
 13648            MOVE ER-2687              TO WS-ERROR
 13649            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13650
 13651
 13652     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13653         NEXT SENTENCE
 13654     ELSE
 13655       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13656            NEXT SENTENCE
 13657       ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 249
* EL050.cbl
 13658         IF NOT NO-AH-COVERAGE
 13659             IF WS-ACCT-AH-OB-RT = ZERO
 13660                MOVE ER-2642    TO WS-ERROR
 13661                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13662
 13663     IF PB-COMPANY-ID = 'CRI'
 13664       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13665         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13666         IF WS-ERROR = ER-2676
 13667            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13668            MOVE ER-2687              TO WS-ERROR
 13669            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13670         ELSE
 13671            MOVE ER-2687              TO WS-ERROR
 13672            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13673
 13674     IF PB-COMPANY-ID NOT = 'GIC'
 13675         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13676            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13677     ELSE
 13678         IF PB-I-LF-PREM-CALC = ZEROS
 13679             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13680                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13681
 13682     IF PB-COMPANY-ID NOT = 'GIC'
 13683         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13684            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13685     ELSE
 13686         IF PB-I-AH-PREM-CALC = ZEROS
 13687             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13688                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13689
 13690     MOVE ZEROS TO PB-I-MORT-CODE.
 13691
 13692     GO TO 3260-EDIT-CONTINUE.
 13693
 13694
 13695 3215-EDIT-RATES.
 13696     IF ACCOUNT-MAST-FOUND
 13697         NEXT SENTENCE
 13698     ELSE
 13699         GO TO 3999-END-EDIT.
 13700
 13701 3220-CHECK-LF-RATES.
 13702
 13703     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13704        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13705        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13706        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13707           AND (NOT WS-LF-CASH))
 13708                           OR
 13709           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13710           AND (NOT WS-AH-CASH)))
 13711                       AND
 13712           (PB-I-ENTRY-STATUS NOT = '5')
 13713           MOVE 'M'              TO PB-BATCH-ENTRY
 13714                                    PB-I-ENTRY-STATUS
 13715        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 250
* EL050.cbl
 13716     END-IF
 13717     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13718                                    PB-I-AH-PREM-CALC
 13719                                    PB-I-LF-ALT-PREM-CALC
 13720                                    PB-I-LF-ALT-RATE
 13721                                    PB-I-LF-REI-RATE
 13722                                    PB-I-LF-ALT-REI-RATE
 13723                                    PB-I-AH-REI-RATE
 13724                                    PB-I-TOT-FEES-CALC.
 13725
 13726     IF PB-COMPANY-ID EQUAL 'DMD'
 13727        NEXT SENTENCE
 13728     ELSE
 13729        MOVE ZEROS               TO PB-I-LF-RATE
 13730                                    PB-I-AH-RATE.
 13731
 13732     IF PB-I-TOT-FEES NOT NUMERIC
 13733        MOVE ZEROS               TO PB-I-TOT-FEES
 13734     END-IF
 13735     IF PB-I-LIVES NOT NUMERIC
 13736         MOVE ZERO               TO PB-I-LIVES.
 13737
 13738     IF PB-I-NUM-BILLED NOT NUMERIC
 13739         MOVE ZERO               TO PB-I-NUM-BILLED.
 13740
 13741     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13742        MOVE +0                  TO PB-I-LF-PREM-TAX
 13743     END-IF
 13744
 13745     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13746        MOVE +0                  TO PB-I-AH-PREM-TAX
 13747     END-IF
 13748
 13749     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13750        PB-I-PAY-FREQUENCY = ZEROS
 13751            MOVE 12 TO CP-PAY-FREQUENCY
 13752     ELSE
 13753            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13754
 13755     IF PB-I-STATE-TAX NOT NUMERIC
 13756         MOVE ZEROS               TO PB-I-STATE-TAX.
 13757
 13758     IF PB-I-MUNI-TAX NOT NUMERIC
 13759         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13760
 13761     MOVE SPACES                 TO CP-BEN-CATEGORY
 13762     IF PB-COMPANY-ID  = 'CSL'  AND
 13763        PB-I-LF-TERM NOT = ZERO
 13764        COMPUTE WS-PAYMENT-AMT =
 13765             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13766        COMPUTE WS-CSL-AMT1 =
 13767             PB-I-LF-TERM * AM-MAX-MON-BEN
 13768        COMPUTE WS-CSL-AMT2 =
 13769             WS-PAYMENT-AMT * PB-I-LF-TERM
 13770        IF CP-PAY-FREQUENCY NOT = 12
 13771           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13772           MOVE '8' TO WS-CSL-CALC-CD
 13773        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 251
* EL050.cbl
 13774           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13775              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13776               AM-MAX-TOT-BEN
 13777               MOVE '6' TO WS-CSL-CALC-CD
 13778           ELSE
 13779              IF (WS-CSL-AMT1  GREATER THAN
 13780                 AM-MAX-TOT-BEN) AND
 13781                 (WS-CSL-AMT2  GREATER THAN
 13782                 AM-MAX-TOT-BEN)
 13783                 MOVE '7' TO WS-CSL-CALC-CD
 13784              ELSE
 13785                 MOVE '5' TO WS-CSL-CALC-CD.
 13786
 13787     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13788         NEXT SENTENCE
 13789     ELSE
 13790         GO TO 3300-CHECK-AH-RATES.
 13791
 13792*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13793
 13794     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13795        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13796              OR
 13797           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13798           MOVE ER-2618          TO WS-ERROR
 13799           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13800           GO TO 3300-CHECK-AH-RATES.
 13801
 13802     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13803           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13804                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13805
 13806     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13807         MOVE ER-2687             TO WS-ERROR
 13808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13809         MOVE 'Z000'              TO PB-I-MORT-CODE
 13810         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13811         GO TO 3300-CHECK-AH-RATES.
 13812
 13813     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13814        IF PB-I-LIVES = ZERO
 13815           MOVE ER-2688          TO WS-ERROR
 13816           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13817
 13818     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13819
 13820     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13821     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13822     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13823     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13824     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13825     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13826     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13827     MOVE '3'                    TO CP-PROCESS-TYPE.
 13828     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13829     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13830
 13831******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 252
* EL050.cbl
 13832     IF PB-COMPANY-ID EQUAL 'CDL'
 13833         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13834            CP-EARN-AS-NET-PAY)
 13835             IF PB-CERT-EFF-DT GREATER  WS-931231
 13836                 MOVE '1'        TO CP-EARNING-METHOD.
 13837*******
 13838
 13839     MOVE PB-SV-STATE            TO CP-STATE.
 13840     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13841     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13842     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13843     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13844     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13845                                    CP-RATING-BENEFIT-AMT.
 13846     IF CP-STATE-STD-ABBRV = 'OR'
 13847         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13848                                         PB-I-LF-ALT-BENEFIT-AMT.
 13849     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13850     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13851     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13852     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13853     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13854     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13855     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13856     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13857     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13858                                    CP-REMAINING-TERM
 13859                                    CP-LOAN-TERM.
 13860
 13861     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13862         NEXT SENTENCE
 13863     ELSE
 13864         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13865             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13866                                           PB-I-LF-PREMIUM-AMT.
 13867
 13868     IF PB-COMPANY-ID EQUAL 'CSL'
 13869        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13870           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13871                                         PB-I-LF-PREMIUM-AMT.
 13872
 13873     IF PB-COMPANY-ID EQUAL 'NCB'
 13874         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13875            CP-EARN-AS-NET-PAY
 13876             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13877                 PB-I-LF-PREMIUM-AMT.
 13878
 13879     IF (CP-TRUNCATED-LIFE)
 13880        or ((pb-company-id = 'AHL')
 13881           and (pb-i-loan-term > pb-i-lf-term))
 13882        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13883
 13884     IF PB-COMPANY-ID EQUAL 'CRI'
 13885        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13886
 13887     IF CP-TERM-IS-DAYS
 13888         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13889     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 253
* EL050.cbl
 13890         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13891     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13892        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13893        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13894        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13895        IF WS-LF-BEN-CATEGORY = 'D'
 13896           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13897           MOVE PB-I-LIFE-COMMISSION
 13898                                 TO CP-DCC-ACT-COMM
 13899           MOVE WS-LF-BEN-CATEGORY
 13900                                 TO CP-BEN-CATEGORY
 13901        END-IF
 13902        IF (CP-BENEFIT-CD (1:1) = 'P')
 13903           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13904           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13905           add pb-i-ah-premium-amt to cp-original-premium
 13906        END-IF
 13907     END-IF
 13908     IF PB-COMPANY-ID = 'CSL'
 13909         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13910         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13911         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13912
 13913     IF PB-COMPANY-ID = 'CSL'
 13914        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13915
 13916     IF (CP-SPECIAL-CALC-CD = 'H')
 13917        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13918         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13919                                    TO CP-ALTERNATE-BENEFIT
 13920         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13921     if (pb-company-id = 'CID')
 13922        and (ws-lf-earnings-calc = '4')
 13923        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
 13924        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13925        move pb-i-term-type      to cp-pmt-mode
 13926        move pb-i-no-of-payments to cp-no-of-pmts
 13927        move pb-i-ah-benefit-amt to cp-monthly-payment
 13928     end-if
 13929     move ws-net-only-state      to cp-net-only-state
 13930     IF (PB-COMPANY-ID = 'CID')
 13931        AND (WS-LF-EARNINGS-CALC = 'B')
 13932        AND (CP-STATE-STD-ABBRV = 'MN')
 13933        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13934                                 TO CP-ALTERNATE-BENEFIT
 13935        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13936     END-IF
 13937     IF (PB-COMPANY-ID = 'CID')
 13938        AND (WS-LF-EARNINGS-CALC = 'B')
 13939        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13940                                 TO CP-ALTERNATE-BENEFIT
 13941        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13942        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13943*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13944*         pb-i-lf-alt-premium-amt
 13945        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13946        IF WS-LF-BEN-CATEGORY = 'P'
 13947           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 254
* EL050.cbl
 13948        ELSE
 13949           IF WS-LF-BEN-CATEGORY = 'I'
 13950              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13951           END-IF
 13952        END-IF
 13953     END-IF
 13954     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13955     MOVE 'R'                   TO CP-RATE-FILE.
 13956     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13957
 13958     IF CP-ERROR-RATE-NOT-FOUND
 13959        MOVE ER-2641            TO WS-ERROR
 13960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13961        GO TO 3300-CHECK-AH-RATES.
 13962
 13963     IF PB-COMPANY-ID EQUAL 'CRI'
 13964        IF CP-ERROR-NO-LIMITS-CRI
 13965           IF NOT ACCOUNT-LIFE-CHECKED
 13966              MOVE ER-2607      TO WS-ERROR
 13967              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13968
 13969******************************************************************
 13970*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13971*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13972******************************************************************
 13973
 13974* CALC LIFE AGE AT EXPIRATION.
 13975
 13976     COMPUTE WS-AGE-AT-EXPIRE =
 13977          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13978
 13979*    IF PB-STATE = 'CO' OR 'UT'
 13980*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13981*        MOVE 'F'            TO PB-FATAL-FLAG
 13982*        MOVE ER-2709        TO WS-ERROR
 13983*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13984*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13985
 13986*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13987*        MOVE 'X'            TO PB-FATAL-FLAG
 13988*        MOVE ER-2718        TO WS-ERROR
 13989*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13990*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13991
 13992* CALC A & H AGE AT EXPIRATION.
 13993
 13994     COMPUTE WS-AGE-AT-EXPIRE =
 13995          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13996
 13997*    IF PB-STATE = 'CO' OR 'UT'
 13998*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13999*        MOVE 'F'            TO PB-FATAL-FLAG
 14000*        MOVE ER-2709        TO WS-ERROR
 14001*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14002*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14003
 14004*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14005*        MOVE 'X'            TO PB-FATAL-FLAG
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 255
* EL050.cbl
 14006*        MOVE ER-2718        TO WS-ERROR
 14007*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14008*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14009
 14010     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 14011        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14012
 14013     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14014        and (not pb-monthly-cert)
 14015        GO TO 3221-CHECK-ERROR-RATE-OPEN
 14016     end-if
 14017
 14018     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14019        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14020
 14021     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14022         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 14023         MOVE ER-2639        TO WS-ERROR
 14024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14025
 14026
 14027******************************************************************
 14028*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14029******************************************************************
 14030
 14031 PREMIUM-EDITING-IS-BYPASSED.
 14032     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14033        AND (CP-R-MAX-ATT-AGE > +0)
 14034        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14035        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14036           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14037           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14038           MOVE '1'              TO DC-OPTION-CODE
 14039           PERFORM 8500-DATE-CONVERT
 14040                                 THRU 8500-EXIT
 14041           IF NO-CONVERSION-ERROR
 14042              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14043                 MOVE ER-2661       TO WS-ERROR
 14044*                PERFORM 9900-ERROR-FORMAT
 14045*                                THRU 9900-EXIT
 14046              END-IF
 14047           END-IF
 14048        ELSE
 14049           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14050           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14051              MOVE ER-2661       TO WS-ERROR
 14052*             PERFORM 9900-ERROR-FORMAT
 14053*                                THRU 9900-EXIT
 14054           ELSE
 14055              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14056                 MOVE ER-1570    TO WS-ERROR
 14057                 PERFORM 9900-ERROR-FORMAT
 14058                                 THRU 9900-EXIT
 14059              END-IF
 14060           END-IF
 14061        END-IF
 14062        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14063           MOVE PB-I-JOINT-BIRTHDAY
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 256
* EL050.cbl
 14064                                 TO DC-BIN-DATE-1
 14065           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14066           MOVE '1'              TO DC-OPTION-CODE
 14067           PERFORM 8500-DATE-CONVERT
 14068                                 THRU 8500-EXIT
 14069           IF NO-CONVERSION-ERROR
 14070              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14071                 MOVE ER-2661       TO WS-ERROR
 14072*                PERFORM 9900-ERROR-FORMAT
 14073*                                THRU 9900-EXIT
 14074              END-IF
 14075           ELSE
 14076              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14077           END-IF
 14078        ELSE
 14079           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14080             (PB-I-LF-TERM / 12)
 14081           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14082              MOVE ER-2661       TO WS-ERROR
 14083*             PERFORM 9900-ERROR-FORMAT
 14084*                                THRU 9900-EXIT
 14085           ELSE
 14086              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14087                 MOVE ER-1571    TO WS-ERROR
 14088                 PERFORM 9900-ERROR-FORMAT
 14089                                 THRU 9900-EXIT
 14090              END-IF
 14091           END-IF
 14092        END-IF
 14093        IF WS-ERROR = ER-2661
 14094           PERFORM 9900-ERROR-FORMAT
 14095                                 THRU 9900-EXIT
 14096        END-IF
 14097     END-IF
 14098*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14099*       MOVE ER-2661             TO WS-ERROR
 14100*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14101
 14102     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14103        MOVE ER-2662             TO WS-ERROR
 14104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14105
 14106     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14107        MOVE ER-2677             TO WS-ERROR
 14108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14109
 14110     IF CP-ERROR-LOAN-TERM
 14111        MOVE ER-2648             TO WS-ERROR
 14112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14113
 14114 3221-CHECK-ERROR-RATE-OPEN.
 14115
 14116     IF CP-ERROR-RATE-FILE-NOTOPEN
 14117         GO TO 3990-FILES-NOT-OPEN.
 14118
 14119     IF PB-COMPANY-ID NOT = 'DMD'
 14120        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14121     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 257
* EL050.cbl
 14122     .
 14123 3221-CONTINUE.
 14124     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14125                                    WS-DCC-AH-RATE
 14126     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14127        IF WS-LF-BEN-CATEGORY = 'D'
 14128           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14129              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14130        END-IF
 14131     END-IF
 14132     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14133*   X'A4FF' = 12/31/2009
 14134     IF (PB-COMPANY-ID = 'CID')
 14135        AND (WS-LF-EARNINGS-CALC = 'B')
 14136        AND (CP-STATE-STD-ABBRV = 'MN')
 14137        AND (PB-CERT-EFF-DT > X'A4FF')
 14138        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14139     END-IF
 14140     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14141
 14142     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14143     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14144        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14145        AND (PB-I-POLICY-IS-MONTHLY)
 14146        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14147        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14148     END-IF
 14149     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14150     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14151     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14152     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14153     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14154        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14155        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14156        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14157        MOVE ER-2786             TO WS-ERROR
 14158        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14159     END-IF
 14160
 14161     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14162
 14163******************************************************************
 14164*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14165******************************************************************
 14166     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14167        and ((not pb-monthly-cert)
 14168        or (ws-lf-ben-category = 'C'))
 14169        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14170
 14171     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14172        GO TO 3225-CHECK-ALT-LIFE-RATE
 14173     ELSE
 14174       IF PB-I-LF-RATE = ZERO
 14175          MOVE ER-2641          TO WS-ERROR
 14176          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14177
 14178 3225-CHECK-ALT-LIFE-RATE.
 14179
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 258
* EL050.cbl
 14180     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14181        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14182        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14183         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14184
 14185     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14186         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14187             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14188                   OR
 14189              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14190              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14191              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14192             MOVE ER-2720        TO  WS-ERROR
 14193             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14194             GO TO 3225-RATING-CONT
 14195         ELSE
 14196             GO TO 3225-RATING-CONT.
 14197     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14198        AND (AM-GPCD = 01 OR 06 OR 15)
 14199        MOVE ER-2798             TO WS-ERROR
 14200        PERFORM 9900-ERROR-FORMAT
 14201                                 THRU 9900-EXIT
 14202*       GO TO 3225-RATING-CONT
 14203     END-IF
 14204     if (pb-company-id = 'CID')
 14205        and (ws-lf-earnings-calc = 'B')
 14206        and (ws-lf-ben-category = 'P' or 'I')
 14207        and (ws-net-only-state = 'Y')
 14208        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14209*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14210        go to 3225-rating-cont
 14211     end-if
 14212     IF (PB-COMPANY-ID = 'CID')
 14213        AND (WS-LF-EARNINGS-CALC = 'B')
 14214        AND (CP-STATE-STD-ABBRV = 'MN')
 14215        AND (PB-CERT-EFF-DT > X'A4FF')
 14216        GO TO 3225-RATING-CONT
 14217     END-IF
 14218     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14219        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14220           AND (PB-I-POLICY-IS-MONTHLY)
 14221           GO TO 3225-RATING-CONT
 14222        END-IF
 14223     END-IF
 14224
 14225     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14226        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14227        CP-EARN-AS-REG-BALLOON
 14228        NEXT SENTENCE
 14229     ELSE
 14230        MOVE '2'                 TO CP-EARNING-METHOD.
 14231
 14232 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14233
 14234     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14235
 14236     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14237        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 259
* EL050.cbl
 14238        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14239         NEXT SENTENCE
 14240     ELSE
 14241         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14242
 14243     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14244     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14245     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14246                                     CP-RATING-BENEFIT-AMT.
 14247     IF CP-STATE-STD-ABBRV = 'OR'
 14248         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14249                                         PB-I-LF-ALT-BENEFIT-AMT.
 14250     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14251        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14252     END-IF
 14253     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14254     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14255     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14256                                    CP-REMAINING-TERM
 14257                                    CP-LOAN-TERM.
 14258     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14259        ADD +1                   TO CP-ORIGINAL-TERM
 14260                                    CP-REMAINING-TERM
 14261                                    CP-LOAN-TERM.
 14262
 14263     MOVE 'R'                   TO CP-RATE-FILE.
 14264     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14265
 14266     IF CP-ERROR-RATE-NOT-FOUND
 14267         MOVE ER-2641            TO WS-ERROR
 14268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14269         GO TO 3300-CHECK-AH-RATES.
 14270
 14271     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14272     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14273
 14274     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14275         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14276
 14277     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14278                               + PB-I-LF-ALT-BENEFIT-AMT.
 14279
 14280     IF ACCOUNT-LIFE-CHECKED  OR
 14281        PB-POLICY-IS-VOIDED   OR
 14282        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14283        and (not pb-monthly-cert))
 14284        GO TO 3225-CONTINUE.
 14285
 14286     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14287        GO TO 3225-CONTINUE.
 14288
 14289     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14290                             EC-RT-LF-MAX-TOT-BEN
 14291        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14292        MOVE ER-2639       TO WS-ERROR
 14293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14294
 14295 3225-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 260
* EL050.cbl
 14296     IF PB-I-LF-ALT-RATE = ZERO
 14297         MOVE ER-2659            TO WS-ERROR
 14298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299
 14300     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14301        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14302        MOVE ER-2698             TO WS-ERROR
 14303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14304
 14305 3225-RATING-CONT.
 14306
 14307     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14308        and (not pb-monthly-cert)
 14309         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14310         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14311         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14312            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14313            CONTINUE
 14314         ELSE
 14315            MOVE ER-2687         TO WS-ERROR
 14316            PERFORM 9900-ERROR-FORMAT
 14317                                 THRU 9900-EXIT
 14318         END-IF
 14319         GO TO 3290-EDIT-LF-REIN-RATE
 14320     END-IF
 14321
 14322* DMD RATING TEST
 14323     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14324         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14325         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14326         MOVE ER-2687                 TO WS-ERROR
 14327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14328         GO TO 3290-EDIT-LF-REIN-RATE.
 14329
 14330 3230-CLIENT-MORT-CD-SPECIALS.
 14331
 14332     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14333     SET BIN-TO-GREG          TO TRUE.
 14334*    MOVE ' '                 TO DC-OPTION-CODE.
 14335     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14336     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14337
 14338 C-POS-3230-MORT-CD.
 14339     IF PB-COMPANY-ID = 'POS' AND
 14340        PB-SV-CARRIER = '2'
 14341         NEXT SENTENCE
 14342     ELSE
 14343         GO TO C-POS-3240-MORT-CD.
 14344
 14345     IF PB-SV-GROUPING = '030'
 14346        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14347         MOVE '2350' TO PB-I-MORT-CODE
 14348      ELSE
 14349         MOVE '3300' TO PB-I-MORT-CODE.
 14350
 14351
 14352 C-POS-3240-MORT-CD.
 14353     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 261
* EL050.cbl
 14354        PB-SV-CARRIER = '1'
 14355         NEXT SENTENCE
 14356     ELSE
 14357         GO TO 3230-CONTINUE.
 14358
 14359     IF PB-SV-STATE = '45' OR '47'
 14360        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14361         MOVE '5200' TO PB-I-MORT-CODE
 14362     ELSE
 14363         MOVE '8300' TO PB-I-MORT-CODE.
 14364
 14365 3230-CONTINUE.
 14366
 14367     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14368        GO TO 3240-CONTINUE
 14369     END-IF
 14370
 14371     IF PB-CERT-EFF-DT > WS-971231
 14372        GO TO 3240-CONTINUE
 14373     END-IF
 14374
 14375     IF LF-BENEFIT-FOUND AND
 14376        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14377         MOVE 'F250'       TO PB-I-MORT-CODE
 14378     ELSE
 14379         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14380             MOVE '7250'   TO PB-I-MORT-CODE
 14381         ELSE
 14382             MOVE '4251'   TO PB-I-MORT-CODE
 14383         END-IF
 14384     END-IF
 14385
 14386     .
 14387 3240-CONTINUE.
 14388
 14389     IF PB-COMPANY-ID NOT = 'GNL'
 14390         GO TO 3256-CONTINUE.
 14391
 14392     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14393         MOVE 'A300' TO PB-I-MORT-CODE
 14394     ELSE
 14395         MOVE '8350' TO PB-I-MORT-CODE.
 14396
 14397 3256-CONTINUE.
 14398     IF PB-COMPANY-ID NOT = 'ABL'
 14399         GO TO 3260-EDIT-CONTINUE.
 14400
 14401     IF PB-I-LF-TERM GREATER THAN 59
 14402         MOVE 'F550' TO PB-I-MORT-CODE
 14403     ELSE
 14404         MOVE 'E550' TO PB-I-MORT-CODE.
 14405
 14406 3260-EDIT-CONTINUE.
 14407     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14408
 14409 3290-EDIT-LF-REIN-RATE.
 14410     IF LF-REIN-NSP-NOT-USED
 14411         GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 262
* EL050.cbl
 14412
 14413     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14414        GO TO 3290-RATING-CONT.
 14415     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14416     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14417     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14418     MOVE '3'                   TO CP-PROCESS-TYPE.
 14419     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14420
 14421******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14422     IF PB-COMPANY-ID EQUAL 'CDL'
 14423         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14424            CP-EARN-AS-NET-PAY)
 14425             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14426*            MOVE SPACE          TO DC-OPTION-CODE
 14427             SET BIN-TO-GREG     TO TRUE
 14428             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14429***  Y2K PROJ 7744
 14430             IF DC-GREG-DATE-CYMD GREATER 19931231
 14431                 MOVE '1'        TO CP-EARNING-METHOD.
 14432***  Y2K PROJ 7744
 14433*******
 14434
 14435     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14436     MOVE PB-SV-STATE           TO CP-STATE.
 14437     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14438     MOVE ZERO                  TO CP-DEVIATION-CODE
 14439                                   CP-RATE-DEV-PCT.
 14440     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14441     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14442                                   CP-RATING-BENEFIT-AMT.
 14443
 14444************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14445     IF PB-COMPANY-ID EQUAL 'NCB'
 14446         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14447            CP-EARN-AS-NET-PAY
 14448             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14449                 PB-I-LF-PREMIUM-AMT.
 14450************
 14451
 14452     IF CP-STATE-STD-ABBRV = 'OR'
 14453         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14454                                         PB-I-LF-ALT-BENEFIT-AMT.
 14455     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14456     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14457     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14458     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14459     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14460     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14461     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14462     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14463                                   CP-REMAINING-TERM
 14464                                   CP-LOAN-TERM.
 14465     IF CP-TRUNCATED-LIFE
 14466        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14467
 14468     IF CP-TERM-IS-DAYS
 14469         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 263
* EL050.cbl
 14470     ELSE
 14471         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14472
 14473     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14474        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14475     END-IF
 14476     IF PB-COMPANY-ID NOT = 'TIC'
 14477          MOVE ZERO          TO CP-CLASS-CODE.
 14478
 14479     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14480
 14481     MOVE 'R'                   TO CP-RATE-FILE.
 14482     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14483
 14484     IF CP-ERROR-RATE-NOT-FOUND
 14485        IF PB-I-OB
 14486           MOVE ER-2625      TO WS-ERROR
 14487           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14488           GO TO 3299-EDIT-CONTINUE
 14489        ELSE
 14490           MOVE ER-2643      TO WS-ERROR
 14491           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14492           GO TO 3299-EDIT-CONTINUE.
 14493
 14494     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14495
 14496     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14497     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14498
 14499     IF PB-I-LF-REI-RATE = ZERO
 14500         MOVE ER-2643        TO WS-ERROR
 14501         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14502
 14503 3290-CHECK-ALT-REIN-RATE.
 14504
 14505     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14506        GO TO 3290-RATING-CONT.
 14507
 14508     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14509     MOVE '2'                    TO CP-EARNING-METHOD.
 14510     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14511     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14512     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14513     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14514                                     CP-RATING-BENEFIT-AMT.
 14515     IF CP-STATE-STD-ABBRV = 'OR'
 14516         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14517                                         PB-I-LF-ALT-BENEFIT-AMT.
 14518     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14519        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14520     END-IF
 14521     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14522     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14523     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14524                                    CP-REMAINING-TERM
 14525                                    CP-LOAN-TERM.
 14526     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14527        ADD +1                   TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 264
* EL050.cbl
 14528                                    CP-REMAINING-TERM
 14529                                    CP-LOAN-TERM.
 14530
 14531     MOVE 'R'                   TO CP-RATE-FILE.
 14532     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14533
 14534     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14535
 14536     IF PB-I-LF-ALT-REI-RATE = ZERO
 14537         MOVE ER-2643            TO WS-ERROR
 14538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14539
 14540 3290-RATING-CONT.
 14541
 14542     IF PB-I-OB
 14543*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14544        GO TO 3300-CHECK-AH-RATES.
 14545
 14546 3299-EDIT-CONTINUE.
 14547
 14548     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14549         NEXT SENTENCE
 14550     ELSE
 14551         MOVE ER-2620           TO WS-ERROR
 14552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14553
 14554 3300-CHECK-AH-RATES.
 14555     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14556         NEXT SENTENCE
 14557     ELSE
 14558         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14559
 14560     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14561        and (not pb-monthly-cert))
 14562                  or
 14563        ((CF-COMPANY-ID = 'DMD') AND
 14564                (NO-DMD-RATING))
 14565         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14566            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14567            CONTINUE
 14568         ELSE
 14569            MOVE ER-2687         TO WS-ERROR
 14570            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14571         END-IF
 14572         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14573         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14574     END-IF
 14575
 14576     IF PB-I-OB
 14577        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14578
 14579     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14580         MOVE ER-2687             TO WS-ERROR
 14581         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14582         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14583         GO TO 3999-END-EDIT.
 14584
 14585*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 265
* EL050.cbl
 14586     if pb-company-id = 'AHL'
 14587        go to 3300-skip-crit-per
 14588     end-if
 14589     if (pb-i-ah-crit-per not = zeros)
 14590        and (ws-ah-special-calc-cd not = 'C')
 14591        MOVE ER-1572             TO WS-ERROR
 14592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14593        go to 3300-skip-crit-per
 14594     END-IF
 14595     if (pb-company-id = 'DCC' or 'VPP')
 14596        and (am-dcc-product-code not = spaces)
 14597        go to 3300-skip-crit-per
 14598     end-if
 14599     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14600        IF PB-I-AH-CRIT-PER = ZERO
 14601           move ws-ah-max-bens   to pb-i-ah-crit-per
 14602*          MOVE ER-2618       TO WS-ERROR
 14603*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14604*          GO TO 3999-END-EDIT
 14605        END-IF
 14606     END-IF
 14607     if (ws-ah-special-calc-cd = 'C')
 14608        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14609        MOVE ER-1576             TO WS-ERROR
 14610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14611     end-if
 14612
 14613     .
 14614 3300-skip-crit-per.
 14615     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14616     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14617     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14618     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14619     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14620     MOVE PB-SV-STATE            TO CP-STATE.
 14621     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14622     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14623     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14624*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14625     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14626     MOVE '3'                    TO CP-PROCESS-TYPE.
 14627     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14628     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14629                                    CP-RATING-BENEFIT-AMT.
 14630     IF PB-COMPANY-ID = 'CID'
 14631               OR
 14632        CP-STATE-STD-ABBRV = 'OR'
 14633         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14634                                         PB-I-AH-TERM.
 14635     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14636        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14637           AND (PB-I-POLICY-IS-MONTHLY)
 14638           MOVE PB-I-LF-BENEFIT-AMT
 14639                                 TO CP-NET-BENEFIT-AMT
 14640           move pb-i-ah-premium-amt to cp-original-premium
 14641           add pb-i-lf-premium-amt to cp-original-premium
 14642        END-IF
 14643     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 266
* EL050.cbl
 14644     MOVE SPACES                 TO CP-BEN-CATEGORY
 14645     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14646        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14647        EVALUATE TRUE
 14648           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14649              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14650              MOVE PB-I-LF-BENEFIT-AMT
 14651                                 TO CP-RATING-BENEFIT-AMT
 14652              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14653           WHEN WS-AH-BEN-CATEGORY = 'G'
 14654              MOVE PB-I-UNPAID-CASH-PRICE
 14655                                 TO CP-RATING-BENEFIT-AMT
 14656           WHEN WS-AH-BEN-CATEGORY = 'D'
 14657              MOVE WS-AH-PMF-COMM
 14658                                 TO CP-DCC-PMF-COMM
 14659              MOVE PB-I-AH-COMMISSION
 14660                                 TO CP-DCC-ACT-COMM
 14661        END-EVALUATE
 14662     END-IF
 14663     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14664     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14665     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14666     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14667     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14668     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14669     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14670                                    CP-REMAINING-TERM
 14671                                    WS-WORK-TERM.
 14672     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14673
 14674     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14675     SET BIN-TO-GREG             TO TRUE.
 14676*    MOVE ' '                    TO DC-OPTION-CODE.
 14677     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14678     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14679
 14680     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14681     IF NOT VALID-SKIP-CODE
 14682         MOVE ER-2683            TO WS-ERROR
 14683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14684         GO TO 3320-RATE-CONTINUE.
 14685
 14686     IF PB-NO-MONTHS-SKIPPED
 14687         GO TO 3320-RATE-CONTINUE.
 14688
 14689     MOVE SPACE TO NUMBER-OF-MONTHS.
 14690
 14691     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14692         MOVE 'S'                TO SK-MO (6).
 14693     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14694         MOVE 'S'                TO SK-MO (7).
 14695     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14696         MOVE 'S'                TO SK-MO (8).
 14697     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14698         MOVE 'S'                TO SK-MO (9).
 14699     IF PB-I-SKIP-CODE = 'A'
 14700         MOVE 'S'                TO SK-MO (10).
 14701
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 267
* EL050.cbl
 14702     MOVE 1                      TO SUB2.
 14703     MOVE PB-I-AH-TERM           TO SUB3.
 14704     MOVE WS-MONTH               TO SUB1.
 14705     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14706     GO TO 3320-RATE-CONTINUE.
 14707
 14708 3310-GET-SKIP-MO.
 14709     IF SUB1 = 13
 14710         MOVE 1                  TO SUB1.
 14711
 14712     IF SK-MO (SUB1) = 'S'
 14713         SUBTRACT 1 FROM WS-WORK-TERM.
 14714
 14715     ADD 1 TO SUB2
 14716              SUB1.
 14717
 14718 3320-RATE-CONTINUE.
 14719
 14720     IF WS-WORK-TERM = ZERO
 14721         MOVE 1                  TO WS-WORK-TERM.
 14722
 14723     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14724                                    CP-LOAN-TERM.
 14725
 14726     IF PB-COMPANY-ID EQUAL 'DMD'
 14727         NEXT SENTENCE
 14728     ELSE
 14729         MOVE ZERO               TO PB-I-AH-RATE
 14730                                    PB-I-AH-REI-RATE.
 14731
 14732
 14733     IF PB-COMPANY-ID EQUAL 'CRI'
 14734        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14735
 14736     IF PB-COMPANY-ID = 'CSL'
 14737         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14738         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14739         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14740         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14741
 14742     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14743        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14744           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14745              PB-I-RATE-DEV-PCT-LF
 14746        END-IF
 14747        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14748                                 TO CP-ALTERNATE-BENEFIT
 14749        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14750        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14751        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14752     END-IF
 14753*    if ws-clp-state not = spaces
 14754*       move ws-clp-state to cp-state
 14755*    end-if
 14756     IF (PB-COMPANY-ID = 'CID')
 14757        AND (WS-LF-EARNINGS-CALC = 'B')
 14758        AND (CP-STATE-STD-ABBRV = 'MN')
 14759        MOVE 'Y'                 TO CP-AH-BALLOON-SW
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 268
* EL050.cbl
 14760     ELSE
 14761        MOVE ' '                 TO CP-AH-BALLOON-SW
 14762     END-IF
 14763     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14764     MOVE 'R'                   TO CP-RATE-FILE.
 14765     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14766
 14767     IF (CP-ERROR-RATE-NOT-FOUND)
 14768        and (not pb-monthly-cert)
 14769        IF PB-I-OB
 14770           MOVE ER-2624          TO WS-ERROR
 14771           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14772           GO TO 3340-CALCULATE-PREMIUM-AMT
 14773        ELSE
 14774          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14775              NEXT SENTENCE
 14776          ELSE
 14777           MOVE ER-2642          TO WS-ERROR
 14778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14779           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14780
 14781     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14782        CP-ERROR-DIV-BY-ZERO
 14783           MOVE ER-3782          TO WS-ERROR
 14784           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14785
 14786     IF PB-COMPANY-ID EQUAL 'CRI'
 14787        IF CP-ERROR-NO-LIMITS-CRI
 14788           IF NOT ACCOUNT-AH-CHECKED
 14789              MOVE ER-2607          TO WS-ERROR
 14790              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14791
 14792     IF ACCOUNT-AH-CHECKED
 14793        NEXT SENTENCE
 14794     ELSE
 14795       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14796          MOVE ER-2640           TO WS-ERROR
 14797          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14798
 14799     IF PB-COMPANY-ID = 'CRI'
 14800         IF WS-ERROR = ER-2640
 14801             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14802     IF ACCOUNT-AH-CHECKED
 14803        CONTINUE
 14804     ELSE
 14805        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14806           AND (CP-R-MAX-ATT-AGE > +0)
 14807           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14808           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14809              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14810              MOVE PB-I-AH-EXPIRE-DT
 14811                                 TO DC-BIN-DATE-2
 14812              MOVE '1'           TO DC-OPTION-CODE
 14813              PERFORM 8500-DATE-CONVERT
 14814                                 THRU 8500-EXIT
 14815              IF NO-CONVERSION-ERROR
 14816                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14817                    MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 269
* EL050.cbl
 14818*                   PERFORM 9900-ERROR-FORMAT
 14819*                                THRU 9900-EXIT
 14820                 END-IF
 14821              END-IF
 14822           ELSE
 14823              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14824              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14825                 MOVE ER-2661    TO WS-ERROR
 14826*                PERFORM 9900-ERROR-FORMAT
 14827*                                THRU 9900-EXIT
 14828              ELSE
 14829                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14830                    MOVE ER-1570 TO WS-ERROR
 14831                    PERFORM 9900-ERROR-FORMAT
 14832                                 THRU 9900-EXIT
 14833                 END-IF
 14834              END-IF
 14835           END-IF
 14836           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14837              MOVE PB-I-JOINT-BIRTHDAY
 14838                                    TO DC-BIN-DATE-1
 14839              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14840              MOVE '1'              TO DC-OPTION-CODE
 14841              PERFORM 8500-DATE-CONVERT
 14842                                    THRU 8500-EXIT
 14843              IF NO-CONVERSION-ERROR
 14844                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14845                    MOVE ER-2661       TO WS-ERROR
 14846*                   PERFORM 9900-ERROR-FORMAT
 14847*                                   THRU 9900-EXIT
 14848                 END-IF
 14849              END-IF
 14850           ELSE
 14851              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14852                (PB-I-AH-TERM / 12)
 14853              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14854                 MOVE ER-2661       TO WS-ERROR
 14855*                PERFORM 9900-ERROR-FORMAT
 14856*                                   THRU 9900-EXIT
 14857              ELSE
 14858                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14859                    MOVE ER-1571 TO WS-ERROR
 14860                    PERFORM 9900-ERROR-FORMAT
 14861                                 THRU 9900-EXIT
 14862                 END-IF
 14863              END-IF
 14864           END-IF
 14865           IF WS-ERROR = ER-2661
 14866              PERFORM 9900-ERROR-FORMAT
 14867                                    THRU 9900-EXIT
 14868           END-IF
 14869        END-IF
 14870     END-IF
 14871*    IF ACCOUNT-AH-CHECKED
 14872*       NEXT SENTENCE
 14873*    ELSE
 14874*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14875*          MOVE ER-2661          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 270
* EL050.cbl
 14876*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14877
 14878     IF ACCOUNT-AH-CHECKED
 14879        NEXT SENTENCE
 14880     ELSE
 14881        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14882           MOVE ER-2663          TO WS-ERROR
 14883           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14884
 14885     IF ACCOUNT-AH-CHECKED OR
 14886        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14887         PB-POLICY-IS-VOIDED
 14888        NEXT SENTENCE
 14889     ELSE
 14890        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14891           MOVE ER-2667            TO WS-ERROR
 14892           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14893
 14894     IF PB-COMPANY-ID = 'CRI'
 14895         IF WS-ERROR = ER-2667
 14896             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14897
 14898     IF ACCOUNT-AH-CHECKED
 14899        NEXT SENTENCE
 14900     ELSE
 14901        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14902           MOVE ER-2678            TO WS-ERROR
 14903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14904
 14905     IF CP-ERROR-RATE-FILE-NOTOPEN
 14906         GO TO 3990-FILES-NOT-OPEN.
 14907
 14908 3321-CONTINUE.
 14909     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14910     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14911     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14912*    IF (PB-COMPANY-ID = 'DCC')
 14913        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14914        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14915                                    PB-I-LF-ALT-PREM-CALC
 14916        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14917        IF WS-AH-BEN-CATEGORY = 'G'
 14918           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14919           + PB-I-ADDL-CLP)
 14920           * (1 + WS-TOL-CLP-PCT)
 14921*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14922        ELSE
 14923           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14924           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14925*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14926        END-IF
 14927        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14928                                 TO PB-I-AH-PREM-CALC
 14929        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14930           MOVE ER-8152          TO WS-ERROR
 14931           PERFORM 9900-ERROR-FORMAT
 14932                                 THRU 9900-EXIT
 14933        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 271
* EL050.cbl
 14934           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14935                 PB-I-ADDL-CLP)
 14936              MOVE ER-8148       TO WS-ERROR
 14937              PERFORM 9900-ERROR-FORMAT
 14938                                 THRU 9900-EXIT
 14939           END-IF
 14940        END-IF
 14941     END-IF
 14942     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14943        AND (PB-I-POLICY-IS-MONTHLY)
 14944        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14945        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14946        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14947           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14948        END-IF
 14949     END-IF
 14950     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14951        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14952        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14953        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14954        MOVE ER-2786             TO WS-ERROR
 14955        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14956     END-IF
 14957     MOVE +0                     TO PB-I-AH-CLP
 14958     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14959        evaluate true
 14960           when WS-AH-BEN-CATEGORY = 'D'
 14961              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14962                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14963           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14964              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14965           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14966              compute ws-cred-union-fees rounded =
 14967                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14968                    pb-i-ah-commission)
 14969              COMPUTE PB-I-AH-CLP =
 14970                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14971        end-evaluate
 14972     END-IF
 14973     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14974
 14975     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14976         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14977
 14978     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14979         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14980
 14981     if (ws-ah-special-calc-cd = 'E')
 14982        and (pb-monthly-cert)
 14983        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14984     end-if
 14985     IF PB-COMPANY-ID = 'CRI'
 14986         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14987            PB-I-PAYMENT-AMOUNT = ZERO
 14988             NEXT SENTENCE
 14989         ELSE
 14990             COMPUTE PB-I-AH-PREM-CALC =
 14991                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 272
* EL050.cbl
 14992                 (CP-PREMIUM-RATE / 100)
 14993             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14994                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14995                                             PB-I-RATE-DEV-PCT-AH.
 14996
 14997     IF (PB-I-AH-RATE  = ZERO)
 14998        and (not pb-monthly-cert)
 14999       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15000           NEXT SENTENCE
 15001       ELSE
 15002         MOVE ER-2642            TO WS-ERROR
 15003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15004
 15005     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 15006     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 15007     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 15008     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 15009     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 15010     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 15011
 15012     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15013        AND (WS-AH-BEN-CATEGORY = 'G')
 15014        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15015        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 15016        IF CP-DEVIATION-CODE NOT = '000'
 15017           MOVE '000'            TO CP-DEVIATION-CODE
 15018           PERFORM 7000-GET-RATE THRU 7000-EXIT
 15019           IF NO-CP-ERROR
 15020              COMPUTE PB-I-DDF-IU-RATE-UP =
 15021              PB-I-AH-CLP - CP-CALC-PREMIUM
 15022           ELSE
 15023              MOVE ER-3057        TO WS-ERROR
 15024              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15025           END-IF
 15026        END-IF
 15027     END-IF
 15028     .
 15029 3335-EDIT-AH-REIN-NSP-RATE.
 15030     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15031        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15032              compute ws-cred-union-fees rounded =
 15033                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15034                    pb-i-ah-commission)
 15035              COMPUTE PB-I-AH-CLP =
 15036                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15037        end-if
 15038     END-IF
 15039     IF AH-REIN-NSP-NOT-USED
 15040         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15041
 15042     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15043     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15044         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15045     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15046     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15047     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15048     MOVE PB-SV-STATE            TO CP-STATE.
 15049     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 273
* EL050.cbl
 15050     MOVE ZERO                   TO CP-DEVIATION-CODE
 15051                                    CP-RATE-DEV-PCT.
 15052*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15053     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15054     MOVE '3'                    TO CP-PROCESS-TYPE.
 15055     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15056     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15057                                    CP-RATING-BENEFIT-AMT.
 15058     IF CP-STATE-STD-ABBRV = 'OR'
 15059         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15060                                         PB-I-AH-TERM.
 15061     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 15062     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15063     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15064     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15065     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15066     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15067                                    CP-REMAINING-TERM
 15068                                    WS-WORK-TERM.
 15069     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15070     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15071        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15072     END-IF
 15073     IF  PB-COMPANY-ID = 'TIC'
 15074         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15075            MOVE ZERO TO CP-CLASS-CODE.
 15076
 15077     IF PB-COMPANY-ID NOT = 'TIC'
 15078          MOVE ZERO          TO CP-CLASS-CODE.
 15079
 15080     MOVE ZERO               TO CP-DEVIATION-CODE.
 15081
 15082     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15083
 15084     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15085
 15086     MOVE 'R'                   TO CP-RATE-FILE.
 15087     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15088
 15089     IF CP-ERROR-RATE-NOT-FOUND
 15090         MOVE ER-2645        TO WS-ERROR
 15091         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15092         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15093
 15094     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15095
 15096     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15097     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15098
 15099     IF PB-I-AH-REI-RATE = ZERO
 15100         MOVE ER-2645        TO WS-ERROR
 15101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15102
 15103
 15104 3340-CALCULATE-PREMIUM-AMT.
 15105     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15106     SET BIN-TO-GREG             TO TRUE
 15107     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 274
* EL050.cbl
 15108     move dc-greg-date-a-edit    to ws-greg-eff-date
 15109
 15110     IF PB-COMPANY-ID = 'NCL'
 15111         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15112             WS-AH-SPECIAL-CALC-CD = 'O')
 15113             GO TO 3999-END-EDIT.
 15114
 15115     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15116                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15117                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15118                         OR 'AHL'
 15119         NEXT SENTENCE
 15120     ELSE
 15121         IF WS-STATE-ABBREVIATION = 'CT'
 15122             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15123                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15124                 COMPUTE PB-I-LF-PREM-CALC =
 15125                                     PB-I-LF-PREM-CALC * .90
 15126                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15127                                     PB-I-LF-ALT-PREM-CALC * .90
 15128                 COMPUTE PB-I-AH-PREM-CALC =
 15129                                     PB-I-AH-PREM-CALC * .90.
 15130
 15131     IF PB-COMP-LF-PREM
 15132        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15133        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15134
 15135     IF PB-COMP-AH-PREM
 15136        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15137
 15138 3340-CHECK-DCC-TOT-FEES.
 15139     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15140        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15141        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15142        AND (PB-I-POLICY-IS-MONTHLY)
 15143        CONTINUE
 15144     ELSE
 15145        GO TO 3340-EDIT-LF-AH-TOL
 15146     END-IF
 15147     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15148     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15149     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15150        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15151           PB-I-RATE-DEV-PCT-LF
 15152     END-IF
 15153     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15154        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15155           PB-I-RATE-DEV-PCT-AH
 15156     END-IF
 15157     MOVE 'N'                    TO CP-BEN-CATEGORY
 15158     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15159
 15160     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15161     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15162     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15163     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15164     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15165     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 275
* EL050.cbl
 15166     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15167     MOVE '3'                    TO CP-PROCESS-TYPE.
 15168     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15169     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15170
 15171     MOVE PB-SV-STATE            TO CP-STATE.
 15172     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15173     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15174     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15175     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15176     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15177                                    CP-RATING-BENEFIT-AMT.
 15178     IF CP-STATE-STD-ABBRV = 'OR'
 15179         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15180                                         PB-I-LF-ALT-BENEFIT-AMT.
 15181     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15182     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15183     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15184     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15185     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15186     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15187     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15188     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15189     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15190                                    CP-REMAINING-TERM
 15191                                    CP-LOAN-TERM.
 15192     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15193        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15194           PB-I-LF-PREMIUM-AMT
 15195     end-if
 15196
 15197     IF CP-TRUNCATED-LIFE
 15198        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15199
 15200     IF CP-TERM-IS-DAYS
 15201         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15202     ELSE
 15203         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15204
 15205     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15206     IF CP-SPECIAL-CALC-CD = 'H'
 15207         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15208                                    TO CP-ALTERNATE-BENEFIT
 15209         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15210     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15211     MOVE 'R'                    TO CP-RATE-FILE
 15212     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15213     IF NOT CP-ERROR-RATE-NOT-FOUND
 15214        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15215        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15216           AND (CP-BENEFIT-CD (1:1) = 'S')
 15217           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15218                                    PB-I-LF-PREMIUM-AMT
 15219        END-IF
 15220     ELSE
 15221        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15222     END-IF
 15223     .
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 276
* EL050.cbl
 15224 3340-EDIT-LF-AH-TOL.
 15225
 15226***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15227***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15228***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15229***
 15230     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15231         PB-I-AH-PREMIUM-AMT
 15232          GIVING WS-CALC-WORK.
 15233
 15234     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15235        AND WS-CALC-WORK NOT = ZERO
 15236         MOVE ER-2649            TO WS-ERROR
 15237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15238
 15239     SUBTRACT PB-I-LF-PREM-CALC
 15240             FROM PB-I-LF-PREMIUM-AMT
 15241                 GIVING WS-UNSIGN-WRK1.
 15242
 15243     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15244             FROM PB-I-LF-ALT-PREMIUM-AMT
 15245                 GIVING WS-UNSIGN-WRK4.
 15246
 15247     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15248                                + WS-UNSIGN-WRK4.
 15249
 15250     SUBTRACT PB-I-AH-PREM-CALC
 15251             FROM PB-I-AH-PREMIUM-AMT
 15252                 GIVING WS-UNSIGN-WRK2.
 15253
 15254******************************************************************
 15255*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15256******************************************************************
 15257
 15258     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15259         MOVE ZERO TO WS-UNSIGN-WRK1.
 15260
 15261     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15262         MOVE ZERO TO WS-UNSIGN-WRK2.
 15263
 15264     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15265             GIVING WS-UNSIGN-WRK3.
 15266
 15267 3342-CONTINUE.
 15268
 15269     IF (PB-I-LF-RATE = ZERO  AND
 15270         PB-I-AH-RATE = ZERO)
 15271         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15272            WS-AH-SPECIAL-CALC-CD = 'O'
 15273              NEXT SENTENCE
 15274         ELSE
 15275             GO TO 3345-EDIT-CONTINUE.
 15276
 15277     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15278         NEXT SENTENCE
 15279     ELSE
 15280     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15281        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 277
* EL050.cbl
 15282           IF (PB-REISSUED-CERT         OR
 15283               PB-POLICY-IS-DECLINED    OR
 15284               PB-POLICY-IS-VOIDED)
 15285              NEXT SENTENCE
 15286           ELSE
 15287              IF WS-PREM-REJECT-SW = SPACE
 15288                 MOVE ER-2652    TO WS-ERROR
 15289                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15290                 GO TO 3344-CHECK-AH
 15291              ELSE
 15292                 MOVE ER-2650    TO WS-ERROR
 15293                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15294                 GO TO 3344-CHECK-AH.
 15295
 15296***
 15297***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15298***
 15299
 15300     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15301         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15302            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15303             (1 + WS-TOL-LF-PREM-PCT)
 15304         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15305            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15306             (1 - WS-TOL-LF-PREM-PCT)
 15307     ELSE
 15308         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15309         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15310
 15311***
 15312***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15313***
 15314
 15315     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15316         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15317          WS-TOL-LF-PREM.
 15318
 15319     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15320         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15321          WS-TOL-LF-PREM.
 15322
 15323     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15324        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15325
 15326     IF PB-REISSUED-CERT
 15327        or PB-POLICY-IS-DECLINED
 15328        or PB-POLICY-IS-VOIDED
 15329        continue
 15330     ELSE
 15331        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15332              > WS-TOL-LF-HIGH-PREM-AMT)
 15333           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15334              < WS-TOL-LF-LOW-PREM-AMT))
 15335                      or
 15336           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15337              > WS-TOL-LF-HIGH-PREM-PCT)
 15338           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15339              < WS-TOL-LF-LOW-PREM-PCT))
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 278
* EL050.cbl
 15340           IF WS-PREM-REJECT-SW = SPACE
 15341              MOVE ER-2652       TO WS-ERROR
 15342              PERFORM 9900-ERROR-FORMAT
 15343                                 THRU 9900-EXIT
 15344           ELSE
 15345              MOVE ER-2650       TO WS-ERROR
 15346              PERFORM 9900-ERROR-FORMAT
 15347                                 THRU 9900-EXIT
 15348           end-if
 15349        end-if
 15350     end-if
 15351
 15352*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15353*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15354*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15355*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15356
 15357     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15358        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15359                      OR
 15360           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15361           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15362           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15363           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15364        END-IF
 15365     END-IF
 15366
 15367     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15368        IF WS-COMP-MAX-CAP GREATER THAN +0
 15369           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15370              IF (PB-REISSUED-CERT         OR
 15371                  PB-POLICY-IS-DECLINED    OR
 15372                  PB-POLICY-IS-VOIDED)
 15373                 NEXT SENTENCE
 15374              ELSE
 15375                  MOVE ER-2646   TO  WS-ERROR
 15376                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15377
 15378 3344-CVL-TOLERANCE-CHECK.
 15379
 15380      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15381          GO TO 3344-CHECK-AH.
 15382
 15383      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15384          GO TO 3344-CHECK-AH.
 15385
 15386      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15387                                     WS-UNSIGN-WRK6.
 15388
 15389      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15390          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15391                                 + PB-I-LF-PREMIUM-AMT
 15392                                 - PB-I-LF-PREM-CALC.
 15393
 15394      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15395          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15396                                 + PB-I-LF-ALT-PREMIUM-AMT
 15397                                 - PB-I-LF-ALT-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 279
* EL050.cbl
 15398
 15399      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15400          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15401              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15402                 MOVE ER-2652    TO  WS-ERROR
 15403                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15404              ELSE
 15405                 MOVE ER-2650    TO  WS-ERROR
 15406                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15407
 15408      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15409          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15410              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15411                 MOVE ER-2652    TO  WS-ERROR
 15412                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15413              ELSE
 15414                 MOVE ER-2650    TO  WS-ERROR
 15415                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15416
 15417 3344-CHECK-AH.
 15418
 15419****************************************************************
 15420***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15421***
 15422
 15423     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15424         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15425             (1 + WS-TOL-AH-PREM-PCT)
 15426         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15427             (1 - WS-TOL-AH-PREM-PCT)
 15428     ELSE
 15429         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15430         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15431
 15432***
 15433***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15434***
 15435
 15436     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15437         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15438
 15439     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15440         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15441
 15442     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15443        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15444
 15445     IF (PB-REISSUED-CERT)
 15446        OR (PB-POLICY-IS-DECLINED)
 15447        OR (PB-POLICY-IS-VOIDED)
 15448        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15449        CONTINUE
 15450     ELSE
 15451        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15452              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15453                          or
 15454           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15455              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 280
* EL050.cbl
 15456           IF WS-PREM-REJECT-SW = SPACE
 15457              MOVE ER-3052       TO WS-ERROR
 15458              PERFORM 9900-ERROR-FORMAT
 15459                                 THRU 9900-EXIT
 15460           ELSE
 15461              MOVE ER-3050       TO WS-ERROR
 15462              PERFORM 9900-ERROR-FORMAT
 15463                                 THRU 9900-EXIT
 15464           END-IF
 15465        END-IF
 15466     END-IF
 15467     if (pb-company-id = 'DCC' or 'VPP')
 15468        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15469        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15470        and (pb-i-policy-is-monthly)
 15471        compute ws-tol-ah-high-prem-amt =
 15472           pb-i-tot-fees-calc + ws-tol-ah-prem
 15473        compute ws-tol-ah-low-prem-amt =
 15474           pb-i-tot-fees-calc - ws-tol-ah-prem
 15475        if ws-tol-ah-prem-pct > zeros
 15476           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15477              (1 + ws-tol-ah-prem-pct)
 15478           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15479              (1 - ws-tol-ah-prem-pct)
 15480        else
 15481           move +9999999.99      to ws-tol-ah-high-prem-pct
 15482           move +0               to ws-tol-ah-low-prem-pct
 15483        end-if
 15484        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15485            or
 15486           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15487                          or
 15488           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15489           or
 15490           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15491            move er-3049         to ws-error
 15492           perform 9900-error-format
 15493                                 thru 9900-exit
 15494
 15495        end-if
 15496     end-if
 15497     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15498         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15499             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15500             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15501
 15502     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15503        IF WS-COMP-MAX-CAP GREATER THAN +0
 15504           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15505              IF (PB-REISSUED-CERT         OR
 15506                  PB-POLICY-IS-DECLINED    OR
 15507                  PB-POLICY-IS-VOIDED)
 15508                 NEXT SENTENCE
 15509              ELSE
 15510                  MOVE ER-2646   TO  WS-ERROR
 15511                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15512
 15513     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 281
* EL050.cbl
 15514        (WS-COMP-MAX-CAP EQUAL +0)
 15515           GO TO 3345-EDIT-CONTINUE.
 15516
 15517     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15518        GREATER THAN WS-COMP-MAX-CAP
 15519           MOVE ER-2646          TO  WS-ERROR
 15520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15521
 15522 3345-EDIT-CONTINUE.
 15523
 15524*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15525*       IF PB-ENTRY-BATCH   NUMERIC
 15526*          IF PB-ISSUE
 15527*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15528*          ELSE
 15529*              IF PB-CANCELLATION
 15530*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15531
 15532*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15533*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15534*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15535*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15536*        ELSE
 15537*            MOVE  ER-1909            TO  WS-ERROR
 15538*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15539
 15540     IF PB-I-POLICY-ACCEPTED
 15541        IF PB-POLICY-IS-DECLINED  OR
 15542           PB-REISSUED-CERT  OR
 15543           PB-REIN-ONLY-CERT  OR
 15544           PB-POLICY-IS-VOIDED
 15545            MOVE  ER-1891         TO  WS-ERROR
 15546            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15547        ELSE
 15548            MOVE SPACE            TO  PB-BATCH-ENTRY
 15549            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15550
 15551     IF PB-I-POLICY-DECLINED
 15552        IF PB-REISSUED-CERT  OR
 15553           PB-REIN-ONLY-CERT  OR
 15554           PB-POLICY-IS-VOIDED
 15555            MOVE  ER-1906         TO  WS-ERROR
 15556            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15557        ELSE
 15558            MOVE  'D'             TO  PB-BATCH-ENTRY
 15559                                      PB-I-ENTRY-STATUS.
 15560
 15561     IF PB-I-NEEDS-UNDERWRITING
 15562        IF PB-POLICY-IS-DECLINED OR
 15563           PB-REISSUED-CERT  OR
 15564           PB-REIN-ONLY-CERT  OR
 15565           PB-POLICY-IS-VOIDED
 15566            MOVE  ER-1907         TO  WS-ERROR
 15567            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15568        ELSE
 15569            MOVE 'U'              TO  PB-BATCH-ENTRY
 15570                                      PB-I-ENTRY-STATUS.
 15571
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 282
* EL050.cbl
 15572     IF PB-NEEDS-UNDERWRITING
 15573        MOVE  ER-1901             TO  WS-ERROR
 15574        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15575     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15576        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15577        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15578        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15579           AND (NOT WS-LF-CASH))
 15580                           OR
 15581           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15582           AND (NOT WS-AH-CASH)))
 15583                       AND
 15584           (PB-I-ENTRY-STATUS NOT = '5')
 15585           MOVE 'M'              TO PB-BATCH-ENTRY
 15586                                    PB-I-ENTRY-STATUS
 15587        END-IF
 15588     END-IF
 15589     move pending-business       to ws-passed-erpndb
 15590     move ' '                    to ws-exceed-limit-yn
 15591     perform 7780-call-agg       thru 7780-exit
 15592*    display ' el050 exceed ' ws-exceed-limit-yn
 15593     if ws-exceed-limit-yn = 'Y'
 15594        MOVE  ER-9813            TO WS-ERROR
 15595        move 'Y'                 to ws-9813-sw
 15596        PERFORM  9900-ERROR-FORMAT
 15597                                 THRU 9900-EXIT
 15598     end-if
 15599     if (PB-EXCEEDED-LIMIT-FORCED)
 15600        and (ws-9813-sw = 'Y')
 15601        subtract +1 from PB-NO-OF-ERRORS
 15602        move er-9823             to ws-error
 15603        PERFORM  9900-ERROR-FORMAT
 15604                                 THRU 9900-EXIT
 15605     end-if
 15606     IF  PB-COMPANY-ID NOT = 'NCL'
 15607         GO TO 3999-END-EDIT.
 15608
 15609     IF PB-REISSUED-CERT  OR
 15610        PB-POLICY-IS-DECLINED  OR
 15611        PB-POLICY-IS-VOIDED  OR
 15612        PB-I-OB
 15613         GO TO 3999-END-EDIT.
 15614
 15615     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15616         MOVE  ER-2644            TO  WS-ERROR
 15617         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15618         GO TO 3999-END-EDIT.
 15619
 15620     MOVE 'N'                     TO  FORM-MASTER-SW.
 15621     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15622
 15623     IF NOT FORM-MASTER-FOUND
 15624         GO TO 3999-END-EDIT.
 15625
 15626     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15627                                      FORM-MASTER-AH-SW.
 15628
 15629     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 283
* EL050.cbl
 15630         MOVE  +1                 TO SUB6
 15631         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15632
 15633     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15634         MOVE  +1                 TO SUB6
 15635         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15636
 15637     IF LF-FORM-MASTER-FOUND  OR
 15638        AH-FORM-MASTER-FOUND
 15639         GO TO 3360-CHECK-FORM-LIMITS
 15640     ELSE
 15641         GO TO 3999-END-EDIT.
 15642
 15643******************************************************************
 15644*                  3350-GET-ERFORM                               *
 15645*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15646*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15647******************************************************************
 15648
 15649 3350-GET-ERFORM.
 15650
 15651     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15652         GO TO  3350-ERFORM-GETMAIN.
 15653
 15654     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15655     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15656     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15657     MOVE 'Y'                     TO FORM-MASTER-SW.
 15658
 15659     IF PB-CANCELLATION
 15660         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15661            PB-SV-STATE          EQUAL   FO-STATE       AND
 15662            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15663              GO TO 3350-EXIT
 15664         ELSE
 15665             NEXT SENTENCE
 15666     ELSE
 15667         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15668            PB-SV-STATE          EQUAL   FO-STATE       AND
 15669            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15670              GO TO 3350-EXIT.
 15671
 15672 3350-ERFORM-GETMAIN.
 15673
 15674     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15675     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15676
 15677 3350-ERFORM-READ.
 15678
 15679     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15680     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15681     IF PB-CANCELLATION
 15682         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15683     ELSE
 15684         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15685     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15686
 15687     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 284
* EL050.cbl
 15688
 15689     IF FORM-MASTER-FOUND
 15690       IF PB-CANCELLATION
 15691          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15692             PB-SV-STATE          EQUAL   FO-STATE       AND
 15693             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15694              GO  TO 3350-EXIT
 15695          ELSE
 15696              NEXT SENTENCE
 15697       ELSE
 15698          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15699             PB-SV-STATE          EQUAL   FO-STATE       AND
 15700             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15701              GO  TO 3350-EXIT.
 15702
 15703     MOVE  'N'                    TO  FORM-MASTER-SW.
 15704     MOVE  ER-1895                TO  WS-ERROR.
 15705     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15706
 15707 3350-EXIT.
 15708      EXIT.
 15709
 15710******************************************************************
 15711*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15712*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15713*   VALID FOR THE POLICY FORM USED.                              *
 15714******************************************************************
 15715
 15716 3355-EDIT-FORM-LF-BENEFITS.
 15717
 15718     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15719        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15720         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15721         GO TO   3355-EXIT.
 15722
 15723     IF  SUB6    LESS THAN   +40
 15724         ADD  +1      TO  SUB6
 15725         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15726
 15727     MOVE  ER-1896         TO  WS-ERROR.
 15728     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15729
 15730 3355-EXIT.
 15731      EXIT.
 15732
 15733******************************************************************
 15734*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15735*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15736*   VALID FOR THE POLICY FORM USED.                              *
 15737******************************************************************
 15738
 15739 3356-EDIT-FORM-AH-BENEFITS.
 15740
 15741     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15742        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15743         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15744         GO TO  3356-EXIT.
 15745
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 285
* EL050.cbl
 15746      IF  SUB6    LESS THAN     +40
 15747          ADD  +1      TO  SUB6
 15748          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15749
 15750     MOVE  ER-1897         TO  WS-ERROR.
 15751     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15752
 15753 3356-EXIT.
 15754      EXIT.
 15755
 15756******************************************************************
 15757*                  3357-BENEFIT-SEARCH                           *
 15758*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15759*   CANCELLATIONS ONLY.                                          *
 15760******************************************************************
 15761 3357-BENEFIT-SEARCH.
 15762     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15763         MOVE +1                          TO SUB6
 15764         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15765
 15766     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15767         MOVE +1                          TO SUB6
 15768         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15769
 15770 3357-EXIT.
 15771     EXIT.
 15772
 15773******************************************************************
 15774*                  3358-BENEFIT-LIFE-SEARCH                      *
 15775*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15776*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15777*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15778******************************************************************
 15779 3358-BENEFIT-LIFE-SEARCH.
 15780     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15781       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15782         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15783           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15784              IF FO-PLAN-REFUND-METHOD (SUB6)
 15785                     IS GREATER THAN SPACES
 15786                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15787                                          WS-LF-REFUND-CALC
 15788                 GO TO 3358-EXIT.
 15789
 15790     IF SUB6 LESS THAN +40
 15791         ADD +1                 TO SUB6
 15792         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15793
 15794 3358-EXIT.
 15795     EXIT.
 15796******************************************************************
 15797*                  3359-BENEFIT-AH-SEARCH                        *
 15798*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15799*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15800*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15801******************************************************************
 15802 3359-BENEFIT-AH-SEARCH.
 15803     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 286
* EL050.cbl
 15804       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15805         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15806           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15807              IF FO-PLAN-REFUND-METHOD (SUB6)
 15808                      IS GREATER THAN SPACES
 15809                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15810                                          WS-AH-REFUND-CALC
 15811                 GO TO 3359-EXIT.
 15812
 15813     IF SUB6 LESS THAN +40
 15814         ADD +1                 TO SUB6
 15815         GO TO 3359-BENEFIT-AH-SEARCH.
 15816
 15817 3359-EXIT.
 15818     EXIT.
 15819
 15820******************************************************************
 15821*                  3360-CHECK-FORM-LIMITS                        *
 15822*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15823*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15824******************************************************************
 15825
 15826 3360-CHECK-FORM-LIMITS.
 15827
 15828     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15829         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15830
 15831     IF NOT LF-FORM-MASTER-FOUND
 15832         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15833
 15834 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15835
 15836     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15837       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15838        WS-LF-JOINT-INDICATOR = 'J'  AND
 15839        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15840         IF PB-COMPANY-ID = 'NCL'
 15841            MOVE  ER-1911          TO  WS-ERROR
 15842            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15843         ELSE
 15844            MOVE  ER-1892          TO  WS-ERROR
 15845            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15846
 15847 3360-CHECK-FORM-LF-ATT-AGE.
 15848
 15849     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15850
 15851     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15852         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15853         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15854            IF PB-COMPANY-ID = 'NCL'
 15855                MOVE  ER-1913      TO  WS-ERROR
 15856                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15857            ELSE
 15858                MOVE  ER-1894      TO  WS-ERROR
 15859                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15860
 15861 3360-CHECK-FORM-LF-MAX-ISS-AGE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 287
* EL050.cbl
 15862
 15863     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15864         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15865         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15866            IF PB-COMPANY-ID = 'NCL'
 15867                MOVE  ER-1914      TO  WS-ERROR
 15868                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15869            ELSE
 15870                MOVE  ER-1899      TO  WS-ERROR
 15871                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15872
 15873 3360-CHECK-FORM-LF-TERM-BAMT.
 15874
 15875     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15876         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15877         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15878           IF  PB-COMPANY-ID = 'NCL'
 15879               MOVE  ER-1916       TO  WS-ERROR
 15880               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15881           ELSE
 15882               MOVE  ER-1902       TO  WS-ERROR
 15883               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15884
 15885     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15886                                    PB-I-LF-ALT-BENEFIT-AMT.
 15887
 15888     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15889         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15890         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15891             IF  PB-COMPANY-ID = 'NCL'
 15892                 MOVE  ER-1918     TO  WS-ERROR
 15893                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15894             ELSE
 15895                 MOVE  ER-1904     TO  WS-ERROR
 15896                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15897
 15898******************************************************************
 15899*                  3360-CHECK-FORM-AH-LIMITS                     *
 15900*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15901*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15902******************************************************************
 15903
 15904 3360-CHECK-FORM-AH-LIMITS.
 15905
 15906     IF NOT AH-FORM-MASTER-FOUND
 15907         GO TO 3999-END-EDIT.
 15908
 15909 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15910
 15911     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15912       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15913        WS-AH-JOINT-INDICATOR = 'J'  AND
 15914        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15915         IF PB-COMPANY-ID = 'NCL'
 15916            MOVE  ER-1912          TO  WS-ERROR
 15917            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15918         ELSE
 15919            MOVE  ER-1893          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 288
* EL050.cbl
 15920            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15921
 15922 3360-CHECK-FORM-AH-ATT-AGE.
 15923
 15924     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15925
 15926     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15927         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15928         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15929            IF PB-COMPANY-ID = 'NCL'
 15930                MOVE  ER-1913      TO  WS-ERROR
 15931                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15932            ELSE
 15933                MOVE  ER-1894      TO  WS-ERROR
 15934                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15935
 15936 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15937
 15938     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15939         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15940         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15941            IF PB-COMPANY-ID = 'NCL'
 15942                MOVE  ER-1915      TO  WS-ERROR
 15943                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15944            ELSE
 15945                MOVE  ER-1900      TO  WS-ERROR
 15946                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15947
 15948 3360-CHECK-FORM-AH-TERM-BAMT.
 15949
 15950     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15951         FO-AH-MAX-TERM    GREATER THAN  +0
 15952         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15953             IF  PB-COMPANY-ID = 'NCL'
 15954                 MOVE  ER-1917     TO  WS-ERROR
 15955                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15956             ELSE
 15957                  MOVE  ER-1903    TO  WS-ERROR
 15958                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15959
 15960     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15961         FO-MAX-AH-AMT    GREATER THAN  +0
 15962         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15963             IF  PB-COMPANY-ID = 'NCL'
 15964                 MOVE  ER-1919     TO  WS-ERROR
 15965                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15966             ELSE
 15967                 MOVE  ER-1905     TO  WS-ERROR
 15968                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15969
 15970     GO TO 3999-END-EDIT.
 15971
 15972******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 289
* EL050.cbl
 15974 3400-edit-vin.
 15975
 15976     move spaces                 to hldi-pass-area
 15977     MOVE PB-I-VIN               TO WS-WORK-VIN
 15978     MOVE +8                     TO V2
 15979     MOVE ZEROS                  TO WS-VIN-TOTAL
 15980     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15981      (V1 > 17)
 15982        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15983           MOVE ER-3825          TO WS-ERROR
 15984           PERFORM 9900-ERROR-FORMAT
 15985                                 THRU 9900-EXIT
 15986        ELSE
 15987           IF V1 = 8
 15988              MOVE 10            TO V2
 15989           END-IF
 15990           IF V1 = 9
 15991              MOVE 0             TO V2
 15992           END-IF
 15993           IF V1 = 10
 15994              MOVE 9             TO V2
 15995           END-IF
 15996           IF WS-WORK-VIN (V1:1) NUMERIC
 15997              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15998               + (WS-WORK-VIN-N (V1) * V2)
 15999           ELSE
 16000              MOVE WS-WORK-VIN (V1:1)
 16001                            TO WS-HEX-BYTE
 16002              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 16003              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16004               + (WS-NUM (V3) * V2)
 16005           END-IF
 16006           COMPUTE V2 = V2 - 1
 16007        END-IF
 16008     END-PERFORM
 16009     MOVE ZEROS                  TO WS-VIN-REMAINDER
 16010     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 16011        REMAINDER WS-VIN-REMAINDER
 16012     IF ((WS-WORK-VIN (9:1) = 'X')
 16013        AND (WS-VIN-REMAINDER = 10))
 16014                OR
 16015        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 16016        if pb-company-id = 'VPP'
 16017           perform 3410-check-with-hldi
 16018                                 thru 3410-exit
 16019        end-if
 16020     ELSE
 16021        IF WS-WORK-VIN (1:1) > 0 AND < 6
 16022           MOVE ER-3826          TO WS-ERROR
 16023           PERFORM 9900-ERROR-FORMAT
 16024                                 THRU 9900-EXIT
 16025        ELSE
 16026           MOVE ER-3827          TO WS-ERROR
 16027           PERFORM 9900-ERROR-FORMAT
 16028                                 THRU 9900-EXIT
 16029        END-IF
 16030     END-IF
 16031
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 290
* EL050.cbl
 16032     .
 16033 3400-exit.
 16034     exit.
 16035 3410-check-with-hldi.
 16036     move spaces                 to hldi-pass-area
 16037     move pb-i-vin               to pa-vin
 16038     perform 7785-call-hldi      thru 7785-exit
 16039*    display 'PA-VIN        ' PA-VIN
 16040*    display 'PA-ErrorCode  ' PA-ErrorCode
 16041*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16042*    display 'PA-ModelYear  ' PA-ModelYear
 16043*    display 'PA-MakeName   ' PA-MakeName
 16044*    display 'PA-ModelName  ' PA-ModelName
 16045*    display 'PA-SeriesName ' PA-SeriesName
 16046     if pa-errorcode (1:1) not = '0'
 16047        move spaces              to hldi-pass-area
 16048        move pb-i-vin            to pa-vin
 16049*       move pa-errordesc        to pa-seriesname
 16050*       perform 7786-call-hldim  thru 7786-exit
 16051*       display 'PA-VIN        ' PA-VIN
 16052*       display 'PA-ErrorCode  ' PA-ErrorCode
 16053*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16054*       display 'PA-ModelYear  ' PA-ModelYear
 16055*       display 'PA-MakeName   ' PA-MakeName
 16056*       display 'PA-ModelName  ' PA-ModelName
 16057*       display 'PA-SeriesName ' PA-SeriesName
 16058     end-if
 16059     .
 16060 3410-exit.
 16061     exit.
 16062******************************************************************
 16063*                  E D I T   C A N C E L                         *
 16064******************************************************************
 16065
 16066 3700-EDIT-CANCEL.
 16067     IF PB-COMPANY-ID = 'DMD'
 16068         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16069                                         WS-RES-MUNI-TAX
 16070                                         PB-CI-STATE-TAX
 16071                                         PB-CI-MUNI-TAX
 16072         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16073
 16074*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16075*       IF PB-ENTRY-BATCH  NUMERIC
 16076*          IF PB-CANCELLATION
 16077*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16078*          ELSE
 16079*             IF PB-ISSUE
 16080*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16081
 16082     IF PB-C-INT-ON-REFS NOT NUMERIC
 16083        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16084     END-IF
 16085*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16086*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16087
 16088     IF CM-ENTRY-STATUS = 'V'
 16089        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 291
* EL050.cbl
 16090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16091        GO TO 3999-END-EDIT.
 16092
 16093     IF CM-ENTRY-STATUS = 'D'
 16094        MOVE ER-2781             TO WS-ERROR
 16095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16096        GO TO 3999-END-EDIT.
 16097
 16098     IF CM-ENTRY-STATUS = 'U'
 16099        MOVE ER-2782             TO WS-ERROR
 16100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16101
 16102***************************************************************
 16103*                                                             *
 16104*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16105*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16106*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16107*   OF ANOTHER COVERAGE.                                      *
 16108*                                                             *
 16109***************************************************************
 16110
 16111     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16112                                    PB-C-AH-CANCEL-VOID-SW.
 16113
 16114     if pb-company-id = 'DCC' or 'VPP'
 16115        if ((pb-ci-lf-cancel-amt <> zeros)
 16116                       or
 16117            (pb-ci-ah-cancel-amt <> zeros))
 16118           MOVE ER-3068          TO WS-ERROR
 16119           PERFORM 9900-ERROR-FORMAT
 16120                                 THRU 9900-EXIT
 16121           GO TO 3999-END-EDIT
 16122        end-if
 16123     end-if
 16124     IF PB-C-LF-CANCEL-AMT = ZERO
 16125        NEXT SENTENCE
 16126     ELSE
 16127        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16128           AND
 16129           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16130               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16131               MOVE ER-2745           TO WS-ERROR
 16132               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16133
 16134     IF PB-C-AH-CANCEL-AMT = ZERO
 16135        NEXT SENTENCE
 16136     ELSE
 16137        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16138           AND
 16139           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16140               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16141               MOVE ER-2745           TO WS-ERROR
 16142               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16143
 16144     IF WS-LF-EARNINGS-CALC = '4'
 16145        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16146
 16147     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 292
* EL050.cbl
 16148     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16149     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16150     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16151     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16152     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16153
 16154     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16155                                      PB-C-AH-REF-CALC.
 16156     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16157
 16158******************************************************************
 16159*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16160*             TO VALIDATE COVERAGE.                              *
 16161******************************************************************
 16162
 16163     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16164        PB-C-LF-CANCEL-AMT = ZEROS
 16165          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16166      ELSE
 16167          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16168
 16169     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16170        PB-C-AH-CANCEL-AMT = ZEROS
 16171          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16172      ELSE
 16173          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16174
 16175     EVALUATE TRUE
 16176         WHEN PB-CANCEL-FORCE             OR
 16177              PB-CANCEL-DATE-FORCED       OR
 16178              PB-FORCE-OFF
 16179                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16180                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16181                  END-IF
 16182         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16183               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16184              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16185                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16186         WHEN OTHER
 16187              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16188                 MOVE ER-2794              TO WS-ERROR
 16189              ELSE
 16190                 MOVE ER-2749              TO WS-ERROR
 16191              END-IF
 16192              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16193     END-EVALUATE.
 16194
 16195
 16196*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16197*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16198*            MOVE  ER-1909            TO  WS-ERROR
 16199*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16200*        ELSE
 16201*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16202
 16203     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16204     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16205        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 293
* EL050.cbl
 16206     ELSE
 16207        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16208     END-IF
 16209     .
 16210 3705-EDIT-CANCEL-DT.
 16211
 16212     IF LF-COVERAGE-CANCELLED
 16213        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16214         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16215         MOVE WS-CURRENT-MONTH-END
 16216                                 TO DC-BIN-DATE-2
 16217         SET ELAPSED-BETWEEN-BIN TO TRUE
 16218*        MOVE 1                  TO DC-OPTION-CODE
 16219         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16220         IF DATE-CONVERSION-ERROR
 16221            NEXT SENTENCE
 16222          ELSE
 16223             IF DC-ELAPSED-DAYS GREATER +180
 16224                IF PB-CANCEL-DATE-FORCED  OR
 16225                   PB-CANCEL-DATE-FORCED-NO-FEE
 16226                      MOVE ER-2751  TO WS-ERROR
 16227                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16228                 ELSE
 16229                   MOVE ER-2752  TO WS-ERROR
 16230                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16231
 16232     IF AH-COVERAGE-CANCELLED
 16233        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16234         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16235         MOVE WS-CURRENT-MONTH-END
 16236                                 TO DC-BIN-DATE-2
 16237         SET ELAPSED-BETWEEN-BIN TO TRUE
 16238*        MOVE 1                  TO DC-OPTION-CODE
 16239         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16240         IF DATE-CONVERSION-ERROR
 16241            NEXT SENTENCE
 16242          ELSE
 16243             IF DC-ELAPSED-DAYS GREATER +180
 16244                IF PB-CANCEL-DATE-FORCED OR
 16245                   PB-CANCEL-DATE-FORCED-NO-FEE
 16246                      MOVE ER-2751  TO WS-ERROR
 16247                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16248                 ELSE
 16249                   MOVE ER-2752  TO WS-ERROR
 16250                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16251
 16252     IF WS-ERROR = ER-2752
 16253        AND (PB-COMPANY-ID = 'ABL'
 16254         OR  PB-COMPANY-ID = 'FGL'
 16255         OR  PB-COMPANY-ID = 'IST'
 16256         OR  PB-COMPANY-ID = 'JHL'
 16257         OR  PB-COMPANY-ID = 'LAP'
 16258         OR  PB-COMPANY-ID = 'LBL'
 16259         OR  PB-COMPANY-ID = 'NCB'
 16260         OR  PB-COMPANY-ID = 'NLI'
 16261         OR  PB-COMPANY-ID = 'OFI'
 16262         OR  PB-COMPANY-ID = 'PLI'
 16263         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 294
* EL050.cbl
 16264         OR  PB-COMPANY-ID = 'TIC'
 16265         OR  PB-COMPANY-ID = 'HER'
 16266         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16267         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16268            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16269            MOVE ER-2762     TO WS-ERROR
 16270            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16271
 16272     IF LF-COVERAGE-CANCELLED
 16273        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16274        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16275             MOVE ER-2733         TO WS-ERROR
 16276             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16277
 16278     IF AH-COVERAGE-CANCELLED
 16279        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16280        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16281              MOVE ER-2733        TO WS-ERROR
 16282              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16283
 16284     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16285        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16286        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16287           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16288            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16289              IF PB-COMPANY-ID NOT = 'LAP'
 16290               MOVE ER-2704            TO WS-ERROR
 16291               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16292
 16293     IF CERT-WAS-NOT-FOUND
 16294         GO TO 3999-END-EDIT.
 16295
 16296     IF PB-COMPANY-ID EQUAL 'CDC'
 16297        IF LF-COVERAGE-CANCELLED
 16298           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16299            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16300            MOVE PB-C-LF-CANCEL-DT
 16301                                 TO DC-BIN-DATE-2
 16302            SET ELAPSED-BETWEEN-BIN TO TRUE
 16303*           MOVE 1               TO DC-OPTION-CODE
 16304            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16305            IF DATE-CONVERSION-ERROR
 16306               NEXT SENTENCE
 16307             ELSE
 16308                IF DC-ELAPSED-DAYS GREATER +60
 16309                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16310
 16311     IF PB-COMPANY-ID EQUAL 'CDC'
 16312        IF AH-COVERAGE-CANCELLED
 16313           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16314            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16315            MOVE PB-C-AH-CANCEL-DT
 16316                                 TO DC-BIN-DATE-2
 16317            MOVE +0              TO DC-ELAPSED-DAYS
 16318                                    DC-ELAPSED-MONTHS
 16319            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16320*           MOVE 1               TO DC-OPTION-CODE
 16321            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 295
* EL050.cbl
 16322            IF DATE-CONVERSION-ERROR
 16323               NEXT SENTENCE
 16324             ELSE
 16325                IF DC-ELAPSED-DAYS GREATER +60
 16326                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16327
 16328     MOVE +0                     TO DC-ELAPSED-DAYS
 16329                                    DC-ELAPSED-MONTHS.
 16330
 16331     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16332        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16333          MOVE 'Z'                TO PB-CI-OB-FLAG
 16334          MOVE ER-2767            TO WS-ERROR
 16335          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16336          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16337          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16338          GO TO 3775-OVER-REF-CHK
 16339        ELSE
 16340          MOVE ZEROS              TO PB-CI-LIVES
 16341                                     PB-C-LIVES
 16342          IF PB-CI-OB-FLAG NOT = 'B'
 16343             MOVE SPACE           TO PB-CI-OB-FLAG.
 16344
 16345     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16346         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16347     ELSE
 16348         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16349
 16350     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16351        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16352            MOVE ER-2760         TO WS-ERROR
 16353            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16354
 16355     IF LF-COVERAGE-CANCELLED
 16356        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16357         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16358            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16359               MOVE ER-2774       TO WS-ERROR
 16360               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16361
 16362     IF AH-COVERAGE-CANCELLED
 16363        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16364         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16365            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16366               MOVE ER-2775       TO WS-ERROR
 16367               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16368
 16369     IF LF-COVERAGE-CANCELLED
 16370        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16371         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16372            MOVE ER-2776         TO WS-ERROR
 16373            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16374
 16375     IF AH-COVERAGE-CANCELLED
 16376        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16377         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16378            MOVE ER-2777         TO WS-ERROR
 16379            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 296
* EL050.cbl
 16380
 16381     IF LF-COVERAGE-CANCELLED
 16382        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16383        if pb-ci-lf-expire-dt = low-values or spaces
 16384           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16385           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16386           MOVE PB-CI-EXTENTION-DAYS
 16387                                 TO DC-ELAPSED-DAYS
 16388           SET BIN-PLUS-ELAPSED  TO TRUE
 16389           PERFORM 8500-DATE-CONVERT
 16390                                 THRU 8500-EXIT
 16391           IF DATE-CONVERSION-ERROR
 16392              move low-values    to dc-bin-date-2
 16393           end-if
 16394        else
 16395           move pb-ci-lf-expire-dt
 16396                                 to dc-bin-date-2
 16397        end-if
 16398        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16399           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16400                             OR  'FIA'
 16401              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16402           ELSE
 16403              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16404              MOVE ER-2731       TO WS-ERROR
 16405              PERFORM 9900-ERROR-FORMAT
 16406                                 THRU 9900-EXIT
 16407           end-if
 16408        end-if
 16409     end-if
 16410*    IF LF-COVERAGE-CANCELLED
 16411*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16412*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16413*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16414*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16415*        SET BIN-PLUS-ELAPSED      TO TRUE
 16416*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16417*        IF DATE-CONVERSION-ERROR
 16418*           NEXT SENTENCE
 16419*         ELSE
 16420*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16421*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16422*                            OR  'FIA'
 16423*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16424*              ELSE
 16425*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16426*               MOVE ER-2731       TO WS-ERROR
 16427*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16428     .
 16429 3705-EDIT-AH-CANCEL-DT.
 16430     IF AH-COVERAGE-CANCELLED
 16431        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16432        if pb-ci-AH-expire-dt = low-values or spaces
 16433           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16434           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16435           MOVE PB-CI-EXTENTION-DAYS
 16436                                 TO DC-ELAPSED-DAYS
 16437           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 297
* EL050.cbl
 16438           PERFORM 8500-DATE-CONVERT
 16439                                 THRU 8500-EXIT
 16440           IF DATE-CONVERSION-ERROR
 16441              move low-values    to dc-bin-date-2
 16442           end-if
 16443        else
 16444           move pb-ci-ah-expire-dt
 16445                                 to dc-bin-date-2
 16446        end-if
 16447        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16448           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16449                             OR  'FIA'
 16450              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16451           ELSE
 16452              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16453              MOVE ER-2771       TO WS-ERROR
 16454              PERFORM 9900-ERROR-FORMAT
 16455                                 THRU 9900-EXIT
 16456           end-if
 16457        end-if
 16458     end-if
 16459*    IF AH-COVERAGE-CANCELLED
 16460*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16461*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16462*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16463*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16464**       MOVE 6                    TO DC-OPTION-CODE
 16465*        SET BIN-PLUS-ELAPSED      TO TRUE
 16466*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16467*        IF DATE-CONVERSION-ERROR
 16468*           NEXT SENTENCE
 16469*         ELSE
 16470*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16471*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16472*                             OR 'FIA'
 16473*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16474*             ELSE
 16475*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16476*              MOVE ER-2771       TO WS-ERROR
 16477*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16478     .
 16479 3705-EDIT-CONTINUED.
 16480
 16481*    IF LF-COVERAGE-CANCELLED
 16482*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16483*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16484*            MOVE ER-2727         TO WS-ERROR
 16485*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16486*
 16487*    IF AH-COVERAGE-CANCELLED
 16488*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16489*        IF PB-COMPANY-ID = 'ACE'
 16490*           MOVE ER-2727        TO WS-ERROR
 16491*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16492*        ELSE
 16493*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16494*              MOVE ER-2727     TO WS-ERROR
 16495*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 298
* EL050.cbl
 16496
 16497     IF PB-COMPANY-ID = 'ACE'
 16498       IF AH-COVERAGE-CANCELLED
 16499         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16500           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16501              MOVE ER-2732      TO WS-ERROR
 16502              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16503
 16504     IF PB-COMPANY-ID      EQUAL   'HER'
 16505        IF WS-ERROR        EQUAL   ER-2727
 16506            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16507            MOVE  ER-2725          TO  WS-ERROR
 16508            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16509
 16510     IF PB-C-CLAIM-CREATED-CANCEL
 16511            MOVE ER-2748         TO WS-ERROR
 16512            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513
 16514     IF PB-C-LAST-NAME NOT = SPACES
 16515         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16516            MOVE ER-2747         TO WS-ERROR
 16517            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16518
 16519 3710-EDIT-LUMP-SUM-PRIOR.
 16520
 16521     IF AH-COVERAGE-CANCELLED
 16522         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16523             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16524                MOVE ER-2735    TO WS-ERROR
 16525                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16526
 16527     IF LF-COVERAGE-CANCELLED
 16528         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16529             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16530                MOVE ER-2735    TO WS-ERROR
 16531                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16532
 16533 3710-EDIT-PRIOR-DEATH.
 16534
 16535*    IF LF-COVERAGE-CANCELLED
 16536*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16537*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16538*           (NOT PB-CI-OB)
 16539*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16540*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16541*                   MOVE ER-2732  TO WS-ERROR
 16542*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16543*
 16544*    IF AH-COVERAGE-CANCELLED
 16545*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16546*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16547*           (NOT PB-CI-OB)
 16548*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16549*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16550*                   MOVE ER-2732  TO WS-ERROR
 16551*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16552
 16553     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 299
* EL050.cbl
 16554         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16555            (NOT PB-COMP-LF-CANCEL)
 16556             NEXT SENTENCE
 16557         ELSE
 16558           IF PB-C-LF-CANCEL-VOIDED
 16559              NEXT SENTENCE
 16560           ELSE
 16561              MOVE ER-2753      TO WS-ERROR
 16562              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16563
 16564     IF CANCEL-FUTURE-DT
 16565         GO TO 3999-END-EDIT.
 16566
 16567 3715-GET-REMAIN-TERM-LF.
 16568
 16569     IF NO-LF-BENEFIT-MATCH  OR
 16570        WS-LF-BENEFIT-CD = ZEROS
 16571        GO TO 3730-GET-AH-REMAIN-TERM.
 16572
 16573     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16574     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16575     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16576     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16577     MOVE PB-SV-STATE            TO CP-STATE.
 16578     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16579     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16580     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16581     MOVE '2'                    TO CP-PROCESS-TYPE.
 16582     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16583     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16584     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16585     IF (PB-COMPANY-ID = 'CID')
 16586        AND (CP-STATE-STD-ABBRV = 'WI')
 16587        MOVE '7'                 TO CP-REM-TERM-METHOD
 16588        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16589     ELSE
 16590        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16591        MOVE WS-REM-TRM-CALC-OPTION
 16592                                 TO CP-REM-TRM-CALC-OPTION
 16593     END-IF
 16594**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16595     IF (PB-COMPANY-ID = 'CID')
 16596        AND (CP-STATE-STD-ABBRV = 'MO')
 16597        AND (PB-CERT-EFF-DT >= X'9B41')
 16598        AND (PB-CERT-EFF-DT <= X'A2FB')
 16599        MOVE '7'                 TO CP-REM-TERM-METHOD
 16600        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16601     END-IF
 16602     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16603                                    CP-LOAN-TERM.
 16604     IF CP-TRUNCATED-LIFE
 16605        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16606
 16607     IF CP-TERM-IS-DAYS
 16608         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16609     ELSE
 16610         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16611
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 300
* EL050.cbl
 16612     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16613
 16614     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16615
 16616     IF LF-COVERAGE-CANCELLED
 16617        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16618        NEXT SENTENCE
 16619      ELSE
 16620          GO TO 3730-GET-AH-REMAIN-TERM.
 16621
 16622 3720-GET-LF-REFUND.
 16623
 16624     IF PB-C-LF-CANCEL-VOIDED
 16625        GO TO 3730-GET-AH-REMAIN-TERM
 16626     end-if
 16627
 16628     IF PB-COMPANY-ID EQUAL 'BOA'
 16629         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16630         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16631         GO TO 3730-GET-AH-REMAIN-TERM.
 16632
 16633     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16634        (WS-AH-SPECIAL-CALC-CD = 'M')
 16635         MOVE ER-2767            TO WS-ERROR
 16636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16637         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16638         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16639         GO TO 3780-UPDATE-CANCEL-CERT.
 16640
 16641*    if (ws-lf-earnings-calc = '6')
 16642*       or (pb-c-lf-refund-override = '6')
 16643*       move cp-remaining-term-1 to cp-remaining-term-2
 16644*    end-if
 16645     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16646
 16647     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16648     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16649     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16650     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16651     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16652     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16653     IF PB-COMPANY-ID = 'DCC'
 16654        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16655        IF PDEF-MASTER-FOUND
 16656           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16657              (V1 > +8)
 16658              OR (PD-PROD-CODE (V1) = 'L')
 16659           END-PERFORM
 16660           IF V1 < +9
 16661              MOVE PD-MAX-AMT (V1)
 16662                           TO CP-R-MAX-TOT-BEN
 16663                              EC-AM-LF-MAX-TOT-BEN
 16664           END-IF
 16665        ELSE
 16666        MOVE ' '                 TO PDEF-MASTER-SW
 16667        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16668        MOVE PB-STATE            TO ERPDEF-STATE
 16669        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 301
* EL050.cbl
 16670           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16671        END-IF
 16672        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16673        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16674        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16675        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16676        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16677        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16678        IF PDEF-MASTER-FOUND
 16679           MOVE 'N'              TO PDEF-MASTER-SW
 16680           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16681           IF PDEF-MASTER-FOUND
 16682              IF (ERPDEF-KEY-SAVE (1:16) =
 16683                           PD-CONTROL-PRIMARY (1:16))
 16684                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16685                 CONTINUE
 16686              ELSE
 16687                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16688                 IF (ERPDEF-KEY-SAVE (1:16) =
 16689                           PD-CONTROL-PRIMARY (1:16))
 16690                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16691                    CONTINUE
 16692                 ELSE
 16693                    MOVE 'N'     TO PDEF-MASTER-SW
 16694                 END-IF
 16695              END-IF
 16696
 16697              IF PDEF-MASTER-FOUND
 16698                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16699                    (V1 > +8)
 16700                    OR (PD-PROD-CODE (V1) = 'L')
 16701                 END-PERFORM
 16702                 IF V1 < +9
 16703                    MOVE PD-MAX-AMT (V1)
 16704                                 TO CP-R-MAX-TOT-BEN
 16705                                    EC-AM-LF-MAX-TOT-BEN
 16706                 END-IF
 16707              END-IF
 16708           END-IF
 16709           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16710        END-IF
 16711        END-IF
 16712     END-IF
 16713     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16714
 16715     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16716
 16717     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16718                                    PB-C-LF-REM-TERM.
 16719
 16720     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16721     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16722
 16723     IF PB-COMPANY-ID EQUAL 'FLC'
 16724        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16725           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16726           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16727                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 302
* EL050.cbl
 16728                    - CM-LF-ITD-DEATH-AMT
 16729           IF PB-C-LF-REF-CALC LESS THAN +0
 16730              MOVE +0            TO PB-C-LF-REF-CALC
 16731              GO TO 3730-GET-AH-REMAIN-TERM
 16732           ELSE
 16733              GO TO 3730-GET-AH-REMAIN-TERM.
 16734
 16735     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16736                            OR '4' OR '5' OR '6' OR '8'
 16737                            OR '9' OR 'G'
 16738        MOVE PB-C-LF-REFUND-OVERRIDE
 16739                                 TO CP-EARNING-METHOD.
 16740
 16741     if pb-company-id = 'AHL'
 16742        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16743        if cp-class-code = spaces
 16744           move zeros            to cp-class-code
 16745        end-if
 16746     ELSE
 16747        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16748     END-IF
 16749*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16750     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16751     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16752                                    CP-RATING-BENEFIT-AMT.
 16753     IF CP-STATE-STD-ABBRV = 'OR'
 16754         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16755                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16756     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16757     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16758     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16759     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16760     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16761     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16762     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16763     IF WS-DEFAULT-APR NOT NUMERIC
 16764         MOVE ZEROS TO WS-DEFAULT-APR.
 16765****   N O T E   ****
 16766*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16767*      THE OH HARD CODING IN ELCRFNDP
 16768
 16769     IF PB-COMPANY-ID = 'CID'
 16770        IF CP-STATE-STD-ABBRV = 'OH'
 16771           MOVE WS-LF-EARNINGS-CALC
 16772                                 TO CP-EARNING-METHOD
 16773        END-IF
 16774     END-IF
 16775
 16776****   N O T E   ****
 16777
 16778*    IF CP-EARN-AS-NET-PAY
 16779*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16780*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16781*               MOVE WS-DEFAULT-APR
 16782*                                TO  CP-LOAN-APR
 16783*               MOVE ER-3780     TO  WS-ERROR
 16784*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16785*           ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 303
* EL050.cbl
 16786*               MOVE ER-3781     TO  WS-ERROR
 16787*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16788*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16789     move ' '                    to cp-ext-days-calc
 16790     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16791
 16792     IF CP-REFUND-TYPE-USED NOT = SPACE
 16793         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16794
 16795     IF CP-ERROR-RATE-IS-ZERO OR
 16796        CP-ERROR-RATE-NOT-FOUND
 16797        MOVE ER-2740             TO WS-ERROR
 16798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16799
 16800     IF CP-ERROR-RATE-FILE-NOTOPEN
 16801        MOVE ER-2617             TO WS-ERROR
 16802        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16803
 16804     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16805        AND PB-CI-ENTRY-STATUS = 'M'
 16806        MOVE +0                  TO PB-C-LF-REF-CALC
 16807     ELSE
 16808        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16809     END-IF
 16810
 16811     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16812         GO TO 3730-GET-AH-REMAIN-TERM.
 16813
 16814*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16815*       ADD +1                   TO PB-C-LF-REM-TERM
 16816*                                   CP-REMAINING-TERM
 16817*                                   CP-ORIGINAL-TERM.
 16818
 16819     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16820     MOVE '2'                    TO CP-EARNING-METHOD
 16821                                    CP-RATING-METHOD.
 16822     IF PB-COMPANY-ID = 'CID'
 16823        IF (CP-STATE-STD-ABBRV = 'MN')
 16824           AND (PB-CERT-EFF-DT > X'A4FF')
 16825           AND (WS-LF-EARNINGS-CALC = 'B')
 16826           MOVE '5'              TO CP-EARNING-METHOD
 16827           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16828        END-IF
 16829     END-IF
 16830     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16831                                        CP-REMAINING-BENEFIT
 16832                                        CP-RATING-BENEFIT-AMT.
 16833     IF CP-STATE-STD-ABBRV = 'OR'
 16834         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16835                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16836     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16837     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16838
 16839     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16840
 16841     IF CP-ERROR-RATE-IS-ZERO OR
 16842        CP-ERROR-RATE-NOT-FOUND
 16843        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 304
* EL050.cbl
 16844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16845
 16846     IF CP-ERROR-RATE-FILE-NOTOPEN
 16847        MOVE ER-2617             TO WS-ERROR
 16848        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16849
 16850     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16851
 16852******************************************************************
 16853
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 305
* EL050.cbl
 16855 3730-GET-AH-REMAIN-TERM.
 16856     IF NO-AH-BENEFIT-MATCH  OR
 16857        WS-AH-BENEFIT-CD = ZEROS
 16858         GO TO 3770-CHECK-REFUNDS.
 16859
 16860     IF PB-CI-AH-LUMP-SUM-DISAB
 16861         IF  PB-C-AH-CANCEL-AMT = ZERO
 16862            IF NOT PB-COMP-AH-CANCEL
 16863             GO TO 3770-CHECK-REFUNDS.
 16864
 16865     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16866     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16867     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16868     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16869     MOVE PB-SV-STATE            TO CP-STATE.
 16870     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16871     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16872     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16873     MOVE '2'                    TO CP-PROCESS-TYPE.
 16874     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16875     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16876     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16877     IF (PB-COMPANY-ID = 'CID')
 16878        AND (CP-STATE-STD-ABBRV = 'WI')
 16879        MOVE '7'                 TO CP-REM-TERM-METHOD
 16880        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16881     ELSE
 16882        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16883        MOVE WS-REM-TRM-CALC-OPTION
 16884                                 TO CP-REM-TRM-CALC-OPTION
 16885     END-IF
 16886     IF (PB-COMPANY-ID = 'CID')
 16887        AND (CP-STATE-STD-ABBRV = 'MO')
 16888        AND (PB-CERT-EFF-DT >= X'9B41')
 16889        AND (PB-CERT-EFF-DT <= X'A2FB')
 16890        MOVE '7'                 TO CP-REM-TERM-METHOD
 16891        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16892     END-IF
 16893     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16894                                    CP-LOAN-TERM.
 16895     IF NOT CP-TERM-IS-DAYS
 16896         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16897
 16898     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16899
 16900     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16901
 16902     IF AH-COVERAGE-CANCELLED
 16903        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16904        NEXT SENTENCE
 16905      ELSE
 16906         GO TO 3770-CHECK-REFUNDS.
 16907
 16908 3740-GET-AH-REFUND.
 16909
 16910     IF PB-C-AH-CANCEL-VOIDED
 16911        GO TO 3780-UPDATE-CANCEL-CERT
 16912     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 306
* EL050.cbl
 16913
 16914     IF PB-COMPANY-ID = 'BOA'
 16915         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16916         GO TO 3770-CHECK-REFUNDS.
 16917
 16918     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16919*    MOVE ' '                    TO DC-OPTION-CODE
 16920     SET BIN-TO-GREG             TO TRUE
 16921     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16922     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16923                                    PB-C-AH-REM-TERM.
 16924     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16925     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16926
 16927     IF PB-COMPANY-ID EQUAL 'FLC'
 16928        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16929           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16930           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16931                    - CM-AH-ITD-AH-PMT)
 16932           IF PB-C-AH-REF-CALC LESS THAN +0
 16933              MOVE +0            TO PB-C-AH-REF-CALC
 16934              GO TO 3770-CHECK-REFUNDS
 16935           ELSE
 16936              GO TO 3770-CHECK-REFUNDS.
 16937
 16938     IF PB-COMPANY-ID = 'DCC'
 16939        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16940            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16941           MOVE 'S'              TO CP-EARNING-METHOD
 16942        END-IF
 16943     END-IF
 16944     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16945                            OR '4' OR '5' OR '6' OR '8'
 16946                            OR '9' OR 'G' OR 'S'
 16947        MOVE PB-C-AH-REFUND-OVERRIDE
 16948                                 TO CP-EARNING-METHOD.
 16949
 16950     if pb-company-id = 'AHL'
 16951        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16952        if cp-class-code = spaces
 16953           move zeros            to cp-class-code
 16954        end-if
 16955     ELSE
 16956        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16957     END-IF
 16958*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16959     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16960     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16961                                    CP-RATING-BENEFIT-AMT.
 16962     IF CP-STATE-STD-ABBRV = 'OR'
 16963         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16964                                         PB-CI-AH-TERM.
 16965     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16966     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16967     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16968     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16969     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16970     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 307
* EL050.cbl
 16971
 16972     IF CP-STATE-STD-ABBRV = 'OH'
 16973        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16974                                AND 'CID' AND 'DCC' and 'VPP'
 16975                                AND 'AHL')
 16976           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16977              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16978              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16979              MOVE '6' TO CP-EARNING-METHOD
 16980           END-IF
 16981        END-IF
 16982        IF PB-COMPANY-ID = 'CID'
 16983           IF NO-LIFE-COVERAGE
 16984              IF CP-CRITICAL-PERIOD
 16985                 MOVE '2'       TO CP-EARNING-METHOD
 16986              ELSE
 16987                 MOVE '6'       TO CP-EARNING-METHOD
 16988              END-IF
 16989           ELSE
 16990              IF WS-LF-COVERAGE-TYPE = 'L'
 16991                 MOVE '2'       TO CP-EARNING-METHOD
 16992              ELSE
 16993                 IF (PB-CI-LF-TERM > +60) OR
 16994                    (WS-LF-EARNINGS-CALC = '5')
 16995                    IF CP-CRITICAL-PERIOD
 16996                       MOVE '2'  TO CP-EARNING-METHOD
 16997                    ELSE
 16998                       MOVE '6'  TO CP-EARNING-METHOD
 16999                    END-IF
 17000                 ELSE
 17001                    MOVE '1'     TO CP-EARNING-METHOD
 17002                 END-IF
 17003              END-IF
 17004           END-IF
 17005        END-IF
 17006     END-IF
 17007
 17008*    IF CP-STATE-STD-ABBRV = 'VA'
 17009*       IF DC-GREG-DATE-CYMD GREATER 19921231
 17010*          IF CP-ORIGINAL-TERM GREATER 61
 17011*             MOVE '6' TO CP-EARNING-METHOD
 17012*          ELSE
 17013*             MOVE '1' TO CP-EARNING-METHOD.
 17014
 17015     IF WS-DEFAULT-APR NOT NUMERIC
 17016         MOVE ZEROS TO WS-DEFAULT-APR.
 17017     IF CP-EARN-AS-NET-PAY
 17018         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 17019            IF WS-DEFAULT-APR GREATER THAN ZEROS
 17020                MOVE WS-DEFAULT-APR
 17021                                 TO  CP-LOAN-APR
 17022                MOVE ER-3780     TO  WS-ERROR
 17023                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17024            ELSE
 17025                MOVE ER-3781     TO  WS-ERROR
 17026                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17027     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17028     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 308
* EL050.cbl
 17029        AND CP-CANCEL-REASON = 'R'
 17030        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17031        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17032     END-IF
 17033     IF PB-COMPANY-ID = 'DCC'
 17034        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17035        AND (CP-EARNING-METHOD = 'D')
 17036        AND (CP-CANCEL-REASON NOT = 'R')
 17037        CONTINUE
 17038     ELSE
 17039        GO TO 3750-CONTINUE
 17040     END-IF
 17041     MOVE ' '                    TO DD-IU-SW
 17042     IF NOT PDEF-MASTER-FOUND
 17043        MOVE ' '                 TO PDEF-MASTER-SW
 17044        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17045        MOVE PB-STATE            TO ERPDEF-STATE
 17046        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17047           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17048        END-IF
 17049        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17050        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17051        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17052        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17053        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17054        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17055        IF PDEF-MASTER-FOUND
 17056           MOVE 'N'              TO PDEF-MASTER-SW
 17057           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17058           IF PDEF-MASTER-FOUND
 17059              IF (ERPDEF-KEY-SAVE (1:16) =
 17060                           PD-CONTROL-PRIMARY (1:16))
 17061                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17062                 CONTINUE
 17063              ELSE
 17064                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17065                 IF (ERPDEF-KEY-SAVE (1:16) =
 17066                           PD-CONTROL-PRIMARY (1:16))
 17067                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17068                    CONTINUE
 17069                 ELSE
 17070                    MOVE ER-2740 TO WS-ERROR
 17071                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17072                    GO TO 3770-CHECK-REFUNDS
 17073                 END-IF
 17074              END-IF
 17075           END-IF
 17076           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17077        END-IF
 17078     END-IF
 17079     IF PDEF-MASTER-FOUND
 17080        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17081           (V1 > +8)
 17082           OR (PD-PROD-CODE (V1) = 'I')
 17083        END-PERFORM
 17084        IF V1 < +9
 17085           SET DD-IU-PRESENT        TO TRUE
 17086        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 309
* EL050.cbl
 17087        IF WS-AH-DCC-TRUNC = 'T'
 17088           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17089        ELSE
 17090           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17091        END-IF
 17092        EVALUATE TRUE
 17093           WHEN WS-TERM > +168
 17094              MOVE 15               TO V1
 17095           WHEN WS-TERM > +156
 17096              MOVE 14               TO V1
 17097           WHEN WS-TERM > +144
 17098              MOVE 13               TO V1
 17099           WHEN WS-TERM > +132
 17100              MOVE 12               TO V1
 17101           WHEN WS-TERM > +120
 17102              MOVE 11               TO V1
 17103           WHEN WS-TERM > +108
 17104              MOVE 10               TO V1
 17105           WHEN WS-TERM > +96
 17106              MOVE 9                TO V1
 17107           WHEN WS-TERM > +84
 17108              MOVE 8                TO V1
 17109           WHEN WS-TERM > +72
 17110              MOVE 7                TO V1
 17111           WHEN WS-TERM > +60
 17112              MOVE 6                TO V1
 17113           WHEN WS-TERM > +48
 17114              MOVE 5                TO V1
 17115           WHEN WS-TERM > +36
 17116              MOVE 4                TO V1
 17117           WHEN WS-TERM > +24
 17118              MOVE 3                TO V1
 17119           WHEN WS-TERM > +12
 17120              MOVE 2                TO V1
 17121           WHEN OTHER
 17122              MOVE 1                TO V1
 17123        END-EVALUATE
 17124
 17125        EVALUATE TRUE
 17126*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17127*             < +13)
 17128*             AND (DD-IU-PRESENT)
 17129*             MOVE 2                TO V2
 17130*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17131*             MOVE 1                TO V2
 17132           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17133              MOVE 2                TO V2
 17134           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17135              MOVE 3                TO V2
 17136           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17137              MOVE 4                TO V2
 17138           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17139              MOVE 5                TO V2
 17140           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17141              MOVE 6                TO V2
 17142           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17143              MOVE 7                TO V2
 17144           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 310
* EL050.cbl
 17145              MOVE 8                TO V2
 17146           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17147              MOVE 9                TO V2
 17148           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17149              MOVE 10               TO V2
 17150           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17151              MOVE 11               TO V2
 17152           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17153              MOVE 12               TO V2
 17154           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17155              MOVE 13               TO V2
 17156           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17157              MOVE 14               TO V2
 17158           WHEN OTHER
 17159              MOVE 15               TO V2
 17160        END-EVALUATE
 17161
 17162        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17163                                 TO CP-DDF-LO-FACT
 17164        MOVE PD-UEP-FACTOR (V1 V2)
 17165                                 TO CP-DDF-HI-FACT
 17166
 17167        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17168        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17169        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17170           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17171        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17172        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17173        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17174           + PD-1ST-YR-ADMIN-ALLOW
 17175
 17176        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17177*       IF PI-CLP-YN = 'Y'
 17178*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17179*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17180*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17181*       END-IF
 17182
 17183        IF DD-IU-PRESENT
 17184           MOVE 'I'              TO CP-EARNING-METHOD
 17185        END-IF
 17186        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17187                                     CP-CLP-RATE-UP
 17188        IF CP-IU-RATE-UP NOT = ZEROS
 17189           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17190              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17191           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17192              / (1 - WS-WORK-FACT)
 17193        END-IF
 17194     END-IF
 17195     .
 17196 3750-CONTINUE.
 17197     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17198
 17199     IF CP-REFUND-TYPE-USED NOT = SPACE
 17200         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17201
 17202     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 311
* EL050.cbl
 17203        CP-ERROR-RATE-NOT-FOUND
 17204        MOVE ER-2740             TO WS-ERROR
 17205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17206
 17207     IF CP-ERROR-RATE-FILE-NOTOPEN
 17208        MOVE ER-2617             TO WS-ERROR
 17209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17210     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17211        AND (PB-CI-ENTRY-STATUS = 'M')
 17212        MOVE +0                  TO PB-C-AH-REF-CALC
 17213     ELSE
 17214        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17215     END-IF
 17216     if pb-company-id = 'VPP'
 17217        MOVE cm-ah-clp           to cp-original-premium
 17218        move zeros               to cp-calc-refund
 17219        perform 7600-get-refund  thru 7600-exit
 17220        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17221           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17222        else
 17223           move zeros            to pb-c-ah-rfnd-clp
 17224        end-if
 17225        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17226           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17227           pb-ci-cancel-fee
 17228     end-if
 17229     IF PB-COMPANY-ID = 'DCC'
 17230        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17231        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17232        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17233        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17234        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17235        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17236        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17237        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17238*       if pb-c-cancel-amt < +0
 17239*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17240*       end-if
 17241*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17242     END-IF
 17243     .
 17244 3770-CHECK-REFUNDS.
 17245
 17246     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17247        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17248           MOVE ER-2766          TO WS-ERROR
 17249           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17250           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17251           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17252              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17253
 17254     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17255        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17256           MOVE ER-2766          TO WS-ERROR
 17257           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17258           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17259           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17260              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 312
* EL050.cbl
 17261
 17262     IF PB-COMP-LF-CANCEL
 17263        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17264        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17265           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17266              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17267
 17268     IF PB-COMP-AH-CANCEL
 17269        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17270        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17271           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17272              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17273
 17274     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17275             GIVING WS-UNSIGN-WRK1
 17276     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17277             GIVING WS-UNSIGN-WRK2.
 17278
 17279     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17280         MOVE ZERO TO WS-UNSIGN-WRK1.
 17281
 17282     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17283         MOVE ZERO TO WS-UNSIGN-WRK2.
 17284
 17285     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17286
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 313
* EL050.cbl
 17288
 17289 3772-CONTINUE.
 17290
 17291**********************************
 17292*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17293*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17294*** DOUBLES THE TOLERANCE AMOUNT.
 17295***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17296**********************************
 17297     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17298     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17299         IF WS-REF-REJECT-SW = SPACE
 17300             MOVE ER-2754        TO WS-ERROR
 17301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17302           ELSE
 17303             MOVE ER-2736        TO WS-ERROR
 17304             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17305**********************************
 17306
 17307 3773-CONTINUE.
 17308
 17309     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17310        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17311           MOVE ER-2723          TO WS-ERROR
 17312           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17313
 17314     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17315        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17316           MOVE ER-2724          TO WS-ERROR
 17317           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17318
 17319     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17320         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17321             (1 + WS-LF-REFUND-OVS-PCT)
 17322     ELSE
 17323         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17324
 17325     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17326         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17327             (1 - WS-TOL-LF-REFUND-PCT)
 17328     ELSE
 17329         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17330
 17331     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17332        AND (PB-CI-ENTRY-STATUS = 'M')
 17333        AND (PB-C-LF-CANCEL-AMT > +0)
 17334        MOVE ER-3843             TO WS-ERROR
 17335        PERFORM 9900-ERROR-FORMAT
 17336                                 THRU 9900-EXIT
 17337     END-IF
 17338     EVALUATE TRUE
 17339        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17340           CONTINUE
 17341        WHEN PB-C-LF-CANCEL-AMT = +0
 17342                 AND PB-C-LF-REF-CALC > +0
 17343           CONTINUE
 17344        WHEN WS-LF-REFUND-OVS-AMT = 0
 17345                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 314
* EL050.cbl
 17346           CONTINUE
 17347        WHEN OTHER
 17348           IF WS-TOL-LF-REFUND  = +0
 17349              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17350           END-IF
 17351           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17352                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17353                          (PB-C-LF-CANCEL-AMT))
 17354              CONTINUE
 17355           ELSE
 17356              IF WS-LF-REFUND-OVS-AMT = +0
 17357                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17358              END-IF
 17359              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17360                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17361                                       PB-C-LF-CANCEL-AMT)
 17362                 CONTINUE
 17363              ELSE
 17364                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17365                   MOVE ER-2754   TO  WS-ERROR
 17366                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17367                 ELSE
 17368                    MOVE ER-2736   TO  WS-ERROR
 17369                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17370                 END-IF
 17371              END-IF
 17372           END-IF
 17373     END-EVALUATE.
 17374
 17375     EVALUATE TRUE
 17376        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17377           CONTINUE
 17378        WHEN PB-C-LF-CANCEL-AMT = +0
 17379                 AND PB-C-LF-REF-CALC > +0
 17380           CONTINUE
 17381        WHEN OTHER
 17382           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17383               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17384              CONTINUE
 17385           ELSE
 17386              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17387               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17388                CONTINUE
 17389              ELSE
 17390                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17391                     MOVE ER-2754   TO  WS-ERROR
 17392                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17393                 ELSE
 17394                     MOVE ER-2736   TO  WS-ERROR
 17395                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17396                 END-IF
 17397              END-IF
 17398           END-IF
 17399     END-EVALUATE.
 17400
 17401     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17402         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17403             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 315
* EL050.cbl
 17404     ELSE
 17405         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17406
 17407     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17408         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17409             (1 - WS-TOL-AH-REFUND-PCT)
 17410     ELSE
 17411         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17412
 17413     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17414        AND (PB-CI-ENTRY-STATUS = 'M')
 17415        AND (PB-C-AH-CANCEL-AMT > +0)
 17416        MOVE ER-3843             TO WS-ERROR
 17417        PERFORM 9900-ERROR-FORMAT
 17418                                 THRU 9900-EXIT
 17419     END-IF
 17420     EVALUATE TRUE
 17421        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17422           CONTINUE
 17423*       WHEN PB-C-AH-REF-CALC = +0 AND
 17424*                  PB-C-AH-CANCEL-AMT > +0
 17425        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17426                   PB-C-AH-REF-CALC > +0
 17427           CONTINUE
 17428        WHEN WS-AH-REFUND-OVS-AMT = +0
 17429                AND WS-TOL-AH-REFUND = +0
 17430           CONTINUE
 17431        WHEN OTHER
 17432           IF WS-TOL-AH-REFUND = +0
 17433              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17434           END-IF
 17435           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17436               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17437                                         PB-C-AH-CANCEL-AMT)
 17438              CONTINUE
 17439           ELSE
 17440              IF WS-AH-REFUND-OVS-AMT = +0
 17441                 MOVE +9999999.99 TO
 17442                         WS-AH-REFUND-OVS-AMT
 17443              END-IF
 17444              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17445                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17446                                         PB-C-AH-CANCEL-AMT)
 17447                 CONTINUE
 17448              ELSE
 17449                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17450                    MOVE ER-2754   TO  WS-ERROR
 17451                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17452                 ELSE
 17453                    MOVE ER-2736   TO  WS-ERROR
 17454                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17455                 END-IF
 17456              END-IF
 17457           END-IF
 17458     END-EVALUATE.
 17459
 17460     EVALUATE TRUE
 17461        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 316
* EL050.cbl
 17462           CONTINUE
 17463*       WHEN PB-C-AH-REF-CALC > +0 AND
 17464*                  PB-C-AH-CANCEL-AMT = +0
 17465        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17466                   PB-C-AH-REF-CALC = +0
 17467           CONTINUE
 17468        WHEN OTHER
 17469           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17470               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17471              CONTINUE
 17472           ELSE
 17473              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17474                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17475                 CONTINUE
 17476              ELSE
 17477                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17478                     MOVE ER-2754   TO  WS-ERROR
 17479                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17480                 ELSE
 17481                     MOVE ER-2736   TO  WS-ERROR
 17482                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17483                 END-IF
 17484              END-IF
 17485           END-IF
 17486     END-EVALUATE.
 17487
 17488     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17489        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17490        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17491           AND  PB-C-LF-REF-CALC < +1.00
 17492           AND  PB-C-AH-REF-CALC < +1.00
 17493           CONTINUE
 17494        ELSE
 17495           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17496              AND (PB-CI-ENTRY-STATUS = 'M')
 17497              CONTINUE
 17498           ELSE
 17499              MOVE ER-2741       TO WS-ERROR
 17500              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17501           END-IF
 17502        END-IF
 17503     END-IF
 17504
 17505     IF (PB-C-LF-CANCEL-AMT = ZERO
 17506        AND WS-LF-BENEFIT-CD NOT = ZERO
 17507        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17508        AND PB-C-LF-REF-CALC NOT = ZERO)
 17509        OR
 17510        (PB-C-LF-CANCEL-AMT = ZERO
 17511        AND WS-LF-BENEFIT-CD NOT = ZERO
 17512        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17513             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17514                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17515                NEXT SENTENCE
 17516             ELSE
 17517                MOVE ER-2739        TO WS-ERROR
 17518                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17519
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 317
* EL050.cbl
 17520     IF (PB-C-AH-CANCEL-AMT = ZERO
 17521        AND WS-AH-BENEFIT-CD NOT = ZERO
 17522        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17523        AND PB-C-AH-REF-CALC NOT = ZERO)
 17524        OR
 17525        (PB-C-AH-CANCEL-AMT = ZERO
 17526        AND WS-AH-BENEFIT-CD NOT = ZERO
 17527        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17528             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17529                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17530                NEXT SENTENCE
 17531             ELSE
 17532                MOVE ER-2738        TO WS-ERROR
 17533                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17534
 17535 3775-OVER-REF-CHK.
 17536
 17537     IF PB-CI-ENTRY-STATUS = '5'
 17538        GO TO 3780-UPDATE-CANCEL-CERT.
 17539
 17540     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17541                              PB-CI-LF-ALT-PREMIUM-AMT.
 17542
 17543     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17544        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17545                                 PB-C-LF-REF-CALC
 17546      ELSE
 17547        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17548                                 PB-C-LF-CANCEL-AMT.
 17549
 17550     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17551        MOVE ER-2755             TO WS-ERROR
 17552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17553
 17554     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17555
 17556     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17557        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17558                                 PB-C-AH-REF-CALC
 17559      ELSE
 17560        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17561                                 PB-C-AH-CANCEL-AMT.
 17562
 17563     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17564        MOVE ER-2778             TO WS-ERROR
 17565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17566
 17567     IF PB-CI-OB-FLAG NOT = 'Z'
 17568        NEXT SENTENCE
 17569       ELSE
 17570         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17571            MOVE ER-2757           TO WS-ERROR
 17572            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17573
 17574 3780-UPDATE-CANCEL-CERT.
 17575
 17576     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17577        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 318
* EL050.cbl
 17578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17579
 17580     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17581         MOVE ER-2729              TO WS-ERROR
 17582         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17583
 17584     IF PB-CI-LF-BENEFIT-CD = ZERO
 17585         GO TO 3780-UPDATE-CONT-1.
 17586
 17587     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17588         GO TO 3780-UPDATE-CONT-1.
 17589
 17590     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17591       AND
 17592        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17593       AND
 17594        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17595       AND
 17596        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17597            NEXT SENTENCE
 17598       ELSE
 17599        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17600          AND
 17601***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17602***       AND
 17603           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17604            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17605               MOVE ER-2730      TO WS-ERROR
 17606               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17607               GO TO 3999-END-EDIT
 17608            ELSE
 17609               GO TO 3999-END-EDIT
 17610        ELSE
 17611            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17612               MOVE ER-2765           TO WS-ERROR
 17613               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17614               GO TO 3785-CHECK-REF-INT.
 17615*              GO TO 3999-END-EDIT.
 17616
 17617 3780-UPDATE-CONT-1.
 17618     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17619
 17620     IF PB-CI-AH-BENEFIT-CD = ZERO
 17621         GO TO 3780-UPDATE-CONT-2.
 17622
 17623     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17624         GO TO 3780-UPDATE-CONT-2.
 17625
 17626     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17627
 17628     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17629       AND
 17630        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17631       AND
 17632        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17633       AND
 17634        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17635            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 319
* EL050.cbl
 17636       ELSE
 17637        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17638          AND
 17639***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17640***       AND
 17641           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17642           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17643            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17644               MOVE ER-2773      TO WS-ERROR
 17645               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17646               GO TO 3999-END-EDIT
 17647            ELSE
 17648               GO TO 3999-END-EDIT
 17649            END-IF
 17650           ELSE
 17651             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17652                IF MSTR-CERT-NO = W-CL-CERT-NO
 17653                   MOVE ER-2890 TO WS-ERROR
 17654                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17655                   GO TO 3999-END-EDIT
 17656                ELSE
 17657                   MOVE ER-2898 TO WS-ERROR
 17658                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17659                   GO TO 3999-END-EDIT
 17660                END-IF
 17661             ELSE
 17662                GO TO 3785-CHECK-REF-INT
 17663             END-IF
 17664           END-IF
 17665          ELSE
 17666            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17667              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17668                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17669                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17670                      MOVE ER-2890 TO WS-ERROR
 17671                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17672                      GO TO 3999-END-EDIT
 17673                   ELSE
 17674                      MOVE ER-2898 TO WS-ERROR
 17675                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17676                      GO TO 3999-END-EDIT
 17677                   END-IF
 17678                ELSE
 17679                   MOVE ER-2765 TO WS-ERROR
 17680                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17681                   GO TO 3785-CHECK-REF-INT
 17682                END-IF
 17683              ELSE
 17684               MOVE ER-2765      TO WS-ERROR
 17685               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17686               GO TO 3785-CHECK-REF-INT.
 17687*              GO TO 3999-END-EDIT.
 17688
 17689 3780-UPDATE-CONT-2.
 17690
 17691     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17692        AND WS-LF-BENEFIT-CD = ZERO
 17693           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 320
* EL050.cbl
 17694           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17695
 17696     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17697        AND WS-AH-BENEFIT-CD = ZERO
 17698           MOVE ER-2744           TO WS-ERROR
 17699           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17700
 17701     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17702        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17703        AND
 17704        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17705         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17706           MOVE ER-2746           TO WS-ERROR
 17707           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17708
 17709     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17710       AND
 17711        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17712             MOVE ER-2737        TO WS-ERROR
 17713             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17714
 17715     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17716       AND
 17717        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17718             MOVE ER-2737        TO WS-ERROR
 17719             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17720
 17721     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17722         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17723             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17724             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17725         ELSE
 17726             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17727                 MOVE ER-2768    TO WS-ERROR
 17728                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17729             ELSE
 17730                 MOVE ER-2756    TO WS-ERROR
 17731                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17732
 17733     IF CERT-PEND-ISSUE-RETURNED
 17734        MOVE ER-2772             TO WS-ERROR
 17735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17736 3785-CHECK-REF-INT.
 17737*    IF PB-STATE NOT = 'NH' and 'TN'
 17738     IF PB-STATE NOT = 'NH'
 17739        GO TO 3999-END-EDIT
 17740     END-IF
 17741
 17742     MOVE ER-2796                TO WS-ERROR
 17743     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17744     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17745        OR (CM-REF-INTERFACE-SW = 'Y')
 17746        MOVE ER-2793             TO WS-ERROR
 17747        PERFORM 9900-ERROR-FORMAT
 17748                                 THRU 9900-EXIT
 17749     END-IF
 17750     MOVE +0                     TO WS-PAYMENT-AMT
 17751     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 321
* EL050.cbl
 17752        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17753               PB-C-AH-CANCEL-DT
 17754           GO TO 3999-END-EDIT
 17755        END-IF
 17756     end-if
 17757***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17758***-_-
 17759***-_-   For TN it's only flat cancels
 17760***-_-
 17761***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17762     if pb-state = 'TN'
 17763        if ((pb-c-lf-cancel-dt <> low-values)
 17764           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17765                      or
 17766           ((pb-c-ah-cancel-dt <> low-values)
 17767           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17768           GO TO 3999-END-EDIT
 17769        END-IF
 17770     end-if
 17771     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17772        GO TO 3999-END-EDIT
 17773     END-IF
 17774***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17775***-_-
 17776***-_-   if cancel date within 15 days of effective date, bypass
 17777***-_-
 17778***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17779     IF PB-STATE NOT = 'NH'
 17780        GO TO 3785-CONTINUE
 17781     END-IF
 17782     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17783     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17784     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17785        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17786     END-IF
 17787     MOVE '1'                    TO DC-OPTION-CODE
 17788     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17789     IF NO-CONVERSION-ERROR
 17790        IF DC-ELAPSED-DAYS < +16
 17791           GO TO 3999-END-EDIT
 17792        END-IF
 17793     END-IF
 17794***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17795***-_-
 17796***-_-   if cancel date within 30 days of current date then
 17797***-_-   bypass else subtract 15 days from period
 17798***-_-
 17799***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17800     MOVE +0                     TO DC-ELAPSED-DAYS
 17801     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17802     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17803     MOVE '1'                    TO DC-OPTION-CODE
 17804     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17805     IF NO-CONVERSION-ERROR
 17806        IF DC-ELAPSED-DAYS > +30
 17807           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17808        ELSE
 17809           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 322
* EL050.cbl
 17810        END-IF
 17811     ELSE
 17812        GO TO 3999-END-EDIT
 17813     END-IF
 17814     .
 17815 3785-CONTINUE.
 17816     if pb-state = 'TN'
 17817        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17818        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17819        MOVE '1'                 TO DC-OPTION-CODE
 17820        PERFORM 8500-DATE-CONVERT
 17821                                 THRU 8500-EXIT
 17822        IF no-CONVERSION-ERROR
 17823           IF DC-ELAPSED-DAYS < +16
 17824              GO TO 3999-END-EDIT
 17825           END-IF
 17826        END-IF
 17827     end-if
 17828***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17829***-_-
 17830***-_-   'NH' is 10%, TN is 3.5%
 17831***-_-
 17832***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17833*    if pb-state = 'NH'
 17834*       move +1.10               to ws-work-rate
 17835*    else
 17836*       move +1.035              to ws-work-rate
 17837*    end-if
 17838     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17839     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17840        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17841           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17842     IF WS-PAYMENT-AMT < 10.00
 17843        GO TO 3999-END-EDIT
 17844     END-IF
 17845*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17846
 17847     if (cm-soc-sec-no(1:9) numeric)
 17848        and (cm-soc-sec-no(1:9) not = zeros)
 17849        GO TO 3999-END-EDIT
 17850     END-IF
 17851     MOVE ER-2795                TO WS-ERROR
 17852     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17853
 17854     GO TO 3999-END-EDIT.
 17855******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 323
* EL050.cbl
 17857 3990-FILES-NOT-OPEN.
 17858
 17859     MOVE ER-2617                TO WS-ERROR.
 17860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17861     GO TO 9990-RETURN.
 17862
 17863 3999-END-EDIT.
 17864
 17865     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17866
 17867     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17868         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17869         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17870             PERFORM 9250-UNLOCK-RETURN
 17871             GO TO 9990-RETURN
 17872          ELSE
 17873             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17874             GO TO 9990-RETURN.
 17875
 17876     IF PB-CANCELLATION
 17877          GO TO 9990-RETURN.
 17878
 17879     IF CERT-WAS-NOT-FOUND
 17880        MOVE SPACES              TO CERTIFICATE-MASTER.
 17881
 17882     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17883
 17884     IF CERT-WAS-FOUND
 17885         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17886             PERFORM 9250-UNLOCK-RETURN
 17887          ELSE
 17888            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17889      ELSE
 17890         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17891
 17892*    if pb-company-id = 'VPP'
 17893*       perform 8150-read-elcrtt thru 8150-exit
 17894*       if ws-vehicle-odometer numeric
 17895*          if ws-vehicle-odometer > 6000
 17896*             move er-1583       to ws-error
 17897*             PERFORM 9900-ERROR-FORMAT
 17898*                                THRU 9900-EXIT
 17899*          end-if
 17900*       end-if
 17901*    end-if
 17902     if (pb-cert-sfx not = ' ')
 17903                 or
 17904        (pb-i-entry-status = 'V')
 17905        perform 7320-CHECK-FOR-OPEN-CLMS-issue
 17906                                 thru 7320-exit
 17907     end-if
 17908     perform 8145-read-elcrtt-upd thru 8145-exit
 17909     if not elcrtt-found
 17910        move 'CS'                to certificate-trailers
 17911        move cm-control-primary  to cs-control-primary
 17912        move 'C'                 TO cs-trailer-type
 17913        move zeros               to cs-vehicle-odometer
 17914     end-if
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 324
* EL050.cbl
 17915     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17916        IF ((PB-COMPANY-ID = 'DCC')
 17917           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17918                         or
 17919           (pb-company-id = 'CID' or 'VPP')
 17920           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 17921               or (hldi-pass-area not = spaces)
 17922               move pa-modelyear        to cs-year
 17923               move pa-makename         to cs-make
 17924               move pa-modelname        to cs-model
 17925               move pa-seriesname       to cs-future
 17926               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17927               move 'Y'                 to elcrtt-update-sw
 17928           end-if
 17929        end-if
 17930     end-if
 17931     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17932        IF WS-INS-AGE-SET = 'Y'
 17933           MOVE WS-INS-AGE-DEFAULTED
 17934                                 TO CS-INS-AGE-DEFAULT-FLAG
 17935           move 'Y'              to elcrtt-update-sw
 17936        END-IF
 17937        IF WS-JNT-AGE-SET = 'Y'
 17938           MOVE WS-JNT-AGE-DEFAULTED
 17939                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17940           move 'Y'              to elcrtt-update-sw
 17941        END-IF
 17942     end-if
 17943     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17944     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17945     move cs-vehicle-odometer    to ws-vehicle-odometer
 17946     if ws-ins-age-defaulted = 'Y'
 17947        move er-1573             to ws-error
 17948        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17949     end-if
 17950
 17951     if ws-jnt-age-defaulted = 'Y'
 17952        move er-1574             to ws-error
 17953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17954     end-if
 17955***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17956***                                                           ****
 17957***  Set an error if the state requires verification of agent ****
 17958***  and agent hasn't verified yet and the status is not =    ****
 17959***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17960***  and the entry date > 09/01/2015.                         ****
 17961***                                                           ****
 17962***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17963     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17964        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17965        and (pb-account (9:2) not = 'OB')
 17966        if (ws-st-agent-sig-edit = 'Y')
 17967           and (am-report-code-1 not = 'CONLEY')
 17968           evaluate true
 17969              when cs-agent-edit-status = 'C'
 17970                 move er-1743    to ws-error
 17971                 perform 9900-error-format
 17972                                 thru 9900-exit
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 325
* EL050.cbl
 17973              when cs-agent-edit-status = 'S'
 17974                 move er-1744    to ws-error
 17975                 perform 9900-error-format
 17976                                 thru 9900-exit
 17977              when cs-agent-edit-status = 'M'
 17978                 move er-1745    to ws-error
 17979                 perform 9900-error-format
 17980                                 thru 9900-exit
 17981              when cs-agent-edit-status = 'R'
 17982                 move er-1747    to ws-error
 17983                 perform 9900-error-format
 17984                                 thru 9900-exit
 17985              when cs-agent-edit-status = 'N'
 17986                 move er-1748    to ws-error
 17987                 perform 9900-error-format
 17988                                 thru 9900-exit
 17989              when cs-agent-edit-status <> 'V' and 'U' and
 17990                                           'R' and 'N' and
 17991                                           'H'
 17992                 move er-1746    to ws-error
 17993                 perform 9900-error-format
 17994                                 thru 9900-exit
 17995           end-evaluate
 17996        end-if
 17997     end-if
 17998*    move ' ' to cs-claim-verification-status
 17999*    move 'Y' to elcrtt-update-sw
 18000     if cs-claim-verification-status = ' ' or 'R'
 18001        move pb-state            to pa-clmhs-state
 18002        move pb-account          to pa-account
 18003        move ws-greg-eff-date    to pa-eff-dt
 18004        move pb-cert-no          to pa-cert-no
 18005        perform 7795-call-sqlclmhs
 18006                                 thru 7795-exit
 18007        if pa-clm-count > 0
 18008           if cs-claim-verification-status = ' '
 18009              move 'R'           to cs-claim-verification-status
 18010*             display 'Updating elcrtt ' pb-state ' '
 18011*                pb-account ' ' pb-cert-no
 18012              move 'Y'           to elcrtt-update-sw
 18013           end-if
 18014        else
 18015           if cs-claim-verification-status = 'R'
 18016              move ' '           to cs-claim-verification-status
 18017              move 'Y'           to elcrtt-update-sw
 18018           end-if
 18019        end-if
 18020     end-if
 18021
 18022     if cs-claim-verification-status <> ' '
 18023        evaluate true
 18024           when cs-claim-verification-status = 'R'
 18025              move er-1749    to ws-error
 18026              perform 9900-error-format
 18027                              thru 9900-exit
 18028           when cs-claim-verification-status = 'W'
 18029              move er-1750    to ws-error
 18030              perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 326
* EL050.cbl
 18031                              thru 9900-exit
 18032           when cs-claim-verification-status = 'I'
 18033              move er-1751    to ws-error
 18034              perform 9900-error-format
 18035                              thru 9900-exit
 18036           when cs-claim-verification-status = 'K'
 18037              move er-1761    to ws-error
 18038              perform 9900-error-format
 18039                              thru 9900-exit
 18040           when cs-claim-verification-status = 'A'
 18041              move er-1752    to ws-error
 18042              perform 9900-error-format
 18043                              thru 9900-exit
 18044           when cs-claim-verification-status = 'B'
 18045              move er-1754    to ws-error
 18046              perform 9900-error-format
 18047                              thru 9900-exit
 18048           when cs-claim-verification-status = 'C'
 18049              move er-1753    to ws-error
 18050              perform 9900-error-format
 18051                              thru 9900-exit
 18052           when cs-claim-verification-status = 'D'
 18053              move er-1757    to ws-error
 18054              perform 9900-error-format
 18055                              thru 9900-exit
 18056           when cs-claim-verification-status = 'E'
 18057              move er-1758    to ws-error
 18058              perform 9900-error-format
 18059                              thru 9900-exit
 18060           when cs-claim-verification-status = 'F'
 18061              move er-1759    to ws-error
 18062              perform 9900-error-format
 18063                              thru 9900-exit
 18064           when cs-claim-verification-status = 'G'
 18065              move er-1760    to ws-error
 18066              perform 9900-error-format
 18067                              thru 9900-exit
 18068*          when cs-claim-verification-status = 'H'
 18069*             move er-1756    to ws-error
 18070*             perform 9900-error-format
 18071*                             thru 9900-exit
 18072*          when cs-claim-verification-status = 'J'
 18073*             move er-1755    to ws-error
 18074*             perform 9900-error-format
 18075*                             thru 9900-exit
 18076        end-evaluate
 18077     end-if
 18078
 18079     IF ELCRTT-UPDATE
 18080        perform 8150-update-elcrtt thru 8150-exit
 18081*       display ' back from 8150 ' elcrtt-file-status
 18082     else
 18083        if elcrtt-found
 18084           perform 8155-unlock-elcrtt
 18085                                 thru 8155-exit
 18086        end-if
 18087     end-if
 18088     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 327
* EL050.cbl
 18089     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18090        AND (WS-NO-SECURE-PAY))
 18091                  OR
 18092        (WS-LF-SPECIAL-CALC-CD = 'O'
 18093        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18094        SET SKIP-ADDR-EDIT       TO TRUE
 18095     END-IF
 18096     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18097        AND (NOT SKIP-ADDR-EDIT)
 18098        MOVE ER-2963             TO WS-ERROR
 18099        PERFORM 9900-ERROR-FORMAT
 18100                                 THRU 9900-EXIT
 18101        GO TO 9990-RETURN
 18102     END-IF
 18103     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18104     IF ERPNDM-FOUND NOT = 'X'
 18105        move 'Y'                 to erpndm-unlock-sw
 18106        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18107           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18108           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18109           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18110           or (pm-zip-code    = zeros)
 18111           or (pm-zip-code not numeric))
 18112           AND (NOT SKIP-ADDR-EDIT)
 18113           MOVE ER-2694          TO WS-ERROR
 18114           PERFORM 9900-ERROR-FORMAT
 18115                                 THRU 9900-EXIT
 18116        END-IF
 18117        MOVE ' '                 TO STATE-RECORD-ERROR
 18118        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18119        MOVE PM-STATE            TO CNTL-ACCESS
 18120        MOVE '3'                 TO CNTL-REC-TYPE
 18121        MOVE +0                  TO CNTL-SEQ-NO
 18122        MOVE '0'                 TO RC-SW-2
 18123        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18124        IF (NO-STATE-RECORD)
 18125           OR (CF-RECORD-TYPE NOT = '3')
 18126           OR (PM-STATE NOT = CF-STATE-CODE)
 18127           IF (PM-STATE = SPACES)
 18128              AND (SKIP-ADDR-EDIT)
 18129              CONTINUE
 18130           ELSE
 18131              MOVE ER-2963       TO WS-ERROR
 18132              PERFORM 9900-ERROR-FORMAT
 18133                                 THRU 9900-EXIT
 18134           END-IF
 18135        END-IF
 18136        if (ws-error not = er-2963 and er-2694)
 18137           and (pm-city-st-zip-verified = ' ')
 18138           and (pb-company-id = 'CID')
 18139           move spaces           to zipcd-pass-area
 18140           move pm-zip-code      to pa-zip
 18141           move pm-city          to pa-city
 18142           move pm-state         to pa-state
 18143           perform 7790-call-zip-verify
 18144                                 thru 7790-exit
 18145           if pa-errorcode-zip (1:1) = ' '
 18146                    move 'Y'     to pm-city-st-zip-verified
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 328
* EL050.cbl
 18147                    PERFORM 8102-REWRITE-ERPNDM
 18148                                 THRU 8102-EXIT
 18149                    move 'N'     to erpndm-unlock-sw
 18150           else
 18151              MOVE ER-3061       TO WS-ERROR
 18152              PERFORM 9900-ERROR-FORMAT
 18153                                 THRU 9900-EXIT
 18154           end-if
 18155        end-if
 18156        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18157           MOVE ER-2883          TO WS-ERROR
 18158           PERFORM 9900-ERROR-FORMAT
 18159                                 THRU 9900-EXIT
 18160        END-IF
 18161        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18162           MOVE ' '                 TO STATE-RECORD-ERROR
 18163           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18164           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18165           MOVE '3'                 TO CNTL-REC-TYPE
 18166           MOVE +0                  TO CNTL-SEQ-NO
 18167           MOVE '0'                 TO RC-SW-2
 18168           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18169           IF NO-STATE-RECORD
 18170              OR (CF-RECORD-TYPE NOT = '3')
 18171              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18172              MOVE ER-2964          TO WS-ERROR
 18173              PERFORM 9900-ERROR-FORMAT
 18174                                    THRU 9900-EXIT
 18175           END-IF
 18176        END-IF
 18177     ELSE
 18178        IF NOT SKIP-ADDR-EDIT
 18179           MOVE ER-2393          TO WS-ERROR
 18180           PERFORM 9900-ERROR-FORMAT
 18181                                 THRU 9900-EXIT
 18182        END-IF
 18183     END-IF
 18184     if need-to-unlock-erpndm
 18185        perform 8104-unlock-erpndm
 18186                                 thru 8104-exit
 18187     end-if
 18188     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18189
 18190     IF (ERMAIL-FOUND = ' ' AND
 18191        ERPNDM-FOUND = ' ')
 18192        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18193           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18194           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18195          OR
 18196           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18197          OR
 18198           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18199           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18200           GO TO 3999-UNLOCK-ERMAIL.
 18201
 18202     IF ERPNDM-FOUND = 'X'
 18203        GO TO 3999-UNLOCK-ERMAIL.
 18204
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 329
* EL050.cbl
 18205     IF PM-INSURED-LAST-NAME      = SPACES
 18206        AND PM-INSURED-FIRST-NAME = SPACES
 18207        AND PM-ADDRESS-LINE-1     = SPACES
 18208        AND PM-ADDRESS-LINE-2     = SPACES
 18209        AND PM-CITY-STATE         = SPACES
 18210        AND PM-CRED-BENE-NAME     = SPACES
 18211        AND PM-CRED-BENE-ADDR     = SPACES
 18212        AND PM-CRED-BENE-CTYST    = SPACES
 18213        GO TO 3999-UNLOCK-ERMAIL
 18214     END-IF
 18215
 18216     MOVE SPACES                 TO MAILING-DATA.
 18217
 18218     MOVE 'MA'                   TO MA-RECORD-ID.
 18219     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18220     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18221     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18222     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18223     MOVE PB-SV-STATE            TO MA-STATE.
 18224     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18225     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18226
 18227     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18228     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18229
 18230     IF ERMAIL-FOUND = ' '
 18231        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18232     ELSE
 18233        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18234        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18235        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18236
 18237     GO TO 9990-RETURN.
 18238
 18239 3999-UNLOCK-ERMAIL.
 18240     IF ERMAIL-FOUND = ' '
 18241        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18242
 18243     GO TO 9990-RETURN.
 18244******************************************************************
 18245
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 330
* EL050.cbl
 18247 4000-UPDATE-CANCELLED-CERT.
 18248     IF CERT-WAS-NOT-FOUND
 18249        GO TO 4299-EXIT.
 18250
 18251*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18252     IF PB-C-INT-ON-REFS > ZEROS
 18253        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18254     END-IF
 18255     IF PB-C-REF-INTERFACE-SW = 'Y'
 18256        MOVE PB-C-REF-INTERFACE-SW
 18257                                 TO CM-ref-INTERFACE-SW
 18258     END-IF
 18259*    IF ERMAIL-FOUND = ' '
 18260*       PERFORM 8140-UNLOCK-ERMAIL
 18261*                                THRU 8140-EXIT
 18262*    end-if
 18263     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18264     IF ERMAIL-FOUND = 'X'
 18265        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18266        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18267        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18268        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18269           MOVE ER-2694          TO WS-ERROR
 18270           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18271     END-IF
 18272
 18273     IF PB-C-POST-CARD-IND = 'Y'
 18274        MOVE +8                  TO SUB
 18275*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18276        IF ERMAIL-FOUND = ' '
 18277           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18278              (SUB > +7)
 18279              OR (MA-MAIL-STATUS (SUB) = '1')
 18280           END-PERFORM
 18281        END-IF
 18282        IF (SUB > +7)
 18283           OR (ERMAIL-FOUND = 'X')
 18284           MOVE ER-3789          TO WS-ERROR
 18285           PERFORM 9900-ERROR-FORMAT
 18286                                 THRU 9900-EXIT
 18287        END-IF
 18288     ELSE
 18289        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18290     END-IF
 18291
 18292     IF ERMAIL-FOUND = ' '
 18293        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18294     END-IF.
 18295
 18296     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18297
 18298     IF PB-CI-OB-FLAG = 'Z'
 18299        GO TO 4150-SUMMARY-CERT-CANCEL.
 18300     perform 8145-read-elcrtt-upd thru 8145-exit
 18301     if not elcrtt-found
 18302        move 'CS'                to certificate-trailers
 18303        move cm-control-primary  to cs-control-primary
 18304        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 331
* EL050.cbl
 18305        move zeros               to cs-vehicle-odometer
 18306     end-if
 18307
 18308     if pb-lf-refund-type <> cs-lf-refund-method
 18309        move pb-lf-refund-type   to cs-lf-refund-method
 18310        set elcrtt-update to true
 18311     end-if
 18312     if pb-ah-refund-type <> cs-ah-refund-method
 18313        move pb-ah-refund-type   to cs-ah-refund-method
 18314        set elcrtt-update to true
 18315     end-if
 18316     IF PB-C-LF-CANCEL-VOIDED
 18317         PERFORM 4200-REVERSE-LF-CANCEL.
 18318     IF PB-C-AH-CANCEL-VOIDED
 18319         PERFORM 4200-REVERSE-AH-CANCEL.
 18320     IF ELCRTT-UPDATE
 18321        perform 8150-update-elcrtt thru 8150-exit
 18322     else
 18323        if elcrtt-found
 18324           perform 8155-unlock-elcrtt
 18325                                 thru 8155-exit
 18326        end-if
 18327     end-if
 18328     .
 18329 4100-APPLY-LF-CANCEL.
 18330
 18331     MOVE +0                     TO WS-SUB.
 18332
 18333 4100-CHECK-LF-ERRORS.
 18334
 18335     ADD +1                       TO WS-SUB.
 18336
 18337     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18338        IF LF-COVERAGE-CANCELLED
 18339           GO TO 4100-LF-CANCEL-CONT
 18340        ELSE
 18341           GO TO 4100-UPDATE-LF-COVERAGE.
 18342
 18343     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18344                                   ER-2729 OR
 18345                                   ER-2730 OR
 18346                                   ER-2731 OR
 18347                                   ER-2732 OR
 18348                                   ER-2737 OR
 18349                                   ER-2740 OR
 18350                                   ER-2743 OR
 18351                                   ER-2749 OR
 18352                                   ER-2750 OR
 18353                                   ER-2755 OR
 18354                                   ER-2757 OR
 18355                                   ER-2760 OR
 18356                                   ER-2772 OR
 18357                                   ER-2774 OR
 18358                                   ER-2776 OR
 18359                                   ER-2794
 18360        GO TO 4100-UPDATE-LF-COVERAGE.
 18361
 18362     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 332
* EL050.cbl
 18363
 18364 4100-UPDATE-LF-COVERAGE.
 18365
 18366     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18367     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18368     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18369        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18370     END-IF
 18371     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18372                                      TO CM-CREDIT-INTERFACE-SW-2.
 18373     IF CM-LF-CANCEL-DT = LOW-VALUE
 18374         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18375
 18376     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18377         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18378                                         CM-LF-STATUS-AT-CANCEL.
 18379
 18380     GO TO 4100-APPLY-AH-CANCEL.
 18381
 18382 4100-LF-CANCEL-CONT.
 18383     IF PB-C-LF-CANCEL-VOIDED
 18384         GO TO 4100-APPLY-AH-CANCEL.
 18385
 18386     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18387         GO TO 4100-APPLY-AH-CANCEL.
 18388
 18389     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18390        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18391           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18392        ELSE
 18393           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18394
 18395     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18396     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18397
 18398     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18399         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18400
 18401     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18402        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18403         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18404         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18405
 18406     IF PB-RECORD-RETURNED
 18407        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18408      ELSE
 18409        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18410
 18411 4100-APPLY-AH-CANCEL.
 18412
 18413     MOVE +0                      TO WS-SUB.
 18414
 18415 4100-CHECK-AH-ERRORS.
 18416
 18417     ADD +1                       TO WS-SUB.
 18418
 18419     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18420        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 333
* EL050.cbl
 18421           GO TO 4100-AH-CANCEL-CONT
 18422        ELSE
 18423           GO TO 4100-UPDATE-AH-COVERAGE.
 18424
 18425     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18426                                   ER-2729 OR
 18427                                   ER-2732 OR
 18428                                   ER-2737 OR
 18429                                   ER-2740 OR
 18430                                   ER-2744 OR
 18431                                   ER-2749 OR
 18432                                   ER-2750 OR
 18433                                   ER-2755 OR
 18434                                   ER-2757 OR
 18435                                   ER-2760 OR
 18436                                   ER-2771 OR
 18437                                   ER-2772 OR
 18438                                   ER-2773 OR
 18439                                   ER-2775 OR
 18440                                   ER-2777 OR
 18441                                   ER-2778 OR
 18442                                   ER-2794
 18443        GO TO 4100-UPDATE-AH-COVERAGE.
 18444
 18445     GO TO 4100-CHECK-AH-ERRORS.
 18446
 18447 4100-UPDATE-AH-COVERAGE.
 18448
 18449     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18450     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18451     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18452     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18453                                      TO CM-CREDIT-INTERFACE-SW-2.
 18454     IF CM-AH-CANCEL-DT = LOW-VALUE
 18455         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18456
 18457     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18458         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18459                                         CM-AH-STATUS-AT-CANCEL.
 18460
 18461     IF LF-COVERAGE-CANCELLED
 18462         IF PB-RECORD-RETURNED
 18463              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18464          ELSE
 18465              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18466
 18467     GO TO 4299-EXIT.
 18468
 18469 4100-AH-CANCEL-CONT.
 18470     IF PB-C-AH-CANCEL-VOIDED
 18471         GO TO 4299-EXIT.
 18472
 18473     if cm-credit-interface-sw-2 = ' '
 18474        if pb-fatal-errors or pb-unforced-errors
 18475           move '4'              to cm-credit-interface-sw-2
 18476        else
 18477           move '1'              to cm-credit-interface-sw-2
 18478        end-if
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 334
* EL050.cbl
 18479     end-if
 18480     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18481         GO TO 4299-EXIT.
 18482
 18483     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18484        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18485           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18486        ELSE
 18487           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18488
 18489     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18490     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18491
 18492     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18493         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18494
 18495     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18496         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18497         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18498
 18499     IF PB-RECORD-RETURNED
 18500        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18501      ELSE
 18502        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18503
 18504     GO TO 4299-EXIT.
 18505
 18506 4150-SUMMARY-CERT-CANCEL.
 18507     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18508
 18509     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18510        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18511                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18512     ELSE
 18513        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18514                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18515
 18516     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18517        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18518                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18519     ELSE
 18520        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18521                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18522
 18523     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18524        NEXT SENTENCE
 18525     ELSE
 18526        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18527
 18528     GO TO 4299-EXIT.
 18529
 18530 4200-REVERSE-LF-CANCEL.
 18531     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18532
 18533     IF CM-LF-CANCEL-APPLIED
 18534        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18535        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18536        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 335
* EL050.cbl
 18537
 18538     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18539
 18540     IF PB-RECORD-RETURNED
 18541        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18542       ELSE
 18543        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18544
 18545 4200-REVERSE-LF-EXIT.
 18546       EXIT.
 18547
 18548 4200-REVERSE-AH-CANCEL.
 18549     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18550
 18551     IF CM-AH-CANCEL-APPLIED
 18552        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18553        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18554        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18555
 18556     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18557
 18558     IF PB-RECORD-RETURNED
 18559        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18560       ELSE
 18561        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18562
 18563 4200-REVERSE-AH-EXIT.
 18564       EXIT.
 18565
 18566 4299-EXIT.
 18567       EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 336
* EL050.cbl
 18569
 18570 4500-UPDATE-NEW-CERT.
 18571     IF CERT-WAS-FOUND
 18572         NEXT SENTENCE
 18573       ELSE
 18574         GO TO 4520-BUILD-NEW-KEY.
 18575
 18576     IF  CLASIC-CREATED-CERT
 18577         GO TO 4999-EXIT.
 18578
 18579     IF  CERT-WAS-CREATED-FOR-CLAIM
 18580         GO TO 4520-BUILD-NEW-KEY.
 18581
 18582     IF CERT-ADDED-BATCH
 18583        IF CM-RECORD-ID = 'CM'
 18584            GO TO 4999-EXIT.
 18585
 18586 4520-BUILD-NEW-KEY.
 18587* BUILD CONTROL PRIMARY
 18588
 18589     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18590                                       CM-COMPANY-CD-A1
 18591                                       CM-COMPANY-CD-A2
 18592                                       CM-COMPANY-CD-A4
 18593                                       CM-COMPANY-CD-A5.
 18594
 18595     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18596     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18597     MOVE PB-SV-STATE               TO CM-STATE.
 18598     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18599     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18600     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18601     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18602
 18603     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18604
 18605     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18606     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18607     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18608     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18609
 18610     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18611        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18612
 18613     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18614         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18615         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18616         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18617         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18618     ELSE
 18619         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18620
 18621     IF PB-COMPANY-ID   EQUAL  'CRI'
 18622         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18623         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18624         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18625         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18626         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 337
* EL050.cbl
 18627
 18628     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18629        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18630         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18631
 18632     IF PB-COMPANY-ID  = 'LBL'
 18633        IF PB-I-JOINT-COVERAGE
 18634            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18635                                           PB-I-MEMBER-NO
 18636            GO TO 4550-CONT-CERT-PROCESS.
 18637
 18638     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18639        NEXT SENTENCE
 18640     ELSE
 18641        GO TO 4540-BUILD-MEMBER-NO.
 18642
 18643******************************************************************
 18644*                                                                *
 18645*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18646*    FOR 'MON'.                                                  *
 18647*                                                                *
 18648******************************************************************
 18649
 18650     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18651     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18652     MOVE +1                     TO WS-SUB1
 18653                                    WS-SUB2.
 18654
 18655 4530-EDIT-MEMB-NAME.
 18656
 18657     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18658        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18659        ADD +1                       TO WS-SUB2.
 18660
 18661     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18662        ADD +1                       TO WS-SUB1
 18663        GO TO 4530-EDIT-MEMB-NAME.
 18664
 18665     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18666     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18667     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18668*    MOVE SPACE                      TO DC-OPTION-CODE.
 18669     SET  BIN-TO-GREG                TO TRUE.
 18670     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18671     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18672
 18673     GO TO 4550-CONT-CERT-PROCESS.
 18674
 18675******************************************************************
 18676*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18677******************************************************************
 18678
 18679 4540-BUILD-MEMBER-NO.
 18680
 18681     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18682         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18683         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18684         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 338
* EL050.cbl
 18685         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18686     ELSE
 18687         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18688
 18689     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18690        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18691         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18692
 18693 4550-CONT-CERT-PROCESS.
 18694
 18695*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18696*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18697*    ELSE
 18698*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18699
 18700     IF CERT-WAS-CREATED-FOR-CLAIM
 18701        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18702        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18703
 18704     IF CERT-AND-CLAIM-ONLINE
 18705        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18706        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18707
 18708     MOVE 'CM'                     TO CM-RECORD-ID.
 18709     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18710
 18711     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18712        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18713        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18714     ELSE
 18715        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18716        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18717
 18718     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18719     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18720     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18721     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18722     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18723     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18724     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18725                                      CM-LF-ITD-CANCEL-AMT
 18726                                      CM-LF-ITD-DEATH-AMT
 18727                                      CM-AH-ITD-AH-PMT
 18728                                      CM-AH-ITD-LUMP-PMT
 18729                                      CM-AH-ITD-CANCEL-AMT
 18730                                      CM-LF-NSP-PREMIUM-AMT
 18731                                      CM-AH-NSP-PREMIUM-AMT.
 18732*                                     CM-CLAIM-DEDUCT-WITHHELD
 18733*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18734     if pb-i-loan-apr = +99.9999
 18735        move zeros                 to cm-loan-apr
 18736     else
 18737        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18738     end-if
 18739     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18740     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18741     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18742     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 339
* EL050.cbl
 18743     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18744     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18745     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18746     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18747     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18748     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18749     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18750
 18751     IF PB-I-LIVES NOT NUMERIC
 18752         MOVE ZERO                 TO PB-I-LIVES.
 18753
 18754     IF PB-I-NUM-BILLED NOT NUMERIC
 18755         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18756
 18757     MOVE PB-I-LIVES               TO CM-LIVES.
 18758     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18759
 18760     IF PB-COMPANY-ID EQUAL  'DMD'
 18761         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18762         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18763
 18764     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18765     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18766     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18767     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18768     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18769     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18770
 18771     IF PB-I-LF-POLICY-FEE NUMERIC
 18772        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18773     ELSE
 18774        MOVE +0                    TO CM-LF-POLICY-FEE.
 18775
 18776     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18777        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18778        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18779     ELSE
 18780        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18781
 18782     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18783     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18784     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18785     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18786     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18787     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18788     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18789     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18790     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18791
 18792     IF PB-I-CANCEL-FEE NUMERIC
 18793        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18794     ELSE
 18795        MOVE +0                  TO CM-CANCEL-FEE
 18796     END-IF
 18797
 18798     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18799        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18800     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 340
* EL050.cbl
 18801        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18802
 18803     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18804     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18805
 18806     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18807                                      CM-LF-DEATH-EXIT-DT
 18808                                      CM-AH-SETTLEMENT-EXIT-DT.
 18809
 18810*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18811*                       'TIH' OR 'OFL' OR 'FLA' OR
 18812*                       'TII' OR 'TMS' OR 'CRI' OR
 18813*                       'NCL'
 18814     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18815
 18816     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18817         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18818            MOVE '2'                TO CM-PREMIUM-TYPE.
 18819
 18820     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18821         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18822            MOVE '2'                TO CM-PREMIUM-TYPE.
 18823
 18824     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18825         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18826     ELSE
 18827         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18828         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18829
 18830     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18831     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18832     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18833     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18834     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18835     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18836     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18837     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18838
 18839     IF PB-NO-MONTHS-SKIPPED
 18840         MOVE SPACE                 TO CM-SKIP-CODE
 18841     ELSE
 18842         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18843
 18844     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18845     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18846                                       CM-LF-STATUS-AT-CANCEL.
 18847
 18848     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18849     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18850                                       CM-AH-STATUS-AT-CANCEL.
 18851
 18852     MOVE '1'                       TO CM-ENTRY-STATUS.
 18853
 18854     IF PB-REISSUED-CERT
 18855        MOVE '5'                    TO CM-ENTRY-STATUS.
 18856
 18857     IF PB-MONTHLY-CERT
 18858        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 341
* EL050.cbl
 18859
 18860     IF PB-CASH-CERT
 18861        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18862
 18863     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18864     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18865     IF PB-POLICY-IS-DECLINED
 18866        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18867
 18868     IF PB-POLICY-IS-VOIDED
 18869        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18870
 18871     IF PB-NEEDS-UNDERWRITING
 18872        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18873
 18874     IF PB-REIN-ONLY-CERT
 18875        MOVE '9'                    TO CM-ENTRY-STATUS.
 18876
 18877     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18878         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18879     ELSE
 18880         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18881
 18882     IF PB-RECORD-RETURNED
 18883        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18884      ELSE
 18885        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18886
 18887     IF PB-I-MAIL-ADDRS-PRESENT
 18888        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18889
 18890     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18891                                       CM-ENTRY-DT.
 18892
 18893 4999-EXIT.
 18894     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 342
* EL050.cbl
 18896
 18897 5000-PROCESS-REPS.
 18898     MOVE ' '                    TO AGTC-MASTER-SW
 18899     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18900     MOVE CO-TYPE                TO AGTC-TYPE
 18901     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18902     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18903     IF (AGTC-MASTER-SW NOT = 'N')
 18904        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18905        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18906        PERFORM 8583-READ-ERAGTC-NEXT
 18907                                 THRU 8583-EXIT
 18908     END-IF
 18909     IF AGTC-MASTER-SW = 'N'
 18910        CONTINUE
 18911     ELSE
 18912        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18913           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18914              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18915              MOVE 'Y'           TO AGTC-MASTER-SW
 18916           END-IF
 18917        END-IF
 18918     END-IF
 18919     .
 18920 5000-EXIT.
 18921     EXIT.
 18922 6370-EDIT-INPUT-LF-CODE.
 18923     move ' ' to ws-benefit-cd-chg-sw
 18924     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18925        MOVE +1                  TO SUB
 18926        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18927        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18928        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18929        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18930        GO TO 6370-SEARCH-LOOP.
 18931
 18932     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18933
 18934     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18935     MOVE SPACES                 TO CNTL-ACCESS.
 18936*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18937     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18938     MOVE +0                     TO CNTL-SEQ-NO.
 18939     MOVE '4' TO RC-SW-2.
 18940     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18941
 18942     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18943        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18944        GO TO 6370-NO-LF-FOUND.
 18945
 18946     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18947     MOVE +1                     TO SUB.
 18948
 18949 6370-SEARCH-LOOP.
 18950     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18951         GO TO 6370-NO-LF-FOUND.
 18952
 18953     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 343
* EL050.cbl
 18954        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18955           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18956           set benefit-code-chg to true
 18957        end-if
 18958        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18959        GO TO 6370-HER-NET-PAY-CHECK.
 18960
 18961     ADD 1   TO SUB.
 18962*    IF SUB GREATER 120
 18963     IF SUB GREATER 200
 18964         GO TO 6370-NO-LF-FOUND.
 18965
 18966     GO TO 6370-SEARCH-LOOP.
 18967
 18968 6370-NO-LF-FOUND.
 18969
 18970     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18971        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18972        set benefit-code-chg to true
 18973     end-if
 18974     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18975
 18976 6370-HER-NET-PAY-CHECK.
 18977
 18978     IF PB-COMPANY-ID = 'CID'
 18979        IF PB-SV-STATE = 'CA' OR 'MN'
 18980           IF PB-I-LF-BENEFIT-CD = '02'
 18981              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18982           ELSE
 18983              IF PB-I-LF-BENEFIT-CD = '04'
 18984                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18985              END-IF
 18986           END-IF
 18987        END-IF
 18988     END-IF
 18989
 18990     IF PB-COMPANY-ID NOT = 'HER'
 18991         GO TO 6370-EXIT.
 18992
 18993     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18994         GO TO 6370-EXIT.
 18995
 18996     IF PB-I-LF-TERM NOT NUMERIC
 18997         MOVE ZEROS              TO PB-I-LF-TERM.
 18998
 18999     IF PB-I-LOAN-TERM NOT NUMERIC
 19000         MOVE ZEROS              TO PB-I-LOAN-TERM.
 19001
 19002     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 19003         GO TO 6370-EXIT.
 19004
 19005     IF PB-I-LF-BENEFIT-CD = '33'
 19006         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 19007
 19008     IF PB-I-LF-BENEFIT-CD = '34'
 19009         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 19010
 19011 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 344
* EL050.cbl
 19012     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 345
* EL050.cbl
 19014
 19015 6380-EDIT-INPUT-AH-CODE.
 19016     IF WK-AH-EDIT-ADDR NOT = ZEROS
 19017        MOVE +1                  TO SUB
 19018        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 19019        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 19020        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 19021        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 19022        GO TO 6380-SEARCH-LOOP.
 19023
 19024     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 19025
 19026     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 19027     MOVE SPACES                 TO CNTL-ACCESS.
 19028     MOVE 'A'                    TO CNTL-REC-TYPE.
 19029*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 19030     MOVE +0                     TO CNTL-SEQ-NO.
 19031     MOVE '5' TO RC-SW-2.
 19032     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19033
 19034     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19035        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19036        GO TO 6380-NO-AH-FOUND.
 19037
 19038     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19039     MOVE +1 TO SUB.
 19040
 19041 6380-SEARCH-LOOP.
 19042     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19043         GO TO 6380-NO-AH-FOUND.
 19044
 19045     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19046         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19047         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19048
 19049     ADD 1   TO SUB.
 19050     IF SUB GREATER THAN 96
 19051*    IF SUB GREATER THAN 300
 19052         GO TO 6380-NO-AH-FOUND.
 19053
 19054     GO TO 6380-SEARCH-LOOP.
 19055
 19056 6380-NO-AH-FOUND.
 19057
 19058     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19059
 19060     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19061         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19062     ELSE
 19063         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19064
 19065 6380-CSO-AH-ONLY-CHECKS.
 19066
 19067     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19068        NEXT SENTENCE
 19069      ELSE
 19070        GO TO 6380-EXIT.
 19071
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 346
* EL050.cbl
 19072     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19073         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19074
 19075
 19076     GO TO 6380-EXIT
 19077     .
 19078 6380-CSO-LIFE-WITH-AH-CHECKS.
 19079
 19080
 19081     .
 19082 6380-EXIT.
 19083     EXIT.
 19084
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 347
* EL050.cbl
 19086
 19087 6400-COMPUTE-EXTENSION-DAYS.
 19088
 19089******************************************************************
 19090*                                                                *
 19091*                   COMPUTE EXTENSION DAYS                       *
 19092*                                                                *
 19093*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19094*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19095*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19096*    THE EXTENSION DAYS.                                         *
 19097*                                                                *
 19098******************************************************************
 19099
 19100     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19101     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19102
 19103******************************************************************
 19104*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19105*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19106******************************************************************
 19107
 19108     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19109        COMPUTE WS-ODD-DAYS-OVER =
 19110               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19111     ELSE
 19112        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19113
 19114     IF WS-ODD-DAYS-OVER = ZEROS
 19115           GO TO 6499-EXIT
 19116     ELSE
 19117        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19118           IF WS-WDF-MONTH = 02
 19119              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19120              ADD 2       TO  WS-ODD-DAYS-OVER
 19121              GO TO 6499-EXIT
 19122           ELSE
 19123              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19124                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19125                 GO TO 6499-EXIT
 19126               ELSE
 19127                 GO TO 6499-EXIT
 19128        ELSE
 19129           GO TO 6499-EXIT.
 19130
 19131 6412-CHECK-TO-DAY.
 19132
 19133        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19134           IF WS-WDT-DAY = 28
 19135              ADD 2              TO WS-ODD-DAYS-OVER
 19136           ELSE
 19137              IF WS-WDT-DAY = 29
 19138                 ADD 1           TO WS-ODD-DAYS-OVER
 19139              ELSE
 19140                 NEXT SENTENCE
 19141        ELSE
 19142           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19143              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 348
* EL050.cbl
 19144
 19145     GO TO 6499-EXIT.
 19146
 19147
 19148 6415-CHECK-LEAP-YEAR.
 19149
 19150     IF DC-DAYS-IN-MONTH = 29
 19151        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19152
 19153 6415-EXIT.
 19154     EXIT.
 19155
 19156 6499-EXIT.
 19157      EXIT.
 19158
 19159 6500-END.
 19160     EXIT.
 19161
 19162
 19163******************************************************************
 19164************* PROCEDURE DIVISION FOR EL050 ***********************
 19165********************** ELC50PD END *******************************
 19166
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 349
* EL050.cbl
 19168
 19169**START***********************************************************
 19170*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19171*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19172******************************************************************
 19173*
 19174 6600-GET-STATE-MUNICIPAL-TAX.
 19175
 19176     IF PB-COMPANY-ID NOT = 'DMD'
 19177         GO TO 6640-EXIT.
 19178
 19179     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19180     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19181     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19182*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19183*
 19184***  Y2K PROJ 7744
 19185     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19186     SET BIN-TO-GREG          TO TRUE.
 19187     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19188
 19189     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19190
 19191     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19192     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19193
 19194
 19195* EXEC CICS HANDLE CONDITION
 19196*        INVREQ    (6610-START-BROWSE)
 19197*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19198*        NOTFND    (6630-END-OF-FILE)
 19199*    END-EXEC.
 19200*    MOVE '"$8JI                 ! # #00019184' TO DFHEIV0
 19201     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19203     MOVE X'2320233030303139313834' TO DFHEIV0(25:11)
 19204     CALL 'kxdfhei1' USING DFHEIV0
 19205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19206
 19207
 19208 6610-START-BROWSE.
 19209
 19210
 19211* EXEC CICS HANDLE CONDITION
 19212*        NOTFND    (6630-END-OF-FILE)
 19213*        DISABLED  (6630-ERRESS-PROBLEM)
 19214*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19215*        ENDFILE   (6630-END-OF-FILE)
 19216*    END-EXEC.
 19217*    MOVE '"$IcJ''                ! $ #00019192' TO DFHEIV0
 19218     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19220     MOVE X'2420233030303139313932' TO DFHEIV0(25:11)
 19221     CALL 'kxdfhei1' USING DFHEIV0
 19222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19223
 19224
 19225
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 350
* EL050.cbl
 19226* EXEC CICS STARTBR
 19227*        DATASET (FILE-ID-ERRESS)
 19228*        RIDFLD  (WS-ERRESS-KEY)
 19229*        GTEQ
 19230*    END-EXEC.
 19231     MOVE 0
 19232       TO DFHEIV11
 19233*    MOVE '&,         G          &   #00019199' TO DFHEIV0
 19234     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19236     MOVE X'2020233030303139313939' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0,
 19238           FILE-ID-ERRESS,
 19239           WS-ERRESS-KEY,
 19240           DFHEIV99,
 19241           DFHEIV11,
 19242           DFHEIV99
 19243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19244
 19245
 19246 6620-READ-NEXT-ERRESS-MASTER.
 19247
 19248
 19249* EXEC CICS HANDLE CONDITION
 19250*        NOTFND    (6630-END-OF-FILE)
 19251*        ENDFILE   (6630-END-OF-FILE)
 19252*        DISABLED  (6630-ERRESS-PROBLEM)
 19253*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19254*    END-EXEC.
 19255*    MOVE '"$I''cJ                ! % #00019207' TO DFHEIV0
 19256     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19258     MOVE X'2520233030303139323037' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0
 19260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19261
 19262
 19263
 19264* EXEC CICS READNEXT
 19265*        DATASET (FILE-ID-ERRESS)
 19266*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19267*        RIDFLD  (WS-ERRESS-KEY)
 19268*    END-EXEC.
 19269     MOVE LENGTH OF
 19270      RESIDENT-STATE-TAX-MASTER
 19271       TO DFHEIV12
 19272     MOVE 0
 19273       TO DFHEIV11
 19274*    MOVE '&.IL                  )   #00019214' TO DFHEIV0
 19275     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19276     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19277     MOVE X'2020233030303139323134' TO DFHEIV0(25:11)
 19278     CALL 'kxdfhei1' USING DFHEIV0,
 19279           FILE-ID-ERRESS,
 19280           RESIDENT-STATE-TAX-MASTER,
 19281           DFHEIV12,
 19282           WS-ERRESS-KEY,
 19283           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 351
* EL050.cbl
 19284           DFHEIV11,
 19285           DFHEIV99,
 19286           DFHEIV99
 19287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19288
 19289
 19290     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19291
 19292* EXEC CICS ENDBR
 19293*            DATASET (FILE-ID-ERRESS)
 19294*       END-EXEC
 19295     MOVE 0
 19296       TO DFHEIV11
 19297*    MOVE '&2                    $   #00019221' TO DFHEIV0
 19298     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19300     MOVE X'2020233030303139323231' TO DFHEIV0(25:11)
 19301     CALL 'kxdfhei1' USING DFHEIV0,
 19302           FILE-ID-ERRESS,
 19303           DFHEIV11,
 19304           DFHEIV99
 19305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19306        GO TO 6630-END-OF-FILE.
 19307
 19308     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19309        NEXT SENTENCE
 19310      ELSE
 19311        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19312
 19313*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19314*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19315*
 19316     MOVE +2                     TO WS-SUB1.
 19317
 19318     IF PB-ISSUE
 19319     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19320        MOVE +1                  TO WS-SUB1.
 19321
 19322     IF PB-CANCELLATION
 19323     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19324        MOVE +1                  TO WS-SUB1.
 19325*
 19326*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19327*
 19328***  Y2K PROJ 7744
 19329     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19330***  Y2K PROJ 7744
 19331
 19332*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19333* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19334* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19335
 19336     ADD 1                    TO WS-YEAR-YY.
 19337
 19338     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19339         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19340                              TO WS-RES-STATE-TAX
 19341         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 352
* EL050.cbl
 19342                              TO WS-RES-MUNI-TAX
 19343     ELSE
 19344         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19345                              TO WS-RES-STATE-TAX
 19346         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19347                              TO WS-RES-MUNI-TAX.
 19348
 19349*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19350
 19351     IF PB-CANCELLATION
 19352         GO TO 6640-CANCEL-TAX.
 19353
 19354     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19355         COMPUTE PB-I-STATE-TAX ROUNDED =
 19356                                   PB-I-LF-PREMIUM-AMT
 19357                                 * WS-RES-STATE-TAX
 19358         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19359                                   PB-I-LF-PREMIUM-AMT
 19360                                 * WS-RES-MUNI-TAX
 19361     ELSE
 19362     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19363         COMPUTE PB-I-STATE-TAX ROUNDED =
 19364                                   PB-I-AH-PREMIUM-AMT
 19365                                 * WS-RES-STATE-TAX
 19366         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19367                                   PB-I-AH-PREMIUM-AMT
 19368                                 * WS-RES-MUNI-TAX.
 19369
 19370
 19371* EXEC CICS ENDBR
 19372*         DATASET (FILE-ID-ERRESS)
 19373*    END-EXEC.
 19374     MOVE 0
 19375       TO DFHEIV11
 19376*    MOVE '&2                    $   #00019288' TO DFHEIV0
 19377     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303139323838' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0,
 19381           FILE-ID-ERRESS,
 19382           DFHEIV11,
 19383           DFHEIV99
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19385
 19386
 19387     GO TO 6640-EXIT.
 19388
 19389 6640-CANCEL-TAX.
 19390     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19391
 19392     IF PB-C-LF-CANCEL-AMT > ZEROS
 19393         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19394                                   PB-C-LF-CANCEL-AMT
 19395                                 * WS-RES-STATE-TAX
 19396         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19397                                   PB-C-LF-CANCEL-AMT
 19398                                *  WS-RES-MUNI-TAX
 19399     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 353
* EL050.cbl
 19400     IF PB-C-AH-CANCEL-AMT > ZEROS
 19401         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19402                                   PB-C-AH-CANCEL-AMT
 19403                                 * WS-RES-STATE-TAX
 19404         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19405                                   PB-C-AH-CANCEL-AMT
 19406                                *  WS-RES-MUNI-TAX.
 19407
 19408
 19409* EXEC CICS ENDBR
 19410*         DATASET (FILE-ID-ERRESS)
 19411*    END-EXEC.
 19412     MOVE 0
 19413       TO DFHEIV11
 19414*    MOVE '&2                    $   #00019313' TO DFHEIV0
 19415     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19416     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19417     MOVE X'2020233030303139333133' TO DFHEIV0(25:11)
 19418     CALL 'kxdfhei1' USING DFHEIV0,
 19419           FILE-ID-ERRESS,
 19420           DFHEIV11,
 19421           DFHEIV99
 19422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19423
 19424
 19425     GO TO 6640-EXIT.
 19426
 19427 6630-END-OF-FILE.
 19428     MOVE ER-8002              TO WS-ERROR.
 19429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19430
 19431     GO TO 6640-EXIT.
 19432
 19433 6630-ERRESS-PROBLEM.
 19434     MOVE ER-8044              TO WS-ERROR.
 19435     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19436
 19437 6640-EXIT.
 19438     EXIT.
 19439
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 354
* EL050.cbl
 19441 6650-GET-RES-STATE-COMM.
 19442
 19443     IF PB-COMPANY-ID NOT = 'DMD'
 19444         GO TO 6700-COMM-EXIT.
 19445
 19446     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19447     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19448     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19449     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19450     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19451     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19452     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19453
 19454*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19455*
 19456***  Y2K PROJ 7744
 19457     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19458     SET BIN-TO-GREG          TO TRUE.
 19459     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19460
 19461     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19462***  Y2K PROJ 7744
 19463
 19464     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19465
 19466
 19467* EXEC CICS HANDLE CONDITION
 19468*        INVREQ    (6660-START-BROWSE)
 19469*        DISABLED  (6690-ERRESC-PROBLEM)
 19470*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19471*        NOTFND    (6690-END-OF-FILE)
 19472*    END-EXEC.
 19473*    MOVE '"$8cJI                ! & #00019358' TO DFHEIV0
 19474     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19476     MOVE X'2620233030303139333538' TO DFHEIV0(25:11)
 19477     CALL 'kxdfhei1' USING DFHEIV0
 19478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19479
 19480
 19481
 19482* EXEC CICS RESETBR
 19483*        DATASET (FILE-ID-ERRESC)
 19484*        RIDFLD  (WS-ERRESC-KEY)
 19485*    END-EXEC.
 19486     MOVE 0
 19487       TO DFHEIV11
 19488*    MOVE '&4         G          &   #00019365' TO DFHEIV0
 19489     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19490     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19491     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 19492     CALL 'kxdfhei1' USING DFHEIV0,
 19493           FILE-ID-ERRESC,
 19494           WS-ERRESC-KEY,
 19495           DFHEIV99,
 19496           DFHEIV11,
 19497           DFHEIV99
 19498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 355
* EL050.cbl
 19499
 19500
 19501 6660-START-BROWSE.
 19502
 19503
 19504* EXEC CICS HANDLE CONDITION
 19505*        NOTFND    (6690-END-OF-FILE)
 19506*        DISABLED  (6690-ERRESC-PROBLEM)
 19507*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19508*        ENDFILE   (6690-END-OF-FILE)
 19509*    END-EXEC.
 19510*    MOVE '"$IcJ''                ! '' #00019372' TO DFHEIV0
 19511     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19513     MOVE X'2720233030303139333732' TO DFHEIV0(25:11)
 19514     CALL 'kxdfhei1' USING DFHEIV0
 19515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19516
 19517
 19518
 19519* EXEC CICS STARTBR
 19520*        DATASET (FILE-ID-ERRESC)
 19521*        RIDFLD  (WS-ERRESC-KEY)
 19522*        GTEQ
 19523*    END-EXEC.
 19524     MOVE 0
 19525       TO DFHEIV11
 19526*    MOVE '&,         G          &   #00019379' TO DFHEIV0
 19527     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19528     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19529     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 19530     CALL 'kxdfhei1' USING DFHEIV0,
 19531           FILE-ID-ERRESC,
 19532           WS-ERRESC-KEY,
 19533           DFHEIV99,
 19534           DFHEIV11,
 19535           DFHEIV99
 19536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19537
 19538
 19539     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19540
 19541 6670-READ-NEXT-ERRESC-MASTER.
 19542
 19543
 19544* EXEC CICS HANDLE CONDITION
 19545*        NOTFND    (6690-END-OF-FILE)
 19546*        DISABLED  (6690-ERRESC-PROBLEM)
 19547*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19548*        ENDFILE   (6690-END-OF-FILE)
 19549*    END-EXEC.
 19550*    MOVE '"$IcJ''                ! ( #00019389' TO DFHEIV0
 19551     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19553     MOVE X'2820233030303139333839' TO DFHEIV0(25:11)
 19554     CALL 'kxdfhei1' USING DFHEIV0
 19555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19556
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 356
* EL050.cbl
 19557
 19558
 19559* EXEC CICS READNEXT
 19560*        DATASET (FILE-ID-ERRESC)
 19561*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19562*        RIDFLD  (ERRESC-RECORD-KEY)
 19563*    END-EXEC.
 19564     MOVE LENGTH OF
 19565      ACCOUNT-RESIDENT-ST-COMMISSION
 19566       TO DFHEIV12
 19567     MOVE 0
 19568       TO DFHEIV11
 19569*    MOVE '&.IL                  )   #00019396' TO DFHEIV0
 19570     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19571     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19572     MOVE X'2020233030303139333936' TO DFHEIV0(25:11)
 19573     CALL 'kxdfhei1' USING DFHEIV0,
 19574           FILE-ID-ERRESC,
 19575           ACCOUNT-RESIDENT-ST-COMMISSION,
 19576           DFHEIV12,
 19577           ERRESC-RECORD-KEY,
 19578           DFHEIV99,
 19579           DFHEIV11,
 19580           DFHEIV99,
 19581           DFHEIV99
 19582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19583
 19584
 19585     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19586        NEXT SENTENCE
 19587     ELSE
 19588
 19589* EXEC CICS ENDBR
 19590*            DATASET (FILE-ID-ERRESC)
 19591*       END-EXEC
 19592     MOVE 0
 19593       TO DFHEIV11
 19594*    MOVE '&2                    $   #00019405' TO DFHEIV0
 19595     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19596     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19597     MOVE X'2020233030303139343035' TO DFHEIV0(25:11)
 19598     CALL 'kxdfhei1' USING DFHEIV0,
 19599           FILE-ID-ERRESC,
 19600           DFHEIV11,
 19601           DFHEIV99
 19602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19603        GO TO 6690-END-OF-FILE.
 19604
 19605     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19606
 19607* EXEC CICS ENDBR
 19608*            DATASET (FILE-ID-ERRESC)
 19609*       END-EXEC
 19610     MOVE 0
 19611       TO DFHEIV11
 19612*    MOVE '&2                    $   #00019411' TO DFHEIV0
 19613     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19614     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 357
* EL050.cbl
 19615     MOVE X'2020233030303139343131' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0,
 19617           FILE-ID-ERRESC,
 19618           DFHEIV11,
 19619           DFHEIV99
 19620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19621        GO TO 6690-END-OF-FILE.
 19622
 19623     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19624        NEXT SENTENCE
 19625      ELSE
 19626        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19627
 19628* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19629*
 19630     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19631
 19632     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19633
 19634     IF WS-SUB1 > ZERO
 19635         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19636             PERFORM 6680-SET-COMMISSION
 19637         ELSE
 19638             PERFORM 6680-SET-TABLE-CODE.
 19639
 19640
 19641* EXEC CICS ENDBR
 19642*         DATASET (FILE-ID-ERRESC)
 19643*    END-EXEC.
 19644     MOVE 0
 19645       TO DFHEIV11
 19646*    MOVE '&2                    $   #00019433' TO DFHEIV0
 19647     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19648     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19649     MOVE X'2020233030303139343333' TO DFHEIV0(25:11)
 19650     CALL 'kxdfhei1' USING DFHEIV0,
 19651           FILE-ID-ERRESC,
 19652           DFHEIV11,
 19653           DFHEIV99
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19655
 19656
 19657     GO TO 6700-COMM-EXIT.
 19658
 19659 6680-SET-TABLE-CODE.
 19660     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19661        MOVE ZEROS             TO WS-SUB1
 19662     ELSE
 19663* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19664* TO COMPUTE AH COMMISSION.
 19665        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19666        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19667        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19668        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19669        PERFORM 6680-READ-CTBL-TABLE
 19670        IF WS-CTBL-READ-SW NOT = 'Y'
 19671           MOVE ZEROS          TO WS-SUB1.
 19672
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 358
* EL050.cbl
 19673 6680-READ-CTBL-TABLE.
 19674*
 19675* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19676* TO COMPUTE LIFE COMMISSION
 19677
 19678     IF CTBL-SW = '0540'
 19679        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19680        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19681        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19682
 19683     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19684
 19685     IF CTBL-TABLE-FOUND
 19686        IF CTBL-SW = '0530'
 19687             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19688                                    * PB-I-AH-TERM
 19689             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19690             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19691        ELSE
 19692             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19693             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19694             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19695     ELSE
 19696        IF FIRST-TIME-THROUGH
 19697            GO TO 6680-READ-CTBL-TABLE
 19698        ELSE
 19699            MOVE ZEROS         TO WS-SUB1.
 19700
 19701 6680-SET-COMMISSION.
 19702     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19703           MOVE ZEROS          TO WS-SUB1
 19704       ELSE
 19705           MOVE RESC-COMMISSION-PER (WS-SUB)
 19706                               TO WS-COMMISSION
 19707           IF CTBL-SW = '0530'
 19708               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19709           ELSE
 19710               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19711
 19712 6680-SEARCH-CATEGORY.
 19713     ADD +1                   TO WS-SUB.
 19714     IF WS-SUB > +12
 19715         GO TO 6680-EXIT.
 19716
 19717     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19718          MOVE WS-SUB         TO WS-SUB1
 19719          GO TO 6680-EXIT.
 19720
 19721     GO TO 6680-SEARCH-CATEGORY.
 19722
 19723 6680-EXIT.
 19724     EXIT.
 19725
 19726 6690-END-OF-FILE.
 19727     GO TO 6700-COMM-EXIT.
 19728
 19729 6690-ERRESC-PROBLEM.
 19730      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 359
* EL050.cbl
 19731      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19732
 19733      GO TO 6700-COMM-EXIT.
 19734
 19735 6700-COMM-EXIT.
 19736     EXIT.
 19737
 19738 7000-GET-RATE.
 19739
 19740* EXEC CICS LINK
 19741*        PROGRAM    ('ELRATE')
 19742*        COMMAREA   (CALCULATION-PASS-AREA)
 19743*        LENGTH     (CP-COMM-LENGTH)
 19744*    END-EXEC.
 19745     MOVE 'ELRATE' TO DFHEIV1
 19746*    MOVE '."C                   (   #00019519' TO DFHEIV0
 19747     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19749     MOVE X'2020233030303139353139' TO DFHEIV0(25:11)
 19750     CALL 'kxdfhei1' USING DFHEIV0,
 19751           DFHEIV1,
 19752           CALCULATION-PASS-AREA,
 19753           CP-COMM-LENGTH,
 19754           DFHEIV99,
 19755           DFHEIV99,
 19756           DFHEIV99,
 19757           DFHEIV99
 19758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19759
 19760
 19761 7000-EXIT.
 19762     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 360
* EL050.cbl
 19764 7100-FIND-BENEFIT-IN-STATE.
 19765     MOVE 'N'                    TO BEN-SEARCH-SW.
 19766
 19767     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19768         VARYING SUB3 FROM 1 BY 1 UNTIL
 19769            ((SUB3 GREATER 50) OR
 19770              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19771               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19772
 19773     IF SUB3 NOT = 51
 19774         MOVE 'Y'                TO BEN-SEARCH-SW.
 19775
 19776     GO TO 7199-EXIT.
 19777
 19778 7100-BENEFIT-DUMMY.
 19779
 19780 7100-DUMMY-EXIT.
 19781     EXIT.
 19782
 19783 7199-EXIT.
 19784     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 361
* EL050.cbl
 19786 7200-FIND-BENEFIT.
 19787     MOVE 'N'                    TO BEN-SEARCH-SW.
 19788
 19789     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19790         VARYING SUB3 FROM 1 BY 1 UNTIL
 19791            ((SUB3 GREATER 8) OR
 19792            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19793
 19794     IF SUB3 NOT = 9
 19795         MOVE 'Y'                TO BEN-SEARCH-SW.
 19796
 19797     GO TO 7200-EXIT.
 19798
 19799 7200-BENEFIT-DUMMY.
 19800
 19801 7200-DUMMY-EXIT.
 19802     EXIT.
 19803
 19804 7200-EXIT.
 19805     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 362
* EL050.cbl
 19807 7250-LOOK-FOR-RESCINDED-CLAIM.
 19808     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19809                                    W-CL-COMP-CD.
 19810     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19811                                    W-CL-CERT-NO.
 19812
 19813
 19814* EXEC CICS HANDLE CONDITION
 19815*        NOTFND  (7250-CONTINUE)
 19816*        ENDFILE (7250-CONTINUE)
 19817*    END-EXEC.
 19818*    MOVE '"$I''                  ! ) #00019577' TO DFHEIV0
 19819     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19821     MOVE X'2920233030303139353737' TO DFHEIV0(25:11)
 19822     CALL 'kxdfhei1' USING DFHEIV0
 19823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19824
 19825
 19826
 19827* EXEC CICS IGNORE CONDITION
 19828*        DUPKEY
 19829*    END-EXEC.
 19830*    MOVE '"*$                   !   #00019582' TO DFHEIV0
 19831     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19833     MOVE X'2020233030303139353832' TO DFHEIV0(25:11)
 19834     CALL 'kxdfhei1' USING DFHEIV0
 19835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19836
 19837
 19838
 19839* EXEC CICS STARTBR
 19840*        DATASET   (CLMS-ID)
 19841*        RIDFLD    (ELMSTR-KEY)
 19842*        GENERIC   EQUAL
 19843*        KEYLENGTH (ELMSTR-LENGTH)
 19844*    END-EXEC.
 19845     MOVE 0
 19846       TO DFHEIV11
 19847*    MOVE '&,   KG    E          &   #00019586' TO DFHEIV0
 19848     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19850     MOVE X'2020233030303139353836' TO DFHEIV0(25:11)
 19851     CALL 'kxdfhei1' USING DFHEIV0,
 19852           CLMS-ID,
 19853           ELMSTR-KEY,
 19854           ELMSTR-LENGTH,
 19855           DFHEIV11,
 19856           DFHEIV99
 19857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19858
 19859
 19860     MOVE 'Y'                    TO W-BROWSE-SW.
 19861
 19862 7250-NEXT-CLAIM.
 19863
 19864
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 363
* EL050.cbl
 19865* EXEC CICS READNEXT
 19866*        DATASET   (CLMS-ID)
 19867*        RIDFLD    (ELMSTR-KEY)
 19868*        SET       (ADDRESS OF CLAIM-MASTER)
 19869*    END-EXEC.
 19870     MOVE 0
 19871       TO DFHEIV11
 19872*    MOVE '&.S                   )   #00019597' TO DFHEIV0
 19873     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19874     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19875     MOVE X'2020233030303139353937' TO DFHEIV0(25:11)
 19876     CALL 'kxdfhei1' USING DFHEIV0,
 19877           CLMS-ID,
 19878           DFHEIV20,
 19879           DFHEIV99,
 19880           ELMSTR-KEY,
 19881           DFHEIV99,
 19882           DFHEIV11,
 19883           DFHEIV99,
 19884           DFHEIV99
 19885     SET ADDRESS OF CLAIM-MASTER TO
 19886         DFHEIV20
 19887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19888
 19889
 19890     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19891        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19892         GO TO 7250-CONTINUE
 19893     END-IF.
 19894
 19895     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19896        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19897        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19898        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19899        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19900         GO TO 7250-NEXT-CLAIM
 19901     END-IF.
 19902
 19903     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19904        OR (CL-CLAIM-TYPE = 'I')
 19905        OR (CL-CLAIM-TYPE = 'G')
 19906        OR (CL-CLAIM-TYPE = 'F')
 19907          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19908              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19909              GO TO 7250-CONTINUE
 19910          END-IF
 19911     END-IF.
 19912
 19913     GO TO 7250-NEXT-CLAIM.
 19914
 19915 7250-CONTINUE.
 19916
 19917     IF W-BROWSE-SW = 'Y'
 19918
 19919* EXEC CICS ENDBR
 19920*            DATASET   (CLMS-ID)
 19921*        END-EXEC
 19922     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 364
* EL050.cbl
 19923       TO DFHEIV11
 19924*    MOVE '&2                    $   #00019631' TO DFHEIV0
 19925     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19926     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19927     MOVE X'2020233030303139363331' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0,
 19929           CLMS-ID,
 19930           DFHEIV11,
 19931           DFHEIV99
 19932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19933         MOVE 'N' TO W-BROWSE-SW
 19934     END-IF.
 19935
 19936 7250-EXIT.
 19937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 365
* EL050.cbl
 19939 7300-CHECK-FOR-OPEN-CLMS.
 19940
 19941*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19942*    MOVE SPACES                 TO CNTL-ACCESS.
 19943*    MOVE '1'                    TO CNTL-REC-TYPE.
 19944*    MOVE +0                     TO CNTL-SEQ-NO.
 19945
 19946*    MOVE '3'                    TO RC-SW-1.
 19947*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19948
 19949*    IF NOT CF-COMPANY-MASTER
 19950*         PERFORM 0099-COMPANY-NOT-FOUND
 19951*         GO TO 7300-EXIT.
 19952
 19953     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19954                                    W-CL-COMP-CD.
 19955     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19956                                    W-CL-CERT-NO.
 19957
 19958
 19959* EXEC CICS HANDLE CONDITION
 19960*        NOTFND  (7300-CONTINUE)
 19961*        ENDFILE (7300-CONTINUE)
 19962*    END-EXEC.
 19963*    MOVE '"$I''                  ! * #00019659' TO DFHEIV0
 19964     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19966     MOVE X'2A20233030303139363539' TO DFHEIV0(25:11)
 19967     CALL 'kxdfhei1' USING DFHEIV0
 19968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19969
 19970
 19971
 19972* EXEC CICS IGNORE CONDITION
 19973*        DUPKEY
 19974*    END-EXEC.
 19975*    MOVE '"*$                   !   #00019664' TO DFHEIV0
 19976     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19978     MOVE X'2020233030303139363634' TO DFHEIV0(25:11)
 19979     CALL 'kxdfhei1' USING DFHEIV0
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19981
 19982
 19983
 19984* EXEC CICS STARTBR
 19985*        DATASET   (CLMS-ID)
 19986*        RIDFLD    (ELMSTR-KEY)
 19987*        GENERIC   EQUAL
 19988*        KEYLENGTH (ELMSTR-LENGTH)
 19989*    END-EXEC.
 19990     MOVE 0
 19991       TO DFHEIV11
 19992*    MOVE '&,   KG    E          &   #00019668' TO DFHEIV0
 19993     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19994     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19995     MOVE X'2020233030303139363638' TO DFHEIV0(25:11)
 19996     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 366
* EL050.cbl
 19997           CLMS-ID,
 19998           ELMSTR-KEY,
 19999           ELMSTR-LENGTH,
 20000           DFHEIV11,
 20001           DFHEIV99
 20002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20003
 20004
 20005     MOVE 'Y'                    TO W-BROWSE-SW.
 20006
 20007 7300-NEXT-CLAIM.
 20008
 20009
 20010* EXEC CICS READNEXT
 20011*        DATASET   (CLMS-ID)
 20012*        RIDFLD    (ELMSTR-KEY)
 20013*        SET       (ADDRESS OF CLAIM-MASTER)
 20014*    END-EXEC.
 20015     MOVE 0
 20016       TO DFHEIV11
 20017*    MOVE '&.S                   )   #00019679' TO DFHEIV0
 20018     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20019     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20020     MOVE X'2020233030303139363739' TO DFHEIV0(25:11)
 20021     CALL 'kxdfhei1' USING DFHEIV0,
 20022           CLMS-ID,
 20023           DFHEIV20,
 20024           DFHEIV99,
 20025           ELMSTR-KEY,
 20026           DFHEIV99,
 20027           DFHEIV11,
 20028           DFHEIV99,
 20029           DFHEIV99
 20030     SET ADDRESS OF CLAIM-MASTER TO
 20031         DFHEIV20
 20032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20033
 20034
 20035     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20036        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20037         GO TO 7300-CONTINUE.
 20038
 20039     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20040        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20041        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20042        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20043        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20044         GO TO 7300-NEXT-CLAIM.
 20045
 20046*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20047     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20048        OR (CL-CLAIM-TYPE = 'I')
 20049        OR (CL-CLAIM-TYPE = 'G')
 20050        OR (CL-CLAIM-TYPE = 'F')
 20051        IF CLAIM-IS-OPEN
 20052           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20053             AND PB-C-AH-CANCEL-DT > SPACES
 20054              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 367
* EL050.cbl
 20055              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20056           END-IF
 20057           EVALUATE TRUE
 20058             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20059                 MOVE ER-2884      TO WS-ERROR
 20060             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20061                 MOVE ER-2887      TO WS-ERROR
 20062             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20063                 MOVE ER-2886      TO WS-ERROR
 20064             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20065                 MOVE ER-2888      TO WS-ERROR
 20066             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20067                 MOVE ER-2885      TO WS-ERROR
 20068             WHEN OTHER
 20069                 MOVE ER-2768      TO WS-ERROR
 20070           END-EVALUATE
 20071           IF PB-C-AH-CANCEL-VOIDED OR
 20072              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20073                NOT AH-COVERAGE-CANCELLED)
 20074               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20075               MOVE ER-2768      TO WS-ERROR
 20076           END-IF
 20077           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20078           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20079              PB-FORCE-CODE NOT EQUAL '8'
 20080               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20081           END-IF
 20082           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20083           GO TO 7300-NEXT-CLAIM
 20084        ELSE
 20085           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20086*****THIS IS A RESCISSION OR REFORMATION
 20087              IF AH-COVERAGE-CANCELLED
 20088                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20089                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20090                    MOVE 1                   TO DC-ELAPSED-DAYS
 20091                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20092                    SET BIN-PLUS-ELAPSED     TO TRUE
 20093                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20094                    IF NO-CONVERSION-ERROR
 20095                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20096                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20097                          MOVE ER-2897 TO WS-ERROR
 20098                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20099                          GO TO 7300-NEXT-CLAIM
 20100                       END-IF
 20101                    END-IF
 20102                 ELSE
 20103                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20104                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20105                         MOVE ER-2890 TO WS-ERROR
 20106                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20107                         GO TO 7300-NEXT-CLAIM
 20108                      ELSE
 20109                         MOVE ER-2898 TO WS-ERROR
 20110                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20111                         GO TO 7300-NEXT-CLAIM
 20112                      END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 368
* EL050.cbl
 20113                   END-IF
 20114                 END-IF
 20115              END-IF
 20116           ELSE
 20117              IF CL-DENIAL-TYPE = '1'  AND
 20118                 CL-TOTAL-PAID-AMT = 0
 20119                    GO TO 7300-NEXT-CLAIM
 20120              END-IF
 20121              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20122               AND PB-C-AH-CANCEL-DT > SPACES
 20123                 MOVE ER-2756        TO WS-ERROR
 20124                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20125                 GO TO 7300-NEXT-CLAIM
 20126              END-IF
 20127           END-IF
 20128        END-IF
 20129     ELSE
 20130*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20131        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20132          OR (CL-CLAIM-TYPE = 'O')
 20133           IF (CLAIM-IS-OPEN)
 20134              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20135                 <> zeros
 20136              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20137                 <> zeros)
 20138              MOVE ER-2889      TO WS-ERROR
 20139              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20140              GO TO 7300-NEXT-CLAIM
 20141           ELSE
 20142              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20143*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20144                 IF (LF-COVERAGE-CANCELLED AND
 20145                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20146                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20147                         MOVE ER-2890 TO WS-ERROR
 20148                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20149                         GO TO 7300-NEXT-CLAIM
 20150                      ELSE
 20151                         MOVE ER-2898 TO WS-ERROR
 20152                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20153                         GO TO 7300-NEXT-CLAIM
 20154                      END-IF
 20155                 END-IF
 20156              ELSE
 20157                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20158                    and (CL-TOTAL-PAID-AMT = 0)
 20159                    GO TO 7300-NEXT-CLAIM
 20160                 END-IF
 20161                 IF (
 20162                      (AH-COVERAGE-CANCELLED)
 20163                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20164                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20165                      and (pb-ci-ah-cancel-amt +
 20166                         pb-c-ah-cancel-amt) <> zeros
 20167                    )
 20168                               OR
 20169                    (
 20170                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 369
* EL050.cbl
 20171                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20172                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20173                      and (pb-ci-lf-cancel-amt +
 20174                         pb-c-lf-cancel-amt) <> zeros
 20175                    )
 20176                       IF CL-CLAIM-TYPE = 'O'
 20177                          MOVE ER-2998 TO WS-ERROR
 20178                       ELSE
 20179                          MOVE ER-2965 TO WS-ERROR
 20180                       END-IF
 20181                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20182                       GO TO 7300-NEXT-CLAIM
 20183                 END-IF
 20184                 IF LF-COVERAGE-CANCELLED
 20185                  IF CL-TOTAL-PAID-AMT > 0
 20186                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20187                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20188                        MOVE ER-2891 TO WS-ERROR
 20189                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20190                        GO TO 7300-NEXT-CLAIM
 20191                      END-IF
 20192                    ELSE
 20193****only show this error if cert num matches exactly
 20194                      IF PB-CERT-NO = CL-CERT-NO
 20195                         IF CL-CLAIM-TYPE = 'O'
 20196                            MOVE ER-2895 TO WS-ERROR
 20197                         ELSE
 20198                            MOVE ER-2892 TO WS-ERROR
 20199                         END-IF
 20200                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20201                         GO TO 7300-NEXT-CLAIM
 20202                      END-IF
 20203                    END-IF
 20204                  END-IF
 20205                 END-IF
 20206              END-IF
 20207           END-IF
 20208        END-IF
 20209     END-IF
 20210
 20211     GO TO 7300-NEXT-CLAIM.
 20212
 20213 7300-CONTINUE.
 20214
 20215     IF W-BROWSE-SW = 'Y'
 20216
 20217* EXEC CICS ENDBR
 20218*            DATASET   (CLMS-ID)
 20219*        END-EXEC.
 20220     MOVE 0
 20221       TO DFHEIV11
 20222*    MOVE '&2                    $   #00019866' TO DFHEIV0
 20223     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20224     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20225     MOVE X'2020233030303139383636' TO DFHEIV0(25:11)
 20226     CALL 'kxdfhei1' USING DFHEIV0,
 20227           CLMS-ID,
 20228           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 370
* EL050.cbl
 20229           DFHEIV99
 20230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20231
 20232
 20233 7300-EXIT.
 20234     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 371
* EL050.cbl
 20236 7320-CHECK-FOR-OPEN-CLMS-issue.
 20237
 20238     move ' '                    to w-browse-sw
 20239     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20240                                    W-CL-COMP-CD
 20241     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
 20242                                    W-CL-CERT-NO
 20243
 20244
 20245* EXEC CICS HANDLE CONDITION
 20246*        NOTFND  (7320-CONTINUE)
 20247*        ENDFILE (7320-CONTINUE)
 20248*    END-EXEC.
 20249*    MOVE '"$I''                  ! + #00019881' TO DFHEIV0
 20250     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20252     MOVE X'2B20233030303139383831' TO DFHEIV0(25:11)
 20253     CALL 'kxdfhei1' USING DFHEIV0
 20254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20255
 20256
 20257
 20258* EXEC CICS IGNORE CONDITION
 20259*        DUPKEY
 20260*    END-EXEC.
 20261*    MOVE '"*$                   !   #00019886' TO DFHEIV0
 20262     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20264     MOVE X'2020233030303139383836' TO DFHEIV0(25:11)
 20265     CALL 'kxdfhei1' USING DFHEIV0
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269
 20270* EXEC CICS STARTBR
 20271*        DATASET   (CLMS-ID)
 20272*        RIDFLD    (ELMSTR-KEY)
 20273*        GENERIC   EQUAL
 20274*        KEYLENGTH (ELMSTR-LENGTH)
 20275*    END-EXEC.
 20276     MOVE 0
 20277       TO DFHEIV11
 20278*    MOVE '&,   KG    E          &   #00019890' TO DFHEIV0
 20279     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20280     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20281     MOVE X'2020233030303139383930' TO DFHEIV0(25:11)
 20282     CALL 'kxdfhei1' USING DFHEIV0,
 20283           CLMS-ID,
 20284           ELMSTR-KEY,
 20285           ELMSTR-LENGTH,
 20286           DFHEIV11,
 20287           DFHEIV99
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291     MOVE 'Y'                    TO W-BROWSE-SW.
 20292
 20293 7320-NEXT-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 372
* EL050.cbl
 20294
 20295
 20296* EXEC CICS READNEXT
 20297*        DATASET   (CLMS-ID)
 20298*        RIDFLD    (ELMSTR-KEY)
 20299*        SET       (ADDRESS OF CLAIM-MASTER)
 20300*    END-EXEC.
 20301     MOVE 0
 20302       TO DFHEIV11
 20303*    MOVE '&.S                   )   #00019901' TO DFHEIV0
 20304     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303139393031' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0,
 20308           CLMS-ID,
 20309           DFHEIV20,
 20310           DFHEIV99,
 20311           ELMSTR-KEY,
 20312           DFHEIV99,
 20313           DFHEIV11,
 20314           DFHEIV99,
 20315           DFHEIV99
 20316     SET ADDRESS OF CLAIM-MASTER TO
 20317         DFHEIV20
 20318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20319
 20320
 20321     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20322        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20323         GO TO 7320-CONTINUE.
 20324
 20325     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20326        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20327        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20328        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20329        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20330         GO TO 7320-NEXT-CLAIM.
 20331
 20332     IF CLAIM-IS-OPEN
 20333        MOVE ER-3273             TO WS-ERROR
 20334        PERFORM 9900-ERROR-FORMAT
 20335                                 THRU 9900-EXIT
 20336     END-IF
 20337     if pb-i-entry-status = 'V'
 20338        IF CLAIM-IS-OPEN
 20339             OR
 20340           CL-LAST-PMT-DT NOT = LOW-VALUES
 20341             OR
 20342           CL-LAST-PMT-AMT > 0
 20343           MOVE ER-3281          TO WS-ERROR
 20344           PERFORM 9900-ERROR-FORMAT
 20345                                 THRU 9900-EXIT
 20346        END-IF
 20347     END-IF
 20348
 20349     GO TO 7320-NEXT-CLAIM.
 20350
 20351 7320-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 373
* EL050.cbl
 20352
 20353     IF W-BROWSE-SW = 'Y'
 20354
 20355* EXEC CICS ENDBR
 20356*            DATASET   (CLMS-ID)
 20357*        END-EXEC.
 20358     MOVE 0
 20359       TO DFHEIV11
 20360*    MOVE '&2                    $   #00019940' TO DFHEIV0
 20361     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20363     MOVE X'2020233030303139393430' TO DFHEIV0(25:11)
 20364     CALL 'kxdfhei1' USING DFHEIV0,
 20365           CLMS-ID,
 20366           DFHEIV11,
 20367           DFHEIV99
 20368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20369
 20370
 20371 7320-EXIT.
 20372     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 374
* EL050.cbl
 20374 7400-GET-REMAIN-TERM.
 20375
 20376* EXEC CICS LINK
 20377*        PROGRAM    ('ELRTRM')
 20378*        COMMAREA   (CALCULATION-PASS-AREA)
 20379*        LENGTH     (CP-COMM-LENGTH)
 20380*    END-EXEC.
 20381     MOVE 'ELRTRM' TO DFHEIV1
 20382*    MOVE '."C                   (   #00019948' TO DFHEIV0
 20383     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20385     MOVE X'2020233030303139393438' TO DFHEIV0(25:11)
 20386     CALL 'kxdfhei1' USING DFHEIV0,
 20387           DFHEIV1,
 20388           CALCULATION-PASS-AREA,
 20389           CP-COMM-LENGTH,
 20390           DFHEIV99,
 20391           DFHEIV99,
 20392           DFHEIV99,
 20393           DFHEIV99
 20394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20395
 20396
 20397 7400-EXIT.
 20398     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 375
* EL050.cbl
 20400
 20401 7500-GET-REMAIN-AMOUNT.
 20402
 20403* EXEC CICS LINK
 20404*        PROGRAM    ('ELRAMT')
 20405*        COMMAREA   (CALCULATION-PASS-AREA)
 20406*        LENGTH     (CP-COMM-LENGTH)
 20407*    END-EXEC.
 20408     MOVE 'ELRAMT' TO DFHEIV1
 20409*    MOVE '."C                   (   #00019959' TO DFHEIV0
 20410     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20412     MOVE X'2020233030303139393539' TO DFHEIV0(25:11)
 20413     CALL 'kxdfhei1' USING DFHEIV0,
 20414           DFHEIV1,
 20415           CALCULATION-PASS-AREA,
 20416           CP-COMM-LENGTH,
 20417           DFHEIV99,
 20418           DFHEIV99,
 20419           DFHEIV99,
 20420           DFHEIV99
 20421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20422
 20423
 20424 7500-EXIT.
 20425     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 376
* EL050.cbl
 20427
 20428 7600-GET-REFUND.
 20429
 20430* EXEC CICS LINK
 20431*        PROGRAM    ('ELRFND')
 20432*        COMMAREA   (CALCULATION-PASS-AREA)
 20433*        LENGTH     (CP-COMM-LENGTH)
 20434*    END-EXEC.
 20435     MOVE 'ELRFND' TO DFHEIV1
 20436*    MOVE '."C                   (   #00019970' TO DFHEIV0
 20437     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20439     MOVE X'2020233030303139393730' TO DFHEIV0(25:11)
 20440     CALL 'kxdfhei1' USING DFHEIV0,
 20441           DFHEIV1,
 20442           CALCULATION-PASS-AREA,
 20443           CP-COMM-LENGTH,
 20444           DFHEIV99,
 20445           DFHEIV99,
 20446           DFHEIV99,
 20447           DFHEIV99
 20448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20449
 20450
 20451 7600-EXIT.
 20452     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 377
* EL050.cbl
 20454 7700-CALL-DL1.
 20455
 20456* EXEC CICS LINK
 20457*        PROGRAM    ('DLO001')
 20458*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20459*        LENGTH     (DLO001-COMM-LENGTH)
 20460*    END-EXEC.
 20461     MOVE 'DLO001' TO DFHEIV1
 20462*    MOVE '."C                   (   #00019980' TO DFHEIV0
 20463     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20465     MOVE X'2020233030303139393830' TO DFHEIV0(25:11)
 20466     CALL 'kxdfhei1' USING DFHEIV0,
 20467           DFHEIV1,
 20468           WS-DLO-MASTER-POLICY-FORM,
 20469           DLO001-COMM-LENGTH,
 20470           DFHEIV99,
 20471           DFHEIV99,
 20472           DFHEIV99,
 20473           DFHEIV99
 20474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20475
 20476
 20477 7700-EXIT.
 20478     EXIT.
 20479
 20480 7710-CALL-DL2.
 20481
 20482* EXEC CICS LINK
 20483*        PROGRAM    ('DLO002')
 20484*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20485*        LENGTH     (DLO002-COMM-LENGTH)
 20486*    END-EXEC.
 20487     MOVE 'DLO002' TO DFHEIV1
 20488*    MOVE '."C                   (   #00019990' TO DFHEIV0
 20489     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20491     MOVE X'2020233030303139393930' TO DFHEIV0(25:11)
 20492     CALL 'kxdfhei1' USING DFHEIV0,
 20493           DFHEIV1,
 20494           WS-DLO-INTERNAL-POLICY-FORM,
 20495           DLO002-COMM-LENGTH,
 20496           DFHEIV99,
 20497           DFHEIV99,
 20498           DFHEIV99,
 20499           DFHEIV99
 20500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20501
 20502
 20503 7710-EXIT.
 20504     EXIT.
 20505
 20506 7720-CALL-DL3.
 20507
 20508* EXEC CICS LINK
 20509*        PROGRAM    ('DLO003')
 20510*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20511*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 378
* EL050.cbl
 20512*    END-EXEC.
 20513     MOVE 'DLO003' TO DFHEIV1
 20514*    MOVE '."C                   (   #00020000' TO DFHEIV0
 20515     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20517     MOVE X'2020233030303230303030' TO DFHEIV0(25:11)
 20518     CALL 'kxdfhei1' USING DFHEIV0,
 20519           DFHEIV1,
 20520           WS-DLO-VALID-BANK-ID,
 20521           DLO003-COMM-LENGTH,
 20522           DFHEIV99,
 20523           DFHEIV99,
 20524           DFHEIV99,
 20525           DFHEIV99
 20526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20527
 20528
 20529 7720-EXIT.
 20530     EXIT.
 20531
 20532 7730-CALL-DL7.
 20533
 20534* EXEC CICS LINK
 20535*        PROGRAM    ('DLO007')
 20536*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20537*        LENGTH     (DLO007-COMM-LENGTH)
 20538*    END-EXEC.
 20539     MOVE 'DLO007' TO DFHEIV1
 20540*    MOVE '."C                   (   #00020010' TO DFHEIV0
 20541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20543     MOVE X'2020233030303230303130' TO DFHEIV0(25:11)
 20544     CALL 'kxdfhei1' USING DFHEIV0,
 20545           DFHEIV1,
 20546           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20547           DLO007-COMM-LENGTH,
 20548           DFHEIV99,
 20549           DFHEIV99,
 20550           DFHEIV99,
 20551           DFHEIV99
 20552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20553
 20554
 20555 7730-EXIT.
 20556     EXIT.
 20557
 20558 7740-CALL-DL11.
 20559
 20560* EXEC CICS LINK
 20561*        PROGRAM    ('DLO011')
 20562*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20563*        LENGTH     (DLO011-COMM-LENGTH)
 20564*    END-EXEC.
 20565     MOVE 'DLO011' TO DFHEIV1
 20566*    MOVE '."C                   (   #00020020' TO DFHEIV0
 20567     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20568     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20569     MOVE X'2020233030303230303230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 379
* EL050.cbl
 20570     CALL 'kxdfhei1' USING DFHEIV0,
 20571           DFHEIV1,
 20572           WS-DLO-PREM-RATES-BEN-TYPE,
 20573           DLO011-COMM-LENGTH,
 20574           DFHEIV99,
 20575           DFHEIV99,
 20576           DFHEIV99,
 20577           DFHEIV99
 20578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20579
 20580
 20581 7740-EXIT.
 20582     EXIT.
 20583
 20584 7750-CALL-DL17.
 20585
 20586* EXEC CICS LINK
 20587*        PROGRAM    ('DLO017')
 20588*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20589*        LENGTH     (DLO017-COMM-LENGTH)
 20590*    END-EXEC.
 20591     MOVE 'DLO017' TO DFHEIV1
 20592*    MOVE '."C                   (   #00020030' TO DFHEIV0
 20593     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20594     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20595     MOVE X'2020233030303230303330' TO DFHEIV0(25:11)
 20596     CALL 'kxdfhei1' USING DFHEIV0,
 20597           DFHEIV1,
 20598           WS-DLO-VALID-RATE-CODE,
 20599           DLO017-COMM-LENGTH,
 20600           DFHEIV99,
 20601           DFHEIV99,
 20602           DFHEIV99,
 20603           DFHEIV99
 20604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20605
 20606
 20607 7750-EXIT.
 20608     EXIT.
 20609
 20610 7755-CALL-DL19.
 20611
 20612* EXEC CICS LINK
 20613*        PROGRAM    ('DLO019')
 20614*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20615*        LENGTH     (DLO019-COMM-LENGTH)
 20616*    END-EXEC.
 20617     MOVE 'DLO019' TO DFHEIV1
 20618*    MOVE '."C                   (   #00020040' TO DFHEIV0
 20619     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20620     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20621     MOVE X'2020233030303230303430' TO DFHEIV0(25:11)
 20622     CALL 'kxdfhei1' USING DFHEIV0,
 20623           DFHEIV1,
 20624           WS-DLO-ORIG-COV-CAT,
 20625           DLO019-COMM-LENGTH,
 20626           DFHEIV99,
 20627           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 380
* EL050.cbl
 20628           DFHEIV99,
 20629           DFHEIV99
 20630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20631
 20632
 20633 7755-EXIT.
 20634     EXIT.
 20635
 20636 7760-CALL-DL21.
 20637
 20638* EXEC CICS LINK
 20639*        PROGRAM    ('DLO021')
 20640*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20641*        LENGTH     (DLO021-COMM-LENGTH)
 20642*    END-EXEC.
 20643     MOVE 'DLO021' TO DFHEIV1
 20644*    MOVE '."C                   (   #00020050' TO DFHEIV0
 20645     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20647     MOVE X'2020233030303230303530' TO DFHEIV0(25:11)
 20648     CALL 'kxdfhei1' USING DFHEIV0,
 20649           DFHEIV1,
 20650           WS-DLO-VALID-LOAN-OFFICER,
 20651           DLO021-COMM-LENGTH,
 20652           DFHEIV99,
 20653           DFHEIV99,
 20654           DFHEIV99,
 20655           DFHEIV99
 20656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20657
 20658
 20659 7760-EXIT.
 20660     EXIT.
 20661
 20662 7770-CALL-DL22.
 20663
 20664* EXEC CICS LINK
 20665*        PROGRAM    ('DLO022')
 20666*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20667*        LENGTH     (DLO022-COMM-LENGTH)
 20668*    END-EXEC.
 20669     MOVE 'DLO022' TO DFHEIV1
 20670*    MOVE '."C                   (   #00020060' TO DFHEIV0
 20671     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20673     MOVE X'2020233030303230303630' TO DFHEIV0(25:11)
 20674     CALL 'kxdfhei1' USING DFHEIV0,
 20675           DFHEIV1,
 20676           WS-DLO-VALID-STATE-CODE,
 20677           DLO022-COMM-LENGTH,
 20678           DFHEIV99,
 20679           DFHEIV99,
 20680           DFHEIV99,
 20681           DFHEIV99
 20682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20683
 20684
 20685 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 381
* EL050.cbl
 20686     EXIT.
 20687
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 382
* EL050.cbl
 20689
 20690 7780-CALL-AGG.
 20691
 20692* EXEC CICS LINK
 20693*        PROGRAM    ('ELAGGO')
 20694*        COMMAREA   (WS-PASS-to-pemaggo)
 20695*        LENGTH     (ws-passed-key-LENGTH)
 20696*    END-EXEC.
 20697     MOVE 'ELAGGO' TO DFHEIV1
 20698*    MOVE '."C                   (   #00020072' TO DFHEIV0
 20699     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20701     MOVE X'2020233030303230303732' TO DFHEIV0(25:11)
 20702     CALL 'kxdfhei1' USING DFHEIV0,
 20703           DFHEIV1,
 20704           WS-PASS-to-pemaggo,
 20705           ws-passed-key-LENGTH,
 20706           DFHEIV99,
 20707           DFHEIV99,
 20708           DFHEIV99,
 20709           DFHEIV99
 20710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20711
 20712 7780-EXIT.
 20713     EXIT.
 20714 7785-CALL-HLDI.
 20715
 20716* EXEC CICS LINK
 20717*        PROGRAM    ('ELHLDI')
 20718*        COMMAREA   (HLDI-PASS-AREA)
 20719*        LENGTH     (HLDI-PASS-AREA-LEN)
 20720*    END-EXEC.
 20721     MOVE 'ELHLDI' TO DFHEIV1
 20722*    MOVE '."C                   (   #00020080' TO DFHEIV0
 20723     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20725     MOVE X'2020233030303230303830' TO DFHEIV0(25:11)
 20726     CALL 'kxdfhei1' USING DFHEIV0,
 20727           DFHEIV1,
 20728           HLDI-PASS-AREA,
 20729           HLDI-PASS-AREA-LEN,
 20730           DFHEIV99,
 20731           DFHEIV99,
 20732           DFHEIV99,
 20733           DFHEIV99
 20734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20735
 20736 7785-EXIT.
 20737     EXIT.
 20738 7786-CALL-HLDIM.
 20739
 20740* EXEC CICS LINK
 20741*        PROGRAM    ('ELHLDIM')
 20742*        COMMAREA   (HLDI-PASS-AREA)
 20743*        LENGTH     (HLDI-PASS-AREA-LEN)
 20744*    END-EXEC.
 20745     MOVE 'ELHLDIM' TO DFHEIV1
 20746*    MOVE '."C                   (   #00020088' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 383
* EL050.cbl
 20747     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20749     MOVE X'2020233030303230303838' TO DFHEIV0(25:11)
 20750     CALL 'kxdfhei1' USING DFHEIV0,
 20751           DFHEIV1,
 20752           HLDI-PASS-AREA,
 20753           HLDI-PASS-AREA-LEN,
 20754           DFHEIV99,
 20755           DFHEIV99,
 20756           DFHEIV99,
 20757           DFHEIV99
 20758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20759
 20760 7786-EXIT.
 20761     EXIT.
 20762 7790-CALL-ZIP-VERIFY.
 20763
 20764
 20765* EXEC CICS LINK
 20766*        PROGRAM    ('WSZIPCD')
 20767*        COMMAREA   (ZIPCD-PASS-AREA)
 20768*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20769*    END-EXEC.
 20770     MOVE 'WSZIPCD' TO DFHEIV1
 20771*    MOVE '."C                   (   #00020097' TO DFHEIV0
 20772     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20773     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20774     MOVE X'2020233030303230303937' TO DFHEIV0(25:11)
 20775     CALL 'kxdfhei1' USING DFHEIV0,
 20776           DFHEIV1,
 20777           ZIPCD-PASS-AREA,
 20778           ZIPCD-PASS-AREA-LEN,
 20779           DFHEIV99,
 20780           DFHEIV99,
 20781           DFHEIV99,
 20782           DFHEIV99
 20783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20784
 20785
 20786 7790-EXIT.
 20787     EXIT.
 20788 7795-call-sqlclmhs.
 20789
 20790
 20791* EXEC CICS LINK
 20792*        PROGRAM    ('SQLCLMHS')
 20793*        COMMAREA   (clmhs-PASS-AREA)
 20794*        LENGTH     (clmhs-PASS-AREA-LEN)
 20795*    END-EXEC.
 20796     MOVE 'SQLCLMHS' TO DFHEIV1
 20797*    MOVE '."C                   (   #00020107' TO DFHEIV0
 20798     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303230313037' TO DFHEIV0(25:11)
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           DFHEIV1,
 20803           clmhs-PASS-AREA,
 20804           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 384
* EL050.cbl
 20805           DFHEIV99,
 20806           DFHEIV99,
 20807           DFHEIV99,
 20808           DFHEIV99
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20810
 20811
 20812 7795-EXIT.
 20813     EXIT.
 20814 7800-REWRITE-CERT.
 20815******************************************************************
 20816*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20817*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20818******************************************************************
 20819
 20820     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20821        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20822        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20823        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20824
 20825* EXEC CICS REWRITE
 20826*                  DATASET (CERT-ID)
 20827*                  FROM    (CERTIFICATE-MASTER)
 20828*              END-EXEC
 20829     MOVE LENGTH OF
 20830      CERTIFICATE-MASTER
 20831       TO DFHEIV11
 20832*    MOVE '&& L                  %   #00020125' TO DFHEIV0
 20833     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20834     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20835     MOVE X'2020233030303230313235' TO DFHEIV0(25:11)
 20836     CALL 'kxdfhei1' USING DFHEIV0,
 20837           CERT-ID,
 20838           CERTIFICATE-MASTER,
 20839           DFHEIV11,
 20840           DFHEIV99
 20841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20842        GO TO 7800-EXIT.
 20843
 20844       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20845       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20846
 20847 7800-EXIT.
 20848      EXIT.
 20849
 20850 7900-DELETE-CERT.
 20851
 20852* EXEC CICS DELETE
 20853*        DATASET (CERT-ID)
 20854*    END-EXEC.
 20855*    MOVE '&(                    &   #00020138' TO DFHEIV0
 20856     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20857     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20858     MOVE X'2020233030303230313338' TO DFHEIV0(25:11)
 20859     CALL 'kxdfhei1' USING DFHEIV0,
 20860           CERT-ID,
 20861           DFHEIV99,
 20862           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 385
* EL050.cbl
 20863           DFHEIV99,
 20864           DFHEIV99
 20865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20866
 20867
 20868 7900-EXIT.
 20869     EXIT.
 20870
 20871 8000-WRITE-CERT.
 20872
 20873* EXEC CICS HANDLE CONDITION
 20874*        DUPKEY    (8000-FREE-MAIN)
 20875*    END-EXEC.
 20876*    MOVE '"$$                   ! , #00020146' TO DFHEIV0
 20877     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20879     MOVE X'2C20233030303230313436' TO DFHEIV0(25:11)
 20880     CALL 'kxdfhei1' USING DFHEIV0
 20881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20882
 20883
 20884
 20885* EXEC CICS WRITE
 20886*        DATASET     (CERT-ID)
 20887*        FROM        (CERTIFICATE-MASTER)
 20888*        RIDFLD      (ELCERT-KEY)
 20889*    END-EXEC.
 20890     MOVE LENGTH OF
 20891      CERTIFICATE-MASTER
 20892       TO DFHEIV11
 20893*    MOVE '&$ L                  ''   #00020150' TO DFHEIV0
 20894     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20896     MOVE X'2020233030303230313530' TO DFHEIV0(25:11)
 20897     CALL 'kxdfhei1' USING DFHEIV0,
 20898           CERT-ID,
 20899           CERTIFICATE-MASTER,
 20900           DFHEIV11,
 20901           ELCERT-KEY,
 20902           DFHEIV99,
 20903           DFHEIV99
 20904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20905
 20906
 20907 8000-FREE-MAIN.
 20908
 20909 8000-EXIT.
 20910      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 386
* EL050.cbl
 20912
 20913 8100-READ-ERPNDM.
 20914
 20915* EXEC CICS HANDLE CONDITION
 20916*         NOTFND     (8100-NOTFND)
 20917*         ENDFILE    (8100-NOTFND)
 20918*    END-EXEC.
 20919*    MOVE '"$I''                  ! - #00020163' TO DFHEIV0
 20920     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20922     MOVE X'2D20233030303230313633' TO DFHEIV0(25:11)
 20923     CALL 'kxdfhei1' USING DFHEIV0
 20924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20925
 20926
 20927     MOVE SPACES                 TO ERPNDM-FOUND.
 20928     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20929
 20930
 20931* EXEC CICS READ UPDATE
 20932*         DATASET   (FILE-ERPNDM)
 20933*         RIDFLD    (PM-CONTROL-PRIMARY)
 20934*         INTO      (PENDING-MAILING-DATA)
 20935*    END-EXEC.
 20936     MOVE LENGTH OF
 20937      PENDING-MAILING-DATA
 20938       TO DFHEIV11
 20939*    MOVE '&"IL       EU         (   #00020171' TO DFHEIV0
 20940     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20941     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20942     MOVE X'2020233030303230313731' TO DFHEIV0(25:11)
 20943     CALL 'kxdfhei1' USING DFHEIV0,
 20944           FILE-ERPNDM,
 20945           PENDING-MAILING-DATA,
 20946           DFHEIV11,
 20947           PM-CONTROL-PRIMARY,
 20948           DFHEIV99,
 20949           DFHEIV99,
 20950           DFHEIV99
 20951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20952
 20953
 20954     GO TO 8100-EXIT.
 20955
 20956 8100-NOTFND.
 20957
 20958     MOVE 'X'                    TO ERPNDM-FOUND.
 20959     MOVE ER-2694                TO WS-ERROR.
 20960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20961     MOVE ER-2883                TO WS-ERROR
 20962     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20963     .
 20964 8100-EXIT.
 20965     EXIT.
 20966 8102-REWRITE-ERPNDM.
 20967
 20968
 20969* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 387
* EL050.cbl
 20970*         DATASET    (FILE-ERPNDM)
 20971*         FROM       (PENDING-MAILING-DATA)
 20972*    END-EXEC
 20973     MOVE LENGTH OF
 20974      PENDING-MAILING-DATA
 20975       TO DFHEIV11
 20976*    MOVE '&& L                  %   #00020191' TO DFHEIV0
 20977     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20978     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20979     MOVE X'2020233030303230313931' TO DFHEIV0(25:11)
 20980     CALL 'kxdfhei1' USING DFHEIV0,
 20981           FILE-ERPNDM,
 20982           PENDING-MAILING-DATA,
 20983           DFHEIV11,
 20984           DFHEIV99
 20985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20986
 20987     .
 20988 8102-EXIT.
 20989     EXIT.
 20990 8104-UNLOCK-ERPNDM.
 20991
 20992
 20993* EXEC CICS UNLOCK
 20994*         DATASET   (FILE-ERPNDM)
 20995*    END-EXEC
 20996*    MOVE '&*                    #   #00020201' TO DFHEIV0
 20997     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20998     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20999     MOVE X'2020233030303230323031' TO DFHEIV0(25:11)
 21000     CALL 'kxdfhei1' USING DFHEIV0,
 21001           FILE-ERPNDM,
 21002           DFHEIV99
 21003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21004
 21005     .
 21006 8104-EXIT.
 21007     EXIT.
 21008 8110-READ-ERMAIL.
 21009
 21010* EXEC CICS HANDLE CONDITION
 21011*         NOTFND     (8110-NOTFND)
 21012*         ENDFILE    (8110-NOTFND)
 21013*    END-EXEC.
 21014*    MOVE '"$I''                  ! . #00020209' TO DFHEIV0
 21015     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21017     MOVE X'2E20233030303230323039' TO DFHEIV0(25:11)
 21018     CALL 'kxdfhei1' USING DFHEIV0
 21019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21020
 21021
 21022     MOVE SPACES                 TO ERMAIL-FOUND.
 21023     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 21024     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 21025     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 21026     MOVE PB-SV-STATE            TO MA-STATE.
 21027
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 388
* EL050.cbl
 21028
 21029* EXEC CICS READ
 21030*         UPDATE
 21031*         DATASET   (FILE-ERMAIL)
 21032*         RIDFLD    (MA-CONTROL-PRIMARY)
 21033*         INTO      (MAILING-DATA)
 21034*    END-EXEC.
 21035     MOVE LENGTH OF
 21036      MAILING-DATA
 21037       TO DFHEIV11
 21038*    MOVE '&"IL       EU         (   #00020220' TO DFHEIV0
 21039     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21040     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21041     MOVE X'2020233030303230323230' TO DFHEIV0(25:11)
 21042     CALL 'kxdfhei1' USING DFHEIV0,
 21043           FILE-ERMAIL,
 21044           MAILING-DATA,
 21045           DFHEIV11,
 21046           MA-CONTROL-PRIMARY,
 21047           DFHEIV99,
 21048           DFHEIV99,
 21049           DFHEIV99
 21050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21051
 21052
 21053     GO TO 8110-EXIT.
 21054
 21055 8110-NOTFND.
 21056     MOVE 'X'                    TO ERMAIL-FOUND.
 21057
 21058 8110-EXIT.
 21059     EXIT.
 21060
 21061 8120-REWRITE-ERMAIL.
 21062
 21063* EXEC CICS REWRITE
 21064*         DATASET    (FILE-ERMAIL)
 21065*         FROM       (MAILING-DATA)
 21066*    END-EXEC.
 21067     MOVE LENGTH OF
 21068      MAILING-DATA
 21069       TO DFHEIV11
 21070*    MOVE '&& L                  %   #00020236' TO DFHEIV0
 21071     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21072     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21073     MOVE X'2020233030303230323336' TO DFHEIV0(25:11)
 21074     CALL 'kxdfhei1' USING DFHEIV0,
 21075           FILE-ERMAIL,
 21076           MAILING-DATA,
 21077           DFHEIV11,
 21078           DFHEIV99
 21079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21080
 21081
 21082 8120-EXIT.
 21083     EXIT.
 21084
 21085 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 389
* EL050.cbl
 21086
 21087* EXEC CICS HANDLE CONDITION
 21088*         DUPKEY   (8130-EXIT)
 21089*    END-EXEC.
 21090*    MOVE '"$$                   ! / #00020245' TO DFHEIV0
 21091     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 21092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21093     MOVE X'2F20233030303230323435' TO DFHEIV0(25:11)
 21094     CALL 'kxdfhei1' USING DFHEIV0
 21095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21096
 21097
 21098
 21099* EXEC CICS WRITE
 21100*         DATASET     (FILE-ERMAIL)
 21101*         RIDFLD      (MA-CONTROL-PRIMARY)
 21102*         FROM        (MAILING-DATA)
 21103*    END-EXEC.
 21104     MOVE LENGTH OF
 21105      MAILING-DATA
 21106       TO DFHEIV11
 21107*    MOVE '&$ L                  ''   #00020249' TO DFHEIV0
 21108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21110     MOVE X'2020233030303230323439' TO DFHEIV0(25:11)
 21111     CALL 'kxdfhei1' USING DFHEIV0,
 21112           FILE-ERMAIL,
 21113           MAILING-DATA,
 21114           DFHEIV11,
 21115           MA-CONTROL-PRIMARY,
 21116           DFHEIV99,
 21117           DFHEIV99
 21118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21119
 21120
 21121 8130-EXIT.
 21122     EXIT.
 21123
 21124 8140-UNLOCK-ERMAIL.
 21125
 21126* EXEC CICS UNLOCK
 21127*         DATASET   (FILE-ERMAIL)
 21128*    END-EXEC.
 21129*    MOVE '&*                    #   #00020259' TO DFHEIV0
 21130     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21131     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21132     MOVE X'2020233030303230323539' TO DFHEIV0(25:11)
 21133     CALL 'kxdfhei1' USING DFHEIV0,
 21134           FILE-ERMAIL,
 21135           DFHEIV99
 21136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21137
 21138
 21139 8140-EXIT.
 21140     EXIT.
 21141
 21142 8145-read-elcrtt-upd.
 21143
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 390
* EL050.cbl
 21144     move ' '                    to elcrtt-found-sw
 21145                                    elcrtt-update-sw
 21146
 21147* EXEC CICS HANDLE CONDITION
 21148*        NOTFND   (8145-exit)
 21149*    END-EXEC
 21150*    MOVE '"$I                   ! 0 #00020270' TO DFHEIV0
 21151     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21153     MOVE X'3020233030303230323730' TO DFHEIV0(25:11)
 21154     CALL 'kxdfhei1' USING DFHEIV0
 21155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21156
 21157     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21158     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21159
 21160
 21161* EXEC CICS READ UPDATE
 21162*        DATASET  (CRTT-ID)
 21163*        RIDFLD   (WS-ELCRTT-KEY)
 21164*        INTO     (CERTIFICATE-TRAILERS)
 21165*    END-EXEC
 21166     MOVE LENGTH OF
 21167      CERTIFICATE-TRAILERS
 21168       TO DFHEIV11
 21169*    MOVE '&"IL       EU         (   #00020277' TO DFHEIV0
 21170     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21171     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21172     MOVE X'2020233030303230323737' TO DFHEIV0(25:11)
 21173     CALL 'kxdfhei1' USING DFHEIV0,
 21174           CRTT-ID,
 21175           CERTIFICATE-TRAILERS,
 21176           DFHEIV11,
 21177           WS-ELCRTT-KEY,
 21178           DFHEIV99,
 21179           DFHEIV99,
 21180           DFHEIV99
 21181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21182
 21183     set elcrtt-found to true
 21184
 21185     .
 21186 8145-exit.
 21187     exit.
 21188 8150-UPDATE-ELCRTT.
 21189
 21190     if elcrtt-found
 21191
 21192* EXEC CICS REWRITE
 21193*           DATASET  (CRTT-ID)
 21194*           FROM     (CERTIFICATE-TRAILERS)
 21195*        END-EXEC
 21196     MOVE LENGTH OF
 21197      CERTIFICATE-TRAILERS
 21198       TO DFHEIV11
 21199*    MOVE '&& L                  %   #00020291' TO DFHEIV0
 21200     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21201     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 391
* EL050.cbl
 21202     MOVE X'2020233030303230323931' TO DFHEIV0(25:11)
 21203     CALL 'kxdfhei1' USING DFHEIV0,
 21204           CRTT-ID,
 21205           CERTIFICATE-TRAILERS,
 21206           DFHEIV11,
 21207           DFHEIV99
 21208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21209     ELSE
 21210
 21211* EXEC CICS WRITE
 21212*          DATASET  (CRTT-ID)
 21213*          RIDFLD   (WS-ELCRTT-KEY)
 21214*          FROM     (CERTIFICATE-TRAILERS)
 21215*       END-EXEC
 21216     MOVE LENGTH OF
 21217      CERTIFICATE-TRAILERS
 21218       TO DFHEIV11
 21219*    MOVE '&$ L                  ''   #00020296' TO DFHEIV0
 21220     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21221     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21222     MOVE X'2020233030303230323936' TO DFHEIV0(25:11)
 21223     CALL 'kxdfhei1' USING DFHEIV0,
 21224           CRTT-ID,
 21225           CERTIFICATE-TRAILERS,
 21226           DFHEIV11,
 21227           WS-ELCRTT-KEY,
 21228           DFHEIV99,
 21229           DFHEIV99
 21230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21231     end-if
 21232
 21233     .
 21234 8150-EXIT.
 21235     EXIT.
 21236
 21237 8155-unlock-elcrtt.
 21238
 21239
 21240* EXEC CICS UNLOCK
 21241*       DATASET  (CRTT-ID)
 21242*    END-EXEC
 21243*    MOVE '&*                    #   #00020309' TO DFHEIV0
 21244     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21245     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21246     MOVE X'2020233030303230333039' TO DFHEIV0(25:11)
 21247     CALL 'kxdfhei1' USING DFHEIV0,
 21248           CRTT-ID,
 21249           DFHEIV99
 21250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21251
 21252     .
 21253 8155-exit.
 21254     exit.
 21255
 21256 8190-UPDATE-REFUND-CLAIM-FLAG.
 21257
 21258* EXEC CICS HANDLE CONDITION
 21259*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 392
* EL050.cbl
 21260*    END-EXEC.
 21261*    MOVE '"$I                   ! 1 #00020318' TO DFHEIV0
 21262     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21264     MOVE X'3120233030303230333138' TO DFHEIV0(25:11)
 21265     CALL 'kxdfhei1' USING DFHEIV0
 21266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21267
 21268
 21269     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21270     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21271
 21272
 21273* EXEC CICS READ
 21274*        UPDATE
 21275*        DATASET  (CRTT-ID)
 21276*        RIDFLD   (WS-ELCRTT-KEY)
 21277*        INTO     (CERTIFICATE-TRAILERS)
 21278*    END-EXEC.
 21279     MOVE LENGTH OF
 21280      CERTIFICATE-TRAILERS
 21281       TO DFHEIV11
 21282*    MOVE '&"IL       EU         (   #00020325' TO DFHEIV0
 21283     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21284     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21285     MOVE X'2020233030303230333235' TO DFHEIV0(25:11)
 21286     CALL 'kxdfhei1' USING DFHEIV0,
 21287           CRTT-ID,
 21288           CERTIFICATE-TRAILERS,
 21289           DFHEIV11,
 21290           WS-ELCRTT-KEY,
 21291           DFHEIV99,
 21292           DFHEIV99,
 21293           DFHEIV99
 21294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21295
 21296
 21297     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21298
 21299* EXEC CICS REWRITE
 21300*       DATASET  (CRTT-ID)
 21301*       FROM     (CERTIFICATE-TRAILERS)
 21302*    END-EXEC.
 21303     MOVE LENGTH OF
 21304      CERTIFICATE-TRAILERS
 21305       TO DFHEIV11
 21306*    MOVE '&& L                  %   #00020333' TO DFHEIV0
 21307     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21309     MOVE X'2020233030303230333333' TO DFHEIV0(25:11)
 21310     CALL 'kxdfhei1' USING DFHEIV0,
 21311           CRTT-ID,
 21312           CERTIFICATE-TRAILERS,
 21313           DFHEIV11,
 21314           DFHEIV99
 21315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21316
 21317
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 393
* EL050.cbl
 21318     GO TO 8190-EXIT.
 21319
 21320 8190-NOTFND.
 21321
 21322     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21323     MOVE 'CS'         TO CS-RECORD-ID.
 21324     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21325     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21326     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21327     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21328
 21329* EXEC CICS WRITE
 21330*       DATASET  (CRTT-ID)
 21331*       RIDFLD   (WS-ELCRTT-KEY)
 21332*       FROM     (CERTIFICATE-TRAILERS)
 21333*    END-EXEC.
 21334     MOVE LENGTH OF
 21335      CERTIFICATE-TRAILERS
 21336       TO DFHEIV11
 21337*    MOVE '&$ L                  ''   #00020348' TO DFHEIV0
 21338     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21339     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21340     MOVE X'2020233030303230333438' TO DFHEIV0(25:11)
 21341     CALL 'kxdfhei1' USING DFHEIV0,
 21342           CRTT-ID,
 21343           CERTIFICATE-TRAILERS,
 21344           DFHEIV11,
 21345           WS-ELCRTT-KEY,
 21346           DFHEIV99,
 21347           DFHEIV99
 21348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21349
 21350
 21351 8190-EXIT.
 21352     EXIT.
 21353
 21354 8195-UPDATE-AGE-FLAGS.
 21355
 21356* EXEC CICS HANDLE CONDITION
 21357*        NOTFND   (8195-NOTFND)
 21358*    END-EXEC.
 21359*    MOVE '"$I                   ! 2 #00020358' TO DFHEIV0
 21360     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21362     MOVE X'3220233030303230333538' TO DFHEIV0(25:11)
 21363     CALL 'kxdfhei1' USING DFHEIV0
 21364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21365
 21366
 21367     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21368     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21369
 21370
 21371* EXEC CICS READ
 21372*        UPDATE
 21373*        DATASET  (CRTT-ID)
 21374*        RIDFLD   (WS-ELCRTT-KEY)
 21375*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 394
* EL050.cbl
 21376*    END-EXEC.
 21377     MOVE LENGTH OF
 21378      CERTIFICATE-TRAILERS
 21379       TO DFHEIV11
 21380*    MOVE '&"IL       EU         (   #00020365' TO DFHEIV0
 21381     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21382     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21383     MOVE X'2020233030303230333635' TO DFHEIV0(25:11)
 21384     CALL 'kxdfhei1' USING DFHEIV0,
 21385           CRTT-ID,
 21386           CERTIFICATE-TRAILERS,
 21387           DFHEIV11,
 21388           WS-ELCRTT-KEY,
 21389           DFHEIV99,
 21390           DFHEIV99,
 21391           DFHEIV99
 21392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21393
 21394
 21395     IF WS-INS-AGE-SET = 'Y'
 21396        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21397     END-IF
 21398     IF WS-JNT-AGE-SET = 'Y'
 21399        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21400     END-IF
 21401
 21402
 21403* EXEC CICS REWRITE
 21404*       DATASET  (CRTT-ID)
 21405*       FROM     (CERTIFICATE-TRAILERS)
 21406*    END-EXEC.
 21407     MOVE LENGTH OF
 21408      CERTIFICATE-TRAILERS
 21409       TO DFHEIV11
 21410*    MOVE '&& L                  %   #00020379' TO DFHEIV0
 21411     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21412     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21413     MOVE X'2020233030303230333739' TO DFHEIV0(25:11)
 21414     CALL 'kxdfhei1' USING DFHEIV0,
 21415           CRTT-ID,
 21416           CERTIFICATE-TRAILERS,
 21417           DFHEIV11,
 21418           DFHEIV99
 21419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21420
 21421
 21422     GO TO 8195-EXIT.
 21423
 21424 8195-NOTFND.
 21425
 21426     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21427     MOVE 'CS'         TO CS-RECORD-ID.
 21428     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21429     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21430     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21431     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21432     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21433
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 395
* EL050.cbl
 21434* EXEC CICS WRITE
 21435*       DATASET  (CRTT-ID)
 21436*       RIDFLD   (WS-ELCRTT-KEY)
 21437*       FROM     (CERTIFICATE-TRAILERS)
 21438*    END-EXEC.
 21439     MOVE LENGTH OF
 21440      CERTIFICATE-TRAILERS
 21441       TO DFHEIV11
 21442*    MOVE '&$ L                  ''   #00020395' TO DFHEIV0
 21443     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21444     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21445     MOVE X'2020233030303230333935' TO DFHEIV0(25:11)
 21446     CALL 'kxdfhei1' USING DFHEIV0,
 21447           CRTT-ID,
 21448           CERTIFICATE-TRAILERS,
 21449           DFHEIV11,
 21450           WS-ELCRTT-KEY,
 21451           DFHEIV99,
 21452           DFHEIV99
 21453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21454
 21455
 21456 8195-EXIT.
 21457     EXIT.
 21458
 21459 8200-READ-REIN-TABLE.
 21460
 21461* EXEC CICS HANDLE CONDITION
 21462*         NOTFND   (8200-NOTFND)
 21463*    END-EXEC.
 21464*    MOVE '"$I                   ! 3 #00020405' TO DFHEIV0
 21465     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21467     MOVE X'3320233030303230343035' TO DFHEIV0(25:11)
 21468     CALL 'kxdfhei1' USING DFHEIV0
 21469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21470
 21471
 21472
 21473* EXEC CICS READ
 21474*        DATASET     (REIN-ID)
 21475*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21476*        RIDFLD      (ERREIN-KEY)
 21477*    END-EXEC.
 21478*    MOVE '&"S        E          (   #00020409' TO DFHEIV0
 21479     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21481     MOVE X'2020233030303230343039' TO DFHEIV0(25:11)
 21482     CALL 'kxdfhei1' USING DFHEIV0,
 21483           REIN-ID,
 21484           DFHEIV20,
 21485           DFHEIV99,
 21486           ERREIN-KEY,
 21487           DFHEIV99,
 21488           DFHEIV99,
 21489           DFHEIV99
 21490     SET ADDRESS OF REINSURANCE-RECORD TO
 21491         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 396
* EL050.cbl
 21492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21493
 21494
 21495     GO TO 8200-EXIT.
 21496
 21497 8200-NOTFND.
 21498     MOVE 'N'             TO WS-REIN-READ-SW.
 21499
 21500 8200-EXIT.
 21501      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 397
* EL050.cbl
 21503
 21504 8300-READ-CTBL-TABLE.
 21505
 21506* EXEC CICS HANDLE CONDITION
 21507*        NOTFND    (8300-NOTFND)
 21508*        DISABLED  (8300-ERRESS-PROBLEM)
 21509*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21510*        ENDFILE   (8300-NOTFND)
 21511*    END-EXEC.
 21512*    MOVE '"$IcJ''                ! 4 #00020425' TO DFHEIV0
 21513     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21515     MOVE X'3420233030303230343235' TO DFHEIV0(25:11)
 21516     CALL 'kxdfhei1' USING DFHEIV0
 21517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21518
 21519
 21520
 21521* EXEC CICS READ
 21522*        DATASET     (CTBL-ID)
 21523*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21524*        RIDFLD      (ERCTBL-KEY)
 21525*    END-EXEC.
 21526*    MOVE '&"S        E          (   #00020432' TO DFHEIV0
 21527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21529     MOVE X'2020233030303230343332' TO DFHEIV0(25:11)
 21530     CALL 'kxdfhei1' USING DFHEIV0,
 21531           CTBL-ID,
 21532           DFHEIV20,
 21533           DFHEIV99,
 21534           ERCTBL-KEY,
 21535           DFHEIV99,
 21536           DFHEIV99,
 21537           DFHEIV99
 21538     SET ADDRESS OF COMM-TABLE-RECORD TO
 21539         DFHEIV20
 21540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21541
 21542
 21543     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21544
 21545     GO TO 8300-EXIT.
 21546
 21547 8300-NOTFND.
 21548
 21549     IF CTBL-SW = '0530'
 21550         MOVE 'AA'                     TO WS-AH-COMP-CD
 21551         MOVE '0550'                   TO CTBL-SW
 21552         MOVE '1'                      TO WS-CTBL-READ-SW
 21553         GO TO 8300-EXIT.
 21554
 21555     IF CTBL-SW = '0540'
 21556         MOVE 'AA'                     TO WS-LF-COMP-CD
 21557         MOVE '0550'                   TO CTBL-SW
 21558         MOVE '1'                      TO WS-CTBL-READ-SW
 21559         GO TO 8300-EXIT.
 21560
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 398
* EL050.cbl
 21561     IF CTBL-SW = '0550'
 21562         MOVE '2'                      TO WS-CTBL-READ-SW
 21563         GO TO 8300-EXIT.
 21564
 21565     GO TO 8300-EXIT.
 21566
 21567 8300-ERRESS-PROBLEM.
 21568
 21569      MOVE ER-8050              TO WS-ERROR.
 21570      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21571
 21572     GO TO 8300-EXIT.
 21573
 21574 8300-EXIT.
 21575      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 399
* EL050.cbl
 21577
 21578
 21579 8400-GETMAIN-ERFORM.
 21580
 21581
 21582* EXEC CICS   GETMAIN
 21583*        LENGTH  (500)
 21584*        SET     (ADDRESS OF FORM-MASTER)
 21585*    END-EXEC.
 21586     MOVE 500
 21587       TO DFHEIV11
 21588*    MOVE '," L                  $   #00020476' TO DFHEIV0
 21589     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21590     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21591     MOVE X'2020233030303230343736' TO DFHEIV0(25:11)
 21592     CALL 'kxdfhei1' USING DFHEIV0,
 21593           DFHEIV20,
 21594           DFHEIV11,
 21595           DFHEIV99
 21596     SET ADDRESS OF FORM-MASTER TO
 21597         DFHEIV20
 21598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21599
 21600
 21601     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21602
 21603 8400-EXIT.
 21604      EXIT.
 21605
 21606 8450-READ-FORM-MASTER.
 21607
 21608
 21609* EXEC CICS  HANDLE CONDITION
 21610*        NOTFND   (8450-FORM-NOT-FOUND)
 21611*        ENDFILE  (8450-FORM-NOT-FOUND)
 21612*    END-EXEC.
 21613*    MOVE '"$I''                  ! 5 #00020488' TO DFHEIV0
 21614     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21616     MOVE X'3520233030303230343838' TO DFHEIV0(25:11)
 21617     CALL 'kxdfhei1' USING DFHEIV0
 21618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21619
 21620
 21621
 21622* EXEC CICS   READ
 21623*        DATASET   (FORM-ID)
 21624*        RIDFLD    (ERFORM-KEY)
 21625*        INTO      (FORM-MASTER)
 21626*        GTEQ
 21627*    END-EXEC.
 21628     MOVE LENGTH OF
 21629      FORM-MASTER
 21630       TO DFHEIV11
 21631*    MOVE '&"IL       G          (   #00020493' TO DFHEIV0
 21632     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21633     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21634     MOVE X'2020233030303230343933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 400
* EL050.cbl
 21635     CALL 'kxdfhei1' USING DFHEIV0,
 21636           FORM-ID,
 21637           FORM-MASTER,
 21638           DFHEIV11,
 21639           ERFORM-KEY,
 21640           DFHEIV99,
 21641           DFHEIV99,
 21642           DFHEIV99
 21643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21644
 21645
 21646     MOVE  'Y'           TO  FORM-MASTER-SW.
 21647
 21648     GO TO  8450-EXIT.
 21649
 21650 8450-FORM-NOT-FOUND.
 21651
 21652     MOVE  'N'           TO  FORM-MASTER-SW.
 21653
 21654 8450-EXIT.
 21655      EXIT.
 21656
 21657 8500-DATE-CONVERT.
 21658
 21659* EXEC CICS LINK
 21660*        PROGRAM    ('ELDATCV')
 21661*        COMMAREA   (DATE-CONVERSION-DATA)
 21662*        LENGTH     (DC-COMM-LENGTH)
 21663*    END-EXEC.
 21664     MOVE 'ELDATCV' TO DFHEIV1
 21665*    MOVE '."C                   (   #00020512' TO DFHEIV0
 21666     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21668     MOVE X'2020233030303230353132' TO DFHEIV0(25:11)
 21669     CALL 'kxdfhei1' USING DFHEIV0,
 21670           DFHEIV1,
 21671           DATE-CONVERSION-DATA,
 21672           DC-COMM-LENGTH,
 21673           DFHEIV99,
 21674           DFHEIV99,
 21675           DFHEIV99,
 21676           DFHEIV99
 21677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21678
 21679
 21680 8500-EXIT.
 21681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 401
* EL050.cbl
 21683
 21684 8555-RELOAD-CONTROL-FILE.
 21685     CONTINUE.
 21686
 21687 8555-EXIT.
 21688     EXIT.
 21689
 21690 8557-GETMAIN-ERPLAN.
 21691
 21692
 21693* EXEC CICS GETMAIN
 21694*        LENGTH    (840)
 21695*        SET       (ADDRESS OF PLAN-RECORDS)
 21696*    END-EXEC.
 21697     MOVE 840
 21698       TO DFHEIV11
 21699*    MOVE '," L                  $   #00020530' TO DFHEIV0
 21700     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21701     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21702     MOVE X'2020233030303230353330' TO DFHEIV0(25:11)
 21703     CALL 'kxdfhei1' USING DFHEIV0,
 21704           DFHEIV20,
 21705           DFHEIV11,
 21706           DFHEIV99
 21707     SET ADDRESS OF PLAN-RECORDS TO
 21708         DFHEIV20
 21709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21710
 21711
 21712     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21713
 21714 8557-EXIT.
 21715     EXIT.
 21716
 21717 8560-GETMAIN.
 21718
 21719* EXEC CICS GETMAIN
 21720*        LENGTH    (2000)
 21721*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21722*    END-EXEC.
 21723     MOVE 2000
 21724       TO DFHEIV11
 21725*    MOVE '," L                  $   #00020541' TO DFHEIV0
 21726     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21727     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21728     MOVE X'2020233030303230353431' TO DFHEIV0(25:11)
 21729     CALL 'kxdfhei1' USING DFHEIV0,
 21730           DFHEIV20,
 21731           DFHEIV11,
 21732           DFHEIV99
 21733     SET ADDRESS OF ACCOUNT-MASTER TO
 21734         DFHEIV20
 21735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21736
 21737
 21738     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21739
 21740 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 402
* EL050.cbl
 21741     EXIT.
 21742
 21743 8570-START-ACCOUNT-MASTER.
 21744
 21745* EXEC CICS HANDLE CONDITION
 21746*        NOTFND    (0199-ACCT-NOT-FOUND)
 21747*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21748*    END-EXEC.
 21749*    MOVE '"$I''                  ! 6 #00020552' TO DFHEIV0
 21750     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21752     MOVE X'3620233030303230353532' TO DFHEIV0(25:11)
 21753     CALL 'kxdfhei1' USING DFHEIV0
 21754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21755
 21756
 21757
 21758* EXEC CICS STARTBR
 21759*        DATASET    (ACCT-ID)
 21760*        RIDFLD     (ERACCT-KEY)
 21761*        GTEQ
 21762*    END-EXEC.
 21763     MOVE 0
 21764       TO DFHEIV11
 21765*    MOVE '&,         G          &   #00020557' TO DFHEIV0
 21766     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21767     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21768     MOVE X'2020233030303230353537' TO DFHEIV0(25:11)
 21769     CALL 'kxdfhei1' USING DFHEIV0,
 21770           ACCT-ID,
 21771           ERACCT-KEY,
 21772           DFHEIV99,
 21773           DFHEIV11,
 21774           DFHEIV99
 21775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21776
 21777
 21778 8570-EXIT.
 21779     EXIT.
 21780
 21781 8580-READ-ACCOUNT-MASTER.
 21782
 21783* EXEC CICS HANDLE CONDITION
 21784*        NOTFND    (0199-ACCT-NOT-FOUND)
 21785*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21786*    END-EXEC.
 21787*    MOVE '"$I''                  ! 7 #00020567' TO DFHEIV0
 21788     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21790     MOVE X'3720233030303230353637' TO DFHEIV0(25:11)
 21791     CALL 'kxdfhei1' USING DFHEIV0
 21792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21793
 21794
 21795
 21796* EXEC CICS READNEXT
 21797*        DATASET     (ACCT-ID)
 21798*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 403
* EL050.cbl
 21799*        RIDFLD      (ERACCT-KEY)
 21800*    END-EXEC.
 21801     MOVE LENGTH OF
 21802      ACCOUNT-MASTER
 21803       TO DFHEIV12
 21804     MOVE 0
 21805       TO DFHEIV11
 21806*    MOVE '&.IL                  )   #00020572' TO DFHEIV0
 21807     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21808     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21809     MOVE X'2020233030303230353732' TO DFHEIV0(25:11)
 21810     CALL 'kxdfhei1' USING DFHEIV0,
 21811           ACCT-ID,
 21812           ACCOUNT-MASTER,
 21813           DFHEIV12,
 21814           ERACCT-KEY,
 21815           DFHEIV99,
 21816           DFHEIV11,
 21817           DFHEIV99,
 21818           DFHEIV99
 21819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21820
 21821
 21822 8580-EXIT.
 21823     EXIT.
 21824
 21825 8582-READ-COMPENSATION-MASTER.
 21826
 21827* EXEC CICS HANDLE CONDITION
 21828*        NOTFND    (8582-COMP-NOT-FOUND)
 21829*        ENDFILE   (8582-COMP-NOT-FOUND)
 21830*    END-EXEC.
 21831*    MOVE '"$I''                  ! 8 #00020582' TO DFHEIV0
 21832     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21834     MOVE X'3820233030303230353832' TO DFHEIV0(25:11)
 21835     CALL 'kxdfhei1' USING DFHEIV0
 21836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21837
 21838
 21839
 21840* EXEC CICS READ
 21841*        DATASET     (COMP-ID)
 21842*        INTO        (COMPENSATION-MASTER)
 21843*        RIDFLD      (ERCOMP-KEY)
 21844*    END-EXEC.
 21845     MOVE LENGTH OF
 21846      COMPENSATION-MASTER
 21847       TO DFHEIV11
 21848*    MOVE '&"IL       E          (   #00020587' TO DFHEIV0
 21849     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21851     MOVE X'2020233030303230353837' TO DFHEIV0(25:11)
 21852     CALL 'kxdfhei1' USING DFHEIV0,
 21853           COMP-ID,
 21854           COMPENSATION-MASTER,
 21855           DFHEIV11,
 21856           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 404
* EL050.cbl
 21857           DFHEIV99,
 21858           DFHEIV99,
 21859           DFHEIV99
 21860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21861
 21862
 21863     MOVE 'Y'                    TO COMP-MASTER-SW
 21864
 21865     GO TO 8582-EXIT
 21866     .
 21867 8582-COMP-NOT-FOUND.
 21868
 21869     MOVE 'N'                    TO COMP-MASTER-SW.
 21870
 21871 8582-EXIT.
 21872     EXIT.
 21873
 21874 8583-READ-ERAGTC.
 21875
 21876* EXEC CICS HANDLE CONDITION
 21877*        NOTFND    (8583-AGTC-NOT-FOUND)
 21878*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21879*    END-EXEC.
 21880*    MOVE '"$I''                  ! 9 #00020605' TO DFHEIV0
 21881     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21883     MOVE X'3920233030303230363035' TO DFHEIV0(25:11)
 21884     CALL 'kxdfhei1' USING DFHEIV0
 21885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21886
 21887
 21888
 21889* EXEC CICS STARTBR
 21890*        DATASET    (AGTC-ID)
 21891*        RIDFLD     (ERAGTC-KEY)
 21892*        GTEQ
 21893*    END-EXEC.
 21894     MOVE 0
 21895       TO DFHEIV11
 21896*    MOVE '&,         G          &   #00020610' TO DFHEIV0
 21897     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21898     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21899     MOVE X'2020233030303230363130' TO DFHEIV0(25:11)
 21900     CALL 'kxdfhei1' USING DFHEIV0,
 21901           AGTC-ID,
 21902           ERAGTC-KEY,
 21903           DFHEIV99,
 21904           DFHEIV11,
 21905           DFHEIV99
 21906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21907
 21908
 21909 8583-READ-ERAGTC-NEXT.
 21910
 21911* EXEC CICS READNEXT
 21912*        DATASET     (AGTC-ID)
 21913*        INTO        (AGENT-COMMISSIONS)
 21914*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 405
* EL050.cbl
 21915*    END-EXEC.
 21916     MOVE LENGTH OF
 21917      AGENT-COMMISSIONS
 21918       TO DFHEIV12
 21919     MOVE 0
 21920       TO DFHEIV11
 21921*    MOVE '&.IL                  )   #00020617' TO DFHEIV0
 21922     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21923     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21924     MOVE X'2020233030303230363137' TO DFHEIV0(25:11)
 21925     CALL 'kxdfhei1' USING DFHEIV0,
 21926           AGTC-ID,
 21927           AGENT-COMMISSIONS,
 21928           DFHEIV12,
 21929           ERAGTC-KEY,
 21930           DFHEIV99,
 21931           DFHEIV11,
 21932           DFHEIV99,
 21933           DFHEIV99
 21934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21935
 21936
 21937*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21938
 21939     GO TO 8583-EXIT
 21940     .
 21941 8583-AGTC-NOT-FOUND.
 21942
 21943     MOVE 'N'                    TO AGTC-MASTER-SW.
 21944
 21945 8583-EXIT.
 21946     EXIT.
 21947
 21948 8584-READ-BANK-CROSS-REF.
 21949
 21950* EXEC CICS HANDLE CONDITION
 21951*        NOTFND    (8584-BXRF-NOT-FOUND)
 21952*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21953*    END-EXEC.
 21954*    MOVE '"$I''                  ! : #00020635' TO DFHEIV0
 21955     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21957     MOVE X'3A20233030303230363335' TO DFHEIV0(25:11)
 21958     CALL 'kxdfhei1' USING DFHEIV0
 21959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21960
 21961
 21962
 21963* EXEC CICS READ
 21964*        DATASET     (BXRF-ID)
 21965*        INTO        (BANK-CROSS-REFERENCE)
 21966*        RIDFLD      (ERBXRF-KEY)
 21967*        LENGTH      (BXRF-REC-LENGTH)
 21968*    END-EXEC.
 21969*    MOVE '&"IL       E          (   #00020640' TO DFHEIV0
 21970     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21972     MOVE X'2020233030303230363430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 406
* EL050.cbl
 21973     CALL 'kxdfhei1' USING DFHEIV0,
 21974           BXRF-ID,
 21975           BANK-CROSS-REFERENCE,
 21976           BXRF-REC-LENGTH,
 21977           ERBXRF-KEY,
 21978           DFHEIV99,
 21979           DFHEIV99,
 21980           DFHEIV99
 21981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21982
 21983
 21984     MOVE 'Y'                    TO BXRF-MASTER-SW
 21985
 21986     GO TO 8584-EXIT
 21987     .
 21988 8584-BXRF-NOT-FOUND.
 21989
 21990     MOVE 'N'                    TO BXRF-MASTER-SW.
 21991
 21992 8584-EXIT.
 21993     EXIT.
 21994
 21995 8585-READ-PLAN-MASTER.
 21996
 21997
 21998* EXEC CICS HANDLE CONDITION
 21999*        NOTFND    (8585-PLAN-NOT-FOUND)
 22000*        ENDFILE   (8585-PLAN-NOT-FOUND)
 22001*    END-EXEC.
 22002*    MOVE '"$I''                  ! ; #00020660' TO DFHEIV0
 22003     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22005     MOVE X'3B20233030303230363630' TO DFHEIV0(25:11)
 22006     CALL 'kxdfhei1' USING DFHEIV0
 22007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22008
 22009
 22010
 22011* EXEC CICS READ
 22012*        DATASET     (PLAN-ID)
 22013*        INTO        (PLAN-MASTER)
 22014*        RIDFLD      (ERPLAN-KEY)
 22015*    END-EXEC.
 22016     MOVE LENGTH OF
 22017      PLAN-MASTER
 22018       TO DFHEIV11
 22019*    MOVE '&"IL       E          (   #00020665' TO DFHEIV0
 22020     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22022     MOVE X'2020233030303230363635' TO DFHEIV0(25:11)
 22023     CALL 'kxdfhei1' USING DFHEIV0,
 22024           PLAN-ID,
 22025           PLAN-MASTER,
 22026           DFHEIV11,
 22027           ERPLAN-KEY,
 22028           DFHEIV99,
 22029           DFHEIV99,
 22030           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 407
* EL050.cbl
 22031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22032
 22033
 22034     MOVE 'Y'                    TO PLAN-MASTER-SW.
 22035
 22036     GO TO 8585-EXIT.
 22037
 22038 8585-PLAN-NOT-FOUND.
 22039
 22040     MOVE 'N'                    TO PLAN-MASTER-SW.
 22041
 22042 8585-EXIT.
 22043     EXIT.
 22044
 22045 8586-READ-LOAN-OFFICER.
 22046
 22047* EXEC CICS READ
 22048*        DATASET     (LOFC-ID)
 22049*        INTO        (LOAN-OFFICER-MASTER)
 22050*        RIDFLD      (ERLOFC-KEY)
 22051*        RESP        (WS-RESPONSE)
 22052*    END-EXEC
 22053     MOVE LENGTH OF
 22054      LOAN-OFFICER-MASTER
 22055       TO DFHEIV11
 22056*    MOVE '&"IL       E          (  N#00020683' TO DFHEIV0
 22057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22059     MOVE X'204E233030303230363833' TO DFHEIV0(25:11)
 22060     CALL 'kxdfhei1' USING DFHEIV0,
 22061           LOFC-ID,
 22062           LOAN-OFFICER-MASTER,
 22063           DFHEIV11,
 22064           ERLOFC-KEY,
 22065           DFHEIV99,
 22066           DFHEIV99,
 22067           DFHEIV99
 22068     MOVE EIBRESP  TO WS-RESPONSE
 22069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22070
 22071     IF WS-RESP-NORMAL
 22072        MOVE 'Y'                 TO LOFC-MASTER-SW
 22073     ELSE
 22074        MOVE 'N'                 TO LOFC-MASTER-SW
 22075     END-IF
 22076     .
 22077 8586-EXIT.
 22078     EXIT.
 22079 8587-START-ERPDEF.
 22080
 22081* EXEC CICS STARTBR
 22082*       DATASET   (PDEF-ID)
 22083*       RIDFLD    (ERPDEF-KEY)
 22084*       GTEQ
 22085*       RESP      (WS-RESPONSE)
 22086*    END-EXEC
 22087     MOVE 0
 22088       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 408
* EL050.cbl
 22089*    MOVE '&,         G          &  N#00020699' TO DFHEIV0
 22090     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22091     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22092     MOVE X'204E233030303230363939' TO DFHEIV0(25:11)
 22093     CALL 'kxdfhei1' USING DFHEIV0,
 22094           PDEF-ID,
 22095           ERPDEF-KEY,
 22096           DFHEIV99,
 22097           DFHEIV11,
 22098           DFHEIV99
 22099     MOVE EIBRESP  TO WS-RESPONSE
 22100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22101     IF WS-RESP-NORMAL
 22102        MOVE 'Y'                 TO PDEF-MASTER-SW
 22103     ELSE
 22104        MOVE 'N'                 TO PDEF-MASTER-SW
 22105     END-IF
 22106     .
 22107 8587-EXIT.
 22108     EXIT.
 22109 8588-READ-ERPDEF.
 22110
 22111* EXEC CICS READNEXT
 22112*       DATASET   (PDEF-ID)
 22113*       RIDFLD    (ERPDEF-KEY)
 22114*       INTO      (PRODUCT-MASTER)
 22115*       RESP      (WS-RESPONSE)
 22116*    END-EXEC
 22117     MOVE LENGTH OF
 22118      PRODUCT-MASTER
 22119       TO DFHEIV12
 22120     MOVE 0
 22121       TO DFHEIV11
 22122*    MOVE '&.IL                  )  N#00020714' TO DFHEIV0
 22123     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22124     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22125     MOVE X'204E233030303230373134' TO DFHEIV0(25:11)
 22126     CALL 'kxdfhei1' USING DFHEIV0,
 22127           PDEF-ID,
 22128           PRODUCT-MASTER,
 22129           DFHEIV12,
 22130           ERPDEF-KEY,
 22131           DFHEIV99,
 22132           DFHEIV11,
 22133           DFHEIV99,
 22134           DFHEIV99
 22135     MOVE EIBRESP  TO WS-RESPONSE
 22136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22137     IF WS-RESP-NORMAL
 22138        MOVE 'Y'                 TO PDEF-MASTER-SW
 22139     ELSE
 22140        MOVE 'N'                 TO PDEF-MASTER-SW
 22141     END-IF
 22142     .
 22143 8588-EXIT.
 22144     EXIT.
 22145 8589-ENDBR-ERPDEF.
 22146
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 409
* EL050.cbl
 22147* EXEC CICS ENDBR
 22148*       DATASET   (PDEF-ID)
 22149*    END-EXEC
 22150     MOVE 0
 22151       TO DFHEIV11
 22152*    MOVE '&2                    $   #00020729' TO DFHEIV0
 22153     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22154     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22155     MOVE X'2020233030303230373239' TO DFHEIV0(25:11)
 22156     CALL 'kxdfhei1' USING DFHEIV0,
 22157           PDEF-ID,
 22158           DFHEIV11,
 22159           DFHEIV99
 22160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22161     .
 22162 8589-EXIT.
 22163     EXIT.
 22164 8590-READ-CERT-MASTER.
 22165     IF PB-COMPANY-ID = 'UCL'
 22166         GO TO 8690-READ-CERT-MASTER-UCL.
 22167
 22168
 22169* EXEC CICS HANDLE CONDITION
 22170*         NOTFND    (0299-CERT-NOT-FOUND)
 22171*    END-EXEC.
 22172*    MOVE '"$I                   ! < #00020739' TO DFHEIV0
 22173     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22175     MOVE X'3C20233030303230373339' TO DFHEIV0(25:11)
 22176     CALL 'kxdfhei1' USING DFHEIV0
 22177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22178
 22179
 22180
 22181* EXEC CICS READ
 22182*        DATASET     (CERT-ID)
 22183*        INTO        (CERTIFICATE-MASTER)
 22184*        RIDFLD      (ELCERT-KEY)
 22185*        UPDATE
 22186*    END-EXEC.
 22187     MOVE LENGTH OF
 22188      CERTIFICATE-MASTER
 22189       TO DFHEIV11
 22190*    MOVE '&"IL       EU         (   #00020743' TO DFHEIV0
 22191     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22192     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22193     MOVE X'2020233030303230373433' TO DFHEIV0(25:11)
 22194     CALL 'kxdfhei1' USING DFHEIV0,
 22195           CERT-ID,
 22196           CERTIFICATE-MASTER,
 22197           DFHEIV11,
 22198           ELCERT-KEY,
 22199           DFHEIV99,
 22200           DFHEIV99,
 22201           DFHEIV99
 22202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22203
 22204
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 410
* EL050.cbl
 22205 8590-EXIT.
 22206     EXIT.
 22207
 22208 8690-READ-CERT-MASTER-UCL.
 22209
 22210* EXEC CICS HANDLE CONDITION
 22211*         NOTFND    (8700-READ-CERT-MASTER)
 22212*    END-EXEC.
 22213*    MOVE '"$I                   ! = #00020754' TO DFHEIV0
 22214     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22216     MOVE X'3D20233030303230373534' TO DFHEIV0(25:11)
 22217     CALL 'kxdfhei1' USING DFHEIV0
 22218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22219
 22220
 22221 8690-READ-CERT-CONT.
 22222
 22223* EXEC CICS READ
 22224*        DATASET     (CERT-ID)
 22225*        INTO        (CERTIFICATE-MASTER)
 22226*        RIDFLD      (ELCERT-KEY)
 22227*        UPDATE
 22228*    END-EXEC.
 22229     MOVE LENGTH OF
 22230      CERTIFICATE-MASTER
 22231       TO DFHEIV11
 22232*    MOVE '&"IL       EU         (   #00020759' TO DFHEIV0
 22233     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22234     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22235     MOVE X'2020233030303230373539' TO DFHEIV0(25:11)
 22236     CALL 'kxdfhei1' USING DFHEIV0,
 22237           CERT-ID,
 22238           CERTIFICATE-MASTER,
 22239           DFHEIV11,
 22240           ELCERT-KEY,
 22241           DFHEIV99,
 22242           DFHEIV99,
 22243           DFHEIV99
 22244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22245
 22246
 22247     GO TO 8590-EXIT.
 22248
 22249 8700-READ-CERT-MASTER.
 22250     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22251     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22252
 22253* EXEC CICS HANDLE CONDITION
 22254*         DUPKEY    (8720-COMP-ACCOUNTS)
 22255*         ENDFILE   (8730-END-BROWSE)
 22256*         NOTFND    (8740-NOT-FOUND)
 22257*    END-EXEC.
 22258*    MOVE '"$$''I                 ! > #00020771' TO DFHEIV0
 22259     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22261     MOVE X'3E20233030303230373731' TO DFHEIV0(25:11)
 22262     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 411
* EL050.cbl
 22263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22264
 22265
 22266
 22267* EXEC CICS STARTBR
 22268*        DATASET     ('ELCERT5')
 22269*        RIDFLD      (ELCERT2-KEY)
 22270*        EQUAL
 22271*    END-EXEC.
 22272     MOVE 'ELCERT5' TO DFHEIV1
 22273     MOVE 0
 22274       TO DFHEIV11
 22275*    MOVE '&,         E          &   #00020777' TO DFHEIV0
 22276     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22277     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22278     MOVE X'2020233030303230373737' TO DFHEIV0(25:11)
 22279     CALL 'kxdfhei1' USING DFHEIV0,
 22280           DFHEIV1,
 22281           ELCERT2-KEY,
 22282           DFHEIV99,
 22283           DFHEIV11,
 22284           DFHEIV99
 22285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22286
 22287
 22288 8710-READ-NEXT.
 22289
 22290* EXEC CICS READNEXT
 22291*        DATASET     ('ELCERT5')
 22292*        INTO        (CERTIFICATE-MASTER)
 22293*        RIDFLD      (ELCERT2-KEY)
 22294*    END-EXEC.
 22295     MOVE LENGTH OF
 22296      CERTIFICATE-MASTER
 22297       TO DFHEIV12
 22298     MOVE 'ELCERT5' TO DFHEIV1
 22299     MOVE 0
 22300       TO DFHEIV11
 22301*    MOVE '&.IL                  )   #00020784' TO DFHEIV0
 22302     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22304     MOVE X'2020233030303230373834' TO DFHEIV0(25:11)
 22305     CALL 'kxdfhei1' USING DFHEIV0,
 22306           DFHEIV1,
 22307           CERTIFICATE-MASTER,
 22308           DFHEIV12,
 22309           ELCERT2-KEY,
 22310           DFHEIV99,
 22311           DFHEIV11,
 22312           DFHEIV99,
 22313           DFHEIV99
 22314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22315
 22316
 22317 8720-COMP-ACCOUNTS.
 22318
 22319* EXEC CICS ENTER
 22320*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 412
* EL050.cbl
 22321*         FROM (PB-C-LAST-NAME)
 22322*    END-EXEC.
 22323     MOVE 001
 22324       TO DFHEIV11
 22325*    MOVE ':$F                   %   #00020791' TO DFHEIV0
 22326     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22327     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22328     MOVE X'2020233030303230373931' TO DFHEIV0(25:11)
 22329     CALL 'kxdfhei1' USING DFHEIV0,
 22330           DFHEIV11,
 22331           PB-C-LAST-NAME,
 22332           DFHEIV99,
 22333           DFHEIV99
 22334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22335
 22336
 22337
 22338* EXEC CICS ENTER
 22339*         TRACEID (002)
 22340*         FROM (CM-INSURED-LAST-NAME)
 22341*    END-EXEC.
 22342     MOVE 002
 22343       TO DFHEIV11
 22344*    MOVE ':$F                   %   #00020796' TO DFHEIV0
 22345     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22347     MOVE X'2020233030303230373936' TO DFHEIV0(25:11)
 22348     CALL 'kxdfhei1' USING DFHEIV0,
 22349           DFHEIV11,
 22350           CM-INSURED-LAST-NAME,
 22351           DFHEIV99,
 22352           DFHEIV99
 22353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22354
 22355
 22356     IF PB-CERT-NO NOT = CM-CERT-NO
 22357         GO TO 8730-END-BROWSE.
 22358
 22359     IF PB-ACCOUNT = CM-ACCOUNT
 22360         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22361             MOVE ER-2799        TO WS-ERROR
 22362             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22363             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22364             GO TO 8730-END-BROWSE.
 22365
 22366     GO TO 8710-READ-NEXT.
 22367
 22368 8730-END-BROWSE.
 22369
 22370* EXEC CICS ENDBR
 22371*         DATASET    ('ELCERT5')
 22372*    END-EXEC.
 22373     MOVE 'ELCERT5' TO DFHEIV1
 22374     MOVE 0
 22375       TO DFHEIV11
 22376*    MOVE '&2                    $   #00020814' TO DFHEIV0
 22377     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 413
* EL050.cbl
 22379     MOVE X'2020233030303230383134' TO DFHEIV0(25:11)
 22380     CALL 'kxdfhei1' USING DFHEIV0,
 22381           DFHEIV1,
 22382           DFHEIV11,
 22383           DFHEIV99
 22384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22385
 22386
 22387 8740-NOT-FOUND.
 22388     GO TO 0299-CERT-NOT-FOUND.
 22389
 22390 8750-START-ELSTAT.
 22391
 22392* EXEC CICS STARTBR
 22393*       DATASET   (STAT-ID)
 22394*       RIDFLD    (ELSTAT-KEY)
 22395*       GTEQ
 22396*       RESP      (WS-RESPONSE)
 22397*    END-EXEC
 22398     MOVE 0
 22399       TO DFHEIV11
 22400*    MOVE '&,         G          &  N#00020822' TO DFHEIV0
 22401     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22402     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22403     MOVE X'204E233030303230383232' TO DFHEIV0(25:11)
 22404     CALL 'kxdfhei1' USING DFHEIV0,
 22405           STAT-ID,
 22406           ELSTAT-KEY,
 22407           DFHEIV99,
 22408           DFHEIV11,
 22409           DFHEIV99
 22410     MOVE EIBRESP  TO WS-RESPONSE
 22411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22412     IF WS-RESP-NORMAL
 22413        MOVE 'Y'                 TO STAT-MASTER-SW
 22414     ELSE
 22415        MOVE 'N'                 TO STAT-MASTER-SW
 22416     END-IF
 22417     .
 22418 8750-EXIT.
 22419     EXIT.
 22420 8752-READ-ELSTAT.
 22421
 22422* EXEC CICS READNEXT
 22423*       DATASET   (STAT-ID)
 22424*       RIDFLD    (ELSTAT-KEY)
 22425*       INTO      (STATE-FILE)
 22426*       RESP      (WS-RESPONSE)
 22427*    END-EXEC
 22428     MOVE LENGTH OF
 22429      STATE-FILE
 22430       TO DFHEIV12
 22431     MOVE 0
 22432       TO DFHEIV11
 22433*    MOVE '&.IL                  )  N#00020837' TO DFHEIV0
 22434     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22435     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22436     MOVE X'204E233030303230383337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 414
* EL050.cbl
 22437     CALL 'kxdfhei1' USING DFHEIV0,
 22438           STAT-ID,
 22439           STATE-FILE,
 22440           DFHEIV12,
 22441           ELSTAT-KEY,
 22442           DFHEIV99,
 22443           DFHEIV11,
 22444           DFHEIV99,
 22445           DFHEIV99
 22446     MOVE EIBRESP  TO WS-RESPONSE
 22447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22448     IF WS-RESP-NORMAL
 22449        MOVE 'Y'                 TO STAT-MASTER-SW
 22450     ELSE
 22451        MOVE 'N'                 TO STAT-MASTER-SW
 22452     END-IF
 22453     .
 22454 8752-EXIT.
 22455     EXIT.
 22456 8800-GET-COMP-RATE.
 22457     MOVE +1 TO IB.
 22458     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22459         ADD +9 TO IB
 22460         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22461             ADD +9 TO IB
 22462             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22463                MOVE ZEROS       TO WS-WK-RATE
 22464                GO TO 8800-EXIT.
 22465
 22466     IF PB-I-AGE GREATER CT-AGE (1)
 22467         ADD +3 TO IB
 22468         IF PB-I-AGE GREATER CT-AGE (2)
 22469             ADD +3 TO IB
 22470             IF PB-I-AGE GREATER CT-AGE (3)
 22471                MOVE ZEROS       TO WS-WK-RATE
 22472                GO TO 8800-EXIT.
 22473
 22474     IF WS-WORK-TERM GREATER CT-TRM (1)
 22475         ADD +1 TO IB
 22476         IF WS-WORK-TERM GREATER CT-TRM (2)
 22477             ADD +1 TO IB
 22478             IF WS-WORK-TERM GREATER CT-TRM (3)
 22479                MOVE ZEROS       TO WS-WK-RATE
 22480                GO TO 8800-EXIT.
 22481
 22482     IF CT-RT (IB) NOT NUMERIC
 22483         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22484         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22485         GO TO 8800-GET-COMP-RATE.
 22486
 22487     MOVE CT-RT (IB) TO WS-WK-RATE.
 22488
 22489 8800-EXIT.
 22490     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 415
* EL050.cbl
 22492 8900-ADDRESS-FILE.
 22493     IF ERACCT-FILE-ADDRESSED
 22494         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22495         GO TO 8900-ADDRESS-EXIT.
 22496
 22497     IF ELCNTL-FILE-ADDRESSED
 22498         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22499         GO TO 8900-ADDRESS-EXIT.
 22500
 22501     IF ERPLAN-FILE-ADDRESSED
 22502         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22503         GO TO 8900-ADDRESS-EXIT.
 22504
 22505     IF ERFORM-FILE-ADDRESSED
 22506         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22507         GO TO 8900-ADDRESS-EXIT.
 22508
 22509 8900-ADDRESS-EXIT.
 22510     EXIT.
 22511
 22512 9000-READ-CONTROL.
 22513
 22514* EXEC CICS HANDLE CONDITION
 22515*        NOTFND    (9000-NOTFND)
 22516*    END-EXEC.
 22517*    MOVE '"$I                   ! ? #00020908' TO DFHEIV0
 22518     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22520     MOVE X'3F20233030303230393038' TO DFHEIV0(25:11)
 22521     CALL 'kxdfhei1' USING DFHEIV0
 22522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22523
 22524
 22525
 22526* EXEC CICS READ
 22527*        DATASET     (CNTL-ID)
 22528*        SET         (ADDRESS OF CONTROL-FILE)
 22529*        RIDFLD      (ELCNTL-KEY)
 22530*        GTEQ
 22531*    END-EXEC.
 22532*    MOVE '&"S        G          (   #00020912' TO DFHEIV0
 22533     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22534     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22535     MOVE X'2020233030303230393132' TO DFHEIV0(25:11)
 22536     CALL 'kxdfhei1' USING DFHEIV0,
 22537           CNTL-ID,
 22538           DFHEIV20,
 22539           DFHEIV99,
 22540           ELCNTL-KEY,
 22541           DFHEIV99,
 22542           DFHEIV99,
 22543           DFHEIV99
 22544     SET ADDRESS OF CONTROL-FILE TO
 22545         DFHEIV20
 22546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22547
 22548
 22549     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 416
* EL050.cbl
 22550
 22551 9000-NOTFND.
 22552     IF RC-SW-1 = '1'
 22553        MOVE ER-2616              TO WS-ERROR
 22554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22555        GO TO 9000-EXIT.
 22556
 22557     IF RC-SW-1 = '2'
 22558        MOVE ER-2602              TO WS-ERROR
 22559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22560
 22561 9000-EXIT.
 22562      EXIT.
 22563
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 417
* EL050.cbl
 22565 9100-READ-CONTROL.
 22566
 22567* EXEC CICS HANDLE CONDITION
 22568*        NOTFND  (9100-NOTFND)
 22569*        ENDFILE (9100-NOTFND)
 22570*    END-EXEC.
 22571*    MOVE '"$I''                  ! @ #00020936' TO DFHEIV0
 22572     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22574     MOVE X'4020233030303230393336' TO DFHEIV0(25:11)
 22575     CALL 'kxdfhei1' USING DFHEIV0
 22576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22577
 22578
 22579
 22580* EXEC CICS READ
 22581*        DATASET     (CNTL-ID)
 22582*        INTO        (CONTROL-FILE)
 22583*        RIDFLD      (ELCNTL-KEY)
 22584*        GTEQ
 22585*    END-EXEC.
 22586     MOVE LENGTH OF
 22587      CONTROL-FILE
 22588       TO DFHEIV11
 22589*    MOVE '&"IL       G          (   #00020941' TO DFHEIV0
 22590     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22592     MOVE X'2020233030303230393431' TO DFHEIV0(25:11)
 22593     CALL 'kxdfhei1' USING DFHEIV0,
 22594           CNTL-ID,
 22595           CONTROL-FILE,
 22596           DFHEIV11,
 22597           ELCNTL-KEY,
 22598           DFHEIV99,
 22599           DFHEIV99,
 22600           DFHEIV99
 22601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22602
 22603
 22604     GO TO 9100-EXIT.
 22605
 22606 9100-NOTFND.
 22607     IF RC-SW-2 = '0'
 22608        MOVE '1'                  TO STATE-RECORD-ERROR
 22609        GO TO 9100-EXIT
 22610     END-IF
 22611     IF RC-SW-2 = '1'
 22612        MOVE '1'                  TO LF-BENEFIT-ERROR
 22613        MOVE ER-2604              TO WS-ERROR
 22614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22615        GO TO 9100-EXIT.
 22616
 22617     IF RC-SW-2 = '2'
 22618        MOVE '1'                  TO AH-BENEFIT-ERROR
 22619        MOVE ER-2605              TO WS-ERROR
 22620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22621        GO TO 9100-EXIT.
 22622
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 418
* EL050.cbl
 22623     IF RC-SW-2 = '3'
 22624         MOVE ER-2603           TO WS-ERROR
 22625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22626         GO TO 9100-EXIT.
 22627
 22628     IF RC-SW-2 = '4'
 22629         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22630         GO TO 9100-EXIT.
 22631
 22632     IF RC-SW-2 = '5'
 22633         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22634         IF WS-AH-INPUT-CD-1 = SPACE
 22635             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22636         ELSE
 22637             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22638
 22639 9100-EXIT.
 22640      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 419
* EL050.cbl
 22642 9200-CONTROL-GETMAIN.
 22643
 22644* EXEC CICS GETMAIN
 22645*         LENGTH   (750)
 22646*         SET      (ADDRESS OF CONTROL-FILE)
 22647*    END-EXEC.
 22648     MOVE 750
 22649       TO DFHEIV11
 22650*    MOVE '," L                  $   #00020987' TO DFHEIV0
 22651     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22652     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22653     MOVE X'2020233030303230393837' TO DFHEIV0(25:11)
 22654     CALL 'kxdfhei1' USING DFHEIV0,
 22655           DFHEIV20,
 22656           DFHEIV11,
 22657           DFHEIV99
 22658     SET ADDRESS OF CONTROL-FILE TO
 22659         DFHEIV20
 22660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22661
 22662
 22663     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22664
 22665 9200-EXIT.
 22666     EXIT.
 22667
 22668 9250-UNLOCK-RETURN.
 22669
 22670* EXEC CICS UNLOCK
 22671*        DATASET   (CERT-ID)
 22672*    END-EXEC.
 22673*    MOVE '&*                    #   #00020998' TO DFHEIV0
 22674     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22675     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22676     MOVE X'2020233030303230393938' TO DFHEIV0(25:11)
 22677     CALL 'kxdfhei1' USING DFHEIV0,
 22678           CERT-ID,
 22679           DFHEIV99
 22680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22681
 22682
 22683 9300-ABEND.
 22684     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22685
 22686
 22687* EXEC CICS LINK
 22688*        PROGRAM   ('EL004')
 22689*        COMMAREA  (WS-ERROR-LINE)
 22690*        LENGTH    (72)
 22691*    END-EXEC.
 22692     MOVE 'EL004' TO DFHEIV1
 22693     MOVE 72
 22694       TO DFHEIV11
 22695*    MOVE '."C                   (   #00021005' TO DFHEIV0
 22696     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22698     MOVE X'2020233030303231303035' TO DFHEIV0(25:11)
 22699     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 420
* EL050.cbl
 22700           DFHEIV1,
 22701           WS-ERROR-LINE,
 22702           DFHEIV11,
 22703           DFHEIV99,
 22704           DFHEIV99,
 22705           DFHEIV99,
 22706           DFHEIV99
 22707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22708
 22709
 22710     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22711
 22712
 22713* EXEC CICS ABEND
 22714*        ABCODE ('EL50')
 22715*    END-EXEC.
 22716     MOVE 'EL50' TO DFHEIV5
 22717*    MOVE '.,A                   "   #00021013' TO DFHEIV0
 22718     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22719     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22720     MOVE X'2020233030303231303133' TO DFHEIV0(25:11)
 22721     CALL 'kxdfhei1' USING DFHEIV0,
 22722           DFHEIV5
 22723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22724
 22725
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 421
* EL050.cbl
 22727
 22728******************************************************************
 22729*                                                                *
 22730*            E R R O R   F O R M A T   R O U T I N E             *
 22731*                                                                *
 22732******************************************************************
 22733
 22734 9900-ERROR-FORMAT.
 22735
 22736     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22737                    PB-COMMON-ERROR (2) OR
 22738                    PB-COMMON-ERROR (3) OR
 22739                    PB-COMMON-ERROR (4) OR
 22740                    PB-COMMON-ERROR (5) OR
 22741                    PB-COMMON-ERROR (6) OR
 22742                    PB-COMMON-ERROR (7) OR
 22743                    PB-COMMON-ERROR (8) OR
 22744                    PB-COMMON-ERROR (9) OR
 22745                    PB-COMMON-ERROR (10)
 22746        GO TO 9900-EXIT.
 22747
 22748     IF PB-NO-OF-ERRORS = +10
 22749        GO TO 9900-EXIT.
 22750
 22751     ADD +1  TO PB-NO-OF-ERRORS.
 22752     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22753                                       (PB-NO-OF-ERRORS).
 22754 9900-EXIT.
 22755     EXIT.
 22756
 22757 9990-RETURN.
 22758     IF BROWSE-STARTED
 22759
 22760* EXEC CICS ENDBR
 22761*            DATASET  (ACCT-ID)
 22762*       END-EXEC.
 22763     MOVE 0
 22764       TO DFHEIV11
 22765*    MOVE '&2                    $   #00021050' TO DFHEIV0
 22766     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22767     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22768     MOVE X'2020233030303231303530' TO DFHEIV0(25:11)
 22769     CALL 'kxdfhei1' USING DFHEIV0,
 22770           ACCT-ID,
 22771           DFHEIV11,
 22772           DFHEIV99
 22773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22774
 22775
 22776 9990-EXIT.
 22777     EXIT.
 22778
 22779
 22780****Check for CRTO record, add one if not found.
 22781 9991-CHECK-FOR-ELCRTO.
 22782
 22783* EXEC CICS HANDLE CONDITION
 22784*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 422
* EL050.cbl
 22785*         ENDFILE (9991-CRTO-NOT-FOUND)
 22786*     END-EXEC.
 22787*    MOVE '"$I''                  ! A #00021060' TO DFHEIV0
 22788     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22790     MOVE X'4120233030303231303630' TO DFHEIV0(25:11)
 22791     CALL 'kxdfhei1' USING DFHEIV0
 22792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22793
 22794     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22795     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22796     MOVE +0                     TO ELCRTO-SEQ-NO
 22797
 22798
 22799* EXEC CICS READ
 22800*       DATASET   ('ELCRTO')
 22801*       INTO      (ORIGINAL-CERTIFICATE)
 22802*       RIDFLD    (ELCRTO-KEY)
 22803*       GTEQ
 22804*       RESP      (WS-RESPONSE)
 22805*    END-EXEC
 22806     MOVE LENGTH OF
 22807      ORIGINAL-CERTIFICATE
 22808       TO DFHEIV11
 22809     MOVE 'ELCRTO' TO DFHEIV1
 22810*    MOVE '&"IL       G          (  N#00021068' TO DFHEIV0
 22811     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22813     MOVE X'204E233030303231303638' TO DFHEIV0(25:11)
 22814     CALL 'kxdfhei1' USING DFHEIV0,
 22815           DFHEIV1,
 22816           ORIGINAL-CERTIFICATE,
 22817           DFHEIV11,
 22818           ELCRTO-KEY,
 22819           DFHEIV99,
 22820           DFHEIV99,
 22821           DFHEIV99
 22822     MOVE EIBRESP  TO WS-RESPONSE
 22823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22824
 22825     IF WS-RESP-NORMAL
 22826        AND (OC-CONTROL-PRIMARY (1:33) =
 22827                 PB-CONTROL-BY-ACCOUNT (1:33))
 22828        AND (OC-RECORD-TYPE =  'I')
 22829           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22830               GO TO 9991-CHECK-INDICATORS
 22831           ELSE
 22832               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22833               GO TO 9991-CRTO-ADD-REC
 22834           END-IF
 22835     END-IF.
 22836
 22837 9991-CRTO-NOT-FOUND.
 22838
 22839     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22840     MOVE 'OC'                TO OC-RECORD-ID
 22841     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22842                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 423
* EL050.cbl
 22843     MOVE +4096               TO OC-KEY-SEQ-NO.
 22844
 22845 9991-CRTO-ADD-REC.
 22846
 22847     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22848     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22849     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22850     MOVE 'I'                 TO OC-RECORD-TYPE
 22851     IF PB-ISSUE
 22852         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22853         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22854         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22855         MOVE PB-I-AGE               TO OC-INS-AGE
 22856         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22857         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22858         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22859         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22860         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22861         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22862         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22863         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22864         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22865         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22866         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22867         IF PB-I-JOINT-COMMISSION > +0
 22868             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22869         ELSE
 22870             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22871         END-IF
 22872         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22873         MOVE +0                     TO OC-LF-CANCEL-AMT
 22874                                        OC-LF-ITD-CANCEL-AMT
 22875         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22876         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22877         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22878         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22879         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22880         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22881         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22882         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22883         MOVE +0                     TO OC-AH-CANCEL-AMT
 22884                                        OC-AH-ITD-CANCEL-AMT
 22885         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22886         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22887         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22888     ELSE
 22889         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22890         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22891         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22892         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22893         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22894         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22895         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22896         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22897         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22898          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22899             MOVE SPACES             TO OC-LF-BENCD
 22900             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 424
* EL050.cbl
 22901                                        OC-LF-BEN-AMT
 22902                                        OC-LF-PRM-AMT
 22903                                        OC-LF-ALT-BEN-AMT
 22904                                        OC-LF-ALT-PRM-AMT
 22905                                        OC-LF-COMM-PCT
 22906                                        OC-LF-CANCEL-AMT
 22907             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22908             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22909         ELSE
 22910             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22911             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22912             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22913             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22914             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22915             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22916             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22917             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22918             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22919             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22920         END-IF
 22921         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22922         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22923          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22924             MOVE SPACES             TO OC-AH-BENCD
 22925             MOVE ZEROS              TO OC-AH-TERM
 22926                                        OC-AH-BEN-AMT
 22927                                        OC-AH-PRM-AMT
 22928                                        OC-AH-COMM-PCT
 22929                                        OC-AH-CANCEL-AMT
 22930                                        OC-AH-CP
 22931             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22932             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22933         ELSE
 22934             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22935             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22936             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22937             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22938             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22939             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22940             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22941             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22942             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22943         END-IF
 22944         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22945         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22946         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22947         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22948     END-IF
 22949     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22950
 22951     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22952
 22953
 22954* EXEC CICS READ
 22955*         DATASET   (FILE-ERMAIL)
 22956*         RIDFLD    (MA-CONTROL-PRIMARY)
 22957*         INTO      (MAILING-DATA)
 22958*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 425
* EL050.cbl
 22959*    END-EXEC
 22960     MOVE LENGTH OF
 22961      MAILING-DATA
 22962       TO DFHEIV11
 22963*    MOVE '&"IL       E          (  N#00021204' TO DFHEIV0
 22964     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22966     MOVE X'204E233030303231323034' TO DFHEIV0(25:11)
 22967     CALL 'kxdfhei1' USING DFHEIV0,
 22968           FILE-ERMAIL,
 22969           MAILING-DATA,
 22970           DFHEIV11,
 22971           MA-CONTROL-PRIMARY,
 22972           DFHEIV99,
 22973           DFHEIV99,
 22974           DFHEIV99
 22975     MOVE EIBRESP  TO WS-RESPONSE
 22976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22977
 22978     IF WS-RESP-NORMAL
 22979         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22980     END-IF.
 22981
 22982     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22983     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22984
 22985
 22986* EXEC CICS READ
 22987*         DATASET  (CRTT-ID)
 22988*         RIDFLD   (WS-ELCRTT-KEY)
 22989*         INTO     (CERTIFICATE-TRAILERS)
 22990*         RESP     (WS-RESPONSE)
 22991*    END-EXEC
 22992     MOVE LENGTH OF
 22993      CERTIFICATE-TRAILERS
 22994       TO DFHEIV11
 22995*    MOVE '&"IL       E          (  N#00021218' TO DFHEIV0
 22996     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22998     MOVE X'204E233030303231323138' TO DFHEIV0(25:11)
 22999     CALL 'kxdfhei1' USING DFHEIV0,
 23000           CRTT-ID,
 23001           CERTIFICATE-TRAILERS,
 23002           DFHEIV11,
 23003           WS-ELCRTT-KEY,
 23004           DFHEIV99,
 23005           DFHEIV99,
 23006           DFHEIV99
 23007     MOVE EIBRESP  TO WS-RESPONSE
 23008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23009
 23010     IF WS-RESP-NORMAL
 23011         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 23012         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 23013     END-IF.
 23014
 23015
 23016* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 426
* EL050.cbl
 23017*       DATASET   ('ELCRTO')
 23018*       FROM      (ORIGINAL-CERTIFICATE)
 23019*       RIDFLD    (OC-CONTROL-PRIMARY)
 23020*       RESP      (WS-RESPONSE)
 23021*    END-EXEC.
 23022     MOVE LENGTH OF
 23023      ORIGINAL-CERTIFICATE
 23024       TO DFHEIV11
 23025     MOVE 'ELCRTO' TO DFHEIV1
 23026*    MOVE '&$ L                  ''  N#00021230' TO DFHEIV0
 23027     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 23028     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23029     MOVE X'204E233030303231323330' TO DFHEIV0(25:11)
 23030     CALL 'kxdfhei1' USING DFHEIV0,
 23031           DFHEIV1,
 23032           ORIGINAL-CERTIFICATE,
 23033           DFHEIV11,
 23034           OC-CONTROL-PRIMARY,
 23035           DFHEIV99,
 23036           DFHEIV99
 23037     MOVE EIBRESP  TO WS-RESPONSE
 23038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23039
 23040
 23041     GO TO 9991-EXIT.
 23042
 23043 9991-CHECK-INDICATORS.
 23044
 23045     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 23046         GO TO 9991-EXIT
 23047     END-IF.
 23048
 23049     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 23050         GO TO 9991-EXIT
 23051     END-IF.
 23052
 23053
 23054* EXEC CICS READ
 23055*       DATASET   ('ELCRTO')
 23056*       INTO      (ORIGINAL-CERTIFICATE)
 23057*       RIDFLD    (OC-CONTROL-PRIMARY)
 23058*       UPDATE
 23059*       RESP      (WS-RESPONSE)
 23060*    END-EXEC
 23061     MOVE LENGTH OF
 23062      ORIGINAL-CERTIFICATE
 23063       TO DFHEIV11
 23064     MOVE 'ELCRTO' TO DFHEIV1
 23065*    MOVE '&"IL       EU         (  N#00021249' TO DFHEIV0
 23066     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23067     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23068     MOVE X'204E233030303231323439' TO DFHEIV0(25:11)
 23069     CALL 'kxdfhei1' USING DFHEIV0,
 23070           DFHEIV1,
 23071           ORIGINAL-CERTIFICATE,
 23072           DFHEIV11,
 23073           OC-CONTROL-PRIMARY,
 23074           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 427
* EL050.cbl
 23075           DFHEIV99,
 23076           DFHEIV99
 23077     MOVE EIBRESP  TO WS-RESPONSE
 23078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23079     IF WS-RESP-NORMAL
 23080        IF PB-ISSUE
 23081          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 23082          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 23083          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 23084          MOVE PB-I-AGE               TO OC-INS-AGE
 23085          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 23086          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 23087          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 23088          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 23089          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 23090          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 23091          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 23092          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 23093          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 23094          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 23095          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 23096          IF PB-I-JOINT-COMMISSION > +0
 23097              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 23098          ELSE
 23099              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 23100          END-IF
 23101          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 23102          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 23103          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 23104          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 23105          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 23106          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 23107          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 23108          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 23109          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 23110
 23111          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 23112
 23113* EXEC CICS READ
 23114*             DATASET   (FILE-ERMAIL)
 23115*             RIDFLD    (MA-CONTROL-PRIMARY)
 23116*             INTO      (MAILING-DATA)
 23117*             RESP      (WS-RESPONSE)
 23118*         END-EXEC
 23119     MOVE LENGTH OF
 23120      MAILING-DATA
 23121       TO DFHEIV11
 23122*    MOVE '&"IL       E          (  N#00021289' TO DFHEIV0
 23123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23125     MOVE X'204E233030303231323839' TO DFHEIV0(25:11)
 23126     CALL 'kxdfhei1' USING DFHEIV0,
 23127           FILE-ERMAIL,
 23128           MAILING-DATA,
 23129           DFHEIV11,
 23130           MA-CONTROL-PRIMARY,
 23131           DFHEIV99,
 23132           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 428
* EL050.cbl
 23133           DFHEIV99
 23134     MOVE EIBRESP  TO WS-RESPONSE
 23135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23136          IF WS-RESP-NORMAL
 23137             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23138          END-IF
 23139
 23140          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23141          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23142
 23143* EXEC CICS READ
 23144*             DATASET  (CRTT-ID)
 23145*             RIDFLD   (WS-ELCRTT-KEY)
 23146*             INTO     (CERTIFICATE-TRAILERS)
 23147*             RESP     (WS-RESPONSE)
 23148*         END-EXEC
 23149     MOVE LENGTH OF
 23150      CERTIFICATE-TRAILERS
 23151       TO DFHEIV11
 23152*    MOVE '&"IL       E          (  N#00021301' TO DFHEIV0
 23153     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23155     MOVE X'204E233030303231333031' TO DFHEIV0(25:11)
 23156     CALL 'kxdfhei1' USING DFHEIV0,
 23157           CRTT-ID,
 23158           CERTIFICATE-TRAILERS,
 23159           DFHEIV11,
 23160           WS-ELCRTT-KEY,
 23161           DFHEIV99,
 23162           DFHEIV99,
 23163           DFHEIV99
 23164     MOVE EIBRESP  TO WS-RESPONSE
 23165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23166          IF WS-RESP-NORMAL
 23167             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23168                               OC-INS-AGE-DEFAULT-FLAG
 23169             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23170                               OC-JNT-AGE-DEFAULT-FLAG
 23171          END-IF
 23172
 23173        ELSE
 23174          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23175             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23176             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23177             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23178          END-IF
 23179          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23180             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23181             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23182             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23183          END-IF
 23184          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23185        END-IF
 23186
 23187* EXEC CICS REWRITE
 23188*          DATASET   ('ELCRTO')
 23189*          FROM      (ORIGINAL-CERTIFICATE)
 23190*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 429
* EL050.cbl
 23191*       END-EXEC
 23192     MOVE LENGTH OF
 23193      ORIGINAL-CERTIFICATE
 23194       TO DFHEIV11
 23195     MOVE 'ELCRTO' TO DFHEIV1
 23196*    MOVE '&& L                  %  N#00021327' TO DFHEIV0
 23197     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23198     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23199     MOVE X'204E233030303231333237' TO DFHEIV0(25:11)
 23200     CALL 'kxdfhei1' USING DFHEIV0,
 23201           DFHEIV1,
 23202           ORIGINAL-CERTIFICATE,
 23203           DFHEIV11,
 23204           DFHEIV99
 23205     MOVE EIBRESP  TO WS-RESPONSE
 23206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23207     END-IF.
 23208
 23209 9991-EXIT.
 23210     EXIT.
 23211
 23212
 23213 9999-RETURN.
 23214     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23215
 23216
 23217* EXEC CICS RETURN
 23218*    END-EXEC.
 23219*    MOVE '.(                    ''   #00021341' TO DFHEIV0
 23220     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23221     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23222     MOVE X'2020233030303231333431' TO DFHEIV0(25:11)
 23223     CALL 'kxdfhei1' USING DFHEIV0,
 23224           DFHEIV99,
 23225           DFHEIV99,
 23226           DFHEIV99,
 23227           DFHEIV99,
 23228           DFHEIV99,
 23229           DFHEIV99
 23230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23231
 23232
 23233
 23234* GOBACK.
 23235     MOVE '9%                    "   ' TO DFHEIV0
 23236     MOVE 'EL050' TO DFHEIV1
 23237     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23238     GOBACK.
 23239
 23240 9999-DFHBACK SECTION.
 23241     MOVE '9%                    "   ' TO DFHEIV0
 23242     MOVE 'EL050' TO DFHEIV1
 23243     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23244     GOBACK.
 23245 9999-DFHEXIT.
 23246     IF DFHEIGDJ EQUAL 0001
 23247         NEXT SENTENCE
 23248     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 430
* EL050.cbl
 23249         GO TO 9300-ABEND,
 23250               3990-FILES-NOT-OPEN
 23251         DEPENDING ON DFHEIGDI
 23252     ELSE IF DFHEIGDJ EQUAL 3
 23253         GO TO 6610-START-BROWSE,
 23254               6630-ERRESS-PROBLEM,
 23255               6630-END-OF-FILE
 23256         DEPENDING ON DFHEIGDI
 23257     ELSE IF DFHEIGDJ EQUAL 4
 23258         GO TO 6630-END-OF-FILE,
 23259               6630-ERRESS-PROBLEM,
 23260               6630-ERRESS-PROBLEM,
 23261               6630-END-OF-FILE
 23262         DEPENDING ON DFHEIGDI
 23263     ELSE IF DFHEIGDJ EQUAL 5
 23264         GO TO 6630-END-OF-FILE,
 23265               6630-END-OF-FILE,
 23266               6630-ERRESS-PROBLEM,
 23267               6630-ERRESS-PROBLEM
 23268         DEPENDING ON DFHEIGDI
 23269     ELSE IF DFHEIGDJ EQUAL 6
 23270         GO TO 6660-START-BROWSE,
 23271               6690-ERRESC-PROBLEM,
 23272               6690-ERRESC-PROBLEM,
 23273               6690-END-OF-FILE
 23274         DEPENDING ON DFHEIGDI
 23275     ELSE IF DFHEIGDJ EQUAL 7
 23276         GO TO 6690-END-OF-FILE,
 23277               6690-ERRESC-PROBLEM,
 23278               6690-ERRESC-PROBLEM,
 23279               6690-END-OF-FILE
 23280         DEPENDING ON DFHEIGDI
 23281     ELSE IF DFHEIGDJ EQUAL 8
 23282         GO TO 6690-END-OF-FILE,
 23283               6690-ERRESC-PROBLEM,
 23284               6690-ERRESC-PROBLEM,
 23285               6690-END-OF-FILE
 23286         DEPENDING ON DFHEIGDI
 23287     ELSE IF DFHEIGDJ EQUAL 9
 23288         GO TO 7250-CONTINUE,
 23289               7250-CONTINUE
 23290         DEPENDING ON DFHEIGDI
 23291     ELSE IF DFHEIGDJ EQUAL 10
 23292         GO TO 7300-CONTINUE,
 23293               7300-CONTINUE
 23294         DEPENDING ON DFHEIGDI
 23295     ELSE IF DFHEIGDJ EQUAL 11
 23296         GO TO 7320-CONTINUE,
 23297               7320-CONTINUE
 23298         DEPENDING ON DFHEIGDI
 23299     ELSE IF DFHEIGDJ EQUAL 12
 23300         GO TO 8000-FREE-MAIN
 23301         DEPENDING ON DFHEIGDI
 23302     ELSE IF DFHEIGDJ EQUAL 13
 23303         GO TO 8100-NOTFND,
 23304               8100-NOTFND
 23305         DEPENDING ON DFHEIGDI
 23306     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 431
* EL050.cbl
 23307         GO TO 8110-NOTFND,
 23308               8110-NOTFND
 23309         DEPENDING ON DFHEIGDI
 23310     ELSE IF DFHEIGDJ EQUAL 15
 23311         GO TO 8130-EXIT
 23312         DEPENDING ON DFHEIGDI
 23313     ELSE IF DFHEIGDJ EQUAL 16
 23314         GO TO 8145-exit
 23315         DEPENDING ON DFHEIGDI
 23316     ELSE IF DFHEIGDJ EQUAL 17
 23317         GO TO 8190-NOTFND
 23318         DEPENDING ON DFHEIGDI
 23319     ELSE IF DFHEIGDJ EQUAL 18
 23320         GO TO 8195-NOTFND
 23321         DEPENDING ON DFHEIGDI
 23322     ELSE IF DFHEIGDJ EQUAL 19
 23323         GO TO 8200-NOTFND
 23324         DEPENDING ON DFHEIGDI
 23325     ELSE IF DFHEIGDJ EQUAL 20
 23326         GO TO 8300-NOTFND,
 23327               8300-ERRESS-PROBLEM,
 23328               8300-ERRESS-PROBLEM,
 23329               8300-NOTFND
 23330         DEPENDING ON DFHEIGDI
 23331     ELSE IF DFHEIGDJ EQUAL 21
 23332         GO TO 8450-FORM-NOT-FOUND,
 23333               8450-FORM-NOT-FOUND
 23334         DEPENDING ON DFHEIGDI
 23335     ELSE IF DFHEIGDJ EQUAL 22
 23336         GO TO 0199-ACCT-NOT-FOUND,
 23337               0199-ACCT-NOT-FOUND
 23338         DEPENDING ON DFHEIGDI
 23339     ELSE IF DFHEIGDJ EQUAL 23
 23340         GO TO 0199-ACCT-NOT-FOUND,
 23341               0199-ACCT-NOT-FOUND
 23342         DEPENDING ON DFHEIGDI
 23343     ELSE IF DFHEIGDJ EQUAL 24
 23344         GO TO 8582-COMP-NOT-FOUND,
 23345               8582-COMP-NOT-FOUND
 23346         DEPENDING ON DFHEIGDI
 23347     ELSE IF DFHEIGDJ EQUAL 25
 23348         GO TO 8583-AGTC-NOT-FOUND,
 23349               8583-AGTC-NOT-FOUND
 23350         DEPENDING ON DFHEIGDI
 23351     ELSE IF DFHEIGDJ EQUAL 26
 23352         GO TO 8584-BXRF-NOT-FOUND,
 23353               8584-BXRF-NOT-FOUND
 23354         DEPENDING ON DFHEIGDI
 23355     ELSE IF DFHEIGDJ EQUAL 27
 23356         GO TO 8585-PLAN-NOT-FOUND,
 23357               8585-PLAN-NOT-FOUND
 23358         DEPENDING ON DFHEIGDI
 23359     ELSE IF DFHEIGDJ EQUAL 28
 23360         GO TO 0299-CERT-NOT-FOUND
 23361         DEPENDING ON DFHEIGDI
 23362     ELSE IF DFHEIGDJ EQUAL 29
 23363         GO TO 8700-READ-CERT-MASTER
 23364         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:30 Page 432
* EL050.cbl
 23365     ELSE IF DFHEIGDJ EQUAL 30
 23366         GO TO 8720-COMP-ACCOUNTS,
 23367               8730-END-BROWSE,
 23368               8740-NOT-FOUND
 23369         DEPENDING ON DFHEIGDI
 23370     ELSE IF DFHEIGDJ EQUAL 31
 23371         GO TO 9000-NOTFND
 23372         DEPENDING ON DFHEIGDI
 23373     ELSE IF DFHEIGDJ EQUAL 32
 23374         GO TO 9100-NOTFND,
 23375               9100-NOTFND
 23376         DEPENDING ON DFHEIGDI
 23377     ELSE IF DFHEIGDJ EQUAL 33
 23378         GO TO 9991-CRTO-NOT-FOUND,
 23379               9991-CRTO-NOT-FOUND
 23380         DEPENDING ON DFHEIGDI.
 23381     MOVE '9%                    "   ' TO DFHEIV0
 23382     MOVE 'EL050' TO DFHEIV1
 23383     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23384     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41832     Code:       95941
