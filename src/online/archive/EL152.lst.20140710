* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   1
* EL152.cbl
* Options: int("EL152.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL152.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL152.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL152.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL152 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/14/94 08:03:40.
     7*                            VMOD=2.055.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX27 - CLAIMS LETTER WRITER.
    13
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   2
* EL152.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23*                                REMOVE OBSOLETE CODE
    24* 102703                   SMVA  MOD COPY MEMBER ELCNAMET TO LEAVE
    25*                                CERTIFICATION DESIGNATION ON
    26*                                PROCESSOR NAME LINE IN CAPS
    27* 121203                   SMVA  ADD PROCESSING FOR NEW CLM TYP G
    28* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    29* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    30* 010407    2006111300003  PEMA  ADD PROCESSING FOR CARRIER 8
    31* 060109  CR2008102800002  PEMA  ADD VAR 16.1
    32* 033110  CR2009122800001  AJRA  NAPERSOFT
    33* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    34* 011212  IR2012011100002  AJRA  FIX DCC PROMPT LETTER
    35* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    36* 041513  CR2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    37******************************************************************
    38 ENVIRONMENT DIVISION.
    39
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   3
* EL152.cbl
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL152 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    47
    48*77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    49*77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    50*                                  USAGE POINTER.
    51 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    52 77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  B1                          PIC S9(5) COMP-3 VALUE +0.
    55 77  S1                          PIC S9 VALUE +0.
    56 77  S2                          PIC S9 VALUE +0.
    57 01  P pointer.
    58 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    59 01  var-ptr pointer.
    60 01  env-var-len                 pic 9(4)  binary.
    61 01  rc                          pic 9(9)  binary.
    62 01  WS-KIXSYS.
    63     05  WS-KIX-FIL1             PIC X(10).
    64     05  WS-KIX-APPS             PIC X(10).
    65     05  WS-KIX-ENV              PIC X(10).
    66     05  WS-KIX-MYENV            PIC X(10).
    67     05  WS-KIX-SYS              PIC X(10).
    68 01  WS-HOLDING-ZIPS.
    69     05  FILLER              PIC X(10)  VALUE '--AM-ZIP--'.
    70     05  WS-AM-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    71     05  FILLER              PIC X(10)  VALUE '--AT-ZIP--'.
    72     05  WS-AT-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    73     05  FILLER              PIC X(10)  VALUE '--BE-ZIP--'.
    74     05  WS-BE-ZIP-CODE      PIC X(9)   VALUE 'XXXXXXXXX'.
    75     05  FILLER              PIC X(10)  VALUE '--CO-ZIP--'.
    76     05  WS-CO-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    77     05  FILLER              PIC X(17)  VALUE '--AM-ZIP-BEFORE--'.
    78     05  WS-AM-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    79     05  FILLER              PIC X(17)  VALUE '--AT-ZIP-BEFORE--'.
    80     05  WS-AT-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    81     05  FILLER              PIC X(17)  VALUE '--BE-ZIP-BEFORE--'.
    82     05  WS-BE-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    83     05  FILLER              PIC X(17)  VALUE '--CO-ZIP-BEFORE--'.
    84     05  WS-CO-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    85     05  FILLER              PIC X(17)  VALUE '-----------------'.
    86
    87*                            COPY ELCSCTM.
    88******************************************************************
    89*                                                                *
    90*                                                                *
    91*                            ELCSCTM                             *
    92*                            VMOD=2.001                          *
    93*                                                                *
    94*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    95*                                                                *
    96******************************************************************
    97 01  SECURITY-MESSAGE.
    98     12  FILLER                          PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   4
* EL152.cbl
    99            VALUE '** LOGIC SECURITY VIOLATION -'.
   100     12  SM-READ                         PIC X(6).
   101     12  FILLER                          PIC X(5)
   102            VALUE ' PGM='.
   103     12  SM-PGM                          PIC X(6).
   104     12  FILLER                          PIC X(5)
   105            VALUE ' OPR='.
   106     12  SM-PROCESSOR-ID                 PIC X(4).
   107     12  FILLER                          PIC X(6)
   108            VALUE ' TERM='.
   109     12  SM-TERMID                       PIC X(4).
   110     12  FILLER                          PIC XX   VALUE SPACE.
   111     12  SM-JUL-DATE                     PIC 9(5).
   112     12  FILLER                          PIC X    VALUE SPACE.
   113     12  SM-TIME                         PIC 99.99.
   114
   115
   116*                            COPY ELCSCRTY.
   117******************************************************************
   118*                                                                *
   119*                                                                *
   120*                            ELCSCRTY                            *
   121*                            VMOD=2.001                          *
   122*                                                                *
   123*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   124*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   125*        SAVED IN PI-SECURITY-ADDRESS.                           *
   126*                                                                *
   127******************************************************************
   128 01  SECURITY-CONTROL.
   129     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   130     12  FILLER                       PIC XX    VALUE 'SC'.
   131     12  SC-CREDIT-CODES.
   132         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   133             20  SC-CREDIT-DISPLAY    PIC X.
   134             20  SC-CREDIT-UPDATE     PIC X.
   135     12  SC-CLAIMS-CODES.
   136         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   137             20  SC-CLAIMS-DISPLAY    PIC X.
   138             20  SC-CLAIMS-UPDATE     PIC X.
   139
   140 01  WS-DATE-AREA.
   141     12  SAVE-DATE               PIC X(08)    VALUE SPACES.
   142     12  SAVE-BIN-DATE           PIC XX       VALUE SPACES.
   143     12  W-REVERSE-DATE-SW       PIC X        VALUE SPACES.
   144         88  W-REVERSE-DATE                   VALUE 'Y'.
   145     12  W-EDIT-DATE-1.
   146         16  W-ED1-MM            PIC XX.
   147         16  FILLER              PIC X        VALUE '/'.
   148         16  W-ED1-DD            PIC XX.
   149         16  FILLER              PIC X        VALUE '/'.
   150         16  W-ED1-YY            PIC XX.
   151     12  W-EDIT-DATE-2.
   152         16  W-ED2-DD            PIC XX.
   153         16  FILLER              PIC X        VALUE '/'.
   154         16  W-ED2-MM            PIC XX.
   155         16  FILLER              PIC X        VALUE '/'.
   156         16  W-ED2-YY            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   5
* EL152.cbl
   157 01  FILLER.
   158     05  WS-WORK-INT-RATE        PIC 99.999.
   159     05  WS-WORK-INT REDEFINES WS-WORK-INT-RATE
   160                                 PIC X(6).
   161 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   162     'BEGINJOB mode=''MVS'''.
   163 01  TRAN-DATA-LINE2.
   164*     05  FILLER                  PIC X(39)    VALUE
   165*     '"smtp -f EL152cl2 -t pema,kmsb,jmsb -s '.
   166     05  FILLER                  PIC X(29)    VALUE
   167     '"smtp -f EL152cl2 -t ajra -s '.
   168     05  TRAN-DETAIL.
   169         10  FILLER              PIC XX       VALUE
   170         ''' '.
   171         10  TRAN-DL2-USER       PIC X(05)    VALUE SPACES.
   172         10  TRAN-DL2-ARCHNO     PIC ZZZZ999  VALUE ZEROS.
   173         10  FILLER              PIC X        VALUE SPACES.
   174         10  TRAN-DL2-CCC        PIC X(22)    VALUE SPACES.
   175     05  FILLER                  PIC XX       VALUE '''"'.
   176     05  FILLER                  PIC X(30)    VALUE SPACES.
   177 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   178     'ENDJOB            '.
   179
   180 01  WS-PRINTER-ID               PIC X(4)    VALUE SPACES.
   181 01  STANDARD-AREAS.
   182     12  WS-ACCT-READ-SW         PIC X       VALUE ' '.
   183     12  WS-COMP-READ-SW         PIC X       VALUE ' '.
   184     12  WS-PROD-READ-SW         PIC X       VALUE ' '.
   185     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   186     12  MAP-NAME.
   187         16  MAP-PREFIX          PIC XX      VALUE 'EL'.
   188         16  MAP-NUMBER          PIC X(4)    VALUE '152A'.
   189         16  MAP-FILLER          PIC XX      VALUE SPACES.
   190     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   191     12  MAPSET-NAME             PIC X(8)    VALUE 'EL152S'.
   192     12  TRANS-ID                PIC X(4)    VALUE 'EX27'.
   193     12  PRINT-TRANS             PIC X(4)    VALUE 'EX57'.
   194     12  LGXX-ID                 PIC X(4)    VALUE 'LGXX'.
   195     12  PGM-NAME                PIC X(8).
   196     12  TIME-IN                 PIC S9(7).
   197     12  TIME-OUT-R  REDEFINES TIME-IN.
   198         16  FILLER              PIC X.
   199         16  TIME-OUT            PIC 99V99.
   200         16  FILLER              PIC XX.
   201     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   202     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   203     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   204     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   205     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   206     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   207     12  THIS-PGM                PIC X(8)    VALUE 'EL152'.
   208     12  LINK-EL1522             PIC X(8)    VALUE 'EL1522'.
   209     12  PGM-EL126               PIC X(8)    VALUE 'EL126'.
   210     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   211     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   212     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   213     12  SUB                     PIC 99.
   214     12  WS-LABELS-SW            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   6
* EL152.cbl
   215
   216     12  WS-PI-QID.
   217         16  QID-TERM            PIC X(4)    VALUE SPACES.
   218         16  FILLER              PIC X(4)    VALUE '152A'.
   219
   220     12  W-LETTER-ADDRESS-TYPE.
   221         16  W-LETTER-ADDR-TYPE  PIC  X VALUE SPACES.
   222         16  W-LETTER-ADDR-SEQ   PIC  9 VALUE ZEROS.
   223
   224     12  W-ADDRESS-SELECTION.
   225         16  W-ACCOUNT           PIC  9 VALUE ZEROS.
   226         16  W-BENEFICIARY       PIC  9 VALUE ZEROS.
   227         16  W-EMPLOYER          PIC  9 VALUE ZEROS.
   228         16  W-INSURED           PIC  9 VALUE ZEROS.
   229         16  W-OTHER-1           PIC  9 VALUE ZEROS.
   230         16  W-OTHER-2           PIC  9 VALUE ZEROS.
   231         16  W-PHYSICIAN         PIC  9 VALUE ZEROS.
   232
   233     12  W-Z-CONTROL-DATA.
   234         16  W-NUMBER-OF-COPIES  PIC  9.
   235         16  FILLER              PIC  X.
   236         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   237         16  FILLER              PIC  X.
   238         16  W-DAYS-TO-RESEND-1  PIC  999.
   239         16  FILLER              PIC  X.
   240         16  W-FORM-TO-RESEND    PIC  X(4).
   241         16  FILLER              PIC  X(1).
   242         16  W-PROMPT-LETTER     PIC  X(1).
   243         16  FILLER              PIC  X(1).
   244         16  W-ENCLOSURE-CD      PIC  X(3).
   245         16  FILLER              PIC  X(1).
   246         16  W-AUTO-CLOSE-IND    PIC  X(1).
   247         16  FILLER              PIC  X(1).
   248         16  W-LETTER-TO-BENE    PIC  X(1).
   249
   250     12  W-CREDIT-CARD-LOAN-NO.
   251         16  W-LOAN-NO           PIC  X(08).
   252         16  W-CURRENT-LOAN-NO   PIC  X(12).
   253
   254     12  W-GROUPING.
   255         16  W-GROUP-3           PIC  XXX.
   256         16  FILLER              PIC  XXX.
   257
   258     12  W-NAME.
   259         16  W-FIRST-NAME        PIC  X(12).
   260         16  W-MIDDLE-NAME       PIC  X(12).
   261         16  W-LAST-NAME         PIC  X(15).
   262
   263     12  WS-PHONE-IN             PIC 9(11)   VALUE ZEROS.
   264     12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   265         16  FILLER              PIC 9.
   266         16  WSPI-AREA           PIC 9(3).
   267         16  WSPI-PFX            PIC 9(3).
   268         16  WSPI-SFX            PIC 9(4).
   269     12  WS-PHONE-OUT.
   270         16  WSPO-AREA           PIC X(3).
   271         16  FILLER              PIC X       VALUE '-'.
   272         16  WSPO-PFX            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   7
* EL152.cbl
   273         16  FILLER              PIC X       VALUE '-'.
   274         16  WSPO-SFX            PIC X(4).
   275
   276     12  WS-ZIP-NUMERIC          PIC 9(9).
   277     12  WS-ZIP-NONNUM  REDEFINES  WS-ZIP-NUMERIC
   278                                 PIC X(9).
   279
   280     12  WS-ZIP-CODE.
   281         16  WS-AM-ZIP-CODE      PIC X(5).
   282         16  WS-AM-ZIP-DASH      PIC X.
   283         16  WS-AM-ZIP-PLUS4     PIC X(4).
   284     12  WS-ZIP-CODE-CANADIAN  REDEFINES  WS-ZIP-CODE.
   285         16  WS-CAN-POSTAL-1     PIC XXX.
   286         16  FILLER              PIC X.
   287         16  WS-CAN-POSTAL-2     PIC XXX.
   288         16  FILLER              PIC XXX.
   289
   290     12  WS-LABEL-HOLD-AREA.
   291         16  WS-LABEL-LINES OCCURS 6 TIMES
   292                            INDEXED BY WS-NDX  WS-NDX2.
   293             20  WS-LABEL-ZIP.
   294                 24  WS-LABEL-1ST-ZIP  PIC X(5).
   295                 24  FILLER            PIC X.
   296                 24  WS-LABEL-2ND-ZIP  PIC X(4).
   297             20  FILLER                PIC X(9).
   298             20  WS-LAST-DIGIT         PIC X.
   299             20  WS-LAST-ZIP.
   300                 24  WS-LAST-1ST-ZIP   PIC X(5).
   301                 24  FILLER            PIC X.
   302                 24  WS-LAST-2ND-ZIP   PIC X(4).
   303
   304     12  WS-DATA-FOUND-SW            PIC X.
   305         88  NO-CHARACTERS-FOUND           VALUE 'N'.
   306
   307     12  WS-SKIP-EMAIL           PIC X       VALUE 'N'.
   308     12  WS-STATE-LINE           PIC X       VALUE 'N'.
   309     12  WS-PROCESSOR-LINE       PIC X(01)   VALUE 'N'.
   310     12  WS-CAPS-SW              PIC X(01)   VALUE 'N'.
   311         88  THE-REST-R-CAPS                 VALUE 'Y'.
   312     12  WS-POSITION2            PIC S9(4)   COMP.
   313     12  WS-POSITION21           PIC S9(4)   COMP.
   314     12  WS-WORD-LENGTH          PIC S9(4)   COMP-3.
   315
   316     12  WS-TEMP-AREA1.
   317         16  WS-TEMP-1           PIC X OCCURS 29
   318                                       INDEXED BY TA1.
   319     12  WS-TEMP-AREA2.
   320         16  WS-TEMP-2           PIC X OCCURS 30
   321                                       INDEXED BY TA2
   322                                                  TA21
   323                                                  MOVE-INDX.
   324
   325     12  WS-SAVE-TEMP-AREA2      PIC X(30)   VALUE SPACES.
   326
   327     12  ACCT-BROWSE-STARTED     PIC X       VALUE 'N'.
   328     12  TEXT-BROWSE-STARTED     PIC X       VALUE 'N'.
   329     12  ARCH-BROWSE-STARTED     PIC X       VALUE 'N'.
   330     12  ACTV-BROWSE-STARTED     PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   8
* EL152.cbl
   331     12  PROD-BROWSE-STARTED     PIC X       VALUE 'N'.
   332     12  INDX-WORK               PIC 99.
   333     12  TEMP-CURR-LINE          PIC S9(3)    COMP-3.
   334
   335     12  DATE-WORK               PIC 9(7).
   336     12  DT-REDEF REDEFINES DATE-WORK.
   337         16  FILLER              PIC XX.
   338         16  DT-WORK             PIC 9(5).
   339
   340     12  BEN-HOLD                PIC XX.
   341
   342     12  BENEFIT-WORK            PIC XXX.
   343     12  BEN-R REDEFINES BENEFIT-WORK.
   344         16  ELIM-DAYS           PIC XX.
   345         16  FILLER              PIC X.
   346
   347     12  GETMAIN-SWITCH          PIC 9        VALUE 0.
   348         88  NO-GETMAIN-DONE-YET              VALUE 0.
   349         88  REFRESH-GETMAIN-AREA             VALUE 1.
   350
   351     12  WORK-AMOUNT             PIC S9(9)V99 VALUE +0.
   352     12  CURRENT-SAVE            PIC XX.
   353     12  CURRENT-PLUS3-SAVE      PIC XX.
   354     12  RESEND-SAVE             PIC XX    VALUE LOW-VALUE.
   355     12  FOLLOW-UP-SAVE          PIC XX    VALUE LOW-VALUE.
   356     12  SEQ-COUNTER             PIC S9(4) COMP.
   357     12  CORR-TRLR-SEQ           PIC S9(4) COMP.
   358     12  DEEDIT-FIELD            PIC X(15).
   359     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   360
   361     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   362     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   363
   364     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   365     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   366
   367     12  WS-CCN-12               PIC X(12).
   368
   369     12  WS-ADDR-TYPE-CD.
   370         16  WS-ADDR-TYPE        PIC X.
   371         16  WS-ADDR-SEQ         PIC X.
   372         16  WS-ADDR-SEQ-NUM REDEFINES
   373             WS-ADDR-SEQ         PIC 9.
   374
   375     12  WS-DMD-CERT-STATE       PIC XX.
   376     12  WS-DMD-CERT-GROUPING    PIC XX.
   377     12  WS-DMD-BEN-CODE         PIC XX.
   378     12  WS-DMD-CORR-TRLR-SEQ    PIC S9(4) COMP.
   379     12  WS-DMD-LETTER-FORM      PIC X(4).
   380     12  WS-DMD-RES-ST           PIC XX.
   381
   382     12  WS-DMD-UND-STATEMENT    PIC X(50)  VALUE
   383          'Central States provides plan administration for'.
   384
   385     12  WS-DMD-UND-COMPANYA     PIC X(50)  VALUE
   386          'Central States Health and Life Co.'.
   387
   388     12  WS-DMD-UND-COMPANYB     PIC X(50)  VALUE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page   9
* EL152.cbl
   389          'Central States Indemnity Co.'.
   390
   391* DLO023
   392 01  DL23-COMM-LENGTH            PIC S9(4) COMP VALUE +132.
   393 01  WS-DLO-CODES-TABLE.
   394     12  DL23-SYSTEM-ID          PIC XX.
   395     12  DL23-RECORD-TYPE        PIC XX.
   396     12  DL23-RECORD-KEY         PIC X(6).
   397     12  DL23-RETURN-CODE        PIC XX.
   398     12  DL23-CODE-DESC          PIC X(60).
   399     12  DL23-GEN-DESC-1         PIC X(20).
   400     12  DL23-GEN-DESC-2         PIC X(20).
   401     12  DL23-GEN-DESC-3         PIC X(20).
   402     12  WS-LETTER-STATUS        PIC X        VALUE ' '.
   403     12  WS-BLANK                PIC X        VALUE ' '.
   404
   405 01  WS-SAVE-ACCT-RECORD         PIC X(2000)  VALUE SPACES.
   406 01  WS-SAVE-PRODUCER-RECORD     PIC X(2000)  VALUE SPACES.
   407
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  10
* EL152.cbl
   409 01  ACCESS-KEYS-AND-FILE-IDS.
   410     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   411     12  ACCT-ID                  PIC X(8)    VALUE 'ERACCT'.
   412     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   413     12  ARCH-ID                  PIC X(8)    VALUE 'ELARCH'.
   414     12  ARCT-ID                  PIC X(8)    VALUE 'ELARCT'.
   415     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   416     12  TEXT-ID                  PIC X(8)    VALUE 'ELLETR'.
   417     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   418     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   419     12  PROD-ID                  PIC X(8)    VALUE 'MPPROD'.
   420     12  PLCY-ID                  PIC X(8)    VALUE 'MPPLCY'.
   421     12  PLAN-ID                  PIC X(8)    VALUE 'MPPLAN'.
   422     12  NAPS-ID                  PIC X(8)    VALUE 'ELNAPS'.
   423     12  ENCC-ID                  PIC X(8)    VALUE 'ELENCC'.
   424
   425     12  CNTL-KEY.
   426         16  CNTL-CO              PIC X(3).
   427         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   428         16  CNTL-GENL.
   429           18 CNTL-GEN1           PIC XX      VALUE SPACES.
   430           18 CNTL-GEN2.
   431             20 CNTL-GEN3         PIC X       VALUE SPACES.
   432             20 CNTL-GEN4         PIC X       VALUE SPACES.
   433         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   434
   435      12  WS-ERCOMP-KEY.
   436          16  WS-ERCOMP-COMPANY-CD PIC X.
   437          16  WS-ERCOMP-CARRIER    PIC X.
   438          16  WS-ERCOMP-GROUPING   PIC X(6).
   439          16  WS-ERCOMP-RESP-NO    PIC X(10).
   440          16  WS-ERCOMP-ACCOUNT    PIC X(10).
   441          16  WS-ERCOMP-TYPE       PIC X.
   442
   443     12  CLAM-KEY.
   444         16  CLAM-CO              PIC X.
   445         16  CLAM-CARRIER         PIC X.
   446         16  CLAM-CLAIM           PIC X(7).
   447         16  CLAM-CERT-NUM        PIC X(11).
   448
   449     12  TEXT-KEY.
   450         16  TEXT-PARTIAL-KEY.
   451             20  TEXT-CO          PIC X.
   452             20  TEXT-LETTER      PIC X(4).
   453         16  TEXT-FILLER          PIC X(8)    VALUE SPACES.
   454         16  TEXT-SEQ             PIC S9(4)   VALUE +0    COMP.
   455
   456     12  ACTV-KEY.
   457         16  ACTV-PARTIAL-KEY.
   458             20  ACTV-CO          PIC X.
   459             20  ACTV-CARRIER     PIC X.
   460             20  ACTV-CLAIM       PIC X(7).
   461             20  ACTV-CERT-NUM    PIC X(11).
   462         16  ACTV-SEQ             PIC S9(4)   VALUE +0    COMP.
   463
   464     12  CERT-KEY.
   465         16  CERT-CO              PIC X.
   466         16  CERT-CARRIER         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  11
* EL152.cbl
   467         16  CERT-GROUPING        PIC X(6).
   468         16  CERT-STATE           PIC XX.
   469         16  CERT-ACCOUNT         PIC X(10).
   470         16  CERT-EFF-DT          PIC XX.
   471         16  CERT-CERT-NUM        PIC X(11).
   472
   473     12  ACCT-KEY.
   474         16  ACCT-PARTIAL-KEY.
   475             20  ACCT-CO              PIC X.
   476             20  ACCT-CARRIER         PIC X.
   477             20  ACCT-GROUPING        PIC X(6).
   478             20  ACCT-STATE           PIC XX.
   479             20  ACCT-ACCOUNT         PIC X(10).
   480         16  ACCT-EXP-DATE            PIC XX.
   481
   482     12  ARCH-KEY.
   483         16  ARCH-PARTIAL-KEY.
   484             20  ARCH-CO          PIC X.
   485             20  ARCH-NUMBER      PIC S9(8)      COMP.
   486         16  ARCH-REC-TYPE        PIC X.
   487         16  ARCH-SEQ             PIC S9(4)      COMP VALUE +0.
   488
   489     12  BENE-KEY.
   490         16  BENE-COMP-CD         PIC X.
   491         16  BENE-REC-TYPE        PIC X.
   492         16  BENE-NUMBER.
   493             20  BENE-CREDITOR    PIC XXX.
   494             20  FILLER           PIC X(7).
   495
   496     12  PROD-KEY.
   497         16  PROD-PARTIAL-KEY.
   498             20  PROD-CO          PIC X.
   499             20  PROD-CARRIER     PIC X.
   500             20  PROD-GROUPING    PIC X(6).
   501             20  PROD-STATE       PIC XX.
   502             20  PROD-PRODUCER    PIC X(10).
   503         16  PROD-EXP-DATE        PIC XX.
   504
   505     12  PLCY-KEY.
   506         16  PLCY-CO              PIC X.
   507         16  PLCY-CARRIER         PIC X.
   508         16  PLCY-GROUPING        PIC X(06).
   509         16  PLCY-STATE           PIC XX.
   510         16  PLCY-PRODUCER        PIC X(10).
   511         16  PLCY-EFF-DT          PIC XX.
   512         16  PLCY-REFERENCE-NO    PIC X(20).
   513
   514     12  PLAN-KEY.
   515         16  PLAN-CO              PIC X.
   516         16  PLAN-CARRIER         PIC X.
   517         16  PLAN-GROUPING        PIC X(6).
   518         16  PLAN-STATE           PIC XX.
   519         16  PLAN-PRODUCER        PIC X(10).
   520         16  PLAN-CODE            PIC XX.
   521         16  PLAN-REV-NO          PIC 999.
   522
   523     12  ELENCC-KEY.
   524         16  ELENCC-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  12
* EL152.cbl
   525         16  ELENCC-REC-TYPE      PIC X.
   526         16  ELENCC-ENC-CODE      PIC X(5).
   527         16  F                    PIC X(09).
   528
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  13
* EL152.cbl
   530     12  ARCH-SAVE-KEY           PIC X(5).
   531     12  ACTV-SAVE-KEY           PIC X(20).
   532     12  ACCT-SAVE-KEY           PIC X(20).
   533     12  PROD-SAVE-KEY           PIC X(20).
   534     12  ACCT-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   535     12  ARCH-LENGTH             PIC S9(4)  COMP  VALUE +90.
   536     12  ARCT-LENGTH             PIC S9(4)  COMP  VALUE +90.
   537     12  ACTV-LENGTH             PIC S9(4)  COMP  VALUE +200.
   538     12  PROD-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   539     12  NAPS-LENGTH             PIC S9(4)  COMP  VALUE +150.
   540     12  ENCC-LENGTH             PIC S9(4)  COMP  VALUE +400.
   541     12  TEXT-SAVE-KEY           PIC X(5).
   542     12  SAVE-VARIABLE-POINTER   PIC S9(8)   COMP.
   543     12  VAR-HOLD.
   544         16  V1                  PIC X.
   545         16  V2                  PIC X.
   546         16  V3                  PIC X.
   547         16  V4                  PIC X.
   548     12  V-HOLD REDEFINES VAR-HOLD.
   549         16  V-NUM               PIC 99.
   550         16  V-PERIOD            PIC X.
   551         16  V-DECIMAL           PIC 9.
   552
   553     12  MAX-LINES               PIC 999     VALUE 300.
   554     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 13.
   555     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   556     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0     COMP-3.
   557     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   558     12  TS-ITEM                 PIC S9(4)   VALUE +0    COMP.
   559     12  TS-MAP-LENGTH           PIC S9(4)   VALUE +1343 COMP.
   560     12  ROLL-COUNTER            PIC S999    VALUE +0    COMP-3.
   561     12  TS-NAME-TEXT.
   562         16  TS-ID-TEXT          PIC X(4)    VALUE '104A'.
   563         16  TS-ID-TIME REDEFINES TS-ID-TEXT  PIC S9(7) COMP-3.
   564         16  TS-TERM-TEXT.
   565          17 TS-TERM-PREFIX      PIC XX.
   566          17 FILLER              PIC XX.
   567     12  TS-NAME-SCREEN.
   568         16  FILLER              PIC X(4)    VALUE '152X'.
   569         16  TS-TERM-SCREEN      PIC X(4).
   570
   571     12  LINE-NUM.
   572         16  LINE1               PIC X.
   573         16  LINE23              PIC 99.
   574     12  LIN-NUM REDEFINES LINE-NUM  PIC 999.
   575     12  TOP-FORM                PIC X(70)
   576         VALUE '*****TOP OF FORM *****'.
   577     12  SINGLE-LINE             PIC X(70).
   578     12  SINGLE-LINE-BY-1 REDEFINES SINGLE-LINE.
   579         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY INDX1 INDX2
   580                                 PIC X.
   581     12  NAPERSOFT-LETTER        PIC X(16)
   582         VALUE 'Napersoft letter'.
   583
   584     12  WS-RESPONSE             PIC S9(8)   COMP.
   585         88  RESP-NORMAL              VALUE +00.
   586         88  RESP-ERROR               VALUE +01.
   587         88  RESP-NOTFND              VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  14
* EL152.cbl
   588         88  RESP-NOTOPEN             VALUE +19.
   589         88  RESP-ENDFILE             VALUE +20.
   590
   591 01  HAN-LETTER-REASON-DATA.
   592     12  WS-REASON-TEXT.
   593         16  WS-RE-NDX           PIC 99.
   594         16  FILLER              PIC X(68).
   595
   596     12  HAN-REASON-TABLE.
   597         16  FILLER              PIC X(50) VALUE
   598           'ADDITIONAL INFO REQUESTED FROM PHYSICIAN          '.
   599         16  FILLER              PIC X(50) VALUE
   600           'CHECKING PRE-EXISTING CONDITION                   '.
   601         16  FILLER              PIC X(50) VALUE
   602           'ADDITIONAL INFO RECEIVED / CLAIM REOPENED         '.
   603         16  FILLER              PIC X(50) VALUE
   604           'LETTER TO INSURED                                 '.
   605         16  FILLER              PIC X(50) VALUE
   606           'LETTER TO CREDITOR                                '.
   607         16  FILLER              PIC X(50) VALUE
   608           'LETTER TO EMPLOYER                                '.
   609         16  FILLER              PIC X(50) VALUE
   610           'LETTER TO INSURED / 2ND REQUEST                   '.
   611         16  FILLER              PIC X(50) VALUE
   612           'LETTER TO CREDITOR / 2ND REQUEST                  '.
   613         16  FILLER              PIC X(50) VALUE
   614           'LETTER TO EMPLOYER / 2ND REQUEST                  '.
   615         16  FILLER              PIC X(50) VALUE
   616           'AWAITING INITIAL CLAIM FORM                       '.
   617         16  FILLER              PIC X(50) VALUE
   618           'AWAITING SUPPLEMENTAL INFORMATION                 '.
   619         16  FILLER              PIC X(50) VALUE
   620           'DENIED / PRE-EXISTING CONDITION                   '.
   621         16  FILLER              PIC X(50) VALUE
   622           'DENIED / WAITING PERIOD NOT MET                   '.
   623         16  FILLER              PIC X(50) VALUE
   624           'DENIED / NORMAL PREGNANCY                         '.
   625         16  FILLER              PIC X(50) VALUE
   626           'DENIED / ACT OF WAR                               '.
   627         16  FILLER              PIC X(50) VALUE
   628           'DENIED / NOT TOTALLY DISABLED                     '.
   629         16  FILLER              PIC X(50) VALUE
   630           'DENIED / NOT UNDER CARE & TREATMENT OF PHYSICIAN  '.
   631         16  FILLER              PIC X(50) VALUE
   632           'DENIED / NO COVERAGE INFORCE                      '.
   633         16  FILLER              PIC X(50) VALUE
   634           'DENIED / DISABLED ON DATE OF LOAN                 '.
   635         16  FILLER              PIC X(50) VALUE
   636           'DENIED / OVER MAXIMUM AGE                         '.
   637         16  FILLER              PIC X(50) VALUE
   638           'CLOSED / CLAIM INFO NOT PROVIDED                  '.
   639         16  FILLER              PIC X(50) VALUE
   640           'PHYSICIAN INFORMATION INCOMPLETE                  '.
   641         16  FILLER              PIC X(50) VALUE
   642           'ACKNOWLEDGEMENT LETTER TO INSURED                 '.
   643         16  FILLER              PIC X(50) VALUE
   644           'DENIED/SUICIDE EXCLUSION                          '.
   645         16  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  15
* EL152.cbl
   646           'DENIED/LOAN EFFECTIVE BEFORE POLICY EFFECTIVE DATE'.
   647         16  FILLER              PIC X(50) VALUE
   648           'DENIED/JOINT DEBTORS NOT COVERED                  '.
   649         16  FILLER              PIC X(50) VALUE
   650           'DENIED/GROUP POLICY LAPSED                        '.
   651         16  FILLER              PIC X(50) VALUE
   652           'DENIED/DECEASED PRIOR TO POLICY EFFECTIVE DATE    '.
   653         16  FILLER              PIC X(50) VALUE
   654           'DENIED/LOAN TERM IN EXCESS OF MAXIMUM LOAN TERM   '.
   655         16  FILLER              PIC X(50) VALUE
   656           'DENIED/INSURED NOT PERMANENTLY & TOTALLY DISABLED '.
   657         16  FILLER              PIC X(50) VALUE
   658           'DENIED/IME EXAM DOES NOT SUPPORT CONT. DISABILITY '.
   659         16  FILLER              PIC X(50) VALUE
   660           'DENIED/INSURED DID NOT APPEAR FOR IME EXAM        '.
   661
   662     12  HAN-LETTER-REASON-TABLE  REDEFINES  HAN-REASON-TABLE.
   663         16  HAN-TABLE-ENTRIES  OCCURS  32  TIMES.
   664             20  HAN-REASON-TEXT PIC X(50).
   665
   666 01  ERROR-MESSAGES.
   667     12  ER-0000                 PIC X(4)  VALUE '0000'.
   668     12  ER-0004                 PIC X(4)  VALUE '0004'.
   669     12  ER-0006                 PIC X(4)  VALUE '0006'.
   670     12  ER-0008                 PIC X(4)  VALUE '0008'.
   671     12  ER-0013                 PIC X(4)  VALUE '0013'.
   672     12  ER-0023                 PIC X(4)  VALUE '0023'.
   673     12  ER-0029                 PIC X(4)  VALUE '0029'.
   674     12  ER-0033                 PIC X(4)  VALUE '0033'.
   675     12  ER-0042                 PIC X(4)  VALUE '0042'.
   676     12  ER-0047                 PIC X(4)  VALUE '0047'.
   677     12  ER-0051                 PIC X(4)  VALUE '0051'.
   678     12  ER-0066                 PIC X(4)  VALUE '0066'.
   679     12  ER-0067                 PIC X(4)  VALUE '0067'.
   680     12  ER-0070                 PIC X(4)  VALUE '0070'.
   681     12  ER-0133                 PIC X(4)  VALUE '0133'.
   682     12  ER-0154                 PIC X(4)  VALUE '0154'.
   683     12  ER-0168                 PIC X(4)  VALUE '0168'.
   684     12  ER-0169                 PIC X(4)  VALUE '0169'.
   685     12  ER-0172                 PIC X(4)  VALUE '0172'.
   686     12  ER-0174                 PIC X(4)  VALUE '0174'.
   687     12  ER-0175                 PIC X(4)  VALUE '0175'.
   688     12  ER-0176                 PIC X(4)  VALUE '0176'.
   689     12  ER-0177                 PIC X(4)  VALUE '0177'.
   690     12  ER-0178                 PIC X(4)  VALUE '0178'.
   691     12  ER-0179                 PIC X(4)  VALUE '0179'.
   692     12  ER-0180                 PIC X(4)  VALUE '0180'.
   693     12  ER-0181                 PIC X(4)  VALUE '0181'.
   694     12  ER-0182                 PIC X(4)  VALUE '0182'.
   695     12  ER-0183                 PIC X(4)  VALUE '0183'.
   696     12  ER-0184                 PIC X(4)  VALUE '0184'.
   697     12  ER-0185                 PIC X(4)  VALUE '0185'.
   698     12  ER-0186                 PIC X(4)  VALUE '0186'.
   699     12  ER-0187                 PIC X(4)  VALUE '0187'.
   700     12  ER-0188                 PIC X(4)  VALUE '0188'.
   701     12  ER-0189                 PIC X(4)  VALUE '0189'.
   702     12  ER-0190                 PIC X(4)  VALUE '0190'.
   703     12  ER-0191                 PIC X(4)  VALUE '0191'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  16
* EL152.cbl
   704     12  ER-0206                 PIC X(4)  VALUE '0206'.
   705     12  ER-0211                 PIC X(4)  VALUE '0211'.
   706     12  ER-0279                 PIC X(4)  VALUE '0279'.
   707     12  ER-0280                 PIC X(4)  VALUE '0280'.
   708     12  ER-0281                 PIC X(4)  VALUE '0281'.
   709     12  ER-0332                 PIC X(4)  VALUE '0332'.
   710     12  ER-0343                 PIC X(4)  VALUE '0343'.
   711     12  ER-0373                 PIC X(4)  VALUE '0373'.
   712     12  ER-0374                 PIC X(4)  VALUE '0374'.
   713     12  ER-0412                 PIC X(4)  VALUE '0412'.
   714     12  ER-0413                 PIC X(4)  VALUE '0413'.
   715     12  ER-0533                 PIC X(4)  VALUE '0533'.
   716     12  ER-0537                 PIC X(4)  VALUE '0537'.
   717     12  ER-0716                 PIC X(4)  VALUE '0716'.
   718     12  ER-0861                 PIC X(4)  VALUE '0861'.
   719     12  ER-0894                 PIC X(4)  VALUE '0894'.
   720     12  ER-0900                 PIC X(4)  VALUE '0900'.
   721     12  ER-0909                 PIC X(4)  VALUE '0909'.
   722     12  ER-0911                 PIC X(4)  VALUE '0911'.
   723     12  ER-0912                 PIC X(4)  VALUE '0912'.
   724     12  ER-1236                 PIC X(4)  VALUE '1236'.
   725     12  ER-1560                 PIC X(4)  VALUE '1560'.
   726     12  ER-2055                 PIC X(4)  VALUE '2055'.
   727     12  ER-2397                 PIC X(4)  VALUE '2397'.
   728     12  ER-2398                 PIC X(4)  VALUE '2398'.
   729     12  ER-3547                 PIC X(4)  VALUE '3547'.
   730     12  ER-3770                 PIC X(4)  VALUE '3770'.
   731     12  ER-3771                 PIC X(4)  VALUE '3771'.
   732     12  ER-3772                 PIC X(4)  VALUE '3772'.
   733     12  ER-7675                 PIC X(4)  VALUE '7675'.
   734     12  ER-7840                 PIC X(4)  VALUE '7840'.
   735     12  ER-7842                 PIC X(4)  VALUE '7842'.
   736     12  ER-7843                 PIC X(4)  VALUE '7843'.
   737     12  ER-8158                 PIC X(4)  VALUE '8158'.
   738     12  ER-9106                 PIC X(4)  VALUE '9106'.
   739     12  ER-9483                 PIC X(4)  VALUE '9483'.
   740     12  ER-9808                 PIC X(4)  VALUE '9808'.
   741     12  ER-9883                 PIC X(4)  VALUE '9883'.
   742     12  ER-9887                 PIC X(4)  VALUE '9887'.
   743
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  17
* EL152.cbl
   745****************************************************
   746*       WHEN ADDING OR DELETING ENTRIES TO         *
   747*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
   748*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
   749*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
   750*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
   751*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
   752*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
   753*                                                  *
   754*   3 FIELDS TO CHANGE:                            *
   755*      1 - SS-NUM-ENTRIES........(NO.OF ENTRIES)   *
   756*      2 - SS-WORK-AREA-LENGTH...(TOTAL LENGTH)    *
   757*      3 - SYSTEM-VARIABLES......( "      "   )    *
   758****************************************************
   759
   760*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
   761*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
   762
   763     12  SS-NUM-ENTRIES          PIC 999    VALUE 130      COMP-3.
   764     12  SS-COUNTER              PIC 999                   COMP-3.
   765     12  SS-WORK-AREA-LENGTH     PIC S9(4)  VALUE +3865    COMP.
   766
   767 01  VARIABLE-WORK-AREA.
   768     12  VAR-CODE                PIC X(4).
   769     12  VAR-LEN                 PIC 99.
   770     12  VAR-DATA                PIC X(100).
   771     12  VAR-DATA-R REDEFINES VAR-DATA.
   772       16  VAR-ONE-CHAR OCCURS 100 TIMES INDEXED BY INDXV PIC X.
   773
   774 01  SYSTEM-SUPPORTED-VARIABLES.
   775*****COMPANY NAME
   776     12  SS01                    PIC X(4)  VALUE     '01.0'.
   777     12  SS01L                   PIC 99    VALUE 36.
   778     12  SS01D                   PIC X(30) VALUE ALL '*'.
   779*****FULL COMPANY ADDRESS
   780     12  SS02-1                  PIC X(4)  VALUE     '02.1'.
   781     12  SS02-1L                 PIC 99    VALUE 36.
   782     12  SS02-1D                 PIC X(30) VALUE ALL '*'.
   783     12  SS02-2                  PIC X(4)  VALUE     '02.2'.
   784     12  SS02-2L                 PIC 99    VALUE 36.
   785     12  SS02-2D                 PIC X(30) VALUE ALL '*'.
   786     12  SS02-3                  PIC X(4)  VALUE     '02.3'.
   787     12  SS02-3L                 PIC 99    VALUE 36.
   788     12  SS02-3D                 PIC X(30) VALUE ALL '*'.
   789     12  SS02-4                  PIC X(4)  VALUE     '02.4'.
   790     12  SS02-4L                 PIC 99    VALUE 36.
   791     12  SS02-4D                 PIC X(30) VALUE ALL '*'.
   792     12  SS02-5                  PIC X(4)  VALUE     '02.5'.
   793     12  SS02-5L                 PIC 99    VALUE 36.
   794     12  SS02-5D                 PIC X(30) VALUE ALL '*'.
   795*****CARRIER NAME
   796     12  SS03                    PIC X(4)  VALUE     '03.0'.
   797     12  SS03L                   PIC 99    VALUE 36.
   798     12  SS03D                   PIC X(30) VALUE ALL '*'.
   799*****INVESTORS HERITAGE
   800* as Administrator for Investors Heritage Life Insurance Company
   801     12  SS03-1                  PIC X(4)  VALUE     '03.1'.
   802     12  SS03-1L                 PIC 99    VALUE 68.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  18
* EL152.cbl
   803     12  SS03-1D                 PIC X(62) VALUE ALL '*'.
   804*****FULL CARRIER ADDRESS
   805     12  SS04-1                  PIC X(4)  VALUE     '04.1'.
   806     12  SS04-1L                 PIC 99    VALUE 36.
   807     12  SS04-1D                 PIC X(30) VALUE ALL '*'.
   808     12  SS04-2                  PIC X(4)  VALUE     '04.2'.
   809     12  SS04-2L                 PIC 99    VALUE 36.
   810     12  SS04-2D                 PIC X(30) VALUE ALL '*'.
   811     12  SS04-3                  PIC X(4)  VALUE     '04.3'.
   812     12  SS04-3L                 PIC 99    VALUE 36.
   813     12  SS04-3D                 PIC X(30) VALUE ALL '*'.
   814     12  SS04-4                  PIC X(4)  VALUE     '04.4'.
   815     12  SS04-4L                 PIC 99    VALUE 36.
   816     12  SS04-4D                 PIC X(30) VALUE ALL '*'.
   817     12  SS04-5                  PIC X(4)  VALUE     '04.5'.
   818     12  SS04-5L                 PIC 99    VALUE 36.
   819     12  SS04-5D                 PIC X(30) VALUE ALL '*'.
   820*****CARRIER PHONE NUMBER
   821     12  SS04-6                  PIC X(4)  VALUE     '04.6'.
   822     12  SS04-6L                 PIC 99    VALUE 18.
   823     12  SS04-6D                 PIC X(12) VALUE ALL '*'.
   824*****FULL ADDRESEE LABEL
   825     12  SS05-1                  PIC X(4)  VALUE     '05.1'.
   826     12  SS05-1L                 PIC 99    VALUE 36.
   827     12  SS05-1D                 PIC X(30) VALUE ALL '*'.
   828     12  SS05-2                  PIC X(4)  VALUE     '05.2'.
   829     12  SS05-2L                 PIC 99    VALUE 36.
   830     12  SS05-2D                 PIC X(30) VALUE ALL '*'.
   831     12  SS05-3                  PIC X(4)  VALUE     '05.3'.
   832     12  SS05-3L                 PIC 99    VALUE 36.
   833     12  SS05-3D                 PIC X(30) VALUE ALL '*'.
   834     12  SS05-4                  PIC X(4)  VALUE     '05.4'.
   835     12  SS05-4L                 PIC 99    VALUE 36.
   836     12  SS05-4D                 PIC X(30) VALUE ALL '*'.
   837     12  SS05-5                  PIC X(4)  VALUE     '05.5'.
   838     12  SS05-5L                 PIC 99    VALUE 36.
   839     12  SS05-5D                 PIC X(30) VALUE ALL '*'.
   840     12  SS05-6                  PIC X(4)  VALUE     '05.6'.
   841     12  SS05-6L                 PIC 99    VALUE 36.
   842     12  SS05-6D                 PIC X(30) VALUE ALL '*'.
   843*****ACCOUNT NAME
   844     12  SS06                    PIC X(4)  VALUE     '06.0'.
   845     12  SS06L                   PIC 99    VALUE 36.
   846     12  SS06D                   PIC X(30) VALUE ALL '*'.
   847*****FULL ACCOUNT ADDRESS
   848     12  SS07-1                  PIC X(4)  VALUE     '07.1'.
   849     12  SS07-1L                 PIC 99    VALUE 36.
   850     12  SS07-1D                 PIC X(30) VALUE ALL '*'.
   851     12  SS07-2                  PIC X(4)  VALUE     '07.2'.
   852     12  SS07-2L                 PIC 99    VALUE 36.
   853     12  SS07-2D                 PIC X(30) VALUE ALL '*'.
   854     12  SS07-3                  PIC X(4)  VALUE     '07.3'.
   855     12  SS07-3L                 PIC 99    VALUE 36.
   856     12  SS07-3D                 PIC X(30) VALUE ALL '*'.
   857     12  SS07-4                  PIC X(4)  VALUE     '07.4'.
   858     12  SS07-4L                 PIC 99    VALUE 36.
   859     12  SS07-4D                 PIC X(30) VALUE ALL '*'.
   860     12  SS07-5                  PIC X(4)  VALUE     '07.5'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  19
* EL152.cbl
   861     12  SS07-5L                 PIC 99    VALUE 36.
   862     12  SS07-5D                 PIC X(30) VALUE ALL '*'.
   863*****ACCOUNT PHONE NUMBER
   864     12  SS07-6                  PIC X(4)  VALUE     '07.6'.
   865     12  SS07-6L                 PIC 99    VALUE 18.
   866     12  SS07-6D                 PIC X(12) VALUE ALL '*'.
   867*****EXECUTING PROCESSOR NAME
   868     12  SS08                    PIC X(4)  VALUE     '08.0'.
   869     12  SS08L                   PIC 99    VALUE 36.
   870     12  SS08D                   PIC X(30) VALUE ALL '*'.
   871*****PROCESSOR TITLE
   872     12  SS09                    PIC X(4)  VALUE     '09.0'.
   873     12  SS09L                   PIC 99    VALUE 32.
   874     12  SS09D                   PIC X(26) VALUE ALL '*'.
   875*****INSUREDS NAME
   876     12  SS10                    PIC X(4)  VALUE     '10.0'.
   877     12  SS10L                   PIC 99    VALUE 36.
   878     12  SS10D                   PIC X(30) VALUE ALL '*'.
   879*****INSUREDS ADDRESS
   880     12  SS11-1                  PIC X(4)  VALUE     '11.1'.
   881     12  SS11-1L                 PIC 99    VALUE 36.
   882     12  SS11-1D                 PIC X(30) VALUE ALL '*'.
   883     12  SS11-2                  PIC X(4)  VALUE     '11.2'.
   884     12  SS11-2L                 PIC 99    VALUE 36.
   885     12  SS11-2D                 PIC X(30) VALUE ALL '*'.
   886     12  SS11-3                  PIC X(4)  VALUE     '11.3'.
   887     12  SS11-3L                 PIC 99    VALUE 36.
   888     12  SS11-3D                 PIC X(30) VALUE ALL '*'.
   889     12  SS11-4                  PIC X(4)  VALUE     '11.4'.
   890     12  SS11-4L                 PIC 99    VALUE 36.
   891     12  SS11-4D                 PIC X(30) VALUE ALL '*'.
   892*****INSUREDS NAME FROM ADDR TRAILER
   893     12  SS11-5                  PIC X(4)  VALUE     '11.5'.
   894     12  SS11-5L                 PIC 99    VALUE 36.
   895     12  SS11-5D                 PIC X(30) VALUE ALL '*'.
   896*****INSUREDS PHONE NUMBER FROM ADDR TRAILER
   897     12  SS11-6                  PIC X(4)  VALUE     '11.6'.
   898     12  SS11-6L                 PIC 99    VALUE 18.
   899     12  SS11-6D                 PIC X(12) VALUE ALL '*'.
   900*****CLAIM TYPE NAME
   901     12  SS12                    PIC X(4)  VALUE     '12.0'.
   902     12  SS12L                   PIC 99    VALUE 12.
   903     12  SS12D                   PIC X(6)  VALUE ALL '*'.
   904*****CLAIM INCURRED DATE
   905     12  SS13                    PIC X(4)  VALUE     '13.0'.
   906     12  SS13L                   PIC 99    VALUE 14.
   907     12  SS13D                   PIC X(8)  VALUE ALL '*'.
   908*****CLAIM REPORTED DATE
   909     12  SS14                    PIC X(4)  VALUE     '14.0'.
   910     12  SS14L                   PIC 99    VALUE 14.
   911     12  SS14D                   PIC X(8)  VALUE ALL '*'.
   912*****LAST PAYMENT DATE
   913     12  SS15                    PIC X(4)  VALUE     '15.0'.
   914     12  SS15L                   PIC 99    VALUE 14.
   915     12  SS15D                   PIC X(8)  VALUE ALL '*'.
   916*****LAST PAYMENT AMOUNT
   917     12  SS16                    PIC X(4)  VALUE     '16.0'.
   918     12  SS16L                   PIC 99    VALUE 17.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  20
* EL152.cbl
   919     12  SS16D                   PIC $$$$,$$$.99 VALUE ZEROS.
   920*****CLAIM INTEREST RATE
   921     12  SS16-1                  PIC X(4)  VALUE     '16.1'.
   922     12  SS16-1L                 PIC 99    VALUE 13.
   923     12  SS16-1D                 PIC X(7)        VALUE SPACE.
   924*****CLAIM PAID THRU/TO DATE
   925     12  SS17                    PIC X(4)  VALUE     '17.0'.
   926     12  SS17L                   PIC 99    VALUE 14.
   927     12  SS17D                   PIC X(8)  VALUE ALL '*'.
   928*****TOTAL PAID TO DATE
   929     12  SS18                    PIC X(4)  VALUE     '18.0'.
   930     12  SS18L                   PIC 99    VALUE 17.
   931     12  SS18D                   PIC $$$$,$$$.99 VALUE ZEROS.
   932*****DIAGNOSIS OR CAUSE
   933     12  SS19                    PIC X(4)  VALUE     '19.0'.
   934     12  SS19L                   PIC 99    VALUE 32.
   935     12  SS19D                   PIC X(26) VALUE ALL '*'.
   936*****CAUSE CODE
   937     12  SS19-1                  PIC X(4)  VALUE     '19.1'.
   938     12  SS19-1L                 PIC 99    VALUE 12.
   939     12  SS19-1D                 PIC X(6)  VALUE ALL '*'.
   940*****CID LOAN NUMBER
   941     12  SS19-2                  PIC X(4)  VALUE     '19.2'.
   942     12  SS19-2L                 PIC 99    VALUE 31.
   943     12  SS19-2D                 PIC X(25) VALUE ALL '*'.
   944*****CURRENT DATE
   945     12  SS20                    PIC X(4)  VALUE     '20.0'.
   946     12  SS20L                   PIC 99    VALUE 14.
   947     12  SS20D                   PIC X(8)  VALUE ALL '*'.
   948*****FULL CURRENT DATE
   949     12  SS21                    PIC X(4)  VALUE     '21.0'.
   950     12  SS21L                   PIC 99    VALUE 24.
   951     12  SS21D                   PIC X(18) VALUE ALL '*'.
   952*****BENEFIT DESCRIPTION
   953     12  SS22                    PIC X(4)  VALUE     '22.0'.
   954     12  SS22L                   PIC 99    VALUE 16.
   955     12  SS22D                   PIC X(10) VALUE ALL '*'.
   956*****CARRIER CODE IN CERT
   957     12  SS23                    PIC X(4)  VALUE     '23.0'.
   958     12  SS23L                   PIC 99    VALUE 9.
   959     12  SS23D                   PIC XXX   VALUE ALL '*'.
   960*****GROUPING CODE IN CERT
   961     12  SS24                    PIC X(4)  VALUE     '24.0'.
   962     12  SS24L                   PIC 99    VALUE 12.
   963     12  SS24D                   PIC X(6)  VALUE ALL '*'.
   964*****ACCOUNT NUMBER IN CERT
   965     12  SS25                    PIC X(4)  VALUE     '25.0'.
   966     12  SS25L                   PIC 99    VALUE 16.
   967     12  SS25D                   PIC X(10) VALUE ALL '*'.
   968*****CERTIFICATE NUMBER
   969     12  SS26                    PIC X(4)  VALUE     '26.0'.
   970     12  SS26L                   PIC 99    VALUE 17.
   971     12  SS26D                   PIC X(11) VALUE ALL '*'.
   972*****CERT EFFECTIVE DATE
   973     12  SS27                    PIC X(4)  VALUE     '27.0'.
   974     12  SS27L                   PIC 99    VALUE 14.
   975     12  SS27D                   PIC X(8)  VALUE ALL '*'.
   976*****CERT EXPIRATION DATE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  21
* EL152.cbl
   977     12  SS28                    PIC X(4)  VALUE     '28.0'.
   978     12  SS28L                   PIC 99    VALUE 14.
   979     12  SS28D                   PIC X(8)  VALUE ALL '*'.
   980*****APPLICABLE COVERAGE TERM
   981     12  SS29                    PIC X(4)  VALUE     '29.0'.
   982     12  SS29L                   PIC 99    VALUE 9.
   983     12  SS29D                   PIC XXX   VALUE ALL '*'.
   984*****APPLICABLE COVERAGE AMOUNT
   985     12  SS30                    PIC X(4)  VALUE     '30.0'.
   986     12  SS30L                   PIC 99    VALUE 18.
   987     12  SS30D                   PIC $$$$$,$$$.99  VALUE ZEROS.
   988*****APPLICABLE COVERAGE CANCEL DATE
   989     12  SS31                    PIC X(4)  VALUE     '31.0'.
   990     12  SS31L                   PIC 99    VALUE 14.
   991     12  SS31D                   PIC X(8)  VALUE ALL '*'.
   992*****APPLICABLE COVERAGE FORM NUMBER
   993     12  SS32                    PIC X(4)  VALUE     '32.0'.
   994     12  SS32L                   PIC 99    VALUE 18.
   995     12  SS32D                   PIC X(12) VALUE ALL '*'.
   996*****INSURES AGE AT POLICY ISSUE
   997     12  SS33                    PIC X(4)  VALUE     '33.0'.
   998     12  SS33L                   PIC 99    VALUE 9.
   999     12  SS33D                   PIC XXX   VALUE ALL '*'.
  1000*****CLAIM NUMBER
  1001     12  SS34                    PIC X(4)  VALUE     '34.0'.
  1002     12  SS34L                   PIC 99    VALUE 13.
  1003     12  SS34D                   PIC X(7)  VALUE ALL '*'.
  1004*****LAST DENIAL TEXT
  1005     12  SS35-1                  PIC X(4)  VALUE     '35.1'.
  1006     12  SS35-1L                 PIC 99    VALUE 66.
  1007     12  SS35-1D                 PIC X(60) VALUE ALL '*'.
  1008     12  SS35-2                  PIC X(4)  VALUE     '35.2'.
  1009     12  SS35-2L                 PIC 99    VALUE 66.
  1010     12  SS35-2D                 PIC X(60) VALUE ALL '*'.
  1011*****LOAN NUMBER
  1012     12  SS36                    PIC X(4)  VALUE     '36.0'.
  1013     12  SS36L                   PIC 99    VALUE 14.
  1014     12  SS36D                   PIC X(8)  VALUE ALL '*'.
  1015*****CURRENT LOAN NUMBER
  1016     12  SS36-1                  PIC X(4)  VALUE     '36.1'.
  1017     12  SS36-1L                 PIC 99    VALUE 26.
  1018     12  SS36-1D                 PIC X(20) VALUE ALL '*'.
  1019*****LOAN BALANCE
  1020     12  SS37                    PIC X(4)  VALUE     '37.0'.
  1021     12  SS37L                   PIC 99    VALUE 18.
  1022     12  SS37D                   PIC $$$$$,$$$.99  VALUE ZEROS.
  1023*****MEMBER NUMBER
  1024     12  SS38                    PIC X(4)  VALUE     '38.0'.
  1025     12  SS38L                   PIC 99    VALUE 18.
  1026     12  SS38D                   PIC X(12) VALUE ALL '*'.
  1027*****INSURED NAME (FIRST M LAST)
  1028     12  SS39                    PIC X(4)  VALUE     '39.0'.
  1029     12  SS39L                   PIC 99    VALUE 36.
  1030     12  SS39D                   PIC X(30) VALUE ALL '*'.
  1031*****INSURED LAST NAME ONLY
  1032     12  SS40                    PIC X(4)  VALUE     '40.0'.
  1033     12  SS40L                   PIC 99    VALUE 21.
  1034     12  SS40D                   PIC X(15) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  22
* EL152.cbl
  1035*****TITLE (MR/MS)
  1036     12  SS41                    PIC X(4)  VALUE     '41.0'.
  1037     12  SS41L                   PIC 99    VALUE 9.
  1038     12  SS41D                   PIC X(3)  VALUE ALL '*'.
  1039*****ELIMINATION PERIOD
  1040     12  SS42                    PIC X(4)  VALUE     '42.0'.
  1041     12  SS42L                   PIC 99    VALUE 9.
  1042     12  SS42D                   PIC X(3)  VALUE ALL '*'.
  1043*****BENEFICIARY NAME
  1044     12  SS43                    PIC X(4)  VALUE     '43.0'.
  1045     12  SS43L                   PIC 99    VALUE 36.
  1046     12  SS43D                   PIC X(30) VALUE ALL '*'.
  1047*****BENEFICIARY ADDRESS
  1048     12  SS44-1                  PIC X(4)  VALUE     '44.1'.
  1049     12  SS44-1L                 PIC 99    VALUE 36.
  1050     12  SS44-1D                 PIC X(30) VALUE ALL '*'.
  1051     12  SS44-2                  PIC X(4)  VALUE     '44.2'.
  1052     12  SS44-2L                 PIC 99    VALUE 36.
  1053     12  SS44-2D                 PIC X(30) VALUE ALL '*'.
  1054     12  SS44-3                  PIC X(4)  VALUE     '44.3'.
  1055     12  SS44-3L                 PIC 99    VALUE 36.
  1056     12  SS44-3D                 PIC X(30) VALUE ALL '*'.
  1057     12  SS44-4                  PIC X(4)  VALUE     '44.4'.
  1058     12  SS44-4L                 PIC 99    VALUE 36.
  1059     12  SS44-4D                 PIC X(30) VALUE ALL '*'.
  1060     12  SS44-5                  PIC X(4)  VALUE     '44.5'.
  1061     12  SS44-5L                 PIC 99    VALUE 18.
  1062     12  SS44-5D                 PIC X(12) VALUE ALL '*'.
  1063     12  SS44-6                  PIC X(4)  VALUE     '44.6'.
  1064     12  SS44-6L                 PIC 99    VALUE 36.
  1065     12  SS44-6D                 PIC X(30) VALUE ALL '*'.
  1066*****INSUREDS DATE OF BIRTH
  1067     12  SS45                    PIC X(4)  VALUE     '45.0'.
  1068     12  SS45L                   PIC 99    VALUE 14.
  1069     12  SS45D                   PIC X(8)  VALUE ALL '*'.
  1070*****INSUREDS SOC SEC NUMBER
  1071     12  SS46                    PIC X(4)  VALUE     '46.0'.
  1072     12  SS46L                   PIC 99    VALUE 17.
  1073     12  SS46D                   PIC X(11) VALUE ALL '*'.
  1074*****PHYSICIANS  NAME
  1075     12  SS47                    PIC X(4)  VALUE     '47.0'.
  1076     12  SS47L                   PIC 99    VALUE 36.
  1077     12  SS47D                   PIC X(30) VALUE ALL '*'.
  1078*****PHYSICIANS  ADDRESS
  1079     12  SS47-1                  PIC X(4)  VALUE     '47.1'.
  1080     12  SS47-1L                 PIC 99    VALUE 36.
  1081     12  SS47-1D                 PIC X(30) VALUE ALL '*'.
  1082     12  SS47-2                  PIC X(4)  VALUE     '47.2'.
  1083     12  SS47-2L                 PIC 99    VALUE 36.
  1084     12  SS47-2D                 PIC X(30) VALUE ALL '*'.
  1085     12  SS47-3                  PIC X(4)  VALUE     '47.3'.
  1086     12  SS47-3L                 PIC 99    VALUE 36.
  1087     12  SS47-3D                 PIC X(30) VALUE ALL '*'.
  1088     12  SS47-4                  PIC X(4)  VALUE     '47.4'.
  1089     12  SS47-4L                 PIC 99    VALUE 36.
  1090     12  SS47-4D                 PIC X(30) VALUE ALL '*'.
  1091     12  SS47-5                  PIC X(4)  VALUE     '47.5'.
  1092     12  SS47-5L                 PIC 99    VALUE 18.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  23
* EL152.cbl
  1093     12  SS47-5D                 PIC X(12) VALUE ALL '*'.
  1094*****EMPLOYERS   NAME
  1095     12  SS48                    PIC X(4)  VALUE     '48.0'.
  1096     12  SS48L                   PIC 99    VALUE 36.
  1097     12  SS48D                   PIC X(30) VALUE ALL '*'.
  1098*****EMPLOYERS   ADDRESS
  1099     12  SS48-1                  PIC X(4)  VALUE     '48.1'.
  1100     12  SS48-1L                 PIC 99    VALUE 36.
  1101     12  SS48-1D                 PIC X(30) VALUE ALL '*'.
  1102     12  SS48-2                  PIC X(4)  VALUE     '48.2'.
  1103     12  SS48-2L                 PIC 99    VALUE 36.
  1104     12  SS48-2D                 PIC X(30) VALUE ALL '*'.
  1105     12  SS48-3                  PIC X(4)  VALUE     '48.3'.
  1106     12  SS48-3L                 PIC 99    VALUE 36.
  1107     12  SS48-3D                 PIC X(30) VALUE ALL '*'.
  1108     12  SS48-4                  PIC X(4)  VALUE     '48.4'.
  1109     12  SS48-4L                 PIC 99    VALUE 36.
  1110     12  SS48-4D                 PIC X(30) VALUE ALL '*'.
  1111     12  SS48-5                  PIC X(4)  VALUE     '48.5'.
  1112     12  SS48-5L                 PIC 99    VALUE 18.
  1113     12  SS48-5D                 PIC X(12) VALUE ALL '*'.
  1114*****OTHER1      NAME
  1115     12  SS49                    PIC X(4)  VALUE     '49.0'.
  1116     12  SS49L                   PIC 99    VALUE 36.
  1117     12  SS49D                   PIC X(30) VALUE ALL '*'.
  1118*****OTHER1      ADDRESS
  1119     12  SS49-1                  PIC X(4)  VALUE     '49.1'.
  1120     12  SS49-1L                 PIC 99    VALUE 36.
  1121     12  SS49-1D                 PIC X(30) VALUE ALL '*'.
  1122     12  SS49-2                  PIC X(4)  VALUE     '49.2'.
  1123     12  SS49-2L                 PIC 99    VALUE 36.
  1124     12  SS49-2D                 PIC X(30) VALUE ALL '*'.
  1125     12  SS49-3                  PIC X(4)  VALUE     '49.3'.
  1126     12  SS49-3L                 PIC 99    VALUE 36.
  1127     12  SS49-3D                 PIC X(30) VALUE ALL '*'.
  1128     12  SS49-4                  PIC X(4)  VALUE     '49.4'.
  1129     12  SS49-4L                 PIC 99    VALUE 36.
  1130     12  SS49-4D                 PIC X(30) VALUE ALL '*'.
  1131     12  SS49-5                  PIC X(4)  VALUE     '49.5'.
  1132     12  SS49-5L                 PIC 99    VALUE 18.
  1133     12  SS49-5D                 PIC X(12) VALUE ALL '*'.
  1134*****OTHER2      NAME
  1135     12  SS50                    PIC X(4)  VALUE     '50.0'.
  1136     12  SS50L                   PIC 99    VALUE 36.
  1137     12  SS50D                   PIC X(30) VALUE ALL '*'.
  1138*****OTHER2      ADDRESS
  1139     12  SS50-1                  PIC X(4)  VALUE     '50.1'.
  1140     12  SS50-1L                 PIC 99    VALUE 36.
  1141     12  SS50-1D                 PIC X(30) VALUE ALL '*'.
  1142     12  SS50-2                  PIC X(4)  VALUE     '50.2'.
  1143     12  SS50-2L                 PIC 99    VALUE 36.
  1144     12  SS50-2D                 PIC X(30) VALUE ALL '*'.
  1145     12  SS50-3                  PIC X(4)  VALUE     '50.3'.
  1146     12  SS50-3L                 PIC 99    VALUE 36.
  1147     12  SS50-3D                 PIC X(30) VALUE ALL '*'.
  1148     12  SS50-4                  PIC X(4)  VALUE     '50.4'.
  1149     12  SS50-4L                 PIC 99    VALUE 36.
  1150     12  SS50-4D                 PIC X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  24
* EL152.cbl
  1151     12  SS50-5                  PIC X(4)  VALUE     '50.5'.
  1152     12  SS50-5L                 PIC 99    VALUE 18.
  1153     12  SS50-5D                 PIC X(12) VALUE ALL '*'.
  1154*****A&H TERM TIMES MON. BEN.
  1155     12  SS51                    PIC X(4)  VALUE     '51.0'.
  1156     12  SS51L                   PIC 99    VALUE 17.
  1157     12  SS51D                   PIC $$$$,$$$.99 VALUE ZEROS.
  1158*****THIRD PARTY NAME
  1159     12  SS52                    PIC X(4)  VALUE     '52.0'.
  1160     12  SS52L                   PIC 99    VALUE 36.
  1161     12  SS52D                   PIC X(30) VALUE ALL '*'.
  1162*****THIRD PARTY ADDRESS
  1163     12  SS53-1                  PIC X(4)  VALUE     '53.1'.
  1164     12  SS53-1L                 PIC 99    VALUE 36.
  1165     12  SS53-1D                 PIC X(30) VALUE ALL '*'.
  1166     12  SS53-2                  PIC X(4)  VALUE     '53.2'.
  1167     12  SS53-2L                 PIC 99    VALUE 36.
  1168     12  SS53-2D                 PIC X(30) VALUE ALL '*'.
  1169     12  SS53-3                  PIC X(4)  VALUE     '53.3'.
  1170     12  SS53-3L                 PIC 99    VALUE 36.
  1171     12  SS53-3D                 PIC X(30) VALUE ALL '*'.
  1172     12  SS53-4                  PIC X(4)  VALUE     '53.4'.
  1173     12  SS53-4L                 PIC 99    VALUE 36.
  1174     12  SS53-4D                 PIC X(30) VALUE ALL '*'.
  1175     12  SS53-5                  PIC X(4)  VALUE     '53.5'.
  1176     12  SS53-5L                 PIC 99    VALUE 36.
  1177     12  SS53-5D                 PIC X(30) VALUE ALL '*'.
  1178*****THIRD PARTY PHONE NUMBER
  1179     12  SS53-6                  PIC X(4)  VALUE     '53.6'.
  1180     12  SS53-6L                 PIC 99    VALUE 18.
  1181     12  SS53-6D                 PIC X(12) VALUE ALL '*'.
  1182*****CERTIFICATE SEQUENCE
  1183     12  SS54                    PIC X(4)  VALUE     '54.0'.
  1184     12  SS54L                   PIC 99    VALUE 09.
  1185     12  SS54D                   PIC XXX VALUE ALL '*'.
  1186*****CERTIFICATE TOTAL  E
  1187     12  SS55                    PIC X(4)  VALUE     '55.0'.
  1188     12  SS55L                   PIC 99    VALUE 09.
  1189     12  SS55D                   PIC XXX VALUE ALL '*'.
  1190*****CREDITOR ID
  1191     12  SS56                    PIC  X(04) VALUE    '56.0'.
  1192     12  SS56L                   PIC  99 VALUE 36.
  1193     12  SS56D                   PIC  X(30) VALUE ALL '*'.
  1194*****INSUREDS NAME (CERTIFICATE)
  1195     12  SS57                    PIC X(4)  VALUE     '57.0'.
  1196     12  SS57L                   PIC 99    VALUE 36.
  1197     12  SS57D                   PIC X(30) VALUE ALL '*'.
  1198*****JOINT NAME (CERTIFICATE)
  1199     12  SS58                    PIC X(4)  VALUE     '58.0'.
  1200     12  SS58L                   PIC 99    VALUE 36.
  1201     12  SS58D                   PIC X(30) VALUE ALL '*'.
  1202*****POLICY REFERENCE NUMBER
  1203     12  SS59                    PIC X(4)  VALUE     '59.0'.
  1204     12  SS59L                   PIC 99    VALUE 26.
  1205     12  SS59D                   PIC X(20) VALUE ALL '*'.
  1206*****CREDIT CARD NUMBER (CLAIMS)
  1207     12  SS60                    PIC X(4)  VALUE     '60.0'.
  1208     12  SS60L                   PIC 99    VALUE 22.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  25
* EL152.cbl
  1209     12  SS60D                   PIC X(16) VALUE ALL '*'.
  1210*****CORRESPONDENCE BENEFICIARY NAME
  1211     12  SS61                    PIC X(4)  VALUE     '61.0'.
  1212     12  SS61L                   PIC 99    VALUE 36.
  1213     12  SS61D                   PIC X(30) VALUE ALL '*'.
  1214*****CORRESPONDENCE BENEFICIARY ADDRESS
  1215     12  SS61-1                  PIC X(4)  VALUE     '61.1'.
  1216     12  SS61-1L                 PIC 99    VALUE 36.
  1217     12  SS61-1D                 PIC X(30) VALUE ALL '*'.
  1218     12  SS61-2                  PIC X(4)  VALUE     '61.2'.
  1219     12  SS61-2L                 PIC 99    VALUE 36.
  1220     12  SS61-2D                 PIC X(30) VALUE ALL '*'.
  1221     12  SS61-3                  PIC X(4)  VALUE     '61.3'.
  1222     12  SS61-3L                 PIC 99    VALUE 36.
  1223     12  SS61-3D                 PIC X(30) VALUE ALL '*'.
  1224     12  SS61-4                  PIC X(4)  VALUE     '61.4'.
  1225     12  SS61-4L                 PIC 99    VALUE 36.
  1226     12  SS61-4D                 PIC X(30) VALUE ALL '*'.
  1227     12  SS61-5                  PIC X(4)  VALUE     '61.5'.
  1228     12  SS61-5L                 PIC 99    VALUE 36.
  1229     12  SS61-5D                 PIC X(30) VALUE ALL '*'.
  1230     12  SS61-6                  PIC X(4)  VALUE     '61.6'.
  1231     12  SS61-6L                 PIC 99    VALUE 18.
  1232     12  SS61-6D                 PIC X(12) VALUE ALL '*'.
  1233
  1234*****DMD UNDERWRITER STATEMENT
  1235     12  SS62                    PIC X(4)  VALUE     '62.0'.
  1236     12  SS62L                   PIC 99    VALUE 56.
  1237     12  SS62D                   PIC X(50) VALUE ALL '*'.
  1238
  1239*****DMD UNDERWRITER NAME
  1240     12  SS63                    PIC X(4)  VALUE     '63.0'.
  1241     12  SS63L                   PIC 99    VALUE 66.
  1242     12  SS63D                   PIC X(60) VALUE ALL '*'.
  1243
  1244*****DMD UNDERWRITER NAME
  1245     12  SS64                    PIC X(4)  VALUE     '64.0'.
  1246     12  SS64L                   PIC 99    VALUE 66.
  1247     12  SS64D                   PIC X(60) VALUE ALL '*'.
  1248
  1249****************************************************
  1250*       WHEN ADDING OR DELETING ENTRIES TO         *
  1251*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
  1252*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
  1253*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
  1254*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
  1255*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
  1256*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
  1257****************************************************
  1258*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  1259*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  1260
  1261 01  SYSTEM-VARIABLES            PIC X(3865).
  1262 01  SYS-VAR-ENTRY.
  1263     12  SYS-VAR-CODE            PIC X(4).
  1264     12  SYS-VAR-LEN             PIC 99.
  1265     12  SYS-VAR-DATA            PIC X(100).
  1266
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  26
* EL152.cbl
  1267*                                COPY ELCDATE.
  1268******************************************************************
  1269*                                                                *
  1270*                                                                *
  1271*                            ELCDATE.                            *
  1272*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1273*                            VMOD=2.003
  1274*                                                                *
  1275*                                                                *
  1276*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1277*                 LENGTH = 200                                   *
  1278******************************************************************
  1279
  1280 01  DATE-CONVERSION-DATA.
  1281     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1282     12  DC-OPTION-CODE                PIC X.
  1283         88  BIN-TO-GREG                VALUE ' '.
  1284         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1285         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1286         88  YMD-GREG-TO-BIN            VALUE '3'.
  1287         88  MDY-GREG-TO-BIN            VALUE '4'.
  1288         88  JULIAN-TO-BIN              VALUE '5'.
  1289         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1290         88  FIND-CENTURY               VALUE '7'.
  1291         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1292         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1293         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1294         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1295         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1296         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1297         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1298         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1299         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1300         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1301         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1302         88  BIN-3-TO-GREG              VALUE 'I'.
  1303         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1304         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1305         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1306         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1307         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1308         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1309         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1310         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1311         88  THREE-CHARACTER-BIN
  1312                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1313         88  GREGORIAN-TO-BIN
  1314                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1315         88  BIN-TO-GREGORIAN
  1316                  VALUES ' ' '1' 'I' '8' 'G'.
  1317         88  JULIAN-TO-BINARY
  1318                  VALUES '5' 'C' 'E' 'F'.
  1319     12  DC-ERROR-CODE                 PIC X.
  1320         88  NO-CONVERSION-ERROR        VALUE ' '.
  1321         88  DATE-CONVERSION-ERROR
  1322                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1323         88  DATE-IS-ZERO               VALUE '1'.
  1324         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  27
* EL152.cbl
  1325         88  DATE-IS-INVALID            VALUE '3'.
  1326         88  DATE1-GREATER-DATE2        VALUE '4'.
  1327         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1328         88  DATE-INVALID-OPTION        VALUE '9'.
  1329         88  INVALID-CENTURY            VALUE 'A'.
  1330         88  ONLY-CENTURY               VALUE 'B'.
  1331         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1332         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1333     12  DC-END-OF-MONTH               PIC X.
  1334         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1335     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1336         88  USE-NORMAL-PROCESS         VALUE ' '.
  1337         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1338         88  ADJUST-UP-100-YRS          VALUE '2'.
  1339     12  FILLER                        PIC X.
  1340     12  DC-CONVERSION-DATES.
  1341         16  DC-BIN-DATE-1             PIC XX.
  1342         16  DC-BIN-DATE-2             PIC XX.
  1343         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1344         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1345                       DC-GREG-DATE-1-EDIT.
  1346             20  DC-EDIT1-MONTH        PIC 99.
  1347             20  SLASH1-1              PIC X.
  1348             20  DC-EDIT1-DAY          PIC 99.
  1349             20  SLASH1-2              PIC X.
  1350             20  DC-EDIT1-YEAR         PIC 99.
  1351         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1352         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1353                     DC-GREG-DATE-2-EDIT.
  1354             20  DC-EDIT2-MONTH        PIC 99.
  1355             20  SLASH2-1              PIC X.
  1356             20  DC-EDIT2-DAY          PIC 99.
  1357             20  SLASH2-2              PIC X.
  1358             20  DC-EDIT2-YEAR         PIC 99.
  1359         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1360         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1361                     DC-GREG-DATE-1-YMD.
  1362             20  DC-YMD-YEAR           PIC 99.
  1363             20  DC-YMD-MONTH          PIC 99.
  1364             20  DC-YMD-DAY            PIC 99.
  1365         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1366         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1367                      DC-GREG-DATE-1-MDY.
  1368             20  DC-MDY-MONTH          PIC 99.
  1369             20  DC-MDY-DAY            PIC 99.
  1370             20  DC-MDY-YEAR           PIC 99.
  1371         16  DC-GREG-DATE-1-ALPHA.
  1372             20  DC-ALPHA-MONTH        PIC X(10).
  1373             20  DC-ALPHA-DAY          PIC 99.
  1374             20  FILLER                PIC XX.
  1375             20  DC-ALPHA-CENTURY.
  1376                 24 DC-ALPHA-CEN-N     PIC 99.
  1377             20  DC-ALPHA-YEAR         PIC 99.
  1378         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1379         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1380         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1381         16  DC-JULIAN-DATE            PIC 9(05).
  1382         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  28
* EL152.cbl
  1383                                       PIC 9(05).
  1384         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1385             20  DC-JULIAN-YEAR        PIC 99.
  1386             20  DC-JULIAN-DAYS        PIC 999.
  1387         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1388         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1389         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1390     12  DATE-CONVERSION-VARIBLES.
  1391         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1392         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1393             20  FILLER                PIC 9(3).
  1394             20  HOLD-CEN-1-CCYY.
  1395                 24  HOLD-CEN-1-CC     PIC 99.
  1396                 24  HOLD-CEN-1-YY     PIC 99.
  1397             20  HOLD-CEN-1-MO         PIC 99.
  1398             20  HOLD-CEN-1-DA         PIC 99.
  1399         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1400             20  HOLD-CEN-1-R-MO       PIC 99.
  1401             20  HOLD-CEN-1-R-DA       PIC 99.
  1402             20  HOLD-CEN-1-R-CCYY.
  1403                 24  HOLD-CEN-1-R-CC   PIC 99.
  1404                 24  HOLD-CEN-1-R-YY   PIC 99.
  1405             20  FILLER                PIC 9(3).
  1406         16  HOLD-CENTURY-1-X.
  1407             20  FILLER                PIC X(3)  VALUE SPACES.
  1408             20  HOLD-CEN-1-X-CCYY.
  1409                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1410                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1411             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1412             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1413         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1414             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1415             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1416             20  HOLD-CEN-1-R-X-CCYY.
  1417                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1418                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1419             20  FILLER                PIC XXX.
  1420         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1421         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1422         16  DC-JULIAN-DATE-1          PIC 9(07).
  1423         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1424             20  DC-JULIAN-1-CCYY.
  1425                 24  DC-JULIAN-1-CC    PIC 99.
  1426                 24  DC-JULIAN-1-YR    PIC 99.
  1427             20  DC-JULIAN-DA-1        PIC 999.
  1428         16  DC-JULIAN-DATE-2          PIC 9(07).
  1429         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1430             20  DC-JULIAN-2-CCYY.
  1431                 24  DC-JULIAN-2-CC    PIC 99.
  1432                 24  DC-JULIAN-2-YR    PIC 99.
  1433             20  DC-JULIAN-DA-2        PIC 999.
  1434         16  DC-GREG-DATE-A-EDIT.
  1435             20  DC-EDITA-MONTH        PIC 99.
  1436             20  SLASHA-1              PIC X VALUE '/'.
  1437             20  DC-EDITA-DAY          PIC 99.
  1438             20  SLASHA-2              PIC X VALUE '/'.
  1439             20  DC-EDITA-CCYY.
  1440                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  29
* EL152.cbl
  1441                 24  DC-EDITA-YEAR     PIC 99.
  1442         16  DC-GREG-DATE-B-EDIT.
  1443             20  DC-EDITB-MONTH        PIC 99.
  1444             20  SLASHB-1              PIC X VALUE '/'.
  1445             20  DC-EDITB-DAY          PIC 99.
  1446             20  SLASHB-2              PIC X VALUE '/'.
  1447             20  DC-EDITB-CCYY.
  1448                 24  DC-EDITB-CENT     PIC 99.
  1449                 24  DC-EDITB-YEAR     PIC 99.
  1450         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1451         16  DC-GREG-DATE-CYMD-R REDEFINES
  1452                              DC-GREG-DATE-CYMD.
  1453             20  DC-CYMD-CEN           PIC 99.
  1454             20  DC-CYMD-YEAR          PIC 99.
  1455             20  DC-CYMD-MONTH         PIC 99.
  1456             20  DC-CYMD-DAY           PIC 99.
  1457         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1458         16  DC-GREG-DATE-MDCY-R REDEFINES
  1459                              DC-GREG-DATE-MDCY.
  1460             20  DC-MDCY-MONTH         PIC 99.
  1461             20  DC-MDCY-DAY           PIC 99.
  1462             20  DC-MDCY-CEN           PIC 99.
  1463             20  DC-MDCY-YEAR          PIC 99.
  1464    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1465        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1466    12  DC-EL310-DATE                  PIC X(21).
  1467    12  FILLER                         PIC X(28).
  1468
  1469*                                COPY ELCLOGOF.
  1470******************************************************************
  1471*                                                                *
  1472*                                                                *
  1473*                            ELCLOGOF.                           *
  1474*                            VMOD=2.001                          *
  1475*                                                                *
  1476*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1477*                                                                *
  1478******************************************************************
  1479 01  CLASIC-LOGOFF.
  1480     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1481     12  LOGOFF-TEXT.
  1482         16  FILLER          PIC X(5)    VALUE SPACES.
  1483         16  LOGOFF-MSG.
  1484             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1485             20  FILLER      PIC X       VALUE SPACES.
  1486             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1487         16  FILLER          PIC X(80)
  1488           VALUE '* YOU ARE NOW LOGGED OFF'.
  1489         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1490         16  FILLER          PIC X       VALUE QUOTE.
  1491         16  LOGOFF-SYS-MSG  PIC X(17)
  1492           VALUE 'S CLAS-IC SYSTEM '.
  1493     12  TEXT-MESSAGES.
  1494         16  UNACCESS-MSG    PIC X(29)
  1495             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1496         16  PGMIDERR-MSG    PIC X(17)
  1497             VALUE 'PROGRAM NOT FOUND'.
  1498
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  30
* EL152.cbl
  1500*                                COPY ELCNWA.
  1501*****************************************************************
  1502*                                                               *
  1503*                                                               *
  1504*                            ELCNWA.                            *
  1505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1506*                            VMOD=2.003                         *
  1507*                                                               *
  1508*            M O V E   N A M E   W O R K   A R E A.             *
  1509*                                                               *
  1510*****************************************************************.
  1511
  1512 01  WS-NAME-WORK-AREA.
  1513     05  WS-INSURED-LAST-NAME        PIC X(15).
  1514     05  WS-INSURED-1ST-NAME         PIC X(12).
  1515     05  WS-INSURED-MID-INIT         PIC X.
  1516
  1517     05  WS-NAME-WORK.
  1518         10  WS-NW                   PIC X
  1519             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1520
  1521     05  WS-NAME-WORK2.
  1522         10  WS-NW2                  PIC X
  1523             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1524                                        NWA-INDEX0.
  1525
  1526     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1527                                     COMP-3.
  1528
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  31
* EL152.cbl
  1530*                                COPY ELCATTR.
  1531******************************************************************
  1532*                                                                *
  1533*                            ELCATTR.                            *
  1534*                            VMOD=2.001                          *
  1535*                                                                *
  1536*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1537*                                                                *
  1538*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1539*                                                                *
  1540*                   POS 1   P=PROTECTED                          *
  1541*                           U=UNPROTECTED                        *
  1542*                           S=ASKIP                              *
  1543*                   POS 2   A=ALPHA/NUMERIC                      *
  1544*                           N=NUMERIC                            *
  1545*                   POS 3   N=NORMAL                             *
  1546*                           B=BRIGHT                             *
  1547*                           D=DARK                               *
  1548*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1549*                           OF=MODIFIED DATA TAG OFF             *
  1550*                                                                *
  1551*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1552******************************************************************
  1553 01  ATTRIBUTE-LIST.
  1554     12  AL-PABOF            PIC X       VALUE 'Y'.
  1555     12  AL-PABON            PIC X       VALUE 'Z'.
  1556     12  AL-PADOF            PIC X       VALUE '%'.
  1557     12  AL-PADON            PIC X       VALUE '_'.
  1558     12  AL-PANOF            PIC X       VALUE '-'.
  1559     12  AL-PANON            PIC X       VALUE '/'.
  1560     12  AL-SABOF            PIC X       VALUE '8'.
  1561     12  AL-SABON            PIC X       VALUE '9'.
  1562     12  AL-SADOF            PIC X       VALUE '@'.
  1563     12  AL-SADON            PIC X       VALUE QUOTE.
  1564     12  AL-SANOF            PIC X       VALUE '0'.
  1565     12  AL-SANON            PIC X       VALUE '1'.
  1566     12  AL-UABOF            PIC X       VALUE 'H'.
  1567     12  AL-UABON            PIC X       VALUE 'I'.
  1568     12  AL-UADOF            PIC X       VALUE '<'.
  1569     12  AL-UADON            PIC X       VALUE '('.
  1570     12  AL-UANOF            PIC X       VALUE ' '.
  1571     12  AL-UANON            PIC X       VALUE 'A'.
  1572     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1573     12  AL-UNBON            PIC X       VALUE 'R'.
  1574     12  AL-UNDOF            PIC X       VALUE '*'.
  1575     12  AL-UNDON            PIC X       VALUE ')'.
  1576     12  AL-UNNOF            PIC X       VALUE '&'.
  1577     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  32
* EL152.cbl
  1579*                                COPY ELCEMIB.
  1580******************************************************************
  1581*                                                                *
  1582*                                                                *
  1583*                            ELCEMIB.                            *
  1584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1585*                            VMOD=2.005                          *
  1586*                                                                *
  1587*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1588*                                                                *
  1589******************************************************************
  1590 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1591     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1592     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1593     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1594     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1595     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1596     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1597     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1598     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1599     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1600         88  EMI-NO-ERRORS                    VALUE '1'.
  1601         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1602         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1603     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1604         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1605     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1606         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1607         88  EMI-AREA1-FULL                   VALUE '2'.
  1608     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1609         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1610         88  EMI-AREA2-FULL                   VALUE '2'.
  1611     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1612         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1613         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1614         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1615         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1616         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1617     12  EMI-ERROR-LINES.
  1618         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1619         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1620         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1621         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1622             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1623                 24  EMI-ERR-NUM         PIC X(4).
  1624                 24  EMI-FILLER          PIC X.
  1625                 24  EMI-SEV             PIC X.
  1626                 24  FILLER              PIC X.
  1627             20  FILLER                  PIC X(02).
  1628     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1629         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1630             20  EMI-ERROR-NUMBER    PIC X(4).
  1631             20  EMI-FILL            PIC X.
  1632             20  EMI-SEVERITY        PIC X.
  1633             20  FILLER              PIC X.
  1634             20  EMI-ERROR-TEXT.
  1635                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1636                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  33
* EL152.cbl
  1637     12  EMI-SEVERITY-SAVE           PIC X.
  1638         88  EMI-NOTE                    VALUE 'N'.
  1639         88  EMI-WARNING                 VALUE 'W'.
  1640         88  EMI-FORCABLE                VALUE 'F'.
  1641         88  EMI-FATAL                   VALUE 'X'.
  1642     12  EMI-MESSAGE-FLAG            PIC X.
  1643         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1644         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1645     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1646     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1647         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1648         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1649         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1650     12  FILLER                      PIC X(137)  VALUE SPACES.
  1651     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1652     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1653     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1654     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1655 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  34
* EL152.cbl
  1657*                                COPY ELCINTF.
  1658******************************************************************
  1659*                                                                *
  1660*                                                                *
  1661*                            ELCINTF.                            *
  1662*                            VMOD=2.017                          *
  1663*                                                                *
  1664*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1665*                                                                *
  1666*       LENGTH = 1024                                            *
  1667*                                                                *
  1668******************************************************************
  1669*                   C H A N G E   L O G
  1670*
  1671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1672*-----------------------------------------------------------------
  1673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1674* EFFECTIVE    NUMBER
  1675*-----------------------------------------------------------------
  1676* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1677******************************************************************
  1678 01  PROGRAM-INTERFACE-BLOCK.
  1679     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1680     12  PI-CALLING-PROGRAM              PIC X(8).
  1681     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1682     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1683     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1684     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1685     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1686     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1687     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1688     12  PI-COMPANY-ID                   PIC XXX.
  1689     12  PI-COMPANY-CD                   PIC X.
  1690
  1691     12  PI-COMPANY-PASSWORD             PIC X(8).
  1692
  1693     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1694
  1695     12  PI-CONTROL-IN-PROGRESS.
  1696         16  PI-CARRIER                  PIC X.
  1697         16  PI-GROUPING                 PIC X(6).
  1698         16  PI-STATE                    PIC XX.
  1699         16  PI-ACCOUNT                  PIC X(10).
  1700         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1701                                         PIC X(10).
  1702         16  PI-CLAIM-CERT-GRP.
  1703             20  PI-CLAIM-NO             PIC X(7).
  1704             20  PI-CERT-NO.
  1705                 25  PI-CERT-PRIME       PIC X(10).
  1706                 25  PI-CERT-SFX         PIC X.
  1707             20  PI-CERT-EFF-DT          PIC XX.
  1708         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1709             20  PI-PLAN-CODE            PIC X(2).
  1710             20  PI-REVISION-NUMBER      PIC X(3).
  1711             20  PI-PLAN-EFF-DT          PIC X(2).
  1712             20  PI-PLAN-EXP-DT          PIC X(2).
  1713             20  FILLER                  PIC X(11).
  1714         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  35
* EL152.cbl
  1715             20  PI-OE-REFERENCE-1.
  1716                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1717                 25  PI-OE-REF-1-SUFF    PIC XX.
  1718
  1719     12  PI-SESSION-IN-PROGRESS          PIC X.
  1720         88  CLAIM-SESSION                   VALUE '1'.
  1721         88  CREDIT-SESSION                  VALUE '2'.
  1722         88  WARRANTY-SESSION                VALUE '3'.
  1723         88  MORTGAGE-SESSION                VALUE '4'.
  1724         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1725
  1726
  1727*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1728
  1729     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1730     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1731
  1732     12  PI-CREDIT-USER                  PIC X.
  1733         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1734         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1735
  1736     12  PI-CLAIM-USER                   PIC X.
  1737         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1738         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1739
  1740     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1741         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1742         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1743         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1744         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1745         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1746
  1747     12  PI-PROCESSOR-ID                 PIC X(4).
  1748
  1749     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1750
  1751     12  PI-MEMBER-CAPTION               PIC X(10).
  1752
  1753     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1754         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1755
  1756     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1757     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1758     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1759     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1760
  1761     12  PI-AH-OVERRIDE-L1               PIC X.
  1762     12  PI-AH-OVERRIDE-L2               PIC XX.
  1763     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1764     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1765
  1766     12  PI-NEW-SYSTEM                   PIC X(2).
  1767
  1768     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1769     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1770         88  PI-USES-PAID-TO                 VALUE '1'.
  1771     12  PI-CRDTCRD-SYSTEM.
  1772         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  36
* EL152.cbl
  1773             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1774             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1775         16  PI-CC-MONTH-END-DT          PIC XX.
  1776     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1777
  1778     12  PI-OE-REFERENCE-2.
  1779         16  PI-OE-REF-2-PRIME           PIC X(10).
  1780         16  PI-OE-REF-2-SUFF            PIC X.
  1781
  1782     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1783
  1784     12  PI-LANGUAGE-TYPE                PIC X.
  1785             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1786             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1787             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1788
  1789     12  PI-POLICY-LINKAGE-IND           PIC X.
  1790         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1791         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1792                                                   LOW-VALUES.
  1793
  1794     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1795     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1796         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1797         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1798
  1799     12  PI-PROCESSOR-CSR-IND            PIC X.
  1800         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1801         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1802
  1803     12  FILLER                          PIC X(3).
  1804
  1805     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1806
  1807     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1808         PI-SYSTEM-LEVEL.
  1809
  1810         16  PI-ENTRY-CODES.
  1811             20  PI-ENTRY-CD-1           PIC X.
  1812             20  PI-ENTRY-CD-2           PIC X.
  1813
  1814         16  PI-RETURN-CODES.
  1815             20  PI-RETURN-CD-1          PIC X.
  1816             20  PI-RETURN-CD-2          PIC X.
  1817
  1818         16  PI-UPDATE-STATUS-SAVE.
  1819             20  PI-UPDATE-BY            PIC X(4).
  1820             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1821
  1822         16  PI-LOWER-CASE-LETTERS       PIC X.
  1823             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1824
  1825*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1826*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1827*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1828
  1829         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1830             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  37
* EL152.cbl
  1831             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1832             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1833             88  ACCNT-CNTL                  VALUE '3'.
  1834             88  CARR-ACCNT-CNTL             VALUE '4'.
  1835
  1836         16  PI-PROCESSOR-CAP-LIST.
  1837             20  PI-SYSTEM-CONTROLS.
  1838                24 PI-SYSTEM-DISPLAY     PIC X.
  1839                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1840                24 PI-SYSTEM-MODIFY      PIC X.
  1841                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1842             20  FILLER                  PIC XX.
  1843             20  PI-DISPLAY-CAP          PIC X.
  1844                 88  DISPLAY-CAP             VALUE 'Y'.
  1845             20  PI-MODIFY-CAP           PIC X.
  1846                 88  MODIFY-CAP              VALUE 'Y'.
  1847             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1848                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1849             20  PI-FORCE-CAP            PIC X.
  1850                 88  FORCE-CAP               VALUE 'Y'.
  1851
  1852         16  PI-PROGRAM-CONTROLS.
  1853             20  PI-PGM-PRINT-OPT        PIC X.
  1854             20  PI-PGM-FORMAT-OPT       PIC X.
  1855             20  PI-PGM-PROCESS-OPT      PIC X.
  1856             20  PI-PGM-TOTALS-OPT       PIC X.
  1857
  1858         16  PI-HELP-INTERFACE.
  1859             20  PI-LAST-ERROR-NO        PIC X(4).
  1860             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1861
  1862         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1863             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1864
  1865         16  PI-CR-CONTROL-IN-PROGRESS.
  1866             20  PI-CR-CARRIER           PIC X.
  1867             20  PI-CR-GROUPING          PIC X(6).
  1868             20  PI-CR-STATE             PIC XX.
  1869             20  PI-CR-ACCOUNT           PIC X(10).
  1870             20  PI-CR-FIN-RESP          PIC X(10).
  1871             20  PI-CR-TYPE              PIC X.
  1872
  1873         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1874
  1875         16  PI-CR-MONTH-END-DT          PIC XX.
  1876
  1877         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1878             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1879             88  PI-ZERO-CARRIER             VALUE '1'.
  1880             88  PI-ZERO-GROUPING            VALUE '2'.
  1881             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1882
  1883         16  PI-CARRIER-SECURITY         PIC X.
  1884             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1885
  1886         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1887             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1888             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  38
* EL152.cbl
  1889
  1890         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1891             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1892                                         INDEXED BY PI-ACCESS-NDX
  1893                                         PIC X.
  1894
  1895         16  PI-GA-BILLING-CONTROL       PIC X.
  1896             88  PI-GA-BILLING               VALUE '1'.
  1897
  1898         16  PI-MAIL-PROCESSING          PIC X.
  1899             88  PI-MAIL-YES                 VALUE 'Y'.
  1900
  1901         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1902
  1903         16  PI-AR-SYSTEM.
  1904             20  PI-AR-PROCESSING-CNTL   PIC X.
  1905                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1906             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1907             20  PI-AR-MONTH-END-DT      PIC XX.
  1908
  1909         16  PI-MP-SYSTEM.
  1910             20  PI-MORTGAGE-USER            PIC X.
  1911                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1912                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1913             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1914                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1915                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1916                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1917                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1918                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1919             20  PI-MP-MONTH-END-DT          PIC XX.
  1920             20  PI-MP-REFERENCE-NO.
  1921                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1922                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1923
  1924         16  PI-LABEL-CONTROL            PIC X(01).
  1925             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1926             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1927
  1928         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1929             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1930
  1931         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1932             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1933             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1934
  1935         16  FILLER                      PIC X(14).
  1936
  1937     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1938******************************************************************
  1939     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1940*        COPY ELC1042.
  1941******************************************************************
  1942*                                                                *
  1943*                                                                *
  1944*                           ELC1042                              *
  1945*                            VMOD=2.002                          *
  1946*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  39
* EL152.cbl
  1947*    NOTE                                                        *
  1948*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1949*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1950*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1951*        TO THESE PROGRAMS.                                      *
  1952*                                                                *
  1953*    NOTE                                                        *
  1954*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1955*        USE ONLY!                                               *
  1956*                                                                *
  1957******************************************************************
  1958
  1959         16  PI-1042-WA.
  1960             20  PI-ACTION       PIC  X(01).
  1961                 88 PI-SHOW-MODE           VALUE '1'.
  1962                 88 PI-CLEAR-MODE          VALUE '2'.
  1963                 88 PI-CREATE-MODE         VALUE '3'.
  1964             20  PI-COMM-CONTROL PIC  X(12).
  1965             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1966             20  PI-EOF-SW       PIC  X(01).
  1967                 88  PI-FILE-EOF           VALUE 'Y'.
  1968             20  PI-FILETYP      PIC  X(01).
  1969             20  PI-FORM-SQUEEZE-CONTROL
  1970                                 PIC  X(01).
  1971                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1972                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1973             20  PI-LAST-CONTROL PIC  X(12).
  1974             20  PI-TEMP-STOR-ITEMS
  1975                                 PIC S9(04) COMP.
  1976             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1977             20  PI-UPDATE-SW    PIC  9(01).
  1978                 88 ANY-UPDATES            VALUE 1.
  1979             20  PI-104-SCREEN-SENT-IND
  1980                                 PIC  X(01).
  1981                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1982                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1983             20  PI-1042-SCREEN-SENT-IND
  1984                                 PIC  X(01).
  1985                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1986                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1987             20  PI-1042-ARCHIVE-IND
  1988                                 PIC  X(01).
  1989                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1990             20  FILLER          PIC  X(29).
  1991**********************************************************
  1992*    NOTE                                                *
  1993*        THE WORK AREA IS USED BY EL152 AND EL1522       *
  1994*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
  1995*        BOTH PROGRAMS.                                  *
  1996*                                                        *
  1997**********************************************************
  1998         16  PI-EL152-WA.
  1999             20  PI-ALT-PRINTER-ID        PIC X(4).
  2000             20  PI-ARCHIVE-NUMBER        PIC 9(8).
  2001             20  PI-FORM-NUMBER           PIC X(4).
  2002             20  PI-ADDR-TYPE             PIC XX.
  2003             20  PI-TEMP-STOR-ID          PIC X(8).
  2004             20  PI-NUM-PRINT-COPIES      PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  40
* EL152.cbl
  2005             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
  2006             20  PI-PRINT-SW              PIC X.
  2007                 88 PRINT-PERFORMED  VALUE '1'.
  2008             20  PI-LETTER-ADDRESS-TYPE   PIC XX.
  2009             20  PI-RESEND-FORM-NUMBER    PIC X(4).
  2010             20  PI-PROMPT-LETTER         PIC X.
  2011             20  PI-ENCLOSURE-CD          PIC X(3).
  2012             20  PI-AUTO-CLOSE-IND        PIC X(1).
  2013             20  PI-LETTER-TO-BENE        PIC X(1).
  2014             20  PI-FILLER                PIC X(528).
  2015             20  PI-FORCE-7840            PIC X.
  2016                 88 FORCE-7840       VALUE '1'.
  2017
  2018             20  PI-BSR-LETTER-IND        PIC XX.
  2019                 88  PI-BSR-AUTOMATED VALUE 'BA'.
  2020             20  FILLER REDEFINES PI-BSR-LETTER-IND.
  2021                 22  PI-ELLETR-BSR        PIC X.
  2022                 22  PI-ELBENE-BSR        PIC X.
  2023
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  41
* EL152.cbl
  2025*                            COPY DFHBMSCA.
  2026*****************************************************************
  2027*                                                               *
  2028* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2029* All rights reserved.                                          *
  2030*                                                               *
  2031*****************************************************************
  2032 01    DFHBMSCA.
  2033*        VARIABLE  PROTECTION    INTENSITY    MODIFIED
  2034*                                             DATA TAG
  2035*
  2036*        DFHBMUNP  Unprotected   Normal       Off
  2037     02  DFHBMUNP PIC X VALUE SPACE.
  2038*        DFHBMUNN  Numeric       Normal       Off
  2039     02  DFHBMUNN PIC X VALUE "&".
  2040*        DFHBMPRO  Protected     Normal       Off
  2041     02  DFHBMPRO PIC X VALUE "-".
  2042*        DFHBMASK  Autoskip      Normal       Off
  2043     02  DFHBMASK PIC X VALUE "0".
  2044*************************************************
  2045*        DFHBMBRY  Unprotected   Bright       Off
  2046     02  DFHBMBRY PIC X VALUE "H".
  2047*        DFHPROTI  Protected     Bright       Off
  2048     02  DFHPROTI PIC X VALUE "Y".
  2049*        DFHBMASB  Autoskip      Bright       Off
  2050     02  DFHBMASB PIC X VALUE "8".
  2051*************************************************
  2052*        DFHBMDAR  Unprotected   Non-Display  Off
  2053     02  DFHBMDAR PIC X VALUE "<".
  2054*        DFHPROTN  Protected     Non-Display  Off
  2055     02  DFHPROTN PIC X VALUE "%".
  2056*************************************************
  2057*        DFHBMFSE  Unprotected   Normal       On
  2058     02  DFHBMFSE PIC X VALUE "A".
  2059*        DFHBMASF  Autoskip      Normal       On
  2060     02  DFHBMASF  PIC X VALUE "1".
  2061*        DFHUNNUM  Numeric       Normal       On
  2062     02  DFHUNNUM PIC X VALUE "J".
  2063*        DFHBMPRF  Protected     Normal       On
  2064     02  DFHBMPRF PIC X VALUE "/".
  2065*************************************************
  2066*        DFHUNIMD  Unprotected   Bright       On
  2067     02  DFHUNIMD PIC X VALUE "I".
  2068*        DFHUNINT  Numeric       Bright       On
  2069     02  DFHUNINT PIC X VALUE "R".
  2070*************************************************
  2071*        DFHUNNOD  Unprotected   Non-Display  On
  2072     02  DFHUNNOD PIC X VALUE "(".
  2073*        DFHUNNON  Numeric       Non-Display  On
  2074     02  DFHUNNON PIC X VALUE ")".
  2075*************************************************
  2076*
  2077*     COLOURS
  2078*
  2079     02  DFHDFCOL PIC X VALUE X"00".
  2080     02  DFHBLUE  PIC X VALUE "1".
  2081     02  DFHRED   PIC X VALUE "2".
  2082     02  DFHPINK  PIC X VALUE "3".
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  42
* EL152.cbl
  2083     02  DFHGREEN PIC X VALUE "4".
  2084     02  DFHTURQ  PIC X VALUE "5".
  2085     02  DFHYELLO PIC X VALUE "6".
  2086     02  DFHNEUTR PIC X VALUE "7".
  2087     02  DFH3270  PIC X VALUE "{".
  2088     02  DFHALL   PIC X VALUE LOW-VALUE.
  2089     02  DFHBASE  PIC X VALUE LOW-VALUE.
  2090     02  DFHBLINK PIC X VALUE "1".
  2091     02  DFHBMDET PIC X VALUE LOW-VALUE.
  2092     02  DFHBMEOF PIC X VALUE X"80".
  2093     02  DFHBMPEM PIC X VALUE X"19".
  2094* Newline, DFHBMPNL, is changed to be an ASCII 0x0A
  2095     02  DFHBMPNL PIC X VALUE X"0A".
  2096     02  DFHCOLOR PIC X VALUE "!".
  2097     02  DFHDFHI  PIC X VALUE LOW-VALUE.
  2098     02  DFHDFT   PIC X VALUE X"FF".
  2099     02  DFHERROR PIC X VALUE X"1A".
  2100     02  DFHHLT   PIC X VALUE " ".
  2101     02  DFHMENT  PIC X VALUE X"02".
  2102     02  DFHBMCUR  PIC X VALUE X"02".
  2103     02  DFHBMFLG  PIC X.
  2104         88 DFHCURSR VALUES ARE X"02" , X"82".
  2105     02  DFHMET   PIC X VALUE X"03".
  2106     02  DFHMFE   PIC X VALUE X"06".
  2107     02  DFHMFET  PIC X VALUE LOW-VALUE.
  2108     02  DFHMFIL  PIC X VALUE X"1C".
  2109     02  DFHMFT   PIC X VALUE X"09".
  2110     02  DFHMT    PIC X VALUE X"01".
  2111     02  DFHPS    PIC X VALUE '"'.
  2112     02  DFHREVRS PIC X VALUE "2".
  2113     02  DFHSA    PIC X VALUE X"08".
  2114     02  DFHUNDLN PIC X VALUE "4".
  2115     02  DFHVAL   PIC X VALUE "A".
  2116     02  DFHLEFT  PIC X VALUE X"97".
  2117     02  DFHOVER  PIC X VALUE X"9C".
  2118     02  DFHRIGHT PIC X VALUE X"02".
  2119     02  DFHUNDER PIC X VALUE X"01".
  2120     02  DFHBOX-BIN  PIC 9(4) COMP VALUE 15.
  2121     02  FILLER REDEFINES DFHBOX-BIN.
  2122         03  FILLER PIC X.
  2123         03  DFHBOX PIC X.
  2124     02  DFHSOSI  PIC X VALUE X"01".
  2125     02  DFHBMPSO-BIN    PIC 9(4) COMP VALUE 3599.
  2126     02  FILLER REDEFINES DFHBMPSO-BIN.
  2127         03 DFHBMPSO  PIC X.
  2128         03 DFHBMPSI  PIC X.
  2129     02  DFHBMEC  PIC X VALUE X"82".
  2130*    02  DFHDFFR  PIC X VALUE X"00".
  2131*    02  DFHOPAQ  PIC X VALUE X"00".
  2132*    02  DFHOUTLN PIC X VALUE X"00".
  2133*    02  DFHTRANS PIC X VALUE X"00".
  2134*    02  DFHBKTRN PIC X VALUE X"00".
  2135*                            COPY ELCAID.
  2136******************************************************************
  2137*                                                                *
  2138*                            ELCAID.                             *
  2139*                            VMOD=2.001                          *
  2140*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  43
* EL152.cbl
  2141*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2142*                                                                *
  2143*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2144*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2145******************************************************************
  2146
  2147 01  DFHAID.
  2148   02  DFHNULL   PIC  X  VALUE  ' '.
  2149   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2150   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2151   02  DFHPEN    PIC  X  VALUE  '='.
  2152   02  DFHOPID   PIC  X  VALUE  'W'.
  2153   02  DFHPA1    PIC  X  VALUE  '%'.
  2154   02  DFHPA2    PIC  X  VALUE  '>'.
  2155   02  DFHPA3    PIC  X  VALUE  ','.
  2156   02  DFHPF1    PIC  X  VALUE  '1'.
  2157   02  DFHPF2    PIC  X  VALUE  '2'.
  2158   02  DFHPF3    PIC  X  VALUE  '3'.
  2159   02  DFHPF4    PIC  X  VALUE  '4'.
  2160   02  DFHPF5    PIC  X  VALUE  '5'.
  2161   02  DFHPF6    PIC  X  VALUE  '6'.
  2162   02  DFHPF7    PIC  X  VALUE  '7'.
  2163   02  DFHPF8    PIC  X  VALUE  '8'.
  2164   02  DFHPF9    PIC  X  VALUE  '9'.
  2165   02  DFHPF10   PIC  X  VALUE  ':'.
  2166   02  DFHPF11   PIC  X  VALUE  '#'.
  2167   02  DFHPF12   PIC  X  VALUE  '@'.
  2168   02  DFHPF13   PIC  X  VALUE  'A'.
  2169   02  DFHPF14   PIC  X  VALUE  'B'.
  2170   02  DFHPF15   PIC  X  VALUE  'C'.
  2171   02  DFHPF16   PIC  X  VALUE  'D'.
  2172   02  DFHPF17   PIC  X  VALUE  'E'.
  2173   02  DFHPF18   PIC  X  VALUE  'F'.
  2174   02  DFHPF19   PIC  X  VALUE  'G'.
  2175   02  DFHPF20   PIC  X  VALUE  'H'.
  2176   02  DFHPF21   PIC  X  VALUE  'I'.
  2177*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2178   02  DFHPF22   PIC  X  VALUE  '['.
  2179   02  DFHPF23   PIC  X  VALUE  '.'.
  2180   02  DFHPF24   PIC  X  VALUE  '<'.
  2181   02  DFHMSRE   PIC  X  VALUE  'X'.
  2182   02  DFHSTRF   PIC  X  VALUE  'h'.
  2183   02  DFHTRIG   PIC  X  VALUE  '"'.
  2184 01  FILLER    REDEFINES DFHAID.
  2185     12  FILLER              PIC X(8).
  2186     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  44
* EL152.cbl
  2188*                            COPY EL152S.
  2189 01  EL152AI.
  2190     05  FILLER            PIC  X(0012).
  2191*    -------------------------------
  2192     05  DATEAL PIC S9(0004) COMP.
  2193     05  DATEAF PIC  X(0001).
  2194     05  FILLER REDEFINES DATEAF.
  2195         10  DATEAA PIC  X(0001).
  2196     05  DATEAI PIC  X(0008).
  2197*    -------------------------------
  2198     05  TIMEAL PIC S9(0004) COMP.
  2199     05  TIMEAF PIC  X(0001).
  2200     05  FILLER REDEFINES TIMEAF.
  2201         10  TIMEAA PIC  X(0001).
  2202     05  TIMEAI PIC  X(0005).
  2203*    -------------------------------
  2204     05  CARRL PIC S9(0004) COMP.
  2205     05  CARRF PIC  X(0001).
  2206     05  FILLER REDEFINES CARRF.
  2207         10  CARRA PIC  X(0001).
  2208     05  CARRI PIC  X(0001).
  2209*    -------------------------------
  2210     05  CLMNOL PIC S9(0004) COMP.
  2211     05  CLMNOF PIC  X(0001).
  2212     05  FILLER REDEFINES CLMNOF.
  2213         10  CLMNOA PIC  X(0001).
  2214     05  CLMNOI PIC  X(0007).
  2215*    -------------------------------
  2216     05  CRTNOL PIC S9(0004) COMP.
  2217     05  CRTNOF PIC  X(0001).
  2218     05  FILLER REDEFINES CRTNOF.
  2219         10  CRTNOA PIC  X(0001).
  2220     05  CRTNOI PIC  X(0011).
  2221*    -------------------------------
  2222     05  PROCL PIC S9(0004) COMP.
  2223     05  PROCF PIC  X(0001).
  2224     05  FILLER REDEFINES PROCF.
  2225         10  PROCA PIC  X(0001).
  2226     05  PROCI PIC  X(0004).
  2227*    -------------------------------
  2228     05  COMPIDL PIC S9(0004) COMP.
  2229     05  COMPIDF PIC  X(0001).
  2230     05  FILLER REDEFINES COMPIDF.
  2231         10  COMPIDA PIC  X(0001).
  2232     05  COMPIDI PIC  X(0003).
  2233*    -------------------------------
  2234     05  CLEANL PIC S9(0004) COMP.
  2235     05  CLEANF PIC  X(0001).
  2236     05  FILLER REDEFINES CLEANF.
  2237         10  CLEANA PIC  X(0001).
  2238     05  CLEANI PIC  X(0001).
  2239*    -------------------------------
  2240     05  SYSL PIC S9(0004) COMP.
  2241     05  SYSF PIC  X(0001).
  2242     05  FILLER REDEFINES SYSF.
  2243         10  SYSA PIC  X(0001).
  2244     05  SYSI PIC  X(0008).
  2245*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  45
* EL152.cbl
  2246     05  MAINTL PIC S9(0004) COMP.
  2247     05  MAINTF PIC  X(0001).
  2248     05  FILLER REDEFINES MAINTF.
  2249         10  MAINTA PIC  X(0001).
  2250     05  MAINTI PIC  X(0001).
  2251*    -------------------------------
  2252     05  ARCHNUML PIC S9(0004) COMP.
  2253     05  ARCHNUMF PIC  X(0001).
  2254     05  FILLER REDEFINES ARCHNUMF.
  2255         10  ARCHNUMA PIC  X(0001).
  2256     05  ARCHNUMI PIC  99999999.
  2257*    -------------------------------
  2258     05  FORML PIC S9(0004) COMP.
  2259     05  FORMF PIC  X(0001).
  2260     05  FILLER REDEFINES FORMF.
  2261         10  FORMA PIC  X(0001).
  2262     05  FORMI PIC  X(0004).
  2263*    -------------------------------
  2264     05  FOLLOWL PIC S9(0004) COMP.
  2265     05  FOLLOWF PIC  X(0001).
  2266     05  FILLER REDEFINES FOLLOWF.
  2267         10  FOLLOWA PIC  X(0001).
  2268     05  FOLLOWI PIC  X(0008).
  2269*    -------------------------------
  2270     05  RESENDL PIC S9(0004) COMP.
  2271     05  RESENDF PIC  X(0001).
  2272     05  FILLER REDEFINES RESENDF.
  2273         10  RESENDA PIC  X(0001).
  2274     05  RESENDI PIC  X(0008).
  2275*    -------------------------------
  2276     05  PRINTL PIC S9(0004) COMP.
  2277     05  PRINTF PIC  X(0001).
  2278     05  FILLER REDEFINES PRINTF.
  2279         10  PRINTA PIC  X(0001).
  2280     05  PRINTI PIC  X(0001).
  2281*    -------------------------------
  2282     05  COPIESL PIC S9(0004) COMP.
  2283     05  COPIESF PIC  X(0001).
  2284     05  FILLER REDEFINES COPIESF.
  2285         10  COPIESA PIC  X(0001).
  2286     05  COPIESI PIC  X(0001).
  2287*    -------------------------------
  2288     05  ENCL PIC S9(0004) COMP.
  2289     05  ENCF PIC  X(0001).
  2290     05  FILLER REDEFINES ENCF.
  2291         10  ENCA PIC  X(0001).
  2292     05  ENCI PIC  X(0003).
  2293*    -------------------------------
  2294     05  ADDRL PIC S9(0004) COMP.
  2295     05  ADDRF PIC  X(0001).
  2296     05  FILLER REDEFINES ADDRF.
  2297         10  ADDRA PIC  X(0001).
  2298     05  ADDRI PIC  X(0002).
  2299*    -------------------------------
  2300     05  ACTL PIC S9(0004) COMP.
  2301     05  ACTF PIC  X(0001).
  2302     05  FILLER REDEFINES ACTF.
  2303         10  ACTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  46
* EL152.cbl
  2304     05  ACTI PIC  X(0001).
  2305*    -------------------------------
  2306     05  BENL PIC S9(0004) COMP.
  2307     05  BENF PIC  X(0001).
  2308     05  FILLER REDEFINES BENF.
  2309         10  BENA PIC  X(0001).
  2310     05  BENI PIC  X(0001).
  2311*    -------------------------------
  2312     05  EMPL PIC S9(0004) COMP.
  2313     05  EMPF PIC  X(0001).
  2314     05  FILLER REDEFINES EMPF.
  2315         10  EMPA PIC  X(0001).
  2316     05  EMPI PIC  X(0001).
  2317*    -------------------------------
  2318     05  INSL PIC S9(0004) COMP.
  2319     05  INSF PIC  X(0001).
  2320     05  FILLER REDEFINES INSF.
  2321         10  INSA PIC  X(0001).
  2322     05  INSI PIC  X(0001).
  2323*    -------------------------------
  2324     05  PHYSL PIC S9(0004) COMP.
  2325     05  PHYSF PIC  X(0001).
  2326     05  FILLER REDEFINES PHYSF.
  2327         10  PHYSA PIC  X(0001).
  2328     05  PHYSI PIC  X(0001).
  2329*    -------------------------------
  2330     05  OTHR1L PIC S9(0004) COMP.
  2331     05  OTHR1F PIC  X(0001).
  2332     05  FILLER REDEFINES OTHR1F.
  2333         10  OTHR1A PIC  X(0001).
  2334     05  OTHR1I PIC  X(0001).
  2335*    -------------------------------
  2336     05  OTHR2L PIC S9(0004) COMP.
  2337     05  OTHR2F PIC  X(0001).
  2338     05  FILLER REDEFINES OTHR2F.
  2339         10  OTHR2A PIC  X(0001).
  2340     05  OTHR2I PIC  X(0001).
  2341*    -------------------------------
  2342     05  REL PIC S9(0004) COMP.
  2343     05  REF PIC  X(0001).
  2344     05  FILLER REDEFINES REF.
  2345         10  REA PIC  X(0001).
  2346     05  REI PIC  X(0070).
  2347*    -------------------------------
  2348     05  L1L PIC S9(0004) COMP.
  2349     05  L1F PIC  X(0001).
  2350     05  FILLER REDEFINES L1F.
  2351         10  L1A PIC  X(0001).
  2352     05  L1I PIC  X(0003).
  2353*    -------------------------------
  2354     05  TEXT1L PIC S9(0004) COMP.
  2355     05  TEXT1F PIC  X(0001).
  2356     05  FILLER REDEFINES TEXT1F.
  2357         10  TEXT1A PIC  X(0001).
  2358     05  TEXT1I PIC  X(0070).
  2359*    -------------------------------
  2360     05  L2L PIC S9(0004) COMP.
  2361     05  L2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  47
* EL152.cbl
  2362     05  FILLER REDEFINES L2F.
  2363         10  L2A PIC  X(0001).
  2364     05  L2I PIC  X(0003).
  2365*    -------------------------------
  2366     05  TEXT2L PIC S9(0004) COMP.
  2367     05  TEXT2F PIC  X(0001).
  2368     05  FILLER REDEFINES TEXT2F.
  2369         10  TEXT2A PIC  X(0001).
  2370     05  TEXT2I PIC  X(0070).
  2371*    -------------------------------
  2372     05  L3L PIC S9(0004) COMP.
  2373     05  L3F PIC  X(0001).
  2374     05  FILLER REDEFINES L3F.
  2375         10  L3A PIC  X(0001).
  2376     05  L3I PIC  X(0003).
  2377*    -------------------------------
  2378     05  TEXT3L PIC S9(0004) COMP.
  2379     05  TEXT3F PIC  X(0001).
  2380     05  FILLER REDEFINES TEXT3F.
  2381         10  TEXT3A PIC  X(0001).
  2382     05  TEXT3I PIC  X(0070).
  2383*    -------------------------------
  2384     05  L4L PIC S9(0004) COMP.
  2385     05  L4F PIC  X(0001).
  2386     05  FILLER REDEFINES L4F.
  2387         10  L4A PIC  X(0001).
  2388     05  L4I PIC  X(0003).
  2389*    -------------------------------
  2390     05  TEXT4L PIC S9(0004) COMP.
  2391     05  TEXT4F PIC  X(0001).
  2392     05  FILLER REDEFINES TEXT4F.
  2393         10  TEXT4A PIC  X(0001).
  2394     05  TEXT4I PIC  X(0070).
  2395*    -------------------------------
  2396     05  L5L PIC S9(0004) COMP.
  2397     05  L5F PIC  X(0001).
  2398     05  FILLER REDEFINES L5F.
  2399         10  L5A PIC  X(0001).
  2400     05  L5I PIC  X(0003).
  2401*    -------------------------------
  2402     05  TEXT5L PIC S9(0004) COMP.
  2403     05  TEXT5F PIC  X(0001).
  2404     05  FILLER REDEFINES TEXT5F.
  2405         10  TEXT5A PIC  X(0001).
  2406     05  TEXT5I PIC  X(0070).
  2407*    -------------------------------
  2408     05  L6L PIC S9(0004) COMP.
  2409     05  L6F PIC  X(0001).
  2410     05  FILLER REDEFINES L6F.
  2411         10  L6A PIC  X(0001).
  2412     05  L6I PIC  X(0003).
  2413*    -------------------------------
  2414     05  TEXT6L PIC S9(0004) COMP.
  2415     05  TEXT6F PIC  X(0001).
  2416     05  FILLER REDEFINES TEXT6F.
  2417         10  TEXT6A PIC  X(0001).
  2418     05  TEXT6I PIC  X(0070).
  2419*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  48
* EL152.cbl
  2420     05  L7L PIC S9(0004) COMP.
  2421     05  L7F PIC  X(0001).
  2422     05  FILLER REDEFINES L7F.
  2423         10  L7A PIC  X(0001).
  2424     05  L7I PIC  X(0003).
  2425*    -------------------------------
  2426     05  TEXT7L PIC S9(0004) COMP.
  2427     05  TEXT7F PIC  X(0001).
  2428     05  FILLER REDEFINES TEXT7F.
  2429         10  TEXT7A PIC  X(0001).
  2430     05  TEXT7I PIC  X(0070).
  2431*    -------------------------------
  2432     05  L8L PIC S9(0004) COMP.
  2433     05  L8F PIC  X(0001).
  2434     05  FILLER REDEFINES L8F.
  2435         10  L8A PIC  X(0001).
  2436     05  L8I PIC  X(0003).
  2437*    -------------------------------
  2438     05  TEXT8L PIC S9(0004) COMP.
  2439     05  TEXT8F PIC  X(0001).
  2440     05  FILLER REDEFINES TEXT8F.
  2441         10  TEXT8A PIC  X(0001).
  2442     05  TEXT8I PIC  X(0070).
  2443*    -------------------------------
  2444     05  L9L PIC S9(0004) COMP.
  2445     05  L9F PIC  X(0001).
  2446     05  FILLER REDEFINES L9F.
  2447         10  L9A PIC  X(0001).
  2448     05  L9I PIC  X(0003).
  2449*    -------------------------------
  2450     05  TEXT9L PIC S9(0004) COMP.
  2451     05  TEXT9F PIC  X(0001).
  2452     05  FILLER REDEFINES TEXT9F.
  2453         10  TEXT9A PIC  X(0001).
  2454     05  TEXT9I PIC  X(0070).
  2455*    -------------------------------
  2456     05  L10L PIC S9(0004) COMP.
  2457     05  L10F PIC  X(0001).
  2458     05  FILLER REDEFINES L10F.
  2459         10  L10A PIC  X(0001).
  2460     05  L10I PIC  X(0003).
  2461*    -------------------------------
  2462     05  TEXT10L PIC S9(0004) COMP.
  2463     05  TEXT10F PIC  X(0001).
  2464     05  FILLER REDEFINES TEXT10F.
  2465         10  TEXT10A PIC  X(0001).
  2466     05  TEXT10I PIC  X(0070).
  2467*    -------------------------------
  2468     05  L11L PIC S9(0004) COMP.
  2469     05  L11F PIC  X(0001).
  2470     05  FILLER REDEFINES L11F.
  2471         10  L11A PIC  X(0001).
  2472     05  L11I PIC  X(0003).
  2473*    -------------------------------
  2474     05  TEXT11L PIC S9(0004) COMP.
  2475     05  TEXT11F PIC  X(0001).
  2476     05  FILLER REDEFINES TEXT11F.
  2477         10  TEXT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  49
* EL152.cbl
  2478     05  TEXT11I PIC  X(0070).
  2479*    -------------------------------
  2480     05  L12L PIC S9(0004) COMP.
  2481     05  L12F PIC  X(0001).
  2482     05  FILLER REDEFINES L12F.
  2483         10  L12A PIC  X(0001).
  2484     05  L12I PIC  X(0003).
  2485*    -------------------------------
  2486     05  TEXT12L PIC S9(0004) COMP.
  2487     05  TEXT12F PIC  X(0001).
  2488     05  FILLER REDEFINES TEXT12F.
  2489         10  TEXT12A PIC  X(0001).
  2490     05  TEXT12I PIC  X(0070).
  2491*    -------------------------------
  2492     05  L13L PIC S9(0004) COMP.
  2493     05  L13F PIC  X(0001).
  2494     05  FILLER REDEFINES L13F.
  2495         10  L13A PIC  X(0001).
  2496     05  L13I PIC  X(0003).
  2497*    -------------------------------
  2498     05  TEXT13L PIC S9(0004) COMP.
  2499     05  TEXT13F PIC  X(0001).
  2500     05  FILLER REDEFINES TEXT13F.
  2501         10  TEXT13A PIC  X(0001).
  2502     05  TEXT13I PIC  X(0070).
  2503*    -------------------------------
  2504     05  ERRMSGL PIC S9(0004) COMP.
  2505     05  ERRMSGF PIC  X(0001).
  2506     05  FILLER REDEFINES ERRMSGF.
  2507         10  ERRMSGA PIC  X(0001).
  2508     05  ERRMSGI PIC  X(0072).
  2509*    -------------------------------
  2510     05  ENTERPFL PIC S9(0004) COMP.
  2511     05  ENTERPFF PIC  X(0001).
  2512     05  FILLER REDEFINES ENTERPFF.
  2513         10  ENTERPFA PIC  X(0001).
  2514     05  ENTERPFI PIC  99.
  2515*    -------------------------------
  2516     05  PRINTERL PIC S9(0004) COMP.
  2517     05  PRINTERF PIC  X(0001).
  2518     05  FILLER REDEFINES PRINTERF.
  2519         10  PRINTERA PIC  X(0001).
  2520     05  PRINTERI PIC  X(0004).
  2521*    -------------------------------
  2522     05  PFKEY9L PIC S9(0004) COMP.
  2523     05  PFKEY9F PIC  X(0001).
  2524     05  FILLER REDEFINES PFKEY9F.
  2525         10  PFKEY9A PIC  X(0001).
  2526     05  PFKEY9I PIC  X(0014).
  2527 01  EL152AO REDEFINES EL152AI.
  2528     05  FILLER            PIC  X(0012).
  2529*    -------------------------------
  2530     05  FILLER            PIC  X(0003).
  2531     05  DATEAO PIC  X(0008).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
  2534     05  TIMEAO PIC  99.99.
  2535*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  50
* EL152.cbl
  2536     05  FILLER            PIC  X(0003).
  2537     05  CARRO PIC  X(0001).
  2538*    -------------------------------
  2539     05  FILLER            PIC  X(0003).
  2540     05  CLMNOO PIC  X(0007).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  CRTNOO PIC  X(0011).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  PROCO PIC  X(0004).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  COMPIDO PIC  X(0003).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  CLEANO PIC  X(0001).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  SYSO PIC  X(0008).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  MAINTO PIC  X(0001).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  ARCHNUMO PIC  X(0008).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
  2564     05  FORMO PIC  X(0004).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  FOLLOWO PIC  X(0008).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  RESENDO PIC  X(0008).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  PRINTO PIC  X(0001).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  COPIESO PIC  X(0001).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  ENCO PIC  X(0003).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  ADDRO PIC  X(0002).
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  ACTO PIC  X(0001).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  BENO PIC  X(0001).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  EMPO PIC  X(0001).
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  51
* EL152.cbl
  2594     05  INSO PIC  X(0001).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
  2597     05  PHYSO PIC  X(0001).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  OTHR1O PIC  X(0001).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  OTHR2O PIC  X(0001).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  REO PIC  X(0070).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  L1O PIC  X(0003).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  TEXT1O PIC  X(0070).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  L2O PIC  X(0003).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  TEXT2O PIC  X(0070).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  L3O PIC  X(0003).
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  TEXT3O PIC  X(0070).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  L4O PIC  X(0003).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  TEXT4O PIC  X(0070).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  L5O PIC  X(0003).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  TEXT5O PIC  X(0070).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  L6O PIC  X(0003).
  2640*    -------------------------------
  2641     05  FILLER            PIC  X(0003).
  2642     05  TEXT6O PIC  X(0070).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  L7O PIC  X(0003).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  TEXT7O PIC  X(0070).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  L8O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  52
* EL152.cbl
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  TEXT8O PIC  X(0070).
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  L9O PIC  X(0003).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  TEXT9O PIC  X(0070).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  L10O PIC  X(0003).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  TEXT10O PIC  X(0070).
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  L11O PIC  X(0003).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  TEXT11O PIC  X(0070).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  L12O PIC  X(0003).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  TEXT12O PIC  X(0070).
  2679*    -------------------------------
  2680     05  FILLER            PIC  X(0003).
  2681     05  L13O PIC  X(0003).
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  TEXT13O PIC  X(0070).
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  ERRMSGO PIC  X(0072).
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  ENTERPFO PIC  X(0002).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  PRINTERO PIC  X(0004).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  PFKEY9O PIC  X(0014).
  2697*    -------------------------------
  2698 01  MAP-REDEF REDEFINES EL152AI.
  2699     12  FILLER              PIC X(251).
  2700*    12  FILLER              PIC X(189).
  2701     12  EL152RI.
  2702       14  TEXT-LINES OCCURS 13 TIMES INDEXED BY SC-INDX.
  2703         16  SC-LINEL        PIC S9(4)  COMP.
  2704         16  SC-LINEA        PIC X.
  2705         16  SC-LINE         PIC XXX.
  2706         16  SC-TEXTL        PIC S9(4)  COMP.
  2707         16  SC-TEXTA        PIC X.
  2708         16  SC-TEXT         PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  53
* EL152.cbl
  2710 01  RECORD-TABLE            PIC X(21900) VALUE SPACES.
  2711
  2712 01  REC-TABLE REDEFINES RECORD-TABLE.
  2713     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX
  2714                             PIC X(3650).
  2715
  2716 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2717     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2718         16  REC-TEXT        PIC X(70).
  2719         16  REC-PC          PIC 99.
  2720         16  FILLER          PIC X.
  2721
  2722 01  TS-WORK-AREA            PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  54
* EL152.cbl
  2724****************************************************************
  2725*
  2726* Copyright (c) 2007 by Clerity Solutions, Inc.
  2727* All rights reserved.
  2728*
  2729****************************************************************
  2730 01  DFHEIV.
  2731   02  DFHEIV0               PIC X(35).
  2732   02  DFHEIV1               PIC X(08).
  2733   02  DFHEIV2               PIC X(08).
  2734   02  DFHEIV3               PIC X(08).
  2735   02  DFHEIV4               PIC X(06).
  2736   02  DFHEIV5               PIC X(04).
  2737   02  DFHEIV6               PIC X(04).
  2738   02  DFHEIV7               PIC X(02).
  2739   02  DFHEIV8               PIC X(02).
  2740   02  DFHEIV9               PIC X(01).
  2741   02  DFHEIV10              PIC S9(7) COMP-3.
  2742   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2743   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2744   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2745   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2746   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2747   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2748   02  DFHEIV17              PIC X(04).
  2749   02  DFHEIV18              PIC X(04).
  2750   02  DFHEIV19              PIC X(04).
  2751   02  DFHEIV20              USAGE IS POINTER.
  2752   02  DFHEIV21              USAGE IS POINTER.
  2753   02  DFHEIV22              USAGE IS POINTER.
  2754   02  DFHEIV23              USAGE IS POINTER.
  2755   02  DFHEIV24              USAGE IS POINTER.
  2756   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2757   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2758   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2759   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2760   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2761   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2762   02  FILLER                PIC X(02).
  2763   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2764   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2765   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2766   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2767   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2768 LINKAGE  SECTION.
  2769*****************************************************************
  2770*                                                               *
  2771* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2772* All rights reserved.                                          *
  2773*                                                               *
  2774*****************************************************************
  2775 01  dfheiblk.
  2776     02  eibtime          pic s9(7) comp-3.
  2777     02  eibdate          pic s9(7) comp-3.
  2778     02  eibtrnid         pic x(4).
  2779     02  eibtaskn         pic s9(7) comp-3.
  2780     02  eibtrmid         pic x(4).
  2781     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  55
* EL152.cbl
  2782     02  eibcposn         pic s9(4) comp.
  2783     02  eibcalen         pic s9(4) comp.
  2784     02  eibaid           pic x(1).
  2785     02  eibfiller1       pic x(1).
  2786     02  eibfn            pic x(2).
  2787     02  eibfiller2       pic x(2).
  2788     02  eibrcode         pic x(6).
  2789     02  eibfiller3       pic x(2).
  2790     02  eibds            pic x(8).
  2791     02  eibreqid         pic x(8).
  2792     02  eibrsrce         pic x(8).
  2793     02  eibsync          pic x(1).
  2794     02  eibfree          pic x(1).
  2795     02  eibrecv          pic x(1).
  2796     02  eibsend          pic x(1).
  2797     02  eibatt           pic x(1).
  2798     02  eibeoc           pic x(1).
  2799     02  eibfmh           pic x(1).
  2800     02  eibcompl         pic x(1).
  2801     02  eibsig           pic x(1).
  2802     02  eibconf          pic x(1).
  2803     02  eiberr           pic x(1).
  2804     02  eibrldbk         pic x(1).
  2805     02  eiberrcd         pic x(4).
  2806     02  eibsynrb         pic x(1).
  2807     02  eibnodat         pic x(1).
  2808     02  eibfiller5       pic x(2).
  2809     02  eibresp          pic 9(09) comp.
  2810     02  eibresp2         pic 9(09) comp.
  2811     02  dfheigdj         pic s9(4) comp.
  2812     02  dfheigdk         pic s9(4) comp.
  2813 01  DFHCOMMAREA                 PIC X(1024).
  2814
  2815 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  56
* EL152.cbl
  2817*                                COPY ELCMSTR.
  2818******************************************************************
  2819*                                                                *
  2820*                            ELCMSTR.                            *
  2821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2822*                            VMOD=2.012                          *
  2823*                                                                *
  2824*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  2825*                                                                *
  2826*   FILE TYPE = VSAM,KSDS                                        *
  2827*   RECORD SIZE = 350  RECFORM = FIXED                           *
  2828*                                                                *
  2829*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  2830*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  2831*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  2832*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  2833*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  2834*                                                 RKP=75,LEN=21  *
  2835*                                                                *
  2836*   **** NOTE ****                                               *
  2837*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  2838*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  2839*                                                                *
  2840*   LOG = YES                                                    *
  2841*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2842******************************************************************
  2843*                   C H A N G E   L O G
  2844*
  2845* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2846*-----------------------------------------------------------------
  2847*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2848* EFFECTIVE    NUMBER
  2849*-----------------------------------------------------------------
  2850* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2851* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2852******************************************************************
  2853 01  CLAIM-MASTER.
  2854     12  CL-RECORD-ID                PIC XX.
  2855         88  VALID-CL-ID         VALUE 'CL'.
  2856
  2857     12  CL-CONTROL-PRIMARY.
  2858         16  CL-COMPANY-CD           PIC X.
  2859         16  CL-CARRIER              PIC X.
  2860         16  CL-CLAIM-NO             PIC X(7).
  2861         16  CL-CERT-NO.
  2862             20  CL-CERT-PRIME       PIC X(10).
  2863             20  CL-CERT-SFX         PIC X.
  2864
  2865     12  CL-CONTROL-BY-NAME.
  2866         16  CL-COMPANY-CD-A1        PIC X.
  2867         16  CL-INSURED-LAST-NAME    PIC X(15).
  2868         16  CL-INSURED-NAME.
  2869             20  CL-INSURED-1ST-NAME PIC X(12).
  2870             20  CL-INSURED-MID-INIT PIC X.
  2871
  2872     12  CL-CONTROL-BY-SSN.
  2873         16  CL-COMPANY-CD-A2        PIC X.
  2874         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  57
* EL152.cbl
  2875             20  CL-SSN-STATE        PIC XX.
  2876             20  CL-SSN-ACCOUNT      PIC X(6).
  2877             20  CL-SSN-LN3          PIC X(3).
  2878
  2879     12  CL-CONTROL-BY-CERT-NO.
  2880         16  CL-COMPANY-CD-A4        PIC X.
  2881         16  CL-CERT-NO-A4.
  2882             20  CL-CERT-A4-PRIME    PIC X(10).
  2883             20  CL-CERT-A4-SFX      PIC X.
  2884
  2885     12  CL-CONTROL-BY-CCN.
  2886         16  CL-COMPANY-CD-A5        PIC X.
  2887         16  CL-CCN-A5.
  2888             20  CL-CCN.
  2889                 24  CL-CCN-PREFIX-A5 PIC X(4).
  2890                 24  CL-CCN-PRIME-A5 PIC X(12).
  2891             20  CL-CCN-FILLER-A5    PIC X(4).
  2892
  2893     12  CL-INSURED-PROFILE-DATA.
  2894         16  CL-INSURED-BIRTH-DT     PIC XX.
  2895         16  CL-INSURED-SEX-CD       PIC X.
  2896             88  INSURED-IS-MALE        VALUE 'M'.
  2897             88  INSURED-IS-FEMALE      VALUE 'F'.
  2898             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  2899         16  CL-INSURED-OCC-CD       PIC X(6).
  2900         16  FILLER                  PIC X(5).
  2901
  2902     12  CL-PROCESSING-INFO.
  2903         16  CL-PROCESSOR-ID         PIC X(4).
  2904         16  CL-CLAIM-STATUS         PIC X.
  2905             88  CLAIM-IS-OPEN          VALUE 'O'.
  2906             88  CLAIM-IS-CLOSED        VALUE 'C'.
  2907         16  CL-CLAIM-TYPE           PIC X.
  2908*            88  AH-CLAIM               VALUE 'A'.
  2909*            88  LIFE-CLAIM             VALUE 'L'.
  2910*            88  PROPERTY-CLAIM         VALUE 'P'.
  2911*            88  IUI-CLAIM              VALUE 'I'.
  2912*            88  GAP-CLAIM              VALUE 'G'.
  2913         16  CL-CLAIM-PREM-TYPE      PIC X.
  2914             88  SINGLE-PREMIUM         VALUE '1'.
  2915             88  O-B-COVERAGE           VALUE '2'.
  2916             88  OPEN-END-COVERAGE      VALUE '3'.
  2917         16  CL-INCURRED-DT          PIC XX.
  2918         16  CL-REPORTED-DT          PIC XX.
  2919         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2920         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2921         16  CL-LAST-PMT-DT          PIC XX.
  2922         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2923         16  CL-PAID-THRU-DT         PIC XX.
  2924         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2925         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2926         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2927         16  CL-PMT-CALC-METHOD      PIC X.
  2928             88  CL-360-DAY-YR          VALUE '1'.
  2929             88  CL-365-DAY-YR          VALUE '2'.
  2930             88  CL-FULL-MONTHS         VALUE '3'.
  2931         16  CL-CAUSE-CD             PIC X(6).
  2932
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  58
* EL152.cbl
  2933         16  CL-PRIME-CERT-NO.
  2934             20  CL-PRIME-CERT-PRIME PIC X(10).
  2935             20  CL-PRIME-CERT-SFX   PIC X.
  2936
  2937         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2938             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2939             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2940
  2941         16  CL-MICROFILM-NO         PIC X(10).
  2942         16  CL-PROG-FORM-TYPE       PIC X.
  2943         16  CL-LAST-ADD-ON-DT       PIC XX.
  2944
  2945         16  CL-LAST-REOPEN-DT       PIC XX.
  2946         16  CL-LAST-CLOSE-DT        PIC XX.
  2947         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2948             88  FINAL-PAID             VALUE '1'.
  2949             88  CLAIM-DENIED           VALUE '2'.
  2950             88  AUTO-CLOSE             VALUE '3'.
  2951             88  MANUAL-CLOSE           VALUE '4'.
  2952             88  BENEFITS-CHANGED       VALUE 'C'.
  2953             88  SETUP-ERRORS           VALUE 'E'.
  2954         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2955         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2956         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2957             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2958         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2959         16  FILLER                  PIC X.
  2960
  2961     12  CL-CERTIFICATE-DATA.
  2962         16  CL-CERT-ORIGIN          PIC X.
  2963             88  CERT-WAS-ONLINE        VALUE '1'.
  2964             88  CERT-WAS-CREATED       VALUE '2'.
  2965             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2966         16  CL-CERT-KEY-DATA.
  2967             20  CL-CERT-CARRIER     PIC X.
  2968             20  CL-CERT-GROUPING    PIC X(6).
  2969             20  CL-CERT-STATE       PIC XX.
  2970             20  CL-CERT-ACCOUNT.
  2971                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2972                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2973             20  CL-CERT-EFF-DT      PIC XX.
  2974
  2975     12  CL-STATUS-CONTROLS.
  2976         16  CL-PRIORITY-CD          PIC X.
  2977             88  CONFIDENTIAL-DATA      VALUE '8'.
  2978             88  HIGHEST-PRIORITY       VALUE '9'.
  2979         16  CL-SUPV-ATTN-CD         PIC X.
  2980             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2981             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2982         16  CL-PURGED-DT            PIC XX.
  2983         16  CL-RESTORED-DT          PIC XX.
  2984         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2985         16  CL-NEXT-RESEND-DT       PIC XX.
  2986         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2987         16  FILLER                  PIC XX.
  2988         16  CL-LAST-MAINT-DT        PIC XX.
  2989         16  CL-LAST-MAINT-USER      PIC X(4).
  2990         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  59
* EL152.cbl
  2991         16  CL-LAST-MAINT-TYPE      PIC X.
  2992             88  CLAIM-SET-UP           VALUE ' '.
  2993             88  PAYMENT-MADE           VALUE '1'.
  2994             88  LETTER-SENT            VALUE '2'.
  2995             88  MASTER-WAS-ALTERED     VALUE '3'.
  2996             88  MASTER-WAS-RESTORED    VALUE '4'.
  2997             88  INCURRED-DATE-CHANGED  VALUE '5'.
  2998             88  FILE-CONVERTED         VALUE '6'.
  2999             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3000             88  ERROR-CORRECTION       VALUE 'E'.
  3001         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3002         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3003         16  CL-BENEFICIARY          PIC X(10).
  3004         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3005         16  CL-DENIAL-TYPE          PIC X.
  3006             88  CL-TYPE-DENIAL          VALUE '1'.
  3007             88  CL-TYPE-RESCISSION      VALUE '2'.
  3008             88  CL-TYPE-REFORMATION     VALUE '3'.
  3009             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3010             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3011         16  FILLER                  PIC X(5).
  3012
  3013     12  CL-TRAILER-CONTROLS.
  3014         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3015             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3016             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3017             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3018         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3019         16  FILLER                  PIC XX.
  3020         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3021         16  CL-ADDRESS-TRAILER-CNT.
  3022             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3023                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3024             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3025                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3026             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3027                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3028             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3029                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3030             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3031                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3032             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3033                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3034             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3035                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3036
  3037     12  CL-CV-REFERENCE-NO.
  3038         16  CL-CV-REFNO-PRIME       PIC X(18).
  3039         16  CL-CV-REFNO-SFX         PIC XX.
  3040
  3041     12  CL-FILE-LOCATION            PIC X(4).
  3042
  3043     12  CL-PROCESS-ERRORS.
  3044         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3045             88  NO-FATAL-ERRORS        VALUE ZERO.
  3046         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3047             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3048
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  60
* EL152.cbl
  3049     12  CL-PRODUCT-CD               PIC X.
  3050
  3051     12  CL-CURRENT-KEY-DATA.
  3052         16  CL-CURRENT-CARRIER      PIC X.
  3053         16  CL-CURRENT-GROUPING     PIC X(6).
  3054         16  CL-CURRENT-STATE        PIC XX.
  3055         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3056
  3057     12  CL-ASSOCIATES               PIC X.
  3058         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3059         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3060         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3061         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3062
  3063     12  CL-ACTIVITY-CODE            PIC 99.
  3064     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3065     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3066
  3067     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3068     12  CL-LAG-REPORT-CODE          PIC 9.
  3069     12  CL-LOAN-TYPE                PIC XX.
  3070     12  CL-LEGAL-STATE              PIC XX.
  3071
  3072*    12  FILLER                      PIC X(5).
  3073     12  CL-YESNOSW                  PIC X.
  3074     12  FILLER                      PIC X(4).
  3075
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  61
* EL152.cbl
  3077*                                COPY ELCCNTL.
  3078******************************************************************
  3079*                                                                *
  3080*                                                                *
  3081*                            ELCCNTL.                            *
  3082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3083*                            VMOD=2.059                          *
  3084*                                                                *
  3085*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3086*                                                                *
  3087*   FILE TYPE = VSAM,KSDS                                        *
  3088*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3089*                                                                *
  3090*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3091*       ALTERNATE INDEX = NONE                                   *
  3092*                                                                *
  3093*   LOG = YES                                                    *
  3094*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3095******************************************************************
  3096*                   C H A N G E   L O G
  3097*
  3098* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3099*-----------------------------------------------------------------
  3100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3101* EFFECTIVE    NUMBER
  3102*-----------------------------------------------------------------
  3103* 082503                   PEMA  ADD BENEFIT GROUP
  3104* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3105* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3106* 092705    2005050300006  PEMA  ADD SPP LEASES
  3107* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3108* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3109* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3110* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3111* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3112* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3113* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3114* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3115******************************************************************
  3116*
  3117 01  CONTROL-FILE.
  3118     12  CF-RECORD-ID                       PIC XX.
  3119         88  VALID-CF-ID                        VALUE 'CF'.
  3120
  3121     12  CF-CONTROL-PRIMARY.
  3122         16  CF-COMPANY-ID                  PIC XXX.
  3123         16  CF-RECORD-TYPE                 PIC X.
  3124             88  CF-COMPANY-MASTER              VALUE '1'.
  3125             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3126             88  CF-STATE-MASTER                VALUE '3'.
  3127             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3128             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3129             88  CF-CARRIER-MASTER              VALUE '6'.
  3130             88  CF-MORTALITY-MASTER            VALUE '7'.
  3131             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3132             88  CF-TERMINAL-MASTER             VALUE '9'.
  3133             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3134             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  62
* EL152.cbl
  3135             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3136             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3137             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3138             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3139             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3140             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3141             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3142         16  CF-ACCESS-CD-GENL              PIC X(4).
  3143         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3144             20  CF-PROCESSOR               PIC X(4).
  3145         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3146             20  CF-STATE-CODE              PIC XX.
  3147             20  FILLER                     PIC XX.
  3148         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3149             20  FILLER                     PIC XX.
  3150             20  CF-HI-BEN-IN-REC           PIC XX.
  3151         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3152             20  FILLER                     PIC XXX.
  3153             20  CF-CARRIER-CNTL            PIC X.
  3154         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3155             20  FILLER                     PIC XX.
  3156             20  CF-HI-TYPE-IN-REC          PIC 99.
  3157         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3158             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3159                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3160             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3161             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3162         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3163             20  FILLER                     PIC X.
  3164             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3165         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3166             20  FILLER                     PIC XX.
  3167             20  CF-MORTGAGE-PLAN           PIC XX.
  3168         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3169
  3170     12  CF-LAST-MAINT-DT                   PIC XX.
  3171     12  CF-LAST-MAINT-BY                   PIC X(4).
  3172     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3173
  3174     12  CF-RECORD-BODY                     PIC X(728).
  3175
  3176
  3177****************************************************************
  3178*             COMPANY MASTER RECORD                            *
  3179****************************************************************
  3180
  3181     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3182         16  CF-COMPANY-ADDRESS.
  3183             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3184             20  CF-CL-IN-CARE-OF           PIC X(30).
  3185             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3186             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3187             20  CF-CL-CITY-STATE           PIC X(30).
  3188             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3189             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3190         16  CF-COMPANY-CD                  PIC X.
  3191         16  CF-COMPANY-PASSWORD            PIC X(8).
  3192         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  63
* EL152.cbl
  3193             88  ALL-SECURITY                   VALUE '1'.
  3194             88  COMPANY-VERIFY                 VALUE '2'.
  3195             88  PROCESSOR-VERIFY               VALUE '3'.
  3196             88  NO-SECURITY                    VALUE '4'.
  3197             88  ALL-BUT-TERM                   VALUE '5'.
  3198         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3199             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3200         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3201             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3202         16  CF-INFORCE-LOCATION            PIC X.
  3203             88  CERTS-ARE-ONLINE               VALUE '1'.
  3204             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3205             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3206         16  CF-LOWER-CASE-LETTERS          PIC X.
  3207         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3208             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3209             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3210             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3211             88  CF-ACCNT-CNTL                  VALUE '3'.
  3212             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3213
  3214         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3215         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3216
  3217         16  CF-LGX-CREDIT-USER             PIC X.
  3218             88  CO-IS-NOT-USER                 VALUE 'N'.
  3219             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3220
  3221         16 CF-CREDIT-CALC-CODES.
  3222             20  CF-CR-REM-TERM-CALC PIC X.
  3223               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3224               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3225               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3226               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3227               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3228               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3229               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3230             20  CF-CR-R78-METHOD           PIC X.
  3231               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3232               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3233
  3234         16  CF-CLAIM-CONTROL-COUNTS.
  3235             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3236                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3237
  3238             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3239                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3240
  3241             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3242                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3243
  3244             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3245                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3246
  3247         16  CF-CURRENT-MONTH-END           PIC XX.
  3248
  3249         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3250             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  64
* EL152.cbl
  3251             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3252             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3253             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3254                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3255                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3256             20  CF-CO-PREM-REJECT-SW       PIC X.
  3257                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3258                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3259             20  CF-CO-REF-REJECT-SW        PIC X.
  3260                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3261                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3262
  3263         16  CF-CO-REPORTING-DT             PIC XX.
  3264         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3265         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3266           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3267           88  CF-CO-MONTH-END                  VALUE '1'.
  3268
  3269         16  CF-LGX-CLAIM-USER              PIC X.
  3270             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3271             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3272
  3273         16  CF-CREDIT-EDIT-CONTROLS.
  3274             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3275             20  CF-MIN-AGE                 PIC 99.
  3276             20  CF-DEFAULT-AGE             PIC 99.
  3277             20  CF-MIN-TERM                PIC S999      COMP-3.
  3278             20  CF-MAX-TERM                PIC S999      COMP-3.
  3279             20  CF-DEFAULT-SEX             PIC X.
  3280             20  CF-JOINT-AGE-INPUT         PIC X.
  3281                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3282             20  CF-BIRTH-DATE-INPUT        PIC X.
  3283                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3284             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3285                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3286                 88  CF-ZERO-CARRIER            VALUE '1'.
  3287                 88  CF-ZERO-GROUPING           VALUE '2'.
  3288                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3289             20  CF-EDIT-SW                 PIC X.
  3290                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3291             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3292             20  CF-CR-PR-METHOD            PIC X.
  3293               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3294               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3295             20  FILLER                     PIC X.
  3296
  3297         16  CF-CREDIT-MISC-CONTROLS.
  3298             20  CF-REIN-TABLE-SW           PIC X.
  3299                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3300             20  CF-COMP-TABLE-SW           PIC X.
  3301                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3302             20  CF-EXPERIENCE-RETENTION-AGE
  3303                                            PIC S9        COMP-3.
  3304             20  CF-CONVERSION-DT           PIC XX.
  3305             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3306             20  CF-RUN-FREQUENCY-SW        PIC X.
  3307                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3308                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  65
* EL152.cbl
  3309
  3310             20  CF-CR-CHECK-NO-CONTROL.
  3311                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3312                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3313                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3314                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3315                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3316                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3317
  3318                 24  CF-CR-CHECK-COUNT       REDEFINES
  3319                     CF-CR-CHECK-COUNTER      PIC X(4).
  3320
  3321                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3322                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3323
  3324                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3325                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3326                 24  CF-MAIL-PROCESSING       PIC X.
  3327                     88  MAIL-PROCESSING          VALUE 'Y'.
  3328
  3329         16  CF-MISC-SYSTEM-CONTROL.
  3330             20  CF-SYSTEM-C                 PIC X.
  3331                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3332             20  CF-SYSTEM-D                 PIC X.
  3333                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3334             20  CF-SOC-SEC-NO-SW            PIC X.
  3335                 88  SOC-SEC-NO-USED             VALUE '1'.
  3336             20  CF-MEMBER-NO-SW             PIC X.
  3337                 88  MEMBER-NO-USED              VALUE '1'.
  3338             20  CF-TAX-ID-NUMBER            PIC X(11).
  3339             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3340             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3341                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3342                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3343                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3344                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3345             20  CF-SYSTEM-E                 PIC X.
  3346                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3347
  3348         16  CF-LGX-LIFE-USER               PIC X.
  3349             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3350             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3351
  3352         16  CF-CR-MONTH-END-DT             PIC XX.
  3353
  3354         16  CF-FILE-MAINT-DATES.
  3355             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3356                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3357             20  CF-LAST-BATCH       REDEFINES
  3358                 CF-LAST-BATCH-NO               PIC X(4).
  3359             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3360             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3361             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3362             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3363             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3364             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3365             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3366             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  66
* EL152.cbl
  3367             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3368             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3369
  3370         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3371         16  FILLER                         PIC X.
  3372
  3373         16  CF-ALT-MORT-CODE               PIC X(4).
  3374         16  CF-MEMBER-CAPTION              PIC X(10).
  3375
  3376         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3377             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3378             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3379             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3380             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3381             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3382
  3383         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3384
  3385         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3386         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3387         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3388         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3389
  3390         16  CF-AH-OVERRIDE-L1              PIC X.
  3391         16  CF-AH-OVERRIDE-L2              PIC XX.
  3392         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3393         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3394
  3395         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3396         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3397
  3398         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3399         16  CF-AR-LAST-EL860-DT            PIC XX.
  3400         16  CF-MP-MONTH-END-DT             PIC XX.
  3401
  3402         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3403         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3404             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3405
  3406         16  CF-AR-MONTH-END-DT             PIC XX.
  3407
  3408         16  CF-CRDTCRD-USER                PIC X.
  3409             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3410             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3411
  3412         16  CF-CC-MONTH-END-DT             PIC XX.
  3413
  3414         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3415
  3416         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3417             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3418             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3419             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3420         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3421         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3422         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3423         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3424             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  67
* EL152.cbl
  3425             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3426         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3427         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3428         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3429             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3430         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3431
  3432         16  CF-CL-ZIP-CODE.
  3433             20  CF-CL-ZIP-PRIME.
  3434                 24  CF-CL-ZIP-1ST          PIC X.
  3435                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3436                 24  FILLER                 PIC X(4).
  3437             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3438         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3439             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3440             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3441             20  FILLER                     PIC XXX.
  3442
  3443         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3444         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3445         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3446         16  CF-CO-OPTION-START-DATE        PIC XX.
  3447         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3448           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3449                                                      '3' '4'.
  3450           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3451           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3452           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3453           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3454           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3455           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3456
  3457         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3458
  3459         16  CF-PAYMENT-APPROVAL-LEVELS.
  3460             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3461             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3462             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3463             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3464             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3465             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3466
  3467         16  CF-END-USER-REPORTING-USER     PIC X.
  3468             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3469             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3470
  3471         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3472             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3473             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3474
  3475         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3476
  3477         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3478         16  FILLER                         PIC X.
  3479
  3480         16  CF-CREDIT-ARCHIVE-CNTL.
  3481             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3482             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  68
* EL152.cbl
  3483             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3484
  3485         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3486
  3487         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3488             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3489             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3490
  3491         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3492             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3493             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3494
  3495         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3496
  3497         16  CF-CO-ACH-ID-CODE              PIC  X.
  3498             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3499             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3500             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3501         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3502         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3503         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3504         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3505         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3506         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3507         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3508         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3509         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3510                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3511         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3512                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3513
  3514         16  CF-CO-OVER-SHORT.
  3515             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3516             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3517
  3518*         16  FILLER                         PIC X(102).
  3519         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3520             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3521             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3522
  3523         16  CF-AH-APPROVAL-DAYS.
  3524             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3525             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3526             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3527             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3528
  3529         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3530
  3531         16  FILLER                         PIC X(79).
  3532****************************************************************
  3533*             PROCESSOR/USER RECORD                            *
  3534****************************************************************
  3535
  3536     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3537         16  CF-PROCESSOR-NAME              PIC X(30).
  3538         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3539         16  CF-PROCESSOR-TITLE             PIC X(26).
  3540         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  69
* EL152.cbl
  3541                 88  MESSAGE-YES                VALUE 'Y'.
  3542                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3543
  3544*****************************************************
  3545****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3546****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3547****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3548****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3549*****************************************************
  3550
  3551         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3552             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3553             20  CF-APPLICATION-FORCE       PIC X.
  3554             20  CF-INDIVIDUAL-APP.
  3555                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3556                     28  CF-BROWSE-APP      PIC X.
  3557                     28  CF-UPDATE-APP      PIC X.
  3558
  3559         16  CF-CURRENT-TERM-ON             PIC X(4).
  3560         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3561             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3562             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3563             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3564             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3565             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3566             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3567             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3568         16  CF-PROCESSOR-CARRIER           PIC X.
  3569             88  NO-CARRIER-SECURITY            VALUE ' '.
  3570         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3571             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3572         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3573             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3574         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3575             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3576
  3577         16  CF-PROC-SYS-ACCESS-SW.
  3578             20  CF-PROC-CREDIT-CLAIMS-SW.
  3579                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3580                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3581                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3582                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3583             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3584                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3585                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3586             20  CF-PROC-LIFE-GNRLDGR-SW.
  3587                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3588                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3589                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3590                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3591             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3592                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3593                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3594         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3595             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3596             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3597         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3598
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  70
* EL152.cbl
  3599         16  CF-APPROVAL-LEVEL                  PIC X.
  3600             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3601             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3602             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3603             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3604
  3605         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3606
  3607         16  CF-LANGUAGE-TYPE                   PIC X.
  3608             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3609             88  CF-LANG-IS-FR                      VALUE 'F'.
  3610
  3611         16  CF-CSR-IND                         PIC X.
  3612         16  FILLER                             PIC X(239).
  3613
  3614****************************************************************
  3615*             PROCESSOR/REMINDERS RECORD                       *
  3616****************************************************************
  3617
  3618     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3619         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3620             20  CF-START-REMIND-DT         PIC XX.
  3621             20  CF-END-REMIND-DT           PIC XX.
  3622             20  CF-REMINDER-TEXT           PIC X(50).
  3623         16  FILLER                         PIC X(296).
  3624
  3625
  3626****************************************************************
  3627*             STATE MASTER RECORD                              *
  3628****************************************************************
  3629
  3630     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3631         16  CF-STATE-ABBREVIATION          PIC XX.
  3632         16  CF-STATE-NAME                  PIC X(25).
  3633         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3634         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3635             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3636             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3637             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3638             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3639                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3640                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3641             20  CF-ST-PREM-REJECT-SW       PIC X.
  3642                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3643                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3644             20  CF-ST-REF-REJECT-SW        PIC X.
  3645                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3646                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3647         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3648         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3649         16  CF-ST-REFUND-RULES.
  3650             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3651             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3652             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3653         16  CF-ST-FST-PMT-EXTENSION.
  3654             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3655             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3656                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  71
* EL152.cbl
  3657                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3658                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3659                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3660         16  CF-ST-STATE-CALL.
  3661             20  CF-ST-CALL-UNEARNED        PIC X.
  3662             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3663             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3664         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3665             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3666             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3667         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3668         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3669         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3670         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3671         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3672         16  FILLER                         PIC X.
  3673         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3674             20  CF-ST-BENEFIT-CD           PIC XX.
  3675             20  CF-ST-BENEFIT-KIND         PIC X.
  3676                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3677                 88  CF-ST-AH-KIND              VALUE 'A'.
  3678             20  CF-ST-REM-TERM-CALC        PIC X.
  3679                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3680                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3681                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3682                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3683                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3684                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3685                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3686                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3687
  3688             20  CF-ST-REFUND-CALC          PIC X.
  3689                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3690                 88  ST-REFD-BY-R78             VALUE '1'.
  3691                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3692                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3693                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3694                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3695                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3696                 88  ST-REFD-UTAH               VALUE '7'.
  3697                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3698                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3699                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3700
  3701             20  CF-ST-EARNING-CALC         PIC X.
  3702                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3703                 88  ST-EARN-BY-R78             VALUE '1'.
  3704                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3705                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3706                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3707                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3708                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3709                 88  ST-EARN-MEAN               VALUE '8'.
  3710                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3711
  3712             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3713                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3714                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  72
* EL152.cbl
  3715                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3716                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3717                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3718                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3719                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3720                 88  ST-OVRD-MEAN               VALUE '8'.
  3721                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3722             20  FILLER                     PIC X.
  3723
  3724         16  CF-ST-COMMISSION-CAPS.
  3725             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3726             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3727             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3728             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3729         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3730                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3731
  3732         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3733
  3734         16  CF-ST-STATUTORY-INTEREST.
  3735             20  CF-ST-STAT-DATE-FROM       PIC X.
  3736                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3737                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3738             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3739             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3740             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3741             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3742             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3743
  3744         16  CF-ST-OVER-SHORT.
  3745             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3746             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3747
  3748         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3749
  3750         16  CF-ST-RT-CALC                  PIC X.
  3751
  3752         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3753         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3754         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3755         16  CF-ST-RF-LR-CALC               PIC X.
  3756         16  CF-ST-RF-LL-CALC               PIC X.
  3757         16  CF-ST-RF-LN-CALC               PIC X.
  3758         16  CF-ST-RF-AH-CALC               PIC X.
  3759         16  CF-ST-RF-CP-CALC               PIC X.
  3760*        16  FILLER                         PIC X(206).
  3761*CIDMOD         16  FILLER                         PIC X(192).
  3762         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3763             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3764         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3765         16  CF-ST-VFY-2ND-BENE             PIC X.
  3766         16  CF-ST-CAUSAL-STATE             PIC X.
  3767         16  FILLER                         PIC X(185).
  3768
  3769****************************************************************
  3770*             BENEFIT MASTER RECORD                            *
  3771****************************************************************
  3772
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  73
* EL152.cbl
  3773     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3774         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3775             20  CF-BENEFIT-CODE            PIC XX.
  3776             20  CF-BENEFIT-NUMERIC  REDEFINES
  3777                 CF-BENEFIT-CODE            PIC XX.
  3778             20  CF-BENEFIT-ALPHA           PIC XXX.
  3779             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3780             20  CF-BENEFIT-COMMENT         PIC X(10).
  3781
  3782             20  CF-LF-COVERAGE-TYPE        PIC X.
  3783                 88  CF-REDUCING                VALUE 'R'.
  3784                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3785
  3786             20  CF-SPECIAL-CALC-CD         PIC X.
  3787                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3788                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3789                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3790                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3791                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3792                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3793                 88  CF-FARM-PLAN               VALUE 'F'.
  3794                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3795                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3796                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3797                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3798                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3799                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3800                 88  CF-PRUDENTIAL              VALUE 'P'.
  3801                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3802                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3803                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3804                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3805                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3806                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3807
  3808             20  CF-JOINT-INDICATOR         PIC X.
  3809                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3810
  3811*            20  FILLER                     PIC X(12).
  3812             20  FILLER                     PIC X(11).
  3813             20  CF-BENEFIT-CATEGORY        PIC X.
  3814             20  CF-LOAN-TYPE               PIC X(8).
  3815
  3816             20  CF-CO-REM-TERM-CALC        PIC X.
  3817                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3818                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3819                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3820                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3821                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3822
  3823             20  CF-CO-EARNINGS-CALC        PIC X.
  3824                 88  CO-EARN-BY-R78             VALUE '1'.
  3825                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3826                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3827                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3828                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3829                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3830                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  74
* EL152.cbl
  3831                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3832
  3833             20  CF-CO-REFUND-CALC          PIC X.
  3834                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3835                 88  CO-REFD-BY-R78             VALUE '1'.
  3836                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3837                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3838                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3839                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3840                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3841                 88  CO-REFD-MEAN               VALUE '8'.
  3842                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3843                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3844                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3845
  3846             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3847                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3848                 88  CO-OVRD-BY-R78             VALUE '1'.
  3849                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3850                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3851                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3852                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3853                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3854                 88  CO-OVRD-MEAN               VALUE '8'.
  3855                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3856
  3857             20  CF-CO-BEN-I-G-CD           PIC X.
  3858                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3859                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3860                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3861
  3862         16  FILLER                         PIC X(304).
  3863
  3864
  3865****************************************************************
  3866*             CARRIER MASTER RECORD                            *
  3867****************************************************************
  3868
  3869     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3870         16  CF-ADDRESS-DATA.
  3871             20  CF-MAIL-TO-NAME            PIC X(30).
  3872             20  CF-IN-CARE-OF              PIC X(30).
  3873             20  CF-ADDRESS-LINE-1          PIC X(30).
  3874             20  CF-ADDRESS-LINE-2          PIC X(30).
  3875             20  CF-CITY-STATE              PIC X(30).
  3876             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3877             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3878
  3879         16  CF-CLAIM-NO-CONTROL.
  3880             20  CF-CLAIM-NO-METHOD         PIC X.
  3881                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3882                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3883                 88  CLAIM-NO-SEQ               VALUE '3'.
  3884                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3885             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3886                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3887                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3888                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  75
* EL152.cbl
  3889
  3890         16  CF-CHECK-NO-CONTROL.
  3891             20  CF-CHECK-NO-METHOD         PIC X.
  3892                 88  CHECK-NO-MANUAL            VALUE '1'.
  3893                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3894                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3895                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3896             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3897                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3898
  3899         16  CF-DOMICILE-STATE              PIC XX.
  3900
  3901         16  CF-EXPENSE-CONTROLS.
  3902             20  CF-EXPENSE-METHOD          PIC X.
  3903                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3904                 88  DOLLARS-PER-PMT            VALUE '2'.
  3905                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3906                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3907             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3908             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3909
  3910         16  CF-CORRESPONDENCE-CONTROL.
  3911             20  CF-LETTER-RESEND-OPT       PIC X.
  3912                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3913                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3914             20  FILLER                     PIC X(4).
  3915
  3916         16  CF-RESERVE-CONTROLS.
  3917             20  CF-MANUAL-SW               PIC X.
  3918                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3919             20  CF-FUTURE-SW               PIC X.
  3920                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3921             20  CF-PTC-SW                  PIC X.
  3922                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3923             20  CF-IBNR-SW                 PIC X.
  3924                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3925             20  CF-PTC-LF-SW               PIC X.
  3926                 88  CF-LF-PTC-USED             VALUE '1'.
  3927             20  CF-CDT-ACCESS-METHOD       PIC X.
  3928                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3929                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3930                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3931             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3932
  3933         16  CF-CLAIM-CALC-METHOD           PIC X.
  3934             88  360-PLUS-MONTHS                VALUE '1'.
  3935             88  365-PLUS-MONTHS                VALUE '2'.
  3936             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3937             88  360-DAILY                      VALUE '4'.
  3938             88  365-DAILY                      VALUE '5'.
  3939
  3940         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3941         16  FILLER                         PIC X(11).
  3942
  3943         16  CF-LIMIT-AMOUNTS.
  3944             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3945             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3946             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  76
* EL152.cbl
  3947             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3948             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3949             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3950             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3951             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3952             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3953             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3954
  3955         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3956         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3957         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3958
  3959         16  CF-ZIP-CODE.
  3960             20  CF-ZIP-PRIME.
  3961                 24  CF-ZIP-1ST             PIC X.
  3962                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3963                 24  FILLER                 PIC X(4).
  3964             20  CF-ZIP-PLUS4               PIC X(4).
  3965         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3966             20  CF-CAN-POSTAL-1            PIC XXX.
  3967             20  CF-CAN-POSTAL-2            PIC XXX.
  3968             20  FILLER                     PIC XXX.
  3969
  3970         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3971         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3972         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3973
  3974         16  CF-RATING-SWITCH               PIC X.
  3975             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3976             88  CF-NO-RATING                   VALUE 'N'.
  3977
  3978         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3979
  3980         16  CF-CARRIER-OVER-SHORT.
  3981             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3982             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3983
  3984         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3985         16  CF-SECPAY-SWITCH               PIC X.
  3986             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3987             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3988         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3989         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3990         16  FILLER                         PIC X(444).
  3991*        16  FILLER                         PIC X(452).
  3992
  3993
  3994****************************************************************
  3995*             MORTALITY MASTER RECORD                          *
  3996****************************************************************
  3997
  3998     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3999         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4000                                INDEXED BY CF-MORT-NDX.
  4001             20  CF-MORT-TABLE              PIC X(5).
  4002             20  CF-MORT-TABLE-TYPE         PIC X.
  4003                 88  CF-MORT-JOINT              VALUE 'J'.
  4004                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  77
* EL152.cbl
  4005                 88  CF-MORT-COMBINED           VALUE 'C'.
  4006                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4007                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4008             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4009             20  CF-MORT-AGE-METHOD         PIC XX.
  4010                 88  CF-AGE-LAST                VALUE 'AL'.
  4011                 88  CF-AGE-NEAR                VALUE 'AN'.
  4012             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4013             20  CF-MORT-ADJUSTMENT-DIRECTION
  4014                                            PIC X.
  4015                 88  CF-MINUS                   VALUE '-'.
  4016                 88  CF-PLUS                    VALUE '+'.
  4017             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4018             20  CF-MORT-JOINT-CODE         PIC X.
  4019                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4020             20  CF-MORT-PC-Q               PIC X.
  4021                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4022             20  CF-MORT-TABLE-CODE         PIC X(4).
  4023             20  CF-MORT-COMMENTS           PIC X(15).
  4024             20  FILLER                     PIC X(14).
  4025
  4026         16  FILLER                         PIC X(251).
  4027
  4028
  4029****************************************************************
  4030*             BUSSINESS TYPE MASTER RECORD                     *
  4031****************************************************************
  4032
  4033     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4034* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4035* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4036* AND RECORD 05 IS TYPES 81-99
  4037         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4038             20  CF-BUSINESS-TITLE          PIC  X(19).
  4039             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4040                                            PIC S9V9(4) COMP-3.
  4041             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4042             20  FILLER                     PIC  X.
  4043         16  FILLER                         PIC  X(248).
  4044
  4045
  4046****************************************************************
  4047*             TERMINAL MASTER RECORD                           *
  4048****************************************************************
  4049
  4050     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4051
  4052         16  CF-COMPANY-TERMINALS.
  4053             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4054                                  PIC X(4).
  4055         16  FILLER               PIC X(248).
  4056
  4057
  4058****************************************************************
  4059*             LIFE EDIT MASTER RECORD                          *
  4060****************************************************************
  4061
  4062     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  78
* EL152.cbl
  4063         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4064             20  CF-LIFE-CODE-IN            PIC XX.
  4065             20  CF-LIFE-CODE-OUT           PIC XX.
  4066         16  FILLER                         PIC X(248).
  4067
  4068
  4069****************************************************************
  4070*             AH EDIT MASTER RECORD                            *
  4071****************************************************************
  4072
  4073     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4074         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4075             20  CF-AH-CODE-IN              PIC XXX.
  4076             20  CF-AH-CODE-OUT             PIC XX.
  4077         16  FILLER                         PIC X(248).
  4078
  4079
  4080****************************************************************
  4081*             CREDIBILITY TABLES                               *
  4082****************************************************************
  4083
  4084     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4085         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4086                             INDEXED BY CF-CRDB-NDX.
  4087             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4088             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4089             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4090         16  FILLER                         PIC  X(332).
  4091
  4092
  4093****************************************************************
  4094*             REPORT CUSTOMIZATION RECORD                      *
  4095****************************************************************
  4096
  4097     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4098         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4099             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4100             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4101             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4102**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4103****       A T-TRANSFER.                                   ****
  4104             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4105
  4106         16  FILLER                         PIC XX.
  4107
  4108         16  CF-CARRIER-CNTL-OPT.
  4109             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4110                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4111                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4112             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4113                                            PIC X.
  4114         16  CF-GROUP-CNTL-OPT.
  4115             20  CF-GROUP-OPT-SEQ           PIC 9.
  4116                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4117                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4118             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4119                                            PIC X(6).
  4120         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  79
* EL152.cbl
  4121             20  CF-STATE-OPT-SEQ           PIC 9.
  4122                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4123                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4124             20  CF-STATE-SELECT OCCURS 3 TIMES
  4125                                            PIC XX.
  4126         16  CF-ACCOUNT-CNTL-OPT.
  4127             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4128                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4129                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4130             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4131                                            PIC X(10).
  4132         16  CF-BUS-TYP-CNTL-OPT.
  4133             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4134                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4135                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4136             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4137                                            PIC XX.
  4138         16  CF-LF-TYP-CNTL-OPT.
  4139             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4140                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4141                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4142             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4143                                            PIC XX.
  4144         16  CF-AH-TYP-CNTL-OPT.
  4145             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4146                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4147                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4148             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4149                                            PIC XX.
  4150         16  CF-REPTCD1-CNTL-OPT.
  4151             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4152                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4153                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4154             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4155                                            PIC X(10).
  4156         16  CF-REPTCD2-CNTL-OPT.
  4157             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4158                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4159                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4160             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4161                                            PIC X(10).
  4162         16  CF-USER1-CNTL-OPT.
  4163             20  CF-USER1-OPT-SEQ           PIC 9.
  4164                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4165                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4166             20  CF-USER1-SELECT OCCURS 3 TIMES
  4167                                            PIC X(10).
  4168         16  CF-USER2-CNTL-OPT.
  4169             20  CF-USER2-OPT-SEQ           PIC 9.
  4170                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4171                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4172             20  CF-USER2-SELECT OCCURS 3 TIMES
  4173                                            PIC X(10).
  4174         16  CF-USER3-CNTL-OPT.
  4175             20  CF-USER3-OPT-SEQ           PIC 9.
  4176                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4177                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4178             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  80
* EL152.cbl
  4179                                            PIC X(10).
  4180         16  CF-USER4-CNTL-OPT.
  4181             20  CF-USER4-OPT-SEQ           PIC 9.
  4182                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4183                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4184             20  CF-USER4-SELECT OCCURS 3 TIMES
  4185                                            PIC X(10).
  4186         16  CF-USER5-CNTL-OPT.
  4187             20  CF-USER5-OPT-SEQ           PIC 9.
  4188                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4189                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4190             20  CF-USER5-SELECT OCCURS 3 TIMES
  4191                                            PIC X(10).
  4192         16  CF-REINS-CNTL-OPT.
  4193             20  CF-REINS-OPT-SEQ           PIC 9.
  4194                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4195                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4196             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4197                 24  CF-REINS-PRIME         PIC XXX.
  4198                 24  CF-REINS-SUB           PIC XXX.
  4199
  4200         16  CF-AGENT-CNTL-OPT.
  4201             20  CF-AGENT-OPT-SEQ           PIC 9.
  4202                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4203                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4204             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4205                                            PIC X(10).
  4206
  4207         16  FILLER                         PIC X(43).
  4208
  4209         16  CF-LOSS-RATIO-SELECT.
  4210             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4211             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4212         16  CF-ENTRY-DATE-SELECT.
  4213             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4214             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4215         16  CF-EFFECTIVE-DATE-SELECT.
  4216             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4217             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4218
  4219         16  CF-EXCEPTION-LIST-IND          PIC X.
  4220             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4221
  4222         16  FILLER                         PIC X(318).
  4223
  4224****************************************************************
  4225*                  EXCEPTION REPORTING RECORD                  *
  4226****************************************************************
  4227
  4228     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4229         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4230             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4231
  4232         16  CF-COMBINED-LIFE-AH-OPT.
  4233             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4234             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4235             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4236             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  81
* EL152.cbl
  4237
  4238         16  CF-LIFE-OPT.
  4239             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4240             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4241             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4242             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4243             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4244             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4245             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4246             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4247             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4248             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4249
  4250         16  CF-AH-OPT.
  4251             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4252             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4253             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4254             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4255             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4256             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4257             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4258             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4259             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4260             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4261
  4262         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4263             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4264             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4265             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4266
  4267         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4268
  4269         16  FILLER                         PIC X(673).
  4270
  4271
  4272****************************************************************
  4273*             MORTGAGE SYSTEM PLAN RECORD                      *
  4274****************************************************************
  4275
  4276     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4277         16  CF-PLAN-TYPE                   PIC X.
  4278             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4279             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4280             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4281         16  CF-PLAN-ABBREV                 PIC XXX.
  4282         16  CF-PLAN-DESCRIPT               PIC X(10).
  4283         16  CF-PLAN-NOTES                  PIC X(20).
  4284         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4285         16  CF-PLAN-UNDERWRITING.
  4286             20  CF-PLAN-TERM-DATA.
  4287                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4288                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4289             20  CF-PLAN-AGE-DATA.
  4290                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4291                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4292                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4293             20  CF-PLAN-BENEFIT-DATA.
  4294                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  82
* EL152.cbl
  4295                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4296                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4297                                            PIC S9(7)V99  COMP-3.
  4298         16  CF-PLAN-POLICY-FORMS.
  4299             20  CF-POLICY-FORM             PIC X(12).
  4300             20  CF-MASTER-APPLICATION      PIC X(12).
  4301             20  CF-MASTER-POLICY           PIC X(12).
  4302         16  CF-PLAN-RATING.
  4303             20  CF-RATE-CODE               PIC X(5).
  4304             20  CF-SEX-RATING              PIC X.
  4305                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4306                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4307             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4308             20  CF-SUB-STD-TYPE            PIC X.
  4309                 88  CF-PCT-OF-PREM            VALUE '1'.
  4310                 88  CF-PCT-OF-BENE            VALUE '2'.
  4311         16  CF-PLAN-PREM-TOLERANCES.
  4312             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4313             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4314         16  CF-PLAN-PYMT-TOLERANCES.
  4315             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4316             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4317         16  CF-PLAN-MISC-DATA.
  4318             20  FILLER                     PIC X.
  4319             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4320             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4321         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4322         16  CF-PLAN-IND-GRP                PIC X.
  4323             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4324                                                     '1'.
  4325             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4326                                                     '2'.
  4327         16  CF-MIB-SEARCH-SW               PIC X.
  4328             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4329             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4330             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4331             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4332         16  CF-ALPHA-SEARCH-SW             PIC X.
  4333             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4334             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4335             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4336             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4337             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4338             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4339             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4340             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4341             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4342             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4343                                                     'A' 'B' 'C'
  4344                                                     'X' 'Y' 'Z'.
  4345         16  CF-EFF-DT-RULE-SW              PIC X.
  4346             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4347             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4348             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4349             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4350             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4351         16  FILLER                         PIC X(4).
  4352         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  83
* EL152.cbl
  4353             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4354         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4355         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4356         16  CF-PLAN-SNGL-JNT               PIC X.
  4357             88  CF-COMBINED-PLAN              VALUE 'C'.
  4358             88  CF-JNT-PLAN                   VALUE 'J'.
  4359             88  CF-SNGL-PLAN                  VALUE 'S'.
  4360         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4361         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4362         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4363         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4364         16  CF-RERATE-CNTL                 PIC  X.
  4365             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4366             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4367             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4368             88  CF-AUTO-RECALC                 VALUE '4'.
  4369         16  CF-BENEFIT-TYPE                PIC  X.
  4370             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4371             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4372         16  CF-POLICY-FEE                  PIC S999V99
  4373                                                    COMP-3.
  4374         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4375         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4376         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4377         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4378         16  FILLER                         PIC  X(32).
  4379         16  CF-TERMINATION-FORM            PIC  X(04).
  4380         16  FILLER                         PIC  X(08).
  4381         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4382                                                       COMP-3.
  4383         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4384         16  CF-ISSUE-LETTER                PIC  X(4).
  4385         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4386         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4387             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4388             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4389         16  CF-MP-REFUND-CALC              PIC X.
  4390             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4391             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4392             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4393             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4394             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4395             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4396             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4397             88  CF-MP-REFD-MEAN                VALUE '8'.
  4398         16  CF-ALT-RATE-CODE               PIC  X(5).
  4399
  4400
  4401         16  FILLER                         PIC X(498).
  4402****************************************************************
  4403*             MORTGAGE COMPANY MASTER RECORD                   *
  4404****************************************************************
  4405
  4406     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4407         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4408         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4409             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4410             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  84
* EL152.cbl
  4411             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4412             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4413             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4414
  4415         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4416         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4417         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4418         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4419         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4420
  4421         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4422             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4423         16  CF-MP-RECON-USE-IND            PIC X(1).
  4424             88  CF-MP-USE-RECON             VALUE 'Y'.
  4425         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4426             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4427         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4428             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4429             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4430         16  FILLER                         PIC X(1).
  4431         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4432             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4433         16  CF-MORTG-MIB-VERSION           PIC X.
  4434             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4435             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4436             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4437         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4438             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4439                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4440             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4441                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4442             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4443                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4444             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4445                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4446             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4447                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4448             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4449                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4450         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4451         16  FILLER                         PIC X(7).
  4452         16  CF-MORTG-DESTINATION-SYMBOL.
  4453             20  CF-MORTG-MIB-COMM          PIC X(5).
  4454             20  CF-MORTG-MIB-TERM          PIC X(5).
  4455         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4456             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4457         16  FILLER                         PIC X(03).
  4458         16  CF-MP-CHECK-NO-CONTROL.
  4459             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4460                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4461                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4462                                                ' ' LOW-VALUES.
  4463                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4464                                               VALUE '3'.
  4465         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4466         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4467         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4468             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  85
* EL152.cbl
  4469                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4470             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4471                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4472             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4473                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4474             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4475                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4476             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4477                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4478             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4479                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4480         16  CF-MORTG-BILLING-AREA.
  4481             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4482                                            PIC X.
  4483         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4484         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4485         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4486         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4487             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4488             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4489         16  FILLER                         PIC X.
  4490         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4491             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4492             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4493         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4494         16  FILLER                         PIC X(8).
  4495         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4496         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4497         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4498         16  CF-ACH-COMPANY-ID.
  4499             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4500                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4501                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4502                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4503             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4504         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4505             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4506         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4507             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4508             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4509         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4510         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4511         16  FILLER                         PIC X(536).
  4512
  4513****************************************************************
  4514*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4515****************************************************************
  4516
  4517     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4518         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4519             20  CF-FEMALE-HEIGHT.
  4520                 24  CF-FEMALE-FT           PIC 99.
  4521                 24  CF-FEMALE-IN           PIC 99.
  4522             20  CF-FEMALE-MIN-WT           PIC 999.
  4523             20  CF-FEMALE-MAX-WT           PIC 999.
  4524         16  FILLER                         PIC X(428).
  4525
  4526     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  86
* EL152.cbl
  4527         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4528             20  CF-MALE-HEIGHT.
  4529                 24  CF-MALE-FT             PIC 99.
  4530                 24  CF-MALE-IN             PIC 99.
  4531             20  CF-MALE-MIN-WT             PIC 999.
  4532             20  CF-MALE-MAX-WT             PIC 999.
  4533         16  FILLER                         PIC X(428).
  4534******************************************************************
  4535*             AUTOMATIC ACTIVITY RECORD                          *
  4536******************************************************************
  4537     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4538         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4539             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4540             20  CF-SYS-LETTER-ID           PIC X(04).
  4541             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4542             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4543             20  CF-SYS-RESET-SW            PIC X(01).
  4544             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4545             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4546
  4547         16  FILLER                         PIC X(50).
  4548
  4549         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4550             20  CF-USER-ACTIVE-SW          PIC X(01).
  4551             20  CF-USER-LETTER-ID          PIC X(04).
  4552             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4553             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4554             20  CF-USER-RESET-SW           PIC X(01).
  4555             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4556             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4557             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4558
  4559         16  FILLER                         PIC X(246).
  4560
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  87
* EL152.cbl
  4562*                                COPY ELCARCH.
  4563******************************************************************
  4564*                                                                *
  4565*                            ELCARCH.                            *
  4566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4567*                            VMOD=2.007                          *
  4568*                                                                *
  4569*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4570*                                                                *
  4571*   FILE TYPE = VSAM,KSDS                                        *
  4572*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4573*                                                                *
  4574*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  4575*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  4576*                                                                *
  4577*   LOG = NO                                                     *
  4578*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4579*                                                                *
  4580*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  4581******************************************************************
  4582 01  LETTER-ARCHIVE.
  4583     12  LA-RECORD-ID                PIC XX.
  4584         88  VALID-LA-ID                VALUE 'LA'.
  4585
  4586     12  LA-CONTROL-PRIMARY.
  4587         16  LA-COMPANY-CD           PIC X.
  4588         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  4589         16  LA-RECORD-TYPE          PIC X.
  4590             88  LA-HEADER-DATA         VALUE '1'.
  4591             88  LA-ADDRESS-DATA        VALUE '2'.
  4592             88  LA-TEXT-DATA           VALUE '3'.
  4593             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  4594         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  4595
  4596     12  LA-CONTROL-BY-TYPE.
  4597         16  LA-COMPANY-CD-A1        PIC X.
  4598         16  LA-RECORD-TYPE-A1       PIC X.
  4599         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4600         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4601
  4602     12  LA-TEXT-RECORD.
  4603         16  LA-SKIP-CONTROL         PIC XX.
  4604             88  NO-LINES-SKIPPED       VALUE SPACES.
  4605             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  4606         16  LA-TEXT-LINE            PIC X(70).
  4607
  4608     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  4609         16  FILLER                  PIC XX.
  4610         16  LA-ADDRESS-LINE         PIC X(30).
  4611         16  FILLER                  PIC X(40).
  4612
  4613     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  4614         16  FILLER                  PIC XX.
  4615         16  LA-CARRIER              PIC X.
  4616         16  LA-CLAIM-NO             PIC X(7).
  4617         16  LA-CERT-NO.
  4618             20  LA-CERT-PRIME       PIC X(10).
  4619             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  88
* EL152.cbl
  4620         16  LA-NO-OF-COPIES         PIC S9.
  4621         16  LA-RESEND-DATE          PIC XX.
  4622         16  LA-PROCESSOR-CD         PIC X(4).
  4623         16  LA-CREATION-DT          PIC XX.
  4624         16  LA-INITIAL-PRINT-DATE   PIC XX.
  4625         16  LA-RESEND-PRINT-DATE    PIC XX.
  4626         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4627         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  4628*
  4629* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  4630*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  4631*   I        20  LA-DMD-PROD-CODE        PIC XX.
  4632*   I        20  LA-DMD-RES-ST           PIC XX.
  4633*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4634*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  4635*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  4636*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  4637*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  4638*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  4639*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  4640*   I        20  LA-DMD-UND-CODE         PIC XX.
  4641*   I        20  LA-DMD-BEN-CODE         PIC XX.
  4642*   V    16  FILLER                  PIC X(15).
  4643* -----
  4644*
  4645* REINSERTED  CSO  MODS
  4646*
  4647         16  FILLER.
  4648             20  FILLER                  PIC X(29).
  4649             20  LA-CSO-LETTER-STATUS    PIC X.
  4650                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  4651                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  4652                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  4653             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  4654             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  4655*
  4656
  4657     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  4658         16  FILLER                  PIC XX.
  4659         16  LA4-CARRIER             PIC X.
  4660         16  LA4-CLAIM-NO            PIC X(7).
  4661         16  LA4-CERT-NO.
  4662             20  LA4-CERT-PRIME      PIC X(10).
  4663             20  LA4-CERT-SFX        PIC X.
  4664         16  LA4-NO-OF-COPIES        PIC S9.
  4665         16  LA4-RESEND-DATE         PIC XX.
  4666         16  LA4-PROCESSOR-CD        PIC X(4).
  4667         16  LA4-CREATION-DT         PIC XX.
  4668         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  4669         16  LA4-RESEND-PRINT-DATE   PIC XX.
  4670         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4671         16  LA4-FORM-TYPE           PIC X.
  4672             88  LA4-INITIAL-FORM    VALUE '1'.
  4673             88  LA4-PROGRESS-FORM   VALUE '2'.
  4674         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  4675         16  LA4-STATE               PIC X(02).
  4676         16  FILLER                  PIC X(31).
  4677******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  89
* EL152.cbl
  4678
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  90
* EL152.cbl
  4680*                                COPY ELCARCT.
  4681******************************************************************
  4682*                                                                *
  4683*                            ELCARCT.                            *
  4684*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4685*                            VMOD=2.003                          *
  4686*                                                                *
  4687*   FILE DESCRIPTION = TEMPORARY LETTER ARCHIVE FILE             *
  4688*                                                                *
  4689*   FILE TYPE = VSAM,KSDS                                        *
  4690*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4691*                                                                *
  4692*   BASE CLUSTER = ELARCT                        RKP=2,LEN=8     *
  4693*       ALTERNATE PATH1 = ELARCT2  (RECORD TYPE) RKP=10,LEN=8    *
  4694*                                                                *
  4695*   LOG = NO                                                     *
  4696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4697*                                                                *
  4698*  NO  CID  MODS  IN  COPYBOOK  ELCARCT                          *
  4699******************************************************************
  4700 01  LETTER-ARCHIVE-TEMP.
  4701     12  LT-RECORD-ID                PIC XX.
  4702         88  VALID-LT-ID                VALUE 'LT'.
  4703
  4704     12  LT-CONTROL-PRIMARY.
  4705         16  LT-COMPANY-CD           PIC X.
  4706         16  LT-ARCHIVE-NO           PIC S9(8)     COMP.
  4707         16  LT-RECORD-TYPE          PIC X.
  4708             88  LT-HEADER-DATA         VALUE '1'.
  4709             88  LT-ADDRESS-DATA        VALUE '2'.
  4710             88  LT-TEXT-DATA           VALUE '3'.
  4711             88  LT-FORM-CONTROL-HDR    VALUE '4'.
  4712         16  LT-LINE-SEQ-NO          PIC S9(4)     COMP.
  4713
  4714     12  LT-CONTROL-BY-TYPE.
  4715         16  LT-COMPANY-CD-A1        PIC X.
  4716         16  LT-RECORD-TYPE-A1       PIC X.
  4717         16  LT-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4718         16  LT-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4719
  4720     12  LT-TEXT-RECORD.
  4721         16  LT-SKIP-CONTROL         PIC XX.
  4722         16  LT-TEXT-LINE            PIC X(70).
  4723
  4724     12  LT-ADDRESS-RECORD  REDEFINES  LT-TEXT-RECORD.
  4725         16  FILLER                  PIC XX.
  4726         16  LT-ADDRESS-LINE         PIC X(30).
  4727         16  FILLER                  PIC X(40).
  4728
  4729     12  LT-HEADER-RECORD  REDEFINES  LT-TEXT-RECORD.
  4730         16  FILLER                  PIC XX.
  4731         16  LT-CARRIER              PIC X.
  4732         16  LT-CLAIM-NO             PIC X(7).
  4733         16  LT-CERT-NO.
  4734             20  LT-CERT-PRIME       PIC X(10).
  4735             20  LT-CERT-SFX         PIC X.
  4736         16  LT-NO-OF-COPIES         PIC S9.
  4737         16  LT-RESEND-DATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  91
* EL152.cbl
  4738         16  LT-PROCESSOR-CD         PIC X(4).
  4739         16  LT-CREATION-DT          PIC XX.
  4740         16  LT-INITIAL-PRINT-DATE   PIC XX.
  4741         16  LT-RESEND-PRINT-DATE    PIC XX.
  4742         16  LT-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4743         16  LT-1ST-RESEND-PRINT-DT  PIC XX.
  4744         16  LT-DMD-ADDITIONAL-FIELDS.
  4745             20  LT-DMD-LETTER-FORM      PIC X(4).
  4746             20  LT-DMD-PROD-CODE        PIC XX.
  4747             20  LT-DMD-RES-ST           PIC XX.
  4748             20  LT-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4749             20  LT-DMD-LETTER-STATUS    PIC X.
  4750                 88  LT-DMD-LETTER-ONLINE   VALUE '1'.
  4751                 88  LT-DMD-LETTER-PURGED   VALUE '2'.
  4752                 88  LT-DMD-LETTER-RELOADED VALUE '3'.
  4753             20  LT-DMD-LETTER-PURGE-DT  PIC XX.
  4754             20  LT-DMD-LETTER-RELOAD-DT PIC XX.
  4755             20  LT-DMD-UND-CODE         PIC XX.
  4756             20  LT-DMD-BEN-CODE         PIC XX.
  4757         16  FILLER                  PIC X(15).
  4758
  4759     12  LT-FORM-CONTROL-HEADER REDEFINES  LT-TEXT-RECORD.
  4760         16  FILLER                  PIC XX.
  4761         16  LT4-CARRIER             PIC X.
  4762         16  LT4-CLAIM-NO            PIC X(7).
  4763         16  LT4-CERT-NO.
  4764             20  LT4-CERT-PRIME      PIC X(10).
  4765             20  LT4-CERT-SFX        PIC X.
  4766         16  LT4-NO-OF-COPIES        PIC S9.
  4767         16  LT4-RESEND-DATE         PIC XX.
  4768         16  LT4-PROCESSOR-CD        PIC X(4).
  4769         16  LT4-CREATION-DT         PIC XX.
  4770         16  LT4-INITIAL-PRINT-DATE  PIC XX.
  4771         16  LT4-RESEND-PRINT-DATE   PIC XX.
  4772         16  LT4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4773         16  LT4-FORM-TYPE           PIC X.
  4774             88  LT4-INITIAL-FORM    VALUE '1'.
  4775             88  LT4-PROGRESS-FORM   VALUE '2'.
  4776         16  LT4-FORM-REM-PRINT-DT   PIC XX.
  4777         16  LT4-STATE               PIC XX.
  4778         16  FILLER                  PIC X(31).
  4779******************************************************************
  4780
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  92
* EL152.cbl
  4782*                                COPY ELCCERT.
  4783******************************************************************
  4784*                                                                *
  4785*                            ELCCERT.                            *
  4786*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4787*                            VMOD=2.013                          *
  4788*                                                                *
  4789*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4790*                                                                *
  4791*   FILE TYPE = VSAM,KSDS                                        *
  4792*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4793*                                                                *
  4794*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4795*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4796*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4797*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4798*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4799*                                                                *
  4800*   LOG = YES                                                    *
  4801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4802******************************************************************
  4803*                   C H A N G E   L O G
  4804*
  4805* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4806*-----------------------------------------------------------------
  4807*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4808* EFFECTIVE    NUMBER
  4809*-----------------------------------------------------------------
  4810* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4811* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4812* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4813* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4814* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4815* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4816* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4817* 032612  CR2011110200001  PEMA  AHL CHANGES
  4818******************************************************************
  4819
  4820 01  CERTIFICATE-MASTER.
  4821     12  CM-RECORD-ID                      PIC XX.
  4822         88  VALID-CM-ID                      VALUE 'CM'.
  4823
  4824     12  CM-CONTROL-PRIMARY.
  4825         16  CM-COMPANY-CD                 PIC X.
  4826         16  CM-CARRIER                    PIC X.
  4827         16  CM-GROUPING.
  4828             20  CM-GROUPING-PREFIX        PIC X(3).
  4829             20  CM-GROUPING-PRIME         PIC X(3).
  4830         16  CM-STATE                      PIC XX.
  4831         16  CM-ACCOUNT.
  4832             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4833             20  CM-ACCOUNT-PRIME          PIC X(6).
  4834         16  CM-CERT-EFF-DT                PIC XX.
  4835         16  CM-CERT-NO.
  4836             20  CM-CERT-PRIME             PIC X(10).
  4837             20  CM-CERT-SFX               PIC X.
  4838
  4839     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  93
* EL152.cbl
  4840         16  CM-COMPANY-CD-A1              PIC X.
  4841         16  CM-INSURED-LAST-NAME          PIC X(15).
  4842         16  CM-INSURED-INITIALS.
  4843             20  CM-INSURED-INITIAL1       PIC X.
  4844             20  CM-INSURED-INITIAL2       PIC X.
  4845
  4846     12  CM-CONTROL-BY-SSN.
  4847         16  CM-COMPANY-CD-A2              PIC X.
  4848         16  CM-SOC-SEC-NO.
  4849             20  CM-SSN-STATE              PIC XX.
  4850             20  CM-SSN-ACCOUNT            PIC X(6).
  4851             20  CM-SSN-LN3.
  4852                 25  CM-INSURED-INITIALS-A2.
  4853                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4854                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4855                 25 CM-PART-LAST-NAME-A2         PIC X.
  4856
  4857     12  CM-CONTROL-BY-CERT-NO.
  4858         16  CM-COMPANY-CD-A4              PIC X.
  4859         16  CM-CERT-NO-A4                 PIC X(11).
  4860
  4861     12  CM-CONTROL-BY-MEMB.
  4862         16  CM-COMPANY-CD-A5              PIC X.
  4863         16  CM-MEMBER-NO.
  4864             20  CM-MEMB-STATE             PIC XX.
  4865             20  CM-MEMB-ACCOUNT           PIC X(6).
  4866             20  CM-MEMB-LN4.
  4867                 25  CM-INSURED-INITIALS-A5.
  4868                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4869                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4870                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4871
  4872     12  CM-INSURED-PROFILE-DATA.
  4873         16  CM-INSURED-FIRST-NAME.
  4874             20  CM-INSURED-1ST-INIT       PIC X.
  4875             20  FILLER                    PIC X(9).
  4876         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4877         16  CM-INSURED-SEX                PIC X.
  4878             88  CM-SEX-MALE                  VALUE 'M'.
  4879             88  CM-SEX-FEMAL                 VALUE 'F'.
  4880         16  CM-INSURED-JOINT-AGE          PIC 99.
  4881         16  CM-JOINT-INSURED-NAME.
  4882             20  CM-JT-LAST-NAME           PIC X(15).
  4883             20  CM-JT-FIRST-NAME.
  4884                 24  CM-JT-1ST-INIT        PIC X.
  4885                 24  FILLER                PIC X(9).
  4886             20  CM-JT-INITIAL             PIC X.
  4887
  4888     12  CM-LIFE-DATA.
  4889         16  CM-LF-BENEFIT-CD              PIC XX.
  4890         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4891         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4892         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4893         16  CM-LF-DEV-CODE                PIC XXX.
  4894         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4895         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4896         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4897         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  94
* EL152.cbl
  4898         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4899         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4900         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4901         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4902         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4903         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4904         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4905         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4906         16  FILLER                        PIC XX.
  4907
  4908     12  CM-AH-DATA.
  4909         16  CM-AH-BENEFIT-CD              PIC XX.
  4910         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4911         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4912         16  CM-AH-DEV-CODE                PIC XXX.
  4913         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4914         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4915         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4916         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4917         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4918         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4919         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4920         16  CM-AH-PAID-THRU-DT            PIC XX.
  4921             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4922         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4923         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4924         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4925         16  FILLER                        PIC X.
  4926
  4927     12  CM-LOAN-INFORMATION.
  4928         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4929         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4930                                           PIC S9(5)V99  COMP-3.
  4931         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4932         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4933         16  CM-PAY-FREQUENCY              PIC S99.
  4934         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4935         16  CM-RATE-CLASS                 PIC XX.
  4936         16  CM-BENEFICIARY                PIC X(25).
  4937         16  CM-POLICY-FORM-NO             PIC X(12).
  4938         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4939         16  CM-LAST-ADD-ON-DT             PIC XX.
  4940         16  CM-DEDUCTIBLE-AMOUNTS.
  4941             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4942             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4943         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4944             20  CM-RESIDENT-STATE         PIC XX.
  4945             20  CM-RATE-CODE              PIC X(4).
  4946             20  FILLER                    PIC XX.
  4947         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4948             20  CM-LOAN-OFFICER           PIC X(5).
  4949             20  FILLER                    PIC XXX.
  4950         16  CM-CSR-CODE                   PIC XXX.
  4951         16  CM-UNDERWRITING-CODE          PIC X.
  4952             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4953         16  CM-POST-CARD-IND              PIC X.
  4954         16  CM-NH-INTERFACE-SW            PIC X.
  4955         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  95
* EL152.cbl
  4956             88  CM-SING-PRM                  VALUE '1'.
  4957             88  CM-O-B-COVERAGE              VALUE '2'.
  4958             88  CM-OPEN-END                  VALUE '3'.
  4959         16  CM-IND-GRP-TYPE               PIC X.
  4960             88  CM-INDIVIDUAL                VALUE 'I'.
  4961             88  CM-GROUP                     VALUE 'G'.
  4962         16  CM-SKIP-CODE                  PIC X.
  4963             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4964             88  SKIP-JULY                    VALUE '1'.
  4965             88  SKIP-AUGUST                  VALUE '2'.
  4966             88  SKIP-SEPTEMBER               VALUE '3'.
  4967             88  SKIP-JULY-AUG                VALUE '4'.
  4968             88  SKIP-AUG-SEPT                VALUE '5'.
  4969             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4970             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4971             88  SKIP-JUNE                    VALUE '8'.
  4972             88  SKIP-JUNE-JULY               VALUE '9'.
  4973             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4974             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4975         16  CM-PAYMENT-MODE               PIC X.
  4976             88  PAY-MONTHLY                  VALUE SPACE.
  4977             88  PAY-WEEKLY                   VALUE '1'.
  4978             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4979             88  PAY-BI-WEEKLY                VALUE '3'.
  4980             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4981         16  CM-LOAN-NUMBER                PIC X(8).
  4982         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4983         16  CM-OLD-LOF                    PIC XXX.
  4984*        16  CM-LOAN-OFFICER               PIC XXX.
  4985         16  CM-REIN-TABLE                 PIC XXX.
  4986         16  CM-SPECIAL-REIN-CODE          PIC X.
  4987         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4988         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4989         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4990
  4991     12  CM-STATUS-DATA.
  4992         16  CM-ENTRY-STATUS               PIC X.
  4993         16  CM-ENTRY-DT                   PIC XX.
  4994
  4995         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4996         16  CM-LF-CANCEL-DT               PIC XX.
  4997         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4998
  4999         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5000         16  CM-LF-DEATH-DT                PIC XX.
  5001         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5002
  5003         16  CM-LF-CURRENT-STATUS          PIC X.
  5004             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5005                                                'M' '4' '5' '9'.
  5006             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5007             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5008             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5009             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5010             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5011             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5012             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5013             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  96
* EL152.cbl
  5014             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5015             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5016             88  CM-LF-DECLINED               VALUE 'D'.
  5017             88  CM-LF-VOIDED                 VALUE 'V'.
  5018
  5019         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5020         16  CM-AH-CANCEL-DT               PIC XX.
  5021         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5022
  5023         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5024         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5025         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5026
  5027         16  CM-AH-CURRENT-STATUS          PIC X.
  5028             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5029                                                'M' '4' '5' '9'.
  5030             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5031             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5032             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5033             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5034             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5035             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5036             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5037             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5038             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5039             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5040             88  CM-AH-DECLINED               VALUE 'D'.
  5041             88  CM-AH-VOIDED                 VALUE 'V'.
  5042
  5043         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5044             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5045             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5046             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5047         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5048
  5049         16  CM-ENTRY-BATCH                PIC X(6).
  5050         16  CM-LF-EXIT-BATCH              PIC X(6).
  5051         16  CM-AH-EXIT-BATCH              PIC X(6).
  5052         16  CM-LAST-MONTH-END             PIC XX.
  5053
  5054     12  CM-NOTE-SW                        PIC X.
  5055         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5056         88  CERT-NOTES-PRESENT               VALUE '1'.
  5057         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5058         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5059         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5060         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5061         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5062         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5063     12  CM-COMP-EXCP-SW                   PIC X.
  5064         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5065         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5066     12  CM-INSURED-ADDRESS-SW             PIC X.
  5067         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5068         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5069
  5070*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5071     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  97
* EL152.cbl
  5072     12  FILLER                            PIC X.
  5073
  5074*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5075     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5076     12  FILLER                            PIC X.
  5077*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5078     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5079
  5080     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5081         88  CERT-ADDED-BATCH                 VALUE ' '.
  5082         88  CERT-ADDED-ONLINE                VALUE '1'.
  5083         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5084         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5085         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5086     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5087         88  CERT-AS-LOADED                   VALUE ' '.
  5088         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5089         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5090         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5091         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5092         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5093         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5094         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5095
  5096     12  CM-ACCOUNT-COMM-PCTS.
  5097         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5098         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5099
  5100     12  CM-USER-FIELD                     PIC X.
  5101     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5102     12  CM-CLP-STATE                      PIC XX.
  5103     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5104     12  CM-USER-RESERVED                  PIC XXX.
  5105     12  FILLER REDEFINES CM-USER-RESERVED.
  5106         16  CM-AH-CLASS-CD                PIC XX.
  5107         16  F                             PIC X.
  5108******************************************************************
  5109
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  98
* EL152.cbl
  5111*                                COPY ERCACCT.
  5112******************************************************************
  5113*                                                                *
  5114*                                                                *
  5115*                            ERCACCT                             *
  5116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5117*                            VMOD=2.031                          *
  5118*                                                                *
  5119*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5120*                                                                *
  5121*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5122*   VSAM ACCOUNT MASTER FILES.                                   *
  5123*                                                                *
  5124*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5125*                                                                *
  5126*   FILE TYPE = VSAM,KSDS                                        *
  5127*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5128*                                                                *
  5129*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5130*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5131*                                                                *
  5132*   LOG = NO                                                     *
  5133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5134*                                                                *
  5135*                                                                *
  5136******************************************************************
  5137*                   C H A N G E   L O G
  5138*
  5139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5140*-----------------------------------------------------------------
  5141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5142* EFFECTIVE    NUMBER
  5143*-----------------------------------------------------------------
  5144* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5145* 092705    2005050300006  PEMA  ADD SPP LEASES
  5146* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5147* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5148* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5149* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5150* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5151******************************************************************
  5152
  5153 01  ACCOUNT-MASTER.
  5154     12  AM-RECORD-ID                      PIC XX.
  5155         88  VALID-AM-ID                      VALUE 'AM'.
  5156
  5157     12  AM-CONTROL-PRIMARY.
  5158         16  AM-COMPANY-CD                 PIC X.
  5159         16  AM-MSTR-CNTRL.
  5160             20  AM-CONTROL-A.
  5161                 24  AM-CARRIER            PIC X.
  5162                 24  AM-GROUPING.
  5163                     28 AM-GROUPING-PREFIX PIC XXX.
  5164                     28 AM-GROUPING-PRIME  PIC XXX.
  5165                 24  AM-STATE              PIC XX.
  5166                 24  AM-ACCOUNT.
  5167                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5168                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page  99
* EL152.cbl
  5169             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5170                                           PIC X(19).
  5171             20  AM-CNTRL-B.
  5172                 24  AM-EXPIRATION-DT      PIC XX.
  5173                 24  FILLER                PIC X(4).
  5174             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5175                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5176
  5177     12  AM-CONTROL-BY-VAR-GRP.
  5178         16  AM-COMPANY-CD-A1              PIC X.
  5179         16  AM-VG-CARRIER                 PIC X.
  5180         16  AM-VG-GROUPING                PIC X(6).
  5181         16  AM-VG-STATE                   PIC XX.
  5182         16  AM-VG-ACCOUNT                 PIC X(10).
  5183         16  AM-VG-DATE.
  5184             20  AM-VG-EXPIRATION-DT       PIC XX.
  5185             20  FILLER                    PIC X(4).
  5186         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5187                                           PIC 9(11)      COMP-3.
  5188     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5189         16  FILLER                        PIC X(10).
  5190         16  AM-VG-KEY3.
  5191             20  AM-VG3-ACCOUNT            PIC X(10).
  5192             20  AM-VG3-EXP-DT             PIC XX.
  5193         16  FILLER                        PIC X(4).
  5194     12  AM-MAINT-INFORMATION.
  5195         16  AM-LAST-MAINT-DT              PIC XX.
  5196         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5197         16  AM-LAST-MAINT-USER            PIC X(4).
  5198         16  FILLER                        PIC XX.
  5199
  5200     12  AM-EFFECTIVE-DT                   PIC XX.
  5201     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5202
  5203     12  AM-PREV-DATES  COMP-3.
  5204         16  AM-PREV-EXP-DT                PIC 9(11).
  5205         16  AM-PREV-EFF-DT                PIC 9(11).
  5206
  5207     12  AM-REPORT-CODE-1                  PIC X(10).
  5208     12  AM-REPORT-CODE-2                  PIC X(10).
  5209
  5210     12  AM-CITY-CODE                      PIC X(4).
  5211     12  AM-COUNTY-PARISH                  PIC X(6).
  5212
  5213     12  AM-NAME                           PIC X(30).
  5214     12  AM-PERSON                         PIC X(30).
  5215     12  AM-ADDRS                          PIC X(30).
  5216     12  AM-CITY.
  5217         16  AM-ADDR-CITY                  PIC X(28).
  5218         16  AM-ADDR-STATE                 PIC XX.
  5219     12  AM-ZIP.
  5220         16  AM-ZIP-PRIME.
  5221             20  AM-ZIP-PRI-1ST            PIC X.
  5222                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5223             20  FILLER                    PIC X(4).
  5224         16  AM-ZIP-PLUS4                  PIC X(4).
  5225     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5226         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 100
* EL152.cbl
  5227         16  AM-CAN-POSTAL-2               PIC XXX.
  5228         16  FILLER                        PIC XXX.
  5229     12  AM-TEL-NO.
  5230         16  AM-AREA-CODE                  PIC 999.
  5231         16  AM-TEL-PRE                    PIC 999.
  5232         16  AM-TEL-NBR                    PIC 9(4).
  5233     12  AM-TEL-LOC                        PIC X.
  5234         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5235         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5236
  5237     12  AM-COMM-STRUCTURE.
  5238         16  AM-DEFN-1.
  5239             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5240                 24  AM-AGT.
  5241                     28  AM-AGT-PREFIX     PIC X(4).
  5242                     28  AM-AGT-PRIME      PIC X(6).
  5243                 24  AM-COM-TYP            PIC X.
  5244                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5245                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5246                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5247                 24  AM-RECALC-LV-INDIC    PIC X.
  5248                 24  AM-RETRO-LV-INDIC     PIC X.
  5249                 24  AM-GL-CODES           PIC X.
  5250                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5251                 24  FILLER                PIC X(01).
  5252         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5253             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5254                 24  FILLER                PIC X(11).
  5255                 24  AM-L-COMA             PIC XXX.
  5256                 24  AM-J-COMA             PIC XXX.
  5257                 24  AM-A-COMA             PIC XXX.
  5258                 24  FILLER                PIC X(6).
  5259
  5260     12  AM-COMM-CHANGE-STATUS             PIC X.
  5261         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5262
  5263     12  AM-CSR-CODE                       PIC X(4).
  5264
  5265     12  AM-BILLING-STATUS                 PIC X.
  5266         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5267         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5268     12  AM-AUTO-REFUND-SW                 PIC X.
  5269         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5270         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5271     12  AM-GPCD                           PIC 99.
  5272     12  AM-IG                             PIC X.
  5273         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5274         88  AM-HAS-GROUP                     VALUE '2'.
  5275     12  AM-STATUS                         PIC X.
  5276         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5277         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5278         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5279         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5280         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5281         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5282     12  AM-REMIT-TO                       PIC 99.
  5283     12  AM-ID-NO                          PIC X(11).
  5284
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 101
* EL152.cbl
  5285     12  AM-CAL-TABLE                      PIC XX.
  5286     12  AM-LF-DEVIATION                   PIC XXX.
  5287     12  AM-AH-DEVIATION                   PIC XXX.
  5288     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5289     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5290     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5291     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5292     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5293     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5294
  5295     12  AM-USER-FIELDS.
  5296         16  AM-FLD-1                      PIC XX.
  5297         16  AM-FLD-2                      PIC XX.
  5298         16  AM-FLD-3                      PIC XX.
  5299         16  AM-FLD-4                      PIC XX.
  5300         16  AM-FLD-5                      PIC XX.
  5301
  5302     12  AM-1ST-PROD-DATE.
  5303         16  AM-1ST-PROD-YR                PIC XX.
  5304         16  AM-1ST-PROD-MO                PIC XX.
  5305         16  AM-1ST-PROD-DA                PIC XX.
  5306     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5307     12  AM-CERTS-PURGED-DATE.
  5308         16  AM-PUR-YR                     PIC XX.
  5309         16  AM-PUR-MO                     PIC XX.
  5310         16  AM-PUR-DA                     PIC XX.
  5311     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5312     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5313     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5314     12  AM-INACTIVE-DATE.
  5315         16  AM-INA-MO                     PIC 99.
  5316         16  AM-INA-DA                     PIC 99.
  5317         16  AM-INA-YR                     PIC 99.
  5318     12  AM-AR-HI-CERT-DATE                PIC XX.
  5319
  5320     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5321     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5322
  5323     12  AM-OB-PAYMENT-MODE                PIC X.
  5324         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5325         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5326         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5327         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5328
  5329     12  AM-AH-ONLY-INDICATOR              PIC X.
  5330         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5331         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5332
  5333     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5334
  5335     12  AM-OVER-SHORT.
  5336         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5337         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5338
  5339     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5340     12  AM-DCC-CLP-STATE                  PIC XX.
  5341
  5342     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 102
* EL152.cbl
  5343     12  AM-RECALC-REIN                    PIC X.
  5344
  5345     12  AM-REI-TABLE                      PIC XXX.
  5346     12  AM-REI-ET-LF                      PIC X.
  5347     12  AM-REI-ET-AH                      PIC X.
  5348     12  AM-REI-PE-LF                      PIC X.
  5349     12  AM-REI-PE-AH                      PIC X.
  5350     12  AM-REI-PRT-ST                     PIC X.
  5351     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5352     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5353     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5354     12  AM-REI-GROUP-A                    PIC X(6).
  5355     12  AM-REI-MORT                       PIC X(4).
  5356     12  AM-REI-PRT-OW                     PIC X.
  5357     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5358     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5359     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5360     12  AM-REI-GROUP-B                    PIC X(6).
  5361
  5362     12  AM-TRUST-TYPE                     PIC X(2).
  5363
  5364     12  AM-EMPLOYER-STMT-USED             PIC X.
  5365     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5366
  5367     12  AM-STD-AH-TYPE                    PIC XX.
  5368     12  AM-EARN-METHODS.
  5369         16  AM-EARN-METHOD-R              PIC X.
  5370             88 AM-REF-RL-R78                 VALUE 'R'.
  5371             88 AM-REF-RL-PR                  VALUE 'P'.
  5372             88 AM-REF-RL-MEAN                VALUE 'M'.
  5373             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5374         16  AM-EARN-METHOD-L              PIC X.
  5375             88 AM-REF-LL-R78                 VALUE 'R'.
  5376             88 AM-REF-LL-PR                  VALUE 'P'.
  5377             88 AM-REF-LL-MEAN                VALUE 'M'.
  5378             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5379         16  AM-EARN-METHOD-A              PIC X.
  5380             88 AM-REF-AH-R78                 VALUE 'R'.
  5381             88 AM-REF-AH-PR                  VALUE 'P'.
  5382             88 AM-REF-AH-MEAN                VALUE 'M'.
  5383             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5384             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5385             88 AM-REF-AH-NET                 VALUE 'N'.
  5386
  5387     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5388     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5389     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5390
  5391     12  AM-RET-Y-N                        PIC X.
  5392     12  AM-RET-P-E                        PIC X.
  5393     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5394     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5395     12  AM-RET-GRP                        PIC X(6).
  5396     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5397         16  AM-POOL-PRIME                 PIC XXX.
  5398         16  AM-POOL-SUB                   PIC XXX.
  5399     12  AM-RETRO-EARNINGS.
  5400         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 103
* EL152.cbl
  5401         16  AM-RET-EARN-L                 PIC X.
  5402         16  AM-RET-EARN-A                 PIC X.
  5403     12  AM-RET-ST-TAX-USE                 PIC X.
  5404         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5405         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5406     12  AM-RETRO-BEG-EARNINGS.
  5407         16  AM-RET-BEG-EARN-R             PIC X.
  5408         16  AM-RET-BEG-EARN-L             PIC X.
  5409         16  AM-RET-BEG-EARN-A             PIC X.
  5410     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5411     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5412
  5413     12  AM-USER-SELECT-OPTIONS.
  5414         16  AM-USER-SELECT-1              PIC X(10).
  5415         16  AM-USER-SELECT-2              PIC X(10).
  5416         16  AM-USER-SELECT-3              PIC X(10).
  5417         16  AM-USER-SELECT-4              PIC X(10).
  5418         16  AM-USER-SELECT-5              PIC X(10).
  5419
  5420     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5421
  5422     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5423
  5424     12  AM-RPT045A-SWITCH                 PIC X.
  5425         88  RPT045A-OFF                   VALUE 'N'.
  5426
  5427     12  AM-INSURANCE-LIMITS.
  5428         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5429         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5430
  5431     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5432         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5433
  5434     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5435         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5436         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5437
  5438     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5439
  5440     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5441     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5442     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5443     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5444     12  AM-DCC-UEF-STATE                  PIC XX.
  5445     12  FILLER                            PIC XXX.
  5446     12  AM-REPORT-CODE-3                  PIC X(10).
  5447*    12  FILLER                            PIC X(22).
  5448
  5449     12  AM-RESERVE-DATE.
  5450         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5451         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5452         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5453
  5454     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5455     12  AM-NOTIFICATION-TYPES.
  5456         16  AM-NOTIF-OF-LETTERS           PIC X.
  5457         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5458         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 104
* EL152.cbl
  5459         16  AM-NOTIF-OF-STATUS            PIC X.
  5460
  5461     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5462         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5463         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5464         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5465         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5466
  5467     12  AM-BENEFIT-CONTROLS.
  5468         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5469             20  AM-BENEFIT-CODE           PIC XX.
  5470             20  AM-BENEFIT-TYPE           PIC X.
  5471             20  AM-BENEFIT-REVISION       PIC XXX.
  5472             20  AM-BENEFIT-REM-TERM       PIC X.
  5473             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5474             20  FILLER                    PIC XX.
  5475         16  FILLER                        PIC X(80).
  5476
  5477     12  AM-TRANSFER-DATA.
  5478         16  AM-TRANSFERRED-FROM.
  5479             20  AM-TRNFROM-CARRIER        PIC X.
  5480             20  AM-TRNFROM-GROUPING.
  5481                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5482                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5483             20  AM-TRNFROM-STATE          PIC XX.
  5484             20  AM-TRNFROM-ACCOUNT.
  5485                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5486                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5487             20  AM-TRNFROM-DTE            PIC XX.
  5488         16  AM-TRANSFERRED-TO.
  5489             20  AM-TRNTO-CARRIER          PIC X.
  5490             20  AM-TRNTO-GROUPING.
  5491                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5492                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5493             20  AM-TRNTO-STATE            PIC XX.
  5494             20  AM-TRNTO-ACCOUNT.
  5495                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5496                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5497             20  AM-TRNTO-DTE              PIC XX.
  5498         16  FILLER                        PIC X(10).
  5499
  5500     12  AM-SAVED-REMIT-TO                 PIC 99.
  5501
  5502     12  AM-COMM-STRUCTURE-SAVED.
  5503         16  AM-DEFN-1-SAVED.
  5504             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5505                 24  AM-AGT-SV             PIC X(10).
  5506                 24  AM-COM-TYP-SV         PIC X.
  5507                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5508                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5509                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5510                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5511                 24  FILLER                PIC X.
  5512                 24  AM-GL-CODES-SV        PIC X.
  5513                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5514                 24  FILLER                PIC X.
  5515         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5516             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 105
* EL152.cbl
  5517                 24  FILLER                PIC X(11).
  5518                 24  AM-L-COMA-SV          PIC XXX.
  5519                 24  AM-J-COMA-SV          PIC XXX.
  5520                 24  AM-A-COMA-SV          PIC XXX.
  5521                 24  FILLER                PIC X(6).
  5522
  5523     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5524         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5525            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5526            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5527            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5528
  5529     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5530     12  FILLER                            PIC X(120).
  5531
  5532     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5533         16  AM-CONTROL-NAME               PIC X(30).
  5534         16  AM-EXECUTIVE-ONE.
  5535             20  AM-EXEC1-NAME             PIC X(15).
  5536             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5537                                                          COMP-3.
  5538             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5539                                                          COMP-3.
  5540         16  AM-EXECUTIVE-TWO.
  5541             20  AM-EXEC2-NAME             PIC X(15).
  5542             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5543                                                          COMP-3.
  5544             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5545                                                          COMP-3.
  5546
  5547     12  AM-RETRO-ADDITIONAL-DATA.
  5548         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5549         16  AM-RETRO-PREM-P-E             PIC X.
  5550         16  AM-RETRO-CLMS-P-I             PIC X.
  5551         16  AM-RETRO-RET-BRACKET-LF.
  5552             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5553                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5554                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5555             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5556                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5557                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5558             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5559                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5560                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5561         16  AM-RETRO-RET-BRACKET-AH.
  5562             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5563                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5564                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5565                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5566             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5567                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5568                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5569             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5570                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5571                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5572
  5573     12  AM-COMMENTS.
  5574         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 106
* EL152.cbl
  5575
  5576     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5577         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5578         16  AM-FLI-BILLING-CODE           PIC X.
  5579         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5580         16  AM-FLI-UNITED-IDENT           PIC X.
  5581         16  AM-FLI-INTEREST-LOST-DATA.
  5582             20  AM-FLI-BANK-NO            PIC X(5).
  5583             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5584             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5585             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5586         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5587             20  AM-FLI-AGT                PIC X(9).
  5588             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5589             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5590         16  FILLER                        PIC X(102).
  5591
  5592     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5593         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5594             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5595             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5596             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5597             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5598             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5599         16  FILLER                          PIC X(10).
  5600******************************************************************
  5601
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 107
* EL152.cbl
  5603*                                COPY ELCTEXT.
  5604******************************************************************
  5605*                                                                *
  5606*                                                                *
  5607*                            ELCTEXT.                            *
  5608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5609*                            VMOD=2.008                          *
  5610*                                                                *
  5611*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5612*                                     FORM LETTERS,              *
  5613*                                     CERT FORM DISPLAY.
  5614*                                                                *
  5615*   FILE TYPE = VSAM,KSDS                                        *
  5616*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5617*                                                                *
  5618*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5619*       ALTERNATE INDEX = NONE                                   *
  5620*                                                                *
  5621*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5622*       ALTERNATE INDEX = NONE                                   *
  5623*                                                                *
  5624*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5625*       ALTERNATE INDEX = NONE                                   *
  5626*                                                                *
  5627*   LOG = NO                                                     *
  5628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5629******************************************************************
  5630 01  TEXT-FILES.
  5631     12  TEXT-FILE-ID                PIC XX.
  5632         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5633         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5634         88  HELP-FILE-TEXT             VALUE 'TH'.
  5635
  5636     12  TX-CONTROL-PRIMARY.
  5637         16  TX-COMPANY-CD           PIC X.
  5638             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5639         16  TX-ACCESS-CD-GENL       PIC X(12).
  5640
  5641         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5642             20  TX-LETTER-NO        PIC X(4).
  5643             20  FILLER              PIC X(8).
  5644
  5645         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5646             20  TX-FORM-NO          PIC X(12).
  5647
  5648         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5649             20  TX-HELP-TYPE        PIC X.
  5650                 88  HELP-FOR-GENERAL   VALUE ' '.
  5651                 88  HELP-BY-SCREEN     VALUE 'S'.
  5652                 88  HELP-BY-ERROR      VALUE 'E'.
  5653             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5654                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5655             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5656                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5657             20  FILLER              PIC X(4).
  5658
  5659         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5660
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 108
* EL152.cbl
  5661     12  TX-PROCESS-CONTROL          PIC XX.
  5662         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5663
  5664     12  TX-TEXT-LINE                PIC X(70).
  5665
  5666     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5667         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5668         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5669         88  TX-VALID-FORM-SQUEEZE-VALUE
  5670                                        VALUE 'Y' ' '.
  5671
  5672     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5673         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5674         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5675         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5676         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5677         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5678         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5679         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5680                                              'K' 'N' ' '
  5681                                              'Z'.
  5682
  5683     12  TX-ARCHIVE-SW               PIC X.
  5684         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5685         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5686         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5687
  5688     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5689     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5690
  5691     12  TX-BSR-CODE                 PIC X.
  5692         88  TX-BSR-LETTER              VALUE 'B'.
  5693         88  TX-NON-BSR-LETTER          VALUE ' '.
  5694
  5695     12  FILLER                      PIC X.
  5696*****************************************************************
  5697
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 109
* EL152.cbl
  5699*                                COPY ELCTRLR.
  5700******************************************************************
  5701*                                                                *
  5702*                            ELCTRLR.                            *
  5703*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5704*                            VMOD=2.014                          *
  5705*                                                                *
  5706*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5707*                                                                *
  5708*   FILE TYPE = VSAM,KSDS                                        *
  5709*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5710*                                                                *
  5711*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5712*       ALTERNATE INDEX = NONE                                   *
  5713*                                                                *
  5714*   LOG = YES                                                    *
  5715*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5716******************************************************************
  5717*                   C H A N G E   L O G
  5718*
  5719* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5720*-----------------------------------------------------------------
  5721*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5722* EFFECTIVE    NUMBER
  5723*-----------------------------------------------------------------
  5724* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5725* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5726* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5727* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5728* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5729* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5730* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5731* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5732* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5733* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5734* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5735* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5736* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5737* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5738* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5739******************************************************************
  5740 01  ACTIVITY-TRAILERS.
  5741     12  AT-RECORD-ID                    PIC XX.
  5742         88  VALID-AT-ID                       VALUE 'AT'.
  5743
  5744     12  AT-CONTROL-PRIMARY.
  5745         16  AT-COMPANY-CD               PIC X.
  5746         16  AT-CARRIER                  PIC X.
  5747         16  AT-CLAIM-NO                 PIC X(7).
  5748         16  AT-CERT-NO.
  5749             20  AT-CERT-PRIME           PIC X(10).
  5750             20  AT-CERT-SFX             PIC X.
  5751         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5752             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5753             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5754             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5755             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5756             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 110
* EL152.cbl
  5757             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5758             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5759             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5760             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5761             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5762             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5763             88  AT-BENEFICIARY-TRL           VALUE +91.
  5764             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5765             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5766             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5767
  5768     12  AT-TRAILER-TYPE                 PIC X.
  5769         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5770         88  PAYMENT-TR                       VALUE '2'.
  5771         88  AUTO-PAY-TR                      VALUE '3'.
  5772         88  CORRESPONDENCE-TR                VALUE '4'.
  5773         88  ADDRESS-TR                       VALUE '5'.
  5774         88  GENERAL-INFO-TR                  VALUE '6'.
  5775         88  AUTO-PROMPT-TR                   VALUE '7'.
  5776         88  DENIAL-TR                        VALUE '8'.
  5777         88  INCURRED-CHG-TR                  VALUE '9'.
  5778         88  FORM-CONTROL-TR                  VALUE 'A'.
  5779
  5780     12  AT-RECORDED-DT                  PIC XX.
  5781     12  AT-RECORDED-BY                  PIC X(4).
  5782     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5783
  5784     12  AT-TRAILER-BODY                 PIC X(165).
  5785
  5786     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5787         16  AT-RESERVE-CONTROLS.
  5788             20  AT-MANUAL-SW            PIC X.
  5789                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5790             20  AT-FUTURE-SW            PIC X.
  5791                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5792             20  AT-PTC-SW               PIC X.
  5793                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5794             20  AT-IBNR-SW              PIC X.
  5795                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5796             20  AT-PTC-LF-SW            PIC X.
  5797                 88  AT-LF-PTC-USED          VALUE '1'.
  5798             20  AT-CDT-ACCESS-METHOD    PIC X.
  5799                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5800                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5801                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5802             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5803         16  AT-LAST-COMPUTED-DT         PIC XX.
  5804         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5805         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5806         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5807         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5808         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5809         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5810         16  AT-EXPENSE-CONTROLS.
  5811             20  AT-EXPENSE-METHOD       PIC X.
  5812                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5813                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5814                 88  PERCENT-OF-PMT           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 111
* EL152.cbl
  5815                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5816             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5817             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5818         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5819         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5820
  5821         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5822         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5823
  5824*        16  FILLER                      PIC X(53).
  5825         16  FILLER                      PIC X(47).
  5826
  5827         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5828         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5829
  5830         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5831             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5832             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5833*                    C = CLOSED
  5834*                    O = OPEN
  5835             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5836*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5837
  5838     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5839         16  AT-PAYMENT-TYPE             PIC X.
  5840             88  PARTIAL-PAYMENT                VALUE '1'.
  5841             88  FINAL-PAYMENT                  VALUE '2'.
  5842             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5843             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5844             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5845             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5846             88  VOIDED-PAYMENT                 VALUE '9'.
  5847             88  TRANSFER                       VALUE 'T'.
  5848             88  LIFE-INTEREST                  VALUE 'I'.
  5849
  5850         16  AT-CLAIM-TYPE               PIC X.
  5851             88  PAID-FOR-AH                    VALUE 'A'.
  5852             88  PAID-FOR-LIFE                  VALUE 'L'.
  5853             88  PAID-FOR-IUI                   VALUE 'I'.
  5854             88  PAID-FOR-GAP                   VALUE 'G'.
  5855         16  AT-CLAIM-PREM-TYPE          PIC X.
  5856             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5857             88  AT-O-B-COVERAGE                VALUE '2'.
  5858             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5859         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5860         16  AT-CHECK-NO                 PIC X(7).
  5861         16  AT-PAID-FROM-DT             PIC XX.
  5862         16  AT-PAID-THRU-DT             PIC XX.
  5863         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5864         16  FILLER                      PIC X.
  5865         16  AT-PAYEES-NAME              PIC X(30).
  5866         16  AT-PAYMENT-ORIGIN           PIC X.
  5867             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5868             88  ONLINE-AUTO-PMT                VALUE '2'.
  5869             88  OFFLINE-PMT                    VALUE '3'.
  5870         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5871         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5872         16  AT-VOID-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 112
* EL152.cbl
  5873             20  AT-VOID-DT              PIC XX.
  5874*00144       20  AT-VOID-REASON          PIC X(30).
  5875             20  AT-VOID-REASON          PIC X(26).
  5876         16  AT-PMT-APPROVED-BY          PIC X(04).
  5877         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5878         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5879         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5880                                         PIC S99V9(5)  COMP-3.
  5881         16  AT-CREDIT-INTERFACE.
  5882             20  AT-PMT-SELECT-DT        PIC XX.
  5883                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5884             20  AT-PMT-ACCEPT-DT        PIC XX.
  5885                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5886             20  AT-VOID-SELECT-DT       PIC XX.
  5887                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5888             20  AT-VOID-ACCEPT-DT       PIC XX.
  5889                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5890
  5891         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5892                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5893                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5894         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5895
  5896         16  AT-FORCE-CONTROL            PIC X.
  5897             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5898         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5899         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5900         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5901         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5902         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5903         16  AT-BENEFIT-TYPE             PIC X.
  5904
  5905         16  AT-EXPENSE-TYPE             PIC X.
  5906         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5907
  5908         16  AT-PAYEE-TYPE-CD.
  5909             20  AT-PAYEE-TYPE           PIC X.
  5910                 88  INSURED-PAID           VALUE 'I'.
  5911                 88  BENEFICIARY-PAID       VALUE 'B'.
  5912                 88  ACCOUNT-PAID           VALUE 'A'.
  5913                 88  OTHER-1-PAID           VALUE 'O'.
  5914                 88  OTHER-2-PAID           VALUE 'Q'.
  5915                 88  DOCTOR-PAID            VALUE 'P'.
  5916                 88  EMPLOYER-PAID          VALUE 'E'.
  5917             20  AT-PAYEE-SEQ            PIC X.
  5918
  5919         16  AT-CASH-PAYMENT             PIC X.
  5920         16  AT-GROUPED-PAYMENT          PIC X.
  5921         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5922         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5923         16  AT-APPROVED-LEVEL           PIC X.
  5924         16  AT-VOID-TYPE                PIC X.
  5925             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5926             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5927         16  AT-AIG-UNEMP-IND            PIC X.
  5928             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5929         16  AT-ASSOCIATES               PIC X.
  5930             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 113
* EL152.cbl
  5931             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5932
  5933         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5934         16  AT-CV-PMT-CODE              PIC X.
  5935             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5936             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5937             88  FULL-ADD-PAYMENT           VALUE '3'.
  5938             88  HALF-ADD-PAYMENT           VALUE '4'.
  5939             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5940             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5941             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5942             88  ADDL-PAYMENT               VALUE '8'.
  5943
  5944         16  AT-EOB-CODE1                PIC XXX.
  5945         16  AT-EOB-CODE2                PIC XXX.
  5946         16  AT-EOB-CODE3                PIC XXX.
  5947         16  FILLER REDEFINES AT-EOB-CODE3.
  5948             20  AT-PRINT-CLM-FORM       PIC X.
  5949             20  AT-PRINT-SURVEY         PIC X.
  5950             20  FILLER                  PIC X.
  5951         16  AT-EOB-CODE4                PIC XXX.
  5952         16  FILLER REDEFINES AT-EOB-CODE4.
  5953             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5954             20  FILLER                  PIC X.
  5955         16  AT-EOB-CODE5                PIC XXX.
  5956         16  FILLER REDEFINES AT-EOB-CODE5.
  5957             20  AT-PMT-PROOF-DT         PIC XX.
  5958             20  FILLER                  PIC X.
  5959
  5960         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5961             88  AT-PRINT-EOB            VALUE 'Y'.
  5962
  5963         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5964         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5965
  5966     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5967         16  AT-SCHEDULE-START-DT        PIC XX.
  5968         16  AT-SCHEDULE-END-DT          PIC XX.
  5969         16  AT-TERMINATED-DT            PIC XX.
  5970         16  AT-LAST-PMT-TYPE            PIC X.
  5971             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5972             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5973         16  AT-FIRST-PMT-DATA.
  5974             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5975             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5976             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5977         16  AT-REGULAR-PMT-DATA.
  5978             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5979             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5980             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5981         16  AT-AUTO-PAYEE-CD.
  5982             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5983                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5984                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5985                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5986                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5987                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5988             20  AT-AUTO-PAYEE-SEQ       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 114
* EL152.cbl
  5989         16  AT-AUTO-PAY-DAY             PIC 99.
  5990         16  AT-AUTO-CASH                PIC X.
  5991             88  AT-CASH                      VALUE 'Y'.
  5992             88  AT-NON-CASH                  VALUE 'N'.
  5993*        16  FILLER                      PIC X(129).
  5994         16  AT-AUTO-END-LETTER          PIC X(4).
  5995         16  FILLER                      PIC X(125).
  5996
  5997         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5998         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5999
  6000     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6001         16  AT-LETTER-SENT-DT           PIC XX.
  6002         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6003         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6004         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6005         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6006         16  AT-LETTER-ORIGIN            PIC X.
  6007             88  ONLINE-CREATION              VALUE '1' '3'.
  6008             88  OFFLINE-CREATION             VALUE '2' '4'.
  6009             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6010             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6011         16  AT-STD-LETTER-FORM          PIC X(4).
  6012         16  AT-REASON-TEXT              PIC X(70).
  6013         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6014         16  AT-ADDRESEE-TYPE            PIC X.
  6015              88  INSURED-ADDRESEE            VALUE 'I'.
  6016              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6017              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6018              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6019              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6020              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6021              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6022         16  AT-ADDRESSEE-NAME           PIC X(30).
  6023         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6024         16  AT-RESEND-PRINT-DATE        PIC XX.
  6025         16  AT-CORR-SOL-UNSOL           PIC X.
  6026         16  AT-LETTER-PURGED-DT         PIC XX.
  6027*
  6028*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6029*
  6030         16  AT-CSO-REDEFINITION.
  6031             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6032             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6033             20  AT-LETTER-TO-BENE       PIC X(1).
  6034             20  AT-STOP-LETTER-DT       PIC X(2).
  6035             20  FILLER                  PIC X(19).
  6036*             20  FILLER                  PIC X(27).
  6037             20  AT-CSO-LETTER-STATUS    PIC X.
  6038                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6039                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6040                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6041             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6042             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6043*
  6044*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6045*
  6046*        16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 115
* EL152.cbl
  6047*
  6048*        16  AT-DMD-BSR-CODE             PIC X.
  6049*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6050*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6051*
  6052*        16  AT-DMD-LETTER-STATUS        PIC X.
  6053*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6054*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6055*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6056*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6057*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6058
  6059         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6060         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6061
  6062     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6063         16  AT-ADDRESS-TYPE             PIC X.
  6064             88  INSURED-ADDRESS               VALUE 'I'.
  6065             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6066             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6067             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6068             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6069             88  OTHER-ADDRESS-1               VALUE 'O'.
  6070             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6071         16  AT-MAIL-TO-NAME             PIC X(30).
  6072         16  AT-ADDRESS-LINE-1           PIC X(30).
  6073         16  AT-ADDRESS-LINE-2           PIC X(30).
  6074         16  AT-CITY-STATE.
  6075             20  AT-CITY                 PIC X(28).
  6076             20  AT-STATE                PIC XX.
  6077         16  AT-ZIP.
  6078             20  AT-ZIP-CODE.
  6079                 24  AT-ZIP-1ST          PIC X.
  6080                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6081                 24  FILLER              PIC X(4).
  6082             20  AT-ZIP-PLUS4            PIC X(4).
  6083         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6084             20  AT-CAN-POSTAL-1         PIC XXX.
  6085             20  AT-CAN-POSTAL-2         PIC XXX.
  6086             20  FILLER                  PIC XXX.
  6087         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6088*         16  FILLER                      PIC X(23).
  6089         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6090         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6091         16  FILLER                      PIC X(13).
  6092         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6093         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6094
  6095     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6096         16  AT-INFO-LINE-1              PIC X(60).
  6097         16  AT-INFO-LINE-2              PIC X(60).
  6098         16  AT-INFO-TRAILER-TYPE        PIC X.
  6099             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6100             88  AT-CALL-NOTE            VALUE 'C'.
  6101             88  AT-MAINT-NOTE           VALUE 'M'.
  6102             88  AT-CERT-CHANGE          VALUE 'X'.
  6103             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6104             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 116
* EL152.cbl
  6105         16  AT-CALL-TYPE                PIC X.
  6106             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6107             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6108         16  AT-NOTE-CONTINUATION        PIC X.
  6109             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6110         16  AT-EOB-CODES-EXIST          PIC X.
  6111             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6112         16  FILLER                      PIC X(35).
  6113         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6114         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6115
  6116     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6117         16  AT-PROMPT-LINE-1            PIC X(60).
  6118         16  AT-PROMPT-LINE-2            PIC X(60).
  6119         16  AT-PROMPT-START-DT          PIC XX.
  6120         16  AT-PROMPT-END-DT            PIC XX.
  6121         16  FILLER                      PIC X(35).
  6122         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6123         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6124
  6125     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6126         16  AT-DENIAL-INFO-1            PIC X(60).
  6127         16  AT-DENIAL-INFO-2            PIC X(60).
  6128         16  AT-DENIAL-DT                PIC XX.
  6129         16  AT-RETRACTION-DT            PIC XX.
  6130         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6131*         16  FILLER                      PIC X(31).
  6132         16  AT-DENIAL-PROOF-DT          PIC XX.
  6133         16  FILLER                      PIC X(29).
  6134         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6135         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6136
  6137     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6138         16  AT-OLD-INCURRED-DT          PIC XX.
  6139         16  AT-OLD-REPORTED-DT          PIC XX.
  6140         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6141         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6142         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6143         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6144         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6145         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6146         16  FILLER                      PIC X(26).
  6147         16  AT-OLD-DIAG-CODE            PIC X(6).
  6148         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6149         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6150         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6151         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6152         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6153         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6154         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6155         16  FILLER                      PIC X(25).
  6156         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6157
  6158     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6159         16  AT-FORM-SEND-ON-DT          PIC XX.
  6160         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6161         16  AT-FORM-RE-SEND-DT          PIC XX.
  6162         16  AT-FORM-ANSWERED-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 117
* EL152.cbl
  6163         16  AT-FORM-PRINTED-DT          PIC XX.
  6164         16  AT-FORM-REPRINT-DT          PIC XX.
  6165         16  AT-FORM-TYPE                PIC X.
  6166             88  INITIAL-FORM                  VALUE '1'.
  6167             88  PROGRESS-FORM                 VALUE '2'.
  6168         16  AT-INSTRUCT-LN-1            PIC X(28).
  6169         16  AT-INSTRUCT-LN-2            PIC X(28).
  6170         16  AT-INSTRUCT-LN-3            PIC X(28).
  6171         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6172         16  AT-FORM-ADDRESS             PIC X.
  6173             88  FORM-TO-INSURED              VALUE 'I'.
  6174             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6175             88  FORM-TO-OTHER-1              VALUE 'O'.
  6176             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6177         16  AT-RELATED-1.
  6178             20 AT-REL-CARR-1            PIC X.
  6179             20 AT-REL-CLAIM-1           PIC X(7).
  6180             20 AT-REL-CERT-1            PIC X(11).
  6181         16  AT-RELATED-2.
  6182             20 AT-REL-CARR-2            PIC X.
  6183             20 AT-REL-CLAIM-2           PIC X(7).
  6184             20 AT-REL-CERT-2            PIC X(11).
  6185         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6186         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6187         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6188         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6189         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6190         16  AT-STOP-FORM-DT             PIC X(2).
  6191
  6192         16  FILLER                      PIC X(09).
  6193         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6194         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6195******************************************************************
  6196
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 118
* EL152.cbl
  6198*                                COPY ELCBENE.
  6199******************************************************************
  6200*                                                                *
  6201*                            ELCBENE.                            *
  6202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6203*                            VMOD=2.006                          *
  6204*                                                                *
  6205*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6206*                                                                *
  6207*   FILE TYPE = VSAM,KSDS                                        *
  6208*   RECORD SIZE = 500   RECFORM = FIX                            *
  6209*                                                                *
  6210*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6211*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6212*                                                                *
  6213*   LOG = YES                                                    *
  6214*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6215*                                                                *
  6216*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6217******************************************************************
  6218
  6219 01  BENEFICIARY-MASTER.
  6220     12  BE-RECORD-ID                PIC XX.
  6221         88  VALID-BE-ID                VALUE 'BE'.
  6222
  6223     12  BE-CONTROL-PRIMARY.
  6224         16  BE-COMPANY-CD           PIC X.
  6225         16  BE-RECORD-TYPE          PIC X.
  6226             88  BENEFICIARY-RECORD  VALUE 'B'.
  6227             88  ADJUSTOR-RECORD     VALUE 'A'.
  6228         16  BE-BENEFICIARY          PIC X(10).
  6229     12  BE-CONTROL-BY-NAME.
  6230         16  BE-COMPANY-CD-A1        PIC X.
  6231         16  BE-RECORD-TYPE-A1       PIC X.
  6232         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6233         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6234
  6235     12  BE-LAST-MAINT-DT            PIC XX.
  6236     12  BE-LAST-MAINT-BY            PIC X(4).
  6237     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6238
  6239     12  BE-ADDRESS-DATA.
  6240         16  BE-MAIL-TO-NAME         PIC X(30).
  6241         16  BE-ADDRESS-LINE-1       PIC X(30).
  6242         16  BE-ADDRESS-LINE-2       PIC X(30).
  6243         16  BE-ADDRESS-LINE-3       PIC X(30).
  6244         16  BE-CITY-STATE.
  6245             20  BE-CITY             PIC X(28).
  6246             20  BE-STATE            PIC XX.
  6247         16  BE-ZIP-CODE.
  6248             20  BE-ZIP-PRIME.
  6249                 24  BE-ZIP-1ST      PIC X.
  6250                     88  BE-CANADIAN-POST-CODE
  6251                                         VALUE 'A' THRU 'Z'.
  6252                 24  FILLER          PIC X(4).
  6253             20  BE-ZIP-PLUS4        PIC X(4).
  6254         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6255             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 119
* EL152.cbl
  6256             20  BE-CAN-POSTAL-2     PIC XXX.
  6257             20  FILLER              PIC XXX.
  6258         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6259         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6260
  6261******************************************************************
  6262*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6263*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6264******************************************************************
  6265     12  BE-CARRIER                  PIC X.
  6266
  6267     12  BE-ADDRESS-DATA2.
  6268         16  BE-MAIL-TO-NAME2        PIC X(30).
  6269         16  BE-ADDRESS-LINE-12      PIC X(30).
  6270         16  BE-ADDRESS-LINE-22      PIC X(30).
  6271         16  BE-ADDRESS-LINE-32      PIC X(30).
  6272         16  BE-CITY-STATE2.
  6273             20  BE-CITY2            PIC X(28).
  6274             20  BE-STATE2           PIC XX.
  6275         16  BE-ZIP-CODE2.
  6276             20  BE-ZIP-PRIME2.
  6277                 24  BE-ZIP-1ST2     PIC X.
  6278                     88  BE-CANADIAN-POST-CODE2
  6279                                         VALUE 'A' THRU 'Z'.
  6280                 24  FILLER          PIC X(4).
  6281             20  BE-ZIP-PLUS42       PIC X(4).
  6282         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6283             20  BE-CAN-POSTAL-12    PIC XXX.
  6284             20  BE-CAN-POSTAL-22    PIC XXX.
  6285             20  FILLER              PIC XXX.
  6286         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6287         16  BE-BILLING-STMT-DATA.
  6288             20  BE-BSR              PIC X.
  6289                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6290                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6291             20  BE-BSR-FROM         PIC X(30).
  6292             20  BE-BSR-DEPT         PIC X(30).
  6293             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6294             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6295             20  BE-OUTPUT-TYPE      PIC X.
  6296                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6297                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6298
  6299     12  FILLER                      PIC X(28).
  6300******************************************************************
  6301
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 120
* EL152.cbl
  6303*                                COPY ERCCOMP.
  6304******************************************************************
  6305*                                                                *
  6306*                                                                *
  6307*                            ERCCOMP                             *
  6308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6309*                            VMOD=2.019                          *
  6310*                                                                *
  6311*   ONLINE CREDIT SYSTEM                                         *
  6312*                                                                *
  6313*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6314*                                                                *
  6315*   FILE TYPE = VSAM,KSDS                                        *
  6316*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6317*                                                                *
  6318*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6319*       ALTERNATE PATH = NONE                                    *
  6320*                                                                *
  6321*   LOG = NO                                                     *
  6322*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6323*                                                                *
  6324******************************************************************
  6325*                   C H A N G E   L O G
  6326*
  6327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6328*-----------------------------------------------------------------
  6329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6330* EFFECTIVE    NUMBER
  6331*-----------------------------------------------------------------
  6332* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6333* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6334* 092205    2005050300006  PEMA  ADD LEASE FEE
  6335* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6336* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6337* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6338* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6339* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6340* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6341******************************************************************
  6342
  6343 01  COMPENSATION-MASTER.
  6344     12  CO-RECORD-ID                          PIC XX.
  6345         88  VALID-CO-ID                          VALUE 'CO'.
  6346
  6347     12  CO-CONTROL-PRIMARY.
  6348         16  CO-COMPANY-CD                     PIC X.
  6349         16  CO-CONTROL.
  6350             20  CO-CTL-1.
  6351                 24  CO-CARR-GROUP.
  6352                     28  CO-CARRIER            PIC X.
  6353                     28  CO-GROUPING.
  6354                         32  CO-GROUP-PREFIX   PIC XXX.
  6355                         32  CO-GROUP-PRIME    PIC XXX.
  6356                 24  CO-RESP-NO.
  6357                     28  CO-RESP-PREFIX        PIC X(4).
  6358                     28  CO-RESP-PRIME         PIC X(6).
  6359             20  CO-CTL-2.
  6360                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 121
* EL152.cbl
  6361                     28  CO-ACCT-PREFIX        PIC X(4).
  6362                     28  CO-ACCT-PRIME         PIC X(6).
  6363         16  CO-TYPE                           PIC X.
  6364             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6365             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6366             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6367
  6368     12  CO-MAINT-INFORMATION.
  6369         16  CO-LAST-MAINT-DT                  PIC XX.
  6370         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6371         16  CO-LAST-MAINT-USER                PIC X(4).
  6372     12  FILLER                                PIC XX.
  6373     12  CO-STMT-TYPE                          PIC XXX.
  6374     12  CO-COMP-TYPE                          PIC X.
  6375         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6376     12  CO-STMT-OWNER                         PIC X(4).
  6377     12  CO-BALANCE-CONTROL                    PIC X.
  6378         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6379         88  CO-NO-BALANCE                        VALUE 'N'.
  6380
  6381     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6382         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6383         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6384         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6385
  6386     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6387         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6388         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6389
  6390     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6391     12  CO-GA-DIRECT-DEP                      PIC X.
  6392     12  CO-FUTURE-SPACE                       PIC X.
  6393         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6394
  6395     12  CO-ACCT-NAME                          PIC X(30).
  6396     12  CO-MAIL-NAME                          PIC X(30).
  6397     12  CO-ADDR-1                             PIC X(30).
  6398     12  CO-ADDR-2                             PIC X(30).
  6399     12  CO-ADDR-3.
  6400         16  CO-ADDR-CITY                      PIC X(27).
  6401         16  CO-ADDR-STATE                     PIC XX.
  6402     12  CO-CSO-1099                           PIC X.
  6403     12  CO-ZIP.
  6404         16  CO-ZIP-PRIME.
  6405             20  CO-ZIP-PRI-1ST                PIC X.
  6406                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6407             20  FILLER                        PIC X(4).
  6408         16  CO-ZIP-PLUS4                      PIC X(4).
  6409     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6410         16  CO-CAN-POSTAL-1                   PIC XXX.
  6411         16  CO-CAN-POSTAL-2                   PIC XXX.
  6412         16  FILLER                            PIC XXX.
  6413     12  CO-SOC-SEC                            PIC X(13).
  6414     12  CO-TELEPHONE.
  6415         16  CO-AREA-CODE                      PIC XXX.
  6416         16  CO-PREFIX                         PIC XXX.
  6417         16  CO-PHONE                          PIC X(4).
  6418
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 122
* EL152.cbl
  6419     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6420
  6421     12  CO-AR-BAL-LEVEL                       PIC X.
  6422         88  CO-AR-REF-LVL                        VALUE '1'.
  6423         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6424         88  CO-AR-BILL-LVL                       VALUE '2'.
  6425         88  CO-AR-AGT-LVL                        VALUE '3'.
  6426         88  CO-AR-FR-LVL                         VALUE '4'.
  6427
  6428     12  CO-AR-NORMAL-PRINT                    PIC X.
  6429         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6430         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6431
  6432     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6433
  6434     12  CO-AR-REPORTING                       PIC X.
  6435         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6436         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6437
  6438     12  CO-AR-PULL-CHECK                      PIC X.
  6439         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6440         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6441
  6442     12  CO-AR-BALANCE-PRINT                   PIC X.
  6443         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6444
  6445     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6446         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6447         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6448         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6449
  6450     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6451
  6452     12  CO-USER-CODE                          PIC X.
  6453     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6454
  6455******************************************************************
  6456*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6457*    THE LAST MONTH END RUN.
  6458******************************************************************
  6459
  6460     12  CO-LAST-ACTIVITY-DATE.
  6461         16  CO-ACT-YEAR                       PIC 99.
  6462         16  CO-ACT-MONTH                      PIC 99.
  6463         16  CO-ACT-DAY                        PIC 99.
  6464
  6465     12  CO-LAST-STMT-DT.
  6466         16  CO-LAST-STMT-YEAR                 PIC 99.
  6467         16  CO-LAST-STMT-MONTH                PIC 99.
  6468         16  CO-LAST-STMT-DAY                  PIC 99.
  6469
  6470     12  CO-MO-END-TOTALS.
  6471         16  CO-MONTHLY-TOTALS.
  6472             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6473             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6474             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6475             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6476             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 123
* EL152.cbl
  6477
  6478         16  CO-AGING-TOTALS.
  6479             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6480             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6481             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6482             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6483
  6484         16  CO-YTD-TOTALS.
  6485             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6486             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6487
  6488         16  CO-OVER-UNDER-TOTALS.
  6489             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6490             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6491
  6492     12  CO-MISCELLANEOUS-TOTALS.
  6493         16  CO-FICA-TOTALS.
  6494             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6495             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6496
  6497         16  CO-CLAIM-TOTALS.
  6498             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6499             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6500
  6501******************************************************************
  6502*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6503*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6504******************************************************************
  6505
  6506     12  CO-CURRENT-TOTALS.
  6507         16  CO-CURRENT-LAST-STMT-DT.
  6508             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6509             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6510             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6511
  6512         16  CO-CURRENT-MONTHLY-TOTALS.
  6513             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6514             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6515             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6516             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6517             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6518
  6519         16  CO-CURRENT-AGING-TOTALS.
  6520             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6521             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6522             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6523             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6524
  6525         16  CO-CURRENT-YTD-TOTALS.
  6526             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6527             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6528
  6529     12  CO-PAID-COMM-TOTALS.
  6530         16  CO-YTD-PAID-COMMS.
  6531             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6532             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6533
  6534     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 124
* EL152.cbl
  6535         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6536         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6537
  6538     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6539         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6540         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6541         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6542         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6543         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6544         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6545         88  CO-FINAL-LETTER                  VALUE 'F'.
  6546         88  CO-RECONCILING                   VALUE 'R'.
  6547         88  CO-PHONE-CALL                    VALUE 'P'.
  6548         88  CO-LEGAL                         VALUE 'L'.
  6549         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6550         88  CO-WRITE-OFF                     VALUE 'W'.
  6551         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6552
  6553     12  CO-CSR-CODE                       PIC X(4).
  6554
  6555     12  CO-GA-STATUS-INFO.
  6556         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6557         16  CO-GA-TERMINATION-DT          PIC XX.
  6558         16  CO-GA-STATUS-CODE             PIC X.
  6559             88  CO-GA-ACTIVE                 VALUE 'A'.
  6560             88  CO-GA-INACTIVE               VALUE 'I'.
  6561             88  CO-GA-PENDING                VALUE 'P'.
  6562         16  CO-GA-COMMENTS.
  6563             20  CO-GA-COMMENT-1           PIC X(40).
  6564             20  CO-GA-COMMENT-2           PIC X(40).
  6565             20  CO-GA-COMMENT-3           PIC X(40).
  6566             20  CO-GA-COMMENT-4           PIC X(40).
  6567
  6568     12  CO-RPTCD2                         PIC X(10).
  6569     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6570         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6571         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6572
  6573     12  CO-TYPE-AGENT                     PIC X(01).
  6574         88  CO-CORPORATION                   VALUE 'C'.
  6575         88  CO-PARTNERSHIP                   VALUE 'P'.
  6576         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6577         88  CO-TRUST                         VALUE 'T'.
  6578         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6579
  6580     12  CO-FAXNO.
  6581         16  CO-FAX-AREA-CODE                  PIC XXX.
  6582         16  CO-FAX-PREFIX                     PIC XXX.
  6583         16  CO-FAX-PHONE                      PIC X(4).
  6584
  6585     12  CO-BANK-INFORMATION.
  6586         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6587         16  CO-BANK-TRANSIT-NON REDEFINES
  6588             CO-BANK-TRANSIT-NO                PIC 9(8).
  6589
  6590         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6591     12  CO-MISC-DEDUCT-INFO REDEFINES
  6592                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 125
* EL152.cbl
  6593         16  CO-MD-GL-ACCT                     PIC X(10).
  6594         16  CO-MD-DIV                         PIC XX.
  6595         16  CO-MD-CENTER                      PIC X(4).
  6596         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6597         16  CO-CREATE-AP-CHECK                PIC X.
  6598         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6599         16  FILLER                            PIC XXX.
  6600     12  CO-ACH-STATUS                         PIC X.
  6601         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6602         88  CO-ACH-PENDING                        VALUE 'P'.
  6603
  6604     12  CO-BILL-SW                            PIC X.
  6605     12  CO-CONTROL-NAME                       PIC X(30).
  6606     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6607     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6608     12  CO-CLP-STATE                          PIC XX.
  6609     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6610     12  CO-SPP-REFUND-EDIT                    PIC X.
  6611
  6612******************************************************************
  6613
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 126
* EL152.cbl
  6615*                                COPY MPCPROD.
  6616*    EJECT
  6617*                                COPY MPCPLCY.
  6618*    EJECT
  6619*                                COPY MPCPLAN.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 127
* EL152.cbl
  6621*                                COPY ELCNAPS.
  6622******************************************************************
  6623*                                                                *
  6624*                            ELCNAPS                             *
  6625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6626*                            VMOD=2.003                          *
  6627*                                                                *
  6628*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  6629*                                                                *
  6630*        FILE TYPE= VSAM,KSDS                                    *
  6631*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6632*                                                                *
  6633*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  6634*                                                                *
  6635*        LOG = YES                                               *
  6636*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6637*                                                                *
  6638******************************************************************
  6639*                   C H A N G E   L O G
  6640*
  6641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6642*-----------------------------------------------------------------
  6643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6644* EFFECTIVE    NUMBER
  6645*-----------------------------------------------------------------
  6646* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  6647******************************************************************
  6648
  6649 01  NAPERSOFT-FILE.
  6650     12  NA-RECORD-ID                PIC  XX.
  6651         88  VALID-NA-ID                  VALUE 'NA'.
  6652
  6653     12  NA-CONTROL-PRIMARY.
  6654         16  NA-COMPANY-CD           PIC X.
  6655         16  NA-CARRIER              PIC X.
  6656         16  NA-CLAIM-NO             PIC X(7).
  6657         16  NA-CERT-NO.
  6658             20  NA-CERT-PRIME       PIC X(10).
  6659             20  NA-CERT-SFX         PIC X.
  6660         16  NA-ARCHIVE-NO           PIC 9(8).
  6661
  6662     12  NA-LETTER-INFORMATION.
  6663         16  NA-LETTER-ID            PIC X(4).
  6664         16  NA-PROCESSOR-ID         PIC X(4).
  6665         16  NA-CREATION-DT          PIC X(2).
  6666         16  NA-INITIAL-PRINT-DT     PIC X(2).
  6667         16  NA-FOLLOW-UP-DT         PIC X(2).
  6668         16  NA-RESEND-DT            PIC X(2).
  6669         16  NA-RESEND-LETTER-ID     PIC X(4).
  6670         16  NA-NO-OF-COPIES         PIC 9(2).
  6671         16  NA-ADDRESS-TYPE         PIC X(2).
  6672         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  6673         16  NA-RESEND-PRINT-DT      PIC X(2).
  6674         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  6675         16  NA-NEXT-DUE-DT          PIC X(2).
  6676         16  NA-AUTOPYDT             PIC X(2).
  6677         16  NA-ENCLOSURE-CD         PIC X(3).
  6678         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 128
* EL152.cbl
  6679         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  6680         16  NA-RESEND-PROMPT-IND    PIC X(1).
  6681         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  6682         16  FILLER                  PIC X(67).
  6683******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 129
* EL152.cbl
  6685*                                COPY ELCENCC.
  6686******************************************************************
  6687*                                                                *
  6688*                                                                *
  6689*                            ELCENCC                             *
  6690*                            VMOD=2.001                          *
  6691*                                                                *
  6692*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  6693*                                                                *
  6694*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  6695*   A NAPERSOFT DOCUMENT                                         *
  6696*                                                                *
  6697*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  6698*                                                                *
  6699*   FILE TYPE = VSAM,KSDS                                        *
  6700*   RECORD SIZE = 400   RECFORM = FIX                            *
  6701*                                                                *
  6702*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  6703*                                                                *
  6704*   LOG = NO                                                     *
  6705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6706*                                                                *
  6707*                                                                *
  6708******************************************************************
  6709*                   C H A N G E   L O G
  6710*
  6711* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6712*-----------------------------------------------------------------
  6713*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6714* EFFECTIVE    NUMBER
  6715*-----------------------------------------------------------------
  6716* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  6717******************************************************************
  6718 01  ENCLOSURE-CODES.
  6719     12  NC-RECORD-ID                      PIC XX.
  6720         88  VALID-NC-ID                      VALUE 'NC'.
  6721     12  NC-CONTROL-PRIMARY.
  6722         16  NC-COMPANY-CD                 PIC X.
  6723         16  NC-REC-TYPE                   PIC X.
  6724             88  NC-CLAIMS                   VALUE '1'.
  6725             88  NC-ADMIN                    VALUE '2'.
  6726         16  NC-ENC-CODE                   PIC X(5).
  6727         16  FILLER                        PIC X(09).
  6728     12  NC-MAINT-INFORMATION.
  6729         16  NC-LAST-MAINT-DT              PIC XX.
  6730         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6731         16  NC-LAST-MAINT-USER            PIC X(4).
  6732         16  FILLER                        PIC XX.
  6733     12  NC-OUTPUT-STACK                   PIC XXX.
  6734     12  NC-ENCLOSURE-LINE                 PIC X(100).
  6735     12  NC-ATTACHMENTS                    PIC X(100).
  6736     12  NC-FUTURE                         PIC X(50).
  6737     12  FILLER                            PIC X(117).
  6738******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 130
* EL152.cbl
  6740*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  6741*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  6742
  6743*01  SYSTEM-VARIABLES            PIC X(3851).
  6744*01  SYS-VAR-ENTRY REDEFINES SYSTEM-VARIABLES.
  6745*    12  SYS-VAR-CODE            PIC X(4).
  6746*    12  SYS-VAR-LEN             PIC 99.
  6747*    12  SYS-VAR-DATA            PIC X(100).
  6748
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 131
* EL152.cbl
  6750 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CLAIM-MASTER
  6751                          CONTROL-FILE LETTER-ARCHIVE
  6752                          LETTER-ARCHIVE-TEMP
  6753                          CERTIFICATE-MASTER ACCOUNT-MASTER
  6754                          TEXT-FILES ACTIVITY-TRAILERS
  6755                          BENEFICIARY-MASTER
  6756                          COMPENSATION-MASTER NAPERSOFT-FILE
  6757                          ENCLOSURE-CODES.
  6758 0000-DFHEXIT SECTION.
  6759     MOVE '9#                    $   ' TO DFHEIV0.
  6760     MOVE 'EL152' TO DFHEIV1.
  6761     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6762
  6763     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6764     MOVE '5'                   TO DC-OPTION-CODE.
  6765     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  6766     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  6767     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  6768
  6769     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  6770     MOVE 1                     TO EMI-NUMBER-OF-LINES.
  6771     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  6772                                TO EMI-SAVE-AREA.
  6773
  6774     MOVE EIBTRMID              TO TS-TERM-TEXT
  6775                                   TS-TERM-SCREEN
  6776                                   QID-TERM.
  6777
  6778     MOVE SAVE-BIN-DATE       TO CURRENT-SAVE.
  6779
  6780*    IF PI-COMPANY-ID = 'DMD'
  6781*       MOVE CURRENT-SAVE           TO DC-BIN-DATE-1
  6782*       MOVE '6'                    TO DC-OPTION-CODE
  6783*       MOVE +3                     TO DC-ELAPSED-MONTHS
  6784*       MOVE +0                     TO DC-ELAPSED-DAYS
  6785*       PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6786*       MOVE DC-BIN-DATE-2          TO CURRENT-PLUS3-SAVE.
  6787
  6788
  6789* EXEC CICS HANDLE CONDITION
  6790*        PGMIDERR (9600-PGMID-ERROR)
  6791*        MAPFAIL  (0325-MAPFAIL)
  6792*        ERROR    (9990-ABEND)
  6793*    END-EXEC.
  6794*    MOVE '"$L?.                 ! " #00006784' TO DFHEIV0
  6795     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  6796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6797     MOVE X'2220233030303036373834' TO DFHEIV0(25:11)
  6798     CALL 'kxdfhei1' USING DFHEIV0
  6799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6800
  6801
  6802     IF PI-PROCESSOR-ID NOT = 'LGXX'
  6803
  6804* EXEC CICS READQ TS
  6805*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6806*            INTO    (SECURITY-CONTROL)
  6807*            LENGTH  (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 132
* EL152.cbl
  6808*            ITEM    (SC-ITEM)
  6809*        END-EXEC
  6810*    MOVE '*$II   L              ''   #00006791' TO DFHEIV0
  6811     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6813     MOVE X'2020233030303036373931' TO DFHEIV0(25:11)
  6814     CALL 'kxdfhei1' USING DFHEIV0,
  6815           PI-SECURITY-TEMP-STORE-ID,
  6816           SECURITY-CONTROL,
  6817           SC-COMM-LENGTH,
  6818           SC-ITEM,
  6819           DFHEIV99,
  6820           DFHEIV99
  6821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6822         MOVE SC-CLAIMS-DISPLAY (7)  TO  PI-DISPLAY-CAP
  6823         MOVE SC-CLAIMS-UPDATE  (7)  TO  PI-MODIFY-CAP.
  6824
  6825     set P to address of KIXSYS
  6826     CALL "getenv" using by value P returning var-ptr
  6827     if var-ptr = null then
  6828        display ' kixsys not set '
  6829     else
  6830        set address of var to var-ptr
  6831        move 0 to env-var-len
  6832        inspect var tallying env-var-len
  6833          for characters before X'00'
  6834        unstring var (1:env-var-len) delimited by '/'
  6835           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6836              WS-KIX-SYS
  6837        end-unstring
  6838     end-if
  6839     IF EIBCALEN = 0
  6840         GO TO 8800-UNAUTHORIZED-ACCESS.
  6841
  6842     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6843         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6844             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6845             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6846             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6847             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6848             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6849             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6850             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6851             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6852             PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
  6853             PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
  6854             PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
  6855             MOVE SPACES              TO PI-WA
  6856                                         PI-FORCE-7840
  6857             MOVE ZEROS               TO PI-TOTAL-LINES
  6858                                         PI-CURRENT-LINE
  6859                                         PI-TEMP-STOR-ITEMS
  6860                                         PI-UPDATE-SW
  6861                                         PI-ADDR-SEQ
  6862             MOVE '2'                 TO PI-ACTION
  6863             MOVE LOW-VALUES          TO EL152AO
  6864                                         PI-ADDR-TYPE
  6865             GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 133
* EL152.cbl
  6866         ELSE
  6867             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6868             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6869             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6870             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6871             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6872             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6873             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6874             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6875             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6876             PERFORM 7500-READ-TS           THRU 7599-EXIT
  6877             PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT
  6878             IF PGM-NAME = PGM-EL141
  6879                PERFORM 500-RECOVER-PI-TEMP-STORAGE THRU 599-EXIT
  6880                SET TB-INDX TO PI-CURRENT-LINE
  6881                PERFORM 400-SET-CODES       THRU 499-EXIT
  6882                PERFORM 7000-READ-ADDR      THRU 7099-EXIT
  6883                PERFORM 7170-FORMAT-SCREEN  THRU 7170-EXIT
  6884                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6885                        SC-INDX > NUM-LINES-PER-SCREEN
  6886                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6887                MOVE AL-UANON           TO PRINTERA
  6888                GO TO 8100-SEND-INITIAL-MAP
  6889             ELSE
  6890                SET TB-INDX TO PI-CURRENT-LINE
  6891                PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6892                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6893                        SC-INDX > NUM-LINES-PER-SCREEN
  6894                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6895                MOVE AL-UANON           TO PRINTERA
  6896                GO TO 8100-SEND-INITIAL-MAP.
  6897
  6898*0100-PA.
  6899*    MOVE ER-0008                TO EMI-ERROR.
  6900*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6901*    MOVE -1                     TO MAINTL.
  6902*    GO TO 8200-SEND-DATAONLY.
  6903
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 134
* EL152.cbl
  6905 0200-RECEIVE.
  6906     MOVE TRANS-ID         TO EIBTRNID.
  6907     MOVE EMI-SAVE-AREA    TO ERROR-MESSAGE-INTERFACE-BLOCK.
  6908     MOVE LOW-VALUES       TO EL152AI.
  6909     MOVE '104A'           TO TS-ID-TEXT.
  6910     MOVE EIBTRMID         TO TS-TERM-TEXT
  6911                              TS-TERM-SCREEN
  6912                              QID-TERM.
  6913
  6914
  6915* EXEC CICS HANDLE AID
  6916*        CLEAR    (9400-CLEAR)
  6917*        PA1      (0100-PA)
  6918*        PA2      (0100-PA)
  6919*        PA3      (0100-PA)
  6920*    END-EXEC.
  6921*    MOVE '"&=!"#               V! # #00006889' TO DFHEIV0
  6922     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  6923     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  6924     MOVE X'2320233030303036383839' TO DFHEIV0(25:11)
  6925     CALL 'kxdfhei1' USING DFHEIV0
  6926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6927
  6928
  6929
  6930* EXEC CICS HANDLE CONDITION
  6931*        MAPFAIL  (0325-MAPFAIL)
  6932*    END-EXEC.
  6933*    MOVE '"$?                   ! $ #00006896' TO DFHEIV0
  6934     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6936     MOVE X'2420233030303036383936' TO DFHEIV0(25:11)
  6937     CALL 'kxdfhei1' USING DFHEIV0
  6938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6939
  6940
  6941
  6942* EXEC CICS SYNCPOINT
  6943*    END-EXEC.
  6944*    MOVE '6"                    !   #00006900' TO DFHEIV0
  6945     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6947     MOVE X'2020233030303036393030' TO DFHEIV0(25:11)
  6948     CALL 'kxdfhei1' USING DFHEIV0
  6949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6950
  6951
  6952     IF LOWER-CASE-LETTERS-USED
  6953
  6954* EXEC CICS RECEIVE
  6955*            MAP      (MAP-NAME)
  6956*            MAPSET   (MAPSET-NAME)
  6957*            INTO     (EL152AI)
  6958*            ASIS
  6959*       END-EXEC
  6960     MOVE LENGTH OF
  6961      EL152AI
  6962       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 135
* EL152.cbl
  6963*    MOVE '8"TAI  L              ''   #00006904' TO DFHEIV0
  6964     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  6965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6966     MOVE X'2020233030303036393034' TO DFHEIV0(25:11)
  6967     CALL 'kxdfhei1' USING DFHEIV0,
  6968           MAP-NAME,
  6969           EL152AI,
  6970           DFHEIV11,
  6971           MAPSET-NAME,
  6972           DFHEIV99,
  6973           DFHEIV99
  6974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6975      ELSE
  6976
  6977* EXEC CICS RECEIVE
  6978*            MAP      (MAP-NAME)
  6979*            MAPSET   (MAPSET-NAME)
  6980*            INTO     (EL152AI)
  6981*       END-EXEC.
  6982     MOVE LENGTH OF
  6983      EL152AI
  6984       TO DFHEIV11
  6985*    MOVE '8"T I  L              ''   #00006911' TO DFHEIV0
  6986     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6988     MOVE X'2020233030303036393131' TO DFHEIV0(25:11)
  6989     CALL 'kxdfhei1' USING DFHEIV0,
  6990           MAP-NAME,
  6991           EL152AI,
  6992           DFHEIV11,
  6993           MAPSET-NAME,
  6994           DFHEIV99,
  6995           DFHEIV99
  6996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6997
  6998
  6999     IF NOT DISPLAY-CAP AND PI-PROCESSOR-ID NOT = 'LGXX'
  7000         MOVE 'READ'             TO  SM-READ
  7001         PERFORM 9995-SECURITY-VIOLATION
  7002         MOVE ER-0070            TO  EMI-ERROR
  7003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7004         GO TO 8100-SEND-INITIAL-MAP.
  7005
  7006     INSPECT MAINTI CONVERTING LOWER-CASE TO UPPER-CASE.
  7007     MOVE 'N'                    TO CLEANI
  7008
  7009     IF ENTERPFL = 0
  7010         GO TO 0300-CHECK-PFKEYS.
  7011     IF EIBAID NOT = DFHENTER
  7012         MOVE ER-0004            TO EMI-ERROR
  7013         GO TO 0320-INPUT-ERROR.
  7014     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7015         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7016     ELSE
  7017         MOVE ER-0029            TO EMI-ERROR
  7018         GO TO 0320-INPUT-ERROR.
  7019
  7020 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 136
* EL152.cbl
  7021     IF EIBAID = DFHPF23
  7022         GO TO 8810-PF23.
  7023     IF EIBAID = DFHPF24
  7024         GO TO 9200-RETURN-MAIN-MENU.
  7025*    IF EIBAID = DFHPF12
  7026*        GO TO 9500-PF12.
  7027     IF EIBAID = DFHPF1
  7028         MOVE 7                  TO ROLL-COUNTER
  7029         GO TO 7900-ROLL-PAGE.
  7030     IF EIBAID = DFHPF2
  7031         MOVE -7                 TO ROLL-COUNTER
  7032         GO TO 7900-ROLL-PAGE.
  7033     IF EIBAID = DFHPF3
  7034         GO TO 6100-ADDR-MAINT.
  7035     IF EIBAID = DFHPF4
  7036         IF MODIFY-CAP
  7037             GO TO 6200-EDIT-MODE
  7038         ELSE
  7039             MOVE 'UPDATE'       TO  SM-READ
  7040             PERFORM 9995-SECURITY-VIOLATION
  7041             MOVE ER-0070        TO  EMI-ERROR
  7042             GO TO 0320-INPUT-ERROR.
  7043
  7044     IF EIBAID = DFHPF5
  7045         GO TO 0330-FUNCTION-CHECK.
  7046
  7047     IF EIBAID = DFHPF6
  7048         GO TO 0330-FUNCTION-CHECK.
  7049
  7050     IF EIBAID = DFHPF7
  7051        COMPUTE ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  7052        GO TO 7900-ROLL-PAGE.
  7053
  7054     IF EIBAID = DFHPF8
  7055        MOVE PI-TOTAL-LINES TO ROLL-COUNTER
  7056        GO TO 7900-ROLL-PAGE.
  7057
  7058*    IF EIBAID = DFHPF9 AND
  7059*       PI-COMPANY-ID = 'DMD'
  7060*        MOVE '1'           TO PI-FORCE-7840
  7061*        GO TO 0330-FUNCTION-CHECK.
  7062
  7063     IF EIBAID = DFHENTER
  7064         GO TO 0330-FUNCTION-CHECK.
  7065
  7066     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7067
  7068     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  7069     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7070             VARYING SC-INDX FROM 1 BY 1
  7071             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7072
  7073     MOVE ER-0029                TO EMI-ERROR.
  7074 0320-INPUT-ERROR.
  7075     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7076     MOVE AL-UNBON               TO ENTERPFA.
  7077     IF ENTERPFL = 0
  7078         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 137
* EL152.cbl
  7079     ELSE
  7080         MOVE -1                 TO ENTERPFL.
  7081
  7082     GO TO 8200-SEND-DATAONLY.
  7083
  7084 0100-PA.
  7085     MOVE ER-0008                TO EMI-ERROR.
  7086     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7087     MOVE -1                     TO MAINTL.
  7088     GO TO 8200-SEND-DATAONLY.
  7089
  7090 0325-MAPFAIL.
  7091***********************************************************
  7092*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  7093*      LETTERS ON A 3275 PRINTER.                         *
  7094***********************************************************
  7095
  7096     PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT.
  7097
  7098     SET TB-INDX         TO PI-CURRENT-LINE.
  7099     PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  7100                  VARYING SC-INDX FROM 1 BY 1 UNTIL
  7101                  SC-INDX > NUM-LINES-PER-SCREEN.
  7102
  7103     GO TO 8100-SEND-INITIAL-MAP.
  7104
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 138
* EL152.cbl
  7106 0330-FUNCTION-CHECK.
  7107     IF NOT MODIFY-CAP
  7108         IF MAINTI = 'S'
  7109             NEXT SENTENCE
  7110         ELSE
  7111             MOVE 'UPDATE'           TO  SM-READ
  7112             PERFORM 9995-SECURITY-VIOLATION
  7113             MOVE ER-0070            TO  EMI-ERROR
  7114             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7115             GO TO 8100-SEND-INITIAL-MAP.
  7116
  7117     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  7118
  7119     IF EIBAID = DFHPF5
  7120      IF PI-PROMPT-LETTER = 'Y'
  7121         MOVE ER-0894            TO EMI-ERROR
  7122         MOVE -1             TO MAINTL
  7123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7124         MOVE AL-UABON       TO MAINTA
  7125         GO TO 8200-SEND-DATAONLY
  7126      ELSE
  7127         IF MAINTI NOT = 'C'
  7128             MOVE ER-0716        TO EMI-ERROR
  7129             MOVE -1             TO MAINTL
  7130             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7131             MOVE AL-UABON       TO MAINTA
  7132             GO TO 8200-SEND-DATAONLY
  7133         ELSE
  7134             IF MODIFY-CAP
  7135                 GO TO 6400-LETTER-RELEASE
  7136             ELSE
  7137                 IF PRINT-PERFORMED
  7138                     GO TO 6400-LETTER-RELEASE
  7139                 ELSE
  7140                     MOVE AL-UNBON TO ENTERPFA
  7141                     MOVE -1       TO ENTERPFL
  7142                     MOVE ER-2398 TO EMI-ERROR
  7143                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7144                     GO TO 8200-SEND-DATAONLY.
  7145
  7146     IF EIBAID = DFHPF6
  7147      IF PI-PROMPT-LETTER = 'Y'
  7148         MOVE ER-0894            TO EMI-ERROR
  7149         MOVE -1             TO MAINTL
  7150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7151         MOVE AL-UABON       TO MAINTA
  7152         GO TO 8200-SEND-DATAONLY
  7153      ELSE
  7154         GO TO 7800-PRINT-LETTER-NOW.
  7155
  7156     IF MAINTI = 'S'
  7157         GO TO 1000-SHOW.
  7158
  7159     IF MAINTI = 'C'
  7160         GO TO 2000-CREATE.
  7161
  7162     IF MAINTI = 'R'
  7163        IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 139
* EL152.cbl
  7164           MOVE ER-0070          TO EMI-ERROR
  7165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7166           MOVE LOW-VALUES       TO EL152AO
  7167           GO TO 8100-SEND-INITIAL-MAP
  7168          ELSE
  7169           GO TO 3000-RECORD.
  7170
  7171     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7172     PERFORM 7950-SET-INDX       THRU 7950-EXIT
  7173     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN
  7174                                 THRU 7960-EXIT
  7175        VARYING SC-INDX FROM 1 BY 1 UNTIL
  7176        SC-INDX > NUM-LINES-PER-SCREEN
  7177     MOVE ER-0023                TO EMI-ERROR.
  7178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7179     MOVE -1                     TO MAINTL.
  7180     MOVE AL-UABON               TO MAINTA.
  7181     GO TO 8200-SEND-DATAONLY.
  7182
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 140
* EL152.cbl
  7184 0350-EDIT-ROUTINE.
  7185     PERFORM 400-SET-CODES THRU 499-EXIT.
  7186     MOVE PI-CLAIM-NO    TO CLAM-CLAIM
  7187                            ACTV-CLAIM.
  7188
  7189     IF ADDRL NOT = +0
  7190        INSPECT ADDRI CONVERTING LOWER-CASE TO UPPER-CASE
  7191        MOVE ADDRI           TO WS-ADDR-TYPE-CD
  7192        IF WS-ADDR-TYPE = 'I' OR 'B' OR 'A' OR 'P' OR
  7193                          'O' OR 'Q' OR 'E'
  7194           MOVE AL-UANON         TO ADDRA
  7195        ELSE
  7196           MOVE -1               TO ADDRL
  7197           MOVE AL-UABON         TO ADDRA
  7198           MOVE ER-0176          TO EMI-ERROR
  7199           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7200*     ELSE
  7201*       IF PI-COMPANY-ID = 'DMD'
  7202*        IF MAINTI = 'C' OR 'R'
  7203*          MOVE -1               TO ADDRL
  7204*          MOVE AL-UABON         TO ADDRA
  7205*          MOVE ER-0861          TO EMI-ERROR
  7206*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7207
  7208     IF ADDRL NOT = +0
  7209        IF WS-ADDR-SEQ NOT NUMERIC
  7210           MOVE -1               TO ADDRL
  7211           MOVE AL-UABON         TO ADDRA
  7212           MOVE ER-0176          TO EMI-ERROR
  7213           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7214
  7215*    IF ADDRL NOT = +0
  7216*       IF PI-COMPANY-ID = 'DMD'
  7217*          IF WS-ADDR-TYPE = 'B' AND
  7218*             WS-ADDR-SEQ NOT = '9'
  7219*                MOVE -1               TO ADDRL
  7220*                MOVE AL-UABON         TO ADDRA
  7221*                MOVE ER-7842          TO EMI-ERROR
  7222*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7223
  7224     IF FORML NOT = ZEROS
  7225        INSPECT FORMI CONVERTING LOWER-CASE TO UPPER-CASE.
  7226
  7227     IF MAINTI = 'C' AND FORML = ZEROS
  7228        MOVE -1                  TO FORML
  7229        MOVE ER-0177             TO EMI-ERROR
  7230        MOVE AL-UABON            TO FORMA
  7231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7232
  7233     IF FOLLOWL NOT = ZEROS
  7234        MOVE FOLLOWI             TO DEEDIT-FIELD
  7235        PERFORM 8600-DEEDIT
  7236        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7237        MOVE '4'                 TO DC-OPTION-CODE
  7238        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7239        IF DATE-CONVERSION-ERROR
  7240           MOVE ER-0182          TO EMI-ERROR
  7241           MOVE -1               TO FOLLOWL
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 141
* EL152.cbl
  7242           MOVE AL-UABON         TO FOLLOWA
  7243           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7244        ELSE
  7245*          IF (PI-COMPANY-ID = 'DMD') AND
  7246*             (NOT FORCE-7840)        AND
  7247*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7248*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7249*              MOVE AL-SABON         TO PFKEY9A
  7250*              MOVE ER-7840          TO EMI-ERROR
  7251*              MOVE -1               TO FOLLOWL
  7252*              MOVE AL-UABON         TO FOLLOWA
  7253*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7254*          ELSE
  7255             MOVE SPACES                TO PFKEY9O
  7256             MOVE AL-SADON              TO PFKEY9A
  7257             MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWO
  7258             MOVE AL-UANON              TO FOLLOWA
  7259             MOVE DC-BIN-DATE-1         TO FOLLOW-UP-SAVE
  7260     ELSE
  7261        MOVE LOW-VALUES                 TO FOLLOW-UP-SAVE.
  7262
  7263     IF FOLLOW-UP-SAVE NOT = LOW-VALUES
  7264        IF FOLLOW-UP-SAVE NOT > CURRENT-SAVE
  7265           MOVE ER-0533          TO EMI-ERROR
  7266           MOVE AL-UABON         TO FOLLOWA
  7267           MOVE -1               TO FOLLOWL
  7268           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7269
  7270     IF RESENDL NOT = ZEROS
  7271        MOVE RESENDI             TO DEEDIT-FIELD
  7272        PERFORM 8600-DEEDIT
  7273        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7274        MOVE '4'                 TO DC-OPTION-CODE
  7275        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7276        IF DATE-CONVERSION-ERROR
  7277           MOVE ER-0185          TO EMI-ERROR
  7278           MOVE -1               TO RESENDL
  7279           MOVE AL-UABON         TO RESENDA
  7280           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7281         ELSE
  7282*          IF (PI-COMPANY-ID = 'DMD') AND
  7283*             (NOT FORCE-7840)        AND
  7284*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7285*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7286*              MOVE AL-SABON         TO PFKEY9A
  7287*              MOVE ER-7840          TO EMI-ERROR
  7288*              MOVE -1               TO RESENDL
  7289*              MOVE AL-UABON         TO RESENDA
  7290*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7291*          ELSE
  7292             MOVE SPACES                 TO PFKEY9O
  7293             MOVE AL-SADON               TO PFKEY9A
  7294             MOVE DC-GREG-DATE-1-EDIT    TO RESENDO
  7295             MOVE AL-UANON               TO RESENDA
  7296             MOVE DC-BIN-DATE-1          TO RESEND-SAVE
  7297     ELSE
  7298        MOVE LOW-VALUE                   TO RESEND-SAVE.
  7299
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 142
* EL152.cbl
  7300     IF RESEND-SAVE NOT = LOW-VALUES
  7301        IF RESEND-SAVE NOT > CURRENT-SAVE
  7302           MOVE ER-0537          TO EMI-ERROR
  7303           MOVE AL-UABON         TO RESENDA
  7304           MOVE -1               TO RESENDL
  7305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7306
  7307     IF PRINTL NOT = ZEROS
  7308        INSPECT PRINTI CONVERTING LOWER-CASE TO UPPER-CASE
  7309        IF PRINTI = 'Y' OR = ' '
  7310           MOVE AL-UANON         TO PRINTA
  7311        ELSE
  7312           MOVE ER-0183          TO EMI-ERROR
  7313           MOVE -1               TO PRINTL
  7314           MOVE AL-UABON         TO PRINTA
  7315           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7316
  7317     MOVE 'Y'                    TO CLEANO
  7318     IF ENCL <= ZEROS
  7319        MOVE 'N'                 TO CLEANO
  7320     END-IF
  7321     IF ENCL > ZEROS
  7322        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  7323                                          PI-ENCLOSURE-CD
  7324        MOVE SPACES             TO ELENCC-KEY
  7325        MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  7326        MOVE '1'                TO ELENCC-REC-TYPE
  7327        MOVE ENCI               TO ELENCC-ENC-CODE
  7328
  7329
  7330* EXEC CICS READ
  7331*           DATASET    (ENCC-ID)
  7332*           SET        (ADDRESS OF ENCLOSURE-CODES)
  7333*           RIDFLD     (ELENCC-KEY)
  7334*           RESP       (WS-RESPONSE)
  7335*       END-EXEC
  7336*    MOVE '&"S        E          (  N#00007247' TO DFHEIV0
  7337     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7338     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7339     MOVE X'204E233030303037323437' TO DFHEIV0(25:11)
  7340     CALL 'kxdfhei1' USING DFHEIV0,
  7341           ENCC-ID,
  7342           DFHEIV20,
  7343           DFHEIV99,
  7344           ELENCC-KEY,
  7345           DFHEIV99,
  7346           DFHEIV99,
  7347           DFHEIV99
  7348     SET ADDRESS OF ENCLOSURE-CODES TO
  7349         DFHEIV20
  7350     MOVE EIBRESP  TO WS-RESPONSE
  7351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7352
  7353        IF RESP-NORMAL
  7354           MOVE ENCI             TO PI-ENCLOSURE-CD
  7355                                    W-ENCLOSURE-CD
  7356           MOVE AL-UANON         TO ENCA
  7357        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 143
* EL152.cbl
  7358           MOVE 'N'              TO CLEANO
  7359           MOVE ER-1560          TO EMI-ERROR
  7360           MOVE -1               TO ENCL
  7361           MOVE AL-UABON         TO ENCA
  7362           PERFORM 9900-ERROR-FORMAT
  7363                                 THRU 9900-EXIT
  7364        END-IF
  7365     END-IF
  7366     IF COPIESL NOT = ZEROS
  7367        IF COPIESI NOT NUMERIC OR
  7368           COPIESI = '0'
  7369           MOVE ER-0184          TO EMI-ERROR
  7370           MOVE -1               TO COPIESL
  7371           MOVE AL-UABON         TO COPIESA
  7372           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7373        ELSE
  7374           MOVE AL-UANON         TO COPIESA.
  7375
  7376     IF PI-PROCESSOR-PRINTER NOT = SPACES
  7377         MOVE PI-PROCESSOR-PRINTER   TO  PI-ALT-PRINTER-ID.
  7378
  7379     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  7380
  7381     IF PRINTERL > ZERO
  7382        INSPECT PRINTERI CONVERTING LOWER-CASE TO UPPER-CASE
  7383        MOVE AL-UANON            TO PRINTERA
  7384        MOVE PRINTERI            TO PI-ALT-PRINTER-ID
  7385                                    PI-ALT-DMD-PRT-ID
  7386     ELSE
  7387        IF (PI-NO-CARRIER-SECURITY AND
  7388            PI-NO-ACCOUNT-SECURITY) OR
  7389            PI-PROCESSOR-PRINTER NOT = SPACES
  7390             NEXT SENTENCE
  7391        ELSE
  7392            MOVE AL-UABON       TO PRINTERA
  7393            MOVE -1             TO PRINTERL
  7394            MOVE ER-2397        TO EMI-ERROR
  7395            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7396
  7397     IF ACTL NOT = +0
  7398         MOVE ZEROS              TO W-ACCOUNT
  7399         IF ACTI > SPACES
  7400             IF ACTI NUMERIC
  7401                     AND
  7402                ACTI NOT < 1
  7403                     AND
  7404                ACTI NOT > 9
  7405                 MOVE AL-UANON   TO ACTA
  7406                 MOVE ACTI       TO W-ACCOUNT
  7407                                    W-LETTER-ADDR-SEQ
  7408                 MOVE 'A'        TO W-LETTER-ADDR-TYPE
  7409             ELSE
  7410                 MOVE -1         TO ACTL
  7411                 MOVE AL-UABON   TO ACTA
  7412                 MOVE ER-3547    TO EMI-ERROR
  7413                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7414
  7415     IF BENL NOT = +0
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 144
* EL152.cbl
  7416         MOVE ZEROS              TO W-BENEFICIARY
  7417         IF BENI > SPACES
  7418             IF BENI NUMERIC
  7419                     AND
  7420                BENI NOT < 1
  7421                     AND
  7422                BENI NOT > 9
  7423                 MOVE AL-UANON   TO BENA
  7424                 MOVE BENI       TO W-BENEFICIARY
  7425                                    W-LETTER-ADDR-SEQ
  7426                 MOVE 'B'        TO W-LETTER-ADDR-TYPE
  7427             ELSE
  7428                 MOVE -1         TO BENL
  7429                 MOVE AL-UABON   TO BENA
  7430                 MOVE ER-3547    TO EMI-ERROR
  7431                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7432
  7433     IF EMPL NOT = +0
  7434         MOVE ZEROS              TO W-EMPLOYER
  7435         IF EMPI > SPACES
  7436             IF EMPI NUMERIC
  7437                     AND
  7438                EMPI NOT < 1
  7439                     AND
  7440                EMPI NOT > 9
  7441                 MOVE AL-UANON   TO EMPA
  7442                 MOVE EMPI       TO W-EMPLOYER
  7443                                    W-LETTER-ADDR-SEQ
  7444                 MOVE 'E'        TO W-LETTER-ADDR-TYPE
  7445             ELSE
  7446                 MOVE -1         TO EMPL
  7447                 MOVE AL-UABON   TO EMPA
  7448                 MOVE ER-3547    TO EMI-ERROR
  7449                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7450
  7451     IF INSL NOT = +0
  7452         MOVE ZEROS              TO W-INSURED
  7453         IF INSI > SPACES
  7454             IF INSI NUMERIC
  7455                     AND
  7456                INSI NOT < 1
  7457                     AND
  7458                INSI NOT > 9
  7459                 MOVE AL-UANON   TO INSA
  7460                 MOVE INSI       TO W-INSURED
  7461                                    W-LETTER-ADDR-SEQ
  7462                 MOVE 'I'        TO W-LETTER-ADDR-TYPE
  7463             ELSE
  7464                 MOVE -1         TO INSL
  7465                 MOVE AL-UABON   TO INSA
  7466                 MOVE ER-3547    TO EMI-ERROR
  7467                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7468
  7469     IF PHYSL NOT = +0
  7470         MOVE ZEROS              TO W-PHYSICIAN
  7471         IF PHYSI > SPACES
  7472             IF PHYSI NUMERIC
  7473                     AND
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 145
* EL152.cbl
  7474                PHYSI NOT < 1
  7475                     AND
  7476                PHYSI NOT > 9
  7477                 MOVE AL-UANON   TO PHYSA
  7478                 MOVE PHYSI      TO W-PHYSICIAN
  7479                                    W-LETTER-ADDR-SEQ
  7480                 MOVE 'P'        TO W-LETTER-ADDR-TYPE
  7481             ELSE
  7482                 MOVE -1         TO PHYSL
  7483                 MOVE AL-UABON   TO PHYSA
  7484                 MOVE ER-3547    TO EMI-ERROR
  7485                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7486
  7487     IF OTHR1L NOT = +0
  7488         MOVE ZEROS              TO W-OTHER-1
  7489         IF OTHR1I > SPACES
  7490             IF OTHR1I NUMERIC
  7491                     AND
  7492                OTHR1I NOT < 1
  7493                     AND
  7494                OTHR1I NOT > 9
  7495                 MOVE AL-UANON   TO OTHR1A
  7496                 MOVE OTHR1I     TO W-OTHER-1
  7497                                    W-LETTER-ADDR-SEQ
  7498                 MOVE 'O'        TO W-LETTER-ADDR-TYPE
  7499             ELSE
  7500                 MOVE -1         TO OTHR1L
  7501                 MOVE AL-UABON   TO OTHR1A
  7502                 MOVE ER-3547    TO EMI-ERROR
  7503                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7504
  7505     IF OTHR2L NOT = +0
  7506         MOVE ZEROS              TO W-OTHER-2
  7507         IF OTHR2I > SPACES
  7508             IF OTHR2I NUMERIC
  7509                     AND
  7510                OTHR2I NOT < 1
  7511                     AND
  7512                OTHR2I NOT > 9
  7513                 MOVE AL-UANON   TO OTHR2A
  7514                 MOVE OTHR2I     TO W-OTHER-2
  7515                                    W-LETTER-ADDR-SEQ
  7516                 MOVE 'Q'        TO W-LETTER-ADDR-TYPE
  7517             ELSE
  7518                 MOVE -1         TO OTHR2L
  7519                 MOVE AL-UABON   TO OTHR2A
  7520                 MOVE ER-3547    TO EMI-ERROR
  7521                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7522
  7523     IF NOT EMI-NO-ERRORS
  7524        GO TO 8200-SEND-DATAONLY.
  7525
  7526 0350-EXIT.
  7527      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 146
* EL152.cbl
  7529 400-SET-CODES.
  7530     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7531     MOVE PI-COMPANY-CD          TO CLAM-CO
  7532                                    TEXT-CO
  7533                                    ACTV-CO
  7534                                    CERT-CO
  7535                                    ACCT-CO
  7536                                    ARCH-CO
  7537                                    PROD-CO
  7538                                    PLCY-CO
  7539                                    PLAN-CO.
  7540
  7541     MOVE PI-CARRIER             TO CLAM-CARRIER
  7542                                    ACTV-CARRIER
  7543                                    CERT-CARRIER
  7544                                    ACCT-CARRIER
  7545                                    PROD-CARRIER
  7546                                    PLCY-CARRIER
  7547                                    PLAN-CARRIER.
  7548
  7549     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  7550                                    ACTV-CERT-NUM
  7551                                    CERT-CERT-NUM.
  7552 499-EXIT.
  7553      EXIT.
  7554
  7555 500-RECOVER-PI-TEMP-STORAGE.
  7556
  7557
  7558* EXEC CICS HANDLE CONDITION
  7559*        QIDERR   (590-QIDERR)
  7560*    END-EXEC.
  7561*    MOVE '"$N                   ! % #00007458' TO DFHEIV0
  7562     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7564     MOVE X'2520233030303037343538' TO DFHEIV0(25:11)
  7565     CALL 'kxdfhei1' USING DFHEIV0
  7566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7567
  7568
  7569
  7570* EXEC CICS READQ TS
  7571*        QUEUE    (WS-PI-QID)
  7572*        INTO     (PROGRAM-INTERFACE-BLOCK)
  7573*        LENGTH   (PI-COMM-LENGTH)
  7574*    END-EXEC.
  7575*    MOVE '*$I    L              ''   #00007462' TO DFHEIV0
  7576     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7578     MOVE X'2020233030303037343632' TO DFHEIV0(25:11)
  7579     CALL 'kxdfhei1' USING DFHEIV0,
  7580           WS-PI-QID,
  7581           PROGRAM-INTERFACE-BLOCK,
  7582           PI-COMM-LENGTH,
  7583           DFHEIV99,
  7584           DFHEIV99,
  7585           DFHEIV99
  7586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 147
* EL152.cbl
  7587
  7588
  7589     PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT.
  7590
  7591     GO TO 599-EXIT.
  7592
  7593 590-QIDERR.
  7594
  7595     IF EIBTRNID = TRANS-ID
  7596         MOVE ER-0033                   TO  EMI-ERROR
  7597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7598         GO TO 8200-SEND-DATAONLY.
  7599
  7600 599-EXIT.
  7601     EXIT.
  7602
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 148
* EL152.cbl
  7604 1000-SHOW.
  7605***************************************************************
  7606*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  7607*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN. THE TEXT      *
  7608*     WILL BE INSERTED INTO THE TS-TABLE AND DISPLAYED TO     *
  7609*     OPERATOR.                                               *
  7610***************************************************************
  7611
  7612     MOVE SPACES                 TO RECORD-TABLE.
  7613     IF ARCHNUML = ZEROS
  7614        MOVE -1                  TO ARCHNUML
  7615        MOVE AL-UNBON            TO ARCHNUMA
  7616        MOVE ER-0174             TO EMI-ERROR
  7617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7618        GO TO 8200-SEND-DATAONLY.
  7619
  7620     IF ARCHNUMI NOT NUMERIC
  7621        MOVE -1                  TO ARCHNUML
  7622        MOVE AL-UNBON            TO ARCHNUMA
  7623        MOVE ER-0175             TO EMI-ERROR
  7624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7625        GO TO 8200-SEND-DATAONLY.
  7626
  7627     IF PI-SHOW-MODE
  7628*       IF PI-ARCHIVE-NUMBER = ARCHNUMI
  7629*          MOVE -1               TO MAINTL
  7630*          GO TO 8200-SEND-DATAONLY
  7631*       ELSE
  7632           PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
  7633
  7634     MOVE ARCHNUMI               TO ARCH-NUMBER
  7635                                    PI-ARCHIVE-NUMBER.
  7636     MOVE ' '                    TO ARCH-REC-TYPE.
  7637     MOVE '1'                    TO PI-ACTION.
  7638     MOVE ZEROS                  TO PI-ADDR-SEQ.
  7639     MOVE LOW-VALUES             TO PI-ADDR-TYPE.
  7640     MOVE SPACES                 TO PI-PRINT-SW
  7641                                    PI-FORM-NUMBER.
  7642     SET TB-INDX TO 1.
  7643
  7644     MOVE SPACE                  TO WS-LETTER-STATUS.
  7645
  7646
  7647* EXEC CICS HANDLE CONDITION
  7648*         NOTOPEN    (8850-ARCH-NOT-OPEN)
  7649*         NOTFND     (1020-ENDBR)
  7650*         ENDFILE    (1020-ENDBR)
  7651*    END-EXEC.
  7652*    MOVE '"$JI''                 ! & #00007525' TO DFHEIV0
  7653     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  7654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7655     MOVE X'2620233030303037353235' TO DFHEIV0(25:11)
  7656     CALL 'kxdfhei1' USING DFHEIV0
  7657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7658
  7659
  7660     MOVE ARCH-PARTIAL-KEY       TO ARCH-SAVE-KEY.
  7661
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 149
* EL152.cbl
  7662
  7663* EXEC CICS STARTBR
  7664*         DATASET    (ARCH-ID)
  7665*         RIDFLD     (ARCH-KEY)
  7666*         GTEQ
  7667*    END-EXEC
  7668     MOVE 0
  7669       TO DFHEIV11
  7670*    MOVE '&,         G          &   #00007533' TO DFHEIV0
  7671     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7672     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7673     MOVE X'2020233030303037353333' TO DFHEIV0(25:11)
  7674     CALL 'kxdfhei1' USING DFHEIV0,
  7675           ARCH-ID,
  7676           ARCH-KEY,
  7677           DFHEIV99,
  7678           DFHEIV11,
  7679           DFHEIV99
  7680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7681
  7682     MOVE 'Y'                    TO ARCH-BROWSE-STARTED.
  7683
  7684 1010-READ-NEXT.
  7685
  7686* EXEC CICS READNEXT
  7687*         SET       (ADDRESS OF LETTER-ARCHIVE)
  7688*         DATASET   (ARCH-ID)
  7689*         RIDFLD    (ARCH-KEY)
  7690*    END-EXEC.
  7691     MOVE 0
  7692       TO DFHEIV11
  7693*    MOVE '&.S                   )   #00007542' TO DFHEIV0
  7694     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7695     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7696     MOVE X'2020233030303037353432' TO DFHEIV0(25:11)
  7697     CALL 'kxdfhei1' USING DFHEIV0,
  7698           ARCH-ID,
  7699           DFHEIV20,
  7700           DFHEIV99,
  7701           ARCH-KEY,
  7702           DFHEIV99,
  7703           DFHEIV11,
  7704           DFHEIV99,
  7705           DFHEIV99
  7706     SET ADDRESS OF LETTER-ARCHIVE TO
  7707         DFHEIV20
  7708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7709
  7710
  7711     IF LA-FORM-CONTROL-HDR
  7712        GO TO 1020-ENDBR.
  7713
  7714
  7715     IF NOT LA-HEADER-DATA
  7716         NEXT SENTENCE
  7717     ELSE
  7718         IF NOT LA-CSO-LETTER-PURGED
  7719             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 150
* EL152.cbl
  7720         ELSE
  7721             MOVE 'P'            TO WS-LETTER-STATUS
  7722             GO TO 1020-ENDBR.
  7723
  7724     IF ARCH-PARTIAL-KEY = ARCH-SAVE-KEY
  7725        IF LA-HEADER-DATA
  7726           PERFORM 1040-FORMAT-RESEND
  7727           MOVE LA-NO-OF-COPIES    TO COPIESO
  7728           PERFORM 1050-GET-CORRESPOND THRU 1059-EXIT
  7729           GO TO 1010-READ-NEXT
  7730        ELSE
  7731           IF LA-ADDRESS-DATA
  7732              MOVE LA-ADDRESS-LINE   TO REC-TEXT (TB-INDX)
  7733              MOVE ZEROS             TO REC-PC (TB-INDX)
  7734              SET TB-INDX UP BY 1
  7735              GO TO 1010-READ-NEXT
  7736           ELSE
  7737              PERFORM 1030-TEXT-BUILD
  7738              GO TO 1010-READ-NEXT.
  7739
  7740 1020-ENDBR.
  7741     IF ARCH-BROWSE-STARTED = 'Y'
  7742        MOVE 'N'                TO ARCH-BROWSE-STARTED
  7743
  7744* EXEC CICS ENDBR
  7745*            DATASET   (ARCH-ID)
  7746*       END-EXEC
  7747     MOVE 0
  7748       TO DFHEIV11
  7749*    MOVE '&2                    $   #00007580' TO DFHEIV0
  7750     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7752     MOVE X'2020233030303037353830' TO DFHEIV0(25:11)
  7753     CALL 'kxdfhei1' USING DFHEIV0,
  7754           ARCH-ID,
  7755           DFHEIV11,
  7756           DFHEIV99
  7757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7758     END-IF.
  7759
  7760*    IF PI-COMPANY-ID = 'CID'
  7761         IF TB-INDX = 1
  7762             IF WS-LETTER-STATUS EQUAL 'P'
  7763                 MOVE 9021           TO EMI-ERROR
  7764                 MOVE -1             TO ARCHNUML
  7765                 MOVE AL-UNBON       TO ARCHNUMA
  7766                 PERFORM 9900-ERROR-FORMAT THRU
  7767                         9900-EXIT
  7768                 GO TO 8200-SEND-DATAONLY
  7769             ELSE
  7770                 MOVE ER-0006             TO EMI-ERROR
  7771                 MOVE -1                  TO ARCHNUML
  7772                 MOVE AL-UNBON            TO ARCHNUMA
  7773                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7774                 GO TO 8200-SEND-DATAONLY
  7775             END-IF
  7776         END-IF
  7777*    ELSE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 151
* EL152.cbl
  7778*        IF TB-INDX = 1
  7779*            MOVE ER-0006             TO EMI-ERROR
  7780*            MOVE -1                  TO ARCHNUML
  7781*            MOVE AL-UNBON            TO ARCHNUMA
  7782*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7783*            GO TO 8200-SEND-DATAONLY
  7784*        END-IF
  7785*    END-IF
  7786
  7787
  7788     SET TB-INDX DOWN BY 1.
  7789     SET PI-TOTAL-LINES          TO TB-INDX.
  7790     MOVE 1                      TO PI-CURRENT-LINE.
  7791     SET TB-INDX TO 1.
  7792
  7793     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7794             VARYING SC-INDX FROM 1 BY 1
  7795               UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7796
  7797     MOVE SPACES                 TO PI-ADDR-TYPE
  7798                                    MAINTI.
  7799     MOVE -1                     TO MAINTL.
  7800
  7801     GO TO 8100-SEND-INITIAL-MAP.
  7802
  7803 1030-TEXT-BUILD.
  7804***** IF THERE ARE NO ADDRESS LINES OR LESS THAN 6 LINES, SET TO
  7805***** TOP OF FORM.
  7806     IF TB-INDX < 7
  7807        SET TB-INDX   TO 7.
  7808
  7809     IF TB-INDX = 7
  7810        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7811        SET TB-INDX UP BY 1.
  7812
  7813     MOVE LA-TEXT-LINE           TO REC-TEXT (TB-INDX).
  7814     MOVE LA-SKIP-CONTROL        TO REC-PC (TB-INDX)
  7815                                    INDX-WORK.
  7816
  7817     IF INDX-WORK NOT = 99
  7818        SET TB-INDX UP BY 1
  7819        SET TB-INDX UP BY INDX-WORK
  7820     ELSE
  7821        SET TB-INDX UP BY 1
  7822        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7823        SET TB-INDX UP BY 1.
  7824
  7825 1040-FORMAT-RESEND.
  7826     IF LA-RESEND-DATE = LOW-VALUES
  7827        MOVE SPACES                 TO RESENDI
  7828       ELSE
  7829        MOVE LA-RESEND-DATE         TO DC-BIN-DATE-1
  7830        MOVE ' '                    TO DC-OPTION-CODE
  7831        PERFORM 9700-DATE-LINK  THRU 9700-EXIT
  7832        MOVE DC-GREG-DATE-1-EDIT    TO RESENDO.
  7833
  7834 1050-GET-CORRESPOND.
  7835     MOVE LA-CARRIER             TO ACTV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 152
* EL152.cbl
  7836     MOVE LA-CLAIM-NO            TO ACTV-CLAIM.
  7837     MOVE LA-CERT-NO             TO ACTV-CERT-NUM.
  7838     MOVE LA-CORR-TRLR-SEQ       TO ACTV-SEQ.
  7839
  7840
  7841* EXEC CICS READ
  7842*         DATASET     (ACTV-ID)
  7843*         RIDFLD      (ACTV-KEY)
  7844*         SET         (ADDRESS OF ACTIVITY-TRAILERS)
  7845*    END-EXEC.
  7846*    MOVE '&"S        E          (   #00007665' TO DFHEIV0
  7847     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7849     MOVE X'2020233030303037363635' TO DFHEIV0(25:11)
  7850     CALL 'kxdfhei1' USING DFHEIV0,
  7851           ACTV-ID,
  7852           DFHEIV20,
  7853           DFHEIV99,
  7854           ACTV-KEY,
  7855           DFHEIV99,
  7856           DFHEIV99,
  7857           DFHEIV99
  7858     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7859         DFHEIV20
  7860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7861
  7862
  7863     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  7864        MOVE SPACES                TO FOLLOWI
  7865     ELSE
  7866        MOVE SPACES                TO DC-OPTION-CODE
  7867        MOVE AT-RECEIPT-FOLLOW-UP  TO DC-BIN-DATE-1
  7868        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7869        MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWI.
  7870
  7871     MOVE SPACES                 TO ADDRI
  7872     MOVE AT-STD-LETTER-FORM     TO FORMI
  7873     MOVE AT-REASON-TEXT         TO REI.
  7874
  7875 1059-EXIT.
  7876      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 153
* EL152.cbl
  7878 2000-CREATE.
  7879***************************************************************
  7880*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  7881*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  7882*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  7883*    WILL BE DISPLAYED ONTO THE SCREEN.                       *
  7884*                                                             *
  7885***************************************************************
  7886
  7887***************************************************************
  7888*    CHECK TO SEE IF SAME REQUEST OR NOT.                     *
  7889*    IF NEW REQUEST AND A LETTER WAS PRINTED, FORCE AN ERROR  *
  7890***************************************************************
  7891
  7892     IF PI-CREATE-MODE
  7893        IF PI-FORM-NUMBER = FORMI AND PI-ADDR-TYPE = ADDRI AND
  7894           PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7895           PERFORM 7500-READ-TS  THRU 7599-EXIT
  7896           PERFORM 7950-SET-INDX THRU 7950-EXIT
  7897           PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7898             VARYING SC-INDX FROM 1 BY 1
  7899             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  7900           MOVE -1               TO MAINTL
  7901*          MOVE 'Y'              TO CLEANO
  7902           GO TO 8200-SEND-DATAONLY
  7903        ELSE
  7904           IF PRINT-PERFORMED AND
  7905              PI-RETURN-TO-PROGRAM  =  PGM-EL150 AND
  7906              FORMI NOT = 9999
  7907              MOVE ER-0279           TO EMI-ERROR
  7908              MOVE -1                TO MAINTL
  7909              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7910              GO TO 8200-SEND-DATAONLY.
  7911
  7912***************************************************************
  7913*   IF THE FORM NUMBER IS THE SAME BUT THE ADDRESS TYPE       *
  7914*   HAS CHANGED, THEN SAVE THE CURRENT SCREEN AND REBUILD     *
  7915*   THE ADDRESS DATA.                                         *
  7916***************************************************************
  7917
  7918     IF PI-FORM-NUMBER = FORMI AND
  7919        PI-ADDR-TYPE  =  ADDRI AND
  7920        PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7921           MOVE -1                  TO MAINTL
  7922           GO TO 8200-SEND-DATAONLY.
  7923
  7924     IF PI-LETTER-ADDRESS-TYPE NOT = W-LETTER-ADDRESS-TYPE
  7925         MOVE 0                  TO GETMAIN-SWITCH
  7926         MOVE 'N'                TO WS-ACCT-READ-SW
  7927                                    WS-PROD-READ-SW
  7928                                    WS-COMP-READ-SW.
  7929
  7930     MOVE SPACES                 TO RECORD-TABLE.
  7931
  7932     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  7933
  7934     SET TB-INDX TO 1
  7935     MOVE TOP-FORM               TO REC-TEXT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 154
* EL152.cbl
  7936     SET TB-INDX UP BY 1.
  7937
  7938***************************************************************
  7939*    IF A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE      *
  7940*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  7941***************************************************************
  7942
  7943     IF FORMI = '9999'
  7944        MOVE 16                  TO PI-TOTAL-LINES
  7945        MOVE 1                   TO PI-CURRENT-LINE
  7946        PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
  7947        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT
  7948        MOVE '3'                 TO PI-ACTION
  7949        MOVE FORMI               TO PI-FORM-NUMBER
  7950                                    PI-COMM-CONTROL
  7951        MOVE ZEROS               TO PI-UPDATE-SW
  7952        MOVE PGM-EL1042          TO PGM-NAME
  7953        GO TO 9300-XCTL.
  7954
  7955     MOVE FORMI                  TO TEXT-LETTER.
  7956     MOVE TEXT-PARTIAL-KEY       TO TEXT-SAVE-KEY.
  7957
  7958
  7959* EXEC CICS HANDLE CONDITION
  7960*         NOTFND     (2120-ENDBR)
  7961*         ENDFILE    (2120-ENDBR)
  7962*         NOTOPEN    (8890-TEXT-NOT-OPEN)
  7963*    END-EXEC
  7964*    MOVE '"$I''J                 ! '' #00007766' TO DFHEIV0
  7965     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7966     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7967     MOVE X'2720233030303037373636' TO DFHEIV0(25:11)
  7968     CALL 'kxdfhei1' USING DFHEIV0
  7969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7970
  7971
  7972* EXEC CICS STARTBR
  7973*         DATASET    (TEXT-ID)
  7974*         RIDFLD     (TEXT-KEY)
  7975*         GTEQ
  7976*    END-EXEC.
  7977     MOVE 0
  7978       TO DFHEIV11
  7979*    MOVE '&,         G          &   #00007772' TO DFHEIV0
  7980     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7981     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7982     MOVE X'2020233030303037373732' TO DFHEIV0(25:11)
  7983     CALL 'kxdfhei1' USING DFHEIV0,
  7984           TEXT-ID,
  7985           TEXT-KEY,
  7986           DFHEIV99,
  7987           DFHEIV11,
  7988           DFHEIV99
  7989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7990
  7991
  7992     MOVE 'Y'                    TO TEXT-BROWSE-STARTED.
  7993
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 155
* EL152.cbl
  7994 2110-READ-NEXT.
  7995     IF TB-INDX > MAX-LINES
  7996        MOVE ER-0051             TO EMI-ERROR
  7997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7998        GO TO 2120-ENDBR.
  7999
  8000
  8001* EXEC CICS READNEXT
  8002*         DATASET    (TEXT-ID)
  8003*         SET        (ADDRESS OF TEXT-FILES)
  8004*         RIDFLD     (TEXT-KEY)
  8005*    END-EXEC.
  8006     MOVE 0
  8007       TO DFHEIV11
  8008*    MOVE '&.S                   )   #00007786' TO DFHEIV0
  8009     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8010     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8011     MOVE X'2020233030303037373836' TO DFHEIV0(25:11)
  8012     CALL 'kxdfhei1' USING DFHEIV0,
  8013           TEXT-ID,
  8014           DFHEIV20,
  8015           DFHEIV99,
  8016           TEXT-KEY,
  8017           DFHEIV99,
  8018           DFHEIV11,
  8019           DFHEIV99,
  8020           DFHEIV99
  8021     SET ADDRESS OF TEXT-FILES TO
  8022         DFHEIV20
  8023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8024
  8025
  8026     IF TEXT-PARTIAL-KEY NOT = TEXT-SAVE-KEY
  8027        IF TB-INDX = +2
  8028           MOVE SPACES           TO PI-FORM-NUMBER
  8029           MOVE -1               TO FORML
  8030           MOVE AL-UABON         TO FORMA
  8031           MOVE ER-1236          TO EMI-ERROR
  8032           MOVE 'N'              TO CLEANO
  8033           PERFORM 9900-ERROR-FORMAT
  8034                                 THRU 9900-EXIT
  8035        END-IF
  8036        GO TO 2120-ENDBR
  8037     END-IF
  8038
  8039     MOVE FORMI                  TO PI-FORM-NUMBER.
  8040     IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  8041         PERFORM 2800-PROCESS-Z-CONTROLS THRU 2800-EXIT
  8042         GO TO 2110-READ-NEXT.
  8043
  8044      MOVE TX-BSR-CODE           TO PI-ELLETR-BSR.
  8045
  8046      IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  8047         AND (PI-CARRIER NOT = '8')
  8048         PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  8049            B1 > +20
  8050            IF TX-TEXT-LINE (B1:5) = '@03.1'
  8051               GO TO 2110-READ-NEXT
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 156
* EL152.cbl
  8052            END-IF
  8053         END-PERFORM
  8054      END-IF
  8055      MOVE TX-TEXT-LINE          TO REC-TEXT (TB-INDX).
  8056      MOVE TX-PROCESS-CONTROL    TO REC-PC (TB-INDX)
  8057                                    INDX-WORK.
  8058      SET TB-INDX UP BY 1.
  8059      IF INDX-WORK = 99
  8060         MOVE TOP-FORM           TO REC-TEXT (TB-INDX)
  8061         SET TB-INDX UP BY 1
  8062         GO TO 2110-READ-NEXT
  8063      ELSE
  8064         SET TB-INDX UP BY INDX-WORK
  8065         GO TO 2110-READ-NEXT.
  8066
  8067 2120-ENDBR.
  8068     IF TEXT-BROWSE-STARTED = 'Y'
  8069        MOVE 'N'                 TO TEXT-BROWSE-STARTED
  8070
  8071* EXEC CICS ENDBR
  8072*            DATASET     (TEXT-ID)
  8073*       END-EXEC.
  8074     MOVE 0
  8075       TO DFHEIV11
  8076*    MOVE '&2                    $   #00007836' TO DFHEIV0
  8077     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8078     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8079     MOVE X'2020233030303037383336' TO DFHEIV0(25:11)
  8080     CALL 'kxdfhei1' USING DFHEIV0,
  8081           TEXT-ID,
  8082           DFHEIV11,
  8083           DFHEIV99
  8084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8085
  8086
  8087*02160      IF TB-INDX = 8
  8088*02161         MOVE ER-0006             TO EMI-ERROR
  8089*02162         MOVE -1                  TO FORML
  8090*02163         MOVE AL-UABON            TO FORMA
  8091*02164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8092*02165         GO TO 8200-SEND-DATAONLY-ERASEAUP.
  8093
  8094     SET TB-INDX DOWN BY 1.
  8095     SET PI-TOTAL-LINES          TO TB-INDX.
  8096     MOVE 1                      TO PI-CURRENT-LINE.
  8097
  8098***************************************************************
  8099*    IF IT IS A DESIGNATED CLAIM, THEN RESOLVE ALL            *
  8100*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
  8101***************************************************************
  8102
  8103     IF PI-RETURN-TO-PROGRAM = PGM-EL150
  8104        PERFORM 7200-RESOLVE-VARIABLES THRU 7269-EXIT
  8105        MOVE SPACES              TO W-REVERSE-DATE-SW
  8106        PERFORM 7300-VARIABLE-SEARCH   THRU 7399-EXIT
  8107                VARYING TB-INDX FROM 7 BY 1 UNTIL
  8108                TB-INDX > PI-TOTAL-LINES
  8109     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 157
* EL152.cbl
  8110        MOVE ER-0373             TO EMI-ERROR
  8111        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8112
  8113     SET TB-INDX TO 1.
  8114     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  8115             VARYING SC-INDX FROM 1 BY 1 UNTIL
  8116             SC-INDX > NUM-LINES-PER-SCREEN.
  8117
  8118     MOVE '3'                    TO PI-ACTION.
  8119*    MOVE FORMI                  TO PI-FORM-NUMBER.
  8120     MOVE W-LETTER-ADDRESS-TYPE  TO PI-LETTER-ADDRESS-TYPE.
  8121     MOVE -1                     TO MAINTL.
  8122     GO TO 8200-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 158
* EL152.cbl
  8124 2800-PROCESS-Z-CONTROLS.
  8125
  8126     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
  8127
  8128     IF RESEND-SAVE = LOW-VALUES
  8129         IF W-DAYS-TO-RESEND-1 NUMERIC
  8130             IF W-DAYS-TO-RESEND-1 > ZEROS
  8131                 MOVE '6'                    TO DC-OPTION-CODE
  8132                 MOVE SAVE-BIN-DATE          TO DC-BIN-DATE-1
  8133                 MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8134                 MOVE W-DAYS-TO-RESEND-1     TO DC-ELAPSED-DAYS
  8135                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8136                 IF NO-CONVERSION-ERROR
  8137                     MOVE DC-BIN-DATE-2       TO RESEND-SAVE
  8138                     MOVE DC-GREG-DATE-1-EDIT TO RESENDO
  8139                     MOVE AL-UANON            TO RESENDA
  8140                     MOVE +8                  TO RESENDL
  8141                 ELSE
  8142                     MOVE ER-3770             TO EMI-ERROR
  8143                     MOVE -1                  TO MAINTL
  8144                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8145                     GO TO 8200-SEND-DATAONLY.
  8146
  8147     IF FOLLOW-UP-SAVE = LOW-VALUES
  8148         IF W-DAYS-TO-FOLLOW-UP NUMERIC
  8149             IF W-DAYS-TO-FOLLOW-UP > ZEROS
  8150                 MOVE '6'                 TO DC-OPTION-CODE
  8151                 MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  8152                 MOVE ZEROS               TO DC-ELAPSED-MONTHS
  8153                 MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  8154                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8155                 IF NO-CONVERSION-ERROR
  8156                     MOVE DC-BIN-DATE-2       TO FOLLOW-UP-SAVE
  8157                     MOVE DC-GREG-DATE-1-EDIT TO FOLLOWO
  8158                     MOVE AL-UANON            TO FOLLOWA
  8159                     MOVE +8                  TO FOLLOWL
  8160                 ELSE
  8161                     MOVE ER-3771             TO EMI-ERROR
  8162                     MOVE -1                  TO MAINTL
  8163                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8164                     GO TO 8200-SEND-DATAONLY.
  8165
  8166     IF COPIESI NOT NUMERIC
  8167         IF W-NUMBER-OF-COPIES NUMERIC
  8168             IF W-NUMBER-OF-COPIES > ZEROS
  8169                 MOVE W-NUMBER-OF-COPIES  TO COPIESI
  8170                 MOVE AL-UNNON            TO COPIESA
  8171                 MOVE +1                  TO COPIESL
  8172             ELSE
  8173                 MOVE +1                  TO COPIESI
  8174                 MOVE AL-UNNON            TO COPIESA
  8175                 MOVE +1                  TO COPIESL.
  8176
  8177     IF W-FORM-TO-RESEND > SPACES
  8178         MOVE W-FORM-TO-RESEND          TO PI-RESEND-FORM-NUMBER
  8179     ELSE
  8180         MOVE LOW-VALUES                TO PI-RESEND-FORM-NUMBER
  8181     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 159
* EL152.cbl
  8182
  8183     IF W-PROMPT-LETTER = 'Y'
  8184         MOVE W-PROMPT-LETTER           TO PI-PROMPT-LETTER
  8185         MOVE ER-0894                   TO EMI-ERROR
  8186         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8187     ELSE
  8188         MOVE 'N'                       TO PI-PROMPT-LETTER
  8189     END-IF.
  8190
  8191     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
  8192                                           ENCO
  8193     MOVE AL-UANON                      TO ENCA
  8194     MOVE +3                            TO ENCL
  8195     MOVE 'N'                           TO CLEANO
  8196     MOVE W-AUTO-CLOSE-IND              TO PI-AUTO-CLOSE-IND.
  8197     MOVE W-LETTER-TO-BENE              TO PI-LETTER-TO-BENE.
  8198
  8199 2800-EXIT.
  8200     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 160
* EL152.cbl
  8202 3000-RECORD.
  8203***************************************************************
  8204*    THIS ROUTINE WILL SAVE THE LETTER TEXT (IF ANY) AND      *
  8205*    BUILD A CORRESPONDENCE TRAILER WITH THE DATA FROM        *
  8206*    THE SCREEN.                                              *
  8207***************************************************************
  8208
  8209     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8210        MOVE ER-0211             TO EMI-ERROR
  8211        MOVE -1                  TO MAINTL
  8212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8213        GO TO 8200-SEND-DATAONLY.
  8214
  8215
  8216* EXEC CICS HANDLE CONDITION
  8217*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  8218*         NOTFND     (3010-NOT-FOUND)
  8219*    END-EXEC.
  8220*    MOVE '"$JI                  ! ( #00007968' TO DFHEIV0
  8221     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8223     MOVE X'2820233030303037393638' TO DFHEIV0(25:11)
  8224     CALL 'kxdfhei1' USING DFHEIV0
  8225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8226
  8227
  8228     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8229     PERFORM 7950-SET-INDX     THRU 7950-EXIT.
  8230
  8231     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8232             VARYING SC-INDX FROM 1 BY 1
  8233             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8234
  8235     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8236
  8237     IF NOT EMI-NO-ERRORS
  8238        GO TO 8200-SEND-DATAONLY.
  8239
  8240     MOVE ZEROS               TO ARCH-NUMBER.
  8241     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8242     MOVE ER-0000             TO EMI-ERROR.
  8243     MOVE -1                  TO MAINTL.
  8244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8245     GO TO 8200-SEND-DATAONLY.
  8246
  8247 3010-NOT-FOUND.
  8248     MOVE ER-0133             TO EMI-ERROR.
  8249     MOVE -1                  TO MAINTL.
  8250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8251     GO TO 8200-SEND-DATAONLY.
  8252
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 161
* EL152.cbl
  8254*4000-SET-BSR. Remove as dead code
  8255*4001-READ-NEXT. Remove as dead code
  8256*4002-ENDBR. Remove as dead code
  8257*4000-EXIT. Remove as dead code
  8258
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 162
* EL152.cbl
  8260 5000-MOVE-NAME.
  8261*    COPY ELCMNS.
  8262*****************************************************************
  8263*                                                               *
  8264*                                                               *
  8265*                            ELCMNS.                            *
  8266*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8267*                            VMOD=2.002                         *
  8268*                                                               *
  8269*                     M O V E   N A M E   R O U T I N E         *
  8270*                                                               *
  8271*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8272*            NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8273*            NO EMBEDDED BLANKS.                                *
  8274*                                                               *
  8275*                  FIELD               VALUE                    *
  8276*                                                               *
  8277*                LAST NAME (CL15)      SMITH                    *
  8278*                1ST NAME  (CL12)      JOHN                     *
  8279*                MID NAME  (CL12)      ALLEN                    *
  8280*                                                               *
  8281*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8282*                                                               *
  8283*                        SMITH, JOHN ALLEN                      *
  8284*                                                               *
  8285*                TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8286*            STORAGE COPYBOOK:                                  *
  8287*                                                               *
  8288*                01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8289*                                                               *
  8290*****************************************************************.
  8291
  8292     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8293     MOVE ZERO                   TO  WS-NAME-SW.
  8294     SET NWA-INDEX TO +1.
  8295
  8296     IF CL-INSURED-1ST-NAME = SPACES  AND
  8297        CL-INSURED-MID-INIT = SPACES
  8298         MOVE +1                 TO  WS-NAME-SW.
  8299
  8300     MOVE CL-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8301     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8302
  8303     MOVE CL-INSURED-1ST-NAME   TO  WS-NAME-WORK2.
  8304     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8305
  8306     SET NWA-INDEX UP BY +1.
  8307     MOVE CL-INSURED-MID-INIT   TO  WS-NAME-WORK2.
  8308     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8309
  8310 5000-EXIT.
  8311     EXIT.
  8312
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 163
* EL152.cbl
  8314 5100-MOVE-NAME SECTION.
  8315     IF WS-NAME-SW GREATER THAN +1
  8316         GO TO 5190-EXIT.
  8317
  8318     IF WS-NAME-WORK2 = SPACES
  8319         GO TO 5190-EXIT.
  8320
  8321     SET NWA-INDEX2 TO +1.
  8322     SET NWA-INDEX3 TO +2.
  8323
  8324 5110-MOVE-NAME.
  8325     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8326
  8327     IF NWA-INDEX LESS THAN +30
  8328         SET NWA-INDEX UP BY +1
  8329       ELSE
  8330         ADD +2  TO  WS-NAME-SW
  8331         GO TO 5190-EXIT.
  8332
  8333     IF NWA-INDEX2 LESS THAN +20
  8334         SET NWA-INDEX3 UP BY +1
  8335         SET NWA-INDEX2 UP BY +1.
  8336
  8337     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8338        WS-NW2 (NWA-INDEX3) = SPACES
  8339         IF WS-NAME-SW = ZERO
  8340             MOVE ','            TO  WS-NW (NWA-INDEX)
  8341             SET NWA-INDEX UP BY +2
  8342             MOVE +1             TO  WS-NAME-SW
  8343             GO TO 5190-EXIT
  8344           ELSE
  8345             GO TO 5190-EXIT.
  8346
  8347     GO TO 5110-MOVE-NAME.
  8348
  8349 5190-EXIT.
  8350     EXIT.
  8351
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 164
* EL152.cbl
  8353 5200-MOVE-NAME.
  8354*    NOTE *******************************************************
  8355*         *           M O V E   N A M E   R O U T I N E         *
  8356*         *                                                     *
  8357*         *      THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8358*         *  NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8359*         *  NO EMBEDDED BLANKS.                                *
  8360*         *                                                     *
  8361*         *        FIELD               VALUE                    *
  8362*         *                                                     *
  8363*         *      LAST NAME (CL15)      SMITH                    *
  8364*         *      1ST NAME  (CL12)      JOHN                     *
  8365*         *      MID NAME  (CL1)       A                        *
  8366*         *                                                     *
  8367*         *      AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8368*         *                                                     *
  8369*         *              JOHN A. SMITH                          *
  8370*         *                                                     *
  8371*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8372*         *  STORAGE COPYBOOK:                                  *
  8373*         *                                                     *
  8374*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8375*         *                                                     *
  8376*         *******************************************************.
  8377
  8378     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8379     MOVE ZERO                   TO  WS-NAME-SW.
  8380     SET NWA-INDEX TO +1.
  8381
  8382     IF W-FIRST-NAME = SPACES
  8383             AND
  8384        W-MIDDLE-NAME = SPACES
  8385         MOVE W-LAST-NAME        TO WS-NAME-WORK
  8386         GO TO 5200-EXIT.
  8387
  8388     MOVE W-FIRST-NAME           TO  WS-NAME-WORK2.
  8389     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8390
  8391     SET NWA-INDEX UP BY +1.
  8392
  8393     IF W-MIDDLE-NAME NOT = SPACES
  8394        MOVE W-MIDDLE-NAME       TO  WS-NW (NWA-INDEX)
  8395        SET NWA-INDEX UP BY +1
  8396        MOVE '.'                 TO  WS-NW (NWA-INDEX)
  8397        SET NWA-INDEX UP BY +2.
  8398
  8399     MOVE W-LAST-NAME            TO  WS-NAME-WORK2.
  8400     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8401
  8402 5200-EXIT.
  8403     EXIT.
  8404
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 165
* EL152.cbl
  8406 5300-MOVE-NAME.
  8407     IF WS-NAME-SW > +1
  8408         GO TO 5390-EXIT.
  8409
  8410     IF WS-NAME-WORK2 = SPACES
  8411         GO TO 5390-EXIT.
  8412
  8413     SET NWA-INDEX2 TO +1.
  8414     SET NWA-INDEX3 TO +2.
  8415
  8416 5310-MOVE-NAME.
  8417     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8418
  8419     IF NWA-INDEX < +30
  8420        SET NWA-INDEX UP BY +1
  8421     ELSE
  8422        ADD +2  TO  WS-NAME-SW
  8423        GO TO 5390-EXIT.
  8424
  8425     IF NWA-INDEX2 < +20
  8426         SET NWA-INDEX2 UP BY +1
  8427         SET NWA-INDEX3 UP BY +1.
  8428
  8429     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8430        WS-NW2 (NWA-INDEX3) = SPACES
  8431        GO TO 5390-EXIT.
  8432
  8433     GO TO 5310-MOVE-NAME.
  8434
  8435 5390-EXIT.
  8436     EXIT.
  8437
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 166
* EL152.cbl
  8439 6100-ADDR-MAINT.
  8440***************************************************************
  8441*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8442*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8443*    IT WILL THEN XCTL TO THE ADDRESS MAINT PROGRAM.          *
  8444***************************************************************
  8445
  8446     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8447
  8448     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8449     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8450             VARYING SC-INDX FROM 1 BY 1
  8451             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8452
  8453     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8454        MOVE ER-0343             TO EMI-ERROR
  8455        MOVE -1                  TO MAINTL
  8456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8457        GO TO 8200-SEND-DATAONLY.
  8458
  8459*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8460*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8461*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8462*            VARYING SC-INDX FROM 1 BY 1
  8463*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8464
  8465     PERFORM 7700-PUT-TEMP-STOR    THRU 7749-EXIT.
  8466     PERFORM 7790-WRITE-SCREEN-TS  THRU 7790-EXIT.
  8467     PERFORM 7795-WRITE-PI-AREA-TS THRU 7795-EXIT.
  8468     MOVE PGM-EL141 TO PGM-NAME.
  8469
  8470     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 167
* EL152.cbl
  8472 6200-EDIT-MODE.
  8473***************************************************************
  8474*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8475*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8476*    IT WILL THEN XCTL TO THE TEXT-EDITOR PROGRAM.            *
  8477***************************************************************
  8478     IF PI-SHOW-MODE
  8479        MOVE ER-0188             TO EMI-ERROR
  8480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8481        MOVE -1                  TO MAINTL
  8482        MOVE AL-UABON            TO MAINTA
  8483        GO TO 8200-SEND-DATAONLY
  8484     END-IF
  8485
  8486*    IF PI-COMPANY-ID = 'DMD'
  8487*        IF PI-BSR-AUTOMATED
  8488*            MOVE ER-0912        TO EMI-ERROR
  8489*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8490*            MOVE -1             TO MAINTL
  8491*            MOVE AL-UABON       TO MAINTA
  8492*            GO TO 8200-SEND-DATAONLY.
  8493
  8494     IF PI-CURRENT-LINE = ZEROS
  8495        MOVE ER-0187             TO EMI-ERROR
  8496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8497        MOVE -1                  TO MAINTL
  8498        GO TO 8200-SEND-DATAONLY.
  8499
  8500     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8501     PERFORM 7750-DELETE-TEMP-STOR
  8502                                 THRU 7750-EXIT
  8503     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8504     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8505             VARYING SC-INDX FROM 1 BY 1
  8506             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8507
  8508     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT.
  8509     PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
  8510
  8511     MOVE PI-FORM-NUMBER         TO PI-COMM-CONTROL.
  8512     MOVE ZEROS                  TO PI-UPDATE-SW.
  8513     MOVE '1'                    TO PI-ENTRY-CD-1.
  8514     MOVE PGM-EL1042             TO PGM-NAME.
  8515     GO TO 9300-XCTL.
  8516
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 168
* EL152.cbl
  8518 6400-LETTER-RELEASE.
  8519***************************************************************
  8520*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
  8521*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS ONTO     *
  8522*    THE ARCHIVE FILE.                                        *
  8523*    THE FOLLOWING FUNCTIONS WILL BE PERFORMED                *
  8524*        1. CHECK SECURITY AND IF IT IS A DESIGNATED LETTER.  *
  8525*        2. RE-EDIT DATA AND UPDATE TS-TABLE WITH CHANGES     *
  8526*        3. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS         *
  8527*        4. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
  8528*        5. WRITE THE NEW ARCHIVE RECORDS FROM TS-TABLE.      *
  8529*        7. BUILD A CORRESPONDENCE TRAILER                    *
  8530*        8. BUILD OR UPDATE THE ACTIVITY QUE FILE WITH THE    *
  8531*                 ARCHIVE NUMBER IF IT IS TO BE PRINTED LATER.*
  8532*        4. RESET ALL CONTROL FIELDS AND RETURN THE           *
  8533*                 ARCHIVE NUMBER USED TO FILE THE RECORDS.    *
  8534***************************************************************
  8535
  8536     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8537
  8538     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8539     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8540             VARYING SC-INDX FROM 1 BY 1
  8541             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8542
  8543     IF NOT MODIFY-CAP
  8544        MOVE ER-0070             TO EMI-ERROR
  8545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8546        MOVE -1                  TO MAINTL
  8547        GO TO 8200-SEND-DATAONLY.
  8548
  8549     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8550        MOVE ER-0211             TO EMI-ERROR
  8551        MOVE -1                  TO MAINTL
  8552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8553        GO TO 8200-SEND-DATAONLY.
  8554
  8555*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8556*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8557*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8558*            VARYING SC-INDX FROM 1 BY 1
  8559*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8560
  8561     IF PI-ADDR-TYPE  NOT =  ADDRI
  8562        PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8563
  8564     IF NOT EMI-NO-ERRORS
  8565        GO TO 8200-SEND-DATAONLY.
  8566
  8567     MOVE +0                     TO TALLY.
  8568     INSPECT RECORD-TABLE TALLYING TALLY
  8569                                 FOR CHARACTERS BEFORE '@'.
  8570
  8571     IF TALLY < +21900
  8572        COMPUTE PI-CURRENT-LINE = TALLY / 73
  8573        MOVE ZEROS               TO ROLL-COUNTER
  8574        MOVE ER-0191             TO EMI-ERROR
  8575        MOVE -1                  TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 169
* EL152.cbl
  8576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8577        GO TO 7900-ROLL-PAGE.
  8578
  8579     MOVE '1'                    TO CNTL-RECORD-TYPE.
  8580     MOVE ZEROS                  TO CNTL-SEQ.
  8581     MOVE SPACES                 TO CNTL-GENL.
  8582
  8583* EXEC CICS READ
  8584*         DATASET    (CNTL-ID)
  8585*         SET        (ADDRESS OF CONTROL-FILE)
  8586*         RIDFLD     (CNTL-KEY)
  8587*         UPDATE
  8588*    END-EXEC.
  8589*    MOVE '&"S        EU         (   #00008327' TO DFHEIV0
  8590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8592     MOVE X'2020233030303038333237' TO DFHEIV0(25:11)
  8593     CALL 'kxdfhei1' USING DFHEIV0,
  8594           CNTL-ID,
  8595           DFHEIV20,
  8596           DFHEIV99,
  8597           CNTL-KEY,
  8598           DFHEIV99,
  8599           DFHEIV99,
  8600           DFHEIV99
  8601     SET ADDRESS OF CONTROL-FILE TO
  8602         DFHEIV20
  8603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8604
  8605
  8606     ADD 1                       TO CF-CO-ARCHIVE-COUNTER.
  8607     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
  8608     MOVE CF-PRINT-ADDRESS-LABELS   TO  WS-LABELS-SW.
  8609
  8610
  8611* EXEC CICS REWRITE
  8612*         FROM      (CONTROL-FILE)
  8613*         DATASET   (CNTL-ID)
  8614*    END-EXEC
  8615     MOVE LENGTH OF
  8616      CONTROL-FILE
  8617       TO DFHEIV11
  8618*    MOVE '&& L                  %   #00008338' TO DFHEIV0
  8619     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8620     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8621     MOVE X'2020233030303038333338' TO DFHEIV0(25:11)
  8622     CALL 'kxdfhei1' USING DFHEIV0,
  8623           CNTL-ID,
  8624           CONTROL-FILE,
  8625           DFHEIV11,
  8626           DFHEIV99
  8627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8628
  8629     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8630
  8631
  8632* EXEC CICS HANDLE CONDITION
  8633*         NOTOPEN   (9990-ABEND)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 170
* EL152.cbl
  8634*    END-EXEC.
  8635*    MOVE '"$J                   ! ) #00008345' TO DFHEIV0
  8636     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  8637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8638     MOVE X'2920233030303038333435' TO DFHEIV0(25:11)
  8639     CALL 'kxdfhei1' USING DFHEIV0
  8640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8641
  8642
  8643
  8644* EXEC CICS GETMAIN
  8645*         SET      (ADDRESS OF LETTER-ARCHIVE)
  8646*         LENGTH   (ARCH-LENGTH)
  8647*    END-EXEC.
  8648*    MOVE '," L                  $   #00008349' TO DFHEIV0
  8649     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8651     MOVE X'2020233030303038333439' TO DFHEIV0(25:11)
  8652     CALL 'kxdfhei1' USING DFHEIV0,
  8653           DFHEIV20,
  8654           ARCH-LENGTH,
  8655           DFHEIV99
  8656     SET ADDRESS OF LETTER-ARCHIVE TO
  8657         DFHEIV20
  8658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8659
  8660
  8661     MOVE SPACES                 TO LETTER-ARCHIVE.
  8662     MOVE 'LA'                   TO LA-RECORD-ID.
  8663     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8664                                    LA-ARCHIVE-NO-A1.
  8665     MOVE '1'                    TO LA-RECORD-TYPE
  8666                                    LA-RECORD-TYPE-A1.
  8667     MOVE ZEROS                  TO LA-LINE-SEQ-NO
  8668                                    LA-LINE-SEQ-NO-A1.
  8669     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8670                                    LA-COMPANY-CD-A1.
  8671     MOVE CLAM-CARRIER           TO LA-CARRIER.
  8672     MOVE PI-CLAIM-NO            TO LA-CLAIM-NO.
  8673     MOVE PI-CERT-NO             TO LA-CERT-NO.
  8674
  8675*    IF PI-COMPANY-ID = 'DMD'
  8676*        MOVE WS-DMD-CERT-STATE    TO LA-DMD-UND-CODE
  8677*        MOVE WS-DMD-CERT-GROUPING TO LA-DMD-PROD-CODE
  8678*        MOVE WS-DMD-BEN-CODE      TO LA-DMD-BEN-CODE
  8679*        MOVE WS-DMD-CORR-TRLR-SEQ TO LA-DMD-CORR-TRLR-SEQ
  8680*        MOVE WS-DMD-LETTER-FORM   TO LA-DMD-LETTER-FORM
  8681*        MOVE WS-DMD-RES-ST        TO LA-DMD-RES-ST
  8682*        MOVE LOW-VALUES           TO LA-DMD-LETTER-PURGE-DT
  8683*                                     LA-DMD-LETTER-RELOAD-DT
  8684*        MOVE '1'                  TO LA-DMD-LETTER-STATUS
  8685*        EXEC CICS GETMAIN
  8686*            SET    (ADDRESS OF LETTER-ARCHIVE-TEMP)
  8687*            LENGTH (ARCT-LENGTH)
  8688*        END-EXEC.
  8689
  8690     IF COPIESL NOT = ZEROS
  8691        MOVE COPIESI             TO LA-NO-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 171
* EL152.cbl
  8692     ELSE
  8693        MOVE  1                  TO LA-NO-OF-COPIES.
  8694
  8695     IF RESENDL NOT = ZEROS
  8696        MOVE RESEND-SAVE         TO LA-RESEND-DATE
  8697     ELSE
  8698        MOVE LOW-VALUES          TO LA-RESEND-DATE.
  8699
  8700     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
  8701     MOVE CURRENT-SAVE           TO LA-CREATION-DT.
  8702
  8703     IF PRINT-PERFORMED
  8704        MOVE CURRENT-SAVE        TO LA-INITIAL-PRINT-DATE
  8705     ELSE
  8706        MOVE LOW-VALUES          TO LA-INITIAL-PRINT-DATE.
  8707
  8708     MOVE LOW-VALUES             TO LA-RESEND-PRINT-DATE.
  8709     MOVE CORR-TRLR-SEQ          TO LA-CORR-TRLR-SEQ.
  8710     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8711
  8712     IF PI-PROMPT-LETTER NOT EQUAL 'Y'
  8713         PERFORM 6700-BUILD-NAPERSOFT THRU 6799-EXIT
  8714     END-IF.
  8715
  8716     IF WS-LABELS-SW = 'N'
  8717         NEXT SENTENCE
  8718     ELSE
  8719         SET TB-INDX TO 1
  8720         MOVE ZEROS                  TO SEQ-COUNTER
  8721         PERFORM 6480-FORMAT-ADDRESS
  8722               VARYING TB-INDX FROM 1 BY 1 UNTIL
  8723               TB-INDX > 6.
  8724
  8725     MOVE ZEROS                  TO SEQ-COUNTER.
  8726     MOVE 'N'                    TO WS-SKIP-EMAIL
  8727     PERFORM 6470-FORMAT-TEXT THRU 6479-EXIT
  8728             VARYING TB-INDX FROM 8 BY 1
  8729             UNTIL TB-INDX > PI-TOTAL-LINES.
  8730     MOVE 'Y'                    TO WS-SKIP-EMAIL.
  8731     IF SEQ-COUNTER < +15
  8732      AND WS-SKIP-EMAIL EQUAL 'N'
  8733        MOVE ARCH-NUMBER         TO TRAN-DL2-ARCHNO
  8734        MOVE PI-PROCESSOR-ID     TO TRAN-DL2-USER
  8735        MOVE SPACES              TO TRAN-DL2-CCC
  8736        STRING PI-CARRIER ' ' PI-CLAIM-NO ' ' PI-CERT-NO
  8737           DELIMITED BY SIZE
  8738           INTO TRAN-DL2-CCC
  8739        END-STRING
  8740
  8741* EXEC CICS WRITEQ TD
  8742*          QUEUE ('BTCH')
  8743*          FROM (TRAN-DATA-LINE1)
  8744*          LENGTH (80)
  8745*       END-EXEC
  8746     MOVE 80
  8747       TO DFHEIV11
  8748     MOVE 'BTCH' TO DFHEIV5
  8749*    MOVE '(" L                  &   #00008433' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 172
* EL152.cbl
  8750     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8751     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8752     MOVE X'2020233030303038343333' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0,
  8754           DFHEIV5,
  8755           TRAN-DATA-LINE1,
  8756           DFHEIV11,
  8757           DFHEIV99,
  8758           DFHEIV99
  8759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8760
  8761* EXEC CICS WRITEQ TD
  8762*          QUEUE ('BTCH')
  8763*          FROM (TRAN-DATA-LINE2)
  8764*          LENGTH (80)
  8765*       END-EXEC
  8766     MOVE 80
  8767       TO DFHEIV11
  8768     MOVE 'BTCH' TO DFHEIV5
  8769*    MOVE '(" L                  &   #00008438' TO DFHEIV0
  8770     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8771     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8772     MOVE X'2020233030303038343338' TO DFHEIV0(25:11)
  8773     CALL 'kxdfhei1' USING DFHEIV0,
  8774           DFHEIV5,
  8775           TRAN-DATA-LINE2,
  8776           DFHEIV11,
  8777           DFHEIV99,
  8778           DFHEIV99
  8779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8780
  8781* EXEC CICS WRITEQ TD
  8782*          QUEUE ('BTCH')
  8783*          FROM (TRAN-DATA-LINE3)
  8784*          LENGTH (80)
  8785*       END-EXEC
  8786     MOVE 80
  8787       TO DFHEIV11
  8788     MOVE 'BTCH' TO DFHEIV5
  8789*    MOVE '(" L                  &   #00008443' TO DFHEIV0
  8790     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8791     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8792     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  8793     CALL 'kxdfhei1' USING DFHEIV0,
  8794           DFHEIV5,
  8795           TRAN-DATA-LINE3,
  8796           DFHEIV11,
  8797           DFHEIV99,
  8798           DFHEIV99
  8799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8800     END-IF
  8801     MOVE ER-0280                TO EMI-ERROR.
  8802
  8803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8804     MOVE ARCH-NUMBER            TO ARCH-SUPPRESS
  8805     MOVE ARCH-EDIT              TO EMI-TEXT-VARIABLE (1).
  8806
  8807     GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 173
* EL152.cbl
  8808
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 174
* EL152.cbl
  8810 6470-FORMAT-TEXT.
  8811
  8812     IF REC-TEXT (TB-INDX) (1:16) = NAPERSOFT-LETTER
  8813         MOVE 'Y'                TO WS-SKIP-EMAIL
  8814     END-IF.
  8815
  8816     MOVE SPACES                 TO LETTER-ARCHIVE.
  8817     MOVE '3'                    TO LA-RECORD-TYPE
  8818                                    LA-RECORD-TYPE-A1.
  8819     MOVE 'LA'                   TO LA-RECORD-ID.
  8820     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8821                                    LA-ARCHIVE-NO-A1.
  8822     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8823                                    LA-LINE-SEQ-NO-A1.
  8824     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8825                                    LA-COMPANY-CD-A1.
  8826     MOVE REC-TEXT (TB-INDX)     TO LA-TEXT-LINE.
  8827     SET TB-INDX1 TO TB-INDX.
  8828     SET TB-INDX1 UP BY 1.
  8829     MOVE ZEROS                  TO INDX-WORK.
  8830
  8831 6472-LOOP.
  8832     IF TB-INDX1 < PI-TOTAL-LINES AND
  8833        REC-TEXT (TB-INDX1) = SPACES
  8834           SET TB-INDX1 UP BY 1
  8835           ADD 1                 TO INDX-WORK
  8836           GO TO 6472-LOOP.
  8837
  8838     IF REC-TEXT (TB-INDX1) = TOP-FORM
  8839        MOVE '99'                TO LA-SKIP-CONTROL
  8840        SET TB-INDX1 UP BY 1
  8841     ELSE
  8842        MOVE INDX-WORK           TO LA-SKIP-CONTROL.
  8843
  8844     SET TB-INDX TO TB-INDX1.
  8845     SET TB-INDX DOWN BY 1.
  8846     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8847     ADD 1 TO SEQ-COUNTER.
  8848
  8849 6479-EXIT.
  8850      EXIT.
  8851
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 175
* EL152.cbl
  8853 6480-FORMAT-ADDRESS.
  8854     MOVE SPACES                 TO LETTER-ARCHIVE.
  8855     MOVE '2'                    TO LA-RECORD-TYPE
  8856                                    LA-RECORD-TYPE-A1.
  8857     MOVE 'LA'                   TO LA-RECORD-ID.
  8858     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8859                                    LA-ARCHIVE-NO-A1.
  8860     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8861                                    LA-LINE-SEQ-NO-A1.
  8862     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8863                                    LA-COMPANY-CD-A1.
  8864     MOVE REC-TEXT (TB-INDX)     TO LA-ADDRESS-LINE.
  8865
  8866     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8867     ADD 1 TO SEQ-COUNTER.
  8868
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 176
* EL152.cbl
  8870 6490-WRITE-ARCHIVE.
  8871
  8872* EXEC CICS HANDLE CONDITION
  8873*        DUPKEY    (6499-EXIT)
  8874*    END-EXEC.
  8875*    MOVE '"$$                   ! * #00008519' TO DFHEIV0
  8876     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8878     MOVE X'2A20233030303038353139' TO DFHEIV0(25:11)
  8879     CALL 'kxdfhei1' USING DFHEIV0
  8880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8881
  8882
  8883*    IF PI-COMPANY-ID = 'DMD'
  8884*        MOVE LETTER-ARCHIVE     TO LETTER-ARCHIVE-TEMP
  8885*        MOVE 'LT'               TO LT-RECORD-ID
  8886*        EXEC CICS WRITE
  8887*            DATASET   (ARCT-ID)
  8888*            FROM      (LETTER-ARCHIVE-TEMP)
  8889*            RIDFLD    (LT-CONTROL-PRIMARY)
  8890*        END-EXEC.
  8891
  8892
  8893* EXEC CICS WRITE
  8894*         DATASET   (ARCH-ID)
  8895*         FROM      (LETTER-ARCHIVE)
  8896*         RIDFLD    (LA-CONTROL-PRIMARY)
  8897*    END-EXEC.
  8898     MOVE LENGTH OF
  8899      LETTER-ARCHIVE
  8900       TO DFHEIV11
  8901*    MOVE '&$ L                  ''   #00008532' TO DFHEIV0
  8902     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8903     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8904     MOVE X'2020233030303038353332' TO DFHEIV0(25:11)
  8905     CALL 'kxdfhei1' USING DFHEIV0,
  8906           ARCH-ID,
  8907           LETTER-ARCHIVE,
  8908           DFHEIV11,
  8909           LA-CONTROL-PRIMARY,
  8910           DFHEIV99,
  8911           DFHEIV99
  8912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8913
  8914
  8915 6499-EXIT.
  8916     EXIT.
  8917
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 177
* EL152.cbl
  8919 6500-BUILD-CORRESPOND.
  8920***************************************************************
  8921*    THIS ROUTINE WILL GET THE TRAILER SEQUENCE NUMBER FROM   *
  8922*    THE CLAIM MASTER AND BUILD A CORRESPONDENCE TRAILER      *
  8923*    USING THE NEW SEQUENCE NUMBER.                           *
  8924*    INPUT DATA FROM THE SCREEN IS USED TO CREATE THE NEW     *
  8925*    TRAILER RECORD.                                          *
  8926***************************************************************
  8927
  8928     MOVE PI-CLAIM-NO            TO CLAM-CLAIM.
  8929
  8930
  8931* EXEC CICS READ
  8932*         DATASET    (CLAM-ID)
  8933*         SET        (ADDRESS OF CLAIM-MASTER)
  8934*         RIDFLD     (CLAM-KEY)
  8935*         UPDATE
  8936*    END-EXEC.
  8937*    MOVE '&"S        EU         (   #00008553' TO DFHEIV0
  8938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8939     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038353533' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           CLAM-ID,
  8943           DFHEIV20,
  8944           DFHEIV99,
  8945           CLAM-KEY,
  8946           DFHEIV99,
  8947           DFHEIV99,
  8948           DFHEIV99
  8949     SET ADDRESS OF CLAIM-MASTER TO
  8950         DFHEIV20
  8951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8952
  8953
  8954     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  8955
  8956     IF FOLLOW-UP-SAVE > CL-NEXT-FOLLOWUP-DT
  8957        MOVE FOLLOW-UP-SAVE      TO CL-NEXT-FOLLOWUP-DT.
  8958
  8959     IF RESEND-SAVE > CL-NEXT-FOLLOWUP-DT
  8960        MOVE RESEND-SAVE         TO CL-NEXT-FOLLOWUP-DT.
  8961
  8962     IF MAINTI = 'C'
  8963        MOVE '2'                 TO CL-LAST-MAINT-TYPE.
  8964
  8965     IF MAINTI = 'R'
  8966        PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT
  8967        MOVE ACTV-SEQ            TO PI-ADDR-SEQ.
  8968
  8969*    IF PI-COMPANY-ID = 'DMD'
  8970*        MOVE 04                 TO CL-ACTIVITY-CODE.
  8971
  8972
  8973* EXEC CICS GETMAIN
  8974*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8975*         INITIMG   (GETMAIN-SPACE)
  8976*         LENGTH    (ACTV-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 178
* EL152.cbl
  8977*    END-EXEC.
  8978*    MOVE ',"IL                  $   #00008578' TO DFHEIV0
  8979     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8980     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8981     MOVE X'2020233030303038353738' TO DFHEIV0(25:11)
  8982     CALL 'kxdfhei1' USING DFHEIV0,
  8983           DFHEIV20,
  8984           ACTV-LENGTH,
  8985           GETMAIN-SPACE
  8986     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8987         DFHEIV20
  8988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8989
  8990
  8991     MOVE 'AT'                   TO AT-RECORD-ID.
  8992     MOVE  4                     TO AT-TRAILER-TYPE.
  8993     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  8994                                    CL-LAST-MAINT-DT
  8995                                    AT-CORR-LAST-MAINT-DT
  8996     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  8997                                    CL-LAST-MAINT-USER
  8998                                    AT-CORR-LAST-UPDATED-BY
  8999     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  9000                                    CL-LAST-MAINT-HHMMSS.
  9001     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  9002     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  9003     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  9004                                    CORR-TRLR-SEQ.
  9005     MOVE CURRENT-SAVE           TO AT-LETTER-SENT-DT.
  9006     MOVE FOLLOW-UP-SAVE         TO AT-RECEIPT-FOLLOW-UP.
  9007     MOVE RESEND-SAVE            TO AT-AUTO-RE-SEND-DT.
  9008     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  9009                                    AT-LETTER-PURGED-DT.
  9010     MOVE ARCH-NUMBER            TO AT-LETTER-ARCHIVE-NO.
  9011     MOVE '1'                    TO AT-LETTER-ORIGIN.
  9012     MOVE PI-RESEND-FORM-NUMBER  TO AT-RESEND-LETTER-FORM.
  9013     MOVE PI-AUTO-CLOSE-IND      TO AT-AUTO-CLOSE-IND.
  9014     MOVE PI-LETTER-TO-BENE      TO AT-LETTER-TO-BENE.
  9015
  9016*    IF PI-COMPANY-ID = 'DMD'
  9017*        MOVE '1'                TO AT-DMD-LETTER-STATUS
  9018*        IF PI-BSR-AUTOMATED
  9019*            MOVE 'A'            TO AT-DMD-BSR-CODE.
  9020*
  9021     IF FORML  NOT = ZEROS
  9022        MOVE FORMI               TO AT-STD-LETTER-FORM
  9023     ELSE
  9024        MOVE SPACES              TO AT-STD-LETTER-FORM.
  9025
  9026     IF REL NOT = ZEROS
  9027        MOVE REI                 TO AT-REASON-TEXT
  9028     ELSE
  9029        MOVE SPACES              TO AT-REASON-TEXT.
  9030
  9031*    IF PI-COMPANY-ID = 'HAN'  OR  'JHL'
  9032*        MOVE AT-REASON-TEXT     TO WS-REASON-TEXT
  9033*        IF WS-RE-NDX NUMERIC  AND
  9034*           WS-RE-NDX > ZERO   AND
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 179
* EL152.cbl
  9035*           WS-RE-NDX < 33
  9036*            MOVE HAN-REASON-TEXT (WS-RE-NDX)
  9037*                                TO AT-REASON-TEXT.
  9038
  9039     MOVE PI-ADDR-SEQ            TO AT-ADDRESS-REC-SEQ-NO.
  9040
  9041     IF PI-ADDR-TYPE > SPACES
  9042         MOVE PI-ADDR-TYPE          TO AT-ADDRESEE-TYPE
  9043         MOVE REC-TEXT (1)          TO AT-ADDRESSEE-NAME
  9044     ELSE
  9045     IF W-ACCOUNT > ZEROS
  9046         MOVE 'A'                   TO AT-ADDRESEE-TYPE
  9047         MOVE SS06D                 TO AT-ADDRESSEE-NAME
  9048     ELSE
  9049     IF W-BENEFICIARY > ZEROS
  9050          MOVE 'B'                  TO AT-ADDRESEE-TYPE
  9051          IF W-BENEFICIARY = 9
  9052              MOVE SS61D            TO AT-ADDRESSEE-NAME
  9053            ELSE
  9054              MOVE SS43D            TO AT-ADDRESSEE-NAME
  9055     ELSE
  9056     IF W-EMPLOYER > ZEROS
  9057          MOVE 'E'                  TO AT-ADDRESEE-TYPE
  9058          MOVE SS48D                TO AT-ADDRESSEE-NAME
  9059     ELSE
  9060     IF W-INSURED > ZEROS
  9061          MOVE 'I'                  TO AT-ADDRESEE-TYPE
  9062          MOVE SS57D                TO AT-ADDRESSEE-NAME
  9063     ELSE
  9064     IF W-PHYSICIAN > ZEROS
  9065          MOVE 'P'                  TO AT-ADDRESEE-TYPE
  9066          MOVE SS47D                TO AT-ADDRESSEE-NAME
  9067     ELSE
  9068     IF W-OTHER-1 > ZEROS
  9069          MOVE 'O'                  TO AT-ADDRESEE-TYPE
  9070          MOVE SS49D                TO AT-ADDRESSEE-NAME
  9071     ELSE
  9072     IF W-OTHER-2 > ZEROS
  9073          MOVE 'Q'                  TO AT-ADDRESEE-TYPE
  9074          MOVE SS50D                TO AT-ADDRESSEE-NAME
  9075     ELSE
  9076          MOVE SPACES               TO AT-ADDRESEE-TYPE
  9077                                       AT-ADDRESSEE-NAME.
  9078     IF PRINT-PERFORMED
  9079        MOVE CURRENT-SAVE        TO AT-INITIAL-PRINT-DATE
  9080     ELSE
  9081        MOVE LOW-VALUES          TO AT-INITIAL-PRINT-DATE.
  9082
  9083     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE.
  9084
  9085*    IF PI-COMPANY-ID = 'DMD'
  9086*        MOVE CL-CERT-STATE          TO WS-DMD-CERT-STATE
  9087*        MOVE CL-CERT-GROUPING (5:2) TO WS-DMD-CERT-GROUPING
  9088*        MOVE BEN-HOLD               TO WS-DMD-BEN-CODE
  9089*        MOVE AT-SEQUENCE-NO         TO WS-DMD-CORR-TRLR-SEQ
  9090*        MOVE AT-STD-LETTER-FORM     TO WS-DMD-LETTER-FORM.
  9091
  9092
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 180
* EL152.cbl
  9093* EXEC CICS WRITE
  9094*         DATASET    (ACTV-ID)
  9095*         FROM       (ACTIVITY-TRAILERS)
  9096*         RIDFLD     (AT-CONTROL-PRIMARY)
  9097*    END-EXEC.
  9098     MOVE LENGTH OF
  9099      ACTIVITY-TRAILERS
  9100       TO DFHEIV11
  9101*    MOVE '&$ L                  ''   #00008685' TO DFHEIV0
  9102     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9104     MOVE X'2020233030303038363835' TO DFHEIV0(25:11)
  9105     CALL 'kxdfhei1' USING DFHEIV0,
  9106           ACTV-ID,
  9107           ACTIVITY-TRAILERS,
  9108           DFHEIV11,
  9109           AT-CONTROL-PRIMARY,
  9110           DFHEIV99,
  9111           DFHEIV99
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9113
  9114
  9115
  9116* EXEC CICS HANDLE CONDITION
  9117*        DUPKEY      (6599-EXIT)
  9118*    END-EXEC.
  9119*    MOVE '"$$                   ! + #00008691' TO DFHEIV0
  9120     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9122     MOVE X'2B20233030303038363931' TO DFHEIV0(25:11)
  9123     CALL 'kxdfhei1' USING DFHEIV0
  9124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9125
  9126
  9127
  9128* EXEC CICS REWRITE
  9129*         DATASET    (CLAM-ID)
  9130*         FROM       (CLAIM-MASTER)
  9131*    END-EXEC.
  9132     MOVE LENGTH OF
  9133      CLAIM-MASTER
  9134       TO DFHEIV11
  9135*    MOVE '&& L                  %   #00008695' TO DFHEIV0
  9136     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9137     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9138     MOVE X'2020233030303038363935' TO DFHEIV0(25:11)
  9139     CALL 'kxdfhei1' USING DFHEIV0,
  9140           CLAM-ID,
  9141           CLAIM-MASTER,
  9142           DFHEIV11,
  9143           DFHEIV99
  9144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9145
  9146
  9147 6599-EXIT.
  9148      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 181
* EL152.cbl
  9150 6600-SET-ADDR-SEQ.
  9151     IF ADDRL = ZEROS
  9152        GO TO 6699-EXIT.
  9153
  9154     MOVE ADDRI                  TO PI-ADDR-TYPE
  9155                                    WS-ADDR-TYPE-CD.
  9156     IF WS-ADDR-SEQ NOT NUMERIC
  9157        GO TO 6699-EXIT.
  9158
  9159     MOVE ZEROS                  TO PI-ADDR-SEQ.
  9160
  9161     IF WS-ADDR-TYPE = 'I'
  9162        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9163     ELSE
  9164     IF WS-ADDR-TYPE = 'A'
  9165        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9166        ADD +20                  TO ACTV-SEQ
  9167     ELSE
  9168     IF WS-ADDR-TYPE = 'B'
  9169        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9170        ADD +10                  TO ACTV-SEQ
  9171     ELSE
  9172     IF WS-ADDR-TYPE = 'P'
  9173        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9174        ADD +30                  TO ACTV-SEQ
  9175     ELSE
  9176     IF WS-ADDR-TYPE = 'E'
  9177        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9178        ADD +40                  TO ACTV-SEQ
  9179     ELSE
  9180     IF WS-ADDR-TYPE = 'O'
  9181        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9182        ADD +50                  TO ACTV-SEQ
  9183     ELSE
  9184     IF WS-ADDR-TYPE = 'Q'
  9185        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9186        ADD +60                  TO ACTV-SEQ.
  9187
  9188 6699-EXIT.
  9189      EXIT.
  9190
  9191 6700-BUILD-NAPERSOFT.
  9192
  9193
  9194* EXEC CICS GETMAIN
  9195*         SET      (ADDRESS OF NAPERSOFT-FILE)
  9196*         LENGTH   (NAPS-LENGTH)
  9197*    END-EXEC.
  9198*    MOVE '," L                  $   #00008746' TO DFHEIV0
  9199     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9200     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9201     MOVE X'2020233030303038373436' TO DFHEIV0(25:11)
  9202     CALL 'kxdfhei1' USING DFHEIV0,
  9203           DFHEIV20,
  9204           NAPS-LENGTH,
  9205           DFHEIV99
  9206     SET ADDRESS OF NAPERSOFT-FILE TO
  9207         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 182
* EL152.cbl
  9208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9209
  9210
  9211     MOVE LOW-VALUES            TO  NAPERSOFT-FILE.
  9212     MOVE 'NA'                  TO  NA-RECORD-ID.
  9213     MOVE PI-COMPANY-CD         TO  NA-COMPANY-CD.
  9214     MOVE PI-CARRIER            TO  NA-CARRIER.
  9215     MOVE PI-CLAIM-NO           TO  NA-CLAIM-NO.
  9216     MOVE PI-CERT-NO            TO  NA-CERT-NO.
  9217     MOVE ARCH-NUMBER           TO  NA-ARCHIVE-NO.
  9218     MOVE FORMI                 TO  NA-LETTER-ID.
  9219     MOVE PI-PROCESSOR-ID       TO  NA-PROCESSOR-ID.
  9220     MOVE CURRENT-SAVE          TO  NA-CREATION-DT.
  9221     IF PRINT-PERFORMED
  9222         MOVE CURRENT-SAVE      TO  NA-INITIAL-PRINT-DT
  9223     ELSE
  9224         MOVE LOW-VALUES        TO  NA-INITIAL-PRINT-DT
  9225     END-IF.
  9226     MOVE FOLLOW-UP-SAVE        TO  NA-FOLLOW-UP-DT.
  9227     MOVE RESEND-SAVE           TO  NA-RESEND-DT
  9228     MOVE PI-RESEND-FORM-NUMBER TO  NA-RESEND-LETTER-ID.
  9229     IF COPIESL NOT = ZEROS
  9230         MOVE COPIESI           TO  NA-NO-OF-COPIES
  9231     ELSE
  9232         MOVE 1                 TO  NA-NO-OF-COPIES
  9233     END-IF.
  9234     IF PI-LETTER-ADDRESS-TYPE = ' 0'
  9235         MOVE LOW-VALUES        TO  NA-ADDRESS-TYPE
  9236     ELSE
  9237         MOVE PI-LETTER-ADDRESS-TYPE TO NA-ADDRESS-TYPE
  9238     END-IF.
  9239     MOVE CORR-TRLR-SEQ         TO  NA-CORR-TRLR-SEQ.
  9240     MOVE PI-ENCLOSURE-CD       TO  NA-ENCLOSURE-CD.
  9241
  9242
  9243* EXEC CICS WRITE
  9244*         DATASET    (NAPS-ID)
  9245*         FROM       (NAPERSOFT-FILE)
  9246*         RIDFLD     (NA-CONTROL-PRIMARY)
  9247*    END-EXEC.
  9248     MOVE LENGTH OF
  9249      NAPERSOFT-FILE
  9250       TO DFHEIV11
  9251*    MOVE '&$ L                  ''   #00008782' TO DFHEIV0
  9252     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9254     MOVE X'2020233030303038373832' TO DFHEIV0(25:11)
  9255     CALL 'kxdfhei1' USING DFHEIV0,
  9256           NAPS-ID,
  9257           NAPERSOFT-FILE,
  9258           DFHEIV11,
  9259           NA-CONTROL-PRIMARY,
  9260           DFHEIV99,
  9261           DFHEIV99
  9262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9263
  9264
  9265 6799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 183
* EL152.cbl
  9266      EXIT.
  9267
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 184
* EL152.cbl
  9269 7000-READ-ADDR.
  9270     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  9271        IF ADDRL = ZEROS
  9272           GO TO 7099-EXIT
  9273        ELSE
  9274           MOVE ER-0374             TO EMI-ERROR
  9275           MOVE -1                  TO ADDRL
  9276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9277           GO TO 7099-EXIT.
  9278
  9279     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  9280                                    ACTV-CLAIM.
  9281
  9282
  9283* EXEC CICS HANDLE CONDITION
  9284*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  9285*         NOTFND     (7090-CLAIM-NOT-FOUND)
  9286*     END-EXEC.
  9287*    MOVE '"$JI                  ! , #00008805' TO DFHEIV0
  9288     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9290     MOVE X'2C20233030303038383035' TO DFHEIV0(25:11)
  9291     CALL 'kxdfhei1' USING DFHEIV0
  9292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9293
  9294
  9295
  9296* EXEC CICS READ
  9297*         DATASET    (CLAM-ID)
  9298*         SET        (ADDRESS OF CLAIM-MASTER)
  9299*         RIDFLD     (CLAM-KEY)
  9300*    END-EXEC.
  9301*    MOVE '&"S        E          (   #00008810' TO DFHEIV0
  9302     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9304     MOVE X'2020233030303038383130' TO DFHEIV0(25:11)
  9305     CALL 'kxdfhei1' USING DFHEIV0,
  9306           CLAM-ID,
  9307           DFHEIV20,
  9308           DFHEIV99,
  9309           CLAM-KEY,
  9310           DFHEIV99,
  9311           DFHEIV99,
  9312           DFHEIV99
  9313     SET ADDRESS OF CLAIM-MASTER TO
  9314         DFHEIV20
  9315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9316
  9317
  9318*    IF PI-COMPANY-ID = 'DMD'
  9319*            AND
  9320*       NOT SYSTEM-MODIFY-CAP
  9321*            AND
  9322*        HIGHEST-PRIORITY
  9323*        IF MAINTI = 'R'
  9324*            MOVE ER-0909        TO EMI-ERROR
  9325*            MOVE -1             TO ADDRL
  9326*            MOVE AL-UABON       TO ADDRA
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 185
* EL152.cbl
  9327*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9328*            GO TO 8200-SEND-DATAONLY
  9329*        ELSE
  9330*            MOVE ER-0900        TO EMI-ERROR
  9331*            MOVE -1             TO ADDRL
  9332*            MOVE AL-UABON       TO ADDRA
  9333*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9334*            GO TO 8200-SEND-DATAONLY.
  9335
  9336     IF ADDRL = ZEROS
  9337        GO TO 7099-EXIT.
  9338
  9339*    IF PI-COMPANY-ID = 'DMD'
  9340*        IF MAINTI = 'C'
  9341*           IF CL-BENEFICIARY = '0000B0CA10' OR '0000B0CAN0' OR
  9342*                               '0000B0CAS0' OR '0000B0CA50' OR
  9343*                               '0000B0CAA0' OR '0000B0CAB0' OR
  9344*                               '0000B0CAC0' OR '0000B0CAD0' OR
  9345*                               '0000B0CO20' OR '0000B0MN10' OR
  9346*                               '0000B0MN20' OR '0000B0MN30' OR
  9347*                               '0000B0MN40' OR '0000B0MN50' OR
  9348*                               '0000B0MN60' OR '0000B0MN70'
  9349*           IF ADDRI(1:1) = 'B'
  9350*              MOVE ER-8158     TO EMI-ERROR
  9351*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9352*              MOVE -1          TO MAINTL
  9353*              GO TO 8200-SEND-DATAONLY.
  9354*
  9355*    IF PI-COMPANY-ID = 'DMD'
  9356*      PERFORM 4000-SET-BSR THRU 4000-EXIT
  9357*      IF PI-BSR-AUTOMATED
  9358*        IF MAINTI = 'C'
  9359*           MOVE ER-7843          TO EMI-ERROR
  9360*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9361*           MOVE -1               TO MAINTL
  9362*           GO TO 8200-SEND-DATAONLY.
  9363
  9364     PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT.
  9365
  9366     MOVE ADDRI TO WS-ADDR-TYPE-CD.
  9367
  9368*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9369*        GO TO 7040-READ-PRODUCER.
  9370
  9371 7010-READ-ACCT.
  9372
  9373     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9374     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9375     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9376     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DATE.
  9377
  9378
  9379* EXEC CICS HANDLE CONDITION
  9380*         NOTOPEN    (8880-ACCT-NOT-OPEN)
  9381*         NOTFND     (7080-ACCT-NOT-FOUND)
  9382*    END-EXEC.
  9383*    MOVE '"$JI                  ! - #00008876' TO DFHEIV0
  9384     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 186
* EL152.cbl
  9385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9386     MOVE X'2D20233030303038383736' TO DFHEIV0(25:11)
  9387     CALL 'kxdfhei1' USING DFHEIV0
  9388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9389
  9390
  9391     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
  9392
  9393     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  9394
  9395 7020-READNEXT.
  9396
  9397     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
  9398
  9399     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  9400        IF WS-SAVE-ACCT-RECORD = SPACES
  9401            GO TO 7080-ACCT-NOT-FOUND
  9402        ELSE
  9403            MOVE 'Y'                 TO  WS-ACCT-READ-SW
  9404            MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
  9405            MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
  9406            GO TO 7030-CONTINUE-BUILD-ADDR.
  9407
  9408     IF AM-EXPIRATION-DT = HIGH-VALUES
  9409         NEXT SENTENCE
  9410     ELSE
  9411         MOVE ACCOUNT-MASTER         TO  WS-SAVE-ACCT-RECORD
  9412         GO TO 7020-READNEXT.
  9413
  9414     MOVE AM-CONTROL-PRIMARY TO ACCT-KEY.
  9415     MOVE 'Y'                TO WS-ACCT-READ-SW.
  9416
  9417 7030-CONTINUE-BUILD-ADDR.
  9418
  9419     MOVE SPACES             TO  WS-SAVE-ACCT-RECORD.
  9420
  9421     IF WS-ADDR-TYPE-CD = 'A0'
  9422        MOVE ZEROS               TO PI-ADDR-SEQ
  9423     ELSE
  9424        GO TO 7067-CHECK-BENE-ADDR.
  9425
  9426     MOVE SPACES             TO               WS-LABEL-HOLD-AREA.
  9427     MOVE AM-NAME            TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9428     MOVE AM-PERSON          TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9429     MOVE AM-ADDRS           TO  REC-TEXT (3) WS-LABEL-LINES (3).
  9430*    MOVE AM-CITY            TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9431     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
  9432        INTO WS-LABEL-LINES (4)
  9433     END-STRING
  9434     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9435     MOVE SPACES             TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9436
  9437     MOVE SPACES             TO  WS-ZIP-CODE.
  9438
  9439     IF AM-CANADIAN-POST-CODE
  9440         MOVE AM-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9441         MOVE AM-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9442     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 187
* EL152.cbl
  9443         MOVE AM-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9444         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9445             MOVE '-'            TO  WS-AM-ZIP-DASH
  9446             MOVE AM-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9447
  9448     MOVE WS-ZIP-CODE        TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9449
  9450     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9451
  9452     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9453     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9454     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9455     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9456     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9457     MOVE WS-LABEL-LINES (6) TO  REC-TEXT (6)    SS05-6D.
  9458
  9459     GO TO 7099-EXIT.
  9460
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 188
* EL152.cbl
  9462*7040-READ-PRODUCER. Remove as dead code
  9463*7050-READNEXT. Remove as dead code
  9464*7060-CONTINUE-BUILD-ADDR. Remove as dead code
  9465 7067-CHECK-BENE-ADDR.
  9466
  9467*    IF PI-COMPANY-ID = 'DMD'
  9468*        IF WS-ADDR-TYPE-CD = 'B9'
  9469*            GO TO 7067-CHECK-BENE-ADDR-9.
  9470
  9471     IF WS-ADDR-TYPE-CD NOT = 'B0'
  9472         GO TO 7068-CONTINUE-BUILD-ADDR.
  9473
  9474     IF CL-BENEFICIARY = SPACES
  9475         GO TO 7070-ACTV-NOT-FOUND.
  9476
  9477
  9478* EXEC CICS HANDLE CONDITION
  9479*         NOTFND     (7070-ACTV-NOT-FOUND)
  9480*    END-EXEC.
  9481*    MOVE '"$I                   ! . #00008967' TO DFHEIV0
  9482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9484     MOVE X'2E20233030303038393637' TO DFHEIV0(25:11)
  9485     CALL 'kxdfhei1' USING DFHEIV0
  9486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9487
  9488
  9489     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9490     MOVE 'B'                    TO BENE-REC-TYPE.
  9491     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9492
  9493
  9494* EXEC CICS READ
  9495*         DATASET    (BENE-ID)
  9496*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9497*         RIDFLD     (BENE-KEY)
  9498*    END-EXEC.
  9499*    MOVE '&"S        E          (   #00008975' TO DFHEIV0
  9500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9502     MOVE X'2020233030303038393735' TO DFHEIV0(25:11)
  9503     CALL 'kxdfhei1' USING DFHEIV0,
  9504           BENE-ID,
  9505           DFHEIV20,
  9506           DFHEIV99,
  9507           BENE-KEY,
  9508           DFHEIV99,
  9509           DFHEIV99,
  9510           DFHEIV99
  9511     SET ADDRESS OF BENEFICIARY-MASTER TO
  9512         DFHEIV20
  9513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9514
  9515
  9516     MOVE SPACES              TO  WS-LABEL-HOLD-AREA.
  9517     MOVE BE-MAIL-TO-NAME     TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9518     MOVE BE-ADDRESS-LINE-1   TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9519     MOVE BE-ADDRESS-LINE-2   TO  REC-TEXT (3) WS-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 189
* EL152.cbl
  9520     MOVE BE-ADDRESS-LINE-3   TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9521*    MOVE BE-CITY-STATE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9522     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
  9523        INTO WS-LABEL-LINES (5)
  9524     END-STRING
  9525     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9526
  9527     MOVE SPACES              TO  WS-ZIP-CODE.
  9528     IF BE-CANADIAN-POST-CODE
  9529         MOVE BE-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9530         MOVE BE-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9531     ELSE
  9532         MOVE BE-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9533         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9534             MOVE '-'            TO  WS-AM-ZIP-DASH
  9535             MOVE BE-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9536
  9537     MOVE WS-ZIP-CODE         TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9538
  9539     GO TO 7069-SET-ADDR.
  9540
  9541 7067-CHECK-BENE-ADDR-9.
  9542
  9543     IF CL-BENEFICIARY = SPACES
  9544         GO TO 7070-ACTV-NOT-FOUND.
  9545
  9546
  9547* EXEC CICS HANDLE CONDITION
  9548*         NOTFND     (7070-ACTV-NOT-FOUND)
  9549*    END-EXEC.
  9550*    MOVE '"$I                   ! / #00009011' TO DFHEIV0
  9551     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9553     MOVE X'2F20233030303039303131' TO DFHEIV0(25:11)
  9554     CALL 'kxdfhei1' USING DFHEIV0
  9555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9556
  9557
  9558     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9559     MOVE 'B'                    TO BENE-REC-TYPE.
  9560     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9561
  9562
  9563* EXEC CICS READ
  9564*         DATASET    (BENE-ID)
  9565*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9566*         RIDFLD     (BENE-KEY)
  9567*    END-EXEC.
  9568*    MOVE '&"S        E          (   #00009019' TO DFHEIV0
  9569     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9570     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9571     MOVE X'2020233030303039303139' TO DFHEIV0(25:11)
  9572     CALL 'kxdfhei1' USING DFHEIV0,
  9573           BENE-ID,
  9574           DFHEIV20,
  9575           DFHEIV99,
  9576           BENE-KEY,
  9577           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 190
* EL152.cbl
  9578           DFHEIV99,
  9579           DFHEIV99
  9580     SET ADDRESS OF BENEFICIARY-MASTER TO
  9581         DFHEIV20
  9582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9583
  9584
  9585     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
  9586     MOVE BE-MAIL-TO-NAME2       TO REC-TEXT (1)
  9587                                    WS-LABEL-LINES (1).
  9588     MOVE BE-ADDRESS-LINE-12     TO REC-TEXT (2)
  9589                                    WS-LABEL-LINES (2).
  9590     MOVE BE-ADDRESS-LINE-22     TO REC-TEXT (3)
  9591                                    WS-LABEL-LINES (3).
  9592     MOVE BE-ADDRESS-LINE-32     TO REC-TEXT (4)
  9593                                    WS-LABEL-LINES (4).
  9594*    MOVE BE-CITY-STATE2         TO REC-TEXT (5)
  9595*                                   WS-LABEL-LINES (5).
  9596     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
  9597        INTO WS-LABEL-LINES (5)
  9598     END-STRING
  9599     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9600
  9601     MOVE SPACES                 TO WS-ZIP-CODE.
  9602
  9603     IF BE-CANADIAN-POST-CODE2
  9604         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
  9605         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
  9606     ELSE
  9607         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
  9608         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
  9609             MOVE '-'            TO WS-AM-ZIP-DASH
  9610             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
  9611
  9612     MOVE WS-ZIP-CODE            TO REC-TEXT (6)
  9613                                    WS-LABEL-LINES (6).
  9614
  9615     GO TO 7069-SET-ADDR.
  9616
  9617 7068-CONTINUE-BUILD-ADDR.
  9618
  9619     IF ACTV-SEQ = ZEROS
  9620        GO TO 7070-ACTV-NOT-FOUND.
  9621
  9622     MOVE ACTV-SEQ               TO PI-ADDR-SEQ.
  9623
  9624
  9625* EXEC CICS HANDLE CONDITION
  9626*         NOTOPEN    (8870-ACTV-NOT-OPEN)
  9627*         NOTFND     (7070-ACTV-NOT-FOUND)
  9628*    END-EXEC.
  9629*    MOVE '"$JI                  ! 0 #00009064' TO DFHEIV0
  9630     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9632     MOVE X'3020233030303039303634' TO DFHEIV0(25:11)
  9633     CALL 'kxdfhei1' USING DFHEIV0
  9634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9635
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 191
* EL152.cbl
  9636
  9637
  9638* EXEC CICS READ
  9639*         DATASET    (ACTV-ID)
  9640*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
  9641*         RIDFLD     (ACTV-KEY)
  9642*    END-EXEC.
  9643*    MOVE '&"S        E          (   #00009069' TO DFHEIV0
  9644     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9645     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9646     MOVE X'2020233030303039303639' TO DFHEIV0(25:11)
  9647     CALL 'kxdfhei1' USING DFHEIV0,
  9648           ACTV-ID,
  9649           DFHEIV20,
  9650           DFHEIV99,
  9651           ACTV-KEY,
  9652           DFHEIV99,
  9653           DFHEIV99,
  9654           DFHEIV99
  9655     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9656         DFHEIV20
  9657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9658
  9659
  9660     MOVE SPACES            TO              WS-LABEL-HOLD-AREA.
  9661     MOVE AT-MAIL-TO-NAME   TO REC-TEXT (1) WS-LABEL-LINES (1).
  9662     MOVE AT-ADDRESS-LINE-1 TO REC-TEXT (2) WS-LABEL-LINES (2).
  9663     MOVE AT-ADDRESS-LINE-2 TO REC-TEXT (3) WS-LABEL-LINES (3).
  9664*    MOVE AT-CITY-STATE     TO REC-TEXT (4) WS-LABEL-LINES (4).
  9665     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
  9666        INTO WS-LABEL-LINES (4)
  9667     END-STRING
  9668     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9669
  9670     MOVE SPACES            TO  WS-ZIP-CODE.
  9671     IF AT-CANADIAN-POST-CODE
  9672         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9673         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9674     ELSE
  9675         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
  9676         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9677             MOVE '-'            TO  WS-AM-ZIP-DASH
  9678             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9679
  9680     MOVE WS-ZIP-CODE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9681
  9682     MOVE SPACES            TO  REC-TEXT (6).
  9683
  9684 7069-SET-ADDR.
  9685     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9686
  9687     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9688     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9689     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9690     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9691     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9692     MOVE SPACES             TO  REC-TEXT (6)    SS05-6D.
  9693
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 192
* EL152.cbl
  9694     GO TO 7099-EXIT.
  9695
  9696 7070-ACTV-NOT-FOUND.
  9697
  9698     IF ACTV-SEQ NOT = +29
  9699        GO TO 7075-CONTINUE-ACTV-ERROR.
  9700
  9701*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9702*        GO TO 7099-EXIT.
  9703
  9704     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9705        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
  9706        GO TO 7075-CONTINUE-ACTV-ERROR.
  9707
  9708     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
  9709        GO TO 7075-CONTINUE-ACTV-ERROR.
  9710
  9711     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD
  9712     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER
  9713     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING
  9714     MOVE 'A'             TO WS-ERCOMP-TYPE
  9715     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9716                          TO WS-ERCOMP-RESP-NO.
  9717
  9718     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
  9719         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
  9720                                       'G' OR 'B'
  9721             MOVE 'G'            TO WS-ERCOMP-TYPE
  9722             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
  9723         ELSE
  9724             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9725                                 TO WS-ERCOMP-ACCOUNT
  9726     ELSE
  9727         MOVE 'G'                TO WS-ERCOMP-TYPE
  9728         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
  9729
  9730     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  9731        MOVE ZEROS TO WS-ERCOMP-CARRIER.
  9732
  9733     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  9734        MOVE ZEROS TO WS-ERCOMP-GROUPING.
  9735
  9736
  9737* EXEC CICS HANDLE CONDITION
  9738*         NOTFND    (7075-CONTINUE-ACTV-ERROR)
  9739*    END-EXEC.
  9740*    MOVE '"$I                   ! 1 #00009151' TO DFHEIV0
  9741     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9742     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9743     MOVE X'3120233030303039313531' TO DFHEIV0(25:11)
  9744     CALL 'kxdfhei1' USING DFHEIV0
  9745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9746
  9747
  9748
  9749* EXEC CICS  READ
  9750*         SET      (ADDRESS OF COMPENSATION-MASTER)
  9751*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 193
* EL152.cbl
  9752*         RIDFLD   (WS-ERCOMP-KEY)
  9753*    END-EXEC.
  9754     MOVE 'ERCOMP' TO DFHEIV1
  9755*    MOVE '&"S        E          (   #00009155' TO DFHEIV0
  9756     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9758     MOVE X'2020233030303039313535' TO DFHEIV0(25:11)
  9759     CALL 'kxdfhei1' USING DFHEIV0,
  9760           DFHEIV1,
  9761           DFHEIV20,
  9762           DFHEIV99,
  9763           WS-ERCOMP-KEY,
  9764           DFHEIV99,
  9765           DFHEIV99,
  9766           DFHEIV99
  9767     SET ADDRESS OF COMPENSATION-MASTER TO
  9768         DFHEIV20
  9769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9770
  9771
  9772     MOVE 'Y'                   TO WS-COMP-READ-SW.
  9773     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
  9774     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
  9775
  9776     IF CO-ACCT-NAME = SPACES
  9777        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
  9778
  9779     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
  9780     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
  9781     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
  9782
  9783     MOVE SPACES                TO  WS-ZIP-CODE.
  9784     IF CO-CANADIAN-POST-CODE
  9785         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
  9786         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
  9787     ELSE
  9788         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
  9789         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9790             MOVE '-'           TO  WS-AM-ZIP-DASH
  9791             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
  9792
  9793     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
  9794
  9795     MOVE ZEROS                 TO WS-PHONE-IN.
  9796     MOVE CO-AREA-CODE          TO WSPO-AREA.
  9797     MOVE CO-PREFIX             TO WSPO-PFX.
  9798     MOVE CO-PHONE              TO WSPO-SFX.
  9799     MOVE WS-PHONE-OUT          TO SS53-6D.
  9800
  9801     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9802
  9803     MOVE WS-LABEL-LINES (1)     TO REC-TEXT (1)    SS52D.
  9804     MOVE WS-LABEL-LINES (2)     TO REC-TEXT (2)    SS53-1D.
  9805     MOVE WS-LABEL-LINES (3)     TO REC-TEXT (3)    SS53-2D.
  9806     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)    SS53-3D.
  9807     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)    SS53-4D.
  9808     MOVE WS-LABEL-LINES (6)     TO REC-TEXT (6)    SS53-5D.
  9809
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 194
* EL152.cbl
  9810     GO TO 7099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 195
* EL152.cbl
  9812
  9813 7075-CONTINUE-ACTV-ERROR.
  9814     MOVE ER-0178                TO EMI-ERROR.
  9815     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9816     MOVE -1                     TO ADDRL.
  9817     MOVE AL-UABON               TO ADDRA.
  9818     MOVE SPACES                 TO PI-ADDR-TYPE.
  9819     MOVE SPACES                 TO REC-TEXT (1)
  9820                                    REC-TEXT (2)
  9821                                    REC-TEXT (3)
  9822                                    REC-TEXT (4)
  9823                                    REC-TEXT (5)
  9824                                    REC-TEXT (6).
  9825     GO TO 7099-EXIT.
  9826
  9827 7080-ACCT-NOT-FOUND.
  9828     MOVE ER-0179                TO EMI-ERROR.
  9829     MOVE -1                     TO ADDRL.
  9830     MOVE AL-UABON               TO ADDRA.
  9831     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9832     GO TO 8200-SEND-DATAONLY.
  9833
  9834 7090-CLAIM-NOT-FOUND.
  9835     MOVE ER-0186                TO EMI-ERROR.
  9836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9837     GO TO 8200-SEND-DATAONLY.
  9838
  9839*7095-PROD-NOT-FOUND. Remove as dead code
  9840
  9841 7099-EXIT.
  9842      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 196
* EL152.cbl
  9844
  9845 7170-FORMAT-SCREEN.
  9846     IF MAINTI = 'S'
  9847        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  9848       ELSE
  9849        MOVE AL-UANOF            TO SC-TEXTA (SC-INDX).
  9850
  9851     IF TB-INDX < 7
  9852        SET LINE23 TO TB-INDX
  9853        MOVE 'A'                 TO LINE1
  9854       ELSE
  9855        IF TB-INDX = 7
  9856           MOVE ZEROS            TO LINE-NUM
  9857        ELSE
  9858           SET LIN-NUM TO TB-INDX
  9859           SUBTRACT 7            FROM LIN-NUM.
  9860
  9861     MOVE LINE-NUM               TO SC-LINE (SC-INDX).
  9862     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  9863     SET TB-INDX UP BY 1.
  9864
  9865 7170-EXIT.
  9866      EXIT.
  9867
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 197
* EL152.cbl
  9869 7200-RESOLVE-VARIABLES.
  9870***************************************************************
  9871*    THIS ROUTINE WILL FORMAT THE SYSTEM-DEFINED SYMBOLS      *
  9872*    WITH DATA PERTAINING TO THE DESIGNATED CLAIM.            *
  9873*    THIS ROUTINE IS PERFORMED THRU 7269-EXIT TO              *
  9874*    RESOLVE ALL OF THE SYMBOLS.                              *
  9875***************************************************************
  9876
  9877*    IF PI-COMPANY-ID = 'AUK'
  9878*        MOVE 'Y'                TO W-REVERSE-DATE-SW.
  9879
  9880     MOVE PI-CLAIM-NO            TO SS34D.
  9881
  9882     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9883        MOVE PI-LIFE-OVERRIDE-L6 TO SS12D
  9884     ELSE
  9885        MOVE PI-AH-OVERRIDE-L6   TO SS12D.
  9886
  9887     MOVE CL-LAST-PMT-AMT        TO SS16D.
  9888     MOVE CL-TOTAL-PAID-AMT      TO SS18D.
  9889     MOVE CL-CAUSE-CD            TO SS19-1D.
  9890     MOVE CL-ASSOC-CERT-SEQU     TO SS54D.
  9891     MOVE CL-ASSOC-CERT-TOTAL    TO SS55D.
  9892
  9893*    IF PI-COMPANY-ID NOT = 'DMD'
  9894*        GO TO 7200-CONTINUE.
  9895
  9896     IF CL-CCN-PREFIX-A5 = '1111' OR '3333' OR '6666' OR
  9897                           '8888' OR '9876'
  9898         MOVE CL-CCN-PRIME-A5    TO WS-CCN-12
  9899         MOVE WS-CCN-12          TO CL-CCN.
  9900
  9901     IF CL-CERT-STATE NOT = '08' AND '09'
  9902         MOVE SPACES             TO SS62D
  9903                                    SS63D
  9904         GO TO 7200-CONTINUE.
  9905
  9906     MOVE WS-DMD-UND-STATEMENT   TO SS62D.
  9907
  9908     MOVE 'CL'                   TO DL23-SYSTEM-ID.
  9909     MOVE 'UN'                   TO DL23-RECORD-TYPE.
  9910     MOVE CL-CERT-STATE          TO DL23-RECORD-KEY.
  9911
  9912
  9913* EXEC CICS LINK
  9914*        PROGRAM    ('DLO023')
  9915*        COMMAREA   (WS-DLO-CODES-TABLE)
  9916*        LENGTH     (DL23-COMM-LENGTH)
  9917*    END-EXEC.
  9918     MOVE 'DLO023' TO DFHEIV1
  9919*    MOVE '."C                   (   #00009301' TO DFHEIV0
  9920     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9922     MOVE X'2020233030303039333031' TO DFHEIV0(25:11)
  9923     CALL 'kxdfhei1' USING DFHEIV0,
  9924           DFHEIV1,
  9925           WS-DLO-CODES-TABLE,
  9926           DL23-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 198
* EL152.cbl
  9927           DFHEIV99,
  9928           DFHEIV99,
  9929           DFHEIV99,
  9930           DFHEIV99
  9931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9932
  9933
  9934     IF DL23-RETURN-CODE = 'OK'
  9935         MOVE DL23-CODE-DESC     TO SS63D
  9936       ELSE
  9937         MOVE SPACES             TO SS63D.
  9938
  9939 7200-CONTINUE.
  9940     MOVE CL-CCN                 TO SS60D.
  9941
  9942     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  9943     MOVE SPACES                 TO DC-OPTION-CODE.
  9944     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9945     IF NO-CONVERSION-ERROR
  9946        MOVE DC-GREG-DATE-1-EDIT TO SS13D.
  9947
  9948     MOVE CL-REPORTED-DT         TO DC-BIN-DATE-1.
  9949     MOVE SPACES                 TO DC-OPTION-CODE.
  9950     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9951     IF NO-CONVERSION-ERROR
  9952        MOVE DC-GREG-DATE-1-EDIT TO SS14D.
  9953
  9954     MOVE CL-LAST-PMT-DT         TO DC-BIN-DATE-1.
  9955     MOVE SPACES                 TO DC-OPTION-CODE.
  9956     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9957     IF NO-CONVERSION-ERROR
  9958        MOVE DC-GREG-DATE-1-EDIT TO SS15D.
  9959
  9960     IF NOT PI-USES-PAID-TO
  9961        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9962        MOVE SPACES                 TO DC-OPTION-CODE
  9963        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9964        IF NO-CONVERSION-ERROR
  9965           MOVE DC-GREG-DATE-1-EDIT TO SS17D
  9966        ELSE
  9967           MOVE SPACES TO SS17D
  9968     ELSE
  9969        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9970        MOVE '6'                    TO DC-OPTION-CODE
  9971        MOVE +1                     TO DC-ELAPSED-DAYS
  9972        MOVE +0                     TO DC-ELAPSED-MONTHS
  9973        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9974        IF NO-CONVERSION-ERROR
  9975           MOVE DC-GREG-DATE-1-EDIT TO SS17D.
  9976
  9977     MOVE CL-INSURED-BIRTH-DT    TO DC-BIN-DATE-1.
  9978     MOVE SPACES                 TO DC-OPTION-CODE.
  9979     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9980     IF NO-CONVERSION-ERROR
  9981        MOVE DC-GREG-DATE-1-EDIT TO SS45D
  9982     ELSE
  9983        MOVE '@@DOB'             TO SS45D.
  9984
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 199
* EL152.cbl
  9985     IF CL-SSN-STATE   = CL-CERT-STATE  AND
  9986        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
  9987             NEXT SENTENCE
  9988         ELSE
  9989             MOVE CL-SOC-SEC-NO  TO SS46D.
  9990
  9991     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
  9992                                    ACCT-GROUPING
  9993                                    PROD-GROUPING
  9994                                    PLCY-GROUPING
  9995                                    PLAN-GROUPING.
  9996     MOVE CL-CERT-STATE          TO CERT-STATE
  9997                                    ACCT-STATE
  9998                                    PROD-STATE
  9999                                    PLCY-STATE
 10000                                    PLAN-STATE.
 10001     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 10002                                    ACCT-ACCOUNT
 10003                                    PROD-PRODUCER
 10004                                    PLCY-PRODUCER
 10005                                    PLAN-PRODUCER.
 10006     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
 10007                                    PLCY-EFF-DT.
 10008     MOVE CL-CV-REFERENCE-NO     TO PLCY-REFERENCE-NO.
 10009
 10010     PERFORM 5000-MOVE-NAME THRU 5000-EXIT.
 10011
 10012*    IF PI-COMPANY-ID = 'DMD'
 10013*       MOVE WS-NAME-WORK           TO SS10D
 10014*       GO TO 7200-CONTINUE-2.
 10015
 10016     IF LOWER-CASE-LETTERS-USED
 10017        MOVE 'N'                    TO WS-STATE-LINE
 10018        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10019        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10020        MOVE WS-TEMP-AREA2          TO SS10D
 10021     ELSE
 10022        MOVE WS-NAME-WORK           TO SS10D.
 10023
 10024 7200-CONTINUE-2.
 10025     MOVE CL-INSURED-1ST-NAME     TO W-FIRST-NAME.
 10026     MOVE CL-INSURED-LAST-NAME    TO W-LAST-NAME.
 10027     MOVE CL-INSURED-MID-INIT     TO W-MIDDLE-NAME.
 10028     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10029
 10030     IF LOWER-CASE-LETTERS-USED
 10031        MOVE 'N'                    TO WS-STATE-LINE
 10032        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10033        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10034        MOVE WS-TEMP-AREA2          TO SS39D
 10035     ELSE
 10036        MOVE WS-NAME-WORK           TO SS39D.
 10037
 10038     MOVE CL-INSURED-LAST-NAME   TO SS40D.
 10039
 10040     IF INSURED-IS-FEMALE
 10041        MOVE 'MS.'               TO SS41D
 10042       ELSE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 200
* EL152.cbl
 10043        MOVE 'MR.'               TO SS41D.
 10044
 10045*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10046*        PERFORM 7290-RESOLVE-CREDITOR THRU 7290-EXIT.
 10047
 10048*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10049*        GO TO 7200-READ-EMPLCY.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 201
* EL152.cbl
 10051
 10052* EXEC CICS HANDLE CONDITION
 10053*         NOTOPEN   (8900-CERT-NOT-OPEN)
 10054*         NOTFND    (8910-CERT-NOT-FOUND)
 10055*    END-EXEC.
 10056*    MOVE '"$JI                  ! 2 #00009424' TO DFHEIV0
 10057     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10059     MOVE X'3220233030303039343234' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063
 10064
 10065* EXEC CICS READ
 10066*         DATASET   (CERT-ID)
 10067*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10068*         RIDFLD    (CERT-KEY)
 10069*    END-EXEC.
 10070*    MOVE '&"S        E          (   #00009429' TO DFHEIV0
 10071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10073     MOVE X'2020233030303039343239' TO DFHEIV0(25:11)
 10074     CALL 'kxdfhei1' USING DFHEIV0,
 10075           CERT-ID,
 10076           DFHEIV20,
 10077           DFHEIV99,
 10078           CERT-KEY,
 10079           DFHEIV99,
 10080           DFHEIV99,
 10081           DFHEIV99
 10082     SET ADDRESS OF CERTIFICATE-MASTER TO
 10083         DFHEIV20
 10084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10085
 10086
 10087*    IF PI-COMPANY-ID = 'DMD'
 10088*        MOVE CM-RESIDENT-STATE  TO WS-DMD-RES-ST
 10089*        IF CM-POLICY-FORM-NO(6:1) = '1'
 10090*            MOVE WS-DMD-UND-COMPANYA    TO SS64D
 10091*          ELSE
 10092*        IF CM-POLICY-FORM-NO(6:1) = '2'
 10093*            MOVE WS-DMD-UND-COMPANYB    TO SS64D
 10094*          ELSE
 10095*            MOVE SPACES                 TO SS64D.
 10096
 10097     MOVE CM-CERT-NO             TO SS26D.
 10098     MOVE CM-INSURED-ISSUE-AGE   TO SS33D.
 10099
 10100*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10101*        MOVE CL-CURRENT-CARRIER TO SS23D
 10102*        MOVE CL-CURRENT-GROUPING
 10103*                                TO SS24D
 10104*        MOVE CL-CURRENT-ACCOUNT TO SS25D
 10105*        MOVE CM-MEMBER-NO       TO SS36D
 10106*        MOVE CM-GROUPING        TO W-GROUPING
 10107*        IF W-GROUP-3 = 'C01' OR 'C02'
 10108*            MOVE CM-MEMBER-NO   TO W-CURRENT-LOAN-NO
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 202
* EL152.cbl
 10109*            MOVE CM-LOAN-NUMBER TO W-LOAN-NO
 10110*            MOVE W-CREDIT-CARD-LOAN-NO
 10111*                                TO SS36-1D
 10112*        ELSE
 10113*            MOVE CM-MEMBER-NO   TO SS36-1D
 10114*    ELSE
 10115         MOVE CM-CARRIER         TO SS23D.
 10116         MOVE CM-GROUPING        TO SS24D.
 10117         MOVE CM-ACCOUNT         TO SS25D.
 10118         MOVE CM-LOAN-NUMBER     TO SS36D.
 10119
 10120     MOVE CM-LOAN-BALANCE        TO SS37D.
 10121     MOVE CM-MEMBER-NO           TO SS38D.
 10122
 10123     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 10124     MOVE SPACES                 TO DC-OPTION-CODE.
 10125     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10126     IF NO-CONVERSION-ERROR
 10127        MOVE DC-GREG-DATE-1-EDIT TO SS27D.
 10128
 10129     MOVE CM-INSURED-FIRST-NAME  TO W-FIRST-NAME.
 10130     MOVE CM-INSURED-LAST-NAME   TO W-LAST-NAME.
 10131     MOVE CM-INSURED-INITIAL2    TO W-MIDDLE-NAME.
 10132     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10133
 10134     IF LOWER-CASE-LETTERS-USED
 10135         MOVE 'N'                TO WS-STATE-LINE
 10136         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10137         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10138         MOVE WS-TEMP-AREA2      TO SS57D
 10139     ELSE
 10140         MOVE WS-NAME-WORK       TO SS57D.
 10141
 10142     MOVE CM-JT-FIRST-NAME       TO W-FIRST-NAME.
 10143     MOVE CM-JT-LAST-NAME        TO W-LAST-NAME.
 10144     MOVE CM-JT-INITIAL          TO W-MIDDLE-NAME.
 10145     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10146
 10147     IF LOWER-CASE-LETTERS-USED
 10148         MOVE 'N'                TO WS-STATE-LINE
 10149         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10150         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10151         MOVE WS-TEMP-AREA2      TO SS58D
 10152     ELSE
 10153         MOVE WS-NAME-WORK       TO SS58D.
 10154
 10155     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10156        MOVE CM-LF-BENEFIT-CD    TO BEN-HOLD
 10157        MOVE CM-LF-ORIG-TERM     TO SS29D
 10158        MOVE CM-LF-BENEFIT-AMT   TO SS30D
 10159        MOVE CM-POLICY-FORM-NO   TO SS32D
 10160        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
 10161     ELSE
 10162        MOVE CM-AH-BENEFIT-CD    TO BEN-HOLD
 10163        MOVE CM-AH-ORIG-TERM     TO SS29D
 10164        MOVE CM-AH-BENEFIT-AMT   TO SS30D
 10165        MOVE CM-POLICY-FORM-NO   TO SS32D
 10166        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 203
* EL152.cbl
 10167
 10168     COMPUTE WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 10169
 10170     MOVE WORK-AMOUNT            TO SS51D.
 10171
 10172     MOVE SPACES                 TO DC-OPTION-CODE.
 10173     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10174     IF NO-CONVERSION-ERROR
 10175        MOVE DC-GREG-DATE-1-EDIT TO SS31D.
 10176
 10177     MOVE ' '                         TO  DC-OPTION-CODE.
 10178     MOVE +0                          TO  DC-ELAPSED-MONTHS
 10179                                          DC-ELAPSED-DAYS.
 10180
 10181     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10182         MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10183         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10184         IF NO-CONVERSION-ERROR
 10185             MOVE DC-GREG-DATE-1-EDIT TO  SS28D
 10186         ELSE
 10187             NEXT SENTENCE
 10188     ELSE
 10189         MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10190         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10191         IF NO-CONVERSION-ERROR
 10192             MOVE DC-GREG-DATE-1-EDIT TO  SS28D.
 10193
 10194*    GO TO 7200-READ-DIAGNOSIS.
 10195
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 204
* EL152.cbl
 10197*7200-READ-EMPLCY. Remove as dead code
 10198 7200-READ-DIAGNOSIS.
 10199
 10200* EXEC CICS HANDLE CONDITION
 10201*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10202*         NOTFND     (7200-READ-LOAN-NUMBER)
 10203*    END-EXEC.
 10204*    MOVE '"$JI                  ! 3 #00009547' TO DFHEIV0
 10205     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10207     MOVE X'3320233030303039353437' TO DFHEIV0(25:11)
 10208     CALL 'kxdfhei1' USING DFHEIV0
 10209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10210
 10211
 10212     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10213     MOVE +90                   TO ACTV-SEQ.
 10214
 10215
 10216* EXEC CICS READ
 10217*         DATASET  (ACTV-ID)
 10218*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10219*         RIDFLD   (ACTV-KEY)
 10220*    END-EXEC.
 10221*    MOVE '&"S        E          (   #00009555' TO DFHEIV0
 10222     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10224     MOVE X'2020233030303039353535' TO DFHEIV0(25:11)
 10225     CALL 'kxdfhei1' USING DFHEIV0,
 10226           ACTV-ID,
 10227           DFHEIV20,
 10228           DFHEIV99,
 10229           ACTV-KEY,
 10230           DFHEIV99,
 10231           DFHEIV99,
 10232           DFHEIV99
 10233     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10234         DFHEIV20
 10235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10236
 10237
 10238     IF AT-TRAILER-TYPE = '6'
 10239        MOVE AT-INFO-LINE-1         TO SS19D.
 10240
 10241 7200-READ-LOAN-NUMBER.
 10242
 10243
 10244* EXEC CICS HANDLE CONDITION
 10245*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10246*         NOTFND     (7201-READ-BENEFICIARY)
 10247*    END-EXEC.
 10248*    MOVE '"$JI                  ! 4 #00009566' TO DFHEIV0
 10249     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10251     MOVE X'3420233030303039353636' TO DFHEIV0(25:11)
 10252     CALL 'kxdfhei1' USING DFHEIV0
 10253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10254
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 205
* EL152.cbl
 10255
 10256     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10257     MOVE +91                   TO ACTV-SEQ.
 10258
 10259
 10260* EXEC CICS READ
 10261*         DATASET  (ACTV-ID)
 10262*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10263*         RIDFLD   (ACTV-KEY)
 10264*    END-EXEC.
 10265*    MOVE '&"S        E          (   #00009574' TO DFHEIV0
 10266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10268     MOVE X'2020233030303039353734' TO DFHEIV0(25:11)
 10269     CALL 'kxdfhei1' USING DFHEIV0,
 10270           ACTV-ID,
 10271           DFHEIV20,
 10272           DFHEIV99,
 10273           ACTV-KEY,
 10274           DFHEIV99,
 10275           DFHEIV99,
 10276           DFHEIV99
 10277     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10278         DFHEIV20
 10279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10280
 10281
 10282     IF AT-TRAILER-TYPE = '6'
 10283        MOVE AT-INFO-LINE-1         TO SS19-2D.
 10284
 10285 7201-READ-BENEFICIARY.
 10286     IF CL-BENIF-ADDR-CNT = +0  AND
 10287        CL-BENEFICIARY = SPACES
 10288          GO TO 7205-READ-PHYSICIAN-ADDR.
 10289
 10290     IF W-BENEFICIARY > ZERO
 10291         COMPUTE ACTV-SEQ = W-BENEFICIARY + 10
 10292     ELSE
 10293         MOVE CL-BENIF-ADDR-CNT  TO ACTV-SEQ
 10294         ADD +10                 TO ACTV-SEQ.
 10295
 10296
 10297* EXEC CICS HANDLE CONDITION
 10298*         NOTOPEN    (7290-BENE-NOT-OPEN)
 10299*         NOTFND     (7205-READ-PHYSICIAN-ADDR)
 10300*    END-EXEC.
 10301*    MOVE '"$JI                  ! 5 #00009594' TO DFHEIV0
 10302     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10304     MOVE X'3520233030303039353934' TO DFHEIV0(25:11)
 10305     CALL 'kxdfhei1' USING DFHEIV0
 10306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10307
 10308
 10309     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10310
 10311     IF ACTV-SEQ = +19
 10312         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 206
* EL152.cbl
 10313     ELSE
 10314         IF ACTV-SEQ NOT = +10
 10315             GO TO 7202-GET-FROM-ACTIVITY.
 10316
 10317     MOVE PI-COMPANY-CD        TO BENE-COMP-CD.
 10318     MOVE 'B'                  TO BENE-REC-TYPE.
 10319     MOVE CL-BENEFICIARY       TO BENE-NUMBER.
 10320
 10321
 10322* EXEC CICS READ
 10323*         DATASET    (BENE-ID)
 10324*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 10325*         RIDFLD     (BENE-KEY)
 10326*    END-EXEC.
 10327*    MOVE '&"S        E          (   #00009611' TO DFHEIV0
 10328     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10329     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10330     MOVE X'2020233030303039363131' TO DFHEIV0(25:11)
 10331     CALL 'kxdfhei1' USING DFHEIV0,
 10332           BENE-ID,
 10333           DFHEIV20,
 10334           DFHEIV99,
 10335           BENE-KEY,
 10336           DFHEIV99,
 10337           DFHEIV99,
 10338           DFHEIV99
 10339     SET ADDRESS OF BENEFICIARY-MASTER TO
 10340         DFHEIV20
 10341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10342
 10343
 10344*    IF PI-COMPANY-ID = 'DMD'
 10345*        MOVE BE-BSR             TO PI-ELBENE-BSR.
 10346
 10347 7201-CONT.
 10348     MOVE BE-MAIL-TO-NAME2       TO WS-LABEL-LINES (1).
 10349     MOVE BE-ADDRESS-LINE-12     TO WS-LABEL-LINES (2).
 10350     MOVE BE-ADDRESS-LINE-22     TO WS-LABEL-LINES (3).
 10351     MOVE BE-ADDRESS-LINE-32     TO WS-LABEL-LINES (4).
 10352*    MOVE BE-CITY-STATE2         TO WS-LABEL-LINES (5).
 10353     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
 10354        INTO WS-LABEL-LINES (5)
 10355     END-STRING
 10356
 10357     MOVE SPACES                 TO WS-ZIP-CODE.
 10358
 10359     IF BE-CANADIAN-POST-CODE2
 10360         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
 10361         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
 10362     ELSE
 10363         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
 10364         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
 10365             MOVE '-'            TO WS-AM-ZIP-DASH
 10366             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
 10367
 10368     MOVE WS-ZIP-CODE            TO WS-LABEL-LINES (6).
 10369
 10370     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 207
* EL152.cbl
 10371
 10372     MOVE WS-LABEL-LINES (1)     TO SS61D.
 10373     MOVE WS-LABEL-LINES (2)     TO SS61-1D.
 10374     MOVE WS-LABEL-LINES (3)     TO SS61-2D.
 10375     MOVE WS-LABEL-LINES (4)     TO SS61-3D.
 10376     MOVE WS-LABEL-LINES (5)     TO SS61-4D.
 10377     MOVE WS-LABEL-LINES (6)     TO SS61-5D.
 10378
 10379     MOVE BE-PHONE-NO2           TO WS-PHONE-IN.
 10380     MOVE WSPI-AREA              TO WSPO-AREA.
 10381     MOVE WSPI-PFX               TO WSPO-PFX.
 10382     MOVE WSPI-SFX               TO WSPO-SFX.
 10383     MOVE WS-PHONE-OUT           TO SS61-6D.
 10384
 10385 7201-CONT-PROCESS.
 10386     MOVE BE-MAIL-TO-NAME      TO  WS-LABEL-LINES (1).
 10387     MOVE BE-ADDRESS-LINE-1    TO  WS-LABEL-LINES (2).
 10388     MOVE BE-ADDRESS-LINE-2    TO  WS-LABEL-LINES (3).
 10389     MOVE BE-ADDRESS-LINE-3    TO  WS-LABEL-LINES (4).
 10390*    MOVE BE-CITY-STATE        TO  WS-LABEL-LINES (5).
 10391     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
 10392        INTO WS-LABEL-LINES (5)
 10393     END-STRING
 10394
 10395     MOVE SPACES               TO  WS-ZIP-CODE.
 10396     IF BE-CANADIAN-POST-CODE
 10397         MOVE BE-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 10398         MOVE BE-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 10399     ELSE
 10400         MOVE BE-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 10401         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10402             MOVE '-'          TO  WS-AM-ZIP-DASH
 10403             MOVE BE-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 10404
 10405     MOVE WS-ZIP-CODE          TO  WS-LABEL-LINES (6).
 10406
 10407     MOVE BE-PHONE-NO          TO  WS-PHONE-IN.
 10408
 10409     GO TO 7204-SET-PHONE.
 10410
 10411 7202-GET-FROM-ACTIVITY.
 10412
 10413* EXEC CICS READ
 10414*         DATASET  (ACTV-ID)
 10415*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10416*         RIDFLD   (ACTV-KEY)
 10417*    END-EXEC.
 10418*    MOVE '&"S        E          (   #00009685' TO DFHEIV0
 10419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10421     MOVE X'2020233030303039363835' TO DFHEIV0(25:11)
 10422     CALL 'kxdfhei1' USING DFHEIV0,
 10423           ACTV-ID,
 10424           DFHEIV20,
 10425           DFHEIV99,
 10426           ACTV-KEY,
 10427           DFHEIV99,
 10428           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 208
* EL152.cbl
 10429           DFHEIV99
 10430     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10431         DFHEIV20
 10432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10433
 10434
 10435     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10436     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10437     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10438*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10439     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10440        INTO WS-LABEL-LINES (4)
 10441     END-STRING
 10442
 10443     MOVE SPACES                 TO  WS-ZIP-CODE.
 10444     IF AT-CANADIAN-POST-CODE
 10445         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10446         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10447     ELSE
 10448         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10449         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10450             MOVE '-'            TO  WS-AM-ZIP-DASH
 10451             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10452
 10453     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10454
 10455     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10456
 10457 7204-SET-PHONE.
 10458     MOVE WSPI-AREA              TO WSPO-AREA.
 10459     MOVE WSPI-PFX               TO WSPO-PFX.
 10460     MOVE WSPI-SFX               TO WSPO-SFX.
 10461     MOVE WS-PHONE-OUT           TO SS44-5D.
 10462
 10463     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10464
 10465     MOVE WS-LABEL-LINES (1)     TO SS43D.
 10466     MOVE WS-LABEL-LINES (2)     TO SS44-1D.
 10467     MOVE WS-LABEL-LINES (3)     TO SS44-2D.
 10468     MOVE WS-LABEL-LINES (4)     TO SS44-3D.
 10469     MOVE WS-LABEL-LINES (5)     TO SS44-4D.
 10470     MOVE WS-LABEL-LINES (6)     TO SS44-6D.
 10471
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 209
* EL152.cbl
 10473 7205-READ-PHYSICIAN-ADDR.
 10474     IF W-PHYSICIAN > ZERO
 10475         COMPUTE ACTV-SEQ = W-PHYSICIAN + 30
 10476     ELSE
 10477         MOVE CL-DOCTOR-ADDR-CNT TO ACTV-SEQ
 10478         ADD +30                 TO ACTV-SEQ.
 10479
 10480     IF ACTV-SEQ = +30
 10481        GO TO 7210-READ-EMPLOYER-ADDR.
 10482
 10483
 10484* EXEC CICS HANDLE CONDITION
 10485*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10486*         NOTFND     (7210-READ-EMPLOYER-ADDR)
 10487*    END-EXEC.
 10488*    MOVE '"$JI                  ! 6 #00009739' TO DFHEIV0
 10489     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10491     MOVE X'3620233030303039373339' TO DFHEIV0(25:11)
 10492     CALL 'kxdfhei1' USING DFHEIV0
 10493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10494
 10495
 10496
 10497* EXEC CICS READ
 10498*         DATASET    (ACTV-ID)
 10499*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10500*         RIDFLD     (ACTV-KEY)
 10501*    END-EXEC.
 10502*    MOVE '&"S        E          (   #00009744' TO DFHEIV0
 10503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10505     MOVE X'2020233030303039373434' TO DFHEIV0(25:11)
 10506     CALL 'kxdfhei1' USING DFHEIV0,
 10507           ACTV-ID,
 10508           DFHEIV20,
 10509           DFHEIV99,
 10510           ACTV-KEY,
 10511           DFHEIV99,
 10512           DFHEIV99,
 10513           DFHEIV99
 10514     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10515         DFHEIV20
 10516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10517
 10518
 10519     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10520     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10521     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10522     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10523*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10524     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10525        INTO WS-LABEL-LINES (4)
 10526     END-STRING
 10527
 10528     MOVE SPACES                 TO  WS-ZIP-CODE.
 10529     IF AT-CANADIAN-POST-CODE
 10530         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 210
* EL152.cbl
 10531         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10532     ELSE
 10533         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10534         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10535             MOVE '-'            TO  WS-AM-ZIP-DASH
 10536             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10537
 10538     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10539
 10540     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10541     MOVE WSPI-AREA              TO WSPO-AREA.
 10542     MOVE WSPI-PFX               TO WSPO-PFX.
 10543     MOVE WSPI-SFX               TO WSPO-SFX.
 10544     MOVE WS-PHONE-OUT           TO SS47-5D.
 10545
 10546     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10547
 10548     MOVE WS-LABEL-LINES (1)     TO SS47D.
 10549     MOVE WS-LABEL-LINES (2)     TO SS47-1D.
 10550     MOVE WS-LABEL-LINES (3)     TO SS47-2D.
 10551     MOVE WS-LABEL-LINES (4)     TO SS47-3D.
 10552     MOVE WS-LABEL-LINES (5)     TO SS47-4D.
 10553
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 211
* EL152.cbl
 10555
 10556 7210-READ-EMPLOYER-ADDR.
 10557     IF W-EMPLOYER > ZERO
 10558         COMPUTE ACTV-SEQ = W-EMPLOYER + 40
 10559     ELSE
 10560         MOVE CL-EMPLOYER-ADDR-CNT
 10561                                 TO ACTV-SEQ
 10562         ADD +40                 TO ACTV-SEQ.
 10563
 10564     IF ACTV-SEQ = +40
 10565        GO TO 7220-READ-INSURED-ADDR.
 10566
 10567
 10568* EXEC CICS HANDLE CONDITION
 10569*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10570*         NOTFND     (7220-READ-INSURED-ADDR)
 10571*    END-EXEC.
 10572*    MOVE '"$JI                  ! 7 #00009798' TO DFHEIV0
 10573     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10575     MOVE X'3720233030303039373938' TO DFHEIV0(25:11)
 10576     CALL 'kxdfhei1' USING DFHEIV0
 10577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10578
 10579
 10580
 10581* EXEC CICS READ
 10582*         DATASET    (ACTV-ID)
 10583*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10584*         RIDFLD     (ACTV-KEY)
 10585*    END-EXEC.
 10586*    MOVE '&"S        E          (   #00009803' TO DFHEIV0
 10587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10589     MOVE X'2020233030303039383033' TO DFHEIV0(25:11)
 10590     CALL 'kxdfhei1' USING DFHEIV0,
 10591           ACTV-ID,
 10592           DFHEIV20,
 10593           DFHEIV99,
 10594           ACTV-KEY,
 10595           DFHEIV99,
 10596           DFHEIV99,
 10597           DFHEIV99
 10598     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10599         DFHEIV20
 10600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10601
 10602
 10603     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10604     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10605     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10606     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10607*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10608     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10609        INTO WS-LABEL-LINES (4)
 10610     END-STRING
 10611
 10612     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 212
* EL152.cbl
 10613     IF AT-CANADIAN-POST-CODE
 10614         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10615         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10616     ELSE
 10617         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10618         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10619             MOVE '-'            TO  WS-AM-ZIP-DASH
 10620             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10621
 10622     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10623
 10624     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10625     MOVE WSPI-AREA              TO WSPO-AREA.
 10626     MOVE WSPI-PFX               TO WSPO-PFX.
 10627     MOVE WSPI-SFX               TO WSPO-SFX.
 10628     MOVE WS-PHONE-OUT           TO SS48-5D.
 10629
 10630     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10631
 10632     MOVE WS-LABEL-LINES (1)     TO SS48D.
 10633     MOVE WS-LABEL-LINES (2)     TO SS48-1D.
 10634     MOVE WS-LABEL-LINES (3)     TO SS48-2D.
 10635     MOVE WS-LABEL-LINES (4)     TO SS48-3D.
 10636     MOVE WS-LABEL-LINES (5)     TO SS48-4D.
 10637
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 213
* EL152.cbl
 10639 7220-READ-INSURED-ADDR.
 10640
 10641     IF W-INSURED > ZERO
 10642         COMPUTE ACTV-SEQ = W-INSURED
 10643     ELSE
 10644         MOVE CL-INSURED-ADDR-CNT TO ACTV-SEQ.
 10645
 10646     IF ACTV-SEQ = +0
 10647        GO TO 7225-READ-OTHER1-ADDR.
 10648
 10649
 10650* EXEC CICS HANDLE CONDITION
 10651*         NOTOPEN   (8870-ACTV-NOT-OPEN)
 10652*         NOTFND    (7225-READ-OTHER1-ADDR)
 10653*    END-EXEC.
 10654*    MOVE '"$JI                  ! 8 #00009855' TO DFHEIV0
 10655     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10657     MOVE X'3820233030303039383535' TO DFHEIV0(25:11)
 10658     CALL 'kxdfhei1' USING DFHEIV0
 10659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10660
 10661
 10662
 10663* EXEC CICS READ
 10664*         DATASET   (ACTV-ID)
 10665*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10666*         RIDFLD    (ACTV-KEY)
 10667*    END-EXEC.
 10668*    MOVE '&"S        E          (   #00009860' TO DFHEIV0
 10669     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10671     MOVE X'2020233030303039383630' TO DFHEIV0(25:11)
 10672     CALL 'kxdfhei1' USING DFHEIV0,
 10673           ACTV-ID,
 10674           DFHEIV20,
 10675           DFHEIV99,
 10676           ACTV-KEY,
 10677           DFHEIV99,
 10678           DFHEIV99,
 10679           DFHEIV99
 10680     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10681         DFHEIV20
 10682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10683
 10684
 10685     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10686     MOVE SS10D                  TO WS-LABEL-LINES (1).
 10687     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10688     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10689*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10690     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10691        INTO WS-LABEL-LINES (4)
 10692     END-STRING
 10693
 10694     MOVE SPACES                 TO  WS-ZIP-CODE.
 10695     IF AT-CANADIAN-POST-CODE
 10696         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 214
* EL152.cbl
 10697         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10698     ELSE
 10699         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10700         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10701             MOVE '-'            TO  WS-AM-ZIP-DASH
 10702             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10703
 10704     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10705
 10706     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10707
 10708     MOVE WS-LABEL-LINES (1)     TO SS10D.
 10709     MOVE WS-LABEL-LINES (2)     TO SS11-1D.
 10710     MOVE WS-LABEL-LINES (3)     TO SS11-2D.
 10711     MOVE WS-LABEL-LINES (4)     TO SS11-3D.
 10712     MOVE WS-LABEL-LINES (5)     TO SS11-4D.
 10713     MOVE AT-MAIL-TO-NAME        TO SS11-5D.
 10714
 10715     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10716     MOVE WSPI-AREA              TO WSPO-AREA.
 10717     MOVE WSPI-PFX               TO WSPO-PFX.
 10718     MOVE WSPI-SFX               TO WSPO-SFX.
 10719     MOVE WS-PHONE-OUT           TO SS11-6D.
 10720
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 215
* EL152.cbl
 10722
 10723 7225-READ-OTHER1-ADDR.
 10724
 10725     IF W-OTHER-1 > ZERO
 10726         COMPUTE ACTV-SEQ = W-OTHER-1 + 50
 10727     ELSE
 10728         MOVE CL-OTHER-1-ADDR-CNT TO ACTV-SEQ
 10729         ADD +50                  TO ACTV-SEQ.
 10730
 10731     IF ACTV-SEQ = +50
 10732        GO TO 7230-READ-OTHER2-ADDR.
 10733
 10734
 10735* EXEC CICS HANDLE CONDITION
 10736*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10737*         NOTFND     (7230-READ-OTHER2-ADDR)
 10738*    END-EXEC.
 10739*    MOVE '"$JI                  ! 9 #00009915' TO DFHEIV0
 10740     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10742     MOVE X'3920233030303039393135' TO DFHEIV0(25:11)
 10743     CALL 'kxdfhei1' USING DFHEIV0
 10744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10745
 10746
 10747
 10748* EXEC CICS READ
 10749*         DATASET    (ACTV-ID)
 10750*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10751*         RIDFLD     (ACTV-KEY)
 10752*    END-EXEC.
 10753*    MOVE '&"S        E          (   #00009920' TO DFHEIV0
 10754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10756     MOVE X'2020233030303039393230' TO DFHEIV0(25:11)
 10757     CALL 'kxdfhei1' USING DFHEIV0,
 10758           ACTV-ID,
 10759           DFHEIV20,
 10760           DFHEIV99,
 10761           ACTV-KEY,
 10762           DFHEIV99,
 10763           DFHEIV99,
 10764           DFHEIV99
 10765     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10766         DFHEIV20
 10767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10768
 10769
 10770     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10771     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10772     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10773     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10774*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10775     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10776        INTO WS-LABEL-LINES (4)
 10777     END-STRING
 10778
 10779     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 216
* EL152.cbl
 10780     IF AT-CANADIAN-POST-CODE
 10781         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10782         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10783     ELSE
 10784         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10785         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10786             MOVE '-'            TO  WS-AM-ZIP-DASH
 10787             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10788
 10789     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10790
 10791     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10792     MOVE WSPI-AREA              TO WSPO-AREA.
 10793     MOVE WSPI-PFX               TO WSPO-PFX.
 10794     MOVE WSPI-SFX               TO WSPO-SFX.
 10795     MOVE WS-PHONE-OUT           TO SS49-5D.
 10796
 10797     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10798
 10799     MOVE WS-LABEL-LINES (1)     TO SS49D.
 10800     MOVE WS-LABEL-LINES (2)     TO SS49-1D.
 10801     MOVE WS-LABEL-LINES (3)     TO SS49-2D.
 10802     MOVE WS-LABEL-LINES (4)     TO SS49-3D.
 10803     MOVE WS-LABEL-LINES (5)     TO SS49-4D.
 10804
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 217
* EL152.cbl
 10806 7230-READ-OTHER2-ADDR.
 10807
 10808     IF W-OTHER-2 > ZERO
 10809         COMPUTE ACTV-SEQ = W-OTHER-2 + 60
 10810     ELSE
 10811         MOVE CL-OTHER-2-ADDR-CNT TO ACTV-SEQ
 10812         ADD +60                  TO ACTV-SEQ.
 10813
 10814     IF ACTV-SEQ = +60
 10815        GO TO 7240-NOT-FOUND.
 10816
 10817
 10818* EXEC CICS HANDLE CONDITION
 10819*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10820*         NOTFND     (7240-NOT-FOUND)
 10821*    END-EXEC.
 10822*    MOVE '"$JI                  ! : #00009973' TO DFHEIV0
 10823     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10825     MOVE X'3A20233030303039393733' TO DFHEIV0(25:11)
 10826     CALL 'kxdfhei1' USING DFHEIV0
 10827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10828
 10829
 10830
 10831* EXEC CICS READ
 10832*         DATASET    (ACTV-ID)
 10833*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10834*         RIDFLD     (ACTV-KEY)
 10835*    END-EXEC.
 10836*    MOVE '&"S        E          (   #00009978' TO DFHEIV0
 10837     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10839     MOVE X'2020233030303039393738' TO DFHEIV0(25:11)
 10840     CALL 'kxdfhei1' USING DFHEIV0,
 10841           ACTV-ID,
 10842           DFHEIV20,
 10843           DFHEIV99,
 10844           ACTV-KEY,
 10845           DFHEIV99,
 10846           DFHEIV99,
 10847           DFHEIV99
 10848     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10849         DFHEIV20
 10850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10851
 10852
 10853     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10854     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10855     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10856     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10857*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10858     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10859        INTO WS-LABEL-LINES (4)
 10860     END-STRING
 10861
 10862     MOVE SPACES                 TO  WS-ZIP-CODE.
 10863     IF AT-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 218
* EL152.cbl
 10864         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10865         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10866     ELSE
 10867         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10868         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10869             MOVE '-'            TO  WS-AM-ZIP-DASH
 10870             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10871
 10872     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10873
 10874     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10875     MOVE WSPI-AREA              TO WSPO-AREA.
 10876     MOVE WSPI-PFX               TO WSPO-PFX.
 10877     MOVE WSPI-SFX               TO WSPO-SFX.
 10878     MOVE WS-PHONE-OUT           TO SS50-5D.
 10879
 10880     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10881
 10882     MOVE WS-LABEL-LINES (1)     TO SS50D.
 10883     MOVE WS-LABEL-LINES (2)     TO SS50-1D.
 10884     MOVE WS-LABEL-LINES (3)     TO SS50-2D.
 10885     MOVE WS-LABEL-LINES (4)     TO SS50-3D.
 10886     MOVE WS-LABEL-LINES (5)     TO SS50-4D.
 10887
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 219
* EL152.cbl
 10889 7240-NOT-FOUND.
 10890     IF ACCOUNT-IS-ONLINE
 10891        GO TO 7250-READ-ACCOUNT.
 10892
 10893     IF W-ACCOUNT > ZERO
 10894         COMPUTE ACTV-SEQ = W-ACCOUNT + 20
 10895     ELSE
 10896         MOVE CL-ACCOUNT-ADDR-CNT TO ACTV-SEQ
 10897         ADD +20                  TO ACTV-SEQ.
 10898
 10899     IF ACTV-SEQ = +20
 10900        GO TO 7250-READ-ACCOUNT.
 10901
 10902
 10903* EXEC CICS HANDLE CONDITION
 10904*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10905*         NOTFND     (7250-READ-ACCOUNT)
 10906*    END-EXEC.
 10907*    MOVE '"$JI                  ! ; #00010033' TO DFHEIV0
 10908     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10910     MOVE X'3B20233030303130303333' TO DFHEIV0(25:11)
 10911     CALL 'kxdfhei1' USING DFHEIV0
 10912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10913
 10914
 10915
 10916* EXEC CICS READ
 10917*         DATASET    (ACTV-ID)
 10918*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10919*         RIDFLD     (ACTV-KEY)
 10920*    END-EXEC.
 10921*    MOVE '&"S        E          (   #00010038' TO DFHEIV0
 10922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10924     MOVE X'2020233030303130303338' TO DFHEIV0(25:11)
 10925     CALL 'kxdfhei1' USING DFHEIV0,
 10926           ACTV-ID,
 10927           DFHEIV20,
 10928           DFHEIV99,
 10929           ACTV-KEY,
 10930           DFHEIV99,
 10931           DFHEIV99,
 10932           DFHEIV99
 10933     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10934         DFHEIV20
 10935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10936
 10937
 10938     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10939     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10940     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10941     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10942*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10943     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10944        INTO WS-LABEL-LINES (4)
 10945     END-STRING
 10946
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 220
* EL152.cbl
 10947     MOVE SPACES                 TO  WS-ZIP-CODE.
 10948     IF AT-CANADIAN-POST-CODE
 10949         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10950         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10951     ELSE
 10952         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10953         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10954             MOVE '-'            TO  WS-AM-ZIP-DASH
 10955             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10956
 10957     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10958
 10959     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10960     MOVE WSPI-AREA              TO WSPO-AREA.
 10961     MOVE WSPI-PFX               TO WSPO-PFX.
 10962     MOVE WSPI-SFX               TO WSPO-SFX.
 10963     MOVE WS-PHONE-OUT           TO SS07-6D.
 10964
 10965*    IF PI-COMPANY-ID NOT = 'FLA'
 10966*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10967
 10968     MOVE WS-LABEL-LINES (1)     TO SS06D.
 10969     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 10970     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 10971     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 10972     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 10973     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 10974
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 221
* EL152.cbl
 10976 7250-READ-ACCOUNT.
 10977*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10978*        GO TO 7250-READ-PRODUCER.
 10979
 10980     IF WS-ACCT-READ-SW = 'Y'
 10981        GO TO 7250-BUILD-ACCT-ADDR.
 10982
 10983     MOVE CM-CERT-EFF-DT TO ACCT-EXP-DATE.
 10984
 10985
 10986* EXEC CICS HANDLE CONDITION
 10987*         NOTOPEN   (8880-ACCT-NOT-OPEN)
 10988*         NOTFND    (7251-READ-3RD-PARTY)
 10989*    END-EXEC.
 10990*    MOVE '"$JI                  ! < #00010091' TO DFHEIV0
 10991     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10993     MOVE X'3C20233030303130303931' TO DFHEIV0(25:11)
 10994     CALL 'kxdfhei1' USING DFHEIV0
 10995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10996
 10997
 10998 7250-STARTBR-ACCOUNT.
 10999     MOVE ACCT-PARTIAL-KEY       TO  ACCT-SAVE-KEY.
 11000     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
 11001
 11002 7250-READNEXT-ACCOUNT.
 11003     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
 11004
 11005     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
 11006         IF WS-SAVE-ACCT-RECORD = SPACES
 11007             GO TO 7251-READ-3RD-PARTY
 11008         ELSE
 11009             MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
 11010             MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
 11011             GO TO 7250-BUILD-ACCT-ADDR.
 11012
 11013     IF AM-EXPIRATION-DT = HIGH-VALUES
 11014         MOVE AM-CONTROL-PRIMARY      TO  ACCT-KEY
 11015     ELSE
 11016         MOVE ACCOUNT-MASTER          TO  WS-SAVE-ACCT-RECORD
 11017         GO TO 7250-READNEXT-ACCOUNT.
 11018
 11019 7250-BUILD-ACCT-ADDR.
 11020     MOVE SPACES                TO  WS-SAVE-ACCT-RECORD.
 11021
 11022     IF NOT ACCOUNT-IS-ONLINE
 11023        GO TO 7251-READ-3RD-PARTY.
 11024
 11025     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11026     MOVE AM-NAME               TO WS-LABEL-LINES (1).
 11027     MOVE AM-PERSON             TO WS-LABEL-LINES (2).
 11028     MOVE AM-ADDRS              TO WS-LABEL-LINES (3).
 11029*    MOVE AM-CITY               TO WS-LABEL-LINES (4).
 11030     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
 11031        INTO WS-LABEL-LINES (4)
 11032     END-STRING
 11033
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 222
* EL152.cbl
 11034     MOVE SPACES                TO  WS-ZIP-CODE.
 11035     IF AM-CANADIAN-POST-CODE
 11036         MOVE AM-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11037         MOVE AM-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11038     ELSE
 11039         MOVE AM-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11040         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11041             MOVE '-'           TO  WS-AM-ZIP-DASH
 11042             MOVE AM-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11043
 11044     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11045
 11046     MOVE ZEROS                 TO WS-PHONE-IN.
 11047     MOVE AM-AREA-CODE          TO WSPO-AREA.
 11048     MOVE AM-TEL-PRE            TO WSPO-PFX.
 11049     MOVE AM-TEL-NBR            TO WSPO-SFX.
 11050     MOVE WS-PHONE-OUT          TO SS07-6D.
 11051
 11052*    IF PI-COMPANY-ID NOT = 'FLA'
 11053*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11054
 11055     MOVE WS-LABEL-LINES (1)     TO SS06D.
 11056     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 11057     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 11058     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 11059     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 11060     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 11061
 11062*    GO TO 7251-READ-3RD-PARTY.
 11063
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 223
* EL152.cbl
 11065*7250-READ-PRODUCER. Remove as dead code
 11066*7250-STARTBR-PRODUCER. Remove as dead code
 11067*7250-READNEXT-PRODUCER. Remove as dead code
 11068*7250-BUILD-PROD-ADDR. Remove as dead code
 11069 7251-READ-3RD-PARTY.
 11070
 11071     MOVE +29                    TO ACTV-SEQ.
 11072
 11073
 11074* EXEC CICS HANDLE CONDITION
 11075*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11076*         NOTFND     (7252-READ-COMP)
 11077*    END-EXEC.
 11078*    MOVE '"$JI                  ! = #00010171' TO DFHEIV0
 11079     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11081     MOVE X'3D20233030303130313731' TO DFHEIV0(25:11)
 11082     CALL 'kxdfhei1' USING DFHEIV0
 11083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11084
 11085
 11086
 11087* EXEC CICS READ
 11088*         DATASET    (ACTV-ID)
 11089*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11090*         RIDFLD     (ACTV-KEY)
 11091*    END-EXEC.
 11092*    MOVE '&"S        E          (   #00010176' TO DFHEIV0
 11093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11095     MOVE X'2020233030303130313736' TO DFHEIV0(25:11)
 11096     CALL 'kxdfhei1' USING DFHEIV0,
 11097           ACTV-ID,
 11098           DFHEIV20,
 11099           DFHEIV99,
 11100           ACTV-KEY,
 11101           DFHEIV99,
 11102           DFHEIV99,
 11103           DFHEIV99
 11104     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11105         DFHEIV20
 11106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11107
 11108
 11109     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11110     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 11111     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 11112     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 11113*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 11114     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 11115        INTO WS-LABEL-LINES (4)
 11116     END-STRING
 11117
 11118     MOVE SPACES                 TO  WS-ZIP-CODE.
 11119     IF AT-CANADIAN-POST-CODE
 11120         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 11121         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 11122     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 224
* EL152.cbl
 11123         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11124         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11125             MOVE '-'            TO  WS-AM-ZIP-DASH
 11126             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11127
 11128     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11129
 11130     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11131     MOVE WSPI-AREA              TO WSPO-AREA.
 11132     MOVE WSPI-PFX               TO WSPO-PFX.
 11133     MOVE WSPI-SFX               TO WSPO-SFX.
 11134     MOVE WS-PHONE-OUT           TO SS53-6D.
 11135
 11136     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11137
 11138     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11139     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11140     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11141     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11142     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11143     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11144
 11145     GO TO 7260-READ-DENIAL.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 225
* EL152.cbl
 11147 7252-READ-COMP.
 11148
 11149     IF WS-COMP-READ-SW = 'Y'
 11150        GO TO 7255-BUILD-COMP-ADDR.
 11151
 11152     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 11153        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
 11154        GO TO 7260-READ-DENIAL.
 11155
 11156     IF AM-3RD-PARTY-NOTIF-LEVEL > 00 AND < 11
 11157        NEXT SENTENCE
 11158     ELSE
 11159        GO TO 7260-READ-DENIAL.
 11160
 11161     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
 11162        GO TO 7260-READ-DENIAL.
 11163
 11164     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD.
 11165     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER.
 11166     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING.
 11167     MOVE 'A'             TO WS-ERCOMP-TYPE.
 11168     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11169                          TO WS-ERCOMP-RESP-NO.
 11170
 11171     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 11172         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 11173                                       'G' OR 'B'
 11174             MOVE 'G'            TO WS-ERCOMP-TYPE
 11175             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
 11176         ELSE
 11177             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11178                                 TO WS-ERCOMP-ACCOUNT
 11179     ELSE
 11180         MOVE 'G'                TO WS-ERCOMP-TYPE
 11181         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
 11182
 11183     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
 11184        MOVE ZEROS TO WS-ERCOMP-CARRIER.
 11185
 11186     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
 11187        MOVE ZEROS TO WS-ERCOMP-GROUPING.
 11188
 11189
 11190* EXEC CICS HANDLE CONDITION
 11191*         NOTFND    (7260-READ-DENIAL)
 11192*    END-EXEC.
 11193*    MOVE '"$I                   ! > #00010262' TO DFHEIV0
 11194     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11196     MOVE X'3E20233030303130323632' TO DFHEIV0(25:11)
 11197     CALL 'kxdfhei1' USING DFHEIV0
 11198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11199
 11200
 11201
 11202* EXEC CICS  READ
 11203*         SET      (ADDRESS OF COMPENSATION-MASTER)
 11204*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 226
* EL152.cbl
 11205*         RIDFLD   (WS-ERCOMP-KEY)
 11206*    END-EXEC.
 11207     MOVE 'ERCOMP' TO DFHEIV1
 11208*    MOVE '&"S        E          (   #00010266' TO DFHEIV0
 11209     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11211     MOVE X'2020233030303130323636' TO DFHEIV0(25:11)
 11212     CALL 'kxdfhei1' USING DFHEIV0,
 11213           DFHEIV1,
 11214           DFHEIV20,
 11215           DFHEIV99,
 11216           WS-ERCOMP-KEY,
 11217           DFHEIV99,
 11218           DFHEIV99,
 11219           DFHEIV99
 11220     SET ADDRESS OF COMPENSATION-MASTER TO
 11221         DFHEIV20
 11222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11223
 11224
 11225 7255-BUILD-COMP-ADDR.
 11226
 11227     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11228     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
 11229     IF CO-ACCT-NAME = SPACES
 11230        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
 11231     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
 11232     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
 11233     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
 11234
 11235     MOVE SPACES                TO  WS-ZIP-CODE.
 11236     IF CO-CANADIAN-POST-CODE
 11237         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11238         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11239     ELSE
 11240         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11241         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11242             MOVE '-'           TO  WS-AM-ZIP-DASH
 11243             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11244
 11245     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11246
 11247     MOVE ZEROS                 TO WS-PHONE-IN.
 11248     MOVE CO-AREA-CODE          TO WSPO-AREA.
 11249     MOVE CO-PREFIX             TO WSPO-PFX.
 11250     MOVE CO-PHONE              TO WSPO-SFX.
 11251     MOVE WS-PHONE-OUT          TO SS53-6D.
 11252
 11253     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11254
 11255     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11256     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11257     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11258     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11259     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11260     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11261
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 227
* EL152.cbl
 11263
 11264 7260-READ-DENIAL.
 11265
 11266     MOVE +93                    TO ACTV-SEQ
 11267
 11268
 11269* EXEC CICS HANDLE CONDITION
 11270*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11271*         NOTFND     (7265-READ-CNTL1)
 11272*         ENDFILE    (7265-READ-CNTL1)
 11273*    END-EXEC.
 11274*    MOVE '"$JI''                 ! ? #00010315' TO DFHEIV0
 11275     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 11276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11277     MOVE X'3F20233030303130333135' TO DFHEIV0(25:11)
 11278     CALL 'kxdfhei1' USING DFHEIV0
 11279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11280
 11281
 11282
 11283* EXEC CICS STARTBR
 11284*         DATASET    (ACTV-ID)
 11285*         RIDFLD     (ACTV-KEY)
 11286*         GTEQ
 11287*    END-EXEC.
 11288     MOVE 0
 11289       TO DFHEIV11
 11290*    MOVE '&,         G          &   #00010321' TO DFHEIV0
 11291     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11292     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11293     MOVE X'2020233030303130333231' TO DFHEIV0(25:11)
 11294     CALL 'kxdfhei1' USING DFHEIV0,
 11295           ACTV-ID,
 11296           ACTV-KEY,
 11297           DFHEIV99,
 11298           DFHEIV11,
 11299           DFHEIV99
 11300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11301
 11302
 11303     MOVE 'Y'                    TO ACTV-BROWSE-STARTED.
 11304     MOVE ACTV-PARTIAL-KEY       TO ACTV-SAVE-KEY.
 11305
 11306 7262-READ-NEXT.
 11307
 11308
 11309* EXEC CICS READNEXT
 11310*         SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11311*         RIDFLD  (ACTV-KEY)
 11312*         DATASET (ACTV-ID)
 11313*    END-EXEC.
 11314     MOVE 0
 11315       TO DFHEIV11
 11316*    MOVE '&.S                   )   #00010332' TO DFHEIV0
 11317     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11318     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11319     MOVE X'2020233030303130333332' TO DFHEIV0(25:11)
 11320     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 228
* EL152.cbl
 11321           ACTV-ID,
 11322           DFHEIV20,
 11323           DFHEIV99,
 11324           ACTV-KEY,
 11325           DFHEIV99,
 11326           DFHEIV11,
 11327           DFHEIV99,
 11328           DFHEIV99
 11329     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11330         DFHEIV20
 11331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11332
 11333
 11334     IF ACTV-PARTIAL-KEY  NOT = ACTV-SAVE-KEY
 11335        GO TO 7265-READ-CNTL1.
 11336     IF AT-TRAILER-TYPE = '2'
 11337        AND AT-PAYMENT-TYPE = 'I'
 11338        AND AT-INT-RATE NUMERIC
 11339        AND AT-INT-RATE NOT = ZEROS
 11340        COMPUTE WS-WORK-INT-RATE = AT-INT-RATE * 100
 11341        MOVE +1                  TO S2
 11342        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
 11343           (S1 > +6)
 11344           IF WS-WORK-INT (S1:1) NOT = '0'
 11345              MOVE WS-WORK-INT (S1:1)
 11346                                 TO SS16-1D (S2:1)
 11347              ADD +1             TO S2
 11348           END-IF
 11349        END-PERFORM
 11350        MOVE '%'                 TO SS16-1D (S2:1)
 11351        GO TO 7262-READ-NEXT
 11352     END-IF
 11353     IF AT-TRAILER-TYPE = '8'
 11354        MOVE AT-DENIAL-INFO-1    TO SS35-1D
 11355        MOVE AT-DENIAL-INFO-2    TO SS35-2D
 11356        IF (CL-TOTAL-INT-PAID = ZEROS)
 11357           OR (CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1)
 11358           GO TO 7265-READ-CNTL1
 11359        END-IF
 11360     END-IF
 11361     GO TO 7262-READ-NEXT
 11362     .
 11363 7265-READ-CNTL1.
 11364     IF ACTV-BROWSE-STARTED = 'Y'
 11365        MOVE 'N'                  TO ACTV-BROWSE-STARTED
 11366
 11367* EXEC CICS ENDBR
 11368*            DATASET    (ACTV-ID)
 11369*       END-EXEC.
 11370     MOVE 0
 11371       TO DFHEIV11
 11372*    MOVE '&2                    $   #00010370' TO DFHEIV0
 11373     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11375     MOVE X'2020233030303130333730' TO DFHEIV0(25:11)
 11376     CALL 'kxdfhei1' USING DFHEIV0,
 11377           ACTV-ID,
 11378           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 229
* EL152.cbl
 11379           DFHEIV99
 11380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11381
 11382
 11383     IF SS35-1D = ALL '*'
 11384         MOVE '@@DENIAL1'        TO SS35-1D.
 11385
 11386     IF SS35-2D = ALL '*'
 11387         MOVE '@@DENIAL2'        TO SS35-2D.
 11388
 11389     MOVE '1'                    TO CNTL-RECORD-TYPE.
 11390     MOVE ZEROS                  TO CNTL-SEQ.
 11391
 11392* EXEC CICS HANDLE CONDITION
 11393*         NOTOPEN   (8840-CNTL-NOT-OPEN)
 11394*         NOTFND    (7266-READ-CNTL2)
 11395*    END-EXEC.
 11396*    MOVE '"$JI                  ! @ #00010382' TO DFHEIV0
 11397     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11399     MOVE X'4020233030303130333832' TO DFHEIV0(25:11)
 11400     CALL 'kxdfhei1' USING DFHEIV0
 11401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11402
 11403
 11404
 11405* EXEC CICS READ
 11406*         DATASET   (CNTL-ID)
 11407*         SET       (ADDRESS OF CONTROL-FILE)
 11408*         RIDFLD    (CNTL-KEY)
 11409*    END-EXEC.
 11410*    MOVE '&"S        E          (   #00010387' TO DFHEIV0
 11411     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11412     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11413     MOVE X'2020233030303130333837' TO DFHEIV0(25:11)
 11414     CALL 'kxdfhei1' USING DFHEIV0,
 11415           CNTL-ID,
 11416           DFHEIV20,
 11417           DFHEIV99,
 11418           CNTL-KEY,
 11419           DFHEIV99,
 11420           DFHEIV99,
 11421           DFHEIV99
 11422     SET ADDRESS OF CONTROL-FILE TO
 11423         DFHEIV20
 11424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11425
 11426
 11427     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11428     MOVE CF-CL-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11429     MOVE CF-CL-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11430     MOVE CF-CL-ADDR-LINE-1      TO WS-LABEL-LINES (3).
 11431     MOVE CF-CL-ADDR-LINE-2      TO WS-LABEL-LINES (4).
 11432     MOVE CF-CL-CITY-STATE       TO WS-LABEL-LINES (5).
 11433
 11434     IF CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11435         MOVE ZEROS              TO  CF-CL-ZIP-CODE-NUM.
 11436     IF CF-CL-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 230
* EL152.cbl
 11437         MOVE CF-CL-ZIP-CODE-NUM TO  WS-ZIP-NUMERIC
 11438         MOVE WS-ZIP-NONNUM      TO  CF-CL-ZIP-CODE.
 11439
 11440     MOVE SPACES                 TO  WS-ZIP-CODE.
 11441     IF CF-CL-CAN-POST-CODE
 11442         MOVE CF-CL-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11443         MOVE CF-CL-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11444     ELSE
 11445         MOVE CF-CL-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11446         IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11447             MOVE '-'              TO  WS-AM-ZIP-DASH
 11448             MOVE CF-CL-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11449
 11450     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (6).
 11451
 11452     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11453
 11454     MOVE WS-LABEL-LINES (1)     TO SS01D.
 11455     MOVE WS-LABEL-LINES (2)     TO SS02-1D.
 11456     MOVE WS-LABEL-LINES (3)     TO SS02-2D.
 11457     MOVE WS-LABEL-LINES (4)     TO SS02-3D.
 11458     MOVE WS-LABEL-LINES (5)     TO SS02-4D.
 11459     MOVE WS-LABEL-LINES (6)     TO SS02-5D.
 11460
 11461 7266-READ-CNTL2.
 11462     IF PI-PROCESSOR-ID  =  LGXX-ID
 11463        GO TO 7267-READ-CNTL4.
 11464
 11465     MOVE '2'                    TO CNTL-RECORD-TYPE.
 11466     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
 11467     MOVE ZEROS                  TO CNTL-SEQ.
 11468
 11469
 11470* EXEC CICS HANDLE CONDITION
 11471*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11472*         NOTFND     (7267-READ-CNTL4)
 11473*    END-EXEC.
 11474*    MOVE '"$JI                  ! A #00010435' TO DFHEIV0
 11475     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11477     MOVE X'4120233030303130343335' TO DFHEIV0(25:11)
 11478     CALL 'kxdfhei1' USING DFHEIV0
 11479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11480
 11481
 11482
 11483* EXEC CICS READ
 11484*         DATASET    (CNTL-ID)
 11485*         SET        (ADDRESS OF CONTROL-FILE)
 11486*         RIDFLD     (CNTL-KEY)
 11487*    END-EXEC.
 11488*    MOVE '&"S        E          (   #00010440' TO DFHEIV0
 11489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11491     MOVE X'2020233030303130343430' TO DFHEIV0(25:11)
 11492     CALL 'kxdfhei1' USING DFHEIV0,
 11493           CNTL-ID,
 11494           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 231
* EL152.cbl
 11495           DFHEIV99,
 11496           CNTL-KEY,
 11497           DFHEIV99,
 11498           DFHEIV99,
 11499           DFHEIV99
 11500     SET ADDRESS OF CONTROL-FILE TO
 11501         DFHEIV20
 11502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11503
 11504
 11505     MOVE CF-PROCESSOR-NAME      TO SS08D.
 11506     MOVE CF-PROCESSOR-TITLE     TO SS09D.
 11507
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 232
* EL152.cbl
 11509 7267-READ-CNTL4.
 11510*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11511*        GO TO 7267-READ-EMPLAN.
 11512
 11513     IF BEN-HOLD = ZEROS
 11514        GO TO 7267-READ-CNTL6.
 11515
 11516     MOVE BEN-HOLD               TO CNTL-GEN2.
 11517     MOVE SPACES                 TO CNTL-GEN1.
 11518
 11519     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11520        MOVE '4'                 TO CNTL-RECORD-TYPE
 11521     ELSE
 11522        MOVE '5'                 TO CNTL-RECORD-TYPE.
 11523
 11524     MOVE ZEROS                  TO CNTL-SEQ.
 11525
 11526
 11527* EXEC CICS HANDLE CONDITION
 11528*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11529*         NOTFND     (7267-READ-CNTL6)
 11530*    END-EXEC.
 11531*    MOVE '"$JI                  ! B #00010467' TO DFHEIV0
 11532     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11534     MOVE X'4220233030303130343637' TO DFHEIV0(25:11)
 11535     CALL 'kxdfhei1' USING DFHEIV0
 11536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11537
 11538
 11539
 11540* EXEC CICS READ
 11541*         DATASET    (CNTL-ID)
 11542*         SET        (ADDRESS OF CONTROL-FILE)
 11543*         RIDFLD     (CNTL-KEY)
 11544*         GTEQ
 11545*    END-EXEC.
 11546*    MOVE '&"S        G          (   #00010472' TO DFHEIV0
 11547     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11549     MOVE X'2020233030303130343732' TO DFHEIV0(25:11)
 11550     CALL 'kxdfhei1' USING DFHEIV0,
 11551           CNTL-ID,
 11552           DFHEIV20,
 11553           DFHEIV99,
 11554           CNTL-KEY,
 11555           DFHEIV99,
 11556           DFHEIV99,
 11557           DFHEIV99
 11558     SET ADDRESS OF CONTROL-FILE TO
 11559         DFHEIV20
 11560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11561
 11562
 11563     MOVE 1                      TO SUB.
 11564 7267-LOOP.
 11565     IF SUB = 9
 11566        GO TO 7267-READ-CNTL6.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 233
* EL152.cbl
 11567
 11568     IF CF-BENEFIT-CODE (SUB) < BEN-HOLD
 11569        ADD 1 TO SUB
 11570        GO TO 7267-LOOP.
 11571
 11572     IF BEN-HOLD = CF-BENEFIT-CODE (SUB)
 11573        MOVE CF-BENEFIT-DESCRIP (SUB) TO SS22D
 11574        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 11575           OR CL-CLAIM-TYPE = 'I'
 11576           OR CL-CLAIM-TYPE = 'G'
 11577           MOVE CF-BENEFIT-ALPHA (SUB)   TO BENEFIT-WORK
 11578           MOVE ELIM-DAYS                TO SS42D.
 11579
 11580     GO TO 7267-READ-CNTL6.
 11581
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 234
* EL152.cbl
 11583*7267-READ-EMPLAN. Remove as dead code
 11584 7267-READ-CNTL6.
 11585     MOVE '6'                    TO CNTL-RECORD-TYPE.
 11586     MOVE SPACES                 TO CNTL-GENL.
 11587
 11588*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11589*        MOVE CL-CURRENT-CARRIER TO CNTL-GEN4
 11590*    ELSE
 11591         MOVE PI-CARRIER         TO CNTL-GEN4.
 11592
 11593     MOVE ZEROS                  TO CNTL-SEQ.
 11594
 11595
 11596* EXEC CICS HANDLE CONDITION
 11597*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11598*         NOTFND     (7268-SET-DATE)
 11599*    END-EXEC.
 11600*    MOVE '"$JI                  ! C #00010511' TO DFHEIV0
 11601     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11603     MOVE X'4320233030303130353131' TO DFHEIV0(25:11)
 11604     CALL 'kxdfhei1' USING DFHEIV0
 11605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11606
 11607
 11608
 11609* EXEC CICS READ
 11610*         DATASET    (CNTL-ID)
 11611*         SET        (ADDRESS OF CONTROL-FILE)
 11612*         RIDFLD     (CNTL-KEY)
 11613*    END-EXEC.
 11614*    MOVE '&"S        E          (   #00010516' TO DFHEIV0
 11615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11617     MOVE X'2020233030303130353136' TO DFHEIV0(25:11)
 11618     CALL 'kxdfhei1' USING DFHEIV0,
 11619           CNTL-ID,
 11620           DFHEIV20,
 11621           DFHEIV99,
 11622           CNTL-KEY,
 11623           DFHEIV99,
 11624           DFHEIV99,
 11625           DFHEIV99
 11626     SET ADDRESS OF CONTROL-FILE TO
 11627         DFHEIV20
 11628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11629
 11630
 11631     MOVE SPACES              TO WS-LABEL-HOLD-AREA.
 11632     MOVE CF-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11633     MOVE CF-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11634     MOVE CF-ADDRESS-LINE-1   TO WS-LABEL-LINES (3).
 11635     MOVE CF-ADDRESS-LINE-2   TO WS-LABEL-LINES (4).
 11636     MOVE CF-CITY-STATE       TO WS-LABEL-LINES (5).
 11637
 11638     IF CF-ZIP-CODE-NUM NOT NUMERIC
 11639         MOVE ZEROS              TO  CF-ZIP-CODE-NUM.
 11640     IF CF-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 235
* EL152.cbl
 11641         MOVE CF-ZIP-CODE-NUM    TO  WS-ZIP-NUMERIC
 11642         MOVE WS-ZIP-NONNUM      TO  CF-ZIP-CODE.
 11643
 11644     MOVE SPACES              TO  WS-ZIP-CODE.
 11645     IF CF-CANADIAN-POST-CODE
 11646         MOVE CF-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 11647         MOVE CF-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 11648     ELSE
 11649         MOVE CF-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 11650         IF CF-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11651             MOVE '-'          TO  WS-AM-ZIP-DASH
 11652             MOVE CF-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 11653
 11654     MOVE WS-ZIP-CODE         TO  WS-LABEL-LINES (6).
 11655
 11656     MOVE CF-PHONE-NO         TO WS-PHONE-IN.
 11657     MOVE WSPI-AREA           TO WSPO-AREA.
 11658     MOVE WSPI-PFX            TO WSPO-PFX.
 11659     MOVE WSPI-SFX            TO WSPO-SFX.
 11660     MOVE WS-PHONE-OUT        TO SS04-6D.
 11661
 11662     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11663
 11664     MOVE WS-LABEL-LINES (1)  TO SS03D
 11665     IF PI-CARRIER = '8'
 11666        MOVE 'as Administrator for Investors Heritage Life Insuran
 11667-     'ce Company'               TO SS03-1D
 11668     END-IF
 11669     MOVE WS-LABEL-LINES (2)  TO SS04-1D.
 11670     MOVE WS-LABEL-LINES (3)  TO SS04-2D.
 11671     MOVE WS-LABEL-LINES (4)  TO SS04-3D.
 11672     MOVE WS-LABEL-LINES (5)  TO SS04-4D.
 11673     MOVE WS-LABEL-LINES (6)  TO SS04-5D.
 11674
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 236
* EL152.cbl
 11676 7268-SET-DATE.
 11677     MOVE EIBDATE                TO DATE-WORK.
 11678     MOVE DT-WORK                TO DC-JULIAN-YYDDD.
 11679     MOVE '5'                    TO DC-OPTION-CODE.
 11680     PERFORM 9700-DATE-LINK  THRU  9700-EXIT.
 11681     MOVE DC-GREG-DATE-1-EDIT    TO SS20D.
 11682     MOVE DC-GREG-DATE-1-ALPHA   TO SS21D.
 11683
 11684     IF NOT LOWER-CASE-LETTERS-USED
 11685        GO TO 7269-EXIT.
 11686
 11687*    IF PI-COMPANY-ID = 'DMD'
 11688*        MOVE SS21D              TO WS-TEMP-AREA2
 11689*        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11690*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11691*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11692*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11693*        END-IF
 11694*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11695*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11696*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11697*        END-IF
 11698*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11699*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11700*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11701*        END-IF
 11702*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11703*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11704*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11705*        END-IF
 11706*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11707*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11708*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11709*        END-IF
 11710*        MOVE WS-TEMP-AREA2      TO SS21D
 11711*        GO TO 7269-EXIT.
 11712*
 11713     INSPECT SS19D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11714     INSPECT SS35-1D CONVERTING UPPER-CASE TO LOWER-CASE.
 11715     INSPECT SS35-2D CONVERTING UPPER-CASE TO LOWER-CASE.
 11716     INSPECT SS22D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11717
 11718     MOVE 'N'                    TO WS-STATE-LINE.
 11719
 11720     MOVE 'Y'                    TO WS-PROCESSOR-LINE.
 11721     MOVE SS08D                  TO WS-TEMP-AREA2.
 11722     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11723     MOVE WS-TEMP-AREA2          TO SS08D.
 11724     MOVE 'N'                    TO WS-PROCESSOR-LINE.
 11725     MOVE 'N'                    TO WS-CAPS-SW.
 11726
 11727     MOVE SS09D                  TO WS-TEMP-AREA2.
 11728     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11729     MOVE WS-TEMP-AREA2          TO SS09D.
 11730
 11731     MOVE SS11-5D                TO WS-TEMP-AREA2.
 11732     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11733     MOVE WS-TEMP-AREA2          TO SS11-5D.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 237
* EL152.cbl
 11734
 11735     MOVE SS21D                  TO WS-TEMP-AREA2.
 11736     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11737     MOVE WS-TEMP-AREA2          TO SS21D.
 11738
 11739     MOVE SS40D                  TO WS-TEMP-AREA2.
 11740     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11741     MOVE WS-TEMP-AREA2          TO SS40D.
 11742
 11743     MOVE SS41D                  TO WS-TEMP-AREA2.
 11744     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11745     MOVE WS-TEMP-AREA2          TO SS41D.
 11746
 11747 7269-EXIT.
 11748     EXIT.
 11749
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 238
* EL152.cbl
 11751*            COPY ELCNAMET.
 11752*****************************************************************
 11753*                                                               *
 11754*                                                               *
 11755*                            ELCNAMET                           *
 11756*                            VMOD=2.003                         *
 11757*                                                               *
 11758*            TRANSLATION ROUTINE USED MAINLY FOR CONVERTING     *
 11759*            NAMES AND ADDRESSES AND OTHER VARIABLES TO         *
 11760*            LOWER CASE.  THE FIRST CHARACTER OF EACH WORD      *
 11761*            IS LEFT AS UPPER AND ALL OTHER LOWER CASE.         *
 11762*                                                               *
 11763*                                                               *
 11764*****************************************************************.
 11765*                   C H A N G E   L O G
 11766*
 11767* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 11768*-----------------------------------------------------------------
 11769*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 11770* EFFECTIVE    NUMBER
 11771*-----------------------------------------------------------------
 11772* 102703                   SMVA  LEAVE CERTIFICATION DESIGNATION O
 11773*                                PROCESSOR NAME LINE IN CAPS
 11774******************************************************************
 11775
 11776 7270-LABEL-MOVE.
 11777     IF WS-LABEL-HOLD-AREA = SPACES
 11778        GO TO 7279-EXIT.
 11779
 11780     IF PI-COMPANY-ID NOT = 'DMD'
 11781         PERFORM 7280-TRANSLATE-LOWER THRU 7280-EXIT.
 11782
 11783 7270-LABEL-MOVE-1.
 11784
 11785     IF WS-LABEL-LINES (1) = SPACES
 11786        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
 11787        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11788        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11789        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11790        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11791        MOVE SPACES              TO WS-LABEL-LINES (6)
 11792        GO TO 7270-LABEL-MOVE-1.
 11793
 11794     IF WS-LABEL-LINES (2) = SPACES AND
 11795        WS-LABEL-LINES (3) = SPACES AND
 11796        WS-LABEL-LINES (4) = SPACES AND
 11797        WS-LABEL-LINES (5) = SPACES AND
 11798        WS-LABEL-LINES (6) = SPACES
 11799        SET WS-NDX               TO 1
 11800        GO TO 7275-MOVE-ZIP.
 11801
 11802 7270-LABEL-MOVE-2.
 11803
 11804     IF WS-LABEL-LINES (2) = SPACES
 11805        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11806        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11807        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11808        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 239
* EL152.cbl
 11809        MOVE SPACES              TO WS-LABEL-LINES (6)
 11810        GO TO 7270-LABEL-MOVE-2.
 11811
 11812     IF WS-LABEL-LINES (3) = SPACES AND
 11813        WS-LABEL-LINES (4) = SPACES AND
 11814        WS-LABEL-LINES (5) = SPACES AND
 11815        WS-LABEL-LINES (6) = SPACES
 11816        SET WS-NDX               TO 2
 11817        GO TO 7275-MOVE-ZIP.
 11818
 11819 7270-LABEL-MOVE-3.
 11820
 11821     IF WS-LABEL-LINES (3) = SPACES
 11822        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11823        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11824        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11825        MOVE SPACES              TO WS-LABEL-LINES (6)
 11826        GO TO 7270-LABEL-MOVE-3.
 11827
 11828     IF WS-LABEL-LINES (4) = SPACES AND
 11829        WS-LABEL-LINES (5) = SPACES AND
 11830        WS-LABEL-LINES (6) = SPACES
 11831        SET WS-NDX               TO 3
 11832        GO TO 7275-MOVE-ZIP.
 11833
 11834 7270-LABEL-MOVE-4.
 11835
 11836     IF WS-LABEL-LINES (4) = SPACES
 11837        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11838        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11839        MOVE SPACES              TO WS-LABEL-LINES (6)
 11840        GO TO 7270-LABEL-MOVE-4.
 11841
 11842     IF WS-LABEL-LINES (5) = SPACES AND
 11843        WS-LABEL-LINES (6) = SPACES
 11844        SET WS-NDX               TO 4
 11845        GO TO 7275-MOVE-ZIP.
 11846
 11847 7270-LABEL-MOVE-5.
 11848
 11849     IF WS-LABEL-LINES (5) = SPACES
 11850        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11851        MOVE SPACES              TO WS-LABEL-LINES (6)
 11852        SET WS-NDX               TO 5
 11853        GO TO 7275-MOVE-ZIP
 11854
 11855     ELSE
 11856        IF WS-LABEL-LINES (6) = SPACES
 11857           SET WS-NDX            TO 5
 11858           GO TO 7275-MOVE-ZIP
 11859
 11860        ELSE
 11861           SET WS-NDX            TO 6.
 11862
 11863 7275-MOVE-ZIP.
 11864
 11865     SET WS-NDX2                 TO WS-NDX.
 11866     SET WS-NDX2 DOWN BY +1.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 240
* EL152.cbl
 11867
 11868     IF  WS-LAST-ZIP (WS-NDX2) = SPACES
 11869*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 11870         IF WS-LABEL-1ST-ZIP (WS-NDX) NUMERIC
 11871          IF PI-COMPANY-ID NOT = 'FLA'
 11872            MOVE WS-LABEL-ZIP (WS-NDX)
 11873                                     TO WS-LAST-ZIP (WS-NDX2)
 11874            MOVE SPACES              TO WS-LABEL-LINES (WS-NDX).
 11875
 11876 7279-EXIT.
 11877     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 241
* EL152.cbl
 11879
 11880 7280-TRANSLATE-LOWER.
 11881     IF LOWER-CASE-LETTERS-USED
 11882        MOVE 'N'                     TO WS-STATE-LINE
 11883     ELSE
 11884        GO TO 7280-EXIT.
 11885
 11886     IF WS-LABEL-LINES (1) NOT = SPACES
 11887        MOVE WS-LABEL-LINES (1)      TO WS-TEMP-AREA2
 11888        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11889        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (1).
 11890
 11891     IF WS-LABEL-LINES (2) NOT = SPACES
 11892        MOVE WS-LABEL-LINES (2)      TO WS-TEMP-AREA2
 11893        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11894        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (2).
 11895
 11896     IF WS-LABEL-LINES (3) NOT = SPACES
 11897        MOVE WS-LABEL-LINES (3)      TO WS-TEMP-AREA2
 11898        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11899        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (3).
 11900
 11901*****THE CITY STATE WILL BE ON LINE FOUR OR FIVE DEPENDING
 11902*****ON THE FORMAT USED.  THE SIXTH LINE BEING BLANK WILL TELL.
 11903
 11904
 11905     IF WS-LABEL-LINES (4) NOT = SPACES
 11906        IF (WS-LABEL-LINES (6) = SPACES  OR
 11907           WS-LABEL-LINES (5) = SPACES)
 11908           MOVE 'Y'                     TO WS-STATE-LINE
 11909           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11910           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11911           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4)
 11912        ELSE
 11913           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11914           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11915           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4).
 11916
 11917     IF WS-LABEL-LINES (5) NOT = SPACES
 11918        IF WS-LABEL-LINES (6) NOT = SPACES
 11919           MOVE 'Y'                     TO WS-STATE-LINE
 11920           MOVE WS-LABEL-LINES (5)      TO WS-TEMP-AREA2
 11921           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11922           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (5).
 11923
 11924 7280-EXIT.
 11925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 242
* EL152.cbl
 11927
 11928 7281-SEARCH-AND-TRANSLATE.
 11929     SET TA1  TO +1.
 11930
 11931 7281-FIND-FIRST-NON-BLANK.
 11932     IF WS-TEMP-2 (TA1) = SPACES
 11933        SET TA1 UP BY 1
 11934        GO TO 7281-FIND-FIRST-NON-BLANK.
 11935
 11936*****SET INDEX TO THE NEXT CHAR TO START THE TRANSLATE.
 11937     SET TA2   TO TA1
 11938     SET TA2   UP BY 1
 11939     SET TA21  TO TA2
 11940     SET TA21  UP BY 1.
 11941
 11942     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11943     PERFORM 7282-FIND-NEXT-BLANK THRU 7282-EXIT.
 11944
 11945 7281-EXIT.
 11946     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 243
* EL152.cbl
 11948
 11949 7282-FIND-NEXT-BLANK.
 11950     IF TA21 GREATER THAN 31
 11951        GO TO 7282-EXIT.
 11952
 11953     IF TA21 EQUAL TO 31
 11954        IF NO-CHARACTERS-FOUND
 11955           GO TO 7282-EXIT
 11956           ELSE
 11957           SET TA1   TO +1
 11958           MOVE SPACES             TO WS-TEMP-AREA1
 11959           PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11960                   UNTIL MOVE-INDX EQUAL TO TA21
 11961           PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT
 11962           SET TA1   TO +1
 11963           PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11964                   UNTIL MOVE-INDX EQUAL TO TA21
 11965           GO TO 7282-EXIT.
 11966
 11967     IF WS-TEMP-2 (TA2)  = SPACE OR ',' OR '/'
 11968         GO TO 7282-NEXT-GROUP-SEARCH.
 11969
 11970     IF WS-TEMP-2 (TA21) = SPACES OR ',' OR '/'
 11971         IF WS-TEMP-2 (TA21)  = ','
 11972            AND WS-PROCESSOR-LINE = 'Y'
 11973             SET THE-REST-R-CAPS TO TRUE
 11974         ELSE
 11975             CONTINUE
 11976     ELSE
 11977         MOVE 'Y'                  TO WS-DATA-FOUND-SW
 11978         SET TA21 UP BY +1
 11979         GO TO 7282-FIND-NEXT-BLANK.
 11980
 11981     SET TA1  TO +1
 11982     MOVE SPACES                   TO WS-TEMP-AREA1.
 11983     PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11984             UNTIL MOVE-INDX EQUAL TO TA21
 11985     PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT.
 11986     SET TA1  TO +1
 11987     PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11988             UNTIL MOVE-INDX EQUAL TO TA21
 11989     IF THE-REST-R-CAPS
 11990         GO TO 7282-EXIT.
 11991     SET TA2   TO TA21
 11992     SET TA21  UP BY 1
 11993     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11994 7282-NEXT-GROUP-SEARCH.
 11995     IF WS-TEMP-2 (TA2) EQUAL TO SPACES OR ',' OR '/'
 11996        SET TA2   UP BY 1
 11997        IF TA2 = 30
 11998           GO TO 7282-EXIT
 11999           ELSE
 12000           GO TO 7282-NEXT-GROUP-SEARCH.
 12001
 12002     SET TA2    UP BY 1
 12003     SET TA21   TO TA2
 12004     SET TA21   UP BY 1
 12005     GO TO 7282-FIND-NEXT-BLANK.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 244
* EL152.cbl
 12006
 12007 7282-EXIT.
 12008     EXIT.
 12009
 12010
 12011 7283-MOVE.
 12012     MOVE WS-TEMP-2 (MOVE-INDX) TO WS-TEMP-1 (TA1)
 12013     SET TA1 UP BY +1.
 12014
 12015
 12016 7284-MOVE-BACK.
 12017     MOVE WS-TEMP-1 (TA1)       TO WS-TEMP-2 (MOVE-INDX).
 12018     SET TA1 UP BY +1.
 12019
 12020 7285-TEST-AND-TRANSLATE.
 12021***BYPASS IF THE AREA MAY BE A PO BOX, OR RR NUMBER
 12022     IF WS-TEMP-AREA1 = '.O.' OR 'RR' OR 'O'
 12023        GO TO 7285-EXIT.
 12024
 12025***BYPASS IF IT IS A CITY/STATE LINE AND BEYOND CHARACTER 07
 12026***AND IT APPEARS THAT IT MAY BE A ABREVIATION.
 12027
 12028     SET WS-POSITION2   TO TA2
 12029     SET WS-POSITION21  TO TA21
 12030     COMPUTE WS-WORD-LENGTH = WS-POSITION21 - WS-POSITION2
 12031     IF WS-WORD-LENGTH LESS THAN 3 AND
 12032        WS-STATE-LINE = 'Y' AND
 12033        TA2 GREATER THAN 07
 12034        GO TO 7285-EXIT.
 12035
 12036     INSPECT WS-TEMP-AREA1 CONVERTING UPPER-CASE TO LOWER-CASE.
 12037
 12038 7285-EXIT.
 12039     EXIT.
 12040
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 245
* EL152.cbl
 12042 7290-RESOLVE-CREDITOR.
 12043
 12044
 12045* EXEC CICS HANDLE CONDITION
 12046*         NOTOPEN    (7290-BENE-NOT-OPEN)
 12047*         NOTFND     (7290-EXIT)
 12048*    END-EXEC.
 12049*    MOVE '"$JI                  ! D #00010935' TO DFHEIV0
 12050     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12052     MOVE X'4420233030303130393335' TO DFHEIV0(25:11)
 12053     CALL 'kxdfhei1' USING DFHEIV0
 12054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12055
 12056
 12057     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 12058
 12059     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12060     MOVE 'B'                    TO BENE-REC-TYPE.
 12061     MOVE SPACES                 TO BENE-NUMBER.
 12062     MOVE CL-CURRENT-GROUPING    TO BENE-CREDITOR.
 12063
 12064
 12065* EXEC CICS READ
 12066*         DATASET    (BENE-ID)
 12067*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 12068*         RIDFLD     (BENE-KEY)
 12069*    END-EXEC.
 12070*    MOVE '&"S        E          (   #00010947' TO DFHEIV0
 12071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12073     MOVE X'2020233030303130393437' TO DFHEIV0(25:11)
 12074     CALL 'kxdfhei1' USING DFHEIV0,
 12075           BENE-ID,
 12076           DFHEIV20,
 12077           DFHEIV99,
 12078           BENE-KEY,
 12079           DFHEIV99,
 12080           DFHEIV99,
 12081           DFHEIV99
 12082     SET ADDRESS OF BENEFICIARY-MASTER TO
 12083         DFHEIV20
 12084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12085
 12086
 12087     IF LOWER-CASE-LETTERS-USED
 12088         MOVE BE-MAIL-TO-NAME    TO WS-TEMP-AREA2
 12089         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 12090         MOVE WS-TEMP-AREA2      TO SS56D
 12091     ELSE
 12092         MOVE BE-MAIL-TO-NAME    TO SS56D.
 12093
 12094     GO TO 7290-EXIT.
 12095
 12096 7290-BENE-NOT-OPEN.
 12097
 12098     MOVE ER-7675                TO EMI-ERROR.
 12099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 246
* EL152.cbl
 12100     MOVE -1                     TO MAINTL.
 12101     GO TO 8200-SEND-DATAONLY.
 12102
 12103 7290-EXIT.
 12104     EXIT.
 12105
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 247
* EL152.cbl
 12107 7300-VARIABLE-SEARCH.
 12108***************************************************************
 12109*    THIS ROUTINE SEARCHES THE NEWLY CREATED LETTER FOR ANY   *
 12110*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 12111*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 12112*    DATA THAT WAS GENERATED IN PARAGRAPHS 7200-7299.         *
 12113*                                                             *
 12114*    THE ADDRESSING OF THE VARIABLE TABLE IS ACCOMPLISHED     *
 12115*    BY DOING A GETMAIN, MOVING THE TABLE TO THE NEW STORAGE  *
 12116*    AND BY ADJUSTING THE BLL POINTER TO POINT AT THE DATA.   *
 12117***************************************************************
 12118
 12119     MOVE REC-TEXT (TB-INDX)     TO SINGLE-LINE.
 12120
 12121     SET INDX1 TO 1.
 12122 7301-LOOP.
 12123     IF INDX1 > 70
 12124        MOVE SINGLE-LINE         TO REC-TEXT (TB-INDX)
 12125        GO TO 7399-EXIT.
 12126
 12127     IF ONE-CHAR (INDX1) NOT = '@'
 12128        SET INDX1 UP BY 1
 12129        GO TO 7301-LOOP.
 12130
 12131     SET INDX2 TO INDX1.
 12132     SET INDX2 UP BY 1.
 12133
 12134     IF ONE-CHAR (INDX2) = '@'
 12135        SET INDX1 UP BY 2
 12136        GO TO 7301-LOOP.
 12137
 12138     MOVE ONE-CHAR (INDX2)       TO V1.
 12139     SET INDX2 UP BY 1.
 12140     MOVE ONE-CHAR (INDX2)       TO V2.
 12141     SET INDX2 UP BY 1.
 12142     MOVE ONE-CHAR (INDX2)       TO V3.
 12143     SET INDX2 UP BY 1.
 12144     MOVE ONE-CHAR (INDX2)       TO V4.
 12145
 12146     IF V-NUM NOT NUMERIC
 12147        GO TO 7330-VAR-ERROR.
 12148
 12149     IF V-PERIOD NOT = '.'
 12150        MOVE '.'                 TO V-PERIOD
 12151        MOVE ZERO                TO V-DECIMAL
 12152        GO TO 7340-TABLE-SEARCH.
 12153
 12154     IF V-DECIMAL NUMERIC
 12155        GO TO 7340-TABLE-SEARCH.
 12156
 12157 7330-VAR-ERROR.
 12158     MOVE ER-0180                TO EMI-ERROR.
 12159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12160     SET INDX1 UP BY 1.
 12161     GO TO 7301-LOOP.
 12162
 12163 7340-TABLE-SEARCH.
 12164
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 248
* EL152.cbl
 12165     IF REFRESH-GETMAIN-AREA
 12166*        MOVE SAVE-VARIABLE-POINTER      TO LCP-WS-ADDR-COMP
 12167*        SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12168         MOVE SYSTEM-SUPPORTED-VARIABLES TO SYSTEM-VARIABLES
 12169         MOVE 2                          TO GETMAIN-SWITCH
 12170         MOVE 1                          TO SS-COUNTER
 12171                                            B1
 12172     ELSE
 12173         IF NO-GETMAIN-DONE-YET
 12174*            EXEC CICS GETMAIN
 12175*                 SET       (ADDRESS OF SYSTEM-VARIABLES)
 12176*                 LENGTH    (SS-WORK-AREA-LENGTH)
 12177*            END-EXEC
 12178             MOVE 2              TO GETMAIN-SWITCH
 12179*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12180*            MOVE LCP-WS-ADDR-COMP
 12181*                                TO SAVE-VARIABLE-POINTER
 12182             MOVE SYSTEM-SUPPORTED-VARIABLES
 12183                                 TO SYSTEM-VARIABLES
 12184             MOVE 1              TO SS-COUNTER
 12185                                    B1
 12186         ELSE
 12187             MOVE 1              TO SS-COUNTER
 12188                                    B1
 12189*            MOVE SAVE-VARIABLE-POINTER
 12190*                                TO LCP-WS-ADDR-COMP
 12191*            SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12192         END-IF
 12193     END-IF
 12194     .
 12195 7350-TABLE-LOOP.
 12196
 12197     IF SS-COUNTER  >  SS-NUM-ENTRIES
 12198        GO TO 7330-VAR-ERROR.
 12199
 12200     MOVE SYSTEM-VARIABLES (B1:106)
 12201                                 TO SYS-VAR-ENTRY
 12202     IF SYS-VAR-CODE NOT = VAR-HOLD
 12203        ADD SYS-VAR-LEN          TO B1
 12204*       SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12205*       ADD SYS-VAR-LEN          TO LCP-WS-ADDR-COMP
 12206*       SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12207        ADD 1                    TO SS-COUNTER
 12208        GO TO 7350-TABLE-LOOP
 12209     END-IF
 12210
 12211     MOVE SYS-VAR-ENTRY          TO VARIABLE-WORK-AREA.
 12212     SET INDXV TO 1.
 12213     SUBTRACT 6                  FROM VAR-LEN.
 12214     PERFORM 7400-MOVE-VAR-DATA VAR-LEN TIMES.
 12215     GO TO 7301-LOOP.
 12216
 12217 7399-EXIT.
 12218      EXIT.
 12219
 12220 7400-MOVE-VAR-DATA.
 12221     IF INDX1 > 70
 12222        MOVE ER-0181             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 249
* EL152.cbl
 12223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12224        GO TO 7301-LOOP.
 12225
 12226     MOVE VAR-ONE-CHAR (INDXV)   TO ONE-CHAR (INDX1).
 12227     SET INDXV UP BY 1.
 12228     SET INDX1 UP BY 1.
 12229
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 250
* EL152.cbl
 12231 7500-READ-TS.
 12232
 12233* EXEC CICS HANDLE CONDITION
 12234*         QIDERR     (7590-TS-QIDERR)
 12235*         ITEMERR    (7585-TS-ITEMERR)
 12236*    END-EXEC.
 12237*    MOVE '"$N<                  ! E #00011098' TO DFHEIV0
 12238     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12240     MOVE X'4520233030303131303938' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0
 12242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12243
 12244
 12245     SET TS-INDX TO 1.
 12246     MOVE 1                      TO TS-ITEM.
 12247
 12248 7501-LOOP.
 12249
 12250* EXEC CICS READQ TS
 12251*         INTO     (TS-WORK-AREA)
 12252*         QUEUE    (TS-NAME-TEXT)
 12253*         LENGTH   (TS-LENGTH)
 12254*         ITEM     (TS-ITEM)
 12255*    END-EXEC.
 12256*    MOVE '*$II   L              ''   #00011107' TO DFHEIV0
 12257     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12258     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12259     MOVE X'2020233030303131313037' TO DFHEIV0(25:11)
 12260     CALL 'kxdfhei1' USING DFHEIV0,
 12261           TS-NAME-TEXT,
 12262           TS-WORK-AREA,
 12263           TS-LENGTH,
 12264           TS-ITEM,
 12265           DFHEIV99,
 12266           DFHEIV99
 12267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12268
 12269
 12270     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
 12271     SET TS-INDX UP BY 1.
 12272     ADD 1                       TO TS-ITEM.
 12273     GO TO 7501-LOOP.
 12274
 12275 7585-TS-ITEMERR.
 12276     IF EIBTRNID NOT = TRANS-ID
 12277        SUBTRACT 1               FROM TS-ITEM
 12278        MOVE TS-ITEM             TO PI-TEMP-STOR-ITEMS.
 12279
 12280     GO TO 7599-EXIT.
 12281
 12282 7590-TS-QIDERR.
 12283     IF EIBTRNID = TRANS-ID
 12284        MOVE ER-0033             TO EMI-ERROR
 12285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12286        GO TO 8200-SEND-DATAONLY.
 12287
 12288 7599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 251
* EL152.cbl
 12289      EXIT.
 12290
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 252
* EL152.cbl
 12292 7600-READ-SCREEN-TS.
 12293
 12294* EXEC CICS HANDLE CONDITION
 12295*         QIDERR     (7690-TS-QIDERR)
 12296*         ITEMERR    (7685-TS-ITEMERR)
 12297*    END-EXEC.
 12298*    MOVE '"$N<                  ! F #00011137' TO DFHEIV0
 12299     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12301     MOVE X'4620233030303131313337' TO DFHEIV0(25:11)
 12302     CALL 'kxdfhei1' USING DFHEIV0
 12303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12304
 12305
 12306     MOVE 1                      TO TS-ITEM.
 12307
 12308
 12309* EXEC CICS READQ TS
 12310*         INTO    (EL152AO)
 12311*         QUEUE   (TS-NAME-SCREEN)
 12312*         LENGTH  (TS-MAP-LENGTH)
 12313*         ITEM    (TS-ITEM)
 12314*    END-EXEC.
 12315*    MOVE '*$II   L              ''   #00011144' TO DFHEIV0
 12316     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12317     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12318     MOVE X'2020233030303131313434' TO DFHEIV0(25:11)
 12319     CALL 'kxdfhei1' USING DFHEIV0,
 12320           TS-NAME-SCREEN,
 12321           EL152AO,
 12322           TS-MAP-LENGTH,
 12323           TS-ITEM,
 12324           DFHEIV99,
 12325           DFHEIV99
 12326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12327
 12328
 12329     IF MAINTL NOT = ZEROS
 12330        MOVE AL-UANON            TO MAINTA.
 12331     IF ARCHNUML NOT = ZEROS
 12332        MOVE AL-UNNON            TO ARCHNUMA.
 12333     IF FORML NOT = ZEROS
 12334        MOVE AL-UANON            TO FORMA.
 12335     IF FOLLOWL NOT = ZEROS
 12336        MOVE AL-UANON            TO FOLLOWA.
 12337     IF RESENDL NOT = ZEROS
 12338        MOVE AL-UANON            TO RESENDA.
 12339     IF PRINTL NOT = ZEROS
 12340        MOVE AL-UANON            TO PRINTA.
 12341     IF COPIESL NOT = ZEROS
 12342        MOVE AL-UNNON            TO COPIESA.
 12343     IF ADDRL NOT = ZEROS
 12344        MOVE AL-UANON            TO ADDRA.
 12345     IF REL NOT = ZEROS
 12346        MOVE AL-UANON            TO REA.
 12347
 12348     GO TO 7699-EXIT.
 12349
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 253
* EL152.cbl
 12350 7685-TS-ITEMERR.
 12351     GO TO 7699-EXIT.
 12352
 12353 7690-TS-QIDERR.
 12354     IF EIBTRNID = TRANS-ID
 12355        MOVE ER-0033             TO EMI-ERROR
 12356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12357        GO TO 8200-SEND-DATAONLY.
 12358
 12359 7699-EXIT.
 12360      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 254
* EL152.cbl
 12362
 12363 7700-PUT-TEMP-STOR.
 12364     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 12365     PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT.
 12366     SET TS-INDX TO 1.
 12367     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12368     PERFORM 7780-WRITE-TS THRU 7780-EXIT
 12369             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12370             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES.
 12371
 12372 7749-EXIT.
 12373      EXIT.
 12374
 12375 7750-DELETE-TEMP-STOR.
 12376
 12377* EXEC CICS HANDLE CONDITION
 12378*         QIDERR      (7750-EXIT)
 12379*    END-EXEC.
 12380*    MOVE '"$N                   ! G #00011198' TO DFHEIV0
 12381     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12383     MOVE X'4720233030303131313938' TO DFHEIV0(25:11)
 12384     CALL 'kxdfhei1' USING DFHEIV0
 12385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12386
 12387
 12388
 12389* EXEC CICS DELETEQ TS
 12390*         QUEUE       (TS-NAME-TEXT)
 12391*    END-EXEC.
 12392*    MOVE '*&                    #   #00011202' TO DFHEIV0
 12393     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12394     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12395     MOVE X'2020233030303131323032' TO DFHEIV0(25:11)
 12396     CALL 'kxdfhei1' USING DFHEIV0,
 12397           TS-NAME-TEXT,
 12398           DFHEIV99
 12399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12400
 12401
 12402 7750-EXIT.
 12403     EXIT.
 12404
 12405 7760-DELETE-TEMP-STOR-SCREEN.
 12406
 12407* EXEC CICS HANDLE CONDITION
 12408*         QIDERR     (7760-EXIT)
 12409*    END-EXEC.
 12410*    MOVE '"$N                   ! H #00011210' TO DFHEIV0
 12411     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12413     MOVE X'4820233030303131323130' TO DFHEIV0(25:11)
 12414     CALL 'kxdfhei1' USING DFHEIV0
 12415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12416
 12417
 12418
 12419* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 255
* EL152.cbl
 12420*         QUEUE      (TS-NAME-SCREEN)
 12421*    END-EXEC.
 12422*    MOVE '*&                    #   #00011214' TO DFHEIV0
 12423     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12425     MOVE X'2020233030303131323134' TO DFHEIV0(25:11)
 12426     CALL 'kxdfhei1' USING DFHEIV0,
 12427           TS-NAME-SCREEN,
 12428           DFHEIV99
 12429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12430
 12431
 12432 7760-EXIT.
 12433     EXIT.
 12434
 12435 7770-DELETE-TEMP-STOR-PI-AREA.
 12436
 12437* EXEC CICS HANDLE CONDITION
 12438*        QIDERR   (7770-EXIT)
 12439*    END-EXEC.
 12440*    MOVE '"$N                   ! I #00011222' TO DFHEIV0
 12441     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12443     MOVE X'4920233030303131323232' TO DFHEIV0(25:11)
 12444     CALL 'kxdfhei1' USING DFHEIV0
 12445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12446
 12447
 12448
 12449* EXEC CICS DELETEQ TS
 12450*        QUEUE    (WS-PI-QID)
 12451*    END-EXEC.
 12452*    MOVE '*&                    #   #00011226' TO DFHEIV0
 12453     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12454     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12455     MOVE X'2020233030303131323236' TO DFHEIV0(25:11)
 12456     CALL 'kxdfhei1' USING DFHEIV0,
 12457           WS-PI-QID,
 12458           DFHEIV99
 12459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12460
 12461
 12462 7770-EXIT.
 12463     EXIT.
 12464
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 256
* EL152.cbl
 12466 7780-WRITE-TS.
 12467     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
 12468     SET TS-INDX UP BY 1.
 12469     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 12470
 12471
 12472* EXEC CICS WRITEQ TS
 12473*         FROM    (TS-WORK-AREA)
 12474*         QUEUE   (TS-NAME-TEXT)
 12475*         LENGTH  (TS-LENGTH)
 12476*         ITEM    (PI-TEMP-STOR-ITEMS)
 12477*    END-EXEC.
 12478*    MOVE '*" I                  ''   #00011239' TO DFHEIV0
 12479     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12481     MOVE X'2020233030303131323339' TO DFHEIV0(25:11)
 12482     CALL 'kxdfhei1' USING DFHEIV0,
 12483           TS-NAME-TEXT,
 12484           TS-WORK-AREA,
 12485           TS-LENGTH,
 12486           PI-TEMP-STOR-ITEMS,
 12487           DFHEIV99,
 12488           DFHEIV99
 12489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12490
 12491
 12492 7780-EXIT.
 12493     EXIT.
 12494
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 257
* EL152.cbl
 12496 7790-WRITE-SCREEN-TS.
 12497     MOVE 1                      TO TS-ITEM.
 12498
 12499
 12500* EXEC CICS WRITEQ TS
 12501*         FROM    (EL152AI)
 12502*         QUEUE   (TS-NAME-SCREEN)
 12503*         LENGTH  (TS-MAP-LENGTH)
 12504*         ITEM    (TS-ITEM)
 12505*    END-EXEC.
 12506*    MOVE '*" I                  ''   #00011253' TO DFHEIV0
 12507     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12508     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12509     MOVE X'2020233030303131323533' TO DFHEIV0(25:11)
 12510     CALL 'kxdfhei1' USING DFHEIV0,
 12511           TS-NAME-SCREEN,
 12512           EL152AI,
 12513           TS-MAP-LENGTH,
 12514           TS-ITEM,
 12515           DFHEIV99,
 12516           DFHEIV99
 12517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12518
 12519
 12520 7790-EXIT.
 12521     EXIT.
 12522
 12523 7795-WRITE-PI-AREA-TS.
 12524
 12525* EXEC CICS WRITEQ TS
 12526*        QUEUE    (WS-PI-QID)
 12527*        FROM     (PROGRAM-INTERFACE-BLOCK)
 12528*        LENGTH   (PI-COMM-LENGTH)
 12529*    END-EXEC.
 12530*    MOVE '*"                    ''   #00011264' TO DFHEIV0
 12531     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 12532     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12533     MOVE X'2020233030303131323634' TO DFHEIV0(25:11)
 12534     CALL 'kxdfhei1' USING DFHEIV0,
 12535           WS-PI-QID,
 12536           PROGRAM-INTERFACE-BLOCK,
 12537           PI-COMM-LENGTH,
 12538           DFHEIV99,
 12539           DFHEIV99,
 12540           DFHEIV99
 12541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12542
 12543
 12544 7795-EXIT.
 12545     EXIT.
 12546
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 258
* EL152.cbl
 12548 7800-PRINT-LETTER-NOW.
 12549***************************************************************
 12550*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 12551*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 12552*        THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS,       *
 12553*        THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE,    *
 12554*        THE LETTER IS SAVED IN TEMP-STORAGE,                 *
 12555*        AND A START IS ISSUED FOR THE PRINT TRANSACTION.     *
 12556***************************************************************
 12557
 12558     PERFORM 400-SET-CODES THRU 499-EXIT.
 12559
 12560     PERFORM 7500-READ-TS        THRU 7599-EXIT
 12561     PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12562     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12563             VARYING SC-INDX FROM 1 BY 1
 12564             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12565
 12566     IF PI-TOTAL-LINES = 0
 12567        MOVE ER-0187             TO EMI-ERROR
 12568        MOVE -1                  TO MAINTL
 12569        MOVE AL-UABON            TO MAINTA
 12570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12571        GO TO 8200-SEND-DATAONLY.
 12572
 12573     IF COPIESL NOT = ZEROS
 12574        IF COPIESI NOT NUMERIC
 12575           MOVE ER-0184          TO EMI-ERROR
 12576           MOVE -1               TO COPIESL
 12577           MOVE AL-UNBON         TO COPIESA
 12578           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12579           GO TO 8200-SEND-DATAONLY
 12580         ELSE
 12581           MOVE COPIESI          TO PI-NUM-PRINT-COPIES
 12582       ELSE
 12583        MOVE 1                   TO PI-NUM-PRINT-COPIES.
 12584
 12585*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12586*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12587*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12588*            VARYING SC-INDX FROM 1 BY 1
 12589*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12590
 12591     MOVE +0                     TO TALLY.
 12592     INSPECT RECORD-TABLE TALLYING TALLY
 12593                                 FOR CHARACTERS BEFORE '@'.
 12594
 12595     IF TALLY < +21900
 12596        COMPUTE PI-CURRENT-LINE = TALLY / 73
 12597        MOVE ZEROS               TO ROLL-COUNTER
 12598        MOVE ER-0191             TO EMI-ERROR
 12599        MOVE -1                  TO MAINTL
 12600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12601        GO TO 7900-ROLL-PAGE.
 12602
 12603 7800-UPDATE-CLAIM.
 12604
 12605     IF PI-RETURN-TO-PROGRAM = PGM-EL126
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 259
* EL152.cbl
 12606         GO TO 7800-GET-PRINTER.
 12607
 12608     MOVE PI-COMPANY-CD          TO  CLAM-CO.
 12609     MOVE PI-CARRIER             TO  CLAM-CARRIER.
 12610     MOVE PI-CLAIM-NO            TO  CLAM-CLAIM.
 12611     MOVE PI-CERT-NO             TO  CLAM-CERT-NUM.
 12612
 12613
 12614* EXEC CICS HANDLE CONDITION
 12615*        NOTOPEN   (8860-CLAM-NOT-OPEN)
 12616*        NOTFND    (7800-CLAIM-NOT-FOUND)
 12617*    END-EXEC.
 12618*    MOVE '"$JI                  ! J #00011339' TO DFHEIV0
 12619     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12621     MOVE X'4A20233030303131333339' TO DFHEIV0(25:11)
 12622     CALL 'kxdfhei1' USING DFHEIV0
 12623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12624
 12625
 12626
 12627* EXEC CICS READ
 12628*        DATASET   (CLAM-ID)
 12629*        RIDFLD    (CLAM-KEY)
 12630*        SET       (ADDRESS OF CLAIM-MASTER)
 12631*        UPDATE
 12632*    END-EXEC.
 12633*    MOVE '&"S        EU         (   #00011344' TO DFHEIV0
 12634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12635     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12636     MOVE X'2020233030303131333434' TO DFHEIV0(25:11)
 12637     CALL 'kxdfhei1' USING DFHEIV0,
 12638           CLAM-ID,
 12639           DFHEIV20,
 12640           DFHEIV99,
 12641           CLAM-KEY,
 12642           DFHEIV99,
 12643           DFHEIV99,
 12644           DFHEIV99
 12645     SET ADDRESS OF CLAIM-MASTER TO
 12646         DFHEIV20
 12647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12648
 12649
 12650     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
 12651     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
 12652     MOVE CURRENT-SAVE           TO  CL-LAST-MAINT-DT.
 12653     MOVE '2'                    TO  CL-LAST-MAINT-TYPE.
 12654
 12655
 12656* EXEC CICS HANDLE CONDITION
 12657*        DUPKEY    (7800-GET-PRINTER)
 12658*    END-EXEC.
 12659*    MOVE '"$$                   ! K #00011356' TO DFHEIV0
 12660     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12662     MOVE X'4B20233030303131333536' TO DFHEIV0(25:11)
 12663     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 260
* EL152.cbl
 12664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12665
 12666
 12667
 12668* EXEC CICS REWRITE
 12669*        DATASET   (CLAM-ID)
 12670*        FROM      (CLAIM-MASTER)
 12671*    END-EXEC.
 12672     MOVE LENGTH OF
 12673      CLAIM-MASTER
 12674       TO DFHEIV11
 12675*    MOVE '&& L                  %   #00011360' TO DFHEIV0
 12676     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12677     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12678     MOVE X'2020233030303131333630' TO DFHEIV0(25:11)
 12679     CALL 'kxdfhei1' USING DFHEIV0,
 12680           CLAM-ID,
 12681           CLAIM-MASTER,
 12682           DFHEIV11,
 12683           DFHEIV99
 12684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12685
 12686
 12687     GO TO 7800-GET-PRINTER.
 12688
 12689 7800-CLAIM-NOT-FOUND.
 12690
 12691     MOVE ER-0133                TO  EMI-ERROR.
 12692     MOVE -1                     TO  MAINTL.
 12693     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12694     GO TO 8200-SEND-DATAONLY.
 12695
 12696 7800-GET-PRINTER.
 12697
 12698     IF PI-ALT-PRINTER-ID NOT = SPACES
 12699        GO TO 7800-CNTL-BYPASS.
 12700
 12701     MOVE '1'                    TO CNTL-RECORD-TYPE.
 12702     MOVE SPACES                 TO CNTL-GENL.
 12703     MOVE ZEROS                  TO CNTL-SEQ.
 12704
 12705
 12706* EXEC CICS HANDLE CONDITION
 12707*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 12708*         NOTFND     (7890-NOT-FOUND)
 12709*    END-EXEC.
 12710*    MOVE '"$JI                  ! L #00011383' TO DFHEIV0
 12711     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12713     MOVE X'4C20233030303131333833' TO DFHEIV0(25:11)
 12714     CALL 'kxdfhei1' USING DFHEIV0
 12715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12716
 12717
 12718
 12719* EXEC CICS READ
 12720*         DATASET    (CNTL-ID)
 12721*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 261
* EL152.cbl
 12722*         RIDFLD     (CNTL-KEY)
 12723*    END-EXEC.
 12724*    MOVE '&"S        E          (   #00011388' TO DFHEIV0
 12725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12727     MOVE X'2020233030303131333838' TO DFHEIV0(25:11)
 12728     CALL 'kxdfhei1' USING DFHEIV0,
 12729           CNTL-ID,
 12730           DFHEIV20,
 12731           DFHEIV99,
 12732           CNTL-KEY,
 12733           DFHEIV99,
 12734           DFHEIV99,
 12735           DFHEIV99
 12736     SET ADDRESS OF CONTROL-FILE TO
 12737         DFHEIV20
 12738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12739
 12740
 12741*    MOVE CF-FORMS-PRINTER-ID       TO TS-TERM-TEXT.
 12742     MOVE CF-FORMS-PRINTER-ID    TO WS-PRINTER-ID
 12743     GO TO 7800-SET-UP-TS.
 12744
 12745 7800-CNTL-BYPASS.
 12746*    MOVE PI-ALT-PRINTER-ID         TO TS-TERM-TEXT.
 12747     MOVE PI-ALT-PRINTER-ID      TO WS-PRINTER-ID.
 12748
 12749 7800-SET-UP-TS.
 12750
 12751***********************************************************
 12752*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 12753*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 12754***********************************************************
 12755
 12756     IF TS-TERM-PREFIX = 'DU'
 12757        PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT
 12758        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
 12759
 12760     SET TS-INDX TO 1.
 12761
 12762
 12763* EXEC CICS ASKTIME
 12764*    END-EXEC.
 12765*    MOVE '0"                    "   #00011415' TO DFHEIV0
 12766     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
 12767     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 12768     MOVE X'2020233030303131343135' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0,
 12770           DFHEIV99
 12771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12772
 12773
 12774     MOVE EIBTIME                TO TS-ID-TIME.
 12775*    MOVE '152A'                 TO TS-ID-TEXT
 12776     MOVE TS-NAME-TEXT           TO PI-TEMP-STOR-ID.
 12777     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12778
 12779     PERFORM 7780-WRITE-TS THRU 7780-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 262
* EL152.cbl
 12780             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12781             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
 12782
 12783     IF NOT PI-SHOW-MODE
 12784        MOVE '1'                 TO PI-PRINT-SW.
 12785
 12786
 12787* EXEC CICS HANDLE CONDITION
 12788*         TERMIDERR  (8820-TERM-ERROR)
 12789*         TRANSIDERR (8830-TRAN-ERROR)
 12790*    END-EXEC.
 12791*    MOVE '"$[\                  ! M #00011430' TO DFHEIV0
 12792     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 12793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12794     MOVE X'4D20233030303131343330' TO DFHEIV0(25:11)
 12795     CALL 'kxdfhei1' USING DFHEIV0
 12796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12797
 12798
 12799*    IF PI-COMPANY-ID = 'DMD' OR 'XXX'
 12800*        MOVE EIBTRMID    TO TS-TERM-TEXT
 12801*        EXEC CICS START
 12802*             INTERVAL    (0)
 12803*             TRANSID     (PRINT-TRANS)
 12804*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12805*             LENGTH      (PI-COMM-LENGTH)
 12806*             TERMID      (TS-TERM-TEXT)
 12807*        END-EXEC
 12808*    ELSE
 12809
 12810* EXEC CICS START
 12811*             INTERVAL    (0)
 12812*             TRANSID     (PRINT-TRANS)
 12813*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12814*             LENGTH      (PI-COMM-LENGTH)
 12815*             TERMID      (TS-TERM-TEXT)
 12816*             TERMID      (WS-PRINTER-ID)
 12817*        END-EXEC.
 12818     MOVE 0 TO DFHEIV10
 12819*    MOVE '0(ILFT                1   #00011445' TO DFHEIV0
 12820     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 12821     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 12822     MOVE X'2020233030303131343435' TO DFHEIV0(25:11)
 12823     CALL 'kxdfhei1' USING DFHEIV0,
 12824           DFHEIV10,
 12825           PRINT-TRANS,
 12826           DFHEIV99,
 12827           PROGRAM-INTERFACE-BLOCK,
 12828           PI-COMM-LENGTH,
 12829           WS-PRINTER-ID,
 12830           DFHEIV99,
 12831           DFHEIV99,
 12832           DFHEIV99,
 12833           DFHEIV99,
 12834           DFHEIV99,
 12835           DFHEIV99,
 12836           DFHEIV99,
 12837           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 263
* EL152.cbl
 12838           DFHEIV99,
 12839           DFHEIV99
 12840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12841
 12842
 12843     MOVE '104A'                 TO TS-ID-TEXT
 12844     MOVE ER-0189                TO EMI-ERROR.
 12845     MOVE -1                     TO MAINTL.
 12846     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 12847     MOVE ' PRINT TRANS STARTED ' TO EMI-MESSAGE-AREA (1)
 12848     MOVE PI-TEMP-STOR-ID TO EMI-MESSAGE-AREA (1) (25:10)
 12849
 12850     GO TO 8200-SEND-DATAONLY.
 12851
 12852 7890-NOT-FOUND.
 12853     MOVE ER-0190                TO EMI-ERROR.
 12854     MOVE -1                     TO MAINTL.
 12855     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12856     GO TO 8200-SEND-DATAONLY.
 12857
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 264
* EL152.cbl
 12859 7900-ROLL-PAGE.
 12860     IF ENTERPFL NOT = ZEROS
 12861        MOVE -1                  TO ENTERPFL
 12862       ELSE
 12863        MOVE -1                  TO MAINTL.
 12864
 12865     PERFORM 7500-READ-TS     THRU 7599-EXIT
 12866     PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12867     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12868        VARYING SC-INDX FROM 1 BY 1 UNTIL
 12869        SC-INDX > NUM-LINES-PER-SCREEN
 12870     IF PI-TOTAL-LINES = 0
 12871        MOVE ER-0047             TO EMI-ERROR
 12872        MOVE -1                  TO MAINTL
 12873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12874        GO TO 8200-SEND-DATAONLY.
 12875
 12876     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
 12877
 12878     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12879        MOVE ER-0067             TO EMI-ERROR
 12880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12881        MOVE 1                   TO TEMP-CURR-LINE.
 12882
 12883     IF TEMP-CURR-LINE > PI-TOTAL-LINES
 12884        MOVE ER-0066             TO EMI-ERROR
 12885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12886        COMPUTE TEMP-CURR-LINE
 12887            = PI-TOTAL-LINES + 1 - NUM-LINES-PER-SCREEN
 12888        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12889            MOVE 1 TO TEMP-CURR-LINE.
 12890
 12891*    IF EMI-ERROR NOT = ER-0191
 12892*       PERFORM 7500-READ-TS     THRU 7599-EXIT
 12893*       PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12894*       PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12895*                VARYING SC-INDX FROM 1 BY 1 UNTIL
 12896*                SC-INDX > NUM-LINES-PER-SCREEN
 12897*    END-IF
 12898
 12899     IF EMI-ERROR = ER-0066 OR ER-0067 OR ER-0000 OR ER-0191
 12900        NEXT SENTENCE
 12901     ELSE
 12902        GO TO 8200-SEND-DATAONLY.
 12903
 12904*    PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12905     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
 12906     SET TB-INDX                 TO PI-CURRENT-LINE.
 12907     MOVE LOW-VALUES             TO EL152RI.
 12908
 12909*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12910     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
 12911             VARYING SC-INDX FROM 1 BY 1
 12912             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12913
 12914     GO TO 8200-SEND-DATAONLY.
 12915
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 265
* EL152.cbl
 12917 7950-SET-INDX.
 12918     IF PI-CURRENT-LINE = 0
 12919        SET TB-INDX TO 1
 12920       ELSE
 12921        SET TB-INDX              TO PI-CURRENT-LINE.
 12922
 12923 7950-EXIT.
 12924      EXIT.
 12925
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 266
* EL152.cbl
 12927 7960-UPDATE-TABLE-FROM-SCREEN.
 12928     IF SC-TEXTL (SC-INDX) NOT = ZEROS
 12929        IF TB-INDX > PI-TOTAL-LINES
 12930           IF PI-TOTAL-LINES = MAX-LINES
 12931              MOVE ER-0051       TO EMI-ERROR
 12932              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933              GO TO 8200-SEND-DATAONLY
 12934           ELSE
 12935              MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX)
 12936              ADD 1              TO PI-TOTAL-LINES
 12937        ELSE
 12938           MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
 12939
 12940     SET TB-INDX UP BY 1.
 12941
 12942 7960-EXIT.
 12943      EXIT.
 12944
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 267
* EL152.cbl
 12946 8000-STARTBR-ERACCT.
 12947
 12948     IF WS-ACCT-READ-SW = 'Y'
 12949         NEXT SENTENCE
 12950     ELSE
 12951
 12952* EXEC CICS GETMAIN
 12953*             SET       (ADDRESS OF ACCOUNT-MASTER)
 12954*             LENGTH    (ACCT-LENGTH)
 12955*        END-EXEC.
 12956*    MOVE '," L                  $   #00011562' TO DFHEIV0
 12957     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12958     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12959     MOVE X'2020233030303131353632' TO DFHEIV0(25:11)
 12960     CALL 'kxdfhei1' USING DFHEIV0,
 12961           DFHEIV20,
 12962           ACCT-LENGTH,
 12963           DFHEIV99
 12964     SET ADDRESS OF ACCOUNT-MASTER TO
 12965         DFHEIV20
 12966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12967
 12968
 12969
 12970* EXEC CICS STARTBR
 12971*        RIDFLD      (ACCT-KEY)
 12972*        DATASET     (ACCT-ID)
 12973*        KEYLENGTH   (20)
 12974*        GENERIC
 12975*    END-EXEC.
 12976     MOVE 20
 12977       TO DFHEIV11
 12978     MOVE 0
 12979       TO DFHEIV12
 12980*    MOVE '&,   KG    G          &   #00011567' TO DFHEIV0
 12981     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12982     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12983     MOVE X'2020233030303131353637' TO DFHEIV0(25:11)
 12984     CALL 'kxdfhei1' USING DFHEIV0,
 12985           ACCT-ID,
 12986           ACCT-KEY,
 12987           DFHEIV11,
 12988           DFHEIV12,
 12989           DFHEIV99
 12990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12991
 12992
 12993     MOVE 'Y'         TO ACCT-BROWSE-STARTED.
 12994 8000-STARTBR-EXIT.
 12995     EXIT.
 12996
 12997 8000-READNEXT-ERACCT.
 12998
 12999
 13000* EXEC CICS READNEXT
 13001*        DATASET   (ACCT-ID)
 13002*        INTO      (ACCOUNT-MASTER)
 13003*        RIDFLD    (ACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 268
* EL152.cbl
 13004*    END-EXEC.
 13005     MOVE LENGTH OF
 13006      ACCOUNT-MASTER
 13007       TO DFHEIV12
 13008     MOVE 0
 13009       TO DFHEIV11
 13010*    MOVE '&.IL                  )   #00011580' TO DFHEIV0
 13011     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13012     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13013     MOVE X'2020233030303131353830' TO DFHEIV0(25:11)
 13014     CALL 'kxdfhei1' USING DFHEIV0,
 13015           ACCT-ID,
 13016           ACCOUNT-MASTER,
 13017           DFHEIV12,
 13018           ACCT-KEY,
 13019           DFHEIV99,
 13020           DFHEIV11,
 13021           DFHEIV99,
 13022           DFHEIV99
 13023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13024
 13025
 13026 8000-READNEXT-EXIT.
 13027     EXIT.
 13028
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 269
* EL152.cbl
 13030*8050-STARTBR-EMPROD. Remove as dead code
 13031*8050-EXIT. Remove as dead code
 13032*8060-READNEXT-EMPROD. Remove as dead code
 13033*8060-EXIT. Remove as dead code
 13034
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 270
* EL152.cbl
 13036 8100-SEND-INITIAL-MAP.
 13037     PERFORM 7700-PUT-TEMP-STOR  THRU 7749-EXIT
 13038     MOVE SAVE-DATE              TO DATEAO.
 13039     MOVE EIBTIME                TO TIME-IN.
 13040     MOVE TIME-OUT               TO TIMEAO.
 13041
 13042     MOVE PI-CARRIER             TO CARRO
 13043     MOVE PI-CLAIM-NO            TO CLMNOO
 13044     MOVE PI-CERT-NO             TO CRTNOO
 13045     MOVE PI-PROCESSOR-ID        TO PROCO
 13046     MOVE PI-COMPANY-ID          TO COMPIDO
 13047     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 13048                                 TO SYSO
 13049     MOVE PI-ENCLOSURE-CD        TO ENCO
 13050     IF NOT EMI-NO-ERRORS
 13051         SET EMI-INDX TO 1
 13052         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSGO
 13053     ELSE
 13054         MOVE SPACES             TO ERRMSGO.
 13055
 13056     MOVE -1                     TO MAINTL.
 13057
 13058
 13059* EXEC CICS SEND
 13060*        MAP      (MAP-NAME)
 13061*        MAPSET   (MAPSET-NAME)
 13062*        FROM     (EL152AO)
 13063*        ERASE
 13064*        CURSOR
 13065*    END-EXEC.
 13066     MOVE LENGTH OF
 13067      EL152AO
 13068       TO DFHEIV12
 13069     MOVE -1
 13070       TO DFHEIV11
 13071*    MOVE '8$     CT  E    H L F ,   #00011618' TO DFHEIV0
 13072     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 13073     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13074     MOVE X'2020233030303131363138' TO DFHEIV0(25:11)
 13075     CALL 'kxdfhei1' USING DFHEIV0,
 13076           MAP-NAME,
 13077           EL152AO,
 13078           DFHEIV12,
 13079           MAPSET-NAME,
 13080           DFHEIV99,
 13081           DFHEIV99,
 13082           DFHEIV99,
 13083           DFHEIV11,
 13084           DFHEIV99,
 13085           DFHEIV99,
 13086           DFHEIV99
 13087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13088
 13089
 13090     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13091     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13092
 13093     GO TO 9000-RETURN-TRANS.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 271
* EL152.cbl
 13094*    GO TO 0200-RECEIVE.
 13095
 13096 8200-SEND-DATAONLY.
 13097     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13098     MOVE PI-ENCLOSURE-CD        TO ENCO
 13099     MOVE SAVE-DATE              TO DATEAO.
 13100     MOVE EIBTIME                TO TIME-IN.
 13101     MOVE TIME-OUT               TO TIMEAO.
 13102     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13103
 13104*    IF PI-COMPANY-ID = 'DMD'
 13105*       IF FORCE-7840
 13106*          MOVE '7840 FORCED' TO PFKEY9O
 13107*          MOVE AL-SABON      TO PFKEY9A.
 13108
 13109
 13110* EXEC CICS SEND
 13111*        MAP      (MAP-NAME)
 13112*        MAPSET   (MAPSET-NAME)
 13113*        FROM     (EL152AO)
 13114*        DATAONLY
 13115*        CURSOR
 13116*    END-EXEC.
 13117     MOVE LENGTH OF
 13118      EL152AO
 13119       TO DFHEIV12
 13120     MOVE -1
 13121       TO DFHEIV11
 13122*    MOVE '8$D    CT       H L F ,   #00011645' TO DFHEIV0
 13123     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 13124     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13125     MOVE X'2020233030303131363435' TO DFHEIV0(25:11)
 13126     CALL 'kxdfhei1' USING DFHEIV0,
 13127           MAP-NAME,
 13128           EL152AO,
 13129           DFHEIV12,
 13130           MAPSET-NAME,
 13131           DFHEIV99,
 13132           DFHEIV99,
 13133           DFHEIV99,
 13134           DFHEIV11,
 13135           DFHEIV99,
 13136           DFHEIV99,
 13137           DFHEIV99
 13138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13139
 13140
 13141     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13142     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13143
 13144     GO TO 9000-RETURN-TRANS.
 13145*    GO TO 0200-RECEIVE.
 13146
 13147 8200-SEND-DATAONLY-ERASEAUP.
 13148     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13149     MOVE PI-ENCLOSURE-CD        TO ENCO
 13150     MOVE SAVE-DATE              TO DATEAO.
 13151     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 272
* EL152.cbl
 13152     MOVE TIME-OUT               TO TIMEAO.
 13153     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13154
 13155* EXEC CICS SEND
 13156*        MAP      (MAP-NAME)
 13157*        MAPSET   (MAPSET-NAME)
 13158*        FROM     (EL152AO)
 13159*        DATAONLY
 13160*        ERASEAUP
 13161*        CURSOR
 13162*    END-EXEC.
 13163     MOVE LENGTH OF
 13164      EL152AO
 13165       TO DFHEIV12
 13166     MOVE -1
 13167       TO DFHEIV11
 13168*    MOVE '8$D    CT  A    H L F ,   #00011666' TO DFHEIV0
 13169     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 13170     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13171     MOVE X'2020233030303131363636' TO DFHEIV0(25:11)
 13172     CALL 'kxdfhei1' USING DFHEIV0,
 13173           MAP-NAME,
 13174           EL152AO,
 13175           DFHEIV12,
 13176           MAPSET-NAME,
 13177           DFHEIV99,
 13178           DFHEIV99,
 13179           DFHEIV99,
 13180           DFHEIV11,
 13181           DFHEIV99,
 13182           DFHEIV99,
 13183           DFHEIV99
 13184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13185
 13186
 13187     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13188     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13189
 13190     GO TO 9000-RETURN-TRANS.
 13191*    GO TO 0200-RECEIVE.
 13192
 13193 8210-ENDBR.
 13194     IF ACCT-BROWSE-STARTED = 'Y'
 13195        MOVE 'N'                  TO ACCT-BROWSE-STARTED
 13196
 13197* EXEC CICS ENDBR
 13198*            DATASET    (ACCT-ID)
 13199*       END-EXEC.
 13200     MOVE 0
 13201       TO DFHEIV11
 13202*    MOVE '&2                    $   #00011684' TO DFHEIV0
 13203     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13205     MOVE X'2020233030303131363834' TO DFHEIV0(25:11)
 13206     CALL 'kxdfhei1' USING DFHEIV0,
 13207           ACCT-ID,
 13208           DFHEIV11,
 13209           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 273
* EL152.cbl
 13210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13211
 13212
 13213 8210-EXIT.
 13214     EXIT.
 13215
 13216 8220-ENDBR-EMPROD.
 13217     IF PROD-BROWSE-STARTED = 'Y'
 13218        MOVE 'N'                  TO PROD-BROWSE-STARTED
 13219
 13220* EXEC CICS ENDBR
 13221*            DATASET    (PROD-ID)
 13222*       END-EXEC.
 13223     MOVE 0
 13224       TO DFHEIV11
 13225*    MOVE '&2                    $   #00011694' TO DFHEIV0
 13226     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13227     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13228     MOVE X'2020233030303131363934' TO DFHEIV0(25:11)
 13229     CALL 'kxdfhei1' USING DFHEIV0,
 13230           PROD-ID,
 13231           DFHEIV11,
 13232           DFHEIV99
 13233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13234
 13235
 13236 8220-EXIT.
 13237     EXIT.
 13238
 13239 8300-SEND-TEXT.
 13240
 13241* EXEC CICS SEND TEXT
 13242*        FROM    (LOGOFF-TEXT)
 13243*        LENGTH  (LOGOFF-LENGTH)
 13244*        ERASE
 13245*        FREEKB
 13246*    END-EXEC.
 13247*    MOVE '8&      T  E F  H   F -   #00011702' TO DFHEIV0
 13248     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13249     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13250     MOVE X'2020233030303131373032' TO DFHEIV0(25:11)
 13251     CALL 'kxdfhei1' USING DFHEIV0,
 13252           LOGOFF-TEXT,
 13253           LOGOFF-LENGTH,
 13254           DFHEIV99,
 13255           DFHEIV99,
 13256           DFHEIV99,
 13257           DFHEIV99,
 13258           DFHEIV99,
 13259           DFHEIV99,
 13260           DFHEIV99,
 13261           DFHEIV99,
 13262           DFHEIV99,
 13263           DFHEIV99
 13264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13265
 13266
 13267
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 274
* EL152.cbl
 13268* EXEC CICS RETURN
 13269*    END-EXEC.
 13270*    MOVE '.(                    ''   #00011709' TO DFHEIV0
 13271     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13272     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13273     MOVE X'2020233030303131373039' TO DFHEIV0(25:11)
 13274     CALL 'kxdfhei1' USING DFHEIV0,
 13275           DFHEIV99,
 13276           DFHEIV99,
 13277           DFHEIV99,
 13278           DFHEIV99,
 13279           DFHEIV99,
 13280           DFHEIV99
 13281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13282
 13283
 13284 8600-DEEDIT.
 13285
 13286* EXEC CICS BIF DEEDIT
 13287*         FIELD    (DEEDIT-FIELD)
 13288*         LENGTH   (15)
 13289*    END-EXEC.
 13290     MOVE 15
 13291       TO DFHEIV11
 13292*    MOVE '@"L                   #   #00011713' TO DFHEIV0
 13293     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13294     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13295     MOVE X'2020233030303131373133' TO DFHEIV0(25:11)
 13296     CALL 'kxdfhei1' USING DFHEIV0,
 13297           DEEDIT-FIELD,
 13298           DFHEIV11
 13299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13300
 13301
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 275
* EL152.cbl
 13303 8800-UNAUTHORIZED-ACCESS.
 13304     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13305     GO TO 8300-SEND-TEXT.
 13306
 13307 8810-PF23.
 13308     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13309     MOVE ZEROS                  TO PI-TOTAL-LINES.
 13310     MOVE ZEROS                  TO PI-CURRENT-LINE.
 13311     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13312     MOVE XCTL-005               TO PGM-NAME.
 13313     GO TO 9300-XCTL.
 13314
 13315 8820-TERM-ERROR.
 13316     MOVE ER-0412                TO EMI-ERROR.
 13317     MOVE SPACES                 TO PI-PRINT-SW.
 13318     GO TO 8999-OPEN-ERROR.
 13319
 13320 8830-TRAN-ERROR.
 13321     MOVE ER-0413                TO EMI-ERROR.
 13322     MOVE SPACES                 TO PI-PRINT-SW.
 13323     GO TO 8999-OPEN-ERROR.
 13324
 13325 8840-CNTL-NOT-OPEN.
 13326     MOVE ER-0042                TO EMI-ERROR.
 13327     GO TO 8999-OPEN-ERROR.
 13328
 13329 8850-ARCH-NOT-OPEN.
 13330     MOVE ER-0332                TO EMI-ERROR.
 13331     GO TO 8999-OPEN-ERROR.
 13332
 13333 8860-CLAM-NOT-OPEN.
 13334     MOVE ER-0154                TO EMI-ERROR.
 13335     GO TO 8999-OPEN-ERROR.
 13336
 13337 8870-ACTV-NOT-OPEN.
 13338     MOVE ER-0172                TO EMI-ERROR.
 13339     GO TO 8999-OPEN-ERROR.
 13340
 13341 8880-ACCT-NOT-OPEN.
 13342     MOVE ER-0168                TO EMI-ERROR.
 13343     GO TO 8999-OPEN-ERROR.
 13344
 13345 8890-TEXT-NOT-OPEN.
 13346     MOVE ER-0013                TO EMI-ERROR.
 13347     GO TO 8999-OPEN-ERROR.
 13348
 13349 8900-CERT-NOT-OPEN.
 13350     MOVE ER-0169                TO EMI-ERROR.
 13351     GO TO 8999-OPEN-ERROR.
 13352
 13353 8910-CERT-NOT-FOUND.
 13354     MOVE ER-0206                TO EMI-ERROR.
 13355     GO TO 8999-OPEN-ERROR.
 13356
 13357 8915-PROD-NOT-OPEN.
 13358     MOVE ER-9106                TO EMI-ERROR.
 13359     GO TO 8999-OPEN-ERROR.
 13360
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 276
* EL152.cbl
 13361 8920-PLCY-NOT-OPEN.
 13362     MOVE ER-9883                TO EMI-ERROR.
 13363     GO TO 8999-OPEN-ERROR.
 13364
 13365 8925-PLAN-NOT-OPEN.
 13366     MOVE ER-9808                TO EMI-ERROR.
 13367     GO TO 8999-OPEN-ERROR.
 13368
 13369 8930-PLCY-NOT-FOUND.
 13370     MOVE ER-9483                TO EMI-ERROR.
 13371     GO TO 8999-OPEN-ERROR.
 13372
 13373 8999-OPEN-ERROR.
 13374     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13375     MOVE -1                     TO MAINTL.
 13376     GO TO 8200-SEND-DATAONLY.
 13377
 13378 9000-RETURN-TRANS.
 13379
 13380     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 13381
 13382* EXEC CICS RETURN
 13383*        TRANSID    (TRANS-ID)
 13384*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13385*        LENGTH     (PI-COMM-LENGTH)
 13386*    END-EXEC.
 13387*    MOVE '.(CT                  ''   #00011797' TO DFHEIV0
 13388     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13389     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13390     MOVE X'2020233030303131373937' TO DFHEIV0(25:11)
 13391     CALL 'kxdfhei1' USING DFHEIV0,
 13392           TRANS-ID,
 13393           PROGRAM-INTERFACE-BLOCK,
 13394           PI-COMM-LENGTH,
 13395           DFHEIV99,
 13396           DFHEIV99,
 13397           DFHEIV99
 13398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13399
 13400
 13401
 13402 9000-EXIT.
 13403     EXIT.
 13404 9200-RETURN-MAIN-MENU.
 13405     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13406
 13407     MOVE ZEROS                  TO PI-TOTAL-LINES
 13408                                    PI-CURRENT-LINE.
 13409     MOVE XCTL-126               TO PGM-NAME.
 13410
 13411     GO TO 9300-XCTL.
 13412
 13413 9300-XCTL.
 13414
 13415* EXEC CICS XCTL
 13416*        PROGRAM    (PGM-NAME)
 13417*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13418*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 277
* EL152.cbl
 13419*    END-EXEC.
 13420*    MOVE '.$C                   %   #00011816' TO DFHEIV0
 13421     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13422     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13423     MOVE X'2020233030303131383136' TO DFHEIV0(25:11)
 13424     CALL 'kxdfhei1' USING DFHEIV0,
 13425           PGM-NAME,
 13426           PROGRAM-INTERFACE-BLOCK,
 13427           PI-COMM-LENGTH,
 13428           DFHEIV99
 13429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13430
 13431
 13432 9400-CLEAR.
 13433     IF PI-CLEAR-MODE
 13434         MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
 13435         GO TO 9300-XCTL
 13436     ELSE
 13437         PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
 13438         PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
 13439         PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
 13440         MOVE SPACES             TO PI-WA
 13441                                    RECORD-TABLE
 13442                                    TS-WORK-AREA
 13443         MOVE ZEROS              TO PI-TOTAL-LINES
 13444                                    PI-CURRENT-LINE
 13445                                    PI-TEMP-STOR-ITEMS
 13446                                    PI-UPDATE-SW
 13447                                    PI-ADDR-SEQ
 13448         MOVE '2'                TO PI-ACTION
 13449         MOVE LOW-VALUES         TO EL152AO
 13450                                    PI-ADDR-TYPE
 13451         SET TS-INDX
 13452             TA1
 13453             TA2
 13454             TA21
 13455             TB-INDX
 13456             TB-INDX1
 13457             MOVE-INDX
 13458             SC-INDX             TO +1
 13459         IF GETMAIN-SWITCH = '2'
 13460             MOVE 1              TO GETMAIN-SWITCH
 13461             GO TO 8100-SEND-INITIAL-MAP
 13462         ELSE
 13463             GO TO 8100-SEND-INITIAL-MAP.
 13464
 13465 9600-PGMID-ERROR.
 13466
 13467* EXEC CICS HANDLE CONDITION
 13468*        PGMIDERR    (8300-SEND-TEXT)
 13469*    END-EXEC.
 13470*    MOVE '"$L                   ! N #00011856' TO DFHEIV0
 13471     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13473     MOVE X'4E20233030303131383536' TO DFHEIV0(25:11)
 13474     CALL 'kxdfhei1' USING DFHEIV0
 13475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13476
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 278
* EL152.cbl
 13477
 13478     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 13479     MOVE ' '                    TO PI-ENTRY-CD-1.
 13480     MOVE XCTL-005               TO PGM-NAME.
 13481     MOVE PGM-NAME               TO LOGOFF-PGM.
 13482     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13483     GO TO 9300-XCTL.
 13484
 13485 9700-DATE-LINK.
 13486     MOVE LINK-ELDATCV           TO PGM-NAME.
 13487
 13488* EXEC CICS LINK
 13489*        PROGRAM   (PGM-NAME)
 13490*        COMMAREA  (DATE-CONVERSION-DATA)
 13491*        LENGTH    (DC-COMM-LENGTH)
 13492*    END-EXEC.
 13493*    MOVE '."C                   (   #00011869' TO DFHEIV0
 13494     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13496     MOVE X'2020233030303131383639' TO DFHEIV0(25:11)
 13497     CALL 'kxdfhei1' USING DFHEIV0,
 13498           PGM-NAME,
 13499           DATE-CONVERSION-DATA,
 13500           DC-COMM-LENGTH,
 13501           DFHEIV99,
 13502           DFHEIV99,
 13503           DFHEIV99,
 13504           DFHEIV99
 13505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13506
 13507
 13508*    IF NO-CONVERSION-ERROR
 13509*            AND
 13510*       W-REVERSE-DATE
 13511*            AND
 13512*       PI-COMPANY-ID = 'AUK'
 13513*           MOVE DC-GREG-DATE-1-EDIT TO W-EDIT-DATE-1
 13514*           MOVE W-ED1-MM            TO W-ED2-MM
 13515*           MOVE W-ED1-DD            TO W-ED2-DD
 13516*           MOVE W-ED1-YY            TO W-ED2-YY
 13517*           MOVE W-EDIT-DATE-2       TO DC-GREG-DATE-1-EDIT.
 13518
 13519 9700-EXIT.
 13520      EXIT.
 13521
 13522 9900-ERROR-FORMAT.
 13523     IF NOT EMI-ERRORS-COMPLETE
 13524         MOVE LINK-001           TO PGM-NAME
 13525
 13526* EXEC CICS LINK
 13527*            PROGRAM   (PGM-NAME)
 13528*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 13529*            LENGTH    (EMI-COMM-LENGTH)
 13530*        END-EXEC.
 13531*    MOVE '."C                   (   #00011892' TO DFHEIV0
 13532     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13534     MOVE X'2020233030303131383932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 279
* EL152.cbl
 13535     CALL 'kxdfhei1' USING DFHEIV0,
 13536           PGM-NAME,
 13537           ERROR-MESSAGE-INTERFACE-BLOCK,
 13538           EMI-COMM-LENGTH,
 13539           DFHEIV99,
 13540           DFHEIV99,
 13541           DFHEIV99,
 13542           DFHEIV99
 13543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13544
 13545
 13546 9900-EXIT.
 13547     EXIT.
 13548
 13549 9990-ABEND.
 13550     MOVE LINK-004               TO PGM-NAME.
 13551     MOVE DFHEIBLK               TO EMI-LINE1.
 13552
 13553* EXEC CICS LINK
 13554*        PROGRAM   (PGM-NAME)
 13555*        COMMAREA  (EMI-LINE1)
 13556*        LENGTH    (72)
 13557*    END-EXEC.
 13558     MOVE 72
 13559       TO DFHEIV11
 13560*    MOVE '."C                   (   #00011904' TO DFHEIV0
 13561     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13563     MOVE X'2020233030303131393034' TO DFHEIV0(25:11)
 13564     CALL 'kxdfhei1' USING DFHEIV0,
 13565           PGM-NAME,
 13566           EMI-LINE1,
 13567           DFHEIV11,
 13568           DFHEIV99,
 13569           DFHEIV99,
 13570           DFHEIV99,
 13571           DFHEIV99
 13572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13573
 13574
 13575     GO TO 8200-SEND-DATAONLY.
 13576
 13577 9995-SECURITY-VIOLATION.
 13578*                            COPY ELCSCTP.
 13579******************************************************************
 13580*                                                                *
 13581*                            ELCSCTP                             *
 13582*                            VMOD=2.001                          *
 13583*                                                                *
 13584*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13585******************************************************************
 13586
 13587
 13588     MOVE EIBDATE          TO SM-JUL-DATE.
 13589     MOVE EIBTRMID         TO SM-TERMID.
 13590     MOVE THIS-PGM         TO SM-PGM.
 13591     MOVE EIBTIME          TO TIME-IN.
 13592     MOVE TIME-OUT         TO SM-TIME.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 280
* EL152.cbl
 13593     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13594
 13595
 13596* EXEC CICS LINK
 13597*         PROGRAM  ('EL003')
 13598*         COMMAREA (SECURITY-MESSAGE)
 13599*         LENGTH   (80)
 13600*    END-EXEC.
 13601     MOVE 'EL003' TO DFHEIV1
 13602     MOVE 80
 13603       TO DFHEIV11
 13604*    MOVE '."C                   (   #00011930' TO DFHEIV0
 13605     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13607     MOVE X'2020233030303131393330' TO DFHEIV0(25:11)
 13608     CALL 'kxdfhei1' USING DFHEIV0,
 13609           DFHEIV1,
 13610           SECURITY-MESSAGE,
 13611           DFHEIV11,
 13612           DFHEIV99,
 13613           DFHEIV99,
 13614           DFHEIV99,
 13615           DFHEIV99
 13616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13617
 13618
 13619******************************************************************
 13620
 13621
 13622
 13623 9999-DFHBACK SECTION.
 13624     MOVE '9%                    "   ' TO DFHEIV0
 13625     MOVE 'EL152' TO DFHEIV1
 13626     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13627     GOBACK.
 13628 9999-DFHEXIT.
 13629     IF DFHEIGDJ EQUAL 0001
 13630         NEXT SENTENCE
 13631     ELSE IF DFHEIGDJ EQUAL 2
 13632         GO TO 9600-PGMID-ERROR,
 13633               0325-MAPFAIL,
 13634               9990-ABEND
 13635         DEPENDING ON DFHEIGDI
 13636     ELSE IF DFHEIGDJ EQUAL 3
 13637         GO TO 9400-CLEAR,
 13638               0100-PA,
 13639               0100-PA,
 13640               0100-PA
 13641         DEPENDING ON DFHEIGDI
 13642     ELSE IF DFHEIGDJ EQUAL 4
 13643         GO TO 0325-MAPFAIL
 13644         DEPENDING ON DFHEIGDI
 13645     ELSE IF DFHEIGDJ EQUAL 5
 13646         GO TO 590-QIDERR
 13647         DEPENDING ON DFHEIGDI
 13648     ELSE IF DFHEIGDJ EQUAL 6
 13649         GO TO 8850-ARCH-NOT-OPEN,
 13650               1020-ENDBR,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 281
* EL152.cbl
 13651               1020-ENDBR
 13652         DEPENDING ON DFHEIGDI
 13653     ELSE IF DFHEIGDJ EQUAL 7
 13654         GO TO 2120-ENDBR,
 13655               2120-ENDBR,
 13656               8890-TEXT-NOT-OPEN
 13657         DEPENDING ON DFHEIGDI
 13658     ELSE IF DFHEIGDJ EQUAL 8
 13659         GO TO 8860-CLAM-NOT-OPEN,
 13660               3010-NOT-FOUND
 13661         DEPENDING ON DFHEIGDI
 13662     ELSE IF DFHEIGDJ EQUAL 9
 13663         GO TO 9990-ABEND
 13664         DEPENDING ON DFHEIGDI
 13665     ELSE IF DFHEIGDJ EQUAL 10
 13666         GO TO 6499-EXIT
 13667         DEPENDING ON DFHEIGDI
 13668     ELSE IF DFHEIGDJ EQUAL 11
 13669         GO TO 6599-EXIT
 13670         DEPENDING ON DFHEIGDI
 13671     ELSE IF DFHEIGDJ EQUAL 12
 13672         GO TO 8860-CLAM-NOT-OPEN,
 13673               7090-CLAIM-NOT-FOUND
 13674         DEPENDING ON DFHEIGDI
 13675     ELSE IF DFHEIGDJ EQUAL 13
 13676         GO TO 8880-ACCT-NOT-OPEN,
 13677               7080-ACCT-NOT-FOUND
 13678         DEPENDING ON DFHEIGDI
 13679     ELSE IF DFHEIGDJ EQUAL 14
 13680         GO TO 7070-ACTV-NOT-FOUND
 13681         DEPENDING ON DFHEIGDI
 13682     ELSE IF DFHEIGDJ EQUAL 15
 13683         GO TO 7070-ACTV-NOT-FOUND
 13684         DEPENDING ON DFHEIGDI
 13685     ELSE IF DFHEIGDJ EQUAL 16
 13686         GO TO 8870-ACTV-NOT-OPEN,
 13687               7070-ACTV-NOT-FOUND
 13688         DEPENDING ON DFHEIGDI
 13689     ELSE IF DFHEIGDJ EQUAL 17
 13690         GO TO 7075-CONTINUE-ACTV-ERROR
 13691         DEPENDING ON DFHEIGDI
 13692     ELSE IF DFHEIGDJ EQUAL 18
 13693         GO TO 8900-CERT-NOT-OPEN,
 13694               8910-CERT-NOT-FOUND
 13695         DEPENDING ON DFHEIGDI
 13696     ELSE IF DFHEIGDJ EQUAL 19
 13697         GO TO 8870-ACTV-NOT-OPEN,
 13698               7200-READ-LOAN-NUMBER
 13699         DEPENDING ON DFHEIGDI
 13700     ELSE IF DFHEIGDJ EQUAL 20
 13701         GO TO 8870-ACTV-NOT-OPEN,
 13702               7201-READ-BENEFICIARY
 13703         DEPENDING ON DFHEIGDI
 13704     ELSE IF DFHEIGDJ EQUAL 21
 13705         GO TO 7290-BENE-NOT-OPEN,
 13706               7205-READ-PHYSICIAN-ADDR
 13707         DEPENDING ON DFHEIGDI
 13708     ELSE IF DFHEIGDJ EQUAL 22
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 282
* EL152.cbl
 13709         GO TO 8870-ACTV-NOT-OPEN,
 13710               7210-READ-EMPLOYER-ADDR
 13711         DEPENDING ON DFHEIGDI
 13712     ELSE IF DFHEIGDJ EQUAL 23
 13713         GO TO 8870-ACTV-NOT-OPEN,
 13714               7220-READ-INSURED-ADDR
 13715         DEPENDING ON DFHEIGDI
 13716     ELSE IF DFHEIGDJ EQUAL 24
 13717         GO TO 8870-ACTV-NOT-OPEN,
 13718               7225-READ-OTHER1-ADDR
 13719         DEPENDING ON DFHEIGDI
 13720     ELSE IF DFHEIGDJ EQUAL 25
 13721         GO TO 8870-ACTV-NOT-OPEN,
 13722               7230-READ-OTHER2-ADDR
 13723         DEPENDING ON DFHEIGDI
 13724     ELSE IF DFHEIGDJ EQUAL 26
 13725         GO TO 8870-ACTV-NOT-OPEN,
 13726               7240-NOT-FOUND
 13727         DEPENDING ON DFHEIGDI
 13728     ELSE IF DFHEIGDJ EQUAL 27
 13729         GO TO 8870-ACTV-NOT-OPEN,
 13730               7250-READ-ACCOUNT
 13731         DEPENDING ON DFHEIGDI
 13732     ELSE IF DFHEIGDJ EQUAL 28
 13733         GO TO 8880-ACCT-NOT-OPEN,
 13734               7251-READ-3RD-PARTY
 13735         DEPENDING ON DFHEIGDI
 13736     ELSE IF DFHEIGDJ EQUAL 29
 13737         GO TO 8870-ACTV-NOT-OPEN,
 13738               7252-READ-COMP
 13739         DEPENDING ON DFHEIGDI
 13740     ELSE IF DFHEIGDJ EQUAL 30
 13741         GO TO 7260-READ-DENIAL
 13742         DEPENDING ON DFHEIGDI
 13743     ELSE IF DFHEIGDJ EQUAL 31
 13744         GO TO 8870-ACTV-NOT-OPEN,
 13745               7265-READ-CNTL1,
 13746               7265-READ-CNTL1
 13747         DEPENDING ON DFHEIGDI
 13748     ELSE IF DFHEIGDJ EQUAL 32
 13749         GO TO 8840-CNTL-NOT-OPEN,
 13750               7266-READ-CNTL2
 13751         DEPENDING ON DFHEIGDI
 13752     ELSE IF DFHEIGDJ EQUAL 33
 13753         GO TO 8840-CNTL-NOT-OPEN,
 13754               7267-READ-CNTL4
 13755         DEPENDING ON DFHEIGDI
 13756     ELSE IF DFHEIGDJ EQUAL 34
 13757         GO TO 8840-CNTL-NOT-OPEN,
 13758               7267-READ-CNTL6
 13759         DEPENDING ON DFHEIGDI
 13760     ELSE IF DFHEIGDJ EQUAL 35
 13761         GO TO 8840-CNTL-NOT-OPEN,
 13762               7268-SET-DATE
 13763         DEPENDING ON DFHEIGDI
 13764     ELSE IF DFHEIGDJ EQUAL 36
 13765         GO TO 7290-BENE-NOT-OPEN,
 13766               7290-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:24 Page 283
* EL152.cbl
 13767         DEPENDING ON DFHEIGDI
 13768     ELSE IF DFHEIGDJ EQUAL 37
 13769         GO TO 7590-TS-QIDERR,
 13770               7585-TS-ITEMERR
 13771         DEPENDING ON DFHEIGDI
 13772     ELSE IF DFHEIGDJ EQUAL 38
 13773         GO TO 7690-TS-QIDERR,
 13774               7685-TS-ITEMERR
 13775         DEPENDING ON DFHEIGDI
 13776     ELSE IF DFHEIGDJ EQUAL 39
 13777         GO TO 7750-EXIT
 13778         DEPENDING ON DFHEIGDI
 13779     ELSE IF DFHEIGDJ EQUAL 40
 13780         GO TO 7760-EXIT
 13781         DEPENDING ON DFHEIGDI
 13782     ELSE IF DFHEIGDJ EQUAL 41
 13783         GO TO 7770-EXIT
 13784         DEPENDING ON DFHEIGDI
 13785     ELSE IF DFHEIGDJ EQUAL 42
 13786         GO TO 8860-CLAM-NOT-OPEN,
 13787               7800-CLAIM-NOT-FOUND
 13788         DEPENDING ON DFHEIGDI
 13789     ELSE IF DFHEIGDJ EQUAL 43
 13790         GO TO 7800-GET-PRINTER
 13791         DEPENDING ON DFHEIGDI
 13792     ELSE IF DFHEIGDJ EQUAL 44
 13793         GO TO 8840-CNTL-NOT-OPEN,
 13794               7890-NOT-FOUND
 13795         DEPENDING ON DFHEIGDI
 13796     ELSE IF DFHEIGDJ EQUAL 45
 13797         GO TO 8820-TERM-ERROR,
 13798               8830-TRAN-ERROR
 13799         DEPENDING ON DFHEIGDI
 13800     ELSE IF DFHEIGDJ EQUAL 46
 13801         GO TO 8300-SEND-TEXT
 13802         DEPENDING ON DFHEIGDI.
 13803     MOVE '9%                    "   ' TO DFHEIV0
 13804     MOVE 'EL152' TO DFHEIV1
 13805     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13806     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       47192     Code:       43924
