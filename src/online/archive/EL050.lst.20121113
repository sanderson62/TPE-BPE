* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43******************************************************************
    44 ENVIRONMENT DIVISION.
    45
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL050.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50
    51 77  FILLER   PIC X(32) VALUE '********************************'.
    52 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    53 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    54
    55 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    56 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    57                                   USAGE POINTER.
    58 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    59 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    60 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    61                                   USAGE IS POINTER.
    62 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    63 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    64                                   USAGE IS POINTER.
    65 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    71                                   USAGE IS POINTER.
    72
    73*    COPY ELC50WS.
    74*****************************************************************
    75*                                                               *
    76*                            ELC50WS.                           *
    77*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    78*                            VMOD=2.061.                        *
    79*                                                               *
    80*   THIS IS THE WORKING STORAGE FOR EL050                       *
    81*                                   EL517                       *
    82*****************************************************************
    83******************************************************************
    84*                   C H A N G E   L O G
    85*
    86* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    87*-----------------------------------------------------------------
    88*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    89* EFFECTIVE    NUMBER
    90*-----------------------------------------------------------------
    91* 123102                   PEMA  ADD DCC PROCESSING
    92* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    93* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    94* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    95* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    96* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    97* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    98* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    99* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   100* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   101* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   102* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   103* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   104* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   105* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL050.cbl
   106* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   107* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   108* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   109* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   110* 030309  CR2009021700001  PEMA  ADD ER-2883
   111* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   113* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   114* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   115* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   116* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   117* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   118* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   119* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   120* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   121* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   122* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   123* 061412  CR2011022800001  AJRA  NAPERSOFT
   124*-----------------------------------------------------------------
   125
   126 01  WORK-AREAS.
   127
   128*****************************************************************
   129*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   130*****************************************************************
   131
   132     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   133     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   134     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   135     12  WS-NAME-EDIT-WORK-AREA.
   136         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   137         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   138             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   139         16  WS-WORK-NAME.
   140             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   141             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   142             20  FILLER           PIC X(10)     VALUE SPACES.
   143         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   144             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   145
   146*****************************************************************
   147*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   148*****************************************************************
   149
   150     12  WS-ERRESC-KEY.
   151         16 WS-ERRESC-SEARCH-KEY.
   152             20  WS-ERRESC-COMPANY-CD PIC  X.
   153             20  WS-ERRESC-CARRIER    PIC  X.
   154             20  WS-ERRESC-GROUP      PIC X(6).
   155             20  WS-ERRESC-STATE      PIC XX.
   156             20  WS-ERRESC-ACCOUNT    PIC X(10).
   157         16 WS-ERRESC-RESIDUAL-KEY.
   158             20  WS-ERRESC-AGENT      PIC X(10).
   159             20  WS-ERRESC-RES-STATE  PIC XX.
   160             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   161*                                          YYYYMMDD
   162     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   163     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL050.cbl
   164
   165*RESIDENT STATE TAX MASTER(ERRESS)
   166*
   167     12  WS-ERRESS-KEY.
   168         16  WS-ERRESS-COMPANY-CD      PIC  X.
   169         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   170         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   171         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   172*                                          YYYYMMDD
   173
   174     12  WS-CONTRACT-DATE              PIC 9(8).
   175*                                          YYYYMMDD
   176     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   177     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   178         16 WS-YEAR-YY                 PIC   9999.
   179         16 FILLER                     PIC 9(4).
   180*                                          YYYYMMDD
   181     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   182     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   183     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   184     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   185
   186     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   187         88  DPRB-1ST-TIME                      VALUE ' '.
   188
   189*****************************************************************
   190*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   191*****************************************************************
   192
   193     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   194     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   195     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   196     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   197     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   198     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   199     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   200     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   201     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   202     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   203         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   204         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   205     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   206         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   207         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   208     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   209
   210     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   211     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   212
   213     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   214     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   215     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   218     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL050.cbl
   222     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   224     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   226     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   227     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   228     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   249     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   250     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   251     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   252     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   256     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   261     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   262     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   263     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   264     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   265     12  WS-2671-SW               PIC X         VALUE SPACE.
   266     12  WS-2672-SW               PIC X         VALUE SPACE.
   267     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   268         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   269     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   270         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   271     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   272
   273     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   274         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   275         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   276         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   277         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   278
   279     12  WS-CREDIT-EDIT-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL050.cbl
   280         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   281         16  WS-MIN-AGE           PIC 99                VALUE  0.
   282         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   283         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   284         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   285         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   286
   287     12  WS-SAVE-ALLOWABLE-BENEFIT.
   288         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   289         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   290         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   291         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   292         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   293         16  FILLER                      PIC XX.
   294
   295     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   296     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   297     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   298     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   299     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   300     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   301     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   302     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   303     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   304     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   305
   306     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   307     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   308     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   309     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   310     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   311     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   312     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   313     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   314         88  WS-REDUCING              VALUE 'R'.
   315         88  WS-LEVEL                 VALUE 'L' 'P'.
   316     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   317
   318     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   319     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   320     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   321     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   322     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   323     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   324     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   325     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   326     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   327
   328     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   329     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   330     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   332     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   333     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   334     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   335     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   336     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   337     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL050.cbl
   338     12  WS-ACCT-SIG-SW.
   339         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   340         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   341     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   342     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   343     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   345     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   346     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   347     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   348     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   349     12  WS-INITIALS.
   350         16  WS-INIT-1            PIC X         VALUE SPACES.
   351         16  WS-INIT-2            PIC X         VALUE SPACES.
   352
   353     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   354     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   355     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   356     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   357     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   358*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   359     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   361     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   362     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   363     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   364     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   365     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   366     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   367     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   369     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   370     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   371     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   372     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   373     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   374     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   377     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   378     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   379     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   380     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   381******** FLA
   382     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   383     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   386     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   387********
   388     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   389     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   390     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   391     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   392     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   393     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   394     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   395     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL050.cbl
   396     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   397     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   398
   399     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   400         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   401                                         '0' THRU '9'.
   402
   403     12  NUMBER-OF-MONTHS.
   404         16  SK-MO OCCURS 12 TIMES PIC X.
   405
   406     12  WS-WORK-DATE.
   407         16  WS-YEAR            PIC 99    VALUE 00.
   408         16  WS-MONTH           PIC 99    VALUE 00.
   409         16  WS-DAY             PIC 99    VALUE 00.
   410
   411     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   412     12  WS-WORK-CRIT-DEV       REDEFINES
   413         WS-WORK-LF-CRIT-PER    PIC X(03).
   414
   415     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   416     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   417
   418     12  WS-WORK-DATE-FROM.
   419         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   420         16  FILLER             PIC X  VALUE SPACE.
   421         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   424
   425     12  WS-WORK-DATE-THRU.
   426         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   427         16  FILLER             PIC X         VALUE SPACE.
   428         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   429         16  FILLER             PIC X         VALUE SPACE.
   430         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   431
   432     12  WS-LF-INPUT-CD.
   433         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   434         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   435
   436     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   437     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   438         16  WS-AH-INPUT-CD-1   PIC X.
   439         16  WS-AH-INPUT-CD-2-3 PIC XX.
   440
   441     12  WS-SWITCHES.
   442         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   443         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   444             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   445         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   446             88  BANK-ACCT-FOUND          VALUE 'Y'.
   447         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   448             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   449         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   450             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   451         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   452             88  COMP-MASTER-FOUND        VALUE 'Y'.
   453         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL050.cbl
   454             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   455         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   456             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   457         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   458             88  STAT-MASTER-FOUND        VALUE 'Y'.
   459         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   460             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   461         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   462             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   463         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   464             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   465         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   466             88  FORM-MASTER-FOUND        VALUE 'Y'.
   467         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   468             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   469         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   470             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   471         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   472             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   473         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   474             88  NO-BENEFIT-FOUND         VALUE 'N'.
   475         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   476             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   477         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   478             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   479         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   480             88  AH-BENEFIT-FOUND         VALUE ' '.
   481             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   482         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   483             88  LF-BENEFIT-FOUND         VALUE ' '.
   484             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   485         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   486             88  NO-STATE-RECORD          VALUE '1'.
   487         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   488             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   489         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   490             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   491         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   492             88  CERT-WAS-FOUND           VALUE ' '.
   493             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   494         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   495             88  BROWSE-STARTED           VALUE 'Y'.
   496         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   497             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   498         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   499             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   500         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   501             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   502         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   503             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   504         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   505             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   506         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   507             88  APP-CERT-USED            VALUE 'Y' 'A'.
   508         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   509             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   510             88  FIRST-TIME-THROUGH       VALUE '1'.
   511             88  CTBL-NOT-FOUND           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL050.cbl
   512
   513         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   514             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   515
   516         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   517             88  DLO-ERROR-FOUND          VALUE 'Y'.
   518
   519********FLA
   520     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   521     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   522********
   523     12  RC-SW-1                  PIC X           VALUE '0'.
   524     12  RC-SW-2                  PIC X           VALUE '0'.
   525     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   526     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   527     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   530     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   531     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   532     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   533     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   534     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   535     12  LIT-SPACES               PIC X           VALUE SPACES.
   536     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   537     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   538     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   539     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   540     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   541     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   542     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   543         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   544         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   545     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   546         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   547
   548 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   549     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   550     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   551 01  WS-CRI-SSN-WORK-AREA.
   552     05  WS-CRI-SOC-SEC-NO.
   553         10  WS-SS-REPT-CD       PIC X(5).
   554         10  WS-SS-LAST-NAME     PIC X(5).
   555         10  WS-SS-INITIAL       PIC X.
   556
   557     05  WS-CRI-REPORT-CODE.
   558         10  FILLER              PIC X(5).
   559         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   560
   561     05  WS-CRI-LAST-NAME.
   562         10  WS-CRI-NAME-MOVE    PIC X(5).
   563         10  FILLER              PIC X(10).
   564
   565 01  WS-NUM-TABLE                PIC X(26)  VALUE
   566     '12345678012345070923456789'.
   567 01  FILLER REDEFINES WS-NUM-TABLE.
   568     05  WS-NUM OCCURS 26        PIC 9.
   569 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL050.cbl
   570 01  V1                          PIC S999 COMP-3.
   571 01  V2                          PIC S999 COMP-3.
   572 01  V3                          PIC S999 COMP-3.
   573 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   574 01  FILLER REDEFINES WS-WORK-VIN.
   575     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   576 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   577 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   578 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   579 01  WS-HEX-WORK.
   580     05  FILLER                  PIC X  VALUE LOW-VALUES.
   581     05  WS-HEX-BYTE             PIC X.
   582 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   583 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   584 01  WS-WORK-HIN-ROW-B.
   585     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   586
   587 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   588 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   589     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   590 01  WS-ROW-D-TABLE.
   591     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   592
   593 01  WS-HIN-TABLE-B.
   594     05  F                       PIC XX VALUE 'A2'.
   595     05  F                       PIC XX VALUE 'B3'.
   596     05  F                       PIC XX VALUE 'C4'.
   597     05  F                       PIC XX VALUE 'D5'.
   598     05  F                       PIC XX VALUE 'E6'.
   599     05  F                       PIC XX VALUE 'F7'.
   600     05  F                       PIC XX VALUE 'G8'.
   601     05  F                       PIC XX VALUE 'H9'.
   602     05  F                       PIC XX VALUE 'I1'.
   603     05  F                       PIC XX VALUE 'J2'.
   604     05  F                       PIC XX VALUE 'K3'.
   605     05  F                       PIC XX VALUE 'L4'.
   606     05  F                       PIC XX VALUE 'M5'.
   607     05  F                       PIC XX VALUE 'N6'.
   608     05  F                       PIC XX VALUE 'O0'.
   609     05  F                       PIC XX VALUE 'P7'.
   610     05  F                       PIC XX VALUE 'Q0'.
   611     05  F                       PIC XX VALUE 'R8'.
   612     05  F                       PIC XX VALUE 'S9'.
   613     05  F                       PIC XX VALUE 'T2'.
   614     05  F                       PIC XX VALUE 'U3'.
   615     05  F                       PIC XX VALUE 'V4'.
   616     05  F                       PIC XX VALUE 'W5'.
   617     05  F                       PIC XX VALUE 'X6'.
   618     05  F                       PIC XX VALUE 'Y7'.
   619     05  F                       PIC XX VALUE 'Z8'.
   620 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   621     05  WS-VAL-IN               PIC X.
   622     05  WS-VAL-OUT              PIC 9.
   623 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   624 01  WS-COMPARE-BINARY-DATES.
   625     05  WS-971231                PIC XX VALUE X'92FF'.
   626     05  WS-931231                PIC XX VALUE X'8CFF'.
   627     05  WS-791231                PIC XX VALUE X'77FF'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL050.cbl
   628     05  WS-771001                PIC XX VALUE X'74A1'.
   629     05  WS-820301                PIC XX VALUE X'7B41'.
   630     05  WS-831031                PIC XX VALUE X'7DBF'.
   631     05  WS-831231                PIC XX VALUE X'7DFF'.
   632     05  WS-810831                PIC XX VALUE X'7A7F'.
   633     05  WS-830901                PIC XX VALUE X'7D81'.
   634
   635 01  FILE-ACCESS-IDS.
   636     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   637     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   638     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   639     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   640     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   641     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   642     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   643     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   644     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   645     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   646     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   647     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   648     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   649     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   650     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   651     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   652     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   653 01  DD-IU-SW                    PIC X   VALUE ' '.
   654     88  DD-IU-PRESENT                 VALUE 'Y'.
   655
   656 01  ACCESS-KEYS.
   657     12  ELMSTR-KEY.
   658         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   659         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   660     12  W-CLAIM-KEY.
   661         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   662         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   663
   664     12  ELCNTL-KEY.
   665         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   666         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   667         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   668         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   669
   670     12  ELCERT-KEY.
   671         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   672         16  CERT-CARRIER         PIC X       VALUE SPACE.
   673         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   674         16  CERT-STATE           PIC XX      VALUE SPACES.
   675         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   676         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   677         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   678
   679     12  ELCERT2-KEY.
   680         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   681         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   682
   683     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   684
   685     12  ELCERT-SAVE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL050.cbl
   686         16  FILLER                      PIC XX    VALUE SPACES.
   687
   688         16  WCS-CONTROL-PRIMARY.
   689             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   690             20  WCS-CARRIER             PIC X     VALUE SPACE.
   691             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   692             20  WCS-STATE               PIC XX    VALUE SPACES.
   693             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   694             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   695             20  WCS-CERT-NO.
   696                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   697                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   698
   699         16  CS-CONTROL-BY-NAME.
   700             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   701             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   702             20  CS-INSURED-INITIALS.
   703                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   704                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   705
   706         16  CS-CONTROL-BY-SSN.
   707             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   708             20  CS-SOC-SEC-NO.
   709                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   710                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   711                 24  CS-SSN-LN3.
   712                     28 CS-INSURED-INITIALS-A2   PIC XX
   713                                     VALUE SPACES.
   714                     28 CS-PART-LAST-NAME-A2     PIC X
   715                                     VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-CERT-NO.
   718             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   719             20  CS-CERT-NO-A4           PIC X(11)
   720                                     VALUE SPACES.
   721
   722         16  CS-CONTROL-BY-MEMB.
   723             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   724             20  CS-MEMBER-NO.
   725                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   726                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   727                 24  CS-MEMB-LN4.
   728                     28 CS-INSURED-INITIALS-A5   PIC XX
   729                                      VALUE SPACES.
   730                     28 CS-PART-LAST-NAME-A5     PIC XX
   731                                      VALUE SPACES.
   732
   733         16  FILLER              PIC X(360) VALUE SPACES.
   734
   735     12  ERACCT-KEY.
   736         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   737         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   738         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   739         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   740         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   741         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   742
   743     12  ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL050.cbl
   744         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   745         16  COMP-CARRIER         PIC X     VALUE SPACES.
   746         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   747         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   748         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   749         16  COMP-TYPE            PIC X     VALUE SPACES.
   750
   751     12  ERLOFC-KEY.
   752         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   753         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   754         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   755         16  LOFC-STATE           PIC XX    VALUE SPACES.
   756         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   757         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   758
   759     12  WS-ELCRTT-KEY.
   760         16  WS-ELCRTT-PRIMARY       PIC X(33).
   761         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   762
   763     12  ERBXRF-KEY.
   764         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   766         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   767         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   768
   769     12  ERAGTC-KEY.
   770         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   771         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   772         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   773         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   774         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   775         16  AGTC-TYPE            PIC X     VALUE SPACES.
   776
   777     12  ERPLAN-KEY.
   778         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   779         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   780         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   781         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   782         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   783         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   784         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   785         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   786
   787     12  ERFORM-KEY.
   788         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   789         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   790         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   791         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   792
   793     12  ERREIN-KEY.
   794         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   795         16  REIN-TYPE            PIC X     VALUE SPACES.
   796         16  REIN-TABLE-CO.
   797             20  REIN-CODE-1      PIC X     VALUE SPACE.
   798             20  REIN-CODE-2      PIC X     VALUE SPACE.
   799             20  REIN-CODE-3      PIC X     VALUE SPACE.
   800         16  FILLER               PIC X(3)  VALUE SPACES.
   801
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL050.cbl
   802     12  ERCTBL-KEY.
   803         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   804         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   805         16  CTBL-CNTRL-2.
   806             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   807             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   808
   809     12  ELCRTO-KEY.
   810         16  ELCRTO-COMPANY-CD       PIC X.
   811         16  ELCRTO-CARRIER          PIC X.
   812         16  ELCRTO-GROUPING         PIC X(6).
   813         16  ELCRTO-STATE            PIC XX.
   814         16  ELCRTO-ACCOUNT          PIC X(10).
   815         16  ELCRTO-CERT-EFF-DT      PIC XX.
   816         16  ELCRTO-CERT-NO.
   817             20  ELCRTO-CERT-PRIME   PIC X(10).
   818             20  ELCRTO-CERT-SFX     PIC X.
   819         16  ELCRTO-RECORD-TYPE      PIC X.
   820         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   821
   822
   823     12  WS-ACCESS.
   824         16  FILLER               PIC XX    VALUE SPACES.
   825         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   826
   827     12  WS-CARR-ACCESS.
   828         16  FILLER               PIC X(3)  VALUE SPACES.
   829         16  WS-CARR              PIC X     VALUE SPACE.
   830*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   831*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   832     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   833         88  WS-DMD-LF-RATING   VALUE 'Y'.
   834         88  WS-DMD-AH-RATING   VALUE 'Y'.
   835         88  WS-DMD-NO-RATING   VALUE 'N'.
   836
   837     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   838         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   839                                         'NJ' 'NL'
   840                                         'PJ' 'PL'
   841                                         'SJ' 'SL'.
   842     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   843         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   844                                         'NI' 'NJ' 'NL' 'NU'
   845                                         'PJ' 'PL' 'PI' 'PU'
   846                                         'SI' 'SJ' 'SL' 'SU'
   847                                         'MX' 'MY' 'MZ'.
   848 01  ERPDEF-KEY-SAVE             PIC X(18).
   849 01  ERPDEF-KEY.
   850     12  ERPDEF-COMPANY-CD       PIC X.
   851     12  ERPDEF-STATE            PIC XX.
   852     12  ERPDEF-PROD-CD          PIC XXX.
   853     12  F                       PIC X(7).
   854     12  ERPDEF-BEN-TYPE         PIC X.
   855     12  ERPDEF-BEN-CODE         PIC XX.
   856     12  ERPDEF-EXP-DT           PIC XX.
   857
   858 01  ELSTAT-KEY-SAVE             PIC X(20).
   859 01  ELSTAT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL050.cbl
   860     12  ELSTAT-COMPANY-ID       PIC XXX.
   861     12  ELSTAT-CARRIER          PIC X.
   862     12  ELSTAT-GROUP            PIC X(6).
   863     12  ELSTAT-STATE            PIC XX.
   864     12  ELSTAT-EXP-DT           PIC 9(8).
   865 01  WS-ERROR-VALUES.
   866     12  ER-1570                     PIC S9(4)   VALUE +1570.
   867     12  ER-1571                     PIC S9(4)   VALUE +1571.
   868     12  ER-1575                     PIC S9(4)   VALUE +1575.
   869     12  ER-1891                     PIC S9(4)   VALUE +1891.
   870     12  ER-1892                     PIC S9(4)   VALUE +1892.
   871     12  ER-1893                     PIC S9(4)   VALUE +1893.
   872     12  ER-1894                     PIC S9(4)   VALUE +1894.
   873     12  ER-1895                     PIC S9(4)   VALUE +1895.
   874     12  ER-1896                     PIC S9(4)   VALUE +1896.
   875     12  ER-1897                     PIC S9(4)   VALUE +1897.
   876     12  ER-1898                     PIC S9(4)   VALUE +1898.
   877     12  ER-1899                     PIC S9(4)   VALUE +1899.
   878     12  ER-1900                     PIC S9(4)   VALUE +1900.
   879     12  ER-1901                     PIC S9(4)   VALUE +1901.
   880     12  ER-1902                     PIC S9(4)   VALUE +1902.
   881     12  ER-1903                     PIC S9(4)   VALUE +1903.
   882     12  ER-1904                     PIC S9(4)   VALUE +1904.
   883     12  ER-1905                     PIC S9(4)   VALUE +1905.
   884     12  ER-1906                     PIC S9(4)   VALUE +1906.
   885     12  ER-1907                     PIC S9(4)   VALUE +1907.
   886     12  ER-1909                     PIC S9(4)   VALUE +1909.
   887     12  ER-1910                     PIC S9(4)   VALUE +1910.
   888     12  ER-1911                     PIC S9(4)   VALUE +1911.
   889     12  ER-1912                     PIC S9(4)   VALUE +1912.
   890     12  ER-1913                     PIC S9(4)   VALUE +1913.
   891     12  ER-1914                     PIC S9(4)   VALUE +1914.
   892     12  ER-1915                     PIC S9(4)   VALUE +1915.
   893     12  ER-1916                     PIC S9(4)   VALUE +1916.
   894     12  ER-1917                     PIC S9(4)   VALUE +1917.
   895     12  ER-1918                     PIC S9(4)   VALUE +1918.
   896     12  ER-1919                     PIC S9(4)   VALUE +1919.
   897     12  ER-1920                     PIC S9(4)   VALUE +1920.
   898     12  ER-1921                     PIC S9(4)   VALUE +1921.
   899     12  ER-1922                     PIC S9(4)   VALUE +1922.
   900     12  ER-1923                     PIC S9(4)   VALUE +1923.
   901     12  ER-1924                     PIC S9(4)   VALUE +1924.
   902     12  ER-1925                     PIC S9(4)   VALUE +1925.
   903     12  ER-1926                     PIC S9(4)   VALUE +1926.
   904     12  ER-1927                     PIC S9(4)   VALUE +1927.
   905     12  ER-2393                     PIC S9(4)   VALUE +2393.
   906     12  ER-2600                     PIC S9(4)   VALUE +2600.
   907     12  ER-2601                     PIC S9(4)   VALUE +2601.
   908     12  ER-2602                     PIC S9(4)   VALUE +2602.
   909     12  ER-2603                     PIC S9(4)   VALUE +2603.
   910     12  ER-2604                     PIC S9(4)   VALUE +2604.
   911     12  ER-2605                     PIC S9(4)   VALUE +2605.
   912     12  ER-2606                     PIC S9(4)   VALUE +2606.
   913     12  ER-2607                     PIC S9(4)   VALUE +2607.
   914     12  ER-2608                     PIC S9(4)   VALUE +2608.
   915     12  ER-2609                     PIC S9(4)   VALUE +2609.
   916     12  ER-2610                     PIC S9(4)   VALUE +2610.
   917     12  ER-2611                     PIC S9(4)   VALUE +2611.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL050.cbl
   918     12  ER-2612                     PIC S9(4)   VALUE +2612.
   919     12  ER-2613                     PIC S9(4)   VALUE +2613.
   920     12  ER-2614                     PIC S9(4)   VALUE +2614.
   921     12  ER-2615                     PIC S9(4)   VALUE +2615.
   922     12  ER-2616                     PIC S9(4)   VALUE +2616.
   923     12  ER-2617                     PIC S9(4)   VALUE +2617.
   924     12  ER-2618                     PIC S9(4)   VALUE +2618.
   925     12  ER-2619                     PIC S9(4)   VALUE +2619.
   926     12  ER-2620                     PIC S9(4)   VALUE +2620.
   927     12  ER-2621                     PIC S9(4)   VALUE +2621.
   928     12  ER-2622                     PIC S9(4)   VALUE +2622.
   929     12  ER-2623                     PIC S9(4)   VALUE +2623.
   930     12  ER-2624                     PIC S9(4)   VALUE +2624.
   931     12  ER-2625                     PIC S9(4)   VALUE +2625.
   932     12  ER-2626                     PIC S9(4)   VALUE +2626.
   933     12  ER-2627                     PIC S9(4)   VALUE +2627.
   934     12  ER-2628                     PIC S9(4)   VALUE +2628.
   935     12  ER-2629                     PIC S9(4)   VALUE +2629.
   936     12  ER-2630                     PIC S9(4)   VALUE +2630.
   937     12  ER-2631                     PIC S9(4)   VALUE +2631.
   938     12  ER-2632                     PIC S9(4)   VALUE +2632.
   939     12  ER-2633                     PIC S9(4)   VALUE +2633.
   940     12  ER-2634                     PIC S9(4)   VALUE +2634.
   941     12  ER-2635                     PIC S9(4)   VALUE +2635.
   942     12  ER-2636                     PIC S9(4)   VALUE +2636.
   943     12  ER-2637                     PIC S9(4)   VALUE +2637.
   944     12  ER-2638                     PIC S9(4)   VALUE +2638.
   945     12  ER-2639                     PIC S9(4)   VALUE +2639.
   946     12  ER-2640                     PIC S9(4)   VALUE +2640.
   947     12  ER-2641                     PIC S9(4)   VALUE +2641.
   948     12  ER-2642                     PIC S9(4)   VALUE +2642.
   949     12  ER-2643                     PIC S9(4)   VALUE +2643.
   950     12  ER-2644                     PIC S9(4)   VALUE +2644.
   951     12  ER-2645                     PIC S9(4)   VALUE +2645.
   952     12  ER-2646                     PIC S9(4)   VALUE +2646.
   953     12  ER-2647                     PIC S9(4)   VALUE +2647.
   954     12  ER-2648                     PIC S9(4)   VALUE +2648.
   955     12  ER-2649                     PIC S9(4)   VALUE +2649.
   956     12  ER-2650                     PIC S9(4)   VALUE +2650.
   957     12  ER-2651                     PIC S9(4)   VALUE +2651.
   958     12  ER-2652                     PIC S9(4)   VALUE +2652.
   959     12  ER-2653                     PIC S9(4)   VALUE +2653.
   960     12  ER-2654                     PIC S9(4)   VALUE +2654.
   961     12  ER-2655                     PIC S9(4)   VALUE +2655.
   962     12  ER-2656                     PIC S9(4)   VALUE +2656.
   963     12  ER-2657                     PIC S9(4)   VALUE +2657.
   964     12  ER-2658                     PIC S9(4)   VALUE +2658.
   965     12  ER-2659                     PIC S9(4)   VALUE +2659.
   966     12  ER-2660                     PIC S9(4)   VALUE +2660.
   967     12  ER-2661                     PIC S9(4)   VALUE +2661.
   968     12  ER-2662                     PIC S9(4)   VALUE +2662.
   969     12  ER-2663                     PIC S9(4)   VALUE +2663.
   970     12  ER-2664                     PIC S9(4)   VALUE +2664.
   971     12  ER-2665                     PIC S9(4)   VALUE +2665.
   972     12  ER-2666                     PIC S9(4)   VALUE +2666.
   973     12  ER-2667                     PIC S9(4)   VALUE +2667.
   974     12  ER-2668                     PIC S9(4)   VALUE +2668.
   975     12  ER-2669                     PIC S9(4)   VALUE +2669.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL050.cbl
   976     12  ER-2670                     PIC S9(4)   VALUE +2670.
   977     12  ER-2671                     PIC S9(4)   VALUE +2671.
   978     12  ER-2672                     PIC S9(4)   VALUE +2672.
   979     12  ER-2673                     PIC S9(4)   VALUE +2673.
   980     12  ER-2674                     PIC S9(4)   VALUE +2674.
   981     12  ER-2675                     PIC S9(4)   VALUE +2675.
   982     12  ER-2676                     PIC S9(4)   VALUE +2676.
   983     12  ER-2677                     PIC S9(4)   VALUE +2677.
   984     12  ER-2678                     PIC S9(4)   VALUE +2678.
   985     12  ER-2679                     PIC S9(4)   VALUE +2679.
   986     12  ER-2680                     PIC S9(4)   VALUE +2680.
   987     12  ER-2681                     PIC S9(4)   VALUE +2681.
   988     12  ER-2682                     PIC S9(4)   VALUE +2682.
   989     12  ER-2683                     PIC S9(4)   VALUE +2683.
   990     12  ER-2684                     PIC S9(4)   VALUE +2684.
   991     12  ER-2685                     PIC S9(4)   VALUE +2685.
   992     12  ER-2686                     PIC S9(4)   VALUE +2686.
   993     12  ER-2687                     PIC S9(4)   VALUE +2687.
   994     12  ER-2688                     PIC S9(4)   VALUE +2688.
   995     12  ER-2689                     PIC S9(4)   VALUE +2689.
   996     12  ER-2690                     PIC S9(4)   VALUE +2690.
   997     12  ER-2691                     PIC S9(4)   VALUE +2691.
   998     12  ER-2692                     PIC S9(4)   VALUE +2692.
   999     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1000     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1001     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1002     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1003     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1004     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1005     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1006     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1007     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1008     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1009     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1010     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1011     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1012     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1013     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1014     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1015     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1016     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1017     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1018     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1019     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1020     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1021     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1022     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1023     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1024     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1025     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1026     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1027     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1028     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1029     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1030     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1031     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1032     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1033     12  ER-2737                     PIC S9(4)   VALUE +2737.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL050.cbl
  1034     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1035     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1036     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1037     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1038     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1039     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1040     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1041     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1042     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1043     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1044     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1045     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1046     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1047     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1048     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1049     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1050     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1051     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1052     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1053     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1054     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1055     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1056     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1057     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1058     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1059     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1060     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1061     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1062     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1063     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1064     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1065     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1066     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1067     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1068     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1069     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1070     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1071     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1072     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1073     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1074     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1075     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1076     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1077     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1078     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1079     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1080     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1081     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1082     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1083     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1084     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1085     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1086     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1087     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1088     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1089     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1090     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1091     12  ER-2869                     PIC S9(4)   VALUE +2869.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL050.cbl
  1092     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1093     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1094     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1095     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1096     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1097     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1098     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1099     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1100     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1101     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1102     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1103     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1104     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1105     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1106     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1107     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1108     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1109     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1110     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1111     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1112     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1113     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1114     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1115     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1116     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1117     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1118     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1119     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1120     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1121     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1122     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1123     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1124     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1125     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1126     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1127     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1128     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1129     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1130     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1131     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1132     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1133     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1134     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1135     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1136     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1137     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1138     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1139     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1140     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1141     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1142     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1143     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1144     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1145     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1146     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1147     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1148     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1149     12  ER-8069                     PIC S9(4)   VALUE +8069.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL050.cbl
  1150     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1151     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1152     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1153     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1154     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1155     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1156     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1157     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1158     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1159     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1160     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1161     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1162     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1163     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1164     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1165     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1166     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1167     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1168     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1169     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1170     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1171     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1172     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1173     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1174     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1175     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1176     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1177     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1178     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1179     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1180     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1181     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1182     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1183     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1184     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1185     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1186     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1187     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1188     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1189     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1190     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1191     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1192     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1193     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1194     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1195     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1196     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1197     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1198     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1199     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1200     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1201     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1202     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1203     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1204     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1205     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1206******************************************************************
  1207***************   END OF ELC50WS     ****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL050.cbl
  1208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL050.cbl
  1211 01  WORKING-STORAGE-WORK-AREAS.
  1212     12  WS-RESPONSE             PIC S9(8)  COMP.
  1213         88  WS-RESP-NORMAL           VALUE +00.
  1214         88  WS-RESP-ERROR            VALUE +01.
  1215         88  WS-RESP-NOTFND           VALUE +13.
  1216         88  WS-RESP-DUPREC           VALUE +14.
  1217         88  WS-RESP-ENDFILE          VALUE +20.
  1218     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1219     12  WORK-AREAS.
  1220         16  WK-CONV-GREG.
  1221             24  WCG-CENT             PIC XX.
  1222             24  WCG-REST             PIC X(4).
  1223         16  WORK-GREGORIAN-DATE.
  1224             24  WK-GREG-CENT         PIC XX.
  1225             24  WK-GREG-DATE-YYMMDD.
  1226                 28  WK-GREG-YYMM     PIC X(4).
  1227                 28  WK-GREG-DD       PIC XX.
  1228
  1229         16  WORK-SELECT-DATE.
  1230             24  WK-SELECT-CENT            PIC XX.
  1231             24  WK-SELECT-DATE-YYMMDD.
  1232                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1233                 28  FILLER                PIC XX.
  1234
  1235         16  WK-FORM-NO.
  1236             24  WK-FORM-BANK-ID       PIC X(5).
  1237             24  WK-FORM-UNDRWRTR      PIC X(1).
  1238             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1239
  1240         16  WK-MEMBER-NO.
  1241             24  WK-MEMBER-1-6        PIC X(6).
  1242             24  WK-MEMBER-7-12       PIC X(6).
  1243
  1244         16  WK-FULL-CERT-NO.
  1245             24  WK-CERT-POS-1-2      PIC X(2).
  1246             24  WK-CERT-POS-3        PIC X(1).
  1247             24  WK-CERT-POS-4        PIC X(1).
  1248             24  WK-CERT-POS-5-6      PIC X(2).
  1249             24  WK-CERT-POS-7        PIC X(1).
  1250             24  WK-CERT-POS-8-11     PIC X(4).
  1251
  1252         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1253             88  VALID-RATE-CODE        VALUE 'Y'.
  1254             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1255
  1256         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1257         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1258         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1259         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1260         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1261         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1262         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1263         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1264         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1265         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1266
  1267* DLO001
  1268 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL050.cbl
  1269     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1270     12  DMPF-RETURN-CODE          PIC XX.
  1271         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1272         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1273         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1274         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1275         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1276         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1277
  1278* DLO002
  1279 01  WS-DLO-INTERNAL-POLICY-FORM.
  1280     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1281     12  DIPF-RETURN-CODE          PIC XX.
  1282         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1283         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1284         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1285         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1286         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1287         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1288
  1289* DLO003
  1290 01  WS-DLO-VALID-BANK-ID.
  1291     12  DVBI-BANK-ID              PIC X(5).
  1292     12  DVBI-BANK-ID-TYPE         PIC X.
  1293         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1294         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1295         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1296         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1297         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1298     12  DVBI-RETURN-CODE          PIC XX.
  1299         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1300         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1301         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1302         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1303         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1304         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1305         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1306         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1307         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1308
  1309* DLO007
  1310 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1311     12  DCUA-RES-STATE            PIC XX.
  1312     12  DCUA-BEN-TYPE             PIC XX.
  1313     12  DCUA-SYS-IDENT            PIC X.
  1314         88  DCUA-CLAIM                        VALUE 'C'.
  1315         88  DCUA-PREMIUM                      VALUE 'P'.
  1316     12  DCUA-COVERAGE-RULE        PIC X.
  1317     12  DCUA-CLIENT-ID            PIC X(10).
  1318     12  DCUA-EFF-DATE             PIC X(8).
  1319     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1320     12  DCUA-RETURN-CODE          PIC XX.
  1321         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1322     12  DCUA-CERT-NUMBER          PIC X(11).
  1323     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1324     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1325
  1326* DLO011
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL050.cbl
  1327 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1328     12  DPRB-RATE-CODE            PIC X(4).
  1329     12  DPRB-COVERAGE-CATEG       PIC X.
  1330     12  DPRB-RETURN-CODE          PIC XX.
  1331         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1332         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1333         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1334         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1335         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1336         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1337         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1338         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1339         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1340     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1341     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1342     12  DPRB-BEN-TYPE             PIC XX.
  1343
  1344* DLO017
  1345 01  WS-DLO-VALID-RATE-CODE.
  1346     12  DVRC-RATE-CODE            PIC X(4).
  1347     12  DVRC-RETURN-CODE          PIC XX.
  1348         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1349         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1350         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1351         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1352         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1353         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1354
  1355* DLO019
  1356 01  WS-DLO-ORIG-COV-CAT.
  1357     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1358     12  DOCC-RETURN-CODE          PIC XX.
  1359     12  DOCC-ORIG-COV-CAT         PIC X.
  1360     12  DOCC-UNDERWITER           PIC XX.
  1361     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1362     12  DOCC-FILLER               PIC X(6).
  1363
  1364* DLO021
  1365 01  WS-DLO-VALID-LOAN-OFFICER.
  1366     12  DVLO-LOAN-OFFICER.
  1367         16  DVLO-BILL-TYPE        PIC X.
  1368         16  DVLO-BILL-SOURCE      PIC X.
  1369         16  DVLO-BATCH-TYPE       PIC X.
  1370     12  DVLO-RETURN-CODE          PIC XX.
  1371         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1372         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1373         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1374         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1375         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1376         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1377
  1378* DLO022
  1379 01  WS-DLO-VALID-STATE-CODE.
  1380     12  DVSC-STATE-CODE           PIC XX.
  1381     12  DVSC-RETURN-CODE          PIC XX.
  1382         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1383
  1384* DLO023
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL050.cbl
  1385 01  WS-DLO-VALID-CODE-VALUES.
  1386     12  DVCV-SYSTEM-ID            PIC XX.
  1387         88  DVCV-CLAIMS                       VALUE 'CL'.
  1388         88  DVCV-CREDIT                       VALUE 'CR'.
  1389     12  DVCV-RECORD-TYPE          PIC XX.
  1390         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1391         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1392         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1393         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1394         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1395         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1396         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1397         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1398     12  DVCV-RECORD-KEY           PIC X(6).
  1399     12  DVCV-RETURN-CODE          PIC XX.
  1400         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1401         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1402         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1403         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1404         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1405         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1406         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1407     12  DVCV-CODE-DESC            PIC X(60).
  1408     12  DVCV-GEN-DESC-1           PIC X(20).
  1409     12  DVCV-GEN-DESC-2           PIC X(20).
  1410     12  DVCV-GEN-DESC-3           PIC X(20).
  1411
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL050.cbl
  1413*    COPY ERCBXRF.
  1414******************************************************************
  1415*                                                                *
  1416*                                                                *
  1417*                            ERCBXRF                             *
  1418*                                                                *
  1419*   ONLINE CREDIT SYSTEM                                         *
  1420*                                                                *
  1421*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1422*                                                                *
  1423*   FILE TYPE = VSAM,KSDS                                        *
  1424*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1425*                                                                *
  1426*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1427*       ALTERNATE PATH = NONE                                    *
  1428*                                                                *
  1429*   LOG = NO                                                     *
  1430*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1431*                                                                *
  1432******************************************************************
  1433
  1434 01  BANK-CROSS-REFERENCE.
  1435     12  BK-RECORD-ID                PIC XX.
  1436         88  VALID-BK-ID             VALUE 'BK'.
  1437
  1438     12  BK-CONTROL-PRIMARY.
  1439         16  BK-COMPANY-CD           PIC X.
  1440         16  BK-CARRIER              PIC X.
  1441         16  BK-GROUPING             PIC X(6).
  1442         16  BK-BANK-NO              PIC X(10).
  1443
  1444     12  BK-MAINT-INFORMATION.
  1445         16  BK-LAST-MAINT-DT        PIC XX.
  1446         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1447         16  BK-LAST-MAINT-USER      PIC X(4).
  1448         16  FILLER                  PIC X(9).
  1449
  1450     12  FILLER                      PIC X(37).
  1451
  1452     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1453
  1454     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1455                            DEPENDING ON BK-BANK-POINTER-CNT.
  1456         16  BK-AM-ACCOUNT           PIC X(10).
  1457         16  BK-AM-EXP-DT            PIC XX.
  1458         16  BK-AM-EFF-DT            PIC XX.
  1459         16  BK-AM-STATE             PIC XX.
  1460         16  FILLER                  PIC X(20).
  1461
  1462******************************************************************
  1463
  1464*    COPY ERCCOMP.
  1465******************************************************************
  1466*                                                                *
  1467*                                                                *
  1468*                            ERCCOMP                             *
  1469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1470*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL050.cbl
  1471*                                                                *
  1472*   ONLINE CREDIT SYSTEM                                         *
  1473*                                                                *
  1474*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1475*                                                                *
  1476*   FILE TYPE = VSAM,KSDS                                        *
  1477*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1478*                                                                *
  1479*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1480*       ALTERNATE PATH = NONE                                    *
  1481*                                                                *
  1482*   LOG = NO                                                     *
  1483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1484*                                                                *
  1485******************************************************************
  1486*                   C H A N G E   L O G
  1487*
  1488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1489*-----------------------------------------------------------------
  1490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1491* EFFECTIVE    NUMBER
  1492*-----------------------------------------------------------------
  1493* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1494* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1495* 092205    2005050300006  PEMA  ADD LEASE FEE
  1496* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1497* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1498* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1499* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1500* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1501* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1502******************************************************************
  1503
  1504 01  COMPENSATION-MASTER.
  1505     12  CO-RECORD-ID                          PIC XX.
  1506         88  VALID-CO-ID                          VALUE 'CO'.
  1507
  1508     12  CO-CONTROL-PRIMARY.
  1509         16  CO-COMPANY-CD                     PIC X.
  1510         16  CO-CONTROL.
  1511             20  CO-CTL-1.
  1512                 24  CO-CARR-GROUP.
  1513                     28  CO-CARRIER            PIC X.
  1514                     28  CO-GROUPING.
  1515                         32  CO-GROUP-PREFIX   PIC XXX.
  1516                         32  CO-GROUP-PRIME    PIC XXX.
  1517                 24  CO-RESP-NO.
  1518                     28  CO-RESP-PREFIX        PIC X(4).
  1519                     28  CO-RESP-PRIME         PIC X(6).
  1520             20  CO-CTL-2.
  1521                 24  CO-ACCOUNT.
  1522                     28  CO-ACCT-PREFIX        PIC X(4).
  1523                     28  CO-ACCT-PRIME         PIC X(6).
  1524         16  CO-TYPE                           PIC X.
  1525             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1526             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1527             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1528
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL050.cbl
  1529     12  CO-MAINT-INFORMATION.
  1530         16  CO-LAST-MAINT-DT                  PIC XX.
  1531         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1532         16  CO-LAST-MAINT-USER                PIC X(4).
  1533     12  FILLER                                PIC XX.
  1534     12  CO-STMT-TYPE                          PIC XXX.
  1535     12  CO-COMP-TYPE                          PIC X.
  1536         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1537     12  CO-STMT-OWNER                         PIC X(4).
  1538     12  CO-BALANCE-CONTROL                    PIC X.
  1539         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1540         88  CO-NO-BALANCE                        VALUE 'N'.
  1541
  1542     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1543         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1544         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1545         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1546
  1547     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1548         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1549         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1550
  1551     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1552     12  CO-GA-DIRECT-DEP                      PIC X.
  1553     12  CO-FUTURE-SPACE                       PIC X.
  1554         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1555
  1556     12  CO-ACCT-NAME                          PIC X(30).
  1557     12  CO-MAIL-NAME                          PIC X(30).
  1558     12  CO-ADDR-1                             PIC X(30).
  1559     12  CO-ADDR-2                             PIC X(30).
  1560     12  CO-ADDR-3.
  1561         16  CO-ADDR-CITY                      PIC X(27).
  1562         16  CO-ADDR-STATE                     PIC XX.
  1563     12  CO-CSO-1099                           PIC X.
  1564     12  CO-ZIP.
  1565         16  CO-ZIP-PRIME.
  1566             20  CO-ZIP-PRI-1ST                PIC X.
  1567                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1568             20  FILLER                        PIC X(4).
  1569         16  CO-ZIP-PLUS4                      PIC X(4).
  1570     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1571         16  CO-CAN-POSTAL-1                   PIC XXX.
  1572         16  CO-CAN-POSTAL-2                   PIC XXX.
  1573         16  FILLER                            PIC XXX.
  1574     12  CO-SOC-SEC                            PIC X(13).
  1575     12  CO-TELEPHONE.
  1576         16  CO-AREA-CODE                      PIC XXX.
  1577         16  CO-PREFIX                         PIC XXX.
  1578         16  CO-PHONE                          PIC X(4).
  1579
  1580     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1581
  1582     12  CO-AR-BAL-LEVEL                       PIC X.
  1583         88  CO-AR-REF-LVL                        VALUE '1'.
  1584         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1585         88  CO-AR-BILL-LVL                       VALUE '2'.
  1586         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL050.cbl
  1587         88  CO-AR-FR-LVL                         VALUE '4'.
  1588
  1589     12  CO-AR-NORMAL-PRINT                    PIC X.
  1590         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1591         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1592
  1593     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1594
  1595     12  CO-AR-REPORTING                       PIC X.
  1596         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1597         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1598
  1599     12  CO-AR-PULL-CHECK                      PIC X.
  1600         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1601         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1602
  1603     12  CO-AR-BALANCE-PRINT                   PIC X.
  1604         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1605
  1606     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1607         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1608         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1609         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1610
  1611     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1612
  1613     12  CO-USER-CODE                          PIC X.
  1614     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1615
  1616******************************************************************
  1617*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1618*    THE LAST MONTH END RUN.
  1619******************************************************************
  1620
  1621     12  CO-LAST-ACTIVITY-DATE.
  1622         16  CO-ACT-YEAR                       PIC 99.
  1623         16  CO-ACT-MONTH                      PIC 99.
  1624         16  CO-ACT-DAY                        PIC 99.
  1625
  1626     12  CO-LAST-STMT-DT.
  1627         16  CO-LAST-STMT-YEAR                 PIC 99.
  1628         16  CO-LAST-STMT-MONTH                PIC 99.
  1629         16  CO-LAST-STMT-DAY                  PIC 99.
  1630
  1631     12  CO-MO-END-TOTALS.
  1632         16  CO-MONTHLY-TOTALS.
  1633             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1634             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1635             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1636             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1637             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1638
  1639         16  CO-AGING-TOTALS.
  1640             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1641             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1642             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1643             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1644
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL050.cbl
  1645         16  CO-YTD-TOTALS.
  1646             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1647             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1648
  1649         16  CO-OVER-UNDER-TOTALS.
  1650             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1651             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1652
  1653     12  CO-MISCELLANEOUS-TOTALS.
  1654         16  CO-FICA-TOTALS.
  1655             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1656             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-CLAIM-TOTALS.
  1659             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1660             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1661
  1662******************************************************************
  1663*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1664*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1665******************************************************************
  1666
  1667     12  CO-CURRENT-TOTALS.
  1668         16  CO-CURRENT-LAST-STMT-DT.
  1669             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1670             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1671             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1672
  1673         16  CO-CURRENT-MONTHLY-TOTALS.
  1674             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1675             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1676             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1677             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1678             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1679
  1680         16  CO-CURRENT-AGING-TOTALS.
  1681             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1682             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1683             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1684             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1685
  1686         16  CO-CURRENT-YTD-TOTALS.
  1687             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1689
  1690     12  CO-PAID-COMM-TOTALS.
  1691         16  CO-YTD-PAID-COMMS.
  1692             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1693             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1694
  1695     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1696         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1697         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1698
  1699     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1700         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1701         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1702         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL050.cbl
  1703         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1704         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1705         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1706         88  CO-FINAL-LETTER                  VALUE 'F'.
  1707         88  CO-RECONCILING                   VALUE 'R'.
  1708         88  CO-PHONE-CALL                    VALUE 'P'.
  1709         88  CO-LEGAL                         VALUE 'L'.
  1710         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1711         88  CO-WRITE-OFF                     VALUE 'W'.
  1712         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1713
  1714     12  CO-CSR-CODE                       PIC X(4).
  1715
  1716     12  CO-GA-STATUS-INFO.
  1717         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1718         16  CO-GA-TERMINATION-DT          PIC XX.
  1719         16  CO-GA-STATUS-CODE             PIC X.
  1720             88  CO-GA-ACTIVE                 VALUE 'A'.
  1721             88  CO-GA-INACTIVE               VALUE 'I'.
  1722             88  CO-GA-PENDING                VALUE 'P'.
  1723         16  CO-GA-COMMENTS.
  1724             20  CO-GA-COMMENT-1           PIC X(40).
  1725             20  CO-GA-COMMENT-2           PIC X(40).
  1726             20  CO-GA-COMMENT-3           PIC X(40).
  1727             20  CO-GA-COMMENT-4           PIC X(40).
  1728
  1729     12  CO-RPTCD2                         PIC X(10).
  1730     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1731         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1732         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1733
  1734     12  CO-TYPE-AGENT                     PIC X(01).
  1735         88  CO-CORPORATION                   VALUE 'C'.
  1736         88  CO-PARTNERSHIP                   VALUE 'P'.
  1737         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1738         88  CO-TRUST                         VALUE 'T'.
  1739         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1740
  1741     12  CO-FAXNO.
  1742         16  CO-FAX-AREA-CODE                  PIC XXX.
  1743         16  CO-FAX-PREFIX                     PIC XXX.
  1744         16  CO-FAX-PHONE                      PIC X(4).
  1745
  1746     12  CO-BANK-INFORMATION.
  1747         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1748         16  CO-BANK-TRANSIT-NON REDEFINES
  1749             CO-BANK-TRANSIT-NO                PIC 9(8).
  1750
  1751         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1752     12  CO-MISC-DEDUCT-INFO REDEFINES
  1753                  CO-BANK-INFORMATION.
  1754         16  CO-MD-GL-ACCT                     PIC X(10).
  1755         16  CO-MD-DIV                         PIC XX.
  1756         16  CO-MD-CENTER                      PIC X(4).
  1757         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1758         16  CO-CREATE-AP-CHECK                PIC X.
  1759         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1760         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL050.cbl
  1761     12  CO-ACH-STATUS                         PIC X.
  1762         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1763         88  CO-ACH-PENDING                        VALUE 'P'.
  1764
  1765     12  CO-BILL-SW                            PIC X.
  1766     12  CO-CONTROL-NAME                       PIC X(30).
  1767     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1768     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1769     12  CO-CLP-STATE                          PIC XX.
  1770     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1771     12  CO-SPP-REFUND-EDIT                    PIC X.
  1772
  1773******************************************************************
  1774
  1775*    COPY ERCAGTC.
  1776******************************************************************
  1777*                                                                *
  1778*                                                                *
  1779*                            ERCAGTC                             *
  1780*                            VMOD=2.001                          *
  1781*                                                                *
  1782*   ONLINE CREDIT SYSTEM                                         *
  1783*                                                                *
  1784*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1785*                                                                *
  1786*   FILE TYPE = VSAM,KSDS                                        *
  1787*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1788*                                                                *
  1789*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1790*       ALTERNATE PATH = NONE                                    *
  1791*                                                                *
  1792*   LOG = NO                                                     *
  1793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1794*                                                                *
  1795******************************************************************
  1796*                   C H A N G E   L O G
  1797*
  1798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1799*-----------------------------------------------------------------
  1800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1801* EFFECTIVE    NUMBER
  1802*-----------------------------------------------------------------
  1803* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1804* 111004                         NEW FILE AND COPYBOOK
  1805* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1806******************************************************************
  1807 01  AGENT-COMMISSIONS.
  1808     12  AG-RECORD-ID                          PIC XX.
  1809         88  VALID-CO-ID                          VALUE 'AG'.
  1810     12  AG-CONTROL-PRIMARY.
  1811         16  AG-COMPANY-CD                     PIC X.
  1812         16  AG-CONTROL.
  1813             20  AG-CTL-1.
  1814                 24  AG-CARR-GROUP.
  1815                     28  AG-CARRIER            PIC X.
  1816                     28  AG-GROUPING           PIC X(6).
  1817                 24  AG-BANK                   PIC X(10).
  1818             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL050.cbl
  1819                 24  AG-EXP-DT                 PIC XX.
  1820         16  AG-TYPE                           PIC X.
  1821             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1822             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1823     12  AG-MAINT-INFORMATION.
  1824         16  AG-LAST-MAINT-DT                  PIC XX.
  1825         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1826         16  AG-LAST-MAINT-USER                PIC X(4).
  1827         16  FILLER                            PIC X(10).
  1828     12  AG-EFF-DT                             PIC XX.
  1829     12  AG-COMM-STRUCTURE.
  1830         16  AG-AGT-COMMS OCCURS 10.
  1831             20  AG-AGT                PIC X(10).
  1832             20  AG-COM-TYP            PIC X.
  1833             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1834             20  AG-RECALC-LV-INDIC    PIC X.
  1835             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1836             20  AG-LRCALC-LV-INDIC    PIC X.
  1837             20  FILLER                PIC X(05).
  1838     12  FILLER                  PIC X(145).
  1839******************************************************************
  1840*    COPY ERCRESS.
  1841******************************************************************
  1842*                                                                *
  1843*                            ERCRESS                             *
  1844*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1845*                            VMOD=2.002                          *
  1846*                                                                *
  1847*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1848*                                                                *
  1849*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1850*   VSAM RESIDENT STATE TAX MASTER                              *
  1851*                                                                *
  1852*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1853*                                                                *
  1854*   FILE TYPE = VSAM,KSDS                                        *
  1855*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1856*                                                                *
  1857*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1858*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1859*                                                                *
  1860*   LOG = NO                                                     *
  1861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1862*                                                                *
  1863*                                                                *
  1864******************************************************************
  1865
  1866 01  RESIDENT-STATE-TAX-MASTER.
  1867
  1868     10  ERRESS-PRIMARY-KEY.
  1869         15  RES-COMPANY-CD        PIC X.
  1870         15  RES-RESIDENT-STATE    PIC XX.
  1871         15  RES-COVERAGE-CATEGORY PIC X.
  1872         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1873*                                      YYYYMMDD
  1874*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1875
  1876     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL050.cbl
  1877
  1878         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1879         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1880         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1881         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1882
  1883     10 RES-RECALC-SW              PIC   X.
  1884         88 RECALC                VALUE 'Y'.
  1885         88 NO-RECALC             VALUE 'N'.
  1886     10  RES-MAINT-BY              PIC X(4).
  1887     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1888     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1889*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL050.cbl
  1891*    COPY ERCRESC.
  1892******************************************************************
  1893*                                                                *
  1894*                            ERCRESC                             *
  1895*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1896*                            VMOD=2.003                          *
  1897*                                                                *
  1898*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1899*                                                                *
  1900*   FILE TYPE = VSAM,KSDS                                        *
  1901*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1902*                                                                *
  1903*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1904*       ALTERNATE PATH1 = NONE                                   *
  1905*                                                                *
  1906*   LOG = NO                                                     *
  1907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1908*                                                                *
  1909******************************************************************
  1910
  1911 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1912
  1913     10  ERRESC-RECORD-KEY.
  1914         15  RESC-COMPANY-CD           PIC   X.
  1915         15  RESC-CARRIER              PIC   X.
  1916         15  RESC-GROUP                PIC   X(6).
  1917         15  RESC-STATE                PIC   XX.
  1918         15  RESC-ACCOUNT              PIC   X(10).
  1919         15  RESC-AGENT                PIC   X(10).
  1920         15  RESC-RESIDENT-STATE       PIC   XX.
  1921         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1922*                                           YYYYMMDD
  1923     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1924
  1925     10  RESC-COMM-RECORD-DATA.
  1926         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1927             20 RESC-COVERAGE-CAT      PIC    X.
  1928             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1929             20 RESC-COMMISSION-TAB REDEFINES
  1930                RESC-COMMISSION-PER    PIC  XXX.
  1931
  1932     10  RESC-MAINT-BY                 PIC X(4).
  1933     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1934     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1935*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL050.cbl
  1937*    COPY ERCPLAN.
  1938******************************************************************
  1939*                                                                *
  1940*                                                                *
  1941*                            ERCPLAN                             *
  1942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1943*                            VMOD=2.003                          *
  1944*                                                                *
  1945*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1946*                                                                *
  1947*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1948*   PLAN MASTER                                                  *
  1949*                                                                *
  1950*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1951*                                                                *
  1952*   FILE TYPE = VSAM,KSDS                                        *
  1953*   RECORD SIZE = 420   RECFORM = FIX                            *
  1954*                                                                *
  1955*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1956*       ALTERNATE PATH1 = N/A                                    *
  1957*                                                                *
  1958*   LOG = NO                                                     *
  1959*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1960*                                                                *
  1961*                                                                *
  1962******************************************************************
  1963
  1964 01  PLAN-MASTER.
  1965     12  PL-RECORD-ID                      PIC XX.
  1966         88  VALID-PL-ID                      VALUE 'PL'.
  1967
  1968     12  PL-CONTROL-PRIMARY.
  1969         16  PL-COMPANY-CD                 PIC X.
  1970         16  PL-MSTR-CNTRL.
  1971             20  PL-CONTROL-A.
  1972                 24  PL-CARRIER            PIC X.
  1973                 24  PL-GROUPING           PIC X(6).
  1974                 24  PL-STATE              PIC XX.
  1975                 24  PL-ACCOUNT            PIC X(10).
  1976             20  PL-BENEFIT-TYPE           PIC X.
  1977             20  PL-BENEFIT-CODE           PIC XX.
  1978             20  PL-REVISION-NO            PIC X(3).
  1979
  1980     12  PL-CONTROL-BY-VAR-GRP.
  1981         16  PL-COMPANY-CD-A1              PIC X.
  1982         16  PL-VG-CARRIER                 PIC X.
  1983         16  PL-VG-GROUPING                PIC X(6).
  1984         16  PL-VG-STATE                   PIC XX.
  1985         16  PL-VG-ACCOUNT                 PIC X(10).
  1986         16  PL-BENEFIT-TYPE-A1            PIC X.
  1987         16  PL-BENEFIT-CODE-A1            PIC XX.
  1988         16  PL-REVISION-NO-A1             PIC 999.
  1989
  1990     12  PL-MAINT-INFORMATION.
  1991         16  PL-LAST-MAINT-DT              PIC XX.
  1992         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1993         16  PL-LAST-MAINT-USER            PIC X(4).
  1994         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL050.cbl
  1995
  1996     12  PL-LIABILITY-LIMITS.
  1997         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1998         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1999             20  PL-LM-AGE                 PIC S99        COMP-3.
  2000             20  PL-LM-DUR                 PIC S999       COMP-3.
  2001             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2002             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2003
  2004     12  FILLER                            PIC X(30).
  2005
  2006     12  PL-GL-ACCOUNT-NOS.
  2007         16  PL-PREMIUM-GL                 PIC X(8).
  2008         16  PL-COMM-GL                    PIC X(8).
  2009         16  PL-CLAIM-GL                   PIC X(8).
  2010     12  FILLER                            PIC X(24).
  2011     12  PL-TOLERANCES.
  2012         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2013         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2014         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2015         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2016         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2017         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2018     12  PL-OVER-SHORT.
  2019         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2020         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2021     12  FILLER                            PIC X(24).
  2022     12  PLAN-MISC.
  2023         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2024         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2025         16  PL-IG                         PIC X.
  2026         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2027         16  PL-POLICY-FORM                PIC X(12).
  2028         16  PL-EDIT-FOR-FORM              PIC X(01).
  2029         16  PL-DEV-CODE                   PIC XXX.
  2030         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2031         16  PL-CALC-METHOD                PIC X.
  2032         16  PL-BENEFIT-GROUP              PIC X(05).
  2033         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2034
  2035         16  FILLER                        PIC X(99).
  2036******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL050.cbl
  2038*    COPY ELCCERT.
  2039******************************************************************
  2040*                                                                *
  2041*                            ELCCERT.                            *
  2042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2043*                            VMOD=2.013                          *
  2044*                                                                *
  2045*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2046*                                                                *
  2047*   FILE TYPE = VSAM,KSDS                                        *
  2048*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2049*                                                                *
  2050*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2051*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2052*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2053*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2054*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2055*                                                                *
  2056*   LOG = YES                                                    *
  2057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2058******************************************************************
  2059*                   C H A N G E   L O G
  2060*
  2061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2062*-----------------------------------------------------------------
  2063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2064* EFFECTIVE    NUMBER
  2065*-----------------------------------------------------------------
  2066* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2067* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2068* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2069* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2070* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2071* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2072* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2073* 032612  CR2011110200001  PEMA  AHL CHANGES
  2074******************************************************************
  2075
  2076 01  CERTIFICATE-MASTER.
  2077     12  CM-RECORD-ID                      PIC XX.
  2078         88  VALID-CM-ID                      VALUE 'CM'.
  2079
  2080     12  CM-CONTROL-PRIMARY.
  2081         16  CM-COMPANY-CD                 PIC X.
  2082         16  CM-CARRIER                    PIC X.
  2083         16  CM-GROUPING.
  2084             20  CM-GROUPING-PREFIX        PIC X(3).
  2085             20  CM-GROUPING-PRIME         PIC X(3).
  2086         16  CM-STATE                      PIC XX.
  2087         16  CM-ACCOUNT.
  2088             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2089             20  CM-ACCOUNT-PRIME          PIC X(6).
  2090         16  CM-CERT-EFF-DT                PIC XX.
  2091         16  CM-CERT-NO.
  2092             20  CM-CERT-PRIME             PIC X(10).
  2093             20  CM-CERT-SFX               PIC X.
  2094
  2095     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL050.cbl
  2096         16  CM-COMPANY-CD-A1              PIC X.
  2097         16  CM-INSURED-LAST-NAME          PIC X(15).
  2098         16  CM-INSURED-INITIALS.
  2099             20  CM-INSURED-INITIAL1       PIC X.
  2100             20  CM-INSURED-INITIAL2       PIC X.
  2101
  2102     12  CM-CONTROL-BY-SSN.
  2103         16  CM-COMPANY-CD-A2              PIC X.
  2104         16  CM-SOC-SEC-NO.
  2105             20  CM-SSN-STATE              PIC XX.
  2106             20  CM-SSN-ACCOUNT            PIC X(6).
  2107             20  CM-SSN-LN3.
  2108                 25  CM-INSURED-INITIALS-A2.
  2109                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2110                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2111                 25 CM-PART-LAST-NAME-A2         PIC X.
  2112
  2113     12  CM-CONTROL-BY-CERT-NO.
  2114         16  CM-COMPANY-CD-A4              PIC X.
  2115         16  CM-CERT-NO-A4                 PIC X(11).
  2116
  2117     12  CM-CONTROL-BY-MEMB.
  2118         16  CM-COMPANY-CD-A5              PIC X.
  2119         16  CM-MEMBER-NO.
  2120             20  CM-MEMB-STATE             PIC XX.
  2121             20  CM-MEMB-ACCOUNT           PIC X(6).
  2122             20  CM-MEMB-LN4.
  2123                 25  CM-INSURED-INITIALS-A5.
  2124                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2125                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2126                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2127
  2128     12  CM-INSURED-PROFILE-DATA.
  2129         16  CM-INSURED-FIRST-NAME.
  2130             20  CM-INSURED-1ST-INIT       PIC X.
  2131             20  FILLER                    PIC X(9).
  2132         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2133         16  CM-INSURED-SEX                PIC X.
  2134             88  CM-SEX-MALE                  VALUE 'M'.
  2135             88  CM-SEX-FEMAL                 VALUE 'F'.
  2136         16  CM-INSURED-JOINT-AGE          PIC 99.
  2137         16  CM-JOINT-INSURED-NAME.
  2138             20  CM-JT-LAST-NAME           PIC X(15).
  2139             20  CM-JT-FIRST-NAME.
  2140                 24  CM-JT-1ST-INIT        PIC X.
  2141                 24  FILLER                PIC X(9).
  2142             20  CM-JT-INITIAL             PIC X.
  2143
  2144     12  CM-LIFE-DATA.
  2145         16  CM-LF-BENEFIT-CD              PIC XX.
  2146         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2147         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2148         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2149         16  CM-LF-DEV-CODE                PIC XXX.
  2150         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2151         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2152         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2153         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL050.cbl
  2154         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2155         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2156         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2157         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2158         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2159         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2160         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2161         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2162         16  FILLER                        PIC XX.
  2163
  2164     12  CM-AH-DATA.
  2165         16  CM-AH-BENEFIT-CD              PIC XX.
  2166         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2167         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2168         16  CM-AH-DEV-CODE                PIC XXX.
  2169         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2170         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2171         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2172         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2173         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2174         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2175         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2176         16  CM-AH-PAID-THRU-DT            PIC XX.
  2177             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2178         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2179         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2180         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2181         16  FILLER                        PIC X.
  2182
  2183     12  CM-LOAN-INFORMATION.
  2184         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2185         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2186                                           PIC S9(5)V99  COMP-3.
  2187         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2188         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2189         16  CM-PAY-FREQUENCY              PIC S99.
  2190         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2191         16  CM-RATE-CLASS                 PIC XX.
  2192         16  CM-BENEFICIARY                PIC X(25).
  2193         16  CM-POLICY-FORM-NO             PIC X(12).
  2194         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2195         16  CM-LAST-ADD-ON-DT             PIC XX.
  2196         16  CM-DEDUCTIBLE-AMOUNTS.
  2197             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2198             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2199         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2200             20  CM-RESIDENT-STATE         PIC XX.
  2201             20  CM-RATE-CODE              PIC X(4).
  2202             20  FILLER                    PIC XX.
  2203         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2204             20  CM-LOAN-OFFICER           PIC X(5).
  2205             20  FILLER                    PIC XXX.
  2206         16  CM-CSR-CODE                   PIC XXX.
  2207         16  CM-UNDERWRITING-CODE          PIC X.
  2208             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2209         16  CM-POST-CARD-IND              PIC X.
  2210         16  CM-NH-INTERFACE-SW            PIC X.
  2211         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL050.cbl
  2212             88  CM-SING-PRM                  VALUE '1'.
  2213             88  CM-O-B-COVERAGE              VALUE '2'.
  2214             88  CM-OPEN-END                  VALUE '3'.
  2215         16  CM-IND-GRP-TYPE               PIC X.
  2216             88  CM-INDIVIDUAL                VALUE 'I'.
  2217             88  CM-GROUP                     VALUE 'G'.
  2218         16  CM-SKIP-CODE                  PIC X.
  2219             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2220             88  SKIP-JULY                    VALUE '1'.
  2221             88  SKIP-AUGUST                  VALUE '2'.
  2222             88  SKIP-SEPTEMBER               VALUE '3'.
  2223             88  SKIP-JULY-AUG                VALUE '4'.
  2224             88  SKIP-AUG-SEPT                VALUE '5'.
  2225             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2226             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2227             88  SKIP-JUNE                    VALUE '8'.
  2228             88  SKIP-JUNE-JULY               VALUE '9'.
  2229             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2230             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2231         16  CM-PAYMENT-MODE               PIC X.
  2232             88  PAY-MONTHLY                  VALUE SPACE.
  2233             88  PAY-WEEKLY                   VALUE '1'.
  2234             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2235             88  PAY-BI-WEEKLY                VALUE '3'.
  2236             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2237         16  CM-LOAN-NUMBER                PIC X(8).
  2238         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2239         16  CM-OLD-LOF                    PIC XXX.
  2240*        16  CM-LOAN-OFFICER               PIC XXX.
  2241         16  CM-REIN-TABLE                 PIC XXX.
  2242         16  CM-SPECIAL-REIN-CODE          PIC X.
  2243         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2244         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2245         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2246
  2247     12  CM-STATUS-DATA.
  2248         16  CM-ENTRY-STATUS               PIC X.
  2249         16  CM-ENTRY-DT                   PIC XX.
  2250
  2251         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2252         16  CM-LF-CANCEL-DT               PIC XX.
  2253         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2254
  2255         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2256         16  CM-LF-DEATH-DT                PIC XX.
  2257         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2258
  2259         16  CM-LF-CURRENT-STATUS          PIC X.
  2260             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2261                                                'M' '4' '5' '9'.
  2262             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2263             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2264             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2265             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2266             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2267             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2268             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2269             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL050.cbl
  2270             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2271             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2272             88  CM-LF-DECLINED               VALUE 'D'.
  2273             88  CM-LF-VOIDED                 VALUE 'V'.
  2274
  2275         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2276         16  CM-AH-CANCEL-DT               PIC XX.
  2277         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2278
  2279         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2280         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2281         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2282
  2283         16  CM-AH-CURRENT-STATUS          PIC X.
  2284             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2285                                                'M' '4' '5' '9'.
  2286             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2287             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2288             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2289             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2290             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2291             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2292             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2293             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2294             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2295             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2296             88  CM-AH-DECLINED               VALUE 'D'.
  2297             88  CM-AH-VOIDED                 VALUE 'V'.
  2298
  2299         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2300             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2301             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2302             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2303         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2304
  2305         16  CM-ENTRY-BATCH                PIC X(6).
  2306         16  CM-LF-EXIT-BATCH              PIC X(6).
  2307         16  CM-AH-EXIT-BATCH              PIC X(6).
  2308         16  CM-LAST-MONTH-END             PIC XX.
  2309
  2310     12  CM-NOTE-SW                        PIC X.
  2311         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2312         88  CERT-NOTES-PRESENT               VALUE '1'.
  2313         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2314         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2315         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2316         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2317         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2318         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2319     12  CM-COMP-EXCP-SW                   PIC X.
  2320         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2321         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2322     12  CM-INSURED-ADDRESS-SW             PIC X.
  2323         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2324         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2325
  2326*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2327     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL050.cbl
  2328     12  FILLER                            PIC X.
  2329
  2330*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2331     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2332     12  FILLER                            PIC X.
  2333*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2334     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2335
  2336     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2337         88  CERT-ADDED-BATCH                 VALUE ' '.
  2338         88  CERT-ADDED-ONLINE                VALUE '1'.
  2339         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2340         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2341         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2342     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2343         88  CERT-AS-LOADED                   VALUE ' '.
  2344         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2345         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2346         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2347         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2348         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2349         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2350         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2351
  2352     12  CM-ACCOUNT-COMM-PCTS.
  2353         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2354         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2355
  2356     12  CM-USER-FIELD                     PIC X.
  2357     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2358     12  CM-CLP-STATE                      PIC XX.
  2359     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2360     12  CM-USER-RESERVED                  PIC XXX.
  2361     12  FILLER REDEFINES CM-USER-RESERVED.
  2362         16  CM-AH-CLASS-CD                PIC XX.
  2363         16  F                             PIC X.
  2364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL050.cbl
  2366*    COPY ERCMAIL.
  2367******************************************************************
  2368*                                                                *
  2369*                                                                *
  2370*                            ERCMAIL                             *
  2371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2372*                            VMOD=2.003                          *
  2373*                                                                *
  2374*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2375*                                                                *
  2376*   FILE TYPE = VSAM,KSDS                                        *
  2377*   RECORD SIZE = 374   RECFORM = FIX                            *
  2378*                                                                *
  2379*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2380*   ALTERNATE PATH    = NOT USED                                 *
  2381*                                                                *
  2382*   LOG = YES                                                    *
  2383*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2384******************************************************************
  2385*                   C H A N G E   L O G
  2386*
  2387* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2388*-----------------------------------------------------------------
  2389*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2390* EFFECTIVE    NUMBER
  2391*-----------------------------------------------------------------
  2392* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2393* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2394* 111108                   PEMA  ADD CRED BENE ADDR2
  2395******************************************************************
  2396
  2397 01  MAILING-DATA.
  2398     12  MA-RECORD-ID                      PIC XX.
  2399         88  VALID-MA-ID                       VALUE 'MA'.
  2400
  2401     12  MA-CONTROL-PRIMARY.
  2402         16  MA-COMPANY-CD                 PIC X.
  2403         16  MA-CARRIER                    PIC X.
  2404         16  MA-GROUPING.
  2405             20  MA-GROUPING-PREFIX        PIC XXX.
  2406             20  MA-GROUPING-PRIME         PIC XXX.
  2407         16  MA-STATE                      PIC XX.
  2408         16  MA-ACCOUNT.
  2409             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2410             20  MA-ACCOUNT-PRIME          PIC X(6).
  2411         16  MA-CERT-EFF-DT                PIC XX.
  2412         16  MA-CERT-NO.
  2413             20  MA-CERT-PRIME             PIC X(10).
  2414             20  MA-CERT-SFX               PIC X.
  2415
  2416     12  FILLER                            PIC XX.
  2417
  2418     12  MA-ACCESS-CONTROL.
  2419         16  MA-SOURCE-SYSTEM              PIC XX.
  2420             88  MA-FROM-CREDIT                VALUE 'CR'.
  2421             88  MA-FROM-VSI                   VALUE 'VS'.
  2422             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2423             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL050.cbl
  2424         16  MA-RECORD-ADD-DT              PIC XX.
  2425         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2426         16  MA-LAST-MAINT-DT              PIC XX.
  2427         16  MA-LAST-MAINT-BY              PIC XXXX.
  2428         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2429
  2430     12  MA-PROFILE-INFO.
  2431         16  MA-QUALIFY-CODE-1             PIC XX.
  2432         16  MA-QUALIFY-CODE-2             PIC XX.
  2433         16  MA-QUALIFY-CODE-3             PIC XX.
  2434         16  MA-QUALIFY-CODE-4             PIC XX.
  2435         16  MA-QUALIFY-CODE-5             PIC XX.
  2436
  2437         16  MA-INSURED-LAST-NAME          PIC X(15).
  2438         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2439         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2440         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2441         16  MA-INSURED-BIRTH-DT           PIC XX.
  2442         16  MA-INSURED-SEX                PIC X.
  2443             88  MA-SEX-MALE                   VALUE 'M'.
  2444             88  MA-SEX-FEMALE                 VALUE 'F'.
  2445         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2446
  2447         16  MA-ADDRESS-CORRECTED          PIC X.
  2448         16  MA-JOINT-BIRTH-DT             PIC XX.
  2449*        16  FILLER                        PIC X(12).
  2450
  2451         16  MA-ADDRESS-LINE-1             PIC X(30).
  2452         16  MA-ADDRESS-LINE-2             PIC X(30).
  2453         16  MA-CITY-STATE.
  2454             20  MA-CITY                   PIC X(28).
  2455             20  MA-ADDR-STATE             PIC XX.
  2456         16  MA-ZIP.
  2457             20  MA-ZIP-CODE.
  2458                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2459                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2460                 24  FILLER                PIC X(4).
  2461             20  MA-ZIP-PLUS4              PIC X(4).
  2462         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2463             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2464             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2465             20  FILLER                    PIC X(3).
  2466
  2467         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2468
  2469         16  FILLER                        PIC XXX.
  2470*        16  FILLER                        PIC X(10).
  2471
  2472     12  MA-CRED-BENE-INFO.
  2473         16  MA-CRED-BENE-NAME                 PIC X(25).
  2474         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2475         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2476         16  MA-CRED-BENE-CTYST.
  2477             20  MA-CRED-BENE-CITY             PIC X(28).
  2478             20  MA-CRED-BENE-STATE            PIC XX.
  2479         16  MA-CRED-BENE-ZIP.
  2480             20  MA-CB-ZIP-CODE.
  2481                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL050.cbl
  2482                     88  MA-CB-CANADIAN-POST-CODE
  2483                                           VALUE 'A' THRU 'Z'.
  2484                 24  FILLER                    PIC X(4).
  2485             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2486         16  MA-CB-CANADIAN-POSTAL-CODE
  2487                            REDEFINES MA-CRED-BENE-ZIP.
  2488             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2489             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2490             20  FILLER                        PIC X(3).
  2491     12  MA-POST-CARD-MAIL-DATA.
  2492         16  MA-MAIL-DATA OCCURS 7.
  2493             20  MA-MAIL-TYPE              PIC X.
  2494                 88  MA-12MO-MAILING           VALUE '1'.
  2495                 88  MA-EXP-MAILING            VALUE '2'.
  2496             20  MA-MAIL-STATUS            PIC X.
  2497                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2498                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2499                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2500             20  MA-MAIL-DATE              PIC XX.
  2501     12  FILLER                            PIC XX.
  2502     12  FILLER                            PIC XX.
  2503*    12  FILLER                            PIC X(30).
  2504******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL050.cbl
  2506*    COPY ERCPNDM.
  2507******************************************************************
  2508*                                                                *
  2509*                                                                *
  2510*                            ERCPNDM                             *
  2511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2512*                            VMOD=2.003                          *
  2513*                                                                *
  2514*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2515*                                                                *
  2516*   FILE TYPE = VSAM,KSDS                                        *
  2517*   RECORD SIZE = 374   RECFORM = FIX                            *
  2518*                                                                *
  2519*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2520*   ALTERNATE PATH    = NOT USED                                 *
  2521*                                                                *
  2522*   LOG = YES                                                    *
  2523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2524******************************************************************
  2525*                   C H A N G E   L O G
  2526*
  2527* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2528*-----------------------------------------------------------------
  2529*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2530* EFFECTIVE    NUMBER
  2531*-----------------------------------------------------------------
  2532* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2533* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2534* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2535******************************************************************
  2536
  2537 01  PENDING-MAILING-DATA.
  2538     12  PM-RECORD-ID                      PIC XX.
  2539         88  VALID-MA-ID                       VALUE 'PM'.
  2540
  2541     12  PM-CONTROL-PRIMARY.
  2542         16  PM-COMPANY-CD                 PIC X.
  2543         16  PM-ENTRY-BATCH                PIC X(6).
  2544         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2545         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2546
  2547     12  FILLER                            PIC X(14).
  2548
  2549     12  PM-ACCESS-CONTROL.
  2550         16  PM-SOURCE-SYSTEM              PIC XX.
  2551             88  PM-FROM-CREDIT                VALUE 'CR'.
  2552             88  PM-FROM-VSI                   VALUE 'VS'.
  2553             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2554             88  PM-FROM-OTHER                 VALUE 'OT'.
  2555         16  PM-RECORD-ADD-DT              PIC XX.
  2556         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2557         16  PM-LAST-MAINT-DT              PIC XX.
  2558         16  PM-LAST-MAINT-BY              PIC XXXX.
  2559         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2560
  2561     12  PM-PROFILE-INFO.
  2562         16  PM-QUALIFY-CODE-1             PIC XX.
  2563         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL050.cbl
  2564         16  PM-QUALIFY-CODE-3             PIC XX.
  2565         16  PM-QUALIFY-CODE-4             PIC XX.
  2566         16  PM-QUALIFY-CODE-5             PIC XX.
  2567
  2568         16  PM-INSURED-LAST-NAME          PIC X(15).
  2569         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2570         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2571         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2572         16  PM-INSURED-BIRTH-DT           PIC XX.
  2573         16  PM-INSURED-SEX                PIC X.
  2574             88  PM-SEX-MALE                   VALUE 'M'.
  2575             88  PM-SEX-FEMALE                 VALUE 'F'.
  2576         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2577
  2578         16  PM-ADDRESS-CORRECTED          PIC X.
  2579         16  PM-JOINT-BIRTH-DT             PIC XX.
  2580*        16  FILLER                        PIC X(12).
  2581
  2582         16  PM-ADDRESS-LINE-1             PIC X(30).
  2583         16  PM-ADDRESS-LINE-2             PIC X(30).
  2584         16  PM-CITY-STATE.
  2585             20  PM-CITY                   PIC X(28).
  2586             20  PM-STATE                  PIC XX.
  2587         16  PM-ZIP.
  2588             20  PM-ZIP-CODE.
  2589                 24  PM-ZIP-1              PIC X.
  2590                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2591                 24  FILLER                PIC X(4).
  2592             20  PM-ZIP-PLUS4              PIC X(4).
  2593         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2594             20  PM-CAN-POST1              PIC XXX.
  2595             20  PM-CAN-POST2              PIC XXX.
  2596             20  FILLER                    PIC XXX.
  2597
  2598         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2599
  2600         16  FILLER                        PIC X(03).
  2601
  2602     12  PM-CRED-BENE-INFO.
  2603         16  PM-CRED-BENE-NAME             PIC X(25).
  2604         16  PM-CRED-BENE-ADDR             PIC X(30).
  2605         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2606         16  PM-CRED-BENE-CTYST.
  2607             20  PM-CRED-BENE-CITY         PIC X(28).
  2608             20  PM-CRED-BENE-STATE        PIC XX.
  2609         16  PM-CRED-BENE-ZIP.
  2610             20  PM-CB-ZIP-CODE.
  2611                 24  PM-CB-ZIP-1           PIC X.
  2612                     88  PM-CB-CANADIAN-POST-CODE
  2613                                  VALUE 'A' THRU 'Z'.
  2614                 24  FILLER                PIC X(4).
  2615             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2616         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2617             20  PM-CB-CAN-POST1           PIC XXX.
  2618             20  PM-CB-CAN-POST2           PIC XXX.
  2619             20  FILLER                    PIC XXX.
  2620     12  PM-POST-CARD-MAIL-DATA.
  2621         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL050.cbl
  2622             20  PM-MAIL-TYPE              PIC X.
  2623                 88  PM-12MO-MAILING           VALUE '1'.
  2624                 88  PM-EXP-MAILING            VALUE '2'.
  2625             20  PM-MAIL-STATUS            PIC X.
  2626                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2627                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2628                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2629             20  PM-MAIL-DATE              PIC XX.
  2630     12  FILLER                            PIC XX.
  2631     12  FILLER                            PIC X(12).
  2632*    12  FILLER                            PIC X(30).
  2633
  2634******************************************************************
  2635*                                COPY ERCLOFC.
  2636******************************************************************
  2637*                                                                *
  2638*                                                                *
  2639*                            ERCLOFC                             *
  2640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2641*                            VMOD=2.003                          *
  2642*                                                                *
  2643*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2644*                                                                *
  2645*   FILE TYPE = VSAM,KSDS                                        *
  2646*   RECORD SIZE = 670   RECFORM = FIX                            *
  2647*                                                                *
  2648*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2649*                                                                *
  2650*   LOG = YES                                                    *
  2651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2652*                                                                *
  2653******************************************************************
  2654
  2655 01  LOAN-OFFICER-MASTER.
  2656     12  LO-RECORD-ID                PIC XX.
  2657         88  VALID-LO-ID                VALUE 'LO'.
  2658
  2659     12  LO-CONTROL-PRIMARY.
  2660         16  LO-COMPANY-CD           PIC X.
  2661         16  LO-CARRIER              PIC X.
  2662         16  LO-GROUPING.
  2663             20  LO-GROUPING-PREFIX  PIC XXX.
  2664             20  LO-GROUPING-PRIME   PIC XXX.
  2665         16  LO-STATE                PIC XX.
  2666         16  LO-ACCOUNT.
  2667             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2668             20  LO-ACCOUNT-PRIME    PIC X(6).
  2669         16  LO-OFFICER-CODE         PIC X(5).
  2670
  2671     12  LO-OFFICER-NAME             PIC X(30).
  2672
  2673     12  LO-LAST-MAINT-DT            PIC XX.
  2674     12  LO-LAST-USER                PIC X(4).
  2675     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2676
  2677     12  LO-COMP-CONTROL             PIC X.
  2678             88  LO-SHOW-COMP           VALUE 'Y'.
  2679             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL050.cbl
  2680     12  LO-DETAIL-CONTROL           PIC X.
  2681             88  LO-PRINT-DETAIL        VALUE 'D'.
  2682             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2683
  2684     12  LO-SV-CARRIER               PIC X.
  2685     12  LO-SV-GROUPING              PIC X(6).
  2686     12  LO-SV-STATE                 PIC XX.
  2687
  2688     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2689     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2690
  2691     12  LO-OFFICER-INFO.
  2692         16  FILLER OCCURS 12 TIMES.
  2693             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2694             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2695             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2696             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2697             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2698             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2699             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2700             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2701     12  FILLER                      PIC X(198).
  2702******************************************************************
  2703*                                COPY ERCPDEF.
  2704******************************************************************
  2705*                                                                *
  2706*                                                                *
  2707*                            ERCPDEF.                            *
  2708*                                                                *
  2709*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2710*                                                                *
  2711*    FILE TYPE = VSAM,KSDS                                       *
  2712*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2713*                                                                *
  2714*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2715*                                                                *
  2716*    LOG = YES                                                   *
  2717*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2718******************************************************************
  2719 01  PRODUCT-MASTER.
  2720    12  PD-RECORD-ID                 PIC X(02).
  2721        88  VALID-PD-ID                  VALUE 'PD'.
  2722    12  PD-CONTROL-PRIMARY.
  2723        16  PD-COMPANY-CD            PIC X.
  2724        16  PD-STATE                 PIC XX.
  2725        16  PD-PRODUCT-CD            PIC XXX.
  2726        16  PD-FILLER                PIC X(7).
  2727        16  PD-BEN-TYPE              PIC X.
  2728        16  PD-BEN-CODE              PIC XX.
  2729        16  PD-PROD-EXP-DT           PIC XX.
  2730    12  FILLER                       PIC X(50).
  2731    12  PD-PRODUCT-DATA OCCURS 8.
  2732        16  PD-PROD-CODE             PIC X.
  2733            88  PD-PROD-LIFE           VALUE 'L'.
  2734            88  PD-PROD-PROP           VALUE 'P'.
  2735            88  PD-PROD-AH             VALUE 'A'.
  2736            88  PD-PROD-IU             VALUE 'I'.
  2737            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL050.cbl
  2738        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2739        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2740        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2741        16  PD-MAX-TERM              PIC S999        COMP-3.
  2742        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2743        16  FILLER                   PIC X.
  2744        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2745        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2746        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2747        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2748        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2749        16  PD-REC-CRIT-PERIOD       PIC X.
  2750        16  PD-RTW-MOS               PIC 99.
  2751        16  FILLER                   PIC X(5).
  2752    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2753    12  PD-TERM-LIMITS OCCURS 15.
  2754        16  PD-LOW-TERM              PIC S999        COMP-3.
  2755        16  PD-HI-TERM               PIC S999        COMP-3.
  2756*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2757    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2758        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2759        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2760    12  PD-EARN-FACTORS.
  2761        16  FILLER OCCURS 15.
  2762            20  FILLER OCCURS 15.
  2763                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2764    12  PD-PRODUCT-DESC              PIC X(80).
  2765    12  PD-TRUNCATED                 PIC X.
  2766    12  FILLER                       PIC X(59).
  2767    12  PD-MAINT-INFORMATION.
  2768        16  PD-LAST-MAINT-DT         PIC X(02).
  2769        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2770        16  PD-LAST-MAINT-BY         PIC X(04).
  2771*                                COPY ELCSTATE.
  2772******************************************************************
  2773*                                                                *
  2774*                                                                *
  2775*                            ELCSTATE.                           *
  2776*                                                                *
  2777*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2778*                                                                *
  2779*   FILE TYPE = VSAM,KSDS                                        *
  2780*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2781*                                                                *
  2782*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2783*       ALTERNATE INDEX = NONE                                   *
  2784*                                                                *
  2785*   LOG = YES                                                    *
  2786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2787******************************************************************
  2788*                   C H A N G E   L O G
  2789*
  2790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2791*-----------------------------------------------------------------
  2792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2793* EFFECTIVE    NUMBER
  2794*-----------------------------------------------------------------
  2795* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL050.cbl
  2796******************************************************************
  2797*
  2798 01  STATE-FILE.
  2799     12  SF-RECORD-ID                       PIC XX.
  2800         88  VALID-CF-ID                        VALUE 'SF'.
  2801     12  SF-CONTROL-PRIMARY.
  2802         16  SF-COMPANY-ID                  PIC XXX.
  2803         16  SF-CARRIER-CODE                PIC X.
  2804         16  SF-GROUPING                    PIC X(6).
  2805         16  SF-STATE-CODE                  PIC XX.
  2806         16  SF-EXPIRE-DATE                 PIC 9(8).
  2807****************************************************************
  2808*             STATE CONTROLS
  2809****************************************************************
  2810     12  SF-LAST-MAINT-DT                   PIC XX.
  2811     12  SF-LAST-MAINT-BY                   PIC X(4).
  2812     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2813     12  SF-STATE-RT-CONTROLS.
  2814         16  SF-ST-RT-CALC                  PIC X.
  2815     12  SF-ST-TAX-CONTROLS.
  2816         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2817         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2818         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2819     12  SF-ST-REFUND-OPTIONS.
  2820         16  SF-ST-RF-LR-CALC               PIC X.
  2821         16  SF-ST-RF-LL-CALC               PIC X.
  2822         16  SF-ST-RF-LN-CALC               PIC X.
  2823         16  SF-ST-RF-AH-CALC               PIC X.
  2824         16  SF-ST-RF-CP-CALC               PIC X.
  2825     12  SF-ST-UNEARN-PREM-OPTIONS.
  2826         16  SF-ST-LUEP-R78                 PIC X.
  2827         16  SF-ST-LUEP-PRO                 PIC X.
  2828         16  SF-ST-LUEP-ST                  PIC X.
  2829         16  SF-ST-LUEP-DOM                 PIC X.
  2830         16  SF-ST-AUEP-R78                 PIC X.
  2831         16  SF-ST-AUEP-PRO                 PIC X.
  2832         16  SF-ST-AUEP-ST                  PIC X.
  2833         16  SF-ST-AUEP-DOM                 PIC X.
  2834         16  SF-ST-CUEP-R78                 PIC X.
  2835         16  SF-ST-CUEP-PRO                 PIC X.
  2836         16  SF-ST-CUEP-ST                  PIC X.
  2837         16  SF-ST-CUEP-DOM                 PIC X.
  2838     12  SF-ST-EARN-PREM-OPTIONS.
  2839         16  SF-ST-LEP-R78                  PIC X.
  2840         16  SF-ST-LEP-PRO                  PIC X.
  2841         16  SF-ST-LEP-ST                   PIC X.
  2842         16  SF-ST-LEP-DOM                  PIC X.
  2843         16  SF-ST-AEP-R78                  PIC X.
  2844         16  SF-ST-AEP-PRO                  PIC X.
  2845         16  SF-ST-AEP-ST                   PIC X.
  2846         16  SF-ST-AEP-DOM                  PIC X.
  2847         16  SF-ST-CEP-R78                  PIC X.
  2848         16  SF-ST-CEP-PRO                  PIC X.
  2849         16  SF-ST-CEP-ST                   PIC X.
  2850         16  SF-ST-CEP-DOM                  PIC X.
  2851     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL050.cbl
  2853*    COPY ELCCRTT.
  2854******************************************************************
  2855*                                                                *
  2856*                            ELCCRTT.                            *
  2857*                                                                *
  2858*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2859*                                                                *
  2860*   FILE TYPE = VSAM,KSDS                                        *
  2861*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2862*                                                                *
  2863*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2864*                                                                *
  2865*   LOG = YES                                                    *
  2866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2867******************************************************************
  2868*                   C H A N G E   L O G
  2869*
  2870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2871*-----------------------------------------------------------------
  2872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2873* EFFECTIVE    NUMBER
  2874*-----------------------------------------------------------------
  2875* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2876* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2877* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2878******************************************************************
  2879
  2880 01  CERTIFICATE-TRAILERS.
  2881     12  CS-RECORD-ID                      PIC XX.
  2882         88  VALID-CS-ID                      VALUE 'CS'.
  2883
  2884     12  CS-CONTROL-PRIMARY.
  2885         16  CS-COMPANY-CD                 PIC X.
  2886         16  CS-CARRIER                    PIC X.
  2887         16  CS-GROUPING                   PIC X(6).
  2888         16  CS-STATE                      PIC XX.
  2889         16  CS-ACCOUNT                    PIC X(10).
  2890         16  CS-CERT-EFF-DT                PIC XX.
  2891         16  CS-CERT-NO.
  2892             20  CS-CERT-PRIME             PIC X(10).
  2893             20  CS-CERT-SFX               PIC X.
  2894         16  CS-TRAILER-TYPE               PIC X.
  2895             88  COMM-TRLR           VALUE 'A'.
  2896             88  FUTURE-TRLR         VALUE 'B'.
  2897             88  CERT-DATA-TRLR      VALUE 'C'.
  2898
  2899     12  CS-DATA-AREA                      PIC X(516).
  2900
  2901     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2902         16  CS-BANK-COMMISSION-AREA.
  2903             20  CS-BANK-COMMS       OCCURS 10.
  2904                 24  CS-AGT                PIC X(10).
  2905                 24  CS-COM-TYP            PIC X.
  2906                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2907                 24  CS-RECALC-LV-INDIC    PIC X.
  2908                 24  FILLER                PIC X(10).
  2909         16  FILLER                        PIC X(256).
  2910
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL050.cbl
  2911     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2912         16  CS-VIN-NUMBER                 PIC X(17).
  2913         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2914         16  FILLER                        PIC X(498).
  2915******************************************************************
  2916*    COPY ELCCRTO.
  2917******************************************************************
  2918*                                                                *
  2919*                            ELCCRTO.                            *
  2920*                                                                *
  2921*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2922*                                                                *
  2923*   FILE TYPE = VSAM,KSDS                                        *
  2924*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2925*                                                                *
  2926*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2927*                                                                *
  2928*   LOG = YES                                                    *
  2929*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2930******************************************************************
  2931*                   C H A N G E   L O G
  2932*
  2933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2934*-----------------------------------------------------------------
  2935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2936* EFFECTIVE    NUMBER
  2937*-----------------------------------------------------------------
  2938* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2939* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2940* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2941******************************************************************
  2942 01  ORIGINAL-CERTIFICATE.
  2943     12  OC-RECORD-ID                      PIC XX.
  2944         88  VALID-OC-ID                      VALUE 'OC'.
  2945     12  OC-CONTROL-PRIMARY.
  2946         16  OC-COMPANY-CD                 PIC X.
  2947         16  OC-CARRIER                    PIC X.
  2948         16  OC-GROUPING                   PIC X(6).
  2949         16  OC-STATE                      PIC XX.
  2950         16  OC-ACCOUNT                    PIC X(10).
  2951         16  OC-CERT-EFF-DT                PIC XX.
  2952         16  OC-CERT-NO.
  2953             20  OC-CERT-PRIME             PIC X(10).
  2954             20  OC-CERT-SFX               PIC X.
  2955         16  OC-RECORD-TYPE                PIC X.
  2956         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2957     12  OC-LAST-MAINT-DT                  PIC XX.
  2958     12  OC-LAST-MAINT-BY                  PIC X(4).
  2959     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2960     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2961     12  FILLER                            PIC X(49).
  2962     12  OC-ORIG-REC.
  2963         16  OC-INS-LAST-NAME              PIC X(15).
  2964         16  OC-INS-FIRST-NAME             PIC X(10).
  2965         16  OC-INS-MIDDLE-INIT            PIC X.
  2966         16  OC-INS-AGE                    PIC S999     COMP-3.
  2967         16  OC-JNT-LAST-NAME              PIC X(15).
  2968         16  OC-JNT-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL050.cbl
  2969         16  OC-JNT-MIDDLE-INIT            PIC X.
  2970         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2971         16  OC-LF-BENCD                   PIC XX.
  2972         16  OC-LF-TERM                    PIC S999      COMP-3.
  2973         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2974         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2975         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2976         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2977         16  OC-LF-EXP-DT                  PIC XX.
  2978         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2979         16  OC-LF-CANCEL-DT               PIC XX.
  2980         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2981         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2982         16  OC-AH-BENCD                   PIC XX.
  2983         16  OC-AH-TERM                    PIC S999      COMP-3.
  2984         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2985         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2986         16  OC-AH-EXP-DT                  PIC XX.
  2987         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2988         16  OC-AH-CP                      PIC 99.
  2989         16  OC-AH-CANCEL-DT               PIC XX.
  2990         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2991         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2992         16  OC-CRED-BENE-NAME             PIC X(25).
  2993         16  OC-1ST-PMT-DT                 PIC XX.
  2994         16  FILLER                        PIC X(215).
  2995
  2996     12  FILLER                            PIC X(50).
  2997******************************************************************
  2998
  2999*    COPY ELCDATE.
  3000******************************************************************
  3001*                                                                *
  3002*                                                                *
  3003*                            ELCDATE.                            *
  3004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3005*                            VMOD=2.003
  3006*                                                                *
  3007*                                                                *
  3008*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3009*                 LENGTH = 200                                   *
  3010******************************************************************
  3011
  3012 01  DATE-CONVERSION-DATA.
  3013     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3014     12  DC-OPTION-CODE                PIC X.
  3015         88  BIN-TO-GREG                VALUE ' '.
  3016         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3017         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3018         88  YMD-GREG-TO-BIN            VALUE '3'.
  3019         88  MDY-GREG-TO-BIN            VALUE '4'.
  3020         88  JULIAN-TO-BIN              VALUE '5'.
  3021         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3022         88  FIND-CENTURY               VALUE '7'.
  3023         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3024         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3025         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3026         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL050.cbl
  3027         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3028         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3029         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3030         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3031         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3032         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3033         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3034         88  BIN-3-TO-GREG              VALUE 'I'.
  3035         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3036         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3037         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3038         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3039         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3040         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3041         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3042         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3043         88  THREE-CHARACTER-BIN
  3044                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3045         88  GREGORIAN-TO-BIN
  3046                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3047         88  BIN-TO-GREGORIAN
  3048                  VALUES ' ' '1' 'I' '8' 'G'.
  3049         88  JULIAN-TO-BINARY
  3050                  VALUES '5' 'C' 'E' 'F'.
  3051     12  DC-ERROR-CODE                 PIC X.
  3052         88  NO-CONVERSION-ERROR        VALUE ' '.
  3053         88  DATE-CONVERSION-ERROR
  3054                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3055         88  DATE-IS-ZERO               VALUE '1'.
  3056         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3057         88  DATE-IS-INVALID            VALUE '3'.
  3058         88  DATE1-GREATER-DATE2        VALUE '4'.
  3059         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3060         88  DATE-INVALID-OPTION        VALUE '9'.
  3061         88  INVALID-CENTURY            VALUE 'A'.
  3062         88  ONLY-CENTURY               VALUE 'B'.
  3063         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3064         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3065     12  DC-END-OF-MONTH               PIC X.
  3066         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3067     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3068         88  USE-NORMAL-PROCESS         VALUE ' '.
  3069         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3070         88  ADJUST-UP-100-YRS          VALUE '2'.
  3071     12  FILLER                        PIC X.
  3072     12  DC-CONVERSION-DATES.
  3073         16  DC-BIN-DATE-1             PIC XX.
  3074         16  DC-BIN-DATE-2             PIC XX.
  3075         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3076         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3077                       DC-GREG-DATE-1-EDIT.
  3078             20  DC-EDIT1-MONTH        PIC 99.
  3079             20  SLASH1-1              PIC X.
  3080             20  DC-EDIT1-DAY          PIC 99.
  3081             20  SLASH1-2              PIC X.
  3082             20  DC-EDIT1-YEAR         PIC 99.
  3083         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3084         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL050.cbl
  3085                     DC-GREG-DATE-2-EDIT.
  3086             20  DC-EDIT2-MONTH        PIC 99.
  3087             20  SLASH2-1              PIC X.
  3088             20  DC-EDIT2-DAY          PIC 99.
  3089             20  SLASH2-2              PIC X.
  3090             20  DC-EDIT2-YEAR         PIC 99.
  3091         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3092         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3093                     DC-GREG-DATE-1-YMD.
  3094             20  DC-YMD-YEAR           PIC 99.
  3095             20  DC-YMD-MONTH          PIC 99.
  3096             20  DC-YMD-DAY            PIC 99.
  3097         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3098         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3099                      DC-GREG-DATE-1-MDY.
  3100             20  DC-MDY-MONTH          PIC 99.
  3101             20  DC-MDY-DAY            PIC 99.
  3102             20  DC-MDY-YEAR           PIC 99.
  3103         16  DC-GREG-DATE-1-ALPHA.
  3104             20  DC-ALPHA-MONTH        PIC X(10).
  3105             20  DC-ALPHA-DAY          PIC 99.
  3106             20  FILLER                PIC XX.
  3107             20  DC-ALPHA-CENTURY.
  3108                 24 DC-ALPHA-CEN-N     PIC 99.
  3109             20  DC-ALPHA-YEAR         PIC 99.
  3110         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3111         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3112         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3113         16  DC-JULIAN-DATE            PIC 9(05).
  3114         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3115                                       PIC 9(05).
  3116         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3117             20  DC-JULIAN-YEAR        PIC 99.
  3118             20  DC-JULIAN-DAYS        PIC 999.
  3119         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3120         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3121         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3122     12  DATE-CONVERSION-VARIBLES.
  3123         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3124         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3125             20  FILLER                PIC 9(3).
  3126             20  HOLD-CEN-1-CCYY.
  3127                 24  HOLD-CEN-1-CC     PIC 99.
  3128                 24  HOLD-CEN-1-YY     PIC 99.
  3129             20  HOLD-CEN-1-MO         PIC 99.
  3130             20  HOLD-CEN-1-DA         PIC 99.
  3131         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3132             20  HOLD-CEN-1-R-MO       PIC 99.
  3133             20  HOLD-CEN-1-R-DA       PIC 99.
  3134             20  HOLD-CEN-1-R-CCYY.
  3135                 24  HOLD-CEN-1-R-CC   PIC 99.
  3136                 24  HOLD-CEN-1-R-YY   PIC 99.
  3137             20  FILLER                PIC 9(3).
  3138         16  HOLD-CENTURY-1-X.
  3139             20  FILLER                PIC X(3)  VALUE SPACES.
  3140             20  HOLD-CEN-1-X-CCYY.
  3141                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3142                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL050.cbl
  3143             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3144             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3145         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3146             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3147             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3148             20  HOLD-CEN-1-R-X-CCYY.
  3149                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3150                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3151             20  FILLER                PIC XXX.
  3152         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3153         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3154         16  DC-JULIAN-DATE-1          PIC 9(07).
  3155         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3156             20  DC-JULIAN-1-CCYY.
  3157                 24  DC-JULIAN-1-CC    PIC 99.
  3158                 24  DC-JULIAN-1-YR    PIC 99.
  3159             20  DC-JULIAN-DA-1        PIC 999.
  3160         16  DC-JULIAN-DATE-2          PIC 9(07).
  3161         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3162             20  DC-JULIAN-2-CCYY.
  3163                 24  DC-JULIAN-2-CC    PIC 99.
  3164                 24  DC-JULIAN-2-YR    PIC 99.
  3165             20  DC-JULIAN-DA-2        PIC 999.
  3166         16  DC-GREG-DATE-A-EDIT.
  3167             20  DC-EDITA-MONTH        PIC 99.
  3168             20  SLASHA-1              PIC X VALUE '/'.
  3169             20  DC-EDITA-DAY          PIC 99.
  3170             20  SLASHA-2              PIC X VALUE '/'.
  3171             20  DC-EDITA-CCYY.
  3172                 24  DC-EDITA-CENT     PIC 99.
  3173                 24  DC-EDITA-YEAR     PIC 99.
  3174         16  DC-GREG-DATE-B-EDIT.
  3175             20  DC-EDITB-MONTH        PIC 99.
  3176             20  SLASHB-1              PIC X VALUE '/'.
  3177             20  DC-EDITB-DAY          PIC 99.
  3178             20  SLASHB-2              PIC X VALUE '/'.
  3179             20  DC-EDITB-CCYY.
  3180                 24  DC-EDITB-CENT     PIC 99.
  3181                 24  DC-EDITB-YEAR     PIC 99.
  3182         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3183         16  DC-GREG-DATE-CYMD-R REDEFINES
  3184                              DC-GREG-DATE-CYMD.
  3185             20  DC-CYMD-CEN           PIC 99.
  3186             20  DC-CYMD-YEAR          PIC 99.
  3187             20  DC-CYMD-MONTH         PIC 99.
  3188             20  DC-CYMD-DAY           PIC 99.
  3189         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3190         16  DC-GREG-DATE-MDCY-R REDEFINES
  3191                              DC-GREG-DATE-MDCY.
  3192             20  DC-MDCY-MONTH         PIC 99.
  3193             20  DC-MDCY-DAY           PIC 99.
  3194             20  DC-MDCY-CEN           PIC 99.
  3195             20  DC-MDCY-YEAR          PIC 99.
  3196    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3197        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3198    12  DC-EL310-DATE                  PIC X(21).
  3199    12  FILLER                         PIC X(28).
  3200
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL050.cbl
  3202*    COPY ELCCALC.
  3203******************************************************************
  3204*                                                                *
  3205*                           ELCCALC.                            *
  3206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3207*                            VMOD=2.025                          *
  3208*                                                                *
  3209*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3210*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3211*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3212*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3213*                                                                *
  3214*  PASSED TO ELRTRM                                              *
  3215*  -----------------                                             *
  3216*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3217*  ORIGINAL TERM                                                 *
  3218*  BEGINNING DATE                                                *
  3219*  ENDING DATE                                                   *
  3220*  COMPANY I.D.                                                  *
  3221*  ACCOUNT MASTER USER FIELD                                     *
  3222*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3223*  FREE LOOK DAYS                                                *
  3224*                                                                *
  3225*  RETURNED FROM ELRTRM                                          *
  3226*  ---------------------                                         *
  3227*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3228*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3229*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3230*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3231*----------------------------------------------------------------*
  3232*  PASSED TO ELRAMT                                              *
  3233*  ----------------                                              *
  3234*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3235*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3236*  ORIGINAL AMOUNT                                               *
  3237*  ALTERNATE BENEFIT (BALLON)                                    *
  3238*  A.P.R. - NET PAY ONLY                                         *
  3239*  METHOD
  3240*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3241*  COMPANY I.D.                                                  *
  3242*  BENEFIT TYPE                                                  *
  3243*                                                                *
  3244*  RETURNED FROM ELRAMT                                          *
  3245*  --------------------                                          *
  3246*  REMAINING AMOUNT 1 - CURRENT                                  *
  3247*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3248*  REMAINING AMOUNT FACTOR
  3249*----------------------------------------------------------------*
  3250*  PASSED TO ELRESV                                              *
  3251*  -----------------                                             *
  3252*  CERTIFICATE EFFECTIVE DATE                                    *
  3253*  VALUATION DATE                                                *
  3254*  PAID THRU DATE                                                *
  3255*  BENEFIT                                                       *
  3256*  INCURRED DATE                                                 *
  3257*  REPORTED DATE                                                 *
  3258*  ISSUE AGE                                                     *
  3259*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL050.cbl
  3260*  CDT PERCENT                                                   *
  3261*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3262* *CLAIM TYPE (LIFE, A/H)                                        *
  3263* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3264* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3265*                                                                *
  3266*  RETURNED FROM ELRESV                                          *
  3267*  --------------------                                          *
  3268*  CDT TABLE USED                                                *
  3269*  CDT FACTOR USED                                               *
  3270*  PAY TO CURRENT RESERVE                                        *
  3271*  I.B.N.R. - A/H ONLY                                           *
  3272*  FUTURE (ACCRUED) AH ONLY                                      *
  3273*----------------------------------------------------------------*
  3274*  PASSED TO ELRATE                                              *
  3275*  ----------------                                              *
  3276*  CERT ISSUE DATE                                               *
  3277*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3278*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3279*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3280*  STATE CODE (CLIENT DEFINED)                                   *
  3281*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3282*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3283*  DEVIATION CODE                                                *
  3284*  ISSUE AGE                                                     *
  3285*  ORIGINAL BENEFIT AMOUNT                                       *
  3286*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3287*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3288*  BENEFIT KIND (LIFE OR A/H)                                    *
  3289*  A.P.R.                                                        *
  3290*  METHOD
  3291*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3292*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3293*  COMPANY I.D. (3 CHARACTER)                                    *
  3294*  BENEFIT CODE                                                  *
  3295*  BENEFIT OVERRIDE CODE                                         *
  3296*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3297*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3298*  JOINT INDICATOR (CSL ONLY)                                    *
  3299*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3300*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3301*                                                                *
  3302*  RETURNED FROM ELRATE                                          *
  3303*  --------------------                                          *
  3304*  CALCULATED PREMIUM                                            *
  3305*  PREMIUM RATE                                                  *
  3306*  MORTALITY CODE                                                *
  3307*  MAX ATTAINED AGE                                              *
  3308*  MAX AGE                                                       *
  3309*  MAX TERM                                                      *
  3310*  MAX MONTHLY BENEFIT                                           *
  3311*  MAX TOTAL BENIFIT                                             *
  3312*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3313*----------------------------------------------------------------*
  3314*  PASSED TO ELRFND                                              *
  3315*  ----------------                                              *
  3316*  CERT ISSUE DATE                                               *
  3317*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL050.cbl
  3318*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3319*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3320*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3321*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3322*  STATE CODE (CLIENT DEFINED)                                   *
  3323*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3324*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3325*  DEVIATION CODE                                                *
  3326*  ISSUE AGE                                                     *
  3327*  ORIGINAL BENEFIT AMOUNT                                       *
  3328*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3329*  PROCESS TYPE (CANCEL)                                         *
  3330*  BENEFIT KIND (LIFE OR A/H)                                    *
  3331*  A.P.R.                                                        *
  3332*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3333*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3334*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3335*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3336*  COMPANY I.D. (3 CHARACTER)                                    *
  3337*  BENEFIT CODE                                                  *
  3338*  BENEFIT OVERRIDE CODE                                         *
  3339*                                                                *
  3340*  RETURNED FROM ELRFND                                          *
  3341*  --------------------                                          *
  3342*  CALCULATED REFUND                                             *
  3343*----------------------------------------------------------------*
  3344*  PASSED TO ELEARN                                              *
  3345*  ----------------                                              *
  3346*  CERT ISSUE DATE                                               *
  3347*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3348*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3349*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3350*  STATE CODE (CLIENT DEFINED)                                   *
  3351*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3352*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3353*  DEVIATION CODE                                                *
  3354*  ISSUE AGE                                                     *
  3355*  ORIGINAL BENEFIT AMOUNT                                       *
  3356*  BENEFIT KIND (LIFE OR A/H)                                    *
  3357*  A.P.R.                                                        *
  3358*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3359*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3360*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3361*  COMPANY I.D. (3 CHARACTER)                                    *
  3362*  BENEFIT CODE                                                  *
  3363*  BENEFIT OVERRIDE CODE                                         *
  3364*                                                                *
  3365*  RETURNED FROM ELEARN                                          *
  3366*  --------------------                                          *
  3367*  INDICATED  EARNINGS                                           *
  3368*----------------------------------------------------------------*
  3369*                 LENGTH = 450                                   *
  3370*                                                                *
  3371******************************************************************
  3372******************************************************************
  3373*                   C H A N G E   L O G
  3374*
  3375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL050.cbl
  3376*-----------------------------------------------------------------
  3377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3378* EFFECTIVE    NUMBER
  3379*-----------------------------------------------------------------
  3380* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3381* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3382* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3383* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3384* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3385* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3386* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3387* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3388* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3389******************************************************************
  3390
  3391 01  CALCULATION-PASS-AREA.
  3392     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3393                                     COMP.
  3394
  3395     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3396       88  NO-CP-ERROR                             VALUE ZERO.
  3397       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3398                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3399       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3400       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3401       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3402       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3403       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3404       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3405       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3406       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3407       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3408       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3409       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3410       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3411       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3412       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3413       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3414       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3415       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3416
  3417     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3418       88  NO-CP-ERROR-2                           VALUE ZERO.
  3419***********************  INPUT AREAS ****************************
  3420
  3421     12  CP-CALCULATION-AREA.
  3422         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3423         16  CP-CERT-EFF-DT        PIC XX.
  3424         16  CP-VALUATION-DT       PIC XX.
  3425         16  CP-PAID-THRU-DT       PIC XX.
  3426         16  CP-BENEFIT-TYPE       PIC X.
  3427           88  CP-AH                               VALUE 'A' 'D'
  3428                                                   'I' 'U'.
  3429           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3430           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3431         16  CP-INCURRED-DT        PIC XX.
  3432         16  CP-REPORTED-DT        PIC XX.
  3433         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL050.cbl
  3434         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3435         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3436                                     COMP-3.
  3437         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3438                                     COMP-3.
  3439         16  CP-CDT-METHOD         PIC X.
  3440           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3441           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3442           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3443         16  CP-CLAIM-TYPE         PIC X.
  3444           88  CP-AH-CLAIM                         VALUE 'A'.
  3445           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3446         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3447                                     COMP-3.
  3448         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3449                                     COMP-3.
  3450         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3451                                     COMP-3.
  3452         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3453                                     COMP-3.
  3454         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3455                                     COMP-3.
  3456         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3457                                     COMP-3.
  3458         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3459                                     COMP-3.
  3460         16  CP-REM-TERM-METHOD    PIC X.
  3461           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3462           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3463           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3464           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3465           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3466           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3467           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3468         16  CP-EARNING-METHOD     PIC X.
  3469           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3470           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3471           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3472           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3473           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3474           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3475           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3476           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3477           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3478           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3479           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3480           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3481           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3482           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3483         16  CP-PROCESS-TYPE       PIC X.
  3484           88  CP-CLAIM                            VALUE '1'.
  3485           88  CP-CANCEL                           VALUE '2'.
  3486           88  CP-ISSUE                            VALUE '3'.
  3487         16  CP-SPECIAL-CALC-CD    PIC X.
  3488           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3489           88  CP-1-MTH-INTEREST               VALUE ' '.
  3490           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3491           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL050.cbl
  3492           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3493           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3494           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3495           88  CP-FARM-PLAN                    VALUE 'F'.
  3496           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3497           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3498           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3499           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3500           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3501           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3502           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3503           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3504           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3505           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3506                                                     'W' 'X'.
  3507           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3508           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3509           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3510           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3511           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3512           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3513           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3514           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3515           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3516           88  CP-CSL-METH-1                   VALUE '5'.
  3517           88  CP-CSL-METH-2                   VALUE '6'.
  3518           88  CP-CSL-METH-3                   VALUE '7'.
  3519           88  CP-CSL-METH-4                   VALUE '8'.
  3520
  3521         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3524         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3525         16  CP-STATE              PIC XX          VALUE SPACE.
  3526         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3527         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3528           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3529               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3530         16  CP-R78-OPTION         PIC X.
  3531           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3532           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3533
  3534         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3535         16  CP-IBNR-RESERVE-SW    PIC X.
  3536         16  CP-CLAIM-STATUS       PIC X.
  3537         16  CP-RATE-FILE          PIC X.
  3538         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3539                                     COMP-3.
  3540
  3541         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3542         16  CP-AH-OVERRIDE-CODE   PIC X.
  3543
  3544         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3547                                   PIC S9(5)V99 COMP-3.
  3548         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3549                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL050.cbl
  3550         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3553                                     COMP-3.
  3554         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3555                                  PIC S9(7)V99 COMP-3.
  3556
  3557         16  CP-PAID-FROM-DATE     PIC X(02).
  3558         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3559         16  CP-EXT-DAYS-CALC      PIC X.
  3560           88  CP-EXT-NO-CHG                   VALUE ' '.
  3561           88  CP-EXT-CHG-LF                   VALUE '1'.
  3562           88  CP-EXT-CHG-AH                   VALUE '2'.
  3563           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3564         16  CP-DOMICILE-STATE     PIC XX.
  3565         16  CP-CARRIER            PIC X.
  3566         16  CP-REIN-FLAG          PIC X.
  3567         16  CP-REM-TRM-CALC-OPTION PIC X.
  3568           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3569                      '2' '3' '4' '5'.
  3570           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3571           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3572           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3573           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3574           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3575           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3576           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3577           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3578         16  CP-SIG-SWITCH         PIC X.
  3579         16  CP-RATING-METHOD      PIC X.
  3580           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3581           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3582           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3583           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3584           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3585           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3586           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3587           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3588           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3589         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3590                                     COMP-3.
  3591         16  CP-BEN-CATEGORY       PIC X.
  3592         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3593         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3594                                   PIC S99V9(5) COMP-3.
  3595         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3596         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3597                                   PIC S99V9(5) COMP-3.
  3598         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3599         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3600         16  CP-EXPIRE-DT          PIC XX.
  3601         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3602         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3603         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3604         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3605         16  CP-DDF-SPEC-CALC      PIC X.
  3606             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3607             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL050.cbl
  3608         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3609         16  CP-CANCEL-REASON      PIC X.
  3610         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3611         16  CP-PMT-MODE           PIC X.
  3612         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3613         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3614         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3615         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3616         16  FILLER                PIC X.
  3617
  3618***************    OUTPUT FROM ELRESV   ************************
  3619
  3620         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3621
  3622         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3623                                     COMP-3.
  3624         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3625                                     COMP-3.
  3626         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3627                                     COMP-3.
  3628         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3629                                     COMP-3.
  3630         16  FILLER                PIC X(09).
  3631***************    OUTPUT FROM ELRTRM   *************************
  3632
  3633         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3636                                     COMP-3.
  3637         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3638                                     COMP-3.
  3639         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3640                                     COMP-3.
  3641         16  FILLER                PIC X(12).
  3642
  3643***************    OUTPUT FROM ELRAMT   *************************
  3644
  3645         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3648                                     COMP-3.
  3649         16  FILLER                PIC X(12).
  3650
  3651***************    OUTPUT FROM ELRATE   *************************
  3652
  3653         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-MORTALITY-CODE     PIC X(4).
  3658         16  CP-RATE-EDIT-FLAG     PIC X.
  3659             88  CP-RATES-NEED-APR                  VALUE '1'.
  3660         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3663         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3664         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3665                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL050.cbl
  3666         16  FILLER                PIC X(07).
  3667
  3668***************    OUTPUT FROM ELRFND   *************************
  3669
  3670         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-REFUND-TYPE-USED   PIC X.
  3673           88  CP-R-AS-R78                         VALUE '1'.
  3674           88  CP-R-AS-PRORATA                     VALUE '2'.
  3675           88  CP-R-AS-CALIF                       VALUE '3'.
  3676           88  CP-R-AS-TEXAS                       VALUE '4'.
  3677           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3678           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3679           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3680           88  CP-R-AS-MEAN                        VALUE '8'.
  3681           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3682           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3683           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3684           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3685           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3686           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3687         16  FILLER                PIC X(12).
  3688
  3689***************    OUTPUT FROM ELEARN   *************************
  3690
  3691         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3702                                     COMP-3.
  3703         16  CP-EARNING-TYPE-USED  PIC X.
  3704           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3705           88  CP-E-AS-R78                         VALUE '1'.
  3706           88  CP-E-AS-PRORATA                     VALUE '2'.
  3707           88  CP-E-AS-TEXAS                       VALUE '4'.
  3708           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3709           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3710           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3711           88  CP-E-AS-MEAN                        VALUE '8'.
  3712           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3713         16  FILLER                PIC X(12).
  3714
  3715***************    OUTPUT FROM ELPMNT   *************************
  3716
  3717         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  FILLER                PIC X(12).
  3722
  3723***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL050.cbl
  3724         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3737             88  OPEN-RATE-FILE                   VALUE 'O'.
  3738             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3739             88  IO-ERROR                         VALUE 'E'.
  3740
  3741         16  CP-FIRST-PAY-DATE     PIC XX.
  3742
  3743         16  CP-JOINT-INDICATOR    PIC X.
  3744
  3745         16  CP-RESERVE-REMAINING-TERM
  3746                                   PIC S9(4)V9    VALUE ZERO
  3747                                     COMP-3.
  3748
  3749         16  CP-INSURED-BIRTH-DT   PIC XX.
  3750
  3751         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3752                                     COMP-3.
  3753
  3754         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3755                                     COMP-3.
  3756
  3757         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3758                                     COMP-3.
  3759
  3760         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3761                                     COMP-3.
  3762
  3763         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3764                                     COMP-3.
  3765
  3766         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3767                                     COMP-3.
  3768
  3769         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3770                                     COMP-3.
  3771
  3772         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3773             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3774
  3775         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3780         16  FILLER                PIC X(15).
  3781******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL050.cbl
  3783******************************************************************
  3784*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3785*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3786*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3787*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3788*** MODIFICATION.                                              ***
  3789*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3790*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3791******************************************************************
  3792*    COPY ERCPNDB.
  3793******************************************************************
  3794*                                                                *
  3795*                                                                *
  3796*                            ERCPNDB.                            *
  3797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3798*                            VMOD=2.025                          *
  3799*                                                                *
  3800*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3801*                                                                *
  3802******************************************************************
  3803*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3804*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3805******************************************************************
  3806*                                                                *
  3807*                                                                *
  3808*   FILE TYPE = VSAM,KSDS                                        *
  3809*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3810*                                                                *
  3811*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3812*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3813*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3814*                                                 RKP=13,LEN=36  *
  3815*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3816*                                      AND CHG-SEQ.)             *
  3817*                                                RKP=49,LEN=11   *
  3818*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3819*                                      AND CHG-SEQ.)             *
  3820*                                                RKP=60,LEN=15   *
  3821*                                                                *
  3822*   LOG = NO                                                     *
  3823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3824******************************************************************
  3825******************************************************************
  3826*                   C H A N G E   L O G
  3827*
  3828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3829*-----------------------------------------------------------------
  3830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3831* EFFECTIVE    NUMBER
  3832*-----------------------------------------------------------------
  3833* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3834* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3835* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3836* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3837* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3838* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3839* 032306                   PEMA  ADD BOW LOAN NUMBER
  3840* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL050.cbl
  3841* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3842* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3843* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3844* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3845* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3846* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3847* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3848******************************************************************
  3849
  3850 01  PENDING-BUSINESS.
  3851     12  PB-RECORD-ID                     PIC XX.
  3852         88  VALID-PB-ID                        VALUE 'PB'.
  3853
  3854     12  PB-CONTROL-PRIMARY.
  3855         16  PB-COMPANY-CD                PIC X.
  3856         16  PB-ENTRY-BATCH               PIC X(6).
  3857         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3858         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3859
  3860     12  PB-CONTROL-BY-ACCOUNT.
  3861         16  PB-COMPANY-CD-A1             PIC X.
  3862         16  PB-CARRIER                   PIC X.
  3863         16  PB-GROUPING.
  3864             20  PB-GROUPING-PREFIX       PIC XXX.
  3865             20  PB-GROUPING-PRIME        PIC XXX.
  3866         16  PB-STATE                     PIC XX.
  3867         16  PB-ACCOUNT.
  3868             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3869             20  PB-ACCOUNT-PRIME         PIC X(6).
  3870         16  PB-CERT-EFF-DT               PIC XX.
  3871         16  PB-CERT-NO.
  3872             20  PB-CERT-PRIME            PIC X(10).
  3873             20  PB-CERT-SFX              PIC X.
  3874         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3875
  3876         16  PB-RECORD-TYPE               PIC X.
  3877             88  PB-MAILING-DATA                VALUE '0'.
  3878             88  PB-ISSUE                       VALUE '1'.
  3879             88  PB-CANCELLATION                VALUE '2'.
  3880             88  PB-BATCH-TRAILER               VALUE '9'.
  3881
  3882     12  PB-CONTROL-BY-ORIG-BATCH.
  3883         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3884         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3885         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3886         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3887
  3888     12  PB-CONTROL-BY-CSR.
  3889         16  PB-CSR-COMPANY-CD            PIC X.
  3890         16  PB-CSR-ID                    PIC X(4).
  3891         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3892         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3893         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3894******************************************************************
  3895*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3896******************************************************************
  3897
  3898     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL050.cbl
  3899     12  PB-LAST-MAINT-BY                 PIC X(4).
  3900     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3901
  3902     12  PB-RECORD-BODY                   PIC X(375).
  3903
  3904     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3905         16  PB-CERT-ORIGIN               PIC X.
  3906             88  CLASIC-CREATED-CERT         VALUE '1'.
  3907         16  PB-I-NAME.
  3908             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3909             20  PB-I-INSURED-FIRST-NAME.
  3910                 24  PB-I-INSURED-1ST-INIT PIC X.
  3911                 24  FILLER                PIC X(9).
  3912             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3913         16  PB-I-AGE                     PIC S99   COMP-3.
  3914         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3915         16  PB-I-BIRTHDAY                PIC XX.
  3916         16  PB-I-INSURED-SEX             PIC X.
  3917             88  PB-SEX-MALE     VALUE 'M'.
  3918             88  PB-SEX-FEMALE   VALUE 'F'.
  3919
  3920         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3921         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3922         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3923         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3924         16  PB-I-SKIP-CODE               PIC X.
  3925             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3926             88  PB-SKIP-JULY              VALUE '1'.
  3927             88  PB-SKIP-AUGUST            VALUE '2'.
  3928             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3929             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3930             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3931             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3932             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3933             88  PB-SKIP-JUNE              VALUE '8'.
  3934             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3935             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3936             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3937         16  PB-I-TERM-TYPE               PIC X.
  3938             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3939             88  PB-PAID-WEEKLY            VALUE 'W'.
  3940             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3941             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3942             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3943         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3944         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3945         16  PB-I-DATA-ENTRY-SW           PIC X.
  3946             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3947             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3948             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3949             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3950         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3951         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3952*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3953         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3954         16  FILLER                       PIC X.
  3955
  3956         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL050.cbl
  3957             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3958             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3959                                                   '90' THRU '99'.
  3960         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3961                                          PIC XX.
  3962         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3963         16  PB-I-AMOUNT-FINANCED REDEFINES
  3964                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3965         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3966         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3967                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3968         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3969         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3970         16  PB-I-CLP-AMOUNT REDEFINES
  3971                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3972         16  PB-I-LF-CALC-FLAG            PIC X.
  3973             88 PB-COMP-LF-PREM               VALUE '?'.
  3974         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3975         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3976         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3977         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3978         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3979         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3980         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3981         16  PB-I-LF-ABBR                 PIC XXX.
  3982         16  PB-I-LF-INPUT-CD             PIC XX.
  3983
  3984         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3985             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3986             88  PB-INVALID-AH               VALUE '  ' '00'
  3987                                                   '90' THRU '99'.
  3988         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3989         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3990         16  PB-I-AH-CALC-FLAG            PIC X.
  3991             88 PB-COMP-AH-PREM                  VALUE '?'.
  3992         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3993         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3994         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3995         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3996         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3997         16  PB-I-AH-ABBR                 PIC XXX.
  3998         16  PB-I-AH-INPUT-CD             PIC XXX.
  3999
  4000         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4001         16  PB-I-REIN-TABLE              PIC XXX.
  4002         16  PB-I-BUSINESS-TYPE           PIC 99.
  4003         16  PB-I-INDV-GRP-CD             PIC X.
  4004         16  PB-I-MORT-CODE.
  4005             20  PB-I-TABLE               PIC X.
  4006             20  PB-I-INTEREST            PIC XX.
  4007             20  PB-I-MORT-TYP            PIC X.
  4008         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4009         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4010         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4011         16  PB-I-INDV-GRP-OVRD           PIC X.
  4012         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4013         16  PB-I-SIG-SW                  PIC X.
  4014             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL050.cbl
  4015         16  PB-I-RATE-CLASS              PIC XX.
  4016         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4017         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4018         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4019         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4020         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4021         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4022         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4023         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4024         16  PB-I-OB-FLAG                 PIC X.
  4025             88  PB-I-OB                      VALUE 'B'.
  4026             88  PB-I-SUMMARY                 VALUE 'Z'.
  4027         16  PB-I-ENTRY-STATUS            PIC X.
  4028             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4029                                              'M' '5' '9' '2'.
  4030             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4031             88  PB-I-POLICY-PENDING          VALUE '2'.
  4032             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4033             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4034             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4035             88  PB-I-REIN-ONLY               VALUE '9'.
  4036             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4037             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4038             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4039             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4040         16  PB-I-INT-CODE                PIC X.
  4041             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4042             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4043         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4044         16  PB-I-SOC-SEC-NO              PIC X(11).
  4045         16  PB-I-MEMBER-NO               PIC X(12).
  4046         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4047*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4048         16  PB-I-OLD-LOF                 PIC XXX.
  4049         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4050         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4051         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4052         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4053         16  PB-I-LIFE-INDICATOR          PIC X.
  4054             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4055         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4056         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4057                                          PIC S9(5)V99    COMP-3.
  4058         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4059             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4060             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4061         16  PB-I-1ST-PMT-DT              PIC XX.
  4062         16  PB-I-JOINT-INSURED.
  4063             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4064             20 PB-I-JOINT-FIRST-NAME.
  4065                24  PB-I-JOINT-FIRST-INIT PIC X.
  4066                24  FILLER                PIC X(9).
  4067             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4068*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4069         16  PB-I-BENEFICIARY-NAME.
  4070             20  PB-I-BANK-NUMBER         PIC X(10).
  4071             20  FILLER                   PIC X(15).
  4072         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL050.cbl
  4073         16  PB-I-REFERENCE               PIC X(12).
  4074         16  FILLER REDEFINES PB-I-REFERENCE.
  4075             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4076             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4077             20  PB-I-CLP-STATE           PIC XX.
  4078         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4079             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4080             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4081             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4082         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4083         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4084         16  PB-I-RESIDENT-STATE          PIC XX.
  4085         16  PB-I-RATE-CODE               PIC X(4).
  4086         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4087         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4088         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4089         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4090         16  PB-I-BANK-NOCHRGB            PIC 99.
  4091         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4092         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4093
  4094     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4095         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4096             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4097         16  PB-C-CANCEL-ORIGIN           PIC X.
  4098             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4099         16  PB-C-LF-CANCEL-DT            PIC XX.
  4100         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4101         16  PB-C-LF-CALC-REQ             PIC X.
  4102             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4103         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4104         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4105         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4106             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4107         16  PB-C-AH-CANCEL-DT            PIC XX.
  4108         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4109         16  PB-C-AH-CALC-REQ             PIC X.
  4110             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4111         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4112         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4113         16  PB-C-LAST-NAME               PIC X(15).
  4114         16  PB-C-REFUND-SW               PIC X.
  4115             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4116             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4117         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4118         16  PB-C-PAYEE-CODE              PIC X(6).
  4119         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4120         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4121         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4122         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4123         16  PB-C-REFERENCE               PIC X(12).
  4124         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4125         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4126         16  PB-C-POST-CARD-IND           PIC X.
  4127         16  PB-C-CANCEL-REASON           PIC X.
  4128         16  PB-C-REF-INTERFACE-SW        PIC X.
  4129         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4130         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL050.cbl
  4131         16  FILLER                       PIC X(01).
  4132*        16  FILLER                       PIC X(18).
  4133         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4134*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4135         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4136         16  PB-CANCELED-CERT-DATA.
  4137             20  PB-CI-INSURED-NAME.
  4138                 24  PB-CI-LAST-NAME      PIC X(15).
  4139                 24  PB-CI-INITIALS       PIC XX.
  4140             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4141             20  PB-CI-INSURED-SEX        PIC X.
  4142             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4143             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4144             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4145             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4146             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4147             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4148             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4149             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4150             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4151             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4152             20  PB-CI-RATE-CLASS         PIC XX.
  4153             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4154             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4155             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4156             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4157             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4158             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4159             20  PB-CI-LF-ABBR            PIC X(3).
  4160             20  PB-CI-AH-ABBR            PIC X(3).
  4161             20  PB-CI-OB-FLAG            PIC X.
  4162                 88  PB-CI-OB                VALUE 'B'.
  4163             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4164                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4165                                           'M' '4' '5' '9' '2'.
  4166                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4167                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4168                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4169                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4170                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4171                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4172                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4173                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4174                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4175                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4176                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4177                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4178             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4179                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4180                                           'M' '4' '5' '9' '2'.
  4181                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4182                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4183                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4184                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4185                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4186                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4187                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4188                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL050.cbl
  4189                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4190                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4191                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4192                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4193             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4194             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4195             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4196             20  PB-CI-MEMBER-NO          PIC X(12).
  4197             20  PB-CI-INT-CODE           PIC X.
  4198                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4199                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4200             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4201             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4202             20  PB-CI-COMP-EXCP-SW       PIC X.
  4203                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4204                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4205             20  PB-CI-ENTRY-STATUS       PIC X.
  4206             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4207             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4208             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4209             20  PB-CI-DEATH-DT           PIC XX.
  4210             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4211             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4212             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4213             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4214             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4215             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4216             20  PB-CI-ENTRY-DT              PIC XX.
  4217             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4218             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4219             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4220             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4221             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4222             20  PB-CI-OLD-LOF               PIC XXX.
  4223*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4224             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4225             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4226             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4227             20  PB-CI-INDV-GRP-CD           PIC X.
  4228             20  PB-CI-BENEFICIARY-NAME.
  4229                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4230                 24  FILLER                  PIC X(15).
  4231             20  PB-CI-NOTE-SW               PIC X.
  4232             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4233             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4234             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4235             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4236             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4237             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4238             20  PB-CI-FIRST-NAME            PIC X(10).
  4239             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4240
  4241         16  FILLER                       PIC X(13).
  4242*032306  16  FILLER                       PIC X(27).
  4243*        16  FILLER                       PIC X(46).
  4244
  4245     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4246         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL050.cbl
  4247         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4248         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4249         16  PB-M-INSURED-MID-INIT        PIC X.
  4250         16  PB-M-INSURED-AGE             PIC 99.
  4251         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4252         16  PB-M-INSURED-SEX             PIC X.
  4253         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4254         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4255         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4256         16  PB-M-INSURED-CITY-STATE.
  4257             20  PB-M-INSURED-CITY        PIC X(28).
  4258             20  PB-M-INSURED-STATE       PIC XX.
  4259         16  PB-M-INSURED-ZIP-CODE.
  4260             20  PB-M-INSURED-ZIP-PRIME.
  4261                 24  PB-M-INSURED-ZIP-1   PIC X.
  4262                     88  PB-M-CANADIAN-POST-CODE
  4263                                             VALUE 'A' THRU 'Z'.
  4264                 24  FILLER               PIC X(4).
  4265             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4266         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4267                                        PB-M-INSURED-ZIP-CODE.
  4268             20  PM-M-INS-CAN-POST1       PIC XXX.
  4269             20  PM-M-INS-CAN-POST2       PIC XXX.
  4270             20  FILLER                   PIC XXX.
  4271         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4272         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4273         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4274         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4275         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4276         16  PB-M-CRED-BENE-CITYST.
  4277             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4278             20  PB-M-CRED-BENE-STATE     PIC XX.
  4279         16  FILLER                       PIC X(92).
  4280
  4281     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4282         16  FILLER                       PIC X(10).
  4283         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4284         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4285         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4286         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4287         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4288         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4289         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4290         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4291         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4292         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4293         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4294         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4295         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4296         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4297         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4298         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4299         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4300         16  PB-ACCOUNT-NAME              PIC X(30).
  4301         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4302         16  PB-REFERENCE                 PIC X(12).
  4303         16  PB-B-RECEIVED-DT             PIC XX.
  4304         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL050.cbl
  4305
  4306     12  PB-RECORD-STATUS.
  4307         16  PB-CREDIT-SELECT-DT          PIC XX.
  4308         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4309         16  PB-BILLED-DT                 PIC XX.
  4310         16  PB-BILLING-STATUS            PIC X.
  4311             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4312             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4313             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4314         16  PB-RECORD-BILL               PIC X.
  4315             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4316             88  PB-RECORD-RETURNED           VALUE 'R'.
  4317             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4318             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4319             88  PB-OVERRIDE-AH               VALUE 'A'.
  4320             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4321         16  PB-BATCH-ENTRY               PIC X.
  4322             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4323             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4324             88  PB-REISSUED-CERT             VALUE 'E'.
  4325             88  PB-MONTHLY-CERT              VALUE 'M'.
  4326             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4327             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4328             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4329         16  PB-FORCE-CODE                PIC X.
  4330             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4331             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4332             88  PB-CANCEL-FORCE              VALUE '8'.
  4333             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4334             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4335             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4336             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4337             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4338             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4339             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4340         16  PB-FATAL-FLAG                PIC X.
  4341             88  PB-FATAL-ERRORS              VALUE 'X'.
  4342         16  PB-FORCE-ER-CD               PIC X.
  4343             88  PB-FORCE-ERRORS              VALUE 'F'.
  4344             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4345         16  PB-WARN-ER-CD                PIC X.
  4346             88  PB-WARNING-ERRORS            VALUE 'W'.
  4347         16  FILLER                       PIC X.
  4348         16  PB-OUT-BAL-CD                PIC X.
  4349             88  PB-OUT-OF-BAL                VALUE 'O'.
  4350         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4351         16  PB-AH-OVERRIDE-L1            PIC X.
  4352         16  PB-INPUT-DT                  PIC XX.
  4353         16  PB-INPUT-BY                  PIC X(4).
  4354         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4355         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4356         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4357         16  PB-LF-EARNING-METHOD         PIC X.
  4358         16  PB-AH-EARNING-METHOD         PIC X.
  4359         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4360         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4361         16  PB-REIN-CD                   PIC XXX.
  4362         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL050.cbl
  4363         16  PB-AH-REFUND-TYPE            PIC X.
  4364         16  PB-ACCT-EFF-DT               PIC XX.
  4365         16  PB-ACCT-EXP-DT               PIC XX.
  4366         16  PB-COMPANY-ID                PIC X(3).
  4367         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4368         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4369         16  PB-SV-CARRIER                PIC X.
  4370         16  PB-SV-GROUPING               PIC X(6).
  4371         16  PB-SV-STATE                  PIC XX.
  4372         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4373         16  PB-GA-BILLING-INFO.
  4374             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4375                                          PIC XX.
  4376         16  PB-SV-REMIT-TO  REDEFINES
  4377             PB-GA-BILLING-INFO           PIC X(10).
  4378         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4379         16  PB-I-LOAN-OFFICER            PIC X(5).
  4380         16  PB-I-VIN                     PIC X(17).
  4381
  4382         16  FILLER                       PIC X(04).
  4383         16  IMNET-BYPASS-SW              PIC X.
  4384
  4385******************************************************************
  4386*                COMMON EDIT ERRORS                              *
  4387******************************************************************
  4388
  4389     12  PB-COMMON-ERRORS.
  4390         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4391                                           PIC S9(4)     COMP.
  4392
  4393******************************************************************
  4394
  4395* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4396*    COPY ELC50W1.
  4397******************************************************************
  4398*                                                                *
  4399*                                                                *
  4400*                             ELC50W1                            *
  4401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4402*                            VMOD=2.004                          *
  4403*                                                                *
  4404*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4405*                                                                *
  4406*                                                                *
  4407******************************************************************
  4408
  4409     12  WK-WORK-AREA.
  4410         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4411         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4412         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4413         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4414         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4415         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4416         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4417         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4418         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4419         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4420         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL050.cbl
  4421         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4422         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4423         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4424         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4425         16  WK-CREDIT-EDIT-CONTROLS.
  4426             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4427             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4428             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4429             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4430             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4431             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4432         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4433         16  WK-SAVE-REIN-DATA.
  4434             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4435             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4436             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4437         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4438             88  ENTRY-FROM-EL6311       VALUE '6'.
  4439         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4440         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4441     12  WK-RECORD-ADDRESSES.
  4442         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4443         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4444         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4445         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4446         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4447         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4448         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4449         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4450     12  WK-OVER-SHORT-AREA.
  4451         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4452         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4453         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4454             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4455         16  FILLER                   PIC X(5) VALUE SPACES.
  4456
  4457*    COPY ELCEDITC.
  4458******************************************************************
  4459*                                                                *
  4460*                                                                *
  4461*                            ELCEDITC                            *
  4462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4463*                            VMOD=2.012                          *
  4464*                                                                *
  4465*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4466*                     EL6313, EL050 AND EL517.                   *
  4467*                                                                *
  4468******************************************************************
  4469******************************************************************
  4470*                   C H A N G E   L O G
  4471*
  4472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4473*-----------------------------------------------------------------
  4474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4475* EFFECTIVE    NUMBER
  4476*-----------------------------------------------------------------
  4477* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4478******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL050.cbl
  4479
  4480     12  EDIT-CRITERIA-DATA.
  4481         16  EC-CO-MONTH-END-DT       PIC XX.
  4482         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4483         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4484         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4485         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4486         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4487         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4488         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4489         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4490         16  EC-CO-REM-TERM-CALC      PIC X.
  4491               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4492               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4493               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4494               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4495
  4496         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4497               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4498               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4499               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4500               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4501               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4502               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4503               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4504               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4505               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4506               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4507
  4508         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4509               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4510               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4511               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4512               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4513               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4514               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4515               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4516               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4517
  4518         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4519                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4520                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4521
  4522         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4523                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4524                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4525                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4526                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4527                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4528                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4529                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4530                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4531
  4532         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4533               88  EC-BR-REDUCING                   VALUE 'R'.
  4534               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4535
  4536         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL050.cbl
  4537         16  EC-BR-LF-DESC             PIC X(10).
  4538         16  EC-BR-AH-DESC             PIC X(10).
  4539         16  EC-BR-LF-COMMENT          PIC X(10).
  4540         16  EC-BR-AH-COMMENT          PIC X(10).
  4541
  4542         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4543               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4544               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4545               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4546               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4547
  4548         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4549               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4550               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4551               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4552               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4553
  4554         16  EC-BR-LF-REFUND-CALC      PIC X.
  4555                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4556                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4557                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4558                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4559                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4560                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4561                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4562
  4563         16  EC-BR-AH-REFUND-CALC      PIC X.
  4564                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4565                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4566                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4567                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4568                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4569                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4570                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4571                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4572
  4573         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4574                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4575                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4576                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4577
  4578         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4579                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4580                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4581                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4582
  4583         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4584         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4585         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4586         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4587
  4588         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4589         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4590                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4591                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4592                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4593                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4594
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL050.cbl
  4595         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4596               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4597               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4598               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4599               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4600               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4601
  4602         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4603               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4604               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4605               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4606               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4607               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4608
  4609         16  EC-ST-LF-REFUND-CALC      PIC X.
  4610                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4611                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4612                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4613                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4614                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4615                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4616                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4617                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4618
  4619         16  EC-ST-AH-REFUND-CALC      PIC X.
  4620                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4621                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4622                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4623                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4624                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4625                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4626                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4627                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4628
  4629         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4630         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4631         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4632         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4633         16  EC-AM-EXPIRATION-DT       PIC XX.
  4634         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4635         16  EC-AM-CLASS-CD            PIC XX.
  4636         16  EC-AM-LF-DEVIATION        PIC XXX.
  4637         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4638         16  EC-AM-AH-DEVIATION        PIC XXX.
  4639         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4640         16  EC-AM-PHONE-NO            PIC X(10).
  4641
  4642         16  EC-AM-LF-REFUND-CALC      PIC X.
  4643                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4644                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4645                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4646                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4647                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4648                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4649                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4650
  4651         16  EC-AM-AH-REFUND-CALC      PIC X.
  4652                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL050.cbl
  4653                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4654                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4655                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4656                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4657                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4658                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4659
  4660         16  EC-AM-BEN-I-G-CD          PIC X.
  4661                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4662                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4663                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4664
  4665         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4666         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4667         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4668         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4669         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4670         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4671         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4672         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4673         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4674
  4675         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4676         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4677         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4678         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4679         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4680         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4681         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4682         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4683         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4684         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4685         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4686         16  EC-RT-LF-NSP-ST           PIC XX.
  4687         16  EC-RT-AH-NSP-ST           PIC XX.
  4688         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4689         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4690
  4691         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4692             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4693                                             'M' '5' '9' '2'.
  4694             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4695             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4696             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4697             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4698             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4699             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4700             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4701             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4702             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4703             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4704
  4705         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4706             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4707                                             'M' '5' '9' '2'.
  4708             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4709             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4710             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL050.cbl
  4711             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4712             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4713             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4714             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4715             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4716             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4717             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4718
  4719         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4720         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4721         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4722         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4723         16  EC-CM-DEATH-DT            PIC XX.
  4724
  4725*DMD CUSTOM CODING FIELDS BELOW
  4726*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4727         16  EC-BR-DMD-RATING-SW       PIC X.
  4728                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4729                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4730                 88  NO-DMD-RATING               VALUE 'N'.
  4731
  4732         16  EC-NEW-CERT               PIC X(11).
  4733         16  EC-NEW-STATE              PIC XX.
  4734         16  FILLER                    PIC X.
  4735*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4736         16  OVER-SHORT-EDIT-FIELDS.
  4737             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4738             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4739             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4740             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4741             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4742             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4743             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4744             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4745             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4746         16  FILLER                    PIC X(71).
  4747******************************************************************
  4748
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL050.cbl
  4750*    COPY ELCDIFRD.
  4751******************************************************************
  4752*                                                                *
  4753*                                                                *
  4754*                            ELCDIFRD.                           *
  4755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4756*                            VMOD=2.004                          *
  4757*                                                                *
  4758*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4759*                                                                *
  4760******************************************************************
  4761*
  4762  01  WS-DIFFERENCE-CALCULATION.
  4763        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4764        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4765        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4766        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4767        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4768        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4769        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4770        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4771        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4772        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4773        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4774
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL050.cbl
  4776****************************************************************
  4777*
  4778* Copyright (c) 2007 by Clerity Solutions, Inc.
  4779* All rights reserved.
  4780*
  4781****************************************************************
  4782 01  DFHEIV.
  4783   02  DFHEIV0               PIC X(35).
  4784   02  DFHEIV1               PIC X(08).
  4785   02  DFHEIV2               PIC X(08).
  4786   02  DFHEIV3               PIC X(08).
  4787   02  DFHEIV4               PIC X(06).
  4788   02  DFHEIV5               PIC X(04).
  4789   02  DFHEIV6               PIC X(04).
  4790   02  DFHEIV7               PIC X(02).
  4791   02  DFHEIV8               PIC X(02).
  4792   02  DFHEIV9               PIC X(01).
  4793   02  DFHEIV10              PIC S9(7) COMP-3.
  4794   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4795   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4796   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4797   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4798   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4799   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4800   02  DFHEIV17              PIC X(04).
  4801   02  DFHEIV18              PIC X(04).
  4802   02  DFHEIV19              PIC X(04).
  4803   02  DFHEIV20              USAGE IS POINTER.
  4804   02  DFHEIV21              USAGE IS POINTER.
  4805   02  DFHEIV22              USAGE IS POINTER.
  4806   02  DFHEIV23              USAGE IS POINTER.
  4807   02  DFHEIV24              USAGE IS POINTER.
  4808   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4809   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4810   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4811   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4812   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4813   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4814   02  FILLER                PIC X(02).
  4815   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4816   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4817   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4818   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4819   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4820 LINKAGE  SECTION.
  4821*****************************************************************
  4822*                                                               *
  4823* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4824* All rights reserved.                                          *
  4825*                                                               *
  4826*****************************************************************
  4827 01  dfheiblk.
  4828     02  eibtime          pic s9(7) comp-3.
  4829     02  eibdate          pic s9(7) comp-3.
  4830     02  eibtrnid         pic x(4).
  4831     02  eibtaskn         pic s9(7) comp-3.
  4832     02  eibtrmid         pic x(4).
  4833     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL050.cbl
  4834     02  eibcposn         pic s9(4) comp.
  4835     02  eibcalen         pic s9(4) comp.
  4836     02  eibaid           pic x(1).
  4837     02  eibfiller1       pic x(1).
  4838     02  eibfn            pic x(2).
  4839     02  eibfiller2       pic x(2).
  4840     02  eibrcode         pic x(6).
  4841     02  eibfiller3       pic x(2).
  4842     02  eibds            pic x(8).
  4843     02  eibreqid         pic x(8).
  4844     02  eibrsrce         pic x(8).
  4845     02  eibsync          pic x(1).
  4846     02  eibfree          pic x(1).
  4847     02  eibrecv          pic x(1).
  4848     02  eibsend          pic x(1).
  4849     02  eibatt           pic x(1).
  4850     02  eibeoc           pic x(1).
  4851     02  eibfmh           pic x(1).
  4852     02  eibcompl         pic x(1).
  4853     02  eibsig           pic x(1).
  4854     02  eibconf          pic x(1).
  4855     02  eiberr           pic x(1).
  4856     02  eibrldbk         pic x(1).
  4857     02  eiberrcd         pic x(4).
  4858     02  eibsynrb         pic x(1).
  4859     02  eibnodat         pic x(1).
  4860     02  eibfiller5       pic x(2).
  4861     02  eibresp          pic 9(09) comp.
  4862     02  eibresp2         pic 9(09) comp.
  4863     02  dfheigdj         pic s9(4) comp.
  4864     02  dfheigdk         pic s9(4) comp.
  4865
  4866 01  DFHCOMMAREA                   PIC X(1036).
  4867
  4868*01 PARMLIST .
  4869*    02  FILLER                    PIC S9(8)   COMP.
  4870*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4871*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4872*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4873*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4874*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4875*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4876*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4877
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL050.cbl
  4879*    COPY ELCCNTL.
  4880******************************************************************
  4881*                                                                *
  4882*                                                                *
  4883*                            ELCCNTL.                            *
  4884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4885*                            VMOD=2.059                          *
  4886*                                                                *
  4887*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4888*                                                                *
  4889*   FILE TYPE = VSAM,KSDS                                        *
  4890*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4891*                                                                *
  4892*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4893*       ALTERNATE INDEX = NONE                                   *
  4894*                                                                *
  4895*   LOG = YES                                                    *
  4896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4897******************************************************************
  4898*                   C H A N G E   L O G
  4899*
  4900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4901*-----------------------------------------------------------------
  4902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4903* EFFECTIVE    NUMBER
  4904*-----------------------------------------------------------------
  4905* 082503                   PEMA  ADD BENEFIT GROUP
  4906* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4907* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4908* 092705    2005050300006  PEMA  ADD SPP LEASES
  4909* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4910* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4911* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4912* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4913* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4914* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4915******************************************************************
  4916*
  4917 01  CONTROL-FILE.
  4918     12  CF-RECORD-ID                       PIC XX.
  4919         88  VALID-CF-ID                        VALUE 'CF'.
  4920
  4921     12  CF-CONTROL-PRIMARY.
  4922         16  CF-COMPANY-ID                  PIC XXX.
  4923         16  CF-RECORD-TYPE                 PIC X.
  4924             88  CF-COMPANY-MASTER              VALUE '1'.
  4925             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4926             88  CF-STATE-MASTER                VALUE '3'.
  4927             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4928             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4929             88  CF-CARRIER-MASTER              VALUE '6'.
  4930             88  CF-MORTALITY-MASTER            VALUE '7'.
  4931             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4932             88  CF-TERMINAL-MASTER             VALUE '9'.
  4933             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4934             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4935             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4936             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL050.cbl
  4937             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4938             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4939             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4940             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4941             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4942         16  CF-ACCESS-CD-GENL              PIC X(4).
  4943         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4944             20  CF-PROCESSOR               PIC X(4).
  4945         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4946             20  CF-STATE-CODE              PIC XX.
  4947             20  FILLER                     PIC XX.
  4948         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4949             20  FILLER                     PIC XX.
  4950             20  CF-HI-BEN-IN-REC           PIC XX.
  4951         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4952             20  FILLER                     PIC XXX.
  4953             20  CF-CARRIER-CNTL            PIC X.
  4954         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4955             20  FILLER                     PIC XX.
  4956             20  CF-HI-TYPE-IN-REC          PIC 99.
  4957         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4958             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4959                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4960             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4961             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4962         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4963             20  FILLER                     PIC X.
  4964             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4965         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4966             20  FILLER                     PIC XX.
  4967             20  CF-MORTGAGE-PLAN           PIC XX.
  4968         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4969
  4970     12  CF-LAST-MAINT-DT                   PIC XX.
  4971     12  CF-LAST-MAINT-BY                   PIC X(4).
  4972     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4973
  4974     12  CF-RECORD-BODY                     PIC X(728).
  4975
  4976
  4977****************************************************************
  4978*             COMPANY MASTER RECORD                            *
  4979****************************************************************
  4980
  4981     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4982         16  CF-COMPANY-ADDRESS.
  4983             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4984             20  CF-CL-IN-CARE-OF           PIC X(30).
  4985             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4986             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4987             20  CF-CL-CITY-STATE           PIC X(30).
  4988             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4989             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4990         16  CF-COMPANY-CD                  PIC X.
  4991         16  CF-COMPANY-PASSWORD            PIC X(8).
  4992         16  CF-SECURITY-OPTION             PIC X.
  4993             88  ALL-SECURITY                   VALUE '1'.
  4994             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL050.cbl
  4995             88  PROCESSOR-VERIFY               VALUE '3'.
  4996             88  NO-SECURITY                    VALUE '4'.
  4997             88  ALL-BUT-TERM                   VALUE '5'.
  4998         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4999             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5000         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5001             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5002         16  CF-INFORCE-LOCATION            PIC X.
  5003             88  CERTS-ARE-ONLINE               VALUE '1'.
  5004             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5005             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5006         16  CF-LOWER-CASE-LETTERS          PIC X.
  5007         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5008             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5009             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5010             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5011             88  CF-ACCNT-CNTL                  VALUE '3'.
  5012             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5013
  5014         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5015         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5016
  5017         16  CF-LGX-CREDIT-USER             PIC X.
  5018             88  CO-IS-NOT-USER                 VALUE 'N'.
  5019             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5020
  5021         16 CF-CREDIT-CALC-CODES.
  5022             20  CF-CR-REM-TERM-CALC PIC X.
  5023               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5024               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5025               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5026               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5027               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5028               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5029               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5030             20  CF-CR-R78-METHOD           PIC X.
  5031               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5032               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5033
  5034         16  CF-CLAIM-CONTROL-COUNTS.
  5035             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5036                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5037
  5038             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5039                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5040
  5041             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5042                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5043
  5044             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5045                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5046
  5047         16  CF-CURRENT-MONTH-END           PIC XX.
  5048
  5049         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5050             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5051             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5052             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL050.cbl
  5053             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5054                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5055                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5056             20  CF-CO-PREM-REJECT-SW       PIC X.
  5057                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5058                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5059             20  CF-CO-REF-REJECT-SW        PIC X.
  5060                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5061                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5062
  5063         16  CF-CO-REPORTING-DT             PIC XX.
  5064         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5065         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5066           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5067           88  CF-CO-MONTH-END                  VALUE '1'.
  5068
  5069         16  CF-LGX-CLAIM-USER              PIC X.
  5070             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5071             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5072
  5073         16  CF-CREDIT-EDIT-CONTROLS.
  5074             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5075             20  CF-MIN-AGE                 PIC 99.
  5076             20  CF-DEFAULT-AGE             PIC 99.
  5077             20  CF-MIN-TERM                PIC S999      COMP-3.
  5078             20  CF-MAX-TERM                PIC S999      COMP-3.
  5079             20  CF-DEFAULT-SEX             PIC X.
  5080             20  CF-JOINT-AGE-INPUT         PIC X.
  5081                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5082             20  CF-BIRTH-DATE-INPUT        PIC X.
  5083                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5084             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5085                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5086                 88  CF-ZERO-CARRIER            VALUE '1'.
  5087                 88  CF-ZERO-GROUPING           VALUE '2'.
  5088                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5089             20  CF-EDIT-SW                 PIC X.
  5090                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5091             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5092             20  CF-CR-PR-METHOD            PIC X.
  5093               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5094               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5095             20  FILLER                     PIC X.
  5096
  5097         16  CF-CREDIT-MISC-CONTROLS.
  5098             20  CF-REIN-TABLE-SW           PIC X.
  5099                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5100             20  CF-COMP-TABLE-SW           PIC X.
  5101                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5102             20  CF-EXPERIENCE-RETENTION-AGE
  5103                                            PIC S9        COMP-3.
  5104             20  CF-CONVERSION-DT           PIC XX.
  5105             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5106             20  CF-RUN-FREQUENCY-SW        PIC X.
  5107                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5108                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5109
  5110             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL050.cbl
  5111                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5112                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5113                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5114                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5115                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5116                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5117
  5118                 24  CF-CR-CHECK-COUNT       REDEFINES
  5119                     CF-CR-CHECK-COUNTER      PIC X(4).
  5120
  5121                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5122                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5123
  5124                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5125                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5126                 24  CF-MAIL-PROCESSING       PIC X.
  5127                     88  MAIL-PROCESSING          VALUE 'Y'.
  5128
  5129         16  CF-MISC-SYSTEM-CONTROL.
  5130             20  CF-SYSTEM-C                 PIC X.
  5131                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5132             20  CF-SYSTEM-D                 PIC X.
  5133                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5134             20  CF-SOC-SEC-NO-SW            PIC X.
  5135                 88  SOC-SEC-NO-USED             VALUE '1'.
  5136             20  CF-MEMBER-NO-SW             PIC X.
  5137                 88  MEMBER-NO-USED              VALUE '1'.
  5138             20  CF-TAX-ID-NUMBER            PIC X(11).
  5139             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5140             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5141                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5142                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5143                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5144                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5145             20  CF-SYSTEM-E                 PIC X.
  5146                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5147
  5148         16  CF-LGX-LIFE-USER               PIC X.
  5149             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5150             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5151
  5152         16  CF-CR-MONTH-END-DT             PIC XX.
  5153
  5154         16  CF-FILE-MAINT-DATES.
  5155             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5156                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5157             20  CF-LAST-BATCH       REDEFINES
  5158                 CF-LAST-BATCH-NO               PIC X(4).
  5159             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5160             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5161             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5162             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5163             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5164             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5165             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5166             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5167             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5168             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL050.cbl
  5169
  5170         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5171         16  FILLER                         PIC X.
  5172
  5173         16  CF-ALT-MORT-CODE               PIC X(4).
  5174         16  CF-MEMBER-CAPTION              PIC X(10).
  5175
  5176         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5177             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5178             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5179             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5180             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5181             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5182
  5183         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5184
  5185         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5186         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5187         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5188         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5189
  5190         16  CF-AH-OVERRIDE-L1              PIC X.
  5191         16  CF-AH-OVERRIDE-L2              PIC XX.
  5192         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5193         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5194
  5195         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5196         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5197
  5198         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5199         16  CF-AR-LAST-EL860-DT            PIC XX.
  5200         16  CF-MP-MONTH-END-DT             PIC XX.
  5201
  5202         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5203         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5204             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5205
  5206         16  CF-AR-MONTH-END-DT             PIC XX.
  5207
  5208         16  CF-CRDTCRD-USER                PIC X.
  5209             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5210             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5211
  5212         16  CF-CC-MONTH-END-DT             PIC XX.
  5213
  5214         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5215
  5216         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5217             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5218             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5219             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5220         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5221         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5222         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5223         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5224             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5225             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5226         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL050.cbl
  5227         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5228         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5229             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5230         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5231
  5232         16  CF-CL-ZIP-CODE.
  5233             20  CF-CL-ZIP-PRIME.
  5234                 24  CF-CL-ZIP-1ST          PIC X.
  5235                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5236                 24  FILLER                 PIC X(4).
  5237             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5238         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5239             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5240             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5241             20  FILLER                     PIC XXX.
  5242
  5243         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5244         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5245         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5246         16  CF-CO-OPTION-START-DATE        PIC XX.
  5247         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5248           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5249                                                      '3' '4'.
  5250           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5251           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5252           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5253           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5254           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5255           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5256
  5257         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5258
  5259         16  CF-PAYMENT-APPROVAL-LEVELS.
  5260             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5261             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5262             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5263             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5264             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5265             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5266
  5267         16  CF-END-USER-REPORTING-USER     PIC X.
  5268             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5269             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5270
  5271         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5272             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5273             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5274
  5275         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5276
  5277         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5278         16  FILLER                         PIC X.
  5279
  5280         16  CF-CREDIT-ARCHIVE-CNTL.
  5281             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5282             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5283             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5284
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL050.cbl
  5285         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5286
  5287         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5288             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5289             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5290
  5291         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5292             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5293             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5294
  5295         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5296
  5297         16  CF-CO-ACH-ID-CODE              PIC  X.
  5298             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5299             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5300             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5301         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5302         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5303         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5304         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5305         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5306         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5307         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5308         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5309         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5310                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5311         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5312                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5313
  5314         16  CF-CO-OVER-SHORT.
  5315             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5316             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5317
  5318*         16  FILLER                         PIC X(102).
  5319         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5320             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5321             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5322
  5323         16  CF-AH-APPROVAL-DAYS.
  5324             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5325             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5326             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5327             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5328
  5329         16  FILLER                         PIC X(82).
  5330****************************************************************
  5331*             PROCESSOR/USER RECORD                            *
  5332****************************************************************
  5333
  5334     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5335         16  CF-PROCESSOR-NAME              PIC X(30).
  5336         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5337         16  CF-PROCESSOR-TITLE             PIC X(26).
  5338         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5339                 88  MESSAGE-YES                VALUE 'Y'.
  5340                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5341
  5342*****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL050.cbl
  5343****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5344****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5345****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5346****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5347*****************************************************
  5348
  5349         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5350             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5351             20  CF-APPLICATION-FORCE       PIC X.
  5352             20  CF-INDIVIDUAL-APP.
  5353                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5354                     28  CF-BROWSE-APP      PIC X.
  5355                     28  CF-UPDATE-APP      PIC X.
  5356
  5357         16  CF-CURRENT-TERM-ON             PIC X(4).
  5358         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5359             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5360             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5361             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5362             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5363             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5364             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5365             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5366         16  CF-PROCESSOR-CARRIER           PIC X.
  5367             88  NO-CARRIER-SECURITY            VALUE ' '.
  5368         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5369             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5370         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5371             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5372         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5373             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5374
  5375         16  CF-PROC-SYS-ACCESS-SW.
  5376             20  CF-PROC-CREDIT-CLAIMS-SW.
  5377                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5378                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5379                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5380                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5381             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5382                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5383                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5384             20  CF-PROC-LIFE-GNRLDGR-SW.
  5385                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5386                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5387                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5388                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5389             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5390                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5391                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5392         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5393             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5394             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5395         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5396
  5397         16  CF-APPROVAL-LEVEL                  PIC X.
  5398             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5399             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5400             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL050.cbl
  5401             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5402
  5403         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5404
  5405         16  CF-LANGUAGE-TYPE                   PIC X.
  5406             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5407             88  CF-LANG-IS-FR                      VALUE 'F'.
  5408
  5409         16  CF-CSR-IND                         PIC X.
  5410         16  FILLER                             PIC X(239).
  5411
  5412****************************************************************
  5413*             PROCESSOR/REMINDERS RECORD                       *
  5414****************************************************************
  5415
  5416     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5417         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5418             20  CF-START-REMIND-DT         PIC XX.
  5419             20  CF-END-REMIND-DT           PIC XX.
  5420             20  CF-REMINDER-TEXT           PIC X(50).
  5421         16  FILLER                         PIC X(296).
  5422
  5423
  5424****************************************************************
  5425*             STATE MASTER RECORD                              *
  5426****************************************************************
  5427
  5428     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5429         16  CF-STATE-ABBREVIATION          PIC XX.
  5430         16  CF-STATE-NAME                  PIC X(25).
  5431         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5432         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5433             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5434             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5435             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5436             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5437                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5438                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5439             20  CF-ST-PREM-REJECT-SW       PIC X.
  5440                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5441                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5442             20  CF-ST-REF-REJECT-SW        PIC X.
  5443                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5444                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5445         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5446         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5447         16  CF-ST-REFUND-RULES.
  5448             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5449             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5450             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5451         16  CF-ST-FST-PMT-EXTENSION.
  5452             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5453             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5454                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5455                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5456                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5457                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5458         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL050.cbl
  5459             20  CF-ST-CALL-UNEARNED        PIC X.
  5460             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5461             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5462         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5463             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5464             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5465         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5466         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5467         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5468         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5469         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5470         16  FILLER                         PIC X.
  5471         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5472             20  CF-ST-BENEFIT-CD           PIC XX.
  5473             20  CF-ST-BENEFIT-KIND         PIC X.
  5474                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5475                 88  CF-ST-AH-KIND              VALUE 'A'.
  5476             20  CF-ST-REM-TERM-CALC        PIC X.
  5477                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5478                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5479                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5480                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5481                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5482                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5483                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5484                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5485
  5486             20  CF-ST-REFUND-CALC          PIC X.
  5487                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5488                 88  ST-REFD-BY-R78             VALUE '1'.
  5489                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5490                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5491                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5492                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5493                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5494                 88  ST-REFD-UTAH               VALUE '7'.
  5495                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5496                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5497                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5498
  5499             20  CF-ST-EARNING-CALC         PIC X.
  5500                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5501                 88  ST-EARN-BY-R78             VALUE '1'.
  5502                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5503                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5504                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5505                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5506                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5507                 88  ST-EARN-MEAN               VALUE '8'.
  5508                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5509
  5510             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5511                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5512                 88  ST-OVRD-BY-R78             VALUE '1'.
  5513                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5514                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5515                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5516                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL050.cbl
  5517                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5518                 88  ST-OVRD-MEAN               VALUE '8'.
  5519                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5520             20  FILLER                     PIC X.
  5521
  5522         16  CF-ST-COMMISSION-CAPS.
  5523             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5524             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5525             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5526             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5527         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5528                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5529
  5530         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5531
  5532         16  CF-ST-STATUTORY-INTEREST.
  5533             20  CF-ST-STAT-DATE-FROM       PIC X.
  5534                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5535                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5536             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5537             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5538             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5539             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5540             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5541
  5542         16  CF-ST-OVER-SHORT.
  5543             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5544             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5545
  5546         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5547
  5548         16  CF-ST-RT-CALC                  PIC X.
  5549
  5550         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5551         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5552         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5553         16  CF-ST-RF-LR-CALC               PIC X.
  5554         16  CF-ST-RF-LL-CALC               PIC X.
  5555         16  CF-ST-RF-LN-CALC               PIC X.
  5556         16  CF-ST-RF-AH-CALC               PIC X.
  5557         16  CF-ST-RF-CP-CALC               PIC X.
  5558*        16  FILLER                         PIC X(206).
  5559*CIDMOD         16  FILLER                         PIC X(192).
  5560         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5561             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5562         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5563         16  CF-ST-VFY-2ND-BENE             PIC X.
  5564         16  FILLER                         PIC X(186).
  5565
  5566****************************************************************
  5567*             BENEFIT MASTER RECORD                            *
  5568****************************************************************
  5569
  5570     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5571         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5572             20  CF-BENEFIT-CODE            PIC XX.
  5573             20  CF-BENEFIT-NUMERIC  REDEFINES
  5574                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL050.cbl
  5575             20  CF-BENEFIT-ALPHA           PIC XXX.
  5576             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5577             20  CF-BENEFIT-COMMENT         PIC X(10).
  5578
  5579             20  CF-LF-COVERAGE-TYPE        PIC X.
  5580                 88  CF-REDUCING                VALUE 'R'.
  5581                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5582
  5583             20  CF-SPECIAL-CALC-CD         PIC X.
  5584                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5585                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5586                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5587                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5588                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5589                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5590                 88  CF-FARM-PLAN               VALUE 'F'.
  5591                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5592                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5593                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5594                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5595                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5596                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5597                 88  CF-PRUDENTIAL              VALUE 'P'.
  5598                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5599                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5600                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5601                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5602                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5603                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5604
  5605             20  CF-JOINT-INDICATOR         PIC X.
  5606                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5607
  5608*            20  FILLER                     PIC X(12).
  5609             20  FILLER                     PIC X(11).
  5610             20  CF-BENEFIT-CATEGORY        PIC X.
  5611             20  CF-LOAN-TYPE               PIC X(8).
  5612
  5613             20  CF-CO-REM-TERM-CALC        PIC X.
  5614                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5615                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5616                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5617                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5618                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5619
  5620             20  CF-CO-EARNINGS-CALC        PIC X.
  5621                 88  CO-EARN-BY-R78             VALUE '1'.
  5622                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5623                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5624                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5625                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5626                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5627                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5628                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5629
  5630             20  CF-CO-REFUND-CALC          PIC X.
  5631                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5632                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL050.cbl
  5633                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5634                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5635                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5636                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5637                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5638                 88  CO-REFD-MEAN               VALUE '8'.
  5639                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5640                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5641                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5642
  5643             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5644                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5645                 88  CO-OVRD-BY-R78             VALUE '1'.
  5646                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5647                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5648                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5649                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5650                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5651                 88  CO-OVRD-MEAN               VALUE '8'.
  5652                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5653
  5654             20  CF-CO-BEN-I-G-CD           PIC X.
  5655                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5656                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5657                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5658
  5659         16  FILLER                         PIC X(304).
  5660
  5661
  5662****************************************************************
  5663*             CARRIER MASTER RECORD                            *
  5664****************************************************************
  5665
  5666     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5667         16  CF-ADDRESS-DATA.
  5668             20  CF-MAIL-TO-NAME            PIC X(30).
  5669             20  CF-IN-CARE-OF              PIC X(30).
  5670             20  CF-ADDRESS-LINE-1          PIC X(30).
  5671             20  CF-ADDRESS-LINE-2          PIC X(30).
  5672             20  CF-CITY-STATE              PIC X(30).
  5673             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5674             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5675
  5676         16  CF-CLAIM-NO-CONTROL.
  5677             20  CF-CLAIM-NO-METHOD         PIC X.
  5678                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5679                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5680                 88  CLAIM-NO-SEQ               VALUE '3'.
  5681                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5682             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5683                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5684                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5685                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5686
  5687         16  CF-CHECK-NO-CONTROL.
  5688             20  CF-CHECK-NO-METHOD         PIC X.
  5689                 88  CHECK-NO-MANUAL            VALUE '1'.
  5690                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL050.cbl
  5691                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5692                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5693             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5694                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5695
  5696         16  CF-DOMICILE-STATE              PIC XX.
  5697
  5698         16  CF-EXPENSE-CONTROLS.
  5699             20  CF-EXPENSE-METHOD          PIC X.
  5700                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5701                 88  DOLLARS-PER-PMT            VALUE '2'.
  5702                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5703                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5704             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5705             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5706
  5707         16  CF-CORRESPONDENCE-CONTROL.
  5708             20  CF-LETTER-RESEND-OPT       PIC X.
  5709                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5710                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5711             20  FILLER                     PIC X(4).
  5712
  5713         16  CF-RESERVE-CONTROLS.
  5714             20  CF-MANUAL-SW               PIC X.
  5715                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5716             20  CF-FUTURE-SW               PIC X.
  5717                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5718             20  CF-PTC-SW                  PIC X.
  5719                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5720             20  CF-IBNR-SW                 PIC X.
  5721                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5722             20  CF-PTC-LF-SW               PIC X.
  5723                 88  CF-LF-PTC-USED             VALUE '1'.
  5724             20  CF-CDT-ACCESS-METHOD       PIC X.
  5725                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5726                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5727                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5728             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5729
  5730         16  CF-CLAIM-CALC-METHOD           PIC X.
  5731             88  360-PLUS-MONTHS                VALUE '1'.
  5732             88  365-PLUS-MONTHS                VALUE '2'.
  5733             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5734             88  360-DAILY                      VALUE '4'.
  5735             88  365-DAILY                      VALUE '5'.
  5736
  5737         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5738         16  FILLER                         PIC X(11).
  5739
  5740         16  CF-LIMIT-AMOUNTS.
  5741             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5742             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5743             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5744             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5745             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5746             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5747             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5748             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL050.cbl
  5749             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5750             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5751
  5752         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5753         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5754         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5755
  5756         16  CF-ZIP-CODE.
  5757             20  CF-ZIP-PRIME.
  5758                 24  CF-ZIP-1ST             PIC X.
  5759                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5760                 24  FILLER                 PIC X(4).
  5761             20  CF-ZIP-PLUS4               PIC X(4).
  5762         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5763             20  CF-CAN-POSTAL-1            PIC XXX.
  5764             20  CF-CAN-POSTAL-2            PIC XXX.
  5765             20  FILLER                     PIC XXX.
  5766
  5767         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5768         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5769         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5770
  5771         16  CF-RATING-SWITCH               PIC X.
  5772             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5773             88  CF-NO-RATING                   VALUE 'N'.
  5774
  5775         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5776
  5777         16  CF-CARRIER-OVER-SHORT.
  5778             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5779             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5780
  5781         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5782         16  CF-SECPAY-SWITCH               PIC X.
  5783             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5784             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5785         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5786         16  FILLER                         PIC X(448).
  5787*        16  FILLER                         PIC X(452).
  5788
  5789
  5790****************************************************************
  5791*             MORTALITY MASTER RECORD                          *
  5792****************************************************************
  5793
  5794     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5795         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5796                                INDEXED BY CF-MORT-NDX.
  5797             20  CF-MORT-TABLE              PIC X(5).
  5798             20  CF-MORT-TABLE-TYPE         PIC X.
  5799                 88  CF-MORT-JOINT              VALUE 'J'.
  5800                 88  CF-MORT-SINGLE             VALUE 'S'.
  5801                 88  CF-MORT-COMBINED           VALUE 'C'.
  5802                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5803                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5804             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5805             20  CF-MORT-AGE-METHOD         PIC XX.
  5806                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL050.cbl
  5807                 88  CF-AGE-NEAR                VALUE 'AN'.
  5808             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5809             20  CF-MORT-ADJUSTMENT-DIRECTION
  5810                                            PIC X.
  5811                 88  CF-MINUS                   VALUE '-'.
  5812                 88  CF-PLUS                    VALUE '+'.
  5813             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5814             20  CF-MORT-JOINT-CODE         PIC X.
  5815                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5816             20  CF-MORT-PC-Q               PIC X.
  5817                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5818             20  CF-MORT-TABLE-CODE         PIC X(4).
  5819             20  CF-MORT-COMMENTS           PIC X(15).
  5820             20  FILLER                     PIC X(14).
  5821
  5822         16  FILLER                         PIC X(251).
  5823
  5824
  5825****************************************************************
  5826*             BUSSINESS TYPE MASTER RECORD                     *
  5827****************************************************************
  5828
  5829     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5830* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5831* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5832* AND RECORD 05 IS TYPES 81-99
  5833         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5834             20  CF-BUSINESS-TITLE          PIC  X(19).
  5835             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5836                                            PIC S9V9(4) COMP-3.
  5837             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5838             20  FILLER                     PIC  X.
  5839         16  FILLER                         PIC  X(248).
  5840
  5841
  5842****************************************************************
  5843*             TERMINAL MASTER RECORD                           *
  5844****************************************************************
  5845
  5846     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5847
  5848         16  CF-COMPANY-TERMINALS.
  5849             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5850                                  PIC X(4).
  5851         16  FILLER               PIC X(248).
  5852
  5853
  5854****************************************************************
  5855*             LIFE EDIT MASTER RECORD                          *
  5856****************************************************************
  5857
  5858     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5859         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5860             20  CF-LIFE-CODE-IN            PIC XX.
  5861             20  CF-LIFE-CODE-OUT           PIC XX.
  5862         16  FILLER                         PIC X(248).
  5863
  5864
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL050.cbl
  5865****************************************************************
  5866*             AH EDIT MASTER RECORD                            *
  5867****************************************************************
  5868
  5869     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5870         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5871             20  CF-AH-CODE-IN              PIC XXX.
  5872             20  CF-AH-CODE-OUT             PIC XX.
  5873         16  FILLER                         PIC X(248).
  5874
  5875
  5876****************************************************************
  5877*             CREDIBILITY TABLES                               *
  5878****************************************************************
  5879
  5880     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5881         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5882                             INDEXED BY CF-CRDB-NDX.
  5883             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5884             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5885             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5886         16  FILLER                         PIC  X(332).
  5887
  5888
  5889****************************************************************
  5890*             REPORT CUSTOMIZATION RECORD                      *
  5891****************************************************************
  5892
  5893     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5894         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5895             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5896             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5897             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5898**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5899****       A T-TRANSFER.                                   ****
  5900             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5901
  5902         16  FILLER                         PIC XX.
  5903
  5904         16  CF-CARRIER-CNTL-OPT.
  5905             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5906                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5907                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5908             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5909                                            PIC X.
  5910         16  CF-GROUP-CNTL-OPT.
  5911             20  CF-GROUP-OPT-SEQ           PIC 9.
  5912                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5913                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5914             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5915                                            PIC X(6).
  5916         16  CF-STATE-CNTL-OPT.
  5917             20  CF-STATE-OPT-SEQ           PIC 9.
  5918                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5919                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5920             20  CF-STATE-SELECT OCCURS 3 TIMES
  5921                                            PIC XX.
  5922         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL050.cbl
  5923             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5924                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5925                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5926             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5927                                            PIC X(10).
  5928         16  CF-BUS-TYP-CNTL-OPT.
  5929             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5930                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5931                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5932             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5933                                            PIC XX.
  5934         16  CF-LF-TYP-CNTL-OPT.
  5935             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5936                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5937                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5938             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5939                                            PIC XX.
  5940         16  CF-AH-TYP-CNTL-OPT.
  5941             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5942                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5943                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5944             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5945                                            PIC XX.
  5946         16  CF-REPTCD1-CNTL-OPT.
  5947             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5948                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5949                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5950             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5951                                            PIC X(10).
  5952         16  CF-REPTCD2-CNTL-OPT.
  5953             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5954                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5955                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5956             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5957                                            PIC X(10).
  5958         16  CF-USER1-CNTL-OPT.
  5959             20  CF-USER1-OPT-SEQ           PIC 9.
  5960                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5961                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5962             20  CF-USER1-SELECT OCCURS 3 TIMES
  5963                                            PIC X(10).
  5964         16  CF-USER2-CNTL-OPT.
  5965             20  CF-USER2-OPT-SEQ           PIC 9.
  5966                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5967                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5968             20  CF-USER2-SELECT OCCURS 3 TIMES
  5969                                            PIC X(10).
  5970         16  CF-USER3-CNTL-OPT.
  5971             20  CF-USER3-OPT-SEQ           PIC 9.
  5972                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5973                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5974             20  CF-USER3-SELECT OCCURS 3 TIMES
  5975                                            PIC X(10).
  5976         16  CF-USER4-CNTL-OPT.
  5977             20  CF-USER4-OPT-SEQ           PIC 9.
  5978                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5979                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5980             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL050.cbl
  5981                                            PIC X(10).
  5982         16  CF-USER5-CNTL-OPT.
  5983             20  CF-USER5-OPT-SEQ           PIC 9.
  5984                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5985                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5986             20  CF-USER5-SELECT OCCURS 3 TIMES
  5987                                            PIC X(10).
  5988         16  CF-REINS-CNTL-OPT.
  5989             20  CF-REINS-OPT-SEQ           PIC 9.
  5990                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5991                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5992             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5993                 24  CF-REINS-PRIME         PIC XXX.
  5994                 24  CF-REINS-SUB           PIC XXX.
  5995
  5996         16  CF-AGENT-CNTL-OPT.
  5997             20  CF-AGENT-OPT-SEQ           PIC 9.
  5998                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5999                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6000             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6001                                            PIC X(10).
  6002
  6003         16  FILLER                         PIC X(43).
  6004
  6005         16  CF-LOSS-RATIO-SELECT.
  6006             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6007             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6008         16  CF-ENTRY-DATE-SELECT.
  6009             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6010             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6011         16  CF-EFFECTIVE-DATE-SELECT.
  6012             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6013             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6014
  6015         16  CF-EXCEPTION-LIST-IND          PIC X.
  6016             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6017
  6018         16  FILLER                         PIC X(318).
  6019
  6020****************************************************************
  6021*                  EXCEPTION REPORTING RECORD                  *
  6022****************************************************************
  6023
  6024     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6025         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6026             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6027
  6028         16  CF-COMBINED-LIFE-AH-OPT.
  6029             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6030             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6031             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6032             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6033
  6034         16  CF-LIFE-OPT.
  6035             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6036             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6037             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6038             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL050.cbl
  6039             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6040             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6041             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6042             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6043             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6044             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6045
  6046         16  CF-AH-OPT.
  6047             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6048             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6049             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6050             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6051             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6052             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6053             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6054             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6055             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6056             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6057
  6058         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6059             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6060             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6061             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6062
  6063         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6064
  6065         16  FILLER                         PIC X(673).
  6066
  6067
  6068****************************************************************
  6069*             MORTGAGE SYSTEM PLAN RECORD                      *
  6070****************************************************************
  6071
  6072     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6073         16  CF-PLAN-TYPE                   PIC X.
  6074             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6075             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6076             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6077         16  CF-PLAN-ABBREV                 PIC XXX.
  6078         16  CF-PLAN-DESCRIPT               PIC X(10).
  6079         16  CF-PLAN-NOTES                  PIC X(20).
  6080         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6081         16  CF-PLAN-UNDERWRITING.
  6082             20  CF-PLAN-TERM-DATA.
  6083                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6084                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6085             20  CF-PLAN-AGE-DATA.
  6086                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6087                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6088                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6089             20  CF-PLAN-BENEFIT-DATA.
  6090                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6091                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6092                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6093                                            PIC S9(7)V99  COMP-3.
  6094         16  CF-PLAN-POLICY-FORMS.
  6095             20  CF-POLICY-FORM             PIC X(12).
  6096             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL050.cbl
  6097             20  CF-MASTER-POLICY           PIC X(12).
  6098         16  CF-PLAN-RATING.
  6099             20  CF-RATE-CODE               PIC X(5).
  6100             20  CF-SEX-RATING              PIC X.
  6101                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6102                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6103             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6104             20  CF-SUB-STD-TYPE            PIC X.
  6105                 88  CF-PCT-OF-PREM            VALUE '1'.
  6106                 88  CF-PCT-OF-BENE            VALUE '2'.
  6107         16  CF-PLAN-PREM-TOLERANCES.
  6108             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6109             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6110         16  CF-PLAN-PYMT-TOLERANCES.
  6111             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6112             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6113         16  CF-PLAN-MISC-DATA.
  6114             20  FILLER                     PIC X.
  6115             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6116             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6117         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6118         16  CF-PLAN-IND-GRP                PIC X.
  6119             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6120                                                     '1'.
  6121             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6122                                                     '2'.
  6123         16  CF-MIB-SEARCH-SW               PIC X.
  6124             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6125             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6126             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6127             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6128         16  CF-ALPHA-SEARCH-SW             PIC X.
  6129             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6130             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6131             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6132             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6133             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6134             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6135             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6136             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6137             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6138             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6139                                                     'A' 'B' 'C'
  6140                                                     'X' 'Y' 'Z'.
  6141         16  CF-EFF-DT-RULE-SW              PIC X.
  6142             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6143             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6144             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6145             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6146             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6147         16  FILLER                         PIC X(4).
  6148         16  CF-HEALTH-QUESTIONS            PIC X.
  6149             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6150         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6151         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6152         16  CF-PLAN-SNGL-JNT               PIC X.
  6153             88  CF-COMBINED-PLAN              VALUE 'C'.
  6154             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL050.cbl
  6155             88  CF-SNGL-PLAN                  VALUE 'S'.
  6156         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6157         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6158         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6159         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6160         16  CF-RERATE-CNTL                 PIC  X.
  6161             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6162             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6163             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6164             88  CF-AUTO-RECALC                 VALUE '4'.
  6165         16  CF-BENEFIT-TYPE                PIC  X.
  6166             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6167             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6168         16  CF-POLICY-FEE                  PIC S999V99
  6169                                                    COMP-3.
  6170         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6171         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6172         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6173         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6174         16  FILLER                         PIC  X(32).
  6175         16  CF-TERMINATION-FORM            PIC  X(04).
  6176         16  FILLER                         PIC  X(08).
  6177         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6178                                                       COMP-3.
  6179         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6180         16  CF-ISSUE-LETTER                PIC  X(4).
  6181         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6182         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6183             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6184             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6185         16  CF-MP-REFUND-CALC              PIC X.
  6186             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6187             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6188             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6189             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6190             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6191             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6192             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6193             88  CF-MP-REFD-MEAN                VALUE '8'.
  6194         16  CF-ALT-RATE-CODE               PIC  X(5).
  6195
  6196
  6197         16  FILLER                         PIC X(498).
  6198****************************************************************
  6199*             MORTGAGE COMPANY MASTER RECORD                   *
  6200****************************************************************
  6201
  6202     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6203         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6204         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6205             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6206             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6207             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6208             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6209             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6210
  6211         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6212         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL050.cbl
  6213         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6214         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6215         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6216
  6217         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6218             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6219         16  CF-MP-RECON-USE-IND            PIC X(1).
  6220             88  CF-MP-USE-RECON             VALUE 'Y'.
  6221         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6222             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6223         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6224             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6225             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6226         16  FILLER                         PIC X(1).
  6227         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6228             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6229         16  CF-MORTG-MIB-VERSION           PIC X.
  6230             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6231             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6232             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6233         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6234             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6235                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6236             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6237                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6238             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6239                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6240             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6241                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6242             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6243                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6244             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6245                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6246         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6247         16  FILLER                         PIC X(7).
  6248         16  CF-MORTG-DESTINATION-SYMBOL.
  6249             20  CF-MORTG-MIB-COMM          PIC X(5).
  6250             20  CF-MORTG-MIB-TERM          PIC X(5).
  6251         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6252             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6253         16  FILLER                         PIC X(03).
  6254         16  CF-MP-CHECK-NO-CONTROL.
  6255             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6256                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6257                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6258                                                ' ' LOW-VALUES.
  6259                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6260                                               VALUE '3'.
  6261         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6262         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6263         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6264             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6265                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6266             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6267                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6268             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6269                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6270             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL050.cbl
  6271                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6272             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6273                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6274             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6275                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6276         16  CF-MORTG-BILLING-AREA.
  6277             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6278                                            PIC X.
  6279         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6280         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6281         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6282         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6283             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6284             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6285         16  FILLER                         PIC X.
  6286         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6287             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6288             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6289         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6290         16  FILLER                         PIC X(8).
  6291         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6292         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6293         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6294         16  CF-ACH-COMPANY-ID.
  6295             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6296                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6297                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6298                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6299             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6300         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6301             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6302         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6303             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6304             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6305         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6306         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6307         16  FILLER                         PIC X(536).
  6308
  6309****************************************************************
  6310*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6311****************************************************************
  6312
  6313     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6314         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6315             20  CF-FEMALE-HEIGHT.
  6316                 24  CF-FEMALE-FT           PIC 99.
  6317                 24  CF-FEMALE-IN           PIC 99.
  6318             20  CF-FEMALE-MIN-WT           PIC 999.
  6319             20  CF-FEMALE-MAX-WT           PIC 999.
  6320         16  FILLER                         PIC X(428).
  6321
  6322     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6323         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6324             20  CF-MALE-HEIGHT.
  6325                 24  CF-MALE-FT             PIC 99.
  6326                 24  CF-MALE-IN             PIC 99.
  6327             20  CF-MALE-MIN-WT             PIC 999.
  6328             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL050.cbl
  6329         16  FILLER                         PIC X(428).
  6330******************************************************************
  6331*             AUTOMATIC ACTIVITY RECORD                          *
  6332******************************************************************
  6333     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6334         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6335             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6336             20  CF-SYS-LETTER-ID           PIC X(04).
  6337             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6338             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6339             20  CF-SYS-RESET-SW            PIC X(01).
  6340             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6341             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6342
  6343         16  FILLER                         PIC X(50).
  6344
  6345         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6346             20  CF-USER-ACTIVE-SW          PIC X(01).
  6347             20  CF-USER-LETTER-ID          PIC X(04).
  6348             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6349             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6350             20  CF-USER-RESET-SW           PIC X(01).
  6351             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6352             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6353             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6354
  6355         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL050.cbl
  6357*    COPY ERCACCT.
  6358******************************************************************
  6359*                                                                *
  6360*                                                                *
  6361*                            ERCACCT                             *
  6362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6363*                            VMOD=2.031                          *
  6364*                                                                *
  6365*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6366*                                                                *
  6367*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6368*   VSAM ACCOUNT MASTER FILES.                                   *
  6369*                                                                *
  6370*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6371*                                                                *
  6372*   FILE TYPE = VSAM,KSDS                                        *
  6373*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6374*                                                                *
  6375*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6376*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6377*                                                                *
  6378*   LOG = NO                                                     *
  6379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6380*                                                                *
  6381*                                                                *
  6382******************************************************************
  6383*                   C H A N G E   L O G
  6384*
  6385* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6386*-----------------------------------------------------------------
  6387*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6388* EFFECTIVE    NUMBER
  6389*-----------------------------------------------------------------
  6390* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6391* 092705    2005050300006  PEMA  ADD SPP LEASES
  6392* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6393* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6394* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6395* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6396* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6397******************************************************************
  6398
  6399 01  ACCOUNT-MASTER.
  6400     12  AM-RECORD-ID                      PIC XX.
  6401         88  VALID-AM-ID                      VALUE 'AM'.
  6402
  6403     12  AM-CONTROL-PRIMARY.
  6404         16  AM-COMPANY-CD                 PIC X.
  6405         16  AM-MSTR-CNTRL.
  6406             20  AM-CONTROL-A.
  6407                 24  AM-CARRIER            PIC X.
  6408                 24  AM-GROUPING.
  6409                     28 AM-GROUPING-PREFIX PIC XXX.
  6410                     28 AM-GROUPING-PRIME  PIC XXX.
  6411                 24  AM-STATE              PIC XX.
  6412                 24  AM-ACCOUNT.
  6413                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6414                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL050.cbl
  6415             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6416                                           PIC X(19).
  6417             20  AM-CNTRL-B.
  6418                 24  AM-EXPIRATION-DT      PIC XX.
  6419                 24  FILLER                PIC X(4).
  6420             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6421                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6422
  6423     12  AM-CONTROL-BY-VAR-GRP.
  6424         16  AM-COMPANY-CD-A1              PIC X.
  6425         16  AM-VG-CARRIER                 PIC X.
  6426         16  AM-VG-GROUPING                PIC X(6).
  6427         16  AM-VG-STATE                   PIC XX.
  6428         16  AM-VG-ACCOUNT                 PIC X(10).
  6429         16  AM-VG-DATE.
  6430             20  AM-VG-EXPIRATION-DT       PIC XX.
  6431             20  FILLER                    PIC X(4).
  6432         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6433                                           PIC 9(11)      COMP-3.
  6434     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6435         16  FILLER                        PIC X(10).
  6436         16  AM-VG-KEY3.
  6437             20  AM-VG3-ACCOUNT            PIC X(10).
  6438             20  AM-VG3-EXP-DT             PIC XX.
  6439         16  FILLER                        PIC X(4).
  6440     12  AM-MAINT-INFORMATION.
  6441         16  AM-LAST-MAINT-DT              PIC XX.
  6442         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6443         16  AM-LAST-MAINT-USER            PIC X(4).
  6444         16  FILLER                        PIC XX.
  6445
  6446     12  AM-EFFECTIVE-DT                   PIC XX.
  6447     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6448
  6449     12  AM-PREV-DATES  COMP-3.
  6450         16  AM-PREV-EXP-DT                PIC 9(11).
  6451         16  AM-PREV-EFF-DT                PIC 9(11).
  6452
  6453     12  AM-REPORT-CODE-1                  PIC X(10).
  6454     12  AM-REPORT-CODE-2                  PIC X(10).
  6455
  6456     12  AM-CITY-CODE                      PIC X(4).
  6457     12  AM-COUNTY-PARISH                  PIC X(6).
  6458
  6459     12  AM-NAME                           PIC X(30).
  6460     12  AM-PERSON                         PIC X(30).
  6461     12  AM-ADDRS                          PIC X(30).
  6462     12  AM-CITY.
  6463         16  AM-ADDR-CITY                  PIC X(28).
  6464         16  AM-ADDR-STATE                 PIC XX.
  6465     12  AM-ZIP.
  6466         16  AM-ZIP-PRIME.
  6467             20  AM-ZIP-PRI-1ST            PIC X.
  6468                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6469             20  FILLER                    PIC X(4).
  6470         16  AM-ZIP-PLUS4                  PIC X(4).
  6471     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6472         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL050.cbl
  6473         16  AM-CAN-POSTAL-2               PIC XXX.
  6474         16  FILLER                        PIC XXX.
  6475     12  AM-TEL-NO.
  6476         16  AM-AREA-CODE                  PIC 999.
  6477         16  AM-TEL-PRE                    PIC 999.
  6478         16  AM-TEL-NBR                    PIC 9(4).
  6479     12  AM-TEL-LOC                        PIC X.
  6480         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6481         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6482
  6483     12  AM-COMM-STRUCTURE.
  6484         16  AM-DEFN-1.
  6485             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6486                 24  AM-AGT.
  6487                     28  AM-AGT-PREFIX     PIC X(4).
  6488                     28  AM-AGT-PRIME      PIC X(6).
  6489                 24  AM-COM-TYP            PIC X.
  6490                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6491                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6492                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6493                 24  AM-RECALC-LV-INDIC    PIC X.
  6494                 24  AM-RETRO-LV-INDIC     PIC X.
  6495                 24  AM-GL-CODES           PIC X.
  6496                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6497                 24  FILLER                PIC X(01).
  6498         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6499             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6500                 24  FILLER                PIC X(11).
  6501                 24  AM-L-COMA             PIC XXX.
  6502                 24  AM-J-COMA             PIC XXX.
  6503                 24  AM-A-COMA             PIC XXX.
  6504                 24  FILLER                PIC X(6).
  6505
  6506     12  AM-COMM-CHANGE-STATUS             PIC X.
  6507         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6508
  6509     12  AM-CSR-CODE                       PIC X(4).
  6510
  6511     12  AM-BILLING-STATUS                 PIC X.
  6512         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6513         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6514     12  AM-AUTO-REFUND-SW                 PIC X.
  6515         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6516         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6517     12  AM-GPCD                           PIC 99.
  6518     12  AM-IG                             PIC X.
  6519         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6520         88  AM-HAS-GROUP                     VALUE '2'.
  6521     12  AM-STATUS                         PIC X.
  6522         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6523         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6524         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6525         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6526         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6527         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6528     12  AM-REMIT-TO                       PIC 99.
  6529     12  AM-ID-NO                          PIC X(11).
  6530
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL050.cbl
  6531     12  AM-CAL-TABLE                      PIC XX.
  6532     12  AM-LF-DEVIATION                   PIC XXX.
  6533     12  AM-AH-DEVIATION                   PIC XXX.
  6534     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6535     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6536     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6537     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6538     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6539     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6540
  6541     12  AM-USER-FIELDS.
  6542         16  AM-FLD-1                      PIC XX.
  6543         16  AM-FLD-2                      PIC XX.
  6544         16  AM-FLD-3                      PIC XX.
  6545         16  AM-FLD-4                      PIC XX.
  6546         16  AM-FLD-5                      PIC XX.
  6547
  6548     12  AM-1ST-PROD-DATE.
  6549         16  AM-1ST-PROD-YR                PIC XX.
  6550         16  AM-1ST-PROD-MO                PIC XX.
  6551         16  AM-1ST-PROD-DA                PIC XX.
  6552     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6553     12  AM-CERTS-PURGED-DATE.
  6554         16  AM-PUR-YR                     PIC XX.
  6555         16  AM-PUR-MO                     PIC XX.
  6556         16  AM-PUR-DA                     PIC XX.
  6557     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6558     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6559     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6560     12  AM-INACTIVE-DATE.
  6561         16  AM-INA-MO                     PIC 99.
  6562         16  AM-INA-DA                     PIC 99.
  6563         16  AM-INA-YR                     PIC 99.
  6564     12  AM-AR-HI-CERT-DATE                PIC XX.
  6565
  6566     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6567     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6568
  6569     12  AM-OB-PAYMENT-MODE                PIC X.
  6570         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6571         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6572         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6573         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6574
  6575     12  AM-AH-ONLY-INDICATOR              PIC X.
  6576         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6577         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6578
  6579     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6580
  6581     12  AM-OVER-SHORT.
  6582         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6583         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6584
  6585     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6586     12  AM-DCC-CLP-STATE                  PIC XX.
  6587
  6588     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL050.cbl
  6589     12  AM-RECALC-REIN                    PIC X.
  6590
  6591     12  AM-REI-TABLE                      PIC XXX.
  6592     12  AM-REI-ET-LF                      PIC X.
  6593     12  AM-REI-ET-AH                      PIC X.
  6594     12  AM-REI-PE-LF                      PIC X.
  6595     12  AM-REI-PE-AH                      PIC X.
  6596     12  AM-REI-PRT-ST                     PIC X.
  6597     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6598     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6599     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6600     12  AM-REI-GROUP-A                    PIC X(6).
  6601     12  AM-REI-MORT                       PIC X(4).
  6602     12  AM-REI-PRT-OW                     PIC X.
  6603     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6604     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6605     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6606     12  AM-REI-GROUP-B                    PIC X(6).
  6607
  6608     12  AM-TRUST-TYPE                     PIC X(2).
  6609
  6610     12  AM-EMPLOYER-STMT-USED             PIC X.
  6611     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6612
  6613     12  AM-STD-AH-TYPE                    PIC XX.
  6614     12  AM-EARN-METHODS.
  6615         16  AM-EARN-METHOD-R              PIC X.
  6616             88 AM-REF-RL-R78                 VALUE 'R'.
  6617             88 AM-REF-RL-PR                  VALUE 'P'.
  6618             88 AM-REF-RL-MEAN                VALUE 'M'.
  6619             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6620         16  AM-EARN-METHOD-L              PIC X.
  6621             88 AM-REF-LL-R78                 VALUE 'R'.
  6622             88 AM-REF-LL-PR                  VALUE 'P'.
  6623             88 AM-REF-LL-MEAN                VALUE 'M'.
  6624             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6625         16  AM-EARN-METHOD-A              PIC X.
  6626             88 AM-REF-AH-R78                 VALUE 'R'.
  6627             88 AM-REF-AH-PR                  VALUE 'P'.
  6628             88 AM-REF-AH-MEAN                VALUE 'M'.
  6629             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6630             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6631             88 AM-REF-AH-NET                 VALUE 'N'.
  6632
  6633     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6634     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6635     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6636
  6637     12  AM-RET-Y-N                        PIC X.
  6638     12  AM-RET-P-E                        PIC X.
  6639     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6640     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6641     12  AM-RET-GRP                        PIC X(6).
  6642     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6643         16  AM-POOL-PRIME                 PIC XXX.
  6644         16  AM-POOL-SUB                   PIC XXX.
  6645     12  AM-RETRO-EARNINGS.
  6646         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL050.cbl
  6647         16  AM-RET-EARN-L                 PIC X.
  6648         16  AM-RET-EARN-A                 PIC X.
  6649     12  AM-RET-ST-TAX-USE                 PIC X.
  6650         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6651         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6652     12  AM-RETRO-BEG-EARNINGS.
  6653         16  AM-RET-BEG-EARN-R             PIC X.
  6654         16  AM-RET-BEG-EARN-L             PIC X.
  6655         16  AM-RET-BEG-EARN-A             PIC X.
  6656     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6657     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6658
  6659     12  AM-USER-SELECT-OPTIONS.
  6660         16  AM-USER-SELECT-1              PIC X(10).
  6661         16  AM-USER-SELECT-2              PIC X(10).
  6662         16  AM-USER-SELECT-3              PIC X(10).
  6663         16  AM-USER-SELECT-4              PIC X(10).
  6664         16  AM-USER-SELECT-5              PIC X(10).
  6665
  6666     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6667
  6668     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6669
  6670     12  AM-RPT045A-SWITCH                 PIC X.
  6671         88  RPT045A-OFF                   VALUE 'N'.
  6672
  6673     12  AM-INSURANCE-LIMITS.
  6674         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6675         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6676
  6677     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6678         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6679
  6680     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6681         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6682         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6683
  6684     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6685
  6686     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6687     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6688     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6689     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6690     12  AM-DCC-UEF-STATE                  PIC XX.
  6691     12  FILLER                            PIC XXX.
  6692     12  AM-REPORT-CODE-3                  PIC X(10).
  6693*    12  FILLER                            PIC X(22).
  6694
  6695     12  AM-RESERVE-DATE.
  6696         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6697         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6698         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6699
  6700     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6701     12  AM-NOTIFICATION-TYPES.
  6702         16  AM-NOTIF-OF-LETTERS           PIC X.
  6703         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6704         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL050.cbl
  6705         16  AM-NOTIF-OF-STATUS            PIC X.
  6706
  6707     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6708         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6709         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6710         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6711         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6712
  6713     12  AM-BENEFIT-CONTROLS.
  6714         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6715             20  AM-BENEFIT-CODE           PIC XX.
  6716             20  AM-BENEFIT-TYPE           PIC X.
  6717             20  AM-BENEFIT-REVISION       PIC XXX.
  6718             20  AM-BENEFIT-REM-TERM       PIC X.
  6719             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6720             20  FILLER                    PIC XX.
  6721         16  FILLER                        PIC X(80).
  6722
  6723     12  AM-TRANSFER-DATA.
  6724         16  AM-TRANSFERRED-FROM.
  6725             20  AM-TRNFROM-CARRIER        PIC X.
  6726             20  AM-TRNFROM-GROUPING.
  6727                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6728                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6729             20  AM-TRNFROM-STATE          PIC XX.
  6730             20  AM-TRNFROM-ACCOUNT.
  6731                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6732                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6733             20  AM-TRNFROM-DTE            PIC XX.
  6734         16  AM-TRANSFERRED-TO.
  6735             20  AM-TRNTO-CARRIER          PIC X.
  6736             20  AM-TRNTO-GROUPING.
  6737                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6738                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6739             20  AM-TRNTO-STATE            PIC XX.
  6740             20  AM-TRNTO-ACCOUNT.
  6741                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6742                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6743             20  AM-TRNTO-DTE              PIC XX.
  6744         16  FILLER                        PIC X(10).
  6745
  6746     12  AM-SAVED-REMIT-TO                 PIC 99.
  6747
  6748     12  AM-COMM-STRUCTURE-SAVED.
  6749         16  AM-DEFN-1-SAVED.
  6750             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6751                 24  AM-AGT-SV             PIC X(10).
  6752                 24  AM-COM-TYP-SV         PIC X.
  6753                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6754                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6755                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6756                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6757                 24  FILLER                PIC X.
  6758                 24  AM-GL-CODES-SV        PIC X.
  6759                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6760                 24  FILLER                PIC X.
  6761         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6762             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL050.cbl
  6763                 24  FILLER                PIC X(11).
  6764                 24  AM-L-COMA-SV          PIC XXX.
  6765                 24  AM-J-COMA-SV          PIC XXX.
  6766                 24  AM-A-COMA-SV          PIC XXX.
  6767                 24  FILLER                PIC X(6).
  6768
  6769     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6770         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6771            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6772            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6773            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6774
  6775     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6776     12  FILLER                            PIC X(120).
  6777
  6778     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6779         16  AM-CONTROL-NAME               PIC X(30).
  6780         16  AM-EXECUTIVE-ONE.
  6781             20  AM-EXEC1-NAME             PIC X(15).
  6782             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6783                                                          COMP-3.
  6784             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6785                                                          COMP-3.
  6786         16  AM-EXECUTIVE-TWO.
  6787             20  AM-EXEC2-NAME             PIC X(15).
  6788             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6789                                                          COMP-3.
  6790             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6791                                                          COMP-3.
  6792
  6793     12  AM-RETRO-ADDITIONAL-DATA.
  6794         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6795         16  AM-RETRO-PREM-P-E             PIC X.
  6796         16  AM-RETRO-CLMS-P-I             PIC X.
  6797         16  AM-RETRO-RET-BRACKET-LF.
  6798             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6799                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6800                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6801             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6802                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6803                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6804             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6805                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6806                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6807         16  AM-RETRO-RET-BRACKET-AH.
  6808             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6809                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6810                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6811                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6812             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6813                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6814                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6815             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6816                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6817                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6818
  6819     12  AM-COMMENTS.
  6820         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL050.cbl
  6821
  6822     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6823         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6824         16  AM-FLI-BILLING-CODE           PIC X.
  6825         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6826         16  AM-FLI-UNITED-IDENT           PIC X.
  6827         16  AM-FLI-INTEREST-LOST-DATA.
  6828             20  AM-FLI-BANK-NO            PIC X(5).
  6829             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6830             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6831             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6832         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6833             20  AM-FLI-AGT                PIC X(9).
  6834             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6835             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6836         16  FILLER                        PIC X(102).
  6837
  6838     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6839         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6840             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6841             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6842             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6843             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6844             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6845         16  FILLER                          PIC X(10).
  6846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL050.cbl
  6848*    COPY ERCREIN.
  6849******************************************************************
  6850*                                                                *
  6851*                            ERCREIN                             *
  6852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6853*                            VMOD=2.010                          *
  6854*                                                                *
  6855*   ONLINE CREDIT SYSTEM                                         *
  6856*                                                                *
  6857*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6858*                                                                *
  6859*   FILE TYPE = VSAM,KSDS                                        *
  6860*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6861*                                                                *
  6862*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6863*       ALTERNATE PATH = NONE                                    *
  6864*                                                                *
  6865*   LOG = NO                                                     *
  6866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6867*                                                                *
  6868******************************************************************
  6869*                   C H A N G E   L O G
  6870*
  6871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6872*-----------------------------------------------------------------
  6873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6874* EFFECTIVE    NUMBER
  6875*-----------------------------------------------------------------
  6876* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6877* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6878******************************************************************
  6879 01  REINSURANCE-RECORD.
  6880     12  RE-RECORD-ID                      PIC XX.
  6881         88  VALID-RE-ID                      VALUE 'RE'.
  6882
  6883     12  RE-CONTROL-PRIMARY.
  6884         16  RE-COMPANY-CD                 PIC X.
  6885         16  RE-KEY.
  6886             20  RE-CODE                   PIC X.
  6887                 88  RE-TABLE-RECORD          VALUE 'A'.
  6888                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6889             20  RE-TABLE                  PIC XXX.
  6890             20  FILLER                    PIC XXX.
  6891         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6892             20  FILLER                    PIC X.
  6893             20  RE-COMPANY.
  6894                 24  RE-COMP-PRIME         PIC XXX.
  6895                 24  RE-COMP-SUB           PIC XXX.
  6896
  6897     12  RE-MAINT-INFORMATION.
  6898         16  RE-LAST-MAINT-DT              PIC XX.
  6899         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6900         16  RE-LAST-MAINT-USER            PIC X(4).
  6901         16  FILLER                        PIC X(10).
  6902
  6903     12  RE-TABLE-DATA.
  6904         16  RE-100-COMP                   PIC 99.
  6905
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL050.cbl
  6906         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6907             20  RE-REI-COMP-NO.
  6908                 24  RE-REI-COMP           PIC XXX.
  6909                 24  RE-REI-COMP-SUB       PIC XXX.
  6910             20  RE-LF-QC                  PIC X.
  6911             20  RE-AH-QC                  PIC X.
  6912             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6913             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6914             20  RE-LFAGE-LO               PIC 99.
  6915             20  RE-LFAGE-HI               PIC 99.
  6916             20  RE-AHAGE-LO               PIC 99.
  6917             20  RE-AHAGE-HI               PIC 99.
  6918             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6919             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6920             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6921             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6922             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6923             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6924             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6925             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6926             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6927             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6928             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6929             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6930             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6931             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6932             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6933             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6934             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6935             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6936             20  RE-LF-BEN-CODE            PIC X.
  6937             20  RE-AH-BEN-CODE            PIC X.
  6938             20  RE-INTERACTIVE            PIC X.
  6939             20  RE-REMAINING              PIC X.
  6940             20  RE-LF-RUNOFF-SW           PIC X.
  6941             20  RE-AH-RUNOFF-SW           PIC X.
  6942             20  FILLER                    PIC X(19).
  6943
  6944         16  RE-COMP-INFO-END              PIC X(6).
  6945         16  RE-NSP-ST-CD-LF               PIC XX.
  6946         16  RE-NSP-ST-CD-AH               PIC XX.
  6947         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6948             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6949
  6950         16  FILLER                        PIC X(27).
  6951
  6952     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6953         16  RE-NAME                       PIC X(30).
  6954         16  RE-LF-PE                      PIC X.
  6955         16  RE-AH-PE                      PIC X.
  6956         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6957         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6958         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6959         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6960         16  RE-PRT-ST                     PIC X.
  6961         16  RE-PRT-OW                     PIC X.
  6962         16  RE-MORT-CODE                  PIC X(4).
  6963         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL050.cbl
  6964         16  RE-ZERO-LF-FEE                PIC X.
  6965         16  RE-ZERO-AH-FEE                PIC X.
  6966         16  RE-CEDE-NAME                  PIC X(30).
  6967         16  RE-LF-COMM                    PIC X.
  6968         16  RE-AH-COMM                    PIC X.
  6969         16  RE-LF-TAX                     PIC X.
  6970         16  RE-AH-TAX                     PIC X.
  6971         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6972         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6973         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6974
  6975         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6976             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6977
  6978         16  RE-LF-CEDING-FEE-BRACKETS.
  6979             20  RE-LF-FEE-METHOD          PIC X.
  6980                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6981                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6982                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6983                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6984             20  RE-LF-FEE-BASIS           PIC X.
  6985                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6986                 88  RE-LF-NET-CEDED               VALUE '2'.
  6987                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6988                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6989                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6990                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6991                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6992                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6993             20  FILLER                    PIC XXX.
  6994             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6995                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6996                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6997
  6998         16  RE-AH-CEDING-FEE-BRACKETS.
  6999             20  RE-AH-FEE-METHOD          PIC X.
  7000                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7001                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7002                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7003                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7004             20  RE-AH-FEE-BASIS           PIC X.
  7005                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7006                 88  RE-AH-NET-CEDED               VALUE '2'.
  7007                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7008                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7009                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7010                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7011                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7012                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7013             20  FILLER                    PIC XXX.
  7014             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7015                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7016                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7017
  7018         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7019
  7020         16  RE-OLD-CEDING-STMT            PIC X.
  7021
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL050.cbl
  7022         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7023         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7024         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7025         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7026         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7027         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7028         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7029         16  RE-MORT-SW                    PIC X.
  7030         16  RE-CEDING-TYPE-FLAG           PIC X.
  7031             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7032             88  RE-CEDED                          VALUE 'C'.
  7033             88  RE-ASSUMED                        VALUE 'A'.
  7034             88  RE-PHANTOM                        VALUE 'P'.
  7035
  7036         16  RE-CEDING-STMT-OPT-A          PIC X.
  7037             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7038         16  RE-CEDING-STMT-OPT-B          PIC X.
  7039             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7040         16  RE-CEDING-STMT-OPT-C          PIC X.
  7041             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7042         16  RE-CEDING-STMT-OPT-D          PIC X.
  7043             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7044         16  RE-CEDING-STMT-OPT-E          PIC X.
  7045             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7046
  7047         16  RE-PRT-CRSV                   PIC X.
  7048
  7049         16  RE-GL-CENTER                  PIC X(4).
  7050
  7051         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7052
  7053         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7054
  7055         16  RE-EARN-STOP-CODE             PIC X.
  7056             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7057             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7058
  7059         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7060             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7061
  7062         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7063         16  FILLER                        PIC X(2281).
  7064
  7065         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7066
  7067******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL050.cbl
  7069*    COPY ERCCTBL.
  7070******************************************************************
  7071*                                                                *
  7072*                                                                *
  7073*                            ERCCTBL                             *
  7074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7075*                            VMOD=2.003
  7076*                                                                *
  7077*   ONLINE CREDIT SYSTEM                                         *
  7078*                                                                *
  7079*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7080*                                                                *
  7081*   FILE TYPE = VSAM,KSDS                                        *
  7082*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7083*                                                                *
  7084*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7085*       ALTERNATE PATH = NONE                                    *
  7086*                                                                *
  7087*   LOG = NO                                                     *
  7088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7089*                                                                *
  7090*                                                                *
  7091******************************************************************
  7092
  7093 01  COMM-TABLE-RECORD.
  7094     12  CT-RECORD-ID                      PIC XX.
  7095         88  VALID-CT-ID                      VALUE 'CT'.
  7096
  7097     12  CT-CONTROL-PRIMARY.
  7098         16  CT-COMPANY-CD                 PIC X.
  7099         16  CT-TABLE                      PIC XXX.
  7100         16  CT-CNTRL-2.
  7101             20  CT-BEN-TYPE               PIC X.
  7102             20  CT-BEN-CODE               PIC XX.
  7103
  7104     12  CT-MAINT-INFORMATION.
  7105         16  CT-LAST-MAINT-DT              PIC XX.
  7106         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7107         16  CT-LAST-MAINT-USER            PIC X(4).
  7108         16  FILLER                        PIC X(31).
  7109
  7110     12  CT-LIMITS.
  7111         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7112
  7113         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7114
  7115         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7116
  7117     12  CT-RATES.
  7118         16  CT-RTX          OCCURS 27 TIMES.
  7119             20  CT-RT                     PIC SV9(5)     COMP-3.
  7120             20  CT-RT-R   REDEFINES
  7121                 CT-RT                     PIC XXX.
  7122
  7123     12  FILLER                            PIC  X(42).
  7124
  7125******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL050.cbl
  7127*    COPY ERCFORM.
  7128******************************************************************
  7129*                                                                *
  7130*                                                                *
  7131*                            ERCFORM.                            *
  7132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7133*                            VMOD=2.003                          *
  7134*                                                                *
  7135*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7136*                                                                *
  7137*    FILE TYPE = VSAM,KSDS                                       *
  7138*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7139*                                                                *
  7140*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7141*                                                                *
  7142*    LOG = YES                                                   *
  7143*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7144******************************************************************
  7145 01  FORM-MASTER.
  7146    12  FO-RECORD-ID                 PIC X(02).
  7147        88  VALID-FO-ID                  VALUE 'FO'.
  7148
  7149    12  FO-CONTROL-PRIMARY.
  7150        16  FO-COMPANY-CD            PIC X(01).
  7151        16  FO-STATE                 PIC X(02).
  7152        16  FO-FORM-ID               PIC X(12).
  7153        16  FO-FORM-EXP-DT           PIC X(02).
  7154
  7155    12  FO-POLICY-FORM-DATA.
  7156        16  FO-IND-GRP-CD            PIC X(01).
  7157        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7158        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7159        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7160        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7161        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7162        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7163        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7164        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7165        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7166        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7167        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7168        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7169        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7170        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7171        16  FO-APP-CERT-USE-CD       PIC X(01).
  7172
  7173    12  FILLER                       PIC X(29).
  7174
  7175    12  FO-FORM-PLAN-TABLE.
  7176        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7177            20  FO-PLAN-TYPE         PIC X(01).
  7178            20  FO-PLAN-ID           PIC X(02).
  7179            20  FO-PLAN-TERM         PIC 9(03).
  7180            20  FO-PLAN-REFUND-METHOD
  7181                                     PIC X.
  7182
  7183    12  FILLER                       PIC X(30).
  7184
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL050.cbl
  7185    12  FO-COMMENTS-AREA.
  7186        16  FO-COMMENT-LINE-1        PIC X(78).
  7187
  7188    12  FILLER                       PIC X(20).
  7189
  7190    12  FO-MAINT-INFORMATION.
  7191        16  FO-LAST-MAINT-DT         PIC X(02).
  7192        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7193        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL050.cbl
  7195*    COPY ELCMSTR.
  7196******************************************************************
  7197*                                                                *
  7198*                            ELCMSTR.                            *
  7199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7200*                            VMOD=2.012                          *
  7201*                                                                *
  7202*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7203*                                                                *
  7204*   FILE TYPE = VSAM,KSDS                                        *
  7205*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7206*                                                                *
  7207*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7208*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7209*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7210*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7211*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7212*                                                 RKP=75,LEN=21  *
  7213*                                                                *
  7214*   **** NOTE ****                                               *
  7215*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7216*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7217*                                                                *
  7218*   LOG = YES                                                    *
  7219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7220******************************************************************
  7221*                   C H A N G E   L O G
  7222*
  7223* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7224*-----------------------------------------------------------------
  7225*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7226* EFFECTIVE    NUMBER
  7227*-----------------------------------------------------------------
  7228* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7229* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7230******************************************************************
  7231 01  CLAIM-MASTER.
  7232     12  CL-RECORD-ID                PIC XX.
  7233         88  VALID-CL-ID         VALUE 'CL'.
  7234
  7235     12  CL-CONTROL-PRIMARY.
  7236         16  CL-COMPANY-CD           PIC X.
  7237         16  CL-CARRIER              PIC X.
  7238         16  CL-CLAIM-NO             PIC X(7).
  7239         16  CL-CERT-NO.
  7240             20  CL-CERT-PRIME       PIC X(10).
  7241             20  CL-CERT-SFX         PIC X.
  7242
  7243     12  CL-CONTROL-BY-NAME.
  7244         16  CL-COMPANY-CD-A1        PIC X.
  7245         16  CL-INSURED-LAST-NAME    PIC X(15).
  7246         16  CL-INSURED-NAME.
  7247             20  CL-INSURED-1ST-NAME PIC X(12).
  7248             20  CL-INSURED-MID-INIT PIC X.
  7249
  7250     12  CL-CONTROL-BY-SSN.
  7251         16  CL-COMPANY-CD-A2        PIC X.
  7252         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL050.cbl
  7253             20  CL-SSN-STATE        PIC XX.
  7254             20  CL-SSN-ACCOUNT      PIC X(6).
  7255             20  CL-SSN-LN3          PIC X(3).
  7256
  7257     12  CL-CONTROL-BY-CERT-NO.
  7258         16  CL-COMPANY-CD-A4        PIC X.
  7259         16  CL-CERT-NO-A4.
  7260             20  CL-CERT-A4-PRIME    PIC X(10).
  7261             20  CL-CERT-A4-SFX      PIC X.
  7262
  7263     12  CL-CONTROL-BY-CCN.
  7264         16  CL-COMPANY-CD-A5        PIC X.
  7265         16  CL-CCN-A5.
  7266             20  CL-CCN.
  7267                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7268                 24  CL-CCN-PRIME-A5 PIC X(12).
  7269             20  CL-CCN-FILLER-A5    PIC X(4).
  7270
  7271     12  CL-INSURED-PROFILE-DATA.
  7272         16  CL-INSURED-BIRTH-DT     PIC XX.
  7273         16  CL-INSURED-SEX-CD       PIC X.
  7274             88  INSURED-IS-MALE        VALUE 'M'.
  7275             88  INSURED-IS-FEMALE      VALUE 'F'.
  7276             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7277         16  CL-INSURED-OCC-CD       PIC X(6).
  7278         16  FILLER                  PIC X(5).
  7279
  7280     12  CL-PROCESSING-INFO.
  7281         16  CL-PROCESSOR-ID         PIC X(4).
  7282         16  CL-CLAIM-STATUS         PIC X.
  7283             88  CLAIM-IS-OPEN          VALUE 'O'.
  7284             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7285         16  CL-CLAIM-TYPE           PIC X.
  7286*            88  AH-CLAIM               VALUE 'A'.
  7287*            88  LIFE-CLAIM             VALUE 'L'.
  7288*            88  PROPERTY-CLAIM         VALUE 'P'.
  7289*            88  IUI-CLAIM              VALUE 'I'.
  7290*            88  GAP-CLAIM              VALUE 'G'.
  7291         16  CL-CLAIM-PREM-TYPE      PIC X.
  7292             88  SINGLE-PREMIUM         VALUE '1'.
  7293             88  O-B-COVERAGE           VALUE '2'.
  7294             88  OPEN-END-COVERAGE      VALUE '3'.
  7295         16  CL-INCURRED-DT          PIC XX.
  7296         16  CL-REPORTED-DT          PIC XX.
  7297         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7298         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7299         16  CL-LAST-PMT-DT          PIC XX.
  7300         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7301         16  CL-PAID-THRU-DT         PIC XX.
  7302         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7303         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7304         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7305         16  CL-PMT-CALC-METHOD      PIC X.
  7306             88  CL-360-DAY-YR          VALUE '1'.
  7307             88  CL-365-DAY-YR          VALUE '2'.
  7308             88  CL-FULL-MONTHS         VALUE '3'.
  7309         16  CL-CAUSE-CD             PIC X(6).
  7310
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL050.cbl
  7311         16  CL-PRIME-CERT-NO.
  7312             20  CL-PRIME-CERT-PRIME PIC X(10).
  7313             20  CL-PRIME-CERT-SFX   PIC X.
  7314
  7315         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7316             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7317             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7318
  7319         16  CL-MICROFILM-NO         PIC X(10).
  7320         16  CL-PROG-FORM-TYPE       PIC X.
  7321         16  CL-LAST-ADD-ON-DT       PIC XX.
  7322
  7323         16  CL-LAST-REOPEN-DT       PIC XX.
  7324         16  CL-LAST-CLOSE-DT        PIC XX.
  7325         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7326             88  FINAL-PAID             VALUE '1'.
  7327             88  CLAIM-DENIED           VALUE '2'.
  7328             88  AUTO-CLOSE             VALUE '3'.
  7329             88  MANUAL-CLOSE           VALUE '4'.
  7330             88  BENEFITS-CHANGED       VALUE 'C'.
  7331             88  SETUP-ERRORS           VALUE 'E'.
  7332         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7333         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7334         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7335             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7336         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7337         16  FILLER                  PIC X.
  7338
  7339     12  CL-CERTIFICATE-DATA.
  7340         16  CL-CERT-ORIGIN          PIC X.
  7341             88  CERT-WAS-ONLINE        VALUE '1'.
  7342             88  CERT-WAS-CREATED       VALUE '2'.
  7343             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7344         16  CL-CERT-KEY-DATA.
  7345             20  CL-CERT-CARRIER     PIC X.
  7346             20  CL-CERT-GROUPING    PIC X(6).
  7347             20  CL-CERT-STATE       PIC XX.
  7348             20  CL-CERT-ACCOUNT.
  7349                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7350                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7351             20  CL-CERT-EFF-DT      PIC XX.
  7352
  7353     12  CL-STATUS-CONTROLS.
  7354         16  CL-PRIORITY-CD          PIC X.
  7355             88  CONFIDENTIAL-DATA      VALUE '8'.
  7356             88  HIGHEST-PRIORITY       VALUE '9'.
  7357         16  CL-SUPV-ATTN-CD         PIC X.
  7358             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7359             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7360         16  CL-PURGED-DT            PIC XX.
  7361         16  CL-RESTORED-DT          PIC XX.
  7362         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7363         16  CL-NEXT-RESEND-DT       PIC XX.
  7364         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7365         16  FILLER                  PIC XX.
  7366         16  CL-LAST-MAINT-DT        PIC XX.
  7367         16  CL-LAST-MAINT-USER      PIC X(4).
  7368         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL050.cbl
  7369         16  CL-LAST-MAINT-TYPE      PIC X.
  7370             88  CLAIM-SET-UP           VALUE ' '.
  7371             88  PAYMENT-MADE           VALUE '1'.
  7372             88  LETTER-SENT            VALUE '2'.
  7373             88  MASTER-WAS-ALTERED     VALUE '3'.
  7374             88  MASTER-WAS-RESTORED    VALUE '4'.
  7375             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7376             88  FILE-CONVERTED         VALUE '6'.
  7377             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7378             88  ERROR-CORRECTION       VALUE 'E'.
  7379         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7380         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7381         16  CL-BENEFICIARY          PIC X(10).
  7382         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7383         16  CL-DENIAL-TYPE          PIC X.
  7384             88  CL-TYPE-DENIAL          VALUE '1'.
  7385             88  CL-TYPE-RESCISSION      VALUE '2'.
  7386             88  CL-TYPE-REFORMATION     VALUE '3'.
  7387             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7388             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7389         16  FILLER                  PIC X(5).
  7390
  7391     12  CL-TRAILER-CONTROLS.
  7392         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7393             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7394             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7395             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7396         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7397         16  FILLER                  PIC XX.
  7398         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7399         16  CL-ADDRESS-TRAILER-CNT.
  7400             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7401                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7402             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7403                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7404             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7405                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7406             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7407                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7408             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7409                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7410             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7411                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7412             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7413                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7414
  7415     12  CL-CV-REFERENCE-NO.
  7416         16  CL-CV-REFNO-PRIME       PIC X(18).
  7417         16  CL-CV-REFNO-SFX         PIC XX.
  7418
  7419     12  CL-FILE-LOCATION            PIC X(4).
  7420
  7421     12  CL-PROCESS-ERRORS.
  7422         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7423             88  NO-FATAL-ERRORS        VALUE ZERO.
  7424         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7425             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7426
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL050.cbl
  7427     12  CL-PRODUCT-CD               PIC X.
  7428
  7429     12  CL-CURRENT-KEY-DATA.
  7430         16  CL-CURRENT-CARRIER      PIC X.
  7431         16  CL-CURRENT-GROUPING     PIC X(6).
  7432         16  CL-CURRENT-STATE        PIC XX.
  7433         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7434
  7435     12  CL-ASSOCIATES               PIC X.
  7436         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7437         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7438         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7439         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7440
  7441     12  CL-ACTIVITY-CODE            PIC 99.
  7442     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7443     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7444
  7445     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7446     12  CL-LAG-REPORT-CODE          PIC 9.
  7447     12  CL-LOAN-TYPE                PIC XX.
  7448     12  CL-LEGAL-STATE              PIC XX.
  7449
  7450*    12  FILLER                      PIC X(5).
  7451     12  CL-YESNOSW                  PIC X.
  7452     12  FILLER                      PIC X(4).
  7453
  7454 01  PLAN-RECORDS.
  7455     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7456     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7457
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL050.cbl
  7459 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7460                          ACCOUNT-MASTER REINSURANCE-RECORD
  7461                          COMM-TABLE-RECORD FORM-MASTER
  7462                          CLAIM-MASTER PLAN-RECORDS.
  7463 0000-DFHEXIT SECTION.
  7464     MOVE '9#                    $   ' TO DFHEIV0.
  7465     MOVE 'EL050' TO DFHEIV1.
  7466     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7467
  7468     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7469
  7470
  7471* EXEC CICS  HANDLE CONDITION
  7472*           ERROR    (9300-ABEND)
  7473*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7474*    END-EXEC.
  7475*    MOVE '"$.J                  ! " #00007466' TO DFHEIV0
  7476     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7478     MOVE X'2220233030303037343636' TO DFHEIV0(25:11)
  7479     CALL 'kxdfhei1' USING DFHEIV0
  7480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7481
  7482
  7483 0000-COPY-PROCEDURE-DIV.
  7484*                          COPY ELC50PD.
  7485******************************************************************
  7486*                                                                *
  7487*                            ELC50PD                             *
  7488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7489*                            VMOD=2.188                          *
  7490*                                                                *
  7491******************************************************************
  7492*                   C H A N G E   L O G
  7493*
  7494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7495*-----------------------------------------------------------------
  7496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7497* EFFECTIVE    NUMBER
  7498*-----------------------------------------------------------------
  7499* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7500* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7501* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7502*                             2709 AND 2718
  7503* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7504* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7505* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7506* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7507* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7508*                                IS OPEN OR CNC DT < PD THRU
  7509* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7510* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7511* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7512* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7513* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7514* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7515* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7516* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL050.cbl
  7517* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7518* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7519* 020906                   PEMA  EXPAND LOAN OFFICER
  7520* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7521* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7522* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7523* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7524* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7525* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7526* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7527* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7528* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7529* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7530* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7531* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7532* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7533* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7534* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7535* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7536* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7537* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7538* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7539* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7540* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7541* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7542* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7543* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7544* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7545*                                UPDATE VIN ON CERT TRAILER
  7546* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7547* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7548* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7549* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7550* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7551* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7552* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7553* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7554* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7555* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7556* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7557* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7558* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7559* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7560* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7561* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7562* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7563* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7564* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7565* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7566* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7567* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7568* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7569* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7570* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7571* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7572* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7573* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7574* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL050.cbl
  7575* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7576* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7577* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7578* 032912  CR2011110200001  PEMA  AHL CHANGES
  7579* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7580* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7581* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7582* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7583* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7584******************************************************************
  7585************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7586******************************************************************
  7587
  7588     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7589
  7590     MOVE SPACES                 TO PB-FATAL-FLAG
  7591                                    PB-FORCE-ER-CD
  7592                                    PB-WARN-ER-CD
  7593                                    PB-OUT-BAL-CD.
  7594
  7595     MOVE SPACE                  TO WS-IG-OVRD-AH
  7596                                    WS-IG-OVRD-LF
  7597                                    WS-IG-OVRD-AM
  7598                                    WS-IG-OVRD
  7599                                    WS-IG-OVRD-AH-PL
  7600                                    WS-IG-OVRD-LF-PL
  7601                                    WS-IG-OVRD-AH-BEN
  7602                                    WS-IG-OVRD-LF-BEN.
  7603
  7604******************************************************************
  7605*************       INITIALIZE COMMON ERRORS       ***************
  7606******************************************************************
  7607
  7608     MOVE +0                     TO PB-NO-OF-ERRORS.
  7609     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7610
  7611******************************************************************
  7612
  7613     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7614     SET JULIAN-TO-BIN           TO TRUE.
  7615*    MOVE 5                      TO DC-OPTION-CODE.
  7616     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7617     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7618
  7619     MOVE ZERO                   TO  SUB4.
  7620
  7621 0040-INITIALIZE-GA-BILL-DT.
  7622
  7623     ADD +1                      TO  SUB4.
  7624
  7625     IF  SUB4 GREATER THAN +5
  7626         GO TO 0050-CHECK-CNTL-FOUND.
  7627
  7628     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7629         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7630
  7631     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7632
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL050.cbl
  7633 0050-CHECK-CNTL-FOUND.
  7634
  7635     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7636        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7637                                         WS-AH-REM-TERM-CALC
  7638                                         EC-CO-REM-TERM-CALC
  7639        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7640        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7641        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7642                                         WS-TOL-AH-CLAIM
  7643        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7644                                         WS-TOL-AH-PREM
  7645                                         EC-CO-TOL-PREM
  7646        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7647                                         WS-TOL-AH-REFUND
  7648                                         EC-CO-TOL-REFUND
  7649        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7650                                         WS-AH-REFUND-OVS-AMT
  7651                                         EC-CO-OVR-SHT-AMT
  7652        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7653                                         WS-TOL-AH-PREM-PCT
  7654                                         EC-CO-TOL-PREM-PCT
  7655        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7656                                         WS-TOL-AH-REFUND-PCT
  7657                                         EC-CO-TOL-REFUND-PCT
  7658        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7659                                         WS-AH-REFUND-OVS-PCT
  7660                                         EC-CO-OVR-SHT-PCT
  7661        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7662        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7663        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7664        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7665        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7666        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7667        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7668        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7669        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7670        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7671        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7672        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7673                                         EC-CO-MONTH-END-DT
  7674        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7675          GO TO 0100-READ-ACCT.
  7676
  7677     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7678     MOVE SPACES                 TO CNTL-ACCESS.
  7679     MOVE '1'                    TO CNTL-REC-TYPE.
  7680     MOVE +0                     TO CNTL-SEQ-NO.
  7681
  7682     MOVE '1' TO RC-SW-1.
  7683     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7684     IF NOT CF-COMPANY-MASTER
  7685         MOVE ZEROS             TO WK-CO-TOL-PREM
  7686                                   WK-CO-TOL-CLAIM
  7687                                   WK-CO-TOL-REFUND
  7688                                   WK-REFUND-OVS-AMT
  7689                                   WK-REFUND-OVS-PCT
  7690                                   WK-CO-TOL-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL050.cbl
  7691                                   WK-CO-TOL-REFUND-PCT
  7692                                   WK-DEFAULT-APR
  7693                                   WK-CO-MAX-CAP
  7694        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7695                                   WK-CR-R78-METHOD
  7696                                   WK-CO-REF-REJECT-SW
  7697                                   WK-CO-PREM-REJECT-SW
  7698                                   WK-REM-TRM-CALC-OPTION
  7699                                   WK-BIRTH-DATE-INPUT
  7700                                   WK-JOINT-AGE-INPUT
  7701        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7702        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7703        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7704        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7705          GO TO 0099-COMPANY-NOT-FOUND.
  7706
  7707     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7708        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7709     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7710        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7711     IF CF-CO-TOL-CAP NOT NUMERIC
  7712        MOVE +0                    TO CF-CO-TOL-CAP.
  7713     IF CF-DEFAULT-APR NOT NUMERIC
  7714        MOVE +0                    TO CF-DEFAULT-APR.
  7715
  7716     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7717     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7718     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7719     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7720     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7721     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7722     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7723     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7724     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7725     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7726     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7727     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7728
  7729     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7730          CF-CO-OVR-SHT-AMT > +0
  7731        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7732
  7733     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7734          CF-CO-OVR-SHT-PCT > +0
  7735        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7736
  7737     IF CF-VALID-REM-TRM-OPTION
  7738         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7739     ELSE
  7740         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7741
  7742     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7743     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7744     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7745     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7746
  7747     GO TO 0050-CHECK-CNTL-FOUND.
  7748
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL050.cbl
  7749 0099-COMPANY-NOT-FOUND.
  7750
  7751     MOVE ER-2616                TO WS-ERROR.
  7752     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7753
  7754 0100-READ-ACCT.
  7755
  7756     MOVE SPACES                 TO DATE-RANGE-SW.
  7757
  7758     IF WK-ACCT-ADDR = ZEROS
  7759        GO TO 0102-ACCT-GETMAIN.
  7760
  7761     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7762     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7763     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7764
  7765     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7766        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7767        GO TO 0105-READ-ACCT
  7768     END-IF
  7769
  7770     IF PB-CARRIER NOT = SPACES
  7771        IF PB-CARRIER NOT = AM-VG-CARRIER
  7772           GO TO 0105-READ-ACCT.
  7773
  7774     IF PB-STATE NOT = SPACES
  7775        IF PB-STATE NOT = AM-VG-STATE
  7776           GO TO 0105-READ-ACCT.
  7777
  7778     IF PB-GROUPING NOT = SPACES
  7779        IF PB-GROUPING NOT = AM-VG-GROUPING
  7780           GO TO 0105-READ-ACCT.
  7781
  7782     MOVE 'X'                 TO DATE-RANGE-SW.
  7783
  7784     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7785        MOVE 'X'                 TO DATE-RANGE-SW
  7786        GO TO 0105-READ-ACCT.
  7787
  7788     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7789        GO TO 0105-READ-ACCT.
  7790
  7791     GO TO 0180-ACCOUNT-FOUND.
  7792
  7793 0102-ACCT-GETMAIN.
  7794     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7795     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7796
  7797 0105-READ-ACCT.
  7798     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7799     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7800     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7801     MOVE PB-STATE               TO ACCT-STATE.
  7802     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7803     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7804
  7805     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7806
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL050.cbl
  7807     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7808
  7809 0110-FIND-ACCT-TOLERANCES-LOOP.
  7810     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7811
  7812     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7813        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7814        GO TO 0199-ACCT-NOT-FOUND
  7815     END-IF
  7816     IF PB-CARRIER NOT = SPACES
  7817        IF PB-CARRIER NOT = AM-VG-CARRIER
  7818           GO TO 0199-ACCT-NOT-FOUND.
  7819
  7820     IF PB-STATE NOT = SPACES
  7821        IF PB-STATE NOT = AM-VG-STATE
  7822           GO TO 0199-ACCT-NOT-FOUND.
  7823
  7824     IF PB-GROUPING NOT = SPACES
  7825        IF PB-GROUPING NOT = AM-VG-GROUPING
  7826           GO TO 0199-ACCT-NOT-FOUND.
  7827
  7828     MOVE 'X'                    TO DATE-RANGE-SW.
  7829
  7830     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7831        MOVE 'X'                 TO DATE-RANGE-SW
  7832        GO TO 0199-ACCT-NOT-FOUND.
  7833
  7834     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7835        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7836
  7837 0180-ACCOUNT-FOUND.
  7838     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7839     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7840     MOVE AM-STATE               TO PB-SV-STATE.
  7841     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7842
  7843     IF AM-CANCEL-FEE  NOT NUMERIC
  7844        MOVE ZEROS TO AM-CANCEL-FEE.
  7845
  7846     IF AM-MAX-MON-BEN NOT NUMERIC
  7847        MOVE ZEROS TO AM-MAX-MON-BEN.
  7848
  7849     IF AM-MAX-TOT-BEN NOT NUMERIC
  7850        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7851
  7852     IF AM-CLP-TOL-PCT NOT NUMERIC
  7853        MOVE +0                  TO AM-CLP-TOL-PCT
  7854     END-IF
  7855     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7856        MOVE +0                  TO AM-SPP-LEASE-COMM
  7857     END-IF
  7858     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7859        MOVE ER-2611             TO   WS-ERROR
  7860        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7861
  7862     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7863        MOVE ER-2621             TO   WS-ERROR
  7864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL050.cbl
  7865
  7866     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7867        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7868        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7869        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7870         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7871
  7872     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7873     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7874     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7875     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7876     IF AM-CLP-TOL-PCT NOT = ZEROS
  7877        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7878     END-IF
  7879     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7880        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7881     END-IF
  7882*    IF PB-COMPANY-ID = 'DCC'
  7883*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7884*                                   WS-ADMIN-FEES
  7885*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7886*          (SUB5 > +10)
  7887*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7888*             AND (AM-A-COM (SUB5) NUMERIC)
  7889*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7890*                + (AM-A-COM (SUB5) * 1000)
  7891*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7892*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7893*                + (AM-A-COM (SUB5) * 1000)
  7894*             END-IF
  7895*             IF AM-COM-TYP (SUB5) = 'N'
  7896*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7897*                + (AM-A-COM (SUB5) * 1000)
  7898*             END-IF
  7899*          END-IF
  7900*       END-PERFORM
  7901*    END-IF
  7902     IF (PB-COMPANY-ID = 'DCC')
  7903        AND (PB-ISSUE)
  7904        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7905        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7906           (SUB5 > +10)
  7907           MOVE +0 TO WS-WK-RATE
  7908           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7909              IF (AM-A-COM (SUB5) NUMERIC)
  7910                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7911                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7912              ELSE
  7913                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7914                 IF PB-ISSUE
  7915                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7916                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7917                 ELSE
  7918                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7919                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7920                 END-IF
  7921                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7922                 MOVE ZEROS             TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL050.cbl
  7923                                           WS-COMMISSION
  7924                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7925                 MOVE '0530'               TO CTBL-SW
  7926                 MOVE ' '                  TO WS-CTBL-READ-SW
  7927                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7928                 IF FIRST-TIME-THROUGH
  7929                    MOVE 'AA'              TO CTBL-BEN-CODE
  7930                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7931                 END-IF
  7932                 IF CTBL-TABLE-FOUND
  7933                    IF PB-ISSUE
  7934                       COMPUTE WS-COMM-CK-AMT =
  7935                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7936                    ELSE
  7937                       COMPUTE WS-COMM-CK-AMT =
  7938                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7939                    END-IF
  7940                    PERFORM 8800-GET-COMP-RATE
  7941                              THRU 8800-EXIT
  7942                 END-IF
  7943              END-IF
  7944              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7945                + (WS-WK-RATE * 1000)
  7946           END-IF
  7947        END-PERFORM
  7948     END-IF
  7949     IF PB-COMPANY-ID EQUAL 'CRI'
  7950         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7951
  7952     IF PB-COMPANY-ID EQUAL 'NCL'
  7953         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7954     END-IF
  7955
  7956     GO TO 0200-READ-CERT.
  7957
  7958 0199-ACCT-NOT-FOUND.
  7959
  7960     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7961
  7962     IF DATE-RANGE-SW NOT = SPACES
  7963        MOVE ER-2601             TO WS-ERROR
  7964        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7965     ELSE
  7966        MOVE ER-2619             TO WS-ERROR
  7967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7968
  7969     GO TO 9990-RETURN.
  7970
  7971 0200-READ-CERT.
  7972
  7973     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7974     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7975     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7976     MOVE PB-SV-STATE            TO CERT-STATE.
  7977     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7978     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7979     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7980
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL050.cbl
  7981     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7982
  7983     IF CERT-WAS-NOT-FOUND
  7984        GO TO 0299-CERT-NOT-FOUND.
  7985
  7986     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7987        MOVE ER-2759             TO WS-ERROR
  7988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7989        GO TO 0298-UNLOCK-RETURN.
  7990
  7991     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7992         MOVE ER-2758            TO WS-ERROR
  7993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7994         GO TO 0298-UNLOCK-RETURN.
  7995
  7996     IF PB-ISSUE
  7997        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7998           IF CERT-WAS-CREATED-FOR-CLAIM
  7999              NEXT SENTENCE
  8000            ELSE
  8001              MOVE ER-2626       TO WS-ERROR
  8002              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8003              GO TO 0298-UNLOCK-RETURN.
  8004
  8005     IF NOT PB-CANCELLATION
  8006        GO TO 0300-CONTINUE-EDIT.
  8007
  8008     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8009     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8010     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8011     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8012     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8013     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8014
  8015     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8016     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8017     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8018     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8019     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8020     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8021     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8022     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8023     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8024
  8025     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8026     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8027     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8028     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8029     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8030     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8031     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8032
  8033     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8034     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8035
  8036     MOVE CM-CREDIT-INTERFACE-SW-1
  8037                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8038     MOVE CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL050.cbl
  8039                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8040
  8041     IF CM-O-B-COVERAGE
  8042         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8043
  8044     IF CM-LIVES NOT NUMERIC
  8045         MOVE ZERO                TO CM-LIVES.
  8046
  8047     IF CM-BILLED NOT NUMERIC
  8048         MOVE ZERO                TO CM-BILLED.
  8049
  8050     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8051         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8052         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8053         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8054         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8055         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8056         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8057         MOVE CM-LIVES             TO PB-CI-LIVES
  8058*The next line causes a problem with my change  I dont think it is
  8059*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8060
  8061     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8062     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8063     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8064     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8065     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8066     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8067
  8068     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8069     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8070     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8071     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8072
  8073     IF CM-LIFE-COMM-PCT NUMERIC
  8074         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8075     ELSE
  8076         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8077
  8078     IF CM-AH-COMM-PCT NUMERIC
  8079         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8080     ELSE
  8081         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8082
  8083     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8084
  8085     IF CM-LOAN-APR       NOT NUMERIC
  8086           MOVE ZERO               TO CM-LOAN-APR.
  8087
  8088     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8089           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8090
  8091     IF CM-LOAN-TERM      NOT NUMERIC
  8092           MOVE ZERO               TO CM-LOAN-TERM.
  8093
  8094     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8095           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8096
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL050.cbl
  8097     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8098           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8099
  8100     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8101     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8102     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8103     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8104     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8105     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8106     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8107     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8108     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8109     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8110     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8111     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8112
  8113     IF CM-STATE = CM-SSN-STATE
  8114         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8115
  8116     IF CM-STATE NOT = CM-MEMB-STATE
  8117         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8118
  8119     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8120
  8121     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8122        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8123        IF CM-ADDL-CLP NOT NUMERIC
  8124           MOVE +0               TO CM-ADDL-CLP
  8125        END-IF
  8126        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8127        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8128           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8129        END-IF
  8130     END-IF
  8131     IF PB-COMPANY-ID = 'DCC'
  8132        MOVE +0                  TO WS-ADMIN-FEES
  8133                                    WS-CSO-ADMIN-FEE
  8134                                    WS-COMM-AND-MFEE
  8135                                    WS-1ST-YR-ALLOW
  8136        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8137           (SUB5 > +10)
  8138           MOVE +0 TO WS-WK-RATE
  8139           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8140              IF (AM-A-COM (SUB5) NUMERIC)
  8141                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8142                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8143              ELSE
  8144                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8145                 IF PB-ISSUE
  8146                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8147                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8148                 ELSE
  8149                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8150                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8151                 END-IF
  8152                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8153                 MOVE ZEROS             TO WS-SUB1
  8154                                           WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL050.cbl
  8155                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8156                 MOVE '0530'               TO CTBL-SW
  8157                 MOVE ' '                  TO WS-CTBL-READ-SW
  8158                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8159                 IF FIRST-TIME-THROUGH
  8160                    MOVE 'AA'              TO CTBL-BEN-CODE
  8161                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8162                 END-IF
  8163                 IF CTBL-TABLE-FOUND
  8164                    IF PB-ISSUE
  8165                       COMPUTE WS-COMM-CK-AMT =
  8166                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8167                    ELSE
  8168                       COMPUTE WS-COMM-CK-AMT =
  8169                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8170                    END-IF
  8171                    PERFORM 8800-GET-COMP-RATE
  8172                              THRU 8800-EXIT
  8173                 END-IF
  8174              END-IF
  8175              IF AM-COM-TYP (SUB5) = 'I'
  8176                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8177                   + (WS-WK-RATE * 1000)
  8178              END-IF
  8179              IF AM-COM-TYP (SUB5) = 'N'
  8180                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8181                   + (WS-WK-RATE * 1000)
  8182              END-IF
  8183              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8184                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8185                   + (WS-WK-RATE * 1000)
  8186              END-IF
  8187              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8188                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8189                   + (WS-WK-RATE * 1000)
  8190              END-IF
  8191           END-IF
  8192        END-PERFORM
  8193     END-IF
  8194     GO TO 0300-CONTINUE-EDIT.
  8195
  8196 0298-UNLOCK-RETURN.
  8197      PERFORM 9250-UNLOCK-RETURN
  8198      GO TO 9990-RETURN.
  8199
  8200 0299-CERT-NOT-FOUND.
  8201
  8202     MOVE '1'                     TO CERT-STATUS-SW.
  8203
  8204     IF PB-COMPANY-ID = 'UCL'
  8205         IF WS-ERROR = ER-2799
  8206             GO TO 3000-CONTINUE-EDIT.
  8207
  8208     IF NOT PB-CANCELLATION
  8209         GO TO 0300-CONTINUE-EDIT.
  8210
  8211     MOVE ER-2726                  TO  WS-ERROR.
  8212     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL050.cbl
  8213     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8214     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8215                                    PB-CI-LF-TERM
  8216                                    PB-C-LF-REM-TERM
  8217                                    PB-CI-AH-TERM
  8218                                    PB-C-AH-REM-TERM
  8219                                    PB-CI-LF-BENEFIT-CD
  8220                                    PB-CI-LF-BENEFIT-AMT
  8221                                    PB-CI-LF-ALT-BENEFIT-AMT
  8222                                    PB-CI-LF-PREMIUM-AMT
  8223                                    PB-CI-LF-ALT-PREMIUM-AMT
  8224                                    PB-CI-AH-BENEFIT-CD
  8225                                    PB-CI-AH-BENEFIT-AMT
  8226                                    PB-CI-AH-PREMIUM-AMT
  8227                                    PB-CI-PAY-FREQUENCY
  8228                                    PB-CI-LOAN-APR
  8229                                    PB-CI-LOAN-TERM
  8230                                    PB-CI-LIFE-COMMISSION
  8231                                    PB-CI-AH-COMMISSION
  8232                                    PB-CI-CURR-SEQ
  8233                                    PB-CI-AH-CANCEL-AMT
  8234                                    PB-CI-LF-CANCEL-AMT
  8235                                    PB-CI-RATE-DEV-PCT-LF
  8236                                    PB-CI-RATE-DEV-PCT-AH
  8237                                    PB-CI-EXTENTION-DAYS
  8238                                    PB-CI-TERM-IN-DAYS
  8239                                    PB-CI-LIVES
  8240                                    PB-CI-LF-CRIT-PER
  8241                                    PB-CI-AH-CRIT-PER
  8242                                    PB-CI-ADDL-CLP
  8243                                    PB-CI-DDF-IU-RATE-UP.
  8244
  8245     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8246                                    PB-CI-AH-SETTLEMENT-DT
  8247                                    PB-CI-DEATH-DT
  8248                                    PB-CI-LF-PRIOR-CANCEL-DT
  8249                                    PB-CI-AH-PRIOR-CANCEL-DT
  8250                                    PB-CI-ENTRY-DT
  8251                                    PB-CI-LF-EXPIRE-DT
  8252                                    PB-CI-AH-EXPIRE-DT
  8253                                    PB-CI-LOAN-1ST-PMT-DT.
  8254
  8255     IF ACCOUNT-MAST-FOUND
  8256        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8257        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8258
  8259     GO TO 3000-CONTINUE-EDIT.
  8260
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL050.cbl
  8262
  8263 0300-CONTINUE-EDIT.
  8264
  8265     IF PB-ISSUE
  8266        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8267            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8268
  8269     IF PB-ISSUE
  8270        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8271            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8272
  8273     IF PB-ISSUE
  8274       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8275          (AM-NO-AH-ONLY)
  8276           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8277               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8278                   MOVE ER-2679 TO WS-ERROR
  8279                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8280
  8281     IF PB-ISSUE
  8282        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8283        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8284        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8285     ELSE
  8286        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8287        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8288        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8289
  8290     MOVE 'N'                    TO PLAN-MASTER-SW
  8291                                    PLAN-MASTER-LIFE-SW
  8292                                    FORM-MASTER-SW
  8293                                    WS-APP-CERT-SW.
  8294
  8295     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8296                                    WS-PL-TOL-LF-REFUND
  8297                                    WS-PL-REF-OVS-AMT
  8298                                    WS-PL-TOL-LF-PREM-PCT
  8299                                    WS-PL-TOL-LF-REFUND-PCT
  8300                                    WS-PL-REF-OVS-PCT
  8301                                    WS-PL-TOL-LF-CLAIM.
  8302
  8303     IF PB-COMPANY-ID = 'NCL'
  8304       IF PB-ISSUE
  8305         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8306             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8307             IF FORM-MASTER-FOUND
  8308                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8309
  8310     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8311        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8312
  8313********************** MON CODE **********************
  8314     IF PB-COMPANY-ID = 'MON'
  8315     IF PB-ISSUE
  8316     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8317        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8318             PB-I-LOAN-APR = ZERO)
  8319               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL050.cbl
  8320******************************************************
  8321
  8322     IF PB-COMPANY-ID = 'NCL'
  8323       IF PB-ISSUE
  8324           IF FORM-MASTER-FOUND
  8325             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8326                AM-DISMBR-COVERAGE
  8327                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8328                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8329                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8330                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8331                                           PB-I-LIFE-BENEFIT-CD.
  8332
  8333     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8334
  8335     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8336         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8337         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8338         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8339         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8340         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8341           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8342             GO TO 0301-LIFE-BENEFIT-SEARCH
  8343         ELSE
  8344             NEXT SENTENCE
  8345     ELSE
  8346         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8347
  8348     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8349     MOVE '4'                    TO CNTL-REC-TYPE.
  8350     MOVE +0                     TO CNTL-SEQ-NO.
  8351     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8352
  8353     MOVE '1' TO RC-SW-2.
  8354     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8355
  8356     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8357        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8358         GO TO 0305-BENEFIT-NOT-FOUND.
  8359
  8360     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8361
  8362 0301-LIFE-BENEFIT-SEARCH.
  8363
  8364     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8365
  8366     IF NO-BENEFIT-FOUND
  8367        GO TO 0305-BENEFIT-NOT-FOUND.
  8368
  8369     IF WS-BEN-CD = '99'
  8370        GO TO 0305-BENEFIT-NOT-FOUND.
  8371
  8372     IF PB-COMPANY-ID = 'NCL'
  8373         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8374             GO TO 0304-LIFE-BENEFIT-FOUND.
  8375
  8376     MOVE +1                     TO SUB5.
  8377     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL050.cbl
  8378
  8379* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8380* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8381     IF PB-COMPANY-ID = 'DMD'
  8382         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8383
  8384 0302-EDIT-ACCT-LF-BENEFITS.
  8385
  8386     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8387        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8388           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8389                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8390           GO TO 03XX-GET-LIFE-ERPLAN.
  8391
  8392     IF SUB5 LESS THAN +20
  8393        ADD +1                   TO SUB5
  8394        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8395
  8396     MOVE +1                     TO SUB5.
  8397
  8398     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8399        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8400
  8401 0303-EDIT-DMD-EXTRA-BENEFITS.
  8402
  8403     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8404        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8405           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8406                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8407           GO TO 03XX-GET-LIFE-ERPLAN.
  8408
  8409     IF SUB5 LESS THAN +30
  8410        ADD +1                   TO SUB5
  8411        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8412
  8413     MOVE +1                     TO SUB5.
  8414
  8415 03XX-EDIT-FOR-NINETY-LF.
  8416
  8417***************************************************************
  8418*                                                             *
  8419*    NINETY BENEFIT PLAN TYPES:                               *
  8420*                                                             *
  8421*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8422*      92 = ALL GROUP REDUCING BENEFITS                       *
  8423*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8424*      94 = ALL GROUP LEVEL BENEFITS                          *
  8425*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8426*           BENEFIT CONTROLS.                                 *
  8427*      99 = ALL BENEFITS                                      *
  8428*                                                             *
  8429***************************************************************
  8430
  8431     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8432                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8433
  8434     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8435       AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL050.cbl
  8436        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8437        GO TO 03XX-GET-LIFE-ERPLAN.
  8438
  8439     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8440       AND
  8441        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8442        IF CF-REDUCING (SUB3)
  8443           IF (PB-I-INDV-GRP-OVRD = 'I')
  8444              OR
  8445           ((AM-IG = '1') AND
  8446           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8447              OR
  8448           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8449           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8450           (AM-IG NOT = '2'))
  8451              GO TO 03XX-GET-LIFE-ERPLAN.
  8452
  8453     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8454       AND
  8455        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8456        IF CF-REDUCING (SUB3)
  8457           IF (PB-I-INDV-GRP-OVRD = 'G')
  8458              OR
  8459           ((AM-IG = '2') AND
  8460           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8461              OR
  8462           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8463           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8464           (AM-IG NOT = '1'))
  8465              GO TO 03XX-GET-LIFE-ERPLAN.
  8466
  8467     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8468       AND
  8469        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8470        IF CF-LEVEL    (SUB3)
  8471           IF (PB-I-INDV-GRP-OVRD = 'I')
  8472              OR
  8473           ((AM-IG = '1') AND
  8474           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8475              OR
  8476           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8477           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8478            (AM-IG NOT = '2'))
  8479              GO TO 03XX-GET-LIFE-ERPLAN.
  8480
  8481     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8482       AND
  8483        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8484        IF CF-LEVEL    (SUB3)
  8485           IF (PB-I-INDV-GRP-OVRD = 'G')
  8486              OR
  8487           ((AM-IG = '2') AND
  8488           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8489              OR
  8490           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8491           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8492           (AM-IG NOT = '1'))
  8493              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL050.cbl
  8494
  8495     IF SUB5 LESS THAN +20
  8496        ADD +1                   TO SUB5
  8497        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8498
  8499     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8500
  8501     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8502        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8503
  8504     MOVE +1                     TO SUB5.
  8505
  8506 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8507
  8508     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8509                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8510
  8511     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8512       AND
  8513        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8514        GO TO 03XX-GET-LIFE-ERPLAN.
  8515
  8516     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8517       AND
  8518        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8519        IF CF-REDUCING (SUB3)
  8520           IF (PB-I-INDV-GRP-OVRD = 'I')
  8521              OR
  8522           ((AM-IG = '1') AND
  8523           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8524              OR
  8525           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8526           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8527           (AM-IG NOT = '2'))
  8528              GO TO 03XX-GET-LIFE-ERPLAN.
  8529
  8530     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8531       AND
  8532        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8533        IF CF-REDUCING (SUB3)
  8534           IF (PB-I-INDV-GRP-OVRD = 'G')
  8535              OR
  8536           ((AM-IG = '2') AND
  8537           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8538              OR
  8539           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8540           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8541           (AM-IG NOT = '1'))
  8542              GO TO 03XX-GET-LIFE-ERPLAN.
  8543
  8544     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8545       AND
  8546        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8547        IF CF-LEVEL    (SUB3)
  8548           IF (PB-I-INDV-GRP-OVRD = 'I')
  8549              OR
  8550           ((AM-IG = '1') AND
  8551           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL050.cbl
  8552              OR
  8553           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8554           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8555            (AM-IG NOT = '2'))
  8556              GO TO 03XX-GET-LIFE-ERPLAN.
  8557
  8558     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8559       AND
  8560        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8561        IF CF-LEVEL    (SUB3)
  8562           IF (PB-I-INDV-GRP-OVRD = 'G')
  8563              OR
  8564           ((AM-IG = '2') AND
  8565           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8566              OR
  8567           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8568           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8569           (AM-IG NOT = '1'))
  8570              GO TO 03XX-GET-LIFE-ERPLAN.
  8571
  8572     IF SUB5 LESS THAN +30
  8573        ADD +1                   TO SUB5
  8574        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8575
  8576     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8577
  8578 03XX-EDIT-FOR-NINETY-LF-CONT.
  8579
  8580     MOVE +99                    TO SUB5.
  8581
  8582     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8583        IF PB-ISSUE
  8584           MOVE ER-1924          TO  WS-ERROR
  8585           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8586
  8587     GO TO 0304-LIFE-BENEFIT-FOUND.
  8588
  8589 03XX-GET-LIFE-ERPLAN.
  8590
  8591     IF WK-PLAN-ADDR EQUAL +0
  8592        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8593
  8594     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8595     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8596     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8597     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8598     MOVE 'Y'                    TO PLAN-MASTER-SW
  8599                                    PLAN-MASTER-LIFE-SW.
  8600     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8601
  8602 03XX-ERPLAN-LIFE-GETMAIN.
  8603
  8604     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8605     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8606
  8607 03XX-ERPLAN-LIFE-READ.
  8608
  8609     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL050.cbl
  8610     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8611     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8612     MOVE PB-SV-STATE            TO PLAN-STATE.
  8613     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8614     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8615     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8616     MOVE WS-SAVE-BENEFIT-REVISION
  8617                                 TO PLAN-REVISION-NO.
  8618
  8619     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8620     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8621
  8622     IF PB-COMPANY-ID = 'NCL'
  8623       IF NOT LF-PLAN-MASTER-FOUND
  8624         IF NOT PB-POLICY-IS-DECLINED  AND
  8625            NOT PB-POLICY-IS-VOIDED
  8626             MOVE  ER-1921         TO  WS-ERROR
  8627             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8628             GO TO 0304-LIFE-BENEFIT-FOUND.
  8629
  8630     IF NOT LF-PLAN-MASTER-FOUND
  8631        GO TO 0304-LIFE-BENEFIT-FOUND.
  8632
  8633 XXXX-CHECK-LF-PLAN-KEY.
  8634
  8635     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8636        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8637        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8638        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8639        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8640        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8641        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8642        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8643        MOVE 'N'                 TO PLAN-MASTER-SW
  8644          GO TO 03XX-ERPLAN-LIFE-READ.
  8645
  8646     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8647
  8648     IF  PB-CANCELLATION
  8649         GO TO  0303-LF-ACCT-BEN-FOUND.
  8650
  8651     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8652        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8653           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8654           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8655              MOVE ER-2644             TO WS-ERROR
  8656              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8657           ELSE
  8658              NEXT SENTENCE
  8659        ELSE
  8660           IF PB-COMPANY-ID NOT = 'NCL'
  8661              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8662                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8663
  8664 0303-LF-ACCT-BEN-FOUND.
  8665
  8666     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8667
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL050.cbl
  8668     IF PL-DEV-CODE NOT = SPACES
  8669        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8670
  8671     IF PL-DEV-PCT NUMERIC AND
  8672        PL-DEV-PCT NOT = ZEROS
  8673        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8674
  8675     IF PL-TOL-PREM-AMT GREATER THAN +0
  8676        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8677
  8678     IF PL-TOL-REF-AMT GREATER THAN +0
  8679        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8680
  8681     IF PL-TOL-PREM-PCT GREATER THAN +0
  8682        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8683
  8684     IF PL-TOL-REF-PCT GREATER THAN +0
  8685        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8686
  8687     IF PL-TOL-CLM-AMT GREATER THAN +0
  8688        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8689
  8690     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8691                          PL-OVER-SHORT-AMT > +0
  8692        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8693
  8694     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8695                          PL-OVER-SHORT-PCT > +0
  8696        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8697
  8698     IF PL-SALES-TAX NUMERIC AND
  8699                          PL-SALES-TAX > +0
  8700         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8701
  8702     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8703        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8704                                    WS-IG-OVRD-AM.
  8705
  8706 0304-LIFE-BENEFIT-FOUND.
  8707
  8708     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8709
  8710     IF PB-ISSUE
  8711        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8712     ELSE
  8713        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8714
  8715     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8716     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8717     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8718     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8719     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8720                                         WS-LF-REFUND-CALC.
  8721
  8722     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8723        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8724
  8725     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL050.cbl
  8726        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8727     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8728
  8729     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8730     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8731     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8732     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8733     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8734     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8735
  8736     IF PB-COMPANY-ID = 'NCL'  AND
  8737        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8738         NEXT SENTENCE
  8739     ELSE
  8740         IF SUB5 NOT GREATER THAN +20
  8741            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8742               MOVE WS-SAVE-BENEFIT-REM-TERM
  8743                                      TO WS-AM-LF-BENE-REM-TERM
  8744                                         EC-BR-LF-REM-TERM-CALC.
  8745
  8746     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8747     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8748
  8749     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8750
  8751 0305-BENEFIT-NOT-FOUND.
  8752
  8753     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8754     MOVE ER-2604                TO WS-ERROR.
  8755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8756
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL050.cbl
  8758
  8759 0310-FIND-AH-BENEFIT-RECORD.
  8760
  8761     MOVE 'N'                    TO PLAN-MASTER-SW
  8762                                    PLAN-MASTER-AH-SW.
  8763
  8764     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8765                                    WS-PL-TOL-AH-REFUND
  8766                                    WS-AH-PL-REF-OVS-AMT
  8767                                    WS-PL-TOL-AH-PREM-PCT
  8768                                    WS-PL-TOL-AH-REFUND-PCT
  8769                                    WS-AH-PL-REF-OVS-PCT
  8770                                    WS-PL-TOL-AH-CLAIM.
  8771     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8772
  8773
  8774     if pb-issue
  8775        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8776           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8777        end-if
  8778        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8779           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8780           GO TO 0399-BENEFIT-NOT-FOUND
  8781        end-if
  8782     end-if
  8783
  8784     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8785        GO TO 0400-FIND-CARRIER.
  8786
  8787     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8788
  8789     IF WK-AH-BEN-ADDR NOT = ZEROS
  8790         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8791         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8792         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8793         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8794           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8795             GO TO 0311-AH-BENEFIT-SEARCH
  8796         ELSE
  8797             NEXT SENTENCE
  8798     ELSE
  8799         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8800
  8801     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8802     MOVE '5'                    TO CNTL-REC-TYPE.
  8803     MOVE +0                     TO CNTL-SEQ-NO.
  8804     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8805
  8806     MOVE '2' TO RC-SW-2.
  8807     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8808
  8809     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8810        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8811          GO TO 0399-BENEFIT-NOT-FOUND.
  8812
  8813     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8814
  8815 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL050.cbl
  8816
  8817     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8818
  8819     IF NO-BENEFIT-FOUND
  8820         GO TO 0399-BENEFIT-NOT-FOUND.
  8821
  8822     IF WS-BEN-CD = '99'
  8823        GO TO 0399-BENEFIT-NOT-FOUND.
  8824
  8825     IF PB-COMPANY-ID  =  'NCL'
  8826         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8827             GO TO 0314-A-H-BENEFIT-FOUND.
  8828
  8829     MOVE +1                     TO SUB5.
  8830     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8831
  8832* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8833* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8834     IF PB-COMPANY-ID = 'DMD'
  8835         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8836
  8837 0312-EDIT-ACCT-AH-BENEFITS.
  8838
  8839     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8840        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8841           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8842                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8843           GO TO 03XX-GET-AH-ERPLAN.
  8844
  8845     IF SUB5 LESS THAN +20
  8846        ADD +1                   TO SUB5
  8847        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8848
  8849     MOVE +1                     TO SUB5.
  8850
  8851     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8852        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8853
  8854 0313-EDIT-DMD-EXTRA-BENEFITS.
  8855
  8856     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8857        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8858           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8859                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8860           GO TO 03XX-GET-AH-ERPLAN.
  8861
  8862     IF SUB5 LESS THAN +30
  8863        ADD +1                   TO SUB5
  8864        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8865
  8866     MOVE +1                     TO SUB5.
  8867
  8868 03XX-EDIT-FOR-NINETY-AH.
  8869
  8870***************************************************************
  8871*                                                             *
  8872*    NINETY BENEFIT PLAN TYPES:                               *
  8873*                                                             *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL050.cbl
  8874*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8875*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8876*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8877*           BENEFIT CONTROLS.                                 *
  8878*      99 = ALL BENEFITS.                                     *
  8879*                                                             *
  8880***************************************************************
  8881
  8882     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8883                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8884
  8885     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8886       AND
  8887        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8888        GO TO 03XX-GET-AH-ERPLAN.
  8889
  8890     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8891       AND
  8892        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8893           IF (PB-I-INDV-GRP-OVRD = 'I')
  8894              OR
  8895           ((AM-IG = '1') AND
  8896           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8897              OR
  8898           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8899           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8900           (AM-IG NOT = '2'))
  8901              GO TO 03XX-GET-AH-ERPLAN.
  8902
  8903     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8904       AND
  8905        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8906           IF (PB-I-INDV-GRP-OVRD = 'G')
  8907              OR
  8908           ((AM-IG = '2') AND
  8909           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8910              OR
  8911           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8912           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8913           (AM-IG NOT = '1'))
  8914              GO TO 03XX-GET-AH-ERPLAN.
  8915
  8916     IF SUB5 LESS THAN +20
  8917        ADD +1                   TO SUB5
  8918        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8919
  8920     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8921        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8922
  8923     MOVE +1                    TO SUB5.
  8924
  8925 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8926
  8927     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8928                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8929
  8930     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8931       AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL050.cbl
  8932        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8933        GO TO 03XX-GET-AH-ERPLAN.
  8934
  8935     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8936       AND
  8937        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8938           IF (PB-I-INDV-GRP-OVRD = 'I')
  8939              OR
  8940           ((AM-IG = '1') AND
  8941           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8942              OR
  8943           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8944           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8945           (AM-IG NOT = '2'))
  8946              GO TO 03XX-GET-AH-ERPLAN.
  8947
  8948     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8949       AND
  8950        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8951           IF (PB-I-INDV-GRP-OVRD = 'G')
  8952              OR
  8953           ((AM-IG = '2') AND
  8954           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8955              OR
  8956           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8957           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8958           (AM-IG NOT = '1'))
  8959              GO TO 03XX-GET-AH-ERPLAN.
  8960
  8961     IF SUB5 LESS THAN +30
  8962        ADD +1                   TO SUB5
  8963        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8964
  8965 03XX-EDIT-FOR-NINETY-AH-CONT.
  8966
  8967     MOVE +99                    TO SUB5.
  8968
  8969     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8970
  8971     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8972        IF PB-ISSUE
  8973           MOVE ER-1925          TO  WS-ERROR
  8974           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8975
  8976     GO TO 0314-A-H-BENEFIT-FOUND.
  8977
  8978 03XX-GET-AH-ERPLAN.
  8979
  8980     IF WK-PLAN-ADDR EQUAL +0
  8981         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8982
  8983     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8984     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8985     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8986     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8987     MOVE 'Y'                    TO PLAN-MASTER-SW
  8988                                    PLAN-MASTER-AH-SW.
  8989*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL050.cbl
  8990     GO TO 03XX-ERPLAN-AH-READ.
  8991
  8992 03XX-ERPLAN-AH-GETMAIN.
  8993
  8994     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8995     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8996
  8997 03XX-ERPLAN-AH-READ.
  8998
  8999     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9000     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9001     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9002     MOVE PB-SV-STATE            TO PLAN-STATE.
  9003     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9004     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9005     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9006     MOVE WS-SAVE-BENEFIT-REVISION
  9007                                 TO PLAN-REVISION-NO.
  9008
  9009     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9010     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9011
  9012     IF PB-COMPANY-ID = 'NCL'
  9013       IF NOT AH-PLAN-MASTER-FOUND
  9014         IF NOT PB-POLICY-IS-DECLINED  AND
  9015            NOT PB-POLICY-IS-VOIDED
  9016             MOVE  ER-1922         TO  WS-ERROR
  9017             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9018             GO TO 0314-A-H-BENEFIT-FOUND.
  9019
  9020     IF NOT AH-PLAN-MASTER-FOUND
  9021        GO TO 0314-A-H-BENEFIT-FOUND.
  9022
  9023 XXXX-CHECK-AH-PLAN-KEY.
  9024
  9025     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9026        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9027        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9028        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9029        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9030        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9031        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9032        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9033        MOVE 'N'                 TO PLAN-MASTER-SW
  9034          GO TO 03XX-ERPLAN-AH-READ.
  9035
  9036     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9037
  9038     IF  PB-CANCELLATION
  9039         GO TO  0313-AH-ACCT-BEN-FOUND.
  9040
  9041     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9042       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9043          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9044          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9045             MOVE ER-2644             TO WS-ERROR
  9046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9047          ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL050.cbl
  9048             NEXT SENTENCE
  9049       ELSE
  9050          IF PB-COMPANY-ID NOT = 'NCL'
  9051             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9052                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9053
  9054 0313-AH-ACCT-BEN-FOUND.
  9055
  9056     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9057
  9058     IF PL-DEV-CODE NOT = SPACES
  9059        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9060
  9061     IF PL-DEV-PCT NUMERIC AND
  9062        PL-DEV-PCT NOT = ZEROS
  9063        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9064
  9065     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9066        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9067
  9068     IF PL-TOL-REF-AMT NOT EQUAL +0
  9069        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9070
  9071     IF PL-TOL-PREM-PCT GREATER THAN +0
  9072        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9073
  9074     IF PL-TOL-REF-PCT GREATER THAN +0
  9075        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9076
  9077     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9078        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9079
  9080     IF PL-OVER-SHORT-AMT NUMERIC AND
  9081                          PL-OVER-SHORT-AMT > +0
  9082        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9083
  9084     IF PL-OVER-SHORT-PCT NUMERIC AND
  9085                          PL-OVER-SHORT-PCT > +0
  9086        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9087
  9088     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9089        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9090        IF WS-IG-OVRD-AM EQUAL SPACES
  9091            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9092
  9093 0314-A-H-BENEFIT-FOUND.
  9094
  9095     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9096
  9097     IF PB-ISSUE
  9098        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9099       ELSE
  9100        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9101
  9102     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9103     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9104     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9105     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL050.cbl
  9106                                         WS-AH-REFUND-CALC.
  9107
  9108     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9109        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9110
  9111     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9112        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9113     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9114
  9115     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9116     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9117     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9118     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9119     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9120     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9121
  9122     IF PB-COMPANY-ID = 'NCL'  AND
  9123        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9124         NEXT SENTENCE
  9125     ELSE
  9126         IF SUB5 NOT GREATER THAN +20
  9127            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9128                MOVE WS-SAVE-BENEFIT-REM-TERM
  9129                                      TO WS-AM-AH-BENE-REM-TERM
  9130                                         EC-BR-AH-REM-TERM-CALC.
  9131
  9132     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9133     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9134
  9135     GO TO 0400-FIND-CARRIER.
  9136
  9137 0399-BENEFIT-NOT-FOUND.
  9138
  9139     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9140     MOVE ER-2605                TO WS-ERROR.
  9141     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9142
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL050.cbl
  9144
  9145 0400-FIND-CARRIER.
  9146
  9147     MOVE PB-SV-CARRIER          TO WS-CARR.
  9148
  9149     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9150     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9151     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9152     MOVE '6'                    TO CNTL-REC-TYPE.
  9153
  9154*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9155     MOVE SPACE                  TO WS-DMD-RATING-SW
  9156                                    EC-BR-DMD-RATING-SW.
  9157
  9158     MOVE '2'                    TO RC-SW-1.
  9159     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9160
  9161     IF NOT CF-CARRIER-MASTER
  9162        GO TO 0400-CARRIER-NOT-FOUND.
  9163
  9164 0400-BUILD-CARR-TOL.
  9165
  9166     IF CF-CR-TOL-PREM NUMERIC AND
  9167        CF-CR-TOL-PREM GREATER THAN +0
  9168        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9169                                    WS-TOL-AH-PREM.
  9170
  9171     IF CF-CR-TOL-REFUND NUMERIC AND
  9172        CF-CR-TOL-REFUND GREATER THAN +0
  9173        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9174                                    WS-TOL-AH-REFUND.
  9175
  9176     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9177        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9178        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9179                                    WS-AH-REFUND-OVS-AMT.
  9180
  9181     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9182        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9183        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9184                                    WS-AH-REFUND-OVS-PCT.
  9185
  9186     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9187        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9188        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9189                                    WS-TOL-AH-PREM-PCT.
  9190
  9191     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9192        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9193        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9194                                     WS-TOL-AH-REFUND-PCT.
  9195
  9196     IF CF-COMPANY-ID EQUAL 'DMD'
  9197         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9198                                    EC-BR-DMD-RATING-SW.
  9199
  9200     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9201     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL050.cbl
  9202        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9203     END-IF
  9204     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9205        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9206     END-IF
  9207     IF WS-TOL-CLP-PCT = ZEROS
  9208        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9209     END-IF
  9210
  9211     IF WS-SPP-LEASE-COMM = ZEROS
  9212        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9213     END-IF
  9214     GO TO 0400-FIND-ERPDEF.
  9215
  9216 0400-CARRIER-NOT-FOUND.
  9217
  9218     MOVE ER-2602                TO WS-ERROR.
  9219     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9220
  9221 0400-FIND-ERPDEF.
  9222     IF PB-COMPANY-ID = 'DCC'
  9223        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9224        CONTINUE
  9225     ELSE
  9226        GO TO 0400-FIND-ERCOMP
  9227     END-IF
  9228     MOVE ' '                    TO PDEF-MASTER-SW
  9229     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9230     MOVE PB-STATE               TO ERPDEF-STATE
  9231     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9232     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9233     IF PB-ISSUE
  9234        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9235     ELSE
  9236        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9237     END-IF
  9238     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9239     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9240     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9241     IF PDEF-MASTER-FOUND
  9242        MOVE 'N'                 TO PDEF-MASTER-SW
  9243        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9244        IF PDEF-MASTER-FOUND
  9245           IF (ERPDEF-KEY-SAVE (1:16) =
  9246                        PD-CONTROL-PRIMARY (1:16))
  9247              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9248              CONTINUE
  9249           ELSE
  9250              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9251              IF (ERPDEF-KEY-SAVE (1:16) =
  9252                        PD-CONTROL-PRIMARY (1:16))
  9253                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9254                 CONTINUE
  9255              ELSE
  9256                 MOVE 'N'        TO PDEF-MASTER-SW
  9257              END-IF
  9258           END-IF
  9259        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL050.cbl
  9260        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9261     END-IF
  9262     IF PDEF-MASTER-FOUND
  9263        IF PD-TRUNCATED = 'Y'
  9264           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9265        END-IF
  9266     END-IF
  9267     .
  9268 0400-FIND-ERCOMP.
  9269     IF PB-COMPANY-ID = 'DCC'
  9270        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9271           (WS-SUB1 > +10)
  9272           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9273                 OR 'A' OR 'N'
  9274              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9275              MOVE PB-CARRIER    TO COMP-CARRIER
  9276              MOVE PB-GROUPING   TO COMP-GROUPING
  9277              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9278              MOVE AM-AGT (WS-SUB1)
  9279                                 TO COMP-FIN-RESP
  9280              MOVE 'G'           TO COMP-TYPE
  9281              PERFORM 8582-READ-COMPENSATION-MASTER
  9282                                 THRU 8582-EXIT
  9283              IF COMP-MASTER-FOUND
  9284                 IF CO-GA-INACTIVE
  9285                    MOVE ER-2763 TO WS-ERROR
  9286                    PERFORM 9900-ERROR-FORMAT
  9287                                 THRU 9900-EXIT
  9288                    MOVE +11     TO WS-SUB1
  9289                 END-IF
  9290                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9291                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9292                    MOVE ER-2788 TO WS-ERROR
  9293                    PERFORM 9900-ERROR-FORMAT
  9294                                 THRU 9900-EXIT
  9295                    MOVE +11     TO WS-SUB1
  9296                 END-IF
  9297              END-IF
  9298           END-IF
  9299        END-PERFORM
  9300     END-IF
  9301     IF PB-COMPANY-ID = 'DCC'
  9302        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9303           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9304                                    WS-CLP-STATE
  9305        ELSE
  9306           MOVE SPACES           TO PB-I-CLP-STATE
  9307                                    WS-CLP-STATE
  9308        END-IF
  9309     END-IF
  9310
  9311     IF (PB-COMPANY-ID = 'DCC')
  9312        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9313        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9314        CONTINUE
  9315     ELSE
  9316        GO TO 0400-FIND-STATE-RECORD
  9317     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL050.cbl
  9318     MOVE SPACES                 TO WS-CLP-STATE
  9319     MOVE +0                     TO WS-BANK-FEE
  9320                                    WS-BANK-LFEE
  9321                                    WS-BANK-NOCHRGB
  9322
  9323     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9324     IF (PB-ISSUE)
  9325        AND (PB-I-BANK-NUMBER NOT =
  9326            SPACES AND ZEROS AND LOW-VALUES)
  9327        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9328     ELSE
  9329        IF (PB-CANCELLATION)
  9330           AND (PB-CI-BANK-NUMBER NOT =
  9331                SPACES AND ZEROS AND LOW-VALUES)
  9332           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9333        END-IF
  9334     END-IF
  9335     IF COMP-FIN-RESP NOT = LOW-VALUES
  9336        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9337        MOVE PB-CARRIER          TO COMP-CARRIER
  9338        MOVE PB-GROUPING         TO COMP-GROUPING
  9339        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9340        MOVE 'B'                 TO COMP-TYPE
  9341        PERFORM 8582-READ-COMPENSATION-MASTER
  9342                                 THRU 8582-EXIT
  9343        IF COMP-MASTER-FOUND
  9344           IF CO-MAX-BANK-FEE NOT NUMERIC
  9345              MOVE +0            TO CO-MAX-BANK-FEE
  9346           END-IF
  9347           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9348              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9349           END-IF
  9350           IF CO-GA-INACTIVE
  9351              MOVE ER-2763       TO WS-ERROR
  9352              PERFORM 9900-ERROR-FORMAT
  9353                                 THRU 9900-EXIT
  9354           END-IF
  9355           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9356              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9357              MOVE ER-2788 TO WS-ERROR
  9358              PERFORM 9900-ERROR-FORMAT
  9359                                 THRU 9900-EXIT
  9360              MOVE +11     TO WS-SUB1
  9361           END-IF
  9362           IF WS-AH-BEN-CATEGORY = 'G'
  9363              MOVE CO-MAX-BANK-FEE
  9364                                 TO WS-BANK-FEE
  9365                                    PB-I-BANK-FEE
  9366           ELSE
  9367              MOVE CO-MAX-BANK-FEE-LEASE
  9368                                 TO WS-BANK-LFEE
  9369                                    PB-I-BANK-FEE
  9370           END-IF
  9371           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9372              AND (WS-AH-REFUND-CALC = 'G'))
  9373                        OR
  9374              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9375              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL050.cbl
  9376              CONTINUE
  9377           ELSE
  9378              MOVE ER-2789 TO WS-ERROR
  9379              PERFORM 9900-ERROR-FORMAT
  9380                                 THRU 9900-EXIT
  9381           END-IF
  9382           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9383                                    PB-I-CLP-STATE
  9384           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9385           MOVE CO-CARRIER       TO BXRF-CARRIER
  9386           MOVE CO-GROUPING      TO BXRF-GROUPING
  9387           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9388           MOVE BXRF-MAX-REC-LENGTH
  9389                                 TO BXRF-REC-LENGTH
  9390           PERFORM 8584-READ-BANK-CROSS-REF
  9391                                 THRU 8584-EXIT
  9392           IF BXRF-MASTER-FOUND
  9393              MOVE ' '           TO BANK-ACCT-SW
  9394              MOVE BK-BANK-POINTER-CNT
  9395                                 TO BK-BANK-POINTER-CNT
  9396              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9397                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9398                 OR (BANK-ACCT-FOUND)
  9399                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9400                    AND (BK-AM-EXP-DT (WS-SUB1)
  9401                                 > PB-CERT-EFF-DT)
  9402                    AND (BK-AM-EFF-DT (WS-SUB1)
  9403                                 NOT > PB-CERT-EFF-DT)
  9404                    SET BANK-ACCT-FOUND TO TRUE
  9405                 END-IF
  9406              END-PERFORM
  9407              IF NOT BANK-ACCT-FOUND
  9408                 MOVE ZEROS      TO WS-BANK-FEE
  9409                                    WS-BANK-LFEE
  9410                 MOVE ER-2869    TO WS-ERROR
  9411                 PERFORM 9900-ERROR-FORMAT
  9412                                 THRU 9900-EXIT
  9413              ELSE
  9414                 PERFORM 5000-PROCESS-REPS
  9415                                 THRU 5000-EXIT
  9416                 IF AGENT-MASTER-FOUND
  9417                    MOVE +0      TO WS-BANK-FEE
  9418                                    WS-BANK-LFEE
  9419*                   MOVE AG-SPP-FEES (1)
  9420*                                TO PB-I-BANK-FEE
  9421*                                   WS-BANK-FEE
  9422                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9423                       (WS-SUB1 > +10)
  9424                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9425                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9426                       END-IF
  9427                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9428                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9429                       END-IF
  9430                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9431                          AG-SPP-FEES (WS-SUB1)
  9432                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9433                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL050.cbl
  9434                    END-PERFORM
  9435                    IF WS-AH-BEN-CATEGORY = 'G'
  9436                       MOVE WS-BANK-FEE
  9437                                 TO PB-I-BANK-FEE
  9438                    ELSE
  9439                       MOVE WS-BANK-LFEE
  9440                                 TO PB-I-BANK-FEE
  9441                    END-IF
  9442                 END-IF
  9443              END-IF
  9444           END-IF
  9445        ELSE
  9446           MOVE ER-2879          TO WS-ERROR
  9447           PERFORM 9900-ERROR-FORMAT
  9448                                 THRU 9900-EXIT
  9449        END-IF
  9450     ELSE
  9451        MOVE ER-2879             TO WS-ERROR
  9452        PERFORM 9900-ERROR-FORMAT
  9453                                 THRU 9900-EXIT
  9454     END-IF
  9455     IF WS-AH-BEN-CATEGORY = 'G'
  9456        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9457        + WS-BANK-FEE
  9458     ELSE
  9459        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9460        + WS-BANK-LFEE
  9461     END-IF
  9462     .
  9463 0400-FIND-STATE-RECORD.
  9464
  9465     IF WK-STATE-ADDR NOT = ZEROS
  9466         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9467         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9468         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9469         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9470         IF PB-SV-STATE = CF-STATE-CODE
  9471             GO TO 0405-CONTINUE-EDIT
  9472         ELSE
  9473             NEXT SENTENCE
  9474     ELSE
  9475         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9476
  9477     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9478     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9479     MOVE '3'                    TO CNTL-REC-TYPE.
  9480     MOVE +0                     TO CNTL-SEQ-NO.
  9481
  9482     MOVE '3'                    TO RC-SW-2.
  9483     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9484
  9485     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9486        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9487        PB-SV-STATE   NOT = CF-STATE-CODE)
  9488        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9489                                    WS-TOL-AH-CLAIM
  9490                                    WS-MINIMUM-REFUND
  9491                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL050.cbl
  9492                                    WS-TOL-AH-PREM
  9493                                    WS-TOL-LF-REFUND
  9494                                    WS-TOL-AH-REFUND
  9495                                    EC-ST-TOL-PREM-PCT
  9496                                    WS-TOL-LF-PREM-PCT
  9497                                    WS-TOL-AH-PREM-PCT
  9498                                    EC-ST-TOL-REFUND-PCT
  9499                                    WS-TOL-LF-REFUND-PCT
  9500                                    WS-TOL-AH-REFUND-PCT
  9501                                    EC-ST-TOL-PREM
  9502                                    EC-ST-TOL-REFUND
  9503                                    EC-ST-FST-PMT-DAYS-MAX
  9504                                    WS-FREE-LOOK-PERIOD
  9505                                    WS-ST-LF-PREM-TAX
  9506                                    WS-ST-AH-PREM-TAX-I
  9507                                    WS-ST-AH-PREM-TAX-G
  9508                                    WS-BANK-FEE
  9509                                    WS-BANK-LFEE
  9510                                    WS-TOL-CLP-PCT
  9511                                    WS-SPP-LEASE-COMM
  9512        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9513                                    EC-ST-FST-PMT-DAYS-CHG
  9514                                    WS-LF-REM-TERM-CALC
  9515                                    WS-LF-REFUND-CALC
  9516                                    EC-ST-LF-REM-TERM-CALC
  9517                                    EC-ST-LF-REFUND-CALC
  9518                                    WS-AH-REM-TERM-CALC
  9519                                    WS-AH-REFUND-CALC
  9520                                    WS-LF-BEN-CATEGORY
  9521                                    WS-AH-BEN-CATEGORY
  9522                                    WS-CLP-STATE
  9523                                    WS-ST-REFUND-CLAIM-FLAG
  9524                                    EC-ST-AH-REM-TERM-CALC
  9525                                    EC-ST-AH-REFUND-CALC
  9526          GO TO 0499-STATE-NOT-FOUND.
  9527
  9528     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9529
  9530 0405-CONTINUE-EDIT.
  9531
  9532     if pb-company-id = 'AHL'
  9533        continue
  9534     else
  9535        IF PB-CERT-PRIME NOT NUMERIC
  9536           MOVE ER-2722          TO WS-ERROR
  9537           PERFORM 9900-ERROR-FORMAT
  9538                                 THRU 9900-EXIT
  9539        end-if
  9540     END-IF
  9541*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9542*       MOVE +0                  TO SUB3
  9543*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9544*       IF SUB3 > +0
  9545*          MOVE ER-2722          TO WS-ERROR
  9546*          PERFORM 9900-ERROR-FORMAT
  9547*                                THRU 9900-EXIT
  9548*       END-IF
  9549*    END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL050.cbl
  9550*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9551*       IF PB-CERT-PRIME NOT NUMERIC
  9552*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9553*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9554*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9555*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9556*
  9557*          MOVE ER-2722          TO WS-ERROR
  9558*          PERFORM 9900-ERROR-FORMAT
  9559*                                THRU 9900-EXIT
  9560*       END-IF
  9561*    END-IF
  9562
  9563     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9564
  9565     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9566        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9567                                    WS-TOL-AH-CLAIM.
  9568
  9569     IF CF-ST-REFUND-MIN NOT NUMERIC
  9570        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9571
  9572     IF CF-ST-REFUND-MIN NOT = ZEROS
  9573        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9574
  9575     IF CF-ST-TOL-PREM  NOT = ZEROS
  9576        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9577                                    WS-TOL-AH-PREM
  9578        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9579
  9580     IF CF-ST-TOL-REFUND NOT = ZEROS
  9581        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9582                                    WS-TOL-AH-REFUND
  9583        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9584
  9585     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9586        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9587        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9588                                    WS-AH-REFUND-OVS-AMT
  9589                                    EC-ST-OVR-SHT-AMT.
  9590
  9591     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9592        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9593        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9594                                    WS-TOL-LF-PREM-PCT
  9595                                    WS-TOL-AH-PREM-PCT.
  9596
  9597     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9598        CF-ST-TOL-REF-PCT GREATER THAN +0
  9599        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9600                                    WS-TOL-LF-REFUND-PCT
  9601                                    WS-TOL-AH-REFUND-PCT.
  9602
  9603     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9604        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9605        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9606                                    WS-AH-REFUND-OVS-PCT
  9607                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL050.cbl
  9608
  9609     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9610     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9611
  9612     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9613          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9614
  9615     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9616     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9617     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9618
  9619     IF CF-ST-LF-PREM-TAX NUMERIC
  9620        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9621     END-IF
  9622     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9623        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9624     END-IF
  9625     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9626        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9627     END-IF
  9628
  9629     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9630         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9631     END-IF.
  9632
  9633     IF WS-LF-BENEFIT-CD = ZEROS
  9634        GO TO 0410-CHECK-AH.
  9635
  9636     IF CF-ST-RT-CALC NOT = SPACES
  9637        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9638                                    EC-ST-LF-REM-TERM-CALC
  9639     END-IF
  9640
  9641     IF WS-LF-COVERAGE-TYPE = 'R'
  9642        IF WS-LF-EARNINGS-CALC = '5'
  9643           IF CF-ST-RF-LN-CALC > '0'
  9644              MOVE CF-ST-RF-LN-CALC
  9645                                 TO WS-LF-REFUND-CALC
  9646                                    EC-ST-LF-REFUND-CALC
  9647           END-IF
  9648        ELSE
  9649           IF CF-ST-RF-LR-CALC > '0'
  9650              MOVE CF-ST-RF-LR-CALC
  9651                                 TO WS-LF-REFUND-CALC
  9652                                    EC-ST-LF-REFUND-CALC
  9653           END-IF
  9654        END-IF
  9655     ELSE
  9656        IF CF-ST-RF-LL-CALC > '0'
  9657           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9658                                    EC-ST-LF-REFUND-CALC
  9659        END-IF
  9660     END-IF
  9661
  9662     IF CF-ST-RT-CALC NOT = SPACES
  9663        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9664                                    EC-ST-LF-REM-TERM-CALC
  9665     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL050.cbl
  9666
  9667     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9668     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9669
  9670     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9671
  9672     IF NO-BENEFIT-FOUND
  9673        GO TO 0410-CHECK-AH.
  9674
  9675     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9676        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9677                                 TO EC-ST-LF-REM-TERM-CALC
  9678                                    WS-LF-REM-TERM-CALC
  9679     END-IF
  9680
  9681     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9682        MOVE CF-ST-REFUND-CALC (SUB3)
  9683                                 TO WS-LF-REFUND-CALC
  9684                                    EC-ST-LF-REFUND-CALC
  9685     END-IF
  9686*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9687
  9688     .
  9689 0410-CHECK-AH.
  9690
  9691     IF WS-AH-BENEFIT-CD = ZEROS
  9692        GO TO 0500-SET-ACCOUNT.
  9693
  9694     IF CF-ST-RT-CALC NOT = SPACES
  9695        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9696                                    EC-ST-AH-REM-TERM-CALC
  9697     END-IF
  9698
  9699     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9700        IF CF-ST-RF-CP-CALC > '0'
  9701           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9702                                    EC-ST-AH-REFUND-CALC
  9703        END-IF
  9704     ELSE
  9705        IF CF-ST-RF-AH-CALC > '0'
  9706           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9707                                    EC-ST-AH-REFUND-CALC
  9708        END-IF
  9709     END-IF
  9710     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9711     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9712
  9713     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9714
  9715     IF NO-BENEFIT-FOUND
  9716        GO TO 0500-SET-ACCOUNT.
  9717
  9718     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9719        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9720                                 TO WS-AH-REM-TERM-CALC
  9721                                    EC-ST-AH-REM-TERM-CALC
  9722     END-IF
  9723
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL050.cbl
  9724     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9725        MOVE CF-ST-REFUND-CALC (SUB3)
  9726                                 TO WS-AH-REFUND-CALC
  9727                                    EC-ST-AH-REFUND-CALC
  9728     END-IF
  9729
  9730*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9731
  9732     GO TO 0500-SET-ACCOUNT.
  9733
  9734 0499-STATE-NOT-FOUND.
  9735
  9736     MOVE ER-2603                TO WS-ERROR.
  9737     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9738
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL050.cbl
  9740
  9741 0500-SET-ACCOUNT.
  9742*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9743     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9744        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9745        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9746        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9747        MOVE '3'                 TO CNTL-REC-TYPE
  9748        MOVE +0                  TO CNTL-SEQ-NO
  9749
  9750        MOVE '3'                 TO RC-SW-2
  9751        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9752
  9753        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9754           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9755           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9756           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9757                                    WS-ST-AH-PREM-TAX-I
  9758                                    WS-ST-AH-PREM-TAX-G
  9759        ELSE
  9760           IF CF-ST-LF-PREM-TAX NUMERIC
  9761              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9762           END-IF
  9763           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9764              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9765           END-IF
  9766           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9767              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9768           END-IF
  9769        END-IF
  9770        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9771     END-IF
  9772*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9773*  FOR DCC ONLY
  9774     IF PB-COMPANY-ID = 'DCC'
  9775
  9776     MOVE ' '                    TO STAT-MASTER-SW
  9777     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9778     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9779     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9780     MOVE PB-STATE               TO ELSTAT-STATE
  9781     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9782        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9783     END-IF
  9784
  9785     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9786     SET BIN-TO-GREG             TO TRUE
  9787     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9788     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9789     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9790
  9791     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9792     IF STAT-MASTER-FOUND
  9793        MOVE 'N'                 TO STAT-MASTER-SW
  9794        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9795        IF STAT-MASTER-FOUND
  9796           IF (ELSTAT-KEY-SAVE (1:12) =
  9797                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL050.cbl
  9798              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9799                 MOVE 'F'        TO STAT-MASTER-SW
  9800              ELSE
  9801                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9802                 IF (STAT-MASTER-FOUND)
  9803                    AND (ELSTAT-KEY-SAVE (1:12) =
  9804                        SF-CONTROL-PRIMARY (1:12))
  9805                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9806                    MOVE 'F'     TO STAT-MASTER-SW
  9807                 END-IF
  9808              END-IF
  9809           END-IF
  9810        END-IF
  9811     END-IF
  9812
  9813     IF STAT-MASTER-SW = 'F'
  9814        IF SF-ST-LF-PREM-TAX NUMERIC
  9815           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9816        END-IF
  9817        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9818           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9819        END-IF
  9820        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9821           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9822        END-IF
  9823     END-IF
  9824
  9825     END-IF
  9826     IF (PB-COMPANY-ID = 'DCC')
  9827        AND (PB-ISSUE)
  9828        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9829        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9830        AND (AM-GPCD = 06)
  9831        MOVE 'Y'                 TO WS-GOOD-HIN
  9832        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9833           MOVE PB-I-VIN         TO WS-WORK-VIN
  9834           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9835              (V1 > 16)
  9836              IF WS-WORK-VIN (V1:1) NUMERIC
  9837                 MOVE WS-WORK-VIN-N (V1)
  9838                                 TO WS-ROW-B-VAL (V1)
  9839              ELSE
  9840                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9841                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9842                    OR (V2 > 26)
  9843                 END-PERFORM
  9844                 IF V2 < 27
  9845                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9846                 ELSE
  9847                    MOVE 'N'     TO WS-GOOD-HIN
  9848                 END-IF
  9849              END-IF
  9850              COMPUTE WS-ROW-D-VAL (V1) =
  9851                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9852              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9853                 WS-ROW-D-VAL (V1)
  9854           END-PERFORM
  9855           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL050.cbl
  9856           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9857             REMAINDER WS-VIN-REMAINDER
  9858           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9859              CONTINUE
  9860           ELSE
  9861              MOVE 'N'           TO WS-GOOD-HIN
  9862           END-IF
  9863        ELSE
  9864           MOVE 'N'              TO WS-GOOD-HIN
  9865        END-IF
  9866        IF WS-GOOD-HIN NOT = 'Y'
  9867           MOVE ER-3826           TO WS-ERROR
  9868           PERFORM 9900-ERROR-FORMAT
  9869                                 THRU 9900-EXIT
  9870        END-IF
  9871     END-IF
  9872     IF (PB-COMPANY-ID = 'DCC')
  9873        AND (PB-ISSUE)
  9874        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9875        AND (AM-GPCD NOT = 06)
  9876        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9877          MOVE PB-I-VIN          TO WS-WORK-VIN
  9878          MOVE +8                TO V2
  9879          MOVE ZEROS             TO WS-VIN-TOTAL
  9880          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9881           (V1 > 17)
  9882             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9883                MOVE ER-3825     TO WS-ERROR
  9884                PERFORM 9900-ERROR-FORMAT
  9885                                 THRU 9900-EXIT
  9886             ELSE
  9887                IF V1 = 8
  9888                   MOVE 10       TO V2
  9889                END-IF
  9890                IF V1 = 9
  9891                   MOVE 0        TO V2
  9892                END-IF
  9893                IF V1 = 10
  9894                   MOVE 9        TO V2
  9895                END-IF
  9896                IF WS-WORK-VIN (V1:1) NUMERIC
  9897                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9898                    + (WS-WORK-VIN-N (V1) * V2)
  9899                ELSE
  9900                   MOVE WS-WORK-VIN (V1:1)
  9901                                 TO WS-HEX-BYTE
  9902                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9903                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9904                    + (WS-NUM (V3) * V2)
  9905                END-IF
  9906                COMPUTE V2 = V2 - 1
  9907             END-IF
  9908          END-PERFORM
  9909          MOVE ZEROS TO WS-VIN-REMAINDER
  9910          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9911             REMAINDER WS-VIN-REMAINDER
  9912          IF ((WS-WORK-VIN (9:1) = 'X')
  9913             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL050.cbl
  9914                     OR
  9915             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9916             CONTINUE
  9917          ELSE
  9918             MOVE ER-3826        TO WS-ERROR
  9919             PERFORM 9900-ERROR-FORMAT
  9920                                 THRU 9900-EXIT
  9921          END-IF
  9922        ELSE
  9923          MOVE ER-3826           TO WS-ERROR
  9924          PERFORM 9900-ERROR-FORMAT
  9925                                 THRU 9900-EXIT
  9926        END-IF
  9927     END-IF
  9928******************************************************************
  9929******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9930******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9931******* METHODS.
  9932******************************************************************
  9933     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9934        IF PB-CANCELLATION
  9935           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9936              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9937                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9938                IF FORM-MASTER-FOUND
  9939                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9940******************************************************************
  9941
  9942     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9943     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9944
  9945     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9946     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9947     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9948     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9949
  9950
  9951     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9952     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9953     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9954
  9955     IF AM-LF-OB-RATE NOT NUMERIC
  9956         MOVE ZERO               TO AM-LF-OB-RATE.
  9957
  9958     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9959         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9960
  9961     IF AM-AH-OB-RATE NOT NUMERIC
  9962         MOVE ZERO               TO AM-AH-OB-RATE.
  9963
  9964     IF WS-LF-JOINT-INDICATOR = 'J'
  9965         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9966     ELSE
  9967         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9968
  9969     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9970
  9971     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL050.cbl
  9972         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9973
  9974     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9975         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9976                                       WS-IG-OVRD
  9977     ELSE
  9978         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9979             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9980                                       WS-IG-OVRD
  9981         ELSE
  9982             MOVE AM-IG             TO WS-IG-OVRD-AH
  9983                                       WS-IG-OVRD.
  9984
  9985     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9986         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9987                                       WS-IG-OVRD
  9988     ELSE
  9989         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9990             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9991                                       WS-IG-OVRD
  9992         ELSE
  9993             MOVE AM-IG             TO WS-IG-OVRD-LF
  9994                                       WS-IG-OVRD.
  9995
  9996     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9997     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9998     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9999     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10000     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10001
 10002     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10003     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10004     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10005     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10006
 10007     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10008     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10009     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10010     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10011     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10012     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10013     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10014
 10015     IF WS-ACCT-AH-DEV-PCT > +0
 10016        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10017     ELSE
 10018        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10019
 10020     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10021        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10022     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10023        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10024
 10025        IF AM-EARN-METHOD-L = 'S'
 10026            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10027                                        WS-LF-REFUND-CALC.
 10028
 10029        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL050.cbl
 10030            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10031                                        WS-LF-REFUND-CALC.
 10032
 10033     IF WS-LF-COVERAGE-TYPE = 'R'
 10034         IF AM-EARN-METHOD-R = 'R'
 10035            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10036                                    WS-LF-REFUND-CALC.
 10037     IF WS-LF-COVERAGE-TYPE = 'R'
 10038         IF AM-EARN-METHOD-R = 'P'
 10039            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10040                                    WS-LF-REFUND-CALC.
 10041     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10042         IF AM-EARN-METHOD-L = 'R'
 10043            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10044                                    WS-LF-REFUND-CALC.
 10045     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10046         IF AM-EARN-METHOD-L = 'P'
 10047            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10048                                    WS-LF-REFUND-CALC.
 10049     IF WS-LF-COVERAGE-TYPE = 'R'
 10050         IF AM-EARN-METHOD-R = 'A'
 10051            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10052                                    WS-LF-REFUND-CALC.
 10053     IF WS-LF-COVERAGE-TYPE = 'R'
 10054         IF AM-EARN-METHOD-R = 'M'
 10055            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10056                                    WS-LF-REFUND-CALC.
 10057     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10058         IF AM-EARN-METHOD-L = 'A'
 10059            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10060                                    WS-LF-REFUND-CALC.
 10061     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10062         IF AM-EARN-METHOD-L = 'M'
 10063            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10064                                    WS-LF-REFUND-CALC.
 10065
 10066     IF AM-EARN-METHOD-A = 'R'
 10067        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10068                                    WS-AH-REFUND-CALC.
 10069     IF AM-EARN-METHOD-A = 'P'
 10070        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10071                                    WS-AH-REFUND-CALC.
 10072     IF AM-EARN-METHOD-A = 'C'
 10073        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10074                                    WS-AH-REFUND-CALC.
 10075     IF AM-EARN-METHOD-A = 'A'
 10076        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10077                                    WS-AH-REFUND-CALC.
 10078     IF AM-EARN-METHOD-A = 'M'
 10079        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10080                                    WS-AH-REFUND-CALC.
 10081     IF AM-EARN-METHOD-A = 'N'
 10082        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10083                                    WS-AH-REFUND-CALC.
 10084     IF AM-EARN-METHOD-A = 'S'
 10085        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10086                                    WS-AH-REFUND-CALC.
 10087
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL050.cbl
 10088     IF AM-TOL-PREM NOT = ZEROS
 10089        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10090                                    WS-TOL-AH-PREM.
 10091
 10092     IF AM-OVR-SHT-AMT NUMERIC AND
 10093                  AM-OVR-SHT-AMT > 0
 10094        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10095                                    EC-AM-LF-OVR-SHT-AMT
 10096                                    WS-AH-REFUND-OVS-AMT
 10097                                    EC-AM-AH-OVR-SHT-AMT.
 10098
 10099     IF AM-OVR-SHT-PCT NUMERIC AND
 10100                    AM-OVR-SHT-PCT > 0
 10101        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10102                                    EC-AM-LF-OVR-SHT-PCT
 10103                                    WS-AH-REFUND-OVS-PCT
 10104                                    EC-AM-AH-OVR-SHT-PCT.
 10105
 10106     IF AM-TOL-REF-PCT NUMERIC AND
 10107                  AM-TOL-REF-PCT > 0
 10108        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10109                                    WS-TOL-AH-REFUND-PCT.
 10110
 10111     IF AM-TOL-REF  NOT = ZEROS  AND
 10112                  AM-TOL-REF NUMERIC
 10113        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10114                                    EC-AM-LF-TOL-REFUND
 10115                                    WS-TOL-AH-REFUND
 10116                                    EC-AM-AH-TOL-REFUND.
 10117
 10118     IF AM-TOL-CLM  NOT = ZEROS
 10119        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10120                                    WS-TOL-AH-CLAIM.
 10121
 10122     IF AM-CLP-TOL-PCT NOT NUMERIC
 10123        MOVE +0                  TO AM-CLP-TOL-PCT
 10124     END-IF
 10125
 10126     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10127        MOVE +0                  TO AM-SPP-LEASE-COMM
 10128     END-IF
 10129     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10130        MOVE WS-PL-TOL-LF-PREM-PCT
 10131                                 TO WS-TOL-LF-PREM-PCT.
 10132
 10133     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10134        MOVE WS-PL-TOL-AH-PREM-PCT
 10135                                 TO WS-TOL-AH-PREM-PCT.
 10136
 10137     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10138        MOVE WS-PL-TOL-LF-REFUND-PCT
 10139                                 TO WS-TOL-LF-REFUND-PCT.
 10140
 10141     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10142        MOVE WS-PL-TOL-AH-REFUND-PCT
 10143                                 TO WS-TOL-AH-REFUND-PCT.
 10144
 10145     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL050.cbl
 10146        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10147
 10148     IF WS-PL-REF-OVS-PCT > +0
 10149        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10150
 10151     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10152        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10153     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10154        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10155     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10156        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10157     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10158        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10159     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10160        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10161     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10162        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10163
 10164     IF WS-AH-PL-REF-OVS-AMT > +0
 10165        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10166
 10167     IF WS-AH-PL-REF-OVS-PCT > +0
 10168        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10169
 10170     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10171     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10172
 10173     IF PB-CANCELLATION
 10174        GO TO 3000-CONTINUE-EDIT.
 10175
 10176     MOVE +1 TO SUB1.
 10177     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10178     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10179
 10180     IF CF-COMPANY-ID = 'DMD'
 10181       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10182         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10183        ELSE
 10184         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10185
 10186  0525-FIND-ACCT-COMM.
 10187     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10188        NEXT SENTENCE
 10189      ELSE
 10190         ADD +1 TO SUB1
 10191         IF SUB1 LESS +11
 10192            GO TO 0525-FIND-ACCT-COMM
 10193          ELSE
 10194             GO TO 0560-EDIT-CONTINUE.
 10195
 10196     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10197     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10198                                    PB-I-LIFE-COMMISSION.
 10199***  IF PB-COMPANY-ID = 'CRI'
 10200     IF PB-PREM-ACCTNG-ONLY
 10201         GO TO 0560-EDIT-CONTINUE.
 10202
 10203     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL050.cbl
 10204     MOVE ' '    TO WS-CTBL-READ-SW.
 10205
 10206
 10207 0530-GET-AH-COMP.
 10208     IF NO-AH-COVERAGE  OR
 10209        NO-AH-BENEFIT-MATCH
 10210           GO TO 0540-NEXT-READ-STEP.
 10211
 10212     IF AM-A-COM (SUB1) NUMERIC
 10213        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10214         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10215         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10216         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10217         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10218     ELSE
 10219          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10220          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10221          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10222          MOVE ZEROS             TO WS-SUB1
 10223                                    WS-COMMISSION
 10224          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10225          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10226          IF WS-COMMISSION > ZEROS
 10227             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10228             GO TO 0540-NEXT-READ-STEP
 10229          END-IF
 10230          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10231          IF CTBL-TABLE-FOUND
 10232             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10233                                        PB-I-AH-TERM
 10234             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10235             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10236             GO TO 0540-NEXT-READ-STEP
 10237          ELSE
 10238             IF FIRST-TIME-THROUGH
 10239                 GO TO 0530-GET-AH-COMP
 10240             ELSE
 10241                 MOVE ER-2609                TO WS-ERROR
 10242                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10243
 10244 0540-NEXT-READ-STEP.
 10245     MOVE '0540' TO CTBL-SW.
 10246     MOVE ' '    TO WS-CTBL-READ-SW.
 10247
 10248 0540-GET-LF-COMP.
 10249     IF NO-LIFE-COVERAGE  OR
 10250        NO-LF-BENEFIT-MATCH
 10251           GO TO 0560-EDIT-CONTINUE.
 10252
 10253     IF WS-LF-JOINT-INDICATOR = 'J'
 10254        IF AM-J-COM (SUB1) NUMERIC
 10255           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10256           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10257           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10258           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10259           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10260        ELSE
 10261           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL050.cbl
 10262           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10263           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10264           MOVE ZEROS                TO WS-SUB1
 10265                                        WS-COMMISSION
 10266           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10267           IF WS-COMMISSION > ZEROS
 10268              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10269              GO TO 0560-EDIT-CONTINUE
 10270           END-IF
 10271           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10272           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10273           IF CTBL-TABLE-FOUND
 10274              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10275              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10276              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10277              GO TO 0560-EDIT-CONTINUE
 10278           ELSE
 10279              IF FIRST-TIME-THROUGH
 10280                  GO TO 0540-GET-LF-COMP
 10281              ELSE
 10282                  MOVE ER-2609                TO WS-ERROR
 10283                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10284                  GO TO 0560-EDIT-CONTINUE.
 10285
 10286     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10287        IF AM-L-COM (SUB1) NUMERIC
 10288           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10289           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10290           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10291           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10292           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10293        ELSE
 10294           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10295           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10296           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10297           MOVE ZEROS                TO WS-SUB1
 10298                                        WS-COMMISSION
 10299           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10300           IF WS-COMMISSION IS GREATER THAN ZEROS
 10301              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10302              GO TO 0560-EDIT-CONTINUE
 10303           END-IF
 10304           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10305           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10306           IF CTBL-TABLE-FOUND
 10307              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10308              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10309              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10310              GO TO 0560-EDIT-CONTINUE
 10311           ELSE
 10312              IF FIRST-TIME-THROUGH
 10313                  GO TO 0540-GET-LF-COMP
 10314              ELSE
 10315                  MOVE ER-2609                TO WS-ERROR
 10316                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10317
 10318*    GO TO 0560-EDIT-CONTINUE.
 10319
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL050.cbl
 10320 0560-EDIT-CONTINUE.
 10321     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10322                                    WS-AH-PMF-COMM
 10323*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10324*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10325     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10326        (SUB1 > +10)
 10327        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10328           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10329           MOVE '0530'           TO CTBL-SW
 10330           MOVE ' '              TO WS-CTBL-READ-SW
 10331           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10332           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10333           MOVE '0540'           TO CTBL-SW
 10334           MOVE ' '              TO WS-CTBL-READ-SW
 10335           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10336        END-IF
 10337     END-PERFORM
 10338     GO TO 0564-EDIT-CONTINUE
 10339     .
 10340 0561-CHECK-AH.
 10341     IF (NO-AH-COVERAGE)
 10342        OR (NO-AH-BENEFIT-MATCH)
 10343        CONTINUE
 10344     ELSE
 10345        IF (AM-A-COM (SUB1) NUMERIC)
 10346           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10347           IF (AM-COM-TYP (SUB1) = 'A')
 10348              AND (WS-AH-PMF-COMM = ZEROS)
 10349              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10350           END-IF
 10351           CONTINUE
 10352        ELSE
 10353           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10354           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10355           MOVE PB-AH-OVERRIDE-L1
 10356                                 TO CTBL-BEN-TYPE
 10357           MOVE ZEROS            TO WS-SUB1
 10358                                    WS-COMMISSION
 10359           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10360           PERFORM 8300-READ-CTBL-TABLE
 10361                                 THRU 8300-EXIT
 10362           IF CTBL-TABLE-FOUND
 10363              IF (AM-COM-TYP (SUB1) = 'A')
 10364                 AND (WS-AH-PMF-COMM = ZEROS)
 10365                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10366                                        PB-I-AH-TERM
 10367                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10368                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10369              END-IF
 10370              CONTINUE
 10371           ELSE
 10372              IF FIRST-TIME-THROUGH
 10373                 GO TO 0561-CHECK-AH
 10374              ELSE
 10375                 MOVE ER-2609    TO WS-ERROR
 10376                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10377              END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL050.cbl
 10378           END-IF
 10379        END-IF
 10380     END-IF
 10381     .
 10382 0561-EXIT.
 10383     EXIT.
 10384 0563-CHECK-LF.
 10385     IF (NO-LIFE-COVERAGE)
 10386        OR (NO-LF-BENEFIT-MATCH)
 10387        CONTINUE
 10388     ELSE
 10389        IF WS-LF-JOINT-INDICATOR = 'J'
 10390           IF AM-J-COM (SUB1) NUMERIC
 10391              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10392              IF (AM-COM-TYP (SUB1) = 'A')
 10393                 AND (WS-LF-PMF-COMM = ZEROS)
 10394                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10395              END-IF
 10396              CONTINUE
 10397           ELSE
 10398              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10399              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10400              MOVE PB-LIFE-OVERRIDE-L1
 10401                                 TO CTBL-BEN-TYPE
 10402              MOVE ZEROS         TO WS-SUB1
 10403                                    WS-COMMISSION
 10404              MOVE AM-J-COMA (SUB1)
 10405                                 TO CTBL-TABLE
 10406              PERFORM 8300-READ-CTBL-TABLE
 10407                                 THRU 8300-EXIT
 10408              IF CTBL-TABLE-FOUND
 10409                 IF (AM-COM-TYP (SUB1) = 'A')
 10410                    AND (WS-LF-PMF-COMM = ZEROS)
 10411                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10412                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10413                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10414                 END-IF
 10415                 CONTINUE
 10416              ELSE
 10417                 IF FIRST-TIME-THROUGH
 10418                    GO TO 0563-CHECK-LF
 10419                 ELSE
 10420                    MOVE ER-2609 TO WS-ERROR
 10421                    PERFORM 9900-ERROR-FORMAT
 10422                                 THRU 9900-EXIT
 10423*                   GO TO 0560-EDIT-CONTINUE
 10424                 END-IF
 10425              END-IF
 10426           END-IF
 10427        ELSE
 10428           IF AM-L-COM (SUB1) NUMERIC
 10429              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10430              IF (AM-COM-TYP (SUB1) = 'A')
 10431                 AND (WS-LF-PMF-COMM = ZEROS)
 10432                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10433              END-IF
 10434              CONTINUE
 10435           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL050.cbl
 10436              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10437              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10438              MOVE PB-LIFE-OVERRIDE-L1
 10439                                 TO CTBL-BEN-TYPE
 10440              MOVE ZEROS         TO WS-SUB1
 10441                                    WS-COMMISSION
 10442              MOVE AM-L-COMA (SUB1)
 10443                                 TO CTBL-TABLE
 10444              PERFORM 8300-READ-CTBL-TABLE
 10445                                 THRU 8300-EXIT
 10446              IF CTBL-TABLE-FOUND
 10447                 CONTINUE
 10448              ELSE
 10449                 IF FIRST-TIME-THROUGH
 10450                    GO TO 0563-CHECK-LF
 10451                 ELSE
 10452                    MOVE ER-2609 TO WS-ERROR
 10453                    PERFORM 9900-ERROR-FORMAT
 10454                                 THRU 9900-EXIT
 10455                 END-IF
 10456              END-IF
 10457           END-IF
 10458        END-IF
 10459     END-IF
 10460     .
 10461 0563-EXIT.
 10462     EXIT.
 10463 0564-EDIT-CONTINUE.
 10464
 10465     IF  PB-COMPANY-ID EQUAL 'DMD'
 10466         IF PB-I-NUM-BILLED EQUAL ZEROS
 10467            MOVE ER-8148       TO WS-ERROR
 10468            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10469
 10470*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10471*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10472*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10473*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10474*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10475*         IF NO-CONVERSION-ERROR
 10476*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10477*         ELSE
 10478*             IF PB-COMPANY-ID EQUAL 'HAN'
 10479*                 MOVE ZEROS     TO PB-I-AGE.
 10480     IF PB-I-BIRTHDAY > LOW-VALUES
 10481        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10482        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10483        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10484        PERFORM 8500-DATE-CONVERT
 10485                                 THRU 8500-EXIT
 10486        IF NO-CONVERSION-ERROR
 10487           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10488           IF PB-I-AGE > ZEROS
 10489              IF WS-WORK-AGE NOT = PB-I-AGE
 10490                 MOVE ER-9501    TO WS-ERROR
 10491                 PERFORM 9900-ERROR-FORMAT
 10492                                 THRU 9900-EXIT
 10493              END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL050.cbl
 10494           ELSE
 10495              MOVE WS-WORK-AGE   TO PB-I-AGE
 10496           END-IF
 10497        END-IF
 10498     END-IF
 10499     IF PB-I-AGE = ZEROS
 10500        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10501           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10502
 10503     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10504                                   WS-AH-EDIT-AGE.
 10505
 10506     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10507        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10508        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10509        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10510        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10511        IF NO-CONVERSION-ERROR
 10512           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10513           IF PB-I-JOINT-AGE > 0
 10514              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10515                 MOVE ER-9503    TO WS-ERROR
 10516                 PERFORM 9900-ERROR-FORMAT
 10517                                 THRU 9900-EXIT
 10518              END-IF
 10519           ELSE
 10520              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10521           END-IF
 10522        ELSE
 10523           MOVE ZEROS            TO PB-I-JOINT-AGE
 10524        END-IF
 10525     END-IF
 10526     IF PB-I-JOINT-AGE NOT NUMERIC
 10527        MOVE ZERO               TO PB-I-JOINT-AGE.
 10528
 10529     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10530        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10531           (WS-AH-JOINT-INDICATOR = 'J')
 10532           IF PB-I-JOINT-AGE = ZEROS
 10533               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10534           END-IF
 10535        END-IF
 10536     END-IF
 10537
 10538     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10539     IF WS-LF-JOINT-INDICATOR = 'J'
 10540        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10541        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10542            IF  PB-I-JOINT-AGE = ZERO
 10543                MOVE ER-2686       TO WS-ERROR
 10544                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10545            ELSE
 10546                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10547                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10548                    IF PB-COMPANY-ID NOT = 'LBL'
 10549                        MOVE ER-2685    TO WS-ERROR
 10550                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10551
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL050.cbl
 10552     IF WS-AH-JOINT-INDICATOR = 'J'
 10553        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10554            IF  PB-I-JOINT-AGE = ZERO
 10555                MOVE ER-2686       TO WS-ERROR
 10556                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10557            ELSE
 10558                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10559                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10560                                           WS-EDIT-AGE
 10561                    IF PB-COMPANY-ID NOT = 'LBL'
 10562                        MOVE ER-2685    TO WS-ERROR
 10563                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10564
 10565******************************************************************
 10566*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10567******************************************************************
 10568
 10569     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10570        (WS-AH-SPECIAL-CALC-CD = 'O')
 10571        NEXT SENTENCE
 10572     ELSE
 10573        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10574          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10575           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10576            WS-AH-JOINT-INDICATOR = 'J')  AND
 10577           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10578            MOVE ER-2627             TO WS-ERROR
 10579            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10580
 10581     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10582        (WS-AH-SPECIAL-CALC-CD = 'O')
 10583         NEXT SENTENCE
 10584     ELSE
 10585         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10586            WS-AH-JOINT-INDICATOR = 'J'
 10587             IF PB-I-JOINT-INSURED = SPACES
 10588                 IF PB-COMPANY-ID NOT = 'JAL'
 10589                     MOVE ER-2696    TO WS-ERROR
 10590                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10591
 10592     IF PB-COMPANY-ID NOT = 'BOA'
 10593        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10594           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10595           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10596               PB-I-JOINT-INSURED NOT = SPACES)
 10597                MOVE ER-2691         TO WS-ERROR
 10598                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10599
 10600     IF PB-COMPANY-ID = 'BOA'
 10601        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10602           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10603            IF PB-I-JOINT-AGE NOT = ZEROS
 10604                MOVE ER-2691         TO WS-ERROR
 10605                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10606
 10607     IF PB-COMPANY-ID = 'CRI'
 10608        IF PB-I-SIG-SW = 'J'
 10609           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL050.cbl
 10610              WS-AH-JOINT-INDICATOR NOT = 'J'
 10611              MOVE ER-2675       TO WS-ERROR
 10612              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10613
 10614     IF PB-COMPANY-ID = 'CRI'
 10615        IF PB-I-SIG-SW = 'S'
 10616           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10617              WS-AH-JOINT-INDICATOR = 'J'
 10618              MOVE ER-2676       TO WS-ERROR
 10619              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10620
 10621     IF PB-COMPANY-ID = 'CVL'
 10622         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10623            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10624              MOVE ER-2783           TO WS-ERROR
 10625              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10626     IF (WS-LF-JOINT-INDICATOR = 'J')
 10627        AND (WS-AH-JOINT-INDICATOR = 'J')
 10628        AND (PB-I-LF-TERM > 120)
 10629        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10630        MOVE ER-2783             TO WS-ERROR
 10631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10632     END-IF
 10633     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10634
 10635     IF PB-I-INDV-GRP-OVRD = 'I'
 10636        MOVE ER-2666             TO WS-ERROR
 10637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10638        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10639
 10640     IF PB-I-INDV-GRP-OVRD = 'G'
 10641        MOVE ER-2666             TO WS-ERROR
 10642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10643        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10644
 10645     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10646        NEXT SENTENCE
 10647     ELSE
 10648        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10649
 10650     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10651        IF WS-ERROR = ER-2666
 10652           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10653           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10654
 10655     IF PB-COMPANY-ID = 'CID'
 10656        IF PB-STATE = 'UT' OR 'MO'
 10657           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10658                 OR '76' OR '77')
 10659                      OR
 10660               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10661                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10662                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10663                   OR '2K' OR '2L'))
 10664              AND PB-I-INDV-GRP-CD = 'I'
 10665              MOVE ER-2721             TO WS-ERROR
 10666              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10667           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL050.cbl
 10668        END-IF
 10669     END-IF
 10670
 10671     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10672     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10673        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10674     ELSE
 10675        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10676     END-IF
 10677
 10678*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10679*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10680     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10681                                    ACCOUNT-AH-CK-SW.
 10682
 10683     IF PB-REISSUED-CERT       OR
 10684        PB-REIN-ONLY-CERT      OR
 10685        PB-POLICY-IS-DECLINED  OR
 10686        PB-POLICY-IS-VOIDED
 10687*       OR PB-MONTHLY-CERT
 10688         GO TO 3000-CONTINUE-EDIT.
 10689
 10690     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10691        IF WS-EDIT-AGE           > +65
 10692           MOVE ER-2709          TO WS-ERROR
 10693           PERFORM 9900-ERROR-FORMAT
 10694                                 THRU 9900-EXIT
 10695        ELSE
 10696           IF WS-EDIT-AGE        > +55
 10697              MOVE ER-2718       TO WS-ERROR
 10698              PERFORM 9900-ERROR-FORMAT
 10699                                 THRU 9900-EXIT
 10700           END-IF
 10701        END-IF
 10702     IF PB-COMPANY-ID = 'DCC'
 10703        IF WS-EDIT-AGE           > +65
 10704           MOVE ER-2709          TO WS-ERROR
 10705           PERFORM 9900-ERROR-FORMAT
 10706                                 THRU 9900-EXIT
 10707        END-IF
 10708     END-IF
 10709     .
 10710
 10711 0565-LIFE-PLAN-LIMIT-EDITS.
 10712
 10713     IF NOT LF-PLAN-MASTER-FOUND
 10714        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10715                                    EC-AM-LF-MAX-TOT-BEN
 10716        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10717
 10718     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10719
 10720     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10721         IF PL-LM-AGE (1) = ZEROS
 10722             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10723
 10724     IF NO-LF-BENEFIT-MATCH          OR
 10725        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL050.cbl
 10726        WS-LF-SPECIAL-CALC-CD = 'M'
 10727        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10728
 10729     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10730     MOVE +1                     TO SUB2.
 10731
 10732     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10733        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10734           MOVE +5   TO SUB2
 10735           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10736              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10737              (PL-LM-AGE (SUB2) EQUAL +0)
 10738              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10739              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10740
 10741     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10742
 10743     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10744                               + PB-I-LF-ALT-BENEFIT-AMT.
 10745
 10746 0568-CHECK-LIFE-ATT-AGE.
 10747
 10748     IF PL-ATT-AGE NUMERIC AND
 10749        PL-ATT-AGE > +0
 10750        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10751     END-IF
 10752*    IF PL-ATT-AGE NUMERIC AND
 10753*       PL-ATT-AGE > +0
 10754*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10755*       IF PB-I-BIRTHDAY > LOW-VALUES
 10756*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10757*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10758*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10759*          SET BIN-PLUS-ELAPSED  TO TRUE
 10760*          PERFORM 8500-DATE-CONVERT
 10761*                                THRU 8500-EXIT
 10762*          IF NO-CONVERSION-ERROR
 10763*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10764*             MOVE ER-2669       TO WS-ERROR
 10765*             PERFORM 9900-ERROR-FORMAT
 10766*                                THRU 9900-EXIT
 10767*          END-IF
 10768*       ELSE
 10769*          IF WS-ATT-AGE >= PL-ATT-AGE
 10770*             MOVE ER-2669       TO WS-ERROR
 10771*             PERFORM 9900-ERROR-FORMAT
 10772*                                THRU 9900-EXIT
 10773*          END-IF
 10774*       END-IF
 10775*    END-IF
 10776     .
 10777 0570-CHECK-LIFE-LIMITS.
 10778
 10779     IF PB-COMPANY-ID EQUAL 'CRI'
 10780        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10781           IF SUB2 GREATER THAN +4
 10782              MOVE ER-2637 TO WS-ERROR
 10783              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL050.cbl
 10784              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10785
 10786     IF PB-COMPANY-ID  =  'NCL'
 10787        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10788            SUB2 GREATER THAN +8
 10789             MOVE 'U'         TO PB-BATCH-ENTRY
 10790             MOVE ER-2637     TO WS-ERROR
 10791             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10792             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10793
 10794     IF SUB2 > +8
 10795        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10796           AND (PB-I-SIG-SW = 'Y')
 10797           CONTINUE
 10798        ELSE
 10799           MOVE ER-2637          TO WS-ERROR
 10800           PERFORM 9900-ERROR-FORMAT
 10801                                 THRU 9900-EXIT
 10802        END-IF
 10803        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10804     END-IF
 10805     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10806     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10807     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10808
 10809     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10810        ADD +1  TO SUB2
 10811        GO TO 0570-CHECK-LIFE-LIMITS.
 10812
 10813     IF PB-COMPANY-ID = 'NCL'
 10814         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10815
 10816     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10817        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10818        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10819           AND (PB-I-SIG-SW = 'Y')
 10820           CONTINUE
 10821        ELSE
 10822           MOVE ER-2637          TO WS-ERROR
 10823           PERFORM 9900-ERROR-FORMAT
 10824                                 THRU 9900-EXIT
 10825        END-IF
 10826     END-IF
 10827     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10828
 10829
 10830 0570-CHECK-NCL-LIFE-LIMITS.
 10831
 10832     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10833        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10834         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10835
 10836     IF APP-CERT-USED
 10837         IF SUB2  LESS THAN  +5
 10838             MOVE +5          TO SUB2
 10839             GO TO 0570-CHECK-LIFE-LIMITS.
 10840
 10841     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL050.cbl
 10842     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10843
 10844     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10845
 10846 0575-CHECK-NCL-SIG-SWITCH.
 10847
 10848     IF NOT APP-CERT-USED
 10849         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10850
 10851     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10852        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10853        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10854        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10855         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10856
 10857     IF SUB2 GREATER THAN +4
 10858         IF PL-LM-AGE (5) = ZEROS  AND
 10859            PL-LM-AGE (6) = ZEROS  AND
 10860            PL-LM-AGE (7) = ZEROS  AND
 10861            PL-LM-AGE (8) = ZEROS
 10862             MOVE  ER-1927        TO WS-ERROR
 10863             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10864             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10865         ELSE
 10866             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10867                 MOVE  ER-1920    TO WS-ERROR
 10868                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10869
 10870     IF PB-I-SIG-SW  = 'Y'
 10871       IF NOT PB-I-POLICY-ACCEPTED  AND
 10872          NOT PB-I-POLICY-DECLINED
 10873           MOVE 'U'               TO PB-BATCH-ENTRY
 10874           MOVE  ER-1926          TO WS-ERROR
 10875           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10876
 10877
 10878 0580-AH-PLAN-LIMIT-EDITS.
 10879
 10880     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10881        IF PB-I-AH-BENEFIT-AMT > +1250
 10882           MOVE ER-2702          TO WS-ERROR
 10883           PERFORM 9900-ERROR-FORMAT
 10884                                 THRU 9900-EXIT
 10885        END-IF
 10886     END-IF
 10887
 10888     IF (PB-COMPANY-ID = 'DCC')
 10889        AND (PB-MONTHLY-CERT)
 10890        IF PB-I-AH-BENEFIT-AMT > +3000
 10891           MOVE ER-2881          TO WS-ERROR
 10892           PERFORM 9900-ERROR-FORMAT
 10893                                 THRU 9900-EXIT
 10894        END-IF
 10895     END-IF
 10896     IF NOT AH-PLAN-MASTER-FOUND
 10897        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10898        GO TO 3000-CONTINUE-EDIT.
 10899
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL050.cbl
 10900     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10901
 10902     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10903         IF PL-LM-AGE (1) = ZEROS
 10904             GO TO 3000-CONTINUE-EDIT.
 10905
 10906     IF NO-AH-BENEFIT-MATCH          OR
 10907        WS-AH-BENEFIT-CD = ZEROS     OR
 10908        WS-AH-SPECIAL-CALC-CD = 'M'
 10909        GO TO 3000-CONTINUE-EDIT.
 10910
 10911     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10912     MOVE +1                     TO SUB2.
 10913
 10914     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10915        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10916           MOVE +5 TO SUB2
 10917           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10918              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10919              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10920              (PL-LM-AGE (SUB2) EQUAL +0)
 10921              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10922              GO TO 3000-CONTINUE-EDIT.
 10923
 10924     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10925
 10926 0590-CHECK-AH-ATT-AGE.
 10927
 10928     IF PL-ATT-AGE NUMERIC AND
 10929        PL-ATT-AGE GREATER THAN +0
 10930        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10931     END-IF
 10932*       IF WS-ATT-AGE >= PL-ATT-AGE
 10933*          MOVE ER-3054          TO WS-ERROR
 10934*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10935     .
 10936 0597-CHECK-AH-LIMITS.
 10937
 10938     IF PB-COMPANY-ID EQUAL 'CRI'
 10939        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10940           IF SUB2 GREATER THAN +4
 10941              MOVE ER-2638       TO WS-ERROR
 10942              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10943              GO TO 3000-CONTINUE-EDIT.
 10944
 10945     IF PB-COMPANY-ID  =  'NCL'
 10946        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10947            SUB2 GREATER THAN +8
 10948             MOVE 'U'            TO PB-BATCH-ENTRY
 10949             MOVE ER-2638        TO WS-ERROR
 10950             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10951             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10952
 10953     IF SUB2 > +8
 10954        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10955           AND (PB-I-SIG-SW = 'Y')
 10956           CONTINUE
 10957        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL050.cbl
 10958           MOVE ER-2638          TO WS-ERROR
 10959           PERFORM 9900-ERROR-FORMAT
 10960                                 THRU 9900-EXIT
 10961        END-IF
 10962        GO TO 3000-CONTINUE-EDIT
 10963     END-IF
 10964
 10965     IF PB-COMPANY-ID = 'CRI'
 10966        IF WS-ERROR = ER-2638
 10967           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10968
 10969     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10970     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10971     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10972     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10973
 10974     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10975        ADD +1                   TO SUB2
 10976        GO TO 0597-CHECK-AH-LIMITS.
 10977
 10978     IF PB-COMPANY-ID = 'NCL'
 10979         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10980
 10981     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10982        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10983        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10984                                 > PL-LM-AMT (SUB2))
 10985        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10986           AND (PB-I-SIG-SW = 'Y')
 10987           CONTINUE
 10988        ELSE
 10989           MOVE ER-2638          TO WS-ERROR
 10990           PERFORM 9900-ERROR-FORMAT
 10991                                 THRU 9900-EXIT
 10992        END-IF
 10993     END-IF
 10994
 10995     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10996         IF  WS-ERROR    EQUAL    ER-2638
 10997             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10998                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10999                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11000                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11001                MOVE  ER-1910    TO  WS-ERROR
 11002                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11003
 11004     IF PB-COMPANY-ID = 'CRI'
 11005        IF WS-ERROR = ER-2638
 11006            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11007            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11008            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11009
 11010     GO TO 3000-CONTINUE-EDIT.
 11011
 11012 0597-CHECK-NCL-AH-LIMITS.
 11013
 11014     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11015        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL050.cbl
 11016        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11017                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11018         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11019
 11020     IF APP-CERT-USED
 11021         IF SUB2  LESS THAN  +5
 11022             MOVE +5             TO SUB2
 11023             GO TO 0597-CHECK-AH-LIMITS.
 11024
 11025     MOVE ER-2638                TO WS-ERROR.
 11026     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11027
 11028     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11029
 11030 0599-CHECK-NCL-SIG-SWITCH.
 11031
 11032     IF NOT APP-CERT-USED
 11033         GO TO 3000-CONTINUE-EDIT.
 11034
 11035     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11036        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11037        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11038        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11039         GO TO 3000-CONTINUE-EDIT.
 11040
 11041     IF SUB2 GREATER THAN +4
 11042         IF PL-LM-AGE (5) = ZEROS  AND
 11043            PL-LM-AGE (6) = ZEROS  AND
 11044            PL-LM-AGE (7) = ZEROS  AND
 11045            PL-LM-AGE (8) = ZEROS
 11046             MOVE  ER-1927        TO WS-ERROR
 11047             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11048             GO TO 3000-CONTINUE-EDIT
 11049         ELSE
 11050             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11051                 MOVE  ER-1920    TO WS-ERROR
 11052                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11053
 11054     IF PB-I-SIG-SW  = 'Y'
 11055       IF NOT PB-I-POLICY-ACCEPTED  AND
 11056          NOT PB-I-POLICY-DECLINED
 11057           MOVE 'U'               TO PB-BATCH-ENTRY
 11058           MOVE  ER-1926          TO WS-ERROR
 11059           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11060
 11061******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL050.cbl
 11063
 11064 3000-CONTINUE-EDIT.
 11065
 11066     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11067     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11068     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11069     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11070     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11071
 11072     IF BROWSE-STARTED
 11073        PERFORM 9990-RETURN THRU 9990-EXIT
 11074        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11075
 11076     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11077        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11078        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11079        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11080*       MOVE 1                   TO DC-OPTION-CODE
 11081        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11082        IF DATE-CONVERSION-ERROR
 11083           MOVE ER-2622          TO WS-ERROR
 11084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11085        ELSE
 11086           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11087              MOVE ER-2623       TO WS-ERROR
 11088              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11089           ELSE
 11090              MOVE ER-2622       TO WS-ERROR
 11091              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11092
 11093     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11094     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11095     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11096*    MOVE 1                      TO DC-OPTION-CODE.
 11097     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11098     IF DATE-CONVERSION-ERROR
 11099        GO TO 3005-EDIT-CONTINUE
 11100     ELSE
 11101        IF DC-ELAPSED-DAYS GREATER +180
 11102           MOVE ER-2613          TO WS-ERROR
 11103           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11104        ELSE
 11105           IF DC-ELAPSED-DAYS GREATER +90
 11106              MOVE ER-2612       TO WS-ERROR
 11107              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11108           ELSE
 11109             IF DC-ELAPSED-DAYS GREATER +60
 11110                MOVE ER-2614     TO WS-ERROR
 11111                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11112
 11113 3005-EDIT-CONTINUE.
 11114
 11115     IF PB-CANCELLATION
 11116         GO TO 3700-EDIT-CANCEL.
 11117
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL050.cbl
 11119******************************************************************
 11120*                  E D I T   I S S U E                           *
 11121******************************************************************
 11122
 11123 3020-EDIT-ISSUE.
 11124
 11125      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11126      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11127      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11128      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11129      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11130
 11131     IF PB-ISSUE-FORCE
 11132        OR PB-ISSUE-DATE-FORCED
 11133        OR PB-FORCE-OFF
 11134        OR PB-OVERCHARGE-FORCE
 11135        CONTINUE
 11136     ELSE
 11137        MOVE ER-2670             TO WS-ERROR
 11138        PERFORM 9900-ERROR-FORMAT
 11139                                 THRU 9900-EXIT
 11140     END-IF
 11141     .
 11142 3022-SET-POLICY-STATUS.
 11143
 11144     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11145
 11146     IF (PB-REISSUED-CERT)
 11147             OR
 11148        ((PB-COMPANY-ID NOT = 'DCC')
 11149         AND (PB-MONTHLY-CERT))
 11150         MOVE '5'                TO PB-I-ENTRY-STATUS
 11151         MOVE 'E'                TO PB-BATCH-ENTRY
 11152     END-IF
 11153
 11154     IF PB-COMPANY-ID = 'DCC'
 11155        IF PB-MONTHLY-CERT
 11156           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11157        END-IF
 11158     END-IF
 11159     IF PB-POLICY-IS-DECLINED
 11160         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11161     IF PB-POLICY-IS-VOIDED
 11162         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11163     IF PB-NEEDS-UNDERWRITING
 11164         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11165     IF PB-REIN-ONLY-CERT
 11166         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11167     IF PB-PREM-ACCTNG-ONLY
 11168         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11169
 11170     MOVE SPACE                  TO PB-I-OB-FLAG.
 11171
 11172     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11173         MOVE ER-2665            TO WS-ERROR
 11174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11175         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11176
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL050.cbl
 11177     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11178        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11179           MOVE 'Z'             TO PB-I-OB-FLAG.
 11180
 11181     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11182        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11183           MOVE 'Z'             TO PB-I-OB-FLAG.
 11184
 11185     IF ACCOUNT-MAST-FOUND
 11186         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11187         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11188         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11189         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11190         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11191         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11192         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11193     END-IF
 11194
 11195     IF ACCOUNT-MAST-FOUND
 11196        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11197         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11198
 11199     IF (ACCOUNT-MAST-FOUND)
 11200        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11201        IF PB-REISSUED-CERT
 11202           CONTINUE
 11203        ELSE
 11204           MOVE ER-2608          TO WS-ERROR
 11205           PERFORM 9900-ERROR-FORMAT
 11206                                 THRU 9900-EXIT
 11207         END-IF
 11208     END-IF
 11209
 11210     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11211        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11212        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11213
 11214**********   DMD CUSTOM CODE FOLLOWS  **********
 11215 3024-EDIT-DMD-FIELDS.
 11216     IF PB-COMPANY-ID NOT = 'DMD'
 11217        GO TO 3025-EDIT-REINSURANCE.
 11218
 11219*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11220*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11221*** ERROR IF THEY ARE NOT EQUAL.
 11222
 11223     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11224     SET BIN-TO-GREG               TO TRUE.
 11225     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11226     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11227**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11228
 11229     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11230     SET BIN-TO-GREG               TO TRUE.
 11231     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11232     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11233**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11234
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL050.cbl
 11235     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11236        MOVE ER-8116               TO WS-ERROR
 11237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11238
 11239     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11240
 11241     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11242                                      WK-FULL-CERT-NO.
 11243     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11244
 11245     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11246
 11247     IF PB-VALID-LIFE
 11248        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11249     ELSE
 11250        IF PB-VALID-AH
 11251          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11252
 11253
 11254     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11255     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11256     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11257                                      DCUA-UNDRWRTR-CODE
 11258                                      DCUA-UNDRWRTR-GROUP-CODE
 11259                                      DCUA-RETURN-CODE.
 11260
 11261****************************************************************
 11262*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11263***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11264***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11265***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11266***   TO THIS RECORD.                                        ***
 11267****************************************************************
 11268     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11269     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11270     IF DCUA-SUCCESSFUL-PROCESS
 11271        GO TO 3024-EDIT-DL7-CONT.
 11272
 11273     IF DCUA-RETURN-CODE EQUAL '01'
 11274        MOVE ER-8110               TO WS-ERROR
 11275        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11277        GO TO 3024-EDIT-DL7-CONT.
 11278
 11279     IF DCUA-RETURN-CODE EQUAL '02'
 11280        MOVE ER-8111               TO WS-ERROR
 11281        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11283        GO TO 3024-EDIT-DL7-CONT.
 11284
 11285     IF DCUA-RETURN-CODE EQUAL '03'
 11286        MOVE ER-8074               TO WS-ERROR
 11287        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11289        GO TO 3024-EDIT-DL7-CONT.
 11290
 11291     IF DCUA-RETURN-CODE EQUAL '04'
 11292        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL050.cbl
 11293        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11295        GO TO 3024-EDIT-DL7-CONT.
 11296
 11297     IF DCUA-RETURN-CODE EQUAL '05'
 11298        MOVE ER-8076               TO WS-ERROR
 11299        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11301        GO TO 3024-EDIT-DL7-CONT.
 11302
 11303     IF DCUA-RETURN-CODE EQUAL '06'
 11304        MOVE ER-8077               TO WS-ERROR
 11305        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11307        GO TO 3024-EDIT-DL7-CONT.
 11308
 11309     IF DCUA-RETURN-CODE EQUAL '07'
 11310        MOVE ER-8078               TO WS-ERROR
 11311        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11313        GO TO 3024-EDIT-DL7-CONT.
 11314
 11315     IF DCUA-RETURN-CODE EQUAL 'E1'
 11316        MOVE ER-8079               TO WS-ERROR
 11317        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11319        GO TO 3024-EDIT-DL7-CONT.
 11320
 11321     IF DCUA-RETURN-CODE EQUAL 'E2'
 11322        MOVE ER-8080               TO WS-ERROR
 11323        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11325        GO TO 3024-EDIT-DL7-CONT.
 11326
 11327     IF DCUA-RETURN-CODE EQUAL 'E3'
 11328        MOVE ER-8098               TO WS-ERROR
 11329        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11331        GO TO 3024-EDIT-DL7-CONT.
 11332
 11333     IF DCUA-RETURN-CODE EQUAL 'C1'
 11334        MOVE ER-8099               TO WS-ERROR
 11335        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11337        GO TO 3024-EDIT-DL7-CONT.
 11338
 11339     IF DCUA-RETURN-CODE EQUAL 'U1'
 11340        MOVE ER-8109               TO WS-ERROR
 11341        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11343        GO TO 3024-EDIT-DL7-CONT.
 11344
 11345     IF DCUA-RETURN-CODE EQUAL 'N1'
 11346        MOVE ER-8112               TO WS-ERROR
 11347        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11349        GO TO 3024-EDIT-DL7-CONT.
 11350
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL050.cbl
 11351     IF DCUA-RETURN-CODE EQUAL 'N2'
 11352        MOVE ER-8113               TO WS-ERROR
 11353        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11355        GO TO 3024-EDIT-DL7-CONT.
 11356
 11357     IF DCUA-RETURN-CODE EQUAL 'N3'
 11358        MOVE ER-8114               TO WS-ERROR
 11359        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11361        GO TO 3024-EDIT-DL7-CONT.
 11362
 11363     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11364     MOVE ER-8097                  TO WS-ERROR.
 11365     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11366     GO TO 3024-EDIT-DL7-CONT.
 11367
 11368 3024-EDIT-DL7-CONT.
 11369
 11370     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11371     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11372     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11373        NEXT SENTENCE
 11374     ELSE
 11375        MOVE ER-9263               TO WS-ERROR
 11376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11377
 11378******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11379******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11380     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11381        NEXT SENTENCE
 11382     ELSE
 11383        MOVE ER-8039               TO WS-ERROR
 11384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11385
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL050.cbl
 11387****************************************************************
 11388*** VALIDATE STATE  : DLO022                                 ***
 11389****************************************************************
 11390     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11391     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11392
 11393     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11394     IF DVSC-SUCCESSFUL-EDIT
 11395        GO TO 3024-EDIT-DL22-CONT.
 11396
 11397     IF DVSC-RETURN-CODE EQUAL '01'
 11398        MOVE ER-8300               TO WS-ERROR
 11399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11400        GO TO 3024-EDIT-DL22-CONT.
 11401
 11402     IF DVSC-RETURN-CODE EQUAL '02'
 11403        MOVE ER-8301               TO WS-ERROR
 11404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11405        GO TO 3024-EDIT-DL22-CONT.
 11406
 11407     IF DVSC-RETURN-CODE EQUAL '03'
 11408        MOVE ER-8302               TO WS-ERROR
 11409        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11410        GO TO 3024-EDIT-DL22-CONT.
 11411
 11412     IF DVSC-RETURN-CODE EQUAL 'N1'
 11413        MOVE ER-8304               TO WS-ERROR
 11414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11415        GO TO 3024-EDIT-DL22-CONT.
 11416
 11417     MOVE ER-8303                  TO WS-ERROR
 11418     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11419
 11420 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL050.cbl
 11422****************************************************************
 11423*** VALIDATE LOAN OFFICER : DLO021                           ***
 11424****************************************************************
 11425
 11426     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11427     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11428     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11429     IF DVLO-SUCCESSFUL-EDIT
 11430        GO TO 3024-EDIT-DL21-CONT.
 11431
 11432     IF DVLO-RETURN-CODE EQUAL '01'
 11433        MOVE ER-8081               TO WS-ERROR
 11434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11435        GO TO 3024-EDIT-DL21-CONT.
 11436
 11437     IF DVLO-RETURN-CODE EQUAL '02'
 11438        MOVE ER-8082               TO WS-ERROR
 11439        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11440        GO TO 3024-EDIT-DL21-CONT.
 11441
 11442     IF DVLO-RETURN-CODE EQUAL '03'
 11443        MOVE ER-8083               TO WS-ERROR
 11444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11445        GO TO 3024-EDIT-DL21-CONT.
 11446
 11447     IF DVLO-RETURN-CODE EQUAL '04'
 11448        MOVE ER-8084               TO WS-ERROR
 11449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11450        GO TO 3024-EDIT-DL21-CONT.
 11451
 11452     IF DVLO-RETURN-CODE EQUAL '05'
 11453        MOVE ER-8085               TO WS-ERROR
 11454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455        GO TO 3024-EDIT-DL21-CONT.
 11456
 11457     MOVE ER-7825                  TO WS-ERROR
 11458     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11459     GO TO 3024-EDIT-DL21-CONT.
 11460
 11461 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL050.cbl
 11463
 11464****************************************************************
 11465*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11466****************************************************************
 11467
 11468     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11469     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11470     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11471     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11472     IF DIPF-SUCCESSFUL-EDIT
 11473        GO TO 3024-EDIT-DL02-CONT.
 11474
 11475     IF DIPF-RETURN-CODE EQUAL '01'
 11476        MOVE ER-8086               TO WS-ERROR
 11477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11478        GO TO 3024-EDIT-DL02-CONT.
 11479
 11480     IF DIPF-RETURN-CODE EQUAL '02'
 11481        MOVE ER-8087               TO WS-ERROR
 11482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11483        GO TO 3024-EDIT-DL02-CONT.
 11484
 11485     IF DIPF-RETURN-CODE EQUAL '03'
 11486        MOVE ER-8088               TO WS-ERROR
 11487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11488        GO TO 3024-EDIT-DL02-CONT.
 11489
 11490     MOVE ER-8095                  TO WS-ERROR
 11491     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11492     GO TO 3024-EDIT-DL02-CONT.
 11493
 11494 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL050.cbl
 11496
 11497****************************************************************
 11498*** VALIDATE BANK ID : DLO003                                ***
 11499****************************************************************
 11500
 11501     MOVE WK-GREG-CENT           TO WCG-CENT.
 11502     MOVE WK-GREG-YYMM           TO WCG-REST.
 11503     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11504        MOVE ER-8040               TO WS-ERROR
 11505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11506
 11507     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11508     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11509     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11510     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11511     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11512     IF DVBI-SUCCESSFUL-EDIT
 11513        GO TO 3024-EDIT-DL03-CONT.
 11514
 11515     IF DVBI-RETURN-CODE EQUAL '01'
 11516        MOVE ER-8089               TO WS-ERROR
 11517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11518        GO TO 3024-EDIT-DL03-CONT.
 11519
 11520     IF DVBI-RETURN-CODE EQUAL '02'
 11521        MOVE ER-8090               TO WS-ERROR
 11522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11523        GO TO 3024-EDIT-DL03-CONT.
 11524
 11525     IF DVBI-RETURN-CODE EQUAL '03'
 11526        MOVE ER-8091               TO WS-ERROR
 11527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11528        GO TO 3024-EDIT-DL03-CONT.
 11529
 11530     IF DVBI-RETURN-CODE EQUAL '04'
 11531        MOVE ER-8092               TO WS-ERROR
 11532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11533        GO TO 3024-EDIT-DL03-CONT.
 11534
 11535     IF DVBI-RETURN-CODE EQUAL '05'
 11536        MOVE ER-8093               TO WS-ERROR
 11537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11538        GO TO 3024-EDIT-DL03-CONT.
 11539
 11540     IF DVBI-RETURN-CODE EQUAL '06'
 11541        MOVE ER-8094               TO WS-ERROR
 11542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11543        GO TO 3024-EDIT-DL03-CONT.
 11544
 11545     MOVE ER-8096                  TO WS-ERROR
 11546     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11547     GO TO 3024-EDIT-DL03-CONT.
 11548
 11549 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL050.cbl
 11551
 11552     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11553        NEXT SENTENCE
 11554     ELSE
 11555        MOVE ER-8042               TO WS-ERROR
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11557
 11558     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11559     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11560     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11561
 11562     IF DMPF-RETURN-CODE = '01'
 11563        MOVE ER-8067               TO WS-ERROR
 11564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11565        GO TO 3024-EDIT-DL01-CONT.
 11566
 11567     IF DMPF-RETURN-CODE = '02'
 11568        MOVE ER-8068               TO WS-ERROR
 11569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11570        GO TO 3024-EDIT-DL01-CONT.
 11571
 11572     IF DMPF-RETURN-CODE = '03'
 11573        MOVE ER-8069               TO WS-ERROR
 11574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11575        GO TO 3024-EDIT-DL01-CONT.
 11576
 11577     IF DMPF-RETURN-CODE = 'E1'
 11578        MOVE ER-8070               TO WS-ERROR
 11579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11580        GO TO 3024-EDIT-DL01-CONT.
 11581
 11582     IF DMPF-RETURN-CODE = 'N1'
 11583        MOVE ER-8071               TO WS-ERROR
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL01-CONT.
 11586
 11587     IF DMPF-RETURN-CODE NOT = 'OK'
 11588        MOVE ER-8072               TO WS-ERROR
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11590
 11591 3024-EDIT-DL01-CONT.
 11592******************************************************************
 11593***  VALIDATES RATE CODES : DLO017                             ***
 11594******************************************************************
 11595
 11596      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11597      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11598      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11599      IF DVRC-SUCCESSFUL-EDIT
 11600        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11601        GO TO 3024-CHECK-VALID-RATE.
 11602
 11603      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11604
 11605      IF DVRC-RETURN-CODE EQUAL '01'
 11606         MOVE ER-7817                   TO WS-ERROR
 11607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL050.cbl
 11609
 11610      IF DVRC-RETURN-CODE EQUAL '02'
 11611         MOVE ER-7818                   TO WS-ERROR
 11612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11613         GO TO 3025-EDIT-REINSURANCE.
 11614
 11615      IF DVRC-RETURN-CODE EQUAL '03'
 11616         MOVE ER-7819                   TO WS-ERROR
 11617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11618         GO TO 3025-EDIT-REINSURANCE.
 11619
 11620       MOVE ER-7820                     TO WS-ERROR.
 11621       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11622       GO TO 3025-EDIT-REINSURANCE.
 11623
 11624******************************************************************
 11625***  GET PREMIUM RATES : DLO011                                ***
 11626******************************************************************
 11627
 11628 3024-CHECK-VALID-RATE.
 11629
 11630     IF VALID-RATE-CODE
 11631        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11632        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11633        MOVE SPACES                TO DPRB-RETURN-CODE
 11634        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11635     ELSE
 11636         GO TO 3025-EDIT-REINSURANCE.
 11637
 11638      IF DPRB-SUCCESSFUL-PROCESS
 11639         IF PB-VALID-LIFE
 11640             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11641             GO TO 3025-EDIT-REINSURANCE
 11642         ELSE
 11643             IF PB-VALID-AH
 11644                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11645                 GO TO 3025-EDIT-REINSURANCE.
 11646
 11647      IF DPRB-RETURN-CODE EQUAL '01'
 11648         MOVE ER-7812                   TO WS-ERROR
 11649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11650         GO TO 3025-EDIT-REINSURANCE.
 11651
 11652      IF DPRB-RETURN-CODE EQUAL '02'
 11653         MOVE ER-7813                   TO WS-ERROR
 11654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11655         GO TO 3025-EDIT-REINSURANCE.
 11656
 11657      IF DPRB-RETURN-CODE EQUAL '03'
 11658         MOVE ER-7814                   TO WS-ERROR
 11659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11660         GO TO 3025-EDIT-REINSURANCE.
 11661
 11662      IF DPRB-RETURN-CODE EQUAL '04'
 11663         IF NOT DPRB-1ST-TIME
 11664            MOVE ER-7815                   TO WS-ERROR
 11665            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL050.cbl
 11667          ELSE
 11668         IF PB-VALID-LIFE
 11669            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11670          ELSE
 11671            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11672         END-IF
 11673         MOVE SPACES                TO DOCC-RETURN-CODE
 11674         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11675         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11676         IF DOCC-RETURN-CODE = 'OK'
 11677             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11678             GO TO 3024-CHECK-VALID-RATE
 11679           ELSE
 11680             MOVE ER-7823               TO WS-ERROR
 11681             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11682             GO TO 3025-EDIT-REINSURANCE.
 11683
 11684       MOVE ER-7816                     TO WS-ERROR.
 11685       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11686       GO TO 3025-EDIT-REINSURANCE.
 11687
 11688**********   DMD CUSTOM CODE ABOVE    **********
 11689
 11690 3025-EDIT-REINSURANCE.
 11691     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11692         GO TO 3027-EDIT-CONTINUE.
 11693
 11694     MOVE LOW-VALUES               TO ERREIN-KEY.
 11695     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11696     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11697                                      REIN-CODE-2
 11698                                      REIN-CODE-3.
 11699     MOVE 'A'                      TO REIN-TYPE.
 11700
 11701     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11702
 11703     MOVE '3026' TO REIN-SW.
 11704     MOVE ' '                   TO WS-REIN-READ-SW.
 11705
 11706     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11707     IF REIN-TABLE-NOT-FOUND
 11708         GO TO 3026-NO-SPEC-TABLE.
 11709
 11710     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11711     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11712                                   WS-NSP-ST-CD-LF.
 11713     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11714                                   WS-NSP-ST-CD-AH.
 11715
 11716     GO TO 3040-EDIT-CONTINUE.
 11717
 11718 3026-NO-SPEC-TABLE.
 11719
 11720     MOVE ER-2664                TO WS-ERROR.
 11721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11722     GO TO 3040-EDIT-CONTINUE.
 11723
 11724 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL050.cbl
 11725
 11726     IF PB-I-REIN-TABLE = SPACES
 11727       GO TO 3040-EDIT-CONTINUE.
 11728
 11729     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11730          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11731          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11732           GO TO 3040-EDIT-CONTINUE.
 11733
 11734     MOVE LOW-VALUES            TO ERREIN-KEY.
 11735     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11736     MOVE 'A'                   TO REIN-TYPE.
 11737     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11738
 11739     MOVE '3028'                TO REIN-SW.
 11740     MOVE ' '                   TO WS-REIN-READ-SW.
 11741
 11742     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11743     IF REIN-TABLE-NOT-FOUND
 11744         GO TO 3028-NO-REIN-TABLE.
 11745
 11746     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11747     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11748                                   WS-NSP-ST-CD-LF.
 11749     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11750                                   WS-NSP-ST-CD-AH.
 11751
 11752     GO TO 3040-EDIT-CONTINUE.
 11753
 11754 3028-NO-REIN-TABLE.
 11755
 11756     MOVE ER-2615                TO WS-ERROR.
 11757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11758     GO TO 3040-EDIT-CONTINUE.
 11759
 11760 3040-EDIT-CONTINUE.
 11761
 11762     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11763         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11764
 11765     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11766         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11767
 11768     IF (NOT PB-REISSUED-CERT)
 11769        AND (NOT PB-MONTHLY-CERT)
 11770        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11771            MOVE '001'           TO PB-I-LF-TERM
 11772            MOVE 'M'             TO PB-I-INSURED-SEX.
 11773
 11774     IF (NOT PB-REISSUED-CERT)
 11775        AND (NOT PB-MONTHLY-CERT)
 11776        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11777            MOVE '001'           TO PB-I-AH-TERM
 11778            MOVE 'M'             TO PB-I-INSURED-SEX.
 11779
 11780 3040-EDIT-1ST-PMT-DT.
 11781     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11782     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL050.cbl
 11783         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11784
 11785******************************************************************
 11786*                                                                *
 11787*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11788*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11789*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11790*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11791*                                                                *
 11792******************************************************************
 11793
 11794     IF PB-EFF-DT-PROCESSING
 11795        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11796                                    PB-I-LF-EXPIRE-DT
 11797                                    PB-I-AH-EXPIRE-DT
 11798        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11799        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11800        MOVE ZERO                TO DC-ELAPSED-DAYS
 11801        MOVE +1                  TO DC-ELAPSED-MONTHS
 11802        SET BIN-PLUS-ELAPSED     TO TRUE
 11803*       MOVE 6                   TO DC-OPTION-CODE
 11804        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11805        IF NO-CONVERSION-ERROR
 11806           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11807
 11808******************************************************************
 11809*                                                                *
 11810*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11811*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11812*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11813*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11814*                                                                *
 11815******************************************************************
 11816
 11817     IF PB-EXT-DAYS-PROCESSING
 11818          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11819                                         PB-I-LF-EXPIRE-DT
 11820                                         PB-I-AH-EXPIRE-DT
 11821          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11822          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11823          MOVE +1                     TO DC-ELAPSED-MONTHS
 11824          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11825          SET BIN-PLUS-ELAPSED        TO TRUE
 11826*         MOVE 6                      TO DC-OPTION-CODE
 11827          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11828          IF NO-CONVERSION-ERROR
 11829             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11830
 11831******************************************************************
 11832*                                                                *
 11833*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11834*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11835*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11836*        (EXPIRE DATE - (TERM -1))  *  -1.
 11837*                                                                *
 11838******************************************************************
 11839
 11840     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL050.cbl
 11841        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11842           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11843              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11844              MOVE PB-I-AH-TERM      TO WS-TERM
 11845           ELSE
 11846              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11847              MOVE PB-I-LF-TERM      TO WS-TERM
 11848        ELSE
 11849           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11850              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11851              MOVE PB-I-LF-TERM      TO WS-TERM
 11852           ELSE
 11853              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11854              MOVE PB-I-AH-TERM      TO WS-TERM.
 11855
 11856     IF PB-EXPIRE-DT-PROCESSING
 11857        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11858        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11859        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11860        MOVE ZERO                TO DC-ELAPSED-DAYS
 11861                                    DC-ODD-DAYS-OVER
 11862          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11863          SET BIN-PLUS-ELAPSED    TO TRUE
 11864*         MOVE 6                  TO DC-OPTION-CODE
 11865          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11866          IF NO-CONVERSION-ERROR
 11867             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11868
 11869******************************************************************
 11870*                                                                *
 11871*            1ST PAYMENT DATE PROCESSING                         *
 11872*                                                                *
 11873******************************************************************
 11874
 11875     IF PB-1ST-PMT-DT-PROCESSING
 11876        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11877                                    PB-I-AH-EXPIRE-DT
 11878        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11879
 11880     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11881         NEXT SENTENCE
 11882     ELSE
 11883         MOVE ER-2680                 TO WS-ERROR
 11884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11885         GO TO 3060-ORIG-TERM-CHECK.
 11886
 11887     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11888     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11889     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11890*    MOVE 1                      TO DC-OPTION-CODE.
 11891     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11892                                    DC-ELAPSED-DAYS
 11893                                    DC-ODD-DAYS-OVER.
 11894
 11895     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11896
 11897     IF DATE-CONVERSION-ERROR
 11898        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL050.cbl
 11899
 11900     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11901     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11902        AND (WS-LF-COVERAGE-TYPE = 'L')
 11903        IF (DC-ELAPSED-MONTHS > 1)
 11904                      OR
 11905           ((DC-ELAPSED-MONTHS = 1)
 11906           AND (DC-ODD-DAYS-OVER > 0))
 11907           MOVE ER-2882          TO WS-ERROR
 11908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11909        END-IF
 11910     END-IF
 11911     IF PB-EXT-DAYS-PROCESSING
 11912        CONTINUE
 11913     ELSE
 11914        IF DC-ELAPSED-MONTHS = +0
 11915           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11916        ELSE
 11917           IF (WS-LF-EARNINGS-CALC = '4')
 11918              AND (DC-ELAPSED-MONTHS > ZERO)
 11919              AND (DC-ELAPSED-DAYS > ZERO)
 11920              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11921           ELSE
 11922              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11923                                 THRU 6499-EXIT
 11924              MOVE WS-ODD-DAYS-OVER
 11925                                 TO PB-I-EXTENTION-DAYS
 11926           END-IF
 11927        END-IF
 11928     END-IF
 11929******************************************************************
 11930*                                                                *
 11931*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11932*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11933*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11934*            AND ANY ODD DAYS.                                   *
 11935*                                                                *
 11936******************************************************************
 11937
 11938     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11939                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11940     IF WS-LF-EARNINGS-CALC NOT = '4'
 11941        IF DC-ELAPSED-DAYS > ZEROS
 11942           MOVE ER-2681          TO WS-ERROR
 11943           PERFORM 9900-ERROR-FORMAT
 11944                                 THRU 9900-EXIT
 11945        END-IF
 11946     END-IF
 11947
 11948     IF WS-LF-EARNINGS-CALC NOT = '4'
 11949        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11950           MOVE ER-2681          TO WS-ERROR
 11951           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11952
 11953     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11954        (PB-I-LF-TERM NOT = ZERO) AND
 11955         NOT NO-LIFE-COVERAGE
 11956          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL050.cbl
 11957          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11958          IF WS-LF-EARNINGS-CALC = '4'
 11959             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11960             PB-I-PAY-FREQUENCY
 11961          END-IF
 11962          MOVE ZERO              TO DC-ELAPSED-DAYS
 11963                                    DC-ODD-DAYS-OVER
 11964          MOVE 1                 TO DC-END-OF-MONTH
 11965          SET BIN-PLUS-ELAPSED        TO TRUE
 11966*         MOVE 6                 TO DC-OPTION-CODE
 11967          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11968          IF NO-CONVERSION-ERROR
 11969             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11970             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11971                (WS-LF-SPECIAL-CALC-CD = 'L')
 11972                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11973                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11974                  MOVE +1             TO DC-ELAPSED-MONTHS
 11975                  SET BIN-PLUS-ELAPSED  TO TRUE
 11976*                 MOVE 6              TO DC-OPTION-CODE
 11977                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11978                  IF NO-CONVERSION-ERROR
 11979                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11980
 11981* okay, i had to move the new att age edit down here because the
 11982* expiration date could get recalculated and i need the exp date
 11983     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11984        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11985        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11986        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11987           AND ZEROS
 11988           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11989           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11990           SET ELAPSED-BETWEEN-BIN TO TRUE
 11991           PERFORM 8500-DATE-CONVERT
 11992                                 THRU 8500-EXIT
 11993           IF NO-CONVERSION-ERROR
 11994              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11995                 MOVE ER-2669       TO WS-ERROR
 11996*                PERFORM 9900-ERROR-FORMAT
 11997*                                THRU 9900-EXIT
 11998              END-IF
 11999           END-IF
 12000        ELSE
 12001           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12002           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12003              MOVE ER-2669       TO WS-ERROR
 12004*             PERFORM 9900-ERROR-FORMAT
 12005*                                THRU 9900-EXIT
 12006           ELSE
 12007              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12008                 MOVE ER-1570    TO WS-ERROR
 12009                 PERFORM 9900-ERROR-FORMAT
 12010                                 THRU 9900-EXIT
 12011              END-IF
 12012           END-IF
 12013        END-IF
 12014        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL050.cbl
 12015           AND ZEROS
 12016           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12017           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12018           SET ELAPSED-BETWEEN-BIN TO TRUE
 12019           PERFORM 8500-DATE-CONVERT
 12020                                 THRU 8500-EXIT
 12021           IF NO-CONVERSION-ERROR
 12022              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12023                 MOVE ER-2669       TO WS-ERROR
 12024*                PERFORM 9900-ERROR-FORMAT
 12025*                                THRU 9900-EXIT
 12026              END-IF
 12027           END-IF
 12028        ELSE
 12029           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12030             (PB-I-LF-TERM / 12)
 12031           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12032              MOVE ER-2669       TO WS-ERROR
 12033*             PERFORM 9900-ERROR-FORMAT
 12034*                                THRU 9900-EXIT
 12035           ELSE
 12036              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12037                 MOVE ER-1571    TO WS-ERROR
 12038                 PERFORM 9900-ERROR-FORMAT
 12039                                 THRU 9900-EXIT
 12040              END-IF
 12041           END-IF
 12042        END-IF
 12043        IF WS-ERROR = ER-2669
 12044           PERFORM 9900-ERROR-FORMAT
 12045                                 THRU 9900-EXIT
 12046        END-IF
 12047     END-IF
 12048     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12049        (PB-I-AH-TERM NOT = ZERO) AND
 12050         NOT NO-AH-COVERAGE
 12051          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12052             AND (PB-COMPANY-ID = 'DCC')
 12053             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12054             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12055          ELSE
 12056             IF WS-LF-EARNINGS-CALC = '4'
 12057                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12058                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12059                PB-I-PAY-FREQUENCY
 12060             ELSE
 12061                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12062                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12063             END-IF
 12064          END-IF
 12065          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12066                                         DC-ODD-DAYS-OVER
 12067          MOVE 1                      TO DC-END-OF-MONTH
 12068          SET BIN-PLUS-ELAPSED        TO TRUE
 12069*         MOVE 6                      TO DC-OPTION-CODE
 12070          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12071          IF NO-CONVERSION-ERROR
 12072             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL050.cbl
 12073     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12074        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12075        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12076        IF PB-I-BIRTHDAY > LOW-VALUES
 12077           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12078           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12079           SET ELAPSED-BETWEEN-BIN TO TRUE
 12080           PERFORM 8500-DATE-CONVERT
 12081                                 THRU 8500-EXIT
 12082           IF NO-CONVERSION-ERROR
 12083              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12084                 MOVE ER-3054       TO WS-ERROR
 12085*                PERFORM 9900-ERROR-FORMAT
 12086*                                THRU 9900-EXIT
 12087              END-IF
 12088           END-IF
 12089        ELSE
 12090           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12091           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12092              MOVE ER-3054       TO WS-ERROR
 12093*             PERFORM 9900-ERROR-FORMAT
 12094*                                THRU 9900-EXIT
 12095           END-IF
 12096        END-IF
 12097        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12098           AND ZEROS
 12099           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12100           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12101           SET ELAPSED-BETWEEN-BIN TO TRUE
 12102           PERFORM 8500-DATE-CONVERT
 12103                                 THRU 8500-EXIT
 12104           IF NO-CONVERSION-ERROR
 12105              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12106                 MOVE ER-3054       TO WS-ERROR
 12107*                PERFORM 9900-ERROR-FORMAT
 12108*                                THRU 9900-EXIT
 12109              END-IF
 12110           END-IF
 12111        ELSE
 12112           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12113             (PB-I-AH-TERM / 12)
 12114           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12115              MOVE ER-3054       TO WS-ERROR
 12116*             PERFORM 9900-ERROR-FORMAT
 12117*                                THRU 9900-EXIT
 12118           END-IF
 12119        END-IF
 12120        IF WS-ERROR = ER-3054
 12121           PERFORM 9900-ERROR-FORMAT
 12122                                 THRU 9900-EXIT
 12123        END-IF
 12124     END-IF
 12125     MOVE SPACE                       TO DC-END-OF-MONTH.
 12126
 12127     IF PB-COMPANY-ID = 'NCB'
 12128        GO TO 3040-EDIT-EXTENSION-DAYS.
 12129
 12130     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL050.cbl
 12131       AND
 12132        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12133        NEXT SENTENCE
 12134     ELSE
 12135        GO TO 3040-EDIT-EXTENSION-DAYS.
 12136
 12137     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12138        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12139        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12140     ELSE
 12141        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12142        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12143
 12144     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12145*    MOVE '1'      TO DC-OPTION-CODE
 12146     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12147     IF (NO-CONVERSION-ERROR)
 12148        AND (DC-ELAPSED-MONTHS > +1)
 12149        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12150        MOVE ER-2668   TO WS-ERROR
 12151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12152
 12153 3040-EDIT-EXTENSION-DAYS.
 12154
 12155     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12156        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12157         GO TO 3050-EDIT-TERM-IN-DAYS
 12158     ELSE
 12159         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12160
 12161     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12162         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12163     ELSE
 12164        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12165           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12166           MOVE ER-2681         TO WS-ERROR
 12167           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12168
 12169     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12170        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12171        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12172         GO TO 3060-ORIG-TERM-CHECK.
 12173
 12174     GO TO 3060-ORIG-TERM-CHECK.
 12175
 12176 3050-EDIT-TERM-IN-DAYS.
 12177
 12178     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12179
 12180     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12181         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12182     ELSE
 12183         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12184            MOVE ER-2682         TO WS-ERROR
 12185            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12186
 12187     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12188                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL050.cbl
 12189     IF WS-WORK-TERM GREATER THAN ZERO
 12190         ADD +1 TO PB-I-LF-TERM.
 12191
 12192     IF NOT NO-AH-COVERAGE
 12193         MOVE ER-2684            TO WS-ERROR
 12194         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12195
 12196
 12197 3060-ORIG-TERM-CHECK.
 12198
 12199******************************************************************
 12200*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12201******************************************************************
 12202
 12203     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12204        NEXT SENTENCE
 12205     ELSE
 12206        IF NOT NO-LIFE-COVERAGE
 12207           IF PB-I-LF-TERM NUMERIC
 12208              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12209              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12210              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12211                  NEXT SENTENCE
 12212           ELSE
 12213              MOVE ER-2647       TO WS-ERROR
 12214              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12215
 12216     IF NOT NO-AH-COVERAGE
 12217         IF PB-I-AH-TERM NUMERIC
 12218            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12219            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12220            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12221             NEXT SENTENCE
 12222          ELSE
 12223              MOVE ER-2658       TO WS-ERROR
 12224              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12225
 12226     IF PB-COMPANY-ID = 'NCB'
 12227        GO TO 3070-LOAN-TERM-CHECK.
 12228
 12229     IF POLICY-HAS-AH
 12230       AND
 12231        POLICY-HAS-LIFE
 12232       AND
 12233        PB-I-LF-TERM NUMERIC
 12234       AND
 12235        PB-I-AH-TERM NUMERIC
 12236        NEXT SENTENCE
 12237     ELSE
 12238        GO TO 3070-LOAN-TERM-CHECK.
 12239
 12240     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12241     IF WS-TEX-FACT-2 LESS THAN +0
 12242        MULTIPLY +1 BY WS-TEX-FACT-2.
 12243
 12244     IF WS-TEX-FACT-2 GREATER THAN +1
 12245        MOVE ER-2668             TO WS-ERROR
 12246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL050.cbl
 12247
 12248 3070-LOAN-TERM-CHECK.
 12249
 12250     IF (WS-LF-BENEFIT-CD = ZERO)
 12251         OR (NO-LF-BENEFIT-MATCH)
 12252            GO TO 3125-EDIT-PMT-FREQ.
 12253*    IF PB-COMPANY-ID NOT = 'DCC'
 12254*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12255*          AND 'V' AND 'W' AND 'X'
 12256*          GO TO 3125-EDIT-PMT-FREQ
 12257*       END-IF
 12258*    ELSE
 12259*       IF WS-AH-DCC-TRUNC = 'T'
 12260*          CONTINUE
 12261*       ELSE
 12262*          GO TO 3125-EDIT-PMT-FREQ
 12263*       END-IF
 12264*    END-IF
 12265     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12266                    OR
 12267        ((PB-COMPANY-ID = 'DCC')
 12268        AND (WS-AH-DCC-TRUNC = 'T'))
 12269        CONTINUE
 12270     ELSE
 12271        GO TO 3125-EDIT-PMT-FREQ
 12272     END-IF
 12273     IF PB-I-LOAN-TERM NOT NUMERIC
 12274         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12275
 12276     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12277        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12278        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12279        PB-I-LOAN-TERM NOT GREATER THAN +360
 12280         NEXT SENTENCE
 12281     ELSE
 12282         MOVE ER-2648            TO WS-ERROR
 12283         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12284
 12285     IF WS-STATE-ABBREVIATION = 'NC'
 12286        IF PB-I-LOAN-TERM > +59
 12287           CONTINUE
 12288        ELSE
 12289           MOVE ER-2792          TO WS-ERROR
 12290           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12291        END-IF
 12292     END-IF
 12293
 12294     .
 12295 3125-EDIT-PMT-FREQ.
 12296     IF (WS-LF-BENEFIT-CD = ZERO)
 12297         OR (NO-LF-BENEFIT-MATCH)
 12298            GO TO 3127-EDIT-LOAN-OFFICER.
 12299     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12300                    OR
 12301        ((PB-COMPANY-ID = 'DCC')
 12302        AND (WS-AH-DCC-TRUNC = 'T'))
 12303                    OR
 12304         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL050.cbl
 12305        CONTINUE
 12306     ELSE
 12307        IF (PB-I-LOAN-TERM > ZEROS)
 12308           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12309           MOVE ER-1575          TO WS-ERROR
 12310           PERFORM 9900-ERROR-FORMAT
 12311                                 THRU 9900-EXIT
 12312        END-IF
 12313     END-IF
 12314     IF WS-LF-EARNINGS-CALC NOT = '4'
 12315         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12316            MOVE ER-2653         TO WS-ERROR
 12317            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12318            GO TO 3127-EDIT-LOAN-OFFICER
 12319         ELSE
 12320            GO TO 3127-EDIT-LOAN-OFFICER.
 12321
 12322     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12323         MOVE ER-2655            TO WS-ERROR
 12324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12325         GO TO 3127-EDIT-LOAN-OFFICER.
 12326
 12327     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12328         MOVE ER-2654            TO WS-ERROR
 12329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12330         GO TO 3127-EDIT-LOAN-OFFICER.
 12331
 12332     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12333         GIVING WS-TEX-FACT-2
 12334             REMAINDER WS-TEX-FACT-3.
 12335
 12336*    IF WS-TEX-FACT-3 NOT = ZERO
 12337*       MOVE ER-2654             TO WS-ERROR
 12338*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12339
 12340
 12341 3127-EDIT-LOAN-OFFICER.
 12342
 12343     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12344        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12345           MOVE ER-2690          TO WS-ERROR
 12346           PERFORM 9900-ERROR-FORMAT
 12347                                 THRU 9900-EXIT
 12348        ELSE
 12349           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12350           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12351           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12352           MOVE PB-SV-STATE      TO LOFC-STATE
 12353           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12354           MOVE PB-I-LOAN-OFFICER
 12355                                 TO LOFC-CODE
 12356           PERFORM 8586-READ-LOAN-OFFICER
 12357                                 THRU 8586-EXIT
 12358           IF (NOT LOFC-MASTER-FOUND)
 12359              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12360              MOVE ER-3006       TO WS-ERROR
 12361              PERFORM 9900-ERROR-FORMAT
 12362                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL050.cbl
 12363           END-IF
 12364        END-IF
 12365     END-IF
 12366     .
 12367 3129-EDIT-APR.
 12368
 12369     IF (WS-LF-BENEFIT-CD = ZERO)
 12370        OR (NO-LF-BENEFIT-MATCH)
 12371        IF PB-COMPANY-ID NOT = 'DCC'
 12372           GO TO 3130-EDIT-AGE
 12373*       ELSE
 12374*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12375*             GO TO 3130-EDIT-AGE
 12376*          END-IF
 12377        END-IF
 12378     END-IF
 12379
 12380     IF (WS-STATE-ABBREVIATION = 'OH')
 12381         AND (PB-I-RATE-CLASS NOT = 'L ')
 12382         AND (PB-I-LF-TERM GREATER THAN 60)
 12383         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12384         GO TO 3129-APR-CONT.
 12385
 12386     IF (WS-STATE-ABBREVIATION = 'RI')
 12387         AND (PB-I-LF-TERM GREATER THAN 60)
 12388         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12389         GO TO 3129-APR-CONT.
 12390
 12391     IF (WS-STATE-ABBREVIATION = 'UT')
 12392         AND (PB-I-LF-TERM GREATER THAN 62)
 12393         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12394         AND (PB-CERT-EFF-DT LESS WS-830901)
 12395         GO TO 3129-APR-CONT.
 12396
 12397     IF PB-COMPANY-ID = 'LAP'
 12398        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12399           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12400              MOVE ER-2656         TO WS-ERROR
 12401              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12402              GO TO 3130-EDIT-AGE.
 12403
 12404     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12405        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12406        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12407        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12408         GO TO 3130-EDIT-AGE.
 12409
 12410 3129-APR-CONT.
 12411     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12412         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12413         GO TO 3130-EDIT-AGE.
 12414
 12415     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12416        AND (PB-COMPANY-ID = 'DCC')
 12417        AND (PB-I-LOAN-APR = ZERO)
 12418        MOVE ER-2657             TO WS-ERROR
 12419        PERFORM 9900-ERROR-FORMAT
 12420                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL050.cbl
 12421        GO TO 3130-EDIT-AGE
 12422     END-IF
 12423     IF PB-I-LOAN-APR = ZERO
 12424        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12425     END-IF
 12426
 12427     IF PB-I-LOAN-APR = ZERO
 12428        MOVE ER-2656             TO WS-ERROR
 12429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12430        GO TO 3130-EDIT-AGE.
 12431
 12432*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12433     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12434        MOVE ER-2657             TO WS-ERROR
 12435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12436
 12437 3130-EDIT-AGE.
 12438
 12439******************************************************************
 12440*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12441******************************************************************
 12442
 12443     IF NOT NO-LIFE-COVERAGE
 12444        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12445           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12446               MOVE ER-2628             TO WS-ERROR
 12447               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12448
 12449     IF NOT NO-AH-COVERAGE
 12450        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12451           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12452               MOVE ER-2628         TO WS-ERROR
 12453               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12454
 12455 3133-SEX-CODE.
 12456     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12457         IF WS-DEFAULT-SEX = 'M'
 12458             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12459          ELSE
 12460             IF WS-DEFAULT-SEX = 'F'
 12461             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12462
 12463     IF PB-I-INSURED-SEX = '1'
 12464         MOVE 'M' TO PB-I-INSURED-SEX.
 12465
 12466     IF PB-I-INSURED-SEX = '2'
 12467         MOVE 'F' TO PB-I-INSURED-SEX.
 12468
 12469 3134-SIG-SW-EDIT.
 12470     IF PB-I-SIG-SW = SPACE
 12471         MOVE 'N'                TO  PB-I-SIG-SW.
 12472
 12473     IF PB-COMPANY-ID = 'NCL'
 12474         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12475             NEXT SENTENCE
 12476         ELSE
 12477             MOVE ER-1923        TO  WS-ERROR
 12478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL050.cbl
 12479     ELSE
 12480     IF PB-COMPANY-ID = 'CRI'
 12481         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12482             NEXT SENTENCE
 12483         ELSE
 12484             MOVE ER-2606        TO  WS-ERROR
 12485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12486     ELSE
 12487     IF PB-COMPANY-ID = 'TMS'
 12488         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12489             NEXT SENTENCE
 12490         ELSE
 12491             MOVE ER-2689        TO  WS-ERROR
 12492             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12493     ELSE
 12494         IF PB-I-SIG-SW = 'Y' OR 'N'
 12495             NEXT SENTENCE
 12496         ELSE
 12497             MOVE ER-2651        TO  WS-ERROR
 12498             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12499
 12500     IF PB-COMPANY-ID = 'FLA'
 12501         IF (WS-EDIT-AGE GREATER 54  OR
 12502             WS-AH-EDIT-AGE GREATER 54)  AND
 12503            PB-I-SIG-SW = 'N'
 12504            MOVE ER-2651         TO  WS-ERROR
 12505            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12506
 12507 3135-NAME-EDIT.
 12508
 12509     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12510        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12511        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12512           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12513                                 TO PB-I-JOINT-FIRST-NAME
 12514        END-PERFORM
 12515     END-IF
 12516     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12517        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12518        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12519           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12520                                 TO PB-I-JOINT-LAST-NAME
 12521        END-PERFORM
 12522     END-IF
 12523     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12524        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12525        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12526           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12527                                 TO PB-I-INSURED-FIRST-NAME
 12528        END-PERFORM
 12529     END-IF
 12530     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12531        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12532        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12533           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12534                                 TO PB-I-INSURED-LAST-NAME
 12535        END-PERFORM
 12536     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL050.cbl
 12537     IF PB-I-INSURED-LAST-NAME = SPACES
 12538       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12539       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12540           MOVE ER-2660    TO WS-ERROR
 12541           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12542
 12543 3136-EDIT-SEX.
 12544
 12545******************************************************************
 12546*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12547******************************************************************
 12548
 12549     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12550        (WS-AH-SPECIAL-CALC-CD = 'O')
 12551        NEXT SENTENCE
 12552     ELSE
 12553        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12554           NEXT SENTENCE
 12555        ELSE
 12556           MOVE ER-2629            TO WS-ERROR
 12557           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12558
 12559 3137-EDIT-EFF-DATE.
 12560
 12561     IF PB-REISSUED-CERT       OR
 12562        PB-POLICY-IS-DECLINED  OR
 12563        PB-POLICY-IS-VOIDED
 12564         GO TO 3139-EDIT-COVERAGE-CODES.
 12565
 12566     MOVE SPACE                  TO WS-2671-SW
 12567                                    WS-2672-SW.
 12568
 12569     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12570         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12571             MOVE ER-2703        TO WS-ERROR
 12572             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12573             GO TO 3139-EDIT-COVERAGE-CODES.
 12574
 12575     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12576         GO TO 3139-EDIT-COVERAGE-CODES.
 12577
 12578     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12579     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12580*    MOVE '1'                    TO DC-OPTION-CODE.
 12581     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12582     MOVE +0                     TO DC-ELAPSED-MONTHS
 12583                                    DC-ELAPSED-DAYS.
 12584     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12585
 12586     IF DATE-CONVERSION-ERROR
 12587         GO TO 3139-EDIT-COVERAGE-CODES.
 12588
 12589     IF DC-ELAPSED-DAYS GREATER +180
 12590         MOVE ER-2672            TO WS-ERROR
 12591         MOVE 'Y'                TO WS-2672-SW
 12592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593     END-IF
 12594
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL050.cbl
 12595     IF WS-ERROR = ER-2671  AND
 12596        PB-COMPANY-ID  = 'LBL'
 12597        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12598        MOVE SPACE               TO WS-2671-SW
 12599        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12600
 12601     IF PB-ISSUE-DATE-FORCED  AND
 12602      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12603         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12604         MOVE ER-2673            TO WS-ERROR
 12605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12606         MOVE SPACE              TO WS-2671-SW
 12607                                    WS-2672-SW.
 12608
 12609     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12610         IF PB-ISSUE-DATE-FORCED
 12611             MOVE ER-2600          TO  WS-ERROR
 12612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12613         ELSE
 12614             MOVE ER-2692          TO  WS-ERROR
 12615             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12616
 12617
 12618 3139-EDIT-COVERAGE-CODES.
 12619
 12620     if pb-company-id not = 'AHL'
 12621        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12622           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12623           MOVE ER-2787          TO WS-ERROR
 12624           PERFORM 9900-ERROR-FORMAT
 12625                                 THRU 9900-EXIT
 12626        END-IF
 12627     end-if
 12628     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12629        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12630                                 > 250000.00
 12631           MOVE ER-2719          TO WS-ERROR
 12632           PERFORM 9900-ERROR-FORMAT
 12633                                 THRU 9900-EXIT
 12634        END-IF
 12635     END-IF
 12636
 12637     IF PB-POLICY-IS-DECLINED  OR
 12638        PB-POLICY-IS-VOIDED
 12639         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12640
 12641     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12642        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12643         MOVE ER-2630                TO WS-ERROR
 12644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12645
 12646     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12647        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12648        PB-I-LF-PREMIUM-AMT = ZERO
 12649         GO TO 3140-CHECK-AH-FOR-ZERO.
 12650
 12651     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12652        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL050.cbl
 12653        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12654         GO TO 3140-CHECK-AH-FOR-ZERO.
 12655
 12656     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12657        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12658        MOVE ER-2631             TO WS-ERROR
 12659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12660     END-IF
 12661
 12662
 12663******************************************************************
 12664*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12665******************************************************************
 12666
 12667     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12668        NEXT SENTENCE
 12669     ELSE
 12670        IF PB-I-LF-BENEFIT-AMT = ZERO
 12671           MOVE ER-2632             TO WS-ERROR
 12672           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12673
 12674
 12675******************************************************************
 12676*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12677******************************************************************
 12678
 12679     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12680        CONTINUE
 12681     ELSE
 12682        IF PB-I-LF-PREMIUM-AMT = ZERO
 12683           IF (NOT PB-COMP-LF-PREM)
 12684              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12685              MOVE ER-2633       TO WS-ERROR
 12686              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12687           END-IF
 12688        END-IF
 12689     END-IF
 12690     .
 12691 3140-CHECK-AH-FOR-ZERO.
 12692
 12693     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12694        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12695        PB-I-AH-PREMIUM-AMT = ZERO
 12696         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12697
 12698     IF PB-COMPANY-ID = 'CSL'  AND
 12699        PB-I-AH-BENEFIT-CD = ZERO  AND
 12700        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12701        PB-I-AH-PREMIUM-AMT = ZERO
 12702         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12703
 12704     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12705        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12706        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12707         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12708
 12709     IF PB-I-AH-BENEFIT-CD = ZERO
 12710         MOVE ER-2634            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL050.cbl
 12711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12712
 12713******************************************************************
 12714*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12715******************************************************************
 12716
 12717     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12718        NEXT SENTENCE
 12719     ELSE
 12720        IF PB-I-AH-BENEFIT-AMT = ZERO
 12721           MOVE ER-2635             TO WS-ERROR
 12722           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12723
 12724******************************************************************
 12725*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12726******************************************************************
 12727
 12728     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12729        NEXT SENTENCE
 12730     ELSE
 12731        IF PB-I-AH-PREMIUM-AMT = ZERO
 12732            IF NOT PB-COMP-AH-PREM
 12733                MOVE ER-2636    TO WS-ERROR
 12734                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12735
 12736
 12737 3140-EDIT-MAX-AMT-SIZES.
 12738* CUSTOM CODE FOR CLIENT    'DMD'
 12739     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12740                                     WS-RES-MUNI-TAX
 12741                                     PB-I-STATE-TAX
 12742                                     PB-I-MUNI-TAX.
 12743
 12744     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12745
 12746     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12747        GO TO 3150-RATE-OUTSTAND-BAL.
 12748
 12749     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12750        GO TO 3150-RATE-OUTSTAND-BAL.
 12751
 12752     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12753        GO TO 3150-RATE-OUTSTAND-BAL.
 12754
 12755     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12756                             OR 'RIC')
 12757        GO TO 3150-RATE-OUTSTAND-BAL.
 12758
 12759     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12760        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12761            GO TO 3150-RATE-OUTSTAND-BAL
 12762        ELSE
 12763           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12764               GO TO 3150-RATE-OUTSTAND-BAL.
 12765
 12766     IF NOT PB-NO-MONTHS-SKIPPED
 12767        GO TO 3150-RATE-OUTSTAND-BAL.
 12768
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL050.cbl
 12769     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12770        GO TO 3150-RATE-OUTSTAND-BAL.
 12771
 12772     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12773        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12774           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12775             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12776           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12777           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12778              MOVE ER-2693     TO WS-ERROR
 12779              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12780              GO TO 3150-RATE-OUTSTAND-BAL
 12781           ELSE
 12782              GO TO 3150-RATE-OUTSTAND-BAL.
 12783
 12784 3150-RATE-OUTSTAND-BAL.
 12785
 12786* DMD RATING TEST
 12787     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12788         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12789         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12790         MOVE ER-2687                 TO WS-ERROR
 12791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12792         MOVE 'B'                     TO PB-I-OB-FLAG
 12793         GO TO 3260-EDIT-CONTINUE.
 12794
 12795     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12796         IF  WS-ERROR    EQUAL    ER-2693
 12797             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12798                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12799                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12800                 MOVE  +0            TO  WS-ERROR.
 12801
 12802     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12803         IF  WS-ERROR    EQUAL    ER-2693
 12804             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12805                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12806                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12807                 MOVE  +0            TO  WS-ERROR.
 12808
 12809     IF PLAN-MASTER-AH-SW = 'Y'
 12810        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12811            IF  WS-ERROR    EQUAL    ER-2693
 12812              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12813                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12814                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12815                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12816                 MOVE  ER-1910           TO  WS-ERROR
 12817                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12818
 12819     IF PLAN-MASTER-AH-SW = 'Y'
 12820        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12821            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12822               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12823               MOVE  ER-1910           TO  WS-ERROR
 12824               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12825
 12826     IF PLAN-MASTER-AH-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL050.cbl
 12827        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12828            IF  WS-ERROR    EQUAL    ER-2693
 12829                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12830                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12831                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12832                 MOVE  +0       TO  WS-ERROR.
 12833
 12834     IF WS-ERROR = ER-2693
 12835        IF PB-COMPANY-ID = 'JAL' AND
 12836           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12837           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12838           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12839
 12840     IF WS-ERROR = ER-2693
 12841        IF PB-COMPANY-ID = 'NCL'  AND
 12842           PB-I-AH-BENEFIT-CD = 'OA'
 12843           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12844           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12845
 12846     IF WS-ERROR = ER-2693
 12847        IF PB-COMPANY-ID = 'CNL' AND
 12848           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12849           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12850           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12851
 12852     IF WS-ERROR = ER-2693
 12853        IF PB-COMPANY-ID = 'HER'
 12854           IF WS-LEVEL
 12855              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12856              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12857
 12858     IF ((LF-BENEFIT-FOUND) AND
 12859         (NOT NO-LIFE-COVERAGE)  AND
 12860         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12861       OR   ((AH-BENEFIT-FOUND) AND
 12862             (NOT NO-AH-COVERAGE)    AND
 12863             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12864         NEXT SENTENCE
 12865     ELSE
 12866         GO TO 3215-EDIT-RATES.
 12867
 12868     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12869        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12870           MOVE ER-2674          TO WS-ERROR
 12871           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12872           GO TO 3215-EDIT-RATES.
 12873
 12874     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12875        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12876           MOVE ER-2674          TO WS-ERROR
 12877           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12878           GO TO 3215-EDIT-RATES.
 12879
 12880     MOVE 'B'                    TO PB-I-OB-FLAG.
 12881
 12882     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12883         NEXT SENTENCE
 12884     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL050.cbl
 12885         IF NOT NO-LIFE-COVERAGE
 12886             IF WS-ACCT-LF-OB-RT = ZERO
 12887                MOVE ER-2641    TO WS-ERROR
 12888                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12889
 12890     IF PB-COMPANY-ID = 'CRI'
 12891       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12892         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12893         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12894         IF WS-ERROR = ER-2675
 12895            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12896            MOVE ER-2687              TO WS-ERROR
 12897            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12898         ELSE
 12899            MOVE ER-2687              TO WS-ERROR
 12900            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12901
 12902
 12903     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12904         NEXT SENTENCE
 12905     ELSE
 12906       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12907            NEXT SENTENCE
 12908       ELSE
 12909         IF NOT NO-AH-COVERAGE
 12910             IF WS-ACCT-AH-OB-RT = ZERO
 12911                MOVE ER-2642    TO WS-ERROR
 12912                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12913
 12914     IF PB-COMPANY-ID = 'CRI'
 12915       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12916         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12917         IF WS-ERROR = ER-2676
 12918            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12919            MOVE ER-2687              TO WS-ERROR
 12920            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12921         ELSE
 12922            MOVE ER-2687              TO WS-ERROR
 12923            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12924
 12925     IF PB-COMPANY-ID NOT = 'GIC'
 12926         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12927            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12928     ELSE
 12929         IF PB-I-LF-PREM-CALC = ZEROS
 12930             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12931                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12932
 12933     IF PB-COMPANY-ID NOT = 'GIC'
 12934         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12935            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12936     ELSE
 12937         IF PB-I-AH-PREM-CALC = ZEROS
 12938             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12939                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12940
 12941     MOVE ZEROS TO PB-I-MORT-CODE.
 12942
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL050.cbl
 12943     GO TO 3260-EDIT-CONTINUE.
 12944
 12945
 12946 3215-EDIT-RATES.
 12947     IF ACCOUNT-MAST-FOUND
 12948         NEXT SENTENCE
 12949     ELSE
 12950         GO TO 3999-END-EDIT.
 12951
 12952 3220-CHECK-LF-RATES.
 12953
 12954     IF PB-COMPANY-ID = 'DCC'
 12955        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12956        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12957        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12958           AND (NOT WS-LF-CASH))
 12959                           OR
 12960           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12961           AND (NOT WS-AH-CASH)))
 12962                       AND
 12963           (PB-I-ENTRY-STATUS NOT = '5')
 12964           MOVE 'M'              TO PB-BATCH-ENTRY
 12965                                    PB-I-ENTRY-STATUS
 12966        END-IF
 12967     END-IF
 12968     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12969                                    PB-I-AH-PREM-CALC
 12970                                    PB-I-LF-ALT-PREM-CALC
 12971                                    PB-I-LF-ALT-RATE
 12972                                    PB-I-LF-REI-RATE
 12973                                    PB-I-LF-ALT-REI-RATE
 12974                                    PB-I-AH-REI-RATE
 12975                                    PB-I-TOT-FEES-CALC.
 12976
 12977     IF PB-COMPANY-ID EQUAL 'DMD'
 12978        NEXT SENTENCE
 12979     ELSE
 12980        MOVE ZEROS               TO PB-I-LF-RATE
 12981                                    PB-I-AH-RATE.
 12982
 12983     IF PB-I-TOT-FEES NOT NUMERIC
 12984        MOVE ZEROS               TO PB-I-TOT-FEES
 12985     END-IF
 12986     IF PB-I-LIVES NOT NUMERIC
 12987         MOVE ZERO               TO PB-I-LIVES.
 12988
 12989     IF PB-I-NUM-BILLED NOT NUMERIC
 12990         MOVE ZERO               TO PB-I-NUM-BILLED.
 12991
 12992     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12993        MOVE +0                  TO PB-I-LF-PREM-TAX
 12994     END-IF
 12995
 12996     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12997        MOVE +0                  TO PB-I-AH-PREM-TAX
 12998     END-IF
 12999
 13000     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL050.cbl
 13001        PB-I-PAY-FREQUENCY = ZEROS
 13002            MOVE 12 TO CP-PAY-FREQUENCY
 13003     ELSE
 13004            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13005
 13006     IF PB-I-STATE-TAX NOT NUMERIC
 13007         MOVE ZEROS               TO PB-I-STATE-TAX.
 13008
 13009     IF PB-I-MUNI-TAX NOT NUMERIC
 13010         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13011
 13012     MOVE SPACES                 TO CP-BEN-CATEGORY
 13013     IF PB-COMPANY-ID  = 'CSL'  AND
 13014        PB-I-LF-TERM NOT = ZERO
 13015        COMPUTE WS-PAYMENT-AMT =
 13016             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13017        COMPUTE WS-CSL-AMT1 =
 13018             PB-I-LF-TERM * AM-MAX-MON-BEN
 13019        COMPUTE WS-CSL-AMT2 =
 13020             WS-PAYMENT-AMT * PB-I-LF-TERM
 13021        IF CP-PAY-FREQUENCY NOT = 12
 13022           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13023           MOVE '8' TO WS-CSL-CALC-CD
 13024        ELSE
 13025           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13026              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13027               AM-MAX-TOT-BEN
 13028               MOVE '6' TO WS-CSL-CALC-CD
 13029           ELSE
 13030              IF (WS-CSL-AMT1  GREATER THAN
 13031                 AM-MAX-TOT-BEN) AND
 13032                 (WS-CSL-AMT2  GREATER THAN
 13033                 AM-MAX-TOT-BEN)
 13034                 MOVE '7' TO WS-CSL-CALC-CD
 13035              ELSE
 13036                 MOVE '5' TO WS-CSL-CALC-CD.
 13037
 13038     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13039         NEXT SENTENCE
 13040     ELSE
 13041         GO TO 3300-CHECK-AH-RATES.
 13042
 13043*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13044
 13045     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13046        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13047              OR
 13048           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13049           MOVE ER-2618          TO WS-ERROR
 13050           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13051           GO TO 3300-CHECK-AH-RATES.
 13052
 13053     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13054           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13055                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13056
 13057     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13058         MOVE ER-2687             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL050.cbl
 13059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13060         MOVE 'Z000'              TO PB-I-MORT-CODE
 13061         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13062         GO TO 3300-CHECK-AH-RATES.
 13063
 13064     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13065        IF PB-I-LIVES = ZERO
 13066           MOVE ER-2688          TO WS-ERROR
 13067           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13068
 13069     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13070
 13071     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13072     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13073     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13074     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13075     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13076     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13077     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13078     MOVE '3'                    TO CP-PROCESS-TYPE.
 13079     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13080     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13081
 13082******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13083     IF PB-COMPANY-ID EQUAL 'CDL'
 13084         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13085            CP-EARN-AS-NET-PAY)
 13086             IF PB-CERT-EFF-DT GREATER  WS-931231
 13087                 MOVE '1'        TO CP-EARNING-METHOD.
 13088*******
 13089
 13090     MOVE PB-SV-STATE            TO CP-STATE.
 13091     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13092     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13093     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13094     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13095     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13096                                    CP-RATING-BENEFIT-AMT.
 13097     IF CP-STATE-STD-ABBRV = 'OR'
 13098         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13099                                         PB-I-LF-ALT-BENEFIT-AMT.
 13100     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13101     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13102     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13103     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13104     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13105     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13106     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13107     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13108     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13109                                    CP-REMAINING-TERM
 13110                                    CP-LOAN-TERM.
 13111
 13112     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13113         NEXT SENTENCE
 13114     ELSE
 13115         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13116             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL050.cbl
 13117                                           PB-I-LF-PREMIUM-AMT.
 13118
 13119     IF PB-COMPANY-ID EQUAL 'CSL'
 13120        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13121           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13122                                         PB-I-LF-PREMIUM-AMT.
 13123
 13124     IF PB-COMPANY-ID EQUAL 'NCB'
 13125         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13126            CP-EARN-AS-NET-PAY
 13127             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13128                 PB-I-LF-PREMIUM-AMT.
 13129
 13130     IF (CP-TRUNCATED-LIFE)
 13131        or ((pb-company-id = 'AHL')
 13132           and (pb-i-loan-term > pb-i-lf-term))
 13133        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13134
 13135     IF PB-COMPANY-ID EQUAL 'CRI'
 13136        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13137
 13138     IF CP-TERM-IS-DAYS
 13139         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13140     ELSE
 13141         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13142     IF PB-COMPANY-ID = 'DCC'
 13143        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13144        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13145        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13146        IF WS-LF-BEN-CATEGORY = 'D'
 13147           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13148           MOVE PB-I-LIFE-COMMISSION
 13149                                 TO CP-DCC-ACT-COMM
 13150           MOVE WS-LF-BEN-CATEGORY
 13151                                 TO CP-BEN-CATEGORY
 13152        END-IF
 13153        IF (CP-BENEFIT-CD (1:1) = 'P')
 13154           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13155           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13156        END-IF
 13157     END-IF
 13158     IF PB-COMPANY-ID = 'CSL'
 13159         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13160         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13161         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13162
 13163     IF PB-COMPANY-ID = 'CSL'
 13164        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13165
 13166     IF (CP-SPECIAL-CALC-CD = 'H')
 13167        OR (PB-COMPANY-ID = 'DCC')
 13168         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13169                                    TO CP-ALTERNATE-BENEFIT
 13170         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13171
 13172     IF (PB-COMPANY-ID = 'CID')
 13173        AND (WS-LF-EARNINGS-CALC = 'B')
 13174        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL050.cbl
 13175        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13176                                 TO CP-ALTERNATE-BENEFIT
 13177        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13178     END-IF
 13179     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13180     MOVE 'R'                   TO CP-RATE-FILE.
 13181     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13182
 13183     IF CP-ERROR-RATE-NOT-FOUND
 13184        MOVE ER-2641            TO WS-ERROR
 13185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13186        GO TO 3300-CHECK-AH-RATES.
 13187
 13188     IF PB-COMPANY-ID EQUAL 'CRI'
 13189        IF CP-ERROR-NO-LIMITS-CRI
 13190           IF NOT ACCOUNT-LIFE-CHECKED
 13191              MOVE ER-2607      TO WS-ERROR
 13192              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13193
 13194******************************************************************
 13195*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13196*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13197******************************************************************
 13198
 13199* CALC LIFE AGE AT EXPIRATION.
 13200
 13201     COMPUTE WS-AGE-AT-EXPIRE =
 13202          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13203
 13204*    IF PB-STATE = 'CO' OR 'UT'
 13205*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13206*        MOVE 'F'            TO PB-FATAL-FLAG
 13207*        MOVE ER-2709        TO WS-ERROR
 13208*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13209*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13210
 13211*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13212*        MOVE 'X'            TO PB-FATAL-FLAG
 13213*        MOVE ER-2718        TO WS-ERROR
 13214*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13216
 13217* CALC A & H AGE AT EXPIRATION.
 13218
 13219     COMPUTE WS-AGE-AT-EXPIRE =
 13220          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13221
 13222*    IF PB-STATE = 'CO' OR 'UT'
 13223*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13224*        MOVE 'F'            TO PB-FATAL-FLAG
 13225*        MOVE ER-2709        TO WS-ERROR
 13226*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13227*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13228
 13229*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13230*        MOVE 'X'            TO PB-FATAL-FLAG
 13231*        MOVE ER-2718        TO WS-ERROR
 13232*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL050.cbl
 13233*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13234
 13235     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13236        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13237
 13238     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13239        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13240
 13241     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13242        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13243
 13244     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13245         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13246         MOVE ER-2639        TO WS-ERROR
 13247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13248
 13249
 13250******************************************************************
 13251*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13252******************************************************************
 13253
 13254 PREMIUM-EDITING-IS-BYPASSED.
 13255     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13256        AND (CP-R-MAX-ATT-AGE > +0)
 13257        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13258        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13259           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13260           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13261           MOVE '1'              TO DC-OPTION-CODE
 13262           PERFORM 8500-DATE-CONVERT
 13263                                 THRU 8500-EXIT
 13264           IF NO-CONVERSION-ERROR
 13265              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13266                 MOVE ER-2661       TO WS-ERROR
 13267*                PERFORM 9900-ERROR-FORMAT
 13268*                                THRU 9900-EXIT
 13269              END-IF
 13270           END-IF
 13271        ELSE
 13272           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13273           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13274              MOVE ER-2661       TO WS-ERROR
 13275*             PERFORM 9900-ERROR-FORMAT
 13276*                                THRU 9900-EXIT
 13277           ELSE
 13278              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13279                 MOVE ER-1570    TO WS-ERROR
 13280                 PERFORM 9900-ERROR-FORMAT
 13281                                 THRU 9900-EXIT
 13282              END-IF
 13283           END-IF
 13284        END-IF
 13285        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13286           MOVE PB-I-JOINT-BIRTHDAY
 13287                                 TO DC-BIN-DATE-1
 13288           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13289           MOVE '1'              TO DC-OPTION-CODE
 13290           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL050.cbl
 13291                                 THRU 8500-EXIT
 13292           IF NO-CONVERSION-ERROR
 13293              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13294                 MOVE ER-2661       TO WS-ERROR
 13295*                PERFORM 9900-ERROR-FORMAT
 13296*                                THRU 9900-EXIT
 13297              END-IF
 13298           ELSE
 13299              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13300           END-IF
 13301        ELSE
 13302           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13303             (PB-I-LF-TERM / 12)
 13304           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13305              MOVE ER-2661       TO WS-ERROR
 13306*             PERFORM 9900-ERROR-FORMAT
 13307*                                THRU 9900-EXIT
 13308           ELSE
 13309              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13310                 MOVE ER-1571    TO WS-ERROR
 13311                 PERFORM 9900-ERROR-FORMAT
 13312                                 THRU 9900-EXIT
 13313              END-IF
 13314           END-IF
 13315        END-IF
 13316        IF WS-ERROR = ER-2661
 13317           PERFORM 9900-ERROR-FORMAT
 13318                                 THRU 9900-EXIT
 13319        END-IF
 13320     END-IF
 13321*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13322*       MOVE ER-2661             TO WS-ERROR
 13323*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13324
 13325     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13326        MOVE ER-2662             TO WS-ERROR
 13327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13328
 13329     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13330        MOVE ER-2677             TO WS-ERROR
 13331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13332
 13333     IF CP-ERROR-LOAN-TERM
 13334        MOVE ER-2648             TO WS-ERROR
 13335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13336
 13337 3221-CHECK-ERROR-RATE-OPEN.
 13338
 13339     IF CP-ERROR-RATE-FILE-NOTOPEN
 13340         GO TO 3990-FILES-NOT-OPEN.
 13341
 13342     IF PB-COMPANY-ID NOT = 'DMD'
 13343        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13344     END-IF
 13345     .
 13346 3221-CONTINUE.
 13347     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13348                                    WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL050.cbl
 13349     IF PB-COMPANY-ID = 'DCC'
 13350        IF WS-LF-BEN-CATEGORY = 'D'
 13351           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13352              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13353        END-IF
 13354     END-IF
 13355     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13356*   X'A4FF' = 12/31/2009
 13357     IF (PB-COMPANY-ID = 'CID')
 13358        AND (WS-LF-EARNINGS-CALC = 'B')
 13359        AND (CP-STATE-STD-ABBRV = 'MN')
 13360        AND (PB-CERT-EFF-DT > X'A4FF')
 13361        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13362     END-IF
 13363     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13364
 13365     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13366     IF (PB-COMPANY-ID = 'DCC')
 13367        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13368        AND (PB-I-POLICY-IS-MONTHLY)
 13369        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13370        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13371     END-IF
 13372     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13373     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13374     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13375     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13376     IF (PB-COMPANY-ID = 'DCC')
 13377        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13378        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13379        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13380        MOVE ER-2786             TO WS-ERROR
 13381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13382     END-IF
 13383
 13384     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13385
 13386******************************************************************
 13387*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13388******************************************************************
 13389     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13390        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13391
 13392     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13393        GO TO 3225-CHECK-ALT-LIFE-RATE
 13394     ELSE
 13395       IF PB-I-LF-RATE = ZERO
 13396          MOVE ER-2641          TO WS-ERROR
 13397          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13398
 13399 3225-CHECK-ALT-LIFE-RATE.
 13400
 13401     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13402        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13403        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13404         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13405
 13406     IF (WS-LF-EARNINGS-CALC NOT = 'B')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL050.cbl
 13407         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13408             AND PB-COMPANY-ID NOT = 'DCC')
 13409                   OR
 13410              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13411              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13412              AND PB-COMPANY-ID NOT = 'DCC')
 13413             MOVE ER-2720        TO  WS-ERROR
 13414             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13415             GO TO 3225-RATING-CONT
 13416         ELSE
 13417             GO TO 3225-RATING-CONT.
 13418     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13419        AND (AM-GPCD = 01 OR 06 OR 15)
 13420        MOVE ER-2798             TO WS-ERROR
 13421        PERFORM 9900-ERROR-FORMAT
 13422                                 THRU 9900-EXIT
 13423*       GO TO 3225-RATING-CONT
 13424     END-IF
 13425     IF (PB-COMPANY-ID = 'CID')
 13426        AND (WS-LF-EARNINGS-CALC = 'B')
 13427        AND (CP-STATE-STD-ABBRV = 'MN')
 13428        AND (PB-CERT-EFF-DT > X'A4FF')
 13429        GO TO 3225-RATING-CONT
 13430     END-IF
 13431     IF PB-COMPANY-ID = 'DCC'
 13432        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13433           AND (PB-I-POLICY-IS-MONTHLY)
 13434           GO TO 3225-RATING-CONT
 13435        END-IF
 13436     END-IF
 13437
 13438     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13439        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13440        CP-EARN-AS-REG-BALLOON
 13441        NEXT SENTENCE
 13442     ELSE
 13443        MOVE '2'                 TO CP-EARNING-METHOD.
 13444
 13445 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13446
 13447     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13448
 13449     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13450        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13451        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13452         NEXT SENTENCE
 13453     ELSE
 13454         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13455
 13456     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13457     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13458     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13459                                     CP-RATING-BENEFIT-AMT.
 13460     IF CP-STATE-STD-ABBRV = 'OR'
 13461         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13462                                         PB-I-LF-ALT-BENEFIT-AMT.
 13463     IF PB-COMPANY-ID = 'DCC'
 13464        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL050.cbl
 13465     END-IF
 13466     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13467     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13468     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13469                                    CP-REMAINING-TERM
 13470                                    CP-LOAN-TERM.
 13471     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13472        ADD +1                   TO CP-ORIGINAL-TERM
 13473                                    CP-REMAINING-TERM
 13474                                    CP-LOAN-TERM.
 13475
 13476     MOVE 'R'                   TO CP-RATE-FILE.
 13477     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13478
 13479     IF CP-ERROR-RATE-NOT-FOUND
 13480         MOVE ER-2641            TO WS-ERROR
 13481         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13482         GO TO 3300-CHECK-AH-RATES.
 13483
 13484     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13485     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13486
 13487     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13488         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13489
 13490     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13491                               + PB-I-LF-ALT-BENEFIT-AMT.
 13492
 13493     IF ACCOUNT-LIFE-CHECKED  OR
 13494        PB-POLICY-IS-VOIDED   OR
 13495        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13496        GO TO 3225-CONTINUE.
 13497
 13498     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13499        GO TO 3225-CONTINUE.
 13500
 13501     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13502                             EC-RT-LF-MAX-TOT-BEN
 13503        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13504        MOVE ER-2639       TO WS-ERROR
 13505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13506
 13507 3225-CONTINUE.
 13508     IF PB-I-LF-ALT-RATE = ZERO
 13509         MOVE ER-2659            TO WS-ERROR
 13510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13511
 13512     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13513        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13514        MOVE ER-2698             TO WS-ERROR
 13515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13516
 13517 3225-RATING-CONT.
 13518
 13519     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13520         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13521         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13522         MOVE ER-2687             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL050.cbl
 13523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13524         GO TO 3290-EDIT-LF-REIN-RATE.
 13525
 13526* DMD RATING TEST
 13527     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13528         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13529         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13530         MOVE ER-2687                 TO WS-ERROR
 13531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13532         GO TO 3290-EDIT-LF-REIN-RATE.
 13533
 13534 3230-CLIENT-MORT-CD-SPECIALS.
 13535
 13536     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13537     SET BIN-TO-GREG          TO TRUE.
 13538*    MOVE ' '                 TO DC-OPTION-CODE.
 13539     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13540     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13541
 13542 C-POS-3230-MORT-CD.
 13543     IF PB-COMPANY-ID = 'POS' AND
 13544        PB-SV-CARRIER = '2'
 13545         NEXT SENTENCE
 13546     ELSE
 13547         GO TO C-POS-3240-MORT-CD.
 13548
 13549     IF PB-SV-GROUPING = '030'
 13550        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13551         MOVE '2350' TO PB-I-MORT-CODE
 13552      ELSE
 13553         MOVE '3300' TO PB-I-MORT-CODE.
 13554
 13555
 13556 C-POS-3240-MORT-CD.
 13557     IF PB-COMPANY-ID = 'POS' AND
 13558        PB-SV-CARRIER = '1'
 13559         NEXT SENTENCE
 13560     ELSE
 13561         GO TO 3230-CONTINUE.
 13562
 13563     IF PB-SV-STATE = '45' OR '47'
 13564        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13565         MOVE '5200' TO PB-I-MORT-CODE
 13566     ELSE
 13567         MOVE '8300' TO PB-I-MORT-CODE.
 13568
 13569 3230-CONTINUE.
 13570
 13571     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13572        GO TO 3240-CONTINUE
 13573     END-IF
 13574
 13575     IF PB-CERT-EFF-DT > WS-971231
 13576        GO TO 3240-CONTINUE
 13577     END-IF
 13578
 13579     IF LF-BENEFIT-FOUND AND
 13580        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL050.cbl
 13581         MOVE 'F250'       TO PB-I-MORT-CODE
 13582     ELSE
 13583         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13584             MOVE '7250'   TO PB-I-MORT-CODE
 13585         ELSE
 13586             MOVE '4251'   TO PB-I-MORT-CODE
 13587         END-IF
 13588     END-IF
 13589
 13590     .
 13591 3240-CONTINUE.
 13592
 13593     IF PB-COMPANY-ID NOT = 'GNL'
 13594         GO TO 3256-CONTINUE.
 13595
 13596     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13597         MOVE 'A300' TO PB-I-MORT-CODE
 13598     ELSE
 13599         MOVE '8350' TO PB-I-MORT-CODE.
 13600
 13601 3256-CONTINUE.
 13602     IF PB-COMPANY-ID NOT = 'ABL'
 13603         GO TO 3260-EDIT-CONTINUE.
 13604
 13605     IF PB-I-LF-TERM GREATER THAN 59
 13606         MOVE 'F550' TO PB-I-MORT-CODE
 13607     ELSE
 13608         MOVE 'E550' TO PB-I-MORT-CODE.
 13609
 13610 3260-EDIT-CONTINUE.
 13611     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13612
 13613 3290-EDIT-LF-REIN-RATE.
 13614     IF LF-REIN-NSP-NOT-USED
 13615         GO TO 3290-RATING-CONT.
 13616
 13617     IF PB-COMPANY-ID = 'DCC'
 13618        GO TO 3290-RATING-CONT.
 13619     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13620     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13621     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13622     MOVE '3'                   TO CP-PROCESS-TYPE.
 13623     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13624
 13625******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13626     IF PB-COMPANY-ID EQUAL 'CDL'
 13627         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13628            CP-EARN-AS-NET-PAY)
 13629             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13630*            MOVE SPACE          TO DC-OPTION-CODE
 13631             SET BIN-TO-GREG     TO TRUE
 13632             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13633***  Y2K PROJ 7744
 13634             IF DC-GREG-DATE-CYMD GREATER 19931231
 13635                 MOVE '1'        TO CP-EARNING-METHOD.
 13636***  Y2K PROJ 7744
 13637*******
 13638
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL050.cbl
 13639     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13640     MOVE PB-SV-STATE           TO CP-STATE.
 13641     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13642     MOVE ZERO                  TO CP-DEVIATION-CODE
 13643                                   CP-RATE-DEV-PCT.
 13644     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13645     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13646                                   CP-RATING-BENEFIT-AMT.
 13647
 13648************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13649     IF PB-COMPANY-ID EQUAL 'NCB'
 13650         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13651            CP-EARN-AS-NET-PAY
 13652             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13653                 PB-I-LF-PREMIUM-AMT.
 13654************
 13655
 13656     IF CP-STATE-STD-ABBRV = 'OR'
 13657         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13658                                         PB-I-LF-ALT-BENEFIT-AMT.
 13659     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13660     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13661     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13662     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13663     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13664     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13665     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13666     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13667                                   CP-REMAINING-TERM
 13668                                   CP-LOAN-TERM.
 13669     IF CP-TRUNCATED-LIFE
 13670        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13671
 13672     IF CP-TERM-IS-DAYS
 13673         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13674     ELSE
 13675         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13676
 13677     IF PB-COMPANY-ID = 'DCC'
 13678        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13679     END-IF
 13680     IF PB-COMPANY-ID NOT = 'TIC'
 13681          MOVE ZERO          TO CP-CLASS-CODE.
 13682
 13683     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13684
 13685     MOVE 'R'                   TO CP-RATE-FILE.
 13686     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13687
 13688     IF CP-ERROR-RATE-NOT-FOUND
 13689        IF PB-I-OB
 13690           MOVE ER-2625      TO WS-ERROR
 13691           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13692           GO TO 3299-EDIT-CONTINUE
 13693        ELSE
 13694           MOVE ER-2643      TO WS-ERROR
 13695           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13696           GO TO 3299-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL050.cbl
 13697
 13698     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13699
 13700     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13701     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13702
 13703     IF PB-I-LF-REI-RATE = ZERO
 13704         MOVE ER-2643        TO WS-ERROR
 13705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13706
 13707 3290-CHECK-ALT-REIN-RATE.
 13708
 13709     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13710        GO TO 3290-RATING-CONT.
 13711
 13712     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13713     MOVE '2'                    TO CP-EARNING-METHOD.
 13714     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13715     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13716     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13717     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13718                                     CP-RATING-BENEFIT-AMT.
 13719     IF CP-STATE-STD-ABBRV = 'OR'
 13720         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13721                                         PB-I-LF-ALT-BENEFIT-AMT.
 13722     IF PB-COMPANY-ID = 'DCC'
 13723        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13724     END-IF
 13725     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13726     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13727     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13728                                    CP-REMAINING-TERM
 13729                                    CP-LOAN-TERM.
 13730     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13731        ADD +1                   TO CP-ORIGINAL-TERM
 13732                                    CP-REMAINING-TERM
 13733                                    CP-LOAN-TERM.
 13734
 13735     MOVE 'R'                   TO CP-RATE-FILE.
 13736     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13737
 13738     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13739
 13740     IF PB-I-LF-ALT-REI-RATE = ZERO
 13741         MOVE ER-2643            TO WS-ERROR
 13742         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13743
 13744 3290-RATING-CONT.
 13745
 13746     IF PB-I-OB
 13747*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13748        GO TO 3300-CHECK-AH-RATES.
 13749
 13750 3299-EDIT-CONTINUE.
 13751
 13752     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13753         NEXT SENTENCE
 13754     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL050.cbl
 13755         MOVE ER-2620           TO WS-ERROR
 13756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13757
 13758 3300-CHECK-AH-RATES.
 13759     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13760         NEXT SENTENCE
 13761     ELSE
 13762         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13763
 13764     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13765        ((CF-COMPANY-ID = 'DMD') AND
 13766                (NO-DMD-RATING))
 13767         MOVE ER-2687             TO WS-ERROR
 13768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13769         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13770         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13771
 13772     IF PB-I-OB
 13773        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13774
 13775     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13776         MOVE ER-2687             TO WS-ERROR
 13777         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13778         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13779         GO TO 3999-END-EDIT.
 13780
 13781*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13782
 13783     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13784        IF PB-I-AH-CRIT-PER = ZERO
 13785           IF PB-COMPANY-ID = 'DCC'
 13786              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13787              CONTINUE
 13788           ELSE
 13789              MOVE ER-2618       TO WS-ERROR
 13790              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13791              GO TO 3999-END-EDIT
 13792           END-IF
 13793        END-IF
 13794     END-IF
 13795     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13796     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13797     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13798     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13799     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13800     MOVE PB-SV-STATE            TO CP-STATE.
 13801     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13802     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13803     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13804*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13805     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13806     MOVE '3'                    TO CP-PROCESS-TYPE.
 13807     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13808     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13809                                    CP-RATING-BENEFIT-AMT.
 13810     IF PB-COMPANY-ID = 'CID'
 13811               OR
 13812        CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL050.cbl
 13813         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13814                                         PB-I-AH-TERM.
 13815     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13816        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13817           AND (PB-I-POLICY-IS-MONTHLY)
 13818           MOVE PB-I-LF-BENEFIT-AMT
 13819                                 TO CP-NET-BENEFIT-AMT
 13820           move pb-i-ah-premium-amt to cp-original-premium
 13821        END-IF
 13822     END-IF
 13823     MOVE SPACES                 TO CP-BEN-CATEGORY
 13824     IF PB-COMPANY-ID = 'DCC'
 13825        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13826        EVALUATE TRUE
 13827           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13828              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13829              MOVE PB-I-LF-BENEFIT-AMT
 13830                                 TO CP-RATING-BENEFIT-AMT
 13831              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13832           WHEN WS-AH-BEN-CATEGORY = 'G'
 13833              MOVE PB-I-UNPAID-CASH-PRICE
 13834                                 TO CP-RATING-BENEFIT-AMT
 13835           WHEN WS-AH-BEN-CATEGORY = 'D'
 13836              MOVE WS-AH-PMF-COMM
 13837                                 TO CP-DCC-PMF-COMM
 13838              MOVE PB-I-AH-COMMISSION
 13839                                 TO CP-DCC-ACT-COMM
 13840        END-EVALUATE
 13841     END-IF
 13842     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13843     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13844     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13845     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13846     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13847     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13848     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13849                                    CP-REMAINING-TERM
 13850                                    WS-WORK-TERM.
 13851     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13852
 13853     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13854     SET BIN-TO-GREG             TO TRUE.
 13855*    MOVE ' '                    TO DC-OPTION-CODE.
 13856     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13857     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13858
 13859     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13860     IF NOT VALID-SKIP-CODE
 13861         MOVE ER-2683            TO WS-ERROR
 13862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13863         GO TO 3320-RATE-CONTINUE.
 13864
 13865     IF PB-NO-MONTHS-SKIPPED
 13866         GO TO 3320-RATE-CONTINUE.
 13867
 13868     MOVE SPACE TO NUMBER-OF-MONTHS.
 13869
 13870     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL050.cbl
 13871         MOVE 'S'                TO SK-MO (6).
 13872     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13873         MOVE 'S'                TO SK-MO (7).
 13874     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13875         MOVE 'S'                TO SK-MO (8).
 13876     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13877         MOVE 'S'                TO SK-MO (9).
 13878     IF PB-I-SKIP-CODE = 'A'
 13879         MOVE 'S'                TO SK-MO (10).
 13880
 13881     MOVE 1                      TO SUB2.
 13882     MOVE PB-I-AH-TERM           TO SUB3.
 13883     MOVE WS-MONTH               TO SUB1.
 13884     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13885     GO TO 3320-RATE-CONTINUE.
 13886
 13887 3310-GET-SKIP-MO.
 13888     IF SUB1 = 13
 13889         MOVE 1                  TO SUB1.
 13890
 13891     IF SK-MO (SUB1) = 'S'
 13892         SUBTRACT 1 FROM WS-WORK-TERM.
 13893
 13894     ADD 1 TO SUB2
 13895              SUB1.
 13896
 13897 3320-RATE-CONTINUE.
 13898
 13899     IF WS-WORK-TERM = ZERO
 13900         MOVE 1                  TO WS-WORK-TERM.
 13901
 13902     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13903                                    CP-LOAN-TERM.
 13904
 13905     IF PB-COMPANY-ID EQUAL 'DMD'
 13906         NEXT SENTENCE
 13907     ELSE
 13908         MOVE ZERO               TO PB-I-AH-RATE
 13909                                    PB-I-AH-REI-RATE.
 13910
 13911
 13912     IF PB-COMPANY-ID EQUAL 'CRI'
 13913        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13914
 13915     IF PB-COMPANY-ID = 'CSL'
 13916         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13917         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13918         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13919         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13920
 13921     IF PB-COMPANY-ID = 'DCC'
 13922        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13923           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13924              PB-I-RATE-DEV-PCT-LF
 13925        END-IF
 13926        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13927                                 TO CP-ALTERNATE-BENEFIT
 13928        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL050.cbl
 13929        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13930        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13931     END-IF
 13932     IF (PB-COMPANY-ID = 'CID')
 13933        AND (WS-LF-EARNINGS-CALC = 'B')
 13934        AND (CP-STATE-STD-ABBRV = 'MN')
 13935        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13936     ELSE
 13937        MOVE ' '                 TO CP-AH-BALLOON-SW
 13938     END-IF
 13939     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13940     MOVE 'R'                   TO CP-RATE-FILE.
 13941     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13942
 13943     IF CP-ERROR-RATE-NOT-FOUND
 13944        IF PB-I-OB
 13945           MOVE ER-2624          TO WS-ERROR
 13946           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13947           GO TO 3340-CALCULATE-PREMIUM-AMT
 13948        ELSE
 13949          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13950              NEXT SENTENCE
 13951          ELSE
 13952           MOVE ER-2642          TO WS-ERROR
 13953           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13954           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13955
 13956     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13957        CP-ERROR-DIV-BY-ZERO
 13958           MOVE ER-3782          TO WS-ERROR
 13959           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13960
 13961     IF PB-COMPANY-ID EQUAL 'CRI'
 13962        IF CP-ERROR-NO-LIMITS-CRI
 13963           IF NOT ACCOUNT-AH-CHECKED
 13964              MOVE ER-2607          TO WS-ERROR
 13965              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13966
 13967     IF ACCOUNT-AH-CHECKED
 13968        NEXT SENTENCE
 13969     ELSE
 13970       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13971          MOVE ER-2640           TO WS-ERROR
 13972          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13973
 13974     IF PB-COMPANY-ID = 'CRI'
 13975         IF WS-ERROR = ER-2640
 13976             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13977     IF ACCOUNT-AH-CHECKED
 13978        CONTINUE
 13979     ELSE
 13980        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13981           AND (CP-R-MAX-ATT-AGE > +0)
 13982           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13983           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13984              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13985              MOVE PB-I-AH-EXPIRE-DT
 13986                                 TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL050.cbl
 13987              MOVE '1'           TO DC-OPTION-CODE
 13988              PERFORM 8500-DATE-CONVERT
 13989                                 THRU 8500-EXIT
 13990              IF NO-CONVERSION-ERROR
 13991                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13992                    MOVE ER-2661       TO WS-ERROR
 13993*                   PERFORM 9900-ERROR-FORMAT
 13994*                                THRU 9900-EXIT
 13995                 END-IF
 13996              END-IF
 13997           ELSE
 13998              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13999              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14000                 MOVE ER-2661    TO WS-ERROR
 14001*                PERFORM 9900-ERROR-FORMAT
 14002*                                THRU 9900-EXIT
 14003              ELSE
 14004                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14005                    MOVE ER-1570 TO WS-ERROR
 14006                    PERFORM 9900-ERROR-FORMAT
 14007                                 THRU 9900-EXIT
 14008                 END-IF
 14009              END-IF
 14010           END-IF
 14011           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14012              MOVE PB-I-JOINT-BIRTHDAY
 14013                                    TO DC-BIN-DATE-1
 14014              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14015              MOVE '1'              TO DC-OPTION-CODE
 14016              PERFORM 8500-DATE-CONVERT
 14017                                    THRU 8500-EXIT
 14018              IF NO-CONVERSION-ERROR
 14019                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14020                    MOVE ER-2661       TO WS-ERROR
 14021*                   PERFORM 9900-ERROR-FORMAT
 14022*                                   THRU 9900-EXIT
 14023                 END-IF
 14024              END-IF
 14025           ELSE
 14026              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14027                (PB-I-AH-TERM / 12)
 14028              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14029                 MOVE ER-2661       TO WS-ERROR
 14030*                PERFORM 9900-ERROR-FORMAT
 14031*                                   THRU 9900-EXIT
 14032              ELSE
 14033                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14034                    MOVE ER-1571 TO WS-ERROR
 14035                    PERFORM 9900-ERROR-FORMAT
 14036                                 THRU 9900-EXIT
 14037                 END-IF
 14038              END-IF
 14039           END-IF
 14040           IF WS-ERROR = ER-2661
 14041              PERFORM 9900-ERROR-FORMAT
 14042                                    THRU 9900-EXIT
 14043           END-IF
 14044        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL050.cbl
 14045     END-IF
 14046*    IF ACCOUNT-AH-CHECKED
 14047*       NEXT SENTENCE
 14048*    ELSE
 14049*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14050*          MOVE ER-2661          TO WS-ERROR
 14051*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14052
 14053     IF ACCOUNT-AH-CHECKED
 14054        NEXT SENTENCE
 14055     ELSE
 14056        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14057           MOVE ER-2663          TO WS-ERROR
 14058           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14059
 14060     IF ACCOUNT-AH-CHECKED OR
 14061        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14062         PB-POLICY-IS-VOIDED
 14063        NEXT SENTENCE
 14064     ELSE
 14065        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14066           MOVE ER-2667            TO WS-ERROR
 14067           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14068
 14069     IF PB-COMPANY-ID = 'CRI'
 14070         IF WS-ERROR = ER-2667
 14071             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14072
 14073     IF ACCOUNT-AH-CHECKED
 14074        NEXT SENTENCE
 14075     ELSE
 14076        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14077           MOVE ER-2678            TO WS-ERROR
 14078           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14079
 14080     IF CP-ERROR-RATE-FILE-NOTOPEN
 14081         GO TO 3990-FILES-NOT-OPEN.
 14082
 14083 3321-CONTINUE.
 14084     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14085     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14086     IF (PB-COMPANY-ID = 'DCC')
 14087        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14088        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14089                                    PB-I-LF-ALT-PREM-CALC
 14090        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14091        IF WS-AH-BEN-CATEGORY = 'G'
 14092           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14093           + PB-I-ADDL-CLP)
 14094           * (1 + WS-TOL-CLP-PCT)
 14095*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14096        ELSE
 14097           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14098           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14099*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14100        END-IF
 14101        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14102                                 TO PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL050.cbl
 14103        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14104           MOVE ER-8152          TO WS-ERROR
 14105           PERFORM 9900-ERROR-FORMAT
 14106                                 THRU 9900-EXIT
 14107        ELSE
 14108           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14109                 PB-I-ADDL-CLP)
 14110              MOVE ER-8148       TO WS-ERROR
 14111              PERFORM 9900-ERROR-FORMAT
 14112                                 THRU 9900-EXIT
 14113           END-IF
 14114        END-IF
 14115     END-IF
 14116     IF (PB-COMPANY-ID = 'DCC')
 14117        AND (PB-I-POLICY-IS-MONTHLY)
 14118        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14119        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14120        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14121           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14122        END-IF
 14123     END-IF
 14124     IF (PB-COMPANY-ID = 'DCC')
 14125        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14126        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14127        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14128        MOVE ER-2786             TO WS-ERROR
 14129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14130     END-IF
 14131     MOVE +0                     TO PB-I-AH-CLP
 14132     IF PB-COMPANY-ID = 'DCC'
 14133        IF WS-AH-BEN-CATEGORY = 'D'
 14134           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14135              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14136        ELSE
 14137           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14138              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14139           END-IF
 14140        END-IF
 14141     END-IF
 14142     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14143
 14144     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14145         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14146
 14147     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14148         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14149
 14150     IF PB-COMPANY-ID = 'CRI'
 14151         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14152            PB-I-PAYMENT-AMOUNT = ZERO
 14153             NEXT SENTENCE
 14154         ELSE
 14155             COMPUTE PB-I-AH-PREM-CALC =
 14156                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14157                 (CP-PREMIUM-RATE / 100)
 14158             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14159                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14160                                             PB-I-RATE-DEV-PCT-AH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 257
* EL050.cbl
 14161
 14162     IF PB-I-AH-RATE  = ZERO
 14163       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14164           NEXT SENTENCE
 14165       ELSE
 14166         MOVE ER-2642            TO WS-ERROR
 14167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14168
 14169     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14170     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14171     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14172     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14173     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14174     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14175
 14176     IF (PB-COMPANY-ID = 'DCC')
 14177        AND (WS-AH-BEN-CATEGORY = 'G')
 14178        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14179        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14180        IF CP-DEVIATION-CODE NOT = '000'
 14181           MOVE '000'            TO CP-DEVIATION-CODE
 14182           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14183           IF NO-CP-ERROR
 14184              COMPUTE PB-I-DDF-IU-RATE-UP =
 14185              PB-I-AH-CLP - CP-CALC-PREMIUM
 14186           ELSE
 14187              MOVE ER-3057        TO WS-ERROR
 14188              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14189           END-IF
 14190        END-IF
 14191     END-IF
 14192     .
 14193 3335-EDIT-AH-REIN-NSP-RATE.
 14194     IF AH-REIN-NSP-NOT-USED
 14195         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14196
 14197     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14198     IF PB-COMPANY-ID = 'DCC'
 14199         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14200     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14201     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14202     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14203     MOVE PB-SV-STATE            TO CP-STATE.
 14204     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14205     MOVE ZERO                   TO CP-DEVIATION-CODE
 14206                                    CP-RATE-DEV-PCT.
 14207*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14208     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14209     MOVE '3'                    TO CP-PROCESS-TYPE.
 14210     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14211     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14212                                    CP-RATING-BENEFIT-AMT.
 14213     IF CP-STATE-STD-ABBRV = 'OR'
 14214         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14215                                         PB-I-AH-TERM.
 14216     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14217     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14218     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 258
* EL050.cbl
 14219     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14220     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14221     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14222                                    CP-REMAINING-TERM
 14223                                    WS-WORK-TERM.
 14224     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14225     IF PB-COMPANY-ID = 'DCC'
 14226        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14227     END-IF
 14228     IF  PB-COMPANY-ID = 'TIC'
 14229         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14230            MOVE ZERO TO CP-CLASS-CODE.
 14231
 14232     IF PB-COMPANY-ID NOT = 'TIC'
 14233          MOVE ZERO          TO CP-CLASS-CODE.
 14234
 14235     MOVE ZERO               TO CP-DEVIATION-CODE.
 14236
 14237     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14238
 14239     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14240
 14241     MOVE 'R'                   TO CP-RATE-FILE.
 14242     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14243
 14244     IF CP-ERROR-RATE-NOT-FOUND
 14245         MOVE ER-2645        TO WS-ERROR
 14246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14247         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14248
 14249     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14250
 14251     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14252     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14253
 14254     IF PB-I-AH-REI-RATE = ZERO
 14255         MOVE ER-2645        TO WS-ERROR
 14256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14257
 14258
 14259 3340-CALCULATE-PREMIUM-AMT.
 14260
 14261     IF PB-COMPANY-ID = 'NCL'
 14262         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14263             WS-AH-SPECIAL-CALC-CD = 'O')
 14264             GO TO 3999-END-EDIT.
 14265
 14266     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14267                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14268                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14269                         OR 'AHL'
 14270         NEXT SENTENCE
 14271     ELSE
 14272         IF WS-STATE-ABBREVIATION = 'CT'
 14273             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14274                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14275                 COMPUTE PB-I-LF-PREM-CALC =
 14276                                     PB-I-LF-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 259
* EL050.cbl
 14277                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14278                                     PB-I-LF-ALT-PREM-CALC * .90
 14279                 COMPUTE PB-I-AH-PREM-CALC =
 14280                                     PB-I-AH-PREM-CALC * .90.
 14281
 14282     IF PB-COMP-LF-PREM
 14283        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14284        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14285
 14286     IF PB-COMP-AH-PREM
 14287        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14288
 14289 3340-CHECK-DCC-TOT-FEES.
 14290     IF (PB-COMPANY-ID = 'DCC')
 14291        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14292        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14293        AND (PB-I-POLICY-IS-MONTHLY)
 14294        CONTINUE
 14295     ELSE
 14296        GO TO 3340-EDIT-LF-AH-TOL
 14297     END-IF
 14298     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14299     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14300     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14301        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14302           PB-I-RATE-DEV-PCT-LF
 14303     END-IF
 14304     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14305        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14306           PB-I-RATE-DEV-PCT-AH
 14307     END-IF
 14308     MOVE 'N'                    TO CP-BEN-CATEGORY
 14309     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14310
 14311     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14312     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14313     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14314     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14315     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14316     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14317     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14318     MOVE '3'                    TO CP-PROCESS-TYPE.
 14319     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14320     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14321
 14322     MOVE PB-SV-STATE            TO CP-STATE.
 14323     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14324     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14325     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14326     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14327     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14328                                    CP-RATING-BENEFIT-AMT.
 14329     IF CP-STATE-STD-ABBRV = 'OR'
 14330         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14331                                         PB-I-LF-ALT-BENEFIT-AMT.
 14332     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14333     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14334     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 260
* EL050.cbl
 14335     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14336     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14337     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14338     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14339     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14340     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14341                                    CP-REMAINING-TERM
 14342                                    CP-LOAN-TERM.
 14343
 14344     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14345         NEXT SENTENCE
 14346     ELSE
 14347         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14348             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14349                                           PB-I-LF-PREMIUM-AMT.
 14350
 14351     IF CP-TRUNCATED-LIFE
 14352        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14353
 14354     IF CP-TERM-IS-DAYS
 14355         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14356     ELSE
 14357         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14358
 14359     IF PB-COMPANY-ID = 'DCC'
 14360        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14361     END-IF
 14362     IF CP-SPECIAL-CALC-CD = 'H'
 14363         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14364                                    TO CP-ALTERNATE-BENEFIT
 14365         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14366     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14367     MOVE 'R'                    TO CP-RATE-FILE
 14368     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14369     IF NOT CP-ERROR-RATE-NOT-FOUND
 14370        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14371        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14372           AND (CP-BENEFIT-CD (1:1) = 'S')
 14373           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14374                                    PB-I-LF-PREMIUM-AMT
 14375        END-IF
 14376     ELSE
 14377        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14378     END-IF
 14379     .
 14380 3340-EDIT-LF-AH-TOL.
 14381
 14382***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14383***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14384***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14385***
 14386     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14387         PB-I-AH-PREMIUM-AMT
 14388          GIVING WS-CALC-WORK.
 14389
 14390     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14391        AND WS-CALC-WORK NOT = ZERO
 14392         MOVE ER-2649            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 261
* EL050.cbl
 14393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14394
 14395     SUBTRACT PB-I-LF-PREM-CALC
 14396             FROM PB-I-LF-PREMIUM-AMT
 14397                 GIVING WS-UNSIGN-WRK1.
 14398
 14399     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14400             FROM PB-I-LF-ALT-PREMIUM-AMT
 14401                 GIVING WS-UNSIGN-WRK4.
 14402
 14403     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14404                                + WS-UNSIGN-WRK4.
 14405
 14406     SUBTRACT PB-I-AH-PREM-CALC
 14407             FROM PB-I-AH-PREMIUM-AMT
 14408                 GIVING WS-UNSIGN-WRK2.
 14409
 14410******************************************************************
 14411*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14412******************************************************************
 14413
 14414     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14415         MOVE ZERO TO WS-UNSIGN-WRK1.
 14416
 14417     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14418         MOVE ZERO TO WS-UNSIGN-WRK2.
 14419
 14420     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14421             GIVING WS-UNSIGN-WRK3.
 14422
 14423 3342-CONTINUE.
 14424
 14425     IF (PB-I-LF-RATE = ZERO  AND
 14426         PB-I-AH-RATE = ZERO)
 14427         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14428            WS-AH-SPECIAL-CALC-CD = 'O'
 14429              NEXT SENTENCE
 14430         ELSE
 14431             GO TO 3345-EDIT-CONTINUE.
 14432
 14433     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14434         NEXT SENTENCE
 14435     ELSE
 14436     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14437        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14438           IF (PB-REISSUED-CERT         OR
 14439               PB-POLICY-IS-DECLINED    OR
 14440               PB-POLICY-IS-VOIDED)
 14441              NEXT SENTENCE
 14442           ELSE
 14443              IF WS-PREM-REJECT-SW = SPACE
 14444                 MOVE ER-2652    TO WS-ERROR
 14445                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14446                 GO TO 3344-CHECK-AH
 14447              ELSE
 14448                 MOVE ER-2650    TO WS-ERROR
 14449                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14450                 GO TO 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 262
* EL050.cbl
 14451
 14452***
 14453***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14454***
 14455
 14456     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14457         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14458            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14459             (1 + WS-TOL-LF-PREM-PCT)
 14460         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14461            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14462             (1 - WS-TOL-LF-PREM-PCT)
 14463     ELSE
 14464         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14465         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14466
 14467***
 14468***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14469***
 14470
 14471     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14472         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14473          WS-TOL-LF-PREM.
 14474
 14475     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14476         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14477          WS-TOL-LF-PREM.
 14478
 14479     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14480        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14481
 14482     IF (PB-REISSUED-CERT        OR
 14483         PB-POLICY-IS-DECLINED   OR
 14484         PB-POLICY-IS-VOIDED)
 14485        NEXT SENTENCE
 14486     ELSE
 14487     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14488           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14489       OR
 14490        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14491           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14492       AND
 14493        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14494           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14495         OR
 14496          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14497           LESS WS-TOL-LF-LOW-PREM-PCT))
 14498              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14499                  MOVE ER-2652   TO  WS-ERROR
 14500                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14501              ELSE
 14502                  MOVE ER-2650   TO  WS-ERROR
 14503                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14504
 14505*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14506*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14507*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14508*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 263
* EL050.cbl
 14509
 14510     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14511        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14512                      OR
 14513           ((PB-COMPANY-ID = 'DCC')
 14514           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14515           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14516           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14517        END-IF
 14518     END-IF
 14519
 14520     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14521        IF WS-COMP-MAX-CAP GREATER THAN +0
 14522           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14523              IF (PB-REISSUED-CERT         OR
 14524                  PB-POLICY-IS-DECLINED    OR
 14525                  PB-POLICY-IS-VOIDED)
 14526                 NEXT SENTENCE
 14527              ELSE
 14528                  MOVE ER-2646   TO  WS-ERROR
 14529                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14530
 14531 3344-CVL-TOLERANCE-CHECK.
 14532
 14533      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14534          GO TO 3344-CHECK-AH.
 14535
 14536      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14537          GO TO 3344-CHECK-AH.
 14538
 14539      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14540                                     WS-UNSIGN-WRK6.
 14541
 14542      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14543          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14544                                 + PB-I-LF-PREMIUM-AMT
 14545                                 - PB-I-LF-PREM-CALC.
 14546
 14547      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14548          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14549                                 + PB-I-LF-ALT-PREMIUM-AMT
 14550                                 - PB-I-LF-ALT-PREM-CALC.
 14551
 14552      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14553          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14554              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14555                 MOVE ER-2652    TO  WS-ERROR
 14556                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14557              ELSE
 14558                 MOVE ER-2650    TO  WS-ERROR
 14559                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14560
 14561      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14562          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14563              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14564                 MOVE ER-2652    TO  WS-ERROR
 14565                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14566              ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 264
* EL050.cbl
 14567                 MOVE ER-2650    TO  WS-ERROR
 14568                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14569
 14570 3344-CHECK-AH.
 14571
 14572****************************************************************
 14573***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14574***
 14575
 14576     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14577         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14578             (1 + WS-TOL-AH-PREM-PCT)
 14579         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14580             (1 - WS-TOL-AH-PREM-PCT)
 14581     ELSE
 14582         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14583         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14584
 14585***
 14586***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14587***
 14588
 14589     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14590         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14591
 14592     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14593         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14594
 14595     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14596        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14597
 14598     IF (PB-REISSUED-CERT)
 14599        OR (PB-POLICY-IS-DECLINED)
 14600        OR (PB-POLICY-IS-VOIDED)
 14601        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14602        CONTINUE
 14603     ELSE
 14604        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14605            OR
 14606           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14607           AND
 14608           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14609           OR
 14610           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14611           IF WS-PREM-REJECT-SW = SPACE
 14612              MOVE ER-3052       TO WS-ERROR
 14613              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14614           ELSE
 14615              MOVE ER-3050       TO WS-ERROR
 14616              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14617           END-IF
 14618        END-IF
 14619     END-IF
 14620
 14621     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14622         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14623             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14624             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 265
* EL050.cbl
 14625
 14626     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14627        IF WS-COMP-MAX-CAP GREATER THAN +0
 14628           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14629              IF (PB-REISSUED-CERT         OR
 14630                  PB-POLICY-IS-DECLINED    OR
 14631                  PB-POLICY-IS-VOIDED)
 14632                 NEXT SENTENCE
 14633              ELSE
 14634                  MOVE ER-2646   TO  WS-ERROR
 14635                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14636
 14637     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14638        (WS-COMP-MAX-CAP EQUAL +0)
 14639           GO TO 3345-EDIT-CONTINUE.
 14640
 14641     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14642        GREATER THAN WS-COMP-MAX-CAP
 14643           MOVE ER-2646          TO  WS-ERROR
 14644           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14645
 14646 3345-EDIT-CONTINUE.
 14647
 14648*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14649*       IF PB-ENTRY-BATCH   NUMERIC
 14650*          IF PB-ISSUE
 14651*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14652*          ELSE
 14653*              IF PB-CANCELLATION
 14654*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14655
 14656*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14657*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14658*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14659*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14660*        ELSE
 14661*            MOVE  ER-1909            TO  WS-ERROR
 14662*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14663
 14664     IF PB-I-POLICY-ACCEPTED
 14665        IF PB-POLICY-IS-DECLINED  OR
 14666           PB-REISSUED-CERT  OR
 14667           PB-REIN-ONLY-CERT  OR
 14668           PB-POLICY-IS-VOIDED
 14669            MOVE  ER-1891         TO  WS-ERROR
 14670            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14671        ELSE
 14672            MOVE SPACE            TO  PB-BATCH-ENTRY
 14673            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14674
 14675     IF PB-I-POLICY-DECLINED
 14676        IF PB-REISSUED-CERT  OR
 14677           PB-REIN-ONLY-CERT  OR
 14678           PB-POLICY-IS-VOIDED
 14679            MOVE  ER-1906         TO  WS-ERROR
 14680            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14681        ELSE
 14682            MOVE  'D'             TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 266
* EL050.cbl
 14683                                      PB-I-ENTRY-STATUS.
 14684
 14685     IF PB-I-NEEDS-UNDERWRITING
 14686        IF PB-POLICY-IS-DECLINED OR
 14687           PB-REISSUED-CERT  OR
 14688           PB-REIN-ONLY-CERT  OR
 14689           PB-POLICY-IS-VOIDED
 14690            MOVE  ER-1907         TO  WS-ERROR
 14691            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14692        ELSE
 14693            MOVE 'U'              TO  PB-BATCH-ENTRY
 14694                                      PB-I-ENTRY-STATUS.
 14695
 14696     IF PB-NEEDS-UNDERWRITING
 14697        MOVE  ER-1901             TO  WS-ERROR
 14698        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14699     IF PB-COMPANY-ID = 'DCC'
 14700        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14701        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14702        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14703           AND (NOT WS-LF-CASH))
 14704                           OR
 14705           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14706           AND (NOT WS-AH-CASH)))
 14707                       AND
 14708           (PB-I-ENTRY-STATUS NOT = '5')
 14709           MOVE 'M'              TO PB-BATCH-ENTRY
 14710                                    PB-I-ENTRY-STATUS
 14711        END-IF
 14712     END-IF
 14713     IF  PB-COMPANY-ID NOT = 'NCL'
 14714         GO TO 3999-END-EDIT.
 14715
 14716     IF PB-REISSUED-CERT  OR
 14717        PB-POLICY-IS-DECLINED  OR
 14718        PB-POLICY-IS-VOIDED  OR
 14719        PB-I-OB
 14720         GO TO 3999-END-EDIT.
 14721
 14722     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14723         MOVE  ER-2644            TO  WS-ERROR
 14724         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14725         GO TO 3999-END-EDIT.
 14726
 14727     MOVE 'N'                     TO  FORM-MASTER-SW.
 14728     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14729
 14730     IF NOT FORM-MASTER-FOUND
 14731         GO TO 3999-END-EDIT.
 14732
 14733     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14734                                      FORM-MASTER-AH-SW.
 14735
 14736     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14737         MOVE  +1                 TO SUB6
 14738         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14739
 14740     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 267
* EL050.cbl
 14741         MOVE  +1                 TO SUB6
 14742         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14743
 14744     IF LF-FORM-MASTER-FOUND  OR
 14745        AH-FORM-MASTER-FOUND
 14746         GO TO 3360-CHECK-FORM-LIMITS
 14747     ELSE
 14748         GO TO 3999-END-EDIT.
 14749
 14750******************************************************************
 14751*                  3350-GET-ERFORM                               *
 14752*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14753*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14754******************************************************************
 14755
 14756 3350-GET-ERFORM.
 14757
 14758     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14759         GO TO  3350-ERFORM-GETMAIN.
 14760
 14761     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14762     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14763     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14764     MOVE 'Y'                     TO FORM-MASTER-SW.
 14765
 14766     IF PB-CANCELLATION
 14767         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14768            PB-SV-STATE          EQUAL   FO-STATE       AND
 14769            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14770              GO TO 3350-EXIT
 14771         ELSE
 14772             NEXT SENTENCE
 14773     ELSE
 14774         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14775            PB-SV-STATE          EQUAL   FO-STATE       AND
 14776            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14777              GO TO 3350-EXIT.
 14778
 14779 3350-ERFORM-GETMAIN.
 14780
 14781     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14782     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14783
 14784 3350-ERFORM-READ.
 14785
 14786     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14787     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14788     IF PB-CANCELLATION
 14789         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14790     ELSE
 14791         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14792     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14793
 14794     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14795
 14796     IF FORM-MASTER-FOUND
 14797       IF PB-CANCELLATION
 14798          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 268
* EL050.cbl
 14799             PB-SV-STATE          EQUAL   FO-STATE       AND
 14800             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14801              GO  TO 3350-EXIT
 14802          ELSE
 14803              NEXT SENTENCE
 14804       ELSE
 14805          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14806             PB-SV-STATE          EQUAL   FO-STATE       AND
 14807             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14808              GO  TO 3350-EXIT.
 14809
 14810     MOVE  'N'                    TO  FORM-MASTER-SW.
 14811     MOVE  ER-1895                TO  WS-ERROR.
 14812     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14813
 14814 3350-EXIT.
 14815      EXIT.
 14816
 14817******************************************************************
 14818*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14819*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14820*   VALID FOR THE POLICY FORM USED.                              *
 14821******************************************************************
 14822
 14823 3355-EDIT-FORM-LF-BENEFITS.
 14824
 14825     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14826        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14827         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14828         GO TO   3355-EXIT.
 14829
 14830     IF  SUB6    LESS THAN   +40
 14831         ADD  +1      TO  SUB6
 14832         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14833
 14834     MOVE  ER-1896         TO  WS-ERROR.
 14835     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14836
 14837 3355-EXIT.
 14838      EXIT.
 14839
 14840******************************************************************
 14841*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14842*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14843*   VALID FOR THE POLICY FORM USED.                              *
 14844******************************************************************
 14845
 14846 3356-EDIT-FORM-AH-BENEFITS.
 14847
 14848     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14849        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14850         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14851         GO TO  3356-EXIT.
 14852
 14853      IF  SUB6    LESS THAN     +40
 14854          ADD  +1      TO  SUB6
 14855          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14856
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 269
* EL050.cbl
 14857     MOVE  ER-1897         TO  WS-ERROR.
 14858     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14859
 14860 3356-EXIT.
 14861      EXIT.
 14862
 14863******************************************************************
 14864*                  3357-BENEFIT-SEARCH                           *
 14865*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14866*   CANCELLATIONS ONLY.                                          *
 14867******************************************************************
 14868 3357-BENEFIT-SEARCH.
 14869     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14870         MOVE +1                          TO SUB6
 14871         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14872
 14873     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14874         MOVE +1                          TO SUB6
 14875         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14876
 14877 3357-EXIT.
 14878     EXIT.
 14879
 14880******************************************************************
 14881*                  3358-BENEFIT-LIFE-SEARCH                      *
 14882*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14883*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14884*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14885******************************************************************
 14886 3358-BENEFIT-LIFE-SEARCH.
 14887     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14888       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14889         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14890           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14891              IF FO-PLAN-REFUND-METHOD (SUB6)
 14892                     IS GREATER THAN SPACES
 14893                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14894                                          WS-LF-REFUND-CALC
 14895                 GO TO 3358-EXIT.
 14896
 14897     IF SUB6 LESS THAN +40
 14898         ADD +1                 TO SUB6
 14899         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14900
 14901 3358-EXIT.
 14902     EXIT.
 14903******************************************************************
 14904*                  3359-BENEFIT-AH-SEARCH                        *
 14905*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14906*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14907*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14908******************************************************************
 14909 3359-BENEFIT-AH-SEARCH.
 14910     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14911       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14912         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14913           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14914              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 270
* EL050.cbl
 14915                      IS GREATER THAN SPACES
 14916                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14917                                          WS-AH-REFUND-CALC
 14918                 GO TO 3359-EXIT.
 14919
 14920     IF SUB6 LESS THAN +40
 14921         ADD +1                 TO SUB6
 14922         GO TO 3359-BENEFIT-AH-SEARCH.
 14923
 14924 3359-EXIT.
 14925     EXIT.
 14926
 14927******************************************************************
 14928*                  3360-CHECK-FORM-LIMITS                        *
 14929*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14930*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14931******************************************************************
 14932
 14933 3360-CHECK-FORM-LIMITS.
 14934
 14935     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14936         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14937
 14938     IF NOT LF-FORM-MASTER-FOUND
 14939         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14940
 14941 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14942
 14943     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14944       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14945        WS-LF-JOINT-INDICATOR = 'J'  AND
 14946        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14947         IF PB-COMPANY-ID = 'NCL'
 14948            MOVE  ER-1911          TO  WS-ERROR
 14949            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14950         ELSE
 14951            MOVE  ER-1892          TO  WS-ERROR
 14952            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14953
 14954 3360-CHECK-FORM-LF-ATT-AGE.
 14955
 14956     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14957
 14958     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14959         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14960         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14961            IF PB-COMPANY-ID = 'NCL'
 14962                MOVE  ER-1913      TO  WS-ERROR
 14963                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14964            ELSE
 14965                MOVE  ER-1894      TO  WS-ERROR
 14966                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14967
 14968 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14969
 14970     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14971         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14972         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 271
* EL050.cbl
 14973            IF PB-COMPANY-ID = 'NCL'
 14974                MOVE  ER-1914      TO  WS-ERROR
 14975                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14976            ELSE
 14977                MOVE  ER-1899      TO  WS-ERROR
 14978                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14979
 14980 3360-CHECK-FORM-LF-TERM-BAMT.
 14981
 14982     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14983         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14984         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14985           IF  PB-COMPANY-ID = 'NCL'
 14986               MOVE  ER-1916       TO  WS-ERROR
 14987               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14988           ELSE
 14989               MOVE  ER-1902       TO  WS-ERROR
 14990               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14991
 14992     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14993                                    PB-I-LF-ALT-BENEFIT-AMT.
 14994
 14995     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14996         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14997         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14998             IF  PB-COMPANY-ID = 'NCL'
 14999                 MOVE  ER-1918     TO  WS-ERROR
 15000                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15001             ELSE
 15002                 MOVE  ER-1904     TO  WS-ERROR
 15003                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15004
 15005******************************************************************
 15006*                  3360-CHECK-FORM-AH-LIMITS                     *
 15007*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15008*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15009******************************************************************
 15010
 15011 3360-CHECK-FORM-AH-LIMITS.
 15012
 15013     IF NOT AH-FORM-MASTER-FOUND
 15014         GO TO 3999-END-EDIT.
 15015
 15016 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15017
 15018     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15019       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15020        WS-AH-JOINT-INDICATOR = 'J'  AND
 15021        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15022         IF PB-COMPANY-ID = 'NCL'
 15023            MOVE  ER-1912          TO  WS-ERROR
 15024            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15025         ELSE
 15026            MOVE  ER-1893          TO  WS-ERROR
 15027            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15028
 15029 3360-CHECK-FORM-AH-ATT-AGE.
 15030
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 272
* EL050.cbl
 15031     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15032
 15033     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15034         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15035         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15036            IF PB-COMPANY-ID = 'NCL'
 15037                MOVE  ER-1913      TO  WS-ERROR
 15038                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15039            ELSE
 15040                MOVE  ER-1894      TO  WS-ERROR
 15041                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15042
 15043 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15044
 15045     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15046         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15047         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15048            IF PB-COMPANY-ID = 'NCL'
 15049                MOVE  ER-1915      TO  WS-ERROR
 15050                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15051            ELSE
 15052                MOVE  ER-1900      TO  WS-ERROR
 15053                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15054
 15055 3360-CHECK-FORM-AH-TERM-BAMT.
 15056
 15057     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15058         FO-AH-MAX-TERM    GREATER THAN  +0
 15059         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15060             IF  PB-COMPANY-ID = 'NCL'
 15061                 MOVE  ER-1917     TO  WS-ERROR
 15062                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15063             ELSE
 15064                  MOVE  ER-1903    TO  WS-ERROR
 15065                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15066
 15067     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15068         FO-MAX-AH-AMT    GREATER THAN  +0
 15069         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15070             IF  PB-COMPANY-ID = 'NCL'
 15071                 MOVE  ER-1919     TO  WS-ERROR
 15072                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15073             ELSE
 15074                 MOVE  ER-1905     TO  WS-ERROR
 15075                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15076
 15077     GO TO 3999-END-EDIT.
 15078
 15079******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 273
* EL050.cbl
 15081******************************************************************
 15082*                  E D I T   C A N C E L                         *
 15083******************************************************************
 15084
 15085 3700-EDIT-CANCEL.
 15086     IF PB-COMPANY-ID = 'DMD'
 15087         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15088                                         WS-RES-MUNI-TAX
 15089                                         PB-CI-STATE-TAX
 15090                                         PB-CI-MUNI-TAX
 15091         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15092
 15093*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15094*       IF PB-ENTRY-BATCH  NUMERIC
 15095*          IF PB-CANCELLATION
 15096*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15097*          ELSE
 15098*             IF PB-ISSUE
 15099*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15100
 15101     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15102        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15103     END-IF
 15104*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15105*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15106
 15107     IF CM-ENTRY-STATUS = 'V'
 15108        MOVE ER-2780             TO WS-ERROR
 15109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15110        GO TO 3999-END-EDIT.
 15111
 15112     IF CM-ENTRY-STATUS = 'D'
 15113        MOVE ER-2781             TO WS-ERROR
 15114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15115        GO TO 3999-END-EDIT.
 15116
 15117     IF CM-ENTRY-STATUS = 'U'
 15118        MOVE ER-2782             TO WS-ERROR
 15119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15120
 15121***************************************************************
 15122*                                                             *
 15123*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15124*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15125*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15126*   OF ANOTHER COVERAGE.                                      *
 15127*                                                             *
 15128***************************************************************
 15129
 15130     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15131                                    PB-C-AH-CANCEL-VOID-SW.
 15132
 15133     IF PB-C-LF-CANCEL-AMT = ZERO
 15134        NEXT SENTENCE
 15135     ELSE
 15136        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15137           AND
 15138           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 274
* EL050.cbl
 15139               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15140               MOVE ER-2745           TO WS-ERROR
 15141               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15142
 15143     IF PB-C-AH-CANCEL-AMT = ZERO
 15144        NEXT SENTENCE
 15145     ELSE
 15146        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15147           AND
 15148           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15149               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15150               MOVE ER-2745           TO WS-ERROR
 15151               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15152
 15153     IF WS-LF-EARNINGS-CALC = '4'
 15154        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15155
 15156     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15157     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15158     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15159     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15160     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15161     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15162
 15163     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15164                                      PB-C-AH-REF-CALC.
 15165     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15166
 15167******************************************************************
 15168*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15169*             TO VALIDATE COVERAGE.                              *
 15170******************************************************************
 15171
 15172     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15173        PB-C-LF-CANCEL-AMT = ZEROS
 15174          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15175      ELSE
 15176          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15177
 15178     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15179        PB-C-AH-CANCEL-AMT = ZEROS
 15180          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15181      ELSE
 15182          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15183
 15184     EVALUATE TRUE
 15185         WHEN PB-CANCEL-FORCE             OR
 15186              PB-CANCEL-DATE-FORCED       OR
 15187              PB-FORCE-OFF
 15188                  IF PB-COMPANY-ID = 'ACE'
 15189                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15190                  END-IF
 15191         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15192               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15193              (PB-COMPANY-ID = 'ACE' )
 15194                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15195         WHEN OTHER
 15196              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 275
* EL050.cbl
 15197                 MOVE ER-2794              TO WS-ERROR
 15198              ELSE
 15199                 MOVE ER-2749              TO WS-ERROR
 15200              END-IF
 15201              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15202     END-EVALUATE.
 15203
 15204
 15205*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15206*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15207*            MOVE  ER-1909            TO  WS-ERROR
 15208*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15209*        ELSE
 15210*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15211
 15212     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15213     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15214        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15215     ELSE
 15216        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15217     END-IF
 15218     .
 15219 3705-EDIT-CANCEL-DT.
 15220
 15221     IF LF-COVERAGE-CANCELLED
 15222        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15223         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15224         MOVE WS-CURRENT-MONTH-END
 15225                                 TO DC-BIN-DATE-2
 15226         SET ELAPSED-BETWEEN-BIN TO TRUE
 15227*        MOVE 1                  TO DC-OPTION-CODE
 15228         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15229         IF DATE-CONVERSION-ERROR
 15230            NEXT SENTENCE
 15231          ELSE
 15232             IF DC-ELAPSED-DAYS GREATER +180
 15233                IF PB-CANCEL-DATE-FORCED  OR
 15234                   PB-CANCEL-DATE-FORCED-NO-FEE
 15235                      MOVE ER-2751  TO WS-ERROR
 15236                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15237                 ELSE
 15238                   MOVE ER-2752  TO WS-ERROR
 15239                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15240
 15241     IF AH-COVERAGE-CANCELLED
 15242        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15243         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15244         MOVE WS-CURRENT-MONTH-END
 15245                                 TO DC-BIN-DATE-2
 15246         SET ELAPSED-BETWEEN-BIN TO TRUE
 15247*        MOVE 1                  TO DC-OPTION-CODE
 15248         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15249         IF DATE-CONVERSION-ERROR
 15250            NEXT SENTENCE
 15251          ELSE
 15252             IF DC-ELAPSED-DAYS GREATER +180
 15253                IF PB-CANCEL-DATE-FORCED OR
 15254                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 276
* EL050.cbl
 15255                      MOVE ER-2751  TO WS-ERROR
 15256                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15257                 ELSE
 15258                   MOVE ER-2752  TO WS-ERROR
 15259                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15260
 15261     IF WS-ERROR = ER-2752
 15262        AND (PB-COMPANY-ID = 'ABL'
 15263         OR  PB-COMPANY-ID = 'FGL'
 15264         OR  PB-COMPANY-ID = 'IST'
 15265         OR  PB-COMPANY-ID = 'JHL'
 15266         OR  PB-COMPANY-ID = 'LAP'
 15267         OR  PB-COMPANY-ID = 'LBL'
 15268         OR  PB-COMPANY-ID = 'NCB'
 15269         OR  PB-COMPANY-ID = 'NLI'
 15270         OR  PB-COMPANY-ID = 'OFI'
 15271         OR  PB-COMPANY-ID = 'PLI'
 15272         OR  PB-COMPANY-ID = 'TAO'
 15273         OR  PB-COMPANY-ID = 'TIC'
 15274         OR  PB-COMPANY-ID = 'HER'
 15275         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15276         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15277            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15278            MOVE ER-2762     TO WS-ERROR
 15279            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15280
 15281     IF LF-COVERAGE-CANCELLED
 15282        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15283        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15284             MOVE ER-2733         TO WS-ERROR
 15285             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15286
 15287     IF AH-COVERAGE-CANCELLED
 15288        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15289        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15290              MOVE ER-2733        TO WS-ERROR
 15291              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15292
 15293     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15294        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15295        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15296           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15297            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15298              IF PB-COMPANY-ID NOT = 'LAP'
 15299               MOVE ER-2704            TO WS-ERROR
 15300               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15301
 15302     IF CERT-WAS-NOT-FOUND
 15303         GO TO 3999-END-EDIT.
 15304
 15305     IF PB-COMPANY-ID EQUAL 'CDC'
 15306        IF LF-COVERAGE-CANCELLED
 15307           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15308            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15309            MOVE PB-C-LF-CANCEL-DT
 15310                                 TO DC-BIN-DATE-2
 15311            SET ELAPSED-BETWEEN-BIN TO TRUE
 15312*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 277
* EL050.cbl
 15313            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15314            IF DATE-CONVERSION-ERROR
 15315               NEXT SENTENCE
 15316             ELSE
 15317                IF DC-ELAPSED-DAYS GREATER +60
 15318                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15319
 15320     IF PB-COMPANY-ID EQUAL 'CDC'
 15321        IF AH-COVERAGE-CANCELLED
 15322           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15323            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15324            MOVE PB-C-AH-CANCEL-DT
 15325                                 TO DC-BIN-DATE-2
 15326            MOVE +0              TO DC-ELAPSED-DAYS
 15327                                    DC-ELAPSED-MONTHS
 15328            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15329*           MOVE 1               TO DC-OPTION-CODE
 15330            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15331            IF DATE-CONVERSION-ERROR
 15332               NEXT SENTENCE
 15333             ELSE
 15334                IF DC-ELAPSED-DAYS GREATER +60
 15335                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15336
 15337     MOVE +0                     TO DC-ELAPSED-DAYS
 15338                                    DC-ELAPSED-MONTHS.
 15339
 15340     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15341        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15342          MOVE 'Z'                TO PB-CI-OB-FLAG
 15343          MOVE ER-2767            TO WS-ERROR
 15344          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15345          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15346          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15347          GO TO 3775-OVER-REF-CHK
 15348        ELSE
 15349          MOVE ZEROS              TO PB-CI-LIVES
 15350                                     PB-C-LIVES
 15351          IF PB-CI-OB-FLAG NOT = 'B'
 15352             MOVE SPACE           TO PB-CI-OB-FLAG.
 15353
 15354     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15355         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15356     ELSE
 15357         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15358
 15359     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15360        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15361            MOVE ER-2760         TO WS-ERROR
 15362            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15363
 15364     IF LF-COVERAGE-CANCELLED
 15365        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15366         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15367            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15368               MOVE ER-2774       TO WS-ERROR
 15369               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15370
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 278
* EL050.cbl
 15371     IF AH-COVERAGE-CANCELLED
 15372        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15373         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15374            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15375               MOVE ER-2775       TO WS-ERROR
 15376               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15377
 15378     IF LF-COVERAGE-CANCELLED
 15379        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15380         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15381            MOVE ER-2776         TO WS-ERROR
 15382            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15383
 15384     IF AH-COVERAGE-CANCELLED
 15385        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15386         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15387            MOVE ER-2777         TO WS-ERROR
 15388            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15389
 15390     IF LF-COVERAGE-CANCELLED
 15391        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15392         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15393         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15394         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15395*        MOVE 6                    TO DC-OPTION-CODE
 15396         SET BIN-PLUS-ELAPSED      TO TRUE
 15397         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15398         IF DATE-CONVERSION-ERROR
 15399            NEXT SENTENCE
 15400          ELSE
 15401            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15402              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15403                             OR  'FIA'
 15404                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15405               ELSE
 15406                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15407                MOVE ER-2731       TO WS-ERROR
 15408                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15409
 15410 3705-EDIT-AH-CANCEL-DT.
 15411
 15412     IF AH-COVERAGE-CANCELLED
 15413        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15414         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15415         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15416         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15417*        MOVE 6                    TO DC-OPTION-CODE
 15418         SET BIN-PLUS-ELAPSED      TO TRUE
 15419         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15420         IF DATE-CONVERSION-ERROR
 15421            NEXT SENTENCE
 15422          ELSE
 15423            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15424              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15425                              OR 'FIA'
 15426                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15427              ELSE
 15428               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 279
* EL050.cbl
 15429               MOVE ER-2771       TO WS-ERROR
 15430               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15431
 15432 3705-EDIT-CONTINUED.
 15433
 15434*    IF LF-COVERAGE-CANCELLED
 15435*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15436*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15437*            MOVE ER-2727         TO WS-ERROR
 15438*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15439*
 15440*    IF AH-COVERAGE-CANCELLED
 15441*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15442*        IF PB-COMPANY-ID = 'ACE'
 15443*           MOVE ER-2727        TO WS-ERROR
 15444*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15445*        ELSE
 15446*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15447*              MOVE ER-2727     TO WS-ERROR
 15448*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15449
 15450     IF PB-COMPANY-ID = 'ACE'
 15451       IF AH-COVERAGE-CANCELLED
 15452         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15453           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15454              MOVE ER-2732      TO WS-ERROR
 15455              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15456
 15457     IF PB-COMPANY-ID      EQUAL   'HER'
 15458        IF WS-ERROR        EQUAL   ER-2727
 15459            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15460            MOVE  ER-2725          TO  WS-ERROR
 15461            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15462
 15463     IF PB-C-CLAIM-CREATED-CANCEL
 15464            MOVE ER-2748         TO WS-ERROR
 15465            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15466
 15467     IF PB-C-LAST-NAME NOT = SPACES
 15468         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15469            MOVE ER-2747         TO WS-ERROR
 15470            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15471
 15472 3710-EDIT-LUMP-SUM-PRIOR.
 15473
 15474     IF AH-COVERAGE-CANCELLED
 15475         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15476             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15477                MOVE ER-2735    TO WS-ERROR
 15478                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15479
 15480     IF LF-COVERAGE-CANCELLED
 15481         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15482             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15483                MOVE ER-2735    TO WS-ERROR
 15484                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15485
 15486 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 280
* EL050.cbl
 15487
 15488*    IF LF-COVERAGE-CANCELLED
 15489*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15490*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15491*           (NOT PB-CI-OB)
 15492*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15493*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15494*                   MOVE ER-2732  TO WS-ERROR
 15495*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15496*
 15497*    IF AH-COVERAGE-CANCELLED
 15498*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15499*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15500*           (NOT PB-CI-OB)
 15501*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15502*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15503*                   MOVE ER-2732  TO WS-ERROR
 15504*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15505
 15506     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15507         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15508            (NOT PB-COMP-LF-CANCEL)
 15509             NEXT SENTENCE
 15510         ELSE
 15511           IF PB-C-LF-CANCEL-VOIDED
 15512              NEXT SENTENCE
 15513           ELSE
 15514              MOVE ER-2753      TO WS-ERROR
 15515              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15516
 15517     IF CANCEL-FUTURE-DT
 15518         GO TO 3999-END-EDIT.
 15519
 15520 3715-GET-REMAIN-TERM-LF.
 15521
 15522     IF NO-LF-BENEFIT-MATCH  OR
 15523        WS-LF-BENEFIT-CD = ZEROS
 15524        GO TO 3730-GET-AH-REMAIN-TERM.
 15525
 15526     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15527     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15528     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15529     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15530     MOVE PB-SV-STATE            TO CP-STATE.
 15531     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15532     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15533     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15534     MOVE '2'                    TO CP-PROCESS-TYPE.
 15535     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15536     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15537     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15538     IF (PB-COMPANY-ID = 'CID')
 15539        AND (CP-STATE-STD-ABBRV = 'WI')
 15540        MOVE '7'                 TO CP-REM-TERM-METHOD
 15541        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15542     ELSE
 15543        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15544        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 281
* EL050.cbl
 15545                                 TO CP-REM-TRM-CALC-OPTION
 15546     END-IF
 15547**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15548     IF (PB-COMPANY-ID = 'CID')
 15549        AND (CP-STATE-STD-ABBRV = 'MO')
 15550        AND (PB-CERT-EFF-DT >= X'9B41')
 15551        AND (PB-CERT-EFF-DT <= X'A2FB')
 15552        MOVE '7'                 TO CP-REM-TERM-METHOD
 15553        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15554     END-IF
 15555     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15556                                    CP-LOAN-TERM.
 15557     IF CP-TRUNCATED-LIFE
 15558        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15559
 15560     IF CP-TERM-IS-DAYS
 15561         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15562     ELSE
 15563         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15564
 15565     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15566
 15567     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15568
 15569     IF LF-COVERAGE-CANCELLED
 15570        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15571        NEXT SENTENCE
 15572      ELSE
 15573          GO TO 3730-GET-AH-REMAIN-TERM.
 15574
 15575 3720-GET-LF-REFUND.
 15576
 15577     IF PB-C-LF-CANCEL-VOIDED OR
 15578        PB-C-AH-CANCEL-VOIDED
 15579        GO TO 3780-UPDATE-CANCEL-CERT.
 15580
 15581     IF PB-COMPANY-ID EQUAL 'BOA'
 15582         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15583         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15584         GO TO 3730-GET-AH-REMAIN-TERM.
 15585
 15586     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15587        (WS-AH-SPECIAL-CALC-CD = 'M')
 15588         MOVE ER-2767            TO WS-ERROR
 15589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15590         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15591         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15592         GO TO 3780-UPDATE-CANCEL-CERT.
 15593
 15594     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15595
 15596     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15597     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15598     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15599     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15600     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15601     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15602     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 282
* EL050.cbl
 15603        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15604        IF PDEF-MASTER-FOUND
 15605           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15606              (V1 > +8)
 15607              OR (PD-PROD-CODE (V1) = 'L')
 15608           END-PERFORM
 15609           IF V1 < +9
 15610              MOVE PD-MAX-AMT (V1)
 15611                           TO CP-R-MAX-TOT-BEN
 15612                              EC-AM-LF-MAX-TOT-BEN
 15613           END-IF
 15614        ELSE
 15615        MOVE ' '                 TO PDEF-MASTER-SW
 15616        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15617        MOVE PB-STATE            TO ERPDEF-STATE
 15618        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15619        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15620        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15621        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15622        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15623        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15624        IF PDEF-MASTER-FOUND
 15625           MOVE 'N'              TO PDEF-MASTER-SW
 15626           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15627           IF PDEF-MASTER-FOUND
 15628              IF (ERPDEF-KEY-SAVE (1:16) =
 15629                           PD-CONTROL-PRIMARY (1:16))
 15630                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15631                 CONTINUE
 15632              ELSE
 15633                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15634                 IF (ERPDEF-KEY-SAVE (1:16) =
 15635                           PD-CONTROL-PRIMARY (1:16))
 15636                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15637                    CONTINUE
 15638                 ELSE
 15639                    MOVE 'N'     TO PDEF-MASTER-SW
 15640                 END-IF
 15641              END-IF
 15642              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15643
 15644              IF PDEF-MASTER-FOUND
 15645                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15646                    (V1 > +8)
 15647                    OR (PD-PROD-CODE (V1) = 'L')
 15648                 END-PERFORM
 15649                 IF V1 < +9
 15650                    MOVE PD-MAX-AMT (V1)
 15651                                 TO CP-R-MAX-TOT-BEN
 15652                                    EC-AM-LF-MAX-TOT-BEN
 15653                 END-IF
 15654              END-IF
 15655           END-IF
 15656           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15657        END-IF
 15658        END-IF
 15659     END-IF
 15660     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 283
* EL050.cbl
 15661
 15662     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15663
 15664     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15665                                    PB-C-LF-REM-TERM.
 15666
 15667     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15668     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15669
 15670     IF PB-COMPANY-ID EQUAL 'FLC'
 15671        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15672           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15673           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15674                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15675                    - CM-LF-ITD-DEATH-AMT
 15676           IF PB-C-LF-REF-CALC LESS THAN +0
 15677              MOVE +0            TO PB-C-LF-REF-CALC
 15678              GO TO 3730-GET-AH-REMAIN-TERM
 15679           ELSE
 15680              GO TO 3730-GET-AH-REMAIN-TERM.
 15681
 15682     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15683                            OR '4' OR '5' OR '6' OR '8'
 15684                            OR '9' OR 'G'
 15685        MOVE PB-C-LF-REFUND-OVERRIDE
 15686                                 TO CP-EARNING-METHOD.
 15687
 15688     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15689     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15690     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15691                                    CP-RATING-BENEFIT-AMT.
 15692     IF CP-STATE-STD-ABBRV = 'OR'
 15693         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15694                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15695     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15696     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15697     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15698     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15699     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15700     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15701     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15702     IF WS-DEFAULT-APR NOT NUMERIC
 15703         MOVE ZEROS TO WS-DEFAULT-APR.
 15704****   N O T E   ****
 15705*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15706*      THE OH HARD CODING IN ELCRFNDP
 15707
 15708     IF PB-COMPANY-ID = 'CID'
 15709        IF CP-STATE-STD-ABBRV = 'OH'
 15710           MOVE WS-LF-EARNINGS-CALC
 15711                                 TO CP-EARNING-METHOD
 15712        END-IF
 15713     END-IF
 15714
 15715****   N O T E   ****
 15716
 15717     IF CP-EARN-AS-NET-PAY
 15718         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 284
* EL050.cbl
 15719            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15720                MOVE WS-DEFAULT-APR
 15721                                 TO  CP-LOAN-APR
 15722                MOVE ER-3780     TO  WS-ERROR
 15723                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15724            ELSE
 15725                MOVE ER-3781     TO  WS-ERROR
 15726                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15727     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15728     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15729
 15730     IF CP-REFUND-TYPE-USED NOT = SPACE
 15731         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15732
 15733     IF CP-ERROR-RATE-IS-ZERO OR
 15734        CP-ERROR-RATE-NOT-FOUND
 15735        MOVE ER-2740             TO WS-ERROR
 15736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15737
 15738     IF CP-ERROR-RATE-FILE-NOTOPEN
 15739        MOVE ER-2617             TO WS-ERROR
 15740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15741
 15742     IF PB-COMPANY-ID = 'DCC'
 15743        AND PB-CI-ENTRY-STATUS = 'M'
 15744        MOVE +0                  TO PB-C-LF-REF-CALC
 15745     ELSE
 15746        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15747     END-IF
 15748
 15749     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15750         GO TO 3730-GET-AH-REMAIN-TERM.
 15751
 15752*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15753*       ADD +1                   TO PB-C-LF-REM-TERM
 15754*                                   CP-REMAINING-TERM
 15755*                                   CP-ORIGINAL-TERM.
 15756
 15757     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15758     MOVE '2'                    TO CP-EARNING-METHOD
 15759                                    CP-RATING-METHOD.
 15760     IF PB-COMPANY-ID = 'CID'
 15761        IF (CP-STATE-STD-ABBRV = 'MN')
 15762           AND (PB-CERT-EFF-DT > X'A4FF')
 15763           AND (WS-LF-EARNINGS-CALC = 'B')
 15764           MOVE '5'              TO CP-EARNING-METHOD
 15765           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15766        END-IF
 15767     END-IF
 15768     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15769                                        CP-REMAINING-BENEFIT
 15770                                        CP-RATING-BENEFIT-AMT.
 15771     IF CP-STATE-STD-ABBRV = 'OR'
 15772         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15773                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15774     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15775     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15776
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 285
* EL050.cbl
 15777     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15778
 15779     IF CP-ERROR-RATE-IS-ZERO OR
 15780        CP-ERROR-RATE-NOT-FOUND
 15781        MOVE ER-2740             TO WS-ERROR
 15782        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15783
 15784     IF CP-ERROR-RATE-FILE-NOTOPEN
 15785        MOVE ER-2617             TO WS-ERROR
 15786        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15787
 15788     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15789
 15790******************************************************************
 15791
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 286
* EL050.cbl
 15793 3730-GET-AH-REMAIN-TERM.
 15794     IF NO-AH-BENEFIT-MATCH  OR
 15795        WS-AH-BENEFIT-CD = ZEROS
 15796         GO TO 3770-CHECK-REFUNDS.
 15797
 15798     IF PB-CI-AH-LUMP-SUM-DISAB
 15799         IF  PB-C-AH-CANCEL-AMT = ZERO
 15800            IF NOT PB-COMP-AH-CANCEL
 15801             GO TO 3770-CHECK-REFUNDS.
 15802
 15803     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15804     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15805     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15806     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15807     MOVE PB-SV-STATE            TO CP-STATE.
 15808     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15809     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15810     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15811     MOVE '2'                    TO CP-PROCESS-TYPE.
 15812     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15813     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15814     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15815     IF (PB-COMPANY-ID = 'CID')
 15816        AND (CP-STATE-STD-ABBRV = 'WI')
 15817        MOVE '7'                 TO CP-REM-TERM-METHOD
 15818        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15819     ELSE
 15820        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15821        MOVE WS-REM-TRM-CALC-OPTION
 15822                                 TO CP-REM-TRM-CALC-OPTION
 15823     END-IF
 15824     IF (PB-COMPANY-ID = 'CID')
 15825        AND (CP-STATE-STD-ABBRV = 'MO')
 15826        AND (PB-CERT-EFF-DT >= X'9B41')
 15827        AND (PB-CERT-EFF-DT <= X'A2FB')
 15828        MOVE '7'                 TO CP-REM-TERM-METHOD
 15829        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15830     END-IF
 15831     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15832                                    CP-LOAN-TERM.
 15833     IF NOT CP-TERM-IS-DAYS
 15834         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15835
 15836     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15837
 15838     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15839
 15840     IF AH-COVERAGE-CANCELLED
 15841        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15842        NEXT SENTENCE
 15843      ELSE
 15844         GO TO 3770-CHECK-REFUNDS.
 15845
 15846 3740-GET-AH-REFUND.
 15847
 15848     IF PB-C-LF-CANCEL-VOIDED OR
 15849        PB-C-AH-CANCEL-VOIDED
 15850        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 287
* EL050.cbl
 15851
 15852     IF PB-COMPANY-ID = 'BOA'
 15853         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15854         GO TO 3770-CHECK-REFUNDS.
 15855
 15856     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15857*    MOVE ' '                    TO DC-OPTION-CODE
 15858     SET BIN-TO-GREG             TO TRUE
 15859     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15860     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15861                                    PB-C-AH-REM-TERM.
 15862     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15863     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15864
 15865     IF PB-COMPANY-ID EQUAL 'FLC'
 15866        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15867           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15868           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15869                    - CM-AH-ITD-AH-PMT)
 15870           IF PB-C-AH-REF-CALC LESS THAN +0
 15871              MOVE +0            TO PB-C-AH-REF-CALC
 15872              GO TO 3770-CHECK-REFUNDS
 15873           ELSE
 15874              GO TO 3770-CHECK-REFUNDS.
 15875
 15876     IF PB-COMPANY-ID = 'DCC'
 15877        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15878            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15879           MOVE 'S'              TO CP-EARNING-METHOD
 15880        END-IF
 15881     END-IF
 15882     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15883                            OR '4' OR '5' OR '6' OR '8'
 15884                            OR '9' OR 'G' OR 'S'
 15885        MOVE PB-C-AH-REFUND-OVERRIDE
 15886                                 TO CP-EARNING-METHOD.
 15887
 15888     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15889     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15890     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15891                                    CP-RATING-BENEFIT-AMT.
 15892     IF CP-STATE-STD-ABBRV = 'OR'
 15893         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15894                                         PB-CI-AH-TERM.
 15895     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15896     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15897     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15898     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15899     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15900     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15901
 15902     IF CP-STATE-STD-ABBRV = 'OH'
 15903        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15904                                AND 'CID' AND 'DCC' AND 'AHL')
 15905           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15906              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15907              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15908              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 288
* EL050.cbl
 15909           END-IF
 15910        END-IF
 15911        IF PB-COMPANY-ID = 'CID'
 15912           IF NO-LIFE-COVERAGE
 15913              IF CP-CRITICAL-PERIOD
 15914                 MOVE '2'       TO CP-EARNING-METHOD
 15915              ELSE
 15916                 MOVE '6'       TO CP-EARNING-METHOD
 15917              END-IF
 15918           ELSE
 15919              IF WS-LF-COVERAGE-TYPE = 'L'
 15920                 MOVE '2'       TO CP-EARNING-METHOD
 15921              ELSE
 15922                 IF (PB-CI-LF-TERM > +60) OR
 15923                    (WS-LF-EARNINGS-CALC = '5')
 15924                    IF CP-CRITICAL-PERIOD
 15925                       MOVE '2'  TO CP-EARNING-METHOD
 15926                    ELSE
 15927                       MOVE '6'  TO CP-EARNING-METHOD
 15928                    END-IF
 15929                 ELSE
 15930                    MOVE '1'     TO CP-EARNING-METHOD
 15931                 END-IF
 15932              END-IF
 15933           END-IF
 15934        END-IF
 15935     END-IF
 15936
 15937*    IF CP-STATE-STD-ABBRV = 'VA'
 15938*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15939*          IF CP-ORIGINAL-TERM GREATER 61
 15940*             MOVE '6' TO CP-EARNING-METHOD
 15941*          ELSE
 15942*             MOVE '1' TO CP-EARNING-METHOD.
 15943
 15944     IF WS-DEFAULT-APR NOT NUMERIC
 15945         MOVE ZEROS TO WS-DEFAULT-APR.
 15946     IF CP-EARN-AS-NET-PAY
 15947         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15948            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15949                MOVE WS-DEFAULT-APR
 15950                                 TO  CP-LOAN-APR
 15951                MOVE ER-3780     TO  WS-ERROR
 15952                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15953            ELSE
 15954                MOVE ER-3781     TO  WS-ERROR
 15955                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15956     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15957     IF PB-COMPANY-ID = 'DCC'
 15958        AND CP-CANCEL-REASON = 'R'
 15959        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15960        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15961     END-IF
 15962     IF PB-COMPANY-ID = 'DCC'
 15963        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15964        AND (CP-EARNING-METHOD = 'D')
 15965        AND (CP-CANCEL-REASON NOT = 'R')
 15966        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 289
* EL050.cbl
 15967     ELSE
 15968        GO TO 3750-CONTINUE
 15969     END-IF
 15970     MOVE ' '                    TO DD-IU-SW
 15971     IF NOT PDEF-MASTER-FOUND
 15972        MOVE ' '                 TO PDEF-MASTER-SW
 15973        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15974        MOVE PB-STATE            TO ERPDEF-STATE
 15975        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15976        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15977        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15978        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15979        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15980        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15981        IF PDEF-MASTER-FOUND
 15982           MOVE 'N'              TO PDEF-MASTER-SW
 15983           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15984           IF PDEF-MASTER-FOUND
 15985              IF (ERPDEF-KEY-SAVE (1:16) =
 15986                           PD-CONTROL-PRIMARY (1:16))
 15987                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15988                 CONTINUE
 15989              ELSE
 15990                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15991                 IF (ERPDEF-KEY-SAVE (1:16) =
 15992                           PD-CONTROL-PRIMARY (1:16))
 15993                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15994                    CONTINUE
 15995                 ELSE
 15996                    MOVE ER-2740 TO WS-ERROR
 15997                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15998                    GO TO 3770-CHECK-REFUNDS
 15999                 END-IF
 16000              END-IF
 16001           END-IF
 16002           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16003        END-IF
 16004     END-IF
 16005     IF PDEF-MASTER-FOUND
 16006        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16007           (V1 > +8)
 16008           OR (PD-PROD-CODE (V1) = 'I')
 16009        END-PERFORM
 16010        IF V1 < +9
 16011           SET DD-IU-PRESENT        TO TRUE
 16012        END-IF
 16013        IF WS-AH-DCC-TRUNC = 'T'
 16014           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16015        ELSE
 16016           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16017        END-IF
 16018        EVALUATE TRUE
 16019           WHEN WS-TERM > +168
 16020              MOVE 15               TO V1
 16021           WHEN WS-TERM > +156
 16022              MOVE 14               TO V1
 16023           WHEN WS-TERM > +144
 16024              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 290
* EL050.cbl
 16025           WHEN WS-TERM > +132
 16026              MOVE 12               TO V1
 16027           WHEN WS-TERM > +120
 16028              MOVE 11               TO V1
 16029           WHEN WS-TERM > +108
 16030              MOVE 10               TO V1
 16031           WHEN WS-TERM > +96
 16032              MOVE 9                TO V1
 16033           WHEN WS-TERM > +84
 16034              MOVE 8                TO V1
 16035           WHEN WS-TERM > +72
 16036              MOVE 7                TO V1
 16037           WHEN WS-TERM > +60
 16038              MOVE 6                TO V1
 16039           WHEN WS-TERM > +48
 16040              MOVE 5                TO V1
 16041           WHEN WS-TERM > +36
 16042              MOVE 4                TO V1
 16043           WHEN WS-TERM > +24
 16044              MOVE 3                TO V1
 16045           WHEN WS-TERM > +12
 16046              MOVE 2                TO V1
 16047           WHEN OTHER
 16048              MOVE 1                TO V1
 16049        END-EVALUATE
 16050
 16051        EVALUATE TRUE
 16052*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16053*             < +13)
 16054*             AND (DD-IU-PRESENT)
 16055*             MOVE 2                TO V2
 16056*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16057*             MOVE 1                TO V2
 16058           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16059              MOVE 2                TO V2
 16060           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16061              MOVE 3                TO V2
 16062           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16063              MOVE 4                TO V2
 16064           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16065              MOVE 5                TO V2
 16066           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16067              MOVE 6                TO V2
 16068           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16069              MOVE 7                TO V2
 16070           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16071              MOVE 8                TO V2
 16072           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16073              MOVE 9                TO V2
 16074           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16075              MOVE 10               TO V2
 16076           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16077              MOVE 11               TO V2
 16078           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16079              MOVE 12               TO V2
 16080           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16081              MOVE 13               TO V2
 16082           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 291
* EL050.cbl
 16083              MOVE 14               TO V2
 16084           WHEN OTHER
 16085              MOVE 15               TO V2
 16086        END-EVALUATE
 16087
 16088        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16089                                 TO CP-DDF-LO-FACT
 16090        MOVE PD-UEP-FACTOR (V1 V2)
 16091                                 TO CP-DDF-HI-FACT
 16092
 16093        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16094        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16095        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16096           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16097        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16098        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16099        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16100           + PD-1ST-YR-ADMIN-ALLOW
 16101
 16102        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16103*       IF PI-CLP-YN = 'Y'
 16104*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16105*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16106*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16107*       END-IF
 16108
 16109        IF DD-IU-PRESENT
 16110           MOVE 'I'              TO CP-EARNING-METHOD
 16111        END-IF
 16112        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16113                                     CP-CLP-RATE-UP
 16114        IF CP-IU-RATE-UP NOT = ZEROS
 16115           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16116              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16117           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16118              / (1 - WS-WORK-FACT)
 16119        END-IF
 16120     END-IF
 16121     .
 16122 3750-CONTINUE.
 16123     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16124
 16125     IF CP-REFUND-TYPE-USED NOT = SPACE
 16126         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16127
 16128     IF CP-ERROR-RATE-IS-ZERO OR
 16129        CP-ERROR-RATE-NOT-FOUND
 16130        MOVE ER-2740             TO WS-ERROR
 16131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16132
 16133     IF CP-ERROR-RATE-FILE-NOTOPEN
 16134        MOVE ER-2617             TO WS-ERROR
 16135        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16136     IF PB-COMPANY-ID = 'DCC'
 16137        AND PB-CI-ENTRY-STATUS = 'M'
 16138        MOVE +0                  TO PB-C-AH-REF-CALC
 16139     ELSE
 16140        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 292
* EL050.cbl
 16141     END-IF
 16142     IF PB-COMPANY-ID = 'DCC'
 16143        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16144        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16145        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16146        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16147        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16148        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16149        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16150        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16151        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16152     END-IF
 16153     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 293
* EL050.cbl
 16155
 16156 3770-CHECK-REFUNDS.
 16157
 16158     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16159        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16160           MOVE ER-2766          TO WS-ERROR
 16161           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16162           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16163           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16164              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16165
 16166     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16167        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16168           MOVE ER-2766          TO WS-ERROR
 16169           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16170           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16171           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16172              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16173
 16174     IF PB-COMP-LF-CANCEL
 16175        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16176        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16177           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16178              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16179
 16180     IF PB-COMP-AH-CANCEL
 16181        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16182        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16183           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16184              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16185
 16186     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16187             GIVING WS-UNSIGN-WRK1
 16188     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16189             GIVING WS-UNSIGN-WRK2.
 16190
 16191     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16192         MOVE ZERO TO WS-UNSIGN-WRK1.
 16193
 16194     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16195         MOVE ZERO TO WS-UNSIGN-WRK2.
 16196
 16197     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16198
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 294
* EL050.cbl
 16200
 16201 3772-CONTINUE.
 16202
 16203**********************************
 16204*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16205*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16206*** DOUBLES THE TOLERANCE AMOUNT.
 16207***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16208**********************************
 16209     IF PB-COMPANY-ID = 'MON'
 16210     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16211         IF WS-REF-REJECT-SW = SPACE
 16212             MOVE ER-2754        TO WS-ERROR
 16213             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16214           ELSE
 16215             MOVE ER-2736        TO WS-ERROR
 16216             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16217**********************************
 16218
 16219 3773-CONTINUE.
 16220
 16221     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16222        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16223           MOVE ER-2723          TO WS-ERROR
 16224           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16225
 16226     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16227        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16228           MOVE ER-2724          TO WS-ERROR
 16229           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16230
 16231     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16232         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16233             (1 + WS-LF-REFUND-OVS-PCT)
 16234     ELSE
 16235         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16236
 16237     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16238         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16239             (1 - WS-TOL-LF-REFUND-PCT)
 16240     ELSE
 16241         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16242
 16243     IF (PB-COMPANY-ID = 'DCC')
 16244        AND (PB-CI-ENTRY-STATUS = 'M')
 16245        AND (PB-C-LF-CANCEL-AMT > +0)
 16246        MOVE ER-3843             TO WS-ERROR
 16247        PERFORM 9900-ERROR-FORMAT
 16248                                 THRU 9900-EXIT
 16249     END-IF
 16250     EVALUATE TRUE
 16251        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16252           CONTINUE
 16253        WHEN PB-C-LF-CANCEL-AMT = +0
 16254                 AND PB-C-LF-REF-CALC > +0
 16255           CONTINUE
 16256        WHEN WS-LF-REFUND-OVS-AMT = 0
 16257                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 295
* EL050.cbl
 16258           CONTINUE
 16259        WHEN OTHER
 16260           IF WS-TOL-LF-REFUND  = +0
 16261              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16262           END-IF
 16263           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16264                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16265                          (PB-C-LF-CANCEL-AMT))
 16266              CONTINUE
 16267           ELSE
 16268              IF WS-LF-REFUND-OVS-AMT = +0
 16269                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16270              END-IF
 16271              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16272                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16273                                       PB-C-LF-CANCEL-AMT)
 16274                 CONTINUE
 16275              ELSE
 16276                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16277                   MOVE ER-2754   TO  WS-ERROR
 16278                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16279                 ELSE
 16280                    MOVE ER-2736   TO  WS-ERROR
 16281                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16282                 END-IF
 16283              END-IF
 16284           END-IF
 16285     END-EVALUATE.
 16286
 16287     EVALUATE TRUE
 16288        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16289           CONTINUE
 16290        WHEN PB-C-LF-CANCEL-AMT = +0
 16291                 AND PB-C-LF-REF-CALC > +0
 16292           CONTINUE
 16293        WHEN OTHER
 16294           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16295               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16296              CONTINUE
 16297           ELSE
 16298              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16299               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16300                CONTINUE
 16301              ELSE
 16302                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16303                     MOVE ER-2754   TO  WS-ERROR
 16304                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16305                 ELSE
 16306                     MOVE ER-2736   TO  WS-ERROR
 16307                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16308                 END-IF
 16309              END-IF
 16310           END-IF
 16311     END-EVALUATE.
 16312
 16313     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16314         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16315             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 296
* EL050.cbl
 16316     ELSE
 16317         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16318
 16319     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16320         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16321             (1 - WS-TOL-AH-REFUND-PCT)
 16322     ELSE
 16323         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16324
 16325     IF (PB-COMPANY-ID = 'DCC')
 16326        AND (PB-CI-ENTRY-STATUS = 'M')
 16327        AND (PB-C-AH-CANCEL-AMT > +0)
 16328        MOVE ER-3843             TO WS-ERROR
 16329        PERFORM 9900-ERROR-FORMAT
 16330                                 THRU 9900-EXIT
 16331     END-IF
 16332     EVALUATE TRUE
 16333        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16334           CONTINUE
 16335*       WHEN PB-C-AH-REF-CALC = +0 AND
 16336*                  PB-C-AH-CANCEL-AMT > +0
 16337        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16338                   PB-C-AH-REF-CALC > +0
 16339           CONTINUE
 16340        WHEN WS-AH-REFUND-OVS-AMT = +0
 16341                AND WS-TOL-AH-REFUND = +0
 16342           CONTINUE
 16343        WHEN OTHER
 16344           IF WS-TOL-AH-REFUND = +0
 16345              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16346           END-IF
 16347           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16348               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16349                                         PB-C-AH-CANCEL-AMT)
 16350              CONTINUE
 16351           ELSE
 16352              IF WS-AH-REFUND-OVS-AMT = +0
 16353                 MOVE +9999999.99 TO
 16354                         WS-AH-REFUND-OVS-AMT
 16355              END-IF
 16356              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16357                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16358                                         PB-C-AH-CANCEL-AMT)
 16359                 CONTINUE
 16360              ELSE
 16361                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16362                    MOVE ER-2754   TO  WS-ERROR
 16363                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16364                 ELSE
 16365                    MOVE ER-2736   TO  WS-ERROR
 16366                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16367                 END-IF
 16368              END-IF
 16369           END-IF
 16370     END-EVALUATE.
 16371
 16372     EVALUATE TRUE
 16373        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 297
* EL050.cbl
 16374           CONTINUE
 16375*       WHEN PB-C-AH-REF-CALC > +0 AND
 16376*                  PB-C-AH-CANCEL-AMT = +0
 16377        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16378                   PB-C-AH-REF-CALC = +0
 16379           CONTINUE
 16380        WHEN OTHER
 16381           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16382               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16383              CONTINUE
 16384           ELSE
 16385              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16386                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16387                 CONTINUE
 16388              ELSE
 16389                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16390                     MOVE ER-2754   TO  WS-ERROR
 16391                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16392                 ELSE
 16393                     MOVE ER-2736   TO  WS-ERROR
 16394                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16395                 END-IF
 16396              END-IF
 16397           END-IF
 16398     END-EVALUATE.
 16399
 16400     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16401        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16402        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16403           AND  PB-C-LF-REF-CALC < +1.00
 16404           AND  PB-C-AH-REF-CALC < +1.00
 16405           CONTINUE
 16406        ELSE
 16407           IF (PB-COMPANY-ID = 'DCC')
 16408              AND (PB-CI-ENTRY-STATUS = 'M')
 16409              CONTINUE
 16410           ELSE
 16411              MOVE ER-2741       TO WS-ERROR
 16412              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16413           END-IF
 16414        END-IF
 16415     END-IF
 16416
 16417     IF (PB-C-LF-CANCEL-AMT = ZERO
 16418        AND WS-LF-BENEFIT-CD NOT = ZERO
 16419        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16420        AND PB-C-LF-REF-CALC NOT = ZERO)
 16421        OR
 16422        (PB-C-LF-CANCEL-AMT = ZERO
 16423        AND WS-LF-BENEFIT-CD NOT = ZERO
 16424        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16425             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16426                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16427                NEXT SENTENCE
 16428             ELSE
 16429                MOVE ER-2739        TO WS-ERROR
 16430                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16431
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 298
* EL050.cbl
 16432     IF (PB-C-AH-CANCEL-AMT = ZERO
 16433        AND WS-AH-BENEFIT-CD NOT = ZERO
 16434        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16435        AND PB-C-AH-REF-CALC NOT = ZERO)
 16436        OR
 16437        (PB-C-AH-CANCEL-AMT = ZERO
 16438        AND WS-AH-BENEFIT-CD NOT = ZERO
 16439        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16440             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16441                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16442                NEXT SENTENCE
 16443             ELSE
 16444                MOVE ER-2738        TO WS-ERROR
 16445                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16446
 16447 3775-OVER-REF-CHK.
 16448
 16449     IF PB-CI-ENTRY-STATUS = '5'
 16450        GO TO 3780-UPDATE-CANCEL-CERT.
 16451
 16452     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16453                              PB-CI-LF-ALT-PREMIUM-AMT.
 16454
 16455     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16456        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16457                                 PB-C-LF-REF-CALC
 16458      ELSE
 16459        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16460                                 PB-C-LF-CANCEL-AMT.
 16461
 16462     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16463        MOVE ER-2755             TO WS-ERROR
 16464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16465
 16466     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16467
 16468     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16469        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16470                                 PB-C-AH-REF-CALC
 16471      ELSE
 16472        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16473                                 PB-C-AH-CANCEL-AMT.
 16474
 16475     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16476        MOVE ER-2778             TO WS-ERROR
 16477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16478
 16479     IF PB-CI-OB-FLAG NOT = 'Z'
 16480        NEXT SENTENCE
 16481       ELSE
 16482         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16483            MOVE ER-2757           TO WS-ERROR
 16484            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16485
 16486 3780-UPDATE-CANCEL-CERT.
 16487
 16488     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16489        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 299
* EL050.cbl
 16490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16491
 16492     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16493         MOVE ER-2729              TO WS-ERROR
 16494         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16495
 16496     IF PB-CI-LF-BENEFIT-CD = ZERO
 16497         GO TO 3780-UPDATE-CONT-1.
 16498
 16499     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16500         GO TO 3780-UPDATE-CONT-1.
 16501
 16502     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16503       AND
 16504        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16505       AND
 16506        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16507       AND
 16508        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16509            NEXT SENTENCE
 16510       ELSE
 16511        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16512          AND
 16513***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16514***       AND
 16515           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16516            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16517               MOVE ER-2730      TO WS-ERROR
 16518               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16519               GO TO 3999-END-EDIT
 16520            ELSE
 16521               GO TO 3999-END-EDIT
 16522        ELSE
 16523            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16524               MOVE ER-2765           TO WS-ERROR
 16525               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16526               GO TO 3785-CHECK-NH.
 16527*              GO TO 3999-END-EDIT.
 16528
 16529 3780-UPDATE-CONT-1.
 16530     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16531
 16532     IF PB-CI-AH-BENEFIT-CD = ZERO
 16533         GO TO 3780-UPDATE-CONT-2.
 16534
 16535     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16536         GO TO 3780-UPDATE-CONT-2.
 16537
 16538     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16539
 16540     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16541       AND
 16542        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16543       AND
 16544        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16545       AND
 16546        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16547            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 300
* EL050.cbl
 16548       ELSE
 16549        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16550          AND
 16551***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16552***       AND
 16553           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16554           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16555            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16556               MOVE ER-2773      TO WS-ERROR
 16557               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16558               GO TO 3999-END-EDIT
 16559            ELSE
 16560               GO TO 3999-END-EDIT
 16561            END-IF
 16562           ELSE
 16563             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16564                MOVE ER-2890 TO WS-ERROR
 16565                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16566                GO TO 3999-END-EDIT
 16567             ELSE
 16568                GO TO 3785-CHECK-NH
 16569             END-IF
 16570           END-IF
 16571          ELSE
 16572            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16573              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16574                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16575                   MOVE ER-2890 TO WS-ERROR
 16576                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16577                   GO TO 3999-END-EDIT
 16578                ELSE
 16579                   MOVE ER-2765 TO WS-ERROR
 16580                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16581                   GO TO 3785-CHECK-NH
 16582                END-IF
 16583              ELSE
 16584               MOVE ER-2765      TO WS-ERROR
 16585               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16586               GO TO 3785-CHECK-NH.
 16587*              GO TO 3999-END-EDIT.
 16588
 16589 3780-UPDATE-CONT-2.
 16590
 16591     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16592        AND WS-LF-BENEFIT-CD = ZERO
 16593           MOVE ER-2743           TO WS-ERROR
 16594           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16595
 16596     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16597        AND WS-AH-BENEFIT-CD = ZERO
 16598           MOVE ER-2744           TO WS-ERROR
 16599           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16600
 16601     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16602        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16603        AND
 16604        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16605         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 301
* EL050.cbl
 16606           MOVE ER-2746           TO WS-ERROR
 16607           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16608
 16609     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16610       AND
 16611        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16612             MOVE ER-2737        TO WS-ERROR
 16613             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16614
 16615     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16616       AND
 16617        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16618             MOVE ER-2737        TO WS-ERROR
 16619             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16620
 16621     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16622         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16623             OR 'CID' OR 'DCC' OR 'AHL'
 16624             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16625         ELSE
 16626             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16627                 MOVE ER-2768    TO WS-ERROR
 16628                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16629             ELSE
 16630                 MOVE ER-2756    TO WS-ERROR
 16631                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16632
 16633     IF CERT-PEND-ISSUE-RETURNED
 16634        MOVE ER-2772             TO WS-ERROR
 16635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16636 3785-CHECK-NH.
 16637     IF PB-STATE NOT = 'NH'
 16638        GO TO 3999-END-EDIT
 16639     END-IF
 16640
 16641     MOVE ER-2796                TO WS-ERROR
 16642     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16643     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16644        OR (CM-NH-INTERFACE-SW = 'Y')
 16645        MOVE ER-2793             TO WS-ERROR
 16646        PERFORM 9900-ERROR-FORMAT
 16647                                 THRU 9900-EXIT
 16648     END-IF
 16649     MOVE +0                     TO WS-PAYMENT-AMT
 16650     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16651        GO TO 3999-END-EDIT
 16652     END-IF
 16653     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16654        GO TO 3999-END-EDIT
 16655     END-IF
 16656     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16657     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16658     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16659        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16660     END-IF
 16661     MOVE '1'                    TO DC-OPTION-CODE
 16662     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16663     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 302
* EL050.cbl
 16664        IF DC-ELAPSED-DAYS < +16
 16665           GO TO 3999-END-EDIT
 16666        END-IF
 16667     END-IF
 16668     MOVE +0                     TO DC-ELAPSED-DAYS
 16669     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16670     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16671     MOVE '1'                    TO DC-OPTION-CODE
 16672     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16673     IF NO-CONVERSION-ERROR
 16674        IF DC-ELAPSED-DAYS > +30
 16675           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16676        ELSE
 16677           GO TO 3999-END-EDIT
 16678        END-IF
 16679     ELSE
 16680        GO TO 3999-END-EDIT
 16681     END-IF
 16682     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16683        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16684           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16685     IF WS-PAYMENT-AMT < 600.00
 16686        GO TO 3999-END-EDIT
 16687     END-IF
 16688     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16689
 16690     IF (ERMAIL-FOUND = ' ')
 16691         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16692         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16693        GO TO 3999-END-EDIT
 16694     END-IF
 16695     MOVE ER-2795                TO WS-ERROR
 16696     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16697
 16698     GO TO 3999-END-EDIT.
 16699******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 303
* EL050.cbl
 16701 3990-FILES-NOT-OPEN.
 16702
 16703     MOVE ER-2617                TO WS-ERROR.
 16704     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16705     GO TO 9990-RETURN.
 16706
 16707 3999-END-EDIT.
 16708
 16709     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16710
 16711     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16712         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16713         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16714             PERFORM 9250-UNLOCK-RETURN
 16715             GO TO 9990-RETURN
 16716          ELSE
 16717             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16718             GO TO 9990-RETURN.
 16719
 16720     IF PB-CANCELLATION
 16721          GO TO 9990-RETURN.
 16722
 16723     IF CERT-WAS-NOT-FOUND
 16724        MOVE SPACES              TO CERTIFICATE-MASTER.
 16725
 16726     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16727
 16728     IF CERT-WAS-FOUND
 16729         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16730             PERFORM 9250-UNLOCK-RETURN
 16731          ELSE
 16732            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16733      ELSE
 16734         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16735
 16736     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16737        IF PB-COMPANY-ID = 'DCC' AND
 16738           (PB-CARRIER = '2' OR '4' OR '6')
 16739              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16740        END-IF
 16741     END-IF.
 16742
 16743     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16744     IF ((PB-COMPANY-ID = 'DCC')
 16745        AND (WS-NO-SECURE-PAY))
 16746                  OR
 16747        (WS-LF-SPECIAL-CALC-CD = 'O'
 16748        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16749        SET SKIP-ADDR-EDIT       TO TRUE
 16750     END-IF
 16751     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16752        AND (NOT SKIP-ADDR-EDIT)
 16753        MOVE ER-2963             TO WS-ERROR
 16754        PERFORM 9900-ERROR-FORMAT
 16755                                 THRU 9900-EXIT
 16756        GO TO 9990-RETURN
 16757     END-IF
 16758     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 304
* EL050.cbl
 16759     IF ERPNDM-FOUND NOT = 'X'
 16760        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16761           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16762           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16763           AND (NOT SKIP-ADDR-EDIT)
 16764           MOVE ER-2694          TO WS-ERROR
 16765           PERFORM 9900-ERROR-FORMAT
 16766                                 THRU 9900-EXIT
 16767        END-IF
 16768        MOVE ' '                 TO STATE-RECORD-ERROR
 16769        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16770        MOVE PM-STATE            TO CNTL-ACCESS
 16771        MOVE '3'                 TO CNTL-REC-TYPE
 16772        MOVE +0                  TO CNTL-SEQ-NO
 16773        MOVE '0'                 TO RC-SW-2
 16774        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16775        IF (NO-STATE-RECORD)
 16776           OR (CF-RECORD-TYPE NOT = '3')
 16777           OR (PM-STATE NOT = CF-STATE-CODE)
 16778           IF (PM-STATE = SPACES)
 16779              AND (SKIP-ADDR-EDIT)
 16780              CONTINUE
 16781           ELSE
 16782              MOVE ER-2963       TO WS-ERROR
 16783              PERFORM 9900-ERROR-FORMAT
 16784                                 THRU 9900-EXIT
 16785           END-IF
 16786        END-IF
 16787        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16788           MOVE ER-2883          TO WS-ERROR
 16789           PERFORM 9900-ERROR-FORMAT
 16790                                 THRU 9900-EXIT
 16791        END-IF
 16792        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16793           MOVE ' '                 TO STATE-RECORD-ERROR
 16794           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16795           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16796           MOVE '3'                 TO CNTL-REC-TYPE
 16797           MOVE +0                  TO CNTL-SEQ-NO
 16798           MOVE '0'                 TO RC-SW-2
 16799           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16800           IF NO-STATE-RECORD
 16801              OR (CF-RECORD-TYPE NOT = '3')
 16802              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16803              MOVE ER-2964          TO WS-ERROR
 16804              PERFORM 9900-ERROR-FORMAT
 16805                                    THRU 9900-EXIT
 16806           END-IF
 16807        END-IF
 16808     ELSE
 16809        IF NOT SKIP-ADDR-EDIT
 16810           MOVE ER-2393          TO WS-ERROR
 16811           PERFORM 9900-ERROR-FORMAT
 16812                                 THRU 9900-EXIT
 16813        END-IF
 16814     END-IF
 16815
 16816     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 305
* EL050.cbl
 16817
 16818     IF (ERMAIL-FOUND = ' ' AND
 16819        ERPNDM-FOUND = ' ')
 16820        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16821           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16822           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16823          OR
 16824           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16825          OR
 16826           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16827           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16828           GO TO 3999-UNLOCK-ERMAIL.
 16829
 16830     IF ERPNDM-FOUND = 'X'
 16831        GO TO 3999-UNLOCK-ERMAIL.
 16832
 16833     IF PM-INSURED-LAST-NAME      = SPACES
 16834        AND PM-INSURED-FIRST-NAME = SPACES
 16835        AND PM-ADDRESS-LINE-1     = SPACES
 16836        AND PM-ADDRESS-LINE-2     = SPACES
 16837        AND PM-CITY-STATE         = SPACES
 16838        AND PM-CRED-BENE-NAME     = SPACES
 16839        AND PM-CRED-BENE-ADDR     = SPACES
 16840        AND PM-CRED-BENE-CTYST    = SPACES
 16841        GO TO 3999-UNLOCK-ERMAIL
 16842     END-IF
 16843
 16844     MOVE SPACES                 TO MAILING-DATA.
 16845
 16846     MOVE 'MA'                   TO MA-RECORD-ID.
 16847     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16848     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16849     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16850     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16851     MOVE PB-SV-STATE            TO MA-STATE.
 16852     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16853     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16854
 16855     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16856     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16857
 16858     IF ERMAIL-FOUND = ' '
 16859        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16860     ELSE
 16861        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16862        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16863        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16864
 16865     GO TO 9990-RETURN.
 16866
 16867 3999-UNLOCK-ERMAIL.
 16868     IF ERMAIL-FOUND = ' '
 16869        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16870
 16871     GO TO 9990-RETURN.
 16872******************************************************************
 16873
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 306
* EL050.cbl
 16875 4000-UPDATE-CANCELLED-CERT.
 16876     IF CERT-WAS-NOT-FOUND
 16877        GO TO 4299-EXIT.
 16878
 16879*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16880     IF PB-C-NH-INT-ON-REFS > ZEROS
 16881        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16882     END-IF
 16883     IF PB-C-REF-INTERFACE-SW = 'Y'
 16884        MOVE PB-C-REF-INTERFACE-SW
 16885                                 TO CM-NH-INTERFACE-SW
 16886     END-IF
 16887     IF PB-C-POST-CARD-IND = 'Y'
 16888        MOVE +8                  TO SUB
 16889        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16890        IF ERMAIL-FOUND = ' '
 16891           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16892              (SUB > +7)
 16893              OR (MA-MAIL-STATUS (SUB) = '1')
 16894           END-PERFORM
 16895        END-IF
 16896        IF (SUB > +7)
 16897           OR (ERMAIL-FOUND = 'X')
 16898           MOVE ER-3789          TO WS-ERROR
 16899           PERFORM 9900-ERROR-FORMAT
 16900                                 THRU 9900-EXIT
 16901        END-IF
 16902     ELSE
 16903        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16904     END-IF
 16905     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16906
 16907     IF PB-CI-OB-FLAG = 'Z'
 16908        GO TO 4150-SUMMARY-CERT-CANCEL.
 16909
 16910     IF PB-C-LF-CANCEL-VOIDED
 16911         PERFORM 4200-REVERSE-LF-CANCEL.
 16912     IF PB-C-AH-CANCEL-VOIDED
 16913         PERFORM 4200-REVERSE-AH-CANCEL.
 16914
 16915 4100-APPLY-LF-CANCEL.
 16916
 16917     MOVE +0                     TO WS-SUB.
 16918
 16919 4100-CHECK-LF-ERRORS.
 16920
 16921     ADD +1                       TO WS-SUB.
 16922
 16923     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16924        IF LF-COVERAGE-CANCELLED
 16925           GO TO 4100-LF-CANCEL-CONT
 16926        ELSE
 16927           GO TO 4100-UPDATE-LF-COVERAGE.
 16928
 16929     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16930                                   ER-2729 OR
 16931                                   ER-2730 OR
 16932                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 307
* EL050.cbl
 16933                                   ER-2732 OR
 16934                                   ER-2737 OR
 16935                                   ER-2740 OR
 16936                                   ER-2743 OR
 16937                                   ER-2749 OR
 16938                                   ER-2750 OR
 16939                                   ER-2755 OR
 16940                                   ER-2757 OR
 16941                                   ER-2760 OR
 16942                                   ER-2772 OR
 16943                                   ER-2774 OR
 16944                                   ER-2776 OR
 16945                                   ER-2794
 16946        GO TO 4100-UPDATE-LF-COVERAGE.
 16947
 16948     GO TO 4100-CHECK-LF-ERRORS.
 16949
 16950 4100-UPDATE-LF-COVERAGE.
 16951
 16952     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16953     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16954     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16955        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16956     END-IF
 16957     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16958                                      TO CM-CREDIT-INTERFACE-SW-2.
 16959     IF CM-LF-CANCEL-DT = LOW-VALUE
 16960         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16961
 16962     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16963         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16964                                         CM-LF-STATUS-AT-CANCEL.
 16965
 16966     GO TO 4100-APPLY-AH-CANCEL.
 16967
 16968 4100-LF-CANCEL-CONT.
 16969     IF PB-C-LF-CANCEL-VOIDED
 16970         GO TO 4100-APPLY-AH-CANCEL.
 16971
 16972     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16973         GO TO 4100-APPLY-AH-CANCEL.
 16974
 16975     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16976        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16977           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16978        ELSE
 16979           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16980
 16981     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16982     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16983
 16984     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16985         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16986
 16987     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16988        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16989         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16990         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 308
* EL050.cbl
 16991
 16992     IF PB-RECORD-RETURNED
 16993        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16994      ELSE
 16995        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16996
 16997 4100-APPLY-AH-CANCEL.
 16998
 16999     MOVE +0                      TO WS-SUB.
 17000
 17001 4100-CHECK-AH-ERRORS.
 17002
 17003     ADD +1                       TO WS-SUB.
 17004
 17005     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17006        IF AH-COVERAGE-CANCELLED
 17007           GO TO 4100-AH-CANCEL-CONT
 17008        ELSE
 17009           GO TO 4100-UPDATE-AH-COVERAGE.
 17010
 17011     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17012                                   ER-2729 OR
 17013                                   ER-2732 OR
 17014                                   ER-2737 OR
 17015                                   ER-2740 OR
 17016                                   ER-2744 OR
 17017                                   ER-2749 OR
 17018                                   ER-2750 OR
 17019                                   ER-2755 OR
 17020                                   ER-2757 OR
 17021                                   ER-2760 OR
 17022                                   ER-2771 OR
 17023                                   ER-2772 OR
 17024                                   ER-2773 OR
 17025                                   ER-2775 OR
 17026                                   ER-2777 OR
 17027                                   ER-2794
 17028        GO TO 4100-UPDATE-AH-COVERAGE.
 17029
 17030     GO TO 4100-CHECK-AH-ERRORS.
 17031
 17032 4100-UPDATE-AH-COVERAGE.
 17033
 17034     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17035     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17036     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17037     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17038                                      TO CM-CREDIT-INTERFACE-SW-2.
 17039     IF CM-AH-CANCEL-DT = LOW-VALUE
 17040         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17041
 17042     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17043         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17044                                         CM-AH-STATUS-AT-CANCEL.
 17045
 17046     IF LF-COVERAGE-CANCELLED
 17047         IF PB-RECORD-RETURNED
 17048              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 309
* EL050.cbl
 17049          ELSE
 17050              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17051
 17052     GO TO 4299-EXIT.
 17053
 17054 4100-AH-CANCEL-CONT.
 17055     IF PB-C-AH-CANCEL-VOIDED
 17056         GO TO 4299-EXIT.
 17057
 17058     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17059         GO TO 4299-EXIT.
 17060
 17061     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17062        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17063           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17064        ELSE
 17065           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17066
 17067     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17068     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17069
 17070     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17071         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17072
 17073     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17074         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17075         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17076
 17077     IF PB-RECORD-RETURNED
 17078        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17079      ELSE
 17080        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17081
 17082     GO TO 4299-EXIT.
 17083
 17084 4150-SUMMARY-CERT-CANCEL.
 17085     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17086
 17087     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17088        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17089                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17090     ELSE
 17091        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17092                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17093
 17094     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17095        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17096                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17097     ELSE
 17098        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17099                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17100
 17101     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17102        NEXT SENTENCE
 17103     ELSE
 17104        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17105
 17106     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 310
* EL050.cbl
 17107
 17108 4200-REVERSE-LF-CANCEL.
 17109     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17110
 17111     IF CM-LF-CANCEL-APPLIED
 17112        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17113        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17114        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17115
 17116     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17117
 17118     IF PB-RECORD-RETURNED
 17119        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17120       ELSE
 17121        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17122
 17123 4200-REVERSE-LF-EXIT.
 17124       EXIT.
 17125
 17126 4200-REVERSE-AH-CANCEL.
 17127     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17128
 17129     IF CM-AH-CANCEL-APPLIED
 17130        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17131        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17132        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17133
 17134     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17135
 17136     IF PB-RECORD-RETURNED
 17137        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17138       ELSE
 17139        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17140
 17141 4200-REVERSE-AH-EXIT.
 17142       EXIT.
 17143
 17144 4299-EXIT.
 17145       EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 311
* EL050.cbl
 17147
 17148 4500-UPDATE-NEW-CERT.
 17149     IF CERT-WAS-FOUND
 17150         NEXT SENTENCE
 17151       ELSE
 17152         GO TO 4520-BUILD-NEW-KEY.
 17153
 17154     IF  CLASIC-CREATED-CERT
 17155         GO TO 4999-EXIT.
 17156
 17157     IF  CERT-WAS-CREATED-FOR-CLAIM
 17158         GO TO 4520-BUILD-NEW-KEY.
 17159
 17160     IF CERT-ADDED-BATCH
 17161        IF CM-RECORD-ID = 'CM'
 17162            GO TO 4999-EXIT.
 17163
 17164 4520-BUILD-NEW-KEY.
 17165* BUILD CONTROL PRIMARY
 17166
 17167     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17168                                       CM-COMPANY-CD-A1
 17169                                       CM-COMPANY-CD-A2
 17170                                       CM-COMPANY-CD-A4
 17171                                       CM-COMPANY-CD-A5.
 17172
 17173     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17174     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17175     MOVE PB-SV-STATE               TO CM-STATE.
 17176     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17177     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17178     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17179     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17180
 17181     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17182
 17183     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17184     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17185     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17186     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17187
 17188     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17189        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17190
 17191     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17192         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17193         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17194         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17195         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17196     ELSE
 17197         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17198
 17199     IF PB-COMPANY-ID   EQUAL  'CRI'
 17200         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17201         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17202         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17203         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17204         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 312
* EL050.cbl
 17205
 17206     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17207        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17208         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17209
 17210     IF PB-COMPANY-ID  = 'LBL'
 17211        IF PB-I-JOINT-COVERAGE
 17212            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17213                                           PB-I-MEMBER-NO
 17214            GO TO 4550-CONT-CERT-PROCESS.
 17215
 17216     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17217        NEXT SENTENCE
 17218     ELSE
 17219        GO TO 4540-BUILD-MEMBER-NO.
 17220
 17221******************************************************************
 17222*                                                                *
 17223*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17224*    FOR 'MON'.                                                  *
 17225*                                                                *
 17226******************************************************************
 17227
 17228     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17229     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17230     MOVE +1                     TO WS-SUB1
 17231                                    WS-SUB2.
 17232
 17233 4530-EDIT-MEMB-NAME.
 17234
 17235     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17236        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17237        ADD +1                       TO WS-SUB2.
 17238
 17239     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17240        ADD +1                       TO WS-SUB1
 17241        GO TO 4530-EDIT-MEMB-NAME.
 17242
 17243     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17244     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17245     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17246*    MOVE SPACE                      TO DC-OPTION-CODE.
 17247     SET  BIN-TO-GREG                TO TRUE.
 17248     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17249     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17250
 17251     GO TO 4550-CONT-CERT-PROCESS.
 17252
 17253******************************************************************
 17254*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17255******************************************************************
 17256
 17257 4540-BUILD-MEMBER-NO.
 17258
 17259     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17260         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17261         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17262         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 313
* EL050.cbl
 17263         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17264     ELSE
 17265         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17266
 17267     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17268        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17269         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17270
 17271 4550-CONT-CERT-PROCESS.
 17272
 17273*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17274*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17275*    ELSE
 17276*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17277
 17278     IF CERT-WAS-CREATED-FOR-CLAIM
 17279        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17280        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17281
 17282     IF CERT-AND-CLAIM-ONLINE
 17283        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17284        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17285
 17286     MOVE 'CM'                     TO CM-RECORD-ID.
 17287     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17288
 17289     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17290        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17291        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17292     ELSE
 17293        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17294        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17295
 17296     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17297     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17298     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17299     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17300     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17301     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17302     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17303                                      CM-LF-ITD-CANCEL-AMT
 17304                                      CM-LF-ITD-DEATH-AMT
 17305                                      CM-AH-ITD-AH-PMT
 17306                                      CM-AH-ITD-LUMP-PMT
 17307                                      CM-AH-ITD-CANCEL-AMT
 17308                                      CM-LF-NSP-PREMIUM-AMT
 17309                                      CM-AH-NSP-PREMIUM-AMT.
 17310*                                     CM-CLAIM-DEDUCT-WITHHELD
 17311*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17312     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17313     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17314     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17315     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17316     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17317     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17318     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17319     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17320     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 314
* EL050.cbl
 17321     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17322     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17323     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17324
 17325     IF PB-I-LIVES NOT NUMERIC
 17326         MOVE ZERO                 TO PB-I-LIVES.
 17327
 17328     IF PB-I-NUM-BILLED NOT NUMERIC
 17329         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17330
 17331     MOVE PB-I-LIVES               TO CM-LIVES.
 17332     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17333
 17334     IF PB-COMPANY-ID EQUAL  'DMD'
 17335         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17336         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17337
 17338     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17339     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17340     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17341     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17342     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17343     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17344
 17345     IF PB-I-LF-POLICY-FEE NUMERIC
 17346        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17347     ELSE
 17348        MOVE +0                    TO CM-LF-POLICY-FEE.
 17349
 17350     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17351        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17352        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17353     ELSE
 17354        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17355
 17356     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17357     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17358     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17359     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17360     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17361     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17362     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17363     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17364     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17365
 17366     IF PB-I-AH-POLICY-FEE NUMERIC
 17367        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17368     ELSE
 17369        MOVE +0                    TO CM-AH-POLICY-FEE.
 17370
 17371     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17372        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17373     ELSE
 17374        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17375
 17376     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17377     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 315
* EL050.cbl
 17379     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17380                                      CM-LF-DEATH-EXIT-DT
 17381                                      CM-AH-SETTLEMENT-EXIT-DT.
 17382
 17383*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17384*                       'TIH' OR 'OFL' OR 'FLA' OR
 17385*                       'TII' OR 'TMS' OR 'CRI' OR
 17386*                       'NCL'
 17387     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17388
 17389     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17390         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17391            MOVE '2'                TO CM-PREMIUM-TYPE.
 17392
 17393     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17394         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17395            MOVE '2'                TO CM-PREMIUM-TYPE.
 17396
 17397     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17398         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17399     ELSE
 17400         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17401         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17402
 17403     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17404     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17405     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17406     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17407     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17408     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17409     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17410     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17411
 17412     IF PB-NO-MONTHS-SKIPPED
 17413         MOVE SPACE                 TO CM-SKIP-CODE
 17414     ELSE
 17415         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17416
 17417     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17418     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17419                                       CM-LF-STATUS-AT-CANCEL.
 17420
 17421     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17422     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17423                                       CM-AH-STATUS-AT-CANCEL.
 17424
 17425     MOVE '1'                       TO CM-ENTRY-STATUS.
 17426
 17427     IF PB-REISSUED-CERT
 17428        MOVE '5'                    TO CM-ENTRY-STATUS.
 17429
 17430     IF PB-MONTHLY-CERT
 17431        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17432
 17433     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17434     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17435     IF PB-POLICY-IS-DECLINED
 17436        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 316
* EL050.cbl
 17437
 17438     IF PB-POLICY-IS-VOIDED
 17439        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17440
 17441     IF PB-NEEDS-UNDERWRITING
 17442        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17443
 17444     IF PB-REIN-ONLY-CERT
 17445        MOVE '9'                    TO CM-ENTRY-STATUS.
 17446
 17447     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17448         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17449     ELSE
 17450         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17451
 17452     IF PB-RECORD-RETURNED
 17453        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17454      ELSE
 17455        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17456
 17457     IF PB-I-MAIL-ADDRS-PRESENT
 17458        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17459
 17460     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17461                                       CM-ENTRY-DT.
 17462
 17463 4999-EXIT.
 17464     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 317
* EL050.cbl
 17466
 17467 5000-PROCESS-REPS.
 17468     MOVE ' '                    TO AGTC-MASTER-SW
 17469     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17470     MOVE CO-TYPE                TO AGTC-TYPE
 17471     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17472     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17473     IF (AGTC-MASTER-SW NOT = 'N')
 17474        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17475        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17476        PERFORM 8583-READ-ERAGTC-NEXT
 17477                                 THRU 8583-EXIT
 17478     END-IF
 17479     IF AGTC-MASTER-SW = 'N'
 17480        CONTINUE
 17481     ELSE
 17482        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17483           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17484              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17485              MOVE 'Y'           TO AGTC-MASTER-SW
 17486           END-IF
 17487        END-IF
 17488     END-IF
 17489     .
 17490 5000-EXIT.
 17491     EXIT.
 17492 6370-EDIT-INPUT-LF-CODE.
 17493     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17494        MOVE +1                  TO SUB
 17495        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17496        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17497        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17498        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17499        GO TO 6370-SEARCH-LOOP.
 17500
 17501     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17502
 17503     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17504     MOVE SPACES                 TO CNTL-ACCESS.
 17505*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17506     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17507     MOVE +0                     TO CNTL-SEQ-NO.
 17508     MOVE '4' TO RC-SW-2.
 17509     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17510
 17511     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17512        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17513        GO TO 6370-NO-LF-FOUND.
 17514
 17515     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17516     MOVE +1                     TO SUB.
 17517
 17518 6370-SEARCH-LOOP.
 17519     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17520         GO TO 6370-NO-LF-FOUND.
 17521
 17522     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17523         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 318
* EL050.cbl
 17524         GO TO 6370-HER-NET-PAY-CHECK.
 17525
 17526     ADD 1   TO SUB.
 17527*    IF SUB GREATER 120
 17528     IF SUB GREATER 200
 17529         GO TO 6370-NO-LF-FOUND.
 17530
 17531     GO TO 6370-SEARCH-LOOP.
 17532
 17533 6370-NO-LF-FOUND.
 17534
 17535     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17536
 17537 6370-HER-NET-PAY-CHECK.
 17538
 17539     IF PB-COMPANY-ID = 'CID'
 17540        IF PB-SV-STATE = 'CA' OR 'MN'
 17541           IF PB-I-LF-BENEFIT-CD = '02'
 17542              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17543           ELSE
 17544              IF PB-I-LF-BENEFIT-CD = '04'
 17545                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17546              END-IF
 17547           END-IF
 17548        END-IF
 17549     END-IF
 17550
 17551     IF PB-COMPANY-ID NOT = 'HER'
 17552         GO TO 6370-EXIT.
 17553
 17554     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17555         GO TO 6370-EXIT.
 17556
 17557     IF PB-I-LF-TERM NOT NUMERIC
 17558         MOVE ZEROS              TO PB-I-LF-TERM.
 17559
 17560     IF PB-I-LOAN-TERM NOT NUMERIC
 17561         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17562
 17563     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17564         GO TO 6370-EXIT.
 17565
 17566     IF PB-I-LF-BENEFIT-CD = '33'
 17567         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17568
 17569     IF PB-I-LF-BENEFIT-CD = '34'
 17570         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17571
 17572 6370-EXIT.
 17573     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 319
* EL050.cbl
 17575
 17576 6380-EDIT-INPUT-AH-CODE.
 17577     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17578        MOVE +1                  TO SUB
 17579        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17580        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17581        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17582        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17583        GO TO 6380-SEARCH-LOOP.
 17584
 17585     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17586
 17587     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17588     MOVE SPACES                 TO CNTL-ACCESS.
 17589     MOVE 'A'                    TO CNTL-REC-TYPE.
 17590*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17591     MOVE +0                     TO CNTL-SEQ-NO.
 17592     MOVE '5' TO RC-SW-2.
 17593     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17594
 17595     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17596        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17597        GO TO 6380-NO-AH-FOUND.
 17598
 17599     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17600     MOVE +1 TO SUB.
 17601
 17602 6380-SEARCH-LOOP.
 17603     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17604         GO TO 6380-NO-AH-FOUND.
 17605
 17606     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17607         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17608         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17609
 17610     ADD 1   TO SUB.
 17611     IF SUB GREATER THAN 96
 17612*    IF SUB GREATER THAN 300
 17613         GO TO 6380-NO-AH-FOUND.
 17614
 17615     GO TO 6380-SEARCH-LOOP.
 17616
 17617 6380-NO-AH-FOUND.
 17618
 17619     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17620
 17621     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17622         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17623     ELSE
 17624         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17625
 17626 6380-CSO-AH-ONLY-CHECKS.
 17627
 17628     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17629        NEXT SENTENCE
 17630      ELSE
 17631        GO TO 6380-EXIT.
 17632
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 320
* EL050.cbl
 17633     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17634         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17635
 17636
 17637     GO TO 6380-EXIT
 17638     .
 17639 6380-CSO-LIFE-WITH-AH-CHECKS.
 17640
 17641
 17642     .
 17643 6380-EXIT.
 17644     EXIT.
 17645
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 321
* EL050.cbl
 17647
 17648 6400-COMPUTE-EXTENSION-DAYS.
 17649
 17650******************************************************************
 17651*                                                                *
 17652*                   COMPUTE EXTENSION DAYS                       *
 17653*                                                                *
 17654*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17655*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17656*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17657*    THE EXTENSION DAYS.                                         *
 17658*                                                                *
 17659******************************************************************
 17660
 17661     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17662     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17663
 17664******************************************************************
 17665*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17666*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17667******************************************************************
 17668
 17669     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17670        COMPUTE WS-ODD-DAYS-OVER =
 17671               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17672     ELSE
 17673        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17674
 17675     IF WS-ODD-DAYS-OVER = ZEROS
 17676           GO TO 6499-EXIT
 17677     ELSE
 17678        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17679           IF WS-WDF-MONTH = 02
 17680              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17681              ADD 2       TO  WS-ODD-DAYS-OVER
 17682              GO TO 6499-EXIT
 17683           ELSE
 17684              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17685                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17686                 GO TO 6499-EXIT
 17687               ELSE
 17688                 GO TO 6499-EXIT
 17689        ELSE
 17690           GO TO 6499-EXIT.
 17691
 17692 6412-CHECK-TO-DAY.
 17693
 17694        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17695           IF WS-WDT-DAY = 28
 17696              ADD 2              TO WS-ODD-DAYS-OVER
 17697           ELSE
 17698              IF WS-WDT-DAY = 29
 17699                 ADD 1           TO WS-ODD-DAYS-OVER
 17700              ELSE
 17701                 NEXT SENTENCE
 17702        ELSE
 17703           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17704              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 322
* EL050.cbl
 17705
 17706     GO TO 6499-EXIT.
 17707
 17708
 17709 6415-CHECK-LEAP-YEAR.
 17710
 17711     IF DC-DAYS-IN-MONTH = 29
 17712        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17713
 17714 6415-EXIT.
 17715     EXIT.
 17716
 17717 6499-EXIT.
 17718      EXIT.
 17719
 17720 6500-END.
 17721     EXIT.
 17722
 17723
 17724******************************************************************
 17725************* PROCEDURE DIVISION FOR EL050 ***********************
 17726********************** ELC50PD END *******************************
 17727
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 323
* EL050.cbl
 17729
 17730**START***********************************************************
 17731*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17732*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17733******************************************************************
 17734*
 17735 6600-GET-STATE-MUNICIPAL-TAX.
 17736
 17737     IF PB-COMPANY-ID NOT = 'DMD'
 17738         GO TO 6640-EXIT.
 17739
 17740     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17741     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17742     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17743*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17744*
 17745***  Y2K PROJ 7744
 17746     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17747     SET BIN-TO-GREG          TO TRUE.
 17748     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17749
 17750     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17751
 17752     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17753     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17754
 17755
 17756* EXEC CICS HANDLE CONDITION
 17757*        INVREQ    (6610-START-BROWSE)
 17758*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17759*        NOTFND    (6630-END-OF-FILE)
 17760*    END-EXEC.
 17761*    MOVE '"$8JI                 ! # #00017743' TO DFHEIV0
 17762     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17764     MOVE X'2320233030303137373433' TO DFHEIV0(25:11)
 17765     CALL 'kxdfhei1' USING DFHEIV0
 17766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17767
 17768
 17769 6610-START-BROWSE.
 17770
 17771
 17772* EXEC CICS HANDLE CONDITION
 17773*        NOTFND    (6630-END-OF-FILE)
 17774*        DISABLED  (6630-ERRESS-PROBLEM)
 17775*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17776*        ENDFILE   (6630-END-OF-FILE)
 17777*    END-EXEC.
 17778*    MOVE '"$IcJ''                ! $ #00017751' TO DFHEIV0
 17779     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17781     MOVE X'2420233030303137373531' TO DFHEIV0(25:11)
 17782     CALL 'kxdfhei1' USING DFHEIV0
 17783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17784
 17785
 17786
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 324
* EL050.cbl
 17787* EXEC CICS STARTBR
 17788*        DATASET (FILE-ID-ERRESS)
 17789*        RIDFLD  (WS-ERRESS-KEY)
 17790*        GTEQ
 17791*    END-EXEC.
 17792     MOVE 0
 17793       TO DFHEIV11
 17794*    MOVE '&,         G          &   #00017758' TO DFHEIV0
 17795     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17796     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17797     MOVE X'2020233030303137373538' TO DFHEIV0(25:11)
 17798     CALL 'kxdfhei1' USING DFHEIV0,
 17799           FILE-ID-ERRESS,
 17800           WS-ERRESS-KEY,
 17801           DFHEIV99,
 17802           DFHEIV11,
 17803           DFHEIV99
 17804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17805
 17806
 17807 6620-READ-NEXT-ERRESS-MASTER.
 17808
 17809
 17810* EXEC CICS HANDLE CONDITION
 17811*        NOTFND    (6630-END-OF-FILE)
 17812*        ENDFILE   (6630-END-OF-FILE)
 17813*        DISABLED  (6630-ERRESS-PROBLEM)
 17814*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17815*    END-EXEC.
 17816*    MOVE '"$I''cJ                ! % #00017766' TO DFHEIV0
 17817     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17819     MOVE X'2520233030303137373636' TO DFHEIV0(25:11)
 17820     CALL 'kxdfhei1' USING DFHEIV0
 17821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17822
 17823
 17824
 17825* EXEC CICS READNEXT
 17826*        DATASET (FILE-ID-ERRESS)
 17827*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17828*        RIDFLD  (WS-ERRESS-KEY)
 17829*    END-EXEC.
 17830     MOVE LENGTH OF
 17831      RESIDENT-STATE-TAX-MASTER
 17832       TO DFHEIV12
 17833     MOVE 0
 17834       TO DFHEIV11
 17835*    MOVE '&.IL                  )   #00017773' TO DFHEIV0
 17836     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17837     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17838     MOVE X'2020233030303137373733' TO DFHEIV0(25:11)
 17839     CALL 'kxdfhei1' USING DFHEIV0,
 17840           FILE-ID-ERRESS,
 17841           RESIDENT-STATE-TAX-MASTER,
 17842           DFHEIV12,
 17843           WS-ERRESS-KEY,
 17844           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 325
* EL050.cbl
 17845           DFHEIV11,
 17846           DFHEIV99,
 17847           DFHEIV99
 17848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17849
 17850
 17851     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17852
 17853* EXEC CICS ENDBR
 17854*            DATASET (FILE-ID-ERRESS)
 17855*       END-EXEC
 17856     MOVE 0
 17857       TO DFHEIV11
 17858*    MOVE '&2                    $   #00017780' TO DFHEIV0
 17859     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17860     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17861     MOVE X'2020233030303137373830' TO DFHEIV0(25:11)
 17862     CALL 'kxdfhei1' USING DFHEIV0,
 17863           FILE-ID-ERRESS,
 17864           DFHEIV11,
 17865           DFHEIV99
 17866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17867        GO TO 6630-END-OF-FILE.
 17868
 17869     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17870        NEXT SENTENCE
 17871      ELSE
 17872        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17873
 17874*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17875*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17876*
 17877     MOVE +2                     TO WS-SUB1.
 17878
 17879     IF PB-ISSUE
 17880     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17881        MOVE +1                  TO WS-SUB1.
 17882
 17883     IF PB-CANCELLATION
 17884     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17885        MOVE +1                  TO WS-SUB1.
 17886*
 17887*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17888*
 17889***  Y2K PROJ 7744
 17890     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17891***  Y2K PROJ 7744
 17892
 17893*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17894* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17895* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17896
 17897     ADD 1                    TO WS-YEAR-YY.
 17898
 17899     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17900         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17901                              TO WS-RES-STATE-TAX
 17902         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 326
* EL050.cbl
 17903                              TO WS-RES-MUNI-TAX
 17904     ELSE
 17905         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17906                              TO WS-RES-STATE-TAX
 17907         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17908                              TO WS-RES-MUNI-TAX.
 17909
 17910*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17911
 17912     IF PB-CANCELLATION
 17913         GO TO 6640-CANCEL-TAX.
 17914
 17915     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17916         COMPUTE PB-I-STATE-TAX ROUNDED =
 17917                                   PB-I-LF-PREMIUM-AMT
 17918                                 * WS-RES-STATE-TAX
 17919         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17920                                   PB-I-LF-PREMIUM-AMT
 17921                                 * WS-RES-MUNI-TAX
 17922     ELSE
 17923     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17924         COMPUTE PB-I-STATE-TAX ROUNDED =
 17925                                   PB-I-AH-PREMIUM-AMT
 17926                                 * WS-RES-STATE-TAX
 17927         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17928                                   PB-I-AH-PREMIUM-AMT
 17929                                 * WS-RES-MUNI-TAX.
 17930
 17931
 17932* EXEC CICS ENDBR
 17933*         DATASET (FILE-ID-ERRESS)
 17934*    END-EXEC.
 17935     MOVE 0
 17936       TO DFHEIV11
 17937*    MOVE '&2                    $   #00017847' TO DFHEIV0
 17938     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17939     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17940     MOVE X'2020233030303137383437' TO DFHEIV0(25:11)
 17941     CALL 'kxdfhei1' USING DFHEIV0,
 17942           FILE-ID-ERRESS,
 17943           DFHEIV11,
 17944           DFHEIV99
 17945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17946
 17947
 17948     GO TO 6640-EXIT.
 17949
 17950 6640-CANCEL-TAX.
 17951     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17952
 17953     IF PB-C-LF-CANCEL-AMT > ZEROS
 17954         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17955                                   PB-C-LF-CANCEL-AMT
 17956                                 * WS-RES-STATE-TAX
 17957         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17958                                   PB-C-LF-CANCEL-AMT
 17959                                *  WS-RES-MUNI-TAX
 17960     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 327
* EL050.cbl
 17961     IF PB-C-AH-CANCEL-AMT > ZEROS
 17962         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17963                                   PB-C-AH-CANCEL-AMT
 17964                                 * WS-RES-STATE-TAX
 17965         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17966                                   PB-C-AH-CANCEL-AMT
 17967                                *  WS-RES-MUNI-TAX.
 17968
 17969
 17970* EXEC CICS ENDBR
 17971*         DATASET (FILE-ID-ERRESS)
 17972*    END-EXEC.
 17973     MOVE 0
 17974       TO DFHEIV11
 17975*    MOVE '&2                    $   #00017872' TO DFHEIV0
 17976     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17977     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17978     MOVE X'2020233030303137383732' TO DFHEIV0(25:11)
 17979     CALL 'kxdfhei1' USING DFHEIV0,
 17980           FILE-ID-ERRESS,
 17981           DFHEIV11,
 17982           DFHEIV99
 17983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17984
 17985
 17986     GO TO 6640-EXIT.
 17987
 17988 6630-END-OF-FILE.
 17989     MOVE ER-8002              TO WS-ERROR.
 17990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17991
 17992     GO TO 6640-EXIT.
 17993
 17994 6630-ERRESS-PROBLEM.
 17995     MOVE ER-8044              TO WS-ERROR.
 17996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17997
 17998 6640-EXIT.
 17999     EXIT.
 18000
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 328
* EL050.cbl
 18002 6650-GET-RES-STATE-COMM.
 18003
 18004     IF PB-COMPANY-ID NOT = 'DMD'
 18005         GO TO 6700-COMM-EXIT.
 18006
 18007     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18008     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18009     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18010     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18011     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18012     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18013     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18014
 18015*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18016*
 18017***  Y2K PROJ 7744
 18018     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18019     SET BIN-TO-GREG          TO TRUE.
 18020     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18021
 18022     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18023***  Y2K PROJ 7744
 18024
 18025     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18026
 18027
 18028* EXEC CICS HANDLE CONDITION
 18029*        INVREQ    (6660-START-BROWSE)
 18030*        DISABLED  (6690-ERRESC-PROBLEM)
 18031*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18032*        NOTFND    (6690-END-OF-FILE)
 18033*    END-EXEC.
 18034*    MOVE '"$8cJI                ! & #00017917' TO DFHEIV0
 18035     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18037     MOVE X'2620233030303137393137' TO DFHEIV0(25:11)
 18038     CALL 'kxdfhei1' USING DFHEIV0
 18039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18040
 18041
 18042
 18043* EXEC CICS RESETBR
 18044*        DATASET (FILE-ID-ERRESC)
 18045*        RIDFLD  (WS-ERRESC-KEY)
 18046*    END-EXEC.
 18047     MOVE 0
 18048       TO DFHEIV11
 18049*    MOVE '&4         G          &   #00017924' TO DFHEIV0
 18050     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18051     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18052     MOVE X'2020233030303137393234' TO DFHEIV0(25:11)
 18053     CALL 'kxdfhei1' USING DFHEIV0,
 18054           FILE-ID-ERRESC,
 18055           WS-ERRESC-KEY,
 18056           DFHEIV99,
 18057           DFHEIV11,
 18058           DFHEIV99
 18059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 329
* EL050.cbl
 18060
 18061
 18062 6660-START-BROWSE.
 18063
 18064
 18065* EXEC CICS HANDLE CONDITION
 18066*        NOTFND    (6690-END-OF-FILE)
 18067*        DISABLED  (6690-ERRESC-PROBLEM)
 18068*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18069*        ENDFILE   (6690-END-OF-FILE)
 18070*    END-EXEC.
 18071*    MOVE '"$IcJ''                ! '' #00017931' TO DFHEIV0
 18072     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18074     MOVE X'2720233030303137393331' TO DFHEIV0(25:11)
 18075     CALL 'kxdfhei1' USING DFHEIV0
 18076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18077
 18078
 18079
 18080* EXEC CICS STARTBR
 18081*        DATASET (FILE-ID-ERRESC)
 18082*        RIDFLD  (WS-ERRESC-KEY)
 18083*        GTEQ
 18084*    END-EXEC.
 18085     MOVE 0
 18086       TO DFHEIV11
 18087*    MOVE '&,         G          &   #00017938' TO DFHEIV0
 18088     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18089     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18090     MOVE X'2020233030303137393338' TO DFHEIV0(25:11)
 18091     CALL 'kxdfhei1' USING DFHEIV0,
 18092           FILE-ID-ERRESC,
 18093           WS-ERRESC-KEY,
 18094           DFHEIV99,
 18095           DFHEIV11,
 18096           DFHEIV99
 18097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18098
 18099
 18100     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18101
 18102 6670-READ-NEXT-ERRESC-MASTER.
 18103
 18104
 18105* EXEC CICS HANDLE CONDITION
 18106*        NOTFND    (6690-END-OF-FILE)
 18107*        DISABLED  (6690-ERRESC-PROBLEM)
 18108*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18109*        ENDFILE   (6690-END-OF-FILE)
 18110*    END-EXEC.
 18111*    MOVE '"$IcJ''                ! ( #00017948' TO DFHEIV0
 18112     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18114     MOVE X'2820233030303137393438' TO DFHEIV0(25:11)
 18115     CALL 'kxdfhei1' USING DFHEIV0
 18116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18117
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 330
* EL050.cbl
 18118
 18119
 18120* EXEC CICS READNEXT
 18121*        DATASET (FILE-ID-ERRESC)
 18122*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18123*        RIDFLD  (ERRESC-RECORD-KEY)
 18124*    END-EXEC.
 18125     MOVE LENGTH OF
 18126      ACCOUNT-RESIDENT-ST-COMMISSION
 18127       TO DFHEIV12
 18128     MOVE 0
 18129       TO DFHEIV11
 18130*    MOVE '&.IL                  )   #00017955' TO DFHEIV0
 18131     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18132     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18133     MOVE X'2020233030303137393535' TO DFHEIV0(25:11)
 18134     CALL 'kxdfhei1' USING DFHEIV0,
 18135           FILE-ID-ERRESC,
 18136           ACCOUNT-RESIDENT-ST-COMMISSION,
 18137           DFHEIV12,
 18138           ERRESC-RECORD-KEY,
 18139           DFHEIV99,
 18140           DFHEIV11,
 18141           DFHEIV99,
 18142           DFHEIV99
 18143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18144
 18145
 18146     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18147        NEXT SENTENCE
 18148     ELSE
 18149
 18150* EXEC CICS ENDBR
 18151*            DATASET (FILE-ID-ERRESC)
 18152*       END-EXEC
 18153     MOVE 0
 18154       TO DFHEIV11
 18155*    MOVE '&2                    $   #00017964' TO DFHEIV0
 18156     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18157     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18158     MOVE X'2020233030303137393634' TO DFHEIV0(25:11)
 18159     CALL 'kxdfhei1' USING DFHEIV0,
 18160           FILE-ID-ERRESC,
 18161           DFHEIV11,
 18162           DFHEIV99
 18163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18164        GO TO 6690-END-OF-FILE.
 18165
 18166     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18167
 18168* EXEC CICS ENDBR
 18169*            DATASET (FILE-ID-ERRESC)
 18170*       END-EXEC
 18171     MOVE 0
 18172       TO DFHEIV11
 18173*    MOVE '&2                    $   #00017970' TO DFHEIV0
 18174     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18175     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 331
* EL050.cbl
 18176     MOVE X'2020233030303137393730' TO DFHEIV0(25:11)
 18177     CALL 'kxdfhei1' USING DFHEIV0,
 18178           FILE-ID-ERRESC,
 18179           DFHEIV11,
 18180           DFHEIV99
 18181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18182        GO TO 6690-END-OF-FILE.
 18183
 18184     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18185        NEXT SENTENCE
 18186      ELSE
 18187        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18188
 18189* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18190*
 18191     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18192
 18193     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18194
 18195     IF WS-SUB1 > ZERO
 18196         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18197             PERFORM 6680-SET-COMMISSION
 18198         ELSE
 18199             PERFORM 6680-SET-TABLE-CODE.
 18200
 18201
 18202* EXEC CICS ENDBR
 18203*         DATASET (FILE-ID-ERRESC)
 18204*    END-EXEC.
 18205     MOVE 0
 18206       TO DFHEIV11
 18207*    MOVE '&2                    $   #00017992' TO DFHEIV0
 18208     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18209     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18210     MOVE X'2020233030303137393932' TO DFHEIV0(25:11)
 18211     CALL 'kxdfhei1' USING DFHEIV0,
 18212           FILE-ID-ERRESC,
 18213           DFHEIV11,
 18214           DFHEIV99
 18215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18216
 18217
 18218     GO TO 6700-COMM-EXIT.
 18219
 18220 6680-SET-TABLE-CODE.
 18221     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18222        MOVE ZEROS             TO WS-SUB1
 18223     ELSE
 18224* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18225* TO COMPUTE AH COMMISSION.
 18226        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18227        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18228        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18229        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18230        PERFORM 6680-READ-CTBL-TABLE
 18231        IF WS-CTBL-READ-SW NOT = 'Y'
 18232           MOVE ZEROS          TO WS-SUB1.
 18233
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 332
* EL050.cbl
 18234 6680-READ-CTBL-TABLE.
 18235*
 18236* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18237* TO COMPUTE LIFE COMMISSION
 18238
 18239     IF CTBL-SW = '0540'
 18240        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18241        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18242        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18243
 18244     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18245
 18246     IF CTBL-TABLE-FOUND
 18247        IF CTBL-SW = '0530'
 18248             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18249                                    * PB-I-AH-TERM
 18250             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18251             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18252        ELSE
 18253             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18254             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18255             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18256     ELSE
 18257        IF FIRST-TIME-THROUGH
 18258            GO TO 6680-READ-CTBL-TABLE
 18259        ELSE
 18260            MOVE ZEROS         TO WS-SUB1.
 18261
 18262 6680-SET-COMMISSION.
 18263     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18264           MOVE ZEROS          TO WS-SUB1
 18265       ELSE
 18266           MOVE RESC-COMMISSION-PER (WS-SUB)
 18267                               TO WS-COMMISSION
 18268           IF CTBL-SW = '0530'
 18269               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18270           ELSE
 18271               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18272
 18273 6680-SEARCH-CATEGORY.
 18274     ADD +1                   TO WS-SUB.
 18275     IF WS-SUB > +12
 18276         GO TO 6680-EXIT.
 18277
 18278     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18279          MOVE WS-SUB         TO WS-SUB1
 18280          GO TO 6680-EXIT.
 18281
 18282     GO TO 6680-SEARCH-CATEGORY.
 18283
 18284 6680-EXIT.
 18285     EXIT.
 18286
 18287 6690-END-OF-FILE.
 18288     GO TO 6700-COMM-EXIT.
 18289
 18290 6690-ERRESC-PROBLEM.
 18291      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 333
* EL050.cbl
 18292      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18293
 18294      GO TO 6700-COMM-EXIT.
 18295
 18296 6700-COMM-EXIT.
 18297     EXIT.
 18298
 18299 7000-GET-RATE.
 18300
 18301* EXEC CICS LINK
 18302*        PROGRAM    ('ELRATE')
 18303*        COMMAREA   (CALCULATION-PASS-AREA)
 18304*        LENGTH     (CP-COMM-LENGTH)
 18305*    END-EXEC.
 18306     MOVE 'ELRATE' TO DFHEIV1
 18307*    MOVE '."C                   ''   #00018078' TO DFHEIV0
 18308     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18309     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18310     MOVE X'2020233030303138303738' TO DFHEIV0(25:11)
 18311     CALL 'kxdfhei1' USING DFHEIV0,
 18312           DFHEIV1,
 18313           CALCULATION-PASS-AREA,
 18314           CP-COMM-LENGTH,
 18315           DFHEIV99,
 18316           DFHEIV99,
 18317           DFHEIV99
 18318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18319
 18320
 18321 7000-EXIT.
 18322     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 334
* EL050.cbl
 18324 7100-FIND-BENEFIT-IN-STATE.
 18325     MOVE 'N'                    TO BEN-SEARCH-SW.
 18326
 18327     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18328         VARYING SUB3 FROM 1 BY 1 UNTIL
 18329            ((SUB3 GREATER 50) OR
 18330              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18331               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18332
 18333     IF SUB3 NOT = 51
 18334         MOVE 'Y'                TO BEN-SEARCH-SW.
 18335
 18336     GO TO 7199-EXIT.
 18337
 18338 7100-BENEFIT-DUMMY.
 18339
 18340 7100-DUMMY-EXIT.
 18341     EXIT.
 18342
 18343 7199-EXIT.
 18344     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 335
* EL050.cbl
 18346 7200-FIND-BENEFIT.
 18347     MOVE 'N'                    TO BEN-SEARCH-SW.
 18348
 18349     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18350         VARYING SUB3 FROM 1 BY 1 UNTIL
 18351            ((SUB3 GREATER 8) OR
 18352            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18353
 18354     IF SUB3 NOT = 9
 18355         MOVE 'Y'                TO BEN-SEARCH-SW.
 18356
 18357     GO TO 7200-EXIT.
 18358
 18359 7200-BENEFIT-DUMMY.
 18360
 18361 7200-DUMMY-EXIT.
 18362     EXIT.
 18363
 18364 7200-EXIT.
 18365     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 336
* EL050.cbl
 18367 7250-LOOK-FOR-RESCINDED-CLAIM.
 18368     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18369                                    W-CL-COMP-CD.
 18370     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18371                                    W-CL-CERT-NO.
 18372
 18373
 18374* EXEC CICS HANDLE CONDITION
 18375*        NOTFND  (7250-CONTINUE)
 18376*        ENDFILE (7250-CONTINUE)
 18377*    END-EXEC.
 18378*    MOVE '"$I''                  ! ) #00018136' TO DFHEIV0
 18379     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18381     MOVE X'2920233030303138313336' TO DFHEIV0(25:11)
 18382     CALL 'kxdfhei1' USING DFHEIV0
 18383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18384
 18385
 18386
 18387* EXEC CICS IGNORE CONDITION
 18388*        DUPKEY
 18389*    END-EXEC.
 18390*    MOVE '"*$                   !   #00018141' TO DFHEIV0
 18391     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18393     MOVE X'2020233030303138313431' TO DFHEIV0(25:11)
 18394     CALL 'kxdfhei1' USING DFHEIV0
 18395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18396
 18397
 18398
 18399* EXEC CICS STARTBR
 18400*        DATASET   (CLMS-ID)
 18401*        RIDFLD    (ELMSTR-KEY)
 18402*        GENERIC   EQUAL
 18403*        KEYLENGTH (ELMSTR-LENGTH)
 18404*    END-EXEC.
 18405     MOVE 0
 18406       TO DFHEIV11
 18407*    MOVE '&,   KG    E          &   #00018145' TO DFHEIV0
 18408     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18409     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18410     MOVE X'2020233030303138313435' TO DFHEIV0(25:11)
 18411     CALL 'kxdfhei1' USING DFHEIV0,
 18412           CLMS-ID,
 18413           ELMSTR-KEY,
 18414           ELMSTR-LENGTH,
 18415           DFHEIV11,
 18416           DFHEIV99
 18417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18418
 18419
 18420     MOVE 'Y'                    TO W-BROWSE-SW.
 18421
 18422 7250-NEXT-CLAIM.
 18423
 18424
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 337
* EL050.cbl
 18425* EXEC CICS READNEXT
 18426*        DATASET   (CLMS-ID)
 18427*        RIDFLD    (ELMSTR-KEY)
 18428*        SET       (ADDRESS OF CLAIM-MASTER)
 18429*    END-EXEC.
 18430     MOVE 0
 18431       TO DFHEIV11
 18432*    MOVE '&.S                   )   #00018156' TO DFHEIV0
 18433     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18434     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18435     MOVE X'2020233030303138313536' TO DFHEIV0(25:11)
 18436     CALL 'kxdfhei1' USING DFHEIV0,
 18437           CLMS-ID,
 18438           DFHEIV20,
 18439           DFHEIV99,
 18440           ELMSTR-KEY,
 18441           DFHEIV99,
 18442           DFHEIV11,
 18443           DFHEIV99,
 18444           DFHEIV99
 18445     SET ADDRESS OF CLAIM-MASTER TO
 18446         DFHEIV20
 18447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18448
 18449
 18450     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18451        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18452         GO TO 7250-CONTINUE
 18453     END-IF.
 18454
 18455     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18456        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18457        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18458        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18459        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18460         GO TO 7250-NEXT-CLAIM
 18461     END-IF.
 18462
 18463     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18464        OR (CL-CLAIM-TYPE = 'I')
 18465        OR (CL-CLAIM-TYPE = 'G')
 18466          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18467              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18468              GO TO 7250-CONTINUE
 18469          END-IF
 18470     END-IF.
 18471
 18472     GO TO 7250-NEXT-CLAIM.
 18473
 18474 7250-CONTINUE.
 18475
 18476     IF W-BROWSE-SW = 'Y'
 18477
 18478* EXEC CICS ENDBR
 18479*            DATASET   (CLMS-ID)
 18480*        END-EXEC
 18481     MOVE 0
 18482       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 338
* EL050.cbl
 18483*    MOVE '&2                    $   #00018189' TO DFHEIV0
 18484     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18485     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18486     MOVE X'2020233030303138313839' TO DFHEIV0(25:11)
 18487     CALL 'kxdfhei1' USING DFHEIV0,
 18488           CLMS-ID,
 18489           DFHEIV11,
 18490           DFHEIV99
 18491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18492         MOVE 'N' TO W-BROWSE-SW
 18493     END-IF.
 18494
 18495 7250-EXIT.
 18496     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 339
* EL050.cbl
 18498 7300-CHECK-FOR-OPEN-CLMS.
 18499
 18500*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18501*    MOVE SPACES                 TO CNTL-ACCESS.
 18502*    MOVE '1'                    TO CNTL-REC-TYPE.
 18503*    MOVE +0                     TO CNTL-SEQ-NO.
 18504
 18505*    MOVE '3'                    TO RC-SW-1.
 18506*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18507
 18508*    IF NOT CF-COMPANY-MASTER
 18509*         PERFORM 0099-COMPANY-NOT-FOUND
 18510*         GO TO 7300-EXIT.
 18511
 18512     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18513                                    W-CL-COMP-CD.
 18514     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18515                                    W-CL-CERT-NO.
 18516
 18517
 18518* EXEC CICS HANDLE CONDITION
 18519*        NOTFND  (7300-CONTINUE)
 18520*        ENDFILE (7300-CONTINUE)
 18521*    END-EXEC.
 18522*    MOVE '"$I''                  ! * #00018217' TO DFHEIV0
 18523     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18525     MOVE X'2A20233030303138323137' TO DFHEIV0(25:11)
 18526     CALL 'kxdfhei1' USING DFHEIV0
 18527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18528
 18529
 18530
 18531* EXEC CICS IGNORE CONDITION
 18532*        DUPKEY
 18533*    END-EXEC.
 18534*    MOVE '"*$                   !   #00018222' TO DFHEIV0
 18535     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18537     MOVE X'2020233030303138323232' TO DFHEIV0(25:11)
 18538     CALL 'kxdfhei1' USING DFHEIV0
 18539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18540
 18541
 18542
 18543* EXEC CICS STARTBR
 18544*        DATASET   (CLMS-ID)
 18545*        RIDFLD    (ELMSTR-KEY)
 18546*        GENERIC   EQUAL
 18547*        KEYLENGTH (ELMSTR-LENGTH)
 18548*    END-EXEC.
 18549     MOVE 0
 18550       TO DFHEIV11
 18551*    MOVE '&,   KG    E          &   #00018226' TO DFHEIV0
 18552     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18554     MOVE X'2020233030303138323236' TO DFHEIV0(25:11)
 18555     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 340
* EL050.cbl
 18556           CLMS-ID,
 18557           ELMSTR-KEY,
 18558           ELMSTR-LENGTH,
 18559           DFHEIV11,
 18560           DFHEIV99
 18561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18562
 18563
 18564     MOVE 'Y'                    TO W-BROWSE-SW.
 18565
 18566 7300-NEXT-CLAIM.
 18567
 18568
 18569* EXEC CICS READNEXT
 18570*        DATASET   (CLMS-ID)
 18571*        RIDFLD    (ELMSTR-KEY)
 18572*        SET       (ADDRESS OF CLAIM-MASTER)
 18573*    END-EXEC.
 18574     MOVE 0
 18575       TO DFHEIV11
 18576*    MOVE '&.S                   )   #00018237' TO DFHEIV0
 18577     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18578     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18579     MOVE X'2020233030303138323337' TO DFHEIV0(25:11)
 18580     CALL 'kxdfhei1' USING DFHEIV0,
 18581           CLMS-ID,
 18582           DFHEIV20,
 18583           DFHEIV99,
 18584           ELMSTR-KEY,
 18585           DFHEIV99,
 18586           DFHEIV11,
 18587           DFHEIV99,
 18588           DFHEIV99
 18589     SET ADDRESS OF CLAIM-MASTER TO
 18590         DFHEIV20
 18591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18592
 18593
 18594     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18595        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18596         GO TO 7300-CONTINUE.
 18597
 18598     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18599        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18600        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18601        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18602        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18603         GO TO 7300-NEXT-CLAIM.
 18604
 18605*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18606     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18607        OR (CL-CLAIM-TYPE = 'I')
 18608        OR (CL-CLAIM-TYPE = 'G')
 18609        IF CLAIM-IS-OPEN
 18610           EVALUATE TRUE
 18611             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18612                 MOVE ER-2884      TO WS-ERROR
 18613             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 341
* EL050.cbl
 18614                 MOVE ER-2887      TO WS-ERROR
 18615             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18616                 MOVE ER-2886      TO WS-ERROR
 18617             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18618                 MOVE ER-2888      TO WS-ERROR
 18619             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18620                 MOVE ER-2885      TO WS-ERROR
 18621             WHEN OTHER
 18622                 MOVE ER-2768      TO WS-ERROR
 18623           END-EVALUATE
 18624           IF PB-C-AH-CANCEL-VOIDED OR
 18625              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18626                NOT AH-COVERAGE-CANCELLED)
 18627               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18628               MOVE ER-2768      TO WS-ERROR
 18629           END-IF
 18630           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18631           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18632              PB-FORCE-CODE NOT EQUAL '8'
 18633               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18634           END-IF
 18635           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18636           GO TO 7300-CONTINUE
 18637        ELSE
 18638           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18639*****THIS IS A RESCISSION OR REFORMATION
 18640              IF (AH-COVERAGE-CANCELLED AND
 18641                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18642                    MOVE ER-2890 TO WS-ERROR
 18643                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18644                    GO TO 7300-CONTINUE
 18645              END-IF
 18646           ELSE
 18647              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18648               AND PB-C-AH-CANCEL-DT > SPACES
 18649                 MOVE ER-2756        TO WS-ERROR
 18650                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18651                 GO TO 7300-CONTINUE
 18652              END-IF
 18653           END-IF
 18654        END-IF
 18655     ELSE
 18656*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18657        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18658           IF CLAIM-IS-OPEN
 18659              MOVE ER-2889      TO WS-ERROR
 18660              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18661              GO TO 7300-CONTINUE
 18662           ELSE
 18663              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18664*****THIS IS A RESCISSION OR REFORMATION
 18665                 IF (LF-COVERAGE-CANCELLED AND
 18666                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18667                       MOVE ER-2890 TO WS-ERROR
 18668                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18669                       GO TO 7300-CONTINUE
 18670                 END-IF
 18671              ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 342
* EL050.cbl
 18672                 IF (AH-COVERAGE-CANCELLED AND
 18673                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18674                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18675                    (LF-COVERAGE-CANCELLED AND
 18676                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18677                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18678                       MOVE ER-2965 TO WS-ERROR
 18679                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18680                       GO TO 7300-CONTINUE
 18681                 END-IF
 18682                 IF LF-COVERAGE-CANCELLED
 18683                  IF CL-TOTAL-PAID-AMT > 0
 18684                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18685                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18686                        MOVE ER-2891 TO WS-ERROR
 18687                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18688                        GO TO 7300-CONTINUE
 18689                      END-IF
 18690                    ELSE
 18691                      MOVE ER-2892 TO WS-ERROR
 18692                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18693                      GO TO 7300-CONTINUE
 18694                    END-IF
 18695                  END-IF
 18696                 END-IF
 18697              END-IF
 18698           END-IF
 18699        END-IF
 18700     END-IF
 18701
 18702     GO TO 7300-NEXT-CLAIM.
 18703
 18704 7300-CONTINUE.
 18705
 18706     IF W-BROWSE-SW = 'Y'
 18707
 18708* EXEC CICS ENDBR
 18709*            DATASET   (CLMS-ID)
 18710*        END-EXEC.
 18711     MOVE 0
 18712       TO DFHEIV11
 18713*    MOVE '&2                    $   #00018356' TO DFHEIV0
 18714     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18715     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18716     MOVE X'2020233030303138333536' TO DFHEIV0(25:11)
 18717     CALL 'kxdfhei1' USING DFHEIV0,
 18718           CLMS-ID,
 18719           DFHEIV11,
 18720           DFHEIV99
 18721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18722
 18723
 18724 7300-EXIT.
 18725     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 343
* EL050.cbl
 18727
 18728 7400-GET-REMAIN-TERM.
 18729
 18730* EXEC CICS LINK
 18731*        PROGRAM    ('ELRTRM')
 18732*        COMMAREA   (CALCULATION-PASS-AREA)
 18733*        LENGTH     (CP-COMM-LENGTH)
 18734*    END-EXEC.
 18735     MOVE 'ELRTRM' TO DFHEIV1
 18736*    MOVE '."C                   ''   #00018365' TO DFHEIV0
 18737     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18738     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18739     MOVE X'2020233030303138333635' TO DFHEIV0(25:11)
 18740     CALL 'kxdfhei1' USING DFHEIV0,
 18741           DFHEIV1,
 18742           CALCULATION-PASS-AREA,
 18743           CP-COMM-LENGTH,
 18744           DFHEIV99,
 18745           DFHEIV99,
 18746           DFHEIV99
 18747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18748
 18749
 18750 7400-EXIT.
 18751     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 344
* EL050.cbl
 18753
 18754 7500-GET-REMAIN-AMOUNT.
 18755
 18756* EXEC CICS LINK
 18757*        PROGRAM    ('ELRAMT')
 18758*        COMMAREA   (CALCULATION-PASS-AREA)
 18759*        LENGTH     (CP-COMM-LENGTH)
 18760*    END-EXEC.
 18761     MOVE 'ELRAMT' TO DFHEIV1
 18762*    MOVE '."C                   ''   #00018376' TO DFHEIV0
 18763     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18764     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18765     MOVE X'2020233030303138333736' TO DFHEIV0(25:11)
 18766     CALL 'kxdfhei1' USING DFHEIV0,
 18767           DFHEIV1,
 18768           CALCULATION-PASS-AREA,
 18769           CP-COMM-LENGTH,
 18770           DFHEIV99,
 18771           DFHEIV99,
 18772           DFHEIV99
 18773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18774
 18775
 18776 7500-EXIT.
 18777     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 345
* EL050.cbl
 18779
 18780 7600-GET-REFUND.
 18781
 18782* EXEC CICS LINK
 18783*        PROGRAM    ('ELRFND')
 18784*        COMMAREA   (CALCULATION-PASS-AREA)
 18785*        LENGTH     (CP-COMM-LENGTH)
 18786*    END-EXEC.
 18787     MOVE 'ELRFND' TO DFHEIV1
 18788*    MOVE '."C                   ''   #00018387' TO DFHEIV0
 18789     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18791     MOVE X'2020233030303138333837' TO DFHEIV0(25:11)
 18792     CALL 'kxdfhei1' USING DFHEIV0,
 18793           DFHEIV1,
 18794           CALCULATION-PASS-AREA,
 18795           CP-COMM-LENGTH,
 18796           DFHEIV99,
 18797           DFHEIV99,
 18798           DFHEIV99
 18799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18800
 18801
 18802 7600-EXIT.
 18803     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 346
* EL050.cbl
 18805 7700-CALL-DL1.
 18806
 18807* EXEC CICS LINK
 18808*        PROGRAM    ('DLO001')
 18809*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18810*        LENGTH     (DLO001-COMM-LENGTH)
 18811*    END-EXEC.
 18812     MOVE 'DLO001' TO DFHEIV1
 18813*    MOVE '."C                   ''   #00018397' TO DFHEIV0
 18814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18816     MOVE X'2020233030303138333937' TO DFHEIV0(25:11)
 18817     CALL 'kxdfhei1' USING DFHEIV0,
 18818           DFHEIV1,
 18819           WS-DLO-MASTER-POLICY-FORM,
 18820           DLO001-COMM-LENGTH,
 18821           DFHEIV99,
 18822           DFHEIV99,
 18823           DFHEIV99
 18824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18825
 18826
 18827 7700-EXIT.
 18828     EXIT.
 18829
 18830 7710-CALL-DL2.
 18831
 18832* EXEC CICS LINK
 18833*        PROGRAM    ('DLO002')
 18834*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18835*        LENGTH     (DLO002-COMM-LENGTH)
 18836*    END-EXEC.
 18837     MOVE 'DLO002' TO DFHEIV1
 18838*    MOVE '."C                   ''   #00018407' TO DFHEIV0
 18839     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18841     MOVE X'2020233030303138343037' TO DFHEIV0(25:11)
 18842     CALL 'kxdfhei1' USING DFHEIV0,
 18843           DFHEIV1,
 18844           WS-DLO-INTERNAL-POLICY-FORM,
 18845           DLO002-COMM-LENGTH,
 18846           DFHEIV99,
 18847           DFHEIV99,
 18848           DFHEIV99
 18849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18850
 18851
 18852 7710-EXIT.
 18853     EXIT.
 18854
 18855 7720-CALL-DL3.
 18856
 18857* EXEC CICS LINK
 18858*        PROGRAM    ('DLO003')
 18859*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18860*        LENGTH     (DLO003-COMM-LENGTH)
 18861*    END-EXEC.
 18862     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 347
* EL050.cbl
 18863*    MOVE '."C                   ''   #00018417' TO DFHEIV0
 18864     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18866     MOVE X'2020233030303138343137' TO DFHEIV0(25:11)
 18867     CALL 'kxdfhei1' USING DFHEIV0,
 18868           DFHEIV1,
 18869           WS-DLO-VALID-BANK-ID,
 18870           DLO003-COMM-LENGTH,
 18871           DFHEIV99,
 18872           DFHEIV99,
 18873           DFHEIV99
 18874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18875
 18876
 18877 7720-EXIT.
 18878     EXIT.
 18879
 18880 7730-CALL-DL7.
 18881
 18882* EXEC CICS LINK
 18883*        PROGRAM    ('DLO007')
 18884*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18885*        LENGTH     (DLO007-COMM-LENGTH)
 18886*    END-EXEC.
 18887     MOVE 'DLO007' TO DFHEIV1
 18888*    MOVE '."C                   ''   #00018427' TO DFHEIV0
 18889     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18891     MOVE X'2020233030303138343237' TO DFHEIV0(25:11)
 18892     CALL 'kxdfhei1' USING DFHEIV0,
 18893           DFHEIV1,
 18894           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18895           DLO007-COMM-LENGTH,
 18896           DFHEIV99,
 18897           DFHEIV99,
 18898           DFHEIV99
 18899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18900
 18901
 18902 7730-EXIT.
 18903     EXIT.
 18904
 18905 7740-CALL-DL11.
 18906
 18907* EXEC CICS LINK
 18908*        PROGRAM    ('DLO011')
 18909*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18910*        LENGTH     (DLO011-COMM-LENGTH)
 18911*    END-EXEC.
 18912     MOVE 'DLO011' TO DFHEIV1
 18913*    MOVE '."C                   ''   #00018437' TO DFHEIV0
 18914     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18915     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18916     MOVE X'2020233030303138343337' TO DFHEIV0(25:11)
 18917     CALL 'kxdfhei1' USING DFHEIV0,
 18918           DFHEIV1,
 18919           WS-DLO-PREM-RATES-BEN-TYPE,
 18920           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 348
* EL050.cbl
 18921           DFHEIV99,
 18922           DFHEIV99,
 18923           DFHEIV99
 18924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18925
 18926
 18927 7740-EXIT.
 18928     EXIT.
 18929
 18930 7750-CALL-DL17.
 18931
 18932* EXEC CICS LINK
 18933*        PROGRAM    ('DLO017')
 18934*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18935*        LENGTH     (DLO017-COMM-LENGTH)
 18936*    END-EXEC.
 18937     MOVE 'DLO017' TO DFHEIV1
 18938*    MOVE '."C                   ''   #00018447' TO DFHEIV0
 18939     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18940     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18941     MOVE X'2020233030303138343437' TO DFHEIV0(25:11)
 18942     CALL 'kxdfhei1' USING DFHEIV0,
 18943           DFHEIV1,
 18944           WS-DLO-VALID-RATE-CODE,
 18945           DLO017-COMM-LENGTH,
 18946           DFHEIV99,
 18947           DFHEIV99,
 18948           DFHEIV99
 18949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18950
 18951
 18952 7750-EXIT.
 18953     EXIT.
 18954
 18955 7755-CALL-DL19.
 18956
 18957* EXEC CICS LINK
 18958*        PROGRAM    ('DLO019')
 18959*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18960*        LENGTH     (DLO019-COMM-LENGTH)
 18961*    END-EXEC.
 18962     MOVE 'DLO019' TO DFHEIV1
 18963*    MOVE '."C                   ''   #00018457' TO DFHEIV0
 18964     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18966     MOVE X'2020233030303138343537' TO DFHEIV0(25:11)
 18967     CALL 'kxdfhei1' USING DFHEIV0,
 18968           DFHEIV1,
 18969           WS-DLO-ORIG-COV-CAT,
 18970           DLO019-COMM-LENGTH,
 18971           DFHEIV99,
 18972           DFHEIV99,
 18973           DFHEIV99
 18974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18975
 18976
 18977 7755-EXIT.
 18978     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 349
* EL050.cbl
 18979
 18980 7760-CALL-DL21.
 18981
 18982* EXEC CICS LINK
 18983*        PROGRAM    ('DLO021')
 18984*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18985*        LENGTH     (DLO021-COMM-LENGTH)
 18986*    END-EXEC.
 18987     MOVE 'DLO021' TO DFHEIV1
 18988*    MOVE '."C                   ''   #00018467' TO DFHEIV0
 18989     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18990     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18991     MOVE X'2020233030303138343637' TO DFHEIV0(25:11)
 18992     CALL 'kxdfhei1' USING DFHEIV0,
 18993           DFHEIV1,
 18994           WS-DLO-VALID-LOAN-OFFICER,
 18995           DLO021-COMM-LENGTH,
 18996           DFHEIV99,
 18997           DFHEIV99,
 18998           DFHEIV99
 18999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19000
 19001
 19002 7760-EXIT.
 19003     EXIT.
 19004
 19005 7770-CALL-DL22.
 19006
 19007* EXEC CICS LINK
 19008*        PROGRAM    ('DLO022')
 19009*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19010*        LENGTH     (DLO022-COMM-LENGTH)
 19011*    END-EXEC.
 19012     MOVE 'DLO022' TO DFHEIV1
 19013*    MOVE '."C                   ''   #00018477' TO DFHEIV0
 19014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19015     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19016     MOVE X'2020233030303138343737' TO DFHEIV0(25:11)
 19017     CALL 'kxdfhei1' USING DFHEIV0,
 19018           DFHEIV1,
 19019           WS-DLO-VALID-STATE-CODE,
 19020           DLO022-COMM-LENGTH,
 19021           DFHEIV99,
 19022           DFHEIV99,
 19023           DFHEIV99
 19024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19025
 19026
 19027 7770-EXIT.
 19028     EXIT.
 19029
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 350
* EL050.cbl
 19031
 19032 7800-REWRITE-CERT.
 19033******************************************************************
 19034*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19035*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19036******************************************************************
 19037
 19038     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19039        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19040        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19041        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19042
 19043* EXEC CICS REWRITE
 19044*                  DATASET (CERT-ID)
 19045*                  FROM    (CERTIFICATE-MASTER)
 19046*              END-EXEC
 19047     MOVE LENGTH OF
 19048      CERTIFICATE-MASTER
 19049       TO DFHEIV11
 19050*    MOVE '&& L                  %   #00018498' TO DFHEIV0
 19051     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19052     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19053     MOVE X'2020233030303138343938' TO DFHEIV0(25:11)
 19054     CALL 'kxdfhei1' USING DFHEIV0,
 19055           CERT-ID,
 19056           CERTIFICATE-MASTER,
 19057           DFHEIV11,
 19058           DFHEIV99
 19059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19060        GO TO 7800-EXIT.
 19061
 19062       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19063       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19064
 19065 7800-EXIT.
 19066      EXIT.
 19067
 19068 7900-DELETE-CERT.
 19069
 19070* EXEC CICS DELETE
 19071*        DATASET (CERT-ID)
 19072*    END-EXEC.
 19073*    MOVE '&(                    &   #00018511' TO DFHEIV0
 19074     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19076     MOVE X'2020233030303138353131' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           CERT-ID,
 19079           DFHEIV99,
 19080           DFHEIV99,
 19081           DFHEIV99,
 19082           DFHEIV99
 19083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19084
 19085
 19086 7900-EXIT.
 19087     EXIT.
 19088
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 351
* EL050.cbl
 19089 8000-WRITE-CERT.
 19090
 19091* EXEC CICS HANDLE CONDITION
 19092*        DUPKEY    (8000-FREE-MAIN)
 19093*    END-EXEC.
 19094*    MOVE '"$$                   ! + #00018519' TO DFHEIV0
 19095     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19097     MOVE X'2B20233030303138353139' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0
 19099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19100
 19101
 19102
 19103* EXEC CICS WRITE
 19104*        DATASET     (CERT-ID)
 19105*        FROM        (CERTIFICATE-MASTER)
 19106*        RIDFLD      (ELCERT-KEY)
 19107*    END-EXEC.
 19108     MOVE LENGTH OF
 19109      CERTIFICATE-MASTER
 19110       TO DFHEIV11
 19111*    MOVE '&$ L                  ''   #00018523' TO DFHEIV0
 19112     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19114     MOVE X'2020233030303138353233' TO DFHEIV0(25:11)
 19115     CALL 'kxdfhei1' USING DFHEIV0,
 19116           CERT-ID,
 19117           CERTIFICATE-MASTER,
 19118           DFHEIV11,
 19119           ELCERT-KEY,
 19120           DFHEIV99,
 19121           DFHEIV99
 19122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19123
 19124
 19125 8000-FREE-MAIN.
 19126
 19127 8000-EXIT.
 19128      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 352
* EL050.cbl
 19130
 19131 8100-READ-ERPNDM.
 19132
 19133* EXEC CICS HANDLE CONDITION
 19134*         NOTFND     (8100-NOTFND)
 19135*         ENDFILE    (8100-NOTFND)
 19136*    END-EXEC.
 19137*    MOVE '"$I''                  ! , #00018536' TO DFHEIV0
 19138     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19140     MOVE X'2C20233030303138353336' TO DFHEIV0(25:11)
 19141     CALL 'kxdfhei1' USING DFHEIV0
 19142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19143
 19144
 19145     MOVE SPACES                 TO ERPNDM-FOUND.
 19146     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19147
 19148
 19149* EXEC CICS READ
 19150*         DATASET   (FILE-ERPNDM)
 19151*         RIDFLD    (PM-CONTROL-PRIMARY)
 19152*         INTO      (PENDING-MAILING-DATA)
 19153*    END-EXEC.
 19154     MOVE LENGTH OF
 19155      PENDING-MAILING-DATA
 19156       TO DFHEIV11
 19157*    MOVE '&"IL       E          (   #00018544' TO DFHEIV0
 19158     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19160     MOVE X'2020233030303138353434' TO DFHEIV0(25:11)
 19161     CALL 'kxdfhei1' USING DFHEIV0,
 19162           FILE-ERPNDM,
 19163           PENDING-MAILING-DATA,
 19164           DFHEIV11,
 19165           PM-CONTROL-PRIMARY,
 19166           DFHEIV99,
 19167           DFHEIV99,
 19168           DFHEIV99
 19169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19170
 19171
 19172     GO TO 8100-EXIT.
 19173
 19174 8100-NOTFND.
 19175
 19176     MOVE 'X'                    TO ERPNDM-FOUND.
 19177     MOVE ER-2694                TO WS-ERROR.
 19178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19179     MOVE ER-2883                TO WS-ERROR
 19180     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19181     .
 19182 8100-EXIT.
 19183     EXIT.
 19184
 19185 8110-READ-ERMAIL.
 19186
 19187* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 353
* EL050.cbl
 19188*         NOTFND     (8110-NOTFND)
 19189*         ENDFILE    (8110-NOTFND)
 19190*    END-EXEC.
 19191*    MOVE '"$I''                  ! - #00018564' TO DFHEIV0
 19192     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19194     MOVE X'2D20233030303138353634' TO DFHEIV0(25:11)
 19195     CALL 'kxdfhei1' USING DFHEIV0
 19196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19197
 19198
 19199     MOVE SPACES                 TO ERMAIL-FOUND.
 19200     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19201     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19202     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19203     MOVE PB-SV-STATE            TO MA-STATE.
 19204
 19205
 19206* EXEC CICS READ
 19207*         UPDATE
 19208*         DATASET   (FILE-ERMAIL)
 19209*         RIDFLD    (MA-CONTROL-PRIMARY)
 19210*         INTO      (MAILING-DATA)
 19211*    END-EXEC.
 19212     MOVE LENGTH OF
 19213      MAILING-DATA
 19214       TO DFHEIV11
 19215*    MOVE '&"IL       EU         (   #00018575' TO DFHEIV0
 19216     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19217     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19218     MOVE X'2020233030303138353735' TO DFHEIV0(25:11)
 19219     CALL 'kxdfhei1' USING DFHEIV0,
 19220           FILE-ERMAIL,
 19221           MAILING-DATA,
 19222           DFHEIV11,
 19223           MA-CONTROL-PRIMARY,
 19224           DFHEIV99,
 19225           DFHEIV99,
 19226           DFHEIV99
 19227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19228
 19229
 19230     GO TO 8110-EXIT.
 19231
 19232 8110-NOTFND.
 19233     MOVE 'X'                    TO ERMAIL-FOUND.
 19234
 19235 8110-EXIT.
 19236     EXIT.
 19237
 19238 8120-REWRITE-ERMAIL.
 19239
 19240* EXEC CICS REWRITE
 19241*         DATASET    (FILE-ERMAIL)
 19242*         FROM       (MAILING-DATA)
 19243*    END-EXEC.
 19244     MOVE LENGTH OF
 19245      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 354
* EL050.cbl
 19246       TO DFHEIV11
 19247*    MOVE '&& L                  %   #00018591' TO DFHEIV0
 19248     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19249     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19250     MOVE X'2020233030303138353931' TO DFHEIV0(25:11)
 19251     CALL 'kxdfhei1' USING DFHEIV0,
 19252           FILE-ERMAIL,
 19253           MAILING-DATA,
 19254           DFHEIV11,
 19255           DFHEIV99
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259 8120-EXIT.
 19260     EXIT.
 19261
 19262 8130-WRITE-ERMAIL.
 19263
 19264* EXEC CICS HANDLE CONDITION
 19265*         DUPKEY   (8130-EXIT)
 19266*    END-EXEC.
 19267*    MOVE '"$$                   ! . #00018600' TO DFHEIV0
 19268     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19269     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19270     MOVE X'2E20233030303138363030' TO DFHEIV0(25:11)
 19271     CALL 'kxdfhei1' USING DFHEIV0
 19272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19273
 19274
 19275
 19276* EXEC CICS WRITE
 19277*         DATASET     (FILE-ERMAIL)
 19278*         RIDFLD      (MA-CONTROL-PRIMARY)
 19279*         FROM        (MAILING-DATA)
 19280*    END-EXEC.
 19281     MOVE LENGTH OF
 19282      MAILING-DATA
 19283       TO DFHEIV11
 19284*    MOVE '&$ L                  ''   #00018604' TO DFHEIV0
 19285     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19286     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19287     MOVE X'2020233030303138363034' TO DFHEIV0(25:11)
 19288     CALL 'kxdfhei1' USING DFHEIV0,
 19289           FILE-ERMAIL,
 19290           MAILING-DATA,
 19291           DFHEIV11,
 19292           MA-CONTROL-PRIMARY,
 19293           DFHEIV99,
 19294           DFHEIV99
 19295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19296
 19297
 19298 8130-EXIT.
 19299     EXIT.
 19300
 19301 8140-UNLOCK-ERMAIL.
 19302
 19303* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 355
* EL050.cbl
 19304*         DATASET   (FILE-ERMAIL)
 19305*    END-EXEC.
 19306*    MOVE '&*                    #   #00018614' TO DFHEIV0
 19307     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19308     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19309     MOVE X'2020233030303138363134' TO DFHEIV0(25:11)
 19310     CALL 'kxdfhei1' USING DFHEIV0,
 19311           FILE-ERMAIL,
 19312           DFHEIV99
 19313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19314
 19315
 19316 8140-EXIT.
 19317     EXIT.
 19318
 19319 8180-UPDATE-VIN-NUMBER.
 19320
 19321* EXEC CICS HANDLE CONDITION
 19322*        NOTFND   (8180-NOTFND)
 19323*    END-EXEC.
 19324*    MOVE '"$I                   ! / #00018622' TO DFHEIV0
 19325     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19327     MOVE X'2F20233030303138363232' TO DFHEIV0(25:11)
 19328     CALL 'kxdfhei1' USING DFHEIV0
 19329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19330
 19331
 19332     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19333     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19334
 19335
 19336* EXEC CICS READ
 19337*        UPDATE
 19338*        DATASET  (CRTT-ID)
 19339*        RIDFLD   (WS-ELCRTT-KEY)
 19340*        INTO     (CERTIFICATE-TRAILERS)
 19341*    END-EXEC.
 19342     MOVE LENGTH OF
 19343      CERTIFICATE-TRAILERS
 19344       TO DFHEIV11
 19345*    MOVE '&"IL       EU         (   #00018629' TO DFHEIV0
 19346     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19347     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19348     MOVE X'2020233030303138363239' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0,
 19350           CRTT-ID,
 19351           CERTIFICATE-TRAILERS,
 19352           DFHEIV11,
 19353           WS-ELCRTT-KEY,
 19354           DFHEIV99,
 19355           DFHEIV99,
 19356           DFHEIV99
 19357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19358
 19359
 19360     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19361         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 356
* EL050.cbl
 19362
 19363* EXEC CICS REWRITE
 19364*           DATASET  (CRTT-ID)
 19365*           FROM     (CERTIFICATE-TRAILERS)
 19366*        END-EXEC
 19367     MOVE LENGTH OF
 19368      CERTIFICATE-TRAILERS
 19369       TO DFHEIV11
 19370*    MOVE '&& L                  %   #00018638' TO DFHEIV0
 19371     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19372     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19373     MOVE X'2020233030303138363338' TO DFHEIV0(25:11)
 19374     CALL 'kxdfhei1' USING DFHEIV0,
 19375           CRTT-ID,
 19376           CERTIFICATE-TRAILERS,
 19377           DFHEIV11,
 19378           DFHEIV99
 19379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19380     ELSE
 19381
 19382* EXEC CICS UNLOCK
 19383*          DATASET  (CRTT-ID)
 19384*       END-EXEC
 19385*    MOVE '&*                    #   #00018643' TO DFHEIV0
 19386     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19387     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19388     MOVE X'2020233030303138363433' TO DFHEIV0(25:11)
 19389     CALL 'kxdfhei1' USING DFHEIV0,
 19390           CRTT-ID,
 19391           DFHEIV99
 19392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19393     END-IF.
 19394
 19395     GO TO 8180-EXIT.
 19396
 19397 8180-NOTFND.
 19398
 19399     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19400     MOVE 'CS'         TO CS-RECORD-ID.
 19401     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19402     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19403     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19404     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19405
 19406* EXEC CICS WRITE
 19407*       DATASET  (CRTT-ID)
 19408*       RIDFLD   (WS-ELCRTT-KEY)
 19409*       FROM     (CERTIFICATE-TRAILERS)
 19410*    END-EXEC.
 19411     MOVE LENGTH OF
 19412      CERTIFICATE-TRAILERS
 19413       TO DFHEIV11
 19414*    MOVE '&$ L                  ''   #00018658' TO DFHEIV0
 19415     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19416     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19417     MOVE X'2020233030303138363538' TO DFHEIV0(25:11)
 19418     CALL 'kxdfhei1' USING DFHEIV0,
 19419           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 357
* EL050.cbl
 19420           CERTIFICATE-TRAILERS,
 19421           DFHEIV11,
 19422           WS-ELCRTT-KEY,
 19423           DFHEIV99,
 19424           DFHEIV99
 19425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19426
 19427
 19428 8180-EXIT.
 19429     EXIT.
 19430
 19431 8190-UPDATE-REFUND-CLAIM-FLAG.
 19432
 19433* EXEC CICS HANDLE CONDITION
 19434*        NOTFND   (8190-NOTFND)
 19435*    END-EXEC.
 19436*    MOVE '"$I                   ! 0 #00018668' TO DFHEIV0
 19437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19439     MOVE X'3020233030303138363638' TO DFHEIV0(25:11)
 19440     CALL 'kxdfhei1' USING DFHEIV0
 19441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19442
 19443
 19444     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19445     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19446
 19447
 19448* EXEC CICS READ
 19449*        UPDATE
 19450*        DATASET  (CRTT-ID)
 19451*        RIDFLD   (WS-ELCRTT-KEY)
 19452*        INTO     (CERTIFICATE-TRAILERS)
 19453*    END-EXEC.
 19454     MOVE LENGTH OF
 19455      CERTIFICATE-TRAILERS
 19456       TO DFHEIV11
 19457*    MOVE '&"IL       EU         (   #00018675' TO DFHEIV0
 19458     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19459     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19460     MOVE X'2020233030303138363735' TO DFHEIV0(25:11)
 19461     CALL 'kxdfhei1' USING DFHEIV0,
 19462           CRTT-ID,
 19463           CERTIFICATE-TRAILERS,
 19464           DFHEIV11,
 19465           WS-ELCRTT-KEY,
 19466           DFHEIV99,
 19467           DFHEIV99,
 19468           DFHEIV99
 19469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19470
 19471
 19472     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19473
 19474* EXEC CICS REWRITE
 19475*       DATASET  (CRTT-ID)
 19476*       FROM     (CERTIFICATE-TRAILERS)
 19477*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 358
* EL050.cbl
 19478     MOVE LENGTH OF
 19479      CERTIFICATE-TRAILERS
 19480       TO DFHEIV11
 19481*    MOVE '&& L                  %   #00018683' TO DFHEIV0
 19482     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19483     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19484     MOVE X'2020233030303138363833' TO DFHEIV0(25:11)
 19485     CALL 'kxdfhei1' USING DFHEIV0,
 19486           CRTT-ID,
 19487           CERTIFICATE-TRAILERS,
 19488           DFHEIV11,
 19489           DFHEIV99
 19490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19491
 19492
 19493     GO TO 8190-EXIT.
 19494
 19495 8190-NOTFND.
 19496
 19497     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19498     MOVE 'CS'         TO CS-RECORD-ID.
 19499     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19500     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19501     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19502     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19503
 19504* EXEC CICS WRITE
 19505*       DATASET  (CRTT-ID)
 19506*       RIDFLD   (WS-ELCRTT-KEY)
 19507*       FROM     (CERTIFICATE-TRAILERS)
 19508*    END-EXEC.
 19509     MOVE LENGTH OF
 19510      CERTIFICATE-TRAILERS
 19511       TO DFHEIV11
 19512*    MOVE '&$ L                  ''   #00018698' TO DFHEIV0
 19513     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19514     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19515     MOVE X'2020233030303138363938' TO DFHEIV0(25:11)
 19516     CALL 'kxdfhei1' USING DFHEIV0,
 19517           CRTT-ID,
 19518           CERTIFICATE-TRAILERS,
 19519           DFHEIV11,
 19520           WS-ELCRTT-KEY,
 19521           DFHEIV99,
 19522           DFHEIV99
 19523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19524
 19525
 19526 8190-EXIT.
 19527     EXIT.
 19528
 19529 8200-READ-REIN-TABLE.
 19530
 19531* EXEC CICS HANDLE CONDITION
 19532*         NOTFND   (8200-NOTFND)
 19533*    END-EXEC.
 19534*    MOVE '"$I                   ! 1 #00018708' TO DFHEIV0
 19535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 359
* EL050.cbl
 19536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19537     MOVE X'3120233030303138373038' TO DFHEIV0(25:11)
 19538     CALL 'kxdfhei1' USING DFHEIV0
 19539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19540
 19541
 19542
 19543* EXEC CICS READ
 19544*        DATASET     (REIN-ID)
 19545*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19546*        RIDFLD      (ERREIN-KEY)
 19547*    END-EXEC.
 19548*    MOVE '&"S        E          (   #00018712' TO DFHEIV0
 19549     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19550     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19551     MOVE X'2020233030303138373132' TO DFHEIV0(25:11)
 19552     CALL 'kxdfhei1' USING DFHEIV0,
 19553           REIN-ID,
 19554           DFHEIV20,
 19555           DFHEIV99,
 19556           ERREIN-KEY,
 19557           DFHEIV99,
 19558           DFHEIV99,
 19559           DFHEIV99
 19560     SET ADDRESS OF REINSURANCE-RECORD TO
 19561         DFHEIV20
 19562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19563
 19564
 19565     GO TO 8200-EXIT.
 19566
 19567 8200-NOTFND.
 19568     MOVE 'N'             TO WS-REIN-READ-SW.
 19569
 19570 8200-EXIT.
 19571      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 360
* EL050.cbl
 19573
 19574 8300-READ-CTBL-TABLE.
 19575
 19576* EXEC CICS HANDLE CONDITION
 19577*        NOTFND    (8300-NOTFND)
 19578*        DISABLED  (8300-ERRESS-PROBLEM)
 19579*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19580*        ENDFILE   (8300-NOTFND)
 19581*    END-EXEC.
 19582*    MOVE '"$IcJ''                ! 2 #00018728' TO DFHEIV0
 19583     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19585     MOVE X'3220233030303138373238' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0
 19587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19588
 19589
 19590
 19591* EXEC CICS READ
 19592*        DATASET     (CTBL-ID)
 19593*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19594*        RIDFLD      (ERCTBL-KEY)
 19595*    END-EXEC.
 19596*    MOVE '&"S        E          (   #00018735' TO DFHEIV0
 19597     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19599     MOVE X'2020233030303138373335' TO DFHEIV0(25:11)
 19600     CALL 'kxdfhei1' USING DFHEIV0,
 19601           CTBL-ID,
 19602           DFHEIV20,
 19603           DFHEIV99,
 19604           ERCTBL-KEY,
 19605           DFHEIV99,
 19606           DFHEIV99,
 19607           DFHEIV99
 19608     SET ADDRESS OF COMM-TABLE-RECORD TO
 19609         DFHEIV20
 19610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19611
 19612
 19613     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19614
 19615     GO TO 8300-EXIT.
 19616
 19617 8300-NOTFND.
 19618
 19619     IF CTBL-SW = '0530'
 19620         MOVE 'AA'                     TO WS-AH-COMP-CD
 19621         MOVE '0550'                   TO CTBL-SW
 19622         MOVE '1'                      TO WS-CTBL-READ-SW
 19623         GO TO 8300-EXIT.
 19624
 19625     IF CTBL-SW = '0540'
 19626         MOVE 'AA'                     TO WS-LF-COMP-CD
 19627         MOVE '0550'                   TO CTBL-SW
 19628         MOVE '1'                      TO WS-CTBL-READ-SW
 19629         GO TO 8300-EXIT.
 19630
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 361
* EL050.cbl
 19631     IF CTBL-SW = '0550'
 19632         MOVE '2'                      TO WS-CTBL-READ-SW
 19633         GO TO 8300-EXIT.
 19634
 19635     GO TO 8300-EXIT.
 19636
 19637 8300-ERRESS-PROBLEM.
 19638
 19639      MOVE ER-8050              TO WS-ERROR.
 19640      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19641
 19642     GO TO 8300-EXIT.
 19643
 19644 8300-EXIT.
 19645      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 362
* EL050.cbl
 19647
 19648
 19649 8400-GETMAIN-ERFORM.
 19650
 19651
 19652* EXEC CICS   GETMAIN
 19653*        LENGTH  (500)
 19654*        SET     (ADDRESS OF FORM-MASTER)
 19655*    END-EXEC.
 19656     MOVE 500
 19657       TO DFHEIV11
 19658*    MOVE '," L                  $   #00018779' TO DFHEIV0
 19659     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19660     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19661     MOVE X'2020233030303138373739' TO DFHEIV0(25:11)
 19662     CALL 'kxdfhei1' USING DFHEIV0,
 19663           DFHEIV20,
 19664           DFHEIV11,
 19665           DFHEIV99
 19666     SET ADDRESS OF FORM-MASTER TO
 19667         DFHEIV20
 19668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19669
 19670
 19671     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19672
 19673 8400-EXIT.
 19674      EXIT.
 19675
 19676 8450-READ-FORM-MASTER.
 19677
 19678
 19679* EXEC CICS  HANDLE CONDITION
 19680*        NOTFND   (8450-FORM-NOT-FOUND)
 19681*        ENDFILE  (8450-FORM-NOT-FOUND)
 19682*    END-EXEC.
 19683*    MOVE '"$I''                  ! 3 #00018791' TO DFHEIV0
 19684     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19686     MOVE X'3320233030303138373931' TO DFHEIV0(25:11)
 19687     CALL 'kxdfhei1' USING DFHEIV0
 19688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19689
 19690
 19691
 19692* EXEC CICS   READ
 19693*        DATASET   (FORM-ID)
 19694*        RIDFLD    (ERFORM-KEY)
 19695*        INTO      (FORM-MASTER)
 19696*        GTEQ
 19697*    END-EXEC.
 19698     MOVE LENGTH OF
 19699      FORM-MASTER
 19700       TO DFHEIV11
 19701*    MOVE '&"IL       G          (   #00018796' TO DFHEIV0
 19702     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19704     MOVE X'2020233030303138373936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 363
* EL050.cbl
 19705     CALL 'kxdfhei1' USING DFHEIV0,
 19706           FORM-ID,
 19707           FORM-MASTER,
 19708           DFHEIV11,
 19709           ERFORM-KEY,
 19710           DFHEIV99,
 19711           DFHEIV99,
 19712           DFHEIV99
 19713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19714
 19715
 19716     MOVE  'Y'           TO  FORM-MASTER-SW.
 19717
 19718     GO TO  8450-EXIT.
 19719
 19720 8450-FORM-NOT-FOUND.
 19721
 19722     MOVE  'N'           TO  FORM-MASTER-SW.
 19723
 19724 8450-EXIT.
 19725      EXIT.
 19726
 19727 8500-DATE-CONVERT.
 19728
 19729* EXEC CICS LINK
 19730*        PROGRAM    ('ELDATCV')
 19731*        COMMAREA   (DATE-CONVERSION-DATA)
 19732*        LENGTH     (DC-COMM-LENGTH)
 19733*    END-EXEC.
 19734     MOVE 'ELDATCV' TO DFHEIV1
 19735*    MOVE '."C                   ''   #00018815' TO DFHEIV0
 19736     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19738     MOVE X'2020233030303138383135' TO DFHEIV0(25:11)
 19739     CALL 'kxdfhei1' USING DFHEIV0,
 19740           DFHEIV1,
 19741           DATE-CONVERSION-DATA,
 19742           DC-COMM-LENGTH,
 19743           DFHEIV99,
 19744           DFHEIV99,
 19745           DFHEIV99
 19746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19747
 19748
 19749 8500-EXIT.
 19750     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 364
* EL050.cbl
 19752
 19753 8555-RELOAD-CONTROL-FILE.
 19754     CONTINUE.
 19755
 19756 8555-EXIT.
 19757     EXIT.
 19758
 19759 8557-GETMAIN-ERPLAN.
 19760
 19761
 19762* EXEC CICS GETMAIN
 19763*        LENGTH    (840)
 19764*        SET       (ADDRESS OF PLAN-RECORDS)
 19765*    END-EXEC.
 19766     MOVE 840
 19767       TO DFHEIV11
 19768*    MOVE '," L                  $   #00018833' TO DFHEIV0
 19769     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19770     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19771     MOVE X'2020233030303138383333' TO DFHEIV0(25:11)
 19772     CALL 'kxdfhei1' USING DFHEIV0,
 19773           DFHEIV20,
 19774           DFHEIV11,
 19775           DFHEIV99
 19776     SET ADDRESS OF PLAN-RECORDS TO
 19777         DFHEIV20
 19778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19779
 19780
 19781     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19782
 19783 8557-EXIT.
 19784     EXIT.
 19785
 19786 8560-GETMAIN.
 19787
 19788* EXEC CICS GETMAIN
 19789*        LENGTH    (2000)
 19790*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19791*    END-EXEC.
 19792     MOVE 2000
 19793       TO DFHEIV11
 19794*    MOVE '," L                  $   #00018844' TO DFHEIV0
 19795     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19796     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19797     MOVE X'2020233030303138383434' TO DFHEIV0(25:11)
 19798     CALL 'kxdfhei1' USING DFHEIV0,
 19799           DFHEIV20,
 19800           DFHEIV11,
 19801           DFHEIV99
 19802     SET ADDRESS OF ACCOUNT-MASTER TO
 19803         DFHEIV20
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
 19807     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19808
 19809 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 365
* EL050.cbl
 19810     EXIT.
 19811
 19812 8570-START-ACCOUNT-MASTER.
 19813
 19814* EXEC CICS HANDLE CONDITION
 19815*        NOTFND    (0199-ACCT-NOT-FOUND)
 19816*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19817*    END-EXEC.
 19818*    MOVE '"$I''                  ! 4 #00018855' TO DFHEIV0
 19819     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19821     MOVE X'3420233030303138383535' TO DFHEIV0(25:11)
 19822     CALL 'kxdfhei1' USING DFHEIV0
 19823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19824
 19825
 19826
 19827* EXEC CICS STARTBR
 19828*        DATASET    (ACCT-ID)
 19829*        RIDFLD     (ERACCT-KEY)
 19830*        GTEQ
 19831*    END-EXEC.
 19832     MOVE 0
 19833       TO DFHEIV11
 19834*    MOVE '&,         G          &   #00018860' TO DFHEIV0
 19835     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19836     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19837     MOVE X'2020233030303138383630' TO DFHEIV0(25:11)
 19838     CALL 'kxdfhei1' USING DFHEIV0,
 19839           ACCT-ID,
 19840           ERACCT-KEY,
 19841           DFHEIV99,
 19842           DFHEIV11,
 19843           DFHEIV99
 19844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19845
 19846
 19847 8570-EXIT.
 19848     EXIT.
 19849
 19850 8580-READ-ACCOUNT-MASTER.
 19851
 19852* EXEC CICS HANDLE CONDITION
 19853*        NOTFND    (0199-ACCT-NOT-FOUND)
 19854*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19855*    END-EXEC.
 19856*    MOVE '"$I''                  ! 5 #00018870' TO DFHEIV0
 19857     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19859     MOVE X'3520233030303138383730' TO DFHEIV0(25:11)
 19860     CALL 'kxdfhei1' USING DFHEIV0
 19861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19862
 19863
 19864
 19865* EXEC CICS READNEXT
 19866*        DATASET     (ACCT-ID)
 19867*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 366
* EL050.cbl
 19868*        RIDFLD      (ERACCT-KEY)
 19869*    END-EXEC.
 19870     MOVE LENGTH OF
 19871      ACCOUNT-MASTER
 19872       TO DFHEIV12
 19873     MOVE 0
 19874       TO DFHEIV11
 19875*    MOVE '&.IL                  )   #00018875' TO DFHEIV0
 19876     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19877     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19878     MOVE X'2020233030303138383735' TO DFHEIV0(25:11)
 19879     CALL 'kxdfhei1' USING DFHEIV0,
 19880           ACCT-ID,
 19881           ACCOUNT-MASTER,
 19882           DFHEIV12,
 19883           ERACCT-KEY,
 19884           DFHEIV99,
 19885           DFHEIV11,
 19886           DFHEIV99,
 19887           DFHEIV99
 19888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19889
 19890
 19891 8580-EXIT.
 19892     EXIT.
 19893
 19894 8582-READ-COMPENSATION-MASTER.
 19895
 19896* EXEC CICS HANDLE CONDITION
 19897*        NOTFND    (8582-COMP-NOT-FOUND)
 19898*        ENDFILE   (8582-COMP-NOT-FOUND)
 19899*    END-EXEC.
 19900*    MOVE '"$I''                  ! 6 #00018885' TO DFHEIV0
 19901     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19903     MOVE X'3620233030303138383835' TO DFHEIV0(25:11)
 19904     CALL 'kxdfhei1' USING DFHEIV0
 19905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19906
 19907
 19908
 19909* EXEC CICS READ
 19910*        DATASET     (COMP-ID)
 19911*        INTO        (COMPENSATION-MASTER)
 19912*        RIDFLD      (ERCOMP-KEY)
 19913*    END-EXEC.
 19914     MOVE LENGTH OF
 19915      COMPENSATION-MASTER
 19916       TO DFHEIV11
 19917*    MOVE '&"IL       E          (   #00018890' TO DFHEIV0
 19918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19920     MOVE X'2020233030303138383930' TO DFHEIV0(25:11)
 19921     CALL 'kxdfhei1' USING DFHEIV0,
 19922           COMP-ID,
 19923           COMPENSATION-MASTER,
 19924           DFHEIV11,
 19925           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 367
* EL050.cbl
 19926           DFHEIV99,
 19927           DFHEIV99,
 19928           DFHEIV99
 19929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19930
 19931
 19932     MOVE 'Y'                    TO COMP-MASTER-SW
 19933
 19934     GO TO 8582-EXIT
 19935     .
 19936 8582-COMP-NOT-FOUND.
 19937
 19938     MOVE 'N'                    TO COMP-MASTER-SW.
 19939
 19940 8582-EXIT.
 19941     EXIT.
 19942
 19943 8583-READ-ERAGTC.
 19944
 19945* EXEC CICS HANDLE CONDITION
 19946*        NOTFND    (8583-AGTC-NOT-FOUND)
 19947*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19948*    END-EXEC.
 19949*    MOVE '"$I''                  ! 7 #00018908' TO DFHEIV0
 19950     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19952     MOVE X'3720233030303138393038' TO DFHEIV0(25:11)
 19953     CALL 'kxdfhei1' USING DFHEIV0
 19954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19955
 19956
 19957
 19958* EXEC CICS STARTBR
 19959*        DATASET    (AGTC-ID)
 19960*        RIDFLD     (ERAGTC-KEY)
 19961*        GTEQ
 19962*    END-EXEC.
 19963     MOVE 0
 19964       TO DFHEIV11
 19965*    MOVE '&,         G          &   #00018913' TO DFHEIV0
 19966     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19967     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19968     MOVE X'2020233030303138393133' TO DFHEIV0(25:11)
 19969     CALL 'kxdfhei1' USING DFHEIV0,
 19970           AGTC-ID,
 19971           ERAGTC-KEY,
 19972           DFHEIV99,
 19973           DFHEIV11,
 19974           DFHEIV99
 19975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19976
 19977
 19978 8583-READ-ERAGTC-NEXT.
 19979
 19980* EXEC CICS READNEXT
 19981*        DATASET     (AGTC-ID)
 19982*        INTO        (AGENT-COMMISSIONS)
 19983*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 368
* EL050.cbl
 19984*    END-EXEC.
 19985     MOVE LENGTH OF
 19986      AGENT-COMMISSIONS
 19987       TO DFHEIV12
 19988     MOVE 0
 19989       TO DFHEIV11
 19990*    MOVE '&.IL                  )   #00018920' TO DFHEIV0
 19991     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19992     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19993     MOVE X'2020233030303138393230' TO DFHEIV0(25:11)
 19994     CALL 'kxdfhei1' USING DFHEIV0,
 19995           AGTC-ID,
 19996           AGENT-COMMISSIONS,
 19997           DFHEIV12,
 19998           ERAGTC-KEY,
 19999           DFHEIV99,
 20000           DFHEIV11,
 20001           DFHEIV99,
 20002           DFHEIV99
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20007
 20008     GO TO 8583-EXIT
 20009     .
 20010 8583-AGTC-NOT-FOUND.
 20011
 20012     MOVE 'N'                    TO AGTC-MASTER-SW.
 20013
 20014 8583-EXIT.
 20015     EXIT.
 20016
 20017 8584-READ-BANK-CROSS-REF.
 20018
 20019* EXEC CICS HANDLE CONDITION
 20020*        NOTFND    (8584-BXRF-NOT-FOUND)
 20021*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20022*    END-EXEC.
 20023*    MOVE '"$I''                  ! 8 #00018938' TO DFHEIV0
 20024     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20026     MOVE X'3820233030303138393338' TO DFHEIV0(25:11)
 20027     CALL 'kxdfhei1' USING DFHEIV0
 20028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20029
 20030
 20031
 20032* EXEC CICS READ
 20033*        DATASET     (BXRF-ID)
 20034*        INTO        (BANK-CROSS-REFERENCE)
 20035*        RIDFLD      (ERBXRF-KEY)
 20036*        LENGTH      (BXRF-REC-LENGTH)
 20037*    END-EXEC.
 20038*    MOVE '&"IL       E          (   #00018943' TO DFHEIV0
 20039     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20041     MOVE X'2020233030303138393433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 369
* EL050.cbl
 20042     CALL 'kxdfhei1' USING DFHEIV0,
 20043           BXRF-ID,
 20044           BANK-CROSS-REFERENCE,
 20045           BXRF-REC-LENGTH,
 20046           ERBXRF-KEY,
 20047           DFHEIV99,
 20048           DFHEIV99,
 20049           DFHEIV99
 20050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20051
 20052
 20053     MOVE 'Y'                    TO BXRF-MASTER-SW
 20054
 20055     GO TO 8584-EXIT
 20056     .
 20057 8584-BXRF-NOT-FOUND.
 20058
 20059     MOVE 'N'                    TO BXRF-MASTER-SW.
 20060
 20061 8584-EXIT.
 20062     EXIT.
 20063
 20064 8585-READ-PLAN-MASTER.
 20065
 20066
 20067* EXEC CICS HANDLE CONDITION
 20068*        NOTFND    (8585-PLAN-NOT-FOUND)
 20069*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20070*    END-EXEC.
 20071*    MOVE '"$I''                  ! 9 #00018963' TO DFHEIV0
 20072     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20074     MOVE X'3920233030303138393633' TO DFHEIV0(25:11)
 20075     CALL 'kxdfhei1' USING DFHEIV0
 20076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20077
 20078
 20079
 20080* EXEC CICS READ
 20081*        DATASET     (PLAN-ID)
 20082*        INTO        (PLAN-MASTER)
 20083*        RIDFLD      (ERPLAN-KEY)
 20084*    END-EXEC.
 20085     MOVE LENGTH OF
 20086      PLAN-MASTER
 20087       TO DFHEIV11
 20088*    MOVE '&"IL       E          (   #00018968' TO DFHEIV0
 20089     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20091     MOVE X'2020233030303138393638' TO DFHEIV0(25:11)
 20092     CALL 'kxdfhei1' USING DFHEIV0,
 20093           PLAN-ID,
 20094           PLAN-MASTER,
 20095           DFHEIV11,
 20096           ERPLAN-KEY,
 20097           DFHEIV99,
 20098           DFHEIV99,
 20099           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 370
* EL050.cbl
 20100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20101
 20102
 20103     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20104
 20105     GO TO 8585-EXIT.
 20106
 20107 8585-PLAN-NOT-FOUND.
 20108
 20109     MOVE 'N'                    TO PLAN-MASTER-SW.
 20110
 20111 8585-EXIT.
 20112     EXIT.
 20113
 20114 8586-READ-LOAN-OFFICER.
 20115
 20116* EXEC CICS READ
 20117*        DATASET     (LOFC-ID)
 20118*        INTO        (LOAN-OFFICER-MASTER)
 20119*        RIDFLD      (ERLOFC-KEY)
 20120*        RESP        (WS-RESPONSE)
 20121*    END-EXEC
 20122     MOVE LENGTH OF
 20123      LOAN-OFFICER-MASTER
 20124       TO DFHEIV11
 20125*    MOVE '&"IL       E          (  N#00018986' TO DFHEIV0
 20126     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20128     MOVE X'204E233030303138393836' TO DFHEIV0(25:11)
 20129     CALL 'kxdfhei1' USING DFHEIV0,
 20130           LOFC-ID,
 20131           LOAN-OFFICER-MASTER,
 20132           DFHEIV11,
 20133           ERLOFC-KEY,
 20134           DFHEIV99,
 20135           DFHEIV99,
 20136           DFHEIV99
 20137     MOVE EIBRESP  TO WS-RESPONSE
 20138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20139
 20140     IF WS-RESP-NORMAL
 20141        MOVE 'Y'                 TO LOFC-MASTER-SW
 20142     ELSE
 20143        MOVE 'N'                 TO LOFC-MASTER-SW
 20144     END-IF
 20145     .
 20146 8586-EXIT.
 20147     EXIT.
 20148 8587-START-ERPDEF.
 20149
 20150* EXEC CICS STARTBR
 20151*       DATASET   (PDEF-ID)
 20152*       RIDFLD    (ERPDEF-KEY)
 20153*       GTEQ
 20154*       RESP      (WS-RESPONSE)
 20155*    END-EXEC
 20156     MOVE 0
 20157       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 371
* EL050.cbl
 20158*    MOVE '&,         G          &  N#00019002' TO DFHEIV0
 20159     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20161     MOVE X'204E233030303139303032' TO DFHEIV0(25:11)
 20162     CALL 'kxdfhei1' USING DFHEIV0,
 20163           PDEF-ID,
 20164           ERPDEF-KEY,
 20165           DFHEIV99,
 20166           DFHEIV11,
 20167           DFHEIV99
 20168     MOVE EIBRESP  TO WS-RESPONSE
 20169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20170     IF WS-RESP-NORMAL
 20171        MOVE 'Y'                 TO PDEF-MASTER-SW
 20172     ELSE
 20173        MOVE 'N'                 TO PDEF-MASTER-SW
 20174     END-IF
 20175     .
 20176 8587-EXIT.
 20177     EXIT.
 20178 8588-READ-ERPDEF.
 20179
 20180* EXEC CICS READNEXT
 20181*       DATASET   (PDEF-ID)
 20182*       RIDFLD    (ERPDEF-KEY)
 20183*       INTO      (PRODUCT-MASTER)
 20184*       RESP      (WS-RESPONSE)
 20185*    END-EXEC
 20186     MOVE LENGTH OF
 20187      PRODUCT-MASTER
 20188       TO DFHEIV12
 20189     MOVE 0
 20190       TO DFHEIV11
 20191*    MOVE '&.IL                  )  N#00019017' TO DFHEIV0
 20192     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20193     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20194     MOVE X'204E233030303139303137' TO DFHEIV0(25:11)
 20195     CALL 'kxdfhei1' USING DFHEIV0,
 20196           PDEF-ID,
 20197           PRODUCT-MASTER,
 20198           DFHEIV12,
 20199           ERPDEF-KEY,
 20200           DFHEIV99,
 20201           DFHEIV11,
 20202           DFHEIV99,
 20203           DFHEIV99
 20204     MOVE EIBRESP  TO WS-RESPONSE
 20205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20206     IF WS-RESP-NORMAL
 20207        MOVE 'Y'                 TO PDEF-MASTER-SW
 20208     ELSE
 20209        MOVE 'N'                 TO PDEF-MASTER-SW
 20210     END-IF
 20211     .
 20212 8588-EXIT.
 20213     EXIT.
 20214 8589-ENDBR-ERPDEF.
 20215
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 372
* EL050.cbl
 20216* EXEC CICS ENDBR
 20217*       DATASET   (PDEF-ID)
 20218*    END-EXEC
 20219     MOVE 0
 20220       TO DFHEIV11
 20221*    MOVE '&2                    $   #00019032' TO DFHEIV0
 20222     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20223     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20224     MOVE X'2020233030303139303332' TO DFHEIV0(25:11)
 20225     CALL 'kxdfhei1' USING DFHEIV0,
 20226           PDEF-ID,
 20227           DFHEIV11,
 20228           DFHEIV99
 20229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20230     .
 20231 8589-EXIT.
 20232     EXIT.
 20233 8590-READ-CERT-MASTER.
 20234     IF PB-COMPANY-ID = 'UCL'
 20235         GO TO 8690-READ-CERT-MASTER-UCL.
 20236
 20237
 20238* EXEC CICS HANDLE CONDITION
 20239*         NOTFND    (0299-CERT-NOT-FOUND)
 20240*    END-EXEC.
 20241*    MOVE '"$I                   ! : #00019042' TO DFHEIV0
 20242     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20244     MOVE X'3A20233030303139303432' TO DFHEIV0(25:11)
 20245     CALL 'kxdfhei1' USING DFHEIV0
 20246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20247
 20248
 20249
 20250* EXEC CICS READ
 20251*        DATASET     (CERT-ID)
 20252*        INTO        (CERTIFICATE-MASTER)
 20253*        RIDFLD      (ELCERT-KEY)
 20254*        UPDATE
 20255*    END-EXEC.
 20256     MOVE LENGTH OF
 20257      CERTIFICATE-MASTER
 20258       TO DFHEIV11
 20259*    MOVE '&"IL       EU         (   #00019046' TO DFHEIV0
 20260     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20261     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20262     MOVE X'2020233030303139303436' TO DFHEIV0(25:11)
 20263     CALL 'kxdfhei1' USING DFHEIV0,
 20264           CERT-ID,
 20265           CERTIFICATE-MASTER,
 20266           DFHEIV11,
 20267           ELCERT-KEY,
 20268           DFHEIV99,
 20269           DFHEIV99,
 20270           DFHEIV99
 20271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20272
 20273
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 373
* EL050.cbl
 20274 8590-EXIT.
 20275     EXIT.
 20276
 20277 8690-READ-CERT-MASTER-UCL.
 20278
 20279* EXEC CICS HANDLE CONDITION
 20280*         NOTFND    (8700-READ-CERT-MASTER)
 20281*    END-EXEC.
 20282*    MOVE '"$I                   ! ; #00019057' TO DFHEIV0
 20283     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20285     MOVE X'3B20233030303139303537' TO DFHEIV0(25:11)
 20286     CALL 'kxdfhei1' USING DFHEIV0
 20287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20288
 20289
 20290 8690-READ-CERT-CONT.
 20291
 20292* EXEC CICS READ
 20293*        DATASET     (CERT-ID)
 20294*        INTO        (CERTIFICATE-MASTER)
 20295*        RIDFLD      (ELCERT-KEY)
 20296*        UPDATE
 20297*    END-EXEC.
 20298     MOVE LENGTH OF
 20299      CERTIFICATE-MASTER
 20300       TO DFHEIV11
 20301*    MOVE '&"IL       EU         (   #00019062' TO DFHEIV0
 20302     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20303     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20304     MOVE X'2020233030303139303632' TO DFHEIV0(25:11)
 20305     CALL 'kxdfhei1' USING DFHEIV0,
 20306           CERT-ID,
 20307           CERTIFICATE-MASTER,
 20308           DFHEIV11,
 20309           ELCERT-KEY,
 20310           DFHEIV99,
 20311           DFHEIV99,
 20312           DFHEIV99
 20313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20314
 20315
 20316     GO TO 8590-EXIT.
 20317
 20318 8700-READ-CERT-MASTER.
 20319     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20320     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20321
 20322* EXEC CICS HANDLE CONDITION
 20323*         DUPKEY    (8720-COMP-ACCOUNTS)
 20324*         ENDFILE   (8730-END-BROWSE)
 20325*         NOTFND    (8740-NOT-FOUND)
 20326*    END-EXEC.
 20327*    MOVE '"$$''I                 ! < #00019074' TO DFHEIV0
 20328     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20330     MOVE X'3C20233030303139303734' TO DFHEIV0(25:11)
 20331     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 374
* EL050.cbl
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334
 20335
 20336* EXEC CICS STARTBR
 20337*        DATASET     ('ELCERT5')
 20338*        RIDFLD      (ELCERT2-KEY)
 20339*        EQUAL
 20340*    END-EXEC.
 20341     MOVE 'ELCERT5' TO DFHEIV1
 20342     MOVE 0
 20343       TO DFHEIV11
 20344*    MOVE '&,         E          &   #00019080' TO DFHEIV0
 20345     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139303830' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           DFHEIV1,
 20350           ELCERT2-KEY,
 20351           DFHEIV99,
 20352           DFHEIV11,
 20353           DFHEIV99
 20354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20355
 20356
 20357 8710-READ-NEXT.
 20358
 20359* EXEC CICS READNEXT
 20360*        DATASET     ('ELCERT5')
 20361*        INTO        (CERTIFICATE-MASTER)
 20362*        RIDFLD      (ELCERT2-KEY)
 20363*    END-EXEC.
 20364     MOVE LENGTH OF
 20365      CERTIFICATE-MASTER
 20366       TO DFHEIV12
 20367     MOVE 'ELCERT5' TO DFHEIV1
 20368     MOVE 0
 20369       TO DFHEIV11
 20370*    MOVE '&.IL                  )   #00019087' TO DFHEIV0
 20371     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20372     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20373     MOVE X'2020233030303139303837' TO DFHEIV0(25:11)
 20374     CALL 'kxdfhei1' USING DFHEIV0,
 20375           DFHEIV1,
 20376           CERTIFICATE-MASTER,
 20377           DFHEIV12,
 20378           ELCERT2-KEY,
 20379           DFHEIV99,
 20380           DFHEIV11,
 20381           DFHEIV99,
 20382           DFHEIV99
 20383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20384
 20385
 20386 8720-COMP-ACCOUNTS.
 20387
 20388* EXEC CICS ENTER
 20389*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 375
* EL050.cbl
 20390*         FROM (PB-C-LAST-NAME)
 20391*    END-EXEC.
 20392     MOVE 001
 20393       TO DFHEIV11
 20394*    MOVE ':$F                   %   #00019094' TO DFHEIV0
 20395     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20396     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20397     MOVE X'2020233030303139303934' TO DFHEIV0(25:11)
 20398     CALL 'kxdfhei1' USING DFHEIV0,
 20399           DFHEIV11,
 20400           PB-C-LAST-NAME,
 20401           DFHEIV99,
 20402           DFHEIV99
 20403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20404
 20405
 20406
 20407* EXEC CICS ENTER
 20408*         TRACEID (002)
 20409*         FROM (CM-INSURED-LAST-NAME)
 20410*    END-EXEC.
 20411     MOVE 002
 20412       TO DFHEIV11
 20413*    MOVE ':$F                   %   #00019099' TO DFHEIV0
 20414     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20415     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20416     MOVE X'2020233030303139303939' TO DFHEIV0(25:11)
 20417     CALL 'kxdfhei1' USING DFHEIV0,
 20418           DFHEIV11,
 20419           CM-INSURED-LAST-NAME,
 20420           DFHEIV99,
 20421           DFHEIV99
 20422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20423
 20424
 20425     IF PB-CERT-NO NOT = CM-CERT-NO
 20426         GO TO 8730-END-BROWSE.
 20427
 20428     IF PB-ACCOUNT = CM-ACCOUNT
 20429         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20430             MOVE ER-2799        TO WS-ERROR
 20431             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20432             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20433             GO TO 8730-END-BROWSE.
 20434
 20435     GO TO 8710-READ-NEXT.
 20436
 20437 8730-END-BROWSE.
 20438
 20439* EXEC CICS ENDBR
 20440*         DATASET    ('ELCERT5')
 20441*    END-EXEC.
 20442     MOVE 'ELCERT5' TO DFHEIV1
 20443     MOVE 0
 20444       TO DFHEIV11
 20445*    MOVE '&2                    $   #00019117' TO DFHEIV0
 20446     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 376
* EL050.cbl
 20448     MOVE X'2020233030303139313137' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0,
 20450           DFHEIV1,
 20451           DFHEIV11,
 20452           DFHEIV99
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456 8740-NOT-FOUND.
 20457     GO TO 0299-CERT-NOT-FOUND.
 20458
 20459 8750-START-ELSTAT.
 20460
 20461* EXEC CICS STARTBR
 20462*       DATASET   (STAT-ID)
 20463*       RIDFLD    (ELSTAT-KEY)
 20464*       GTEQ
 20465*       RESP      (WS-RESPONSE)
 20466*    END-EXEC
 20467     MOVE 0
 20468       TO DFHEIV11
 20469*    MOVE '&,         G          &  N#00019125' TO DFHEIV0
 20470     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20471     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20472     MOVE X'204E233030303139313235' TO DFHEIV0(25:11)
 20473     CALL 'kxdfhei1' USING DFHEIV0,
 20474           STAT-ID,
 20475           ELSTAT-KEY,
 20476           DFHEIV99,
 20477           DFHEIV11,
 20478           DFHEIV99
 20479     MOVE EIBRESP  TO WS-RESPONSE
 20480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20481     IF WS-RESP-NORMAL
 20482        MOVE 'Y'                 TO STAT-MASTER-SW
 20483     ELSE
 20484        MOVE 'N'                 TO STAT-MASTER-SW
 20485     END-IF
 20486     .
 20487 8750-EXIT.
 20488     EXIT.
 20489 8752-READ-ELSTAT.
 20490
 20491* EXEC CICS READNEXT
 20492*       DATASET   (STAT-ID)
 20493*       RIDFLD    (ELSTAT-KEY)
 20494*       INTO      (STATE-FILE)
 20495*       RESP      (WS-RESPONSE)
 20496*    END-EXEC
 20497     MOVE LENGTH OF
 20498      STATE-FILE
 20499       TO DFHEIV12
 20500     MOVE 0
 20501       TO DFHEIV11
 20502*    MOVE '&.IL                  )  N#00019140' TO DFHEIV0
 20503     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20504     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20505     MOVE X'204E233030303139313430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 377
* EL050.cbl
 20506     CALL 'kxdfhei1' USING DFHEIV0,
 20507           STAT-ID,
 20508           STATE-FILE,
 20509           DFHEIV12,
 20510           ELSTAT-KEY,
 20511           DFHEIV99,
 20512           DFHEIV11,
 20513           DFHEIV99,
 20514           DFHEIV99
 20515     MOVE EIBRESP  TO WS-RESPONSE
 20516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20517     IF WS-RESP-NORMAL
 20518        MOVE 'Y'                 TO STAT-MASTER-SW
 20519     ELSE
 20520        MOVE 'N'                 TO STAT-MASTER-SW
 20521     END-IF
 20522     .
 20523 8752-EXIT.
 20524     EXIT.
 20525 8800-GET-COMP-RATE.
 20526     MOVE +1 TO IB.
 20527     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20528         ADD +9 TO IB
 20529         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20530             ADD +9 TO IB
 20531             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20532                MOVE ZEROS       TO WS-WK-RATE
 20533                GO TO 8800-EXIT.
 20534
 20535     IF PB-I-AGE GREATER CT-AGE (1)
 20536         ADD +3 TO IB
 20537         IF PB-I-AGE GREATER CT-AGE (2)
 20538             ADD +3 TO IB
 20539             IF PB-I-AGE GREATER CT-AGE (3)
 20540                MOVE ZEROS       TO WS-WK-RATE
 20541                GO TO 8800-EXIT.
 20542
 20543     IF WS-WORK-TERM GREATER CT-TRM (1)
 20544         ADD +1 TO IB
 20545         IF WS-WORK-TERM GREATER CT-TRM (2)
 20546             ADD +1 TO IB
 20547             IF WS-WORK-TERM GREATER CT-TRM (3)
 20548                MOVE ZEROS       TO WS-WK-RATE
 20549                GO TO 8800-EXIT.
 20550
 20551     IF CT-RT (IB) NOT NUMERIC
 20552         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20553         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20554         GO TO 8800-GET-COMP-RATE.
 20555
 20556     MOVE CT-RT (IB) TO WS-WK-RATE.
 20557
 20558 8800-EXIT.
 20559     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 378
* EL050.cbl
 20561 8900-ADDRESS-FILE.
 20562     IF ERACCT-FILE-ADDRESSED
 20563         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20564         GO TO 8900-ADDRESS-EXIT.
 20565
 20566     IF ELCNTL-FILE-ADDRESSED
 20567         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20568         GO TO 8900-ADDRESS-EXIT.
 20569
 20570     IF ERPLAN-FILE-ADDRESSED
 20571         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20572         GO TO 8900-ADDRESS-EXIT.
 20573
 20574     IF ERFORM-FILE-ADDRESSED
 20575         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20576         GO TO 8900-ADDRESS-EXIT.
 20577
 20578 8900-ADDRESS-EXIT.
 20579     EXIT.
 20580
 20581 9000-READ-CONTROL.
 20582
 20583* EXEC CICS HANDLE CONDITION
 20584*        NOTFND    (9000-NOTFND)
 20585*    END-EXEC.
 20586*    MOVE '"$I                   ! = #00019211' TO DFHEIV0
 20587     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20589     MOVE X'3D20233030303139323131' TO DFHEIV0(25:11)
 20590     CALL 'kxdfhei1' USING DFHEIV0
 20591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20592
 20593
 20594
 20595* EXEC CICS READ
 20596*        DATASET     (CNTL-ID)
 20597*        SET         (ADDRESS OF CONTROL-FILE)
 20598*        RIDFLD      (ELCNTL-KEY)
 20599*        GTEQ
 20600*    END-EXEC.
 20601*    MOVE '&"S        G          (   #00019215' TO DFHEIV0
 20602     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20603     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20604     MOVE X'2020233030303139323135' TO DFHEIV0(25:11)
 20605     CALL 'kxdfhei1' USING DFHEIV0,
 20606           CNTL-ID,
 20607           DFHEIV20,
 20608           DFHEIV99,
 20609           ELCNTL-KEY,
 20610           DFHEIV99,
 20611           DFHEIV99,
 20612           DFHEIV99
 20613     SET ADDRESS OF CONTROL-FILE TO
 20614         DFHEIV20
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 379
* EL050.cbl
 20619
 20620 9000-NOTFND.
 20621     IF RC-SW-1 = '1'
 20622        MOVE ER-2616              TO WS-ERROR
 20623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20624        GO TO 9000-EXIT.
 20625
 20626     IF RC-SW-1 = '2'
 20627        MOVE ER-2602              TO WS-ERROR
 20628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20629
 20630 9000-EXIT.
 20631      EXIT.
 20632
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 380
* EL050.cbl
 20634 9100-READ-CONTROL.
 20635
 20636* EXEC CICS HANDLE CONDITION
 20637*        NOTFND  (9100-NOTFND)
 20638*        ENDFILE (9100-NOTFND)
 20639*    END-EXEC.
 20640*    MOVE '"$I''                  ! > #00019239' TO DFHEIV0
 20641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20643     MOVE X'3E20233030303139323339' TO DFHEIV0(25:11)
 20644     CALL 'kxdfhei1' USING DFHEIV0
 20645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20646
 20647
 20648
 20649* EXEC CICS READ
 20650*        DATASET     (CNTL-ID)
 20651*        INTO        (CONTROL-FILE)
 20652*        RIDFLD      (ELCNTL-KEY)
 20653*        GTEQ
 20654*    END-EXEC.
 20655     MOVE LENGTH OF
 20656      CONTROL-FILE
 20657       TO DFHEIV11
 20658*    MOVE '&"IL       G          (   #00019244' TO DFHEIV0
 20659     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303139323434' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           CNTL-ID,
 20664           CONTROL-FILE,
 20665           DFHEIV11,
 20666           ELCNTL-KEY,
 20667           DFHEIV99,
 20668           DFHEIV99,
 20669           DFHEIV99
 20670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20671
 20672
 20673     GO TO 9100-EXIT.
 20674
 20675 9100-NOTFND.
 20676     IF RC-SW-2 = '0'
 20677        MOVE '1'                  TO STATE-RECORD-ERROR
 20678        GO TO 9100-EXIT
 20679     END-IF
 20680     IF RC-SW-2 = '1'
 20681        MOVE '1'                  TO LF-BENEFIT-ERROR
 20682        MOVE ER-2604              TO WS-ERROR
 20683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20684        GO TO 9100-EXIT.
 20685
 20686     IF RC-SW-2 = '2'
 20687        MOVE '1'                  TO AH-BENEFIT-ERROR
 20688        MOVE ER-2605              TO WS-ERROR
 20689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20690        GO TO 9100-EXIT.
 20691
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 381
* EL050.cbl
 20692     IF RC-SW-2 = '3'
 20693         MOVE ER-2603           TO WS-ERROR
 20694         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20695         GO TO 9100-EXIT.
 20696
 20697     IF RC-SW-2 = '4'
 20698         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20699         GO TO 9100-EXIT.
 20700
 20701     IF RC-SW-2 = '5'
 20702         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20703         IF WS-AH-INPUT-CD-1 = SPACE
 20704             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20705         ELSE
 20706             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20707
 20708 9100-EXIT.
 20709      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 382
* EL050.cbl
 20711 9200-CONTROL-GETMAIN.
 20712
 20713* EXEC CICS GETMAIN
 20714*         LENGTH   (750)
 20715*         SET      (ADDRESS OF CONTROL-FILE)
 20716*    END-EXEC.
 20717     MOVE 750
 20718       TO DFHEIV11
 20719*    MOVE '," L                  $   #00019290' TO DFHEIV0
 20720     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20722     MOVE X'2020233030303139323930' TO DFHEIV0(25:11)
 20723     CALL 'kxdfhei1' USING DFHEIV0,
 20724           DFHEIV20,
 20725           DFHEIV11,
 20726           DFHEIV99
 20727     SET ADDRESS OF CONTROL-FILE TO
 20728         DFHEIV20
 20729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20730
 20731
 20732     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20733
 20734 9200-EXIT.
 20735     EXIT.
 20736
 20737 9250-UNLOCK-RETURN.
 20738
 20739* EXEC CICS UNLOCK
 20740*        DATASET   (CERT-ID)
 20741*    END-EXEC.
 20742*    MOVE '&*                    #   #00019301' TO DFHEIV0
 20743     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20744     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20745     MOVE X'2020233030303139333031' TO DFHEIV0(25:11)
 20746     CALL 'kxdfhei1' USING DFHEIV0,
 20747           CERT-ID,
 20748           DFHEIV99
 20749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20750
 20751
 20752 9300-ABEND.
 20753     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20754
 20755
 20756* EXEC CICS LINK
 20757*        PROGRAM   ('EL004')
 20758*        COMMAREA  (WS-ERROR-LINE)
 20759*        LENGTH    (72)
 20760*    END-EXEC.
 20761     MOVE 'EL004' TO DFHEIV1
 20762     MOVE 72
 20763       TO DFHEIV11
 20764*    MOVE '."C                   ''   #00019308' TO DFHEIV0
 20765     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20767     MOVE X'2020233030303139333038' TO DFHEIV0(25:11)
 20768     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 383
* EL050.cbl
 20769           DFHEIV1,
 20770           WS-ERROR-LINE,
 20771           DFHEIV11,
 20772           DFHEIV99,
 20773           DFHEIV99,
 20774           DFHEIV99
 20775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20776
 20777
 20778     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20779
 20780
 20781* EXEC CICS ABEND
 20782*        ABCODE ('EL50')
 20783*    END-EXEC.
 20784     MOVE 'EL50' TO DFHEIV5
 20785*    MOVE '.,A                   "   #00019316' TO DFHEIV0
 20786     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20787     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20788     MOVE X'2020233030303139333136' TO DFHEIV0(25:11)
 20789     CALL 'kxdfhei1' USING DFHEIV0,
 20790           DFHEIV5
 20791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20792
 20793
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 384
* EL050.cbl
 20795
 20796******************************************************************
 20797*                                                                *
 20798*            E R R O R   F O R M A T   R O U T I N E             *
 20799*                                                                *
 20800******************************************************************
 20801
 20802 9900-ERROR-FORMAT.
 20803
 20804     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20805                    PB-COMMON-ERROR (2) OR
 20806                    PB-COMMON-ERROR (3) OR
 20807                    PB-COMMON-ERROR (4) OR
 20808                    PB-COMMON-ERROR (5) OR
 20809                    PB-COMMON-ERROR (6) OR
 20810                    PB-COMMON-ERROR (7) OR
 20811                    PB-COMMON-ERROR (8) OR
 20812                    PB-COMMON-ERROR (9) OR
 20813                    PB-COMMON-ERROR (10)
 20814        GO TO 9900-EXIT.
 20815
 20816     IF PB-NO-OF-ERRORS = +10
 20817        GO TO 9900-EXIT.
 20818
 20819     ADD +1  TO PB-NO-OF-ERRORS.
 20820     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20821                                       (PB-NO-OF-ERRORS).
 20822 9900-EXIT.
 20823     EXIT.
 20824
 20825 9990-RETURN.
 20826     IF BROWSE-STARTED
 20827
 20828* EXEC CICS ENDBR
 20829*            DATASET  (ACCT-ID)
 20830*       END-EXEC.
 20831     MOVE 0
 20832       TO DFHEIV11
 20833*    MOVE '&2                    $   #00019353' TO DFHEIV0
 20834     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20835     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20836     MOVE X'2020233030303139333533' TO DFHEIV0(25:11)
 20837     CALL 'kxdfhei1' USING DFHEIV0,
 20838           ACCT-ID,
 20839           DFHEIV11,
 20840           DFHEIV99
 20841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20842
 20843
 20844 9990-EXIT.
 20845     EXIT.
 20846
 20847
 20848****Check for CRTO record, add one if not found.
 20849 9991-CHECK-FOR-ELCRTO.
 20850
 20851* EXEC CICS HANDLE CONDITION
 20852*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 385
* EL050.cbl
 20853*         ENDFILE (9991-CRTO-NOT-FOUND)
 20854*     END-EXEC.
 20855*    MOVE '"$I''                  ! ? #00019363' TO DFHEIV0
 20856     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20858     MOVE X'3F20233030303139333633' TO DFHEIV0(25:11)
 20859     CALL 'kxdfhei1' USING DFHEIV0
 20860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20861
 20862     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 20863     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 20864     MOVE +0                     TO ELCRTO-SEQ-NO
 20865
 20866
 20867* EXEC CICS READ
 20868*       DATASET   ('ELCRTO')
 20869*       INTO      (ORIGINAL-CERTIFICATE)
 20870*       RIDFLD    (ELCRTO-KEY)
 20871*       GTEQ
 20872*       RESP      (WS-RESPONSE)
 20873*    END-EXEC
 20874     MOVE LENGTH OF
 20875      ORIGINAL-CERTIFICATE
 20876       TO DFHEIV11
 20877     MOVE 'ELCRTO' TO DFHEIV1
 20878*    MOVE '&"IL       G          (  N#00019371' TO DFHEIV0
 20879     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20880     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20881     MOVE X'204E233030303139333731' TO DFHEIV0(25:11)
 20882     CALL 'kxdfhei1' USING DFHEIV0,
 20883           DFHEIV1,
 20884           ORIGINAL-CERTIFICATE,
 20885           DFHEIV11,
 20886           ELCRTO-KEY,
 20887           DFHEIV99,
 20888           DFHEIV99,
 20889           DFHEIV99
 20890     MOVE EIBRESP  TO WS-RESPONSE
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20892
 20893     IF WS-RESP-NORMAL
 20894        AND (OC-CONTROL-PRIMARY (1:33) =
 20895                 PB-CONTROL-BY-ACCOUNT (1:33))
 20896        AND (OC-RECORD-TYPE =  'I')
 20897           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 20898               GO TO 9991-EXIT
 20899           ELSE
 20900               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 20901               GO TO 9991-CRTO-ADD-REC
 20902           END-IF
 20903     END-IF.
 20904
 20905 9991-CRTO-NOT-FOUND.
 20906
 20907     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 20908     MOVE 'OC'                TO OC-RECORD-ID
 20909     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 20910                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 386
* EL050.cbl
 20911     MOVE +4096               TO OC-KEY-SEQ-NO.
 20912
 20913 9991-CRTO-ADD-REC.
 20914
 20915     MOVE 'E050'              TO OC-LAST-MAINT-BY
 20916     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 20917     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 20918     MOVE 'I'                 TO OC-RECORD-TYPE
 20919     IF PB-ISSUE
 20920         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 20921         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 20922         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 20923         MOVE PB-I-AGE               TO OC-INS-AGE
 20924         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 20925         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 20926         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 20927         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 20928         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 20929         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 20930         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 20931         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 20932         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 20933         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 20934         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 20935         IF PB-I-JOINT-COMMISSION > +0
 20936             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 20937         ELSE
 20938             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 20939         END-IF
 20940         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 20941         MOVE +0                     TO OC-LF-CANCEL-AMT
 20942                                        OC-LF-ITD-CANCEL-AMT
 20943         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 20944         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 20945         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 20946         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 20947         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 20948         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 20949         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 20950         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 20951         MOVE +0                     TO OC-AH-CANCEL-AMT
 20952                                        OC-AH-ITD-CANCEL-AMT
 20953         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 20954     ELSE
 20955         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 20956         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 20957         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 20958         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 20959         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 20960         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 20961         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 20962         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 20963         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 20964          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 20965             MOVE SPACES             TO OC-LF-BENCD
 20966             MOVE ZEROS              TO OC-LF-TERM
 20967                                        OC-LF-BEN-AMT
 20968                                        OC-LF-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 387
* EL050.cbl
 20969                                        OC-LF-ALT-BEN-AMT
 20970                                        OC-LF-ALT-PRM-AMT
 20971                                        OC-LF-COMM-PCT
 20972                                        OC-LF-CANCEL-AMT
 20973             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 20974             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 20975         ELSE
 20976             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 20977             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 20978             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 20979             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 20980             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 20981             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 20982             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 20983             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 20984             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 20985             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 20986         END-IF
 20987         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 20988         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 20989          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 20990             MOVE SPACES             TO OC-AH-BENCD
 20991             MOVE ZEROS              TO OC-AH-TERM
 20992                                        OC-AH-BEN-AMT
 20993                                        OC-AH-PRM-AMT
 20994                                        OC-AH-COMM-PCT
 20995                                        OC-AH-CANCEL-AMT
 20996                                        OC-AH-CP
 20997             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 20998             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 20999         ELSE
 21000             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21001             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21002             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21003             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21004             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21005             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21006             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21007             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21008             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21009         END-IF
 21010         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21011         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21012     END-IF
 21013     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21014
 21015     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21016
 21017
 21018* EXEC CICS READ
 21019*         DATASET   (FILE-ERMAIL)
 21020*         RIDFLD    (MA-CONTROL-PRIMARY)
 21021*         INTO      (MAILING-DATA)
 21022*         RESP      (WS-RESPONSE)
 21023*    END-EXEC
 21024     MOVE LENGTH OF
 21025      MAILING-DATA
 21026       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 388
* EL050.cbl
 21027*    MOVE '&"IL       E          (  N#00019503' TO DFHEIV0
 21028     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21030     MOVE X'204E233030303139353033' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0,
 21032           FILE-ERMAIL,
 21033           MAILING-DATA,
 21034           DFHEIV11,
 21035           MA-CONTROL-PRIMARY,
 21036           DFHEIV99,
 21037           DFHEIV99,
 21038           DFHEIV99
 21039     MOVE EIBRESP  TO WS-RESPONSE
 21040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21041
 21042     IF WS-RESP-NORMAL
 21043         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21044     END-IF.
 21045
 21046
 21047* EXEC CICS WRITE
 21048*       DATASET   ('ELCRTO')
 21049*       FROM      (ORIGINAL-CERTIFICATE)
 21050*       RIDFLD    (OC-CONTROL-PRIMARY)
 21051*       RESP      (WS-RESPONSE)
 21052*    END-EXEC.
 21053     MOVE LENGTH OF
 21054      ORIGINAL-CERTIFICATE
 21055       TO DFHEIV11
 21056     MOVE 'ELCRTO' TO DFHEIV1
 21057*    MOVE '&$ L                  ''  N#00019514' TO DFHEIV0
 21058     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21060     MOVE X'204E233030303139353134' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           DFHEIV1,
 21063           ORIGINAL-CERTIFICATE,
 21064           DFHEIV11,
 21065           OC-CONTROL-PRIMARY,
 21066           DFHEIV99,
 21067           DFHEIV99
 21068     MOVE EIBRESP  TO WS-RESPONSE
 21069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21070
 21071
 21072 9991-EXIT.
 21073     EXIT.
 21074
 21075
 21076 9999-RETURN.
 21077     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21078
 21079
 21080* EXEC CICS RETURN
 21081*    END-EXEC.
 21082*    MOVE '.(                    &   #00019528' TO DFHEIV0
 21083     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21084     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 389
* EL050.cbl
 21085     MOVE X'2020233030303139353238' TO DFHEIV0(25:11)
 21086     CALL 'kxdfhei1' USING DFHEIV0,
 21087           DFHEIV99,
 21088           DFHEIV99,
 21089           DFHEIV99,
 21090           DFHEIV99,
 21091           DFHEIV99
 21092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21093
 21094
 21095
 21096* GOBACK.
 21097     MOVE '9%                    "   ' TO DFHEIV0
 21098     MOVE 'EL050' TO DFHEIV1
 21099     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21100     GOBACK.
 21101
 21102 9999-DFHBACK SECTION.
 21103     MOVE '9%                    "   ' TO DFHEIV0
 21104     MOVE 'EL050' TO DFHEIV1
 21105     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21106     GOBACK.
 21107 9999-DFHEXIT.
 21108     IF DFHEIGDJ EQUAL 0001
 21109         NEXT SENTENCE
 21110     ELSE IF DFHEIGDJ EQUAL 2
 21111         GO TO 9300-ABEND,
 21112               3990-FILES-NOT-OPEN
 21113         DEPENDING ON DFHEIGDI
 21114     ELSE IF DFHEIGDJ EQUAL 3
 21115         GO TO 6610-START-BROWSE,
 21116               6630-ERRESS-PROBLEM,
 21117               6630-END-OF-FILE
 21118         DEPENDING ON DFHEIGDI
 21119     ELSE IF DFHEIGDJ EQUAL 4
 21120         GO TO 6630-END-OF-FILE,
 21121               6630-ERRESS-PROBLEM,
 21122               6630-ERRESS-PROBLEM,
 21123               6630-END-OF-FILE
 21124         DEPENDING ON DFHEIGDI
 21125     ELSE IF DFHEIGDJ EQUAL 5
 21126         GO TO 6630-END-OF-FILE,
 21127               6630-END-OF-FILE,
 21128               6630-ERRESS-PROBLEM,
 21129               6630-ERRESS-PROBLEM
 21130         DEPENDING ON DFHEIGDI
 21131     ELSE IF DFHEIGDJ EQUAL 6
 21132         GO TO 6660-START-BROWSE,
 21133               6690-ERRESC-PROBLEM,
 21134               6690-ERRESC-PROBLEM,
 21135               6690-END-OF-FILE
 21136         DEPENDING ON DFHEIGDI
 21137     ELSE IF DFHEIGDJ EQUAL 7
 21138         GO TO 6690-END-OF-FILE,
 21139               6690-ERRESC-PROBLEM,
 21140               6690-ERRESC-PROBLEM,
 21141               6690-END-OF-FILE
 21142         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 390
* EL050.cbl
 21143     ELSE IF DFHEIGDJ EQUAL 8
 21144         GO TO 6690-END-OF-FILE,
 21145               6690-ERRESC-PROBLEM,
 21146               6690-ERRESC-PROBLEM,
 21147               6690-END-OF-FILE
 21148         DEPENDING ON DFHEIGDI
 21149     ELSE IF DFHEIGDJ EQUAL 9
 21150         GO TO 7250-CONTINUE,
 21151               7250-CONTINUE
 21152         DEPENDING ON DFHEIGDI
 21153     ELSE IF DFHEIGDJ EQUAL 10
 21154         GO TO 7300-CONTINUE,
 21155               7300-CONTINUE
 21156         DEPENDING ON DFHEIGDI
 21157     ELSE IF DFHEIGDJ EQUAL 11
 21158         GO TO 8000-FREE-MAIN
 21159         DEPENDING ON DFHEIGDI
 21160     ELSE IF DFHEIGDJ EQUAL 12
 21161         GO TO 8100-NOTFND,
 21162               8100-NOTFND
 21163         DEPENDING ON DFHEIGDI
 21164     ELSE IF DFHEIGDJ EQUAL 13
 21165         GO TO 8110-NOTFND,
 21166               8110-NOTFND
 21167         DEPENDING ON DFHEIGDI
 21168     ELSE IF DFHEIGDJ EQUAL 14
 21169         GO TO 8130-EXIT
 21170         DEPENDING ON DFHEIGDI
 21171     ELSE IF DFHEIGDJ EQUAL 15
 21172         GO TO 8180-NOTFND
 21173         DEPENDING ON DFHEIGDI
 21174     ELSE IF DFHEIGDJ EQUAL 16
 21175         GO TO 8190-NOTFND
 21176         DEPENDING ON DFHEIGDI
 21177     ELSE IF DFHEIGDJ EQUAL 17
 21178         GO TO 8200-NOTFND
 21179         DEPENDING ON DFHEIGDI
 21180     ELSE IF DFHEIGDJ EQUAL 18
 21181         GO TO 8300-NOTFND,
 21182               8300-ERRESS-PROBLEM,
 21183               8300-ERRESS-PROBLEM,
 21184               8300-NOTFND
 21185         DEPENDING ON DFHEIGDI
 21186     ELSE IF DFHEIGDJ EQUAL 19
 21187         GO TO 8450-FORM-NOT-FOUND,
 21188               8450-FORM-NOT-FOUND
 21189         DEPENDING ON DFHEIGDI
 21190     ELSE IF DFHEIGDJ EQUAL 20
 21191         GO TO 0199-ACCT-NOT-FOUND,
 21192               0199-ACCT-NOT-FOUND
 21193         DEPENDING ON DFHEIGDI
 21194     ELSE IF DFHEIGDJ EQUAL 21
 21195         GO TO 0199-ACCT-NOT-FOUND,
 21196               0199-ACCT-NOT-FOUND
 21197         DEPENDING ON DFHEIGDI
 21198     ELSE IF DFHEIGDJ EQUAL 22
 21199         GO TO 8582-COMP-NOT-FOUND,
 21200               8582-COMP-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 391
* EL050.cbl
 21201         DEPENDING ON DFHEIGDI
 21202     ELSE IF DFHEIGDJ EQUAL 23
 21203         GO TO 8583-AGTC-NOT-FOUND,
 21204               8583-AGTC-NOT-FOUND
 21205         DEPENDING ON DFHEIGDI
 21206     ELSE IF DFHEIGDJ EQUAL 24
 21207         GO TO 8584-BXRF-NOT-FOUND,
 21208               8584-BXRF-NOT-FOUND
 21209         DEPENDING ON DFHEIGDI
 21210     ELSE IF DFHEIGDJ EQUAL 25
 21211         GO TO 8585-PLAN-NOT-FOUND,
 21212               8585-PLAN-NOT-FOUND
 21213         DEPENDING ON DFHEIGDI
 21214     ELSE IF DFHEIGDJ EQUAL 26
 21215         GO TO 0299-CERT-NOT-FOUND
 21216         DEPENDING ON DFHEIGDI
 21217     ELSE IF DFHEIGDJ EQUAL 27
 21218         GO TO 8700-READ-CERT-MASTER
 21219         DEPENDING ON DFHEIGDI
 21220     ELSE IF DFHEIGDJ EQUAL 28
 21221         GO TO 8720-COMP-ACCOUNTS,
 21222               8730-END-BROWSE,
 21223               8740-NOT-FOUND
 21224         DEPENDING ON DFHEIGDI
 21225     ELSE IF DFHEIGDJ EQUAL 29
 21226         GO TO 9000-NOTFND
 21227         DEPENDING ON DFHEIGDI
 21228     ELSE IF DFHEIGDJ EQUAL 30
 21229         GO TO 9100-NOTFND,
 21230               9100-NOTFND
 21231         DEPENDING ON DFHEIGDI
 21232     ELSE IF DFHEIGDJ EQUAL 31
 21233         GO TO 9991-CRTO-NOT-FOUND,
 21234               9991-CRTO-NOT-FOUND
 21235         DEPENDING ON DFHEIGDI.
 21236     MOVE '9%                    "   ' TO DFHEIV0
 21237     MOVE 'EL050' TO DFHEIV1
 21238     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21239     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39984     Code:       85269
