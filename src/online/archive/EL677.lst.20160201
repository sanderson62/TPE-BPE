* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35******************************************************************
    36 ENVIRONMENT DIVISION.
    37
    38 DATA DIVISION.
    39 WORKING-STORAGE SECTION.
    40 01  DFH-START PIC X(04).
    41 77  FILLER  PIC X(32)  VALUE '********************************'.
    42 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    43 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    44 77  s1                          pic s999 comp-3 value +0.
    45 77  s2                          pic s999 comp-3 value +0.
    46 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    47 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    48 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    49 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    50 77  ws-browse-sw                pic x value spaces.
    51     88  i-say-when                 value 'Y'.
    52 77  ws-delete-sw                pic x value ' '.
    53     88  row-deleted                 value 'Y'.
    54 77  ws-sql-code                 pic s9(7) value zeros.
    55 77  ws-dis-sql-code             pic -9999999 value zeros.
    56 77  ws-match-sw                 pic x  value ' '.
    57     88  found-a-match             value 'Y'.
    58 77  ws-commit-sw                pic x value ' '.
    59     88  tbl-commited                value 'Y'.
    60 01  P pointer.
    61 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    62 01  var-ptr pointer.
    63 01  env-var-len                 pic 9(4)  binary.
    64 01  rc                          pic 9(9)  binary.
    65
    66 01  WS-KIXSYS.
    67     05  WS-KIX-FIL1             PIC X(10).
    68     05  WS-KIX-APPS             PIC X(10).
    69     05  WS-KIX-ENV              PIC X(10).
    70     05  WS-KIX-MYENV            PIC X(10).
    71     05  WS-KIX-SYS              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL677.cbl
*   72 EXEC SQL
*   73    INCLUDE SQLDA
*   74 END-EXEC
    75 01 SQLDA sync.
    76    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    77    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    78    05 SQLN                  PIC S9(4) COMP-5 value 0.
    79    05 SQLD                  PIC S9(4) COMP-5 value 0.
    80    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    81       10 SQLTYPE            PIC S9(4) COMP-5.
    82       10 SQLLEN             PIC S9(4) COMP-5.
    83$IF P64 SET
    84X      *> For 64-bit environments, ensure that SQLDATA is
    85X      *> aligned on an 8-byte boundary.
    86X      10 FILLER             PIC S9(9) COMP-5.
    87$END
    88       10 SQLDATA            USAGE POINTER.
    89       10 SQLIND             USAGE POINTER.
    90       10 SQLNAME.
    91          15 SQLNAMEL        PIC S9(4) COMP-5.
    92          15 SQLNAMEC        PIC X(30).
    93
    94* Values for SQLTYPE
    95
    96 78  ESQL-DATE-CHAR              VALUE 384.
    97 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    98 78  ESQL-DATE-REC               VALUE 386.
    99 78  ESQL-DATE-REC-NULL          VALUE 387.
   100 78  ESQL-TIME-CHAR              VALUE 388.
   101 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   102 78  ESQL-TIME-REC               VALUE 390.
   103 78  ESQL-TIME-REC-NULL          VALUE 391.
   104 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   105 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   106 78  ESQL-TIMESTAMP-REC          VALUE 394.
   107 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   108 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   109 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   110 78  ESQL-TS-OFFSET-REC          VALUE 398.
   111 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   112 78  ESQL-LONGVARBINARY          VALUE 404.
   113 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   114 78  ESQL-LONGVARCHAR            VALUE 408.
   115 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   116 78  ESQL-BINARY                 VALUE 444.
   117 78  ESQL-BINARY-NULL            VALUE 445.
   118 78  ESQL-VARBINARY              VALUE 446.
   119 78  ESQL-VARBINARY-NULL         VALUE 447.
   120 78  ESQL-VARCHAR                VALUE 448.
   121 78  ESQL-VARCHAR-NULL           VALUE 449.
   122
   123 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   124 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   125
   126 78  ESQL-CHAR                   VALUE 452.
   127 78  ESQL-CHAR-NULL              VALUE 453.
   128
   129 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   131
   132 78  ESQL-DOUBLE                 VALUE 480.
   133 78  ESQL-DOUBLE-NULL            VALUE 481.
   134 78  ESQL-REAL                   VALUE 482.
   135 78  ESQL-REAL-NULL              VALUE 483.
   136 78  ESQL-DECIMAL                VALUE 484.
   137 78  ESQL-DECIMAL-NULL           VALUE 485.
   138 78  ESQL-INTEGER                VALUE 496.
   139 78  ESQL-INTEGER-NULL           VALUE 497.
   140 78  ESQL-SMALLINT               VALUE 500.
   141 78  ESQL-SMALLINT-NULL          VALUE 501.
   142 78  ESQL-TINYINT                VALUE 502.
   143 78  ESQL-TINYINT-NULL           VALUE 503.
*  144 EXEC SQL
*  145    INCLUDE SQLCA
*  146 END-EXEC
   147 01 SQLCA.
   148     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   149     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   150     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   151     05  SQLERRM.
   152         49  SQLERRML    PIC S9(4) COMP-5.
   153         49  SQLERRMC    PIC X(70).
   154     05  SQLERRP         PIC X(8).
   155     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   156     05  SQLWARN.
   157         10  SQLWARN0    PIC X.
   158         10  SQLWARN1    PIC X.
   159         10  SQLWARN2    PIC X.
   160         10  SQLWARN3    PIC X.
   161         10  SQLWARN4    PIC X.
   162         10  SQLWARN5    PIC X.
   163         10  SQLWARN6    PIC X.
   164         10  SQLWARN7    PIC X.
   165     05  SQLEXT.
   166         10  SQLWARN8    PIC X.
   167         10  SQLWARN9    PIC X.
   168         10  SQLWARN10   PIC X.
   169         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   170     05  SQLSTATE    PIC X(5).
   171 EXEC SQL
   172    BEGIN DECLARE SECTION
   173 END-EXEC
   174 01  ws-paid-bank-work-area.
   175     05  ws-pb-compid            pic x(9).
   176     05  ws-pb-check-no          pic x(10).
   177     05  ws-pb-bad-check-no      pic x(10).
   178     05  ws-check-amount         pic x(10).
   179 01  Paid-Bank-Info.
   180     05  pb-check-no             pic 9(10).
   181     05  pb-tran-type            pic x.
   182     05  pb-bank-acct-desc       pic x(50).
   183     05  pb-amount               pic x(12).
   184     05  pb-paid-date            pic x(25).
   185 01  ws-key-stuff.
   186     05  ws-compid               pic xxx.
   187     05  ws-carrier              pic x.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL677.cbl
   188     05  ws-grouping             pic x(6).
   189     05  ws-state                pic xx.
   190     05  ws-account              pic x(10).
   191     05  ws-eff-date             pic x(10).
   192     05  ws-certificate          pic x(10).
   193     05  ws-cert-sfx             pic x.
   194     05  ws-seq-no               pic 999.
   195     05  ws-type                 pic x.
   196 01  sqlcmd                      pic x(1024).
   197 01  WS-MOE-DATE                 pic x(10).
   198 01  svr                         pic x(32).
   199 01  usr                         pic x(32).
   200 01  pass                        pic x(32).
   201 01  usr-pass                    pic x(64).
   202 01  ws-disp-code                pic s9(11).
   203***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   204***                                                            ***
   205***  These indicators are used to determine if a variable      ***
   206***  is passed nulls from sql. The indicator will be -1        ***
   207***  if the value on sql is nulls and +0 if the value is       ***
   208***  something other than nulls. Here is an example on how     ***
   209***  to use the indicator variables.                           ***
   210***                                                            ***
   211***     EXEC SQL                                               ***
   212***        fetch checkapp into                                 ***
   213***           :db-app-status :nu-app-status,                   ***
   214***           :db-app-by     :nu-app-by,                       ***
   215***           :db-app-date   :nu-app-date,                     ***
   216***           :db-app-batch  :nu-app-batch                     ***
   217***     END-EXEC                                               ***
   218***                                                            ***
   219***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   220 01  indicator-vaiables-for-nulls.
   221     05  nu-app-status           pic s9(4) comp value +0.
   222     05  nu-app-by               pic s9(4) comp value +0.
   223     05  nu-app-date             pic s9(4) comp value +0.
   224     05  nu-app-batch            pic s9(4) comp value +0.
   225     05  nu-fincar               pic s9(4) comp value +0.
   226 01  daily-check-request-rec.
   227     05  db-compid               pic xxx.
   228     05  db-carrier              pic x.
   229     05  db-grouping             pic x(6).
   230     05  db-state                pic xx.
   231     05  db-account              pic x(10).
   232     05  db-effdate              pic x(10).
   233     05  db-certificate          pic x(10).
   234     05  db-cert-sfx             pic x.
   235     05  db-seq-no               pic 999.
   236     05  db-type                 pic x.
   237     05  db-amount-n             pic 9(7).99.
   238     05  db-amount redefines db-amount-n
   239                                 pic x(10).
   240     05  db-checkno              pic x(15).
   241     05  db-checkdate            pic x(10).
   242     05  db-checkstatus          pic 9(5).
   243     05  db-releasebatch         pic 9(5).
   244     05  db-releasedt            pic x(10).
   245     05  db-releaseby            pic x(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL677.cbl
   246     05  db-payeename1           pic x(30).
   247     05  db-payeename2           pic x(30).
   248     05  db-payeeaddr1           pic x(30).
   249     05  db-payeeaddr2           pic x(30).
   250     05  db-payeecity            pic x(30).
   251     05  db-payeest              pic xx.
   252     05  db-payeezip             pic x(10).
   253     05  db-fincar               pic x.
   254     05  db-fingrp               pic x(6).
   255     05  db-finresp              pic x(10).
   256     05  db-finacct              pic x(10).
   257     05  db-preparer             pic x(4).
   258     05  db-app-status           pic x(9).
   259     05  dp-app-status-n redefines db-app-status
   260                                 pic 9(9).
   261     05  db-app-by               pic x(20).
   262     05  db-app-date             pic x(30).
   263     05  db-app-batch            pic x(10).
   264     05  db-return-to            pic x(30).
   265     05  db-insured-name         pic x(30).
   266 EXEC SQL
   267    END DECLARE SECTION
   268 END-EXEC
   269*                            COPY ELCSCTM.
   270******************************************************************
   271*                                                                *
   272*                                                                *
   273*                            ELCSCTM                             *
   274*                            VMOD=2.001                          *
   275*                                                                *
   276*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   277*                                                                *
   278******************************************************************
   279 01  SECURITY-MESSAGE.
   280     12  FILLER                          PIC X(30)
   281            VALUE '** LOGIC SECURITY VIOLATION -'.
   282     12  SM-READ                         PIC X(6).
   283     12  FILLER                          PIC X(5)
   284            VALUE ' PGM='.
   285     12  SM-PGM                          PIC X(6).
   286     12  FILLER                          PIC X(5)
   287            VALUE ' OPR='.
   288     12  SM-PROCESSOR-ID                 PIC X(4).
   289     12  FILLER                          PIC X(6)
   290            VALUE ' TERM='.
   291     12  SM-TERMID                       PIC X(4).
   292     12  FILLER                          PIC XX   VALUE SPACE.
   293     12  SM-JUL-DATE                     PIC 9(5).
   294     12  FILLER                          PIC X    VALUE SPACE.
   295     12  SM-TIME                         PIC 99.99.
   296
   297*                            COPY ELCSCRTY.
   298******************************************************************
   299*                                                                *
   300*                                                                *
   301*                            ELCSCRTY                            *
   302*                            VMOD=2.001                          *
   303*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL677.cbl
   304*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   305*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   306*        SAVED IN PI-SECURITY-ADDRESS.                           *
   307*                                                                *
   308******************************************************************
   309 01  SECURITY-CONTROL.
   310     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   311     12  FILLER                       PIC XX    VALUE 'SC'.
   312     12  SC-CREDIT-CODES.
   313         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   314             20  SC-CREDIT-DISPLAY    PIC X.
   315             20  SC-CREDIT-UPDATE     PIC X.
   316     12  SC-CLAIMS-CODES.
   317         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   318             20  SC-CLAIMS-DISPLAY    PIC X.
   319             20  SC-CLAIMS-UPDATE     PIC X.
   320 01  ws-dummy-erchek             pic x(600).
   321 01  filler.
   322     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   323     05  WS-CHECK-AMT-TMPX REDEFINES
   324         WS-CHECK-AMT-TMP        PIC X(10).
   325     05  ws-ind                     pic s9(4) comp value +0.
   326     05  ws-ind-red redefines ws-ind pic xx.
   327     05  ws-display-ind             pic s9(7) value zeros.
   328 01  ws-compare-erchek-key          pic x(33) value low-values.
   329 01  ws-eracct-sw                   pic x value ' '.
   330     88  eracct-found                 value 'Y'.
   331 01  ws-eracct-start-sw             pic x value ' '.
   332     88  eracct-start                 value 'Y'.
   333 01  WS-DATE-AREA.
   334     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   335     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   336     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   337
   338 01  ws-work-amt-alpha           pic x(10).
   339 01  ws-work-amt-num redefines ws-work-amt-alpha
   340                                 pic 9(8)v99.
   341 01  ws-user-defined.
   342     05  ws-user-reason         pic xxx.
   343     05  ws-user-cert-no        pic x(11).
   344     05  ws-user-name           pic x(28).
   345 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   346 01  STANDARD-AREAS.
   347     12  ws-connect-sw               pic x  value ' '.
   348         88  connected-to-db             value 'Y'.
   349     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   350     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   351     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   352     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   353     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   354     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   355     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   356     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   357     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   358     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   359     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   360     12  TIME-OUT-R  REDEFINES TIME-IN.
   361         16  FILLER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL677.cbl
   362         16  TIME-OUT                PIC 99V99.
   363         16  FILLER                  PIC XX.
   364     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   365     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   366     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   367     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   368     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   369     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   370     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   371     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   372     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   373     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   374     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   375     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   376     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   377     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   378     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   379     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   380     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   381     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   382     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   383     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   384     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   385     12  QID.
   386         16  QID-TERM                PIC X(4)    VALUE SPACES.
   387         16  FILLER                  PIC X(4)    VALUE '677A'.
   388
   389 01  WORK-AREAS.
   390     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   391     12  WS-AM-WK REDEFINES WS-AM-WORK.
   392         16  WS-AM-NUM               PIC S9(7)V99.
   393         16  WS-AM-SIGN              PIC X.
   394     12  WS-CHECK-WORK.
   395         16  FILLER                  PIC X        VALUE SPACE.
   396         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   397     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   398     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   399     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   400     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   401     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   402     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   403     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   404     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   405     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   406     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   407     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   408         WS-DT-DEEDIT-FIELD.
   409         16  FILLER                  PIC X(4).
   410         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   411     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   412     12  WS-DEEDIT-FIELD-V0          REDEFINES
   413         WS-DEEDIT-FIELD-A           PIC S9(15).
   414
   415     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   416     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   417         88 WS-CERT-FOUND                        VALUE 'Y'.
   418         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   419     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL677.cbl
   420         88 WS-PNDB-FOUND                        VALUE 'Y'.
   421         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   422     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   423         88  WS-PROCESS-CERT                     VALUE 'Y'.
   424     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   425         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   426     12  WS-PY-ENTRY-COMMENT.
   427         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   428         16  FILLER                  PIC X(13)   VALUE
   429            ' MISC. CHECK '.
   430         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   431         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   432     12  WS-PY-REF-COMMENT.
   433         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   434         16  FILLER                  PIC X(13)   VALUE
   435            ' REFUND PYMT '.
   436         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   437         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   438     12  WS-PY-END-COMMENT.
   439         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   440         16  FILLER                  PIC X(13)   VALUE
   441            ' ENDORSEMENT '.
   442         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   443         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   444     12  WS-PY-DED-COMMENT.
   445         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   446         16  FILLER                  PIC X(13)   VALUE
   447            ' STAT DEDUCT '.
   448         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   449         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   450     12  WS-PY-ADDL-COMMENT.
   451         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   452         16  FILLER                  PIC X(13)   VALUE
   453            ' ADDL CHARGE '.
   454         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   455         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   456     12  WS-PY-REVERSAL-COMMENT.
   457         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   458         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   459            ' VOID REFUND '.
   460         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   461         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   462     12  WS-TMS-ENTRY-COMMENT.
   463         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   464         16  FILLER                  PIC XX      VALUE SPACES.
   465         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   466     12  WS-ZIP-CODE.
   467         16  WS-ZIP-PRIME.
   468             20  WS-ZIP-PRI-1ST      PIC X.
   469                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   470             20  FILLER              PIC X(4).
   471         16  WS-ZIP-PLUS4            PIC X(4).
   472     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   473         16  WS-CAN-POST1-1          PIC XXX.
   474         16  WS-CAN-POST1-2.
   475             20  WS-CAN-POST-4TH     PIC X.
   476             20  FILLER              PIC XX.
   477         16  FILLER                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL677.cbl
   478     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   479         16  WS-CAN-POST2-1          PIC XXX.
   480         16  FILLER                  PIC X.
   481         16  WS-CAN-POST2-2          PIC XXX.
   482         16  FILLER                  PIC XX.
   483
   484*                                    COPY ELCNWA.
   485*****************************************************************
   486*                                                               *
   487*                                                               *
   488*                            ELCNWA.                            *
   489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   490*                            VMOD=2.003                         *
   491*                                                               *
   492*            M O V E   N A M E   W O R K   A R E A.             *
   493*                                                               *
   494*****************************************************************.
   495
   496 01  WS-NAME-WORK-AREA.
   497     05  WS-INSURED-LAST-NAME        PIC X(15).
   498     05  WS-INSURED-1ST-NAME         PIC X(12).
   499     05  WS-INSURED-MID-INIT         PIC X.
   500
   501     05  WS-NAME-WORK.
   502         10  WS-NW                   PIC X
   503             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   504
   505     05  WS-NAME-WORK2.
   506         10  WS-NW2                  PIC X
   507             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   508                                        NWA-INDEX0.
   509
   510     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   511                                     COMP-3.
   512
   513 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   514     88  RESP-NORMAL                    VALUE +0.
   515     88  resp-file-notfnd               value +12.
   516     88  RESP-NOTFND                    VALUE +13.
   517     88  resp-duprec                    value +14.
   518     88  resp-dupkey                    value +15.
   519     88  resp-invreq                    value +16.
   520     88  RESP-NOTOPEN                   VALUE +19.
   521     88  RESP-ENDFILE                   VALUE +20.
   522     88  resp-lengtherr                 value +22.
   523 01  ACCESS-KEYS.
   524     12  ELCNTL-KEY.
   525         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   526         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   527         16 ELCNTL-ACCESS.
   528             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   529             20  FILLER              PIC X       VALUE SPACES.
   530             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   531         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   532
   533     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   534
   535     12  ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL677.cbl
   536         16  ERACCT-CO               PIC X       VALUE SPACES.
   537         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   538         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   539         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   540         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   541         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   542         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   543
   544     12  SAVE-ERACCT-KEY.
   545         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   546         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   547         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   548         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   549         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   550         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   551         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   552
   553     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   554
   555     12  ERCOMP-KEY.
   556         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   557         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   558         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   559         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   560         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   561         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   562
   563     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   564
   565     12  ELCERT-KEY.
   566         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   567         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   568         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   569         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   570         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   571         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   572         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   573         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   574
   575     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   576
   577     12  ERPNDB-PRIMARY-KEY.
   578         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   579         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   580         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   581         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   582
   583     12  ERPNDB-ALT-KEY.
   584         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   585         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   586         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   587         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   588         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   589         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   590         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   591         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   592         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   593         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL677.cbl
   594
   595     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   596
   597     12  ERPNDM-PRIMARY-KEY.
   598         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   599         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   600         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   601         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   602
   603     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   604
   605     12  ERCHEK-KEY.
   606         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   607         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   608         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   609         16  CHEK-STATE              PIC XX      VALUE SPACES.
   610         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   611         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   612         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   613         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   614         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   615
   616     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   617     12  ERPYAJ-KEY.
   618         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   619         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   620         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   621         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   622         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   623         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   624         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   625
   626     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   627
   628 01  ERROR-NUMBERS.
   629     12  ER-0000                     PIC X(4)    VALUE '0000'.
   630     12  ER-0004                     PIC X(4)    VALUE '0004'.
   631     12  ER-0008                     PIC X(4)    VALUE '0008'.
   632     12  ER-0013                     PIC X(4)    VALUE '0013'.
   633     12  ER-0022                     PIC X(4)    VALUE '0022'.
   634     12  ER-0023                     PIC X(4)    VALUE '0023'.
   635     12  ER-0026                     PIC X(4)    VALUE '0026'.
   636     12  ER-0029                     PIC X(4)    VALUE '0029'.
   637     12  ER-0070                     PIC X(4)    VALUE '0070'.
   638     12  ER-0194                     PIC X(4)    VALUE '0194'.
   639     12  ER-0195                     PIC X(4)    VALUE '0195'.
   640     12  ER-0196                     PIC X(4)    VALUE '0196'.
   641     12  ER-0197                     PIC X(4)    VALUE '0197'.
   642     12  ER-0203                     PIC X(4)    VALUE '0203'.
   643     12  ER-0215                     PIC X(4)    VALUE '0215'.
   644     12  ER-0216                     PIC X(4)    VALUE '0216'.
   645     12  ER-0433                     PIC X(4)    VALUE '0433'.
   646     12  ER-0565                     PIC X(4)    VALUE '0565'.
   647     12  ER-1159                     PIC X(4)    VALUE '1159'.
   648     12  ER-1162                     PIC X(4)    VALUE '1162'.
   649     12  ER-2056                     PIC X(4)    VALUE '2056'.
   650     12  ER-2208                     PIC X(4)    VALUE '2208'.
   651     12  ER-2209                     PIC X(4)    VALUE '2209'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL677.cbl
   652     12  ER-2210                     PIC X(4)    VALUE '2210'.
   653     12  ER-2230                     PIC X(4)    VALUE '2230'.
   654     12  ER-2237                     PIC X(4)    VALUE '2237'.
   655     12  ER-2238                     PIC X(4)    VALUE '2238'.
   656     12  ER-2294                     PIC X(4)    VALUE '2294'.
   657     12  ER-2394                     PIC X(4)    VALUE '2394'.
   658     12  ER-2438                     PIC X(4)    VALUE '2438'.
   659     12  ER-2439                     PIC X(4)    VALUE '2439'.
   660     12  ER-2583                     PIC X(4)    VALUE '2583'.
   661     12  ER-2600                     PIC X(4)    VALUE '2600'.
   662     12  ER-2726                     PIC X(4)    VALUE '2726'.
   663     12  ER-2905                     PIC X(4)    VALUE '2905'.
   664     12  ER-2906                     PIC X(4)    VALUE '2906'.
   665     12  ER-2907                     PIC X(4)    VALUE '2907'.
   666     12  ER-2908                     PIC X(4)    VALUE '2908'.
   667     12  ER-2909                     PIC X(4)    VALUE '2909'.
   668     12  ER-3044                     PIC X(4)    VALUE '3044'.
   669     12  ER-3046                     PIC X(4)    VALUE '3046'.
   670     12  ER-3047                     PIC X(4)    VALUE '3047'.
   671     12  ER-3445                     PIC X(4)    VALUE '3445'.
   672     12  er-3450                     pic x(4)    value '3450'.
   673     12  er-3451                     pic x(4)    value '3451'.
   674     12  er-3452                     pic x(4)    value '3452'.
   675     12  er-3453                     pic x(4)    value '3453'.
   676     12  er-3454                     pic x(4)    value '3454'.
   677     12  er-3455                     pic x(4)    value '3455'.
   678     12  ER-7389                     PIC X(4)    VALUE '7389'.
   679*                                    COPY ELCLOGOF.
   680******************************************************************
   681*                                                                *
   682*                                                                *
   683*                            ELCLOGOF.                           *
   684*                            VMOD=2.001                          *
   685*                                                                *
   686*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   687*                                                                *
   688******************************************************************
   689 01  CLASIC-LOGOFF.
   690     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   691     12  LOGOFF-TEXT.
   692         16  FILLER          PIC X(5)    VALUE SPACES.
   693         16  LOGOFF-MSG.
   694             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   695             20  FILLER      PIC X       VALUE SPACES.
   696             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   697         16  FILLER          PIC X(80)
   698           VALUE '* YOU ARE NOW LOGGED OFF'.
   699         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   700         16  FILLER          PIC X       VALUE QUOTE.
   701         16  LOGOFF-SYS-MSG  PIC X(17)
   702           VALUE 'S CLAS-IC SYSTEM '.
   703     12  TEXT-MESSAGES.
   704         16  UNACCESS-MSG    PIC X(29)
   705             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   706         16  PGMIDERR-MSG    PIC X(17)
   707             VALUE 'PROGRAM NOT FOUND'.
   708*                                    COPY ELCDATE.
   709******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL677.cbl
   710*                                                                *
   711*                                                                *
   712*                            ELCDATE.                            *
   713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   714*                            VMOD=2.003
   715*                                                                *
   716*                                                                *
   717*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   718*                 LENGTH = 200                                   *
   719******************************************************************
   720
   721 01  DATE-CONVERSION-DATA.
   722     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   723     12  DC-OPTION-CODE                PIC X.
   724         88  BIN-TO-GREG                VALUE ' '.
   725         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   726         88  EDIT-GREG-TO-BIN           VALUE '2'.
   727         88  YMD-GREG-TO-BIN            VALUE '3'.
   728         88  MDY-GREG-TO-BIN            VALUE '4'.
   729         88  JULIAN-TO-BIN              VALUE '5'.
   730         88  BIN-PLUS-ELAPSED           VALUE '6'.
   731         88  FIND-CENTURY               VALUE '7'.
   732         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   733         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   734         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   735         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   736         88  JULIAN-TO-BIN-3            VALUE 'C'.
   737         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   738         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   739         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   740         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   741         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   742         88  CHECK-LEAP-YEAR            VALUE 'H'.
   743         88  BIN-3-TO-GREG              VALUE 'I'.
   744         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   745         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   746         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   747         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   748         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   749         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   750         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   751         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   752         88  THREE-CHARACTER-BIN
   753                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   754         88  GREGORIAN-TO-BIN
   755                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   756         88  BIN-TO-GREGORIAN
   757                  VALUES ' ' '1' 'I' '8' 'G'.
   758         88  JULIAN-TO-BINARY
   759                  VALUES '5' 'C' 'E' 'F'.
   760     12  DC-ERROR-CODE                 PIC X.
   761         88  NO-CONVERSION-ERROR        VALUE ' '.
   762         88  DATE-CONVERSION-ERROR
   763                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   764         88  DATE-IS-ZERO               VALUE '1'.
   765         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   766         88  DATE-IS-INVALID            VALUE '3'.
   767         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL677.cbl
   768         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   769         88  DATE-INVALID-OPTION        VALUE '9'.
   770         88  INVALID-CENTURY            VALUE 'A'.
   771         88  ONLY-CENTURY               VALUE 'B'.
   772         88  ONLY-LEAP-YEAR             VALUE 'C'.
   773         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   774     12  DC-END-OF-MONTH               PIC X.
   775         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   776     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   777         88  USE-NORMAL-PROCESS         VALUE ' '.
   778         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   779         88  ADJUST-UP-100-YRS          VALUE '2'.
   780     12  FILLER                        PIC X.
   781     12  DC-CONVERSION-DATES.
   782         16  DC-BIN-DATE-1             PIC XX.
   783         16  DC-BIN-DATE-2             PIC XX.
   784         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   785         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   786                       DC-GREG-DATE-1-EDIT.
   787             20  DC-EDIT1-MONTH        PIC 99.
   788             20  SLASH1-1              PIC X.
   789             20  DC-EDIT1-DAY          PIC 99.
   790             20  SLASH1-2              PIC X.
   791             20  DC-EDIT1-YEAR         PIC 99.
   792         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   793         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   794                     DC-GREG-DATE-2-EDIT.
   795             20  DC-EDIT2-MONTH        PIC 99.
   796             20  SLASH2-1              PIC X.
   797             20  DC-EDIT2-DAY          PIC 99.
   798             20  SLASH2-2              PIC X.
   799             20  DC-EDIT2-YEAR         PIC 99.
   800         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   801         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   802                     DC-GREG-DATE-1-YMD.
   803             20  DC-YMD-YEAR           PIC 99.
   804             20  DC-YMD-MONTH          PIC 99.
   805             20  DC-YMD-DAY            PIC 99.
   806         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   807         16  DC-GREG-DATE-1-MDY-R REDEFINES
   808                      DC-GREG-DATE-1-MDY.
   809             20  DC-MDY-MONTH          PIC 99.
   810             20  DC-MDY-DAY            PIC 99.
   811             20  DC-MDY-YEAR           PIC 99.
   812         16  DC-GREG-DATE-1-ALPHA.
   813             20  DC-ALPHA-MONTH        PIC X(10).
   814             20  DC-ALPHA-DAY          PIC 99.
   815             20  FILLER                PIC XX.
   816             20  DC-ALPHA-CENTURY.
   817                 24 DC-ALPHA-CEN-N     PIC 99.
   818             20  DC-ALPHA-YEAR         PIC 99.
   819         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   820         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   821         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   822         16  DC-JULIAN-DATE            PIC 9(05).
   823         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   824                                       PIC 9(05).
   825         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL677.cbl
   826             20  DC-JULIAN-YEAR        PIC 99.
   827             20  DC-JULIAN-DAYS        PIC 999.
   828         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   829         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   830         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   831     12  DATE-CONVERSION-VARIBLES.
   832         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   833         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   834             20  FILLER                PIC 9(3).
   835             20  HOLD-CEN-1-CCYY.
   836                 24  HOLD-CEN-1-CC     PIC 99.
   837                 24  HOLD-CEN-1-YY     PIC 99.
   838             20  HOLD-CEN-1-MO         PIC 99.
   839             20  HOLD-CEN-1-DA         PIC 99.
   840         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   841             20  HOLD-CEN-1-R-MO       PIC 99.
   842             20  HOLD-CEN-1-R-DA       PIC 99.
   843             20  HOLD-CEN-1-R-CCYY.
   844                 24  HOLD-CEN-1-R-CC   PIC 99.
   845                 24  HOLD-CEN-1-R-YY   PIC 99.
   846             20  FILLER                PIC 9(3).
   847         16  HOLD-CENTURY-1-X.
   848             20  FILLER                PIC X(3)  VALUE SPACES.
   849             20  HOLD-CEN-1-X-CCYY.
   850                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   851                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   852             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   853             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   854         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   855             20  HOLD-CEN-1-R-X-MO     PIC XX.
   856             20  HOLD-CEN-1-R-X-DA     PIC XX.
   857             20  HOLD-CEN-1-R-X-CCYY.
   858                 24  HOLD-CEN-1-R-X-CC PIC XX.
   859                 24  HOLD-CEN-1-R-X-YY PIC XX.
   860             20  FILLER                PIC XXX.
   861         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   862         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   863         16  DC-JULIAN-DATE-1          PIC 9(07).
   864         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   865             20  DC-JULIAN-1-CCYY.
   866                 24  DC-JULIAN-1-CC    PIC 99.
   867                 24  DC-JULIAN-1-YR    PIC 99.
   868             20  DC-JULIAN-DA-1        PIC 999.
   869         16  DC-JULIAN-DATE-2          PIC 9(07).
   870         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   871             20  DC-JULIAN-2-CCYY.
   872                 24  DC-JULIAN-2-CC    PIC 99.
   873                 24  DC-JULIAN-2-YR    PIC 99.
   874             20  DC-JULIAN-DA-2        PIC 999.
   875         16  DC-GREG-DATE-A-EDIT.
   876             20  DC-EDITA-MONTH        PIC 99.
   877             20  SLASHA-1              PIC X VALUE '/'.
   878             20  DC-EDITA-DAY          PIC 99.
   879             20  SLASHA-2              PIC X VALUE '/'.
   880             20  DC-EDITA-CCYY.
   881                 24  DC-EDITA-CENT     PIC 99.
   882                 24  DC-EDITA-YEAR     PIC 99.
   883         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL677.cbl
   884             20  DC-EDITB-MONTH        PIC 99.
   885             20  SLASHB-1              PIC X VALUE '/'.
   886             20  DC-EDITB-DAY          PIC 99.
   887             20  SLASHB-2              PIC X VALUE '/'.
   888             20  DC-EDITB-CCYY.
   889                 24  DC-EDITB-CENT     PIC 99.
   890                 24  DC-EDITB-YEAR     PIC 99.
   891         16  DC-GREG-DATE-CYMD         PIC 9(08).
   892         16  DC-GREG-DATE-CYMD-R REDEFINES
   893                              DC-GREG-DATE-CYMD.
   894             20  DC-CYMD-CEN           PIC 99.
   895             20  DC-CYMD-YEAR          PIC 99.
   896             20  DC-CYMD-MONTH         PIC 99.
   897             20  DC-CYMD-DAY           PIC 99.
   898         16  DC-GREG-DATE-MDCY         PIC 9(08).
   899         16  DC-GREG-DATE-MDCY-R REDEFINES
   900                              DC-GREG-DATE-MDCY.
   901             20  DC-MDCY-MONTH         PIC 99.
   902             20  DC-MDCY-DAY           PIC 99.
   903             20  DC-MDCY-CEN           PIC 99.
   904             20  DC-MDCY-YEAR          PIC 99.
   905    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   906        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   907    12  DC-EL310-DATE                  PIC X(21).
   908    12  FILLER                         PIC X(28).
   909*                                    COPY ELCATTR.
   910******************************************************************
   911*                                                                *
   912*                            ELCATTR.                            *
   913*                            VMOD=2.001                          *
   914*                                                                *
   915*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   916*                                                                *
   917*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   918*                                                                *
   919*                   POS 1   P=PROTECTED                          *
   920*                           U=UNPROTECTED                        *
   921*                           S=ASKIP                              *
   922*                   POS 2   A=ALPHA/NUMERIC                      *
   923*                           N=NUMERIC                            *
   924*                   POS 3   N=NORMAL                             *
   925*                           B=BRIGHT                             *
   926*                           D=DARK                               *
   927*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   928*                           OF=MODIFIED DATA TAG OFF             *
   929*                                                                *
   930*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   931******************************************************************
   932 01  ATTRIBUTE-LIST.
   933     12  AL-PABOF            PIC X       VALUE 'Y'.
   934     12  AL-PABON            PIC X       VALUE 'Z'.
   935     12  AL-PADOF            PIC X       VALUE '%'.
   936     12  AL-PADON            PIC X       VALUE '_'.
   937     12  AL-PANOF            PIC X       VALUE '-'.
   938     12  AL-PANON            PIC X       VALUE '/'.
   939     12  AL-SABOF            PIC X       VALUE '8'.
   940     12  AL-SABON            PIC X       VALUE '9'.
   941     12  AL-SADOF            PIC X       VALUE '@'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL677.cbl
   942     12  AL-SADON            PIC X       VALUE QUOTE.
   943     12  AL-SANOF            PIC X       VALUE '0'.
   944     12  AL-SANON            PIC X       VALUE '1'.
   945     12  AL-UABOF            PIC X       VALUE 'H'.
   946     12  AL-UABON            PIC X       VALUE 'I'.
   947     12  AL-UADOF            PIC X       VALUE '<'.
   948     12  AL-UADON            PIC X       VALUE '('.
   949     12  AL-UANOF            PIC X       VALUE ' '.
   950     12  AL-UANON            PIC X       VALUE 'A'.
   951     12  AL-UNBOF            PIC X       VALUE 'Q'.
   952     12  AL-UNBON            PIC X       VALUE 'R'.
   953     12  AL-UNDOF            PIC X       VALUE '*'.
   954     12  AL-UNDON            PIC X       VALUE ')'.
   955     12  AL-UNNOF            PIC X       VALUE '&'.
   956     12  AL-UNNON            PIC X       VALUE 'J'.
   957*                                    COPY ELCEMIB.
   958******************************************************************
   959*                                                                *
   960*                                                                *
   961*                            ELCEMIB.                            *
   962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   963*                            VMOD=2.005                          *
   964*                                                                *
   965*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   966*                                                                *
   967******************************************************************
   968 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   969     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   970     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   971     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   972     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   973     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   974     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   975     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   976     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   977     12  EMI-SWITCH1             PIC X        VALUE '1'.
   978         88  EMI-NO-ERRORS                    VALUE '1'.
   979         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   980         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   981     12  EMI-SWITCH2             PIC X        VALUE '1'.
   982         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   983     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   984         88  EMI-AREA1-EMPTY                  VALUE '1'.
   985         88  EMI-AREA1-FULL                   VALUE '2'.
   986     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   987         88  EMI-AREA2-EMPTY                  VALUE '1'.
   988         88  EMI-AREA2-FULL                   VALUE '2'.
   989     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   990         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   991         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   992         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   993         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   994         88  EMI-BYPASS-FATALS                VALUE 'X'.
   995     12  EMI-ERROR-LINES.
   996         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   997         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   998         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   999         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL677.cbl
  1000             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1001                 24  EMI-ERR-NUM         PIC X(4).
  1002                 24  EMI-FILLER          PIC X.
  1003                 24  EMI-SEV             PIC X.
  1004                 24  FILLER              PIC X.
  1005             20  FILLER                  PIC X(02).
  1006     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1007         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1008             20  EMI-ERROR-NUMBER    PIC X(4).
  1009             20  EMI-FILL            PIC X.
  1010             20  EMI-SEVERITY        PIC X.
  1011             20  FILLER              PIC X.
  1012             20  EMI-ERROR-TEXT.
  1013                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1014                 24  FILLER          PIC X(55).
  1015     12  EMI-SEVERITY-SAVE           PIC X.
  1016         88  EMI-NOTE                    VALUE 'N'.
  1017         88  EMI-WARNING                 VALUE 'W'.
  1018         88  EMI-FORCABLE                VALUE 'F'.
  1019         88  EMI-FATAL                   VALUE 'X'.
  1020     12  EMI-MESSAGE-FLAG            PIC X.
  1021         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1022         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1023     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1024     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1025         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1026         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1027         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1028     12  emi-claim-no                pic x(7).
  1029     12  emi-claim-type              pic x(6).
  1030     12  FILLER                      PIC X(124)  VALUE SPACES.
  1031     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1032     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1033     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1034     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1035*                                    COPY ELCINTF.
  1036******************************************************************
  1037*                                                                *
  1038*                                                                *
  1039*                            ELCINTF.                            *
  1040*                            VMOD=2.017                          *
  1041*                                                                *
  1042*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1043*                                                                *
  1044*       LENGTH = 1024                                            *
  1045*                                                                *
  1046******************************************************************
  1047*                   C H A N G E   L O G
  1048*
  1049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1050*-----------------------------------------------------------------
  1051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1052* EFFECTIVE    NUMBER
  1053*-----------------------------------------------------------------
  1054* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1055******************************************************************
  1056 01  PROGRAM-INTERFACE-BLOCK.
  1057     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL677.cbl
  1058     12  PI-CALLING-PROGRAM              PIC X(8).
  1059     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1060     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1061     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1062     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1063     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1064     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1065     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1066     12  PI-COMPANY-ID                   PIC XXX.
  1067     12  PI-COMPANY-CD                   PIC X.
  1068
  1069     12  PI-COMPANY-PASSWORD             PIC X(8).
  1070
  1071     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1072
  1073     12  PI-CONTROL-IN-PROGRESS.
  1074         16  PI-CARRIER                  PIC X.
  1075         16  PI-GROUPING                 PIC X(6).
  1076         16  PI-STATE                    PIC XX.
  1077         16  PI-ACCOUNT                  PIC X(10).
  1078         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1079                                         PIC X(10).
  1080         16  PI-CLAIM-CERT-GRP.
  1081             20  PI-CLAIM-NO             PIC X(7).
  1082             20  PI-CERT-NO.
  1083                 25  PI-CERT-PRIME       PIC X(10).
  1084                 25  PI-CERT-SFX         PIC X.
  1085             20  PI-CERT-EFF-DT          PIC XX.
  1086         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1087             20  PI-PLAN-CODE            PIC X(2).
  1088             20  PI-REVISION-NUMBER      PIC X(3).
  1089             20  PI-PLAN-EFF-DT          PIC X(2).
  1090             20  PI-PLAN-EXP-DT          PIC X(2).
  1091             20  FILLER                  PIC X(11).
  1092         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1093             20  PI-OE-REFERENCE-1.
  1094                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1095                 25  PI-OE-REF-1-SUFF    PIC XX.
  1096
  1097     12  PI-SESSION-IN-PROGRESS          PIC X.
  1098         88  CLAIM-SESSION                   VALUE '1'.
  1099         88  CREDIT-SESSION                  VALUE '2'.
  1100         88  WARRANTY-SESSION                VALUE '3'.
  1101         88  MORTGAGE-SESSION                VALUE '4'.
  1102         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1103
  1104
  1105*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1106
  1107     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1108     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1109
  1110     12  PI-CREDIT-USER                  PIC X.
  1111         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1112         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1113
  1114     12  PI-CLAIM-USER                   PIC X.
  1115         88  PI-NOT-CLAIM-USER               VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL677.cbl
  1116         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1117
  1118     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1119         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1120         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1121         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1122         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1123         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1124
  1125     12  PI-PROCESSOR-ID                 PIC X(4).
  1126
  1127     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1128
  1129     12  PI-MEMBER-CAPTION               PIC X(10).
  1130
  1131     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1132         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1133
  1134     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1135     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1136     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1137     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1138
  1139     12  PI-AH-OVERRIDE-L1               PIC X.
  1140     12  PI-AH-OVERRIDE-L2               PIC XX.
  1141     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1142     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1143
  1144     12  PI-NEW-SYSTEM                   PIC X(2).
  1145
  1146     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1147     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1148         88  PI-USES-PAID-TO                 VALUE '1'.
  1149     12  PI-CRDTCRD-SYSTEM.
  1150         16  PI-CRDTCRD-USER             PIC X.
  1151             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1152             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1153         16  PI-CC-MONTH-END-DT          PIC XX.
  1154     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1155
  1156     12  PI-OE-REFERENCE-2.
  1157         16  PI-OE-REF-2-PRIME           PIC X(10).
  1158         16  PI-OE-REF-2-SUFF            PIC X.
  1159
  1160     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1161
  1162     12  PI-LANGUAGE-TYPE                PIC X.
  1163             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1164             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1165             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1166
  1167     12  PI-POLICY-LINKAGE-IND           PIC X.
  1168         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1169         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1170                                                   LOW-VALUES.
  1171
  1172     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1173     12  PI-CLAIM-PW-SESSION             PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL677.cbl
  1174         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1175         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1176
  1177     12  PI-PROCESSOR-CSR-IND            PIC X.
  1178         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1179         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1180
  1181     12  FILLER                          PIC X(3).
  1182
  1183     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1184
  1185     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1186         PI-SYSTEM-LEVEL.
  1187
  1188         16  PI-ENTRY-CODES.
  1189             20  PI-ENTRY-CD-1           PIC X.
  1190             20  PI-ENTRY-CD-2           PIC X.
  1191
  1192         16  PI-RETURN-CODES.
  1193             20  PI-RETURN-CD-1          PIC X.
  1194             20  PI-RETURN-CD-2          PIC X.
  1195
  1196         16  PI-UPDATE-STATUS-SAVE.
  1197             20  PI-UPDATE-BY            PIC X(4).
  1198             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1199
  1200         16  PI-LOWER-CASE-LETTERS       PIC X.
  1201             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1202
  1203*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1204*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1205*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1206
  1207         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1208             88  ST-ACCNT-CNTL               VALUE ' '.
  1209             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1210             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1211             88  ACCNT-CNTL                  VALUE '3'.
  1212             88  CARR-ACCNT-CNTL             VALUE '4'.
  1213
  1214         16  PI-PROCESSOR-CAP-LIST.
  1215             20  PI-SYSTEM-CONTROLS.
  1216                24 PI-SYSTEM-DISPLAY     PIC X.
  1217                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1218                24 PI-SYSTEM-MODIFY      PIC X.
  1219                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1220             20  FILLER                  PIC XX.
  1221             20  PI-DISPLAY-CAP          PIC X.
  1222                 88  DISPLAY-CAP             VALUE 'Y'.
  1223             20  PI-MODIFY-CAP           PIC X.
  1224                 88  MODIFY-CAP              VALUE 'Y'.
  1225             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1226                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1227             20  PI-FORCE-CAP            PIC X.
  1228                 88  FORCE-CAP               VALUE 'Y'.
  1229
  1230         16  PI-PROGRAM-CONTROLS.
  1231             20  PI-PGM-PRINT-OPT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL677.cbl
  1232             20  PI-PGM-FORMAT-OPT       PIC X.
  1233             20  PI-PGM-PROCESS-OPT      PIC X.
  1234             20  PI-PGM-TOTALS-OPT       PIC X.
  1235
  1236         16  PI-HELP-INTERFACE.
  1237             20  PI-LAST-ERROR-NO        PIC X(4).
  1238             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1239
  1240         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1241             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1242
  1243         16  PI-CR-CONTROL-IN-PROGRESS.
  1244             20  PI-CR-CARRIER           PIC X.
  1245             20  PI-CR-GROUPING          PIC X(6).
  1246             20  PI-CR-STATE             PIC XX.
  1247             20  PI-CR-ACCOUNT           PIC X(10).
  1248             20  PI-CR-FIN-RESP          PIC X(10).
  1249             20  PI-CR-TYPE              PIC X.
  1250
  1251         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1252
  1253         16  PI-CR-MONTH-END-DT          PIC XX.
  1254
  1255         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1256             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1257             88  PI-ZERO-CARRIER             VALUE '1'.
  1258             88  PI-ZERO-GROUPING            VALUE '2'.
  1259             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1260
  1261         16  PI-CARRIER-SECURITY         PIC X.
  1262             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1263
  1264         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1265             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1266             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1267
  1268         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1269             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1270                                         INDEXED BY PI-ACCESS-NDX
  1271                                         PIC X.
  1272
  1273         16  PI-GA-BILLING-CONTROL       PIC X.
  1274             88  PI-GA-BILLING               VALUE '1'.
  1275
  1276         16  PI-MAIL-PROCESSING          PIC X.
  1277             88  PI-MAIL-YES                 VALUE 'Y'.
  1278
  1279         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1280
  1281         16  PI-AR-SYSTEM.
  1282             20  PI-AR-PROCESSING-CNTL   PIC X.
  1283                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1284             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1285             20  PI-AR-MONTH-END-DT      PIC XX.
  1286
  1287         16  PI-MP-SYSTEM.
  1288             20  PI-MORTGAGE-USER            PIC X.
  1289                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL677.cbl
  1290                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1291             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1292                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1293                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1294                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1295                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1296                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1297             20  PI-MP-MONTH-END-DT          PIC XX.
  1298             20  PI-MP-REFERENCE-NO.
  1299                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1300                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1301
  1302         16  PI-LABEL-CONTROL            PIC X(01).
  1303             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1304             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1305
  1306         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1307             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1308
  1309         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1310             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1311             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1312
  1313         16  FILLER                      PIC X(14).
  1314
  1315     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1316******************************************************************
  1317     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1318         16  PI-EOF-SW               PIC X.
  1319             88  PI-FILE-EOF                     VALUE 'Y'.
  1320         16  PI-PREV-MAINT           PIC X.
  1321         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1322         16  PI-ERCHEK-KEY.
  1323             20  PI-CHEK-COMP-CD     PIC X.
  1324             20  PI-CHEK-CARRIER     PIC X.
  1325             20  PI-CHEK-GROUPING    PIC X(6).
  1326             20  PI-CHEK-STATE       PIC XX.
  1327             20  PI-CHEK-ACCOUNT     PIC X(10).
  1328             20  PI-CHEK-EFF-DT      PIC XX.
  1329             20  PI-CHEK-CERT-NO     PIC X(10).
  1330             20  PI-CHEK-SUF-NO      PIC X.
  1331             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1332         16  PI-ACCOUNT-ADDRESS.
  1333             20  PI-AM-NAME          PIC X(30).
  1334             20  PI-AM-ADDRS         PIC X(30).
  1335             20  PI-AM-CITY-st.
  1336                 24  pi-am-city      PIC X(28).
  1337                 24  pi-am-st        pic xx.
  1338             20  PI-AM-ZIP-CODE.
  1339                 24  PI-AM-ZIP-PRIME PIC X(5).
  1340                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1341         16  PI-PROCESS-CERT-SW          PIC X.
  1342             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1343         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1344             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1345         16  PI-PAYTO1                   PIC X(30).
  1346         16  PI-REFERENCE                PIC X(12).
  1347         16  PI-CANC-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL677.cbl
  1348         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1349         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1350         16  PI-INSURED-NAME             PIC X(28).
  1351         16  PI-PFKEY                    PIC XXX.
  1352             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1353             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1354         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1355         16  PI-TYPE                     PIC X.
  1356         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1357         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1358         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1359         16  pi-chek-rec-cnt             pic s999 comp-3.
  1360         16  pi-am-csr                   pic x(4).
  1361         16  pi-return-to                pic x(30).
  1362         16  pi-prev-ded-comm            pic x.
  1363         16  pi-table-name               pic x(30).
  1364         16  pi-check-cashed             pic x.
  1365         16  FILLER                      PIC X(353).
  1366*                                    COPY ELCAID.
  1367******************************************************************
  1368*                                                                *
  1369*                            ELCAID.                             *
  1370*                            VMOD=2.001                          *
  1371*                                                                *
  1372*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1373*                                                                *
  1374*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1375*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1376******************************************************************
  1377
  1378 01  DFHAID.
  1379   02  DFHNULL   PIC  X  VALUE  ' '.
  1380   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1381   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1382   02  DFHPEN    PIC  X  VALUE  '='.
  1383   02  DFHOPID   PIC  X  VALUE  'W'.
  1384   02  DFHPA1    PIC  X  VALUE  '%'.
  1385   02  DFHPA2    PIC  X  VALUE  '>'.
  1386   02  DFHPA3    PIC  X  VALUE  ','.
  1387   02  DFHPF1    PIC  X  VALUE  '1'.
  1388   02  DFHPF2    PIC  X  VALUE  '2'.
  1389   02  DFHPF3    PIC  X  VALUE  '3'.
  1390   02  DFHPF4    PIC  X  VALUE  '4'.
  1391   02  DFHPF5    PIC  X  VALUE  '5'.
  1392   02  DFHPF6    PIC  X  VALUE  '6'.
  1393   02  DFHPF7    PIC  X  VALUE  '7'.
  1394   02  DFHPF8    PIC  X  VALUE  '8'.
  1395   02  DFHPF9    PIC  X  VALUE  '9'.
  1396   02  DFHPF10   PIC  X  VALUE  ':'.
  1397   02  DFHPF11   PIC  X  VALUE  '#'.
  1398   02  DFHPF12   PIC  X  VALUE  '@'.
  1399   02  DFHPF13   PIC  X  VALUE  'A'.
  1400   02  DFHPF14   PIC  X  VALUE  'B'.
  1401   02  DFHPF15   PIC  X  VALUE  'C'.
  1402   02  DFHPF16   PIC  X  VALUE  'D'.
  1403   02  DFHPF17   PIC  X  VALUE  'E'.
  1404   02  DFHPF18   PIC  X  VALUE  'F'.
  1405   02  DFHPF19   PIC  X  VALUE  'G'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL677.cbl
  1406   02  DFHPF20   PIC  X  VALUE  'H'.
  1407   02  DFHPF21   PIC  X  VALUE  'I'.
  1408*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1409   02  DFHPF22   PIC  X  VALUE  '['.
  1410   02  DFHPF23   PIC  X  VALUE  '.'.
  1411   02  DFHPF24   PIC  X  VALUE  '<'.
  1412   02  DFHMSRE   PIC  X  VALUE  'X'.
  1413   02  DFHSTRF   PIC  X  VALUE  'h'.
  1414   02  DFHTRIG   PIC  X  VALUE  '"'.
  1415 01  FILLER    REDEFINES DFHAID.
  1416     12  FILLER                      PIC X(8).
  1417     12  PF-VALUES                   PIC X       OCCURS 24.
  1418     12  FILLER                      PIC X(3).
  1419*                                    COPY EL677S.
  1420 01  EL677AI.
  1421     05  FILLER            PIC  X(0012).
  1422*    -------------------------------
  1423     05  DATEL PIC S9(0004) COMP.
  1424     05  DATEF PIC  X(0001).
  1425     05  FILLER REDEFINES DATEF.
  1426         10  DATEA PIC  X(0001).
  1427     05  DATEI PIC  X(0008).
  1428*    -------------------------------
  1429     05  TIMEL PIC S9(0004) COMP.
  1430     05  TIMEF PIC  X(0001).
  1431     05  FILLER REDEFINES TIMEF.
  1432         10  TIMEA PIC  X(0001).
  1433     05  TIMEI PIC  X(0005).
  1434*    -------------------------------
  1435     05  MAINTL PIC S9(0004) COMP.
  1436     05  MAINTF PIC  X(0001).
  1437     05  FILLER REDEFINES MAINTF.
  1438         10  MAINTA PIC  X(0001).
  1439     05  MAINTI PIC  X(0001).
  1440*    -------------------------------
  1441     05  DMAINT1L PIC S9(0004) COMP.
  1442     05  DMAINT1F PIC  X(0001).
  1443     05  FILLER REDEFINES DMAINT1F.
  1444         10  DMAINT1A PIC  X(0001).
  1445     05  DMAINT1I PIC  X(0009).
  1446*    -------------------------------
  1447     05  DMAINT2L PIC S9(0004) COMP.
  1448     05  DMAINT2F PIC  X(0001).
  1449     05  FILLER REDEFINES DMAINT2F.
  1450         10  DMAINT2A PIC  X(0001).
  1451     05  DMAINT2I PIC  X(0029).
  1452*    -------------------------------
  1453     05  CARRIERL PIC S9(0004) COMP.
  1454     05  CARRIERF PIC  X(0001).
  1455     05  FILLER REDEFINES CARRIERF.
  1456         10  CARRIERA PIC  X(0001).
  1457     05  CARRIERI PIC  X(0001).
  1458*    -------------------------------
  1459     05  GROUPL PIC S9(0004) COMP.
  1460     05  GROUPF PIC  X(0001).
  1461     05  FILLER REDEFINES GROUPF.
  1462         10  GROUPA PIC  X(0001).
  1463     05  GROUPI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL677.cbl
  1464*    -------------------------------
  1465     05  STATEL PIC S9(0004) COMP.
  1466     05  STATEF PIC  X(0001).
  1467     05  FILLER REDEFINES STATEF.
  1468         10  STATEA PIC  X(0001).
  1469     05  STATEI PIC  X(0002).
  1470*    -------------------------------
  1471     05  ACCTL PIC S9(0004) COMP.
  1472     05  ACCTF PIC  X(0001).
  1473     05  FILLER REDEFINES ACCTF.
  1474         10  ACCTA PIC  X(0001).
  1475     05  ACCTI PIC  X(0010).
  1476*    -------------------------------
  1477     05  EFFDTL PIC S9(0004) COMP.
  1478     05  EFFDTF PIC  X(0001).
  1479     05  FILLER REDEFINES EFFDTF.
  1480         10  EFFDTA PIC  X(0001).
  1481     05  EFFDTI PIC  X(0008).
  1482*    -------------------------------
  1483     05  CERTNOL PIC S9(0004) COMP.
  1484     05  CERTNOF PIC  X(0001).
  1485     05  FILLER REDEFINES CERTNOF.
  1486         10  CERTNOA PIC  X(0001).
  1487     05  CERTNOI PIC  X(0010).
  1488*    -------------------------------
  1489     05  SFXL PIC S9(0004) COMP.
  1490     05  SFXF PIC  X(0001).
  1491     05  FILLER REDEFINES SFXF.
  1492         10  SFXA PIC  X(0001).
  1493     05  SFXI PIC  X(0001).
  1494*    -------------------------------
  1495     05  SEQL PIC S9(0004) COMP.
  1496     05  SEQF PIC  X(0001).
  1497     05  FILLER REDEFINES SEQF.
  1498         10  SEQA PIC  X(0001).
  1499     05  SEQI PIC  99.
  1500*    -------------------------------
  1501     05  PAYTO1L PIC S9(0004) COMP.
  1502     05  PAYTO1F PIC  X(0001).
  1503     05  FILLER REDEFINES PAYTO1F.
  1504         10  PAYTO1A PIC  X(0001).
  1505     05  PAYTO1I PIC  X(0030).
  1506*    -------------------------------
  1507     05  CREATEDL PIC S9(0004) COMP.
  1508     05  CREATEDF PIC  X(0001).
  1509     05  FILLER REDEFINES CREATEDF.
  1510         10  CREATEDA PIC  X(0001).
  1511     05  CREATEDI PIC  X(0008).
  1512*    -------------------------------
  1513     05  CBYL PIC S9(0004) COMP.
  1514     05  CBYF PIC  X(0001).
  1515     05  FILLER REDEFINES CBYF.
  1516         10  CBYA PIC  X(0001).
  1517     05  CBYI PIC  X(0004).
  1518*    -------------------------------
  1519     05  PAYTO2L PIC S9(0004) COMP.
  1520     05  PAYTO2F PIC  X(0001).
  1521     05  FILLER REDEFINES PAYTO2F.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL677.cbl
  1522         10  PAYTO2A PIC  X(0001).
  1523     05  PAYTO2I PIC  X(0030).
  1524*    -------------------------------
  1525     05  PAYEEL PIC S9(0004) COMP.
  1526     05  PAYEEF PIC  X(0001).
  1527     05  FILLER REDEFINES PAYEEF.
  1528         10  PAYEEA PIC  X(0001).
  1529     05  PAYEEI PIC  X(0006).
  1530*    -------------------------------
  1531     05  APVSTATL PIC S9(0004) COMP.
  1532     05  APVSTATF PIC  X(0001).
  1533     05  FILLER REDEFINES APVSTATF.
  1534         10  APVSTATA PIC  X(0001).
  1535     05  APVSTATI PIC  X(0009).
  1536*    -------------------------------
  1537     05  PAYAD1L PIC S9(0004) COMP.
  1538     05  PAYAD1F PIC  X(0001).
  1539     05  FILLER REDEFINES PAYAD1F.
  1540         10  PAYAD1A PIC  X(0001).
  1541     05  PAYAD1I PIC  X(0030).
  1542*    -------------------------------
  1543     05  APVDTL PIC S9(0004) COMP.
  1544     05  APVDTF PIC  X(0001).
  1545     05  FILLER REDEFINES APVDTF.
  1546         10  APVDTA PIC  X(0001).
  1547     05  APVDTI PIC  X(0008).
  1548*    -------------------------------
  1549     05  APVBYL PIC S9(0004) COMP.
  1550     05  APVBYF PIC  X(0001).
  1551     05  FILLER REDEFINES APVBYF.
  1552         10  APVBYA PIC  X(0001).
  1553     05  APVBYI PIC  X(0004).
  1554*    -------------------------------
  1555     05  PAYAD2L PIC S9(0004) COMP.
  1556     05  PAYAD2F PIC  X(0001).
  1557     05  FILLER REDEFINES PAYAD2F.
  1558         10  PAYAD2A PIC  X(0001).
  1559     05  PAYAD2I PIC  X(0030).
  1560*    -------------------------------
  1561     05  VOIDEDL PIC S9(0004) COMP.
  1562     05  VOIDEDF PIC  X(0001).
  1563     05  FILLER REDEFINES VOIDEDF.
  1564         10  VOIDEDA PIC  X(0001).
  1565     05  VOIDEDI PIC  X(0008).
  1566*    -------------------------------
  1567     05  VBYL PIC S9(0004) COMP.
  1568     05  VBYF PIC  X(0001).
  1569     05  FILLER REDEFINES VBYF.
  1570         10  VBYA PIC  X(0001).
  1571     05  VBYI PIC  X(0004).
  1572*    -------------------------------
  1573     05  PAYCTYL PIC S9(0004) COMP.
  1574     05  PAYCTYF PIC  X(0001).
  1575     05  FILLER REDEFINES PAYCTYF.
  1576         10  PAYCTYA PIC  X(0001).
  1577     05  PAYCTYI PIC  X(0028).
  1578*    -------------------------------
  1579     05  PAYSTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL677.cbl
  1580     05  PAYSTF PIC  X(0001).
  1581     05  FILLER REDEFINES PAYSTF.
  1582         10  PAYSTA PIC  X(0001).
  1583     05  PAYSTI PIC  X(0002).
  1584*    -------------------------------
  1585     05  PRINTEDL PIC S9(0004) COMP.
  1586     05  PRINTEDF PIC  X(0001).
  1587     05  FILLER REDEFINES PRINTEDF.
  1588         10  PRINTEDA PIC  X(0001).
  1589     05  PRINTEDI PIC  X(0008).
  1590*    -------------------------------
  1591     05  PTOZIPL PIC S9(0004) COMP.
  1592     05  PTOZIPF PIC  X(0001).
  1593     05  FILLER REDEFINES PTOZIPF.
  1594         10  PTOZIPA PIC  X(0001).
  1595     05  PTOZIPI PIC  X(0009).
  1596*    -------------------------------
  1597     05  DEDCYNL PIC S9(0004) COMP.
  1598     05  DEDCYNF PIC  X(0001).
  1599     05  FILLER REDEFINES DEDCYNF.
  1600         10  DEDCYNA PIC  X(0001).
  1601     05  DEDCYNI PIC  X(0001).
  1602*    -------------------------------
  1603     05  CASHEDL PIC S9(0004) COMP.
  1604     05  CASHEDF PIC  X(0001).
  1605     05  FILLER REDEFINES CASHEDF.
  1606         10  CASHEDA PIC  X(0001).
  1607     05  CASHEDI PIC  X(0008).
  1608*    -------------------------------
  1609     05  RETTOL PIC S9(0004) COMP.
  1610     05  RETTOF PIC  X(0001).
  1611     05  FILLER REDEFINES RETTOF.
  1612         10  RETTOA PIC  X(0001).
  1613     05  RETTOI PIC  X(0030).
  1614*    -------------------------------
  1615     05  DPREML PIC S9(0004) COMP.
  1616     05  DPREMF PIC  X(0001).
  1617     05  FILLER REDEFINES DPREMF.
  1618         10  DPREMA PIC  X(0001).
  1619     05  DPREMI PIC  X(0005).
  1620*    -------------------------------
  1621     05  PREML PIC S9(0004) COMP.
  1622     05  PREMF PIC  X(0001).
  1623     05  FILLER REDEFINES PREMF.
  1624         10  PREMA PIC  X(0001).
  1625     05  PREMI PIC  X(0008).
  1626*    -------------------------------
  1627     05  DCOMML PIC S9(0004) COMP.
  1628     05  DCOMMF PIC  X(0001).
  1629     05  FILLER REDEFINES DCOMMF.
  1630         10  DCOMMA PIC  X(0001).
  1631     05  DCOMMI PIC  X(0005).
  1632*    -------------------------------
  1633     05  ISSCOMML PIC S9(0004) COMP.
  1634     05  ISSCOMMF PIC  X(0001).
  1635     05  FILLER REDEFINES ISSCOMMF.
  1636         10  ISSCOMMA PIC  X(0001).
  1637     05  ISSCOMMI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL677.cbl
  1638*    -------------------------------
  1639     05  DREFL PIC S9(0004) COMP.
  1640     05  DREFF PIC  X(0001).
  1641     05  FILLER REDEFINES DREFF.
  1642         10  DREFA PIC  X(0001).
  1643     05  DREFI PIC  X(0004).
  1644*    -------------------------------
  1645     05  REFL PIC S9(0004) COMP.
  1646     05  REFF PIC  X(0001).
  1647     05  FILLER REDEFINES REFF.
  1648         10  REFA PIC  X(0001).
  1649     05  REFI PIC  X(0008).
  1650*    -------------------------------
  1651     05  DUECOMML PIC S9(0004) COMP.
  1652     05  DUECOMMF PIC  X(0001).
  1653     05  FILLER REDEFINES DUECOMMF.
  1654         10  DUECOMMA PIC  X(0001).
  1655     05  DUECOMMI PIC  X(0007).
  1656*    -------------------------------
  1657     05  UECOMML PIC S9(0004) COMP.
  1658     05  UECOMMF PIC  X(0001).
  1659     05  FILLER REDEFINES UECOMMF.
  1660         10  UECOMMA PIC  X(0001).
  1661     05  UECOMMI PIC  X(0008).
  1662*    -------------------------------
  1663     05  DPREPDL PIC S9(0004) COMP.
  1664     05  DPREPDF PIC  X(0001).
  1665     05  FILLER REDEFINES DPREPDF.
  1666         10  DPREPDA PIC  X(0001).
  1667     05  DPREPDI PIC  X(0006).
  1668*    -------------------------------
  1669     05  PREPDL PIC S9(0004) COMP.
  1670     05  PREPDF PIC  X(0001).
  1671     05  FILLER REDEFINES PREPDF.
  1672         10  PREPDA PIC  X(0001).
  1673     05  PREPDI PIC  X(0008).
  1674*    -------------------------------
  1675     05  AMOUNTL PIC S9(0004) COMP.
  1676     05  AMOUNTF PIC  X(0001).
  1677     05  FILLER REDEFINES AMOUNTF.
  1678         10  AMOUNTA PIC  X(0001).
  1679     05  AMOUNTI PIC  S9(9)V99.
  1680*    -------------------------------
  1681     05  CHECKL PIC S9(0004) COMP.
  1682     05  CHECKF PIC  X(0001).
  1683     05  FILLER REDEFINES CHECKF.
  1684         10  CHECKA PIC  X(0001).
  1685     05  CHECKI PIC  X(0007).
  1686*    -------------------------------
  1687     05  TYPEL PIC S9(0004) COMP.
  1688     05  TYPEF PIC  X(0001).
  1689     05  FILLER REDEFINES TYPEF.
  1690         10  TYPEA PIC  X(0001).
  1691     05  TYPEI PIC  X(0001).
  1692*    -------------------------------
  1693     05  REASONL PIC S9(0004) COMP.
  1694     05  REASONF PIC  X(0001).
  1695     05  FILLER REDEFINES REASONF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL677.cbl
  1696         10  REASONA PIC  X(0001).
  1697     05  REASONI PIC  X(0025).
  1698*    -------------------------------
  1699     05  VREASONL PIC S9(0004) COMP.
  1700     05  VREASONF PIC  X(0001).
  1701     05  FILLER REDEFINES VREASONF.
  1702         10  VREASONA PIC  X(0001).
  1703     05  VREASONI PIC  X(0024).
  1704*    -------------------------------
  1705     05  STUBL PIC S9(0004) COMP.
  1706     05  STUBF PIC  X(0001).
  1707     05  FILLER REDEFINES STUBF.
  1708         10  STUBA PIC  X(0001).
  1709     05  STUBI PIC  X(0030).
  1710*    -------------------------------
  1711     05  TEXT1L PIC S9(0004) COMP.
  1712     05  TEXT1F PIC  X(0001).
  1713     05  FILLER REDEFINES TEXT1F.
  1714         10  TEXT1A PIC  X(0001).
  1715     05  TEXT1I PIC  X(0050).
  1716*    -------------------------------
  1717     05  TEXT2L PIC S9(0004) COMP.
  1718     05  TEXT2F PIC  X(0001).
  1719     05  FILLER REDEFINES TEXT2F.
  1720         10  TEXT2A PIC  X(0001).
  1721     05  TEXT2I PIC  X(0050).
  1722*    -------------------------------
  1723     05  TEXT3L PIC S9(0004) COMP.
  1724     05  TEXT3F PIC  X(0001).
  1725     05  FILLER REDEFINES TEXT3F.
  1726         10  TEXT3A PIC  X(0001).
  1727     05  TEXT3I PIC  X(0040).
  1728*    -------------------------------
  1729     05  ERRMSG1L PIC S9(0004) COMP.
  1730     05  ERRMSG1F PIC  X(0001).
  1731     05  FILLER REDEFINES ERRMSG1F.
  1732         10  ERRMSG1A PIC  X(0001).
  1733     05  ERRMSG1I PIC  X(0079).
  1734*    -------------------------------
  1735     05  ERRMSG2L PIC S9(0004) COMP.
  1736     05  ERRMSG2F PIC  X(0001).
  1737     05  FILLER REDEFINES ERRMSG2F.
  1738         10  ERRMSG2A PIC  X(0001).
  1739     05  ERRMSG2I PIC  X(0079).
  1740*    -------------------------------
  1741     05  PFENTERL PIC S9(0004) COMP.
  1742     05  PFENTERF PIC  X(0001).
  1743     05  FILLER REDEFINES PFENTERF.
  1744         10  PFENTERA PIC  X(0001).
  1745     05  PFENTERI PIC  9(2).
  1746*    -------------------------------
  1747     05  PF357L PIC S9(0004) COMP.
  1748     05  PF357F PIC  X(0001).
  1749     05  FILLER REDEFINES PF357F.
  1750         10  PF357A PIC  X(0001).
  1751     05  PF357I PIC  X(0050).
  1752*    -------------------------------
  1753     05  PF46L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL677.cbl
  1754     05  PF46F PIC  X(0001).
  1755     05  FILLER REDEFINES PF46F.
  1756         10  PF46A PIC  X(0001).
  1757     05  PF46I PIC  X(0033).
  1758 01  EL677AO REDEFINES EL677AI.
  1759     05  FILLER            PIC  X(0012).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  DATEO PIC  X(0008).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  TIMEO PIC  99.99.
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  MAINTO PIC  X(0001).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  DMAINT1O PIC  X(0009).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  DMAINT2O PIC  X(0029).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  CARRIERO PIC  X(0001).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  GROUPO PIC  X(0006).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  STATEO PIC  X(0002).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  ACCTO PIC  X(0010).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  EFFDTO PIC  99B99B99.
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  CERTNOO PIC  X(0010).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  SFXO PIC  X(0001).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  SEQO PIC  99.
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  PAYTO1O PIC  X(0030).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  CREATEDO PIC  X(0008).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  CBYO PIC  X(0004).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  PAYTO2O PIC  X(0030).
  1811*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL677.cbl
  1812     05  FILLER            PIC  X(0003).
  1813     05  PAYEEO PIC  X(0006).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  APVSTATO PIC  X(0009).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  PAYAD1O PIC  X(0030).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  APVDTO PIC  X(0008).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  APVBYO PIC  X(0004).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  PAYAD2O PIC  X(0030).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  VOIDEDO PIC  X(0008).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  VBYO PIC  X(0004).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  PAYCTYO PIC  X(0028).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  PAYSTO PIC  X(0002).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  PRINTEDO PIC  99B99B99.
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  PTOZIPO PIC  X(0009).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  DEDCYNO PIC  X(0001).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  CASHEDO PIC  X(0008).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  RETTOO PIC  X(0030).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  DPREMO PIC  X(0005).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  PREMO PIC  Z(5).99.
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  DCOMMO PIC  X(0005).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  ISSCOMMO PIC  Z(5).99.
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL677.cbl
  1870     05  DREFO PIC  X(0004).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  REFO PIC  Z(5).99.
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  DUECOMMO PIC  X(0007).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  UECOMMO PIC  Z(5).99.
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  DPREPDO PIC  X(0006).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  PREPDO PIC  Z(5).99.
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  AMOUNTO PIC  Z(7).ZZ-.
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  CHECKO PIC  X(0007).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  TYPEO PIC  X(0001).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  REASONO PIC  X(0025).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  VREASONO PIC  X(0024).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  STUBO PIC  X(0030).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  TEXT1O PIC  X(0050).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  TEXT2O PIC  X(0050).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  TEXT3O PIC  X(0040).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  ERRMSG1O PIC  X(0079).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  ERRMSG2O PIC  X(0079).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  PFENTERO PIC  99.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  PF357O PIC  X(0050).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  PF46O PIC  X(0033).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL677.cbl
  1928*    -------------------------------
  1929****************************************************************
  1930*
  1931* Copyright (c) 2007 by Clerity Solutions, Inc.
  1932* All rights reserved.
  1933*
  1934****************************************************************
  1935 01  DFHEIV.
  1936   02  DFHEIV0               PIC X(35).
  1937   02  DFHEIV1               PIC X(08).
  1938   02  DFHEIV2               PIC X(08).
  1939   02  DFHEIV3               PIC X(08).
  1940   02  DFHEIV4               PIC X(06).
  1941   02  DFHEIV5               PIC X(04).
  1942   02  DFHEIV6               PIC X(04).
  1943   02  DFHEIV7               PIC X(02).
  1944   02  DFHEIV8               PIC X(02).
  1945   02  DFHEIV9               PIC X(01).
  1946   02  DFHEIV10              PIC S9(7) COMP-3.
  1947   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1948   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1949   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1950   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1951   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1952   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1953   02  DFHEIV17              PIC X(04).
  1954   02  DFHEIV18              PIC X(04).
  1955   02  DFHEIV19              PIC X(04).
  1956   02  DFHEIV20              USAGE IS POINTER.
  1957   02  DFHEIV21              USAGE IS POINTER.
  1958   02  DFHEIV22              USAGE IS POINTER.
  1959   02  DFHEIV23              USAGE IS POINTER.
  1960   02  DFHEIV24              USAGE IS POINTER.
  1961   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1962   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1963   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1964   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1965   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1966   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1967   02  FILLER                PIC X(02).
  1968   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1969   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1970   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1971   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1972   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1973 LINKAGE  SECTION.
  1974*****************************************************************
  1975*                                                               *
  1976* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1977* All rights reserved.                                          *
  1978*                                                               *
  1979*****************************************************************
  1980 01  dfheiblk.
  1981     02  eibtime          pic s9(7) comp-3.
  1982     02  eibdate          pic s9(7) comp-3.
  1983     02  eibtrnid         pic x(4).
  1984     02  eibtaskn         pic s9(7) comp-3.
  1985     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL677.cbl
  1986     02  dfheigdi         pic s9(4) comp.
  1987     02  eibcposn         pic s9(4) comp.
  1988     02  eibcalen         pic s9(4) comp.
  1989     02  eibaid           pic x(1).
  1990     02  eibfiller1       pic x(1).
  1991     02  eibfn            pic x(2).
  1992     02  eibfiller2       pic x(2).
  1993     02  eibrcode         pic x(6).
  1994     02  eibfiller3       pic x(2).
  1995     02  eibds            pic x(8).
  1996     02  eibreqid         pic x(8).
  1997     02  eibrsrce         pic x(8).
  1998     02  eibsync          pic x(1).
  1999     02  eibfree          pic x(1).
  2000     02  eibrecv          pic x(1).
  2001     02  eibsend          pic x(1).
  2002     02  eibatt           pic x(1).
  2003     02  eibeoc           pic x(1).
  2004     02  eibfmh           pic x(1).
  2005     02  eibcompl         pic x(1).
  2006     02  eibsig           pic x(1).
  2007     02  eibconf          pic x(1).
  2008     02  eiberr           pic x(1).
  2009     02  eibrldbk         pic x(1).
  2010     02  eiberrcd         pic x(4).
  2011     02  eibsynrb         pic x(1).
  2012     02  eibnodat         pic x(1).
  2013     02  eibfiller5       pic x(2).
  2014     02  eibresp          pic 9(09) comp.
  2015     02  eibresp2         pic 9(09) comp.
  2016     02  dfheigdj         pic s9(4) comp.
  2017     02  dfheigdk         pic s9(4) comp.
  2018 01  DFHCOMMAREA                     PIC X(1024).
  2019 01  var  pic x(30).
  2020*                                    COPY ELCCNTL.
  2021******************************************************************
  2022*                                                                *
  2023*                                                                *
  2024*                            ELCCNTL.                            *
  2025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2026*                            VMOD=2.059                          *
  2027*                                                                *
  2028*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2029*                                                                *
  2030*   FILE TYPE = VSAM,KSDS                                        *
  2031*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2032*                                                                *
  2033*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2034*       ALTERNATE INDEX = NONE                                   *
  2035*                                                                *
  2036*   LOG = YES                                                    *
  2037*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2038******************************************************************
  2039*                   C H A N G E   L O G
  2040*
  2041* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2042*-----------------------------------------------------------------
  2043*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL677.cbl
  2044* EFFECTIVE    NUMBER
  2045*-----------------------------------------------------------------
  2046* 082503                   PEMA  ADD BENEFIT GROUP
  2047* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2048* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2049* 092705    2005050300006  PEMA  ADD SPP LEASES
  2050* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2051* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2052* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2053* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2054* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2055* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2056* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2057* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2058* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2059* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2060******************************************************************
  2061*
  2062 01  CONTROL-FILE.
  2063     12  CF-RECORD-ID                       PIC XX.
  2064         88  VALID-CF-ID                        VALUE 'CF'.
  2065
  2066     12  CF-CONTROL-PRIMARY.
  2067         16  CF-COMPANY-ID                  PIC XXX.
  2068         16  CF-RECORD-TYPE                 PIC X.
  2069             88  CF-COMPANY-MASTER              VALUE '1'.
  2070             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2071             88  CF-STATE-MASTER                VALUE '3'.
  2072             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2073             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2074             88  CF-CARRIER-MASTER              VALUE '6'.
  2075             88  CF-MORTALITY-MASTER            VALUE '7'.
  2076             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2077             88  CF-TERMINAL-MASTER             VALUE '9'.
  2078             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2079             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2080             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2081             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2082             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2083             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2084             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2085             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2086             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2087         16  CF-ACCESS-CD-GENL              PIC X(4).
  2088         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2089             20  CF-PROCESSOR               PIC X(4).
  2090         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2091             20  CF-STATE-CODE              PIC XX.
  2092             20  FILLER                     PIC XX.
  2093         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2094             20  FILLER                     PIC XX.
  2095             20  CF-HI-BEN-IN-REC           PIC XX.
  2096         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2097             20  FILLER                     PIC XXX.
  2098             20  CF-CARRIER-CNTL            PIC X.
  2099         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2100             20  FILLER                     PIC XX.
  2101             20  CF-HI-TYPE-IN-REC          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL677.cbl
  2102         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2103             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2104                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2105             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2106             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2107         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2108             20  FILLER                     PIC X.
  2109             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2110         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2111             20  FILLER                     PIC XX.
  2112             20  CF-MORTGAGE-PLAN           PIC XX.
  2113         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2114
  2115     12  CF-LAST-MAINT-DT                   PIC XX.
  2116     12  CF-LAST-MAINT-BY                   PIC X(4).
  2117     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2118
  2119     12  CF-RECORD-BODY                     PIC X(728).
  2120
  2121
  2122****************************************************************
  2123*             COMPANY MASTER RECORD                            *
  2124****************************************************************
  2125
  2126     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2127         16  CF-COMPANY-ADDRESS.
  2128             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2129             20  CF-CL-IN-CARE-OF           PIC X(30).
  2130             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2131             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2132             20  CF-CL-CITY-STATE           PIC X(30).
  2133             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2134             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2135         16  CF-COMPANY-CD                  PIC X.
  2136         16  CF-COMPANY-PASSWORD            PIC X(8).
  2137         16  CF-SECURITY-OPTION             PIC X.
  2138             88  ALL-SECURITY                   VALUE '1'.
  2139             88  COMPANY-VERIFY                 VALUE '2'.
  2140             88  PROCESSOR-VERIFY               VALUE '3'.
  2141             88  NO-SECURITY                    VALUE '4'.
  2142             88  ALL-BUT-TERM                   VALUE '5'.
  2143         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2144             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2145         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2146             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2147         16  CF-INFORCE-LOCATION            PIC X.
  2148             88  CERTS-ARE-ONLINE               VALUE '1'.
  2149             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2150             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2151         16  CF-LOWER-CASE-LETTERS          PIC X.
  2152         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2153             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2154             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2155             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2156             88  CF-ACCNT-CNTL                  VALUE '3'.
  2157             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2158
  2159         16  CF-FORMS-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL677.cbl
  2160         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2161
  2162         16  CF-LGX-CREDIT-USER             PIC X.
  2163             88  CO-IS-NOT-USER                 VALUE 'N'.
  2164             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2165
  2166         16 CF-CREDIT-CALC-CODES.
  2167             20  CF-CR-REM-TERM-CALC PIC X.
  2168               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2169               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2170               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2171               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2172               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2173               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2174               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2175             20  CF-CR-R78-METHOD           PIC X.
  2176               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2177               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2178
  2179         16  CF-CLAIM-CONTROL-COUNTS.
  2180             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2181                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2182
  2183             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2184                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2185
  2186             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2187                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2188
  2189             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2190                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2191
  2192         16  CF-CURRENT-MONTH-END           PIC XX.
  2193
  2194         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2195             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2196             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2197             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2198             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2199                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2200                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2201             20  CF-CO-PREM-REJECT-SW       PIC X.
  2202                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2203                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2204             20  CF-CO-REF-REJECT-SW        PIC X.
  2205                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2206                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2207
  2208         16  CF-CO-REPORTING-DT             PIC XX.
  2209         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2210         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2211           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2212           88  CF-CO-MONTH-END                  VALUE '1'.
  2213
  2214         16  CF-LGX-CLAIM-USER              PIC X.
  2215             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2216             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2217
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL677.cbl
  2218         16  CF-CREDIT-EDIT-CONTROLS.
  2219             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2220             20  CF-MIN-AGE                 PIC 99.
  2221             20  CF-DEFAULT-AGE             PIC 99.
  2222             20  CF-MIN-TERM                PIC S999      COMP-3.
  2223             20  CF-MAX-TERM                PIC S999      COMP-3.
  2224             20  CF-DEFAULT-SEX             PIC X.
  2225             20  CF-JOINT-AGE-INPUT         PIC X.
  2226                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2227             20  CF-BIRTH-DATE-INPUT        PIC X.
  2228                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2229             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2230                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2231                 88  CF-ZERO-CARRIER            VALUE '1'.
  2232                 88  CF-ZERO-GROUPING           VALUE '2'.
  2233                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2234             20  CF-EDIT-SW                 PIC X.
  2235                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2236             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2237             20  CF-CR-PR-METHOD            PIC X.
  2238               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2239               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2240             20  FILLER                     PIC X.
  2241
  2242         16  CF-CREDIT-MISC-CONTROLS.
  2243             20  CF-REIN-TABLE-SW           PIC X.
  2244                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2245             20  CF-COMP-TABLE-SW           PIC X.
  2246                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2247             20  CF-EXPERIENCE-RETENTION-AGE
  2248                                            PIC S9        COMP-3.
  2249             20  CF-CONVERSION-DT           PIC XX.
  2250             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2251             20  CF-RUN-FREQUENCY-SW        PIC X.
  2252                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2253                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2254
  2255             20  CF-CR-CHECK-NO-CONTROL.
  2256                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2257                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2258                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2259                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2260                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2261                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2262
  2263                 24  CF-CR-CHECK-COUNT       REDEFINES
  2264                     CF-CR-CHECK-COUNTER      PIC X(4).
  2265
  2266                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2267                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2268
  2269                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2270                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2271                 24  CF-MAIL-PROCESSING       PIC X.
  2272                     88  MAIL-PROCESSING          VALUE 'Y'.
  2273
  2274         16  CF-MISC-SYSTEM-CONTROL.
  2275             20  CF-SYSTEM-C                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL677.cbl
  2276                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2277             20  CF-SYSTEM-D                 PIC X.
  2278                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2279             20  CF-SOC-SEC-NO-SW            PIC X.
  2280                 88  SOC-SEC-NO-USED             VALUE '1'.
  2281             20  CF-MEMBER-NO-SW             PIC X.
  2282                 88  MEMBER-NO-USED              VALUE '1'.
  2283             20  CF-TAX-ID-NUMBER            PIC X(11).
  2284             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2285             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2286                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2287                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2288                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2289                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2290             20  CF-SYSTEM-E                 PIC X.
  2291                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2292
  2293         16  CF-LGX-LIFE-USER               PIC X.
  2294             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2295             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2296
  2297         16  CF-CR-MONTH-END-DT             PIC XX.
  2298
  2299         16  CF-FILE-MAINT-DATES.
  2300             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2301                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2302             20  CF-LAST-BATCH       REDEFINES
  2303                 CF-LAST-BATCH-NO               PIC X(4).
  2304             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2305             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2306             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2307             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2308             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2309             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2310             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2311             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2312             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2313             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2314
  2315         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2316         16  FILLER                         PIC X.
  2317
  2318         16  CF-ALT-MORT-CODE               PIC X(4).
  2319         16  CF-MEMBER-CAPTION              PIC X(10).
  2320
  2321         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2322             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2323             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2324             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2325             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2326             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2327
  2328         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2329
  2330         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2331         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2332         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2333         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL677.cbl
  2334
  2335         16  CF-AH-OVERRIDE-L1              PIC X.
  2336         16  CF-AH-OVERRIDE-L2              PIC XX.
  2337         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2338         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2339
  2340         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2341         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2342
  2343         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2344         16  CF-AR-LAST-EL860-DT            PIC XX.
  2345         16  CF-MP-MONTH-END-DT             PIC XX.
  2346
  2347         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2348         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2349             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2350
  2351         16  CF-AR-MONTH-END-DT             PIC XX.
  2352
  2353         16  CF-CRDTCRD-USER                PIC X.
  2354             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2355             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2356
  2357         16  CF-CC-MONTH-END-DT             PIC XX.
  2358
  2359         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2360
  2361         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2362             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2363             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2364             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2365         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2366         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2367         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2368         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2369             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2370             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2371         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2372         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2373         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2374             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2375         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2376
  2377         16  CF-CL-ZIP-CODE.
  2378             20  CF-CL-ZIP-PRIME.
  2379                 24  CF-CL-ZIP-1ST          PIC X.
  2380                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2381                 24  FILLER                 PIC X(4).
  2382             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2383         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2384             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2385             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2386             20  FILLER                     PIC XXX.
  2387
  2388         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2389         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2390         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2391         16  CF-CO-OPTION-START-DATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL677.cbl
  2392         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2393           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2394                                                      '3' '4'.
  2395           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2396           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2397           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2398           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2399           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2400           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2401
  2402         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2403
  2404         16  CF-PAYMENT-APPROVAL-LEVELS.
  2405             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2406             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2407             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2408             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2409             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2410             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2411
  2412         16  CF-END-USER-REPORTING-USER     PIC X.
  2413             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2414             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2415
  2416         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2417             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2418             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2419
  2420         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2421
  2422         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2423         16  FILLER                         PIC X.
  2424
  2425         16  CF-CREDIT-ARCHIVE-CNTL.
  2426             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2427             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2428             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2429
  2430         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2431
  2432         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2433             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2434             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2435
  2436         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2437             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2438             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2439
  2440         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2441
  2442         16  CF-CO-ACH-ID-CODE              PIC  X.
  2443             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2444             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2445             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2446         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2447         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2448         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2449         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL677.cbl
  2450         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2451         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2452         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2453         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2454         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2455                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2456         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2457                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2458
  2459         16  CF-CO-OVER-SHORT.
  2460             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2461             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2462
  2463*         16  FILLER                         PIC X(102).
  2464         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2465             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2466             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2467
  2468         16  CF-AH-APPROVAL-DAYS.
  2469             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2470             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2471             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2472             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2473
  2474         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2475
  2476         16  CF-APPROV-LEV-5.
  2477             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2478             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2479             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2480
  2481         16  FILLER                         PIC X(68).
  2482****************************************************************
  2483*             PROCESSOR/USER RECORD                            *
  2484****************************************************************
  2485
  2486     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2487         16  CF-PROCESSOR-NAME              PIC X(30).
  2488         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2489         16  CF-PROCESSOR-TITLE             PIC X(26).
  2490         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2491                 88  MESSAGE-YES                VALUE 'Y'.
  2492                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2493
  2494*****************************************************
  2495****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2496****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2497****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2498****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2499*****************************************************
  2500
  2501         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2502             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2503             20  CF-APPLICATION-FORCE       PIC X.
  2504             20  CF-INDIVIDUAL-APP.
  2505                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2506                     28  CF-BROWSE-APP      PIC X.
  2507                     28  CF-UPDATE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL677.cbl
  2508
  2509         16  CF-CURRENT-TERM-ON             PIC X(4).
  2510         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2511             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2512             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2513             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2514             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2515             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2516             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2517             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2518         16  CF-PROCESSOR-CARRIER           PIC X.
  2519             88  NO-CARRIER-SECURITY            VALUE ' '.
  2520         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2521             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2522         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2523             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2524         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2525             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2526
  2527         16  CF-PROC-SYS-ACCESS-SW.
  2528             20  CF-PROC-CREDIT-CLAIMS-SW.
  2529                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2530                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2531                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2532                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2533             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2534                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2535                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2536             20  CF-PROC-LIFE-GNRLDGR-SW.
  2537                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2538                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2539                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2540                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2541             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2542                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2543                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2544         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2545             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2546             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2547         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2548
  2549         16  CF-APPROVAL-LEVEL                  PIC X.
  2550             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2551             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2552             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2553             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2554             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2555
  2556         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2557
  2558         16  CF-LANGUAGE-TYPE                   PIC X.
  2559             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2560             88  CF-LANG-IS-FR                      VALUE 'F'.
  2561
  2562         16  CF-CSR-IND                         PIC X.
  2563         16  FILLER                             PIC X(239).
  2564
  2565****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL677.cbl
  2566*             PROCESSOR/REMINDERS RECORD                       *
  2567****************************************************************
  2568
  2569     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2570         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2571             20  CF-START-REMIND-DT         PIC XX.
  2572             20  CF-END-REMIND-DT           PIC XX.
  2573             20  CF-REMINDER-TEXT           PIC X(50).
  2574         16  FILLER                         PIC X(296).
  2575
  2576
  2577****************************************************************
  2578*             STATE MASTER RECORD                              *
  2579****************************************************************
  2580
  2581     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2582         16  CF-STATE-ABBREVIATION          PIC XX.
  2583         16  CF-STATE-NAME                  PIC X(25).
  2584         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2585         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2586             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2587             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2588             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2589             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2590                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2591                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2592             20  CF-ST-PREM-REJECT-SW       PIC X.
  2593                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2594                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2595             20  CF-ST-REF-REJECT-SW        PIC X.
  2596                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2597                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2598         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2599         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2600         16  CF-ST-REFUND-RULES.
  2601             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2602             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2603             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2604         16  CF-ST-FST-PMT-EXTENSION.
  2605             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2606             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2607                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2608                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2609                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2610                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2611         16  CF-ST-STATE-CALL.
  2612             20  CF-ST-CALL-UNEARNED        PIC X.
  2613             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2614             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2615         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2616             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2617             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2618         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2619         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2620         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2621         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2622         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2623         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL677.cbl
  2624         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2625             20  CF-ST-BENEFIT-CD           PIC XX.
  2626             20  CF-ST-BENEFIT-KIND         PIC X.
  2627                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2628                 88  CF-ST-AH-KIND              VALUE 'A'.
  2629             20  CF-ST-REM-TERM-CALC        PIC X.
  2630                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2631                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2632                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2633                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2634                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2635                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2636                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2637                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2638
  2639             20  CF-ST-REFUND-CALC          PIC X.
  2640                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2641                 88  ST-REFD-BY-R78             VALUE '1'.
  2642                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2643                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2644                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2645                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2646                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2647                 88  ST-REFD-UTAH               VALUE '7'.
  2648                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2649                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2650                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2651
  2652             20  CF-ST-EARNING-CALC         PIC X.
  2653                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2654                 88  ST-EARN-BY-R78             VALUE '1'.
  2655                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2656                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2657                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2658                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2659                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2660                 88  ST-EARN-MEAN               VALUE '8'.
  2661                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2662
  2663             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2664                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2665                 88  ST-OVRD-BY-R78             VALUE '1'.
  2666                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2667                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2668                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2669                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2670                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2671                 88  ST-OVRD-MEAN               VALUE '8'.
  2672                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2673             20  FILLER                     PIC X.
  2674
  2675         16  CF-ST-COMMISSION-CAPS.
  2676             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2677             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2678             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2679             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2680         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2681                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL677.cbl
  2682
  2683         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2684
  2685         16  CF-ST-STATUTORY-INTEREST.
  2686             20  CF-ST-STAT-DATE-FROM       PIC X.
  2687                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2688                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2689             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2690             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2691             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2692             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2693             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2694
  2695         16  CF-ST-OVER-SHORT.
  2696             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2697             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2698
  2699         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2700
  2701         16  CF-ST-RT-CALC                  PIC X.
  2702
  2703         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2704         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2705         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2706         16  CF-ST-RF-LR-CALC               PIC X.
  2707         16  CF-ST-RF-LL-CALC               PIC X.
  2708         16  CF-ST-RF-LN-CALC               PIC X.
  2709         16  CF-ST-RF-AH-CALC               PIC X.
  2710         16  CF-ST-RF-CP-CALC               PIC X.
  2711*        16  FILLER                         PIC X(206).
  2712*CIDMOD         16  FILLER                         PIC X(192).
  2713         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2714             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2715         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2716         16  CF-ST-VFY-2ND-BENE             PIC X.
  2717         16  CF-ST-CAUSAL-STATE             PIC X.
  2718         16  FILLER                         PIC X(185).
  2719
  2720****************************************************************
  2721*             BENEFIT MASTER RECORD                            *
  2722****************************************************************
  2723
  2724     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2725         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2726             20  CF-BENEFIT-CODE            PIC XX.
  2727             20  CF-BENEFIT-NUMERIC  REDEFINES
  2728                 CF-BENEFIT-CODE            PIC XX.
  2729             20  CF-BENEFIT-ALPHA           PIC XXX.
  2730             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2731             20  CF-BENEFIT-COMMENT         PIC X(10).
  2732
  2733             20  CF-LF-COVERAGE-TYPE        PIC X.
  2734                 88  CF-REDUCING                VALUE 'R'.
  2735                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2736
  2737             20  CF-SPECIAL-CALC-CD         PIC X.
  2738                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2739                 88  CF-NP-0-MO-INT             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL677.cbl
  2740                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2741                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2742                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2743                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2744                 88  CF-FARM-PLAN               VALUE 'F'.
  2745                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2746                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2747                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2748                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2749                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2750                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2751                 88  CF-PRUDENTIAL              VALUE 'P'.
  2752                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2753                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2754                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2755                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2756                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2757                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2758
  2759             20  CF-JOINT-INDICATOR         PIC X.
  2760                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2761
  2762*            20  FILLER                     PIC X(12).
  2763             20  cf-maximum-benefits        pic s999 comp-3.
  2764             20  FILLER                     PIC X(09).
  2765             20  CF-BENEFIT-CATEGORY        PIC X.
  2766             20  CF-LOAN-TYPE               PIC X(8).
  2767
  2768             20  CF-CO-REM-TERM-CALC        PIC X.
  2769                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2770                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2771                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2772                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2773                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2774
  2775             20  CF-CO-EARNINGS-CALC        PIC X.
  2776                 88  CO-EARN-BY-R78             VALUE '1'.
  2777                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2778                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2779                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2780                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2781                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2782                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2783                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2784
  2785             20  CF-CO-REFUND-CALC          PIC X.
  2786                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2787                 88  CO-REFD-BY-R78             VALUE '1'.
  2788                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2789                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2790                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2791                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2792                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2793                 88  CO-REFD-MEAN               VALUE '8'.
  2794                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2795                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2796                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2797
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL677.cbl
  2798             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2799                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2800                 88  CO-OVRD-BY-R78             VALUE '1'.
  2801                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2802                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2803                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2804                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2805                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2806                 88  CO-OVRD-MEAN               VALUE '8'.
  2807                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2808
  2809             20  CF-CO-BEN-I-G-CD           PIC X.
  2810                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2811                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2812                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2813
  2814         16  FILLER                         PIC X(304).
  2815
  2816
  2817****************************************************************
  2818*             CARRIER MASTER RECORD                            *
  2819****************************************************************
  2820
  2821     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2822         16  CF-ADDRESS-DATA.
  2823             20  CF-MAIL-TO-NAME            PIC X(30).
  2824             20  CF-IN-CARE-OF              PIC X(30).
  2825             20  CF-ADDRESS-LINE-1          PIC X(30).
  2826             20  CF-ADDRESS-LINE-2          PIC X(30).
  2827             20  CF-CITY-STATE              PIC X(30).
  2828             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2829             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2830
  2831         16  CF-CLAIM-NO-CONTROL.
  2832             20  CF-CLAIM-NO-METHOD         PIC X.
  2833                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2834                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2835                 88  CLAIM-NO-SEQ               VALUE '3'.
  2836                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2837             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2838                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2839                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2840                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2841
  2842         16  CF-CHECK-NO-CONTROL.
  2843             20  CF-CHECK-NO-METHOD         PIC X.
  2844                 88  CHECK-NO-MANUAL            VALUE '1'.
  2845                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2846                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2847                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2848             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2849                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2850
  2851         16  CF-DOMICILE-STATE              PIC XX.
  2852
  2853         16  CF-EXPENSE-CONTROLS.
  2854             20  CF-EXPENSE-METHOD          PIC X.
  2855                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL677.cbl
  2856                 88  DOLLARS-PER-PMT            VALUE '2'.
  2857                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2858                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2859             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2860             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2861
  2862         16  CF-CORRESPONDENCE-CONTROL.
  2863             20  CF-LETTER-RESEND-OPT       PIC X.
  2864                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2865                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2866             20  FILLER                     PIC X(4).
  2867
  2868         16  CF-RESERVE-CONTROLS.
  2869             20  CF-MANUAL-SW               PIC X.
  2870                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2871             20  CF-FUTURE-SW               PIC X.
  2872                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2873             20  CF-PTC-SW                  PIC X.
  2874                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2875             20  CF-IBNR-SW                 PIC X.
  2876                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2877             20  CF-PTC-LF-SW               PIC X.
  2878                 88  CF-LF-PTC-USED             VALUE '1'.
  2879             20  CF-CDT-ACCESS-METHOD       PIC X.
  2880                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2881                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2882                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2883             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2884
  2885         16  CF-CLAIM-CALC-METHOD           PIC X.
  2886             88  360-PLUS-MONTHS                VALUE '1'.
  2887             88  365-PLUS-MONTHS                VALUE '2'.
  2888             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2889             88  360-DAILY                      VALUE '4'.
  2890             88  365-DAILY                      VALUE '5'.
  2891
  2892         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2893         16  FILLER                         PIC X(11).
  2894
  2895         16  CF-LIMIT-AMOUNTS.
  2896             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2897             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2898             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2899             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2900             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2901             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2902             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2903             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2904             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2905             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2906
  2907         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2908         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2909         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2910
  2911         16  CF-ZIP-CODE.
  2912             20  CF-ZIP-PRIME.
  2913                 24  CF-ZIP-1ST             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL677.cbl
  2914                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2915                 24  FILLER                 PIC X(4).
  2916             20  CF-ZIP-PLUS4               PIC X(4).
  2917         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2918             20  CF-CAN-POSTAL-1            PIC XXX.
  2919             20  CF-CAN-POSTAL-2            PIC XXX.
  2920             20  FILLER                     PIC XXX.
  2921
  2922         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2923         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2924         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2925
  2926         16  CF-RATING-SWITCH               PIC X.
  2927             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2928             88  CF-NO-RATING                   VALUE 'N'.
  2929
  2930         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2931
  2932         16  CF-CARRIER-OVER-SHORT.
  2933             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2934             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2935
  2936         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2937         16  CF-SECPAY-SWITCH               PIC X.
  2938             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2939             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2940         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2941         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2942         16  FILLER                         PIC X(444).
  2943*        16  FILLER                         PIC X(452).
  2944
  2945
  2946****************************************************************
  2947*             MORTALITY MASTER RECORD                          *
  2948****************************************************************
  2949
  2950     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2951         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2952                                INDEXED BY CF-MORT-NDX.
  2953             20  CF-MORT-TABLE              PIC X(5).
  2954             20  CF-MORT-TABLE-TYPE         PIC X.
  2955                 88  CF-MORT-JOINT              VALUE 'J'.
  2956                 88  CF-MORT-SINGLE             VALUE 'S'.
  2957                 88  CF-MORT-COMBINED           VALUE 'C'.
  2958                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2959                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2960             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2961             20  CF-MORT-AGE-METHOD         PIC XX.
  2962                 88  CF-AGE-LAST                VALUE 'AL'.
  2963                 88  CF-AGE-NEAR                VALUE 'AN'.
  2964             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2965             20  CF-MORT-ADJUSTMENT-DIRECTION
  2966                                            PIC X.
  2967                 88  CF-MINUS                   VALUE '-'.
  2968                 88  CF-PLUS                    VALUE '+'.
  2969             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2970             20  CF-MORT-JOINT-CODE         PIC X.
  2971                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL677.cbl
  2972             20  CF-MORT-PC-Q               PIC X.
  2973                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2974             20  CF-MORT-TABLE-CODE         PIC X(4).
  2975             20  CF-MORT-COMMENTS           PIC X(15).
  2976             20  FILLER                     PIC X(14).
  2977
  2978         16  FILLER                         PIC X(251).
  2979
  2980
  2981****************************************************************
  2982*             BUSSINESS TYPE MASTER RECORD                     *
  2983****************************************************************
  2984
  2985     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2986* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2987* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2988* AND RECORD 05 IS TYPES 81-99
  2989         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2990             20  CF-BUSINESS-TITLE          PIC  X(19).
  2991             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2992                                            PIC S9V9(4) COMP-3.
  2993             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2994             20  FILLER                     PIC  X.
  2995         16  FILLER                         PIC  X(248).
  2996
  2997
  2998****************************************************************
  2999*             TERMINAL MASTER RECORD                           *
  3000****************************************************************
  3001
  3002     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3003
  3004         16  CF-COMPANY-TERMINALS.
  3005             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3006                                  PIC X(4).
  3007         16  FILLER               PIC X(248).
  3008
  3009
  3010****************************************************************
  3011*             LIFE EDIT MASTER RECORD                          *
  3012****************************************************************
  3013
  3014     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3015         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3016             20  CF-LIFE-CODE-IN            PIC XX.
  3017             20  CF-LIFE-CODE-OUT           PIC XX.
  3018         16  FILLER                         PIC X(248).
  3019
  3020
  3021****************************************************************
  3022*             AH EDIT MASTER RECORD                            *
  3023****************************************************************
  3024
  3025     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3026         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3027             20  CF-AH-CODE-IN              PIC XXX.
  3028             20  CF-AH-CODE-OUT             PIC XX.
  3029         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL677.cbl
  3030
  3031
  3032****************************************************************
  3033*             CREDIBILITY TABLES                               *
  3034****************************************************************
  3035
  3036     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3037         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3038                             INDEXED BY CF-CRDB-NDX.
  3039             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3040             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3041             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3042         16  FILLER                         PIC  X(332).
  3043
  3044
  3045****************************************************************
  3046*             REPORT CUSTOMIZATION RECORD                      *
  3047****************************************************************
  3048
  3049     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3050         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3051             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3052             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3053             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3054**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3055****       A T-TRANSFER.                                   ****
  3056             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3057
  3058         16  FILLER                         PIC XX.
  3059
  3060         16  CF-CARRIER-CNTL-OPT.
  3061             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3062                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3063                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3064             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3065                                            PIC X.
  3066         16  CF-GROUP-CNTL-OPT.
  3067             20  CF-GROUP-OPT-SEQ           PIC 9.
  3068                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3069                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3070             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3071                                            PIC X(6).
  3072         16  CF-STATE-CNTL-OPT.
  3073             20  CF-STATE-OPT-SEQ           PIC 9.
  3074                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3075                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3076             20  CF-STATE-SELECT OCCURS 3 TIMES
  3077                                            PIC XX.
  3078         16  CF-ACCOUNT-CNTL-OPT.
  3079             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3080                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3081                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3082             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3083                                            PIC X(10).
  3084         16  CF-BUS-TYP-CNTL-OPT.
  3085             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3086                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3087                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL677.cbl
  3088             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3089                                            PIC XX.
  3090         16  CF-LF-TYP-CNTL-OPT.
  3091             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3092                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3093                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3094             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3095                                            PIC XX.
  3096         16  CF-AH-TYP-CNTL-OPT.
  3097             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3098                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3099                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3100             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3101                                            PIC XX.
  3102         16  CF-REPTCD1-CNTL-OPT.
  3103             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3104                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3105                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3106             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3107                                            PIC X(10).
  3108         16  CF-REPTCD2-CNTL-OPT.
  3109             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3110                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3111                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3112             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3113                                            PIC X(10).
  3114         16  CF-USER1-CNTL-OPT.
  3115             20  CF-USER1-OPT-SEQ           PIC 9.
  3116                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3117                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3118             20  CF-USER1-SELECT OCCURS 3 TIMES
  3119                                            PIC X(10).
  3120         16  CF-USER2-CNTL-OPT.
  3121             20  CF-USER2-OPT-SEQ           PIC 9.
  3122                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3123                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3124             20  CF-USER2-SELECT OCCURS 3 TIMES
  3125                                            PIC X(10).
  3126         16  CF-USER3-CNTL-OPT.
  3127             20  CF-USER3-OPT-SEQ           PIC 9.
  3128                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3129                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3130             20  CF-USER3-SELECT OCCURS 3 TIMES
  3131                                            PIC X(10).
  3132         16  CF-USER4-CNTL-OPT.
  3133             20  CF-USER4-OPT-SEQ           PIC 9.
  3134                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3135                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3136             20  CF-USER4-SELECT OCCURS 3 TIMES
  3137                                            PIC X(10).
  3138         16  CF-USER5-CNTL-OPT.
  3139             20  CF-USER5-OPT-SEQ           PIC 9.
  3140                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3141                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3142             20  CF-USER5-SELECT OCCURS 3 TIMES
  3143                                            PIC X(10).
  3144         16  CF-REINS-CNTL-OPT.
  3145             20  CF-REINS-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL677.cbl
  3146                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3147                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3148             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3149                 24  CF-REINS-PRIME         PIC XXX.
  3150                 24  CF-REINS-SUB           PIC XXX.
  3151
  3152         16  CF-AGENT-CNTL-OPT.
  3153             20  CF-AGENT-OPT-SEQ           PIC 9.
  3154                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3155                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3156             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3157                                            PIC X(10).
  3158
  3159         16  FILLER                         PIC X(43).
  3160
  3161         16  CF-LOSS-RATIO-SELECT.
  3162             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3163             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3164         16  CF-ENTRY-DATE-SELECT.
  3165             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3166             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3167         16  CF-EFFECTIVE-DATE-SELECT.
  3168             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3169             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3170
  3171         16  CF-EXCEPTION-LIST-IND          PIC X.
  3172             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3173
  3174         16  FILLER                         PIC X(318).
  3175
  3176****************************************************************
  3177*                  EXCEPTION REPORTING RECORD                  *
  3178****************************************************************
  3179
  3180     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3181         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3182             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3183
  3184         16  CF-COMBINED-LIFE-AH-OPT.
  3185             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3186             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3187             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3188             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3189
  3190         16  CF-LIFE-OPT.
  3191             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3192             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3193             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3194             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3195             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3196             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3197             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3198             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3199             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3200             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3201
  3202         16  CF-AH-OPT.
  3203             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL677.cbl
  3204             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3205             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3206             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3207             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3208             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3209             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3210             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3211             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3212             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3213
  3214         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3215             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3216             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3217             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3218
  3219         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3220
  3221         16  FILLER                         PIC X(673).
  3222
  3223
  3224****************************************************************
  3225*             MORTGAGE SYSTEM PLAN RECORD                      *
  3226****************************************************************
  3227
  3228     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3229         16  CF-PLAN-TYPE                   PIC X.
  3230             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3231             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3232             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3233         16  CF-PLAN-ABBREV                 PIC XXX.
  3234         16  CF-PLAN-DESCRIPT               PIC X(10).
  3235         16  CF-PLAN-NOTES                  PIC X(20).
  3236         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3237         16  CF-PLAN-UNDERWRITING.
  3238             20  CF-PLAN-TERM-DATA.
  3239                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3240                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3241             20  CF-PLAN-AGE-DATA.
  3242                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3243                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3244                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3245             20  CF-PLAN-BENEFIT-DATA.
  3246                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3247                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3248                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3249                                            PIC S9(7)V99  COMP-3.
  3250         16  CF-PLAN-POLICY-FORMS.
  3251             20  CF-POLICY-FORM             PIC X(12).
  3252             20  CF-MASTER-APPLICATION      PIC X(12).
  3253             20  CF-MASTER-POLICY           PIC X(12).
  3254         16  CF-PLAN-RATING.
  3255             20  CF-RATE-CODE               PIC X(5).
  3256             20  CF-SEX-RATING              PIC X.
  3257                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3258                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3259             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3260             20  CF-SUB-STD-TYPE            PIC X.
  3261                 88  CF-PCT-OF-PREM            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL677.cbl
  3262                 88  CF-PCT-OF-BENE            VALUE '2'.
  3263         16  CF-PLAN-PREM-TOLERANCES.
  3264             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3265             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3266         16  CF-PLAN-PYMT-TOLERANCES.
  3267             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3268             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3269         16  CF-PLAN-MISC-DATA.
  3270             20  FILLER                     PIC X.
  3271             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3272             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3273         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3274         16  CF-PLAN-IND-GRP                PIC X.
  3275             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3276                                                     '1'.
  3277             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3278                                                     '2'.
  3279         16  CF-MIB-SEARCH-SW               PIC X.
  3280             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3281             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3282             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3283             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3284         16  CF-ALPHA-SEARCH-SW             PIC X.
  3285             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3286             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3287             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3288             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3289             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3290             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3291             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3292             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3293             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3294             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3295                                                     'A' 'B' 'C'
  3296                                                     'X' 'Y' 'Z'.
  3297         16  CF-EFF-DT-RULE-SW              PIC X.
  3298             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3299             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3300             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3301             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3302             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3303         16  FILLER                         PIC X(4).
  3304         16  CF-HEALTH-QUESTIONS            PIC X.
  3305             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3306         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3307         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3308         16  CF-PLAN-SNGL-JNT               PIC X.
  3309             88  CF-COMBINED-PLAN              VALUE 'C'.
  3310             88  CF-JNT-PLAN                   VALUE 'J'.
  3311             88  CF-SNGL-PLAN                  VALUE 'S'.
  3312         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3313         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3314         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3315         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3316         16  CF-RERATE-CNTL                 PIC  X.
  3317             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3318             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3319             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL677.cbl
  3320             88  CF-AUTO-RECALC                 VALUE '4'.
  3321         16  CF-BENEFIT-TYPE                PIC  X.
  3322             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3323             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3324         16  CF-POLICY-FEE                  PIC S999V99
  3325                                                    COMP-3.
  3326         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3327         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3328         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3329         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3330         16  FILLER                         PIC  X(32).
  3331         16  CF-TERMINATION-FORM            PIC  X(04).
  3332         16  FILLER                         PIC  X(08).
  3333         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3334                                                       COMP-3.
  3335         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3336         16  CF-ISSUE-LETTER                PIC  X(4).
  3337         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3338         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3339             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3340             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3341         16  CF-MP-REFUND-CALC              PIC X.
  3342             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3343             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3344             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3345             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3346             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3347             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3348             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3349             88  CF-MP-REFD-MEAN                VALUE '8'.
  3350         16  CF-ALT-RATE-CODE               PIC  X(5).
  3351
  3352
  3353         16  FILLER                         PIC X(498).
  3354****************************************************************
  3355*             MORTGAGE COMPANY MASTER RECORD                   *
  3356****************************************************************
  3357
  3358     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3359         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3360         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3361             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3362             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3363             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3364             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3365             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3366
  3367         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3368         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3369         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3370         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3371         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3372
  3373         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3374             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3375         16  CF-MP-RECON-USE-IND            PIC X(1).
  3376             88  CF-MP-USE-RECON             VALUE 'Y'.
  3377         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL677.cbl
  3378             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3379         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3380             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3381             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3382         16  FILLER                         PIC X(1).
  3383         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3384             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3385         16  CF-MORTG-MIB-VERSION           PIC X.
  3386             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3387             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3388             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3389         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3390             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3391                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3392             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3393                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3394             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3395                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3396             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3397                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3398             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3399                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3400             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3401                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3402         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3403         16  FILLER                         PIC X(7).
  3404         16  CF-MORTG-DESTINATION-SYMBOL.
  3405             20  CF-MORTG-MIB-COMM          PIC X(5).
  3406             20  CF-MORTG-MIB-TERM          PIC X(5).
  3407         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3408             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3409         16  FILLER                         PIC X(03).
  3410         16  CF-MP-CHECK-NO-CONTROL.
  3411             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3412                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3413                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3414                                                ' ' LOW-VALUES.
  3415                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3416                                               VALUE '3'.
  3417         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3418         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3419         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3420             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3421                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3422             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3423                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3424             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3425                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3426             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3427                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3428             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3429                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3430             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3431                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3432         16  CF-MORTG-BILLING-AREA.
  3433             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3434                                            PIC X.
  3435         16  CF-MORTG-MONTH-END-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL677.cbl
  3436         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3437         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3438         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3439             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3440             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3441         16  FILLER                         PIC X.
  3442         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3443             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3444             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3445         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3446         16  FILLER                         PIC X(8).
  3447         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3448         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3449         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3450         16  CF-ACH-COMPANY-ID.
  3451             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3452                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3453                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3454                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3455             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3456         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3457             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3458         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3459             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3460             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3461         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3462         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3463         16  FILLER                         PIC X(536).
  3464
  3465****************************************************************
  3466*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3467****************************************************************
  3468
  3469     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3470         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3471             20  CF-FEMALE-HEIGHT.
  3472                 24  CF-FEMALE-FT           PIC 99.
  3473                 24  CF-FEMALE-IN           PIC 99.
  3474             20  CF-FEMALE-MIN-WT           PIC 999.
  3475             20  CF-FEMALE-MAX-WT           PIC 999.
  3476         16  FILLER                         PIC X(428).
  3477
  3478     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3479         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3480             20  CF-MALE-HEIGHT.
  3481                 24  CF-MALE-FT             PIC 99.
  3482                 24  CF-MALE-IN             PIC 99.
  3483             20  CF-MALE-MIN-WT             PIC 999.
  3484             20  CF-MALE-MAX-WT             PIC 999.
  3485         16  FILLER                         PIC X(428).
  3486******************************************************************
  3487*             AUTOMATIC ACTIVITY RECORD                          *
  3488******************************************************************
  3489     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3490         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3491             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3492             20  CF-SYS-LETTER-ID           PIC X(04).
  3493             20  CF-SYS-RESEND-DAYS         PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL677.cbl
  3494             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3495             20  CF-SYS-RESET-SW            PIC X(01).
  3496             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3497             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3498
  3499         16  FILLER                         PIC X(50).
  3500
  3501         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3502             20  CF-USER-ACTIVE-SW          PIC X(01).
  3503             20  CF-USER-LETTER-ID          PIC X(04).
  3504             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3505             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3506             20  CF-USER-RESET-SW           PIC X(01).
  3507             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3508             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3509             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3510
  3511         16  FILLER                         PIC X(246).
  3512*                                    COPY ERCCHEK.
  3513******************************************************************
  3514*                                                                *
  3515*                                                                *
  3516*                            ERCCHEK                             *
  3517*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3518*                            VMOD=2.008                          *
  3519*                                                                *
  3520*   FILE DESCRIPTION = CHECK RECORDS                             *
  3521*                                                                *
  3522*   FILE TYPE = VSAM,KSDS                                        *
  3523*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3524*                                                                *
  3525*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3526*       ALTERNATE INDEX = NONE                                   *
  3527*                                                                *
  3528*   LOG = YES                                                    *
  3529*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3530******************************************************************
  3531*                   C H A N G E   L O G
  3532*
  3533* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3534*-----------------------------------------------------------------
  3535*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3536* EFFECTIVE    NUMBER
  3537*-----------------------------------------------------------------
  3538* 021414    2003053000001  PEMA  changes for auto chk request
  3539******************************************************************
  3540 01  CHECK-RECORDS.
  3541     12  CH-RECORD-ID                      PIC XX.
  3542         88  VALID-CH-ID                      VALUE 'CH'.
  3543
  3544     12  CH-CONTROL-PRIMARY.
  3545         16  CH-COMPANY-CD                 PIC X.
  3546         16  CH-CARRIER                    PIC X.
  3547         16  CH-GROUPING                   PIC X(6).
  3548         16  CH-STATE                      PIC XX.
  3549         16  CH-ACCOUNT                    PIC X(10).
  3550         16  CH-CERT-EFF-DT                PIC XX.
  3551         16  CH-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL677.cbl
  3552             20  CH-CERT-PRIME             PIC X(10).
  3553             20  CH-CERT-SFX               PIC X.
  3554         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3555
  3556     12  CH-RECORDED-DT                    PIC XX.
  3557     12  CH-RECORDED-BY                    PIC X(4).
  3558     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3559
  3560     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3561     12  CH-CHECK-NO                       PIC X(7).
  3562     12  CH-REASON-FOR-CHECK               PIC X(25).
  3563     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3564     12  FILLER                            PIC X.
  3565
  3566     12  CH-PAYEE-INFO.
  3567         16  CH-PAYEE-NAME-1               PIC X(30).
  3568         16  CH-PAYEE-NAME-2               PIC X(30).
  3569         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3570         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3571         16  CH-PAYEE-CITY-ST.
  3572             20  CH-PAYEE-CITY             PIC X(28).
  3573             20  CH-PAYEE-STATE            PIC XX.
  3574         16  CH-PAYEE-ZIP-CODE.
  3575             20  CH-PAYEE-ZIP.
  3576                 24  CH-ZIP-PRI-1ST        PIC X.
  3577                     88  CH-CANADIAN-POST-CODE
  3578                                           VALUES 'A' THRU 'Z'.
  3579                 24  FILLER                PIC X(4).
  3580             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3581         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3582             20  CH-CAN-POSTAL-1           PIC XXX.
  3583             20  CH-CAN-POSTAL-2           PIC XXX.
  3584             20  FILLER                    PIC XXX.
  3585
  3586     12  CH-CHECK-STUB-TEXT.
  3587         16  CH-STUB-LINE-1                PIC X(30).
  3588         16  CH-TEXT-LINE-1                PIC X(50).
  3589         16  CH-TEXT-LINE-2                PIC X(50).
  3590         16  CH-TEXT-LINE-3                PIC X(40).
  3591     12  CH-RETURN-TO                      PIC X(30).
  3592
  3593     12  CH-COMPENSATION-CONTROL.
  3594         16  CH-COMP-CARRIER               PIC X.
  3595         16  CH-COMP-GROUPING              PIC X(6).
  3596         16  CH-COMP-FIN-RESP              PIC X(10).
  3597         16  CH-COMP-ACCOUNT               PIC X(10).
  3598
  3599     12  CH-CREDIT-SELECT-DT               PIC XX.
  3600     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3601     12  CH-PAYEE-CODE                     PIC X(6).
  3602
  3603     12  CH-VOID-DATA.
  3604         20  CH-VOID-DT                    PIC XX.
  3605         20  CH-VOID-BY                    PIC X(4).
  3606         20  CH-VOID-REASON                PIC X(25).
  3607
  3608     12  CH-APPROVAL-DATA.
  3609         20  CH-APPROVAL-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL677.cbl
  3610         20  CH-APPROVAL-STATUS            PIC X.
  3611             88  CH-IN-LIMBO                  VALUE ' '.
  3612             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3613             88  CH-APPROVED                  VALUE 'A'.
  3614             88  CH-DENIED                    VALUE 'D'.
  3615         20  CH-APPROVED-BY                PIC XXXX.
  3616     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3617             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3618     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3619
  3620     12  ch-released-dt                    pic xx.
  3621     12  ch-check-cashed-dt                pic xx.
  3622     12  FILLER                            PIC X.
  3623*    12  CH-CHECK-REFERENCE                PIC X(12).
  3624     12  CH-CHECK-ORIGIN-SW                PIC X.
  3625             88  CH-REFUND-CHECK              VALUE 'R'.
  3626             88  CH-MAINT-CHECK               VALUE 'M'.
  3627
  3628     12  CH-CANC-DT                        PIC XX.
  3629     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3630     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3631
  3632     12  CH-INSURED-NAME                   PIC X(28).
  3633
  3634     12  ch-released-by                    pic x(4).
  3635     12  ch-csr                            pic x(4).
  3636     12  ch-deduct-commission              pic x.
  3637         88  ch-deduct-comm                  value 'Y'.
  3638         88  ch-do-not-deduct-comm           value 'N'.
  3639
  3640     12  FILLER                            PIC X(11).
  3641*    12  CH-LETTER-TABLE.
  3642*        16  CH-LETTERS OCCURS 3 TIMES
  3643*                       INDEXED BY CH-LT-NDX
  3644*                                          PIC X(04).
  3645
  3646     12  FILLER                            PIC X(07).
  3647
  3648*                                    COPY ERCACCT.
  3649******************************************************************
  3650*                                                                *
  3651*                                                                *
  3652*                            ERCACCT                             *
  3653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3654*                            VMOD=2.031                          *
  3655*                                                                *
  3656*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3657*                                                                *
  3658*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3659*   VSAM ACCOUNT MASTER FILES.                                   *
  3660*                                                                *
  3661*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3662*                                                                *
  3663*   FILE TYPE = VSAM,KSDS                                        *
  3664*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3665*                                                                *
  3666*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3667*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL677.cbl
  3668*                                                                *
  3669*   LOG = NO                                                     *
  3670*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3671*                                                                *
  3672*                                                                *
  3673******************************************************************
  3674*                   C H A N G E   L O G
  3675*
  3676* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3677*-----------------------------------------------------------------
  3678*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3679* EFFECTIVE    NUMBER
  3680*-----------------------------------------------------------------
  3681* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3682* 092705    2005050300006  PEMA  ADD SPP LEASES
  3683* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3684* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3685* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3686* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3687* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3688******************************************************************
  3689
  3690 01  ACCOUNT-MASTER.
  3691     12  AM-RECORD-ID                      PIC XX.
  3692         88  VALID-AM-ID                      VALUE 'AM'.
  3693
  3694     12  AM-CONTROL-PRIMARY.
  3695         16  AM-COMPANY-CD                 PIC X.
  3696         16  AM-MSTR-CNTRL.
  3697             20  AM-CONTROL-A.
  3698                 24  AM-CARRIER            PIC X.
  3699                 24  AM-GROUPING.
  3700                     28 AM-GROUPING-PREFIX PIC XXX.
  3701                     28 AM-GROUPING-PRIME  PIC XXX.
  3702                 24  AM-STATE              PIC XX.
  3703                 24  AM-ACCOUNT.
  3704                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3705                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3706             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3707                                           PIC X(19).
  3708             20  AM-CNTRL-B.
  3709                 24  AM-EXPIRATION-DT      PIC XX.
  3710                 24  FILLER                PIC X(4).
  3711             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3712                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3713
  3714     12  AM-CONTROL-BY-VAR-GRP.
  3715         16  AM-COMPANY-CD-A1              PIC X.
  3716         16  AM-VG-CARRIER                 PIC X.
  3717         16  AM-VG-GROUPING                PIC X(6).
  3718         16  AM-VG-STATE                   PIC XX.
  3719         16  AM-VG-ACCOUNT                 PIC X(10).
  3720         16  AM-VG-DATE.
  3721             20  AM-VG-EXPIRATION-DT       PIC XX.
  3722             20  FILLER                    PIC X(4).
  3723         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3724                                           PIC 9(11)      COMP-3.
  3725     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL677.cbl
  3726         16  FILLER                        PIC X(10).
  3727         16  AM-VG-KEY3.
  3728             20  AM-VG3-ACCOUNT            PIC X(10).
  3729             20  AM-VG3-EXP-DT             PIC XX.
  3730         16  FILLER                        PIC X(4).
  3731     12  AM-MAINT-INFORMATION.
  3732         16  AM-LAST-MAINT-DT              PIC XX.
  3733         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3734         16  AM-LAST-MAINT-USER            PIC X(4).
  3735         16  FILLER                        PIC XX.
  3736
  3737     12  AM-EFFECTIVE-DT                   PIC XX.
  3738     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3739
  3740     12  AM-PREV-DATES  COMP-3.
  3741         16  AM-PREV-EXP-DT                PIC 9(11).
  3742         16  AM-PREV-EFF-DT                PIC 9(11).
  3743
  3744     12  AM-REPORT-CODE-1                  PIC X(10).
  3745     12  AM-REPORT-CODE-2                  PIC X(10).
  3746
  3747     12  AM-CITY-CODE                      PIC X(4).
  3748     12  AM-COUNTY-PARISH                  PIC X(6).
  3749
  3750     12  AM-NAME                           PIC X(30).
  3751     12  AM-PERSON                         PIC X(30).
  3752     12  AM-ADDRS                          PIC X(30).
  3753     12  AM-CITY.
  3754         16  AM-ADDR-CITY                  PIC X(28).
  3755         16  AM-ADDR-STATE                 PIC XX.
  3756     12  AM-ZIP.
  3757         16  AM-ZIP-PRIME.
  3758             20  AM-ZIP-PRI-1ST            PIC X.
  3759                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3760             20  FILLER                    PIC X(4).
  3761         16  AM-ZIP-PLUS4                  PIC X(4).
  3762     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3763         16  AM-CAN-POSTAL-1               PIC XXX.
  3764         16  AM-CAN-POSTAL-2               PIC XXX.
  3765         16  FILLER                        PIC XXX.
  3766     12  AM-TEL-NO.
  3767         16  AM-AREA-CODE                  PIC 999.
  3768         16  AM-TEL-PRE                    PIC 999.
  3769         16  AM-TEL-NBR                    PIC 9(4).
  3770     12  AM-TEL-LOC                        PIC X.
  3771         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3772         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3773
  3774     12  AM-COMM-STRUCTURE.
  3775         16  AM-DEFN-1.
  3776             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3777                 24  AM-AGT.
  3778                     28  AM-AGT-PREFIX     PIC X(4).
  3779                     28  AM-AGT-PRIME      PIC X(6).
  3780                 24  AM-COM-TYP            PIC X.
  3781                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3782                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3783                 24  AM-A-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL677.cbl
  3784                 24  AM-RECALC-LV-INDIC    PIC X.
  3785                 24  AM-RETRO-LV-INDIC     PIC X.
  3786                 24  AM-GL-CODES           PIC X.
  3787                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3788                 24  FILLER                PIC X(01).
  3789         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3790             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3791                 24  FILLER                PIC X(11).
  3792                 24  AM-L-COMA             PIC XXX.
  3793                 24  AM-J-COMA             PIC XXX.
  3794                 24  AM-A-COMA             PIC XXX.
  3795                 24  FILLER                PIC X(6).
  3796
  3797     12  AM-COMM-CHANGE-STATUS             PIC X.
  3798         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3799
  3800     12  AM-CSR-CODE                       PIC X(4).
  3801
  3802     12  AM-BILLING-STATUS                 PIC X.
  3803         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3804         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3805     12  AM-AUTO-REFUND-SW                 PIC X.
  3806         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3807         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3808     12  AM-GPCD                           PIC 99.
  3809     12  AM-IG                             PIC X.
  3810         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3811         88  AM-HAS-GROUP                     VALUE '2'.
  3812     12  AM-STATUS                         PIC X.
  3813         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3814         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3815         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3816         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3817         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3818         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3819     12  AM-REMIT-TO                       PIC 99.
  3820     12  AM-ID-NO                          PIC X(11).
  3821
  3822     12  AM-CAL-TABLE                      PIC XX.
  3823     12  AM-LF-DEVIATION                   PIC XXX.
  3824     12  AM-AH-DEVIATION                   PIC XXX.
  3825     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3826     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3827     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3828     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3829     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3830     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3831
  3832     12  AM-USER-FIELDS.
  3833         16  AM-FLD-1                      PIC XX.
  3834         16  AM-FLD-2                      PIC XX.
  3835         16  AM-FLD-3                      PIC XX.
  3836         16  AM-FLD-4                      PIC XX.
  3837         16  AM-FLD-5                      PIC XX.
  3838
  3839     12  AM-1ST-PROD-DATE.
  3840         16  AM-1ST-PROD-YR                PIC XX.
  3841         16  AM-1ST-PROD-MO                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL677.cbl
  3842         16  AM-1ST-PROD-DA                PIC XX.
  3843     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3844     12  AM-CERTS-PURGED-DATE.
  3845         16  AM-PUR-YR                     PIC XX.
  3846         16  AM-PUR-MO                     PIC XX.
  3847         16  AM-PUR-DA                     PIC XX.
  3848     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3849     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3850     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3851     12  AM-INACTIVE-DATE.
  3852         16  AM-INA-MO                     PIC 99.
  3853         16  AM-INA-DA                     PIC 99.
  3854         16  AM-INA-YR                     PIC 99.
  3855     12  AM-AR-HI-CERT-DATE                PIC XX.
  3856
  3857     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3858     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3859
  3860     12  AM-OB-PAYMENT-MODE                PIC X.
  3861         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3862         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3863         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3864         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3865
  3866     12  AM-AH-ONLY-INDICATOR              PIC X.
  3867         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3868         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3869
  3870     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3871
  3872     12  AM-OVER-SHORT.
  3873         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3874         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3875
  3876     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3877     12  AM-DCC-CLP-STATE                  PIC XX.
  3878
  3879     12  AM-RECALC-COMM                    PIC X.
  3880     12  AM-RECALC-REIN                    PIC X.
  3881
  3882     12  AM-REI-TABLE                      PIC XXX.
  3883     12  AM-REI-ET-LF                      PIC X.
  3884     12  AM-REI-ET-AH                      PIC X.
  3885     12  AM-REI-PE-LF                      PIC X.
  3886     12  AM-REI-PE-AH                      PIC X.
  3887     12  AM-REI-PRT-ST                     PIC X.
  3888     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3889     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3890     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3891     12  AM-REI-GROUP-A                    PIC X(6).
  3892     12  AM-REI-MORT                       PIC X(4).
  3893     12  AM-REI-PRT-OW                     PIC X.
  3894     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3895     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3896     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3897     12  AM-REI-GROUP-B                    PIC X(6).
  3898
  3899     12  AM-TRUST-TYPE                     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL677.cbl
  3900
  3901     12  AM-EMPLOYER-STMT-USED             PIC X.
  3902     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3903
  3904     12  AM-STD-AH-TYPE                    PIC XX.
  3905     12  AM-EARN-METHODS.
  3906         16  AM-EARN-METHOD-R              PIC X.
  3907             88 AM-REF-RL-R78                 VALUE 'R'.
  3908             88 AM-REF-RL-PR                  VALUE 'P'.
  3909             88 AM-REF-RL-MEAN                VALUE 'M'.
  3910             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3911         16  AM-EARN-METHOD-L              PIC X.
  3912             88 AM-REF-LL-R78                 VALUE 'R'.
  3913             88 AM-REF-LL-PR                  VALUE 'P'.
  3914             88 AM-REF-LL-MEAN                VALUE 'M'.
  3915             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3916         16  AM-EARN-METHOD-A              PIC X.
  3917             88 AM-REF-AH-R78                 VALUE 'R'.
  3918             88 AM-REF-AH-PR                  VALUE 'P'.
  3919             88 AM-REF-AH-MEAN                VALUE 'M'.
  3920             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3921             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3922             88 AM-REF-AH-NET                 VALUE 'N'.
  3923
  3924     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3925     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3926     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3927
  3928     12  AM-RET-Y-N                        PIC X.
  3929     12  AM-RET-P-E                        PIC X.
  3930     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3931     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3932     12  AM-RET-GRP                        PIC X(6).
  3933     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3934         16  AM-POOL-PRIME                 PIC XXX.
  3935         16  AM-POOL-SUB                   PIC XXX.
  3936     12  AM-RETRO-EARNINGS.
  3937         16  AM-RET-EARN-R                 PIC X.
  3938         16  AM-RET-EARN-L                 PIC X.
  3939         16  AM-RET-EARN-A                 PIC X.
  3940     12  AM-RET-ST-TAX-USE                 PIC X.
  3941         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3942         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3943     12  AM-RETRO-BEG-EARNINGS.
  3944         16  AM-RET-BEG-EARN-R             PIC X.
  3945         16  AM-RET-BEG-EARN-L             PIC X.
  3946         16  AM-RET-BEG-EARN-A             PIC X.
  3947     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3948     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3949
  3950     12  AM-USER-SELECT-OPTIONS.
  3951         16  AM-USER-SELECT-1              PIC X(10).
  3952         16  AM-USER-SELECT-2              PIC X(10).
  3953         16  AM-USER-SELECT-3              PIC X(10).
  3954         16  AM-USER-SELECT-4              PIC X(10).
  3955         16  AM-USER-SELECT-5              PIC X(10).
  3956
  3957     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL677.cbl
  3958
  3959     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3960
  3961     12  AM-RPT045A-SWITCH                 PIC X.
  3962         88  RPT045A-OFF                   VALUE 'N'.
  3963
  3964     12  AM-INSURANCE-LIMITS.
  3965         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3966         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3967
  3968     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3969         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3970
  3971     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3972         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3973         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3974
  3975     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3976
  3977     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3978     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3979     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3980     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3981     12  AM-DCC-UEF-STATE                  PIC XX.
  3982     12  FILLER                            PIC XXX.
  3983     12  AM-REPORT-CODE-3                  PIC X(10).
  3984*    12  FILLER                            PIC X(22).
  3985
  3986     12  AM-RESERVE-DATE.
  3987         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3988         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3989         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3990
  3991     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3992     12  AM-NOTIFICATION-TYPES.
  3993         16  AM-NOTIF-OF-LETTERS           PIC X.
  3994         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3995         16  AM-NOTIF-OF-REPORTS           PIC X.
  3996         16  AM-NOTIF-OF-STATUS            PIC X.
  3997
  3998     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3999         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4000         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4001         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4002         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4003
  4004     12  AM-BENEFIT-CONTROLS.
  4005         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4006             20  AM-BENEFIT-CODE           PIC XX.
  4007             20  AM-BENEFIT-TYPE           PIC X.
  4008             20  AM-BENEFIT-REVISION       PIC XXX.
  4009             20  AM-BENEFIT-REM-TERM       PIC X.
  4010             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4011             20  FILLER                    PIC XX.
  4012         16  FILLER                        PIC X(80).
  4013
  4014     12  AM-TRANSFER-DATA.
  4015         16  AM-TRANSFERRED-FROM.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL677.cbl
  4016             20  AM-TRNFROM-CARRIER        PIC X.
  4017             20  AM-TRNFROM-GROUPING.
  4018                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4019                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4020             20  AM-TRNFROM-STATE          PIC XX.
  4021             20  AM-TRNFROM-ACCOUNT.
  4022                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4023                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4024             20  AM-TRNFROM-DTE            PIC XX.
  4025         16  AM-TRANSFERRED-TO.
  4026             20  AM-TRNTO-CARRIER          PIC X.
  4027             20  AM-TRNTO-GROUPING.
  4028                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4029                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4030             20  AM-TRNTO-STATE            PIC XX.
  4031             20  AM-TRNTO-ACCOUNT.
  4032                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4033                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4034             20  AM-TRNTO-DTE              PIC XX.
  4035         16  FILLER                        PIC X(10).
  4036
  4037     12  AM-SAVED-REMIT-TO                 PIC 99.
  4038
  4039     12  AM-COMM-STRUCTURE-SAVED.
  4040         16  AM-DEFN-1-SAVED.
  4041             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4042                 24  AM-AGT-SV             PIC X(10).
  4043                 24  AM-COM-TYP-SV         PIC X.
  4044                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4045                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4046                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4047                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4048                 24  FILLER                PIC X.
  4049                 24  AM-GL-CODES-SV        PIC X.
  4050                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4051                 24  FILLER                PIC X.
  4052         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4053             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4054                 24  FILLER                PIC X(11).
  4055                 24  AM-L-COMA-SV          PIC XXX.
  4056                 24  AM-J-COMA-SV          PIC XXX.
  4057                 24  AM-A-COMA-SV          PIC XXX.
  4058                 24  FILLER                PIC X(6).
  4059
  4060     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4061         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4062            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4063            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4064            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4065
  4066     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4067     12  FILLER                            PIC X(120).
  4068
  4069     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4070         16  AM-CONTROL-NAME               PIC X(30).
  4071         16  AM-EXECUTIVE-ONE.
  4072             20  AM-EXEC1-NAME             PIC X(15).
  4073             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL677.cbl
  4074                                                          COMP-3.
  4075             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4076                                                          COMP-3.
  4077         16  AM-EXECUTIVE-TWO.
  4078             20  AM-EXEC2-NAME             PIC X(15).
  4079             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4080                                                          COMP-3.
  4081             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4082                                                          COMP-3.
  4083
  4084     12  AM-RETRO-ADDITIONAL-DATA.
  4085         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4086         16  AM-RETRO-PREM-P-E             PIC X.
  4087         16  AM-RETRO-CLMS-P-I             PIC X.
  4088         16  AM-RETRO-RET-BRACKET-LF.
  4089             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4090                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4091                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4092             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4093                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4094                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4095             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4096                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4097                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4098         16  AM-RETRO-RET-BRACKET-AH.
  4099             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4100                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4101                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4102                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4103             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4104                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4105                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4106             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4107                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4108                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4109
  4110     12  AM-COMMENTS.
  4111         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4112
  4113     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4114         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4115         16  AM-FLI-BILLING-CODE           PIC X.
  4116         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4117         16  AM-FLI-UNITED-IDENT           PIC X.
  4118         16  AM-FLI-INTEREST-LOST-DATA.
  4119             20  AM-FLI-BANK-NO            PIC X(5).
  4120             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4121             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4122             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4123         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4124             20  AM-FLI-AGT                PIC X(9).
  4125             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4126             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4127         16  FILLER                        PIC X(102).
  4128
  4129     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4130         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4131             20  AM-BENEFIT-DMD-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL677.cbl
  4132             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4133             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4134             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4135             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4136         16  FILLER                          PIC X(10).
  4137******************************************************************
  4138*                                    COPY ERCCOMP.
  4139******************************************************************
  4140*                                                                *
  4141*                                                                *
  4142*                            ERCCOMP                             *
  4143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4144*                            VMOD=2.019                          *
  4145*                                                                *
  4146*   ONLINE CREDIT SYSTEM                                         *
  4147*                                                                *
  4148*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4149*                                                                *
  4150*   FILE TYPE = VSAM,KSDS                                        *
  4151*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4152*                                                                *
  4153*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4154*       ALTERNATE PATH = NONE                                    *
  4155*                                                                *
  4156*   LOG = NO                                                     *
  4157*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4158*                                                                *
  4159******************************************************************
  4160*                   C H A N G E   L O G
  4161*
  4162* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4163*-----------------------------------------------------------------
  4164*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4165* EFFECTIVE    NUMBER
  4166*-----------------------------------------------------------------
  4167* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4168* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4169* 092205    2005050300006  PEMA  ADD LEASE FEE
  4170* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4171* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4172* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4173* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4174* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4175* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4176******************************************************************
  4177
  4178 01  COMPENSATION-MASTER.
  4179     12  CO-RECORD-ID                          PIC XX.
  4180         88  VALID-CO-ID                          VALUE 'CO'.
  4181
  4182     12  CO-CONTROL-PRIMARY.
  4183         16  CO-COMPANY-CD                     PIC X.
  4184         16  CO-CONTROL.
  4185             20  CO-CTL-1.
  4186                 24  CO-CARR-GROUP.
  4187                     28  CO-CARRIER            PIC X.
  4188                     28  CO-GROUPING.
  4189                         32  CO-GROUP-PREFIX   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL677.cbl
  4190                         32  CO-GROUP-PRIME    PIC XXX.
  4191                 24  CO-RESP-NO.
  4192                     28  CO-RESP-PREFIX        PIC X(4).
  4193                     28  CO-RESP-PRIME         PIC X(6).
  4194             20  CO-CTL-2.
  4195                 24  CO-ACCOUNT.
  4196                     28  CO-ACCT-PREFIX        PIC X(4).
  4197                     28  CO-ACCT-PRIME         PIC X(6).
  4198         16  CO-TYPE                           PIC X.
  4199             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4200             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4201             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4202
  4203     12  CO-MAINT-INFORMATION.
  4204         16  CO-LAST-MAINT-DT                  PIC XX.
  4205         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4206         16  CO-LAST-MAINT-USER                PIC X(4).
  4207     12  FILLER                                PIC XX.
  4208     12  CO-STMT-TYPE                          PIC XXX.
  4209     12  CO-COMP-TYPE                          PIC X.
  4210         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4211     12  CO-STMT-OWNER                         PIC X(4).
  4212     12  CO-BALANCE-CONTROL                    PIC X.
  4213         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4214         88  CO-NO-BALANCE                        VALUE 'N'.
  4215
  4216     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4217         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4218         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4219         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4220
  4221     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4222         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4223         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4224
  4225     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4226     12  CO-GA-DIRECT-DEP                      PIC X.
  4227     12  CO-FUTURE-SPACE                       PIC X.
  4228         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4229
  4230     12  CO-ACCT-NAME                          PIC X(30).
  4231     12  CO-MAIL-NAME                          PIC X(30).
  4232     12  CO-ADDR-1                             PIC X(30).
  4233     12  CO-ADDR-2                             PIC X(30).
  4234     12  CO-ADDR-3.
  4235         16  CO-ADDR-CITY                      PIC X(27).
  4236         16  CO-ADDR-STATE                     PIC XX.
  4237     12  CO-CSO-1099                           PIC X.
  4238     12  CO-ZIP.
  4239         16  CO-ZIP-PRIME.
  4240             20  CO-ZIP-PRI-1ST                PIC X.
  4241                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4242             20  FILLER                        PIC X(4).
  4243         16  CO-ZIP-PLUS4                      PIC X(4).
  4244     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4245         16  CO-CAN-POSTAL-1                   PIC XXX.
  4246         16  CO-CAN-POSTAL-2                   PIC XXX.
  4247         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL677.cbl
  4248     12  CO-SOC-SEC                            PIC X(13).
  4249     12  CO-TELEPHONE.
  4250         16  CO-AREA-CODE                      PIC XXX.
  4251         16  CO-PREFIX                         PIC XXX.
  4252         16  CO-PHONE                          PIC X(4).
  4253
  4254     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4255
  4256     12  CO-AR-BAL-LEVEL                       PIC X.
  4257         88  CO-AR-REF-LVL                        VALUE '1'.
  4258         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4259         88  CO-AR-BILL-LVL                       VALUE '2'.
  4260         88  CO-AR-AGT-LVL                        VALUE '3'.
  4261         88  CO-AR-FR-LVL                         VALUE '4'.
  4262
  4263     12  CO-AR-NORMAL-PRINT                    PIC X.
  4264         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4265         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4266
  4267     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4268
  4269     12  CO-AR-REPORTING                       PIC X.
  4270         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4271         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4272
  4273     12  CO-AR-PULL-CHECK                      PIC X.
  4274         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4275         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4276
  4277     12  CO-AR-BALANCE-PRINT                   PIC X.
  4278         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4279
  4280     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4281         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4282         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4283         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4284
  4285     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4286
  4287     12  CO-USER-CODE                          PIC X.
  4288     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4289
  4290******************************************************************
  4291*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4292*    THE LAST MONTH END RUN.
  4293******************************************************************
  4294
  4295     12  CO-LAST-ACTIVITY-DATE.
  4296         16  CO-ACT-YEAR                       PIC 99.
  4297         16  CO-ACT-MONTH                      PIC 99.
  4298         16  CO-ACT-DAY                        PIC 99.
  4299
  4300     12  CO-LAST-STMT-DT.
  4301         16  CO-LAST-STMT-YEAR                 PIC 99.
  4302         16  CO-LAST-STMT-MONTH                PIC 99.
  4303         16  CO-LAST-STMT-DAY                  PIC 99.
  4304
  4305     12  CO-MO-END-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL677.cbl
  4306         16  CO-MONTHLY-TOTALS.
  4307             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4308             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4309             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4310             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4311             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4312
  4313         16  CO-AGING-TOTALS.
  4314             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4315             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4316             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4317             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4318
  4319         16  CO-YTD-TOTALS.
  4320             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4321             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4322
  4323         16  CO-OVER-UNDER-TOTALS.
  4324             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4325             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4326
  4327     12  CO-MISCELLANEOUS-TOTALS.
  4328         16  CO-FICA-TOTALS.
  4329             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4330             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4331
  4332         16  CO-CLAIM-TOTALS.
  4333             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4334             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4335
  4336******************************************************************
  4337*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4338*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4339******************************************************************
  4340
  4341     12  CO-CURRENT-TOTALS.
  4342         16  CO-CURRENT-LAST-STMT-DT.
  4343             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4344             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4345             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4346
  4347         16  CO-CURRENT-MONTHLY-TOTALS.
  4348             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4349             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4350             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4351             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4352             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4353
  4354         16  CO-CURRENT-AGING-TOTALS.
  4355             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4356             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4357             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4358             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4359
  4360         16  CO-CURRENT-YTD-TOTALS.
  4361             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4362             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4363
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL677.cbl
  4364     12  CO-PAID-COMM-TOTALS.
  4365         16  CO-YTD-PAID-COMMS.
  4366             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4367             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4368
  4369     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4370         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4371         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4372
  4373     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4374         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4375         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4376         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4377         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4378         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4379         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4380         88  CO-FINAL-LETTER                  VALUE 'F'.
  4381         88  CO-RECONCILING                   VALUE 'R'.
  4382         88  CO-PHONE-CALL                    VALUE 'P'.
  4383         88  CO-LEGAL                         VALUE 'L'.
  4384         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4385         88  CO-WRITE-OFF                     VALUE 'W'.
  4386         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4387
  4388     12  CO-CSR-CODE                       PIC X(4).
  4389
  4390     12  CO-GA-STATUS-INFO.
  4391         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4392         16  CO-GA-TERMINATION-DT          PIC XX.
  4393         16  CO-GA-STATUS-CODE             PIC X.
  4394             88  CO-GA-ACTIVE                 VALUE 'A'.
  4395             88  CO-GA-INACTIVE               VALUE 'I'.
  4396             88  CO-GA-PENDING                VALUE 'P'.
  4397         16  CO-GA-COMMENTS.
  4398             20  CO-GA-COMMENT-1           PIC X(40).
  4399             20  CO-GA-COMMENT-2           PIC X(40).
  4400             20  CO-GA-COMMENT-3           PIC X(40).
  4401             20  CO-GA-COMMENT-4           PIC X(40).
  4402
  4403     12  CO-RPTCD2                         PIC X(10).
  4404     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4405         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4406         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4407
  4408     12  CO-TYPE-AGENT                     PIC X(01).
  4409         88  CO-CORPORATION                   VALUE 'C'.
  4410         88  CO-PARTNERSHIP                   VALUE 'P'.
  4411         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4412         88  CO-TRUST                         VALUE 'T'.
  4413         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4414
  4415     12  CO-FAXNO.
  4416         16  CO-FAX-AREA-CODE                  PIC XXX.
  4417         16  CO-FAX-PREFIX                     PIC XXX.
  4418         16  CO-FAX-PHONE                      PIC X(4).
  4419
  4420     12  CO-BANK-INFORMATION.
  4421         16  CO-BANK-TRANSIT-NO                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL677.cbl
  4422         16  CO-BANK-TRANSIT-NON REDEFINES
  4423             CO-BANK-TRANSIT-NO                PIC 9(8).
  4424
  4425         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4426     12  CO-MISC-DEDUCT-INFO REDEFINES
  4427                  CO-BANK-INFORMATION.
  4428         16  CO-MD-GL-ACCT                     PIC X(10).
  4429         16  CO-MD-DIV                         PIC XX.
  4430         16  CO-MD-CENTER                      PIC X(4).
  4431         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4432         16  CO-CREATE-AP-CHECK                PIC X.
  4433         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4434         16  FILLER                            PIC XXX.
  4435     12  CO-ACH-STATUS                         PIC X.
  4436         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4437         88  CO-ACH-PENDING                        VALUE 'P'.
  4438
  4439     12  CO-BILL-SW                            PIC X.
  4440     12  CO-CONTROL-NAME                       PIC X(30).
  4441     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4442     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4443     12  CO-CLP-STATE                          PIC XX.
  4444     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4445     12  CO-SPP-REFUND-EDIT                    PIC X.
  4446
  4447******************************************************************
  4448*                                    COPY ELCCERT.
  4449******************************************************************
  4450*                                                                *
  4451*                            ELCCERT.                            *
  4452*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4453*                            VMOD=2.013                          *
  4454*                                                                *
  4455*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4456*                                                                *
  4457*   FILE TYPE = VSAM,KSDS                                        *
  4458*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4459*                                                                *
  4460*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4461*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4462*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4463*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4464*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4465*                                                                *
  4466*   LOG = YES                                                    *
  4467*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4468******************************************************************
  4469*                   C H A N G E   L O G
  4470*
  4471* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4472*-----------------------------------------------------------------
  4473*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4474* EFFECTIVE    NUMBER
  4475*-----------------------------------------------------------------
  4476* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4477* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4478* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4479* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL677.cbl
  4480* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4481* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4482* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4483* 032612  CR2011110200001  PEMA  AHL CHANGES
  4484******************************************************************
  4485
  4486 01  CERTIFICATE-MASTER.
  4487     12  CM-RECORD-ID                      PIC XX.
  4488         88  VALID-CM-ID                      VALUE 'CM'.
  4489
  4490     12  CM-CONTROL-PRIMARY.
  4491         16  CM-COMPANY-CD                 PIC X.
  4492         16  CM-CARRIER                    PIC X.
  4493         16  CM-GROUPING.
  4494             20  CM-GROUPING-PREFIX        PIC X(3).
  4495             20  CM-GROUPING-PRIME         PIC X(3).
  4496         16  CM-STATE                      PIC XX.
  4497         16  CM-ACCOUNT.
  4498             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4499             20  CM-ACCOUNT-PRIME          PIC X(6).
  4500         16  CM-CERT-EFF-DT                PIC XX.
  4501         16  CM-CERT-NO.
  4502             20  CM-CERT-PRIME             PIC X(10).
  4503             20  CM-CERT-SFX               PIC X.
  4504
  4505     12  CM-CONTROL-BY-NAME.
  4506         16  CM-COMPANY-CD-A1              PIC X.
  4507         16  CM-INSURED-LAST-NAME          PIC X(15).
  4508         16  CM-INSURED-INITIALS.
  4509             20  CM-INSURED-INITIAL1       PIC X.
  4510             20  CM-INSURED-INITIAL2       PIC X.
  4511
  4512     12  CM-CONTROL-BY-SSN.
  4513         16  CM-COMPANY-CD-A2              PIC X.
  4514         16  CM-SOC-SEC-NO.
  4515             20  CM-SSN-STATE              PIC XX.
  4516             20  CM-SSN-ACCOUNT            PIC X(6).
  4517             20  CM-SSN-LN3.
  4518                 25  CM-INSURED-INITIALS-A2.
  4519                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4520                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4521                 25 CM-PART-LAST-NAME-A2         PIC X.
  4522
  4523     12  CM-CONTROL-BY-CERT-NO.
  4524         16  CM-COMPANY-CD-A4              PIC X.
  4525         16  CM-CERT-NO-A4                 PIC X(11).
  4526
  4527     12  CM-CONTROL-BY-MEMB.
  4528         16  CM-COMPANY-CD-A5              PIC X.
  4529         16  CM-MEMBER-NO.
  4530             20  CM-MEMB-STATE             PIC XX.
  4531             20  CM-MEMB-ACCOUNT           PIC X(6).
  4532             20  CM-MEMB-LN4.
  4533                 25  CM-INSURED-INITIALS-A5.
  4534                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4535                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4536                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4537
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL677.cbl
  4538     12  CM-INSURED-PROFILE-DATA.
  4539         16  CM-INSURED-FIRST-NAME.
  4540             20  CM-INSURED-1ST-INIT       PIC X.
  4541             20  FILLER                    PIC X(9).
  4542         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4543         16  CM-INSURED-SEX                PIC X.
  4544             88  CM-SEX-MALE                  VALUE 'M'.
  4545             88  CM-SEX-FEMAL                 VALUE 'F'.
  4546         16  CM-INSURED-JOINT-AGE          PIC 99.
  4547         16  CM-JOINT-INSURED-NAME.
  4548             20  CM-JT-LAST-NAME           PIC X(15).
  4549             20  CM-JT-FIRST-NAME.
  4550                 24  CM-JT-1ST-INIT        PIC X.
  4551                 24  FILLER                PIC X(9).
  4552             20  CM-JT-INITIAL             PIC X.
  4553
  4554     12  CM-LIFE-DATA.
  4555         16  CM-LF-BENEFIT-CD              PIC XX.
  4556         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4557         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4558         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4559         16  CM-LF-DEV-CODE                PIC XXX.
  4560         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4561         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4562         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4563         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4564         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4565         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4566         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4567         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4568         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4569         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4570         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4571         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4572         16  cm-temp-epiq                  pic xx.
  4573             88  EPIQ-CLASS                  value 'EQ'.
  4574*        16  FILLER                        PIC XX.
  4575
  4576     12  CM-AH-DATA.
  4577         16  CM-AH-BENEFIT-CD              PIC XX.
  4578         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4579         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4580         16  CM-AH-DEV-CODE                PIC XXX.
  4581         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4582         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4583         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4584         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4585         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4586         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4587         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4588         16  CM-AH-PAID-THRU-DT            PIC XX.
  4589             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4590         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4591         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4592         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4593         16  FILLER                        PIC X.
  4594
  4595     12  CM-LOAN-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL677.cbl
  4596         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4597         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4598                                           PIC S9(5)V99  COMP-3.
  4599         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4600         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4601         16  CM-PAY-FREQUENCY              PIC S99.
  4602         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4603         16  CM-RATE-CLASS                 PIC XX.
  4604         16  CM-BENEFICIARY                PIC X(25).
  4605         16  CM-POLICY-FORM-NO             PIC X(12).
  4606         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4607         16  CM-LAST-ADD-ON-DT             PIC XX.
  4608         16  CM-DEDUCTIBLE-AMOUNTS.
  4609             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4610             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4611         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4612             20  CM-RESIDENT-STATE         PIC XX.
  4613             20  CM-RATE-CODE              PIC X(4).
  4614             20  FILLER                    PIC XX.
  4615         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4616             20  CM-LOAN-OFFICER           PIC X(5).
  4617             20  FILLER                    PIC XXX.
  4618         16  CM-CSR-CODE                   PIC XXX.
  4619         16  CM-UNDERWRITING-CODE          PIC X.
  4620             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4621         16  CM-POST-CARD-IND              PIC X.
  4622         16  CM-NH-INTERFACE-SW            PIC X.
  4623         16  CM-PREMIUM-TYPE               PIC X.
  4624             88  CM-SING-PRM                  VALUE '1'.
  4625             88  CM-O-B-COVERAGE              VALUE '2'.
  4626             88  CM-OPEN-END                  VALUE '3'.
  4627         16  CM-IND-GRP-TYPE               PIC X.
  4628             88  CM-INDIVIDUAL                VALUE 'I'.
  4629             88  CM-GROUP                     VALUE 'G'.
  4630         16  CM-SKIP-CODE                  PIC X.
  4631             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4632             88  SKIP-JULY                    VALUE '1'.
  4633             88  SKIP-AUGUST                  VALUE '2'.
  4634             88  SKIP-SEPTEMBER               VALUE '3'.
  4635             88  SKIP-JULY-AUG                VALUE '4'.
  4636             88  SKIP-AUG-SEPT                VALUE '5'.
  4637             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4638             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4639             88  SKIP-JUNE                    VALUE '8'.
  4640             88  SKIP-JUNE-JULY               VALUE '9'.
  4641             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4642             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4643         16  CM-PAYMENT-MODE               PIC X.
  4644             88  PAY-MONTHLY                  VALUE SPACE.
  4645             88  PAY-WEEKLY                   VALUE '1'.
  4646             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4647             88  PAY-BI-WEEKLY                VALUE '3'.
  4648             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4649         16  CM-LOAN-NUMBER                PIC X(8).
  4650         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4651         16  CM-OLD-LOF                    PIC XXX.
  4652*        16  CM-LOAN-OFFICER               PIC XXX.
  4653         16  CM-REIN-TABLE                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL677.cbl
  4654         16  CM-SPECIAL-REIN-CODE          PIC X.
  4655         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4656         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4657         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4658
  4659     12  CM-STATUS-DATA.
  4660         16  CM-ENTRY-STATUS               PIC X.
  4661         16  CM-ENTRY-DT                   PIC XX.
  4662
  4663         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4664         16  CM-LF-CANCEL-DT               PIC XX.
  4665         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4666
  4667         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4668         16  CM-LF-DEATH-DT                PIC XX.
  4669         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4670
  4671         16  CM-LF-CURRENT-STATUS          PIC X.
  4672             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4673                                                'M' '4' '5' '9'.
  4674             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4675             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4676             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4677             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4678             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4679             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4680             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4681             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4682             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4683             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4684             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4685             88  CM-LF-DECLINED               VALUE 'D'.
  4686             88  CM-LF-VOIDED                 VALUE 'V'.
  4687
  4688         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4689         16  CM-AH-CANCEL-DT               PIC XX.
  4690         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4691
  4692         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4693         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4694         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4695
  4696         16  CM-AH-CURRENT-STATUS          PIC X.
  4697             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4698                                                'M' '4' '5' '9'.
  4699             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4700             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4701             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4702             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4703             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4704             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4705             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4706             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4707             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4708             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4709             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4710             88  CM-AH-DECLINED               VALUE 'D'.
  4711             88  CM-AH-VOIDED                 VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL677.cbl
  4712
  4713         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4714             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4715             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4716             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4717         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4718
  4719         16  CM-ENTRY-BATCH                PIC X(6).
  4720         16  CM-LF-EXIT-BATCH              PIC X(6).
  4721         16  CM-AH-EXIT-BATCH              PIC X(6).
  4722         16  CM-LAST-MONTH-END             PIC XX.
  4723
  4724     12  CM-NOTE-SW                        PIC X.
  4725         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4726         88  CERT-NOTES-PRESENT               VALUE '1'.
  4727         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4728         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4729         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4730         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4731         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4732         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4733     12  CM-COMP-EXCP-SW                   PIC X.
  4734         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4735         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4736     12  CM-INSURED-ADDRESS-SW             PIC X.
  4737         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4738         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4739
  4740*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4741     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4742     12  FILLER                            PIC X.
  4743
  4744*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4745     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4746     12  FILLER                            PIC X.
  4747*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4748     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4749
  4750     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4751         88  CERT-ADDED-BATCH                 VALUE ' '.
  4752         88  CERT-ADDED-ONLINE                VALUE '1'.
  4753         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4754         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4755         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4756     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4757         88  CERT-AS-LOADED                   VALUE ' '.
  4758         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4759         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4760         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4761         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4762         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4763         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4764         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4765
  4766     12  CM-ACCOUNT-COMM-PCTS.
  4767         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4768         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4769
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL677.cbl
  4770     12  CM-USER-FIELD                     PIC X.
  4771     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4772     12  CM-CLP-STATE                      PIC XX.
  4773     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4774     12  CM-USER-RESERVED                  PIC XXX.
  4775     12  FILLER REDEFINES CM-USER-RESERVED.
  4776         16  CM-AH-CLASS-CD                PIC XX.
  4777         16  F                             PIC X.
  4778******************************************************************
  4779*                                    COPY ERCPNDB.
  4780******************************************************************
  4781*                                                                *
  4782*                                                                *
  4783*                            ERCPNDB.                            *
  4784*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4785*                            VMOD=2.025                          *
  4786*                                                                *
  4787*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4788*                                                                *
  4789******************************************************************
  4790*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4791*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4792******************************************************************
  4793*                                                                *
  4794*                                                                *
  4795*   FILE TYPE = VSAM,KSDS                                        *
  4796*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4797*                                                                *
  4798*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4799*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4800*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4801*                                                 RKP=13,LEN=36  *
  4802*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4803*                                      AND CHG-SEQ.)             *
  4804*                                                RKP=49,LEN=11   *
  4805*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4806*                                      AND CHG-SEQ.)             *
  4807*                                                RKP=60,LEN=15   *
  4808*                                                                *
  4809*   LOG = NO                                                     *
  4810*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4811******************************************************************
  4812******************************************************************
  4813*                   C H A N G E   L O G
  4814*
  4815* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4816*-----------------------------------------------------------------
  4817*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4818* EFFECTIVE    NUMBER
  4819*-----------------------------------------------------------------
  4820* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4821* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4822* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4823* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4824* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4825* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4826* 032306                   PEMA  ADD BOW LOAN NUMBER
  4827* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL677.cbl
  4828* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4829* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4830* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4831* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4832* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4833* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4834* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4835* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4836******************************************************************
  4837
  4838 01  PENDING-BUSINESS.
  4839     12  PB-RECORD-ID                     PIC XX.
  4840         88  VALID-PB-ID                        VALUE 'PB'.
  4841
  4842     12  PB-CONTROL-PRIMARY.
  4843         16  PB-COMPANY-CD                PIC X.
  4844         16  PB-ENTRY-BATCH               PIC X(6).
  4845         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4846         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4847
  4848     12  PB-CONTROL-BY-ACCOUNT.
  4849         16  PB-COMPANY-CD-A1             PIC X.
  4850         16  PB-CARRIER                   PIC X.
  4851         16  PB-GROUPING.
  4852             20  PB-GROUPING-PREFIX       PIC XXX.
  4853             20  PB-GROUPING-PRIME        PIC XXX.
  4854         16  PB-STATE                     PIC XX.
  4855         16  PB-ACCOUNT.
  4856             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4857             20  PB-ACCOUNT-PRIME         PIC X(6).
  4858         16  PB-CERT-EFF-DT               PIC XX.
  4859         16  PB-CERT-NO.
  4860             20  PB-CERT-PRIME            PIC X(10).
  4861             20  PB-CERT-SFX              PIC X.
  4862         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4863
  4864         16  PB-RECORD-TYPE               PIC X.
  4865             88  PB-MAILING-DATA                VALUE '0'.
  4866             88  PB-ISSUE                       VALUE '1'.
  4867             88  PB-CANCELLATION                VALUE '2'.
  4868             88  PB-BATCH-TRAILER               VALUE '9'.
  4869
  4870     12  PB-CONTROL-BY-ORIG-BATCH.
  4871         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4872         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4873         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4874         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4875
  4876     12  PB-CONTROL-BY-CSR.
  4877         16  PB-CSR-COMPANY-CD            PIC X.
  4878         16  PB-CSR-ID                    PIC X(4).
  4879         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4880         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4881         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4882******************************************************************
  4883*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4884******************************************************************
  4885
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL677.cbl
  4886     12  PB-LAST-MAINT-DT                 PIC XX.
  4887     12  PB-LAST-MAINT-BY                 PIC X(4).
  4888     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4889
  4890     12  PB-RECORD-BODY                   PIC X(375).
  4891
  4892     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4893         16  PB-CERT-ORIGIN               PIC X.
  4894             88  CLASIC-CREATED-CERT         VALUE '1'.
  4895         16  PB-I-NAME.
  4896             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4897             20  PB-I-INSURED-FIRST-NAME.
  4898                 24  PB-I-INSURED-1ST-INIT PIC X.
  4899                 24  FILLER                PIC X(9).
  4900             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4901         16  PB-I-AGE                     PIC S99   COMP-3.
  4902         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4903         16  PB-I-BIRTHDAY                PIC XX.
  4904         16  PB-I-INSURED-SEX             PIC X.
  4905             88  PB-SEX-MALE     VALUE 'M'.
  4906             88  PB-SEX-FEMALE   VALUE 'F'.
  4907
  4908         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4909         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4910         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4911         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4912         16  PB-I-SKIP-CODE               PIC X.
  4913             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4914             88  PB-SKIP-JULY              VALUE '1'.
  4915             88  PB-SKIP-AUGUST            VALUE '2'.
  4916             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4917             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4918             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4919             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4920             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4921             88  PB-SKIP-JUNE              VALUE '8'.
  4922             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4923             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4924             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4925         16  PB-I-TERM-TYPE               PIC X.
  4926             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4927             88  PB-PAID-WEEKLY            VALUE 'W'.
  4928             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4929             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4930             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4931         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4932         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4933         16  PB-I-DATA-ENTRY-SW           PIC X.
  4934             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4935             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4936             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4937             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4938         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4939         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4940*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4941         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4942         16  FILLER                       PIC X.
  4943
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL677.cbl
  4944         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4945             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4946             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4947                                                   '90' THRU '99'.
  4948         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4949                                          PIC XX.
  4950         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4951         16  PB-I-AMOUNT-FINANCED REDEFINES
  4952                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4953         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4954         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4955                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4956         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4957         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4958         16  PB-I-CLP-AMOUNT REDEFINES
  4959                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4960         16  PB-I-LF-CALC-FLAG            PIC X.
  4961             88 PB-COMP-LF-PREM               VALUE '?'.
  4962         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4963         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4964         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4965         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4966         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4967         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4968         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4969         16  PB-I-LF-ABBR                 PIC XXX.
  4970         16  PB-I-LF-INPUT-CD             PIC XX.
  4971
  4972         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4973             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4974             88  PB-INVALID-AH               VALUE '  ' '00'
  4975                                                   '90' THRU '99'.
  4976         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4977         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4978         16  PB-I-AH-CALC-FLAG            PIC X.
  4979             88 PB-COMP-AH-PREM                  VALUE '?'.
  4980         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4981         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4982         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4983         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4984         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4985         16  PB-I-AH-ABBR                 PIC XXX.
  4986         16  PB-I-AH-INPUT-CD             PIC XXX.
  4987
  4988         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4989         16  PB-I-REIN-TABLE              PIC XXX.
  4990         16  PB-I-BUSINESS-TYPE           PIC 99.
  4991         16  PB-I-INDV-GRP-CD             PIC X.
  4992         16  PB-I-MORT-CODE.
  4993             20  PB-I-TABLE               PIC X.
  4994             20  PB-I-INTEREST            PIC XX.
  4995             20  PB-I-MORT-TYP            PIC X.
  4996         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4997         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4998         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4999         16  PB-I-INDV-GRP-OVRD           PIC X.
  5000         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5001         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL677.cbl
  5002             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5003         16  PB-I-RATE-CLASS              PIC XX.
  5004         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5005         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5006         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5007         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5008         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5009         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5010         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5011         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5012         16  PB-I-OB-FLAG                 PIC X.
  5013             88  PB-I-OB                      VALUE 'B'.
  5014             88  PB-I-SUMMARY                 VALUE 'Z'.
  5015         16  PB-I-ENTRY-STATUS            PIC X.
  5016             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5017                                              'M' '5' '9' '2'.
  5018             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5019             88  PB-I-POLICY-PENDING          VALUE '2'.
  5020             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5021             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5022             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5023             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5024             88  PB-I-REIN-ONLY               VALUE '9'.
  5025             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5026             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5027             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5028             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5029         16  PB-I-INT-CODE                PIC X.
  5030             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5031             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5032         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5033         16  PB-I-SOC-SEC-NO              PIC X(11).
  5034         16  PB-I-MEMBER-NO               PIC X(12).
  5035         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5036*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5037         16  PB-I-OLD-LOF                 PIC XXX.
  5038         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5039         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5040         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5041         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5042         16  PB-I-LIFE-INDICATOR          PIC X.
  5043             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5044         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5045         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5046                                          PIC S9(5)V99    COMP-3.
  5047         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5048             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5049             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5050         16  PB-I-1ST-PMT-DT              PIC XX.
  5051         16  PB-I-JOINT-INSURED.
  5052             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5053             20 PB-I-JOINT-FIRST-NAME.
  5054                24  PB-I-JOINT-FIRST-INIT PIC X.
  5055                24  FILLER                PIC X(9).
  5056             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5057*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5058         16  PB-I-BENEFICIARY-NAME.
  5059             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL677.cbl
  5060             20  FILLER                   PIC X(15).
  5061         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5062         16  PB-I-REFERENCE               PIC X(12).
  5063         16  FILLER REDEFINES PB-I-REFERENCE.
  5064             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5065             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5066             20  PB-I-CLP-STATE           PIC XX.
  5067         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5068             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5069             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5070             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5071         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5072         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5073         16  PB-I-RESIDENT-STATE          PIC XX.
  5074         16  PB-I-RATE-CODE               PIC X(4).
  5075         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5076         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5077         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5078         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5079         16  PB-I-BANK-NOCHRGB            PIC 99.
  5080         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5081         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5082
  5083     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5084         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5085             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5086         16  PB-C-CANCEL-ORIGIN           PIC X.
  5087             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5088         16  PB-C-LF-CANCEL-DT            PIC XX.
  5089         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5090         16  PB-C-LF-CALC-REQ             PIC X.
  5091             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5092         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5093         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5094         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5095             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5096         16  PB-C-AH-CANCEL-DT            PIC XX.
  5097         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5098         16  PB-C-AH-CALC-REQ             PIC X.
  5099             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5100         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5101         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5102         16  PB-C-LAST-NAME               PIC X(15).
  5103         16  PB-C-REFUND-SW               PIC X.
  5104             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5105             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5106         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5107         16  PB-C-PAYEE-CODE              PIC X(6).
  5108         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5109         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5110         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5111         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5112         16  PB-C-REFERENCE               PIC X(12).
  5113         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5114         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5115         16  PB-C-POST-CARD-IND           PIC X.
  5116         16  PB-C-CANCEL-REASON           PIC X.
  5117         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL677.cbl
  5118         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5119         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5120         16  FILLER                       PIC X(01).
  5121*        16  FILLER                       PIC X(18).
  5122         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5123*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5124         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5125         16  PB-CANCELED-CERT-DATA.
  5126             20  PB-CI-INSURED-NAME.
  5127                 24  PB-CI-LAST-NAME      PIC X(15).
  5128                 24  PB-CI-INITIALS       PIC XX.
  5129             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5130             20  PB-CI-INSURED-SEX        PIC X.
  5131             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5132             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5133             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5134             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5135             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5136             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5137             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5138             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5139             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5140             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5141             20  PB-CI-RATE-CLASS         PIC XX.
  5142             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5143             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5144             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5145             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5146             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5147             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5148             20  PB-CI-LF-ABBR            PIC X(3).
  5149             20  PB-CI-AH-ABBR            PIC X(3).
  5150             20  PB-CI-OB-FLAG            PIC X.
  5151                 88  PB-CI-OB                VALUE 'B'.
  5152             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5153                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5154                                           'M' '4' '5' '9' '2'.
  5155                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5156                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5157                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5158                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5159                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5160                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5161                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5162                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5163                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5164                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5165                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5166                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5167                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5168             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5169                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5170                                           'M' '4' '5' '9' '2'.
  5171                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5172                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5173                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5174                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5175                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL677.cbl
  5176                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5177                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5178                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5179                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5180                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5181                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5182                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5183                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5184             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5185             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5186             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5187             20  PB-CI-MEMBER-NO          PIC X(12).
  5188             20  PB-CI-INT-CODE           PIC X.
  5189                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5190                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5191             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5192             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5193             20  PB-CI-COMP-EXCP-SW       PIC X.
  5194                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5195                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5196             20  PB-CI-ENTRY-STATUS       PIC X.
  5197             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5198             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5199             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5200             20  PB-CI-DEATH-DT           PIC XX.
  5201             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5202             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5203             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5204             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5205             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5206             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5207             20  PB-CI-ENTRY-DT              PIC XX.
  5208             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5209             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5210             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5211             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5212             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5213             20  PB-CI-OLD-LOF               PIC XXX.
  5214*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5215             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5216             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5217             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5218             20  PB-CI-INDV-GRP-CD           PIC X.
  5219             20  PB-CI-BENEFICIARY-NAME.
  5220                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5221                 24  FILLER                  PIC X(15).
  5222             20  PB-CI-NOTE-SW               PIC X.
  5223             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5224             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5225             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5226             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5227             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5228             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5229             20  PB-CI-FIRST-NAME            PIC X(10).
  5230             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5231
  5232         16  FILLER                       PIC X(13).
  5233*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL677.cbl
  5234*        16  FILLER                       PIC X(46).
  5235
  5236     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5237         16  FILLER                       PIC X(10).
  5238         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5239         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5240         16  PB-M-INSURED-MID-INIT        PIC X.
  5241         16  PB-M-INSURED-AGE             PIC 99.
  5242         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5243         16  PB-M-INSURED-SEX             PIC X.
  5244         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5245         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5246         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5247         16  PB-M-INSURED-CITY-STATE.
  5248             20  PB-M-INSURED-CITY        PIC X(28).
  5249             20  PB-M-INSURED-STATE       PIC XX.
  5250         16  PB-M-INSURED-ZIP-CODE.
  5251             20  PB-M-INSURED-ZIP-PRIME.
  5252                 24  PB-M-INSURED-ZIP-1   PIC X.
  5253                     88  PB-M-CANADIAN-POST-CODE
  5254                                             VALUE 'A' THRU 'Z'.
  5255                 24  FILLER               PIC X(4).
  5256             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5257         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5258                                        PB-M-INSURED-ZIP-CODE.
  5259             20  PM-M-INS-CAN-POST1       PIC XXX.
  5260             20  PM-M-INS-CAN-POST2       PIC XXX.
  5261             20  FILLER                   PIC XXX.
  5262         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5263         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5264         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5265         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5266         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5267         16  PB-M-CRED-BENE-CITYST.
  5268             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5269             20  PB-M-CRED-BENE-STATE     PIC XX.
  5270         16  FILLER                       PIC X(92).
  5271
  5272     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5273         16  FILLER                       PIC X(10).
  5274         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5275         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5276         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5277         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5278         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5279         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5280         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5281         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5282         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5283         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5284         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5285         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5286         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5287         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5288         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5289         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5290         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5291         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL677.cbl
  5292         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5293         16  PB-REFERENCE                 PIC X(12).
  5294         16  PB-B-RECEIVED-DT             PIC XX.
  5295         16  FILLER                       PIC X(234).
  5296
  5297     12  PB-RECORD-STATUS.
  5298         16  PB-CREDIT-SELECT-DT          PIC XX.
  5299         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5300         16  PB-BILLED-DT                 PIC XX.
  5301         16  PB-BILLING-STATUS            PIC X.
  5302             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5303             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5304             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5305         16  PB-RECORD-BILL               PIC X.
  5306             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5307             88  PB-RECORD-RETURNED           VALUE 'R'.
  5308             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5309             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5310             88  PB-OVERRIDE-AH               VALUE 'A'.
  5311             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5312         16  PB-BATCH-ENTRY               PIC X.
  5313             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5314             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5315             88  PB-REISSUED-CERT             VALUE 'E'.
  5316             88  PB-CASH-CERT                 VALUE 'C'.
  5317             88  PB-MONTHLY-CERT              VALUE 'M'.
  5318             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5319             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5320             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5321         16  PB-FORCE-CODE                PIC X.
  5322             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5323             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5324             88  PB-CANCEL-FORCE              VALUE '8'.
  5325             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5326             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5327             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5328             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5329             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5330             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5331             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5332         16  PB-FATAL-FLAG                PIC X.
  5333             88  PB-FATAL-ERRORS              VALUE 'X'.
  5334         16  PB-FORCE-ER-CD               PIC X.
  5335             88  PB-FORCE-ERRORS              VALUE 'F'.
  5336             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5337         16  PB-WARN-ER-CD                PIC X.
  5338             88  PB-WARNING-ERRORS            VALUE 'W'.
  5339         16  FILLER                       PIC X.
  5340         16  PB-OUT-BAL-CD                PIC X.
  5341             88  PB-OUT-OF-BAL                VALUE 'O'.
  5342         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5343         16  PB-AH-OVERRIDE-L1            PIC X.
  5344         16  PB-INPUT-DT                  PIC XX.
  5345         16  PB-INPUT-BY                  PIC X(4).
  5346         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5347         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5348         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5349         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL677.cbl
  5350         16  PB-AH-EARNING-METHOD         PIC X.
  5351         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5352         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5353         16  PB-REIN-CD                   PIC XXX.
  5354         16  PB-LF-REFUND-TYPE            PIC X.
  5355         16  PB-AH-REFUND-TYPE            PIC X.
  5356         16  PB-ACCT-EFF-DT               PIC XX.
  5357         16  PB-ACCT-EXP-DT               PIC XX.
  5358         16  PB-COMPANY-ID                PIC X(3).
  5359         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5360         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5361         16  PB-SV-CARRIER                PIC X.
  5362         16  PB-SV-GROUPING               PIC X(6).
  5363         16  PB-SV-STATE                  PIC XX.
  5364         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5365         16  PB-GA-BILLING-INFO.
  5366             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5367                                          PIC XX.
  5368         16  PB-SV-REMIT-TO  REDEFINES
  5369             PB-GA-BILLING-INFO           PIC X(10).
  5370         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5371         16  PB-I-LOAN-OFFICER            PIC X(5).
  5372         16  PB-I-VIN                     PIC X(17).
  5373
  5374         16  FILLER                       PIC X(04).
  5375         16  IMNET-BYPASS-SW              PIC X.
  5376
  5377******************************************************************
  5378*                COMMON EDIT ERRORS                              *
  5379******************************************************************
  5380
  5381     12  PB-COMMON-ERRORS.
  5382         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5383                                           PIC S9(4)     COMP.
  5384
  5385******************************************************************
  5386*                                    COPY ERCPNDM.
  5387******************************************************************
  5388*                                                                *
  5389*                                                                *
  5390*                            ERCPNDM                             *
  5391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5392*                            VMOD=2.003                          *
  5393*                                                                *
  5394*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5395*                                                                *
  5396*   FILE TYPE = VSAM,KSDS                                        *
  5397*   RECORD SIZE = 374   RECFORM = FIX                            *
  5398*                                                                *
  5399*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5400*   ALTERNATE PATH    = NOT USED                                 *
  5401*                                                                *
  5402*   LOG = YES                                                    *
  5403*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5404******************************************************************
  5405*                   C H A N G E   L O G
  5406*
  5407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL677.cbl
  5408*-----------------------------------------------------------------
  5409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5410* EFFECTIVE    NUMBER
  5411*-----------------------------------------------------------------
  5412* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5413* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5414* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5415******************************************************************
  5416
  5417 01  PENDING-MAILING-DATA.
  5418     12  PM-RECORD-ID                      PIC XX.
  5419         88  VALID-MA-ID                       VALUE 'PM'.
  5420
  5421     12  PM-CONTROL-PRIMARY.
  5422         16  PM-COMPANY-CD                 PIC X.
  5423         16  PM-ENTRY-BATCH                PIC X(6).
  5424         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5425         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5426
  5427     12  FILLER                            PIC X(14).
  5428
  5429     12  PM-ACCESS-CONTROL.
  5430         16  PM-SOURCE-SYSTEM              PIC XX.
  5431             88  PM-FROM-CREDIT                VALUE 'CR'.
  5432             88  PM-FROM-VSI                   VALUE 'VS'.
  5433             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5434             88  PM-FROM-OTHER                 VALUE 'OT'.
  5435         16  PM-RECORD-ADD-DT              PIC XX.
  5436         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5437         16  PM-LAST-MAINT-DT              PIC XX.
  5438         16  PM-LAST-MAINT-BY              PIC XXXX.
  5439         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5440
  5441     12  PM-PROFILE-INFO.
  5442         16  PM-QUALIFY-CODE-1             PIC XX.
  5443         16  PM-QUALIFY-CODE-2             PIC XX.
  5444         16  PM-QUALIFY-CODE-3             PIC XX.
  5445         16  PM-QUALIFY-CODE-4             PIC XX.
  5446         16  PM-QUALIFY-CODE-5             PIC XX.
  5447
  5448         16  PM-INSURED-LAST-NAME          PIC X(15).
  5449         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5450         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5451         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5452         16  PM-INSURED-BIRTH-DT           PIC XX.
  5453         16  PM-INSURED-SEX                PIC X.
  5454             88  PM-SEX-MALE                   VALUE 'M'.
  5455             88  PM-SEX-FEMALE                 VALUE 'F'.
  5456         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5457
  5458         16  PM-ADDRESS-CORRECTED          PIC X.
  5459         16  PM-JOINT-BIRTH-DT             PIC XX.
  5460*        16  FILLER                        PIC X(12).
  5461
  5462         16  PM-ADDRESS-LINE-1             PIC X(30).
  5463         16  PM-ADDRESS-LINE-2             PIC X(30).
  5464         16  PM-CITY-STATE.
  5465             20  PM-CITY                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL677.cbl
  5466             20  PM-STATE                  PIC XX.
  5467         16  PM-ZIP.
  5468             20  PM-ZIP-CODE.
  5469                 24  PM-ZIP-1              PIC X.
  5470                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5471                 24  FILLER                PIC X(4).
  5472             20  PM-ZIP-PLUS4              PIC X(4).
  5473         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5474             20  PM-CAN-POST1              PIC XXX.
  5475             20  PM-CAN-POST2              PIC XXX.
  5476             20  FILLER                    PIC XXX.
  5477
  5478         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5479
  5480         16  FILLER                        PIC X(03).
  5481
  5482     12  PM-CRED-BENE-INFO.
  5483         16  PM-CRED-BENE-NAME             PIC X(25).
  5484         16  PM-CRED-BENE-ADDR             PIC X(30).
  5485         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5486         16  PM-CRED-BENE-CTYST.
  5487             20  PM-CRED-BENE-CITY         PIC X(28).
  5488             20  PM-CRED-BENE-STATE        PIC XX.
  5489         16  PM-CRED-BENE-ZIP.
  5490             20  PM-CB-ZIP-CODE.
  5491                 24  PM-CB-ZIP-1           PIC X.
  5492                     88  PM-CB-CANADIAN-POST-CODE
  5493                                  VALUE 'A' THRU 'Z'.
  5494                 24  FILLER                PIC X(4).
  5495             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5496         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5497             20  PM-CB-CAN-POST1           PIC XXX.
  5498             20  PM-CB-CAN-POST2           PIC XXX.
  5499             20  FILLER                    PIC XXX.
  5500     12  PM-POST-CARD-MAIL-DATA.
  5501         16  PM-MAIL-DATA OCCURS 7.
  5502             20  PM-MAIL-TYPE              PIC X.
  5503                 88  PM-12MO-MAILING           VALUE '1'.
  5504                 88  PM-EXP-MAILING            VALUE '2'.
  5505             20  PM-MAIL-STATUS            PIC X.
  5506                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5507                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5508                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5509             20  PM-MAIL-DATE              PIC XX.
  5510     12  FILLER                            PIC XX.
  5511     12  FILLER                            PIC X(12).
  5512*    12  FILLER                            PIC X(30).
  5513
  5514******************************************************************
  5515*                                    COPY ERCMAIL.
  5516******************************************************************
  5517*                                                                *
  5518*                                                                *
  5519*                            ERCMAIL                             *
  5520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5521*                            VMOD=2.003                          *
  5522*                                                                *
  5523*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL677.cbl
  5524*                                                                *
  5525*   FILE TYPE = VSAM,KSDS                                        *
  5526*   RECORD SIZE = 374   RECFORM = FIX                            *
  5527*                                                                *
  5528*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5529*   ALTERNATE PATH    = NOT USED                                 *
  5530*                                                                *
  5531*   LOG = YES                                                    *
  5532*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5533******************************************************************
  5534*                   C H A N G E   L O G
  5535*
  5536* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5537*-----------------------------------------------------------------
  5538*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5539* EFFECTIVE    NUMBER
  5540*-----------------------------------------------------------------
  5541* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5542* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5543* 111108                   PEMA  ADD CRED BENE ADDR2
  5544******************************************************************
  5545
  5546 01  MAILING-DATA.
  5547     12  MA-RECORD-ID                      PIC XX.
  5548         88  VALID-MA-ID                       VALUE 'MA'.
  5549
  5550     12  MA-CONTROL-PRIMARY.
  5551         16  MA-COMPANY-CD                 PIC X.
  5552         16  MA-CARRIER                    PIC X.
  5553         16  MA-GROUPING.
  5554             20  MA-GROUPING-PREFIX        PIC XXX.
  5555             20  MA-GROUPING-PRIME         PIC XXX.
  5556         16  MA-STATE                      PIC XX.
  5557         16  MA-ACCOUNT.
  5558             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5559             20  MA-ACCOUNT-PRIME          PIC X(6).
  5560         16  MA-CERT-EFF-DT                PIC XX.
  5561         16  MA-CERT-NO.
  5562             20  MA-CERT-PRIME             PIC X(10).
  5563             20  MA-CERT-SFX               PIC X.
  5564
  5565     12  FILLER                            PIC XX.
  5566
  5567     12  MA-ACCESS-CONTROL.
  5568         16  MA-SOURCE-SYSTEM              PIC XX.
  5569             88  MA-FROM-CREDIT                VALUE 'CR'.
  5570             88  MA-FROM-VSI                   VALUE 'VS'.
  5571             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5572             88  MA-FROM-OTHER                 VALUE 'OT'.
  5573         16  MA-RECORD-ADD-DT              PIC XX.
  5574         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5575         16  MA-LAST-MAINT-DT              PIC XX.
  5576         16  MA-LAST-MAINT-BY              PIC XXXX.
  5577         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5578
  5579     12  MA-PROFILE-INFO.
  5580         16  MA-QUALIFY-CODE-1             PIC XX.
  5581         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL677.cbl
  5582         16  MA-QUALIFY-CODE-3             PIC XX.
  5583         16  MA-QUALIFY-CODE-4             PIC XX.
  5584         16  MA-QUALIFY-CODE-5             PIC XX.
  5585
  5586         16  MA-INSURED-LAST-NAME          PIC X(15).
  5587         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5588         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5589         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5590         16  MA-INSURED-BIRTH-DT           PIC XX.
  5591         16  MA-INSURED-SEX                PIC X.
  5592             88  MA-SEX-MALE                   VALUE 'M'.
  5593             88  MA-SEX-FEMALE                 VALUE 'F'.
  5594         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5595
  5596         16  MA-ADDRESS-CORRECTED          PIC X.
  5597         16  MA-JOINT-BIRTH-DT             PIC XX.
  5598*        16  FILLER                        PIC X(12).
  5599
  5600         16  MA-ADDRESS-LINE-1             PIC X(30).
  5601         16  MA-ADDRESS-LINE-2             PIC X(30).
  5602         16  MA-CITY-STATE.
  5603             20  MA-CITY                   PIC X(28).
  5604             20  MA-ADDR-STATE             PIC XX.
  5605         16  MA-ZIP.
  5606             20  MA-ZIP-CODE.
  5607                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5608                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5609                 24  FILLER                PIC X(4).
  5610             20  MA-ZIP-PLUS4              PIC X(4).
  5611         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5612             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5613             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5614             20  FILLER                    PIC X(3).
  5615
  5616         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5617
  5618         16  FILLER                        PIC XXX.
  5619*        16  FILLER                        PIC X(10).
  5620
  5621     12  MA-CRED-BENE-INFO.
  5622         16  MA-CRED-BENE-NAME                 PIC X(25).
  5623         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5624         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5625         16  MA-CRED-BENE-CTYST.
  5626             20  MA-CRED-BENE-CITY             PIC X(28).
  5627             20  MA-CRED-BENE-STATE            PIC XX.
  5628         16  MA-CRED-BENE-ZIP.
  5629             20  MA-CB-ZIP-CODE.
  5630                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5631                     88  MA-CB-CANADIAN-POST-CODE
  5632                                           VALUE 'A' THRU 'Z'.
  5633                 24  FILLER                    PIC X(4).
  5634             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5635         16  MA-CB-CANADIAN-POSTAL-CODE
  5636                            REDEFINES MA-CRED-BENE-ZIP.
  5637             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5638             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5639             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL677.cbl
  5640     12  MA-POST-CARD-MAIL-DATA.
  5641         16  MA-MAIL-DATA OCCURS 7.
  5642             20  MA-MAIL-TYPE              PIC X.
  5643                 88  MA-12MO-MAILING           VALUE '1'.
  5644                 88  MA-EXP-MAILING            VALUE '2'.
  5645             20  MA-MAIL-STATUS            PIC X.
  5646                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5647                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5648                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5649             20  MA-MAIL-DATE              PIC XX.
  5650     12  FILLER                            PIC XX.
  5651     12  FILLER                            PIC XX.
  5652*    12  FILLER                            PIC X(30).
  5653******************************************************************
  5654*                                    COPY ERCPYAJ.
  5655******************************************************************
  5656*                                                                *
  5657*                            ERCPYAJ                             *
  5658*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5659*                            VMOD=2.015                          *
  5660*                                                                *
  5661*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5662*                                                                *
  5663*                                                                *
  5664*   FILE TYPE = VSAM,KSDS                                        *
  5665*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5666*                                                                *
  5667*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5668*       ALTERNATE PATHS = NONE                                   *
  5669*                                                                *
  5670*   LOG = YES                                                    *
  5671*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5672******************************************************************
  5673******************************************************************
  5674*                   C H A N G E   L O G
  5675*
  5676* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5677*-----------------------------------------------------------------
  5678*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5679* EFFECTIVE    NUMBER
  5680*-----------------------------------------------------------------
  5681* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5682* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5683******************************************************************
  5684
  5685 01  PENDING-PAY-ADJ.
  5686     12  PY-RECORD-ID                     PIC XX.
  5687         88  VALID-PY-ID                        VALUE 'PY'.
  5688
  5689     12  PY-CONTROL-PRIMARY.
  5690         16  PY-COMPANY-CD                PIC X.
  5691         16  PY-CARRIER                   PIC X.
  5692         16  PY-GROUPING                  PIC X(6).
  5693         16  PY-FIN-RESP                  PIC X(10).
  5694         16  PY-ACCOUNT                   PIC X(10).
  5695         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5696                                          PIC X(10).
  5697         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL677.cbl
  5698         16  PY-RECORD-TYPE               PIC X.
  5699             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5700             88  PY-DEPOSIT                   VALUE 'D'.
  5701             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5702             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5703             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5704             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5705             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5706             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5707             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5708             88  PY-FICA-ENTRY                VALUE 'F'.
  5709             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5710             88  PY-POLICY-FEE                VALUE 'W'.
  5711             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5712
  5713     12  PY-PYMT-TYPE                     PIC X.
  5714             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5715             88  PY-REINS-PYMT                VALUE 'R'.
  5716             88  PY-EXP-PYMT                  VALUE 'E'.
  5717
  5718     12  PY-BIL-INV                       PIC X(6).
  5719     12  PY-REF-NO                        PIC X(12).
  5720
  5721     12  PY-LAST-MAINT-DT                 PIC XX.
  5722     12  PY-LAST-MAINT-BY                 PIC X(4).
  5723     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5724
  5725     12  PY-PYADJ-RECORD.
  5726         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5727         16  PY-ENTRY-COMMENT             PIC X(30).
  5728         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5729             20  PY-GL-ACCOUNT            PIC X(10).
  5730             20  PY-GL-STATE              PIC X(02).
  5731             20  PY-GL-CANC-SW            PIC X(01).
  5732                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5733                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5734             20  PY-GL-COMMENT            PIC X(10).
  5735             20  FILLER      REDEFINES PY-GL-COMMENT.
  5736                 24  PY-GL-CHECK-NO       PIC 9(06).
  5737                 24  FILLER               PIC X(04).
  5738             20  FILLER                   PIC X(07).
  5739         16  PY-SAVE-ACCOUNT              PIC X(10).
  5740         16  PY-SAVE-TYPE                 PIC X(01).
  5741
  5742         16  PY-LETTERS.
  5743             20  PY-LETTER OCCURS 3 TIMES
  5744                           INDEXED BY PY-LET-NDX
  5745                                          PIC X(04).
  5746
  5747         16  PY-ERCOMP-TYPE               PIC X.
  5748             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5749             88  PY-GA-TYPE                   VALUE 'G'.
  5750             88  PY-BANK-TYPE                 VALUE 'B'.
  5751         16  FILLER                       PIC X(05).
  5752
  5753     12  PY-RECORD-STATUS.
  5754         16  PY-CREDIT-SELECT-DT          PIC XX.
  5755         16  PY-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL677.cbl
  5756         16  PY-BILLED-DATE               PIC XX.
  5757         16  PY-REPORTED-DT               PIC XX.
  5758         16  PY-PMT-APPLIED               PIC X.
  5759             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5760             88  PY-GA-PMT                    VALUE 'G'.
  5761             88  PY-OVWRITE-PMT               VALUE 'O'.
  5762             88  PY-NON-AR-PMT                VALUE 'N'.
  5763         16  FILLER                       PIC X(5).
  5764         16  PY-INPUT-DT                  PIC XX.
  5765         16  PY-CHECK-NUMBER              PIC X(6).
  5766         16  PY-VOID-SW                   PIC X.
  5767             88  PY-CHECK-VOIDED              VALUE 'V'.
  5768         16  PY-CHECK-ORIGIN-SW           PIC X.
  5769             88  PY-BILLING-CHECK             VALUE 'B'.
  5770             88  PY-REFUND-CHECK              VALUE 'R'.
  5771             88  PY-GA-CHECK                  VALUE 'G'.
  5772             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5773             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5774         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5775         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5776         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5777         16  PY-BILL-FLAG                 PIC X.
  5778             88  PY-BILLED                    VALUE 'B'.
  5779         16  PY-AR-FLAG                   PIC X.
  5780             88  PY-AR-CYCLE                  VALUE 'C'.
  5781             88  PY-AR-MONTH-END              VALUE 'M'.
  5782         16  PY-AR-DATE                   PIC XX.
  5783
  5784     12  PY-GL-CODES.
  5785         16  PY-GL-DB                     PIC X(14).
  5786         16  PY-GL-CR                     PIC X(14).
  5787         16  PY-GL-FLAG                   PIC X.
  5788         16  PY-GL-DATE                   PIC XX.
  5789
  5790     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5791     12  FILLER                           PIC X(3).
  5792******************************************************************
  5793 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5794                          CHECK-RECORDS ACCOUNT-MASTER
  5795                          COMPENSATION-MASTER
  5796                          CERTIFICATE-MASTER PENDING-BUSINESS
  5797                          PENDING-MAILING-DATA MAILING-DATA
  5798                          PENDING-PAY-ADJ.
  5799 0000-DFHEXIT SECTION.
  5800     MOVE '9#                    $   ' TO DFHEIV0.
  5801     MOVE 'EL677' TO DFHEIV1.
  5802     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5803
  5804     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5805     MOVE '5'                    TO  DC-OPTION-CODE.
  5806     PERFORM 8500-DATE-CONVERT.
  5807     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5808     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5809     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5810
  5811     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5812
  5813     IF PI-AMOUNT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL677.cbl
  5814         MOVE ZEROS              TO  PI-AMOUNT.
  5815
  5816     IF EIBCALEN = 0
  5817         GO TO 8800-UNAUTHORIZED-ACCESS.
  5818     set P to address of KIXSYS
  5819     CALL "getenv" using by value P returning var-ptr
  5820     if var-ptr = null then
  5821        display ' kixsys not set '
  5822     else
  5823        set address of var to var-ptr
  5824        move 0 to env-var-len
  5825        inspect var tallying env-var-len
  5826          for characters before X'00'
  5827        unstring var (1:env-var-len) delimited by '/'
  5828           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5829              WS-KIX-SYS
  5830        end-unstring
  5831     end-if
  5832     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5833     MOVE 2                      TO  EMI-SWITCH2.
  5834     MOVE EIBTRMID               TO  QID-TERM.
  5835
  5836     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5837         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5838
  5839     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5840         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5841             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5842             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5843             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5844             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5845             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5846             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5847             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5848             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5849         ELSE
  5850             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5851             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5852             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5853             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5854             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5855             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5856             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5857             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5858
  5859     MOVE LOW-VALUES             TO  EL677AI.
  5860
  5861     IF EIBTRNID NOT = TRANS-ID
  5862         move pi-processor-id    to pi-return-to
  5863         move 'N'                to dedcyno
  5864         move al-uanon           to dedcyna
  5865         perform 6800-browse-previous-chek-recs
  5866                                 thru 6800-exit
  5867         perform 5600-get-erpndb thru 5600-exit
  5868         IF PI-TO-EL677-FROM-EL1273
  5869             MOVE 'S'            TO MAINTI
  5870             MOVE 1              TO MAINTL
  5871             MOVE AL-UABON       TO MAINTA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL677.cbl
  5872             MOVE DFHENTER       TO EIBAID
  5873             GO TO 5000-BROWSE-FILE.
  5874
  5875     IF EIBTRNID NOT = TRANS-ID
  5876        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5877           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5878           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5879           IF PI-PROCESS-BENEFICIARY
  5880              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5881           ELSE
  5882              GO TO 6300-BUILD-CERT-SCREEN
  5883           end-if
  5884        ELSE
  5885           IF EIBTRNID NOT = EL6311-TRANS-ID
  5886              GO TO 8100-SEND-INITIAL-MAP
  5887           ELSE
  5888              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5889              IF PI-PROCESS-BENEFICIARY
  5890                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5891              ELSE
  5892                 GO TO 6300-BUILD-CERT-SCREEN
  5893              end-if
  5894           end-if
  5895        end-if
  5896      end-if
  5897
  5898     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5899                                     PI-CHEK-COMP-CD.
  5900
  5901
  5902* EXEC CICS HANDLE CONDITION
  5903*        PGMIDERR  (9600-PGMID-ERROR)
  5904*        ERROR     (9990-ABEND)
  5905*    END-EXEC.
  5906*    MOVE '"$L.                  ! " #00005804' TO DFHEIV0
  5907     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5909     MOVE X'2220233030303035383034' TO DFHEIV0(25:11)
  5910     CALL 'kxdfhei1' USING DFHEIV0
  5911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5912
  5913
  5914     IF EIBAID = DFHCLEAR
  5915         GO TO 9400-CLEAR.
  5916
  5917     IF PI-PROCESSOR-ID = 'LGXX'
  5918         GO TO 0200-RECEIVE.
  5919
  5920
  5921* EXEC CICS READQ TS
  5922*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5923*        INTO   (SECURITY-CONTROL)
  5924*        LENGTH (SC-COMM-LENGTH)
  5925*        ITEM   (SC-ITEM)
  5926*    END-EXEC.
  5927*    MOVE '*$II   L              ''   #00005815' TO DFHEIV0
  5928     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL677.cbl
  5930     MOVE X'2020233030303035383135' TO DFHEIV0(25:11)
  5931     CALL 'kxdfhei1' USING DFHEIV0,
  5932           PI-SECURITY-TEMP-STORE-ID,
  5933           SECURITY-CONTROL,
  5934           SC-COMM-LENGTH,
  5935           SC-ITEM,
  5936           DFHEIV99,
  5937           DFHEIV99
  5938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5939
  5940
  5941     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5942     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5943
  5944     IF NOT DISPLAY-CAP
  5945         MOVE 'READ'          TO SM-READ
  5946         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5947         MOVE ER-0070         TO  EMI-ERROR
  5948         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5949         GO TO 8100-SEND-INITIAL-MAP.
  5950
  5951 0200-RECEIVE.
  5952     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5953         MOVE ER-1159            TO  EMI-ERROR
  5954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5955         MOVE -1                 TO  PFENTERL
  5956         GO TO 8200-SEND-DATAONLY.
  5957
  5958
  5959* EXEC CICS HANDLE CONDITION
  5960*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5961*    END-EXEC.
  5962*    MOVE '"$?                   ! # #00005839' TO DFHEIV0
  5963     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5965     MOVE X'2320233030303035383339' TO DFHEIV0(25:11)
  5966     CALL 'kxdfhei1' USING DFHEIV0
  5967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5968
  5969
  5970
  5971* EXEC CICS RECEIVE
  5972*        MAP      (EL677A)
  5973*        MAPSET   (MAPSET-NAME)
  5974*        INTO     (EL677AI)
  5975*    END-EXEC.
  5976     MOVE LENGTH OF
  5977      EL677AI
  5978       TO DFHEIV11
  5979*    MOVE '8"T I  L              ''   #00005843' TO DFHEIV0
  5980     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5981     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5982     MOVE X'2020233030303035383433' TO DFHEIV0(25:11)
  5983     CALL 'kxdfhei1' USING DFHEIV0,
  5984           EL677A,
  5985           EL677AI,
  5986           DFHEIV11,
  5987           MAPSET-NAME,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL677.cbl
  5988           DFHEIV99,
  5989           DFHEIV99
  5990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5991
  5992
  5993     IF PFENTERL GREATER ZERO
  5994         IF EIBAID NOT = DFHENTER
  5995             MOVE ER-0004        TO  EMI-ERROR
  5996             MOVE AL-UNBOF       TO  PFENTERA
  5997             MOVE -1             TO  PFENTERL
  5998             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5999             GO TO 8200-SEND-DATAONLY
  6000         ELSE
  6001             IF (PFENTERI NUMERIC) AND
  6002                (PFENTERI GREATER 0 AND LESS 25)
  6003                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6004             ELSE
  6005                 MOVE ER-0029    TO  EMI-ERROR
  6006                 MOVE AL-UNBOF   TO  PFENTERA
  6007                 MOVE -1         TO  PFENTERL
  6008                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6009                 GO TO 8200-SEND-DATAONLY.
  6010 0300-CHECK-PFKEYS.
  6011     IF EIBAID = DFHPF23
  6012         GO TO 8810-PF23.
  6013
  6014     IF EIBAID = DFHPF24
  6015         GO TO 9200-RETURN-MAIN-MENU.
  6016
  6017     IF EIBAID = DFHPF12
  6018         GO TO 9500-PF12.
  6019
  6020     IF EIBAID = DFHPF1 OR DFHPF2
  6021         GO TO 5000-BROWSE-FILE.
  6022
  6023     if PI-TO-EL677-FROM-EL1273
  6024        and (eibaid not = dfhenter)
  6025        go to 0320-input-error
  6026     end-if
  6027     IF EIBAID = DFHPF3
  6028         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6029         MOVE 'PF3'              TO  PI-PFKEY
  6030         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6031         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6032             GO TO 9400-CLEAR
  6033         ELSE
  6034             MOVE XCTL-1273      TO  PGM-NAME
  6035             GO TO 9300-XCTL.
  6036
  6037     IF EIBAID = DFHPF4
  6038         IF NOT FORCE-CAP
  6039             MOVE ER-0433        TO EMI-ERROR
  6040             MOVE -1             TO PFENTERL
  6041             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6042             GO TO 8200-SEND-DATAONLY.
  6043
  6044     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6045                             DFHPF5 OR DFHPF6 or dfhpf7
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL677.cbl
  6046         GO TO 1000-EDIT-DATA.
  6047
  6048*    IF EIBAID = DFHPF7
  6049*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6050*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6051*        MOVE XCTL-114           TO  PGM-NAME
  6052*        GO TO 9300-XCTL.
  6053
  6054 0320-INPUT-ERROR.
  6055     MOVE ER-0029                TO  EMI-ERROR.
  6056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6057     MOVE -1                     TO  PFENTERL.
  6058     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL677.cbl
  6060
  6061 1000-EDIT-DATA.
  6062     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6063         MOVE AL-UANON           TO MAINTA
  6064         IF MAINTI = 'C' OR 'V'
  6065             IF PI-PREV-MAINT = 'S'  OR  'C'
  6066                 NEXT SENTENCE
  6067             ELSE
  6068                 MOVE ER-2056    TO  EMI-ERROR
  6069                 MOVE -1         TO  MAINTL
  6070                 MOVE AL-UABON   TO  MAINTA
  6071                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6072                 GO TO 1100-EDIT-COMPLETE
  6073         ELSE
  6074             NEXT SENTENCE
  6075     ELSE
  6076         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6077            NEXT SENTENCE
  6078         ELSE
  6079            MOVE ER-0023            TO  EMI-ERROR
  6080            MOVE -1                 TO  MAINTL
  6081            MOVE AL-UABON           TO  MAINTA
  6082            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6083
  6084     IF MODIFY-CAP
  6085         NEXT SENTENCE
  6086       ELSE
  6087         IF MAINTI NOT = 'S'
  6088            MOVE 'UPDATE'       TO SM-READ
  6089            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6090            MOVE ER-0070        TO EMI-ERROR
  6091            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6092            GO TO 8100-SEND-INITIAL-MAP.
  6093
  6094     if (pi-return-to-program = 'EL1273')
  6095        and (MAINTI not = 'S' and 'V')
  6096        move 'S'                 to mainti
  6097        move +1                  to maintl
  6098        move al-uanon            to mainta
  6099     end-if
  6100     IF CARRIERI NOT = LOW-VALUES
  6101         MOVE AL-UANON           TO  CARRIERA
  6102         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6103         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6104                                     PI-CARRIER
  6105     ELSE
  6106         MOVE -1                 TO  CARRIERL
  6107         MOVE AL-UABON           TO  CARRIERA
  6108         MOVE ER-0194            TO  EMI-ERROR
  6109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6110
  6111     IF GROUPI NOT = LOW-VALUES
  6112         MOVE AL-UANON           TO  GROUPA
  6113         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6114                                     PI-GROUPING
  6115     ELSE
  6116         MOVE -1                 TO  GROUPL
  6117         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL677.cbl
  6118         MOVE ER-0195            TO  EMI-ERROR
  6119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6120
  6121     IF STATEI NOT = LOW-VALUES
  6122         MOVE AL-UANON           TO  STATEA
  6123         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6124         MOVE STATEI             TO  PI-CHEK-STATE
  6125                                     PI-STATE
  6126     ELSE
  6127         MOVE -1                 TO  STATEL
  6128         MOVE AL-UABON           TO  STATEA
  6129         MOVE ER-0196            TO  EMI-ERROR
  6130         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6131
  6132     IF EFFDTL GREATER ZERO
  6133         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6134         PERFORM 8700-DEEDIT
  6135         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6136             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6137             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6138             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6139             MOVE '4'                TO  DC-OPTION-CODE
  6140             PERFORM 8500-DATE-CONVERT
  6141             IF DC-ERROR-CODE NOT = SPACES
  6142                 MOVE ER-0215        TO  EMI-ERROR
  6143                 PERFORM 9900-ERROR-FORMAT
  6144                 MOVE -1             TO  EFFDTL
  6145                 MOVE AL-UABON       TO  EFFDTA
  6146               ELSE
  6147                 MOVE AL-UANON       TO  EFFDTA
  6148                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6149                                         PI-CERT-EFF-DT
  6150           ELSE
  6151             MOVE ER-0215        TO  EMI-ERROR
  6152             PERFORM 9900-ERROR-FORMAT
  6153             MOVE -1             TO  EFFDTL
  6154             MOVE AL-UABON       TO  EFFDTA
  6155       ELSE
  6156         MOVE ER-0216            TO  EMI-ERROR
  6157         PERFORM 9900-ERROR-FORMAT
  6158         MOVE -1                 TO  EFFDTL
  6159         MOVE AL-UABOF           TO  EFFDTA.
  6160
  6161     IF ACCTI NOT = LOW-VALUES
  6162         MOVE AL-UANON           TO  ACCTA
  6163         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6164         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6165                                     PI-ACCOUNT
  6166     ELSE
  6167         MOVE -1                 TO  ACCTL
  6168         MOVE AL-UABON           TO  ACCTA
  6169         MOVE ER-0197            TO  EMI-ERROR
  6170         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6171
  6172     IF CERTNOI NOT = LOW-VALUES
  6173         MOVE AL-UANON           TO  CERTNOA
  6174         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6175                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL677.cbl
  6176     ELSE
  6177         MOVE -1                 TO  CERTNOL
  6178         MOVE AL-UABON           TO  CERTNOA
  6179         MOVE ER-0203            TO  EMI-ERROR
  6180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6181
  6182     IF SFXI  = LOW-VALUES
  6183         MOVE SPACE              TO  SFXI.
  6184
  6185     MOVE AL-UANON               TO  SFXA.
  6186
  6187     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6188                                     PI-CERT-SFX.
  6189     IF SEQI = LOW-VALUES
  6190         MOVE +1                 TO  SEQI.
  6191
  6192     MOVE AL-UNNON               TO  SEQA.
  6193     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6194
  6195     IF PAYTO1L > 0
  6196         MOVE PAYTO1I            TO  PI-PAYTO1
  6197     ELSE
  6198         MOVE SPACES             TO  PI-PAYTO1.
  6199
  6200     IF AMOUNTL > 0
  6201
  6202* EXEC CICS BIF DEEDIT
  6203*            FIELD   (AMOUNTI)
  6204*            LENGTH  (11)
  6205*        END-EXEC
  6206     MOVE 11
  6207       TO DFHEIV11
  6208*    MOVE '@"L                   #   #00006057' TO DFHEIV0
  6209     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6210     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6211     MOVE X'2020233030303036303537' TO DFHEIV0(25:11)
  6212     CALL 'kxdfhei1' USING DFHEIV0,
  6213           AMOUNTI,
  6214           DFHEIV11
  6215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6216         MOVE AMOUNTI            TO  PI-AMOUNT
  6217     ELSE
  6218         MOVE ZEROS              TO  PI-AMOUNT.
  6219
  6220     IF TYPEL > 0
  6221         MOVE TYPEI              TO  PI-TYPE
  6222     ELSE
  6223         MOVE SPACE              TO  PI-TYPE.
  6224
  6225*    IF REFL > 0
  6226*        MOVE REFI               TO  PI-REFERENCE
  6227*    ELSE
  6228*        MOVE SPACES             TO  PI-REFERENCE.
  6229     if rettol not = zeros
  6230        move rettoi              to pi-return-to
  6231        MOVE AL-UANON            TO  RETTOA
  6232     end-if
  6233     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL677.cbl
  6234        if dedcyni = 'Y' OR 'N'
  6235           continue
  6236        else
  6237           move er-3451          to emi-error
  6238           move -1               to dedcynl
  6239           move al-uabon         to dedcyna
  6240           perform 9900-error-format
  6241                                 thru 9900-exit
  6242        end-if
  6243     end-if
  6244
  6245     if mainti = 'V'
  6246        if (vreasonl > zeros)
  6247           and (vreasoni (1:2) not = spaces)
  6248           continue
  6249        else
  6250           move er-3454          to emi-error
  6251           move -1               to vreasonl
  6252           move al-uabon         to vreasona
  6253           perform 9900-error-format
  6254                                 thru 9900-exit
  6255        end-if
  6256     end-if
  6257     if mainti = 'A'
  6258        continue
  6259     else
  6260        IF MAINTI = 'S'
  6261           or pi-prev-maint = 'S'
  6262           GO TO 1100-EDIT-COMPLETE
  6263        end-if
  6264     end-if
  6265     IF EIBAID = DFHPF5
  6266        IF EMI-ERROR = ZEROS
  6267          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6268        ELSE
  6269          GO TO 1100-EDIT-COMPLETE.
  6270
  6271     IF EIBAID = DFHPF6
  6272        IF EMI-ERROR = ZEROS
  6273           GO TO 6300-BUILD-CERT-SCREEN
  6274         ELSE
  6275           GO TO 1100-EDIT-COMPLETE.
  6276
  6277     IF EIBAID = DFHPF7
  6278        IF EMI-ERROR = ZEROS
  6279           GO TO 6600-build-beneficiary-screen
  6280         ELSE
  6281           GO TO 1100-EDIT-COMPLETE.
  6282
  6283*    if mainti = 'V'
  6284*       if (vreasonl > zeros)
  6285*          and (vreasoni (1:2) not = spaces)
  6286*          continue
  6287*       else
  6288*          move er-3454          to emi-error
  6289*          move -1               to vreasonl
  6290*          move al-uabon         to vreasona
  6291*          perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL677.cbl
  6292*                                thru 9900-exit
  6293*       end-if
  6294*    end-if
  6295     IF MAINTI = 'A'
  6296        if (payto1i not = spaces and low-values)
  6297           and (payad1i not = spaces and low-values)
  6298           and (payctyi not = spaces and low-values)
  6299           and (paysti not = spaces and low-values)
  6300           and (ptozipi not = spaces and low-values)
  6301           continue
  6302        else
  6303           MOVE -1               TO PAYTO1L
  6304           MOVE ER-2907          TO EMI-ERROR
  6305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6306        end-if
  6307     end-if
  6308
  6309     IF MAINTI = 'A'
  6310         IF EIBAID NOT = DFHPF4
  6311             MOVE DFHENTER       TO  EIBAID
  6312             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6313
  6314     IF MAINTI = 'S' OR 'V'
  6315         GO TO 1100-EDIT-COMPLETE.
  6316
  6317     IF PRINTEDL GREATER THAN +0
  6318         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6319         PERFORM 8700-DEEDIT
  6320         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6321             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6322             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6323             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6324             MOVE '4'                TO  DC-OPTION-CODE
  6325             PERFORM 8500-DATE-CONVERT
  6326             IF DC-ERROR-CODE NOT = SPACES
  6327                 MOVE ER-3046        TO  EMI-ERROR
  6328                 PERFORM 9900-ERROR-FORMAT
  6329                 MOVE -1             TO  PRINTEDL
  6330                 MOVE AL-UABON       TO  PRINTEDA
  6331                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6332             ELSE
  6333                 MOVE AL-UANON       TO  PRINTEDA
  6334                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6335         ELSE
  6336             MOVE ER-3046        TO  EMI-ERROR
  6337             PERFORM 9900-ERROR-FORMAT
  6338             MOVE -1             TO  PRINTEDL
  6339             MOVE AL-UABON       TO  PRINTEDA
  6340             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6341
  6342     IF AMOUNTL = ZEROS
  6343         GO TO 1050-CK-AMT.
  6344
  6345
  6346* EXEC CICS BIF DEEDIT
  6347*        FIELD   (AMOUNTI)
  6348*        LENGTH  (11)
  6349*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL677.cbl
  6350     MOVE 11
  6351       TO DFHEIV11
  6352*    MOVE '@"L                   #   #00006190' TO DFHEIV0
  6353     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6354     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6355     MOVE X'2020233030303036313930' TO DFHEIV0(25:11)
  6356     CALL 'kxdfhei1' USING DFHEIV0,
  6357           AMOUNTI,
  6358           DFHEIV11
  6359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6360
  6361
  6362     IF AMOUNTI NOT NUMERIC     OR
  6363        AMOUNTI LESS THAN ZERO  OR
  6364       (AMOUNTI = ZEROS  AND
  6365               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6366          MOVE ER-1159            TO  EMI-ERROR
  6367          MOVE -1                 TO  AMOUNTL
  6368          MOVE AL-UNBON           TO  AMOUNTA
  6369          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6370          GO TO 1100-EDIT-COMPLETE.
  6371
  6372     MOVE AMOUNTI                TO  WS-AM-WORK.
  6373
  6374     IF WS-AM-SIGN = SPACES
  6375         MOVE WS-AM-NUM          TO  WS-AMT
  6376         ADD 0                   TO  WS-AMT
  6377       ELSE
  6378         MOVE AMOUNTI            TO  WS-AMT
  6379         ADD 0                   TO  WS-AMT.
  6380
  6381      MOVE WS-AMT                TO  AMOUNTO.
  6382      MOVE AL-UNNON              TO  AMOUNTA.
  6383
  6384 1050-CK-AMT.
  6385     IF AMOUNTL = ZEROS AND
  6386        MAINTI  = 'A'
  6387         MOVE ER-1159            TO  EMI-ERROR
  6388         MOVE -1                 TO  AMOUNTL
  6389         MOVE AL-UNBON           TO  AMOUNTA
  6390         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6391
  6392     MOVE AL-UANON              TO  TYPEA.
  6393
  6394     IF TYPEL GREATER THAN ZEROS
  6395         IF TYPEI = 'R' OR 'M' OR 'E'
  6396             NEXT SENTENCE
  6397         ELSE
  6398             MOVE ER-3044    TO  EMI-ERROR
  6399             MOVE -1         TO  TYPEL
  6400             MOVE AL-UABON   TO  TYPEA
  6401             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6402     ELSE
  6403         IF MAINTI  = 'A'
  6404             MOVE ER-3044    TO  EMI-ERROR
  6405             MOVE -1         TO  TYPEL
  6406             MOVE AL-UABON   TO  TYPEA
  6407             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL677.cbl
  6408
  6409
  6410 1100-EDIT-COMPLETE.
  6411
  6412     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6413       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6414        EIBAID NOT = DFHPF4)
  6415         GO TO 8200-SEND-DATAONLY.
  6416
  6417     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6418
  6419     IF MAINTI = 'A'
  6420         GO TO 2000-ADD-RECORD.
  6421
  6422*    IF MAINTI = 'C' OR 'V'
  6423     IF MAINTI = 'V'
  6424         GO TO 3000-CHANGE-RECORD.
  6425
  6426     IF MAINTI = 'S' or 'C'
  6427         GO TO 5000-BROWSE-FILE.
  6428
  6429     if mainti = 'D'
  6430        go to 3400-delete-record
  6431     end-if
  6432     .
  6433 1200-VERIFY-CARRIER-ID.
  6434     MOVE SPACES                 TO ELCNTL-KEY.
  6435     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6436     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6437     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6438     MOVE +0                     TO ELCNTL-SEQ.
  6439
  6440
  6441* EXEC CICS HANDLE CONDITION
  6442*        NOTFND   (1290-NO-CARRIER)
  6443*    END-EXEC.
  6444*    MOVE '"$I                   ! $ #00006273' TO DFHEIV0
  6445     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6447     MOVE X'2420233030303036323733' TO DFHEIV0(25:11)
  6448     CALL 'kxdfhei1' USING DFHEIV0
  6449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6450
  6451
  6452
  6453* EXEC CICS READ
  6454*        DATASET   (ELCNTL-FILE-ID)
  6455*        SET       (ADDRESS OF CONTROL-FILE)
  6456*        RIDFLD    (ELCNTL-KEY)
  6457*    END-EXEC.
  6458*    MOVE '&"S        E          (   #00006277' TO DFHEIV0
  6459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6461     MOVE X'2020233030303036323737' TO DFHEIV0(25:11)
  6462     CALL 'kxdfhei1' USING DFHEIV0,
  6463           ELCNTL-FILE-ID,
  6464           DFHEIV20,
  6465           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL677.cbl
  6466           ELCNTL-KEY,
  6467           DFHEIV99,
  6468           DFHEIV99,
  6469           DFHEIV99
  6470     SET ADDRESS OF CONTROL-FILE TO
  6471         DFHEIV20
  6472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6473
  6474
  6475     GO TO 1200-EXIT.
  6476
  6477 1290-NO-CARRIER.
  6478     MOVE ER-2208                TO EMI-ERROR.
  6479     MOVE -1                     TO CARRIERL.
  6480     MOVE AL-UABON               TO CARRIERA.
  6481     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6482
  6483 1200-EXIT.
  6484      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL677.cbl
  6486 1300-VERIFY-STATE-ID.
  6487     MOVE SPACES                 TO ELCNTL-KEY.
  6488     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6489     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6490     MOVE STATEI                 TO ELCNTL-STATE.
  6491     MOVE +0                     TO ELCNTL-SEQ.
  6492
  6493
  6494* EXEC CICS HANDLE CONDITION
  6495*        NOTFND   (1380-NO-STATE)
  6496*    END-EXEC.
  6497*    MOVE '"$I                   ! % #00006301' TO DFHEIV0
  6498     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6500     MOVE X'2520233030303036333031' TO DFHEIV0(25:11)
  6501     CALL 'kxdfhei1' USING DFHEIV0
  6502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6503
  6504
  6505
  6506* EXEC CICS READ
  6507*        DATASET   (ELCNTL-FILE-ID)
  6508*        SET       (ADDRESS OF CONTROL-FILE)
  6509*        RIDFLD    (ELCNTL-KEY)
  6510*    END-EXEC.
  6511*    MOVE '&"S        E          (   #00006305' TO DFHEIV0
  6512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6514     MOVE X'2020233030303036333035' TO DFHEIV0(25:11)
  6515     CALL 'kxdfhei1' USING DFHEIV0,
  6516           ELCNTL-FILE-ID,
  6517           DFHEIV20,
  6518           DFHEIV99,
  6519           ELCNTL-KEY,
  6520           DFHEIV99,
  6521           DFHEIV99,
  6522           DFHEIV99
  6523     SET ADDRESS OF CONTROL-FILE TO
  6524         DFHEIV20
  6525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6526
  6527
  6528     GO TO 1390-EXIT.
  6529
  6530 1380-NO-STATE.
  6531     MOVE ER-2209                TO EMI-ERROR.
  6532     MOVE -1                     TO STATEL.
  6533     MOVE AL-UABON               TO STATEA.
  6534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6535
  6536 1390-EXIT.
  6537      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL677.cbl
  6539
  6540 1400-VERIFY-ACCOUNT.
  6541     IF EIBAID = DFHPF5
  6542         GO TO 1410-BUILD-ACCOUNT-KEY.
  6543
  6544     IF MAINTL GREATER +0
  6545         NEXT SENTENCE
  6546       ELSE
  6547         GO TO 1490-EXIT.
  6548
  6549*    IF MAINTI = 'A' OR 'C' OR 'V'
  6550     IF MAINTI = 'A' OR 'V'
  6551         NEXT SENTENCE
  6552       ELSE
  6553         GO TO 1490-EXIT.
  6554
  6555 1410-BUILD-ACCOUNT-KEY.
  6556     MOVE CARRIERI               TO ERACCT-CARRIER.
  6557     MOVE GROUPI                 TO ERACCT-GROUPING
  6558     MOVE STATEI                 TO ERACCT-STATE.
  6559     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6560     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6561
  6562     MOVE '2'                    TO DC-OPTION-CODE.
  6563     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6564
  6565     PERFORM 8500-DATE-CONVERT.
  6566     IF DATE-CONVERSION-ERROR
  6567        GO TO 1480-ACCOUNT-INVALID.
  6568
  6569     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6570    .
  6571 1420-get-eracct.
  6572     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6573
  6574
  6575* EXEC CICS HANDLE CONDITION
  6576*        NOTFND   (1480-ACCOUNT-INVALID)
  6577*        ENDFILE  (1480-ACCOUNT-INVALID)
  6578*    END-EXEC.
  6579*    MOVE '"$I''                  ! & #00006357' TO DFHEIV0
  6580     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6582     MOVE X'2620233030303036333537' TO DFHEIV0(25:11)
  6583     CALL 'kxdfhei1' USING DFHEIV0
  6584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6585
  6586
  6587
  6588* EXEC CICS STARTBR
  6589*        DATASET   (ERACCT-FILE-ID)
  6590*        RIDFLD    (ERACCT-KEY)
  6591*    END-EXEC.
  6592     MOVE 0
  6593       TO DFHEIV11
  6594*    MOVE '&,         G          &   #00006362' TO DFHEIV0
  6595     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6596     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL677.cbl
  6597     MOVE X'2020233030303036333632' TO DFHEIV0(25:11)
  6598     CALL 'kxdfhei1' USING DFHEIV0,
  6599           ERACCT-FILE-ID,
  6600           ERACCT-KEY,
  6601           DFHEIV99,
  6602           DFHEIV11,
  6603           DFHEIV99
  6604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6605
  6606
  6607     set eracct-start to true
  6608     .
  6609 1420-READNEXT-ACCOUNT-MASTER.
  6610
  6611* EXEC CICS READNEXT
  6612*        DATASET   (ERACCT-FILE-ID)
  6613*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6614*        RIDFLD    (ERACCT-KEY)
  6615*    END-EXEC.
  6616     MOVE 0
  6617       TO DFHEIV11
  6618*    MOVE '&.S                   )   #00006370' TO DFHEIV0
  6619     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6620     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6621     MOVE X'2020233030303036333730' TO DFHEIV0(25:11)
  6622     CALL 'kxdfhei1' USING DFHEIV0,
  6623           ERACCT-FILE-ID,
  6624           DFHEIV20,
  6625           DFHEIV99,
  6626           ERACCT-KEY,
  6627           DFHEIV99,
  6628           DFHEIV11,
  6629           DFHEIV99,
  6630           DFHEIV99
  6631     SET ADDRESS OF ACCOUNT-MASTER TO
  6632         DFHEIV20
  6633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6634
  6635
  6636*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6637*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6638*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6639*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6640*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6641*         GO TO 1480-ACCOUNT-INVALID.
  6642*
  6643*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6644*        GO TO 1480-ACCOUNT-INVALID.
  6645*
  6646*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6647*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6648
  6649     evaluate true
  6650        when (save-eracct-key (1:20) not =
  6651           am-control-primary (1:20))
  6652           and (not eracct-found)
  6653           go to 1480-account-invalid
  6654        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL677.cbl
  6655           am-control-primary (1:20))
  6656           and (eracct-found)
  6657           move ws-hold-eracct-record
  6658                                 to account-master
  6659        when (sv-acct-exp-date < am-effective-dt)
  6660           and (not eracct-found)
  6661           go to 1480-account-invalid
  6662        when sv-acct-exp-date >= am-expiration-dt
  6663           go to 1420-readnext-account-master
  6664        when am-expiration-dt = high-values
  6665           continue
  6666        when other
  6667           set eracct-found to true
  6668           move account-master   to ws-hold-eracct-record
  6669           go to 1420-readnext-account-master
  6670     end-evaluate
  6671     if eracct-start
  6672
  6673* exec cics endbr
  6674*          dataset  (eracct-file-id)
  6675*       end-exec
  6676     MOVE 0
  6677       TO DFHEIV11
  6678*    MOVE '&2                    $   #00006412' TO DFHEIV0
  6679     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6680     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6681     MOVE X'2020233030303036343132' TO DFHEIV0(25:11)
  6682     CALL 'kxdfhei1' USING DFHEIV0,
  6683           eracct-file-id,
  6684           DFHEIV11,
  6685           DFHEIV99
  6686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6687     end-if
  6688*    if am-expiration-dt = high-values
  6689*       continue
  6690*    else
  6691*       move account-master      to ws-hold-eracct-record
  6692*       go to 1420-readnext-account-master
  6693*    end-if
  6694     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6695     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6696     MOVE AM-STATE               TO PI-CR-STATE.
  6697     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6698
  6699     MOVE AM-NAME                TO PI-AM-NAME.
  6700     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6701     MOVE AM-CITY                TO PI-AM-CITY-st
  6702     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6703     move am-csr-code            to pi-am-csr
  6704
  6705     MOVE +0                     TO WS-SUB.
  6706
  6707 1430-FIND-ACC-AGT.
  6708     ADD +1                      TO WS-SUB.
  6709
  6710     IF  WS-SUB GREATER +10
  6711         GO TO 1480-ACCOUNT-INVALID.
  6712
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL677.cbl
  6713     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6714         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6715       ELSE
  6716         GO TO 1430-FIND-ACC-AGT.
  6717
  6718     MOVE AL-UANON               TO CARRIERA
  6719                                    GROUPA
  6720                                    STATEA.
  6721
  6722     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6723
  6724     GO TO 1490-EXIT.
  6725
  6726 1480-ACCOUNT-INVALID.
  6727     MOVE -1                     TO CARRIERL
  6728     MOVE AL-UANON               TO CARRIERA
  6729                                    GROUPA
  6730                                    STATEA
  6731                                    ACCTA.
  6732     MOVE ER-2210                TO EMI-ERROR.
  6733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6734     GO TO 8200-SEND-DATAONLY.
  6735
  6736 1490-EXIT.
  6737      EXIT.
  6738
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL677.cbl
  6740 1500-VERIFY-PENDING-BUS-REC.
  6741
  6742* EXEC CICS HANDLE CONDITION
  6743*        NOTFND   (1590-EXIT)
  6744*    END-EXEC.
  6745*    MOVE '"$I                   ! '' #00006469' TO DFHEIV0
  6746     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6748     MOVE X'2720233030303036343639' TO DFHEIV0(25:11)
  6749     CALL 'kxdfhei1' USING DFHEIV0
  6750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6751
  6752
  6753     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6754
  6755     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6756     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6757     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6758     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6759     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6760     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6761     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6762     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6763     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6764     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6765
  6766     IF ST-ACCNT-CNTL  OR
  6767        ACCNT-CNTL
  6768          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6769
  6770     IF ST-ACCNT-CNTL      OR
  6771        CARR-ST-ACCNT-CNTL OR
  6772        ACCNT-CNTL         OR
  6773        CARR-ACCNT-CNTL
  6774          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6775
  6776     IF ACCNT-CNTL OR
  6777        CARR-ACCNT-CNTL
  6778          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6779
  6780
  6781* EXEC CICS READ
  6782*         DATASET   (ERPNDB-ALT-FILE-ID)
  6783*         SET       (ADDRESS OF PENDING-BUSINESS)
  6784*         RIDFLD    (ERPNDB-ALT-KEY)
  6785*     END-EXEC.
  6786*    MOVE '&"S        E          (   #00006500' TO DFHEIV0
  6787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6788     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6789     MOVE X'2020233030303036353030' TO DFHEIV0(25:11)
  6790     CALL 'kxdfhei1' USING DFHEIV0,
  6791           ERPNDB-ALT-FILE-ID,
  6792           DFHEIV20,
  6793           DFHEIV99,
  6794           ERPNDB-ALT-KEY,
  6795           DFHEIV99,
  6796           DFHEIV99,
  6797           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL677.cbl
  6798     SET ADDRESS OF PENDING-BUSINESS TO
  6799         DFHEIV20
  6800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6801
  6802
  6803     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6804
  6805     IF PB-C-PAYEE-CODE GREATER SPACES
  6806        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6807
  6808     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6809*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6810
  6811     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6812     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6813
  6814     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6815         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6816     ELSE
  6817         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6818
  6819     IF MAINTI = 'A' OR 'C'
  6820       IF PB-C-REFUND-CREATED
  6821           MOVE -1               TO  MAINTL
  6822           MOVE ER-3445          TO  EMI-ERROR
  6823           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6824
  6825 1590-EXIT.
  6826      EXIT.
  6827
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL677.cbl
  6829 2000-ADD-RECORD.
  6830
  6831* EXEC CICS GETMAIN
  6832*        SET      (ADDRESS OF CHECK-RECORDS)
  6833*        LENGTH   (600)
  6834*        INITIMG  (GETMAIN-SPACE)
  6835*    END-EXEC.
  6836     MOVE 600
  6837       TO DFHEIV11
  6838*    MOVE ',"IL                  $   #00006533' TO DFHEIV0
  6839     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6841     MOVE X'2020233030303036353333' TO DFHEIV0(25:11)
  6842     CALL 'kxdfhei1' USING DFHEIV0,
  6843           DFHEIV20,
  6844           DFHEIV11,
  6845           GETMAIN-SPACE
  6846     SET ADDRESS OF CHECK-RECORDS TO
  6847         DFHEIV20
  6848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6849
  6850
  6851     MOVE 'CH'                   TO CH-RECORD-ID.
  6852     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6853     MOVE CARRIERI               TO CH-CARRIER.
  6854     MOVE GROUPI                 TO CH-GROUPING.
  6855     MOVE STATEI                 TO CH-STATE.
  6856     MOVE ACCTI                  TO CH-ACCOUNT.
  6857
  6858     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6859     MOVE '2'                    TO DC-OPTION-CODE.
  6860     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6861     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6862
  6863     MOVE CERTNOI                TO CH-CERT-PRIME.
  6864     MOVE SFXI                   TO CH-CERT-SFX.
  6865
  6866     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6867
  6868     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6869                                    ch-released-by
  6870     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6871
  6872     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6873     MOVE '5'                    TO DC-OPTION-CODE.
  6874     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6875     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6876                                    ch-released-dt
  6877
  6878     move 'P'                    to ch-approval-status
  6879
  6880     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6881                                    CH-VOID-DT
  6882                                    CH-CREDIT-ACCEPT-DT
  6883                                    CH-CANC-DT
  6884                                    ch-approval-dt
  6885                                    ch-check-cashed-dt
  6886     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL677.cbl
  6887                                    CH-AH-REFUND
  6888*                                   CH-DEDUCT-WITHHELD
  6889*                                   CH-ADDITIONAL-CHARGE.
  6890
  6891     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6892
  6893     if pi-prev-paid not numeric
  6894        move zeros               to pi-prev-paid
  6895     end-if
  6896     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6897       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6898        EIBAID NOT = DFHPF4)
  6899         GO TO 8200-SEND-DATAONLY.
  6900
  6901     add ch-amount-paid to pi-prev-paid
  6902     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6903     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6904     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6905     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6906     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6907     move pi-am-csr              to ch-csr
  6908     .
  6909 2100-WRITE-RECORD.
  6910
  6911* exec cics read
  6912*       dataset    (erchek-file-id)
  6913*       into       (ws-dummy-erchek)
  6914*       ridfld     (ch-control-primary)
  6915*       resp       (ws-response)
  6916*    end-exec
  6917     MOVE LENGTH OF
  6918      ws-dummy-erchek
  6919       TO DFHEIV11
  6920*    MOVE '&"IL       E          (  N#00006598' TO DFHEIV0
  6921     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6922     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6923     MOVE X'204E233030303036353938' TO DFHEIV0(25:11)
  6924     CALL 'kxdfhei1' USING DFHEIV0,
  6925           erchek-file-id,
  6926           ws-dummy-erchek,
  6927           DFHEIV11,
  6928           ch-control-primary,
  6929           DFHEIV99,
  6930           DFHEIV99,
  6931           DFHEIV99
  6932     MOVE EIBRESP  TO ws-response
  6933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6934     if RESP-NOTFND
  6935        continue
  6936     else
  6937        add +1 to ch-sequence-no
  6938        add 1 to seqi
  6939        go to 2100-write-record
  6940     end-if
  6941     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
  6942
  6943* EXEC CICS HANDLE CONDITION
  6944*        DUPREC (2200-DUPREC)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL677.cbl
  6945*    END-EXEC.
  6946*    MOVE '"$%                   ! ( #00006612' TO DFHEIV0
  6947     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6949     MOVE X'2820233030303036363132' TO DFHEIV0(25:11)
  6950     CALL 'kxdfhei1' USING DFHEIV0
  6951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6952
  6953
  6954     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  6955     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  6956                                    CH-CHECK-QUE-SEQUENCE
  6957
  6958
  6959* EXEC CICS WRITE
  6960*        DATASET  (ERCHEK-FILE-ID)
  6961*        FROM     (CHECK-RECORDS)
  6962*        RIDFLD   (CH-CONTROL-PRIMARY)
  6963*    END-EXEC.
  6964     MOVE LENGTH OF
  6965      CHECK-RECORDS
  6966       TO DFHEIV11
  6967*    MOVE '&$ L                  ''   #00006620' TO DFHEIV0
  6968     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6969     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6970     MOVE X'2020233030303036363230' TO DFHEIV0(25:11)
  6971     CALL 'kxdfhei1' USING DFHEIV0,
  6972           ERCHEK-FILE-ID,
  6973           CHECK-RECORDS,
  6974           DFHEIV11,
  6975           CH-CONTROL-PRIMARY,
  6976           DFHEIV99,
  6977           DFHEIV99
  6978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6979
  6980
  6981     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  6982             ERCHEK-RECORD-LENGTH + 23.
  6983
  6984     PERFORM 6200-UPDATE-PENDING-BUS-REC THRU 6200-EXIT.
  6985     if resp-normal
  6986        MOVE 'Y'                 TO PB-C-REFUND-SW
  6987        add +1 to pi-chek-rec-cnt
  6988        perform 6210-rewrite-pndb thru 6210-exit
  6989*       PERFORM 2700-WRITE-SQL   THRU 2700-EXIT
  6990     end-if
  6991*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
  6992
  6993     IF EMI-NO-ERRORS
  6994         MOVE ER-0000            TO EMI-ERROR
  6995     ELSE
  6996         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  6997            EIBAID = DFHPF4
  6998             MOVE ER-2600        TO EMI-ERROR.
  6999
  7000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7001
  7002     MOVE LOW-VALUES             TO EL677AI.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL677.cbl
  7003
  7004     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7005     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7006     MOVE PI-CHEK-STATE          TO STATEO.
  7007     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7008
  7009     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7010     MOVE SPACE                  TO DC-OPTION-CODE.
  7011     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7012     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7013
  7014     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7015     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7016     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7017
  7018     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7019                                    ACCTA     EFFDTA  CERTNOA
  7020                                    SFXA.
  7021     MOVE AL-UNNON               TO SEQA.
  7022     go to 5000-browse-file
  7023     GO TO 8100-SEND-INITIAL-MAP.
  7024
  7025 2200-DUPREC.
  7026     ADD +1 TO CH-SEQUENCE-NO.
  7027     MOVE CH-SEQUENCE-NO         TO SEQO
  7028                                    PI-CHEK-SEQUENCE
  7029                                    CHEK-RECORD-SEQ.
  7030     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL677.cbl
  7032
  7033 2500-WRITE-PAY-ADJ.
  7034
  7035     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7036
  7037     IF CH-AMOUNT-PAID = ZEROS
  7038         GO TO 2510-CONTINUE.
  7039     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7040     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7041
  7042 2510-CONTINUE.
  7043
  7044     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7045         GO TO 2580-HANDLE-ELCNTL-FILE.
  7046
  7047 2550-BUILD-ERPYAJ-RECORD.
  7048
  7049
  7050* EXEC CICS GETMAIN
  7051*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7052*        LENGTH  (200)
  7053*        INITIMG (GETMAIN-SPACE)
  7054*    END-EXEC.
  7055     MOVE 200
  7056       TO DFHEIV11
  7057*    MOVE ',"IL                  $   #00006694' TO DFHEIV0
  7058     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7060     MOVE X'2020233030303036363934' TO DFHEIV0(25:11)
  7061     CALL 'kxdfhei1' USING DFHEIV0,
  7062           DFHEIV20,
  7063           DFHEIV11,
  7064           GETMAIN-SPACE
  7065     SET ADDRESS OF PENDING-PAY-ADJ TO
  7066         DFHEIV20
  7067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7068
  7069
  7070     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7071     MOVE 'PY'                   TO PY-RECORD-ID.
  7072     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7073
  7074     MOVE CARRIERI               TO PY-CARRIER.
  7075     IF PI-ZERO-CARRIER  OR
  7076        PI-ZERO-CAR-GROUP
  7077         MOVE ZERO               TO PY-CARRIER.
  7078
  7079     MOVE GROUPI                 TO PY-GROUPING.
  7080     IF PI-ZERO-GROUPING  OR
  7081        PI-ZERO-CAR-GROUP
  7082         MOVE ZERO               TO PY-GROUPING.
  7083
  7084     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7085     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7086     MOVE 'C'                    TO PY-RECORD-TYPE.
  7087     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7088
  7089     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL677.cbl
  7090                                    WS-PY-REF-DATE
  7091                                    WS-PY-END-DATE
  7092                                    WS-PY-DED-DATE
  7093                                    WS-PY-ADDL-DATE.
  7094     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7095     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7096                                    WS-PY-REF-CERT
  7097                                    WS-PY-END-CERT
  7098                                    WS-PY-DED-CERT
  7099                                    WS-PY-ADDL-CERT
  7100                                    WS-TMS-PY-CERT.
  7101     IF SFXI NOT = LOW-VALUES
  7102         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7103                                    WS-PY-REF-SUFFIX
  7104                                    WS-PY-END-SUFFIX
  7105                                    WS-PY-DED-SUFFIX
  7106                                    WS-PY-ADDL-SUFFIX
  7107     ELSE
  7108         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7109                                    WS-PY-REF-SUFFIX
  7110                                    WS-PY-END-SUFFIX
  7111                                    WS-PY-DED-SUFFIX
  7112                                    WS-PY-ADDL-SUFFIX.
  7113
  7114     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7115         MOVE WS-TMS-ENTRY-COMMENT
  7116                                 TO PY-ENTRY-COMMENT
  7117     ELSE
  7118         IF TYPEI EQUAL 'R'
  7119             MOVE WS-PY-REF-COMMENT
  7120                                 TO PY-ENTRY-COMMENT
  7121         ELSE
  7122             IF TYPEI EQUAL 'E'
  7123                 MOVE WS-PY-END-COMMENT
  7124                                 TO PY-ENTRY-COMMENT
  7125             ELSE
  7126                 MOVE WS-PY-ENTRY-COMMENT
  7127                                 TO PY-ENTRY-COMMENT.
  7128
  7129     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7130
  7131     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7132     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7133     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7134                                    PY-INPUT-DT.
  7135*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7136*                                   PY-CHECK-QUE-SEQUENCE.
  7137     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7138                                    PY-REPORTED-DT
  7139                                    PY-CHECK-WRITTEN-DT
  7140                                    PY-BILLED-DATE
  7141                                    PY-AR-DATE
  7142                                    PY-GL-DATE.
  7143     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7144     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7145*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7146
  7147     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL677.cbl
  7148         MOVE 'B'                TO PY-PYMT-TYPE
  7149         MOVE 'A'                TO PY-PMT-APPLIED.
  7150
  7151 2559-BUILD-EXIT.
  7152     EXIT.
  7153
  7154 2570-WRITE-ERPYAJ-RECORD.
  7155
  7156
  7157* EXEC CICS HANDLE CONDITION
  7158*        DUPREC (2577-DUPREC)
  7159*    END-EXEC.
  7160*    MOVE '"$%                   ! ) #00006786' TO DFHEIV0
  7161     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7163     MOVE X'2920233030303036373836' TO DFHEIV0(25:11)
  7164     CALL 'kxdfhei1' USING DFHEIV0
  7165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7166
  7167
  7168
  7169* EXEC CICS WRITE
  7170*        DATASET (ERPYAJ-FILE-ID)
  7171*        FROM    (PENDING-PAY-ADJ)
  7172*        RIDFLD  (PY-CONTROL-PRIMARY)
  7173*    END-EXEC.
  7174     MOVE LENGTH OF
  7175      PENDING-PAY-ADJ
  7176       TO DFHEIV11
  7177*    MOVE '&$ L                  ''   #00006790' TO DFHEIV0
  7178     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7179     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7180     MOVE X'2020233030303036373930' TO DFHEIV0(25:11)
  7181     CALL 'kxdfhei1' USING DFHEIV0,
  7182           ERPYAJ-FILE-ID,
  7183           PENDING-PAY-ADJ,
  7184           DFHEIV11,
  7185           PY-CONTROL-PRIMARY,
  7186           DFHEIV99,
  7187           DFHEIV99
  7188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7189
  7190
  7191     GO TO 2579-WRITE-EXIT.
  7192
  7193 2577-DUPREC.
  7194     ADD +1 TO PY-FILE-SEQ-NO.
  7195
  7196     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7197
  7198 2579-WRITE-EXIT.
  7199     EXIT.
  7200
  7201 2580-HANDLE-ELCNTL-FILE.
  7202
  7203     IF CR-CHECK-NO-AUTO-SEQ
  7204         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7205     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL677.cbl
  7206
  7207* EXEC CICS UNLOCK
  7208*            DATASET (ELCNTL-FILE-ID)
  7209*        END-EXEC.
  7210*    MOVE '&*                    #   #00006811' TO DFHEIV0
  7211     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7212     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7213     MOVE X'2020233030303036383131' TO DFHEIV0(25:11)
  7214     CALL 'kxdfhei1' USING DFHEIV0,
  7215           ELCNTL-FILE-ID,
  7216           DFHEIV99
  7217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7218
  7219
  7220 2590-EXIT.
  7221      EXIT.
  7222
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL677.cbl
  7224
  7225 2600-READ-CONTROL-FILE.
  7226     MOVE SPACES                 TO ELCNTL-KEY.
  7227     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7228     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7229     MOVE +0                     TO ELCNTL-SEQ.
  7230
  7231
  7232* EXEC CICS HANDLE CONDITION
  7233*        NOTFND   (2600-NO-CO-MASTER)
  7234*    END-EXEC.
  7235*    MOVE '"$I                   ! * #00006826' TO DFHEIV0
  7236     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7238     MOVE X'2A20233030303036383236' TO DFHEIV0(25:11)
  7239     CALL 'kxdfhei1' USING DFHEIV0
  7240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7241
  7242
  7243
  7244* EXEC CICS READ
  7245*        DATASET   (ELCNTL-FILE-ID)
  7246*        SET       (ADDRESS OF CONTROL-FILE)
  7247*        RIDFLD    (ELCNTL-KEY)
  7248*    END-EXEC.
  7249*    MOVE '&"S        E          (   #00006830' TO DFHEIV0
  7250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7252     MOVE X'2020233030303036383330' TO DFHEIV0(25:11)
  7253     CALL 'kxdfhei1' USING DFHEIV0,
  7254           ELCNTL-FILE-ID,
  7255           DFHEIV20,
  7256           DFHEIV99,
  7257           ELCNTL-KEY,
  7258           DFHEIV99,
  7259           DFHEIV99,
  7260           DFHEIV99
  7261     SET ADDRESS OF CONTROL-FILE TO
  7262         DFHEIV20
  7263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7264
  7265
  7266     GO TO 2600-EXIT
  7267
  7268     .
  7269 2600-NO-CO-MASTER.
  7270     MOVE ER-0022                TO  EMI-ERROR.
  7271     MOVE -1                     TO  CARRIERL.
  7272     MOVE AL-UABON               TO  CARRIERA.
  7273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7274
  7275 2600-EXIT.
  7276      EXIT.
  7277
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL677.cbl
  7279 2650-REWRITE-CONTROL-FILE.
  7280
  7281* EXEC CICS READ
  7282*        DATASET   (ELCNTL-FILE-ID)
  7283*        SET       (ADDRESS OF CONTROL-FILE)
  7284*        RIDFLD    (ELCNTL-KEY)
  7285*        UPDATE
  7286*    END-EXEC.
  7287*    MOVE '&"S        EU         (   #00006850' TO DFHEIV0
  7288     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7289     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7290     MOVE X'2020233030303036383530' TO DFHEIV0(25:11)
  7291     CALL 'kxdfhei1' USING DFHEIV0,
  7292           ELCNTL-FILE-ID,
  7293           DFHEIV20,
  7294           DFHEIV99,
  7295           ELCNTL-KEY,
  7296           DFHEIV99,
  7297           DFHEIV99,
  7298           DFHEIV99
  7299     SET ADDRESS OF CONTROL-FILE TO
  7300         DFHEIV20
  7301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7302
  7303
  7304
  7305* EXEC CICS REWRITE
  7306*         DATASET (ELCNTL-FILE-ID)
  7307*         FROM    (CONTROL-FILE)
  7308*     END-EXEC.
  7309     MOVE LENGTH OF
  7310      CONTROL-FILE
  7311       TO DFHEIV11
  7312*    MOVE '&& L                  %   #00006857' TO DFHEIV0
  7313     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7314     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7315     MOVE X'2020233030303036383537' TO DFHEIV0(25:11)
  7316     CALL 'kxdfhei1' USING DFHEIV0,
  7317           ELCNTL-FILE-ID,
  7318           CONTROL-FILE,
  7319           DFHEIV11,
  7320           DFHEIV99
  7321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7322
  7323
  7324 2650-EXIT.
  7325      EXIT.
  7326 2700-WRITE-SQL.
  7327     perform 2710-build-rec      thru 2710-exit
  7328     perform 2720-insert-row     thru 2720-exit
  7329     perform 4300-FINISH-UP-DB   thru 4300-exit
  7330     .
  7331 2700-EXIT.
  7332     EXIT.
  7333 2710-BUILD-REC.
  7334     move spaces                 to daily-check-request-rec
  7335     move pi-company-id          to db-compid
  7336     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL677.cbl
  7337                                    db-fincar
  7338     move ch-grouping            to db-grouping
  7339                                    db-fingrp
  7340     move ch-state               to db-state
  7341     move ch-account             to db-account
  7342     move ch-cert-eff-dt         to dc-bin-date-1
  7343     move ' '                    to dc-option-code
  7344     perform 8500-date-convert   thru 8500-exit
  7345     if no-conversion-error
  7346        move dc-greg-date-a-edit to db-effdate
  7347     else
  7348        move spaces              to db-effdate
  7349     end-if
  7350     move ch-cert-prime          to db-certificate
  7351     move ch-cert-sfx            to db-cert-sfx
  7352     move ch-sequence-no         to db-seq-no
  7353     move '1'                    to db-type
  7354     move ch-amount-paid         to db-amount-n
  7355     move zeros                  to db-checkstatus
  7356     move ch-check-que-control   to db-releasebatch
  7357     move save-bin-date          to dc-bin-date-1
  7358     move ' '                    to dc-option-code
  7359     perform 8500-date-convert   thru 8500-exit
  7360     if no-conversion-error
  7361        move dc-greg-date-a-edit to db-releasedt
  7362     else
  7363        move spaces              to db-releasedt
  7364     end-if
  7365     move pi-processor-id        to db-releaseby
  7366     move ch-payee-name-1        to db-payeename1
  7367     move ch-payee-name-2        to db-payeename2
  7368     move ch-payee-address-1     to db-payeeaddr1
  7369     move ch-payee-address-2     to db-payeeaddr2
  7370     move ch-payee-city          to db-payeecity
  7371     move ch-payee-state         to db-payeest
  7372     move ch-payee-zip-code      to db-payeezip
  7373     move ch-comp-fin-resp       to db-finresp
  7374     move ch-comp-account        to db-finacct
  7375     move ch-recorded-by         to db-preparer
  7376     move ch-return-to           to db-return-to
  7377     move pi-table-name          to db-insured-name
  7378     .
  7379 2710-EXIT.
  7380     EXIT.
  7381 2720-INSERT-ROW.
  7382     if not connected-to-db
  7383        perform 4100-CONNECT-TO-DB
  7384                                 thru 4100-exit
  7385     end-if
  7386     EXEC SQL
  7387        INSERT into ChkApp_Check (
  7388           Company,
  7389           CertCarrier,
  7390           CertGroup,
  7391           CertState,
  7392           CertAccount,
  7393           CertEffDate,
  7394           CertNumber,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL677.cbl
  7395           CertNumberSuf,
  7396           CheckSeqNbr,
  7397           CheckType,
  7398           CheckAmount,
  7399           ReleaseBatchNbr,
  7400           ReleaseDate,
  7401           ReleasedBy,
  7402           PayeeName1,
  7403           PayeeName2,
  7404           PayeeAddress1,
  7405           PayeeAddress2,
  7406           PayeeCity,
  7407           PayeeState,
  7408           PayeeZip,
  7409           CompCarrier,
  7410           CompGroup,
  7411           CompFinResp,
  7412           CompAccount,
  7413           Preparer,
  7414           ReturnTo,
  7415           InsuredName)
  7416         VALUES (
  7417           :DB-CompId,
  7418           :DB-Carrier,
  7419           :DB-Grouping,
  7420           :DB-State,
  7421           :DB-Account,
  7422           :DB-EffDate,
  7423           :DB-Certificate,
  7424           :db-cert-sfx,
  7425           :DB-Seq-No,
  7426           :DB-Type,
  7427           :db-amount,
  7428           :db-releasebatch,
  7429           :db-releasedt,
  7430           :db-releaseby,
  7431           :db-payeename1,
  7432           :db-payeename2,
  7433           :db-payeeaddr1,
  7434           :db-payeeaddr2,
  7435           :db-payeecity,
  7436           :db-payeest,
  7437           :db-payeezip,
  7438           :db-fincar,
  7439           :db-fingrp,
  7440           :db-finresp,
  7441           :db-finacct,
  7442           :db-preparer,
  7443           :db-return-to,
  7444           :db-insured-name)
  7445     END-EXEC
  7446     if sqlcode = -2601
  7447        add +1                   to ch-sequence-no
  7448        move ch-sequence-no      to DB-Seq-No
  7449        go to 2720-insert-row
  7450     end-if
  7451     if sqlcode not = 0
  7452        display "Error: cannot insert row "
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL677.cbl
  7453        display ' sql return code ' sqlcode
  7454        move sqlcode to ws-sql-code
  7455        move ws-sql-code to ws-dis-sql-code
  7456        display ' dis sql code ' ws-dis-sql-code
  7457        display ' sql err mess    ' sqlerrmc
  7458        move sqlcode to ws-sql-code
  7459        move ws-sql-code to ws-dis-sql-code
  7460        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7461           into EMI-MESSAGE-AREA (1)
  7462        end-string
  7463        display ' msga1 ' emi-message-area (1)
  7464        perform 4300-FINISH-UP-DB thru 4300-exit
  7465        go to 8200-send-dataonly
  7466*       goback
  7467     end-if
  7468     .
  7469 2720-EXIT.
  7470     EXIT.
  7471 3000-CHANGE-RECORD.
  7472
  7473* EXEC CICS HANDLE CONDITION
  7474*        NOTFND (3900-RECORD-NOTFND)
  7475*    END-EXEC.
  7476*    MOVE '"$I                   ! + #00007010' TO DFHEIV0
  7477     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7479     MOVE X'2B20233030303037303130' TO DFHEIV0(25:11)
  7480     CALL 'kxdfhei1' USING DFHEIV0
  7481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7482
  7483
  7484
  7485* EXEC CICS READ
  7486*        DATASET  (ERCHEK-FILE-ID)
  7487*        SET      (ADDRESS OF CHECK-RECORDS)
  7488*        RIDFLD   (PI-ERCHEK-KEY)
  7489*        UPDATE
  7490*    END-EXEC.
  7491*    MOVE '&"S        EU         (   #00007014' TO DFHEIV0
  7492     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7493     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7494     MOVE X'2020233030303037303134' TO DFHEIV0(25:11)
  7495     CALL 'kxdfhei1' USING DFHEIV0,
  7496           ERCHEK-FILE-ID,
  7497           DFHEIV20,
  7498           DFHEIV99,
  7499           PI-ERCHEK-KEY,
  7500           DFHEIV99,
  7501           DFHEIV99,
  7502           DFHEIV99
  7503     SET ADDRESS OF CHECK-RECORDS TO
  7504         DFHEIV20
  7505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7506
  7507
  7508     IF CH-LF-REFUND NOT NUMERIC
  7509         MOVE ZEROS              TO CH-LF-REFUND.
  7510     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL677.cbl
  7511         MOVE ZEROS              TO CH-AH-REFUND.
  7512*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7513*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7514*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7515*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7516
  7517     IF VREASONL NOT = ZEROS
  7518         MOVE VREASONI           TO  CH-VOID-REASON.
  7519
  7520     IF MAINTI = 'V'
  7521        GO TO 3050-void-processing
  7522     end-if
  7523
  7524     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7525
  7526     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7527
  7528     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7529       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7530        EIBAID NOT = DFHPF4)
  7531         GO TO 8200-SEND-DATAONLY.
  7532     go to 3100-rewrite-record
  7533     .
  7534 3050-void-processing.
  7535     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7536     if sqlcode = 0
  7537        perform 4200-get-tbl-row thru 4200-exit
  7538        if sqlcode = 0
  7539           if nu-app-date = -1
  7540              move -1            to maintl
  7541              move er-3453       to emi-error
  7542              move al-uabon      to mainta
  7543              perform 9900-error-format
  7544                                 thru 9900-exit
  7545              perform 4300-FINISH-UP-DB thru 4300-exit
  7546              go to 8200-send-dataonly
  7547           end-if
  7548        end-if
  7549        if connected-to-db
  7550           perform 4300-FINISH-UP-DB thru 4300-exit
  7551        end-if
  7552     end-if
  7553     if (ch-check-written-dt = low-values)
  7554        or (ch-check-no = spaces)
  7555        move -1                  to maintl
  7556        move er-3455             to emi-error
  7557        move al-uabon            to mainta
  7558        perform 9900-error-format
  7559                                 thru 9900-exit
  7560        perform 4300-FINISH-UP-DB thru 4300-exit
  7561        go to 8200-send-dataonly
  7562     end-if
  7563     .
  7564 3100-REWRITE-RECORD.
  7565     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7566
  7567     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7568     MOVE '5'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL677.cbl
  7569     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7570
  7571     IF MAINTI = 'C'
  7572       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7573     end-if
  7574*      IF MANUAL-CHECK-WRITTEN
  7575*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7576
  7577     IF MAINTI = 'V'
  7578        IF (CH-VOID-DT = LOW-VALUES)
  7579           and (pi-check-cashed = spaces)
  7580           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7581           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7582*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7583           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7584           if pi-chek-rec-cnt = +1
  7585              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7586                                 THRU 6200-EXIT
  7587              if resp-normal
  7588                 MOVE ' '        TO PB-C-REFUND-SW
  7589                 perform 6210-rewrite-pndb
  7590                                 thru 6210-exit
  7591              end-if
  7592           end-if
  7593        ELSE
  7594           MOVE -1               TO MAINTL
  7595           MOVE ER-2583          TO EMI-ERROR
  7596           MOVE AL-UABON         TO MAINTA
  7597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7598           GO TO 8200-SEND-DATAONLY
  7599        end-if
  7600     end-if
  7601
  7602     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7603
  7604
  7605* EXEC CICS REWRITE
  7606*        DATASET  (ERCHEK-FILE-ID)
  7607*        FROM     (CHECK-RECORDS)
  7608*    END-EXEC.
  7609     MOVE LENGTH OF
  7610      CHECK-RECORDS
  7611       TO DFHEIV11
  7612*    MOVE '&& L                  %   #00007117' TO DFHEIV0
  7613     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7615     MOVE X'2020233030303037313137' TO DFHEIV0(25:11)
  7616     CALL 'kxdfhei1' USING DFHEIV0,
  7617           ERCHEK-FILE-ID,
  7618           CHECK-RECORDS,
  7619           DFHEIV11,
  7620           DFHEIV99
  7621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7622
  7623
  7624     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7625        (MAINTI EQUAL 'C')          AND
  7626        (PI-PAYTO1 NOT EQUAL PAYTO1I)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL677.cbl
  7627            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7628
  7629     IF EMI-NO-ERRORS
  7630         MOVE ER-0000            TO EMI-ERROR
  7631     ELSE
  7632         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7633            EIBAID = DFHPF4
  7634             MOVE ER-2600        TO EMI-ERROR.
  7635
  7636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7637
  7638     MOVE LOW-VALUES             TO EL677AI.
  7639
  7640     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7641     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7642     MOVE PI-CHEK-STATE          TO STATEO.
  7643     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7644
  7645     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7646     MOVE SPACE                  TO DC-OPTION-CODE.
  7647     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7648     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7649
  7650     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7651     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7652     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7653
  7654     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7655                                     ACCTA   EFFDTA
  7656                                    CERTNOA   SFXA.
  7657
  7658     MOVE AL-UNNON               TO SEQA.
  7659     go to 5000-browse-file
  7660*    GO TO 8100-SEND-INITIAL-MAP.
  7661
  7662     .
  7663 3200-PAY-ADJS-REVERSAL.
  7664
  7665     IF CH-AMOUNT-PAID NOT = ZEROS
  7666         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7667         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7668
  7669     GO TO 3290-EXIT
  7670     .
  7671 3250-BUILD-ERPYAJ-REVERSAL.
  7672
  7673
  7674* EXEC CICS GETMAIN
  7675*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7676*        LENGTH  (200)
  7677*        INITIMG (GETMAIN-SPACE)
  7678*    END-EXEC.
  7679     MOVE 200
  7680       TO DFHEIV11
  7681*    MOVE ',"IL                  $   #00007171' TO DFHEIV0
  7682     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7683     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7684     MOVE X'2020233030303037313731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL677.cbl
  7685     CALL 'kxdfhei1' USING DFHEIV0,
  7686           DFHEIV20,
  7687           DFHEIV11,
  7688           GETMAIN-SPACE
  7689     SET ADDRESS OF PENDING-PAY-ADJ TO
  7690         DFHEIV20
  7691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7692
  7693
  7694     MOVE 'PY'                   TO PY-RECORD-ID.
  7695     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7696
  7697     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7698     IF PI-ZERO-CARRIER  OR
  7699        PI-ZERO-CAR-GROUP
  7700         MOVE ZERO               TO PY-CARRIER.
  7701
  7702     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7703     IF PI-ZERO-GROUPING  OR
  7704        PI-ZERO-CAR-GROUP
  7705         MOVE ZERO               TO PY-GROUPING.
  7706
  7707     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7708     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7709     MOVE 'R'                    TO PY-RECORD-TYPE.
  7710     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7711     move '1825011300'           to py-gl-account
  7712     move 'VOID REFCK'           TO py-gl-comment
  7713     move ch-amount-paid         to py-entry-amt
  7714*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7715
  7716     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7717     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7718
  7719     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7720     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7721     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7722                                    PY-INPUT-DT.
  7723*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7724*                                   PY-CHECK-QUE-SEQUENCE.
  7725     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7726                                    PY-BILLED-DATE
  7727                                    PY-REPORTED-DT
  7728                                    PY-CHECK-WRITTEN-DT
  7729                                    PY-AR-DATE
  7730                                    PY-GL-DATE.
  7731     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7732     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7733*    MOVE 'V'                    TO PY-VOID-SW.
  7734*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7735
  7736     IF PI-AR-PROCESSING
  7737         MOVE 'B'                TO PY-PYMT-TYPE
  7738         MOVE 'A'                TO PY-PMT-APPLIED.
  7739
  7740 3259-BUILD-EXIT.
  7741     EXIT.
  7742
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL677.cbl
  7743 3280-WRITE-ERPYAJ-REVERSAL.
  7744
  7745
  7746* EXEC CICS HANDLE CONDITION
  7747*        DUPREC (3287-DUPREC)
  7748*    END-EXEC.
  7749*    MOVE '"$%                   ! , #00007228' TO DFHEIV0
  7750     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7752     MOVE X'2C20233030303037323238' TO DFHEIV0(25:11)
  7753     CALL 'kxdfhei1' USING DFHEIV0
  7754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7755
  7756
  7757
  7758* EXEC CICS WRITE
  7759*        DATASET (ERPYAJ-FILE-ID)
  7760*        FROM    (PENDING-PAY-ADJ)
  7761*        RIDFLD  (PY-CONTROL-PRIMARY)
  7762*    END-EXEC.
  7763     MOVE LENGTH OF
  7764      PENDING-PAY-ADJ
  7765       TO DFHEIV11
  7766*    MOVE '&$ L                  ''   #00007232' TO DFHEIV0
  7767     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7768     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7769     MOVE X'2020233030303037323332' TO DFHEIV0(25:11)
  7770     CALL 'kxdfhei1' USING DFHEIV0,
  7771           ERPYAJ-FILE-ID,
  7772           PENDING-PAY-ADJ,
  7773           DFHEIV11,
  7774           PY-CONTROL-PRIMARY,
  7775           DFHEIV99,
  7776           DFHEIV99
  7777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7778
  7779
  7780     GO TO 3289-WRITE-EXIT.
  7781
  7782 3287-DUPREC.
  7783     ADD +1 TO PY-FILE-SEQ-NO.
  7784
  7785     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7786
  7787 3289-WRITE-EXIT.
  7788     EXIT.
  7789
  7790 3290-EXIT.
  7791      EXIT.
  7792
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL677.cbl
  7794 3300-UPDATE-ERPYAJ.
  7795
  7796
  7797* EXEC CICS GETMAIN
  7798*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7799*        LENGTH  (200)
  7800*        INITIMG (GETMAIN-SPACE)
  7801*    END-EXEC.
  7802     MOVE 200
  7803       TO DFHEIV11
  7804*    MOVE ',"IL                  $   #00007254' TO DFHEIV0
  7805     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7806     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7807     MOVE X'2020233030303037323534' TO DFHEIV0(25:11)
  7808     CALL 'kxdfhei1' USING DFHEIV0,
  7809           DFHEIV20,
  7810           DFHEIV11,
  7811           GETMAIN-SPACE
  7812     SET ADDRESS OF PENDING-PAY-ADJ TO
  7813         DFHEIV20
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816
  7817     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7818     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7819     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7820     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7821     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7822     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7823     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7824
  7825
  7826* EXEC CICS HANDLE CONDITION
  7827*        NOTFND   (3390-EXIT)
  7828*        ENDFILE  (3390-EXIT)
  7829*    END-EXEC.
  7830*    MOVE '"$I''                  ! - #00007268' TO DFHEIV0
  7831     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7833     MOVE X'2D20233030303037323638' TO DFHEIV0(25:11)
  7834     CALL 'kxdfhei1' USING DFHEIV0
  7835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7836
  7837
  7838 3320-READNEXT-ERPYAJ.
  7839
  7840
  7841* EXEC CICS READ
  7842*        DATASET  (ERPYAJ-FILE-ID)
  7843*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7844*        RIDFLD   (ERPYAJ-KEY)
  7845*        GTEQ
  7846*    END-EXEC.
  7847*    MOVE '&"S        G          (   #00007275' TO DFHEIV0
  7848     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7850     MOVE X'2020233030303037323735' TO DFHEIV0(25:11)
  7851     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL677.cbl
  7852           ERPYAJ-FILE-ID,
  7853           DFHEIV20,
  7854           DFHEIV99,
  7855           ERPYAJ-KEY,
  7856           DFHEIV99,
  7857           DFHEIV99,
  7858           DFHEIV99
  7859     SET ADDRESS OF PENDING-PAY-ADJ TO
  7860         DFHEIV20
  7861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7862
  7863
  7864     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7865
  7866     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7867        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7868        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7869        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7870        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7871        (PY-RECORD-TYPE   NOT = 'C')
  7872          GO TO 3390-EXIT.
  7873
  7874     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7875         ADD +1 TO PYAJ-FILE-SEQ-NO
  7876         GO TO 3320-READNEXT-ERPYAJ.
  7877
  7878
  7879* EXEC CICS READ UPDATE
  7880*        DATASET   (ERPYAJ-FILE-ID)
  7881*        RIDFLD    (ERPYAJ-KEY)
  7882*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7883*    END-EXEC.
  7884*    MOVE '&"S        EU         (   #00007296' TO DFHEIV0
  7885     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7887     MOVE X'2020233030303037323936' TO DFHEIV0(25:11)
  7888     CALL 'kxdfhei1' USING DFHEIV0,
  7889           ERPYAJ-FILE-ID,
  7890           DFHEIV20,
  7891           DFHEIV99,
  7892           ERPYAJ-KEY,
  7893           DFHEIV99,
  7894           DFHEIV99,
  7895           DFHEIV99
  7896     SET ADDRESS OF PENDING-PAY-ADJ TO
  7897         DFHEIV20
  7898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7899
  7900
  7901     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7902     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7903
  7904     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7905
  7906     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7907     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7908     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7909
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL677.cbl
  7910
  7911* EXEC CICS REWRITE
  7912*        DATASET  (ERPYAJ-FILE-ID)
  7913*        FROM     (PENDING-PAY-ADJ)
  7914*    END-EXEC.
  7915     MOVE LENGTH OF
  7916      PENDING-PAY-ADJ
  7917       TO DFHEIV11
  7918*    MOVE '&& L                  %   #00007311' TO DFHEIV0
  7919     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7920     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7921     MOVE X'2020233030303037333131' TO DFHEIV0(25:11)
  7922     CALL 'kxdfhei1' USING DFHEIV0,
  7923           ERPYAJ-FILE-ID,
  7924           PENDING-PAY-ADJ,
  7925           DFHEIV11,
  7926           DFHEIV99
  7927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7928
  7929
  7930 3390-EXIT.
  7931      EXIT.
  7932
  7933 3400-delete-record.
  7934
  7935* EXEC CICS READ
  7936*        DATASET  (ERCHEK-FILE-ID)
  7937*        SET      (ADDRESS OF CHECK-RECORDS)
  7938*        RIDFLD   (PI-ERCHEK-KEY)
  7939*        UPDATE
  7940*        resp     (ws-response)
  7941*    END-EXEC
  7942*    MOVE '&"S        EU         (  N#00007320' TO DFHEIV0
  7943     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7944     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7945     MOVE X'204E233030303037333230' TO DFHEIV0(25:11)
  7946     CALL 'kxdfhei1' USING DFHEIV0,
  7947           ERCHEK-FILE-ID,
  7948           DFHEIV20,
  7949           DFHEIV99,
  7950           PI-ERCHEK-KEY,
  7951           DFHEIV99,
  7952           DFHEIV99,
  7953           DFHEIV99
  7954     SET ADDRESS OF CHECK-RECORDS TO
  7955         DFHEIV20
  7956     MOVE EIBRESP  TO ws-response
  7957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7958     if (ch-in-limbo or ch-approv-pending)
  7959        and (ch-void-dt = low-values)
  7960        and (ch-check-written-dt = low-values)
  7961        and (ch-credit-accept-dt = low-values)
  7962        perform 3500-check-tbl   thru 3500-exit
  7963        if (row-deleted and tbl-commited)
  7964           or (emi-error = er-3450)
  7965
  7966* exec cics delete
  7967*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL677.cbl
  7968*          end-exec
  7969*    MOVE '&(                    &   #00007334' TO DFHEIV0
  7970     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7971     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7972     MOVE X'2020233030303037333334' TO DFHEIV0(25:11)
  7973     CALL 'kxdfhei1' USING DFHEIV0,
  7974           erchek-file-id,
  7975           DFHEIV99,
  7976           DFHEIV99,
  7977           DFHEIV99,
  7978           DFHEIV99
  7979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7980        end-if
  7981     else
  7982        move -1               to maintl
  7983        move er-3452          to emi-error
  7984        move al-uabon         to mainta
  7985        perform 9900-error-format
  7986                                 thru 9900-exit
  7987        go to 8200-send-dataonly
  7988     end-if
  7989     if pi-chek-rec-cnt = +1
  7990        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7991                                 THRU 6200-EXIT
  7992        if resp-normal
  7993           MOVE ' '              TO PB-C-REFUND-SW
  7994           perform 6210-rewrite-pndb
  7995                                 thru 6210-exit
  7996        end-if
  7997     end-if
  7998     MOVE ER-0000            TO EMI-ERROR
  7999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8000     MOVE LOW-VALUES             TO EL677AI.
  8001     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8002     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8003     MOVE PI-CHEK-STATE          TO STATEO.
  8004     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8005     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8006     MOVE SPACE                  TO DC-OPTION-CODE.
  8007     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8008     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8009     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8010     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8011     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8012     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8013                                    ACCTA   EFFDTA
  8014                                    CERTNOA   SFXA.
  8015     MOVE AL-UNNON               TO SEQA.
  8016     GO TO 8100-SEND-INITIAL-MAP
  8017     .
  8018 3400-exit.
  8019     exit.
  8020 3500-check-tbl.
  8021     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8022*    if sqlcode = 0
  8023*       perform 4150-open-cursor    thru 4150-exit
  8024*    end-if
  8025     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL677.cbl
  8026        perform 4200-get-tbl-row thru 4200-exit
  8027     end-if
  8028      if sqlcode = 0
  8029         if (nu-app-date = -1)
  8030            or (db-app-status = '2')
  8031            perform 4250-delete-row thru 4250-exit
  8032         else
  8033           MOVE ER-3452            TO  EMI-ERROR
  8034           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8035           MOVE -1                 TO  PFENTERL
  8036           GO TO 8200-SEND-DATAONLY
  8037        end-if
  8038      else
  8039         MOVE ER-3450            TO  EMI-ERROR
  8040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8041         MOVE -1                 TO  PFENTERL
  8042*        GO TO 8200-SEND-DATAONLY
  8043      end-if
  8044     if connected-to-db
  8045        perform 4300-FINISH-UP-DB thru 4300-exit
  8046     end-if
  8047     .
  8048 3500-exit.
  8049     exit.
  8050 3700-UPDATE-ERCHKQ.
  8051*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8052*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8053*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8054*
  8055*    EXEC CICS HANDLE CONDITION
  8056*        NOTFND (3780-CHECK-NOTFND)
  8057*    END-EXEC.
  8058*
  8059*    EXEC CICS READ
  8060*        DATASET  (ERCHKQ-FILE-ID)
  8061*        SET      (ADDRESS OF CHECK-QUE)
  8062*        RIDFLD   (ERCHKQ-KEY)
  8063*        UPDATE
  8064*    END-EXEC.
  8065*
  8066*    IF MAINTI = 'C'
  8067*        IF MANUAL-CHECK-WRITTEN
  8068*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8069*            MOVE +1                  TO CQ-TIMES-PRINTED
  8070*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8071*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8072*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8073*
  8074*    IF MAINTI = 'V'
  8075*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8076*                                   CQ-VOID-INDICATOR
  8077*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8078*
  8079*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8080*
  8081*    EXEC CICS REWRITE
  8082*        DATASET  (ERCHKQ-FILE-ID)
  8083*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL677.cbl
  8084*    END-EXEC.
  8085*
  8086*    GO TO 3790-EXIT.
  8087*
  8088*3780-CHECK-NOTFND.
  8089*    MOVE ER-2905                TO EMI-ERROR.
  8090*    MOVE -1                     TO CARRIERL
  8091*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8092*                                   ACCTA     EFFDTA  CERTNOA
  8093*                                   SFXA      SEQA.
  8094*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8095     .
  8096 3790-EXIT.
  8097      EXIT.
  8098
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL677.cbl
  8100
  8101 3900-RECORD-NOTFND.
  8102     MOVE ER-2908                TO EMI-ERROR.
  8103     MOVE -1                     TO CARRIERL
  8104     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8105                                    ACCTA     EFFDTA  CERTNOA
  8106                                    SFXA      SEQA.
  8107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8108     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL677.cbl
  8110 4000-ADD-CHANGE.
  8111     IF PAYTO1L NOT = ZEROS
  8112        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8113     END-IF
  8114
  8115     IF PAYTO2L NOT = ZEROS
  8116         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8117
  8118     IF PAYAD1L NOT = ZEROS
  8119         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8120
  8121     IF PAYAD2L NOT = ZEROS
  8122         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8123
  8124     IF PAYctyL NOT = ZEROS
  8125         MOVE payctyi            TO CH-PAYEE-CITY.
  8126
  8127     IF PAYstL NOT = ZEROS
  8128         MOVE paysti            TO CH-PAYEE-state.
  8129
  8130     IF PAYEEI GREATER SPACES
  8131        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8132
  8133     IF PTOZIPL  =  ZEROS
  8134         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8135         GO TO 4000-CK-REST.
  8136
  8137     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8138
  8139     IF NOT WS-CANADIAN-POST-CODE
  8140         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8141         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8142         GO TO 4000-CK-REST.
  8143
  8144     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8145     IF WS-CAN-POST-4TH = SPACE OR '-'
  8146         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8147         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8148     ELSE
  8149         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8150         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8151
  8152 4000-CK-REST.
  8153
  8154     IF RETTOL NOT = ZEROS
  8155        MOVE RETTOI TO CH-RETURN-TO.
  8156     if dedcynl not = zeros
  8157        move dedcyni             to ch-deduct-commission
  8158     end-if
  8159     if dedcynl not = zeros
  8160        if (dedcyni = 'Y')
  8161           or (pi-prev-ded-comm = 'Y')
  8162           compute ws-amt =
  8163              pi-refund-on-pending-rec -
  8164                 pi-prev-paid - pi-ue-comm
  8165        else
  8166           if dedcyni = 'N'
  8167              compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL677.cbl
  8168                 pi-refund-on-pending-rec -
  8169                    pi-prev-paid
  8170           end-if
  8171        end-if
  8172     end-if
  8173     IF AMOUNTL NOT = ZEROS
  8174         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8175         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8176
  8177     IF CHECKL NOT = ZEROS
  8178         MOVE CHECKI             TO CH-CHECK-NO.
  8179
  8180     IF REASONL NOT = ZEROS
  8181         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8182
  8183*    IF DEDAMTL NOT = ZEROS
  8184*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8185*                                   DEDAMTO.
  8186
  8187*    IF ADDLCHGL NOT = ZEROS
  8188*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8189*                                   ADDLCHGO.
  8190
  8191     IF STUBL NOT = ZEROS
  8192         MOVE STUBI              TO CH-STUB-LINE-1.
  8193
  8194     IF TEXT1L NOT = ZEROS
  8195         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8196
  8197     IF TEXT2L NOT = ZEROS
  8198         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8199
  8200     IF TEXT3L NOT = ZEROS
  8201         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8202
  8203     IF TYPEL NOT = ZEROS
  8204         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8205
  8206*    MOVE LETTER1I               TO CH-LETTERS (1).
  8207*    MOVE LETTER2I               TO CH-LETTERS (2).
  8208*    MOVE LETTER3I               TO CH-LETTERS (3).
  8209
  8210*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8211     IF CH-CHECK-ORIGIN-SW = 'R'
  8212         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8213*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
  8214         MOVE PI-CANC-DT             TO CH-CANC-DT
  8215         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8216         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8217         MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8218
  8219*    IF PI-AR-PROCESSING AND
  8220*       REFL NOT = ZERO
  8221*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8222
  8223 4000-EXIT.
  8224      EXIT.
  8225 4100-CONNECT-TO-DB.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL677.cbl
  8226     move 'NTSQLTST2_Logic'      to svr
  8227     move 'sa'                   to usr
  8228     move 'sql2008r2'            to pass
  8229
  8230     if ws-kix-myenv = 'cid1p'
  8231        move 'NTCSO2_ChkApprv'   to svr
  8232        move 'sa'                to usr
  8233        move 'ntcso2'            to pass
  8234     end-if
  8235     string
  8236         usr delimited space
  8237         "." delimited size
  8238         pass delimited space into usr-pass
  8239     end-string
  8240     EXEC SQL
  8241        CONNECT TO :svr USER :usr-pass
  8242     END-EXEC
  8243     if sqlcode not = 0
  8244        display "Error: cannot connect "
  8245        display sqlcode
  8246        display sqlerrmc
  8247     end-if
  8248     set connected-to-db to true
  8249     .
  8250 4100-EXIT.
  8251     EXIT.
  8252 4150-open-cursor.
  8253     move pi-company-id          to ws-compid
  8254     move ch-carrier             to ws-carrier
  8255     move ch-grouping            to ws-grouping
  8256     move ch-state               to ws-state
  8257     move ch-account             to ws-account
  8258     move ch-cert-eff-dt         to dc-bin-date-1
  8259     move ' '                    to dc-option-code
  8260     perform 8500-date-convert   thru 8500-exit
  8261     if no-conversion-error
  8262        move dc-greg-date-a-edit to ws-eff-date
  8263     end-if
  8264     move ch-cert-prime          to ws-certificate
  8265     move ch-cert-sfx            to ws-cert-sfx
  8266     move ch-sequence-no         to ws-seq-no
  8267     move '1'                    to ws-type
  8268     EXEC SQL
  8269        DECLARE
  8270           checkapp cursor for
  8271        SELECT
  8272           ApprovalStatus,
  8273           MaintainedBy,
  8274           MaintainedDate,
  8275           ApprovalBatch
  8276        FROM
  8277           ChkApp_Check
  8278        WHERE
  8279           Company           = :ws-compid
  8280           and CertCarrier   = :ws-carrier
  8281           and CertGroup     = :ws-grouping
  8282           and CertState     = :ws-state
  8283           and CertAccount   = :ws-account
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL677.cbl
  8284           and CertEffDate   = :ws-eff-date
  8285           and CertNumber    = :ws-certificate
  8286           and CertNumberSuf = :ws-cert-sfx
  8287           and CheckSeqNbr   = :ws-seq-no
  8288           and CheckType     = :ws-type
  8289     END-EXEC
  8290     if sqlcode not = 0
  8291        display "Error: cannot declare cursor "
  8292        display ' sql retrun code ' sqlcode
  8293        display ' sql err mess    ' sqlerrmc
  8294        go to 4150-exit
  8295     end-if
  8296     EXEC SQL
  8297        open checkapp
  8298     END-EXEC
  8299     if sqlcode not = 0
  8300        display "Error: cannot open cursor "
  8301        display ' sql retrun code ' sqlcode
  8302        display ' sql err mess    ' sqlerrmc
  8303     end-if
  8304     .
  8305 4150-exit.
  8306     exit.
  8307 4200-get-tbl-row.
  8308***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8309***                                                            ***
  8310***  I'm only expecting one row so no cursor is declared       ***
  8311***                                                            ***
  8312***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8313     move pi-company-id          to ws-compid
  8314     move ch-carrier             to ws-carrier
  8315     move ch-grouping            to ws-grouping
  8316     move ch-state               to ws-state
  8317     move ch-account             to ws-account
  8318     move ch-cert-eff-dt         to dc-bin-date-1
  8319     move ' '                    to dc-option-code
  8320     perform 8500-date-convert   thru 8500-exit
  8321     if no-conversion-error
  8322        move dc-greg-date-a-edit to ws-eff-date
  8323     end-if
  8324     move ch-cert-prime          to ws-certificate
  8325     move ch-cert-sfx            to ws-cert-sfx
  8326     move ch-sequence-no         to ws-seq-no
  8327     move '1'                    to ws-type
  8328     exec sql
  8329        SELECT
  8330           ApprovalStatus,
  8331           MaintainedBy,
  8332           MaintainedDate,
  8333           ApprovalBatch
  8334        INTO
  8335           :db-app-status :nu-app-status,
  8336           :db-app-by :nu-app-by,
  8337           :db-app-date :nu-app-date,
  8338           :db-app-batch :nu-app-batch
  8339        FROM
  8340           ChkApp_Check
  8341        WHERE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL677.cbl
  8342           Company           = :ws-compid
  8343           and CertCarrier   = :ws-carrier
  8344           and CertGroup     = :ws-grouping
  8345           and CertState     = :ws-state
  8346           and CertAccount   = :ws-account
  8347           and CertEffDate   = :ws-eff-date
  8348           and CertNumber    = :ws-certificate
  8349           and CertNumberSuf = :ws-cert-sfx
  8350           and CheckSeqNbr   = :ws-seq-no
  8351           and CheckType     = :ws-type
  8352     end-exec
  8353     if sqlcode not = 0
  8354        display "Error: cannot read row "
  8355        display ' sql return code ' sqlcode
  8356        display ' sql err mess    ' sqlerrmc
  8357        go to 4200-exit
  8358     end-if
  8359*    display ' status ' db-app-status
  8360*    display ' by     ' db-app-by
  8361*    display ' date   ' db-app-date
  8362*    display ' batch  ' db-app-batch
  8363*    if nu-app-date = -1
  8364*       display ' approval date is low-values '
  8365*    else
  8366*       display ' approval date is NOT low values '
  8367*    end-if
  8368     .
  8369 4200-exit.
  8370     exit.
  8371 4250-delete-row.
  8372     EXEC SQL
  8373        DELETE
  8374           from ChkApp_Check
  8375        WHERE
  8376           Company           = :ws-compid
  8377           and CertCarrier   = :ws-carrier
  8378           and CertGroup     = :ws-grouping
  8379           and CertState     = :ws-state
  8380           and CertAccount   = :ws-account
  8381           and CertEffDate   = :ws-eff-date
  8382           and CertNumber    = :ws-certificate
  8383           and CertNumberSuf = :ws-cert-sfx
  8384           and CheckSeqNbr   = :ws-seq-no
  8385           and CheckType     = :ws-type
  8386     END-EXEC
  8387     if sqlcode not = 0
  8388        display "Error: cannot delete row  "
  8389        display ' sql retrun code ' sqlcode
  8390        display ' sql err mess    ' sqlerrmc
  8391        go to 4250-exit
  8392     end-if
  8393     set row-deleted         to true
  8394     EXEC SQL
  8395         commit transaction
  8396     END-EXEC
  8397     if sqlcode not = 0
  8398        display "Error: commit "
  8399        display ' sql return code ' sqlcode
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL677.cbl
  8400        display ' sql err mess    ' sqlerrmc
  8401        go to 4250-exit
  8402     end-if
  8403     set tbl-commited to true
  8404     .
  8405 4250-exit.
  8406     exit.
  8407 4300-FINISH-UP-DB.
  8408     EXEC SQL
  8409         commit work release
  8410     END-EXEC
  8411     if sqlcode not = 0
  8412        display "Error: commit release "
  8413        display ' sql return code ' sqlcode
  8414        display ' sql err mess    ' sqlerrmc
  8415     end-if
  8416     .
  8417 4300-EXIT.
  8418     EXIT.
  8419 5000-BROWSE-FILE.
  8420
  8421* EXEC CICS HANDLE CONDITION
  8422*        NOTFND   (5560-END-OF-FILE)
  8423*        ENDFILE  (5560-END-OF-FILE)
  8424*    END-EXEC.
  8425*    MOVE '"$I''                  ! . #00007777' TO DFHEIV0
  8426     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8428     MOVE X'2E20233030303037373737' TO DFHEIV0(25:11)
  8429     CALL 'kxdfhei1' USING DFHEIV0
  8430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8431
  8432
  8433     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8434
  8435     IF SEQI = LOW-VALUES
  8436         MOVE +1                 TO CHEK-RECORD-SEQ.
  8437
  8438     IF EIBAID = DFHPF2
  8439         GO TO 5100-BROWSE-BKWD.
  8440
  8441 5010-READ-LOOP.
  8442     IF EIBAID = DFHPF1
  8443         ADD +1                  TO CHEK-RECORD-SEQ.
  8444
  8445
  8446* EXEC CICS READ
  8447*        DATASET  (ERCHEK-FILE-ID)
  8448*        SET      (ADDRESS OF CHECK-RECORDS)
  8449*        RIDFLD   (ERCHEK-KEY)
  8450*        GTEQ
  8451*    END-EXEC.
  8452*    MOVE '&"S        G          (   #00007794' TO DFHEIV0
  8453     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8455     MOVE X'2020233030303037373934' TO DFHEIV0(25:11)
  8456     CALL 'kxdfhei1' USING DFHEIV0,
  8457           ERCHEK-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL677.cbl
  8458           DFHEIV20,
  8459           DFHEIV99,
  8460           ERCHEK-KEY,
  8461           DFHEIV99,
  8462           DFHEIV99,
  8463           DFHEIV99
  8464     SET ADDRESS OF CHECK-RECORDS TO
  8465         DFHEIV20
  8466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8467
  8468
  8469     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8470         IF EIBAID = DFHENTER
  8471             GO TO 5550-NO-RECORD
  8472         ELSE
  8473             GO TO 5560-END-OF-FILE.
  8474
  8475        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8476           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8477           PI-CHEK-STATE      = CH-STATE       AND
  8478           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8479           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8480           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8481           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8482              GO TO 5500-FORMAT-SCREEN
  8483            ELSE
  8484              IF EIBAID = DFHPF1
  8485                  GO TO 5560-END-OF-FILE
  8486                ELSE
  8487                  GO TO 5550-NO-RECORD.
  8488
  8489     IF EIBAID = DFHENTER
  8490        IF CHEK-CARRIER    = CH-CARRIER     AND
  8491           CHEK-GROUPING   = CH-GROUPING    AND
  8492           CHEK-STATE      = CH-STATE       AND
  8493           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8494           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8495           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8496           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8497           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8498              GO TO 5500-FORMAT-SCREEN
  8499        ELSE
  8500              GO TO 5550-NO-RECORD.
  8501
  8502     GO TO 5500-FORMAT-SCREEN.
  8503
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL677.cbl
  8505
  8506 5100-BROWSE-BKWD.
  8507
  8508* EXEC CICS STARTBR
  8509*        DATASET  (ERCHEK-FILE-ID)
  8510*        RIDFLD   (ERCHEK-KEY)
  8511*    END-EXEC.
  8512     MOVE 0
  8513       TO DFHEIV11
  8514*    MOVE '&,         G          &   #00007839' TO DFHEIV0
  8515     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8517     MOVE X'2020233030303037383339' TO DFHEIV0(25:11)
  8518     CALL 'kxdfhei1' USING DFHEIV0,
  8519           ERCHEK-FILE-ID,
  8520           ERCHEK-KEY,
  8521           DFHEIV99,
  8522           DFHEIV11,
  8523           DFHEIV99
  8524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8525
  8526
  8527
  8528* EXEC CICS READPREV
  8529*        DATASET  (ERCHEK-FILE-ID)
  8530*        SET      (ADDRESS OF CHECK-RECORDS)
  8531*        RIDFLD   (ERCHEK-KEY)
  8532*    END-EXEC.
  8533     MOVE 0
  8534       TO DFHEIV11
  8535*    MOVE '&0S                   )   #00007844' TO DFHEIV0
  8536     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8537     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8538     MOVE X'2020233030303037383434' TO DFHEIV0(25:11)
  8539     CALL 'kxdfhei1' USING DFHEIV0,
  8540           ERCHEK-FILE-ID,
  8541           DFHEIV20,
  8542           DFHEIV99,
  8543           ERCHEK-KEY,
  8544           DFHEIV99,
  8545           DFHEIV11,
  8546           DFHEIV99,
  8547           DFHEIV99
  8548     SET ADDRESS OF CHECK-RECORDS TO
  8549         DFHEIV20
  8550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8551
  8552
  8553 5110-READ-LOOP.
  8554     IF PI-FILE-EOF
  8555         MOVE SPACE              TO PI-EOF-SW
  8556     ELSE
  8557
  8558* EXEC CICS READPREV
  8559*            DATASET  (ERCHEK-FILE-ID)
  8560*            SET      (ADDRESS OF CHECK-RECORDS)
  8561*            RIDFLD   (ERCHEK-KEY)
  8562*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL677.cbl
  8563     MOVE 0
  8564       TO DFHEIV11
  8565*    MOVE '&0S                   )   #00007854' TO DFHEIV0
  8566     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8567     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8568     MOVE X'2020233030303037383534' TO DFHEIV0(25:11)
  8569     CALL 'kxdfhei1' USING DFHEIV0,
  8570           ERCHEK-FILE-ID,
  8571           DFHEIV20,
  8572           DFHEIV99,
  8573           ERCHEK-KEY,
  8574           DFHEIV99,
  8575           DFHEIV11,
  8576           DFHEIV99,
  8577           DFHEIV99
  8578     SET ADDRESS OF CHECK-RECORDS TO
  8579         DFHEIV20
  8580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8581
  8582
  8583     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8584         GO TO 5560-END-OF-FILE.
  8585
  8586        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8587           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8588           PI-CHEK-STATE      = CH-STATE       AND
  8589           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8590           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8591           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8592           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8593              GO TO 5500-FORMAT-SCREEN
  8594            ELSE
  8595              GO TO 5560-END-OF-FILE.
  8596
  8597     GO TO 5500-FORMAT-SCREEN.
  8598
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL677.cbl
  8600*                          COPY ELCNPD.
  8601*****************************************************************
  8602*                                                               *
  8603*                                                               *
  8604*                            ELCNPD                             *
  8605*                            VMOD=2.001                         *
  8606*****************************************************************
  8607
  8608 5200-MOVE-NAME.
  8609*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8610*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8611*            BLANKS.                                            *
  8612*                                                               *
  8613*                  FIELD               VALUE                    *
  8614*                                                               *
  8615*                LAST NAME (CL15)      SMITH                    *
  8616*                1ST NAME  (CL12)      JOHN                     *
  8617*                MID NAME  (CL1)       A                        *
  8618*                                                               *
  8619*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8620*         *                                                     *
  8621*         *              JOHN A. SMITH                          *
  8622*         *                                                     *
  8623*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8624*         *  STORAGE COPYBOOK:                                  *
  8625*         *                                                     *
  8626*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8627*         *******************************************************.
  8628
  8629     MOVE SPACES                 TO  WS-NAME-WORK
  8630                                     WS-NAME-WORK2.
  8631     MOVE ZERO                   TO  WS-NAME-SW.
  8632     SET NWA-INDEX TO +1.
  8633
  8634     IF WS-INSURED-1ST-NAME = SPACES  AND
  8635        WS-INSURED-MID-INIT = SPACES
  8636         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8637         GO TO 5200-EXIT.
  8638
  8639     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8640     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8641
  8642     SET NWA-INDEX UP BY +1
  8643     IF WS-INSURED-MID-INIT NOT = SPACES
  8644        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8645        SET NWA-INDEX UP BY +1
  8646        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8647        SET NWA-INDEX UP BY +2.
  8648
  8649     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8650     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8651
  8652
  8653 5200-EXIT.
  8654     EXIT.
  8655
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL677.cbl
  8657 5300-MOVE-NAME SECTION.
  8658     IF WS-NAME-SW GREATER THAN +1
  8659         GO TO 5390-EXIT.
  8660
  8661     IF WS-NAME-WORK2 = SPACES
  8662         GO TO 5390-EXIT.
  8663
  8664     SET NWA-INDEX2 TO +1.
  8665     SET NWA-INDEX3 TO +2.
  8666
  8667 5310-MOVE-NAME.
  8668     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8669
  8670     IF NWA-INDEX LESS THAN +30
  8671        SET NWA-INDEX UP BY +1
  8672     ELSE
  8673        ADD +2  TO  WS-NAME-SW
  8674        GO TO 5390-EXIT.
  8675
  8676     IF NWA-INDEX2 LESS THAN +20
  8677         SET NWA-INDEX2 UP BY +1
  8678         SET NWA-INDEX3 UP BY +1.
  8679
  8680     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8681        WS-NW2 (NWA-INDEX3) = SPACES
  8682        GO TO 5390-EXIT.
  8683
  8684     GO TO 5310-MOVE-NAME.
  8685
  8686 5390-EXIT.
  8687     EXIT.
  8688
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL677.cbl
  8691 5500-FORMAT-SCREEN.
  8692     MOVE LOW-VALUES             TO  EL677AI.
  8693     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8694     MOVE +1                     TO  MAINTL.
  8695     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8696     MOVE CH-CARRIER             TO  CARRIERO.
  8697     MOVE CH-GROUPING            TO  GROUPO.
  8698     MOVE CH-STATE               TO  STATEO.
  8699     MOVE CH-ACCOUNT             TO  ACCTO.
  8700
  8701     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8702     MOVE SPACE                  TO  DC-OPTION-CODE.
  8703     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8704     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8705
  8706     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8707     MOVE CH-CERT-SFX            TO  SFXO.
  8708     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8709
  8710     MOVE AL-UANON               TO  CARRIERA
  8711                                     GROUPA
  8712                                     STATEA
  8713                                     ACCTA
  8714                                     EFFDTA
  8715                                     CERTNOA
  8716                                     SFXA.
  8717     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8718
  8719     if ch-approval-dt not = low-values
  8720        move ch-approval-dt      to dc-bin-date-1
  8721        move ' '                 to dc-option-code
  8722        perform 8500-date-convert thru 8500-exit
  8723        move dc-greg-date-1-edit to apvdto
  8724     end-if
  8725     evaluate ch-approval-status
  8726        when '2'
  8727           move 'PENDING '       TO APVSTATO
  8728        when 'P'
  8729           move 'PENDING '       TO APVSTATO
  8730        when 'A'
  8731           move 'APPROVED'       to apvstato
  8732        when 'D'
  8733           move 'DENIED'         to apvstato
  8734     end-evaluate
  8735     move ch-approved-by         to apvbyo
  8736*    IF PI-COMPANY-ID = 'TMS'
  8737*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8738*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8739*    ELSE
  8740         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8741         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8742
  8743     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8744     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8745     move ch-payee-city          to payctyo
  8746     move ch-payee-state         to paysto
  8747     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8748
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL677.cbl
  8749     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8750         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8751         MOVE AL-UANON           TO  PTOZIPA.
  8752
  8753     MOVE CH-RETURN-TO           TO  RETTOO
  8754*    if ch-check-cashed-dt not = spaces and low-values
  8755*       move ch-check-cashed-dt  to dc-bin-date-1
  8756*       MOVE SPACE               TO  DC-OPTION-CODE
  8757*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8758*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8759*    end-if
  8760     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8761     MOVE SPACE                  TO  DC-OPTION-CODE.
  8762     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8763     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8764
  8765     MOVE CH-RECORDED-BY         TO  CBYO.
  8766
  8767     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8768         NEXT SENTENCE
  8769     ELSE
  8770         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8771         MOVE SPACE                  TO  DC-OPTION-CODE
  8772         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8773         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8774         MOVE CH-VOID-BY             TO  VBYO.
  8775
  8776     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8777         NEXT SENTENCE
  8778     ELSE
  8779         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8780         MOVE SPACE                  TO  DC-OPTION-CODE
  8781         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8782         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8783
  8784     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8785     MOVE AL-SANOF               TO  AMOUNTA.
  8786     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8787     MOVE AL-SANOF               TO  TYPEA.
  8788     MOVE CH-CHECK-NO            TO  CHECKO.
  8789     move ch-deduct-commission   to dedcyno
  8790     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8791     MOVE CH-VOID-REASON         TO  VREASONO.
  8792
  8793     MOVE CH-STUB-LINE-1         TO  STUBO.
  8794     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8795     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8796     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8797     IF CH-LF-REFUND NOT NUMERIC
  8798         MOVE ZEROS              TO CH-LF-REFUND.
  8799     IF CH-AH-REFUND NOT NUMERIC
  8800         MOVE ZEROS              TO CH-AH-REFUND.
  8801     if (ch-check-no not = spaces and low-values)
  8802        and (ch-check-written-dt not = low-values)
  8803        perform 5800-fetch-check-cashed-dt
  8804                                 thru 5800-exit
  8805     end-if
  8806     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL677.cbl
  8807        CH-VOID-DT          GREATER LOW-VALUES
  8808        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8809                                     STUBA     TEXT1A   TEXT2A
  8810                                     TEXT3A    PAYTO1A  SFXA
  8811                                     PAYTO2A   PAYAD1A  PAYctyA
  8812                                     paysta    RETTOA   PAYAD2A
  8813                                     PTOZIPA
  8814                                     PRINTEDA
  8815     ELSE
  8816        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8817                                     ACCTA     EFFDTA   CERTNOA
  8818                                     CHECKA    REASONA  VREASONA
  8819                                     STUBA     TEXT1A   TEXT2A
  8820                                     TEXT3A    PAYTO1A  SFXA
  8821                                     PAYTO2A   PAYAD1A  PAYctyA
  8822                                     paysta    RETTOA   PAYAD2A
  8823                                     PRINTEDA.
  8824
  8825     MOVE AL-UNNON               TO SEQA.
  8826     perform 5600-get-erpndb     thru 5600-exit
  8827     perform 5700-get-elcert     thru 5700-exit
  8828     move pi-prev-paid           to prepdo
  8829     if WS-PNDB-FOUND
  8830        compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8831     end-if
  8832     if WS-CERT-FOUND
  8833        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8834           cm-lf-alt-premium-amt
  8835        compute ws-tot-iss-prem  =
  8836           cm-ah-premium-amt + ws-tot-lf-prem
  8837        compute ws-tot-iss-comm =
  8838           (ws-tot-lf-prem * cm-life-comm-pct) +
  8839           (cm-ah-premium-amt * cm-ah-comm-pct)
  8840        compute ws-tot-ref-comm =
  8841           (pi-lf-refund * cm-life-comm-pct) +
  8842           (pi-ah-refund * cm-ah-comm-pct)
  8843        move ws-tot-iss-prem     to premo
  8844        move ws-tot-iss-comm     to isscommo
  8845        move ws-tot-ref-comm     to uecommo
  8846     end-if
  8847     if PI-TO-EL677-FROM-EL1273
  8848        move zeros               to premo
  8849                                    isscommo
  8850                                    uecommo
  8851                                    prepdo
  8852                                    refo
  8853     end-if
  8854     GO TO 8100-SEND-INITIAL-MAP
  8855     .
  8856 5550-NO-RECORD.
  8857     MOVE ER-1162                TO  EMI-ERROR.
  8858     MOVE -1                     TO  CARRIERL.
  8859     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8860                                     ACCTA     EFFDTA  CERTNOA
  8861                                     SFXA      SEQA.
  8862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8863
  8864     IF NOT PI-TO-EL677-FROM-EL1273
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL677.cbl
  8865         GO TO 8200-SEND-DATAONLY.
  8866
  8867     MOVE CHEK-CARRIER           TO  CARRIERO.
  8868     MOVE CHEK-GROUPING          TO  GROUPO.
  8869     MOVE CHEK-STATE             TO  STATEO.
  8870     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8871
  8872     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8873     MOVE SPACE                  TO  DC-OPTION-CODE.
  8874     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8875     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8876
  8877     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8878     MOVE CHEK-SUF-NO            TO  SFXO.
  8879     GO TO 8100-SEND-INITIAL-MAP.
  8880
  8881 5560-END-OF-FILE.
  8882     IF EIBAID = DFHPF1
  8883         MOVE 'Y'                TO  PI-EOF-SW
  8884         MOVE ER-2237            TO  EMI-ERROR
  8885     ELSE
  8886     IF EIBAID = DFHENTER
  8887        GO TO 5550-NO-RECORD
  8888     ELSE
  8889*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8890         MOVE ER-2238            TO  EMI-ERROR.
  8891
  8892     MOVE -1                     TO  MAINTL.
  8893     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8894     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL677.cbl
  8896 5600-get-erpndb.
  8897     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8898     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8899     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8900     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8901     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8902     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8903     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8904     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8905     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8906     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8907     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  8908     IF ST-ACCNT-CNTL  OR
  8909        ACCNT-CNTL
  8910          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  8911     IF ST-ACCNT-CNTL      OR
  8912        CARR-ST-ACCNT-CNTL OR
  8913        ACCNT-CNTL         OR
  8914        CARR-ACCNT-CNTL
  8915          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  8916     IF ACCNT-CNTL OR
  8917        CARR-ACCNT-CNTL
  8918          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  8919
  8920* EXEC CICS READ
  8921*         DATASET   (ERPNDB-ALT-FILE-ID)
  8922*         SET       (ADDRESS OF PENDING-BUSINESS)
  8923*         RIDFLD    (ERPNDB-ALT-KEY)
  8924*         resp      (ws-response)
  8925*    END-EXEC
  8926*    MOVE '&"S        E          (  N#00008196' TO DFHEIV0
  8927     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8928     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8929     MOVE X'204E233030303038313936' TO DFHEIV0(25:11)
  8930     CALL 'kxdfhei1' USING DFHEIV0,
  8931           ERPNDB-ALT-FILE-ID,
  8932           DFHEIV20,
  8933           DFHEIV99,
  8934           ERPNDB-ALT-KEY,
  8935           DFHEIV99,
  8936           DFHEIV99,
  8937           DFHEIV99
  8938     SET ADDRESS OF PENDING-BUSINESS TO
  8939         DFHEIV20
  8940     MOVE EIBRESP  TO ws-response
  8941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8942     if resp-normal
  8943        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  8944        compute pi-refund-on-pending-rec =
  8945           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8946     end-if
  8947     .
  8948 5600-exit.
  8949     exit.
  8950 5700-get-elcert.
  8951     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8952     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8953     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL677.cbl
  8954     MOVE PI-STATE               TO  ELCERT-STATE.
  8955     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8956     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8957     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8958     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8959     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8960
  8961* EXEC CICS READ
  8962*         DATASET   (ELCERT-FILE-ID)
  8963*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8964*         RIDFLD    (ELCERT-KEY)
  8965*         resp      (ws-response)
  8966*    END-EXEC
  8967*    MOVE '&"S        E          (  N#00008220' TO DFHEIV0
  8968     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8970     MOVE X'204E233030303038323230' TO DFHEIV0(25:11)
  8971     CALL 'kxdfhei1' USING DFHEIV0,
  8972           ELCERT-FILE-ID,
  8973           DFHEIV20,
  8974           DFHEIV99,
  8975           ELCERT-KEY,
  8976           DFHEIV99,
  8977           DFHEIV99,
  8978           DFHEIV99
  8979     SET ADDRESS OF CERTIFICATE-MASTER TO
  8980         DFHEIV20
  8981     MOVE EIBRESP  TO ws-response
  8982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8983     if resp-normal
  8984        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  8985     end-if
  8986     .
  8987 5700-exit.
  8988     exit.
  8989 5800-fetch-check-cashed-dt.
  8990     move ' '                    to ws-connect-sw
  8991                                    ws-match-sw
  8992                                    pi-check-cashed
  8993     move 'NTCSO2_PdBnkInfo'     to svr
  8994     move 'sa'                   to usr
  8995     move 'ntcso2'               to pass
  8996     string
  8997         usr delimited space
  8998         "." delimited size
  8999         pass delimited space into usr-pass
  9000     end-string
  9001     EXEC SQL
  9002        CONNECT TO :svr USER :usr-pass
  9003     END-EXEC
  9004     if sqlcode not = 0
  9005        display "Error: cannot connect to pdbnkinfo "
  9006        display sqlcode
  9007        display sqlerrmc
  9008        go to 5800-exit
  9009     end-if
  9010     set connected-to-db to true
  9011     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL677.cbl
  9012        move 'CSO - AP%'         to ws-pb-compid
  9013     else
  9014        move 'AHL - AP%'         to ws-pb-compid
  9015     end-if
  9016     move '000'                  to ws-pb-check-no (1:3)
  9017     move ch-check-no            to ws-pb-check-no (4:7)
  9018     move spaces                 to ws-pb-bad-check-no
  9019     perform varying s1 from +1 by +1 until
  9020        (s1 > +10)
  9021        or (ws-pb-check-no (s1:1) not = '0')
  9022     end-perform
  9023     if s1 < +11
  9024        move ws-pb-check-no (s1:11 - s1)
  9025                            to ws-pb-bad-check-no (1: 11 - s1)
  9026     end-if
  9027*    display ' compid **' ws-pb-compid '**'
  9028*    display ' ckno  **' ws-pb-check-no '**'
  9029     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9030     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9031     MOVE SPACES              TO pb-paid-date
  9032
  9033     EXEC SQL
  9034        CALL pbi_GetCashDate_by_TransactionNbr
  9035           @compid          = :ws-pb-compid,
  9036           @checkno         = :ws-pb-check-no,
  9037           @badcheckno      = :ws-pb-bad-check-no,
  9038           @checkamount     = :ws-check-amount,
  9039           @checkcasheddate = :pb-paid-date OUT
  9040     END-EXEC
  9041     if sqlcode not = 0
  9042        display "Error: cannot run stor proc  "
  9043        move sqlcode            to ws-sql-code
  9044        move ws-sql-code to ws-dis-sql-code
  9045        display ' dis sql code ' ws-dis-sql-code
  9046        display ' sql return code ' sqlcode
  9047        display ' sql err mess    ' sqlerrmc
  9048        go to 5800-disconnect
  9049     end-if
  9050***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9051***                                                            ***
  9052***  The following code works just as well as the above        ***
  9053***  stored procedure and just as fast.                        ***
  9054***  Originally, I had declared a cursor and fetched through   ***
  9055***  the record set to find the correct check and that REALLY  ***
  9056***  slowed the response down to ~ 3/4 second.                 ***
  9057***                                                            ***
  9058***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9059*     EXEC SQL
  9060*        SELECT
  9061*           PaidDate
  9062*        INTO
  9063*           :pb-paid-date
  9064*        FROM
  9065*           dbo.cso_pbi_TransactionLookup
  9066*        WHERE
  9067*           (BankAcctDescr like :ws-pb-compid)
  9068*           and (Amount = :ws-check-amount)
  9069*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL677.cbl
  9070*                  or
  9071*               (transactionnbr = :ws-pb-bad-check-no))
  9072**          and (CAST(TransactionNbr AS INT) =
  9073**             :ws-pb-check-no-num)
  9074**          and (right('00000' + rtrim(TransactionNbr),10)
  9075**             = :ws-pb-check-no)
  9076**          and (TransactionNbr  = :ws-pb-check-no)
  9077*     END-EXEC
  9078*    display ' chkno  ' pb-check-no
  9079*    display ' desc   ' pb-bank-acct-desc
  9080*    display ' trn typ' pb-tran-type
  9081*    display ' amt   *' pb-amount '**'
  9082*    display ' pd dte ' pb-paid-date
  9083     string pb-paid-date (7:4)
  9084            pb-paid-date (1:2)
  9085            pb-paid-date (4:2)
  9086        delimited by size into dc-greg-date-cymd-r
  9087     end-string
  9088     move 'L'                    to dc-option-code
  9089     perform 8500-date-convert   thru 8500-exit
  9090     if no-conversion-error
  9091*       move dc-bin-date-1       to ws-bin-cashed-dt
  9092        move dc-greg-date-1-edit to cashedo
  9093        move 'Y' to pi-check-cashed
  9094     else
  9095        display ' error cvtdte cash dt ' pb-paid-date ' '
  9096           dc-error-code
  9097     end-if
  9098     .
  9099 5800-disconnect.
  9100     EXEC SQL
  9101        DISCONNECT ALL
  9102     END-EXEC
  9103     if sqlcode not = 0
  9104        display "Error: cannot disconnect pdbnk "
  9105        display ' sql return code ' sqlcode
  9106        display ' sql err mess    ' sqlerrmc
  9107     end-if
  9108     .
  9109 5800-exit.
  9110     exit.
  9111 6000-VERIFY-COMP-MASTER.
  9112
  9113* EXEC CICS HANDLE CONDITION
  9114*        NOTFND   (6070-NO-COMP-MSTR)
  9115*    END-EXEC.
  9116*    MOVE '"$I                   ! / #00008355' TO DFHEIV0
  9117     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9118     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9119     MOVE X'2F20233030303038333535' TO DFHEIV0(25:11)
  9120     CALL 'kxdfhei1' USING DFHEIV0
  9121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9122
  9123
  9124     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9125
  9126     IF NOT PI-ZERO-CARRIER AND
  9127        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL677.cbl
  9128         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9129     ELSE
  9130         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9131
  9132     IF NOT PI-ZERO-GROUPING  AND
  9133        NOT PI-ZERO-CAR-GROUP
  9134         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9135     ELSE
  9136         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9137
  9138     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9139     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9140     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9141
  9142
  9143* EXEC CICS READ
  9144*         DATASET   (ERCOMP-FILE-ID)
  9145*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9146*         RIDFLD    (ERCOMP-KEY)
  9147*     END-EXEC.
  9148*    MOVE '&"S        E          (   #00008377' TO DFHEIV0
  9149     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9151     MOVE X'2020233030303038333737' TO DFHEIV0(25:11)
  9152     CALL 'kxdfhei1' USING DFHEIV0,
  9153           ERCOMP-FILE-ID,
  9154           DFHEIV20,
  9155           DFHEIV99,
  9156           ERCOMP-KEY,
  9157           DFHEIV99,
  9158           DFHEIV99,
  9159           DFHEIV99
  9160     SET ADDRESS OF COMPENSATION-MASTER TO
  9161         DFHEIV20
  9162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9163
  9164
  9165     GO TO 6090-EXIT.
  9166
  9167 6070-NO-COMP-MSTR.
  9168     MOVE -1                     TO  CARRIERL.
  9169     MOVE ER-2230                TO  EMI-ERROR.
  9170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9171     GO TO 8200-SEND-DATAONLY.
  9172
  9173 6090-EXIT.
  9174      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL677.cbl
  9176 6100-VERIFY-CERTIFICATE.
  9177
  9178* EXEC CICS HANDLE CONDITION
  9179*        NOTFND   (6170-NO-CERTIFICATE)
  9180*    END-EXEC.
  9181*    MOVE '"$I                   ! 0 #00008395' TO DFHEIV0
  9182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9184     MOVE X'3020233030303038333935' TO DFHEIV0(25:11)
  9185     CALL 'kxdfhei1' USING DFHEIV0
  9186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9187
  9188
  9189     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9190     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9191     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9192     MOVE PI-STATE               TO  ELCERT-STATE.
  9193     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9194     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9195     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9196     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9197
  9198     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9199
  9200     MOVE SPACES                 TO  PI-REFERENCE
  9201*                                    PI-INSURED-NAME.
  9202     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9203     MOVE ZEROS                  TO  PI-LF-REFUND
  9204                                     PI-AH-REFUND.
  9205
  9206
  9207* EXEC CICS READ
  9208*         DATASET   (ELCERT-FILE-ID)
  9209*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9210*         RIDFLD    (ELCERT-KEY)
  9211*     END-EXEC.
  9212*    MOVE '&"S        E          (   #00008416' TO DFHEIV0
  9213     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9215     MOVE X'2020233030303038343136' TO DFHEIV0(25:11)
  9216     CALL 'kxdfhei1' USING DFHEIV0,
  9217           ELCERT-FILE-ID,
  9218           DFHEIV20,
  9219           DFHEIV99,
  9220           ELCERT-KEY,
  9221           DFHEIV99,
  9222           DFHEIV99,
  9223           DFHEIV99
  9224     SET ADDRESS OF CERTIFICATE-MASTER TO
  9225         DFHEIV20
  9226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9227
  9228
  9229     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9230
  9231     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9232     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9233     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL677.cbl
  9234         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9235     ELSE
  9236         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9237             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9238*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9239
  9240     GO TO 6190-EXIT.
  9241
  9242 6170-NO-CERTIFICATE.
  9243     MOVE -1                     TO  CARRIERL.
  9244     MOVE ER-2726                TO  EMI-ERROR.
  9245     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9246
  9247 6190-EXIT.
  9248      EXIT.
  9249
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL677.cbl
  9251 6200-UPDATE-PENDING-BUS-REC.
  9252     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9253     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9254     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9255     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9256     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9257     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9258     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9259     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9260     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9261     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9262
  9263     IF ST-ACCNT-CNTL  OR
  9264        ACCNT-CNTL
  9265          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9266
  9267     IF ST-ACCNT-CNTL      OR
  9268        CARR-ST-ACCNT-CNTL OR
  9269        ACCNT-CNTL         OR
  9270        CARR-ACCNT-CNTL
  9271          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9272
  9273     IF ACCNT-CNTL OR
  9274        CARR-ACCNT-CNTL
  9275          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9276
  9277
  9278* EXEC CICS READ
  9279*         DATASET   (ERPNDB-ALT-FILE-ID)
  9280*         SET       (ADDRESS OF PENDING-BUSINESS)
  9281*         RIDFLD    (ERPNDB-ALT-KEY)
  9282*         resp      (ws-response)
  9283*     END-EXEC.
  9284*    MOVE '&"S        E          (  N#00008470' TO DFHEIV0
  9285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9287     MOVE X'204E233030303038343730' TO DFHEIV0(25:11)
  9288     CALL 'kxdfhei1' USING DFHEIV0,
  9289           ERPNDB-ALT-FILE-ID,
  9290           DFHEIV20,
  9291           DFHEIV99,
  9292           ERPNDB-ALT-KEY,
  9293           DFHEIV99,
  9294           DFHEIV99,
  9295           DFHEIV99
  9296     SET ADDRESS OF PENDING-BUSINESS TO
  9297         DFHEIV20
  9298     MOVE EIBRESP  TO ws-response
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9300
  9301
  9302     if not resp-normal
  9303        go to 6200-exit
  9304     end-if
  9305     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9306
  9307
  9308* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL677.cbl
  9309*         DATASET   (ERPNDB-FILE-ID)
  9310*         SET       (ADDRESS OF PENDING-BUSINESS)
  9311*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9312*         UPDATE
  9313*         resp      (ws-response)
  9314*     END-EXEC.
  9315*    MOVE '&"S        EU         (  N#00008482' TO DFHEIV0
  9316     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9317     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9318     MOVE X'204E233030303038343832' TO DFHEIV0(25:11)
  9319     CALL 'kxdfhei1' USING DFHEIV0,
  9320           ERPNDB-FILE-ID,
  9321           DFHEIV20,
  9322           DFHEIV99,
  9323           ERPNDB-PRIMARY-KEY,
  9324           DFHEIV99,
  9325           DFHEIV99,
  9326           DFHEIV99
  9327     SET ADDRESS OF PENDING-BUSINESS TO
  9328         DFHEIV20
  9329     MOVE EIBRESP  TO ws-response
  9330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9331
  9332
  9333 6200-EXIT.
  9334      EXIT.
  9335 6210-rewrite-pndb.
  9336
  9337* EXEC CICS REWRITE
  9338*        DATASET  (ERPNDB-FILE-ID)
  9339*        FROM     (PENDING-BUSINESS)
  9340*    END-EXEC
  9341     MOVE LENGTH OF
  9342      PENDING-BUSINESS
  9343       TO DFHEIV11
  9344*    MOVE '&& L                  %   #00008493' TO DFHEIV0
  9345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9347     MOVE X'2020233030303038343933' TO DFHEIV0(25:11)
  9348     CALL 'kxdfhei1' USING DFHEIV0,
  9349           ERPNDB-FILE-ID,
  9350           PENDING-BUSINESS,
  9351           DFHEIV11,
  9352           DFHEIV99
  9353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9354     .
  9355 6210-exit.
  9356     exit.
  9357 6300-BUILD-CERT-SCREEN.
  9358     perform 6700-build-common   thru 6700-exit
  9359     if ws-refund-amount = zeros
  9360        move pi-company-cd       to pi-chek-comp-cd
  9361        move pi-carrier          to pi-chek-carrier
  9362        move pi-grouping         to pi-chek-grouping
  9363        move pi-state            to pi-chek-state
  9364        move pi-account          to pi-chek-account
  9365        move pi-cert-eff-dt      to pi-chek-eff-dt
  9366        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL677.cbl
  9367        move pi-cert-sfx         to pi-chek-suf-no
  9368        move +1                  to pi-chek-sequence
  9369             MOVE 'S'            TO MAINTI
  9370             MOVE 1              TO MAINTL
  9371             MOVE AL-UABON       TO MAINTA
  9372             MOVE DFHENTER       TO EIBAID
  9373        go to 5000-browse-file
  9374     end-if
  9375     IF WS-CERT-NOT-FOUND
  9376         GO TO 8100-SEND-INITIAL-MAP.
  9377
  9378*    IF WS-PNDB-FOUND
  9379*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9380*                                   PB-C-AH-CANCEL-AMT
  9381*        MOVE 'R'                TO  TYPEO
  9382*        IF PI-AR-PROCESSING
  9383*            MOVE AL-UANON       TO  REFA
  9384*            MOVE PB-C-REFERENCE TO  REFO
  9385*        END-IF
  9386*    ELSE
  9387*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9388*                                   CM-AH-ITD-CANCEL-AMT.
  9389     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9390     MOVE 'R'                     TO TYPEO
  9391
  9392     IF PI-COMPANY-ID = 'TMS'
  9393         MOVE WS-NAME-WORK         TO PAYTO1I
  9394                                      PI-PAYTO1
  9395         MOVE AL-UANON             TO PAYTO1A
  9396     ELSE
  9397         MOVE WS-NAME-WORK         TO PAYTO1I
  9398                                      PI-PAYTO1
  9399         MOVE AL-UANON             TO PAYTO1A.
  9400
  9401*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9402*    MOVE AL-UANON                 TO PAYTO1AA.
  9403     move 'N'                    to dedcyni
  9404     move al-uanon               to dedcyna
  9405     move 'INS'                  to payeeo
  9406     move al-panon               to payeea
  9407     IF PI-MAIL-YES
  9408         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9409
  9410     GO TO 8100-SEND-INITIAL-MAP.
  9411
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL677.cbl
  9413
  9414 6400-MAILING-ADDRESS.
  9415
  9416* EXEC CICS HANDLE CONDITION
  9417*        NOTFND   (6470-NO-ADDRESS)
  9418*    END-EXEC.
  9419*    MOVE '"$I                   ! 1 #00008558' TO DFHEIV0
  9420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9422     MOVE X'3120233030303038353538' TO DFHEIV0(25:11)
  9423     CALL 'kxdfhei1' USING DFHEIV0
  9424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9425
  9426
  9427
  9428* EXEC CICS READ
  9429*        DATASET   (ERMAIL-FILE-ID)
  9430*        SET       (ADDRESS OF MAILING-DATA)
  9431*        RIDFLD    (ELCERT-KEY)
  9432*    END-EXEC.
  9433*    MOVE '&"S        E          (   #00008562' TO DFHEIV0
  9434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9436     MOVE X'2020233030303038353632' TO DFHEIV0(25:11)
  9437     CALL 'kxdfhei1' USING DFHEIV0,
  9438           ERMAIL-FILE-ID,
  9439           DFHEIV20,
  9440           DFHEIV99,
  9441           ELCERT-KEY,
  9442           DFHEIV99,
  9443           DFHEIV99,
  9444           DFHEIV99
  9445     SET ADDRESS OF MAILING-DATA TO
  9446         DFHEIV20
  9447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9448
  9449
  9450     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9451     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9452     move ma-city                to payctyi
  9453     move ma-addr-state          to paysti
  9454     MOVE MA-ZIP                 TO PTOZIPI.
  9455     MOVE AL-UANON               TO PAYAD1A
  9456                                    PAYAD2A
  9457                                    PAYctyA
  9458                                    paysta
  9459                                    PTOZIPA.
  9460
  9461     GO TO 6490-EXIT.
  9462
  9463 6470-NO-ADDRESS.
  9464     MOVE -1                     TO  PAYAD1L.
  9465     MOVE ER-2394                TO  EMI-ERROR.
  9466     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9467
  9468 6490-EXIT.
  9469      EXIT.
  9470
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL677.cbl
  9472
  9473 6500-BUILD-ACCOUNT-SCREEN.
  9474     perform 6700-build-common   thru 6700-exit
  9475     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9476     MOVE PI-AM-NAME             TO PAYTO1I
  9477     MOVE SPACES                 TO PAYTO2I
  9478     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9479     MOVE PI-AM-CITY             TO PAYCTYI
  9480     move pi-am-st               to paysti
  9481     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9482     move 'ACCT'                 to payeeo
  9483     move al-panon               to payeea
  9484     MOVE AL-UANON               TO PAYTO1A
  9485                                    PAYTO2A
  9486                                    PAYAD1A
  9487                                    PAYCTYA
  9488                                    paysta
  9489                                    PTOZIPA.
  9490     GO TO 8100-SEND-INITIAL-MAP
  9491     .
  9492 6600-BUILD-BENEFICIARY-SCREEN.
  9493     perform 6700-build-common   thru 6700-exit
  9494     IF WS-CERT-NOT-FOUND
  9495         GO TO 8100-SEND-INITIAL-MAP.
  9496
  9497*    IF WS-PNDB-FOUND
  9498*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9499*                                   PB-C-AH-CANCEL-AMT
  9500*        MOVE 'R'                TO  TYPEO
  9501*        IF PI-AR-PROCESSING
  9502*            MOVE AL-UANON       TO  REFA
  9503*            MOVE PB-C-REFERENCE TO  REFO
  9504*        END-IF
  9505*    ELSE
  9506*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9507*                                   CM-AH-ITD-CANCEL-AMT.
  9508
  9509     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9510     MOVE 'R'                     TO  TYPEO.
  9511
  9512     IF PI-COMPANY-ID = 'TMS'
  9513         MOVE WS-NAME-WORK         TO PAYTO1I
  9514                                      PI-PAYTO1
  9515         MOVE AL-UANON             TO PAYTO1A
  9516     ELSE
  9517         MOVE WS-NAME-WORK         TO PAYTO1I
  9518                                      PI-PAYTO1
  9519         MOVE AL-UANON             TO PAYTO1A.
  9520
  9521*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9522*    MOVE AL-UANON                 TO PAYTO1AA.
  9523
  9524     move 'N'                    to dedcyni
  9525     move al-uanon               to dedcyna
  9526     move 'BENE'                 to payeeo
  9527     move al-panon               to payeea
  9528     IF PI-MAIL-YES
  9529         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL677.cbl
  9530
  9531     GO TO 8100-SEND-INITIAL-MAP.
  9532
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL677.cbl
  9534
  9535 6620-MAILING-ADDRESS.
  9536
  9537* EXEC CICS HANDLE CONDITION
  9538*        NOTFND   (6670-NO-beneficiary)
  9539*    END-EXEC.
  9540*    MOVE '"$I                   ! 2 #00008654' TO DFHEIV0
  9541     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9543     MOVE X'3220233030303038363534' TO DFHEIV0(25:11)
  9544     CALL 'kxdfhei1' USING DFHEIV0
  9545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9546
  9547
  9548
  9549* EXEC CICS READ
  9550*        DATASET   (ERMAIL-FILE-ID)
  9551*        SET       (ADDRESS OF MAILING-DATA)
  9552*        RIDFLD    (ELCERT-KEY)
  9553*    END-EXEC.
  9554*    MOVE '&"S        E          (   #00008658' TO DFHEIV0
  9555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9557     MOVE X'2020233030303038363538' TO DFHEIV0(25:11)
  9558     CALL 'kxdfhei1' USING DFHEIV0,
  9559           ERMAIL-FILE-ID,
  9560           DFHEIV20,
  9561           DFHEIV99,
  9562           ELCERT-KEY,
  9563           DFHEIV99,
  9564           DFHEIV99,
  9565           DFHEIV99
  9566     SET ADDRESS OF MAILING-DATA TO
  9567         DFHEIV20
  9568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9569
  9570
  9571     move spaces                 to payto2i
  9572     move ma-cred-bene-name      to payto1i
  9573     MOVE MA-cred-bene-addr      TO PAYad1I.
  9574     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9575     move ma-cred-bene-city      to payctyi
  9576     move ma-cred-bene-state     to paysti
  9577     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9578     MOVE AL-UANON               TO payto1a
  9579                                    PAYTO2A
  9580                                    PAYad1A
  9581                                    payad2a
  9582                                    PAYctyA
  9583                                    paysta
  9584                                    PTOZIPA.
  9585
  9586     GO TO 6690-EXIT.
  9587
  9588 6670-NO-BENEFICIARY.
  9589     MOVE -1                     TO  PAYTO1L.
  9590     MOVE ER-2394                TO  EMI-ERROR.
  9591     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL677.cbl
  9592
  9593 6690-EXIT.
  9594      EXIT.
  9595 6700-build-common.
  9596     if not eracct-found
  9597        move pi-company-cd       to eracct-co
  9598        move pi-carrier          to eracct-carrier
  9599        move pi-grouping         to eracct-grouping
  9600        move pi-state            to eracct-state
  9601        move pi-account          to eracct-account
  9602        move pi-cert-eff-dt      to eracct-exp-date
  9603        if not eracct-found
  9604           perform 1420-get-eracct  thru 1490-exit
  9605        end-if
  9606     end-if
  9607*    if WS-PNDB-NOT-FOUND
  9608*       perform 5600-get-erpndb thru 5600-exit
  9609*    end-if
  9610     MOVE LOW-VALUES             TO  EL677AI.
  9611     MOVE 'A'                    TO  MAINTI.
  9612     MOVE AL-UANON               TO  MAINTA.
  9613     MOVE +1                     TO  MAINTL.
  9614     MOVE PI-CARRIER             TO  CARRIERO.
  9615     MOVE PI-GROUPING            TO  GROUPO.
  9616     MOVE PI-STATE               TO  STATEO.
  9617     MOVE PI-ACCOUNT             TO  ACCTO.
  9618     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9619     MOVE PI-CERT-SFX            TO  SFXO.
  9620     MOVE PI-AMOUNT              TO  AMOUNTO.
  9621     MOVE PI-TYPE                TO  TYPEO.
  9622     move pi-return-to           to  rettoo
  9623*    MOVE PI-REFERENCE           TO  REFO.
  9624     MOVE PI-PAYTO1              TO  PAYTO1O.
  9625     MOVE AL-UANON               TO  CARRIERA
  9626                                     GROUPA
  9627                                     STATEA
  9628                                     ACCTA
  9629                                     CERTNOA
  9630                                     SFXA
  9631                                     PAYTO1A
  9632                                     PAYTO2A
  9633*                                    AMOUNTA
  9634                                     TYPEA
  9635                                     rettoa.
  9636     move al-panon               to amounta
  9637     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9638     MOVE ' '                    TO  DC-OPTION-CODE.
  9639     PERFORM 8500-DATE-CONVERT.
  9640     IF NO-CONVERSION-ERROR
  9641         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9642         MOVE AL-UANON            TO  EFFDTA
  9643         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9644         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9645     ELSE
  9646         GO TO 8200-SEND-DATAONLY.
  9647     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9648         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9649         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL677.cbl
  9650     ELSE
  9651         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9652         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9653     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9654     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9655     move spaces to pi-insured-name
  9656     string cm-insured-last-name ' '
  9657            cm-insured-first-name delimited by '  '
  9658        into pi-insured-name
  9659     end-string
  9660     move spaces                 to pi-table-name
  9661     string cm-insured-last-name ', '
  9662            cm-insured-first-name ' '
  9663            cm-insured-initial2
  9664        delimited by '  '
  9665        into
  9666           pi-table-name
  9667     end-string
  9668*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9669     if eibaid = dfhpf5
  9670        move 'Y'                 to dedcyni
  9671        move al-uanon            to dedcyna
  9672     end-if
  9673    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9674       cm-lf-alt-premium-amt
  9675    compute ws-tot-iss-prem  =
  9676       cm-ah-premium-amt + ws-tot-lf-prem
  9677    compute ws-tot-iss-comm =
  9678       (ws-tot-lf-prem * cm-life-comm-pct) +
  9679       (cm-ah-premium-amt * cm-ah-comm-pct)
  9680    compute ws-tot-ref-comm =
  9681       (pi-lf-refund * cm-life-comm-pct) +
  9682       (pi-ah-refund * cm-ah-comm-pct)
  9683     move ws-tot-iss-prem         to premo
  9684     move ws-tot-iss-comm         to isscommo
  9685     compute refo = pi-lf-refund + pi-ah-refund
  9686     move ws-tot-ref-comm         to uecommo
  9687                                     pi-ue-comm
  9688     move pi-prev-paid            to prepdo
  9689     compute ws-refund-amount = pi-refund-on-pending-rec -
  9690        pi-prev-paid
  9691     if (dedcyni = 'Y')
  9692        or (pi-prev-ded-comm = 'Y')
  9693        compute ws-refund-amount = ws-refund-amount -
  9694           ws-tot-ref-comm
  9695     end-if
  9696     if not WS-CERT-NOT-FOUND
  9697        string
  9698           pi-cert-prime         ' : '
  9699           cm-insured-last-name  ', '
  9700           cm-insured-first-name ' : '
  9701           pi-account            ' : '
  9702           pi-am-csr delimited by '  ' into text1o
  9703        end-string
  9704        move al-uanon            to text1a
  9705        MOVE 'REF'               TO WS-USER-REASON
  9706        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9707        inspect ws-user-cert-no replacing leading zeros
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL677.cbl
  9708           by spaces
  9709        move pi-insured-name     to ws-user-name
  9710        perform varying s1 from +1 by +1 until
  9711           (s1 > +11)
  9712           or (ws-user-cert-no (s1:1)) <> ' '
  9713        end-perform
  9714        string ws-user-reason  ' ' delimited by size
  9715               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9716                  delimited by size
  9717               cm-insured-last-name ' '
  9718               cm-insured-first-name delimited by '  '
  9719           into stubo
  9720        end-string
  9721        move al-uanon            to stuba
  9722     end-if
  9723     .
  9724 6700-exit.
  9725     exit.
  9726 6800-browse-previous-chek-recs.
  9727***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9728***                                                            ***
  9729**** this should be the first time through, we need to gather  ***
  9730**** all the erchek records for this pending record, add the   ***
  9731**** amounts and make sure this check request will not exceed  ***
  9732**** the collected premium                                     ***
  9733***                                                            ***
  9734***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9735     move zeros                  to pi-prev-paid
  9736                                    ws-browse-sw
  9737                                    pi-chek-rec-cnt
  9738     move spaces                 to pi-prev-ded-comm
  9739     move pi-company-cd          to chek-company-cd
  9740     move pi-carrier             to chek-carrier
  9741     move pi-grouping            to chek-grouping
  9742     move pi-state               to chek-state
  9743     move pi-account             to chek-account
  9744     move pi-cert-prime          to chek-cert-no
  9745     move pi-cert-sfx            to chek-suf-no
  9746     move pi-cert-eff-dt         to chek-eff-dt
  9747     move +0                     to chek-record-seq
  9748     move erchek-key             to ws-compare-erchek-key
  9749
  9750* EXEC CICS STARTBR
  9751*       DATASET  (ERCHEK-FILE-ID)
  9752*       RIDFLD   (ERCHEK-KEY)
  9753*       resp     (ws-response)
  9754*    END-EXEC
  9755     MOVE 0
  9756       TO DFHEIV11
  9757*    MOVE '&,         G          &  N#00008842' TO DFHEIV0
  9758     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9759     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9760     MOVE X'204E233030303038383432' TO DFHEIV0(25:11)
  9761     CALL 'kxdfhei1' USING DFHEIV0,
  9762           ERCHEK-FILE-ID,
  9763           ERCHEK-KEY,
  9764           DFHEIV99,
  9765           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL677.cbl
  9766           DFHEIV99
  9767     MOVE EIBRESP  TO ws-response
  9768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9769     if not resp-normal
  9770        go to 6800-exit
  9771     end-if
  9772     perform until i-say-when
  9773
  9774* EXEC CICS READNEXT
  9775*          DATASET   (ERCHEK-FILE-ID)
  9776*          SET       (ADDRESS OF CHECK-RECORDS)
  9777*          RIDFLD    (ERCHEK-KEY)
  9778*          resp      (ws-response)
  9779*       END-EXEC
  9780     MOVE 0
  9781       TO DFHEIV11
  9782*    MOVE '&.S                   )  N#00008851' TO DFHEIV0
  9783     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9784     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9785     MOVE X'204E233030303038383531' TO DFHEIV0(25:11)
  9786     CALL 'kxdfhei1' USING DFHEIV0,
  9787           ERCHEK-FILE-ID,
  9788           DFHEIV20,
  9789           DFHEIV99,
  9790           ERCHEK-KEY,
  9791           DFHEIV99,
  9792           DFHEIV11,
  9793           DFHEIV99,
  9794           DFHEIV99
  9795     SET ADDRESS OF CHECK-RECORDS TO
  9796         DFHEIV20
  9797     MOVE EIBRESP  TO ws-response
  9798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9799        if resp-normal
  9800           and erchek-key (1:33) = ws-compare-erchek-key
  9801           if ch-void-dt = low-values
  9802              and not ch-denied
  9803              compute pi-prev-paid = pi-prev-paid +
  9804                 ch-amount-paid
  9805              add +1 to pi-chek-rec-cnt
  9806              move ch-deduct-commission
  9807                                 to pi-prev-ded-comm
  9808           end-if
  9809        else
  9810           set i-say-when to true
  9811        end-if
  9812     end-perform
  9813     .
  9814 6800-exit.
  9815     exit.
  9816 7000-SET-PI-AREA.
  9817     MOVE CARRIERI               TO  PI-CARRIER
  9818                                     PI-CHEK-CARRIER.
  9819     MOVE GROUPI                 TO  PI-GROUPING
  9820                                     PI-CHEK-GROUPING.
  9821     MOVE STATEI                 TO  PI-STATE
  9822                                     PI-CHEK-STATE.
  9823     MOVE ACCTI                  TO  PI-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL677.cbl
  9824                                     PI-CHEK-ACCOUNT.
  9825     MOVE CERTNOI                TO  PI-CERT-PRIME
  9826                                     PI-CHEK-CERT-NO.
  9827     IF SFXI NOT = LOW-VALUES
  9828         MOVE SFXI               TO  PI-CERT-SFX
  9829                                     PI-CHEK-SUF-NO
  9830     ELSE
  9831         MOVE SPACE              TO  PI-CERT-SFX
  9832                                     PI-CHEK-SUF-NO.
  9833
  9834     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9835     MOVE '2'                    TO  DC-OPTION-CODE.
  9836     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9837     IF DATE-CONVERSION-ERROR
  9838         MOVE ER-0215            TO  EMI-ERROR
  9839         MOVE -1                 TO  EFFDTL
  9840         MOVE AL-UNBON           TO  EFFDTA
  9841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9842         GO TO 8200-SEND-DATAONLY
  9843     ELSE
  9844         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9845                                     PI-CHEK-EFF-DT.
  9846
  9847 7090-EXIT.
  9848      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL677.cbl
  9850 7100-CREATE-TEMP-STORAGE.
  9851     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9852
  9853
  9854* EXEC CICS WRITEQ TS
  9855*        QUEUE   (QID)
  9856*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9857*        LENGTH  (PI-COMM-LENGTH)
  9858*    END-EXEC.
  9859*    MOVE '*"                    ''   #00008911' TO DFHEIV0
  9860     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  9861     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9862     MOVE X'2020233030303038393131' TO DFHEIV0(25:11)
  9863     CALL 'kxdfhei1' USING DFHEIV0,
  9864           QID,
  9865           PROGRAM-INTERFACE-BLOCK,
  9866           PI-COMM-LENGTH,
  9867           DFHEIV99,
  9868           DFHEIV99,
  9869           DFHEIV99
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9871
  9872
  9873 7100-EXIT.
  9874      EXIT.
  9875
  9876 7200-RECOVER-TEMP-STORAGE.
  9877
  9878* EXEC CICS READQ TS
  9879*        QUEUE   (QID)
  9880*        INTO    (PROGRAM-INTERFACE-BLOCK)
  9881*        LENGTH  (PI-COMM-LENGTH)
  9882*    END-EXEC.
  9883*    MOVE '*$I    L              ''   #00008921' TO DFHEIV0
  9884     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9886     MOVE X'2020233030303038393231' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           QID,
  9889           PROGRAM-INTERFACE-BLOCK,
  9890           PI-COMM-LENGTH,
  9891           DFHEIV99,
  9892           DFHEIV99,
  9893           DFHEIV99
  9894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9895
  9896
  9897     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9898
  9899 7200-EXIT.
  9900      EXIT.
  9901
  9902 7300-DELETE-TEMP-STORAGE.
  9903
  9904* EXEC CICS HANDLE CONDITION
  9905*        QIDERR  (7300-EXIT)
  9906*    END-EXEC.
  9907*    MOVE '"$N                   ! 3 #00008933' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL677.cbl
  9908     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9910     MOVE X'3320233030303038393333' TO DFHEIV0(25:11)
  9911     CALL 'kxdfhei1' USING DFHEIV0
  9912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9913
  9914
  9915
  9916* EXEC CICS DELETEQ TS
  9917*        QUEUE  (QID)
  9918*    END-EXEC.
  9919*    MOVE '*&                    #   #00008937' TO DFHEIV0
  9920     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9921     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9922     MOVE X'2020233030303038393337' TO DFHEIV0(25:11)
  9923     CALL 'kxdfhei1' USING DFHEIV0,
  9924           QID,
  9925           DFHEIV99
  9926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9927
  9928
  9929 7300-EXIT.
  9930      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL677.cbl
  9932 8035-LETR-NOT-OPEN.
  9933
  9934     MOVE ER-0013                TO EMI-ERROR.
  9935*    MOVE -1                     TO LETTER1L
  9936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9937     GO TO 8200-SEND-DATAONLY.
  9938
  9939 8035-EXIT.
  9940     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL677.cbl
  9942 8100-SEND-INITIAL-MAP.
  9943     MOVE SAVE-DATE              TO  DATEO.
  9944     MOVE EIBTIME                TO  TIME-IN.
  9945     MOVE TIME-OUT               TO  TIMEO.
  9946     MOVE -1                     TO  MAINTL
  9947     move al-uanon               to mainta
  9948     if PI-TO-EL677-FROM-EL1273
  9949        move al-sadof            to pf357a
  9950                                    pf46a
  9951                                    dprema
  9952                                    dcomma
  9953                                    drefa
  9954                                    duecomma
  9955                                    dprepda
  9956                                    prema
  9957                                    isscomma
  9958                                    refa
  9959                                    uecomma
  9960                                    prepda
  9961                                    dmaint2a
  9962        move ', VOID(V)'         to dmaint1o
  9963     end-if
  9964     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9965     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9966
  9967
  9968* EXEC CICS SEND
  9969*        MAP      (EL677A)
  9970*        MAPSET   (MAPSET-NAME)
  9971*        FROM     (EL677AO)
  9972*        ERASE
  9973*        CURSOR
  9974*    END-EXEC.
  9975     MOVE LENGTH OF
  9976      EL677AO
  9977       TO DFHEIV12
  9978     MOVE -1
  9979       TO DFHEIV11
  9980*    MOVE '8$     CT  E    H L F ,   #00008979' TO DFHEIV0
  9981     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9982     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9983     MOVE X'2020233030303038393739' TO DFHEIV0(25:11)
  9984     CALL 'kxdfhei1' USING DFHEIV0,
  9985           EL677A,
  9986           EL677AO,
  9987           DFHEIV12,
  9988           MAPSET-NAME,
  9989           DFHEIV99,
  9990           DFHEIV99,
  9991           DFHEIV99,
  9992           DFHEIV11,
  9993           DFHEIV99,
  9994           DFHEIV99,
  9995           DFHEIV99
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9997
  9998
  9999     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL677.cbl
 10001 8200-SEND-DATAONLY.
 10002     if connected-to-db
 10003        perform 4300-FINISH-UP-DB thru 4300-exit
 10004     end-if
 10005     MOVE SAVE-DATE              TO  DATEO.
 10006     MOVE EIBTIME                TO  TIME-IN.
 10007     MOVE TIME-OUT               TO  TIMEO.
 10008     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10009     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10010
 10011
 10012* EXEC CICS SEND
 10013*        MAP     (EL677A)
 10014*        MAPSET  (MAPSET-NAME)
 10015*        FROM    (EL677AO)
 10016*        DATAONLY
 10017*        CURSOR
 10018*    END-EXEC.
 10019     MOVE LENGTH OF
 10020      EL677AO
 10021       TO DFHEIV12
 10022     MOVE -1
 10023       TO DFHEIV11
 10024*    MOVE '8$D    CT       H L F ,   #00008999' TO DFHEIV0
 10025     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10026     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10027     MOVE X'2020233030303038393939' TO DFHEIV0(25:11)
 10028     CALL 'kxdfhei1' USING DFHEIV0,
 10029           EL677A,
 10030           EL677AO,
 10031           DFHEIV12,
 10032           MAPSET-NAME,
 10033           DFHEIV99,
 10034           DFHEIV99,
 10035           DFHEIV99,
 10036           DFHEIV11,
 10037           DFHEIV99,
 10038           DFHEIV99,
 10039           DFHEIV99
 10040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10041
 10042
 10043     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL677.cbl
 10045 8300-SEND-TEXT.
 10046
 10047* EXEC CICS SEND TEXT
 10048*        FROM     (LOGOFF-TEXT)
 10049*        LENGTH   (LOGOFF-LENGTH)
 10050*        ERASE
 10051*        FREEKB
 10052*    END-EXEC.
 10053*    MOVE '8&      T  E F  H   F -   #00009010' TO DFHEIV0
 10054     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10055     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10056     MOVE X'2020233030303039303130' TO DFHEIV0(25:11)
 10057     CALL 'kxdfhei1' USING DFHEIV0,
 10058           LOGOFF-TEXT,
 10059           LOGOFF-LENGTH,
 10060           DFHEIV99,
 10061           DFHEIV99,
 10062           DFHEIV99,
 10063           DFHEIV99,
 10064           DFHEIV99,
 10065           DFHEIV99,
 10066           DFHEIV99,
 10067           DFHEIV99,
 10068           DFHEIV99,
 10069           DFHEIV99
 10070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10071
 10072
 10073
 10074* EXEC CICS RETURN
 10075*    END-EXEC.
 10076*    MOVE '.(                    ''   #00009017' TO DFHEIV0
 10077     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10078     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10079     MOVE X'2020233030303039303137' TO DFHEIV0(25:11)
 10080     CALL 'kxdfhei1' USING DFHEIV0,
 10081           DFHEIV99,
 10082           DFHEIV99,
 10083           DFHEIV99,
 10084           DFHEIV99,
 10085           DFHEIV99,
 10086           DFHEIV99
 10087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10088
 10089
 10090 8500-DATE-CONVERT.
 10091     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10092
 10093
 10094* EXEC CICS LINK
 10095*        PROGRAM    (PGM-NAME)
 10096*        COMMAREA   (DATE-CONVERSION-DATA)
 10097*        LENGTH     (DC-COMM-LENGTH)
 10098*    END-EXEC.
 10099*    MOVE '."C                   (   #00009023' TO DFHEIV0
 10100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10102     MOVE X'2020233030303039303233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL677.cbl
 10103     CALL 'kxdfhei1' USING DFHEIV0,
 10104           PGM-NAME,
 10105           DATE-CONVERSION-DATA,
 10106           DC-COMM-LENGTH,
 10107           DFHEIV99,
 10108           DFHEIV99,
 10109           DFHEIV99,
 10110           DFHEIV99
 10111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10112
 10113
 10114 8500-EXIT.
 10115      EXIT.
 10116
 10117 8600-DEEDIT.
 10118
 10119* EXEC CICS BIF DEEDIT
 10120*        FIELD   (WS-DEEDIT-FIELD)
 10121*        LENGTH  (10)
 10122*    END-EXEC.
 10123     MOVE 10
 10124       TO DFHEIV11
 10125*    MOVE '@"L                   #   #00009033' TO DFHEIV0
 10126     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10127     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10128     MOVE X'2020233030303039303333' TO DFHEIV0(25:11)
 10129     CALL 'kxdfhei1' USING DFHEIV0,
 10130           WS-DEEDIT-FIELD,
 10131           DFHEIV11
 10132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10133
 10134
 10135 8600-EXIT.
 10136      EXIT.
 10137
 10138 8700-DEEDIT.
 10139
 10140* EXEC CICS BIF DEEDIT
 10141*        FIELD   (WS-DT-DEEDIT-FIELD)
 10142*        LENGTH  (10)
 10143*    END-EXEC.
 10144     MOVE 10
 10145       TO DFHEIV11
 10146*    MOVE '@"L                   #   #00009042' TO DFHEIV0
 10147     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10148     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10149     MOVE X'2020233030303039303432' TO DFHEIV0(25:11)
 10150     CALL 'kxdfhei1' USING DFHEIV0,
 10151           WS-DT-DEEDIT-FIELD,
 10152           DFHEIV11
 10153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10154
 10155
 10156 8700-EXIT.
 10157      EXIT.
 10158
 10159 8800-UNAUTHORIZED-ACCESS.
 10160     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL677.cbl
 10161     GO TO 8300-SEND-TEXT.
 10162
 10163 8810-PF23.
 10164     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10165     MOVE XCTL-005               TO  PGM-NAME.
 10166     GO TO 9300-XCTL.
 10167
 10168
 10169 9100-RETURN-TRAN.
 10170     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10171     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10172
 10173* EXEC CICS RETURN
 10174*        TRANSID  (TRANS-ID)
 10175*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10176*        LENGTH   (PI-COMM-LENGTH)
 10177*    END-EXEC.
 10178*    MOVE '.(CT                  ''   #00009063' TO DFHEIV0
 10179     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10180     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10181     MOVE X'2020233030303039303633' TO DFHEIV0(25:11)
 10182     CALL 'kxdfhei1' USING DFHEIV0,
 10183           TRANS-ID,
 10184           PROGRAM-INTERFACE-BLOCK,
 10185           PI-COMM-LENGTH,
 10186           DFHEIV99,
 10187           DFHEIV99,
 10188           DFHEIV99
 10189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10190
 10191
 10192
 10193* GOBACK.
 10194     MOVE '9%                    "   ' TO DFHEIV0
 10195     MOVE 'EL677' TO DFHEIV1
 10196     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10197     GOBACK.
 10198
 10199 9200-RETURN-MAIN-MENU.
 10200     MOVE XCTL-626               TO  PGM-NAME.
 10201     GO TO 9300-XCTL.
 10202
 10203 9300-XCTL.
 10204
 10205* EXEC CICS XCTL
 10206*        PROGRAM    (PGM-NAME)
 10207*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10208*        LENGTH     (PI-COMM-LENGTH)
 10209*    END-EXEC.
 10210*    MOVE '.$C                   %   #00009076' TO DFHEIV0
 10211     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10212     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10213     MOVE X'2020233030303039303736' TO DFHEIV0(25:11)
 10214     CALL 'kxdfhei1' USING DFHEIV0,
 10215           PGM-NAME,
 10216           PROGRAM-INTERFACE-BLOCK,
 10217           PI-COMM-LENGTH,
 10218           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL677.cbl
 10219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10220
 10221
 10222 9400-CLEAR.
 10223     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10224     MOVE SPACES                 TO  PI-PFKEY.
 10225     GO TO 9300-XCTL.
 10226
 10227 9500-PF12.
 10228     MOVE XCTL-010               TO  PGM-NAME.
 10229     GO TO 9300-XCTL.
 10230
 10231 9600-PGMID-ERROR.
 10232
 10233* EXEC CICS HANDLE CONDITION
 10234*        PGMIDERR    (8300-SEND-TEXT)
 10235*    END-EXEC.
 10236*    MOVE '"$L                   ! 4 #00009092' TO DFHEIV0
 10237     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10239     MOVE X'3420233030303039303932' TO DFHEIV0(25:11)
 10240     CALL 'kxdfhei1' USING DFHEIV0
 10241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10242
 10243
 10244     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10245     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10246     MOVE XCTL-005               TO  PGM-NAME.
 10247     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10248     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10249
 10250     GO TO 9300-XCTL.
 10251
 10252 9900-ERROR-FORMAT.
 10253     IF NOT EMI-ERRORS-COMPLETE
 10254         MOVE LINK-001           TO  PGM-NAME
 10255
 10256* EXEC CICS LINK
 10257*            PROGRAM    (PGM-NAME)
 10258*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10259*            LENGTH     (EMI-COMM-LENGTH)
 10260*        END-EXEC.
 10261*    MOVE '."C                   (   #00009107' TO DFHEIV0
 10262     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10264     MOVE X'2020233030303039313037' TO DFHEIV0(25:11)
 10265     CALL 'kxdfhei1' USING DFHEIV0,
 10266           PGM-NAME,
 10267           ERROR-MESSAGE-INTERFACE-BLOCK,
 10268           EMI-COMM-LENGTH,
 10269           DFHEIV99,
 10270           DFHEIV99,
 10271           DFHEIV99,
 10272           DFHEIV99
 10273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10274
 10275
 10276 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL677.cbl
 10277      EXIT.
 10278
 10279 9990-ABEND.
 10280     MOVE LINK-004               TO  PGM-NAME.
 10281     MOVE DFHEIBLK               TO  EMI-LINE1.
 10282
 10283* EXEC CICS LINK
 10284*        PROGRAM   (PGM-NAME)
 10285*        COMMAREA  (EMI-LINE1)
 10286*        LENGTH    (72)
 10287*    END-EXEC.
 10288     MOVE 72
 10289       TO DFHEIV11
 10290*    MOVE '."C                   (   #00009119' TO DFHEIV0
 10291     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10293     MOVE X'2020233030303039313139' TO DFHEIV0(25:11)
 10294     CALL 'kxdfhei1' USING DFHEIV0,
 10295           PGM-NAME,
 10296           EMI-LINE1,
 10297           DFHEIV11,
 10298           DFHEIV99,
 10299           DFHEIV99,
 10300           DFHEIV99,
 10301           DFHEIV99
 10302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10303
 10304
 10305     GO TO 8200-SEND-DATAONLY.
 10306
 10307 9995-SECURITY-VIOLATION.
 10308*                            COPY ELCSCTP.
 10309******************************************************************
 10310*                                                                *
 10311*                            ELCSCTP                             *
 10312*                            VMOD=2.001                          *
 10313*                                                                *
 10314*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10315******************************************************************
 10316
 10317
 10318     MOVE EIBDATE          TO SM-JUL-DATE.
 10319     MOVE EIBTRMID         TO SM-TERMID.
 10320     MOVE THIS-PGM         TO SM-PGM.
 10321     MOVE EIBTIME          TO TIME-IN.
 10322     MOVE TIME-OUT         TO SM-TIME.
 10323     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10324
 10325
 10326* EXEC CICS LINK
 10327*         PROGRAM  ('EL003')
 10328*         COMMAREA (SECURITY-MESSAGE)
 10329*         LENGTH   (80)
 10330*    END-EXEC.
 10331     MOVE 'EL003' TO DFHEIV1
 10332     MOVE 80
 10333       TO DFHEIV11
 10334*    MOVE '."C                   (   #00009145' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL677.cbl
 10335     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10336     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10337     MOVE X'2020233030303039313435' TO DFHEIV0(25:11)
 10338     CALL 'kxdfhei1' USING DFHEIV0,
 10339           DFHEIV1,
 10340           SECURITY-MESSAGE,
 10341           DFHEIV11,
 10342           DFHEIV99,
 10343           DFHEIV99,
 10344           DFHEIV99,
 10345           DFHEIV99
 10346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10347
 10348
 10349******************************************************************
 10350
 10351
 10352 9995-EXIT.
 10353     EXIT.
 10354
 10355
 10356 9999-DFHBACK SECTION.
 10357     MOVE '9%                    "   ' TO DFHEIV0
 10358     MOVE 'EL677' TO DFHEIV1
 10359     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10360     GOBACK.
 10361 9999-DFHEXIT.
 10362     IF DFHEIGDJ EQUAL 0001
 10363         NEXT SENTENCE
 10364     ELSE IF DFHEIGDJ EQUAL 2
 10365         GO TO 9600-PGMID-ERROR,
 10366               9990-ABEND
 10367         DEPENDING ON DFHEIGDI
 10368     ELSE IF DFHEIGDJ EQUAL 3
 10369         GO TO 8100-SEND-INITIAL-MAP
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 4
 10372         GO TO 1290-NO-CARRIER
 10373         DEPENDING ON DFHEIGDI
 10374     ELSE IF DFHEIGDJ EQUAL 5
 10375         GO TO 1380-NO-STATE
 10376         DEPENDING ON DFHEIGDI
 10377     ELSE IF DFHEIGDJ EQUAL 6
 10378         GO TO 1480-ACCOUNT-INVALID,
 10379               1480-ACCOUNT-INVALID
 10380         DEPENDING ON DFHEIGDI
 10381     ELSE IF DFHEIGDJ EQUAL 7
 10382         GO TO 1590-EXIT
 10383         DEPENDING ON DFHEIGDI
 10384     ELSE IF DFHEIGDJ EQUAL 8
 10385         GO TO 2200-DUPREC
 10386         DEPENDING ON DFHEIGDI
 10387     ELSE IF DFHEIGDJ EQUAL 9
 10388         GO TO 2577-DUPREC
 10389         DEPENDING ON DFHEIGDI
 10390     ELSE IF DFHEIGDJ EQUAL 10
 10391         GO TO 2600-NO-CO-MASTER
 10392         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL677.cbl
 10393     ELSE IF DFHEIGDJ EQUAL 11
 10394         GO TO 3900-RECORD-NOTFND
 10395         DEPENDING ON DFHEIGDI
 10396     ELSE IF DFHEIGDJ EQUAL 12
 10397         GO TO 3287-DUPREC
 10398         DEPENDING ON DFHEIGDI
 10399     ELSE IF DFHEIGDJ EQUAL 13
 10400         GO TO 3390-EXIT,
 10401               3390-EXIT
 10402         DEPENDING ON DFHEIGDI
 10403     ELSE IF DFHEIGDJ EQUAL 14
 10404         GO TO 5560-END-OF-FILE,
 10405               5560-END-OF-FILE
 10406         DEPENDING ON DFHEIGDI
 10407     ELSE IF DFHEIGDJ EQUAL 15
 10408         GO TO 6070-NO-COMP-MSTR
 10409         DEPENDING ON DFHEIGDI
 10410     ELSE IF DFHEIGDJ EQUAL 16
 10411         GO TO 6170-NO-CERTIFICATE
 10412         DEPENDING ON DFHEIGDI
 10413     ELSE IF DFHEIGDJ EQUAL 17
 10414         GO TO 6470-NO-ADDRESS
 10415         DEPENDING ON DFHEIGDI
 10416     ELSE IF DFHEIGDJ EQUAL 18
 10417         GO TO 6670-NO-beneficiary
 10418         DEPENDING ON DFHEIGDI
 10419     ELSE IF DFHEIGDJ EQUAL 19
 10420         GO TO 7300-EXIT
 10421         DEPENDING ON DFHEIGDI
 10422     ELSE IF DFHEIGDJ EQUAL 20
 10423         GO TO 8300-SEND-TEXT
 10424         DEPENDING ON DFHEIGDI.
 10425     MOVE '9%                    "   ' TO DFHEIV0
 10426     MOVE 'EL677' TO DFHEIV1
 10427     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10428     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142340     Code:       38504
