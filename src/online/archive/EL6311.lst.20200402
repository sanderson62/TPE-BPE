* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87******************************************************************
    88
    89 ENVIRONMENT DIVISION.
    90
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   4
* EL6311.cbl
    92 DATA DIVISION.
    93 WORKING-STORAGE SECTION.
    94 01  DFH-START PIC X(04).
    95 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    96 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    97 77  FILLER  PIC X(32)  VALUE '********************************'.
    98 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    99 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   100 77  A1                          PIC S999 COMP-3 VALUE +0.
   101 77  N1                          PIC S999 COMP-3 VALUE +0.
   102 77  N2                          PIC S999 COMP-3 VALUE +0.
   103 77  N3                          PIC S999 COMP-3 VALUE +0.
   104 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   105 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   106 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   107     88  REVERSAL                    VALUE 'Y'.
   108 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   109 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   110 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   111 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   112 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   113     88  ERMAIL-FOUND                 VALUE 'Y'.
   114 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   115 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   116 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   117 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   118     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   119 77  ws-stop-sw                  pic x value ' '.
   120     88  i-say-stop                 value 'Y'.
   121 77  ws-check-sw                 pic x value ' '.
   122     88  i-have-checks              value 'Y'.
   123 77  ws-proc-check-sw            pic x value ' '.
   124     88  i-have-processed-checks    value 'Y'.
   125 77  ws-any-check-sw             pic x value ' '.
   126     88  i-have-a-check-period      value 'Y'.
   127 77  ws-chek-browse-sw           pic x value ' '.
   128 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   129 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   130 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   131 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   132 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   133 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   134 77  ws-elcrtt-update-sw         pic x value ' '.
   135     88  update-elcrtt              value 'Y'.
   136 01  P pointer.
   137 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   138 01  var-ptr pointer.
   139 01  env-var-len                 pic 9(4)  binary.
   140 01  rc                          pic 9(9)  binary.
   141 01  WS-KIXSYS.
   142     05  WS-KIX-FIL1             PIC X(10).
   143     05  WS-KIX-APPS             PIC X(10).
   144     05  WS-KIX-ENV              PIC X(10).
   145     05  WS-KIX-MYENV            PIC X(10).
   146     05  WS-KIX-SYS              PIC X(10).
   147*    COPY ELCSCTM.
   148******************************************************************
   149*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   5
* EL6311.cbl
   150*                                                                *
   151*                            ELCSCTM                             *
   152*                            VMOD=2.001                          *
   153*                                                                *
   154*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   155*                                                                *
   156******************************************************************
   157 01  SECURITY-MESSAGE.
   158     12  FILLER                          PIC X(30)
   159            VALUE '** LOGIC SECURITY VIOLATION -'.
   160     12  SM-READ                         PIC X(6).
   161     12  FILLER                          PIC X(5)
   162            VALUE ' PGM='.
   163     12  SM-PGM                          PIC X(6).
   164     12  FILLER                          PIC X(5)
   165            VALUE ' OPR='.
   166     12  SM-PROCESSOR-ID                 PIC X(4).
   167     12  FILLER                          PIC X(6)
   168            VALUE ' TERM='.
   169     12  SM-TERMID                       PIC X(4).
   170     12  FILLER                          PIC XX   VALUE SPACE.
   171     12  SM-JUL-DATE                     PIC 9(5).
   172     12  FILLER                          PIC X    VALUE SPACE.
   173     12  SM-TIME                         PIC 99.99.
   174
   175
   176*    COPY ELCSCRTY.
   177******************************************************************
   178*                                                                *
   179*                                                                *
   180*                            ELCSCRTY                            *
   181*                            VMOD=2.001                          *
   182*                                                                *
   183*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   184*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   185*        SAVED IN PI-SECURITY-ADDRESS.                           *
   186*                                                                *
   187******************************************************************
   188 01  SECURITY-CONTROL.
   189     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   190     12  FILLER                       PIC XX    VALUE 'SC'.
   191     12  SC-CREDIT-CODES.
   192         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   193             20  SC-CREDIT-DISPLAY    PIC X.
   194             20  SC-CREDIT-UPDATE     PIC X.
   195     12  SC-CLAIMS-CODES.
   196         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   197             20  SC-CLAIMS-DISPLAY    PIC X.
   198             20  SC-CLAIMS-UPDATE     PIC X.
   199
   200 01  WS-VA-NO-COMM-MESS.
   201     12  FILLER                  PIC X(41) VALUE
   202        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   203 01  WS-OC-MESSAGE.
   204     12  FILLER                  PIC X(43) VALUE
   205        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   206     12  WS-OC-DIS-AMT           PIC -----9.99.
   207     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   6
* EL6311.cbl
   208     12  WS-OC-DATE              PIC X(10).
   209 01  WS-DATE-AREA.
   210     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   211     12  WS-CURRENT-DT.
   212         16  FILLER              PIC X(6)    VALUE SPACES.
   213         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   214     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   215     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   216     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   217
   218 01  STANDARD-AREAS.
   219     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   220     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   221     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   222     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   223     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   224     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   225     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   226     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   227     12  PGM-NAME                PIC X(8).
   228     12  TIME-IN                 PIC S9(7).
   229     12  TIME-OUT-R  REDEFINES TIME-IN.
   230         16  FILLER              PIC X.
   231         16  TIME-OUT            PIC 99V99.
   232         16  FILLER              PIC XX.
   233     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   234     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   235     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   236     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   237     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   238     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   239     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   240     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   241     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   242     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   243     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   244     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   245     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   246     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   247     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   248     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   249     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   250     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   251     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   252     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   253     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   254     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   255     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   256     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   257     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   258     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   259     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   260     12  FILE-ID                 PIC X(8).
   261     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   262     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   263     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   264     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   265     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   7
* EL6311.cbl
   266     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   267     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   268     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   269     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   270     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   271     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   272     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   273     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   274     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   275     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   276
   277 01  WS-PASS-AREA.
   278     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   279     05  WS-PASS-VADS-REC    PIC X(350).
   280*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   281*                                COPY ELCZREC.
   282******************************************************************
   283*                                                                *
   284*                                                                *
   285*                            ELCZREC.                            *
   286*                                                                *
   287*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   288*                                                                *
   289******************************************************************
   290*-----------------------------------------------------------------
   291*                   C H A N G E   L O G
   292*
   293* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   294*-----------------------------------------------------------------
   295*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   296* EFFECTIVE    NUMBER
   297*-----------------------------------------------------------------
   298* 122011    2011022800001  AJRA  NEW FILE
   299* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   300* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   301* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   302* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   303*-----------------------------------------------------------------
   304 01  W-Z-CONTROL-DATA.
   305     05  W-NUMBER-OF-COPIES      PIC  9.
   306     05  FILLER                  PIC  X.
   307     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   308     05  FILLER                  PIC  X.
   309     05  W-DAYS-TO-RESEND        PIC  999.
   310     05  FILLER                  PIC  X.
   311     05  W-FORM-TO-RESEND        PIC  X(4).
   312     05  W-ADD-BAR-CODE          PIC  X.
   313     05  W-PROMPT-LETTER         PIC  X.
   314     05  W-HAS-RETURN-ENV        PIC  X.
   315     05  W-ENCLOSURE-CD          PIC  XXX.
   316     05  W-SIG-FLAG-DEFAULT      PIC  X.
   317     05  W-AUTO-CLOSE-IND        PIC  X.
   318     05  FILLER                  PIC  X.
   319     05  W-LETTER-TO-BENE        PIC  X.
   320     05  FILLER                  PIC  X.
   321     05  W-LETTER-TO-ACCT        PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   8
* EL6311.cbl
   324     05  FILLER                  PIC  X.
   325     05  W-PRINT-CERTIFICATE     PIC  X.
   326     05  FILLER                  PIC  X.
   327     05  W-REFUND-REQUIRED       PIC  X.
   328     05  FILLER                  PIC  X.
   329     05  W-ONBASE-CODE           PIC  XX.
   330     05  FILLER                  PIC  X.
   331     05  W-ACCT-SUMM             PIC  X.
   332     05  FILLER                  PIC  X.
   333     05  W-CSO-SUMM              PIC  X.
   334     05  FILLER                  PIC  X.
   335     05  W-REASONS-REQUIRED      PIC  X.
   336     05  FILLER                  PIC  X(29).
   337******************************************************************
   338*                                                                *
   339*              A C C E S S   K E Y S                             *
   340*                                                                *
   341******************************************************************
   342
   343 01  ACCESS-KEYS.
   344     12  ERPYAJ-KEY.
   345         16  ERPYAJ-COMPANY-CD       PIC X.
   346         16  ERPYAJ-CARRIER          PIC X.
   347         16  ERPYAJ-GROUPING         PIC X(6).
   348         16  ERPYAJ-FIN-RESP         PIC X(10).
   349         16  ERPYAJ-ACCOUNT          PIC X(10).
   350         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   351         16  ERPYAJ-TYPE             PIC X.
   352     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   353     12  ELCERT-KEY.
   354         16  ELCERT-COMPANY-CD       PIC X.
   355         16  ELCERT-CARRIER          PIC X.
   356         16  ELCERT-GROUPING         PIC X(6).
   357         16  ELCERT-STATE            PIC XX.
   358         16  ELCERT-ACCOUNT          PIC X(10).
   359         16  ELCERT-CERT-EFF-DT      PIC XX.
   360         16  ELCERT-CERT-NO.
   361             20  ELCERT-CERT-PRIME   PIC X(10).
   362             20  ELCERT-CERT-SFX     PIC X.
   363
   364     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   365     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   366     12  ELCRTO-KEY.
   367         16  ELCRTO-COMPANY-CD       PIC X.
   368         16  ELCRTO-CARRIER          PIC X.
   369         16  ELCRTO-GROUPING         PIC X(6).
   370         16  ELCRTO-STATE            PIC XX.
   371         16  ELCRTO-ACCOUNT          PIC X(10).
   372         16  ELCRTO-CERT-EFF-DT      PIC XX.
   373         16  ELCRTO-CERT-NO.
   374             20  ELCRTO-CERT-PRIME   PIC X(10).
   375             20  ELCRTO-CERT-SFX     PIC X.
   376         16  ELCRTO-RECORD-TYPE      PIC X.
   377         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   378
   379     12  ELCRTT-KEY.
   380         16  ELCRTT-PRIMARY          PIC X(33).
   381         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page   9
* EL6311.cbl
   382     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   383     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   384
   385     12  ERPNDB-KEY.
   386         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   387         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   388         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   389         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   390             ERPNDB-BATCH-SEQ-NO     PIC XX.
   391         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   392
   393     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   394     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   395     12  ERCHEK-KEY.
   396         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   397         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   398         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   399         16  CHEK-STATE              PIC XX      VALUE SPACES.
   400         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   401         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   402         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   403         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   404         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   405     12  ELLETR-KEY.
   406         16  LETR-COMPANY-CD     PIC X.
   407         16  LETR-LETTER-ID      PIC X(4).
   408         16  LETR-FILLER         PIC X(8).
   409         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   410     12  ERPNDM-KEY.
   411         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   412         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   413         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   414         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   415
   416*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   417     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   418*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   419     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   420
   421     12  ERPNDB-ALT-KEY.
   422         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   423         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   424         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   425         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   426         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   427         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   428         16  ERPNDB-CERT-NO.
   429             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   430             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   431         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   432         16  ERPNDB-RECORD-TYPE      PIC X.
   433
   434      12  ERPNDB-CSR-KEY.
   435          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   436          20  ERPNDB-CSR-ID                PIC X(4).
   437          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   438          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   439          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  10
* EL6311.cbl
   440
   441     12  ERNOTE-KEY.
   442         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   443         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   444         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   445         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   446         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   447         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   448         16  ERNOTE-CERT-NO.
   449             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   450             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   451
   452     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   453     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   454
   455     12  ERCNOT-KEY.
   456         16  ERCNOT-PART-KEY.
   457             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   458             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   459             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   460             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   461             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   462             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   463             20  ERCNOT-CERT-NO.
   464                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   465                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   466         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   467         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   468
   469     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   470     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   471
   472     12  ERMAIL-KEY.
   473         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   474         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   475         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   476         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   477         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   478         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   479         16  ERMAIL-CERT-NO.
   480             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   481             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   482
   483     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   484     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   485
   486     12  ERRQST-KEY.
   487         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   488         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   489
   490     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   491     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   492
   493     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   494
   495     12  ERLOFC-KEY.
   496         16  ERLOFC-COMPANY-CD          PIC  X.
   497         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  11
* EL6311.cbl
   498         16  ERLOFC-GROUPING            PIC  X(6).
   499         16  ERLOFC-STATE               PIC  XX.
   500         16  ERLOFC-ACCOUNT             PIC  X(10).
   501         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   502*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   503
   504     12  ERACCT-KEY.
   505         16  ERACCT-COMPANY-CD          PIC  X.
   506         16  ERACCT-CARRIER             PIC  X.
   507         16  ERACCT-GROUPING            PIC  X(6).
   508         16  ERACCT-STATE               PIC  XX.
   509         16  ERACCT-ACCOUNT             PIC  X(10).
   510         16  ERACCT-EXP-DT.
   511             20  ERACCT-DT              PIC  XX.
   512             20  ERACCT-FILL            PIC  X(4).
   513     12  ERACNT-KEY.
   514         16  ERACNT-COMPANY-CD          PIC  X.
   515         16  ERACNT-CARRIER             PIC  X.
   516         16  ERACNT-GROUPING            PIC  X(6).
   517         16  ERACNT-STATE               PIC  XX.
   518         16  ERACNT-ACCOUNT             PIC  X(10).
   519         16  ERACNT-REC-TYPE            PIC  X.
   520         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   521     12  ERENDT-KEY.
   522         16  ENDT-COMPANY-CD       PIC X.
   523         16  ENDT-CARRIER          PIC X.
   524         16  ENDT-GROUPING         PIC X(6).
   525         16  ENDT-STATE            PIC XX.
   526         16  ENDT-ACCOUNT          PIC X(10).
   527         16  ENDT-CERT-EFF-DT      PIC XX.
   528         16  ENDT-CERT-PRIME       PIC X(10).
   529         16  ENDT-CERT-SFX         PIC X.
   530         16  ENDT-RECORD-TYPE      PIC X.
   531         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   532
   533 01  WS-ELMSTR-WORK.
   534     12  ELMSTR-KEY.
   535         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   536         16  MSTR-CERT-NO.
   537             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   538             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   539     12  W-CLAIM-KEY.
   540         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   541         16  W-CL-CERT-NO.
   542             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   543             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   544      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   545 01  CANCEL-GEN-PASS-AREA.
   546     05  CG-OPTION-CODE          PIC X.
   547         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   548         88  CG-FLAT-CANCEL        VALUE '1'.
   549         88  CG-CANCEL             VALUE '2'.
   550         88  CG-CANCEL-REISSUE     VALUE '3'.
   551     05  CG-ERROR-CODE           PIC 99.
   552         88  CG-SUCCESS            VALUE 00.
   553         88  CG-DATE-ERROR         VALUE 01.
   554         88  CG-CERT-NOT-FOUND     VALUE 02.
   555         88  CG-AMOUNT-ERROR       VALUE 04.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  12
* EL6311.cbl
   556         88  CG-OPTION-ERROR       VALUE 05.
   557         88  CG-PREV-CAN           VALUE 06.
   558         88  CG-INVALID-DATA       VALUE 07.
   559         88  CG-NO-ACCT-MSTR       VALUE 08.
   560         88  CG-SFX-A-EXIST        VALUE 09.
   561         88  CG-MISC-ERROR         VALUE 99.
   562     05  CG-COMPANY-ID           PIC XXX.
   563     05  CG-PROC-ID              PIC XXXX.
   564     05  CG-CURRENT-DT           PIC XX.
   565     05  CG-MONTH-END-DT         PIC XX.
   566     05  CG-CERT-KEY.
   567         10  CG-CERT-COMPANY-CD  PIC X.
   568         10  CG-CERT-CARRIER     PIC X.
   569         10  CG-CERT-GROUP       PIC X(6).
   570         10  CG-CERT-STATE       PIC XX.
   571         10  CG-CERT-ACCOUNT     PIC X(10).
   572         10  CG-CERT-EFF-DT      PIC XX.
   573         10  CG-CERT-CERT-NO     PIC X(11).
   574     05  CG-LF-CAN-DATA.
   575         10  CG-LF-CAN-DT        PIC XX.
   576         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   577     05  CG-AH-CAN-DATA.
   578         10  CG-AH-CAN-DT        PIC XX.
   579         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   580     05  CG-CERT-PROFILE-DATA.
   581         10  CG-INS-LNAME        PIC X(15).
   582         10  CG-INS-FNAME        PIC X(10).
   583         10  CG-INS-MID-INIT     PIC X.
   584         10  CG-INS-AGE          PIC 99.
   585         10  CG-JNT-LNAME        PIC X(15).
   586         10  CG-JNT-FNAME        PIC X(10).
   587         10  CG-JNT-MID-INIT     PIC X.
   588         10  CG-JNT-AGE          PIC 99.
   589     05  CG-LF-ISS-DATA.
   590         10  CG-LF-BENCD         PIC XX.
   591         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   592         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   593     05  CG-AH-ISS-DATA.
   594         10  CG-AH-BENCD         PIC XX.
   595         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   596     05  CG-BATCH-NO             PIC X(6).
   597     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   598     05  FILLER                  PIC X(306).
   599******************************************************************
   600*                                                                *
   601*            G E N E R A L   W O R K   A R E A                   *
   602*                                                                *
   603******************************************************************
   604
   605 01  WORK-AREA.
   606     12  WS-RESPONSE             PIC S9(8)   COMP.
   607         88  RESP-NORMAL           VALUE +0.
   608         88  resp-file-notfnd      value +12.
   609         88  RESP-NOTFND           VALUE +13.
   610         88  resp-duprec           value +14.
   611         88  resp-dupkey           value +15.
   612         88  resp-invreq           value +16.
   613         88  RESP-NOTOPEN          VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  13
* EL6311.cbl
   614         88  RESP-ENDFILE          VALUE +20.
   615         88  resp-lengtherr        value +22.
   616     12  DEEDIT-FIELD            PIC X(15).
   617     12  FILLER          REDEFINES DEEDIT-FIELD.
   618         16  FILLER              PIC X(4).
   619         16  DEEDIT-FIELD-X11    PIC X(11).
   620     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   621                                 PIC S9(15).
   622     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   623                                 PIC S9(13)V99.
   624     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   625                                 PIC S9(11)V9999.
   626     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   627     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   628     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   629         16  WS-CALC-TERM-WHOLE  PIC S999.
   630         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   631
   632     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   633     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   634         16  WS-HR-MINS          PIC 99V99.
   635         16  FILLER              PIC XX.
   636
   637     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   638     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   639
   640     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   641     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   642
   643     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   644     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   645     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   646     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   647     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   648     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   649     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   650
   651     12  QID.
   652         16  QID-TERM            PIC X(4).
   653         16  FILLER              PIC X(4)    VALUE '607B'.
   654
   655     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   656         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   657
   658     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   659         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   660
   661     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   662         88 WS-MODE-CODE-VALID     VALUE ' '
   663                                         'W'     *> Weekly
   664                                         'B'     *> Bi-weekly
   665                                         'S'     *> Semi-monthly
   666                                         'M'     *> Monthly (Def)
   667                                         'Q'     *> Quarterly
   668                                         'N'     *> Bi-Monthly??
   669                                         'T'     *> Semi-annual
   670                                         'A'.    *> Annual Pay
   671
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  14
* EL6311.cbl
   672     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   673
   674     12  WS-NUMERIC-SW           PIC X.
   675        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   676
   677     12  WS-EDIT-CSO-FIELD.
   678         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   679                                 PIC X.
   680     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   681     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   682        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   683        88  CALLED-FROM-6315          VALUE '5'.
   684
   685     12  WS-SAVE-INPUT-FIELDS.
   686         16  WS-BAGE             PIC 99       VALUE ZERO.
   687*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   688         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   689         16  FILLER REDEFINES WS-BAPR.
   690             20  WS-APR-WHOLE-NUM    PIC 99.
   691             20  WS-APR-DEC          PIC 9999.
   692         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   693         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   694
   695         16  WS-B-COVERAGE OCCURS 2 TIMES.
   696             20  WS-TERM-IN-DAYS-SW  PIC X.
   697                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   698             20  WS-BTERM        PIC 999       COMP-3.
   699             20  WS-BALT-TERM    PIC 999       COMP-3.
   700             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   701             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   702             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   703             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   704             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   705             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   706
   707         16  WS-C-FIELDS COMP-3.
   708             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   709             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   710             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   711
   712         16  WS-D-FIELDS COMP-3.
   713             20  WS-DRISS        PIC S9(5)    VALUE +0.
   714             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   715             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   716             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   717             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   718             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   719
   720     12  WS-SAVE-BIRTH-DATE.
   721         16  FILLER              PIC X(4)   VALUE SPACES.
   722         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   723
   724     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   725     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   726     12  FILLER REDEFINES WS-WORK-BIN-RED.
   727         16  FILLER              PIC X(02).
   728         16  WS-WORK-BIN-DT      PIC X(02).
   729     12  WS-SW-1                 PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  15
* EL6311.cbl
   730     12  WS-SW-2                 PIC X     VALUE SPACE.
   731     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   732         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   733     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   734         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   735
   736     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   737     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   738     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   739     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   740     12  WS-CONVERTED-CANCEL-DATES.
   741         16  WS-CONVERTED-CANDT1                  PIC XX.
   742         16  WS-CONVERTED-CANDT2                  PIC XX.
   743
   744     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   745
   746     12  WS-REC-FOUND-SW         PIC X.
   747         88  RECORD-NOT-FOUND    VALUE 'N'.
   748
   749     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   750         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   751         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   752
   753     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   754         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   755         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   756
   757     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   758         88  BROWSE-STARTED      VALUE 'Y'.
   759
   760     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   761         88  FIRST-TIME          VALUE 'Y'.
   762
   763     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   764         88  FIRST-ENTRY         VALUE 'Y'.
   765
   766     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   767         88  REC-BILLED          VALUE 'Y'.
   768
   769     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   770         88  NO-CURSOR-SET       VALUE +0.
   771         88  CURSOR-SET          VALUE +1.
   772
   773     12  WS-ERR-SW               PIC X.
   774         88  STD-ERRORS          VALUE 'S'.
   775         88  TRN-ERRORS          VALUE 'T'.
   776
   777     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   778         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   779
   780     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   781         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   782
   783     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   784         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   785
   786     12  WS-ERR-CODE.
   787         16  FILLER              PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  16
* EL6311.cbl
   788         16  WS-ERROR-SUB        PIC 99.
   789
   790     12  WS-DATE-WORK.
   791         16  WS-WORK-MM          PIC XX.
   792         16  WS-WORK-DD          PIC XX.
   793         16  WS-WORK-YY          PIC XX.
   794
   795     12  WS-MM-YY.
   796         16  WS-MM               PIC XX.
   797         16  FILLER              PIC X     VALUE '/'.
   798         16  WS-YY               PIC XX.
   799
   800     12  WS-CERT-EFF-DT          PIC XX.
   801
   802     12  WS-MEMBER-NO            PIC X(12).
   803     12  FILLER  REDEFINES  WS-MEMBER-NO.
   804         16  WS-MEMBER-NO-1-8    PIC 9(8).
   805         16  FILLER              PIC X(4).
   806
   807     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   808
   809     12  WS-ERPNDB-ALT-KEY.
   810         16  WS-PB-COMPANY-CD-A1         PIC X.
   811         16  WS-PB-CARRIER               PIC X.
   812         16  WS-PB-GROUPING              PIC X(6).
   813         16  WS-PB-STATE                 PIC XX.
   814         16  WS-PB-ACCOUNT               PIC X(10).
   815         16  WS-PB-CERT-EFF-DT           PIC XX.
   816         16  WS-PB-CERT-NO.
   817             20  WS-PB-CERT-PRIME        PIC X(10).
   818             20  WS-PB-CERT-SFX          PIC X.
   819         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   820         16  WS-PB-RECORD-TYPE           PIC X.
   821
   822     12  WS-SHOW-SAVE-AREAS.
   823         16  WS-NEW-CERT-NO.
   824             20  WS-NEW-PRIME    PIC X(10).
   825             20  WS-NEW-SUFFIX   PIC X.
   826         16  WS-NEW-CERT-EFF-DT  PIC XX.
   827         16  WS-NEW-RECORD-TYPE  PIC X.
   828         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   829             88   SHOW-RECORD            VALUE 'Y'.
   830
   831     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   832
   833     12  WS-BATCH-NO.
   834         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   835         16  FILLER              PIC X(5) VALUE SPACES.
   836
   837     12  WS-FIRST-NAME.
   838         16  WS-1ST-INIT         PIC X.
   839         16  FILLER              PIC X(9).
   840
   841     12  WS-INITIALS.
   842         16  WS-INITIAL-1        PIC X.
   843         16  WS-INITIAL-2        PIC X.
   844
   845     12  WS-C-HDG.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  17
* EL6311.cbl
   846         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   847         16  FILLER              PIC X(4) VALUE '-REF'.
   848
   849     12  WS-D-PREM-HDG.
   850         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   851         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   852
   853     12  WS-D-REFUND-HDG.
   854         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   855         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   856
   857     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   858
   859     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   860     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   861     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   862     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   863     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   864     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   865     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   866
   867     12  WS-01-CANCEL-ERR        PIC X(25)
   868         VALUE 'CANCEL DATE ERROR'.
   869     12  WS-02-CANCEL-ERR        PIC X(25)
   870         VALUE 'CERT NOT FOUND'.
   871     12  WS-04-CANCEL-ERR        PIC X(25)
   872         VALUE 'CANCEL AMOUNT ERROR'.
   873     12  WS-05-CANCEL-ERR        PIC X(25)
   874         VALUE 'CANCEL OPTION ERROR'.
   875     12  WS-06-CANCEL-ERR        PIC X(25)
   876         VALUE 'PREVIOUSLY CANCELLED'.
   877     12  WS-07-CANCEL-ERR        PIC X(25)
   878         VALUE 'INVALID DATA'.
   879     12  WS-08-CANCEL-ERR        PIC X(25)
   880         VALUE 'NO ACCOUNT MASTER'.
   881     12  WS-09-CANCEL-ERR        PIC X(25)
   882         VALUE 'SUFFIX ALREADY EXISTS'.
   883     12  WS-99-CANCEL-ERR        PIC X(25)
   884         VALUE 'MISC CANCEL ERROR'.
   885
   886     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   887     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   888
   889     12  WS-AGE-FIELDS.
   890         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   891         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   892         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   893         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   894
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  18
* EL6311.cbl
   896
   897******************************************************************
   898*                                                                *
   899*                 B A T C H   T O T A L S                        *
   900*                                                                *
   901******************************************************************
   902
   903     12  WS-BATCH-RECORD.
   904         16  FILLER                       PIC X(10).
   905         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   906         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   907         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   908         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   909         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   910         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   911         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   912         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   913         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   914         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   915         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   916         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   917         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   918         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   919         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   920         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   921         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   922         16  WS-ACCOUNT-NAME              PIC X(30).
   923         16  FILLER                       PIC X.
   924         16  WS-REFERENCE                 PIC X(12).
   925         16  FILLER                       PIC X(197).
   926
   927     12  WS-BATCH-TOTALS.
   928         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   929         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   930         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   931         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   932         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   933         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   934         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   935         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   936         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   937         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   938         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   939         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   940         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   941         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   942         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   943         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   945         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   946         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   947
   948     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   949
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  19
* EL6311.cbl
   951
   952******************************************************************
   953*                                                                *
   954*                E R R O R   M E S S A G E S                     *
   955*                                                                *
   956******************************************************************
   957
   958 01  ERROR-MESSAGES.
   959     12  ER-0004                 PIC  9(4) VALUE 0004.
   960     12  ER-0008                 PIC  9(4) VALUE 0008.
   961     12  ER-0023                 PIC  9(4) VALUE 0023.
   962     12  ER-0029                 PIC  9(4) VALUE 0029.
   963     12  ER-0033                 PIC  9(4) VALUE 0033.
   964     12  ER-0070                 PIC  9(4) VALUE 0070.
   965     12  ER-0220                 PIC  9(4) VALUE 0220.
   966     12  ER-0248                 PIC  9(4) VALUE 0248.
   967     12  ER-0280                 PIC  9(4) VALUE 0280.
   968     12  ER-0348                 PIC  9(4) VALUE 0348.
   969     12  ER-0582                 PIC  9(4) VALUE 0582.
   970     12  ER-0877                 PIC  9(4) VALUE 0877.
   971     12  ER-1236                 PIC  9(4) VALUE 1236.
   972     12  ER-1570                 PIC  9(4) VALUE 1570.
   973     12  ER-1575                 PIC  9(4) VALUE 1575.
   974     12  ER-1577                 PIC  9(4) VALUE 1577.
   975     12  ER-1584                 PIC  9(4) VALUE 1584.
   976     12  ER-1585                 PIC  9(4) VALUE 1585.
   977     12  ER-1609                 PIC  9(4) VALUE 1609.
   978     12  er-1762                 pic  9(4) value 1762.
   979     12  ER-1819                 PIC  9(4) VALUE 1819.
   980     12  ER-2077                 PIC  9(4) VALUE 2077.
   981     12  ER-2129                 PIC  9(4) VALUE 2129.
   982     12  ER-2188                 PIC  9(4) VALUE 2188.
   983     12  ER-2192                 PIC  9(4) VALUE 2192.
   984     12  ER-2196                 PIC  9(4) VALUE 2196.
   985     12  ER-2197                 PIC  9(4) VALUE 2197.
   986     12  ER-2198                 PIC  9(4) VALUE 2198.
   987     12  ER-2200                 PIC  9(4) VALUE 2200.
   988     12  ER-2212                 PIC  9(4) VALUE 2212.
   989     12  ER-2218                 PIC  9(4) VALUE 2218.
   990     12  ER-2220                 PIC  9(4) VALUE 2220.
   991     12  ER-2222                 PIC  9(4) VALUE 2222.
   992     12  ER-2223                 PIC  9(4) VALUE 2223.
   993     12  ER-2224                 PIC  9(4) VALUE 2224.
   994     12  ER-2225                 PIC  9(4) VALUE 2225.
   995     12  ER-2226                 PIC  9(4) VALUE 2226.
   996     12  ER-2227                 PIC  9(4) VALUE 2227.
   997     12  ER-2228                 PIC  9(4) VALUE 2228.
   998     12  ER-2240                 PIC  9(4) VALUE 2240.
   999     12  ER-2241                 PIC  9(4) VALUE 2241.
  1000     12  ER-2242                 PIC  9(4) VALUE 2242.
  1001     12  ER-2243                 PIC  9(4) VALUE 2243.
  1002     12  ER-2244                 PIC  9(4) VALUE 2244.
  1003     12  ER-2245                 PIC  9(4) VALUE 2245.
  1004     12  ER-2246                 PIC  9(4) VALUE 2246.
  1005     12  ER-2247                 PIC  9(4) VALUE 2247.
  1006     12  ER-2251                 PIC  9(4) VALUE 2251.
  1007     12  ER-2252                 PIC  9(4) VALUE 2252.
  1008     12  ER-2253                 PIC  9(4) VALUE 2253.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  20
* EL6311.cbl
  1009     12  ER-2254                 PIC  9(4) VALUE 2254.
  1010     12  ER-2255                 PIC  9(4) VALUE 2255.
  1011     12  ER-2256                 PIC  9(4) VALUE 2256.
  1012     12  ER-2257                 PIC  9(4) VALUE 2257.
  1013     12  ER-2258                 PIC  9(4) VALUE 2258.
  1014     12  ER-2259                 PIC  9(4) VALUE 2259.
  1015     12  ER-2260                 PIC  9(4) VALUE 2260.
  1016     12  ER-2261                 PIC  9(4) VALUE 2261.
  1017     12  ER-2287                 PIC  9(4) VALUE 2287.
  1018     12  ER-2336                 PIC  9(4) VALUE 2336.
  1019     12  ER-2337                 PIC  9(4) VALUE 2337.
  1020     12  ER-2437                 PIC  9(4) VALUE 2437.
  1021     12  ER-2471                 PIC  9(4) VALUE 2471.
  1022     12  ER-2530                 PIC  9(4) VALUE 2530.
  1023     12  ER-2531                 PIC  9(4) VALUE 2531.
  1024     12  ER-2532                 PIC  9(4) VALUE 2532.
  1025     12  ER-2533                 PIC  9(4) VALUE 2533.
  1026     12  ER-2547                 PIC  9(4) VALUE 2547.
  1027     12  ER-2591                 PIC  9(4) VALUE 2591.
  1028     12  ER-2592                 PIC  9(4) VALUE 2592.
  1029     12  ER-2593                 PIC  9(4) VALUE 2593.
  1030     12  ER-2600                 PIC  9(4) VALUE 2600.
  1031     12  ER-2601                 PIC  9(4) VALUE 2601.
  1032     12  ER-2604                 PIC  9(4) VALUE 2604.
  1033     12  ER-2605                 PIC  9(4) VALUE 2605.
  1034     12  ER-2606                 PIC  9(4) VALUE 2606.
  1035     12  ER-2607                 PIC  9(4) VALUE 2607.
  1036     12  ER-2622                 PIC  9(4) VALUE 2622.
  1037     12  ER-2625                 PIC  9(4) VALUE 2625.
  1038     12  ER-2626                 PIC  9(4) VALUE 2626.
  1039     12  ER-2627                 PIC  9(4) VALUE 2627.
  1040     12  ER-2628                 PIC  9(4) VALUE 2628.
  1041     12  ER-2629                 PIC  9(4) VALUE 2629.
  1042     12  ER-2630                 PIC  9(4) VALUE 2630.
  1043     12  ER-2631                 PIC  9(4) VALUE 2631.
  1044     12  ER-2632                 PIC  9(4) VALUE 2632.
  1045     12  ER-2633                 PIC  9(4) VALUE 2633.
  1046     12  ER-2634                 PIC  9(4) VALUE 2634.
  1047     12  ER-2635                 PIC  9(4) VALUE 2635.
  1048     12  ER-2636                 PIC  9(4) VALUE 2636.
  1049     12  ER-2639                 PIC  9(4) VALUE 2639.
  1050     12  ER-2640                 PIC  9(4) VALUE 2640.
  1051     12  ER-2647                 PIC  9(4) VALUE 2647.
  1052     12  ER-2648                 PIC  9(4) VALUE 2648.
  1053     12  ER-2649                 PIC  9(4) VALUE 2649.
  1054     12  ER-2650                 PIC  9(4) VALUE 2650.
  1055     12  ER-2651                 PIC  9(4) VALUE 2651.
  1056     12  ER-2653                 PIC  9(4) VALUE 2653.
  1057     12  ER-2654                 PIC  9(4) VALUE 2654.
  1058     12  ER-2655                 PIC  9(4) VALUE 2655.
  1059     12  ER-2656                 PIC  9(4) VALUE 2656.
  1060     12  ER-2657                 PIC  9(4) VALUE 2657.
  1061     12  ER-2660                 PIC  9(4) VALUE 2660.
  1062     12  ER-2661                 PIC  9(4) VALUE 2661.
  1063     12  ER-2662                 PIC  9(4) VALUE 2662.
  1064     12  ER-2663                 PIC  9(4) VALUE 2663.
  1065     12  ER-2664                 PIC  9(4) VALUE 2664.
  1066     12  ER-2667                 PIC  9(4) VALUE 2667.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  21
* EL6311.cbl
  1067     12  ER-2668                 PIC  9(4) VALUE 2668.
  1068     12  ER-2669                 PIC  9(4) VALUE 2669.
  1069     12  ER-2670                 PIC  9(4) VALUE 2670.
  1070     12  ER-2671                 PIC  9(4) VALUE 2671.
  1071     12  ER-2672                 PIC  9(4) VALUE 2672.
  1072     12  ER-2673                 PIC  9(4) VALUE 2673.
  1073     12  ER-2677                 PIC  9(4) VALUE 2677.
  1074     12  ER-2678                 PIC  9(4) VALUE 2678.
  1075     12  ER-2679                 PIC  9(4) VALUE 2679.
  1076     12  ER-2680                 PIC  9(4) VALUE 2680.
  1077     12  ER-2681                 PIC  9(4) VALUE 2681.
  1078     12  ER-2682                 PIC  9(4) VALUE 2682.
  1079     12  ER-2683                 PIC  9(4) VALUE 2683.
  1080     12  ER-2684                 PIC  9(4) VALUE 2684.
  1081     12  ER-2686                 PIC  9(4) VALUE 2686.
  1082     12  ER-2689                 PIC  9(4) VALUE 2689.
  1083     12  ER-2690                 PIC  9(4) VALUE 2690.
  1084     12  ER-2693                 PIC  9(4) VALUE 2693.
  1085     12  ER-2695                 PIC  9(4) VALUE 2695.
  1086     12  ER-2701                 PIC  9(4) VALUE 2701.
  1087     12  ER-2720                 PIC  9(4) VALUE 2720.
  1088     12  ER-2709                 PIC  9(4) VALUE 2709.
  1089     12  ER-2704                 PIC  9(4) VALUE 2704.
  1090     12  ER-2725                 PIC  9(4) VALUE 2725.
  1091     12  ER-2726                 PIC  9(4) VALUE 2726.
  1092     12  ER-2728                 PIC  9(4) VALUE 2728.
  1093     12  ER-2729                 PIC  9(4) VALUE 2729.
  1094     12  ER-2731                 PIC  9(4) VALUE 2731.
  1095     12  ER-2732                 PIC  9(4) VALUE 2732.
  1096     12  ER-2733                 PIC  9(4) VALUE 2733.
  1097     12  ER-2735                 PIC  9(4) VALUE 2735.
  1098     12  ER-2738                 PIC  9(4) VALUE 2738.
  1099     12  ER-2742                 PIC  9(4) VALUE 2742.
  1100     12  ER-2743                 PIC  9(4) VALUE 2743.
  1101     12  ER-2744                 PIC  9(4) VALUE 2744.
  1102     12  ER-2747                 PIC  9(4) VALUE 2747.
  1103     12  ER-2749                 PIC  9(4) VALUE 2749.
  1104     12  ER-2753                 PIC  9(4) VALUE 2753.
  1105     12  ER-2755                 PIC  9(4) VALUE 2755.
  1106     12  ER-2757                 PIC  9(4) VALUE 2757.
  1107     12  ER-2771                 PIC  9(4) VALUE 2771.
  1108     12  ER-2774                 PIC  9(4) VALUE 2774.
  1109     12  ER-2775                 PIC  9(4) VALUE 2775.
  1110     12  ER-2776                 PIC  9(4) VALUE 2776.
  1111     12  ER-2777                 PIC  9(4) VALUE 2777.
  1112     12  ER-2794                 PIC  9(4) VALUE 2794.
  1113     12  ER-2799                 PIC  9(4) VALUE 2799.
  1114     12  ER-2900                 PIC  9(4) VALUE 2900.
  1115     12  ER-2902                 PIC  9(4) VALUE 2902.
  1116     12  ER-2945                 PIC  9(4) VALUE 2945.
  1117     12  ER-3000                 PIC  9(4) VALUE 3000.
  1118     12  ER-3006                 PIC  9(4) VALUE 3006.
  1119     12  ER-3054                 PIC  9(4) VALUE 3054.
  1120     12  er-3070                 pic  9(4) value 3070.
  1121     12  ER-3224                 PIC  9(4) VALUE 3224.
  1122     12  ER-3269                 PIC  9(4) VALUE 3269.
  1123     12  er-3444                 pic  9(4) value 3444.
  1124     12  er-3446                 pic  9(4) value 3446.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  22
* EL6311.cbl
  1125     12  er-3447                 pic  9(4) value 3447.
  1126     12  er-3448                 pic  9(4) value 3448.
  1127     12  er-3449                 pic  9(4) value 3449.
  1128     12  ER-3456                 PIC  9(4) VALUE 3456.
  1129     12  ER-3457                 PIC  9(4) VALUE 3457.
  1130     12  ER-3458                 PIC  9(4) VALUE 3458.
  1131     12  ER-3504                 PIC  9(4) VALUE 3504.
  1132     12  ER-3513                 PIC  9(4) VALUE 3513.
  1133     12  ER-3831                 PIC  9(4) VALUE 3831.
  1134     12  ER-3834                 PIC  9(4) VALUE 3834.
  1135     12  ER-3835                 PIC  9(4) VALUE 3835.
  1136     12  ER-4005                 PIC  9(4) VALUE 4005.
  1137     12  ER-7144                 PIC  9(4) VALUE 7144.
  1138     12  ER-7401                 PIC  9(4) VALUE 7401.
  1139     12  ER-7402                 PIC  9(4) VALUE 7402.
  1140     12  ER-7403                 PIC  9(4) VALUE 7403.
  1141     12  ER-7404                 PIC  9(4) VALUE 7404.
  1142     12  ER-7423                 PIC  9(4) VALUE 7423.
  1143     12  ER-7424                 PIC  9(4) VALUE 7424.
  1144     12  ER-7433                 PIC  9(4) VALUE 7433.
  1145     12  ER-7450                 PIC  9(4) VALUE 7450.
  1146     12  ER-7451                 PIC  9(4) VALUE 7451.
  1147     12  ER-7530                 PIC  9(4) VALUE 7530.
  1148     12  ER-7573                 PIC  9(4) VALUE 7573.
  1149     12  ER-7631                 PIC  9(4) VALUE 7631.
  1150     12  ER-7632                 PIC  9(4) VALUE 7632.
  1151     12  ER-7633                 PIC  9(4) VALUE 7633.
  1152     12  ER-7537                 PIC  9(4) VALUE 7537.
  1153     12  ER-7538                 PIC  9(4) VALUE 7538.
  1154     12  ER-7574                 PIC  9(4) VALUE 7574.
  1155     12  ER-7997                 PIC  9(4) VALUE 7997.
  1156     12  ER-7998                 PIC  9(4) VALUE 7998.
  1157     12  ER-8148                 PIC  9(4) VALUE 8148.
  1158     12  ER-9063                 PIC  9(4) VALUE 9063.
  1159     12  ER-9076                 PIC  9(4) VALUE 9076.
  1160     12  ER-9618                 PIC  9(4) VALUE 9618.
  1161     12  ER-9841                 PIC  9(4) VALUE 9841.
  1162
  1163*                                COPY ELCTEXT.
  1164******************************************************************
  1165*                                                                *
  1166*                                                                *
  1167*                            ELCTEXT.                            *
  1168*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1169*                            VMOD=2.008                          *
  1170*                                                                *
  1171*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1172*                                     FORM LETTERS,              *
  1173*                                     CERT FORM DISPLAY.
  1174*                                                                *
  1175*   FILE TYPE = VSAM,KSDS                                        *
  1176*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1177*                                                                *
  1178*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1179*       ALTERNATE INDEX = NONE                                   *
  1180*                                                                *
  1181*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1182*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  23
* EL6311.cbl
  1183*                                                                *
  1184*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1185*       ALTERNATE INDEX = NONE                                   *
  1186*                                                                *
  1187*   LOG = NO                                                     *
  1188*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1189******************************************************************
  1190 01  TEXT-FILES.
  1191     12  TEXT-FILE-ID                PIC XX.
  1192         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1193         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1194         88  HELP-FILE-TEXT             VALUE 'TH'.
  1195
  1196     12  TX-CONTROL-PRIMARY.
  1197         16  TX-COMPANY-CD           PIC X.
  1198             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1199         16  TX-ACCESS-CD-GENL       PIC X(12).
  1200
  1201         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1202             20  TX-LETTER-NO        PIC X(4).
  1203             20  FILLER              PIC X(8).
  1204
  1205         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1206             20  TX-FORM-NO          PIC X(12).
  1207
  1208         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1209             20  TX-HELP-TYPE        PIC X.
  1210                 88  HELP-FOR-GENERAL   VALUE ' '.
  1211                 88  HELP-BY-SCREEN     VALUE 'S'.
  1212                 88  HELP-BY-ERROR      VALUE 'E'.
  1213             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1214                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1215             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1216                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1217             20  FILLER              PIC X(4).
  1218
  1219         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1220
  1221     12  TX-PROCESS-CONTROL          PIC XX.
  1222         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1223
  1224     12  TX-TEXT-LINE                PIC X(70).
  1225
  1226     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1227         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1228         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1229         88  TX-VALID-FORM-SQUEEZE-VALUE
  1230                                        VALUE 'Y' ' '.
  1231
  1232     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1233         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1234         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1235         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1236         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1237         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1238         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1239         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1240                                              'K' 'N' ' '
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  24
* EL6311.cbl
  1241                                              'Z'.
  1242
  1243     12  TX-ARCHIVE-SW               PIC X.
  1244         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1245         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1246         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1247
  1248     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1249     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1250
  1251     12  TX-BSR-CODE                 PIC X.
  1252         88  TX-BSR-LETTER              VALUE 'B'.
  1253         88  TX-NON-BSR-LETTER          VALUE ' '.
  1254
  1255     12  FILLER                      PIC X.
  1256*****************************************************************
  1257*                                COPY ELCCRTO.
  1258******************************************************************
  1259*                                                                *
  1260*                            ELCCRTO.                            *
  1261*                                                                *
  1262*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1263*                                                                *
  1264*   FILE TYPE = VSAM,KSDS                                        *
  1265*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1266*                                                                *
  1267*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1268*                                                                *
  1269*   LOG = YES                                                    *
  1270*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1271******************************************************************
  1272*                   C H A N G E   L O G
  1273*
  1274* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1275*-----------------------------------------------------------------
  1276*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1277* EFFECTIVE    NUMBER
  1278*-----------------------------------------------------------------
  1279* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1280* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1281* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1282* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1283* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1284******************************************************************
  1285 01  ORIGINAL-CERTIFICATE.
  1286     12  OC-RECORD-ID                      PIC XX.
  1287         88  VALID-OC-ID                      VALUE 'OC'.
  1288     12  OC-CONTROL-PRIMARY.
  1289         16  OC-COMPANY-CD                 PIC X.
  1290         16  OC-CARRIER                    PIC X.
  1291         16  OC-GROUPING                   PIC X(6).
  1292         16  OC-STATE                      PIC XX.
  1293         16  OC-ACCOUNT                    PIC X(10).
  1294         16  OC-CERT-EFF-DT                PIC XX.
  1295         16  OC-CERT-NO.
  1296             20  OC-CERT-PRIME             PIC X(10).
  1297             20  OC-CERT-SFX               PIC X.
  1298         16  OC-RECORD-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  25
* EL6311.cbl
  1299         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1300     12  OC-LAST-MAINT-DT                  PIC XX.
  1301     12  OC-LAST-MAINT-BY                  PIC X(4).
  1302     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1303     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1304     12  FILLER                            PIC X(49).
  1305     12  OC-ORIG-REC.
  1306         16  OC-INS-LAST-NAME              PIC X(15).
  1307         16  OC-INS-FIRST-NAME             PIC X(10).
  1308         16  OC-INS-MIDDLE-INIT            PIC X.
  1309         16  OC-INS-AGE                    PIC S999     COMP-3.
  1310         16  OC-JNT-LAST-NAME              PIC X(15).
  1311         16  OC-JNT-FIRST-NAME             PIC X(10).
  1312         16  OC-JNT-MIDDLE-INIT            PIC X.
  1313         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1314         16  OC-LF-BENCD                   PIC XX.
  1315         16  OC-LF-TERM                    PIC S999      COMP-3.
  1316         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1317         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1318         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1319         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1320         16  OC-LF-EXP-DT                  PIC XX.
  1321         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1322         16  OC-LF-CANCEL-DT               PIC XX.
  1323         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1324         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1325         16  OC-AH-BENCD                   PIC XX.
  1326         16  OC-AH-TERM                    PIC S999      COMP-3.
  1327         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1328         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1329         16  OC-AH-EXP-DT                  PIC XX.
  1330         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1331         16  OC-AH-CP                      PIC 99.
  1332         16  OC-AH-CANCEL-DT               PIC XX.
  1333         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1334         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1335         16  OC-CRED-BENE-NAME             PIC X(25).
  1336         16  OC-1ST-PMT-DT                 PIC XX.
  1337         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1338         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1339         16  OC-ISSUE-TRAN-IND             PIC X.
  1340         16  OC-CANCEL-TRAN-IND            PIC X.
  1341         16  FILLER                        PIC X(211).
  1342
  1343     12  FILLER                            PIC X(50).
  1344******************************************************************
  1345*                                COPY ERCACCT.
  1346******************************************************************
  1347*                                                                *
  1348*                                                                *
  1349*                            ERCACCT                             *
  1350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1351*                            VMOD=2.031                          *
  1352*                                                                *
  1353*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1354*                                                                *
  1355*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1356*   VSAM ACCOUNT MASTER FILES.                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  26
* EL6311.cbl
  1357*                                                                *
  1358*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1359*                                                                *
  1360*   FILE TYPE = VSAM,KSDS                                        *
  1361*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1362*                                                                *
  1363*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1364*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1365*                                                                *
  1366*   LOG = NO                                                     *
  1367*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1368*                                                                *
  1369*                                                                *
  1370******************************************************************
  1371*                   C H A N G E   L O G
  1372*
  1373* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1374*-----------------------------------------------------------------
  1375*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1376* EFFECTIVE    NUMBER
  1377*-----------------------------------------------------------------
  1378* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1379* 092705    2005050300006  PEMA  ADD SPP LEASES
  1380* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1381* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1382* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1383* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1384* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1385* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1386******************************************************************
  1387
  1388 01  ACCOUNT-MASTER.
  1389     12  AM-RECORD-ID                      PIC XX.
  1390         88  VALID-AM-ID                      VALUE 'AM'.
  1391
  1392     12  AM-CONTROL-PRIMARY.
  1393         16  AM-COMPANY-CD                 PIC X.
  1394         16  AM-MSTR-CNTRL.
  1395             20  AM-CONTROL-A.
  1396                 24  AM-CARRIER            PIC X.
  1397                 24  AM-GROUPING.
  1398                     28 AM-GROUPING-PREFIX PIC XXX.
  1399                     28 AM-GROUPING-PRIME  PIC XXX.
  1400                 24  AM-STATE              PIC XX.
  1401                 24  AM-ACCOUNT.
  1402                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1403                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1404             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1405                                           PIC X(19).
  1406             20  AM-CNTRL-B.
  1407                 24  AM-EXPIRATION-DT      PIC XX.
  1408                 24  FILLER                PIC X(4).
  1409             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1410                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1411
  1412     12  AM-CONTROL-BY-VAR-GRP.
  1413         16  AM-COMPANY-CD-A1              PIC X.
  1414         16  AM-VG-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  27
* EL6311.cbl
  1415         16  AM-VG-GROUPING                PIC X(6).
  1416         16  AM-VG-STATE                   PIC XX.
  1417         16  AM-VG-ACCOUNT                 PIC X(10).
  1418         16  AM-VG-DATE.
  1419             20  AM-VG-EXPIRATION-DT       PIC XX.
  1420             20  FILLER                    PIC X(4).
  1421         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1422                                           PIC 9(11)      COMP-3.
  1423     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1424         16  FILLER                        PIC X(10).
  1425         16  AM-VG-KEY3.
  1426             20  AM-VG3-ACCOUNT            PIC X(10).
  1427             20  AM-VG3-EXP-DT             PIC XX.
  1428         16  FILLER                        PIC X(4).
  1429     12  AM-MAINT-INFORMATION.
  1430         16  AM-LAST-MAINT-DT              PIC XX.
  1431         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1432         16  AM-LAST-MAINT-USER            PIC X(4).
  1433         16  FILLER                        PIC XX.
  1434
  1435     12  AM-EFFECTIVE-DT                   PIC XX.
  1436     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1437
  1438     12  AM-PREV-DATES  COMP-3.
  1439         16  AM-PREV-EXP-DT                PIC 9(11).
  1440         16  AM-PREV-EFF-DT                PIC 9(11).
  1441
  1442     12  AM-REPORT-CODE-1                  PIC X(10).
  1443     12  AM-REPORT-CODE-2                  PIC X(10).
  1444
  1445     12  AM-CITY-CODE                      PIC X(4).
  1446     12  AM-COUNTY-PARISH                  PIC X(6).
  1447
  1448     12  AM-NAME                           PIC X(30).
  1449     12  AM-PERSON                         PIC X(30).
  1450     12  AM-ADDRS                          PIC X(30).
  1451     12  AM-CITY.
  1452         16  AM-ADDR-CITY                  PIC X(28).
  1453         16  AM-ADDR-STATE                 PIC XX.
  1454     12  AM-ZIP.
  1455         16  AM-ZIP-PRIME.
  1456             20  AM-ZIP-PRI-1ST            PIC X.
  1457                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1458             20  FILLER                    PIC X(4).
  1459         16  AM-ZIP-PLUS4                  PIC X(4).
  1460     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1461         16  AM-CAN-POSTAL-1               PIC XXX.
  1462         16  AM-CAN-POSTAL-2               PIC XXX.
  1463         16  FILLER                        PIC XXX.
  1464     12  AM-TEL-NO.
  1465         16  AM-AREA-CODE                  PIC 999.
  1466         16  AM-TEL-PRE                    PIC 999.
  1467         16  AM-TEL-NBR                    PIC 9(4).
  1468     12  AM-TEL-LOC                        PIC X.
  1469         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1470         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1471
  1472     12  AM-COMM-STRUCTURE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  28
* EL6311.cbl
  1473         16  AM-DEFN-1.
  1474             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1475                 24  AM-AGT.
  1476                     28  AM-AGT-PREFIX     PIC X(4).
  1477                     28  AM-AGT-PRIME      PIC X(6).
  1478                 24  AM-COM-TYP            PIC X.
  1479                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1480                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1481                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1482                 24  AM-RECALC-LV-INDIC    PIC X.
  1483                 24  AM-RETRO-LV-INDIC     PIC X.
  1484                 24  AM-GL-CODES           PIC X.
  1485                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1486                 24  FILLER                PIC X(01).
  1487         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1488             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1489                 24  FILLER                PIC X(11).
  1490                 24  AM-L-COMA             PIC XXX.
  1491                 24  AM-J-COMA             PIC XXX.
  1492                 24  AM-A-COMA             PIC XXX.
  1493                 24  FILLER                PIC X(6).
  1494
  1495     12  AM-COMM-CHANGE-STATUS             PIC X.
  1496         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1497
  1498     12  AM-CSR-CODE                       PIC X(4).
  1499
  1500     12  AM-BILLING-STATUS                 PIC X.
  1501         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1502         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1503     12  AM-AUTO-REFUND-SW                 PIC X.
  1504         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1505         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1506     12  AM-GPCD                           PIC 99.
  1507     12  AM-IG                             PIC X.
  1508         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1509         88  AM-HAS-GROUP                     VALUE '2'.
  1510     12  AM-STATUS                         PIC X.
  1511         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1512         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1513         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1514         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1515         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1516         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1517         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1518         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1519         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1520         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1521     12  AM-REMIT-TO                       PIC 99.
  1522     12  AM-ID-NO                          PIC X(11).
  1523
  1524     12  AM-CAL-TABLE                      PIC XX.
  1525     12  AM-LF-DEVIATION                   PIC XXX.
  1526     12  AM-AH-DEVIATION                   PIC XXX.
  1527     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1528     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1529     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1530     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  29
* EL6311.cbl
  1531     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1532     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1533
  1534     12  AM-USER-FIELDS.
  1535         16  AM-FLD-1                      PIC XX.
  1536         16  AM-FLD-2                      PIC XX.
  1537         16  AM-FLD-3                      PIC XX.
  1538         16  AM-FLD-4                      PIC XX.
  1539         16  AM-FLD-5                      PIC XX.
  1540
  1541     12  AM-1ST-PROD-DATE.
  1542         16  AM-1ST-PROD-YR                PIC XX.
  1543         16  AM-1ST-PROD-MO                PIC XX.
  1544         16  AM-1ST-PROD-DA                PIC XX.
  1545     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1546     12  AM-CERTS-PURGED-DATE.
  1547         16  AM-PUR-YR                     PIC XX.
  1548         16  AM-PUR-MO                     PIC XX.
  1549         16  AM-PUR-DA                     PIC XX.
  1550     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1551     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1552     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1553     12  AM-INACTIVE-DATE.
  1554         16  AM-INA-MO                     PIC 99.
  1555         16  AM-INA-DA                     PIC 99.
  1556         16  AM-INA-YR                     PIC 99.
  1557     12  AM-AR-HI-CERT-DATE                PIC XX.
  1558
  1559     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1560     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1561
  1562     12  AM-OB-PAYMENT-MODE                PIC X.
  1563         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1564         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1565         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1566         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1567
  1568     12  AM-AH-ONLY-INDICATOR              PIC X.
  1569         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1570         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1571
  1572     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1573
  1574     12  AM-OVER-SHORT.
  1575         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1576         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1577
  1578     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1579     12  AM-DCC-CLP-STATE                  PIC XX.
  1580
  1581     12  AM-RECALC-COMM                    PIC X.
  1582     12  AM-RECALC-REIN                    PIC X.
  1583
  1584     12  AM-REI-TABLE                      PIC XXX.
  1585     12  AM-REI-ET-LF                      PIC X.
  1586     12  AM-REI-ET-AH                      PIC X.
  1587     12  AM-REI-PE-LF                      PIC X.
  1588     12  AM-REI-PE-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  30
* EL6311.cbl
  1589     12  AM-REI-PRT-ST                     PIC X.
  1590     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1591     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1592     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1593     12  AM-REI-GROUP-A                    PIC X(6).
  1594     12  AM-REI-MORT                       PIC X(4).
  1595     12  AM-REI-PRT-OW                     PIC X.
  1596     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1597     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1598     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1599     12  AM-REI-GROUP-B                    PIC X(6).
  1600
  1601     12  AM-TRUST-TYPE                     PIC X(2).
  1602
  1603     12  AM-EMPLOYER-STMT-USED             PIC X.
  1604     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1605
  1606     12  AM-STD-AH-TYPE                    PIC XX.
  1607     12  AM-EARN-METHODS.
  1608         16  AM-EARN-METHOD-R              PIC X.
  1609             88 AM-REF-RL-R78                 VALUE 'R'.
  1610             88 AM-REF-RL-PR                  VALUE 'P'.
  1611             88 AM-REF-RL-MEAN                VALUE 'M'.
  1612             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1613         16  AM-EARN-METHOD-L              PIC X.
  1614             88 AM-REF-LL-R78                 VALUE 'R'.
  1615             88 AM-REF-LL-PR                  VALUE 'P'.
  1616             88 AM-REF-LL-MEAN                VALUE 'M'.
  1617             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1618         16  AM-EARN-METHOD-A              PIC X.
  1619             88 AM-REF-AH-R78                 VALUE 'R'.
  1620             88 AM-REF-AH-PR                  VALUE 'P'.
  1621             88 AM-REF-AH-MEAN                VALUE 'M'.
  1622             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1623             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1624             88 AM-REF-AH-NET                 VALUE 'N'.
  1625
  1626     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1627     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1628     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1629
  1630     12  AM-RET-Y-N                        PIC X.
  1631     12  AM-RET-P-E                        PIC X.
  1632     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1633     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1634     12  AM-RET-GRP                        PIC X(6).
  1635     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1636         16  AM-POOL-PRIME                 PIC XXX.
  1637         16  AM-POOL-SUB                   PIC XXX.
  1638     12  AM-RETRO-EARNINGS.
  1639         16  AM-RET-EARN-R                 PIC X.
  1640         16  AM-RET-EARN-L                 PIC X.
  1641         16  AM-RET-EARN-A                 PIC X.
  1642     12  AM-RET-ST-TAX-USE                 PIC X.
  1643         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1644         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1645     12  AM-RETRO-BEG-EARNINGS.
  1646         16  AM-RET-BEG-EARN-R             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  31
* EL6311.cbl
  1647         16  AM-RET-BEG-EARN-L             PIC X.
  1648         16  AM-RET-BEG-EARN-A             PIC X.
  1649     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1650     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1651
  1652     12  AM-USER-SELECT-OPTIONS.
  1653         16  AM-USER-SELECT-1              PIC X(10).
  1654         16  AM-USER-SELECT-2              PIC X(10).
  1655         16  AM-USER-SELECT-3              PIC X(10).
  1656         16  AM-USER-SELECT-4              PIC X(10).
  1657         16  AM-USER-SELECT-5              PIC X(10).
  1658
  1659     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1660
  1661     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1662
  1663     12  AM-RPT045A-SWITCH                 PIC X.
  1664         88  RPT045A-OFF                   VALUE 'N'.
  1665
  1666     12  AM-INSURANCE-LIMITS.
  1667         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1668         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1669
  1670     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1671         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1672
  1673     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1674         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1675         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1676
  1677     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1678
  1679     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1680     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1681     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1682     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1683     12  AM-DCC-UEF-STATE                  PIC XX.
  1684     12  FILLER                            PIC XXX.
  1685     12  AM-REPORT-CODE-3                  PIC X(10).
  1686*    12  FILLER                            PIC X(22).
  1687
  1688     12  AM-RESERVE-DATE.
  1689         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1690         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1691         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1692
  1693     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1694     12  AM-NOTIFICATION-TYPES.
  1695         16  AM-NOTIF-OF-LETTERS           PIC X.
  1696         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1697         16  AM-NOTIF-OF-REPORTS           PIC X.
  1698         16  AM-NOTIF-OF-STATUS            PIC X.
  1699
  1700     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1701         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1702         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1703         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1704         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  32
* EL6311.cbl
  1705
  1706     12  AM-BENEFIT-CONTROLS.
  1707         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1708             20  AM-BENEFIT-CODE           PIC XX.
  1709             20  AM-BENEFIT-TYPE           PIC X.
  1710             20  AM-BENEFIT-REVISION       PIC XXX.
  1711             20  AM-BENEFIT-REM-TERM       PIC X.
  1712             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1713             20  FILLER                    PIC XX.
  1714         16  FILLER                        PIC X(80).
  1715
  1716     12  AM-TRANSFER-DATA.
  1717         16  AM-TRANSFERRED-FROM.
  1718             20  AM-TRNFROM-CARRIER        PIC X.
  1719             20  AM-TRNFROM-GROUPING.
  1720                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1721                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1722             20  AM-TRNFROM-STATE          PIC XX.
  1723             20  AM-TRNFROM-ACCOUNT.
  1724                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1725                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1726             20  AM-TRNFROM-DTE            PIC XX.
  1727         16  AM-TRANSFERRED-TO.
  1728             20  AM-TRNTO-CARRIER          PIC X.
  1729             20  AM-TRNTO-GROUPING.
  1730                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1731                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1732             20  AM-TRNTO-STATE            PIC XX.
  1733             20  AM-TRNTO-ACCOUNT.
  1734                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1735                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1736             20  AM-TRNTO-DTE              PIC XX.
  1737         16  FILLER                        PIC X(10).
  1738
  1739     12  AM-SAVED-REMIT-TO                 PIC 99.
  1740
  1741     12  AM-COMM-STRUCTURE-SAVED.
  1742         16  AM-DEFN-1-SAVED.
  1743             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1744                 24  AM-AGT-SV             PIC X(10).
  1745                 24  AM-COM-TYP-SV         PIC X.
  1746                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1747                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1748                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1749                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1750                 24  FILLER                PIC X.
  1751                 24  AM-GL-CODES-SV        PIC X.
  1752                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1753                 24  FILLER                PIC X.
  1754         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1755             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1756                 24  FILLER                PIC X(11).
  1757                 24  AM-L-COMA-SV          PIC XXX.
  1758                 24  AM-J-COMA-SV          PIC XXX.
  1759                 24  AM-A-COMA-SV          PIC XXX.
  1760                 24  FILLER                PIC X(6).
  1761
  1762     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  33
* EL6311.cbl
  1763         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1764            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1765            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1766            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1767
  1768     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1769     12  FILLER                            PIC X(120).
  1770
  1771     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1772         16  AM-CONTROL-NAME               PIC X(30).
  1773         16  AM-EXECUTIVE-ONE.
  1774             20  AM-EXEC1-NAME             PIC X(15).
  1775             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1776                                                          COMP-3.
  1777             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1778                                                          COMP-3.
  1779         16  AM-EXECUTIVE-TWO.
  1780             20  AM-EXEC2-NAME             PIC X(15).
  1781             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1782                                                          COMP-3.
  1783             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1784                                                          COMP-3.
  1785
  1786     12  AM-RETRO-ADDITIONAL-DATA.
  1787         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1788         16  AM-RETRO-PREM-P-E             PIC X.
  1789         16  AM-RETRO-CLMS-P-I             PIC X.
  1790         16  AM-RETRO-RET-BRACKET-LF.
  1791             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1792                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1793                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1794             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1795                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1796                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1797             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1798                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1799                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1800         16  AM-RETRO-RET-BRACKET-AH.
  1801             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1802                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1803                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1804                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1805             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1806                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1807                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1808             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1809                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1810                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1811
  1812     12  AM-COMMENTS.
  1813         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1814
  1815     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1816         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1817         16  AM-FLI-BILLING-CODE           PIC X.
  1818         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1819         16  AM-FLI-UNITED-IDENT           PIC X.
  1820         16  AM-FLI-INTEREST-LOST-DATA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  34
* EL6311.cbl
  1821             20  AM-FLI-BANK-NO            PIC X(5).
  1822             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1823             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1824             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1825         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1826             20  AM-FLI-AGT                PIC X(9).
  1827             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1828             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1829         16  FILLER                        PIC X(102).
  1830
  1831     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1832         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1833             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1834             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1835             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1836             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1837             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1838         16  FILLER                          PIC X(10).
  1839******************************************************************
  1840*                                copy ERCACNT.
  1841******************************************************************
  1842*                                                                *
  1843*                                                                *
  1844*                            ERCACNT.                            *
  1845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1846*                            VMOD=2.002                          *
  1847*                                                                *
  1848*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1849*                                                                *
  1850*   FILE TYPE = VSAM,KSDS                                        *
  1851*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1852*                                                                *
  1853*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1854*       ALTERNATE INDEX = NONE                                   *
  1855*                                                                *
  1856*                                                                *
  1857*   LOG = YES                                                    *
  1858*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1859******************************************************************
  1860*                   C H A N G E   L O G
  1861*
  1862* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1863*-----------------------------------------------------------------
  1864*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1865* EFFECTIVE    NUMBER
  1866*-----------------------------------------------------------------
  1867* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1868*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1869******************************************************************
  1870 01  NOTE-FILE.
  1871     12  NT-FILE-ID                  PIC XX.
  1872         88  VALID-NOTE-ID              VALUE 'NT'.
  1873
  1874     12  NT-CONTROL-PRIMARY.
  1875         16  NT-COMPANY-CD           PIC X.
  1876         16  NT-ACCT-NOTE-KEY.
  1877             18  NT-CARRIER              PIC X.
  1878             18  NT-GROUPING             PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  35
* EL6311.cbl
  1879             18  NT-STATE                PIC XX.
  1880             18  NT-ACCOUNT              PIC X(10).
  1881         16  NT-RECORD-TYPE          PIC X.
  1882              88  ACCT-NOTE          VALUE '1'.
  1883              88  ACCT-BRANCH-LOC    VALUE '2'.
  1884              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1885         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1886
  1887     12  NT-LAST-MAINT-DT            PIC XX.
  1888     12  NT-LAST-MAINT-BY            PIC X(4).
  1889     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1890
  1891*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1892*     SEQUENCE NUMBERS
  1893     12  NT-NOTE-INFORMATION.
  1894         16  NT-NOTE-LINE            PIC X(60).
  1895         16  FILLER                  PIC X(25).
  1896*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1897     12  NT-LOCATION-INFORMATION REDEFINES
  1898                         NT-NOTE-INFORMATION.
  1899         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1900         16  FILLER                  PIC X(25).
  1901* Account special indicator is record type '2', sequence 3
  1902     12  filler REDEFINES NT-NOTE-INFORMATION.
  1903         16  nt-account-special      PIC X.
  1904         16  FILLER                  PIC X(84).
  1905*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1906*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1907*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1908*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1909*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1910*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1911*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1912     12  NT-SHIPPING-INFORMATION REDEFINES
  1913                         NT-NOTE-INFORMATION.
  1914         16  NT-SHIPPING-LINE        PIC X(60).
  1915         16  NT-SHIP-STATE           PIC XX.
  1916         16  NT-SHIP-ZIP             PIC X(10).
  1917         16  FILLER                  PIC X(13).
  1918*****************************************************************
  1919*                                COPY ELCVADS.
  1920******************************************************************
  1921*                                                                *
  1922*                                                                *
  1923*                            ELCVADS.                            *
  1924*                                                                *
  1925*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1926*   ELVADS                  LENGTH = 350                         *
  1927******************************************************************
  1928******************************************************************
  1929*                   C H A N G E   L O G
  1930*
  1931* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1932*-----------------------------------------------------------------
  1933*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1934* EFFECTIVE    NUMBER
  1935*-----------------------------------------------------------------
  1936* 100111    2011022800001  AJRA  NAPERSOFT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  36
* EL6311.cbl
  1937******************************************************************
  1938
  1939 01  VIRGINIA-DISCLOSURE.
  1940     12  VD-COMPANY-CD              PIC X.
  1941     12  VD-CARRIER                 PIC X.
  1942     12  VD-GROUPING.
  1943         20  VD-GROUPING-PREFIX     PIC XXX.
  1944         20  VD-GROUPING-PRIME      PIC XXX.
  1945     12  VD-STATE                   PIC XX.
  1946     12  VD-ACCOUNT.
  1947         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1948         20  VD-ACCOUNT-PRIME       PIC X(6).
  1949     12  VD-CERT-EFF-DT             PIC XX.
  1950     12  VD-CERT-NO.
  1951         20  VD-CERT-PRIME          PIC X(10).
  1952         20  VD-CERT-SFX            PIC X.
  1953     12  VD-ENTRY-BATCH             PIC X(6).
  1954     12  VD-CSR-ID                  PIC X(4).
  1955     12  VD-NAME.
  1956         20  VD-INSURED-LAST-NAME   PIC X(15).
  1957         20  VD-INSURED-FIRST-NAME.
  1958             24  VD-INSURED-1ST-INIT PIC X.
  1959             24  FILLER             PIC X(9).
  1960         20  VD-INSURED-MIDDLE-INIT PIC X.
  1961     12  VD-JOINT-INSURED.
  1962         20 VD-JOINT-LAST-NAME      PIC X(15).
  1963         20 VD-JOINT-FIRST-NAME.
  1964            24  VD-JOINT-FIRST-INIT PIC X.
  1965            24  FILLER              PIC X(9).
  1966         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1967     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1968     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1969     12  VD-INSURED-CITY-STATE.
  1970         20  VD-INSURED-CITY        PIC X(28).
  1971         20  VD-INSURED-STATE       PIC XX.
  1972     12  VD-INSURED-ZIP-CODE.
  1973         20  VD-INSURED-ZIP-PRIME.
  1974             24  VD-INSURED-ZIP-1   PIC X.
  1975                 88  VD-CANADIAN-POST-CODE
  1976                                       VALUE 'A' THRU 'Z'.
  1977             24  FILLER             PIC X(4).
  1978         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1979     12  VD-BENEFICIARY-NAME        PIC X(30).
  1980     12  VD-ACCOUNT-NAME            PIC X(30).
  1981     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1982     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1983     12  VD-1ST-PMT-DT              PIC XX.
  1984     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1985         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1986         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1987                                             '90' THRU '99'.
  1988     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1989                                    PIC XX.
  1990     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1991     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1992     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1993     12  VD-LF-TERM                 PIC S999   COMP-3.
  1994     12  VD-AH-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  37
* EL6311.cbl
  1995         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1996         88  VD-INVALID-AH             VALUE '  ' '00'
  1997                                             '90' THRU '99'.
  1998     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1999     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2000     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2001     12  VD-AH-TERM                 PIC S999   COMP-3.
  2002     12  VD-LETTER-ID               PIC X(4).
  2003     12  VD-PROC-ID                 PIC X(4).
  2004     12  VD-COMP-ID                 PIC X(3).
  2005     12  VD-CURRENT-DATE            PIC XX.
  2006     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2007     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2008     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  38
* EL6311.cbl
  2010*    COPY ELCDATE.
  2011******************************************************************
  2012*                                                                *
  2013*                                                                *
  2014*                            ELCDATE.                            *
  2015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2016*                            VMOD=2.003
  2017*                                                                *
  2018*                                                                *
  2019*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2020*                 LENGTH = 200                                   *
  2021******************************************************************
  2022
  2023 01  DATE-CONVERSION-DATA.
  2024     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2025     12  DC-OPTION-CODE                PIC X.
  2026         88  BIN-TO-GREG                VALUE ' '.
  2027         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2028         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2029         88  YMD-GREG-TO-BIN            VALUE '3'.
  2030         88  MDY-GREG-TO-BIN            VALUE '4'.
  2031         88  JULIAN-TO-BIN              VALUE '5'.
  2032         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2033         88  FIND-CENTURY               VALUE '7'.
  2034         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2035         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2036         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2037         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2038         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2039         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2040         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2041         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2042         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2043         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2044         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2045         88  BIN-3-TO-GREG              VALUE 'I'.
  2046         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2047         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2048         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2049         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2050         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2051         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2052         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2053         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2054         88  THREE-CHARACTER-BIN
  2055                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2056         88  GREGORIAN-TO-BIN
  2057                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2058         88  BIN-TO-GREGORIAN
  2059                  VALUES ' ' '1' 'I' '8' 'G'.
  2060         88  JULIAN-TO-BINARY
  2061                  VALUES '5' 'C' 'E' 'F'.
  2062     12  DC-ERROR-CODE                 PIC X.
  2063         88  NO-CONVERSION-ERROR        VALUE ' '.
  2064         88  DATE-CONVERSION-ERROR
  2065                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2066         88  DATE-IS-ZERO               VALUE '1'.
  2067         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  39
* EL6311.cbl
  2068         88  DATE-IS-INVALID            VALUE '3'.
  2069         88  DATE1-GREATER-DATE2        VALUE '4'.
  2070         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2071         88  DATE-INVALID-OPTION        VALUE '9'.
  2072         88  INVALID-CENTURY            VALUE 'A'.
  2073         88  ONLY-CENTURY               VALUE 'B'.
  2074         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2075         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2076     12  DC-END-OF-MONTH               PIC X.
  2077         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2078     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2079         88  USE-NORMAL-PROCESS         VALUE ' '.
  2080         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2081         88  ADJUST-UP-100-YRS          VALUE '2'.
  2082     12  FILLER                        PIC X.
  2083     12  DC-CONVERSION-DATES.
  2084         16  DC-BIN-DATE-1             PIC XX.
  2085         16  DC-BIN-DATE-2             PIC XX.
  2086         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2087         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2088                       DC-GREG-DATE-1-EDIT.
  2089             20  DC-EDIT1-MONTH        PIC 99.
  2090             20  SLASH1-1              PIC X.
  2091             20  DC-EDIT1-DAY          PIC 99.
  2092             20  SLASH1-2              PIC X.
  2093             20  DC-EDIT1-YEAR         PIC 99.
  2094         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2095         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2096                     DC-GREG-DATE-2-EDIT.
  2097             20  DC-EDIT2-MONTH        PIC 99.
  2098             20  SLASH2-1              PIC X.
  2099             20  DC-EDIT2-DAY          PIC 99.
  2100             20  SLASH2-2              PIC X.
  2101             20  DC-EDIT2-YEAR         PIC 99.
  2102         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2103         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2104                     DC-GREG-DATE-1-YMD.
  2105             20  DC-YMD-YEAR           PIC 99.
  2106             20  DC-YMD-MONTH          PIC 99.
  2107             20  DC-YMD-DAY            PIC 99.
  2108         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2109         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2110                      DC-GREG-DATE-1-MDY.
  2111             20  DC-MDY-MONTH          PIC 99.
  2112             20  DC-MDY-DAY            PIC 99.
  2113             20  DC-MDY-YEAR           PIC 99.
  2114         16  DC-GREG-DATE-1-ALPHA.
  2115             20  DC-ALPHA-MONTH        PIC X(10).
  2116             20  DC-ALPHA-DAY          PIC 99.
  2117             20  FILLER                PIC XX.
  2118             20  DC-ALPHA-CENTURY.
  2119                 24 DC-ALPHA-CEN-N     PIC 99.
  2120             20  DC-ALPHA-YEAR         PIC 99.
  2121         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2122         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2123         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2124         16  DC-JULIAN-DATE            PIC 9(05).
  2125         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  40
* EL6311.cbl
  2126                                       PIC 9(05).
  2127         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2128             20  DC-JULIAN-YEAR        PIC 99.
  2129             20  DC-JULIAN-DAYS        PIC 999.
  2130         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2131         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2132         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2133     12  DATE-CONVERSION-VARIBLES.
  2134         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2135         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2136             20  FILLER                PIC 9(3).
  2137             20  HOLD-CEN-1-CCYY.
  2138                 24  HOLD-CEN-1-CC     PIC 99.
  2139                 24  HOLD-CEN-1-YY     PIC 99.
  2140             20  HOLD-CEN-1-MO         PIC 99.
  2141             20  HOLD-CEN-1-DA         PIC 99.
  2142         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2143             20  HOLD-CEN-1-R-MO       PIC 99.
  2144             20  HOLD-CEN-1-R-DA       PIC 99.
  2145             20  HOLD-CEN-1-R-CCYY.
  2146                 24  HOLD-CEN-1-R-CC   PIC 99.
  2147                 24  HOLD-CEN-1-R-YY   PIC 99.
  2148             20  FILLER                PIC 9(3).
  2149         16  HOLD-CENTURY-1-X.
  2150             20  FILLER                PIC X(3)  VALUE SPACES.
  2151             20  HOLD-CEN-1-X-CCYY.
  2152                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2153                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2154             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2155             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2156         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2157             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2158             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2159             20  HOLD-CEN-1-R-X-CCYY.
  2160                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2161                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2162             20  FILLER                PIC XXX.
  2163         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2164         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2165         16  DC-JULIAN-DATE-1          PIC 9(07).
  2166         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2167             20  DC-JULIAN-1-CCYY.
  2168                 24  DC-JULIAN-1-CC    PIC 99.
  2169                 24  DC-JULIAN-1-YR    PIC 99.
  2170             20  DC-JULIAN-DA-1        PIC 999.
  2171         16  DC-JULIAN-DATE-2          PIC 9(07).
  2172         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2173             20  DC-JULIAN-2-CCYY.
  2174                 24  DC-JULIAN-2-CC    PIC 99.
  2175                 24  DC-JULIAN-2-YR    PIC 99.
  2176             20  DC-JULIAN-DA-2        PIC 999.
  2177         16  DC-GREG-DATE-A-EDIT.
  2178             20  DC-EDITA-MONTH        PIC 99.
  2179             20  SLASHA-1              PIC X VALUE '/'.
  2180             20  DC-EDITA-DAY          PIC 99.
  2181             20  SLASHA-2              PIC X VALUE '/'.
  2182             20  DC-EDITA-CCYY.
  2183                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  41
* EL6311.cbl
  2184                 24  DC-EDITA-YEAR     PIC 99.
  2185         16  DC-GREG-DATE-B-EDIT.
  2186             20  DC-EDITB-MONTH        PIC 99.
  2187             20  SLASHB-1              PIC X VALUE '/'.
  2188             20  DC-EDITB-DAY          PIC 99.
  2189             20  SLASHB-2              PIC X VALUE '/'.
  2190             20  DC-EDITB-CCYY.
  2191                 24  DC-EDITB-CENT     PIC 99.
  2192                 24  DC-EDITB-YEAR     PIC 99.
  2193         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2194         16  DC-GREG-DATE-CYMD-R REDEFINES
  2195                              DC-GREG-DATE-CYMD.
  2196             20  DC-CYMD-CEN           PIC 99.
  2197             20  DC-CYMD-YEAR          PIC 99.
  2198             20  DC-CYMD-MONTH         PIC 99.
  2199             20  DC-CYMD-DAY           PIC 99.
  2200         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2201         16  DC-GREG-DATE-MDCY-R REDEFINES
  2202                              DC-GREG-DATE-MDCY.
  2203             20  DC-MDCY-MONTH         PIC 99.
  2204             20  DC-MDCY-DAY           PIC 99.
  2205             20  DC-MDCY-CEN           PIC 99.
  2206             20  DC-MDCY-YEAR          PIC 99.
  2207    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2208        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2209    12  DC-EL310-DATE                  PIC X(21).
  2210    12  FILLER                         PIC X(28).
  2211
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  42
* EL6311.cbl
  2213*    COPY ELCLOGOF.
  2214******************************************************************
  2215*                                                                *
  2216*                                                                *
  2217*                            ELCLOGOF.                           *
  2218*                            VMOD=2.001                          *
  2219*                                                                *
  2220*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2221*                                                                *
  2222******************************************************************
  2223 01  CLASIC-LOGOFF.
  2224     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2225     12  LOGOFF-TEXT.
  2226         16  FILLER          PIC X(5)    VALUE SPACES.
  2227         16  LOGOFF-MSG.
  2228             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2229             20  FILLER      PIC X       VALUE SPACES.
  2230             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2231         16  FILLER          PIC X(80)
  2232           VALUE '* YOU ARE NOW LOGGED OFF'.
  2233         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2234         16  FILLER          PIC X       VALUE QUOTE.
  2235         16  LOGOFF-SYS-MSG  PIC X(17)
  2236           VALUE 'S CLAS-IC SYSTEM '.
  2237     12  TEXT-MESSAGES.
  2238         16  UNACCESS-MSG    PIC X(29)
  2239             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2240         16  PGMIDERR-MSG    PIC X(17)
  2241             VALUE 'PROGRAM NOT FOUND'.
  2242
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  43
* EL6311.cbl
  2244*    COPY ELCATTR.
  2245******************************************************************
  2246*                                                                *
  2247*                            ELCATTR.                            *
  2248*                            VMOD=2.001                          *
  2249*                                                                *
  2250*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2251*                                                                *
  2252*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2253*                                                                *
  2254*                   POS 1   P=PROTECTED                          *
  2255*                           U=UNPROTECTED                        *
  2256*                           S=ASKIP                              *
  2257*                   POS 2   A=ALPHA/NUMERIC                      *
  2258*                           N=NUMERIC                            *
  2259*                   POS 3   N=NORMAL                             *
  2260*                           B=BRIGHT                             *
  2261*                           D=DARK                               *
  2262*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2263*                           OF=MODIFIED DATA TAG OFF             *
  2264*                                                                *
  2265*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2266******************************************************************
  2267 01  ATTRIBUTE-LIST.
  2268     12  AL-PABOF            PIC X       VALUE 'Y'.
  2269     12  AL-PABON            PIC X       VALUE 'Z'.
  2270     12  AL-PADOF            PIC X       VALUE '%'.
  2271     12  AL-PADON            PIC X       VALUE '_'.
  2272     12  AL-PANOF            PIC X       VALUE '-'.
  2273     12  AL-PANON            PIC X       VALUE '/'.
  2274     12  AL-SABOF            PIC X       VALUE '8'.
  2275     12  AL-SABON            PIC X       VALUE '9'.
  2276     12  AL-SADOF            PIC X       VALUE '@'.
  2277     12  AL-SADON            PIC X       VALUE QUOTE.
  2278     12  AL-SANOF            PIC X       VALUE '0'.
  2279     12  AL-SANON            PIC X       VALUE '1'.
  2280     12  AL-UABOF            PIC X       VALUE 'H'.
  2281     12  AL-UABON            PIC X       VALUE 'I'.
  2282     12  AL-UADOF            PIC X       VALUE '<'.
  2283     12  AL-UADON            PIC X       VALUE '('.
  2284     12  AL-UANOF            PIC X       VALUE ' '.
  2285     12  AL-UANON            PIC X       VALUE 'A'.
  2286     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2287     12  AL-UNBON            PIC X       VALUE 'R'.
  2288     12  AL-UNDOF            PIC X       VALUE '*'.
  2289     12  AL-UNDON            PIC X       VALUE ')'.
  2290     12  AL-UNNOF            PIC X       VALUE '&'.
  2291     12  AL-UNNON            PIC X       VALUE 'J'.
  2292
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  44
* EL6311.cbl
  2294*    COPY ELCEMIB.
  2295******************************************************************
  2296*                                                                *
  2297*                                                                *
  2298*                            ELCEMIB.                            *
  2299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2300*                            VMOD=2.005                          *
  2301*                                                                *
  2302*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2303*                                                                *
  2304******************************************************************
  2305 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2306     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2307     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2308     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2309     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2310     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2311     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2312     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2313     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2314     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2315         88  EMI-NO-ERRORS                    VALUE '1'.
  2316         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2317         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2318     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2319         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2320     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2321         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2322         88  EMI-AREA1-FULL                   VALUE '2'.
  2323     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2324         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2325         88  EMI-AREA2-FULL                   VALUE '2'.
  2326     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2327         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2328         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2329         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2330         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2331         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2332     12  EMI-ERROR-LINES.
  2333         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2334         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2335         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2336         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2337             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2338                 24  EMI-ERR-NUM         PIC X(4).
  2339                 24  EMI-FILLER          PIC X.
  2340                 24  EMI-SEV             PIC X.
  2341                 24  FILLER              PIC X.
  2342             20  FILLER                  PIC X(02).
  2343     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2344         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2345             20  EMI-ERROR-NUMBER    PIC X(4).
  2346             20  EMI-FILL            PIC X.
  2347             20  EMI-SEVERITY        PIC X.
  2348             20  FILLER              PIC X.
  2349             20  EMI-ERROR-TEXT.
  2350                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2351                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  45
* EL6311.cbl
  2352     12  EMI-SEVERITY-SAVE           PIC X.
  2353         88  EMI-NOTE                    VALUE 'N'.
  2354         88  EMI-WARNING                 VALUE 'W'.
  2355         88  EMI-FORCABLE                VALUE 'F'.
  2356         88  EMI-FATAL                   VALUE 'X'.
  2357     12  EMI-MESSAGE-FLAG            PIC X.
  2358         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2359         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2360     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2361     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2362         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2363         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2364         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2365     12  emi-claim-no                pic x(7).
  2366     12  emi-claim-type              pic x(6).
  2367     12  FILLER                      PIC X(124)  VALUE SPACES.
  2368     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2369     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2370     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2371     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2372
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  46
* EL6311.cbl
  2374*    COPY ELCINTF.
  2375******************************************************************
  2376*                                                                *
  2377*                                                                *
  2378*                            ELCINTF.                            *
  2379*                            VMOD=2.017                          *
  2380*                                                                *
  2381*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2382*                                                                *
  2383*       LENGTH = 1024                                            *
  2384*                                                                *
  2385******************************************************************
  2386*                   C H A N G E   L O G
  2387*
  2388* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2389*-----------------------------------------------------------------
  2390*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2391* EFFECTIVE    NUMBER
  2392*-----------------------------------------------------------------
  2393* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2394******************************************************************
  2395 01  PROGRAM-INTERFACE-BLOCK.
  2396     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2397     12  PI-CALLING-PROGRAM              PIC X(8).
  2398     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2399     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2400     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2401     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2402     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2403     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2404     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2405     12  PI-COMPANY-ID                   PIC XXX.
  2406     12  PI-COMPANY-CD                   PIC X.
  2407
  2408     12  PI-COMPANY-PASSWORD             PIC X(8).
  2409
  2410     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2411
  2412     12  PI-CONTROL-IN-PROGRESS.
  2413         16  PI-CARRIER                  PIC X.
  2414         16  PI-GROUPING                 PIC X(6).
  2415         16  PI-STATE                    PIC XX.
  2416         16  PI-ACCOUNT                  PIC X(10).
  2417         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2418                                         PIC X(10).
  2419         16  PI-CLAIM-CERT-GRP.
  2420             20  PI-CLAIM-NO             PIC X(7).
  2421             20  PI-CERT-NO.
  2422                 25  PI-CERT-PRIME       PIC X(10).
  2423                 25  PI-CERT-SFX         PIC X.
  2424             20  PI-CERT-EFF-DT          PIC XX.
  2425         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2426             20  PI-PLAN-CODE            PIC X(2).
  2427             20  PI-REVISION-NUMBER      PIC X(3).
  2428             20  PI-PLAN-EFF-DT          PIC X(2).
  2429             20  PI-PLAN-EXP-DT          PIC X(2).
  2430             20  FILLER                  PIC X(11).
  2431         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  47
* EL6311.cbl
  2432             20  PI-OE-REFERENCE-1.
  2433                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2434                 25  PI-OE-REF-1-SUFF    PIC XX.
  2435
  2436     12  PI-SESSION-IN-PROGRESS          PIC X.
  2437         88  CLAIM-SESSION                   VALUE '1'.
  2438         88  CREDIT-SESSION                  VALUE '2'.
  2439         88  WARRANTY-SESSION                VALUE '3'.
  2440         88  MORTGAGE-SESSION                VALUE '4'.
  2441         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2442
  2443
  2444*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2445
  2446     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2447     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2448
  2449     12  PI-CREDIT-USER                  PIC X.
  2450         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2451         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2452
  2453     12  PI-CLAIM-USER                   PIC X.
  2454         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2455         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2456
  2457     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2458         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2459         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2460         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2461         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2462         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2463
  2464     12  PI-PROCESSOR-ID                 PIC X(4).
  2465
  2466     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2467
  2468     12  PI-MEMBER-CAPTION               PIC X(10).
  2469
  2470     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2471         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2472
  2473     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2474     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2475     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2476     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2477
  2478     12  PI-AH-OVERRIDE-L1               PIC X.
  2479     12  PI-AH-OVERRIDE-L2               PIC XX.
  2480     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2481     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2482
  2483     12  PI-NEW-SYSTEM                   PIC X(2).
  2484
  2485     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2486     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2487         88  PI-USES-PAID-TO                 VALUE '1'.
  2488     12  PI-CRDTCRD-SYSTEM.
  2489         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  48
* EL6311.cbl
  2490             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2491             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2492         16  PI-CC-MONTH-END-DT          PIC XX.
  2493     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2494
  2495     12  PI-OE-REFERENCE-2.
  2496         16  PI-OE-REF-2-PRIME           PIC X(10).
  2497         16  PI-OE-REF-2-SUFF            PIC X.
  2498
  2499     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2500
  2501     12  PI-LANGUAGE-TYPE                PIC X.
  2502             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2503             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2504             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2505
  2506     12  PI-POLICY-LINKAGE-IND           PIC X.
  2507         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2508         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2509                                                   LOW-VALUES.
  2510
  2511     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2512     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2513         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2514         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2515
  2516     12  PI-PROCESSOR-CSR-IND            PIC X.
  2517         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2518         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2519
  2520     12  FILLER                          PIC X(3).
  2521
  2522     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2523
  2524     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2525         PI-SYSTEM-LEVEL.
  2526
  2527         16  PI-ENTRY-CODES.
  2528             20  PI-ENTRY-CD-1           PIC X.
  2529             20  PI-ENTRY-CD-2           PIC X.
  2530
  2531         16  PI-RETURN-CODES.
  2532             20  PI-RETURN-CD-1          PIC X.
  2533             20  PI-RETURN-CD-2          PIC X.
  2534
  2535         16  PI-UPDATE-STATUS-SAVE.
  2536             20  PI-UPDATE-BY            PIC X(4).
  2537             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2538
  2539         16  PI-LOWER-CASE-LETTERS       PIC X.
  2540             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2541
  2542*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2543*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2544*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2545
  2546         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2547             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  49
* EL6311.cbl
  2548             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2549             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2550             88  ACCNT-CNTL                  VALUE '3'.
  2551             88  CARR-ACCNT-CNTL             VALUE '4'.
  2552
  2553         16  PI-PROCESSOR-CAP-LIST.
  2554             20  PI-SYSTEM-CONTROLS.
  2555                24 PI-SYSTEM-DISPLAY     PIC X.
  2556                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2557                24 PI-SYSTEM-MODIFY      PIC X.
  2558                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2559             20  FILLER                  PIC XX.
  2560             20  PI-DISPLAY-CAP          PIC X.
  2561                 88  DISPLAY-CAP             VALUE 'Y'.
  2562             20  PI-MODIFY-CAP           PIC X.
  2563                 88  MODIFY-CAP              VALUE 'Y'.
  2564             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2565                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2566             20  PI-FORCE-CAP            PIC X.
  2567                 88  FORCE-CAP               VALUE 'Y'.
  2568
  2569         16  PI-PROGRAM-CONTROLS.
  2570             20  PI-PGM-PRINT-OPT        PIC X.
  2571             20  PI-PGM-FORMAT-OPT       PIC X.
  2572             20  PI-PGM-PROCESS-OPT      PIC X.
  2573             20  PI-PGM-TOTALS-OPT       PIC X.
  2574
  2575         16  PI-HELP-INTERFACE.
  2576             20  PI-LAST-ERROR-NO        PIC X(4).
  2577             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2578
  2579         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2580             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2581
  2582         16  PI-CR-CONTROL-IN-PROGRESS.
  2583             20  PI-CR-CARRIER           PIC X.
  2584             20  PI-CR-GROUPING          PIC X(6).
  2585             20  PI-CR-STATE             PIC XX.
  2586             20  PI-CR-ACCOUNT           PIC X(10).
  2587             20  PI-CR-FIN-RESP          PIC X(10).
  2588             20  PI-CR-TYPE              PIC X.
  2589
  2590         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2591
  2592         16  PI-CR-MONTH-END-DT          PIC XX.
  2593
  2594         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2595             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2596             88  PI-ZERO-CARRIER             VALUE '1'.
  2597             88  PI-ZERO-GROUPING            VALUE '2'.
  2598             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2599
  2600         16  PI-CARRIER-SECURITY         PIC X.
  2601             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2602
  2603         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2604             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2605             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  50
* EL6311.cbl
  2606
  2607         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2608             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2609                                         INDEXED BY PI-ACCESS-NDX
  2610                                         PIC X.
  2611
  2612         16  PI-GA-BILLING-CONTROL       PIC X.
  2613             88  PI-GA-BILLING               VALUE '1'.
  2614
  2615         16  PI-MAIL-PROCESSING          PIC X.
  2616             88  PI-MAIL-YES                 VALUE 'Y'.
  2617
  2618         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2619
  2620         16  PI-AR-SYSTEM.
  2621             20  PI-AR-PROCESSING-CNTL   PIC X.
  2622                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2623             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2624             20  PI-AR-MONTH-END-DT      PIC XX.
  2625
  2626         16  PI-MP-SYSTEM.
  2627             20  PI-MORTGAGE-USER            PIC X.
  2628                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2629                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2630             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2631                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2632                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2633                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2634                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2635                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2636             20  PI-MP-MONTH-END-DT          PIC XX.
  2637             20  PI-MP-REFERENCE-NO.
  2638                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2639                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2640
  2641         16  PI-LABEL-CONTROL            PIC X(01).
  2642             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2643             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2644
  2645         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2646             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2647
  2648         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2649             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2650             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2651
  2652         16  FILLER                      PIC X(14).
  2653
  2654     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2655******************************************************************
  2656
  2657     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2658*    COPY ELC631PI.
  2659******************************************************************
  2660*                                                                *
  2661*                                                                *
  2662*                            ELC631PI                            *
  2663*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  51
* EL6311.cbl
  2664*                                                                *
  2665*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2666*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2667*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2668*                                                                *
  2669*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2670*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2671*    BETWEEN PROGRAMS.                                           *
  2672*                                                                *
  2673*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2674*                                                                *
  2675*               EL631 - EL6311 - EL6312 - EL6313                 *
  2676*                                                                *
  2677******************************************************************
  2678*                   C H A N G E   L O G
  2679*
  2680* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2681*-----------------------------------------------------------------
  2682*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2683* EFFECTIVE    NUMBER
  2684*-----------------------------------------------------------------
  2685* 021414    2003053000001  PEMA  changes for auto chk request
  2686******************************************************************
  2687
  2688         16  PI-631-DATA.
  2689             20  PI-ERPNDB-KEY.
  2690                 24  PI-PB-COMPANY-CD     PIC X.
  2691                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2692                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2693                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2694
  2695             20  PI-ERPNDB-ALT-KEY.
  2696                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2697                 24  PI-PB-CARRIER        PIC X.
  2698                 24  PI-PB-GROUPING       PIC X(6).
  2699                 24  PI-PB-STATE          PIC XX.
  2700                 24  PI-PB-ACCOUNT        PIC X(10).
  2701                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2702                 24  PI-PB-CERT-NO.
  2703                     28  PI-PB-CERT-PRIME PIC X(10).
  2704                     28  PI-PB-CERT-SFX   PIC X.
  2705                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2706                 24  PI-PB-RECORD-TYPE    PIC X.
  2707
  2708             20  PI-ERPNDB-CSR-KEY.
  2709                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2710                 24  PI-PB-CSR-ID             PIC X(4).
  2711                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2712                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2713                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2714
  2715             20  PI-BROWSE-TYPE               PIC X.
  2716                 88  PI-FILE-BROWSE             VALUE ' '.
  2717                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2718                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2719                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2720                 88  PI-CSR-BROWSE              VALUE '4'.
  2721
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  52
* EL6311.cbl
  2722             20  PI-MAINT-FUNCTION            PIC X.
  2723                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2724                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2725                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2726                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2727                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2728                 88  PI-PF5-FUNCTION            VALUE '5'.
  2729                 88  PI-PF6-FUNCTION            VALUE '6'.
  2730
  2731             20  PI-FILE-SWITCHES.
  2732                 24  PI-ALL-ISSUES-SW         PIC X.
  2733                     88  ALL-ISSUES             VALUE 'Y'.
  2734                 24  PI-ALL-CANCELS-SW        PIC X.
  2735                     88  ALL-CANCELS            VALUE 'Y'.
  2736                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2737                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2738                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2739                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2740                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2741                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2742                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2743                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2744                 24  PI-HOLD-REC-SW           PIC X.
  2745                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2746                 24  PI-CHANGE-REC-SW         PIC X.
  2747                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2748                 24  PI-CHK-REQ-REC-SW        PIC X.
  2749                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2750                 24  PI-ISSUE-WARNING-SW      PIC X.
  2751                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2752                 24  PI-CANCEL-WARNING-SW     PIC X.
  2753                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2754             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2755                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2756             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2757                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2758
  2759             20  PI-MAP-NAME                  PIC X(8).
  2760
  2761             20  PI-CURSOR                    PIC S9(4) COMP.
  2762
  2763             20  PI-PREV-ALT-KEY              PIC X(36).
  2764             20  PI-PREV-CSR-KEY              PIC X(15).
  2765             20  PI-PREV-KEY.
  2766                 24  PI-PREV-COMPANY-CD       PIC X.
  2767                 24  PI-PREV-BATCH            PIC X(6).
  2768                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2769                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2770             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2771             20  PI-BROWSE-SW                 PIC X.
  2772                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2773                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2774             20  PI-SV-CARRIER                PIC X.
  2775             20  PI-SV-GROUPING               PIC X(6).
  2776             20  PI-SV-STATE                  PIC XX.
  2777             20  PI-EDIT-SW                   PIC X.
  2778             20  PI-DISPLAY-SW                PIC XX.
  2779                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  53
* EL6311.cbl
  2780                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2781             20  PI-CRITERIA-DATA             PIC X(350).
  2782             20  PI-BMODE                     PIC X.
  2783             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2784             20  PI-BPMTS                     PIC S999     COMP-3.
  2785             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2786             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2787             20  PI-CSR-SESSION-SW            PIC X.
  2788                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2789             20  PI-ERRORS-SW                 PIC X.
  2790                 88  FATAL-ERRORS               VALUE 'X'.
  2791*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2792             20  pi-unforced-sw               pic x.
  2793                 88  unforced-errors            value 'X'.
  2794             20  FILLER                       PIC X(4).
  2795
  2796        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2797        16  FILLER             PIC X(92).
  2798
  2799 01  W-LETTER-COMMUNICATION-AREAS.
  2800*    COPY ELC1042.
  2801******************************************************************
  2802*                                                                *
  2803*                                                                *
  2804*                           ELC1042                              *
  2805*                            VMOD=2.002                          *
  2806*                                                                *
  2807*    NOTE                                                        *
  2808*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2809*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2810*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2811*        TO THESE PROGRAMS.                                      *
  2812*                                                                *
  2813*    NOTE                                                        *
  2814*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2815*        USE ONLY!                                               *
  2816*                                                                *
  2817******************************************************************
  2818
  2819         16  PI-1042-WA.
  2820             20  PI-ACTION       PIC  X(01).
  2821                 88 PI-SHOW-MODE           VALUE '1'.
  2822                 88 PI-CLEAR-MODE          VALUE '2'.
  2823                 88 PI-CREATE-MODE         VALUE '3'.
  2824             20  PI-COMM-CONTROL PIC  X(12).
  2825             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2826             20  PI-EOF-SW       PIC  X(01).
  2827                 88  PI-FILE-EOF           VALUE 'Y'.
  2828             20  PI-FILETYP      PIC  X(01).
  2829             20  PI-FORM-SQUEEZE-CONTROL
  2830                                 PIC  X(01).
  2831                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2832                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2833             20  PI-LAST-CONTROL PIC  X(12).
  2834             20  PI-TEMP-STOR-ITEMS
  2835                                 PIC S9(04) COMP.
  2836             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2837             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  54
* EL6311.cbl
  2838                 88 ANY-UPDATES            VALUE 1.
  2839             20  PI-104-SCREEN-SENT-IND
  2840                                 PIC  X(01).
  2841                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2842                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2843             20  PI-1042-SCREEN-SENT-IND
  2844                                 PIC  X(01).
  2845                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2846                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2847             20  PI-1042-ARCHIVE-IND
  2848                                 PIC  X(01).
  2849                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2850             20  FILLER          PIC  X(29).
  2851*    COPY ELC689PI.
  2852******************************************************************
  2853*                                                                *
  2854*                            ELC689PI                            *
  2855*                            VMOD=2.003                          *
  2856*                                                                *
  2857*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2858*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2859*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2860*                                                                *
  2861*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2862*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2863*    BETWEEN PROGRAMS.                                           *
  2864*                                                                *
  2865*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2866*                                                                *
  2867*               EL631 - EL689  - EL6891 - EL6892                 *
  2868*                                                                *
  2869******************************************************************
  2870*                   C H A N G E   L O G
  2871*
  2872* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2873*-----------------------------------------------------------------
  2874*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2875* EFFECTIVE    NUMBER
  2876*-----------------------------------------------------------------
  2877* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2878* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2879* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2880******************************************************************
  2881
  2882
  2883         16  PI-689-WORK-AREA.
  2884             20  PI-689-ALT-PRINTER-ID
  2885                                 PIC  X(04).
  2886             20  PI-689-ARCHIVE-NUMBER
  2887                                 PIC  9(08).
  2888             20  PI-689-ARCHIVE-SW
  2889                                 PIC  X(01).
  2890                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2891             20  PI-689-DATA-SOURCE
  2892                                 PIC  X(01).
  2893                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2894                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2895                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  55
* EL6311.cbl
  2896                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2897                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2898             20  PI-689-ERROR-IND
  2899                                 PIC  X(01).
  2900                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2901             20  PI-689-ERROR    PIC  9(04).
  2902                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2903                 88  PI-689-FATAL-ERROR
  2904                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2905                            0042 0047 0051 0066 0067 0070
  2906                            0168 0169 0174 0175 0176 0177 0179
  2907                            0180 0181 0182 0184 0185 0189 0190
  2908                            0191
  2909                            0215 0279 0280
  2910                            0412 0413 0454
  2911                            0533 0537
  2912                            2055 2114 2208 2209 2216 2232 2369
  2913                            2398 2433 2908 2999
  2914                            3000 3770 3771 3775
  2915                            7250 7365 7367 7368 7369 7370 7371
  2916                            7272 7373 7374 7376 7377 7378 7379
  2917                            7381 7388 7390 7393 7395 7396 7398
  2918                            9095 9096 9281 9298 9299 9320 9327
  2919                            9426 9427.
  2920                 88  PI-689-STOP-ERROR
  2921                     VALUES 0004 0008 0013 0023 0029 0033
  2922                            0042 0047 0066 0067 0070
  2923                            0168 0169 0174 0175 0176 0177
  2924                            0181 0182 0184 0185 0189 0190
  2925                            0279 0280
  2926                            0412 0413 0454
  2927                            2055 2208 2209 2216 2232
  2928                            2398 2999
  2929                            3000 3770 3771 3775
  2930                            7250 7365 7369 7370 7371
  2931                            7272 7373 7374 7376 7377 7378 7379
  2932                            7381 7388 7390 7393 7396 7398
  2933                            9095 9096 9299 9320 9426.
  2934             20  PI-689-FOLLOW-UP-DATE
  2935                                 PIC  X(02).
  2936             20  PI-689-FORM-NUMBER
  2937                                 PIC  X(04).
  2938             20  PI-689-LABEL-SOURCE
  2939                                 PIC X(01).
  2940                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2941                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2942                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2943                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2944                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2945                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2946                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2947             20  PI-689-NUMBER-COPIES
  2948                                 PIC  9(01).
  2949             20  PI-689-NUMBER-LABEL-LINES
  2950                                 PIC  9(01).
  2951             20  PI-689-NUMBER-TEXT-RECORDS
  2952                                 PIC  9(03).
  2953             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  56
* EL6311.cbl
  2954                                 PIC  X(01).
  2955                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2956                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2957                 88  PI-689-PRINT-LATER     VALUE '3'.
  2958                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2959             20  PI-689-PRINT-RESTRICTION
  2960                                 PIC  X(01).
  2961                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2962                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2963                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2964             20  PI-689-PRINT-SW PIC  X(01).
  2965                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2966             20  PI-689-RESEND-DATE-1
  2967                                 PIC  X(02).
  2968             20  PI-689-RESEND-LETR-1
  2969                                 PIC X(4).
  2970             20  PI-689-TEMP-STOR-ID
  2971                                 PIC  X(08).
  2972             20  PI-689-USE-SCREEN-IND
  2973                                 PIC  X(01).
  2974                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2975             20  PI-689-ARCH-POINTER
  2976                                 PIC S9(08) COMP.
  2977                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2978             20  PI-689-ARCT-POINTER
  2979                                 PIC S9(08) COMP.
  2980                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2981             20  PI-689-VARIABLE-DATA-GRP.
  2982                 24  PI-689-VARIABLE-DATA-1
  2983                                 PIC  X(30).
  2984                 24  PI-689-VARIABLE-DATA-2
  2985                                 PIC  X(30).
  2986                 24  PI-689-VARIABLE-DATA-3
  2987                                 PIC  X(30).
  2988                 24  PI-689-VARIABLE-DATA-4
  2989                                 PIC  X(30).
  2990
  2991         16  PI-689-KEY-DATA-FIELDS.
  2992             20  PI-689-ACCOUNT  PIC  X(10).
  2993             20  PI-689-CARRIER  PIC  X(01).
  2994             20  PI-689-CERT-NO.
  2995                 24  PI-689-CERT-PRIME
  2996                                 PIC  X(10).
  2997                 24  PI-689-CERT-SFX
  2998                                 PIC  X(01).
  2999             20  PI-689-CHG-SEQ-NO
  3000                                 PIC S9(04)    COMP.
  3001             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3002                                 PIC  X(02).
  3003             20  PI-689-ENTRY-BATCH
  3004                                 PIC  X(06).
  3005             20  PI-689-EFF-DATE PIC  X(02).
  3006             20  PI-689-EXP-DATE PIC  X(02).
  3007             20  PI-689-GROUPING PIC  X(06).
  3008             20  PI-689-RESP-PERSON
  3009                                 PIC  X(10).
  3010             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3011             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  57
* EL6311.cbl
  3012                                 PIC  X(04).
  3013             20  PI-689-STATE    PIC  X(02).
  3014             20  PI-689-TYPE     PIC  X(01).
  3015             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3016             20  PI-689-ALT-SEQ-NO
  3017                                 PIC S9(04)    COMP.
  3018         16  PI-689-DATE-EDIT    PIC  X(08).
  3019         16  PI-689-FOLLOW-UP-EDIT
  3020                                 PIC  X(08).
  3021         16  PI-689-RESEND1-EDIT PIC  X(08).
  3022         16  PI-689-SEQ-EDIT     PIC  X(08).
  3023         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3024         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3025             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3026         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3027         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  58
* EL6311.cbl
  3029
  3030 01  WS-EL6315-PASS-AREA.
  3031        16  PI-6315-ISS-CAN-SW      PIC X.
  3032        16  FILLER                  PIC X(120).
  3033        16  PI-RES-REF-CLM-TYPE     PIC X.
  3034        16  FILLER                  PIC X.
  3035        16  PI-6315-PASS-AREA.
  3036            20 FILLER               PIC X(236).
  3037            20 PI-6315-FINALIZED    PIC X.
  3038            20 FILLER               PIC X(280).
  3039
  3040 01  WS-EL6316-PASS-AREA.
  3041        16  PI-ISS-CAN-SW           PIC X.
  3042        16  FILLER                  PIC X(121).
  3043        16  PI-CLM-RESC-IND         PIC X.
  3044        16  PI-6316-PASS-AREA.
  3045            20 FILLER               PIC X(236).
  3046            20 PI-6316-FINALIZED    PIC X.
  3047            20 FILLER               PIC X(280).
  3048
  3049******************************************************************
  3050*                                                                *
  3051*         P A S S   A R E A   F O R   E D I T                    *
  3052*                                                                *
  3053******************************************************************
  3054
  3055 01  PASSED-RECORD.
  3056     12  RECORD-SAVE                  PIC X(585).
  3057* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3058*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3059*                    BY  WK-CURRENT-DATE.
  3060******************************************************************
  3061*                                                                *
  3062*                                                                *
  3063*                             ELC50W1                            *
  3064*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3065*                            VMOD=2.004                          *
  3066*                                                                *
  3067*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3068*                                                                *
  3069*                                                                *
  3070******************************************************************
  3071
  3072     12  WK-WORK-AREA.
  3073         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3074         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3075         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3076         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3077         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3078         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3079         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3080         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3081         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3082         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3083         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3084         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3085         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3086         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  59
* EL6311.cbl
  3087         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3088         16  WK-CREDIT-EDIT-CONTROLS.
  3089             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3090             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3091             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3092             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3093             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3094             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3095         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3096         16  WK-SAVE-REIN-DATA.
  3097             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3098             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3099             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3100         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3101             88  ENTRY-FROM-EL6311       VALUE '6'.
  3102         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3103         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3104     12  WK-RECORD-ADDRESSES.
  3105         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3106         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3107         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3108         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3109         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3110         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3111         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3112         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3113     12  WK-OVER-SHORT-AREA.
  3114         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3115         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3116         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3117             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3118         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  60
* EL6311.cbl
  3120
  3121*    COPY ELCEDITC.
  3122******************************************************************
  3123*                                                                *
  3124*                                                                *
  3125*                            ELCEDITC                            *
  3126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3127*                            VMOD=2.012                          *
  3128*                                                                *
  3129*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3130*                     EL6313, EL050 AND EL517.                   *
  3131*                                                                *
  3132******************************************************************
  3133******************************************************************
  3134*                   C H A N G E   L O G
  3135*
  3136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3137*-----------------------------------------------------------------
  3138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3139* EFFECTIVE    NUMBER
  3140*-----------------------------------------------------------------
  3141* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3142******************************************************************
  3143
  3144     12  EDIT-CRITERIA-DATA.
  3145         16  EC-CO-MONTH-END-DT       PIC XX.
  3146         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3147         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3148         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3149         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3150         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3151         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3152         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3153         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3154         16  EC-CO-REM-TERM-CALC      PIC X.
  3155               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3156               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3157               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3158               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3159
  3160         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3161               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3162               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3163               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3164               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3165               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3166               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3167               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3168               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3169               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3170               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3171
  3172         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3173               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3174               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3175               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3176               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3177               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  61
* EL6311.cbl
  3178               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3179               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3180               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3181
  3182         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3183                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3184                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3185
  3186         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3187                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3188                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3189                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3190                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3191                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3192                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3193                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3194                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3195
  3196         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3197               88  EC-BR-REDUCING                   VALUE 'R'.
  3198               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3199
  3200         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3201         16  EC-BR-LF-DESC             PIC X(10).
  3202         16  EC-BR-AH-DESC             PIC X(10).
  3203         16  EC-BR-LF-COMMENT          PIC X(10).
  3204         16  EC-BR-AH-COMMENT          PIC X(10).
  3205
  3206         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3207               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3208               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3209               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3210               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3211
  3212         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3213               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3214               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3215               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3216               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3217
  3218         16  EC-BR-LF-REFUND-CALC      PIC X.
  3219                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3220                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3221                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3222                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3223                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3224                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3225                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3226
  3227         16  EC-BR-AH-REFUND-CALC      PIC X.
  3228                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3229                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3230                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3231                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3232                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3233                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3234                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3235                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  62
* EL6311.cbl
  3236
  3237         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3238                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3239                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3240                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3241
  3242         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3243                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3244                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3245                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3246
  3247         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3248         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3249         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3250         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3251
  3252         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3253         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3254                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3255                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3256                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3257                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3258
  3259         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3260               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3261               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3262               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3263               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3264               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3265
  3266         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3267               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3268               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3269               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3270               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3271               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3272
  3273         16  EC-ST-LF-REFUND-CALC      PIC X.
  3274                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3275                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3276                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3277                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3278                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3279                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3280                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3281                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3282
  3283         16  EC-ST-AH-REFUND-CALC      PIC X.
  3284                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3285                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3286                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3287                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3288                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3289                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3290                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3291                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3292
  3293         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  63
* EL6311.cbl
  3294         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3295         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3296         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3297         16  EC-AM-EXPIRATION-DT       PIC XX.
  3298         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3299         16  EC-AM-CLASS-CD            PIC XX.
  3300         16  EC-AM-LF-DEVIATION        PIC XXX.
  3301         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3302         16  EC-AM-AH-DEVIATION        PIC XXX.
  3303         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3304         16  EC-AM-PHONE-NO            PIC X(10).
  3305
  3306         16  EC-AM-LF-REFUND-CALC      PIC X.
  3307                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3308                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3309                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3310                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3311                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3312                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3313                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3314
  3315         16  EC-AM-AH-REFUND-CALC      PIC X.
  3316                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3317                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3318                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3319                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3320                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3321                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3322                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3323
  3324         16  EC-AM-BEN-I-G-CD          PIC X.
  3325                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3326                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3327                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3328
  3329         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3330         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3331         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3332         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3333         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3334         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3335         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3336         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3337         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3338
  3339         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3340         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3341         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3342         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3343         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3344         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3345         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3346         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3347         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3348         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3349         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3350         16  EC-RT-LF-NSP-ST           PIC XX.
  3351         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  64
* EL6311.cbl
  3352         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3353         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3354
  3355         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3356             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3357                                             'M' '5' '9' '2'.
  3358             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3359             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3360             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3361             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3362             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3363             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3364             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3365             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3366             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3367             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3368
  3369         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3370             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3371                                             'M' '5' '9' '2'.
  3372             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3373             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3374             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3375             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3376             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3377             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3378             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3379             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3380             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3381             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3382
  3383         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3384         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3385         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3386         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3387         16  EC-CM-DEATH-DT            PIC XX.
  3388
  3389*DMD CUSTOM CODING FIELDS BELOW
  3390*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3391         16  EC-BR-DMD-RATING-SW       PIC X.
  3392                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3393                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3394                 88  NO-DMD-RATING               VALUE 'N'.
  3395
  3396         16  EC-NEW-CERT               PIC X(11).
  3397         16  EC-NEW-STATE              PIC XX.
  3398         16  FILLER                    PIC X.
  3399*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3400         16  OVER-SHORT-EDIT-FIELDS.
  3401             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3402             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3403             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3404             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3405             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3406             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3407             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3408             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3409             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  65
* EL6311.cbl
  3410         16  FILLER                    PIC X(71).
  3411
  3412******************************************************************
  3413
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  66
* EL6311.cbl
  3415
  3416*    COPY ELCJPFX.
  3417******************************************************************
  3418*                                                                *
  3419*                                                                *
  3420*                            ELCJPFX.                            *
  3421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3422*                            VMOD=2.002                          *
  3423*                                                                *
  3424*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3425*                                                                *
  3426*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3427*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3428*        ELCNTL - CONTROL FILE                                   *
  3429*        ELMSTR - CLAIM MASTERS                                  *
  3430*        ELTRLR - ACTIVITY TRAILERS                              *
  3431*        ELCHKQ - CHECK QUE                                      *
  3432******************************************************************
  3433 01  JOURNAL-RECORD.
  3434     12  jp-date                     pic s9(5) comp-3.
  3435     12  jp-time                     pic s9(7) comp-3.
  3436     12  JP-USER-ID                  PIC X(4).
  3437     12  JP-FILE-ID                  PIC X(8).
  3438     12  JP-PROGRAM-ID               PIC X(8).
  3439     12  JP-RECORD-TYPE              PIC X.
  3440         88 JP-ADD              VALUE 'A'.
  3441         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3442         88 JP-AFTER-CHANGE     VALUE 'C'.
  3443         88 JP-DELETE           VALUE 'D'.
  3444         88 JP-GENERIC-DELETE   VALUE 'G'.
  3445         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3446         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3447     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3448     12  JP-RECORD-AREA
  3449
  3450
  3451                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  67
* EL6311.cbl
  3453*    COPY ELCAID.
  3454******************************************************************
  3455*                                                                *
  3456*                            ELCAID.                             *
  3457*                            VMOD=2.001                          *
  3458*                                                                *
  3459*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3460*                                                                *
  3461*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3462*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3463******************************************************************
  3464
  3465 01  DFHAID.
  3466   02  DFHNULL   PIC  X  VALUE  ' '.
  3467   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3468   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3469   02  DFHPEN    PIC  X  VALUE  '='.
  3470   02  DFHOPID   PIC  X  VALUE  'W'.
  3471   02  DFHPA1    PIC  X  VALUE  '%'.
  3472   02  DFHPA2    PIC  X  VALUE  '>'.
  3473   02  DFHPA3    PIC  X  VALUE  ','.
  3474   02  DFHPF1    PIC  X  VALUE  '1'.
  3475   02  DFHPF2    PIC  X  VALUE  '2'.
  3476   02  DFHPF3    PIC  X  VALUE  '3'.
  3477   02  DFHPF4    PIC  X  VALUE  '4'.
  3478   02  DFHPF5    PIC  X  VALUE  '5'.
  3479   02  DFHPF6    PIC  X  VALUE  '6'.
  3480   02  DFHPF7    PIC  X  VALUE  '7'.
  3481   02  DFHPF8    PIC  X  VALUE  '8'.
  3482   02  DFHPF9    PIC  X  VALUE  '9'.
  3483   02  DFHPF10   PIC  X  VALUE  ':'.
  3484   02  DFHPF11   PIC  X  VALUE  '#'.
  3485   02  DFHPF12   PIC  X  VALUE  '@'.
  3486   02  DFHPF13   PIC  X  VALUE  'A'.
  3487   02  DFHPF14   PIC  X  VALUE  'B'.
  3488   02  DFHPF15   PIC  X  VALUE  'C'.
  3489   02  DFHPF16   PIC  X  VALUE  'D'.
  3490   02  DFHPF17   PIC  X  VALUE  'E'.
  3491   02  DFHPF18   PIC  X  VALUE  'F'.
  3492   02  DFHPF19   PIC  X  VALUE  'G'.
  3493   02  DFHPF20   PIC  X  VALUE  'H'.
  3494   02  DFHPF21   PIC  X  VALUE  'I'.
  3495*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3496   02  DFHPF22   PIC  X  VALUE  '['.
  3497   02  DFHPF23   PIC  X  VALUE  '.'.
  3498   02  DFHPF24   PIC  X  VALUE  '<'.
  3499   02  DFHMSRE   PIC  X  VALUE  'X'.
  3500   02  DFHSTRF   PIC  X  VALUE  'h'.
  3501   02  DFHTRIG   PIC  X  VALUE  '"'.
  3502
  3503 01  FILLER    REDEFINES DFHAID.
  3504     12  FILLER              PIC X(8).
  3505     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3506
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  68
* EL6311.cbl
  3508*    COPY EL6311S.
  3509 01  EL631BI.
  3510     05  FILLER            PIC  X(0012).
  3511*    -------------------------------
  3512     05  BDATEL PIC S9(0004) COMP.
  3513     05  BDATEF PIC  X(0001).
  3514     05  FILLER REDEFINES BDATEF.
  3515         10  BDATEA PIC  X(0001).
  3516     05  BDATEI PIC  X(0008).
  3517*    -------------------------------
  3518     05  BTIMEL PIC S9(0004) COMP.
  3519     05  BTIMEF PIC  X(0001).
  3520     05  FILLER REDEFINES BTIMEF.
  3521         10  BTIMEA PIC  X(0001).
  3522     05  BTIMEI PIC  X(0005).
  3523*    -------------------------------
  3524     05  BHEADL PIC S9(0004) COMP.
  3525     05  BHEADF PIC  X(0001).
  3526     05  FILLER REDEFINES BHEADF.
  3527         10  BHEADA PIC  X(0001).
  3528     05  BHEADI PIC  X(0038).
  3529*    -------------------------------
  3530     05  BNCERTLL PIC S9(0004) COMP.
  3531     05  BNCERTLF PIC  X(0001).
  3532     05  FILLER REDEFINES BNCERTLF.
  3533         10  BNCERTLA PIC  X(0001).
  3534     05  BNCERTLI PIC  X(0008).
  3535*    -------------------------------
  3536     05  BNCERTL PIC S9(0004) COMP.
  3537     05  BNCERTF PIC  X(0001).
  3538     05  FILLER REDEFINES BNCERTF.
  3539         10  BNCERTA PIC  X(0001).
  3540     05  BNCERTI PIC  X(0011).
  3541*    -------------------------------
  3542     05  BNSTATLL PIC S9(0004) COMP.
  3543     05  BNSTATLF PIC  X(0001).
  3544     05  FILLER REDEFINES BNSTATLF.
  3545         10  BNSTATLA PIC  X(0001).
  3546     05  BNSTATLI PIC  X(0009).
  3547*    -------------------------------
  3548     05  BNSTATL PIC S9(0004) COMP.
  3549     05  BNSTATF PIC  X(0001).
  3550     05  FILLER REDEFINES BNSTATF.
  3551         10  BNSTATA PIC  X(0001).
  3552     05  BNSTATI PIC  X(0002).
  3553*    -------------------------------
  3554     05  BCHGTL PIC S9(0004) COMP.
  3555     05  BCHGTF PIC  X(0001).
  3556     05  FILLER REDEFINES BCHGTF.
  3557         10  BCHGTA PIC  X(0001).
  3558     05  BCHGTI PIC  X(0004).
  3559*    -------------------------------
  3560     05  BCHGL PIC S9(0004) COMP.
  3561     05  BCHGF PIC  X(0001).
  3562     05  FILLER REDEFINES BCHGF.
  3563         10  BCHGA PIC  X(0001).
  3564     05  BCHGI PIC  X(0004).
  3565*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  69
* EL6311.cbl
  3566     05  BCOMPIDL PIC S9(0004) COMP.
  3567     05  BCOMPIDF PIC  X(0001).
  3568     05  FILLER REDEFINES BCOMPIDF.
  3569         10  BCOMPIDA PIC  X(0001).
  3570     05  BCOMPIDI PIC  X(0003).
  3571*    -------------------------------
  3572     05  BREGIONL PIC S9(0004) COMP.
  3573     05  BREGIONF PIC  X(0001).
  3574     05  FILLER REDEFINES BREGIONF.
  3575         10  BREGIONA PIC  X(0001).
  3576     05  BREGIONI PIC  X(0006).
  3577*    -------------------------------
  3578     05  BUSERL PIC S9(0004) COMP.
  3579     05  BUSERF PIC  X(0001).
  3580     05  FILLER REDEFINES BUSERF.
  3581         10  BUSERA PIC  X(0001).
  3582     05  BUSERI PIC  X(0004).
  3583*    -------------------------------
  3584     05  BMAINTL PIC S9(0004) COMP.
  3585     05  BMAINTF PIC  X(0001).
  3586     05  FILLER REDEFINES BMAINTF.
  3587         10  BMAINTA PIC  X(0001).
  3588     05  BMAINTI PIC  X(0001).
  3589*    -------------------------------
  3590     05  BMANTBYL PIC S9(0004) COMP.
  3591     05  BMANTBYF PIC  X(0001).
  3592     05  FILLER REDEFINES BMANTBYF.
  3593         10  BMANTBYA PIC  X(0001).
  3594     05  BMANTBYI PIC  X(0004).
  3595*    -------------------------------
  3596     05  BCHGHDGL PIC S9(0004) COMP.
  3597     05  BCHGHDGF PIC  X(0001).
  3598     05  FILLER REDEFINES BCHGHDGF.
  3599         10  BCHGHDGA PIC  X(0001).
  3600     05  BCHGHDGI PIC  X(0003).
  3601*    -------------------------------
  3602     05  BMANTDTL PIC S9(0004) COMP.
  3603     05  BMANTDTF PIC  X(0001).
  3604     05  FILLER REDEFINES BMANTDTF.
  3605         10  BMANTDTA PIC  X(0001).
  3606     05  BMANTDTI PIC  X(0008).
  3607*    -------------------------------
  3608     05  BMANTATL PIC S9(0004) COMP.
  3609     05  BMANTATF PIC  X(0001).
  3610     05  FILLER REDEFINES BMANTATF.
  3611         10  BMANTATA PIC  X(0001).
  3612     05  BMANTATI PIC  X(0005).
  3613*    -------------------------------
  3614     05  BCSRL PIC S9(0004) COMP.
  3615     05  BCSRF PIC  X(0001).
  3616     05  FILLER REDEFINES BCSRF.
  3617         10  BCSRA PIC  X(0001).
  3618     05  BCSRI PIC  X(0004).
  3619*    -------------------------------
  3620     05  BBATCHL PIC S9(0004) COMP.
  3621     05  BBATCHF PIC  X(0001).
  3622     05  FILLER REDEFINES BBATCHF.
  3623         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  70
* EL6311.cbl
  3624     05  BBATCHI PIC  X(0006).
  3625*    -------------------------------
  3626     05  BSEQL PIC S9(0004) COMP.
  3627     05  BSEQF PIC  X(0001).
  3628     05  FILLER REDEFINES BSEQF.
  3629         10  BSEQA PIC  X(0001).
  3630     05  BSEQI PIC  X(0004).
  3631*    -------------------------------
  3632     05  BMOENDTL PIC S9(0004) COMP.
  3633     05  BMOENDTF PIC  X(0001).
  3634     05  FILLER REDEFINES BMOENDTF.
  3635         10  BMOENDTA PIC  X(0001).
  3636     05  BMOENDTI PIC  X(0008).
  3637*    -------------------------------
  3638     05  BCARRL PIC S9(0004) COMP.
  3639     05  BCARRF PIC  X(0001).
  3640     05  FILLER REDEFINES BCARRF.
  3641         10  BCARRA PIC  X(0001).
  3642     05  BCARRI PIC  X(0001).
  3643*    -------------------------------
  3644     05  BGROUPL PIC S9(0004) COMP.
  3645     05  BGROUPF PIC  X(0001).
  3646     05  FILLER REDEFINES BGROUPF.
  3647         10  BGROUPA PIC  X(0001).
  3648     05  BGROUPI PIC  X(0006).
  3649*    -------------------------------
  3650     05  BSTATEL PIC S9(0004) COMP.
  3651     05  BSTATEF PIC  X(0001).
  3652     05  FILLER REDEFINES BSTATEF.
  3653         10  BSTATEA PIC  X(0001).
  3654     05  BSTATEI PIC  X(0002).
  3655*    -------------------------------
  3656     05  BACCTL PIC S9(0004) COMP.
  3657     05  BACCTF PIC  X(0001).
  3658     05  FILLER REDEFINES BACCTF.
  3659         10  BACCTA PIC  X(0001).
  3660     05  BACCTI PIC  X(0010).
  3661*    -------------------------------
  3662     05  BVINHL PIC S9(0004) COMP.
  3663     05  BVINHF PIC  X(0001).
  3664     05  FILLER REDEFINES BVINHF.
  3665         10  BVINHA PIC  X(0001).
  3666     05  BVINHI PIC  X(0004).
  3667*    -------------------------------
  3668     05  BVINL PIC S9(0004) COMP.
  3669     05  BVINF PIC  X(0001).
  3670     05  FILLER REDEFINES BVINF.
  3671         10  BVINA PIC  X(0001).
  3672     05  BVINI PIC  X(0017).
  3673*    -------------------------------
  3674     05  BREFHDGL PIC S9(0004) COMP.
  3675     05  BREFHDGF PIC  X(0001).
  3676     05  FILLER REDEFINES BREFHDGF.
  3677         10  BREFHDGA PIC  X(0001).
  3678     05  BREFHDGI PIC  X(0004).
  3679*    -------------------------------
  3680     05  BREFL PIC S9(0004) COMP.
  3681     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  71
* EL6311.cbl
  3682     05  FILLER REDEFINES BREFF.
  3683         10  BREFA PIC  X(0001).
  3684     05  BREFI PIC  X(0012).
  3685*    -------------------------------
  3686     05  LETRREQL PIC S9(0004) COMP.
  3687     05  LETRREQF PIC  X(0001).
  3688     05  FILLER REDEFINES LETRREQF.
  3689         10  LETRREQA PIC  X(0001).
  3690     05  LETRREQI PIC  X(0001).
  3691*    -------------------------------
  3692     05  BAGEDEFL PIC S9(0004) COMP.
  3693     05  BAGEDEFF PIC  X(0001).
  3694     05  FILLER REDEFINES BAGEDEFF.
  3695         10  BAGEDEFA PIC  X(0001).
  3696     05  BAGEDEFI PIC  X(0004).
  3697*    -------------------------------
  3698     05  BCERTNOL PIC S9(0004) COMP.
  3699     05  BCERTNOF PIC  X(0001).
  3700     05  FILLER REDEFINES BCERTNOF.
  3701         10  BCERTNOA PIC  X(0001).
  3702     05  BCERTNOI PIC  X(0010).
  3703*    -------------------------------
  3704     05  BSUFIXL PIC S9(0004) COMP.
  3705     05  BSUFIXF PIC  X(0001).
  3706     05  FILLER REDEFINES BSUFIXF.
  3707         10  BSUFIXA PIC  X(0001).
  3708     05  BSUFIXI PIC  X(0001).
  3709*    -------------------------------
  3710     05  BEFFDTL PIC S9(0004) COMP.
  3711     05  BEFFDTF PIC  X(0001).
  3712     05  FILLER REDEFINES BEFFDTF.
  3713         10  BEFFDTA PIC  X(0001).
  3714     05  BEFFDTI PIC  X(0008).
  3715*    -------------------------------
  3716     05  BLSTNML PIC S9(0004) COMP.
  3717     05  BLSTNMF PIC  X(0001).
  3718     05  FILLER REDEFINES BLSTNMF.
  3719         10  BLSTNMA PIC  X(0001).
  3720     05  BLSTNMI PIC  X(0015).
  3721*    -------------------------------
  3722     05  B1STNML PIC S9(0004) COMP.
  3723     05  B1STNMF PIC  X(0001).
  3724     05  FILLER REDEFINES B1STNMF.
  3725         10  B1STNMA PIC  X(0001).
  3726     05  B1STNMI PIC  X(0010).
  3727*    -------------------------------
  3728     05  BINITL PIC S9(0004) COMP.
  3729     05  BINITF PIC  X(0001).
  3730     05  FILLER REDEFINES BINITF.
  3731         10  BINITA PIC  X(0001).
  3732     05  BINITI PIC  X(0001).
  3733*    -------------------------------
  3734     05  BSEXL PIC S9(0004) COMP.
  3735     05  BSEXF PIC  X(0001).
  3736     05  FILLER REDEFINES BSEXF.
  3737         10  BSEXA PIC  X(0001).
  3738     05  BSEXI PIC  X(0001).
  3739*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  72
* EL6311.cbl
  3740     05  BAGEL PIC S9(0004) COMP.
  3741     05  BAGEF PIC  X(0001).
  3742     05  FILLER REDEFINES BAGEF.
  3743         10  BAGEA PIC  X(0001).
  3744     05  BAGEI PIC  X(0002).
  3745*    -------------------------------
  3746     05  BBIRTHL PIC S9(0004) COMP.
  3747     05  BBIRTHF PIC  X(0001).
  3748     05  FILLER REDEFINES BBIRTHF.
  3749         10  BBIRTHA PIC  X(0001).
  3750     05  BBIRTHI PIC  X(0008).
  3751*    -------------------------------
  3752     05  B1STPMTL PIC S9(0004) COMP.
  3753     05  B1STPMTF PIC  X(0001).
  3754     05  FILLER REDEFINES B1STPMTF.
  3755         10  B1STPMTA PIC  X(0001).
  3756     05  B1STPMTI PIC  X(0008).
  3757*    -------------------------------
  3758     05  BDAYSL PIC S9(0004) COMP.
  3759     05  BDAYSF PIC  X(0001).
  3760     05  FILLER REDEFINES BDAYSF.
  3761         10  BDAYSA PIC  X(0001).
  3762     05  BDAYSI PIC  X(0003).
  3763*    -------------------------------
  3764     05  BLNTRML PIC S9(0004) COMP.
  3765     05  BLNTRMF PIC  X(0001).
  3766     05  FILLER REDEFINES BLNTRMF.
  3767         10  BLNTRMA PIC  X(0001).
  3768     05  BLNTRMI PIC  X(0003).
  3769*    -------------------------------
  3770     05  BLNOFCRL PIC S9(0004) COMP.
  3771     05  BLNOFCRF PIC  X(0001).
  3772     05  FILLER REDEFINES BLNOFCRF.
  3773         10  BLNOFCRA PIC  X(0001).
  3774     05  BLNOFCRI PIC  X(0005).
  3775*    -------------------------------
  3776     05  BMODEL PIC S9(0004) COMP.
  3777     05  BMODEF PIC  X(0001).
  3778     05  FILLER REDEFINES BMODEF.
  3779         10  BMODEA PIC  X(0001).
  3780     05  BMODEI PIC  X(0001).
  3781*    -------------------------------
  3782     05  BFREQL PIC S9(0004) COMP.
  3783     05  BFREQF PIC  X(0001).
  3784     05  FILLER REDEFINES BFREQF.
  3785         10  BFREQA PIC  X(0001).
  3786     05  BFREQI PIC  X(0002).
  3787*    -------------------------------
  3788     05  BPMTSL PIC S9(0004) COMP.
  3789     05  BPMTSF PIC  X(0001).
  3790     05  FILLER REDEFINES BPMTSF.
  3791         10  BPMTSA PIC  X(0001).
  3792     05  BPMTSI PIC  999.
  3793*    -------------------------------
  3794     05  BPMTAMTL PIC S9(0004) COMP.
  3795     05  BPMTAMTF PIC  X(0001).
  3796     05  FILLER REDEFINES BPMTAMTF.
  3797         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  73
* EL6311.cbl
  3798     05  BPMTAMTI PIC  9(7)V99.
  3799*    -------------------------------
  3800     05  BAPRL PIC S9(0004) COMP.
  3801     05  BAPRF PIC  X(0001).
  3802     05  FILLER REDEFINES BAPRF.
  3803         10  BAPRA PIC  X(0001).
  3804     05  BAPRI PIC  X(7).
  3805*    -------------------------------
  3806     05  BLIVESL PIC S9(0004) COMP.
  3807     05  BLIVESF PIC  X(0001).
  3808     05  FILLER REDEFINES BLIVESF.
  3809         10  BLIVESA PIC  X(0001).
  3810     05  BLIVESI PIC  X(0009).
  3811*    -------------------------------
  3812     05  BMEMCAPL PIC S9(0004) COMP.
  3813     05  BMEMCAPF PIC  X(0001).
  3814     05  FILLER REDEFINES BMEMCAPF.
  3815         10  BMEMCAPA PIC  X(0001).
  3816     05  BMEMCAPI PIC  X(0011).
  3817*    -------------------------------
  3818     05  BORIGHDL PIC S9(0004) COMP.
  3819     05  BORIGHDF PIC  X(0001).
  3820     05  FILLER REDEFINES BORIGHDF.
  3821         10  BORIGHDA PIC  X(0001).
  3822     05  BORIGHDI PIC  X(0009).
  3823*    -------------------------------
  3824     05  DMDBILL PIC S9(0004) COMP.
  3825     05  DMDBILF PIC  X(0001).
  3826     05  FILLER REDEFINES DMDBILF.
  3827         10  DMDBILA PIC  X(0001).
  3828     05  DMDBILI PIC  X(0006).
  3829*    -------------------------------
  3830     05  BFORCEL PIC S9(0004) COMP.
  3831     05  BFORCEF PIC  X(0001).
  3832     05  FILLER REDEFINES BFORCEF.
  3833         10  BFORCEA PIC  X(0001).
  3834     05  BFORCEI PIC  X(0001).
  3835*    -------------------------------
  3836     05  BENTRYL PIC S9(0004) COMP.
  3837     05  BENTRYF PIC  X(0001).
  3838     05  FILLER REDEFINES BENTRYF.
  3839         10  BENTRYA PIC  X(0001).
  3840     05  BENTRYI PIC  X(0001).
  3841*    -------------------------------
  3842     05  BREINL PIC S9(0004) COMP.
  3843     05  BREINF PIC  X(0001).
  3844     05  FILLER REDEFINES BREINF.
  3845         10  BREINA PIC  X(0001).
  3846     05  BREINI PIC  X(0001).
  3847*    -------------------------------
  3848     05  BBILCDL PIC S9(0004) COMP.
  3849     05  BBILCDF PIC  X(0001).
  3850     05  FILLER REDEFINES BBILCDF.
  3851         10  BBILCDA PIC  X(0001).
  3852     05  BBILCDI PIC  X(0001).
  3853*    -------------------------------
  3854     05  BUNWRITL PIC S9(0004) COMP.
  3855     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  74
* EL6311.cbl
  3856     05  FILLER REDEFINES BUNWRITF.
  3857         10  BUNWRITA PIC  X(0001).
  3858     05  BUNWRITI PIC  X(0001).
  3859*    -------------------------------
  3860     05  BSKPCDL PIC S9(0004) COMP.
  3861     05  BSKPCDF PIC  X(0001).
  3862     05  FILLER REDEFINES BSKPCDF.
  3863         10  BSKPCDA PIC  X(0001).
  3864     05  BSKPCDI PIC  X(0001).
  3865*    -------------------------------
  3866     05  BINDGRPL PIC S9(0004) COMP.
  3867     05  BINDGRPF PIC  X(0001).
  3868     05  FILLER REDEFINES BINDGRPF.
  3869         10  BINDGRPA PIC  X(0001).
  3870     05  BINDGRPI PIC  X(0001).
  3871*    -------------------------------
  3872     05  BSIGL PIC S9(0004) COMP.
  3873     05  BSIGF PIC  X(0001).
  3874     05  FILLER REDEFINES BSIGF.
  3875         10  BSIGA PIC  X(0001).
  3876     05  BSIGI PIC  X(0001).
  3877*    -------------------------------
  3878     05  BRTCLSL PIC S9(0004) COMP.
  3879     05  BRTCLSF PIC  X(0001).
  3880     05  FILLER REDEFINES BRTCLSF.
  3881         10  BRTCLSA PIC  X(0001).
  3882     05  BRTCLSI PIC  X(0002).
  3883*    -------------------------------
  3884     05  BCHGCNTL PIC S9(0004) COMP.
  3885     05  BCHGCNTF PIC  X(0001).
  3886     05  FILLER REDEFINES BCHGCNTF.
  3887         10  BCHGCNTA PIC  X(0001).
  3888     05  BCHGCNTI PIC  X(0003).
  3889*    -------------------------------
  3890     05  BMEMBERL PIC S9(0004) COMP.
  3891     05  BMEMBERF PIC  X(0001).
  3892     05  FILLER REDEFINES BMEMBERF.
  3893         10  BMEMBERA PIC  X(0001).
  3894     05  BMEMBERI PIC  X(0012).
  3895*    -------------------------------
  3896     05  BORGNOL PIC S9(0004) COMP.
  3897     05  BORGNOF PIC  X(0001).
  3898     05  FILLER REDEFINES BORGNOF.
  3899         10  BORGNOA PIC  X(0001).
  3900     05  BORGNOI PIC  X(0006).
  3901*    -------------------------------
  3902     05  BORGSEQL PIC S9(0004) COMP.
  3903     05  BORGSEQF PIC  X(0001).
  3904     05  FILLER REDEFINES BORGSEQF.
  3905         10  BORGSEQA PIC  X(0001).
  3906     05  BORGSEQI PIC  X(0004).
  3907*    -------------------------------
  3908     05  BBILLEDL PIC S9(0004) COMP.
  3909     05  BBILLEDF PIC  X(0001).
  3910     05  FILLER REDEFINES BBILLEDF.
  3911         10  BBILLEDA PIC  X(0001).
  3912     05  BBILLEDI PIC  9(9).
  3913*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  75
* EL6311.cbl
  3914     05  BKIND1L PIC S9(0004) COMP.
  3915     05  BKIND1F PIC  X(0001).
  3916     05  FILLER REDEFINES BKIND1F.
  3917         10  BKIND1A PIC  X(0001).
  3918     05  BKIND1I PIC  X(0002).
  3919*    -------------------------------
  3920     05  BTYPE1L PIC S9(0004) COMP.
  3921     05  BTYPE1F PIC  X(0001).
  3922     05  FILLER REDEFINES BTYPE1F.
  3923         10  BTYPE1A PIC  X(0001).
  3924     05  BTYPE1I PIC  X(0003).
  3925*    -------------------------------
  3926     05  BTERM1L PIC S9(0004) COMP.
  3927     05  BTERM1F PIC  X(0001).
  3928     05  FILLER REDEFINES BTERM1F.
  3929         10  BTERM1A PIC  X(0001).
  3930     05  BTERM1I PIC  X(0003).
  3931*    -------------------------------
  3932     05  BBEN1L PIC S9(0004) COMP.
  3933     05  BBEN1F PIC  X(0001).
  3934     05  FILLER REDEFINES BBEN1F.
  3935         10  BBEN1A PIC  X(0001).
  3936     05  BBEN1I PIC  X(0012).
  3937*    -------------------------------
  3938     05  BPREM1L PIC S9(0004) COMP.
  3939     05  BPREM1F PIC  X(0001).
  3940     05  FILLER REDEFINES BPREM1F.
  3941         10  BPREM1A PIC  X(0001).
  3942     05  BPREM1I PIC  X(0011).
  3943*    -------------------------------
  3944     05  BEXPIR1L PIC S9(0004) COMP.
  3945     05  BEXPIR1F PIC  X(0001).
  3946     05  FILLER REDEFINES BEXPIR1F.
  3947         10  BEXPIR1A PIC  X(0001).
  3948     05  BEXPIR1I PIC  X(0008).
  3949*    -------------------------------
  3950     05  BCP1L PIC S9(0004) COMP.
  3951     05  BCP1F PIC  X(0001).
  3952     05  FILLER REDEFINES BCP1F.
  3953         10  BCP1A PIC  X(0001).
  3954     05  BCP1I PIC  X(0002).
  3955*    -------------------------------
  3956     05  BALTBN1L PIC S9(0004) COMP.
  3957     05  BALTBN1F PIC  X(0001).
  3958     05  FILLER REDEFINES BALTBN1F.
  3959         10  BALTBN1A PIC  X(0001).
  3960     05  BALTBN1I PIC  X(0012).
  3961*    -------------------------------
  3962     05  BALTPR1L PIC S9(0004) COMP.
  3963     05  BALTPR1F PIC  X(0001).
  3964     05  FILLER REDEFINES BALTPR1F.
  3965         10  BALTPR1A PIC  X(0001).
  3966     05  BALTPR1I PIC  X(0011).
  3967*    -------------------------------
  3968     05  BBNCD1L PIC S9(0004) COMP.
  3969     05  BBNCD1F PIC  X(0001).
  3970     05  FILLER REDEFINES BBNCD1F.
  3971         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  76
* EL6311.cbl
  3972     05  BBNCD1I PIC  X(0003).
  3973*    -------------------------------
  3974     05  BCPRM1L PIC S9(0004) COMP.
  3975     05  BCPRM1F PIC  X(0001).
  3976     05  FILLER REDEFINES BCPRM1F.
  3977         10  BCPRM1A PIC  X(0001).
  3978     05  BCPRM1I PIC  X(0011).
  3979*    -------------------------------
  3980     05  BCAPRM1L PIC S9(0004) COMP.
  3981     05  BCAPRM1F PIC  X(0001).
  3982     05  FILLER REDEFINES BCAPRM1F.
  3983         10  BCAPRM1A PIC  X(0001).
  3984     05  BCAPRM1I PIC  X(0011).
  3985*    -------------------------------
  3986     05  BENABR1L PIC S9(0004) COMP.
  3987     05  BENABR1F PIC  X(0001).
  3988     05  FILLER REDEFINES BENABR1F.
  3989         10  BENABR1A PIC  X(0001).
  3990     05  BENABR1I PIC  X(0005).
  3991*    -------------------------------
  3992     05  BDIFF1L PIC S9(0004) COMP.
  3993     05  BDIFF1F PIC  X(0001).
  3994     05  FILLER REDEFINES BDIFF1F.
  3995         10  BDIFF1A PIC  X(0001).
  3996     05  BDIFF1I PIC  X(0011).
  3997*    -------------------------------
  3998     05  BBILIT1L PIC S9(0004) COMP.
  3999     05  BBILIT1F PIC  X(0001).
  4000     05  FILLER REDEFINES BBILIT1F.
  4001         10  BBILIT1A PIC  X(0001).
  4002     05  BBILIT1I PIC  X(0008).
  4003*    -------------------------------
  4004     05  BADIFF1L PIC S9(0004) COMP.
  4005     05  BADIFF1F PIC  X(0001).
  4006     05  FILLER REDEFINES BADIFF1F.
  4007         10  BADIFF1A PIC  X(0001).
  4008     05  BADIFF1I PIC  X(0011).
  4009*    -------------------------------
  4010     05  BKIND2L PIC S9(0004) COMP.
  4011     05  BKIND2F PIC  X(0001).
  4012     05  FILLER REDEFINES BKIND2F.
  4013         10  BKIND2A PIC  X(0001).
  4014     05  BKIND2I PIC  X(0002).
  4015*    -------------------------------
  4016     05  BTYPE2L PIC S9(0004) COMP.
  4017     05  BTYPE2F PIC  X(0001).
  4018     05  FILLER REDEFINES BTYPE2F.
  4019         10  BTYPE2A PIC  X(0001).
  4020     05  BTYPE2I PIC  X(0003).
  4021*    -------------------------------
  4022     05  BTERM2L PIC S9(0004) COMP.
  4023     05  BTERM2F PIC  X(0001).
  4024     05  FILLER REDEFINES BTERM2F.
  4025         10  BTERM2A PIC  X(0001).
  4026     05  BTERM2I PIC  X(0003).
  4027*    -------------------------------
  4028     05  BBEN2L PIC S9(0004) COMP.
  4029     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  77
* EL6311.cbl
  4030     05  FILLER REDEFINES BBEN2F.
  4031         10  BBEN2A PIC  X(0001).
  4032     05  BBEN2I PIC  X(0012).
  4033*    -------------------------------
  4034     05  BPREM2L PIC S9(0004) COMP.
  4035     05  BPREM2F PIC  X(0001).
  4036     05  FILLER REDEFINES BPREM2F.
  4037         10  BPREM2A PIC  X(0001).
  4038     05  BPREM2I PIC  X(0011).
  4039*    -------------------------------
  4040     05  BEXPIR2L PIC S9(0004) COMP.
  4041     05  BEXPIR2F PIC  X(0001).
  4042     05  FILLER REDEFINES BEXPIR2F.
  4043         10  BEXPIR2A PIC  X(0001).
  4044     05  BEXPIR2I PIC  X(0008).
  4045*    -------------------------------
  4046     05  BCP2L PIC S9(0004) COMP.
  4047     05  BCP2F PIC  X(0001).
  4048     05  FILLER REDEFINES BCP2F.
  4049         10  BCP2A PIC  X(0001).
  4050     05  BCP2I PIC  X(0002).
  4051*    -------------------------------
  4052     05  BALTBN2L PIC S9(0004) COMP.
  4053     05  BALTBN2F PIC  X(0001).
  4054     05  FILLER REDEFINES BALTBN2F.
  4055         10  BALTBN2A PIC  X(0001).
  4056     05  BALTBN2I PIC  X(0012).
  4057*    -------------------------------
  4058     05  BALTPR2L PIC S9(0004) COMP.
  4059     05  BALTPR2F PIC  X(0001).
  4060     05  FILLER REDEFINES BALTPR2F.
  4061         10  BALTPR2A PIC  X(0001).
  4062     05  BALTPR2I PIC  X(0011).
  4063*    -------------------------------
  4064     05  BBNCD2L PIC S9(0004) COMP.
  4065     05  BBNCD2F PIC  X(0001).
  4066     05  FILLER REDEFINES BBNCD2F.
  4067         10  BBNCD2A PIC  X(0001).
  4068     05  BBNCD2I PIC  X(0003).
  4069*    -------------------------------
  4070     05  BCPRM2L PIC S9(0004) COMP.
  4071     05  BCPRM2F PIC  X(0001).
  4072     05  FILLER REDEFINES BCPRM2F.
  4073         10  BCPRM2A PIC  X(0001).
  4074     05  BCPRM2I PIC  X(0011).
  4075*    -------------------------------
  4076     05  BCAPRM2L PIC S9(0004) COMP.
  4077     05  BCAPRM2F PIC  X(0001).
  4078     05  FILLER REDEFINES BCAPRM2F.
  4079         10  BCAPRM2A PIC  X(0001).
  4080     05  BCAPRM2I PIC  X(0011).
  4081*    -------------------------------
  4082     05  BENABR2L PIC S9(0004) COMP.
  4083     05  BENABR2F PIC  X(0001).
  4084     05  FILLER REDEFINES BENABR2F.
  4085         10  BENABR2A PIC  X(0001).
  4086     05  BENABR2I PIC  X(0005).
  4087*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  78
* EL6311.cbl
  4088     05  BDIFF2L PIC S9(0004) COMP.
  4089     05  BDIFF2F PIC  X(0001).
  4090     05  FILLER REDEFINES BDIFF2F.
  4091         10  BDIFF2A PIC  X(0001).
  4092     05  BDIFF2I PIC  X(0011).
  4093*    -------------------------------
  4094     05  BBILIT2L PIC S9(0004) COMP.
  4095     05  BBILIT2F PIC  X(0001).
  4096     05  FILLER REDEFINES BBILIT2F.
  4097         10  BBILIT2A PIC  X(0001).
  4098     05  BBILIT2I PIC  X(0008).
  4099*    -------------------------------
  4100     05  BADIFF2L PIC S9(0004) COMP.
  4101     05  BADIFF2F PIC  X(0001).
  4102     05  FILLER REDEFINES BADIFF2F.
  4103         10  BADIFF2A PIC  X(0001).
  4104     05  BADIFF2I PIC  X(0011).
  4105*    -------------------------------
  4106     05  BERMSG1L PIC S9(0004) COMP.
  4107     05  BERMSG1F PIC  X(0001).
  4108     05  FILLER REDEFINES BERMSG1F.
  4109         10  BERMSG1A PIC  X(0001).
  4110     05  BERMSG1I PIC  X(0078).
  4111*    -------------------------------
  4112     05  BERMSG2L PIC S9(0004) COMP.
  4113     05  BERMSG2F PIC  X(0001).
  4114     05  FILLER REDEFINES BERMSG2F.
  4115         10  BERMSG2A PIC  X(0001).
  4116     05  BERMSG2I PIC  X(0078).
  4117*    -------------------------------
  4118     05  BERMSG3L PIC S9(0004) COMP.
  4119     05  BERMSG3F PIC  X(0001).
  4120     05  FILLER REDEFINES BERMSG3F.
  4121         10  BERMSG3A PIC  X(0001).
  4122     05  BERMSG3I PIC  X(0078).
  4123*    -------------------------------
  4124     05  BPFENTRL PIC S9(0004) COMP.
  4125     05  BPFENTRF PIC  X(0001).
  4126     05  FILLER REDEFINES BPFENTRF.
  4127         10  BPFENTRA PIC  X(0001).
  4128     05  BPFENTRI PIC  9(2).
  4129*    -------------------------------
  4130     05  BPF5HDRL PIC S9(0004) COMP.
  4131     05  BPF5HDRF PIC  X(0001).
  4132     05  FILLER REDEFINES BPF5HDRF.
  4133         10  BPF5HDRA PIC  X(0001).
  4134     05  BPF5HDRI PIC  X(0005).
  4135*    -------------------------------
  4136     05  BPF4HDRL PIC S9(0004) COMP.
  4137     05  BPF4HDRF PIC  X(0001).
  4138     05  FILLER REDEFINES BPF4HDRF.
  4139         10  BPF4HDRA PIC  X(0001).
  4140     05  BPF4HDRI PIC  X(0013).
  4141*    -------------------------------
  4142     05  BF15HDRL PIC S9(0004) COMP.
  4143     05  BF15HDRF PIC  X(0001).
  4144     05  FILLER REDEFINES BF15HDRF.
  4145         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  79
* EL6311.cbl
  4146     05  BF15HDRI PIC  X(0010).
  4147 01  EL631BO REDEFINES EL631BI.
  4148     05  FILLER            PIC  X(0012).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BDATEO PIC  X(0008).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BTIMEO PIC  99.99.
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BHEADO PIC  X(0038).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BNCERTLO PIC  X(0008).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BNCERTO PIC  X(0011).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BNSTATLO PIC  X(0009).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BNSTATO PIC  X(0002).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BCHGTO PIC  X(0004).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BCHGO PIC  ZZZ9.
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BCOMPIDO PIC  X(0003).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BREGIONO PIC  X(0006).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BUSERO PIC  X(0004).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BMAINTO PIC  X(0001).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BMANTBYO PIC  X(0004).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BCHGHDGO PIC  X(0003).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BMANTDTO PIC  X(0008).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BMANTATO PIC  99.99.
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BCSRO PIC  X(0004).
  4203*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  80
* EL6311.cbl
  4204     05  FILLER            PIC  X(0003).
  4205     05  BBATCHO PIC  X(0006).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BSEQO PIC  X(0004).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BMOENDTO PIC  X(0008).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BCARRO PIC  X(0001).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BGROUPO PIC  X(0006).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BSTATEO PIC  X(0002).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BACCTO PIC  X(0010).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BVINHO PIC  X(0004).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BVINO PIC  X(0017).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BREFHDGO PIC  X(0004).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BREFO PIC  X(0012).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  LETRREQO PIC  X(0001).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BAGEDEFO PIC  X(0004).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BCERTNOO PIC  X(0010).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BSUFIXO PIC  X(0001).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  BEFFDTO PIC  X(0008).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BLSTNMO PIC  X(0015).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  B1STNMO PIC  X(0010).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BINITO PIC  X(0001).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  81
* EL6311.cbl
  4262     05  BSEXO PIC  X(0001).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BAGEO PIC  X(0002).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  BBIRTHO PIC  X(0008).
  4269*    -------------------------------
  4270     05  FILLER            PIC  X(0003).
  4271     05  B1STPMTO PIC  X(0008).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
  4274     05  BDAYSO PIC  X(0003).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
  4277     05  BLNTRMO PIC  X(0003).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BLNOFCRO PIC  X(0005).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  BMODEO PIC  X(0001).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  BFREQO PIC  X(0002).
  4287*    -------------------------------
  4288     05  FILLER            PIC  X(0003).
  4289     05  BPMTSO PIC  X(0003).
  4290*    -------------------------------
  4291     05  FILLER            PIC  X(0003).
  4292     05  BPMTAMTO PIC  ZZZZZ9.99.
  4293*    -------------------------------
  4294     05  FILLER            PIC  X(0003).
  4295     05  BAPRO PIC  99.9999.
  4296*    -------------------------------
  4297     05  FILLER            PIC  X(0003).
  4298     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4299*    -------------------------------
  4300     05  FILLER            PIC  X(0003).
  4301     05  BMEMCAPO PIC  X(0011).
  4302*    -------------------------------
  4303     05  FILLER            PIC  X(0003).
  4304     05  BORIGHDO PIC  X(0009).
  4305*    -------------------------------
  4306     05  FILLER            PIC  X(0003).
  4307     05  DMDBILO PIC  X(0006).
  4308*    -------------------------------
  4309     05  FILLER            PIC  X(0003).
  4310     05  BFORCEO PIC  X(0001).
  4311*    -------------------------------
  4312     05  FILLER            PIC  X(0003).
  4313     05  BENTRYO PIC  X(0001).
  4314*    -------------------------------
  4315     05  FILLER            PIC  X(0003).
  4316     05  BREINO PIC  X(0001).
  4317*    -------------------------------
  4318     05  FILLER            PIC  X(0003).
  4319     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  82
* EL6311.cbl
  4320*    -------------------------------
  4321     05  FILLER            PIC  X(0003).
  4322     05  BUNWRITO PIC  X(0001).
  4323*    -------------------------------
  4324     05  FILLER            PIC  X(0003).
  4325     05  BSKPCDO PIC  X(0001).
  4326*    -------------------------------
  4327     05  FILLER            PIC  X(0003).
  4328     05  BINDGRPO PIC  X(0001).
  4329*    -------------------------------
  4330     05  FILLER            PIC  X(0003).
  4331     05  BSIGO PIC  X(0001).
  4332*    -------------------------------
  4333     05  FILLER            PIC  X(0003).
  4334     05  BRTCLSO PIC  X(0002).
  4335*    -------------------------------
  4336     05  FILLER            PIC  X(0003).
  4337     05  BCHGCNTO PIC  X(0003).
  4338*    -------------------------------
  4339     05  FILLER            PIC  X(0003).
  4340     05  BMEMBERO PIC  X(0012).
  4341*    -------------------------------
  4342     05  FILLER            PIC  X(0003).
  4343     05  BORGNOO PIC  X(0006).
  4344*    -------------------------------
  4345     05  FILLER            PIC  X(0003).
  4346     05  BORGSEQO PIC  X(0004).
  4347*    -------------------------------
  4348     05  FILLER            PIC  X(0003).
  4349     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4350*    -------------------------------
  4351     05  FILLER            PIC  X(0003).
  4352     05  BKIND1O PIC  X(0002).
  4353*    -------------------------------
  4354     05  FILLER            PIC  X(0003).
  4355     05  BTYPE1O PIC  X(0003).
  4356*    -------------------------------
  4357     05  FILLER            PIC  X(0003).
  4358     05  BTERM1O PIC  X(0003).
  4359*    -------------------------------
  4360     05  FILLER            PIC  X(0003).
  4361     05  BBEN1O PIC  X(0012).
  4362*    -------------------------------
  4363     05  FILLER            PIC  X(0003).
  4364     05  BPREM1O PIC  X(0011).
  4365*    -------------------------------
  4366     05  FILLER            PIC  X(0003).
  4367     05  BEXPIR1O PIC  X(0008).
  4368*    -------------------------------
  4369     05  FILLER            PIC  X(0003).
  4370     05  BCP1O PIC  X(0002).
  4371*    -------------------------------
  4372     05  FILLER            PIC  X(0003).
  4373     05  BALTBN1O PIC  X(0012).
  4374*    -------------------------------
  4375     05  FILLER            PIC  X(0003).
  4376     05  BALTPR1O PIC  X(0011).
  4377*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  83
* EL6311.cbl
  4378     05  FILLER            PIC  X(0003).
  4379     05  BBNCD1O PIC  X(0003).
  4380*    -------------------------------
  4381     05  FILLER            PIC  X(0003).
  4382     05  BCPRM1O PIC  X(0011).
  4383*    -------------------------------
  4384     05  FILLER            PIC  X(0003).
  4385     05  BCAPRM1O PIC  X(0011).
  4386*    -------------------------------
  4387     05  FILLER            PIC  X(0003).
  4388     05  BENABR1O PIC  X(0005).
  4389*    -------------------------------
  4390     05  FILLER            PIC  X(0003).
  4391     05  BDIFF1O PIC  X(0011).
  4392*    -------------------------------
  4393     05  FILLER            PIC  X(0003).
  4394     05  BBILIT1O PIC  X(0008).
  4395*    -------------------------------
  4396     05  FILLER            PIC  X(0003).
  4397     05  BADIFF1O PIC  X(0011).
  4398*    -------------------------------
  4399     05  FILLER            PIC  X(0003).
  4400     05  BKIND2O PIC  X(0002).
  4401*    -------------------------------
  4402     05  FILLER            PIC  X(0003).
  4403     05  BTYPE2O PIC  X(0003).
  4404*    -------------------------------
  4405     05  FILLER            PIC  X(0003).
  4406     05  BTERM2O PIC  X(0003).
  4407*    -------------------------------
  4408     05  FILLER            PIC  X(0003).
  4409     05  BBEN2O PIC  X(0012).
  4410*    -------------------------------
  4411     05  FILLER            PIC  X(0003).
  4412     05  BPREM2O PIC  X(0011).
  4413*    -------------------------------
  4414     05  FILLER            PIC  X(0003).
  4415     05  BEXPIR2O PIC  X(0008).
  4416*    -------------------------------
  4417     05  FILLER            PIC  X(0003).
  4418     05  BCP2O PIC  X(0002).
  4419*    -------------------------------
  4420     05  FILLER            PIC  X(0003).
  4421     05  BALTBN2O PIC  X(0012).
  4422*    -------------------------------
  4423     05  FILLER            PIC  X(0003).
  4424     05  BALTPR2O PIC  X(0011).
  4425*    -------------------------------
  4426     05  FILLER            PIC  X(0003).
  4427     05  BBNCD2O PIC  X(0003).
  4428*    -------------------------------
  4429     05  FILLER            PIC  X(0003).
  4430     05  BCPRM2O PIC  X(0011).
  4431*    -------------------------------
  4432     05  FILLER            PIC  X(0003).
  4433     05  BCAPRM2O PIC  X(0011).
  4434*    -------------------------------
  4435     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  84
* EL6311.cbl
  4436     05  BENABR2O PIC  X(0005).
  4437*    -------------------------------
  4438     05  FILLER            PIC  X(0003).
  4439     05  BDIFF2O PIC  X(0011).
  4440*    -------------------------------
  4441     05  FILLER            PIC  X(0003).
  4442     05  BBILIT2O PIC  X(0008).
  4443*    -------------------------------
  4444     05  FILLER            PIC  X(0003).
  4445     05  BADIFF2O PIC  X(0011).
  4446*    -------------------------------
  4447     05  FILLER            PIC  X(0003).
  4448     05  BERMSG1O PIC  X(0078).
  4449*    -------------------------------
  4450     05  FILLER            PIC  X(0003).
  4451     05  BERMSG2O PIC  X(0078).
  4452*    -------------------------------
  4453     05  FILLER            PIC  X(0003).
  4454     05  BERMSG3O PIC  X(0078).
  4455*    -------------------------------
  4456     05  FILLER            PIC  X(0003).
  4457     05  BPFENTRO PIC  X(0002).
  4458*    -------------------------------
  4459     05  FILLER            PIC  X(0003).
  4460     05  BPF5HDRO PIC  X(0005).
  4461*    -------------------------------
  4462     05  FILLER            PIC  X(0003).
  4463     05  BPF4HDRO PIC  X(0013).
  4464*    -------------------------------
  4465     05  FILLER            PIC  X(0003).
  4466     05  BF15HDRO PIC  X(0010).
  4467*    -------------------------------
  4468 01  EL631CI REDEFINES EL631BI.
  4469     05  FILLER            PIC  X(0012).
  4470*    -------------------------------
  4471     05  CDATEL PIC S9(0004) COMP.
  4472     05  CDATEF PIC  X(0001).
  4473     05  FILLER REDEFINES CDATEF.
  4474         10  CDATEA PIC  X(0001).
  4475     05  CDATEI PIC  X(0008).
  4476*    -------------------------------
  4477     05  CTIMEL PIC S9(0004) COMP.
  4478     05  CTIMEF PIC  X(0001).
  4479     05  FILLER REDEFINES CTIMEF.
  4480         10  CTIMEA PIC  X(0001).
  4481     05  CTIMEI PIC  X(0005).
  4482*    -------------------------------
  4483     05  CHEADL PIC S9(0004) COMP.
  4484     05  CHEADF PIC  X(0001).
  4485     05  FILLER REDEFINES CHEADF.
  4486         10  CHEADA PIC  X(0001).
  4487     05  CHEADI PIC  X(0038).
  4488*    -------------------------------
  4489     05  CCHGTL PIC S9(0004) COMP.
  4490     05  CCHGTF PIC  X(0001).
  4491     05  FILLER REDEFINES CCHGTF.
  4492         10  CCHGTA PIC  X(0001).
  4493     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  85
* EL6311.cbl
  4494*    -------------------------------
  4495     05  CCHGL PIC S9(0004) COMP.
  4496     05  CCHGF PIC  X(0001).
  4497     05  FILLER REDEFINES CCHGF.
  4498         10  CCHGA PIC  X(0001).
  4499     05  CCHGI PIC  X(0004).
  4500*    -------------------------------
  4501     05  CMAINTL PIC S9(0004) COMP.
  4502     05  CMAINTF PIC  X(0001).
  4503     05  FILLER REDEFINES CMAINTF.
  4504         10  CMAINTA PIC  X(0001).
  4505     05  CMAINTI PIC  X(0001).
  4506*    -------------------------------
  4507     05  CMANTBYL PIC S9(0004) COMP.
  4508     05  CMANTBYF PIC  X(0001).
  4509     05  FILLER REDEFINES CMANTBYF.
  4510         10  CMANTBYA PIC  X(0001).
  4511     05  CMANTBYI PIC  X(0004).
  4512*    -------------------------------
  4513     05  CCHGHDGL PIC S9(0004) COMP.
  4514     05  CCHGHDGF PIC  X(0001).
  4515     05  FILLER REDEFINES CCHGHDGF.
  4516         10  CCHGHDGA PIC  X(0001).
  4517     05  CCHGHDGI PIC  X(0003).
  4518*    -------------------------------
  4519     05  CMANTDTL PIC S9(0004) COMP.
  4520     05  CMANTDTF PIC  X(0001).
  4521     05  FILLER REDEFINES CMANTDTF.
  4522         10  CMANTDTA PIC  X(0001).
  4523     05  CMANTDTI PIC  X(0008).
  4524*    -------------------------------
  4525     05  CMANTATL PIC S9(0004) COMP.
  4526     05  CMANTATF PIC  X(0001).
  4527     05  FILLER REDEFINES CMANTATF.
  4528         10  CMANTATA PIC  X(0001).
  4529     05  CMANTATI PIC  X(0005).
  4530*    -------------------------------
  4531     05  CCSRL PIC S9(0004) COMP.
  4532     05  CCSRF PIC  X(0001).
  4533     05  FILLER REDEFINES CCSRF.
  4534         10  CCSRA PIC  X(0001).
  4535     05  CCSRI PIC  X(0004).
  4536*    -------------------------------
  4537     05  CBATCHL PIC S9(0004) COMP.
  4538     05  CBATCHF PIC  X(0001).
  4539     05  FILLER REDEFINES CBATCHF.
  4540         10  CBATCHA PIC  X(0001).
  4541     05  CBATCHI PIC  X(0006).
  4542*    -------------------------------
  4543     05  CSEQL PIC S9(0004) COMP.
  4544     05  CSEQF PIC  X(0001).
  4545     05  FILLER REDEFINES CSEQF.
  4546         10  CSEQA PIC  X(0001).
  4547     05  CSEQI PIC  X(0004).
  4548*    -------------------------------
  4549     05  CMOENDTL PIC S9(0004) COMP.
  4550     05  CMOENDTF PIC  X(0001).
  4551     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  86
* EL6311.cbl
  4552         10  CMOENDTA PIC  X(0001).
  4553     05  CMOENDTI PIC  X(0008).
  4554*    -------------------------------
  4555     05  CCARRL PIC S9(0004) COMP.
  4556     05  CCARRF PIC  X(0001).
  4557     05  FILLER REDEFINES CCARRF.
  4558         10  CCARRA PIC  X(0001).
  4559     05  CCARRI PIC  X(0001).
  4560*    -------------------------------
  4561     05  CGROUPL PIC S9(0004) COMP.
  4562     05  CGROUPF PIC  X(0001).
  4563     05  FILLER REDEFINES CGROUPF.
  4564         10  CGROUPA PIC  X(0001).
  4565     05  CGROUPI PIC  X(0006).
  4566*    -------------------------------
  4567     05  CSTATEL PIC S9(0004) COMP.
  4568     05  CSTATEF PIC  X(0001).
  4569     05  FILLER REDEFINES CSTATEF.
  4570         10  CSTATEA PIC  X(0001).
  4571     05  CSTATEI PIC  X(0002).
  4572*    -------------------------------
  4573     05  CACCTL PIC S9(0004) COMP.
  4574     05  CACCTF PIC  X(0001).
  4575     05  FILLER REDEFINES CACCTF.
  4576         10  CACCTA PIC  X(0001).
  4577     05  CACCTI PIC  X(0010).
  4578*    -------------------------------
  4579     05  CORIGHDL PIC S9(0004) COMP.
  4580     05  CORIGHDF PIC  X(0001).
  4581     05  FILLER REDEFINES CORIGHDF.
  4582         10  CORIGHDA PIC  X(0001).
  4583     05  CORIGHDI PIC  X(0011).
  4584*    -------------------------------
  4585     05  CORGNOL PIC S9(0004) COMP.
  4586     05  CORGNOF PIC  X(0001).
  4587     05  FILLER REDEFINES CORGNOF.
  4588         10  CORGNOA PIC  X(0001).
  4589     05  CORGNOI PIC  X(0006).
  4590*    -------------------------------
  4591     05  CORGSEQL PIC S9(0004) COMP.
  4592     05  CORGSEQF PIC  X(0001).
  4593     05  FILLER REDEFINES CORGSEQF.
  4594         10  CORGSEQA PIC  X(0001).
  4595     05  CORGSEQI PIC  X(0004).
  4596*    -------------------------------
  4597     05  CREFHDGL PIC S9(0004) COMP.
  4598     05  CREFHDGF PIC  X(0001).
  4599     05  FILLER REDEFINES CREFHDGF.
  4600         10  CREFHDGA PIC  X(0001).
  4601     05  CREFHDGI PIC  X(0010).
  4602*    -------------------------------
  4603     05  CREFL PIC S9(0004) COMP.
  4604     05  CREFF PIC  X(0001).
  4605     05  FILLER REDEFINES CREFF.
  4606         10  CREFA PIC  X(0001).
  4607     05  CREFI PIC  X(0012).
  4608*    -------------------------------
  4609     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  87
* EL6311.cbl
  4610     05  CNHINTF PIC  X(0001).
  4611     05  FILLER REDEFINES CNHINTF.
  4612         10  CNHINTA PIC  X(0001).
  4613     05  CNHINTI PIC  9(7)V99.
  4614*    -------------------------------
  4615     05  CCERTNOL PIC S9(0004) COMP.
  4616     05  CCERTNOF PIC  X(0001).
  4617     05  FILLER REDEFINES CCERTNOF.
  4618         10  CCERTNOA PIC  X(0001).
  4619     05  CCERTNOI PIC  X(0010).
  4620*    -------------------------------
  4621     05  CSUFIXL PIC S9(0004) COMP.
  4622     05  CSUFIXF PIC  X(0001).
  4623     05  FILLER REDEFINES CSUFIXF.
  4624         10  CSUFIXA PIC  X(0001).
  4625     05  CSUFIXI PIC  X(0001).
  4626*    -------------------------------
  4627     05  CEFFDTL PIC S9(0004) COMP.
  4628     05  CEFFDTF PIC  X(0001).
  4629     05  FILLER REDEFINES CEFFDTF.
  4630         10  CEFFDTA PIC  X(0001).
  4631     05  CEFFDTI PIC  X(0008).
  4632*    -------------------------------
  4633     05  CLSTNML PIC S9(0004) COMP.
  4634     05  CLSTNMF PIC  X(0001).
  4635     05  FILLER REDEFINES CLSTNMF.
  4636         10  CLSTNMA PIC  X(0001).
  4637     05  CLSTNMI PIC  X(0015).
  4638*    -------------------------------
  4639     05  CPCYNL PIC S9(0004) COMP.
  4640     05  CPCYNF PIC  X(0001).
  4641     05  FILLER REDEFINES CPCYNF.
  4642         10  CPCYNA PIC  X(0001).
  4643     05  CPCYNI PIC  X(0001).
  4644*    -------------------------------
  4645     05  CINAMEL PIC S9(0004) COMP.
  4646     05  CINAMEF PIC  X(0001).
  4647     05  FILLER REDEFINES CINAMEF.
  4648         10  CINAMEA PIC  X(0001).
  4649     05  CINAMEI PIC  X(0015).
  4650*    -------------------------------
  4651     05  CINITSL PIC S9(0004) COMP.
  4652     05  CINITSF PIC  X(0001).
  4653     05  FILLER REDEFINES CINITSF.
  4654         10  CINITSA PIC  X(0001).
  4655     05  CINITSI PIC  X(0010).
  4656*    -------------------------------
  4657     05  CCANREAL PIC S9(0004) COMP.
  4658     05  CCANREAF PIC  X(0001).
  4659     05  FILLER REDEFINES CCANREAF.
  4660         10  CCANREAA PIC  X(0001).
  4661     05  CCANREAI PIC  X(0001).
  4662*    -------------------------------
  4663     05  ACTSPCL PIC S9(0004) COMP.
  4664     05  ACTSPCF PIC  X(0001).
  4665     05  FILLER REDEFINES ACTSPCF.
  4666         10  ACTSPCA PIC  X(0001).
  4667     05  ACTSPCI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  88
* EL6311.cbl
  4668*    -------------------------------
  4669     05  CKIND1L PIC S9(0004) COMP.
  4670     05  CKIND1F PIC  X(0001).
  4671     05  FILLER REDEFINES CKIND1F.
  4672         10  CKIND1A PIC  X(0001).
  4673     05  CKIND1I PIC  X(0002).
  4674*    -------------------------------
  4675     05  CCANDT1L PIC S9(0004) COMP.
  4676     05  CCANDT1F PIC  X(0001).
  4677     05  FILLER REDEFINES CCANDT1F.
  4678         10  CCANDT1A PIC  X(0001).
  4679     05  CCANDT1I PIC  X(0008).
  4680*    -------------------------------
  4681     05  CREFND1L PIC S9(0004) COMP.
  4682     05  CREFND1F PIC  X(0001).
  4683     05  FILLER REDEFINES CREFND1F.
  4684         10  CREFND1A PIC  X(0001).
  4685     05  CREFND1I PIC  S9(9)V99.
  4686*    -------------------------------
  4687     05  CMTHD1L PIC S9(0004) COMP.
  4688     05  CMTHD1F PIC  X(0001).
  4689     05  FILLER REDEFINES CMTHD1F.
  4690         10  CMTHD1A PIC  X(0001).
  4691     05  CMTHD1I PIC  X(0001).
  4692*    -------------------------------
  4693     05  CKIND2L PIC S9(0004) COMP.
  4694     05  CKIND2F PIC  X(0001).
  4695     05  FILLER REDEFINES CKIND2F.
  4696         10  CKIND2A PIC  X(0001).
  4697     05  CKIND2I PIC  X(0002).
  4698*    -------------------------------
  4699     05  CCANDT2L PIC S9(0004) COMP.
  4700     05  CCANDT2F PIC  X(0001).
  4701     05  FILLER REDEFINES CCANDT2F.
  4702         10  CCANDT2A PIC  X(0001).
  4703     05  CCANDT2I PIC  X(0008).
  4704*    -------------------------------
  4705     05  CREFND2L PIC S9(0004) COMP.
  4706     05  CREFND2F PIC  X(0001).
  4707     05  FILLER REDEFINES CREFND2F.
  4708         10  CREFND2A PIC  X(0001).
  4709     05  CREFND2I PIC  S9(9)V99.
  4710*    -------------------------------
  4711     05  CMTHD2L PIC S9(0004) COMP.
  4712     05  CMTHD2F PIC  X(0001).
  4713     05  FILLER REDEFINES CMTHD2F.
  4714         10  CMTHD2A PIC  X(0001).
  4715     05  CMTHD2I PIC  X(0001).
  4716*    -------------------------------
  4717     05  CLIVESL PIC S9(0004) COMP.
  4718     05  CLIVESF PIC  X(0001).
  4719     05  FILLER REDEFINES CLIVESF.
  4720         10  CLIVESA PIC  X(0001).
  4721     05  CLIVESI PIC  X(0003).
  4722*    -------------------------------
  4723     05  CFORCEL PIC S9(0004) COMP.
  4724     05  CFORCEF PIC  X(0001).
  4725     05  FILLER REDEFINES CFORCEF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  89
* EL6311.cbl
  4726         10  CFORCEA PIC  X(0001).
  4727     05  CFORCEI PIC  X(0001).
  4728*    -------------------------------
  4729     05  CBILCDL PIC S9(0004) COMP.
  4730     05  CBILCDF PIC  X(0001).
  4731     05  FILLER REDEFINES CBILCDF.
  4732         10  CBILCDA PIC  X(0001).
  4733     05  CBILCDI PIC  X(0001).
  4734*    -------------------------------
  4735     05  CCRFND1L PIC S9(0004) COMP.
  4736     05  CCRFND1F PIC  X(0001).
  4737     05  FILLER REDEFINES CCRFND1F.
  4738         10  CCRFND1A PIC  X(0001).
  4739     05  CCRFND1I PIC  X(0011).
  4740*    -------------------------------
  4741     05  CCRFND2L PIC S9(0004) COMP.
  4742     05  CCRFND2F PIC  X(0001).
  4743     05  FILLER REDEFINES CCRFND2F.
  4744         10  CCRFND2A PIC  X(0001).
  4745     05  CCRFND2I PIC  X(0011).
  4746*    -------------------------------
  4747     05  CBILIT1L PIC S9(0004) COMP.
  4748     05  CBILIT1F PIC  X(0001).
  4749     05  FILLER REDEFINES CBILIT1F.
  4750         10  CBILIT1A PIC  X(0001).
  4751     05  CBILIT1I PIC  X(0008).
  4752*    -------------------------------
  4753     05  CDRFND1L PIC S9(0004) COMP.
  4754     05  CDRFND1F PIC  X(0001).
  4755     05  FILLER REDEFINES CDRFND1F.
  4756         10  CDRFND1A PIC  X(0001).
  4757     05  CDRFND1I PIC  X(0011).
  4758*    -------------------------------
  4759     05  CBILIT2L PIC S9(0004) COMP.
  4760     05  CBILIT2F PIC  X(0001).
  4761     05  FILLER REDEFINES CBILIT2F.
  4762         10  CBILIT2A PIC  X(0001).
  4763     05  CBILIT2I PIC  X(0008).
  4764*    -------------------------------
  4765     05  CDRFND2L PIC S9(0004) COMP.
  4766     05  CDRFND2F PIC  X(0001).
  4767     05  FILLER REDEFINES CDRFND2F.
  4768         10  CDRFND2A PIC  X(0001).
  4769     05  CDRFND2I PIC  X(0011).
  4770*    -------------------------------
  4771     05  CCANTXTL PIC S9(0004) COMP.
  4772     05  CCANTXTF PIC  X(0001).
  4773     05  FILLER REDEFINES CCANTXTF.
  4774         10  CCANTXTA PIC  X(0001).
  4775     05  CCANTXTI PIC  X(0005).
  4776*    -------------------------------
  4777     05  CCANFEEL PIC S9(0004) COMP.
  4778     05  CCANFEEF PIC  X(0001).
  4779     05  FILLER REDEFINES CCANFEEF.
  4780         10  CCANFEEA PIC  X(0001).
  4781     05  CCANFEEI PIC  X(0002).
  4782*    -------------------------------
  4783     05  CTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  90
* EL6311.cbl
  4784     05  CTERM1F PIC  X(0001).
  4785     05  FILLER REDEFINES CTERM1F.
  4786         10  CTERM1A PIC  X(0001).
  4787     05  CTERM1I PIC  X(0003).
  4788*    -------------------------------
  4789     05  CRTERM1L PIC S9(0004) COMP.
  4790     05  CRTERM1F PIC  X(0001).
  4791     05  FILLER REDEFINES CRTERM1F.
  4792         10  CRTERM1A PIC  X(0001).
  4793     05  CRTERM1I PIC  X(0003).
  4794*    -------------------------------
  4795     05  CPREM1L PIC S9(0004) COMP.
  4796     05  CPREM1F PIC  X(0001).
  4797     05  FILLER REDEFINES CPREM1F.
  4798         10  CPREM1A PIC  X(0001).
  4799     05  CPREM1I PIC  X(0011).
  4800*    -------------------------------
  4801     05  CTERM2L PIC S9(0004) COMP.
  4802     05  CTERM2F PIC  X(0001).
  4803     05  FILLER REDEFINES CTERM2F.
  4804         10  CTERM2A PIC  X(0001).
  4805     05  CTERM2I PIC  X(0003).
  4806*    -------------------------------
  4807     05  CRTERM2L PIC S9(0004) COMP.
  4808     05  CRTERM2F PIC  X(0001).
  4809     05  FILLER REDEFINES CRTERM2F.
  4810         10  CRTERM2A PIC  X(0001).
  4811     05  CRTERM2I PIC  X(0003).
  4812*    -------------------------------
  4813     05  CPREM2L PIC S9(0004) COMP.
  4814     05  CPREM2F PIC  X(0001).
  4815     05  FILLER REDEFINES CPREM2F.
  4816         10  CPREM2A PIC  X(0001).
  4817     05  CPREM2I PIC  X(0011).
  4818*    -------------------------------
  4819     05  CENTRDTL PIC S9(0004) COMP.
  4820     05  CENTRDTF PIC  X(0001).
  4821     05  FILLER REDEFINES CENTRDTF.
  4822         10  CENTRDTA PIC  X(0001).
  4823     05  CENTRDTI PIC  X(0008).
  4824*    -------------------------------
  4825     05  CPAYEEL PIC S9(0004) COMP.
  4826     05  CPAYEEF PIC  X(0001).
  4827     05  FILLER REDEFINES CPAYEEF.
  4828         10  CPAYEEA PIC  X(0001).
  4829     05  CPAYEEI PIC  X(0006).
  4830*    -------------------------------
  4831     05  CRFNDSWL PIC S9(0004) COMP.
  4832     05  CRFNDSWF PIC  X(0001).
  4833     05  FILLER REDEFINES CRFNDSWF.
  4834         10  CRFNDSWA PIC  X(0001).
  4835     05  CRFNDSWI PIC  X(0003).
  4836*    -------------------------------
  4837     05  CLFHDGL PIC S9(0004) COMP.
  4838     05  CLFHDGF PIC  X(0001).
  4839     05  FILLER REDEFINES CLFHDGF.
  4840         10  CLFHDGA PIC  X(0001).
  4841     05  CLFHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  91
* EL6311.cbl
  4842*    -------------------------------
  4843     05  CAHHDGL PIC S9(0004) COMP.
  4844     05  CAHHDGF PIC  X(0001).
  4845     05  FILLER REDEFINES CAHHDGF.
  4846         10  CAHHDGA PIC  X(0001).
  4847     05  CAHHDGI PIC  X(0006).
  4848*    -------------------------------
  4849     05  CENTDTL PIC S9(0004) COMP.
  4850     05  CENTDTF PIC  X(0001).
  4851     05  FILLER REDEFINES CENTDTF.
  4852         10  CENTDTA PIC  X(0001).
  4853     05  CENTDTI PIC  X(0008).
  4854*    -------------------------------
  4855     05  CENTBYL PIC S9(0004) COMP.
  4856     05  CENTBYF PIC  X(0001).
  4857     05  FILLER REDEFINES CENTBYF.
  4858         10  CENTBYA PIC  X(0001).
  4859     05  CENTBYI PIC  X(0004).
  4860*    -------------------------------
  4861     05  CCHGCNTL PIC S9(0004) COMP.
  4862     05  CCHGCNTF PIC  X(0001).
  4863     05  FILLER REDEFINES CCHGCNTF.
  4864         10  CCHGCNTA PIC  X(0001).
  4865     05  CCHGCNTI PIC  X(0003).
  4866*    -------------------------------
  4867     05  CLFREFNL PIC S9(0004) COMP.
  4868     05  CLFREFNF PIC  X(0001).
  4869     05  FILLER REDEFINES CLFREFNF.
  4870         10  CLFREFNA PIC  X(0001).
  4871     05  CLFREFNI PIC  X(0006).
  4872*    -------------------------------
  4873     05  CAHREFNL PIC S9(0004) COMP.
  4874     05  CAHREFNF PIC  X(0001).
  4875     05  FILLER REDEFINES CAHREFNF.
  4876         10  CAHREFNA PIC  X(0001).
  4877     05  CAHREFNI PIC  X(0006).
  4878*    -------------------------------
  4879     05  CREINCDL PIC S9(0004) COMP.
  4880     05  CREINCDF PIC  X(0001).
  4881     05  FILLER REDEFINES CREINCDF.
  4882         10  CREINCDA PIC  X(0001).
  4883     05  CREINCDI PIC  X(0003).
  4884*    -------------------------------
  4885     05  CAEFFDTL PIC S9(0004) COMP.
  4886     05  CAEFFDTF PIC  X(0001).
  4887     05  FILLER REDEFINES CAEFFDTF.
  4888         10  CAEFFDTA PIC  X(0001).
  4889     05  CAEFFDTI PIC  X(0008).
  4890*    -------------------------------
  4891     05  CAEXPDTL PIC S9(0004) COMP.
  4892     05  CAEXPDTF PIC  X(0001).
  4893     05  FILLER REDEFINES CAEXPDTF.
  4894         10  CAEXPDTA PIC  X(0001).
  4895     05  CAEXPDTI PIC  X(0008).
  4896*    -------------------------------
  4897     05  COMMLFL PIC S9(0004) COMP.
  4898     05  COMMLFF PIC  X(0001).
  4899     05  FILLER REDEFINES COMMLFF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  92
* EL6311.cbl
  4900         10  COMMLFA PIC  X(0001).
  4901     05  COMMLFI PIC  X(0006).
  4902*    -------------------------------
  4903     05  COMMAHL PIC S9(0004) COMP.
  4904     05  COMMAHF PIC  X(0001).
  4905     05  FILLER REDEFINES COMMAHF.
  4906         10  COMMAHA PIC  X(0001).
  4907     05  COMMAHI PIC  X(0006).
  4908*    -------------------------------
  4909     05  CERMSG1L PIC S9(0004) COMP.
  4910     05  CERMSG1F PIC  X(0001).
  4911     05  FILLER REDEFINES CERMSG1F.
  4912         10  CERMSG1A PIC  X(0001).
  4913     05  CERMSG1I PIC  X(0078).
  4914*    -------------------------------
  4915     05  CERMSG2L PIC S9(0004) COMP.
  4916     05  CERMSG2F PIC  X(0001).
  4917     05  FILLER REDEFINES CERMSG2F.
  4918         10  CERMSG2A PIC  X(0001).
  4919     05  CERMSG2I PIC  X(0078).
  4920*    -------------------------------
  4921     05  CERMSG3L PIC S9(0004) COMP.
  4922     05  CERMSG3F PIC  X(0001).
  4923     05  FILLER REDEFINES CERMSG3F.
  4924         10  CERMSG3A PIC  X(0001).
  4925     05  CERMSG3I PIC  X(0078).
  4926*    -------------------------------
  4927     05  CPFENTRL PIC S9(0004) COMP.
  4928     05  CPFENTRF PIC  X(0001).
  4929     05  FILLER REDEFINES CPFENTRF.
  4930         10  CPFENTRA PIC  X(0001).
  4931     05  CPFENTRI PIC  9(2).
  4932*    -------------------------------
  4933     05  CPF5HDRL PIC S9(0004) COMP.
  4934     05  CPF5HDRF PIC  X(0001).
  4935     05  FILLER REDEFINES CPF5HDRF.
  4936         10  CPF5HDRA PIC  X(0001).
  4937     05  CPF5HDRI PIC  X(0005).
  4938*    -------------------------------
  4939     05  CPF4HDRL PIC S9(0004) COMP.
  4940     05  CPF4HDRF PIC  X(0001).
  4941     05  FILLER REDEFINES CPF4HDRF.
  4942         10  CPF4HDRA PIC  X(0001).
  4943     05  CPF4HDRI PIC  X(0013).
  4944*    -------------------------------
  4945     05  CF15HDRL PIC S9(0004) COMP.
  4946     05  CF15HDRF PIC  X(0001).
  4947     05  FILLER REDEFINES CF15HDRF.
  4948         10  CF15HDRA PIC  X(0001).
  4949     05  CF15HDRI PIC  X(0022).
  4950 01  EL631CO REDEFINES EL631BI.
  4951     05  FILLER            PIC  X(0012).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CDATEO PIC  X(0008).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CTIMEO PIC  99.99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  93
* EL6311.cbl
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CHEADO PIC  X(0038).
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CCHGTO PIC  X(0004).
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CCHGO PIC  ZZZ9.
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CMAINTO PIC  X(0001).
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CMANTBYO PIC  X(0004).
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CCHGHDGO PIC  X(0003).
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CMANTDTO PIC  X(0008).
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  CMANTATO PIC  99.99.
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CCSRO PIC  X(0004).
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CBATCHO PIC  X(0006).
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CSEQO PIC  X(0004).
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CMOENDTO PIC  X(0008).
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CCARRO PIC  X(0001).
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CGROUPO PIC  X(0006).
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CSTATEO PIC  X(0002).
  5003*    -------------------------------
  5004     05  FILLER            PIC  X(0003).
  5005     05  CACCTO PIC  X(0010).
  5006*    -------------------------------
  5007     05  FILLER            PIC  X(0003).
  5008     05  CORIGHDO PIC  X(0011).
  5009*    -------------------------------
  5010     05  FILLER            PIC  X(0003).
  5011     05  CORGNOO PIC  X(0006).
  5012*    -------------------------------
  5013     05  FILLER            PIC  X(0003).
  5014     05  CORGSEQO PIC  X(0004).
  5015*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  94
* EL6311.cbl
  5016     05  FILLER            PIC  X(0003).
  5017     05  CREFHDGO PIC  X(0010).
  5018*    -------------------------------
  5019     05  FILLER            PIC  X(0003).
  5020     05  CREFO PIC  X(0012).
  5021*    -------------------------------
  5022     05  FILLER            PIC  X(0003).
  5023     05  CNHINTO PIC  ZZZZZ9.99.
  5024*    -------------------------------
  5025     05  FILLER            PIC  X(0003).
  5026     05  CCERTNOO PIC  X(0010).
  5027*    -------------------------------
  5028     05  FILLER            PIC  X(0003).
  5029     05  CSUFIXO PIC  X(0001).
  5030*    -------------------------------
  5031     05  FILLER            PIC  X(0003).
  5032     05  CEFFDTO PIC  X(0008).
  5033*    -------------------------------
  5034     05  FILLER            PIC  X(0003).
  5035     05  CLSTNMO PIC  X(0015).
  5036*    -------------------------------
  5037     05  FILLER            PIC  X(0003).
  5038     05  CPCYNO PIC  X(0001).
  5039*    -------------------------------
  5040     05  FILLER            PIC  X(0003).
  5041     05  CINAMEO PIC  X(0015).
  5042*    -------------------------------
  5043     05  FILLER            PIC  X(0003).
  5044     05  CINITSO PIC  X(0010).
  5045*    -------------------------------
  5046     05  FILLER            PIC  X(0003).
  5047     05  CCANREAO PIC  X(0001).
  5048*    -------------------------------
  5049     05  FILLER            PIC  X(0003).
  5050     05  ACTSPCO PIC  X(0001).
  5051*    -------------------------------
  5052     05  FILLER            PIC  X(0003).
  5053     05  CKIND1O PIC  X(0002).
  5054*    -------------------------------
  5055     05  FILLER            PIC  X(0003).
  5056     05  CCANDT1O PIC  X(0008).
  5057*    -------------------------------
  5058     05  FILLER            PIC  X(0003).
  5059     05  CREFND1O PIC  Z(7).99-.
  5060*    -------------------------------
  5061     05  FILLER            PIC  X(0003).
  5062     05  CMTHD1O PIC  X(0001).
  5063*    -------------------------------
  5064     05  FILLER            PIC  X(0003).
  5065     05  CKIND2O PIC  X(0002).
  5066*    -------------------------------
  5067     05  FILLER            PIC  X(0003).
  5068     05  CCANDT2O PIC  X(0008).
  5069*    -------------------------------
  5070     05  FILLER            PIC  X(0003).
  5071     05  CREFND2O PIC  Z(7).99-.
  5072*    -------------------------------
  5073     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  95
* EL6311.cbl
  5074     05  CMTHD2O PIC  X(0001).
  5075*    -------------------------------
  5076     05  FILLER            PIC  X(0003).
  5077     05  CLIVESO PIC  X(0003).
  5078*    -------------------------------
  5079     05  FILLER            PIC  X(0003).
  5080     05  CFORCEO PIC  X(0001).
  5081*    -------------------------------
  5082     05  FILLER            PIC  X(0003).
  5083     05  CBILCDO PIC  X(0001).
  5084*    -------------------------------
  5085     05  FILLER            PIC  X(0003).
  5086     05  CCRFND1O PIC  Z(7).99-.
  5087*    -------------------------------
  5088     05  FILLER            PIC  X(0003).
  5089     05  CCRFND2O PIC  Z(7).99-.
  5090*    -------------------------------
  5091     05  FILLER            PIC  X(0003).
  5092     05  CBILIT1O PIC  X(0008).
  5093*    -------------------------------
  5094     05  FILLER            PIC  X(0003).
  5095     05  CDRFND1O PIC  Z(7).99-.
  5096*    -------------------------------
  5097     05  FILLER            PIC  X(0003).
  5098     05  CBILIT2O PIC  X(0008).
  5099*    -------------------------------
  5100     05  FILLER            PIC  X(0003).
  5101     05  CDRFND2O PIC  Z(7).99-.
  5102*    -------------------------------
  5103     05  FILLER            PIC  X(0003).
  5104     05  CCANTXTO PIC  X(0005).
  5105*    -------------------------------
  5106     05  FILLER            PIC  X(0003).
  5107     05  CCANFEEO PIC  Z9.
  5108*    -------------------------------
  5109     05  FILLER            PIC  X(0003).
  5110     05  CTERM1O PIC  ZZ9.
  5111*    -------------------------------
  5112     05  FILLER            PIC  X(0003).
  5113     05  CRTERM1O PIC  ZZ9.
  5114*    -------------------------------
  5115     05  FILLER            PIC  X(0003).
  5116     05  CPREM1O PIC  ZZZZZZ9.99-.
  5117*    -------------------------------
  5118     05  FILLER            PIC  X(0003).
  5119     05  CTERM2O PIC  ZZ9.
  5120*    -------------------------------
  5121     05  FILLER            PIC  X(0003).
  5122     05  CRTERM2O PIC  ZZ9.
  5123*    -------------------------------
  5124     05  FILLER            PIC  X(0003).
  5125     05  CPREM2O PIC  ZZZZZZ9.99-.
  5126*    -------------------------------
  5127     05  FILLER            PIC  X(0003).
  5128     05  CENTRDTO PIC  X(0008).
  5129*    -------------------------------
  5130     05  FILLER            PIC  X(0003).
  5131     05  CPAYEEO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  96
* EL6311.cbl
  5132*    -------------------------------
  5133     05  FILLER            PIC  X(0003).
  5134     05  CRFNDSWO PIC  X(0003).
  5135*    -------------------------------
  5136     05  FILLER            PIC  X(0003).
  5137     05  CLFHDGO PIC  X(0006).
  5138*    -------------------------------
  5139     05  FILLER            PIC  X(0003).
  5140     05  CAHHDGO PIC  X(0006).
  5141*    -------------------------------
  5142     05  FILLER            PIC  X(0003).
  5143     05  CENTDTO PIC  X(0008).
  5144*    -------------------------------
  5145     05  FILLER            PIC  X(0003).
  5146     05  CENTBYO PIC  X(0004).
  5147*    -------------------------------
  5148     05  FILLER            PIC  X(0003).
  5149     05  CCHGCNTO PIC  X(0003).
  5150*    -------------------------------
  5151     05  FILLER            PIC  X(0003).
  5152     05  CLFREFNO PIC  X(0006).
  5153*    -------------------------------
  5154     05  FILLER            PIC  X(0003).
  5155     05  CAHREFNO PIC  X(0006).
  5156*    -------------------------------
  5157     05  FILLER            PIC  X(0003).
  5158     05  CREINCDO PIC  X(0003).
  5159*    -------------------------------
  5160     05  FILLER            PIC  X(0003).
  5161     05  CAEFFDTO PIC  X(0008).
  5162*    -------------------------------
  5163     05  FILLER            PIC  X(0003).
  5164     05  CAEXPDTO PIC  X(0008).
  5165*    -------------------------------
  5166     05  FILLER            PIC  X(0003).
  5167     05  COMMLFO PIC  .99999.
  5168*    -------------------------------
  5169     05  FILLER            PIC  X(0003).
  5170     05  COMMAHO PIC  .99999.
  5171*    -------------------------------
  5172     05  FILLER            PIC  X(0003).
  5173     05  CERMSG1O PIC  X(0078).
  5174*    -------------------------------
  5175     05  FILLER            PIC  X(0003).
  5176     05  CERMSG2O PIC  X(0078).
  5177*    -------------------------------
  5178     05  FILLER            PIC  X(0003).
  5179     05  CERMSG3O PIC  X(0078).
  5180*    -------------------------------
  5181     05  FILLER            PIC  X(0003).
  5182     05  CPFENTRO PIC  X(0002).
  5183*    -------------------------------
  5184     05  FILLER            PIC  X(0003).
  5185     05  CPF5HDRO PIC  X(0005).
  5186*    -------------------------------
  5187     05  FILLER            PIC  X(0003).
  5188     05  CPF4HDRO PIC  X(0013).
  5189*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  97
* EL6311.cbl
  5190     05  FILLER            PIC  X(0003).
  5191     05  CF15HDRO PIC  X(0022).
  5192*    -------------------------------
  5193 01  EL631DI REDEFINES EL631BI.
  5194     05  FILLER            PIC  X(0012).
  5195*    -------------------------------
  5196     05  DDATEL PIC S9(0004) COMP.
  5197     05  DDATEF PIC  X(0001).
  5198     05  FILLER REDEFINES DDATEF.
  5199         10  DDATEA PIC  X(0001).
  5200     05  DDATEI PIC  X(0008).
  5201*    -------------------------------
  5202     05  DTIMEL PIC S9(0004) COMP.
  5203     05  DTIMEF PIC  X(0001).
  5204     05  FILLER REDEFINES DTIMEF.
  5205         10  DTIMEA PIC  X(0001).
  5206     05  DTIMEI PIC  X(0005).
  5207*    -------------------------------
  5208     05  DHEADL PIC S9(0004) COMP.
  5209     05  DHEADF PIC  X(0001).
  5210     05  FILLER REDEFINES DHEADF.
  5211         10  DHEADA PIC  X(0001).
  5212     05  DHEADI PIC  X(0038).
  5213*    -------------------------------
  5214     05  DLDATEL PIC S9(0004) COMP.
  5215     05  DLDATEF PIC  X(0001).
  5216     05  FILLER REDEFINES DLDATEF.
  5217         10  DLDATEA PIC  X(0001).
  5218     05  DLDATEI PIC  X(0010).
  5219*    -------------------------------
  5220     05  DBATCHL PIC S9(0004) COMP.
  5221     05  DBATCHF PIC  X(0001).
  5222     05  FILLER REDEFINES DBATCHF.
  5223         10  DBATCHA PIC  X(0001).
  5224     05  DBATCHI PIC  X(0011).
  5225*    -------------------------------
  5226     05  DACCTNML PIC S9(0004) COMP.
  5227     05  DACCTNMF PIC  X(0001).
  5228     05  FILLER REDEFINES DACCTNMF.
  5229         10  DACCTNMA PIC  X(0001).
  5230     05  DACCTNMI PIC  X(0030).
  5231*    -------------------------------
  5232     05  DPROCDTL PIC S9(0004) COMP.
  5233     05  DPROCDTF PIC  X(0001).
  5234     05  FILLER REDEFINES DPROCDTF.
  5235         10  DPROCDTA PIC  X(0001).
  5236     05  DPROCDTI PIC  X(0008).
  5237*    -------------------------------
  5238     05  DINPUTL PIC S9(0004) COMP.
  5239     05  DINPUTF PIC  X(0001).
  5240     05  FILLER REDEFINES DINPUTF.
  5241         10  DINPUTA PIC  X(0001).
  5242     05  DINPUTI PIC  X(0008).
  5243*    -------------------------------
  5244     05  DMAINDTL PIC S9(0004) COMP.
  5245     05  DMAINDTF PIC  X(0001).
  5246     05  FILLER REDEFINES DMAINDTF.
  5247         10  DMAINDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  98
* EL6311.cbl
  5248     05  DMAINDTI PIC  X(0008).
  5249*    -------------------------------
  5250     05  DCARRL PIC S9(0004) COMP.
  5251     05  DCARRF PIC  X(0001).
  5252     05  FILLER REDEFINES DCARRF.
  5253         10  DCARRA PIC  X(0001).
  5254     05  DCARRI PIC  X(0001).
  5255*    -------------------------------
  5256     05  DGROUPL PIC S9(0004) COMP.
  5257     05  DGROUPF PIC  X(0001).
  5258     05  FILLER REDEFINES DGROUPF.
  5259         10  DGROUPA PIC  X(0001).
  5260     05  DGROUPI PIC  X(0006).
  5261*    -------------------------------
  5262     05  DSTATEL PIC S9(0004) COMP.
  5263     05  DSTATEF PIC  X(0001).
  5264     05  FILLER REDEFINES DSTATEF.
  5265         10  DSTATEA PIC  X(0001).
  5266     05  DSTATEI PIC  X(0002).
  5267*    -------------------------------
  5268     05  DACCTL PIC S9(0004) COMP.
  5269     05  DACCTF PIC  X(0001).
  5270     05  FILLER REDEFINES DACCTF.
  5271         10  DACCTA PIC  X(0001).
  5272     05  DACCTI PIC  X(0010).
  5273*    -------------------------------
  5274     05  DRECVDTL PIC S9(0004) COMP.
  5275     05  DRECVDTF PIC  X(0001).
  5276     05  FILLER REDEFINES DRECVDTF.
  5277         10  DRECVDTA PIC  X(0001).
  5278     05  DRECVDTI PIC  X(0008).
  5279*    -------------------------------
  5280     05  DCSRL PIC S9(0004) COMP.
  5281     05  DCSRF PIC  X(0001).
  5282     05  FILLER REDEFINES DCSRF.
  5283         10  DCSRA PIC  X(0001).
  5284     05  DCSRI PIC  X(0004).
  5285*    -------------------------------
  5286     05  DREFHDGL PIC S9(0004) COMP.
  5287     05  DREFHDGF PIC  X(0001).
  5288     05  FILLER REDEFINES DREFHDGF.
  5289         10  DREFHDGA PIC  X(0001).
  5290     05  DREFHDGI PIC  X(0010).
  5291*    -------------------------------
  5292     05  DREFL PIC S9(0004) COMP.
  5293     05  DREFF PIC  X(0001).
  5294     05  FILLER REDEFINES DREFF.
  5295         10  DREFA PIC  X(0001).
  5296     05  DREFI PIC  X(0012).
  5297*    -------------------------------
  5298     05  DLFPHDGL PIC S9(0004) COMP.
  5299     05  DLFPHDGF PIC  X(0001).
  5300     05  FILLER REDEFINES DLFPHDGF.
  5301         10  DLFPHDGA PIC  X(0001).
  5302     05  DLFPHDGI PIC  X(0010).
  5303*    -------------------------------
  5304     05  DAHPHDGL PIC S9(0004) COMP.
  5305     05  DAHPHDGF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page  99
* EL6311.cbl
  5306     05  FILLER REDEFINES DAHPHDGF.
  5307         10  DAHPHDGA PIC  X(0001).
  5308     05  DAHPHDGI PIC  X(0010).
  5309*    -------------------------------
  5310     05  DLFRHDGL PIC S9(0004) COMP.
  5311     05  DLFRHDGF PIC  X(0001).
  5312     05  FILLER REDEFINES DLFRHDGF.
  5313         10  DLFRHDGA PIC  X(0001).
  5314     05  DLFRHDGI PIC  X(0009).
  5315*    -------------------------------
  5316     05  DAHRHDGL PIC S9(0004) COMP.
  5317     05  DAHRHDGF PIC  X(0001).
  5318     05  FILLER REDEFINES DAHRHDGF.
  5319         10  DAHRHDGA PIC  X(0001).
  5320     05  DAHRHDGI PIC  X(0009).
  5321*    -------------------------------
  5322     05  DRISSL PIC S9(0004) COMP.
  5323     05  DRISSF PIC  X(0001).
  5324     05  FILLER REDEFINES DRISSF.
  5325         10  DRISSA PIC  X(0001).
  5326     05  DRISSI PIC  X(0005).
  5327*    -------------------------------
  5328     05  DRLFPRML PIC S9(0004) COMP.
  5329     05  DRLFPRMF PIC  X(0001).
  5330     05  FILLER REDEFINES DRLFPRMF.
  5331         10  DRLFPRMA PIC  X(0001).
  5332     05  DRLFPRMI PIC  S9(9)V99.
  5333*    -------------------------------
  5334     05  DRAHPRML PIC S9(0004) COMP.
  5335     05  DRAHPRMF PIC  X(0001).
  5336     05  FILLER REDEFINES DRAHPRMF.
  5337         10  DRAHPRMA PIC  X(0001).
  5338     05  DRAHPRMI PIC  S9(9)V99.
  5339*    -------------------------------
  5340     05  DRCANCL PIC S9(0004) COMP.
  5341     05  DRCANCF PIC  X(0001).
  5342     05  FILLER REDEFINES DRCANCF.
  5343         10  DRCANCA PIC  X(0001).
  5344     05  DRCANCI PIC  X(0005).
  5345*    -------------------------------
  5346     05  DRLFRFDL PIC S9(0004) COMP.
  5347     05  DRLFRFDF PIC  X(0001).
  5348     05  FILLER REDEFINES DRLFRFDF.
  5349         10  DRLFRFDA PIC  X(0001).
  5350     05  DRLFRFDI PIC  S9(9)V99.
  5351*    -------------------------------
  5352     05  DRAHRFDL PIC S9(0004) COMP.
  5353     05  DRAHRFDF PIC  X(0001).
  5354     05  FILLER REDEFINES DRAHRFDF.
  5355         10  DRAHRFDA PIC  X(0001).
  5356     05  DRAHRFDI PIC  S9(9)V99.
  5357*    -------------------------------
  5358     05  DEISSL PIC S9(0004) COMP.
  5359     05  DEISSF PIC  X(0001).
  5360     05  FILLER REDEFINES DEISSF.
  5361         10  DEISSA PIC  X(0001).
  5362     05  DEISSI PIC  X(0005).
  5363*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 100
* EL6311.cbl
  5364     05  DELFPRML PIC S9(0004) COMP.
  5365     05  DELFPRMF PIC  X(0001).
  5366     05  FILLER REDEFINES DELFPRMF.
  5367         10  DELFPRMA PIC  X(0001).
  5368     05  DELFPRMI PIC  X(0011).
  5369*    -------------------------------
  5370     05  DEAHPRML PIC S9(0004) COMP.
  5371     05  DEAHPRMF PIC  X(0001).
  5372     05  FILLER REDEFINES DEAHPRMF.
  5373         10  DEAHPRMA PIC  X(0001).
  5374     05  DEAHPRMI PIC  X(0011).
  5375*    -------------------------------
  5376     05  DECANCL PIC S9(0004) COMP.
  5377     05  DECANCF PIC  X(0001).
  5378     05  FILLER REDEFINES DECANCF.
  5379         10  DECANCA PIC  X(0001).
  5380     05  DECANCI PIC  X(0005).
  5381*    -------------------------------
  5382     05  DELFRFDL PIC S9(0004) COMP.
  5383     05  DELFRFDF PIC  X(0001).
  5384     05  FILLER REDEFINES DELFRFDF.
  5385         10  DELFRFDA PIC  X(0001).
  5386     05  DELFRFDI PIC  X(0011).
  5387*    -------------------------------
  5388     05  DEAHRFDL PIC S9(0004) COMP.
  5389     05  DEAHRFDF PIC  X(0001).
  5390     05  FILLER REDEFINES DEAHRFDF.
  5391         10  DEAHRFDA PIC  X(0001).
  5392     05  DEAHRFDI PIC  X(0011).
  5393*    -------------------------------
  5394     05  DCISSL PIC S9(0004) COMP.
  5395     05  DCISSF PIC  X(0001).
  5396     05  FILLER REDEFINES DCISSF.
  5397         10  DCISSA PIC  X(0001).
  5398     05  DCISSI PIC  X(0005).
  5399*    -------------------------------
  5400     05  DCLFPRML PIC S9(0004) COMP.
  5401     05  DCLFPRMF PIC  X(0001).
  5402     05  FILLER REDEFINES DCLFPRMF.
  5403         10  DCLFPRMA PIC  X(0001).
  5404     05  DCLFPRMI PIC  X(0011).
  5405*    -------------------------------
  5406     05  DCAHPRML PIC S9(0004) COMP.
  5407     05  DCAHPRMF PIC  X(0001).
  5408     05  FILLER REDEFINES DCAHPRMF.
  5409         10  DCAHPRMA PIC  X(0001).
  5410     05  DCAHPRMI PIC  X(0011).
  5411*    -------------------------------
  5412     05  DCCANCL PIC S9(0004) COMP.
  5413     05  DCCANCF PIC  X(0001).
  5414     05  FILLER REDEFINES DCCANCF.
  5415         10  DCCANCA PIC  X(0001).
  5416     05  DCCANCI PIC  X(0005).
  5417*    -------------------------------
  5418     05  DCLFRFDL PIC S9(0004) COMP.
  5419     05  DCLFRFDF PIC  X(0001).
  5420     05  FILLER REDEFINES DCLFRFDF.
  5421         10  DCLFRFDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 101
* EL6311.cbl
  5422     05  DCLFRFDI PIC  X(0011).
  5423*    -------------------------------
  5424     05  DCAHRFDL PIC S9(0004) COMP.
  5425     05  DCAHRFDF PIC  X(0001).
  5426     05  FILLER REDEFINES DCAHRFDF.
  5427         10  DCAHRFDA PIC  X(0001).
  5428     05  DCAHRFDI PIC  X(0011).
  5429*    -------------------------------
  5430     05  DOISSL PIC S9(0004) COMP.
  5431     05  DOISSF PIC  X(0001).
  5432     05  FILLER REDEFINES DOISSF.
  5433         10  DOISSA PIC  X(0001).
  5434     05  DOISSI PIC  X(0005).
  5435*    -------------------------------
  5436     05  DOLFPRML PIC S9(0004) COMP.
  5437     05  DOLFPRMF PIC  X(0001).
  5438     05  FILLER REDEFINES DOLFPRMF.
  5439         10  DOLFPRMA PIC  X(0001).
  5440     05  DOLFPRMI PIC  X(0011).
  5441*    -------------------------------
  5442     05  DOAHPRML PIC S9(0004) COMP.
  5443     05  DOAHPRMF PIC  X(0001).
  5444     05  FILLER REDEFINES DOAHPRMF.
  5445         10  DOAHPRMA PIC  X(0001).
  5446     05  DOAHPRMI PIC  X(0011).
  5447*    -------------------------------
  5448     05  DOCANCL PIC S9(0004) COMP.
  5449     05  DOCANCF PIC  X(0001).
  5450     05  FILLER REDEFINES DOCANCF.
  5451         10  DOCANCA PIC  X(0001).
  5452     05  DOCANCI PIC  X(0005).
  5453*    -------------------------------
  5454     05  DOLFRFDL PIC S9(0004) COMP.
  5455     05  DOLFRFDF PIC  X(0001).
  5456     05  FILLER REDEFINES DOLFRFDF.
  5457         10  DOLFRFDA PIC  X(0001).
  5458     05  DOLFRFDI PIC  X(0011).
  5459*    -------------------------------
  5460     05  DOAHRFDL PIC S9(0004) COMP.
  5461     05  DOAHRFDF PIC  X(0001).
  5462     05  FILLER REDEFINES DOAHRFDF.
  5463         10  DOAHRFDA PIC  X(0001).
  5464     05  DOAHRFDI PIC  X(0011).
  5465*    -------------------------------
  5466     05  DITOTALL PIC S9(0004) COMP.
  5467     05  DITOTALF PIC  X(0001).
  5468     05  FILLER REDEFINES DITOTALF.
  5469         10  DITOTALA PIC  X(0001).
  5470     05  DITOTALI PIC  X(0005).
  5471*    -------------------------------
  5472     05  DIFATALL PIC S9(0004) COMP.
  5473     05  DIFATALF PIC  X(0001).
  5474     05  FILLER REDEFINES DIFATALF.
  5475         10  DIFATALA PIC  X(0001).
  5476     05  DIFATALI PIC  X(0005).
  5477*    -------------------------------
  5478     05  DIFORCEL PIC S9(0004) COMP.
  5479     05  DIFORCEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 102
* EL6311.cbl
  5480     05  FILLER REDEFINES DIFORCEF.
  5481         10  DIFORCEA PIC  X(0001).
  5482     05  DIFORCEI PIC  X(0005).
  5483*    -------------------------------
  5484     05  DIHOLDL PIC S9(0004) COMP.
  5485     05  DIHOLDF PIC  X(0001).
  5486     05  FILLER REDEFINES DIHOLDF.
  5487         10  DIHOLDA PIC  X(0001).
  5488     05  DIHOLDI PIC  X(0005).
  5489*    -------------------------------
  5490     05  DIAVAILL PIC S9(0004) COMP.
  5491     05  DIAVAILF PIC  X(0001).
  5492     05  FILLER REDEFINES DIAVAILF.
  5493         10  DIAVAILA PIC  X(0001).
  5494     05  DIAVAILI PIC  X(0005).
  5495*    -------------------------------
  5496     05  DIGPREML PIC S9(0004) COMP.
  5497     05  DIGPREMF PIC  X(0001).
  5498     05  FILLER REDEFINES DIGPREMF.
  5499         10  DIGPREMA PIC  X(0001).
  5500     05  DIGPREMI PIC  X(0011).
  5501*    -------------------------------
  5502     05  DIBPREML PIC S9(0004) COMP.
  5503     05  DIBPREMF PIC  X(0001).
  5504     05  FILLER REDEFINES DIBPREMF.
  5505         10  DIBPREMA PIC  X(0001).
  5506     05  DIBPREMI PIC  X(0011).
  5507*    -------------------------------
  5508     05  DCTOTALL PIC S9(0004) COMP.
  5509     05  DCTOTALF PIC  X(0001).
  5510     05  FILLER REDEFINES DCTOTALF.
  5511         10  DCTOTALA PIC  X(0001).
  5512     05  DCTOTALI PIC  X(0005).
  5513*    -------------------------------
  5514     05  DCFATALL PIC S9(0004) COMP.
  5515     05  DCFATALF PIC  X(0001).
  5516     05  FILLER REDEFINES DCFATALF.
  5517         10  DCFATALA PIC  X(0001).
  5518     05  DCFATALI PIC  X(0005).
  5519*    -------------------------------
  5520     05  DCFORCEL PIC S9(0004) COMP.
  5521     05  DCFORCEF PIC  X(0001).
  5522     05  FILLER REDEFINES DCFORCEF.
  5523         10  DCFORCEA PIC  X(0001).
  5524     05  DCFORCEI PIC  X(0005).
  5525*    -------------------------------
  5526     05  DCHOLDL PIC S9(0004) COMP.
  5527     05  DCHOLDF PIC  X(0001).
  5528     05  FILLER REDEFINES DCHOLDF.
  5529         10  DCHOLDA PIC  X(0001).
  5530     05  DCHOLDI PIC  X(0005).
  5531*    -------------------------------
  5532     05  DCAVAILL PIC S9(0004) COMP.
  5533     05  DCAVAILF PIC  X(0001).
  5534     05  FILLER REDEFINES DCAVAILF.
  5535         10  DCAVAILA PIC  X(0001).
  5536     05  DCAVAILI PIC  X(0005).
  5537*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 103
* EL6311.cbl
  5538     05  DCGPREML PIC S9(0004) COMP.
  5539     05  DCGPREMF PIC  X(0001).
  5540     05  FILLER REDEFINES DCGPREMF.
  5541         10  DCGPREMA PIC  X(0001).
  5542     05  DCGPREMI PIC  X(0011).
  5543*    -------------------------------
  5544     05  DCBPREML PIC S9(0004) COMP.
  5545     05  DCBPREMF PIC  X(0001).
  5546     05  FILLER REDEFINES DCBPREMF.
  5547         10  DCBPREMA PIC  X(0001).
  5548     05  DCBPREMI PIC  X(0011).
  5549*    -------------------------------
  5550     05  DNTOTALL PIC S9(0004) COMP.
  5551     05  DNTOTALF PIC  X(0001).
  5552     05  FILLER REDEFINES DNTOTALF.
  5553         10  DNTOTALA PIC  X(0001).
  5554     05  DNTOTALI PIC  X(0005).
  5555*    -------------------------------
  5556     05  DNFATALL PIC S9(0004) COMP.
  5557     05  DNFATALF PIC  X(0001).
  5558     05  FILLER REDEFINES DNFATALF.
  5559         10  DNFATALA PIC  X(0001).
  5560     05  DNFATALI PIC  X(0005).
  5561*    -------------------------------
  5562     05  DNFORCEL PIC S9(0004) COMP.
  5563     05  DNFORCEF PIC  X(0001).
  5564     05  FILLER REDEFINES DNFORCEF.
  5565         10  DNFORCEA PIC  X(0001).
  5566     05  DNFORCEI PIC  X(0005).
  5567*    -------------------------------
  5568     05  DNHOLDL PIC S9(0004) COMP.
  5569     05  DNHOLDF PIC  X(0001).
  5570     05  FILLER REDEFINES DNHOLDF.
  5571         10  DNHOLDA PIC  X(0001).
  5572     05  DNHOLDI PIC  X(0005).
  5573*    -------------------------------
  5574     05  DNAVAILL PIC S9(0004) COMP.
  5575     05  DNAVAILF PIC  X(0001).
  5576     05  FILLER REDEFINES DNAVAILF.
  5577         10  DNAVAILA PIC  X(0001).
  5578     05  DNAVAILI PIC  X(0005).
  5579*    -------------------------------
  5580     05  DNGPREML PIC S9(0004) COMP.
  5581     05  DNGPREMF PIC  X(0001).
  5582     05  FILLER REDEFINES DNGPREMF.
  5583         10  DNGPREMA PIC  X(0001).
  5584     05  DNGPREMI PIC  X(0011).
  5585*    -------------------------------
  5586     05  DNBPREML PIC S9(0004) COMP.
  5587     05  DNBPREMF PIC  X(0001).
  5588     05  FILLER REDEFINES DNBPREMF.
  5589         10  DNBPREMA PIC  X(0001).
  5590     05  DNBPREMI PIC  X(0011).
  5591*    -------------------------------
  5592     05  DERMSGL PIC S9(0004) COMP.
  5593     05  DERMSGF PIC  X(0001).
  5594     05  FILLER REDEFINES DERMSGF.
  5595         10  DERMSGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 104
* EL6311.cbl
  5596     05  DERMSGI PIC  X(0075).
  5597*    -------------------------------
  5598     05  DPFENTRL PIC S9(0004) COMP.
  5599     05  DPFENTRF PIC  X(0001).
  5600     05  FILLER REDEFINES DPFENTRF.
  5601         10  DPFENTRA PIC  X(0001).
  5602     05  DPFENTRI PIC  9(2).
  5603 01  EL631DO REDEFINES EL631BI.
  5604     05  FILLER            PIC  X(0012).
  5605*    -------------------------------
  5606     05  FILLER            PIC  X(0003).
  5607     05  DDATEO PIC  X(0008).
  5608*    -------------------------------
  5609     05  FILLER            PIC  X(0003).
  5610     05  DTIMEO PIC  99.99.
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DHEADO PIC  X(0038).
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DLDATEO PIC  X(0010).
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DBATCHO PIC  X(0011).
  5620*    -------------------------------
  5621     05  FILLER            PIC  X(0003).
  5622     05  DACCTNMO PIC  X(0030).
  5623*    -------------------------------
  5624     05  FILLER            PIC  X(0003).
  5625     05  DPROCDTO PIC  X(0008).
  5626*    -------------------------------
  5627     05  FILLER            PIC  X(0003).
  5628     05  DINPUTO PIC  X(0008).
  5629*    -------------------------------
  5630     05  FILLER            PIC  X(0003).
  5631     05  DMAINDTO PIC  X(0008).
  5632*    -------------------------------
  5633     05  FILLER            PIC  X(0003).
  5634     05  DCARRO PIC  X(0001).
  5635*    -------------------------------
  5636     05  FILLER            PIC  X(0003).
  5637     05  DGROUPO PIC  X(0006).
  5638*    -------------------------------
  5639     05  FILLER            PIC  X(0003).
  5640     05  DSTATEO PIC  X(0002).
  5641*    -------------------------------
  5642     05  FILLER            PIC  X(0003).
  5643     05  DACCTO PIC  X(0010).
  5644*    -------------------------------
  5645     05  FILLER            PIC  X(0003).
  5646     05  DRECVDTO PIC  X(0008).
  5647*    -------------------------------
  5648     05  FILLER            PIC  X(0003).
  5649     05  DCSRO PIC  X(0004).
  5650*    -------------------------------
  5651     05  FILLER            PIC  X(0003).
  5652     05  DREFHDGO PIC  X(0010).
  5653*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 105
* EL6311.cbl
  5654     05  FILLER            PIC  X(0003).
  5655     05  DREFO PIC  X(0012).
  5656*    -------------------------------
  5657     05  FILLER            PIC  X(0003).
  5658     05  DLFPHDGO PIC  X(0010).
  5659*    -------------------------------
  5660     05  FILLER            PIC  X(0003).
  5661     05  DAHPHDGO PIC  X(0010).
  5662*    -------------------------------
  5663     05  FILLER            PIC  X(0003).
  5664     05  DLFRHDGO PIC  X(0009).
  5665*    -------------------------------
  5666     05  FILLER            PIC  X(0003).
  5667     05  DAHRHDGO PIC  X(0009).
  5668*    -------------------------------
  5669     05  FILLER            PIC  X(0003).
  5670     05  DRISSO PIC  ZZ99-.
  5671*    -------------------------------
  5672     05  FILLER            PIC  X(0003).
  5673     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5674*    -------------------------------
  5675     05  FILLER            PIC  X(0003).
  5676     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5677*    -------------------------------
  5678     05  FILLER            PIC  X(0003).
  5679     05  DRCANCO PIC  ZZ99-.
  5680*    -------------------------------
  5681     05  FILLER            PIC  X(0003).
  5682     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5683*    -------------------------------
  5684     05  FILLER            PIC  X(0003).
  5685     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5686*    -------------------------------
  5687     05  FILLER            PIC  X(0003).
  5688     05  DEISSO PIC  ZZ99-.
  5689*    -------------------------------
  5690     05  FILLER            PIC  X(0003).
  5691     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5692*    -------------------------------
  5693     05  FILLER            PIC  X(0003).
  5694     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5695*    -------------------------------
  5696     05  FILLER            PIC  X(0003).
  5697     05  DECANCO PIC  ZZ99-.
  5698*    -------------------------------
  5699     05  FILLER            PIC  X(0003).
  5700     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5701*    -------------------------------
  5702     05  FILLER            PIC  X(0003).
  5703     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5704*    -------------------------------
  5705     05  FILLER            PIC  X(0003).
  5706     05  DCISSO PIC  ZZ99-.
  5707*    -------------------------------
  5708     05  FILLER            PIC  X(0003).
  5709     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5710*    -------------------------------
  5711     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 106
* EL6311.cbl
  5712     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5713*    -------------------------------
  5714     05  FILLER            PIC  X(0003).
  5715     05  DCCANCO PIC  ZZ99-.
  5716*    -------------------------------
  5717     05  FILLER            PIC  X(0003).
  5718     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5719*    -------------------------------
  5720     05  FILLER            PIC  X(0003).
  5721     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5722*    -------------------------------
  5723     05  FILLER            PIC  X(0003).
  5724     05  DOISSO PIC  ZZ99-.
  5725*    -------------------------------
  5726     05  FILLER            PIC  X(0003).
  5727     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5728*    -------------------------------
  5729     05  FILLER            PIC  X(0003).
  5730     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5731*    -------------------------------
  5732     05  FILLER            PIC  X(0003).
  5733     05  DOCANCO PIC  ZZ99-.
  5734*    -------------------------------
  5735     05  FILLER            PIC  X(0003).
  5736     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5737*    -------------------------------
  5738     05  FILLER            PIC  X(0003).
  5739     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5740*    -------------------------------
  5741     05  FILLER            PIC  X(0003).
  5742     05  DITOTALO PIC  ZZZ99.
  5743*    -------------------------------
  5744     05  FILLER            PIC  X(0003).
  5745     05  DIFATALO PIC  ZZZ99.
  5746*    -------------------------------
  5747     05  FILLER            PIC  X(0003).
  5748     05  DIFORCEO PIC  ZZZ99.
  5749*    -------------------------------
  5750     05  FILLER            PIC  X(0003).
  5751     05  DIHOLDO PIC  ZZZ99.
  5752*    -------------------------------
  5753     05  FILLER            PIC  X(0003).
  5754     05  DIAVAILO PIC  ZZZ99.
  5755*    -------------------------------
  5756     05  FILLER            PIC  X(0003).
  5757     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5758*    -------------------------------
  5759     05  FILLER            PIC  X(0003).
  5760     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5761*    -------------------------------
  5762     05  FILLER            PIC  X(0003).
  5763     05  DCTOTALO PIC  ZZZ99.
  5764*    -------------------------------
  5765     05  FILLER            PIC  X(0003).
  5766     05  DCFATALO PIC  ZZZ99.
  5767*    -------------------------------
  5768     05  FILLER            PIC  X(0003).
  5769     05  DCFORCEO PIC  ZZZ99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 107
* EL6311.cbl
  5770*    -------------------------------
  5771     05  FILLER            PIC  X(0003).
  5772     05  DCHOLDO PIC  ZZZ99.
  5773*    -------------------------------
  5774     05  FILLER            PIC  X(0003).
  5775     05  DCAVAILO PIC  ZZZ99.
  5776*    -------------------------------
  5777     05  FILLER            PIC  X(0003).
  5778     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5779*    -------------------------------
  5780     05  FILLER            PIC  X(0003).
  5781     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5782*    -------------------------------
  5783     05  FILLER            PIC  X(0003).
  5784     05  DNTOTALO PIC  ---99.
  5785*    -------------------------------
  5786     05  FILLER            PIC  X(0003).
  5787     05  DNFATALO PIC  ---99.
  5788*    -------------------------------
  5789     05  FILLER            PIC  X(0003).
  5790     05  DNFORCEO PIC  ---99.
  5791*    -------------------------------
  5792     05  FILLER            PIC  X(0003).
  5793     05  DNHOLDO PIC  ---99.
  5794*    -------------------------------
  5795     05  FILLER            PIC  X(0003).
  5796     05  DNAVAILO PIC  ---99.
  5797*    -------------------------------
  5798     05  FILLER            PIC  X(0003).
  5799     05  DNGPREMO PIC  -------9.99.
  5800*    -------------------------------
  5801     05  FILLER            PIC  X(0003).
  5802     05  DNBPREMO PIC  -------9.99.
  5803*    -------------------------------
  5804     05  FILLER            PIC  X(0003).
  5805     05  DERMSGO PIC  X(0075).
  5806*    -------------------------------
  5807     05  FILLER            PIC  X(0003).
  5808     05  DPFENTRO PIC  X(0002).
  5809*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 108
* EL6311.cbl
  5811 01  MAP-B REDEFINES EL631BI.
  5812     12  FILLER                  PIC X(595).
  5813*    12  FILLER                  PIC X(591).
  5814*    12  FILLER                  PIC X(512).
  5815*    12  FILLER                  PIC X(510).
  5816     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5817         16  BKIND-LEN               PIC S9(4)  COMP.
  5818         16  BKIND-ATTRB             PIC X.
  5819         16  BKIND                   PIC XX.
  5820         16  BTYPE-LEN               PIC S9(4)  COMP.
  5821         16  BTYPE-ATTRB             PIC X.
  5822         16  BTYPE                   PIC X(3).
  5823         16  BTERM-LEN               PIC S9(4)  COMP.
  5824         16  BTERM-ATTRB             PIC X.
  5825         16  BTERMI                  PIC 999.
  5826         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5827         16  BBEN-LEN                PIC S9(4)  COMP.
  5828         16  BBEN-ATTRB              PIC X.
  5829         16  BBENI                   PIC 9(10)V99.
  5830*        16  BBENI                   PIC 9(12).
  5831         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5832         16  BPREM-LEN               PIC S9(4)  COMP.
  5833         16  BPREM-ATTRB             PIC X.
  5834         16  BPREMI                  PIC S9(9)V99.
  5835*        16  BPREMI                  PIC 9(11).
  5836         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5837         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5838         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5839         16  BEXPIRE-ATTRB           PIC X.
  5840         16  BEXPIRE                 PIC X(8).
  5841         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5842         16  BCRIT-PERD-ATTRB        PIC X.
  5843         16  BCRIT-PERDI             PIC 99.
  5844         16  BCRIT-PERDO REDEFINES
  5845                         BCRIT-PERDI PIC ZZ.
  5846         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5847         16  BALT-BEN-ATTRB          PIC X.
  5848         16  BALT-BENI               PIC 9(10)V99.
  5849*        16  BALT-BENI               PIC 9(12).
  5850         16  BALT-BENO REDEFINES
  5851                           BALT-BENI PIC Z(9).ZZ.
  5852         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5853         16  BALT-PREM-ATTRB         PIC X.
  5854         16  BALT-PREMI              PIC 9(9)V99.
  5855*        16  BALT-PREMI              PIC 9(11).
  5856         16  BALT-PREMO REDEFINES
  5857                          BALT-PREMI PIC Z(7).ZZ-.
  5858         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5859         16  BBEN-CD-ATTRB           PIC X.
  5860         16  BBEN-CD                 PIC XXX.
  5861         16  BCPREM-LEN              PIC S9(4)  COMP.
  5862         16  BCPREM-ATTRB            PIC X.
  5863         16  BCPREMI                 PIC S9(9)V99.
  5864*        16  BCPREMI                 PIC X(11).
  5865         16  BCPREMO REDEFINES BCPREMI
  5866                                     PIC Z(7).99-.
  5867         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5868         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 109
* EL6311.cbl
  5869         16  BCALT-PREM              PIC Z(7).99-.
  5870         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5871         16  BBEN-ABBR-ATTRB         PIC X.
  5872         16  BBEN-ABBR               PIC X(5).
  5873         16  BDIFF-LEN               PIC S9(4)  COMP.
  5874         16  BDIFF-ATTRB             PIC X.
  5875         16  BDIFFO                  PIC Z(7).99-.
  5876         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5877         16  BBILL-LIT-ATTRB         PIC X.
  5878         16  BBILL-LIT               PIC X(8).
  5879         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5880         16  BDALT-PREM-ATTRB        PIC X.
  5881         16  BDALT-PREM              PIC Z(7).99-.
  5882
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 110
* EL6311.cbl
  5884
  5885****************************************************************
  5886*
  5887* Copyright (c) 2007-2013 Dell Inc.
  5888* All rights reserved.
  5889*
  5890****************************************************************
  5891 01  DFHEIV.
  5892   02  DFHEIV0               PIC X(35).
  5893   02  DFHEIV1               PIC X(08).
  5894   02  DFHEIV2               PIC X(08).
  5895   02  DFHEIV3               PIC X(08).
  5896   02  DFHEIV4               PIC X(06).
  5897   02  DFHEIV5               PIC X(04).
  5898   02  DFHEIV6               PIC X(04).
  5899   02  DFHEIV7               PIC X(02).
  5900   02  DFHEIV8               PIC X(02).
  5901   02  DFHEIV9               PIC X(01).
  5902   02  DFHEIV10              PIC S9(7) COMP-3.
  5903   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5904   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5905   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5906   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5907   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5908   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5909   02  DFHEIV17              PIC X(04).
  5910   02  DFHEIV18              PIC X(04).
  5911   02  DFHEIV19              PIC X(04).
  5912   02  DFHEIV20              USAGE IS POINTER.
  5913   02  DFHEIV21              USAGE IS POINTER.
  5914   02  DFHEIV22              USAGE IS POINTER.
  5915   02  DFHEIV23              USAGE IS POINTER.
  5916   02  DFHEIV24              USAGE IS POINTER.
  5917   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5918   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5919   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5920   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5921   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5922   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5923   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5924   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5925   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5926   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5927   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5928   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5929   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5930   02  FILLER                PIC X(02).
  5931   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5932   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5933   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5934   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5935   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5936   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5937   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5938 LINKAGE  SECTION.
  5939*****************************************************************
  5940*                                                               *
  5941* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 111
* EL6311.cbl
  5942* All rights reserved.                                          *
  5943*                                                               *
  5944*****************************************************************
  5945 01  dfheiblk.
  5946     02  eibtime          pic s9(7) comp-3.
  5947     02  eibdate          pic s9(7) comp-3.
  5948     02  eibtrnid         pic x(4).
  5949     02  eibtaskn         pic s9(7) comp-3.
  5950     02  eibtrmid         pic x(4).
  5951     02  dfheigdi         pic s9(4) comp.
  5952     02  eibcposn         pic s9(4) comp.
  5953     02  eibcalen         pic s9(4) comp.
  5954     02  eibaid           pic x(1).
  5955     02  eibfiller1       pic x(1).
  5956     02  eibfn            pic x(2).
  5957     02  eibfiller2       pic x(2).
  5958     02  eibrcode         pic x(6).
  5959     02  eibfiller3       pic x(2).
  5960     02  eibds            pic x(8).
  5961     02  eibreqid         pic x(8).
  5962     02  eibrsrce         pic x(8).
  5963     02  eibsync          pic x(1).
  5964     02  eibfree          pic x(1).
  5965     02  eibrecv          pic x(1).
  5966     02  eibsend          pic x(1).
  5967     02  eibatt           pic x(1).
  5968     02  eibeoc           pic x(1).
  5969     02  eibfmh           pic x(1).
  5970     02  eibcompl         pic x(1).
  5971     02  eibsig           pic x(1).
  5972     02  eibconf          pic x(1).
  5973     02  eiberr           pic x(1).
  5974     02  eibrldbk         pic x(1).
  5975     02  eiberrcd         pic x(4).
  5976     02  eibsynrb         pic x(1).
  5977     02  eibnodat         pic x(1).
  5978     02  eibfiller5       pic x(2).
  5979     02  eibresp          pic s9(8) comp.
  5980     02  eibresp2         pic s9(8) comp.
  5981     02  dfheigdj         pic s9(4) comp.
  5982     02  dfheigdk         pic s9(4) comp.
  5983 01  DFHCOMMAREA                 PIC X(1300).
  5984*                                COPY ERCPNDB.
  5985******************************************************************
  5986*                                                                *
  5987*                                                                *
  5988*                            ERCPNDB.                            *
  5989*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5990*                            VMOD=2.025                          *
  5991*                                                                *
  5992*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5993*                                                                *
  5994******************************************************************
  5995*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5996*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5997******************************************************************
  5998*                                                                *
  5999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 112
* EL6311.cbl
  6000*   FILE TYPE = VSAM,KSDS                                        *
  6001*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6002*                                                                *
  6003*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6004*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6005*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6006*                                                 RKP=13,LEN=36  *
  6007*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6008*                                      AND CHG-SEQ.)             *
  6009*                                                RKP=49,LEN=11   *
  6010*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6011*                                      AND CHG-SEQ.)             *
  6012*                                                RKP=60,LEN=15   *
  6013*                                                                *
  6014*   LOG = NO                                                     *
  6015*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6016******************************************************************
  6017******************************************************************
  6018*                   C H A N G E   L O G
  6019*
  6020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6021*-----------------------------------------------------------------
  6022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6023* EFFECTIVE    NUMBER
  6024*-----------------------------------------------------------------
  6025* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6026* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6027* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6028* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6029* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6030* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6031* 032306                   PEMA  ADD BOW LOAN NUMBER
  6032* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6033* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6034* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6035* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6036* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6037* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6038* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6039* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6040* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6041* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6042* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6043* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6044* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6045******************************************************************
  6046
  6047 01  PENDING-BUSINESS.
  6048     12  PB-RECORD-ID                     PIC XX.
  6049         88  VALID-PB-ID                        VALUE 'PB'.
  6050
  6051     12  PB-CONTROL-PRIMARY.
  6052         16  PB-COMPANY-CD                PIC X.
  6053         16  PB-ENTRY-BATCH               PIC X(6).
  6054         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6055         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6056
  6057     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 113
* EL6311.cbl
  6058         16  PB-COMPANY-CD-A1             PIC X.
  6059         16  PB-CARRIER                   PIC X.
  6060         16  PB-GROUPING.
  6061             20  PB-GROUPING-PREFIX       PIC XXX.
  6062             20  PB-GROUPING-PRIME        PIC XXX.
  6063         16  PB-STATE                     PIC XX.
  6064         16  PB-ACCOUNT.
  6065             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6066             20  PB-ACCOUNT-PRIME         PIC X(6).
  6067         16  PB-CERT-EFF-DT               PIC XX.
  6068         16  PB-CERT-NO.
  6069             20  PB-CERT-PRIME            PIC X(10).
  6070             20  PB-CERT-SFX              PIC X.
  6071         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6072
  6073         16  PB-RECORD-TYPE               PIC X.
  6074             88  PB-MAILING-DATA                VALUE '0'.
  6075             88  PB-ISSUE                       VALUE '1'.
  6076             88  PB-CANCELLATION                VALUE '2'.
  6077             88  PB-BATCH-TRAILER               VALUE '9'.
  6078
  6079     12  PB-CONTROL-BY-ORIG-BATCH.
  6080         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6081         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6082         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6083         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6084
  6085     12  PB-CONTROL-BY-CSR.
  6086         16  PB-CSR-COMPANY-CD            PIC X.
  6087         16  PB-CSR-ID                    PIC X(4).
  6088         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6089         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6090         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6091******************************************************************
  6092*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6093******************************************************************
  6094
  6095     12  PB-LAST-MAINT-DT                 PIC XX.
  6096     12  PB-LAST-MAINT-BY                 PIC X(4).
  6097     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6098
  6099     12  PB-RECORD-BODY                   PIC X(375).
  6100
  6101     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6102         16  PB-CERT-ORIGIN               PIC X.
  6103             88  CLASIC-CREATED-CERT         VALUE '1'.
  6104         16  PB-I-NAME.
  6105             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6106             20  PB-I-INSURED-FIRST-NAME.
  6107                 24  PB-I-INSURED-1ST-INIT PIC X.
  6108                 24  FILLER                PIC X(9).
  6109             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6110         16  PB-I-AGE                     PIC S99   COMP-3.
  6111         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6112         16  PB-I-BIRTHDAY                PIC XX.
  6113         16  PB-I-INSURED-SEX             PIC X.
  6114             88  PB-SEX-MALE     VALUE 'M'.
  6115             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 114
* EL6311.cbl
  6116
  6117         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6118         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6119         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6120         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6121         16  PB-I-SKIP-CODE               PIC X.
  6122             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6123             88  PB-SKIP-JULY              VALUE '1'.
  6124             88  PB-SKIP-AUGUST            VALUE '2'.
  6125             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6126             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6127             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6128             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6129             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6130             88  PB-SKIP-JUNE              VALUE '8'.
  6131             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6132             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6133             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6134         16  PB-I-TERM-TYPE               PIC X.
  6135             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6136             88  PB-PAID-WEEKLY            VALUE 'W'.
  6137             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6138             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6139             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6140         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6141         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6142         16  PB-I-DATA-ENTRY-SW           PIC X.
  6143             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6144             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6145             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6146             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6147         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6148         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6149*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6150         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6151         16  PB-I-LETTER-REQD             PIC X.
  6152
  6153         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6154             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6155             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6156                                                   '90' THRU '99'.
  6157         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6158                                          PIC XX.
  6159         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6160         16  PB-I-AMOUNT-FINANCED REDEFINES
  6161                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6162         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6163         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6164                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6165         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6166         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6167         16  PB-I-CLP-AMOUNT REDEFINES
  6168                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6169         16  PB-I-LF-CALC-FLAG            PIC X.
  6170             88 PB-COMP-LF-PREM               VALUE '?'.
  6171         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6172         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6173         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 115
* EL6311.cbl
  6174         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6175         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6176         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6177         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6178         16  PB-I-LF-ABBR                 PIC XXX.
  6179         16  PB-I-LF-INPUT-CD             PIC XX.
  6180
  6181         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6182             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6183             88  PB-INVALID-AH               VALUE '  ' '00'
  6184                                                   '90' THRU '99'.
  6185         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6186         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6187         16  PB-I-AH-CALC-FLAG            PIC X.
  6188             88 PB-COMP-AH-PREM                  VALUE '?'.
  6189         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6190         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6191         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6192         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6193         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6194         16  PB-I-AH-ABBR                 PIC XXX.
  6195         16  PB-I-AH-INPUT-CD             PIC XXX.
  6196
  6197         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6198         16  PB-I-REIN-TABLE              PIC XXX.
  6199         16  PB-I-BUSINESS-TYPE           PIC 99.
  6200         16  PB-I-INDV-GRP-CD             PIC X.
  6201         16  PB-I-MORT-CODE.
  6202             20  PB-I-TABLE               PIC X.
  6203             20  PB-I-INTEREST            PIC XX.
  6204             20  PB-I-MORT-TYP            PIC X.
  6205         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6206         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6207         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6208         16  PB-I-INDV-GRP-OVRD           PIC X.
  6209         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6210         16  PB-I-SIG-SW                  PIC X.
  6211             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6212         16  PB-I-RATE-CLASS              PIC XX.
  6213         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6214         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6215         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6216         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6217         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6218         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6219         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6220         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6221         16  PB-I-OB-FLAG                 PIC X.
  6222             88  PB-I-OB                      VALUE 'B'.
  6223             88  PB-I-SUMMARY                 VALUE 'Z'.
  6224         16  PB-I-ENTRY-STATUS            PIC X.
  6225             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6226                                              'M' '5' '9' '2'.
  6227             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6228             88  PB-I-POLICY-PENDING          VALUE '2'.
  6229             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6230             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6231             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 116
* EL6311.cbl
  6232             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6233             88  PB-I-REIN-ONLY               VALUE '9'.
  6234             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6235             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6236             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6237             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6238         16  PB-I-INT-CODE                PIC X.
  6239             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6240             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6241         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6242         16  PB-I-SOC-SEC-NO              PIC X(11).
  6243         16  PB-I-MEMBER-NO               PIC X(12).
  6244         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6245*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6246         16  PB-I-OLD-LOF                 PIC XXX.
  6247         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6248         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6249         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6250         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6251         16  PB-I-LIFE-INDICATOR          PIC X.
  6252             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6253         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6254         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6255                                          PIC S9(5)V99    COMP-3.
  6256         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6257             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6258             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6259         16  PB-I-1ST-PMT-DT              PIC XX.
  6260         16  PB-I-JOINT-INSURED.
  6261             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6262             20 PB-I-JOINT-FIRST-NAME.
  6263                24  PB-I-JOINT-FIRST-INIT PIC X.
  6264                24  FILLER                PIC X(9).
  6265             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6266*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6267         16  PB-I-BENEFICIARY-NAME.
  6268             20  PB-I-BANK-NUMBER         PIC X(10).
  6269             20  FILLER                   PIC X(15).
  6270         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6271         16  PB-I-REFERENCE               PIC X(12).
  6272         16  FILLER REDEFINES PB-I-REFERENCE.
  6273             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6274             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6275             20  PB-I-CLP-STATE           PIC XX.
  6276         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6277             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6278             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6279             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6280         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6281         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6282         16  PB-I-RESIDENT-STATE          PIC XX.
  6283         16  PB-I-RATE-CODE               PIC X(4).
  6284         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6285         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6286         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6287         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6288         16  PB-I-BANK-NOCHRGB            PIC 99.
  6289         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 117
* EL6311.cbl
  6290         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6291
  6292     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6293         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6294             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6295         16  PB-C-CANCEL-ORIGIN           PIC X.
  6296             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6297         16  PB-C-LF-CANCEL-DT            PIC XX.
  6298         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6299         16  PB-C-LF-CALC-REQ             PIC X.
  6300             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6301         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6302         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6303         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6304             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6305         16  PB-C-AH-CANCEL-DT            PIC XX.
  6306         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6307         16  PB-C-AH-CALC-REQ             PIC X.
  6308             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6309         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6310         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6311         16  PB-C-LAST-NAME               PIC X(15).
  6312         16  PB-C-REFUND-SW               PIC X.
  6313             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6314             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6315         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6316         16  PB-C-PAYEE-CODE              PIC X(6).
  6317         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6318         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6319         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6320         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6321         16  PB-C-REFERENCE               PIC X(12).
  6322         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6323         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6324         16  PB-C-POST-CARD-IND           PIC X.
  6325         16  PB-C-CANCEL-REASON           PIC X.
  6326         16  PB-C-REF-INTERFACE-SW        PIC X.
  6327         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6328         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6329         16  FILLER                       PIC X(01).
  6330*        16  FILLER                       PIC X(18).
  6331         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6332*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6333         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6334         16  PB-CANCELED-CERT-DATA.
  6335             20  PB-CI-INSURED-NAME.
  6336                 24  PB-CI-LAST-NAME      PIC X(15).
  6337                 24  PB-CI-INITIALS       PIC XX.
  6338             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6339             20  PB-CI-INSURED-SEX        PIC X.
  6340             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6341             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6342             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6343             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6344             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6345             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6346             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6347             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 118
* EL6311.cbl
  6348             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6349             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6350             20  PB-CI-RATE-CLASS         PIC XX.
  6351             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6352             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6353             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6354             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6355             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6356             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6357             20  PB-CI-LF-ABBR            PIC X(3).
  6358             20  PB-CI-AH-ABBR            PIC X(3).
  6359             20  PB-CI-OB-FLAG            PIC X.
  6360                 88  PB-CI-OB                VALUE 'B'.
  6361             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6362                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6363                                           'M' '4' '5' '9' '2'.
  6364                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6365                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6366                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6367                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6368                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6369                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6370                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6371                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6372                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6373                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6374                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6375                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6376                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6377             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6378                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6379                                           'M' '4' '5' '9' '2'.
  6380                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6381                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6382                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6383                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6384                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6385                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6386                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6387                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6388                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6389                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6390                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6391                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6392                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6393             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6394             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6395             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6396             20  PB-CI-MEMBER-NO          PIC X(12).
  6397             20  PB-CI-INT-CODE           PIC X.
  6398                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6399                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6400             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6401             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6402             20  PB-CI-COMP-EXCP-SW       PIC X.
  6403                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6404                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6405             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 119
* EL6311.cbl
  6406             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6407             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6408             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6409             20  PB-CI-DEATH-DT           PIC XX.
  6410             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6411             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6412             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6413             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6414             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6415             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6416             20  PB-CI-ENTRY-DT              PIC XX.
  6417             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6418             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6419             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6420             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6421             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6422             20  PB-CI-OLD-LOF               PIC XXX.
  6423*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6424             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6425             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6426             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6427             20  PB-CI-INDV-GRP-CD           PIC X.
  6428             20  PB-CI-BENEFICIARY-NAME.
  6429                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6430                 24  FILLER                  PIC X(15).
  6431             20  PB-CI-NOTE-SW               PIC X.
  6432             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6433             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6434             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6435             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6436             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6437             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6438             20  PB-CI-FIRST-NAME            PIC X(10).
  6439             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6440
  6441         16  FILLER                       PIC X(13).
  6442*032306  16  FILLER                       PIC X(27).
  6443*        16  FILLER                       PIC X(46).
  6444
  6445     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6446         16  FILLER                       PIC X(10).
  6447         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6448         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6449         16  PB-M-INSURED-MID-INIT        PIC X.
  6450         16  PB-M-INSURED-AGE             PIC 99.
  6451         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6452         16  PB-M-INSURED-SEX             PIC X.
  6453         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6454         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6455         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6456         16  PB-M-INSURED-CITY-STATE.
  6457             20  PB-M-INSURED-CITY        PIC X(28).
  6458             20  PB-M-INSURED-STATE       PIC XX.
  6459         16  PB-M-INSURED-ZIP-CODE.
  6460             20  PB-M-INSURED-ZIP-PRIME.
  6461                 24  PB-M-INSURED-ZIP-1   PIC X.
  6462                     88  PB-M-CANADIAN-POST-CODE
  6463                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 120
* EL6311.cbl
  6464                 24  FILLER               PIC X(4).
  6465             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6466         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6467                                        PB-M-INSURED-ZIP-CODE.
  6468             20  PM-M-INS-CAN-POST1       PIC XXX.
  6469             20  PM-M-INS-CAN-POST2       PIC XXX.
  6470             20  FILLER                   PIC XXX.
  6471         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6472         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6473         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6474         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6475         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6476         16  PB-M-CRED-BENE-CITYST.
  6477             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6478             20  PB-M-CRED-BENE-STATE     PIC XX.
  6479         16  FILLER                       PIC X(92).
  6480
  6481     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6482         16  FILLER                       PIC X(10).
  6483         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6484         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6485         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6486         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6487         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6488         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6489         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6490         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6491         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6492         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6493         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6494         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6495         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6496         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6497         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6498         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6499         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6500         16  PB-ACCOUNT-NAME              PIC X(30).
  6501         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6502         16  PB-REFERENCE                 PIC X(12).
  6503         16  PB-B-RECEIVED-DT             PIC XX.
  6504         16  FILLER                       PIC X(234).
  6505
  6506     12  PB-RECORD-STATUS.
  6507         16  PB-CREDIT-SELECT-DT          PIC XX.
  6508         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6509         16  PB-BILLED-DT                 PIC XX.
  6510         16  PB-BILLING-STATUS            PIC X.
  6511             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6512             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6513             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6514         16  PB-RECORD-BILL               PIC X.
  6515             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6516             88  PB-RECORD-RETURNED           VALUE 'R'.
  6517             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6518             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6519             88  PB-OVERRIDE-AH               VALUE 'A'.
  6520             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6521         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 121
* EL6311.cbl
  6522             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6523             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6524             88  PB-REISSUED-CERT             VALUE 'E'.
  6525             88  PB-CASH-CERT                 VALUE 'C'.
  6526             88  PB-MONTHLY-CERT              VALUE 'M'.
  6527             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6528             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6529             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6530         16  PB-FORCE-CODE                PIC X.
  6531             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6532             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6533             88  PB-CANCEL-FORCE              VALUE '8'.
  6534             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6535             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6536             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6537             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6538             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6539             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6540             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6541             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6542         16  PB-FATAL-FLAG                PIC X.
  6543             88  PB-FATAL-ERRORS              VALUE 'X'.
  6544         16  PB-FORCE-ER-CD               PIC X.
  6545             88  PB-FORCE-ERRORS              VALUE 'F'.
  6546             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6547         16  PB-WARN-ER-CD                PIC X.
  6548             88  PB-WARNING-ERRORS            VALUE 'W'.
  6549         16  FILLER                       PIC X.
  6550         16  PB-OUT-BAL-CD                PIC X.
  6551             88  PB-OUT-OF-BAL                VALUE 'O'.
  6552         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6553         16  PB-AH-OVERRIDE-L1            PIC X.
  6554         16  PB-INPUT-DT                  PIC XX.
  6555         16  PB-INPUT-BY                  PIC X(4).
  6556         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6557         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6558         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6559         16  PB-LF-EARNING-METHOD         PIC X.
  6560         16  PB-AH-EARNING-METHOD         PIC X.
  6561         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6562         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6563         16  PB-REIN-CD                   PIC XXX.
  6564         16  PB-LF-REFUND-TYPE            PIC X.
  6565         16  PB-AH-REFUND-TYPE            PIC X.
  6566         16  PB-ACCT-EFF-DT               PIC XX.
  6567         16  PB-ACCT-EXP-DT               PIC XX.
  6568         16  PB-COMPANY-ID                PIC X(3).
  6569         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6570         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6571         16  PB-SV-CARRIER                PIC X.
  6572         16  PB-SV-GROUPING               PIC X(6).
  6573         16  PB-SV-STATE                  PIC XX.
  6574         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6575         16  PB-GA-BILLING-INFO.
  6576             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6577                                          PIC XX.
  6578         16  PB-SV-REMIT-TO  REDEFINES
  6579             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 122
* EL6311.cbl
  6580         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6581         16  PB-I-LOAN-OFFICER            PIC X(5).
  6582         16  PB-I-VIN                     PIC X(17).
  6583
  6584         16  FILLER                       PIC X(04).
  6585         16  IMNET-BYPASS-SW              PIC X.
  6586
  6587******************************************************************
  6588*                COMMON EDIT ERRORS                              *
  6589******************************************************************
  6590
  6591     12  PB-COMMON-ERRORS.
  6592         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6593                                           PIC S9(4)     COMP.
  6594
  6595******************************************************************
  6596*                                COPY ELCCERT.
  6597******************************************************************
  6598*                                                                *
  6599*                            ELCCERT.                            *
  6600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6601*                            VMOD=2.013                          *
  6602*                                                                *
  6603*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6604*                                                                *
  6605*   FILE TYPE = VSAM,KSDS                                        *
  6606*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6607*                                                                *
  6608*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6609*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6610*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6611*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6612*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6613*                                                                *
  6614*   LOG = YES                                                    *
  6615*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6616******************************************************************
  6617*                   C H A N G E   L O G
  6618*
  6619* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6620*-----------------------------------------------------------------
  6621*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6622* EFFECTIVE    NUMBER
  6623*-----------------------------------------------------------------
  6624* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6625* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6626* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6627* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6628* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6629* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6630* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6631* 032612  CR2011110200001  PEMA  AHL CHANGES
  6632* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6633* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6634* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6635******************************************************************
  6636
  6637 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 123
* EL6311.cbl
  6638     12  CM-RECORD-ID                      PIC XX.
  6639         88  VALID-CM-ID                      VALUE 'CM'.
  6640
  6641     12  CM-CONTROL-PRIMARY.
  6642         16  CM-COMPANY-CD                 PIC X.
  6643         16  CM-CARRIER                    PIC X.
  6644         16  CM-GROUPING.
  6645             20  CM-GROUPING-PREFIX        PIC X(3).
  6646             20  CM-GROUPING-PRIME         PIC X(3).
  6647         16  CM-STATE                      PIC XX.
  6648         16  CM-ACCOUNT.
  6649             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6650             20  CM-ACCOUNT-PRIME          PIC X(6).
  6651         16  CM-CERT-EFF-DT                PIC XX.
  6652         16  CM-CERT-NO.
  6653             20  CM-CERT-PRIME             PIC X(10).
  6654             20  CM-CERT-SFX               PIC X.
  6655
  6656     12  CM-CONTROL-BY-NAME.
  6657         16  CM-COMPANY-CD-A1              PIC X.
  6658         16  CM-INSURED-LAST-NAME          PIC X(15).
  6659         16  CM-INSURED-INITIALS.
  6660             20  CM-INSURED-INITIAL1       PIC X.
  6661             20  CM-INSURED-INITIAL2       PIC X.
  6662
  6663     12  CM-CONTROL-BY-SSN.
  6664         16  CM-COMPANY-CD-A2              PIC X.
  6665         16  CM-SOC-SEC-NO.
  6666             20  CM-SSN-STATE              PIC XX.
  6667             20  CM-SSN-ACCOUNT            PIC X(6).
  6668             20  CM-SSN-LN3.
  6669                 25  CM-INSURED-INITIALS-A2.
  6670                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6671                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6672                 25 CM-PART-LAST-NAME-A2         PIC X.
  6673
  6674     12  CM-CONTROL-BY-CERT-NO.
  6675         16  CM-COMPANY-CD-A4              PIC X.
  6676         16  CM-CERT-NO-A4                 PIC X(11).
  6677
  6678     12  CM-CONTROL-BY-MEMB.
  6679         16  CM-COMPANY-CD-A5              PIC X.
  6680         16  CM-MEMBER-NO.
  6681             20  CM-MEMB-STATE             PIC XX.
  6682             20  CM-MEMB-ACCOUNT           PIC X(6).
  6683             20  CM-MEMB-LN4.
  6684                 25  CM-INSURED-INITIALS-A5.
  6685                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6686                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6687                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6688
  6689     12  CM-INSURED-PROFILE-DATA.
  6690         16  CM-INSURED-FIRST-NAME.
  6691             20  CM-INSURED-1ST-INIT       PIC X.
  6692             20  FILLER                    PIC X(9).
  6693         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6694         16  CM-INSURED-SEX                PIC X.
  6695             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 124
* EL6311.cbl
  6696             88  CM-SEX-FEMAL                 VALUE 'F'.
  6697         16  CM-INSURED-JOINT-AGE          PIC 99.
  6698         16  CM-JOINT-INSURED-NAME.
  6699             20  CM-JT-LAST-NAME           PIC X(15).
  6700             20  CM-JT-FIRST-NAME.
  6701                 24  CM-JT-1ST-INIT        PIC X.
  6702                 24  FILLER                PIC X(9).
  6703             20  CM-JT-INITIAL             PIC X.
  6704
  6705     12  CM-LIFE-DATA.
  6706         16  CM-LF-BENEFIT-CD              PIC XX.
  6707         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6708         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6709         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6710         16  CM-LF-DEV-CODE                PIC XXX.
  6711         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6712         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6713         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6714         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6715         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6716         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6717         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6718         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6719         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6720         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6721         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6722         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6723         16  cm-temp-epiq                  pic xx.
  6724             88  EPIQ-CLASS                  value 'EQ'.
  6725*        16  FILLER                        PIC XX.
  6726
  6727     12  CM-AH-DATA.
  6728         16  CM-AH-BENEFIT-CD              PIC XX.
  6729         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6730         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6731         16  CM-AH-DEV-CODE                PIC XXX.
  6732         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6733         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6734         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6735         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6736         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6737         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6738         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6739         16  CM-AH-PAID-THRU-DT            PIC XX.
  6740             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6741         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6742         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6743         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6744         16  FILLER                        PIC X.
  6745
  6746     12  CM-LOAN-INFORMATION.
  6747         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6748         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6749                                           PIC S9(5)V99  COMP-3.
  6750         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6751         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6752         16  CM-PAY-FREQUENCY              PIC S99.
  6753         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 125
* EL6311.cbl
  6754         16  CM-RATE-CLASS                 PIC XX.
  6755         16  CM-BENEFICIARY                PIC X(25).
  6756         16  CM-POLICY-FORM-NO             PIC X(12).
  6757         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6758         16  CM-LAST-ADD-ON-DT             PIC XX.
  6759         16  CM-DEDUCTIBLE-AMOUNTS.
  6760             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6761             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6762         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6763             20  CM-RESIDENT-STATE         PIC XX.
  6764             20  CM-RATE-CODE              PIC X(4).
  6765             20  FILLER                    PIC XX.
  6766         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6767             20  CM-LOAN-OFFICER           PIC X(5).
  6768             20  FILLER                    PIC XXX.
  6769         16  CM-CSR-CODE                   PIC XXX.
  6770         16  CM-UNDERWRITING-CODE          PIC X.
  6771             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6772         16  CM-POST-CARD-IND              PIC X.
  6773         16  CM-REF-INTERFACE-SW           PIC X.
  6774         16  CM-PREMIUM-TYPE               PIC X.
  6775             88  CM-SING-PRM                  VALUE '1'.
  6776             88  CM-O-B-COVERAGE              VALUE '2'.
  6777             88  CM-OPEN-END                  VALUE '3'.
  6778         16  CM-IND-GRP-TYPE               PIC X.
  6779             88  CM-INDIVIDUAL                VALUE 'I'.
  6780             88  CM-GROUP                     VALUE 'G'.
  6781         16  CM-SKIP-CODE                  PIC X.
  6782             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6783             88  SKIP-JULY                    VALUE '1'.
  6784             88  SKIP-AUGUST                  VALUE '2'.
  6785             88  SKIP-SEPTEMBER               VALUE '3'.
  6786             88  SKIP-JULY-AUG                VALUE '4'.
  6787             88  SKIP-AUG-SEPT                VALUE '5'.
  6788             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6789             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6790             88  SKIP-JUNE                    VALUE '8'.
  6791             88  SKIP-JUNE-JULY               VALUE '9'.
  6792             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6793             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6794         16  CM-PAYMENT-MODE               PIC X.
  6795             88  PAY-MONTHLY                  VALUE SPACE.
  6796             88  PAY-WEEKLY                   VALUE '1'.
  6797             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6798             88  PAY-BI-WEEKLY                VALUE '3'.
  6799             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6800         16  CM-LOAN-NUMBER                PIC X(8).
  6801         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6802         16  CM-OLD-LOF                    PIC XXX.
  6803*        16  CM-LOAN-OFFICER               PIC XXX.
  6804         16  CM-REIN-TABLE                 PIC XXX.
  6805         16  CM-SPECIAL-REIN-CODE          PIC X.
  6806         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6807         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6808         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6809
  6810     12  CM-STATUS-DATA.
  6811         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 126
* EL6311.cbl
  6812         16  CM-ENTRY-DT                   PIC XX.
  6813
  6814         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6815         16  CM-LF-CANCEL-DT               PIC XX.
  6816         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6817
  6818         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6819         16  CM-LF-DEATH-DT                PIC XX.
  6820         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6821
  6822         16  CM-LF-CURRENT-STATUS          PIC X.
  6823             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6824                                                'M' '4' '5' '9'.
  6825             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6826             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6827             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6828             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6829             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6830             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6831             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6832             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6833             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6834             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6835             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6836             88  CM-LF-DECLINED               VALUE 'D'.
  6837             88  CM-LF-VOIDED                 VALUE 'V'.
  6838
  6839         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6840         16  CM-AH-CANCEL-DT               PIC XX.
  6841         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6842
  6843         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6844         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6845         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6846
  6847         16  CM-AH-CURRENT-STATUS          PIC X.
  6848             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6849                                                'M' '4' '5' '9'.
  6850             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6851             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6852             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6853             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6854             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6855             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6856             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6857             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6858             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6859             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6860             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6861             88  CM-AH-DECLINED               VALUE 'D'.
  6862             88  CM-AH-VOIDED                 VALUE 'V'.
  6863
  6864         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6865             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6866             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6867             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6868         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6869
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 127
* EL6311.cbl
  6870         16  CM-ENTRY-BATCH                PIC X(6).
  6871         16  CM-LF-EXIT-BATCH              PIC X(6).
  6872         16  CM-AH-EXIT-BATCH              PIC X(6).
  6873         16  CM-LAST-MONTH-END             PIC XX.
  6874
  6875     12  CM-NOTE-SW                        PIC X.
  6876         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6877         88  CERT-NOTES-PRESENT               VALUE '1'.
  6878         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6879         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6880         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6881         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6882         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6883         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6884     12  CM-COMP-EXCP-SW                   PIC X.
  6885         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6886         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6887     12  CM-INSURED-ADDRESS-SW             PIC X.
  6888         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6889         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6890
  6891*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6892     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6893     12  FILLER                            PIC X.
  6894
  6895*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6896     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6897     12  FILLER                            PIC X.
  6898*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6899     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6900
  6901     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6902         88  CERT-ADDED-BATCH                 VALUE ' '.
  6903         88  CERT-ADDED-ONLINE                VALUE '1'.
  6904         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6905         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6906         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6907     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6908         88  CERT-AS-LOADED                   VALUE ' '.
  6909         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6910         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6911         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6912         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6913         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6914         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6915         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6916
  6917     12  CM-ACCOUNT-COMM-PCTS.
  6918         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6919         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6920
  6921     12  CM-USER-FIELD                     PIC X.
  6922     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6923     12  CM-CLP-STATE                      PIC XX.
  6924     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6925     12  CM-USER-RESERVED                  PIC XXX.
  6926     12  FILLER REDEFINES CM-USER-RESERVED.
  6927         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 128
* EL6311.cbl
  6928         16  F                             PIC X.
  6929******************************************************************
  6930*                                COPY ERCNOTE.
  6931******************************************************************
  6932*                                                                *
  6933*                                                                *
  6934*                            ERCNOTE                             *
  6935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6936*                            VMOD=2.003                          *
  6937*                                                                *
  6938*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6939*                                                                *
  6940*        FILE TYPE= VSAM,KSDS                                    *
  6941*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6942*                                                                *
  6943*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6944*                                                                *
  6945*        LOG = YES                                               *
  6946*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6947*                                                                *
  6948******************************************************************
  6949*                   C H A N G E   L O G
  6950*
  6951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6952*-----------------------------------------------------------------
  6953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6954* EFFECTIVE    NUMBER
  6955*-----------------------------------------------------------------
  6956* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6957*                                FILE WILL CONTAIN BILLING NOTES O
  6958******************************************************************
  6959
  6960 01  CERTIFICATE-NOTE.
  6961     12  CN-RECORD-ID                PIC  XX.
  6962         88  VALID-CN-ID                  VALUE 'CN'.
  6963
  6964     12  CN-CONTROL-PRIMARY.
  6965         16  CN-COMPANY-CD           PIC X.
  6966         16  CN-CARRIER              PIC X.
  6967         16  CN-GROUPING.
  6968             20 CN-GROUPING-PREFIX   PIC XXX.
  6969             20 CN-GROUPING-PRIME    PIC XXX.
  6970         16  CN-STATE                PIC XX.
  6971         16  CN-ACCOUNT.
  6972             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6973             20 CN-ACCOUNT-PRIME     PIC X(6).
  6974         16  CN-CERT-EFF-DT          PIC XX.
  6975         16  CN-CERT-NO.
  6976             20  CN-CERT-PRIME       PIC X(10).
  6977             20  CN-CERT-SFX         PIC X.
  6978
  6979     12  CN-BILLING-START-LINE-NO    PIC 99.
  6980     12  CN-BILLING-END-LINE-NO      PIC 99.
  6981
  6982     12  CN-LINES.
  6983         16  CN-LINE OCCURS 10       PIC X(77).
  6984
  6985     12  CN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 129
* EL6311.cbl
  6986     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6987     12  CN-LAST-MAINT-USER          PIC X(4).
  6988     12  FILLER                      PIC X(6).
  6989******************************************************************
  6990*                                COPY ERCPNDM.
  6991******************************************************************
  6992*                                                                *
  6993*                                                                *
  6994*                            ERCPNDM                             *
  6995*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6996*                            VMOD=2.003                          *
  6997*                                                                *
  6998*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6999*                                                                *
  7000*   FILE TYPE = VSAM,KSDS                                        *
  7001*   RECORD SIZE = 374   RECFORM = FIX                            *
  7002*                                                                *
  7003*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  7004*   ALTERNATE PATH    = NOT USED                                 *
  7005*                                                                *
  7006*   LOG = YES                                                    *
  7007*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7008******************************************************************
  7009*                   C H A N G E   L O G
  7010*
  7011* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7012*-----------------------------------------------------------------
  7013*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7014* EFFECTIVE    NUMBER
  7015*-----------------------------------------------------------------
  7016* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7017* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7018* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7019* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7020******************************************************************
  7021
  7022 01  PENDING-MAILING-DATA.
  7023     12  PM-RECORD-ID                      PIC XX.
  7024         88  VALID-MA-ID                       VALUE 'PM'.
  7025
  7026     12  PM-CONTROL-PRIMARY.
  7027         16  PM-COMPANY-CD                 PIC X.
  7028         16  PM-ENTRY-BATCH                PIC X(6).
  7029         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7030         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7031
  7032     12  FILLER                            PIC X(14).
  7033
  7034     12  PM-ACCESS-CONTROL.
  7035         16  PM-SOURCE-SYSTEM              PIC XX.
  7036             88  PM-FROM-CREDIT                VALUE 'CR'.
  7037             88  PM-FROM-VSI                   VALUE 'VS'.
  7038             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7039             88  PM-FROM-OTHER                 VALUE 'OT'.
  7040         16  PM-RECORD-ADD-DT              PIC XX.
  7041         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7042         16  PM-LAST-MAINT-DT              PIC XX.
  7043         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 130
* EL6311.cbl
  7044         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7045
  7046     12  PM-PROFILE-INFO.
  7047         16  PM-QUALIFY-CODE-1             PIC XX.
  7048         16  PM-QUALIFY-CODE-2             PIC XX.
  7049         16  PM-QUALIFY-CODE-3             PIC XX.
  7050         16  PM-QUALIFY-CODE-4             PIC XX.
  7051         16  PM-QUALIFY-CODE-5             PIC XX.
  7052
  7053         16  PM-INSURED-LAST-NAME          PIC X(15).
  7054         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7055         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7056         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7057         16  PM-INSURED-BIRTH-DT           PIC XX.
  7058         16  PM-INSURED-SEX                PIC X.
  7059             88  PM-SEX-MALE                   VALUE 'M'.
  7060             88  PM-SEX-FEMALE                 VALUE 'F'.
  7061         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7062
  7063         16  PM-ADDRESS-CORRECTED          PIC X.
  7064         16  PM-JOINT-BIRTH-DT             PIC XX.
  7065*        16  FILLER                        PIC X(12).
  7066
  7067         16  PM-ADDRESS-LINE-1             PIC X(30).
  7068         16  PM-ADDRESS-LINE-2             PIC X(30).
  7069         16  PM-CITY-STATE.
  7070             20  PM-CITY                   PIC X(28).
  7071             20  PM-STATE                  PIC XX.
  7072         16  PM-ZIP.
  7073             20  PM-ZIP-CODE.
  7074                 24  PM-ZIP-1              PIC X.
  7075                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7076                 24  FILLER                PIC X(4).
  7077             20  PM-ZIP-PLUS4              PIC X(4).
  7078         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7079             20  PM-CAN-POST1              PIC XXX.
  7080             20  PM-CAN-POST2              PIC XXX.
  7081             20  FILLER                    PIC XXX.
  7082
  7083         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7084         16  pm-city-st-zip-verified       pic x.
  7085         16  FILLER                        PIC XX.
  7086
  7087     12  PM-CRED-BENE-INFO.
  7088         16  PM-CRED-BENE-NAME             PIC X(25).
  7089         16  PM-CRED-BENE-ADDR             PIC X(30).
  7090         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7091         16  PM-CRED-BENE-CTYST.
  7092             20  PM-CRED-BENE-CITY         PIC X(28).
  7093             20  PM-CRED-BENE-STATE        PIC XX.
  7094         16  PM-CRED-BENE-ZIP.
  7095             20  PM-CB-ZIP-CODE.
  7096                 24  PM-CB-ZIP-1           PIC X.
  7097                     88  PM-CB-CANADIAN-POST-CODE
  7098                                  VALUE 'A' THRU 'Z'.
  7099                 24  FILLER                PIC X(4).
  7100             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7101         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 131
* EL6311.cbl
  7102             20  PM-CB-CAN-POST1           PIC XXX.
  7103             20  PM-CB-CAN-POST2           PIC XXX.
  7104             20  FILLER                    PIC XXX.
  7105     12  PM-POST-CARD-MAIL-DATA.
  7106         16  PM-MAIL-DATA OCCURS 7.
  7107             20  PM-MAIL-TYPE              PIC X.
  7108                 88  PM-12MO-MAILING           VALUE '1'.
  7109                 88  PM-EXP-MAILING            VALUE '2'.
  7110             20  PM-MAIL-STATUS            PIC X.
  7111                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7112                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7113                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7114             20  PM-MAIL-DATE              PIC XX.
  7115     12  FILLER                            PIC XX.
  7116     12  FILLER                            PIC X(12).
  7117*    12  FILLER                            PIC X(30).
  7118
  7119******************************************************************
  7120*                                COPY ERCMAIL.
  7121******************************************************************
  7122*                                                                *
  7123*                                                                *
  7124*                            ERCMAIL                             *
  7125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7126*                            VMOD=2.003                          *
  7127*                                                                *
  7128*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7129*                                                                *
  7130*   FILE TYPE = VSAM,KSDS                                        *
  7131*   RECORD SIZE = 374   RECFORM = FIX                            *
  7132*                                                                *
  7133*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7134*   ALTERNATE PATH    = NOT USED                                 *
  7135*                                                                *
  7136*   LOG = YES                                                    *
  7137*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7138******************************************************************
  7139*                   C H A N G E   L O G
  7140*
  7141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7142*-----------------------------------------------------------------
  7143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7144* EFFECTIVE    NUMBER
  7145*-----------------------------------------------------------------
  7146* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7147* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7148* 111108                   PEMA  ADD CRED BENE ADDR2
  7149******************************************************************
  7150
  7151 01  MAILING-DATA.
  7152     12  MA-RECORD-ID                      PIC XX.
  7153         88  VALID-MA-ID                       VALUE 'MA'.
  7154
  7155     12  MA-CONTROL-PRIMARY.
  7156         16  MA-COMPANY-CD                 PIC X.
  7157         16  MA-CARRIER                    PIC X.
  7158         16  MA-GROUPING.
  7159             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 132
* EL6311.cbl
  7160             20  MA-GROUPING-PRIME         PIC XXX.
  7161         16  MA-STATE                      PIC XX.
  7162         16  MA-ACCOUNT.
  7163             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7164             20  MA-ACCOUNT-PRIME          PIC X(6).
  7165         16  MA-CERT-EFF-DT                PIC XX.
  7166         16  MA-CERT-NO.
  7167             20  MA-CERT-PRIME             PIC X(10).
  7168             20  MA-CERT-SFX               PIC X.
  7169
  7170     12  FILLER                            PIC XX.
  7171
  7172     12  MA-ACCESS-CONTROL.
  7173         16  MA-SOURCE-SYSTEM              PIC XX.
  7174             88  MA-FROM-CREDIT                VALUE 'CR'.
  7175             88  MA-FROM-VSI                   VALUE 'VS'.
  7176             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7177             88  MA-FROM-OTHER                 VALUE 'OT'.
  7178         16  MA-RECORD-ADD-DT              PIC XX.
  7179         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7180         16  MA-LAST-MAINT-DT              PIC XX.
  7181         16  MA-LAST-MAINT-BY              PIC XXXX.
  7182         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7183
  7184     12  MA-PROFILE-INFO.
  7185         16  MA-QUALIFY-CODE-1             PIC XX.
  7186         16  MA-QUALIFY-CODE-2             PIC XX.
  7187         16  MA-QUALIFY-CODE-3             PIC XX.
  7188         16  MA-QUALIFY-CODE-4             PIC XX.
  7189         16  MA-QUALIFY-CODE-5             PIC XX.
  7190
  7191         16  MA-INSURED-LAST-NAME          PIC X(15).
  7192         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7193         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7194         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7195         16  MA-INSURED-BIRTH-DT           PIC XX.
  7196         16  MA-INSURED-SEX                PIC X.
  7197             88  MA-SEX-MALE                   VALUE 'M'.
  7198             88  MA-SEX-FEMALE                 VALUE 'F'.
  7199         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7200
  7201         16  MA-ADDRESS-CORRECTED          PIC X.
  7202         16  MA-JOINT-BIRTH-DT             PIC XX.
  7203*        16  FILLER                        PIC X(12).
  7204
  7205         16  MA-ADDRESS-LINE-1             PIC X(30).
  7206         16  MA-ADDRESS-LINE-2             PIC X(30).
  7207         16  MA-CITY-STATE.
  7208             20  MA-CITY                   PIC X(28).
  7209             20  MA-ADDR-STATE             PIC XX.
  7210         16  MA-ZIP.
  7211             20  MA-ZIP-CODE.
  7212                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7213                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7214                 24  FILLER                PIC X(4).
  7215             20  MA-ZIP-PLUS4              PIC X(4).
  7216         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7217             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 133
* EL6311.cbl
  7218             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7219             20  FILLER                    PIC X(3).
  7220
  7221         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7222
  7223         16  FILLER                        PIC XXX.
  7224*        16  FILLER                        PIC X(10).
  7225
  7226     12  MA-CRED-BENE-INFO.
  7227         16  MA-CRED-BENE-NAME                 PIC X(25).
  7228         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7229         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7230         16  MA-CRED-BENE-CTYST.
  7231             20  MA-CRED-BENE-CITY             PIC X(28).
  7232             20  MA-CRED-BENE-STATE            PIC XX.
  7233         16  MA-CRED-BENE-ZIP.
  7234             20  MA-CB-ZIP-CODE.
  7235                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7236                     88  MA-CB-CANADIAN-POST-CODE
  7237                                           VALUE 'A' THRU 'Z'.
  7238                 24  FILLER                    PIC X(4).
  7239             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7240         16  MA-CB-CANADIAN-POSTAL-CODE
  7241                            REDEFINES MA-CRED-BENE-ZIP.
  7242             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7243             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7244             20  FILLER                        PIC X(3).
  7245     12  MA-POST-CARD-MAIL-DATA.
  7246         16  MA-MAIL-DATA OCCURS 7.
  7247             20  MA-MAIL-TYPE              PIC X.
  7248                 88  MA-12MO-MAILING           VALUE '1'.
  7249                 88  MA-EXP-MAILING            VALUE '2'.
  7250             20  MA-MAIL-STATUS            PIC X.
  7251                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7252                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7253                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7254             20  MA-MAIL-DATE              PIC XX.
  7255     12  FILLER                            PIC XX.
  7256     12  FILLER                            PIC XX.
  7257*    12  FILLER                            PIC X(30).
  7258******************************************************************
  7259*                                COPY ERCRQST.
  7260******************************************************************
  7261*                                                                *
  7262*                                                                *
  7263*                            ERCRQST.                            *
  7264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7265*                            VMOD=2.002                          *
  7266*                                                                *
  7267*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7268*                                                                *
  7269*   FILE TYPE = VSAM,KSDS                                        *
  7270*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7271*                                                                *
  7272*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7273*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7274*                                   ACCOUNT, REF, BATCH)         *
  7275*                                                RKP=9, LEN=38   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 134
* EL6311.cbl
  7276*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7277*                                   ACCOUNT, REF, BATCH)         *
  7278*                                                RKP=47, LEN=46  *
  7279*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7280*                                   BATCH)                       *
  7281*                                                RKP=93, LEN=24  *
  7282*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7283*                                   REF, BATCH)                  *
  7284*                                                RKP=117, LEN=35 *
  7285*   LOG = NO                                                     *
  7286*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7287******************************************************************
  7288
  7289 01  AR-REQUEST-RECORD.
  7290     12  RQ-RECORD-ID                     PIC XX.
  7291         88  VALID-RQ-ID                        VALUE 'RQ'.
  7292
  7293     12  RQ-CONTROL-PRIMARY.
  7294         16  RQ-COMPANY-CD                PIC X.
  7295         16  RQ-ENTRY-BATCH               PIC X(6).
  7296
  7297     12  RQ-CONTROL-BY-ACCT-REF.
  7298         16  RQ-COMPANY-CD-A1             PIC X.
  7299         16  RQ-CARRIER-A1                PIC X.
  7300         16  RQ-GROUPING-A1               PIC X(6).
  7301         16  RQ-STATE-A1                  PIC XX.
  7302         16  RQ-ACCOUNT-A1                PIC X(10).
  7303         16  RQ-REFERENCE-A1              PIC X(12).
  7304         16  RQ-BATCH-A1                  PIC X(6).
  7305
  7306     12  RQ-CONTROL-BY-FIN-RESP.
  7307         16  RQ-COMPANY-CD-A2             PIC X.
  7308         16  RQ-CARRIER-A2                PIC X.
  7309         16  RQ-GROUPING-A2               PIC X(6).
  7310         16  RQ-FIN-RESP-A2               PIC X(10).
  7311         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7312         16  RQ-REFERENCE-A2              PIC X(12).
  7313         16  RQ-BATCH-A2                  PIC X(6).
  7314
  7315     12  RQ-CONTROL-BY-ACCT-AGENT.
  7316         16  RQ-COMPANY-CD-A3             PIC X.
  7317         16  RQ-CARRIER-A3                PIC X.
  7318         16  RQ-GROUPING-A3               PIC X(6).
  7319         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7320         16  RQ-BATCH-A3                  PIC X(6).
  7321
  7322     12  RQ-CONTROL-BY-SUMMARY.
  7323         16  RQ-COMPANY-CD-A4             PIC X.
  7324         16  RQ-SUMMARY-CODE              PIC X(6).
  7325         16  RQ-ACCOUNT-A4                PIC X(10).
  7326         16  RQ-REFERENCE-A4              PIC X(12).
  7327         16  RQ-BATCH-A4                  PIC X(6).
  7328
  7329     12  RQ-REQUEST-METHOD                PIC X.
  7330         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7331         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7332         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7333         88 RQ-BATCH-REQUEST                  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 135
* EL6311.cbl
  7334     12  FILLER                           PIC X.
  7335     12  RQ-STATUS                        PIC X.
  7336         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7337         88  RQ-RESUBMIT                      VALUE 'R'.
  7338     12  RQ-PROCESSOR-ID                  PIC X(4).
  7339     12  RQ-ENTRY-DT                      PIC XX.
  7340     12  RQ-MO-END-DT                     PIC XX.
  7341     12  RQ-REQUEST-DT                    PIC XX.
  7342     12  RQ-STMT-DT                       PIC XX.
  7343     12  RQ-REVERSAL-DT                   PIC XX.
  7344     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7345     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7346
  7347     12  FILLER                           PIC X(27).
  7348
  7349******************************************************************
  7350
  7351*                                COPY ERCLOFC.
  7352******************************************************************
  7353*                                                                *
  7354*                                                                *
  7355*                            ERCLOFC                             *
  7356*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7357*                            VMOD=2.003                          *
  7358*                                                                *
  7359*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7360*                                                                *
  7361*   FILE TYPE = VSAM,KSDS                                        *
  7362*   RECORD SIZE = 670   RECFORM = FIX                            *
  7363*                                                                *
  7364*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7365*                                                                *
  7366*   LOG = YES                                                    *
  7367*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7368*                                                                *
  7369******************************************************************
  7370
  7371 01  LOAN-OFFICER-MASTER.
  7372     12  LO-RECORD-ID                PIC XX.
  7373         88  VALID-LO-ID                VALUE 'LO'.
  7374
  7375     12  LO-CONTROL-PRIMARY.
  7376         16  LO-COMPANY-CD           PIC X.
  7377         16  LO-CARRIER              PIC X.
  7378         16  LO-GROUPING.
  7379             20  LO-GROUPING-PREFIX  PIC XXX.
  7380             20  LO-GROUPING-PRIME   PIC XXX.
  7381         16  LO-STATE                PIC XX.
  7382         16  LO-ACCOUNT.
  7383             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7384             20  LO-ACCOUNT-PRIME    PIC X(6).
  7385         16  LO-OFFICER-CODE         PIC X(5).
  7386
  7387     12  LO-OFFICER-NAME             PIC X(30).
  7388
  7389     12  LO-LAST-MAINT-DT            PIC XX.
  7390     12  LO-LAST-USER                PIC X(4).
  7391     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 136
* EL6311.cbl
  7392
  7393     12  LO-COMP-CONTROL             PIC X.
  7394             88  LO-SHOW-COMP           VALUE 'Y'.
  7395             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7396     12  LO-DETAIL-CONTROL           PIC X.
  7397             88  LO-PRINT-DETAIL        VALUE 'D'.
  7398             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7399
  7400     12  LO-SV-CARRIER               PIC X.
  7401     12  LO-SV-GROUPING              PIC X(6).
  7402     12  LO-SV-STATE                 PIC XX.
  7403
  7404     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7405     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7406
  7407     12  LO-OFFICER-INFO.
  7408         16  FILLER OCCURS 12 TIMES.
  7409             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7410             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7411             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7412             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7413             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7414             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7415             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7416             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7417     12  FILLER                      PIC X(198).
  7418******************************************************************
  7419*                                COPY ERCPYAJ.
  7420******************************************************************
  7421*                                                                *
  7422*                            ERCPYAJ                             *
  7423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7424*                            VMOD=2.015                          *
  7425*                                                                *
  7426*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7427*                                                                *
  7428*                                                                *
  7429*   FILE TYPE = VSAM,KSDS                                        *
  7430*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7431*                                                                *
  7432*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7433*       ALTERNATE PATHS = NONE                                   *
  7434*                                                                *
  7435*   LOG = YES                                                    *
  7436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7437******************************************************************
  7438******************************************************************
  7439*                   C H A N G E   L O G
  7440*
  7441* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7442*-----------------------------------------------------------------
  7443*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7444* EFFECTIVE    NUMBER
  7445*-----------------------------------------------------------------
  7446* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7447* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7448******************************************************************
  7449
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 137
* EL6311.cbl
  7450 01  PENDING-PAY-ADJ.
  7451     12  PY-RECORD-ID                     PIC XX.
  7452         88  VALID-PY-ID                        VALUE 'PY'.
  7453
  7454     12  PY-CONTROL-PRIMARY.
  7455         16  PY-COMPANY-CD                PIC X.
  7456         16  PY-CARRIER                   PIC X.
  7457         16  PY-GROUPING                  PIC X(6).
  7458         16  PY-FIN-RESP                  PIC X(10).
  7459         16  PY-ACCOUNT                   PIC X(10).
  7460         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7461                                          PIC X(10).
  7462         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7463         16  PY-RECORD-TYPE               PIC X.
  7464             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7465             88  PY-DEPOSIT                   VALUE 'D'.
  7466             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7467             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7468             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7469             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7470             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7471             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7472             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7473             88  PY-FICA-ENTRY                VALUE 'F'.
  7474             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7475             88  PY-POLICY-FEE                VALUE 'W'.
  7476             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7477
  7478     12  PY-PYMT-TYPE                     PIC X.
  7479             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7480             88  PY-REINS-PYMT                VALUE 'R'.
  7481             88  PY-EXP-PYMT                  VALUE 'E'.
  7482
  7483     12  PY-BIL-INV                       PIC X(6).
  7484     12  PY-REF-NO                        PIC X(12).
  7485
  7486     12  PY-LAST-MAINT-DT                 PIC XX.
  7487     12  PY-LAST-MAINT-BY                 PIC X(4).
  7488     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7489
  7490     12  PY-PYADJ-RECORD.
  7491         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7492         16  PY-ENTRY-COMMENT             PIC X(30).
  7493         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7494             20  PY-GL-ACCOUNT            PIC X(10).
  7495             20  PY-GL-STATE              PIC X(02).
  7496             20  PY-GL-CANC-SW            PIC X(01).
  7497                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7498                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7499             20  PY-GL-COMMENT            PIC X(10).
  7500             20  FILLER      REDEFINES PY-GL-COMMENT.
  7501                 24  PY-GL-CHECK-NO       PIC 9(06).
  7502                 24  FILLER               PIC X(04).
  7503             20  FILLER                   PIC X(07).
  7504         16  PY-SAVE-ACCOUNT              PIC X(10).
  7505         16  PY-SAVE-TYPE                 PIC X(01).
  7506
  7507         16  PY-LETTERS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 138
* EL6311.cbl
  7508             20  PY-LETTER OCCURS 3 TIMES
  7509                           INDEXED BY PY-LET-NDX
  7510                                          PIC X(04).
  7511
  7512         16  PY-ERCOMP-TYPE               PIC X.
  7513             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7514             88  PY-GA-TYPE                   VALUE 'G'.
  7515             88  PY-BANK-TYPE                 VALUE 'B'.
  7516         16  FILLER                       PIC X(05).
  7517
  7518     12  PY-RECORD-STATUS.
  7519         16  PY-CREDIT-SELECT-DT          PIC XX.
  7520         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7521         16  PY-BILLED-DATE               PIC XX.
  7522         16  PY-REPORTED-DT               PIC XX.
  7523         16  PY-PMT-APPLIED               PIC X.
  7524             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7525             88  PY-GA-PMT                    VALUE 'G'.
  7526             88  PY-OVWRITE-PMT               VALUE 'O'.
  7527             88  PY-NON-AR-PMT                VALUE 'N'.
  7528         16  FILLER                       PIC X(5).
  7529         16  PY-INPUT-DT                  PIC XX.
  7530         16  PY-CHECK-NUMBER              PIC X(6).
  7531         16  PY-VOID-SW                   PIC X.
  7532             88  PY-CHECK-VOIDED              VALUE 'V'.
  7533         16  PY-CHECK-ORIGIN-SW           PIC X.
  7534             88  PY-BILLING-CHECK             VALUE 'B'.
  7535             88  PY-REFUND-CHECK              VALUE 'R'.
  7536             88  PY-GA-CHECK                  VALUE 'G'.
  7537             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7538             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7539         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7540         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7541         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7542         16  PY-BILL-FLAG                 PIC X.
  7543             88  PY-BILLED                    VALUE 'B'.
  7544         16  PY-AR-FLAG                   PIC X.
  7545             88  PY-AR-CYCLE                  VALUE 'C'.
  7546             88  PY-AR-MONTH-END              VALUE 'M'.
  7547         16  PY-AR-DATE                   PIC XX.
  7548
  7549     12  PY-GL-CODES.
  7550         16  PY-GL-DB                     PIC X(14).
  7551         16  PY-GL-CR                     PIC X(14).
  7552         16  PY-GL-FLAG                   PIC X.
  7553         16  PY-GL-DATE                   PIC XX.
  7554
  7555     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7556     12  FILLER                           PIC X(3).
  7557******************************************************************
  7558*                                COPY ERCCNOT.
  7559******************************************************************
  7560*                                                                *
  7561*                            ERCCNOT                             *
  7562*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7563*                            VMOD=2.003                          *
  7564*                                                                *
  7565*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 139
* EL6311.cbl
  7566*                                                                *
  7567*        FILE TYPE= VSAM,KSDS                                    *
  7568*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7569*                                                                *
  7570*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7571*                                                                *
  7572*        LOG = YES                                               *
  7573*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7574*                                                                *
  7575******************************************************************
  7576*                   C H A N G E   L O G
  7577*
  7578* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7579*-----------------------------------------------------------------
  7580*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7581* EFFECTIVE    NUMBER
  7582*-----------------------------------------------------------------
  7583* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7584******************************************************************
  7585
  7586 01  CERT-NOTE-FILE.
  7587     12  CZ-RECORD-ID                PIC  XX.
  7588         88  VALID-CZ-ID                  VALUE 'CZ'.
  7589
  7590     12  CZ-CONTROL-PRIMARY.
  7591         16  CZ-COMPANY-CD           PIC X.
  7592         16  CZ-CARRIER              PIC X.
  7593         16  CZ-GROUPING.
  7594             20 CZ-GROUPING-PREFIX   PIC XXX.
  7595             20 CZ-GROUPING-PRIME    PIC XXX.
  7596         16  CZ-STATE                PIC XX.
  7597         16  CZ-ACCOUNT.
  7598             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7599             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7600         16  CZ-CERT-EFF-DT          PIC XX.
  7601         16  CZ-CERT-NO.
  7602             20  CZ-CERT-PRIME       PIC X(10).
  7603             20  CZ-CERT-SFX         PIC X.
  7604         16  CZ-RECORD-TYPE          PIC X.
  7605             88  CERT-NOTE           VALUE '1'.
  7606             88  CLAIM-CERT-NOTE     VALUE '2'.
  7607         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7608
  7609     12  CZ-LAST-MAINT-DT            PIC XX.
  7610     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7611     12  CZ-LAST-MAINT-USER          PIC X(4).
  7612
  7613     12  CZ-NOTE-INFORMATION.
  7614         16  CZ-NOTE                 PIC X(63).
  7615         16  FILLER                  PIC X(39).
  7616******************************************************************
  7617*                                COPY ELCMSTR.
  7618******************************************************************
  7619*                                                                *
  7620*                            ELCMSTR.                            *
  7621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7622*                            VMOD=2.012                          *
  7623*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 140
* EL6311.cbl
  7624*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7625*                                                                *
  7626*   FILE TYPE = VSAM,KSDS                                        *
  7627*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7628*                                                                *
  7629*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7630*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7631*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7632*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7633*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7634*                                                 RKP=75,LEN=21  *
  7635*                                                                *
  7636*   **** NOTE ****                                               *
  7637*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7638*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7639*                                                                *
  7640*   LOG = YES                                                    *
  7641*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7642******************************************************************
  7643*                   C H A N G E   L O G
  7644*
  7645* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7646*-----------------------------------------------------------------
  7647*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7648* EFFECTIVE    NUMBER
  7649*-----------------------------------------------------------------
  7650* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7651* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7652* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7653* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7654* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7655* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7656* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7657******************************************************************
  7658 01  CLAIM-MASTER.
  7659     12  CL-RECORD-ID                PIC XX.
  7660         88  VALID-CL-ID         VALUE 'CL'.
  7661
  7662     12  CL-CONTROL-PRIMARY.
  7663         16  CL-COMPANY-CD           PIC X.
  7664         16  CL-CARRIER              PIC X.
  7665         16  CL-CLAIM-NO             PIC X(7).
  7666         16  CL-CERT-NO.
  7667             20  CL-CERT-PRIME       PIC X(10).
  7668             20  CL-CERT-SFX         PIC X.
  7669
  7670     12  CL-CONTROL-BY-NAME.
  7671         16  CL-COMPANY-CD-A1        PIC X.
  7672         16  CL-INSURED-LAST-NAME    PIC X(15).
  7673         16  CL-INSURED-NAME.
  7674             20  CL-INSURED-1ST-NAME PIC X(12).
  7675             20  CL-INSURED-MID-INIT PIC X.
  7676
  7677     12  CL-CONTROL-BY-SSN.
  7678         16  CL-COMPANY-CD-A2        PIC X.
  7679         16  CL-SOC-SEC-NO.
  7680             20  CL-SSN-STATE        PIC XX.
  7681             20  CL-SSN-ACCOUNT      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 141
* EL6311.cbl
  7682             20  CL-SSN-LN3          PIC X(3).
  7683
  7684     12  CL-CONTROL-BY-CERT-NO.
  7685         16  CL-COMPANY-CD-A4        PIC X.
  7686         16  CL-CERT-NO-A4.
  7687             20  CL-CERT-A4-PRIME    PIC X(10).
  7688             20  CL-CERT-A4-SFX      PIC X.
  7689
  7690     12  CL-CONTROL-BY-CCN.
  7691         16  CL-COMPANY-CD-A5        PIC X.
  7692         16  CL-CCN-A5.
  7693             20  CL-CCN.
  7694                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7695                 24  CL-CCN-PRIME-A5 PIC X(12).
  7696             20  CL-CCN-FILLER-A5    PIC X(4).
  7697
  7698     12  CL-INSURED-PROFILE-DATA.
  7699         16  CL-INSURED-BIRTH-DT     PIC XX.
  7700         16  CL-INSURED-SEX-CD       PIC X.
  7701             88  INSURED-IS-MALE        VALUE 'M'.
  7702             88  INSURED-IS-FEMALE      VALUE 'F'.
  7703             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7704         16  CL-INSURED-OCC-CD       PIC X(6).
  7705         16  FILLER                  PIC X(5).
  7706
  7707     12  CL-PROCESSING-INFO.
  7708         16  CL-PROCESSOR-ID         PIC X(4).
  7709         16  CL-CLAIM-STATUS         PIC X.
  7710             88  CLAIM-IS-OPEN          VALUE 'O'.
  7711             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7712         16  CL-CLAIM-TYPE           PIC X.
  7713*            88  AH-CLAIM               VALUE 'A'.
  7714*            88  LIFE-CLAIM             VALUE 'L'.
  7715*            88  PROPERTY-CLAIM         VALUE 'P'.
  7716*            88  IUI-CLAIM              VALUE 'I'.
  7717*            88  GAP-CLAIM              VALUE 'G'.
  7718*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7719*            88  OTHER-CLAIM            VALUE 'O'.
  7720         16  CL-CLAIM-PREM-TYPE      PIC X.
  7721             88  SINGLE-PREMIUM         VALUE '1'.
  7722             88  O-B-COVERAGE           VALUE '2'.
  7723             88  OPEN-END-COVERAGE      VALUE '3'.
  7724         16  CL-INCURRED-DT          PIC XX.
  7725         16  CL-REPORTED-DT          PIC XX.
  7726         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7727         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7728         16  CL-LAST-PMT-DT          PIC XX.
  7729         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7730         16  CL-PAID-THRU-DT         PIC XX.
  7731         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7732         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7733         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7734         16  CL-PMT-CALC-METHOD      PIC X.
  7735             88  CL-360-DAY-YR          VALUE '1'.
  7736             88  CL-365-DAY-YR          VALUE '2'.
  7737             88  CL-FULL-MONTHS         VALUE '3'.
  7738         16  CL-CAUSE-CD             PIC X(6).
  7739
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 142
* EL6311.cbl
  7740         16  CL-PRIME-CERT-NO.
  7741             20  CL-PRIME-CERT-PRIME PIC X(10).
  7742             20  CL-PRIME-CERT-SFX   PIC X.
  7743
  7744         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7745             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7746             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7747
  7748         16  CL-MICROFILM-NO         PIC X(10).
  7749         16  FILLER REDEFINES CL-MICROFILM-NO.
  7750             20  CL-BENEFIT-PERIOD   PIC 99.
  7751             20  FILLER              PIC X(8).
  7752         16  CL-PROG-FORM-TYPE       PIC X.
  7753         16  CL-LAST-ADD-ON-DT       PIC XX.
  7754
  7755         16  CL-LAST-REOPEN-DT       PIC XX.
  7756         16  CL-LAST-CLOSE-DT        PIC XX.
  7757         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7758             88  FINAL-PAID             VALUE '1'.
  7759             88  CLAIM-DENIED           VALUE '2'.
  7760             88  AUTO-CLOSE             VALUE '3'.
  7761             88  MANUAL-CLOSE           VALUE '4'.
  7762             88  BENEFITS-CHANGED       VALUE 'C'.
  7763             88  SETUP-ERRORS           VALUE 'E'.
  7764         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7765         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7766         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7767             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7768         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7769         16  FILLER                  PIC X.
  7770
  7771     12  CL-CERTIFICATE-DATA.
  7772         16  CL-CERT-ORIGIN          PIC X.
  7773             88  CERT-WAS-ONLINE        VALUE '1'.
  7774             88  CERT-WAS-CREATED       VALUE '2'.
  7775             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7776         16  CL-CERT-KEY-DATA.
  7777             20  CL-CERT-CARRIER     PIC X.
  7778             20  CL-CERT-GROUPING    PIC X(6).
  7779             20  CL-CERT-STATE       PIC XX.
  7780             20  CL-CERT-ACCOUNT.
  7781                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7782                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7783             20  CL-CERT-EFF-DT      PIC XX.
  7784
  7785     12  CL-STATUS-CONTROLS.
  7786         16  CL-PRIORITY-CD          PIC X.
  7787             88  CONFIDENTIAL-DATA      VALUE '8'.
  7788             88  HIGHEST-PRIORITY       VALUE '9'.
  7789         16  CL-SUPV-ATTN-CD         PIC X.
  7790             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7791             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7792         16  CL-PURGED-DT            PIC XX.
  7793         16  CL-RESTORED-DT          PIC XX.
  7794         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7795         16  CL-NEXT-RESEND-DT       PIC XX.
  7796         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7797         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 143
* EL6311.cbl
  7798*        16  FILLER                  PIC XX.
  7799         16  CL-LAST-MAINT-DT        PIC XX.
  7800         16  CL-LAST-MAINT-USER      PIC X(4).
  7801         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7802         16  CL-LAST-MAINT-TYPE      PIC X.
  7803             88  CLAIM-SET-UP           VALUE ' '.
  7804             88  PAYMENT-MADE           VALUE '1'.
  7805             88  LETTER-SENT            VALUE '2'.
  7806             88  MASTER-WAS-ALTERED     VALUE '3'.
  7807             88  MASTER-WAS-RESTORED    VALUE '4'.
  7808             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7809             88  FILE-CONVERTED         VALUE '6'.
  7810             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7811             88  ERROR-CORRECTION       VALUE 'E'.
  7812         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7813         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7814         16  CL-BENEFICIARY          PIC X(10).
  7815         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7816         16  CL-DENIAL-TYPE          PIC X.
  7817             88  CL-TYPE-DENIAL          VALUE '1'.
  7818             88  CL-TYPE-RESCISSION      VALUE '2'.
  7819             88  CL-TYPE-REFORMATION     VALUE '3'.
  7820             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7821             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7822         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7823         16  filler                  pic x(3).
  7824*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7825*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7826*        16  CL-RTW-DT               PIC XX.
  7827
  7828     12  CL-TRAILER-CONTROLS.
  7829         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7830             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7831             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7832             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7833         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7834         16  FILLER                  PIC XX.
  7835         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7836         16  CL-ADDRESS-TRAILER-CNT.
  7837             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7838                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7839             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7840                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7841             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7842                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7843             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7844                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7845             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7846                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7847             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7848                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7849             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7850                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7851
  7852     12  CL-CV-REFERENCE-NO.
  7853         16  CL-CV-REFNO-PRIME       PIC X(18).
  7854         16  CL-CV-REFNO-SFX         PIC XX.
  7855
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 144
* EL6311.cbl
  7856     12  CL-FILE-LOCATION            PIC X(4).
  7857
  7858     12  CL-PROCESS-ERRORS.
  7859         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7860             88  NO-FATAL-ERRORS        VALUE ZERO.
  7861         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7862             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7863
  7864     12  CL-PRODUCT-CD               PIC X.
  7865
  7866     12  CL-CURRENT-KEY-DATA.
  7867         16  CL-CURRENT-CARRIER      PIC X.
  7868         16  CL-CURRENT-GROUPING     PIC X(6).
  7869         16  CL-CURRENT-STATE        PIC XX.
  7870         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7871
  7872     12  CL-ASSOCIATES               PIC X.
  7873         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7874         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7875         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7876         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7877
  7878     12  CL-ACTIVITY-CODE            PIC 99.
  7879     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7880     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7881
  7882     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7883     12  CL-LAG-REPORT-CODE          PIC 9.
  7884     12  CL-LOAN-TYPE                PIC XX.
  7885     12  CL-LEGAL-STATE              PIC XX.
  7886
  7887     12  CL-YESNOSW                  PIC X.
  7888     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7889         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7890         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7891         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7892     12  cl-insured-type             pic x.
  7893         88  cl-claim-on-primary         value 'P'.
  7894         88  cl-claim-on-co-borrower     value 'C'.
  7895     12  cl-benefit-expiration-dt    PIC XX.
  7896*                                COPY ERCENDT.
  7897******************************************************************
  7898*                                                                *
  7899*                                                                *
  7900*                            ERCENDT.                            *
  7901*                            VMOD=2.001                          *
  7902*                                                                *
  7903*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7904*                                                                *
  7905*   FILE TYPE = VSAM,KSDS                                        *
  7906*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7907*                                                                *
  7908*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7909*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7910*                                                                *
  7911*   LOG = NO                                                     *
  7912*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7913******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 145
* EL6311.cbl
  7914*-----------------------------------------------------------------
  7915*                   C H A N G E   L O G
  7916*
  7917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7918*-----------------------------------------------------------------
  7919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7920* EFFECTIVE    NUMBER
  7921*-----------------------------------------------------------------
  7922* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7923*                                WITH OPEN CLAIMS
  7924* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7925* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7926* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7927* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7928*-----------------------------------------------------------------
  7929 01  ENDORSEMENT-RECORD.
  7930     12  EN-RECORD-ID                PIC XX.
  7931         88  VALID-EN-ID                VALUE 'EN'.
  7932     12  EN-CONTROL-PRIMARY.
  7933         16  EN-COMPANY-CD           PIC X.
  7934         16  EN-CARRIER              PIC X.
  7935         16  EN-GROUPING             PIC X(6).
  7936         16  EN-STATE                PIC XX.
  7937         16  EN-ACCOUNT              PIC X(10).
  7938         16  EN-CERT-EFF-DT          PIC XX.
  7939         16  EN-CERT-NO.
  7940             20  EN-CERT-PRIME       PIC X(10).
  7941             20  EN-CERT-SFX         PIC X.
  7942         16  EN-REC-TYPE             PIC X.
  7943             88  EN-ISSUE               VALUE 'I'.
  7944             88  EN-CANCELLATION        VALUE 'C'.
  7945         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7946     12  EN-CONTROL-BY-ARCH-NO.
  7947         16  EN-COMPANY-CD-A1              PIC X.
  7948         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7949     12  EN-LAST-MAINT-DT            PIC XX.
  7950     12  EN-LAST-MAINT-BY            PIC X(4).
  7951     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7952     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7953     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7954         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7955         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7956         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7957         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7958         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7959         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7960         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7961         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7962         16  EN-LF-ORIG-BENCD        PIC XX.
  7963         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7964         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7965         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7966         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7967         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7968         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7969*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7970         16  EN-ORIG-CRED-BENE       PIC X(25).
  7971         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 146
* EL6311.cbl
  7972         16  FILLER                  PIC X.
  7973         16  EN-AH-ORIG-BENCD        PIC XX.
  7974         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7975         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7976         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7977         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7978*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7979*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7980         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7981         16  F                       PIC X(09).
  7982         16  EN-AH-ORIG-CP           PIC 99.
  7983         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7984         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7985         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7986         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7987         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7988         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7989         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7990         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7991         16  EN-LF-NEW-BENCD         PIC XX.
  7992         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7993         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7994         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7995         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7996         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7997         16  EN-LF-NEW-EXP-DT        PIC XX.
  7998         16  EN-NEW-CRED-BENE        PIC X(25).
  7999         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8000         16  FILLER                  PIC X.
  8001         16  EN-AH-NEW-BENCD         PIC XX.
  8002         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8003         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8004         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8005         16  EN-AH-NEW-EXP-DT        PIC XX.
  8006*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8007*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8008*        16  F                       PIC X(12).
  8009         16  EN-AH-NEW-CP            PIC 99.
  8010         16  EN-SIG-SW               PIC X.
  8011         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8012         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8013         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8014         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8015         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8016         16  FILLER                  PIC X(33).
  8017     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8018         16  EN-LF-ORIG-REF-DT       PIC XX.
  8019         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8020         16  EN-AH-ORIG-REF-DT       PIC XX.
  8021         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8022         16  EN-LF-NEW-REF-DT        PIC XX.
  8023         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8024         16  EN-AH-NEW-REF-DT        PIC XX.
  8025         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8026         16  EN-FLAG-CERT            PIC X.
  8027         16  EN-INS-LAST-NAME        PIC X(15).
  8028         16  EN-INS-FIRST-NAME       PIC X(10).
  8029         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 147
* EL6311.cbl
  8030         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8031         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8032         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8033         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8034         16  FILLER                  PIC X(262).
  8035     12  EN-MONEY-SW             PIC X.
  8036     12  EN-HEALTH-APP           PIC X.
  8037     12  EN-VOUCHER-SW           PIC X.
  8038     12  EN-PAYEE                PIC X(14).
  8039     12  EN-INPUT-DT             PIC XX.
  8040     12  EN-PROCESS-DT           PIC XX.
  8041     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8042     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8043     12  EN-REASON-CODES.
  8044         16  F OCCURS 12.
  8045             20  EN-REASON-CODE  PIC X(4).
  8046     12  EN-TEMPLATE-USED        PIC X(8).
  8047     12  EN-DOCU-TYPE            PIC X.
  8048         88  EN-VERI-DOCU          VALUE 'V'.
  8049         88  EN-GCE-DOCU           VALUE 'G'.
  8050         88  EN-CANC-DOCU          VALUE 'C'.
  8051     12  EN-COMMENTS1            PIC X(13).
  8052     12  EN-COMMENTS2            PIC X(70).
  8053     12  EN-COMM-CHGBK           PIC X.
  8054         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8055         88  EN-CHG-ACCT           VALUE 'Y'.
  8056     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8057     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8058     12  EN-BATCH-NUMBER         PIC X(6).
  8059     12  EN-ACCT-SUMM            PIC X.
  8060     12  EN-CSO-SUMM             PIC X.
  8061     12  en-check-type           pic x.
  8062     12  FILLER                  PIC X(12).
  8063******************************************************************
  8064*                                COPY ELCCRTT.
  8065******************************************************************
  8066*                                                                *
  8067*                            ELCCRTT.                            *
  8068*                                                                *
  8069*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8070*                                                                *
  8071*   FILE TYPE = VSAM,KSDS                                        *
  8072*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8073*                                                                *
  8074*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8075*                                                                *
  8076*   LOG = YES                                                    *
  8077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8078******************************************************************
  8079*                   C H A N G E   L O G
  8080*
  8081* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8082*-----------------------------------------------------------------
  8083*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8084* EFFECTIVE    NUMBER
  8085*-----------------------------------------------------------------
  8086* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8087* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 148
* EL6311.cbl
  8088* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8089* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8090* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8091* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8092* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8093* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8094* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8095* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8096* 091318  CR2018073000001  PEMA  ADD Refund methods
  8097* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8098******************************************************************
  8099
  8100 01  CERTIFICATE-TRAILERS.
  8101     12  CS-RECORD-ID                      PIC XX.
  8102         88  VALID-CS-ID                      VALUE 'CS'.
  8103
  8104     12  CS-CONTROL-PRIMARY.
  8105         16  CS-COMPANY-CD                 PIC X.
  8106         16  CS-CARRIER                    PIC X.
  8107         16  CS-GROUPING                   PIC X(6).
  8108         16  CS-STATE                      PIC XX.
  8109         16  CS-ACCOUNT                    PIC X(10).
  8110         16  CS-CERT-EFF-DT                PIC XX.
  8111         16  CS-CERT-NO.
  8112             20  CS-CERT-PRIME             PIC X(10).
  8113             20  CS-CERT-SFX               PIC X.
  8114         16  CS-TRAILER-TYPE               PIC X.
  8115             88  COMM-TRLR           VALUE 'A'.
  8116             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8117             88  CERT-DATA-TRLR      VALUE 'C'.
  8118
  8119     12  CS-DATA-AREA                      PIC X(516).
  8120
  8121     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8122         16  CS-BANK-COMMISSION-AREA.
  8123             20  CS-BANK-COMMS       OCCURS 10.
  8124                 24  CS-AGT                PIC X(10).
  8125                 24  CS-COM-TYP            PIC X.
  8126                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8127                 24  CS-RECALC-LV-INDIC    PIC X.
  8128                 24  FILLER                PIC X(10).
  8129         16  FILLER                        PIC X(256).
  8130
  8131     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8132****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8133         16  CS-MB-CLAIM-DATA OCCURS 24.
  8134             20  CS-CLAIM-NO               PIC X(7).
  8135             20  CS-CLAIM-TYPE             PIC X.
  8136                 88  CS-AH-CLM               VALUE 'A'.
  8137                 88  CS-IU-CLM               VALUE 'I'.
  8138                 88  CS-GP-CLM               VALUE 'G'.
  8139                 88  CS-LF-CLM               VALUE 'L'.
  8140                 88  CS-PR-CLM               VALUE 'P'.
  8141                 88  CS-FL-CLM               VALUE 'F'.
  8142                 88  CS-OT-CLM               VALUE 'O'.
  8143             20  CS-INSURED-TYPE           PIC X.
  8144                 88  CS-PRIM-INSURED          VALUE 'P'.
  8145                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 149
* EL6311.cbl
  8146             20  CS-BENEFIT-PERIOD         PIC 99.
  8147             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8148             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8149             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8150         16  FILLER                        PIC X(12).
  8151     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8152         16  CS-VIN-NUMBER                 PIC X(17).
  8153         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8154         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8155         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8156         16  cs-agent-name.
  8157             20  cs-agent-fname            pic x(20).
  8158             20  cs-agent-mi               pic x.
  8159             20  cs-agent-lname            pic x(25).
  8160         16  cs-license-no                 pic x(15).
  8161         16  cs-npn-number                 pic x(10).
  8162         16  cs-agent-edit-status          pic x.
  8163             88  cs-ae-refer-to-manager      value 'M'.
  8164             88  cs-ae-cover-sheet           value 'C'.
  8165             88  cs-ae-sig-form              value 'S'.
  8166             88  cs-ae-verified              value 'V'.
  8167             88  cs-unidentified-signature   value 'U'.
  8168             88  cs-cert-returned            value 'R'.
  8169             88  cs-accept-no-commission     value 'N'.
  8170         16  cs-year                       pic 9999.
  8171         16  cs-make                       pic x(20).
  8172         16  cs-model                      pic x(20).
  8173         16  cs-future                     pic x(20).
  8174         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8175         16  cs-claim-verification-status  pic x.
  8176             88  cs-clm-ver-eligible         value 'A'.
  8177             88  cs-clm-ver-partial-elig     value 'B'.
  8178             88  cs-clm-ver-not-eligible     value 'C'.
  8179             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8180             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8181             88  cs-clm-ver-ND-CERT          value 'F'.
  8182             88  cs-clm-ver-spec-other       value 'G'.
  8183             88  cs-clam-ver-pratial-corrected
  8184                                             value 'H'.
  8185             88  cs-clm-ver-no-matches       value 'I'.
  8186             88  cs-clm-ver-not-elig-corrected
  8187                                             value 'J'.
  8188             88  cs-clm-ver-needs-review     value 'R'.
  8189             88  cs-clm-ver-sent-to-claims   value 'W'.
  8190         16  CS-LF-REFUND-METHOD           PIC X.
  8191         16  CS-AH-REFUND-METHOD           PIC X.
  8192         16  FILLER                        PIC X(353). *> was 420
  8193*        16  FILLER                        PIC X(496).
  8194*                                COPY ERCCHEK.
  8195******************************************************************
  8196*                                                                *
  8197*                                                                *
  8198*                            ERCCHEK                             *
  8199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8200*                            VMOD=2.008                          *
  8201*                                                                *
  8202*   FILE DESCRIPTION = CHECK RECORDS                             *
  8203*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 150
* EL6311.cbl
  8204*   FILE TYPE = VSAM,KSDS                                        *
  8205*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8206*                                                                *
  8207*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8208*       ALTERNATE INDEX = NONE                                   *
  8209*                                                                *
  8210*   LOG = YES                                                    *
  8211*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8212******************************************************************
  8213*                   C H A N G E   L O G
  8214*
  8215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8216*-----------------------------------------------------------------
  8217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8218* EFFECTIVE    NUMBER
  8219*-----------------------------------------------------------------
  8220* 021414    2003053000001  PEMA  changes for auto chk request
  8221******************************************************************
  8222 01  CHECK-RECORDS.
  8223     12  CH-RECORD-ID                      PIC XX.
  8224         88  VALID-CH-ID                      VALUE 'CH'.
  8225
  8226     12  CH-CONTROL-PRIMARY.
  8227         16  CH-COMPANY-CD                 PIC X.
  8228         16  CH-CARRIER                    PIC X.
  8229         16  CH-GROUPING                   PIC X(6).
  8230         16  CH-STATE                      PIC XX.
  8231         16  CH-ACCOUNT                    PIC X(10).
  8232         16  CH-CERT-EFF-DT                PIC XX.
  8233         16  CH-CERT-NO.
  8234             20  CH-CERT-PRIME             PIC X(10).
  8235             20  CH-CERT-SFX               PIC X.
  8236         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8237
  8238     12  CH-RECORDED-DT                    PIC XX.
  8239     12  CH-RECORDED-BY                    PIC X(4).
  8240     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8241
  8242     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8243     12  CH-CHECK-NO                       PIC X(7).
  8244     12  CH-REASON-FOR-CHECK               PIC X(25).
  8245     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8246     12  FILLER                            PIC X.
  8247
  8248     12  CH-PAYEE-INFO.
  8249         16  CH-PAYEE-NAME-1               PIC X(30).
  8250         16  CH-PAYEE-NAME-2               PIC X(30).
  8251         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8252         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8253         16  CH-PAYEE-CITY-ST.
  8254             20  CH-PAYEE-CITY             PIC X(28).
  8255             20  CH-PAYEE-STATE            PIC XX.
  8256         16  CH-PAYEE-ZIP-CODE.
  8257             20  CH-PAYEE-ZIP.
  8258                 24  CH-ZIP-PRI-1ST        PIC X.
  8259                     88  CH-CANADIAN-POST-CODE
  8260                                           VALUES 'A' THRU 'Z'.
  8261                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 151
* EL6311.cbl
  8262             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8263         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8264             20  CH-CAN-POSTAL-1           PIC XXX.
  8265             20  CH-CAN-POSTAL-2           PIC XXX.
  8266             20  FILLER                    PIC XXX.
  8267
  8268     12  CH-CHECK-STUB-TEXT.
  8269         16  CH-STUB-LINE-1                PIC X(30).
  8270         16  CH-TEXT-LINE-1                PIC X(50).
  8271         16  CH-TEXT-LINE-2                PIC X(50).
  8272         16  CH-TEXT-LINE-3                PIC X(40).
  8273     12  CH-RETURN-TO                      PIC X(30).
  8274
  8275     12  CH-COMPENSATION-CONTROL.
  8276         16  CH-COMP-CARRIER               PIC X.
  8277         16  CH-COMP-GROUPING              PIC X(6).
  8278         16  CH-COMP-FIN-RESP              PIC X(10).
  8279         16  CH-COMP-ACCOUNT               PIC X(10).
  8280
  8281     12  CH-CREDIT-SELECT-DT               PIC XX.
  8282     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8283     12  CH-PAYEE-CODE                     PIC X(6).
  8284
  8285     12  CH-VOID-DATA.
  8286         20  CH-VOID-DT                    PIC XX.
  8287         20  CH-VOID-BY                    PIC X(4).
  8288         20  CH-VOID-REASON                PIC X(25).
  8289
  8290     12  CH-APPROVAL-DATA.
  8291         20  CH-APPROVAL-DT                PIC XX.
  8292         20  CH-APPROVAL-STATUS            PIC X.
  8293             88  CH-IN-LIMBO                  VALUE ' '.
  8294             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8295             88  CH-APPROVED                  VALUE 'A'.
  8296             88  CH-DENIED                    VALUE 'D'.
  8297         20  CH-APPROVED-BY                PIC XXXX.
  8298     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8299             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8300     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8301
  8302     12  ch-released-dt                    pic xx.
  8303     12  ch-check-cashed-dt                pic xx.
  8304     12  FILLER                            PIC X.
  8305*    12  CH-CHECK-REFERENCE                PIC X(12).
  8306     12  CH-CHECK-ORIGIN-SW                PIC X.
  8307             88  CH-REFUND-CHECK              VALUE 'R'.
  8308             88  CH-MAINT-CHECK               VALUE 'M'.
  8309
  8310     12  CH-CANC-DT                        PIC XX.
  8311     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8312     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8313
  8314     12  CH-INSURED-NAME                   PIC X(28).
  8315
  8316     12  ch-released-by                    pic x(4).
  8317     12  ch-csr                            pic x(4).
  8318     12  ch-deduct-commission              pic x.
  8319         88  ch-deduct-comm                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 152
* EL6311.cbl
  8320         88  ch-do-not-deduct-comm           value 'N'.
  8321
  8322     12  FILLER                            PIC X(11).
  8323*    12  CH-LETTER-TABLE.
  8324*        16  CH-LETTERS OCCURS 3 TIMES
  8325*                       INDEXED BY CH-LT-NDX
  8326*                                          PIC X(04).
  8327
  8328     12  FILLER                            PIC X(07).
  8329
  8330 01  var                         pic x(30).
  8331 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8332                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8333                          PENDING-MAILING-DATA MAILING-DATA
  8334                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8335                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8336                          CLAIM-MASTER ENDORSEMENT-RECORD
  8337                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8338                          VAR.
  8339 0000-DFHEXIT SECTION.
  8340     MOVE '9#                    $   ' TO DFHEIV0.
  8341     MOVE 'EL6311' TO DFHEIV1.
  8342     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8343
  8344     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8345     MOVE EIBTRMID               TO QID-TERM.
  8346     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8347     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8348     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8349     MOVE 2                      TO EMI-SWITCH2.
  8350
  8351     move spaces to ws-kix-myenv
  8352     set P to address of KIXSYS
  8353     CALL "getenv" using by value P returning var-ptr
  8354     if var-ptr = null then
  8355        display ' kixsys not set '
  8356     else
  8357        set address of var to var-ptr
  8358        move 0 to env-var-len
  8359        inspect var tallying env-var-len
  8360          for characters before X'00'
  8361        unstring var (1:env-var-len) delimited by '/'
  8362           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8363              WS-KIX-SYS
  8364        end-unstring
  8365     end-if
  8366     perform varying a1 from +1 by +1 until a1 > +10
  8367        if ws-kix-myenv (a1:1) = low-values or high-values
  8368           display ' found low or hi val '
  8369           move spaces to ws-kix-myenv (a1:1)
  8370        end-if
  8371     end-perform
  8372*    display ' env *' ws-kix-myenv '*'
  8373     IF EIBCALEN = 0
  8374         GO TO 8800-UNAUTHORIZED-ACCESS.
  8375
  8376     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8377     MOVE '5'                   TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 153
* EL6311.cbl
  8378     PERFORM 9700-DATE-LINK.
  8379     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8380     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8381
  8382     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8383     MOVE SPACE                  TO DC-OPTION-CODE.
  8384     PERFORM 9700-DATE-LINK.
  8385     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8386     MOVE LOW-VALUES             TO EL631BI.
  8387
  8388
  8389* EXEC CICS HANDLE CONDITION
  8390*        PGMIDERR  (9600-PGMID-ERROR)
  8391*        ERROR     (9990-ABEND)
  8392*        INVREQ    (9990-ABEND)
  8393*        QIDERR    (0010-MAIN-LOGIC)
  8394*    END-EXEC.
  8395*    MOVE '"$L.8N                ! " #00008384' TO DFHEIV0
  8396     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8398     MOVE X'2220233030303038333834' TO DFHEIV0(25:11)
  8399     CALL 'kxdfhei1' USING DFHEIV0
  8400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8401
  8402
  8403     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8404         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8405             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8406             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8407             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8408             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8409             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8410             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8411             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8412             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8413
  8414             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8415                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8416
  8417             ELSE
  8418                 NEXT SENTENCE
  8419
  8420         ELSE
  8421             IF PI-CALLING-PROGRAM = 'EL6315'
  8422                SET CALLED-FROM-6315 TO TRUE
  8423             END-IF
  8424             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8425             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8426             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8427             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8428             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8429             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8430             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8431             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8432             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8433             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8434             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8435             GO TO 3900-RE-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 154
* EL6311.cbl
  8436     ELSE
  8437         GO TO 0020-MAIN-LOGIC.
  8438
  8439 0010-MAIN-LOGIC.
  8440     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8441                                    WS-FIRST-ENTRY-SW.
  8442
  8443     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8444
  8445     MOVE LOW-VALUES             TO EC-NEW-CERT
  8446                                    EC-NEW-STATE.
  8447
  8448     IF PI-DISPLAY-ORIGINAL-BATCH
  8449         NEXT SENTENCE
  8450     ELSE
  8451         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8452             GO TO 5000-BROWSE-BATCH-HEADERS.
  8453
  8454     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8455         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8456
  8457     IF PI-CSR-BROWSE
  8458        GO TO 4200-BROWSE-CSR-FORWARD.
  8459
  8460     IF PI-FILE-BROWSE
  8461         GO TO 4300-BROWSE-FILE-FORWARD.
  8462
  8463     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8464
  8465 0020-MAIN-LOGIC.
  8466     IF EIBAID = DFHCLEAR
  8467         GO TO 9400-CLEAR.
  8468
  8469     MOVE LOW-VALUES             TO EC-NEW-CERT
  8470                                    EC-NEW-STATE.
  8471
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 155
* EL6311.cbl
  8473
  8474******************************************************************
  8475*                                                                *
  8476*              R E C E I V E   M A P                             *
  8477*                                                                *
  8478******************************************************************
  8479
  8480 0200-RECEIVE.
  8481     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8482         MOVE ER-0008            TO EMI-ERROR
  8483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8484         IF PI-MAP-NAME = EL631B
  8485             MOVE -1                 TO BMAINTL
  8486             GO TO 8200-SEND-DATAONLY
  8487         ELSE
  8488             IF PI-MAP-NAME = EL631C
  8489                 MOVE -1                 TO CMAINTL
  8490                 GO TO 8200-SEND-DATAONLY
  8491             ELSE
  8492                 IF PI-MAP-NAME = EL631D
  8493                     MOVE -1                 TO DPFENTRL
  8494                     GO TO 8200-SEND-DATAONLY.
  8495
  8496
  8497* EXEC CICS RECEIVE
  8498*        MAP      (PI-MAP-NAME)
  8499*        MAPSET   (MAPSET-EL6311S)
  8500*        INTO     (EL631BI)
  8501*    END-EXEC.
  8502     MOVE LENGTH OF
  8503      EL631BI
  8504       TO DFHEIV11
  8505*    MOVE '8"T I  L              ''   #00008484' TO DFHEIV0
  8506     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8507     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8508     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  8509     CALL 'kxdfhei1' USING DFHEIV0,
  8510           PI-MAP-NAME,
  8511           EL631BI,
  8512           DFHEIV11,
  8513           MAPSET-EL6311S,
  8514           DFHEIV99,
  8515           DFHEIV99
  8516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8517
  8518
  8519******************************************************************
  8520*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8521******************************************************************
  8522
  8523     IF BTYPE-LEN (1) EQUAL +3
  8524        IF BTYPE (1) EQUAL ALL ' '
  8525            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8526
  8527     IF BTYPE-LEN (2) EQUAL +3
  8528        IF BTYPE (2) EQUAL ALL ' '
  8529            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8530
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 156
* EL6311.cbl
  8531     INSPECT EL631BI CONVERTING '_' TO ' '.
  8532
  8533     IF PI-MAP-NAME = EL631B
  8534         IF BPFENTRL GREATER THAN ZEROS
  8535             IF EIBAID NOT = DFHENTER
  8536                 MOVE ER-0004       TO EMI-ERROR
  8537                 MOVE -1            TO BPFENTRL
  8538                 MOVE AL-UNBOF      TO BPFENTRA
  8539                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8540                 GO TO 8200-SEND-DATAONLY
  8541             ELSE
  8542                 IF BPFENTRI NUMERIC AND
  8543                   (BPFENTRI GREATER 0 AND LESS 25)
  8544                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8545                 ELSE
  8546                     MOVE ER-0029  TO EMI-ERROR
  8547                     MOVE AL-UNBON TO BPFENTRA
  8548                     MOVE -1       TO BPFENTRL
  8549                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8550                     GO TO 8200-SEND-DATAONLY
  8551         ELSE
  8552             NEXT SENTENCE
  8553     ELSE
  8554         IF PI-MAP-NAME = EL631C
  8555            IF CPFENTRL GREATER THAN ZEROS
  8556                IF EIBAID NOT = DFHENTER
  8557                 MOVE ER-0004         TO EMI-ERROR
  8558                 MOVE -1              TO CPFENTRL
  8559                 MOVE AL-UNBOF        TO CPFENTRA
  8560                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8561                 GO TO 8200-SEND-DATAONLY
  8562             ELSE
  8563                 IF CPFENTRI NUMERIC AND
  8564                   (CPFENTRI GREATER 0 AND LESS 25)
  8565                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8566                 ELSE
  8567                     MOVE ER-0029      TO EMI-ERROR
  8568                     MOVE AL-UNBON     TO CPFENTRA
  8569                     MOVE -1           TO CPFENTRL
  8570                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8571                     GO TO 8200-SEND-DATAONLY
  8572         ELSE
  8573             NEXT SENTENCE
  8574     ELSE
  8575     IF PI-MAP-NAME = EL631D
  8576         IF DPFENTRL GREATER THAN ZEROS
  8577             IF EIBAID NOT = DFHENTER
  8578                 MOVE ER-0004         TO EMI-ERROR
  8579                 MOVE -1              TO DPFENTRL
  8580                 MOVE AL-UNBOF        TO DPFENTRA
  8581                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8582                 GO TO 8200-SEND-DATAONLY
  8583             ELSE
  8584                 IF DPFENTRI NUMERIC AND
  8585                   (DPFENTRI GREATER 0 AND LESS 25)
  8586                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8587                 ELSE
  8588                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 157
* EL6311.cbl
  8589                     MOVE AL-UNBON     TO DPFENTRA
  8590                     MOVE -1           TO DPFENTRL
  8591                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8592                     GO TO 8200-SEND-DATAONLY.
  8593
  8594     IF EIBAID = DFHPF23
  8595         GO TO 8810-PF23.
  8596
  8597     IF EIBAID = DFHPF24
  8598         GO TO 9200-RETURN-MAIN-MENU.
  8599
  8600     IF EIBAID = DFHPF12
  8601         GO TO 9500-PF12.
  8602
  8603     IF PI-MAP-NAME = EL631B
  8604        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8605
  8606     IF PI-MAP-NAME = EL631C
  8607        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8608
  8609     IF PI-MAP-NAME = EL631D
  8610        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8611
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 158
* EL6311.cbl
  8613
  8614******************************************************************
  8615*                                                                *
  8616*      ISSUE SCREEN PF KEY CHECKING                              *
  8617*                                                                *
  8618******************************************************************
  8619
  8620******************************************************************
  8621*                                                                *
  8622*      PF KEY FUNCTIONS:                                         *
  8623*                                                                *
  8624*      PF1  = BROWSE FORWARD                                     *
  8625*      PF2  = BROWSE BACKWARD                                    *
  8626*      PF3  = CERTIFICATE LOOKUP                                 *
  8627*      PF4  = DISPLAY BATCH HEADER                               *
  8628*      PF5  = ADD ISSUE  SCREEN                                  *
  8629*      PF6  = ADD CANCEL SCREEN                                  *
  8630*      PF7  = CERTIFICATE DISPLAY                                *
  8631*      PF8  = CERTIFICATE NOTES                                  *
  8632*      PF9  = EDIT CONTROL                                       *
  8633*      PF10 = DISPLAY LETTER SCREEN                              *
  8634*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8635*      PF12 = HELP SCREEN                                        *
  8636*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8637*      PF14 = ACCOUNT MASTER                                     *
  8638*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8639*      PF16 = DISPLAY LETTER REVIEW                              *
  8640*                                                                *
  8641******************************************************************
  8642
  8643 0300-CHECK-ISSUE-PF-KEYS.
  8644     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8645        MOVE ER-2337            TO EMI-ERROR
  8646        MOVE -1                  TO BMAINTL
  8647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8648        GO TO 8200-SEND-DATAONLY.
  8649
  8650     IF EIBAID = DFHPF1
  8651        MOVE '0'                TO PI-EDIT-SW
  8652        IF PI-PRIMARY-BROWSE
  8653           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8654        ELSE
  8655           IF PI-PRIMARY-WITH-SELECT
  8656              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8657           ELSE
  8658              IF PI-FILE-BROWSE
  8659                 GO TO 4300-BROWSE-FILE-FORWARD
  8660              ELSE
  8661                 IF PI-CSR-BROWSE
  8662                    GO TO 4200-BROWSE-CSR-FORWARD
  8663                 ELSE
  8664                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8665
  8666     IF EIBAID = DFHPF2
  8667        MOVE '0'                TO PI-EDIT-SW
  8668        IF PI-PRIMARY-BROWSE
  8669           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8670        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 159
* EL6311.cbl
  8671           IF PI-PRIMARY-WITH-SELECT
  8672              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8673           ELSE
  8674              IF PI-FILE-BROWSE
  8675                 GO TO 4800-BROWSE-FILE-BACKWARD
  8676              ELSE
  8677                 IF PI-CSR-BROWSE
  8678                    GO TO 4900-BROWSE-CSR-BACKWARD
  8679                 ELSE
  8680                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8681
  8682     IF EIBAID = DFHPF3
  8683        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8684        MOVE XCTL-EL127         TO PGM-NAME
  8685        GO TO 9300-XCTL.
  8686
  8687     IF (EIBAID = DFHPF15 OR DFHPF6)
  8688        AND (CSR-EDIT-SESSION)
  8689*       AND (FATAL-OR-UNFORCED)
  8690*       AND (FATAL-ERRORS)
  8691        and (pi-6311-fatal-ctr <> +0)
  8692        MOVE ER-1819             TO EMI-ERROR
  8693        MOVE -1                  TO BMAINTL
  8694        MOVE AL-UANON            TO BMAINTA
  8695        PERFORM 9900-ERROR-FORMAT
  8696                                 THRU 9900-EXIT
  8697        GO TO 8200-SEND-DATAONLY
  8698     END-IF
  8699     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8700      OR (EIBAID = DFHPF10)
  8701        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8702        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8703        IF (RESP-NORMAL)
  8704           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8705              AM-CONTROL-PRIMARY (1:20))
  8706            IF AM-NAME NOT GREATER THAN SPACES OR
  8707               AM-ADDRS NOT GREATER THAN SPACES  OR
  8708               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8709               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8710               AM-ZIP NOT GREATER THAN SPACES
  8711               MOVE ER-3834             TO EMI-ERROR
  8712               MOVE -1                  TO BMAINTL
  8713               MOVE AL-UANON            TO BMAINTA
  8714               PERFORM 9900-ERROR-FORMAT
  8715                                 THRU 9900-EXIT
  8716               GO TO 8200-SEND-DATAONLY
  8717            END-IF
  8718        ELSE
  8719           MOVE ER-1609             TO EMI-ERROR
  8720           MOVE -1                  TO BMAINTL
  8721           MOVE AL-UANON            TO BMAINTA
  8722           PERFORM 9900-ERROR-FORMAT
  8723                                THRU 9900-EXIT
  8724           GO TO 8200-SEND-DATAONLY
  8725        END-IF
  8726
  8727        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8728        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 160
* EL6311.cbl
  8729        IF (ERMAIL-FOUND)
  8730            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8731               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8732               MA-CITY NOT GREATER THAN SPACES OR
  8733               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8734               MA-ZIP-CODE NOT GREATER THAN SPACES
  8735               MOVE ER-3835             TO EMI-ERROR
  8736               MOVE -1                  TO BMAINTL
  8737               MOVE AL-UANON            TO BMAINTA
  8738               PERFORM 9900-ERROR-FORMAT
  8739                                 THRU 9900-EXIT
  8740               GO TO 8200-SEND-DATAONLY
  8741            END-IF
  8742        ELSE
  8743           MOVE ER-3000             TO EMI-ERROR
  8744           MOVE -1                  TO BMAINTL
  8745           MOVE AL-UANON            TO BMAINTA
  8746           PERFORM 9900-ERROR-FORMAT
  8747                                THRU 9900-EXIT
  8748           GO TO 8200-SEND-DATAONLY
  8749        END-IF
  8750
  8751     END-IF
  8752     IF (EIBAID = DFHPF15)
  8753        AND (CSR-EDIT-SESSION)
  8754        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8755        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8756        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8757        MOVE PI-SV-STATE         TO PI-STATE
  8758        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8759        MOVE BCERTNOI            TO PI-CERT-PRIME
  8760        MOVE BSUFIXI             TO PI-CERT-SFX
  8761        MOVE BEFFDTI             TO DEEDIT-FIELD
  8762        PERFORM 8600-DEEDIT
  8763        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8764        MOVE '4'                 TO DC-OPTION-CODE
  8765        PERFORM 9700-DATE-LINK
  8766        IF DATE-CONVERSION-ERROR
  8767           MOVE ER-0348          TO EMI-ERROR
  8768           MOVE -1               TO BEFFDTL
  8769           MOVE AL-UABON         TO BEFFDTA
  8770           PERFORM 9900-ERROR-FORMAT
  8771                                 THRU 9900-EXIT
  8772           GO TO 8200-SEND-DATAONLY
  8773        ELSE
  8774           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8775           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8776           MOVE XCTL-EL6315      TO PGM-NAME
  8777           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8778           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8779           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8780           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8781           GO TO 9300-XCTL
  8782        END-IF
  8783     END-IF
  8784
  8785     IF EIBAID = DFHPF4
  8786        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 161
* EL6311.cbl
  8787        IF PI-DISPLAY-ORIGINAL-BATCH
  8788           NEXT SENTENCE
  8789        ELSE
  8790           GO TO 7200-DISPLAY-BATCHES.
  8791
  8792     IF EIBAID = DFHPF5
  8793        MOVE ER-0029                TO EMI-ERROR
  8794        MOVE -1                     TO BPFENTRL
  8795        MOVE AL-UNBON               TO BPFENTRA
  8796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8797        GO TO 8200-SEND-DATAONLY.
  8798*        MOVE '0'                TO PI-EDIT-SW
  8799*        IF PI-DISPLAY-ORIGINAL-BATCH
  8800*           NEXT SENTENCE
  8801*        ELSE
  8802*           MOVE EL631B              TO PI-MAP-NAME
  8803*           MOVE LOW-VALUES          TO EL631BI
  8804*           MOVE 'A'                 TO BMAINTO
  8805*           MOVE AL-UANON            TO BMAINTA
  8806*           MOVE -1                  TO BMAINTL
  8807*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8808*           GO TO 8100-SEND-INITIAL-MAP.
  8809
  8810     IF EIBAID = DFHPF6
  8811        IF NOT CSR-EDIT-SESSION
  8812           MOVE ER-0029                TO EMI-ERROR
  8813           MOVE -1                     TO BPFENTRL
  8814           MOVE AL-UNBON               TO BPFENTRA
  8815           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8816           GO TO 8200-SEND-DATAONLY
  8817*           MOVE '0'              TO PI-EDIT-SW
  8818*           IF PI-DISPLAY-ORIGINAL-BATCH
  8819*              NEXT SENTENCE
  8820*           ELSE
  8821*              MOVE EL631C        TO PI-MAP-NAME
  8822*              MOVE LOW-VALUES    TO EL631CI
  8823*              MOVE 'A'           TO CMAINTO
  8824*              MOVE AL-UANON      TO CMAINTA
  8825*              MOVE -1            TO CMAINTL
  8826*              MOVE '6'           TO PI-MAINT-FUNCTION
  8827*              GO TO 8100-SEND-INITIAL-MAP
  8828*           END-IF
  8829        ELSE
  8830           PERFORM 5100-PROCESS-POL-RESC
  8831                                 THRU 5100-EXIT
  8832           MOVE  PI-PREV-CONTROL-PRIMARY
  8833                                 TO ERPNDB-KEY
  8834
  8835* EXEC CICS READ
  8836*              SET     (ADDRESS OF PENDING-BUSINESS)
  8837*              DATASET (FILE-ID-ERPNDB)
  8838*              RIDFLD  (ERPNDB-KEY)
  8839*          END-EXEC
  8840*    MOVE '&"S        E          (   #00008805' TO DFHEIV0
  8841     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8843     MOVE X'2020233030303038383035' TO DFHEIV0(25:11)
  8844     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 162
* EL6311.cbl
  8845           FILE-ID-ERPNDB,
  8846           DFHEIV20,
  8847           DFHEIV99,
  8848           ERPNDB-KEY,
  8849           DFHEIV99,
  8850           DFHEIV99,
  8851           DFHEIV99
  8852     SET ADDRESS OF PENDING-BUSINESS TO
  8853         DFHEIV20
  8854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8855           PERFORM 9800-LINK-PENDING-EDIT
  8856                                 THRU 9800-EXIT
  8857           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8858           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8859                                    PI-PREV-SEQ-NO
  8860           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8861*                                    WS-CANCEL-LETTER-SW
  8862                                    PI-ALL-ISSUES-SW
  8863                                    PI-ALL-CANCELS-SW
  8864           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8865        END-IF
  8866     END-IF
  8867     IF EIBAID = DFHPF7
  8868        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8869        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8870        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8871        MOVE PI-SV-STATE            TO PI-STATE
  8872        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8873        MOVE BCERTNOI               TO PI-CERT-PRIME
  8874        MOVE BSUFIXI                TO PI-CERT-SFX
  8875        MOVE BEFFDTI                TO DEEDIT-FIELD
  8876        PERFORM 8600-DEEDIT
  8877        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8878        MOVE '4'                    TO DC-OPTION-CODE
  8879        PERFORM 9700-DATE-LINK
  8880        IF DATE-CONVERSION-ERROR
  8881           MOVE ER-0348            TO EMI-ERROR
  8882           MOVE -1                  TO BEFFDTL
  8883           MOVE AL-UABON            TO BEFFDTA
  8884           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8885           GO TO 8200-SEND-DATAONLY
  8886        ELSE
  8887           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8888           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8889           MOVE XCTL-EL1273        TO PGM-NAME
  8890           GO TO 9300-XCTL.
  8891
  8892     IF EIBAID = DFHPF8
  8893        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8894        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8895        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8896        MOVE PI-SV-STATE            TO PI-STATE
  8897        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8898        MOVE BCERTNOI               TO PI-CERT-PRIME
  8899        MOVE BSUFIXI                TO PI-CERT-SFX
  8900        MOVE BEFFDTI                TO DEEDIT-FIELD
  8901        PERFORM 8600-DEEDIT
  8902        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 163
* EL6311.cbl
  8903        MOVE '4'                    TO DC-OPTION-CODE
  8904        PERFORM 9700-DATE-LINK
  8905        IF DATE-CONVERSION-ERROR
  8906           MOVE ER-0348            TO EMI-ERROR
  8907           MOVE -1                  TO BEFFDTL
  8908           MOVE AL-UABON            TO BEFFDTA
  8909           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8910           GO TO 8200-SEND-DATAONLY
  8911        ELSE
  8912           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8913           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8914           IF PI-COMPANY-ID = 'DMD'
  8915               MOVE XCTL-EL401DMD      TO PGM-NAME
  8916             ELSE
  8917               MOVE XCTL-EL1279        TO PGM-NAME
  8918           END-IF
  8919           GO TO 9300-XCTL.
  8920
  8921     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8922        MOVE XCTL-EL6312         TO PGM-NAME
  8923
  8924* EXEC CICS XCTL
  8925*           PROGRAM   (PGM-NAME)
  8926*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8927*           LENGTH    (WS-COMM-LENGTH)
  8928*       END-EXEC
  8929*    MOVE '.$C                   %   #00008878' TO DFHEIV0
  8930     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8932     MOVE X'2020233030303038383738' TO DFHEIV0(25:11)
  8933     CALL 'kxdfhei1' USING DFHEIV0,
  8934           PGM-NAME,
  8935           PROGRAM-INTERFACE-BLOCK,
  8936           WS-COMM-LENGTH,
  8937           DFHEIV99
  8938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8939     ELSE
  8940        MOVE '0'                 TO  PI-EDIT-SW.
  8941
  8942     IF  EIBAID = DFHPF10
  8943         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8944         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8945         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8946                                    PI-1042-WA
  8947         MOVE 4                  TO PI-689-DATA-SOURCE
  8948         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8949         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8950         MOVE PI-SV-STATE        TO PI-689-STATE
  8951         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8952         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8953         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8954         MOVE PI-PB-ALT-CHG-SEQ-NO
  8955                                 TO PI-689-ALT-SEQ-NO
  8956         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8957         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8958         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8959         MOVE +0                 TO PI-689-CONTROL
  8960         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 164
* EL6311.cbl
  8961                                    PI-689-EXP-DATE
  8962                                    PI-689-RESP-PERSON
  8963                                    PI-689-TYPE
  8964                                    PI-689-FOLLOW-UP-EDIT
  8965                                    PI-689-RESEND1-EDIT
  8966                                    PI-689-SEQ-EDIT
  8967                                    PI-689-BCSEQ-EDIT
  8968                                    PI-689-LBL-OVERRIDE
  8969         MOVE W-LETTER-COMMUNICATION-AREAS
  8970                                 TO PI-PROGRAM-WORK-AREA
  8971         MOVE XCTL-EL689         TO PGM-NAME
  8972         GO TO 9300-XCTL.
  8973
  8974     IF  EIBAID = DFHPF16
  8975         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8976         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8977         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8978                                    PI-1042-WA
  8979         MOVE 4                  TO PI-689-DATA-SOURCE
  8980         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8981         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8982         MOVE PI-SV-STATE        TO PI-689-STATE
  8983         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8984         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8985         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8986         MOVE PI-PB-ALT-CHG-SEQ-NO
  8987                                 TO PI-689-ALT-SEQ-NO
  8988         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8989         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8990         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8991         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8992         MOVE W-LETTER-COMMUNICATION-AREAS
  8993                                 TO PI-PROGRAM-WORK-AREA
  8994         MOVE XCTL-EL690         TO PGM-NAME
  8995         GO TO 9300-XCTL.
  8996
  8997     IF EIBAID = DFHPF13
  8998         MOVE XCTL-EL6313        TO PGM-NAME
  8999         GO TO 9300-XCTL.
  9000
  9001     IF EIBAID = DFHPF17
  9002        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  9003        IF (PB-I-LOAN-APR numeric)
  9004           and (pb-i-loan-apr < 99.9999)
  9005           AND (PB-I-BENEFICIARY-NAME NOT
  9006              = SPACES AND LOW-VALUES)
  9007
  9008           MOVE LINK-ELVADS          TO PGM-NAME
  9009
  9010* EXEC CICS LINK
  9011*              PROGRAM    (PGM-NAME)
  9012*              COMMAREA   (WS-PASS-AREA)
  9013*              LENGTH     (WS-PASS-AREA-LENGTH)
  9014*          END-EXEC
  9015*    MOVE '."C                   (   #00008953' TO DFHEIV0
  9016     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9018     MOVE X'2020233030303038393533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 165
* EL6311.cbl
  9019     CALL 'kxdfhei1' USING DFHEIV0,
  9020           PGM-NAME,
  9021           WS-PASS-AREA,
  9022           WS-PASS-AREA-LENGTH,
  9023           DFHEIV99,
  9024           DFHEIV99,
  9025           DFHEIV99,
  9026           DFHEIV99
  9027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9028
  9029           MOVE 0000             TO EMI-ERROR
  9030           MOVE -1               TO BMAINTL
  9031           PERFORM 9900-ERROR-FORMAT
  9032                                 THRU 9900-EXIT
  9033           GO TO 8200-SEND-DATAONLY
  9034        ELSE
  9035           MOVE ER-0877            TO EMI-ERROR
  9036           MOVE -1                  TO BEFFDTL
  9037           MOVE AL-UABON            TO BEFFDTA
  9038           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9039           GO TO 8200-SEND-DATAONLY
  9040        END-IF
  9041     END-IF
  9042     IF EIBAID = DFHPF14
  9043        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9044        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9045        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9046        MOVE PI-SV-STATE            TO PI-CR-STATE
  9047        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9048        MOVE SPACE                  TO PI-EDIT-SW
  9049        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9050        MOVE XCTL-EL650             TO PGM-NAME
  9051        GO TO 9300-XCTL.
  9052
  9053     IF EIBAID = DFHPF15
  9054        IF PI-COMPANY-ID  =  'HER'
  9055            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9056            MOVE XCTL-EL680         TO PGM-NAME
  9057            GO TO 9300-XCTL.
  9058
  9059     IF EIBAID = DFHENTER OR DFHPF11
  9060        GO TO 1000-ISSUE-MAINLINE.
  9061
  9062     MOVE ER-0029                TO EMI-ERROR
  9063     MOVE -1                     TO BPFENTRL
  9064     MOVE AL-UNBON               TO BPFENTRA
  9065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9066     GO TO 8200-SEND-DATAONLY.
  9067
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 166
* EL6311.cbl
  9069
  9070******************************************************************
  9071*                                                                *
  9072*      CANCEL SCREEN PF KEY CHECKING                             *
  9073*                                                                *
  9074******************************************************************
  9075
  9076******************************************************************
  9077*                                                                *
  9078*      PF KEY FUNCTIONS:                                         *
  9079*                                                                *
  9080*      PF1  = BROWSE FORWARD                                     *
  9081*      PF2  = BROWSE BACKWARD                                    *
  9082*      PF3  = CERTIFICATE LOOKUP                                 *
  9083*      PF4  = DISPLAY BATCH HEADER                               *
  9084*      PF5  = ADD ISSUE SCREEN                                   *
  9085*      PF6  = ADD CANCEL SCREEN                                  *
  9086*      PF7  = CERTIFICATE DISPLAY                                *
  9087*      PF8  = CERTIFICATE NOTES                                  *
  9088*      PF9  = EDIT CONTROL                                       *
  9089*      PF10 = DISPLAY LETTER SCREEN                              *
  9090*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9091*      PF12 = DISPLAY HELP SCREEN                                *
  9092*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9093*      PF14 = ACCOUNT MASTER                                     *
  9094*      PF16 = LETTER REVIEW                                      *
  9095*                                                                *
  9096******************************************************************
  9097
  9098 0400-CHECK-CANCEL-PF-KEYS.
  9099     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9100        MOVE ER-2337             TO EMI-ERROR
  9101        MOVE -1                  TO CMAINTL
  9102        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9103        GO TO 8200-SEND-DATAONLY.
  9104
  9105     IF EIBAID = DFHPF1
  9106        MOVE '0'                TO PI-EDIT-SW
  9107        IF PI-PRIMARY-BROWSE
  9108           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9109        ELSE
  9110           IF PI-PRIMARY-WITH-SELECT
  9111              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9112           ELSE
  9113              IF PI-FILE-BROWSE
  9114                 GO TO 4300-BROWSE-FILE-FORWARD
  9115              ELSE
  9116                 IF PI-CSR-BROWSE
  9117                    GO TO 4200-BROWSE-CSR-FORWARD
  9118                 ELSE
  9119                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9120
  9121     IF EIBAID = DFHPF2
  9122        MOVE '0'                TO PI-EDIT-SW
  9123        IF PI-PRIMARY-BROWSE
  9124           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9125        ELSE
  9126           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 167
* EL6311.cbl
  9127              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9128           ELSE
  9129              IF PI-FILE-BROWSE
  9130                 GO TO 4800-BROWSE-FILE-BACKWARD
  9131              ELSE
  9132                 IF PI-CSR-BROWSE
  9133                    GO TO 4900-BROWSE-CSR-BACKWARD
  9134                 ELSE
  9135                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9136
  9137     IF EIBAID = DFHPF3
  9138        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9139        MOVE XCTL-EL127         TO PGM-NAME
  9140        GO TO 9300-XCTL.
  9141
  9142     IF (EIBAID = DFHPF15 OR DFHPF17)
  9143        AND (CSR-EDIT-SESSION)
  9144*       AND (FATAL-OR-UNFORCED)
  9145        AND (FATAL-ERRORS)
  9146        MOVE ER-1819             TO EMI-ERROR
  9147        MOVE -1                  TO CMAINTL
  9148        MOVE AL-UANON            TO CMAINTA
  9149        PERFORM 9900-ERROR-FORMAT
  9150                                 THRU 9900-EXIT
  9151        GO TO 8200-SEND-DATAONLY
  9152     END-IF
  9153     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9154       AND (CSR-EDIT-SESSION)
  9155        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9156        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9157        IF (RESP-NORMAL)
  9158           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9159              AM-CONTROL-PRIMARY (1:20))
  9160            IF AM-NAME NOT GREATER THAN SPACES OR
  9161               AM-ADDRS NOT GREATER THAN SPACES  OR
  9162               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9163               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9164               AM-ZIP NOT GREATER THAN SPACES
  9165               MOVE ER-3834             TO EMI-ERROR
  9166               MOVE -1                  TO BMAINTL
  9167               MOVE AL-UANON            TO BMAINTA
  9168               PERFORM 9900-ERROR-FORMAT
  9169                                 THRU 9900-EXIT
  9170               GO TO 8200-SEND-DATAONLY
  9171            END-IF
  9172        ELSE
  9173           MOVE ER-1609             TO EMI-ERROR
  9174           MOVE -1                  TO BMAINTL
  9175           MOVE AL-UANON            TO BMAINTA
  9176           PERFORM 9900-ERROR-FORMAT
  9177                                THRU 9900-EXIT
  9178           GO TO 8200-SEND-DATAONLY
  9179        END-IF
  9180
  9181        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9182        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9183        IF (ERMAIL-FOUND)
  9184            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 168
* EL6311.cbl
  9185               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9186               MA-CITY NOT GREATER THAN SPACES OR
  9187               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9188               MA-ZIP-CODE NOT GREATER THAN SPACES
  9189               MOVE ER-3835             TO EMI-ERROR
  9190               MOVE -1                  TO BMAINTL
  9191               MOVE AL-UANON            TO BMAINTA
  9192               PERFORM 9900-ERROR-FORMAT
  9193                                 THRU 9900-EXIT
  9194               GO TO 8200-SEND-DATAONLY
  9195            END-IF
  9196        ELSE
  9197           MOVE ER-3000             TO EMI-ERROR
  9198           MOVE -1                  TO BMAINTL
  9199           MOVE AL-UANON            TO BMAINTA
  9200           PERFORM 9900-ERROR-FORMAT
  9201                                THRU 9900-EXIT
  9202           GO TO 8200-SEND-DATAONLY
  9203        END-IF
  9204
  9205     END-IF
  9206     IF (EIBAID = DFHPF15 OR DFHPF17)
  9207        AND (CSR-EDIT-SESSION)
  9208        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9209        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9210        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9211        MOVE PI-SV-STATE         TO PI-STATE
  9212        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9213        MOVE CCERTNOI            TO PI-CERT-PRIME
  9214        MOVE CSUFIXI             TO PI-CERT-SFX
  9215        MOVE CEFFDTI             TO DEEDIT-FIELD
  9216        PERFORM 8600-DEEDIT
  9217        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9218        MOVE '4'                 TO DC-OPTION-CODE
  9219        PERFORM 9700-DATE-LINK
  9220        IF DATE-CONVERSION-ERROR
  9221           MOVE ER-0348          TO EMI-ERROR
  9222           MOVE -1               TO CEFFDTL
  9223           MOVE AL-UABON         TO CEFFDTA
  9224           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9225           GO TO 8200-SEND-DATAONLY
  9226        ELSE
  9227           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9228           PERFORM 6000-CREATE-TEMP-STORAGE
  9229                                 THRU 6000-EXIT
  9230           IF EIBAID = DFHPF17
  9231               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9232                                  THRU 6400-EXIT
  9233               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9234                                 '2' AND '3' AND '4'
  9235                  MOVE ER-3831     TO  EMI-ERROR
  9236                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9237                  GO TO 8200-SEND-DATAONLY
  9238               END-IF
  9239               MOVE 'Y'          TO PI-CLM-RESC-IND
  9240           ELSE
  9241               MOVE 'N'          TO PI-CLM-RESC-IND
  9242           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 169
* EL6311.cbl
  9243           MOVE XCTL-EL6316      TO PGM-NAME
  9244           MOVE '2'              TO PI-ISS-CAN-SW
  9245           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9246           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9247           GO TO 9300-XCTL
  9248        END-IF
  9249     END-IF
  9250
  9251     IF EIBAID = DFHPF4
  9252        MOVE '0'                TO PI-EDIT-SW
  9253        IF PI-DISPLAY-ORIGINAL-BATCH
  9254           NEXT SENTENCE
  9255        ELSE
  9256           GO TO 7200-DISPLAY-BATCHES.
  9257
  9258     IF EIBAID = DFHPF5
  9259        MOVE ER-0029                TO EMI-ERROR
  9260        MOVE -1                     TO BPFENTRL
  9261        MOVE AL-UNBON               TO BPFENTRA
  9262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9263        GO TO 8200-SEND-DATAONLY.
  9264*        MOVE '0'                TO PI-EDIT-SW
  9265*        IF PI-DISPLAY-ORIGINAL-BATCH
  9266*           NEXT SENTENCE
  9267*        ELSE
  9268*           MOVE EL631B              TO PI-MAP-NAME
  9269*           MOVE LOW-VALUES          TO EL631BI
  9270*           MOVE 'A'                 TO BMAINTO
  9271*           MOVE AL-UANON            TO BMAINTA
  9272*           MOVE -1                  TO BMAINTL
  9273*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9274*           GO TO 8100-SEND-INITIAL-MAP.
  9275
  9276     IF EIBAID = DFHPF6
  9277        MOVE ER-0029                TO EMI-ERROR
  9278        MOVE -1                     TO BPFENTRL
  9279        MOVE AL-UNBON               TO BPFENTRA
  9280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9281        GO TO 8200-SEND-DATAONLY.
  9282*        MOVE '0'                TO PI-EDIT-SW
  9283*        IF PI-DISPLAY-ORIGINAL-BATCH
  9284*           NEXT SENTENCE
  9285*        ELSE
  9286*           MOVE EL631C              TO PI-MAP-NAME
  9287*           MOVE LOW-VALUES          TO EL631CI
  9288*           MOVE 'A'                 TO CMAINTO
  9289*           MOVE AL-UANON            TO CMAINTA
  9290*           MOVE -1                  TO CMAINTL
  9291*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9292*           GO TO 8100-SEND-INITIAL-MAP.
  9293
  9294     IF EIBAID = DFHPF7
  9295        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9296        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9297        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9298        MOVE PI-SV-STATE            TO PI-STATE
  9299        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9300        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 170
* EL6311.cbl
  9301        MOVE CSUFIXI                TO PI-CERT-SFX
  9302        MOVE CEFFDTI                TO DEEDIT-FIELD
  9303        PERFORM 8600-DEEDIT
  9304        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9305        MOVE '4'                    TO DC-OPTION-CODE
  9306        PERFORM 9700-DATE-LINK
  9307        IF DATE-CONVERSION-ERROR
  9308           MOVE ER-0348            TO EMI-ERROR
  9309           MOVE -1                  TO BEFFDTL
  9310           MOVE AL-UABON            TO BEFFDTA
  9311           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9312           GO TO 8200-SEND-DATAONLY
  9313        ELSE
  9314           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9315           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9316           MOVE XCTL-EL1273        TO PGM-NAME
  9317           GO TO 9300-XCTL.
  9318
  9319     IF EIBAID = DFHPF8
  9320        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9321        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9322        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9323        MOVE PI-SV-STATE            TO PI-STATE
  9324        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9325        MOVE CCERTNOI               TO PI-CERT-PRIME
  9326        MOVE CSUFIXI                TO PI-CERT-SFX
  9327        MOVE CEFFDTI                TO DEEDIT-FIELD
  9328        PERFORM 8600-DEEDIT
  9329        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9330        MOVE '4'                    TO DC-OPTION-CODE
  9331        PERFORM 9700-DATE-LINK
  9332        IF DATE-CONVERSION-ERROR
  9333           MOVE ER-0348             TO EMI-ERROR
  9334           MOVE -1                  TO BEFFDTL
  9335           MOVE AL-UABON            TO BEFFDTA
  9336           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9337           GO TO 8200-SEND-DATAONLY
  9338        ELSE
  9339           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9340           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9341           IF PI-COMPANY-ID = 'DMD'
  9342               MOVE XCTL-EL401DMD      TO PGM-NAME
  9343             ELSE
  9344               MOVE XCTL-EL1279        TO PGM-NAME
  9345           END-IF
  9346           GO TO 9300-XCTL.
  9347
  9348     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9349        MOVE XCTL-EL6312     TO PGM-NAME
  9350
  9351* EXEC CICS XCTL
  9352*           PROGRAM  (PGM-NAME)
  9353*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9354*           LENGTH   (WS-COMM-LENGTH)
  9355*       END-EXEC
  9356*    MOVE '.$C                   %   #00009280' TO DFHEIV0
  9357     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9358     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 171
* EL6311.cbl
  9359     MOVE X'2020233030303039323830' TO DFHEIV0(25:11)
  9360     CALL 'kxdfhei1' USING DFHEIV0,
  9361           PGM-NAME,
  9362           PROGRAM-INTERFACE-BLOCK,
  9363           WS-COMM-LENGTH,
  9364           DFHEIV99
  9365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9366     ELSE
  9367        MOVE '0'                 TO  PI-EDIT-SW.
  9368
  9369     IF EIBAID = DFHPF10
  9370         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9371         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9372         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9373         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9374                                    PI-1042-WA
  9375         MOVE 4                  TO PI-689-DATA-SOURCE
  9376         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9377         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9378         MOVE PI-SV-STATE        TO PI-689-STATE
  9379         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9380         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9381         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9382         MOVE PI-PB-ALT-CHG-SEQ-NO
  9383                                 TO PI-689-ALT-SEQ-NO
  9384         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9385         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9386         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9387         MOVE +0                 TO PI-689-CONTROL
  9388         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9389                                    PI-689-EXP-DATE
  9390                                    PI-689-RESP-PERSON
  9391                                    PI-689-TYPE
  9392                                    PI-689-FOLLOW-UP-EDIT
  9393                                    PI-689-RESEND1-EDIT
  9394                                    PI-689-SEQ-EDIT
  9395                                    PI-689-BCSEQ-EDIT
  9396                                    PI-689-LBL-OVERRIDE
  9397         MOVE W-LETTER-COMMUNICATION-AREAS
  9398                                 TO PI-PROGRAM-WORK-AREA
  9399         MOVE XCTL-EL689         TO PGM-NAME
  9400         GO TO 9300-XCTL.
  9401
  9402     IF  EIBAID = DFHPF16
  9403         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9404         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9405         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9406                                    PI-1042-WA
  9407         MOVE 4                  TO PI-689-DATA-SOURCE
  9408         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9409         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9410         MOVE PI-SV-STATE        TO PI-689-STATE
  9411         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9412         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9413         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9414         MOVE PI-PB-ALT-CHG-SEQ-NO
  9415                                 TO PI-689-ALT-SEQ-NO
  9416         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 172
* EL6311.cbl
  9417         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9418         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9419         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9420         MOVE W-LETTER-COMMUNICATION-AREAS
  9421                                 TO PI-PROGRAM-WORK-AREA
  9422         MOVE XCTL-EL690         TO PGM-NAME
  9423         GO TO 9300-XCTL.
  9424     IF (EIBAID = DFHPF13)
  9425        if (not fatal-errors)
  9426           and (not unforced-errors)
  9427           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9428           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9429           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9430           MOVE PI-SV-STATE      TO PI-STATE
  9431           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9432           MOVE CCERTNOI         TO PI-CERT-PRIME
  9433           MOVE CSUFIXI          TO PI-CERT-SFX
  9434           MOVE CEFFDTI          TO DEEDIT-FIELD
  9435           PERFORM 8600-DEEDIT
  9436           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9437           MOVE '4'              TO DC-OPTION-CODE
  9438           PERFORM 9700-DATE-LINK
  9439           IF DATE-CONVERSION-ERROR
  9440              MOVE ER-0348       TO EMI-ERROR
  9441              MOVE -1            TO CEFFDTL
  9442              MOVE AL-UABON      TO CEFFDTA
  9443              PERFORM 9900-ERROR-FORMAT
  9444                                 THRU 9900-EXIT
  9445              GO TO 8200-SEND-DATAONLY
  9446           ELSE
  9447              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9448              MOVE AL-UANON      TO CEFFDTA
  9449              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9450              PERFORM 6000-CREATE-TEMP-STORAGE
  9451                                 THRU 6000-EXIT
  9452              MOVE XCTL-EL677    TO PGM-NAME
  9453              GO TO 9300-XCTL
  9454           end-if
  9455        else
  9456           MOVE ER-3444          TO EMI-ERROR
  9457           MOVE -1               TO CPFENTRL
  9458           MOVE AL-UNBON         TO CPFENTRA
  9459           PERFORM 9900-ERROR-FORMAT
  9460                                 THRU 9900-EXIT
  9461           GO TO 8200-SEND-DATAONLY
  9462        end-if
  9463     end-if
  9464
  9465     IF EIBAID = DFHPF14
  9466        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9467        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9468        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9469        MOVE PI-SV-STATE            TO PI-CR-STATE
  9470        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9471        MOVE SPACE                  TO PI-EDIT-SW
  9472        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9473        MOVE XCTL-EL650             TO PGM-NAME
  9474        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 173
* EL6311.cbl
  9475
  9476     IF EIBAID = DFHENTER OR DFHPF11
  9477        GO TO 2000-CANCEL-MAINLINE.
  9478
  9479     MOVE ER-0029                TO EMI-ERROR.
  9480     MOVE -1                     TO CPFENTRL.
  9481     MOVE AL-UNBON               TO CPFENTRA.
  9482     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9483     GO TO 8200-SEND-DATAONLY.
  9484
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 174
* EL6311.cbl
  9486
  9487******************************************************************
  9488*                                                                *
  9489*      BATCH SCREEN PF KEY CHECKING                              *
  9490*                                                                *
  9491******************************************************************
  9492
  9493******************************************************************
  9494*                                                                *
  9495*      PF KEY FUNCTIONS:                                         *
  9496*                                                                *
  9497*      PF1 = BROWSE FORWARD                                      *
  9498*      PF2 = BROWSE BACKWARD                                     *
  9499*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9500*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9501*                                                                *
  9502*                                                                *
  9503******************************************************************
  9504
  9505 0500-CHECK-BATCH-PF-KEYS.
  9506     IF EIBAID = DFHPF1
  9507        MOVE '0'                TO PI-EDIT-SW
  9508        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9509           GO TO 5000-BROWSE-BATCH-HEADERS
  9510        ELSE
  9511           IF PI-GOOD-BROWSE
  9512              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9513                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9514              ELSE
  9515                 IF PI-FILE-BROWSE
  9516                    GO TO 4300-BROWSE-FILE-FORWARD
  9517                 ELSE
  9518                    IF PI-CSR-BROWSE
  9519                       GO TO 4200-BROWSE-CSR-FORWARD
  9520                    ELSE
  9521                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9522           ELSE
  9523              GO TO 0800-BROWSE-ERROR.
  9524
  9525     IF EIBAID = DFHPF2
  9526        MOVE '0'                TO PI-EDIT-SW
  9527        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9528           GO TO 5500-BROWSE-BATCH-BACKWARD
  9529        ELSE
  9530           IF PI-GOOD-BROWSE
  9531              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9532                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9533              ELSE
  9534                 IF PI-FILE-BROWSE
  9535                    GO TO 4800-BROWSE-FILE-BACKWARD
  9536                 ELSE
  9537                    IF PI-CSR-BROWSE
  9538                       GO TO 4900-BROWSE-CSR-BACKWARD
  9539                    ELSE
  9540                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9541           ELSE
  9542              GO TO 0800-BROWSE-ERROR.
  9543
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 175
* EL6311.cbl
  9544     IF EIBAID = DFHPF3
  9545        GO TO 3000-BATCH-MAINLINE.
  9546
  9547     IF  EIBAID = DFHPF4
  9548        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9549        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9550        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9551        MOVE PI-SV-STATE            TO PI-CR-STATE
  9552        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9553                                       PI-CR-FIN-RESP
  9554        MOVE 'A'                    TO PI-CR-TYPE
  9555        MOVE SPACE                  TO PI-EDIT-SW
  9556        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9557        MOVE XCTL-EL640             TO PGM-NAME
  9558        GO TO 9300-XCTL.
  9559
  9560     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9561       AND
  9562        (EIBAID = DFHENTER)
  9563           GO TO 3500-EDIT-BATCH-DATA.
  9564
  9565     IF EIBAID = DFHENTER
  9566        GO TO 3500-EDIT-BATCH-DATA.
  9567
  9568     MOVE ER-0029             TO EMI-ERROR.
  9569     MOVE -1                  TO DPFENTRL.
  9570     MOVE AL-UNBON            TO DPFENTRA.
  9571     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9572     GO TO 8200-SEND-DATAONLY.
  9573
  9574 0800-BROWSE-ERROR.
  9575     MOVE ER-2258                TO EMI-ERROR.
  9576     MOVE -1                     TO DPFENTRL.
  9577     MOVE AL-UNBON               TO DPFENTRA.
  9578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9579     GO TO 8200-SEND-DATAONLY.
  9580
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 176
* EL6311.cbl
  9582
  9583******************************************************************
  9584*                                                                *
  9585*                I S S U E   M A I N L I N E                     *
  9586*                                                                *
  9587******************************************************************
  9588
  9589 1000-ISSUE-MAINLINE.
  9590     IF PI-DISPLAY-ORIGINAL-BATCH
  9591        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9592           MOVE ER-0023             TO EMI-ERROR
  9593           MOVE -1                  TO BMAINTL
  9594           MOVE AL-UABON            TO BMAINTA
  9595           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9596           GO TO 8200-SEND-DATAONLY
  9597        ELSE
  9598           NEXT SENTENCE
  9599     ELSE
  9600        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9601           MOVE ER-0023             TO EMI-ERROR
  9602           MOVE -1                  TO BMAINTL
  9603           MOVE AL-UABON            TO BMAINTA
  9604           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9605           GO TO 8200-SEND-DATAONLY.
  9606
  9607     IF BMAINTI = 'S'
  9608        GO TO 1100-SHOW-REQUEST.
  9609
  9610     IF NOT MODIFY-CAP
  9611         MOVE 'UPDATE'       TO SM-READ
  9612         PERFORM 9995-SECURITY-VIOLATION
  9613         MOVE ER-0070        TO EMI-ERROR
  9614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9615         GO TO 8100-SEND-INITIAL-MAP.
  9616
  9617     IF BMAINTL GREATER THAN ZEROS
  9618        IF PI-PF5-FUNCTION
  9619           IF BMAINTI NOT = 'A'
  9620              MOVE AL-UABON  TO BMAINTA
  9621              MOVE -1        TO BMAINTL
  9622              MOVE ER-2260   TO EMI-ERROR
  9623              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9624              GO TO 8200-SEND-DATAONLY.
  9625
  9626     IF BCERTNOL = ZEROS
  9627       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9628         NEXT SENTENCE
  9629     ELSE
  9630         IF BCERTNOL NOT = ZEROS
  9631             MOVE AL-UANON       TO BCERTNOA
  9632         ELSE
  9633             MOVE -1             TO BCERTNOL
  9634             MOVE  1             TO SET-CURSOR-SW
  9635             MOVE ER-2218        TO EMI-ERROR
  9636             MOVE AL-UABON       TO BCERTNOA
  9637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9638
  9639     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 177
* EL6311.cbl
  9640         MOVE AL-UANON       TO BSUFIXA
  9641     ELSE
  9642         MOVE AL-SANOF       TO BSUFIXA.
  9643
  9644
  9645* EXEC CICS READ
  9646*        DATASET (FILE-ID-ERPNDB)
  9647*        INTO    (PENDING-BUSINESS)
  9648*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9649*    END-EXEC.
  9650     MOVE LENGTH OF
  9651      PENDING-BUSINESS
  9652       TO DFHEIV11
  9653*    MOVE '&"IL       E          (   #00009563' TO DFHEIV0
  9654     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9656     MOVE X'2020233030303039353633' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           FILE-ID-ERPNDB,
  9659           PENDING-BUSINESS,
  9660           DFHEIV11,
  9661           PI-PREV-CONTROL-PRIMARY,
  9662           DFHEIV99,
  9663           DFHEIV99,
  9664           DFHEIV99
  9665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9666
  9667
  9668     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9669        NEXT SENTENCE
  9670     ELSE
  9671        IF BEFFDTL NOT = ZEROS
  9672           MOVE AL-UNNON             TO BEFFDTA
  9673           MOVE BEFFDTI              TO DEEDIT-FIELD
  9674           PERFORM 8600-DEEDIT
  9675           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9676           MOVE 4                    TO DC-OPTION-CODE
  9677           PERFORM 9700-DATE-LINK
  9678           IF NO-CONVERSION-ERROR
  9679              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9680              ELSE
  9681              MOVE -1                TO BEFFDTL
  9682              MOVE  1                TO SET-CURSOR-SW
  9683              MOVE ER-2226           TO EMI-ERROR
  9684              MOVE AL-UNBON          TO BEFFDTA
  9685              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9686           ELSE
  9687              MOVE -1                TO BEFFDTL
  9688              MOVE  1                TO SET-CURSOR-SW
  9689              MOVE ER-2220           TO EMI-ERROR
  9690              MOVE AL-UNBON          TO BEFFDTA
  9691              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9692
  9693     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9694
  9695     IF BCERTNOL NOT = ZEROS
  9696        MOVE BCERTNOI                TO WS-NEW-PRIME
  9697     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 178
* EL6311.cbl
  9698        MOVE SPACES                  TO WS-NEW-PRIME.
  9699
  9700     IF BSUFIXL NOT = ZEROS
  9701        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9702     ELSE
  9703        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9704
  9705     IF BEFFDTL NOT = ZEROS
  9706        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9707     ELSE
  9708        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9709
  9710     IF BMAINTI = 'A' OR 'K' OR 'S'
  9711        NEXT SENTENCE
  9712     ELSE
  9713        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9714        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9715           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9716           WS-PB-RECORD-TYPE NOT = '1'
  9717           IF BMAINTI = 'C'
  9718               MOVE ER-2287          TO EMI-ERROR
  9719               MOVE -1               TO BCERTNOL
  9720               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9721               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9722               GO TO 8200-SEND-DATAONLY
  9723             ELSE
  9724               MOVE ER-2260          TO EMI-ERROR
  9725               MOVE -1               TO BCERTNOL
  9726               MOVE AL-UABON         TO BCERTNOA
  9727               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9728               GO TO 8200-SEND-DATAONLY.
  9729
  9730     IF BMAINTI = 'D'
  9731         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9732
  9733*    IF BMICRNOL  NOT =  ZEROS
  9734*        IF BMICRNOI  NUMERIC
  9735*            MOVE AL-UNNON       TO  BMICRNOA
  9736*        ELSE
  9737*            MOVE -1             TO  BMICRNOL
  9738*            MOVE 1              TO  SET-CURSOR-SW
  9739*            MOVE AL-UNBON       TO  BMICRNOA
  9740*            MOVE ER-2701        TO  EMI-ERROR
  9741*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9742     IF BVINL NOT = ZEROS
  9743        MOVE AL-UANON            TO BVINA
  9744     END-IF
  9745
  9746     IF LETRREQL   GREATER THAN ZEROS
  9747        IF LETRREQI = 'Y'
  9748          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9749           CONTINUE
  9750        ELSE
  9751        IF LETRREQI = 'N'
  9752          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9753           CONTINUE
  9754        ELSE
  9755           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 179
* EL6311.cbl
  9756           MOVE ER-1585          TO EMI-ERROR
  9757           MOVE AL-UABON         TO LETRREQA
  9758           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9759        END-IF
  9760     END-IF.
  9761     IF B1STNML NOT = ZEROS
  9762         MOVE AL-UANON                TO B1STNMA.
  9763
  9764     IF BINITL  NOT = ZEROS
  9765        MOVE AL-UANON                TO BINITA.
  9766
  9767     IF BSEXL NOT = ZEROS
  9768        IF BSEXI = 'M' OR 'F'
  9769           MOVE AL-UANON             TO BSEXA
  9770        ELSE
  9771           MOVE -1               TO BSEXL
  9772           MOVE ER-2629          TO EMI-ERROR
  9773           MOVE AL-UABON         TO BSEXA
  9774           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9775
  9776     IF BAGEL NOT = ZEROS
  9777         IF BAGEI NUMERIC
  9778             MOVE BAGEI              TO WS-BAGE
  9779             MOVE AL-UNNON           TO BAGEA
  9780         ELSE
  9781             MOVE -1                 TO BAGEL
  9782             MOVE  1                 TO SET-CURSOR-SW
  9783             MOVE ER-2223            TO EMI-ERROR
  9784             MOVE AL-UNBON           TO BAGEA
  9785             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9786
  9787     IF BLSTNML NOT = ZERO  OR
  9788        B1STNML NOT = ZERO  OR
  9789        BINITL NOT = ZERO
  9790         IF BAGEL = ZEROS
  9791             MOVE -1                 TO BAGEL
  9792             MOVE  1                 TO SET-CURSOR-SW
  9793             MOVE ER-3269            TO EMI-ERROR
  9794             MOVE AL-UNBON           TO BAGEA
  9795             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9796         END-IF
  9797     END-IF.
  9798
  9799     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9800
  9801     IF (BBIRTHL GREATER THAN +0) AND
  9802        (BBIRTHI NOT EQUAL SPACES)
  9803        NEXT SENTENCE
  9804     ELSE
  9805        GO TO 1010-CHECK-AGE.
  9806
  9807     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9808     PERFORM 8600-DEEDIT.
  9809     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9810     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9811     MOVE AL-UNNON               TO BBIRTHA.
  9812     MOVE '4'                    TO DC-OPTION-CODE.
  9813     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 180
* EL6311.cbl
  9814     IF DATE-CONVERSION-ERROR
  9815        MOVE -1                  TO BBIRTHL
  9816        MOVE  1                  TO SET-CURSOR-SW
  9817        MOVE ER-2228             TO EMI-ERROR
  9818        MOVE AL-UNBON            TO BBIRTHA
  9819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9820        GO TO 1010-CHECK-AGE.
  9821
  9822     IF (NO-CONVERSION-ERROR) AND
  9823        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9824        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9825        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9826        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9827                                    WS-CONVERTED-BIRTH
  9828        MOVE AL-UANON            TO BBIRTHA
  9829     ELSE
  9830        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9831        MOVE AL-UANON            TO BBIRTHA.
  9832
  9833 1010-CHECK-AGE.
  9834
  9835*    IF BAGEL = ZERO
  9836*       IF BBIRTHL GREATER THAN ZERO
  9837*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9838
  9839     IF B1STPMTL NOT = ZEROS
  9840        IF B1STPMTI = SPACES
  9841           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9842        ELSE
  9843           MOVE B1STPMTI             TO DEEDIT-FIELD
  9844           PERFORM 8600-DEEDIT
  9845           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9846           MOVE AL-UNNON             TO B1STPMTA
  9847           MOVE 4                    TO DC-OPTION-CODE
  9848           PERFORM 9700-DATE-LINK
  9849           IF NO-CONVERSION-ERROR
  9850              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9851              MOVE AL-UANON          TO B1STPMTA
  9852           ELSE
  9853              MOVE -1                TO B1STPMTL
  9854              MOVE  1                TO SET-CURSOR-SW
  9855              MOVE ER-2200           TO EMI-ERROR
  9856              MOVE AL-UNBON          TO B1STPMTA
  9857              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9858
  9859     IF BDAYSL NOT = ZEROS
  9860         IF BDAYSI NUMERIC
  9861             MOVE AL-UNNON           TO BDAYSA
  9862         ELSE
  9863             MOVE -1                 TO BDAYSL
  9864             MOVE ER-2530            TO EMI-ERROR
  9865             MOVE AL-UNBON           TO BDAYSA
  9866             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9867
  9868     IF BLNTRML NOT = ZEROS
  9869         IF BLNTRMI NUMERIC
  9870             MOVE AL-UNNON       TO BLNTRMA
  9871         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 181
* EL6311.cbl
  9872             MOVE -1             TO BLNTRML
  9873             MOVE ER-2533        TO EMI-ERROR
  9874             MOVE AL-UNBON       TO BLNTRMA
  9875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9876
  9877**   IF PI-COMPANY-ID = 'DMD'
  9878     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9879        NEXT SENTENCE
  9880     ELSE
  9881         IF BLNOFCRL NOT = ZEROS
  9882            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9883            IF LOAN-OFFICER-FOUND
  9884                MOVE AL-UANON        TO BLNOFCRA
  9885             ELSE
  9886                 MOVE SPACE          TO WS-LOAN-OFFICER
  9887                 MOVE -1             TO BLNOFCRL
  9888                 MOVE  1             TO SET-CURSOR-SW
  9889                 MOVE ER-3006        TO EMI-ERROR
  9890                 MOVE AL-UNBON       TO BLNOFCRA
  9891                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9892
  9893     IF BFREQL NOT = ZEROS
  9894         IF BFREQI NUMERIC
  9895             MOVE AL-UNNON       TO BFREQA
  9896         ELSE
  9897             MOVE -1             TO BFREQL
  9898             MOVE  1             TO SET-CURSOR-SW
  9899             MOVE ER-2223        TO EMI-ERROR
  9900             MOVE AL-UNBON       TO BFREQA
  9901             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9902
  9903     IF BMODEL NOT = ZEROS
  9904         MOVE BMODEI             TO WS-MODE-CODE
  9905                                    PI-BMODE
  9906         IF WS-MODE-CODE-VALID
  9907             MOVE AL-UANON       TO BMODEA
  9908         ELSE
  9909             MOVE -1             TO BMODEL
  9910             MOVE ER-2591        TO EMI-ERROR
  9911             MOVE AL-UABON       TO BMODEA
  9912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9913
  9914     IF BPMTSL NOT = ZEROS
  9915         IF BPMTSI NUMERIC
  9916             MOVE AL-UNNON           TO BPMTSA
  9917             MOVE BPMTSI             TO PI-BPMTS
  9918         ELSE
  9919             MOVE -1                 TO BPMTSL
  9920             MOVE ER-2592            TO EMI-ERROR
  9921             MOVE AL-UNBON           TO BPMTSA
  9922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9923
  9924     IF BPMTAMTL NOT = ZEROS
  9925
  9926* EXEC CICS BIF DEEDIT
  9927*            FIELD  (BPMTAMTI)
  9928*            LENGTH (9)
  9929*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 182
* EL6311.cbl
  9930     MOVE 9
  9931       TO DFHEIV11
  9932*    MOVE '@"L                   #   #00009826' TO DFHEIV0
  9933     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9934     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9935     MOVE X'2020233030303039383236' TO DFHEIV0(25:11)
  9936     CALL 'kxdfhei1' USING DFHEIV0,
  9937           BPMTAMTI,
  9938           DFHEIV11
  9939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9940        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9941*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9942*        PERFORM 8600-DEEDIT
  9943*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9944
  9945*    IF BAPRL NOT = ZEROS
  9946*        EXEC CICS BIF DEEDIT
  9947*            FIELD  (BAPRI)
  9948*            LENGTH (7)
  9949*        END-EXEC
  9950*        MOVE BAPRI              TO WS-BAPR.
  9951
  9952     IF BAPRL > 0
  9953        MOVE +0                  TO  WS-BAPR
  9954        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9955           (WS-SUB > 7)
  9956           OR (BAPRI (WS-SUB:1) NUMERIC)
  9957           OR (BAPRI (WS-SUB:1) = '.')
  9958        END-PERFORM
  9959        IF WS-SUB > 7
  9960           MOVE ER-2471       TO EMI-ERROR
  9961           MOVE -1            TO BAPRL
  9962           MOVE AL-UNBON      TO BAPRA
  9963           PERFORM 9900-ERROR-FORMAT
  9964                                 THRU 9900-EXIT
  9965        ELSE
  9966           IF BAPRI (WS-SUB:1) NUMERIC
  9967              MOVE WS-SUB           TO WS-BEG
  9968              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9969                 (WS-SUB > 7)
  9970                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9971              END-PERFORM
  9972              COMPUTE WS-END = WS-SUB - WS-BEG
  9973              MOVE BAPRI (WS-BEG:WS-END)
  9974                                 TO WS-APR-WHOLE-NUM
  9975           END-IF
  9976           IF BAPRI (WS-SUB:1) = '.'
  9977              COMPUTE WS-BEG = WS-SUB + 1
  9978              IF (WS-BEG < 8)
  9979                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9980                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9981                    (WS-SUB > 7)
  9982                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9983                 END-PERFORM
  9984                 COMPUTE WS-END = WS-SUB - WS-BEG
  9985                 MOVE BAPRI (WS-BEG:WS-END)
  9986                                 TO WS-APR-DEC (1:WS-END)
  9987              END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 183
* EL6311.cbl
  9988           END-IF
  9989           MOVE AL-UNNON      TO BAPRA
  9990           MOVE WS-BAPR       TO BAPRO
  9991        END-IF
  9992     END-IF
  9993*     IF BAPRL NOT = ZEROS
  9994*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9995*        PERFORM 8600-DEEDIT
  9996*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9997
  9998     IF BLIVESL NOT = ZEROS
  9999        MOVE BLIVESI             TO DEEDIT-FIELD
 10000        PERFORM 8600-DEEDIT
 10001        IF DEEDIT-FIELD-V0 NUMERIC
 10002           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
 10003           MOVE AL-UNNON         TO BLIVESA
 10004        ELSE
 10005           MOVE -1               TO BLIVESL
 10006           MOVE AL-UNBON         TO BLIVESA
 10007           MOVE ER-2223          TO EMI-ERROR
 10008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10009
 10010*DMD CUSTOM CODING*************START
 10011*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10012     IF PI-COMPANY-ID NOT = 'DMD'
 10013         MOVE ZEROS               TO BBILLEDL
 10014         GO TO 1010-EDIT-CONT.
 10015
 10016     IF BBILLEDL NOT = ZEROS
 10017        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10018        MOVE 'Y'                 TO WS-NUMERIC-SW
 10019        MOVE +1                  TO WS-CSO-SUB
 10020        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10021        IF CSO-NUMERIC-FIELD
 10022
 10023* EXEC CICS BIF DEEDIT
 10024*              FIELD  (BBILLEDI)
 10025*              LENGTH (9)
 10026*          END-EXEC
 10027     MOVE 9
 10028       TO DFHEIV11
 10029*    MOVE '@"L                   #   #00009912' TO DFHEIV0
 10030     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10032     MOVE X'2020233030303039393132' TO DFHEIV0(25:11)
 10033     CALL 'kxdfhei1' USING DFHEIV0,
 10034           BBILLEDI,
 10035           DFHEIV11
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10037           MOVE BBILLEDI         TO WS-BILLED
 10038           MOVE AL-UNNON         TO BBILLEDA
 10039        ELSE
 10040           MOVE -1               TO BBILLEDL
 10041           MOVE AL-UNBON         TO BBILLEDA
 10042           MOVE ER-2547          TO EMI-ERROR
 10043           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10044     ELSE
 10045        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 184
* EL6311.cbl
 10046           MOVE -1               TO BBILLEDL
 10047           MOVE AL-UNBON         TO BBILLEDA
 10048           MOVE ER-8148          TO EMI-ERROR
 10049           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10050
 10051 1010-EDIT-CONT.
 10052
 10053     IF BFORCEL  NOT = ZEROS
 10054         IF FORCE-CAP
 10055            MOVE AL-UANON            TO BFORCEA
 10056         ELSE
 10057            MOVE ER-2945             TO EMI-ERROR
 10058            MOVE AL-UABON            TO BFORCEA
 10059            MOVE -1                  TO BFORCEL
 10060            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10061
 10062     if (bforcel not = zeros)
 10063        and (bforcei = 'L')
 10064        and (not csr-edit-session)
 10065        and (emi-error <> er-2945)
 10066        MOVE ER-2670             TO EMI-ERROR
 10067        MOVE AL-UABON            TO BFORCEA
 10068        MOVE -1                  TO BFORCEL
 10069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10070     end-if
 10071     IF BENTRYL NOT = ZEROS
 10072        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10073                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10074           MOVE ER-2224              TO EMI-ERROR
 10075           MOVE AL-UABON             TO BENTRYA
 10076           MOVE -1                   TO BENTRYL
 10077           MOVE  1                   TO SET-CURSOR-SW
 10078           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10079        ELSE
 10080           MOVE AL-UANON             TO BENTRYA.
 10081
 10082     IF BUNWRITL NOT = ZEROS
 10083        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10084           MOVE ER-7574              TO EMI-ERROR
 10085           MOVE AL-UABON             TO BUNWRITA
 10086           MOVE -1                   TO BUNWRITL
 10087           MOVE  1                   TO SET-CURSOR-SW
 10088           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10089        ELSE
 10090           MOVE AL-UANON             TO BUNWRITA.
 10091
 10092     IF BREINL  NOT = ZEROS
 10093         MOVE AL-UANON               TO BREINA.
 10094
 10095     IF BBILCDL NOT = ZEROS
 10096        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10097                             AND 'A' AND 'B' AND 'E'
 10098           MOVE ER-2225              TO EMI-ERROR
 10099           MOVE AL-UABON             TO BBILCDA
 10100           MOVE -1                   TO BBILCDL
 10101           MOVE  1                   TO SET-CURSOR-SW
 10102           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10103        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 185
* EL6311.cbl
 10104           MOVE AL-UANON             TO BBILCDA.
 10105
 10106     IF BSKPCDL NOT = ZEROS
 10107         MOVE AL-UANON               TO BSKPCDA.
 10108
 10109     IF BINDGRPL NOT = ZEROS
 10110         MOVE AL-UANON               TO BINDGRPA.
 10111
 10112     IF BSIGL   NOT = ZEROS
 10113         MOVE AL-UANON               TO BSIGA.
 10114
 10115     IF BRTCLSL NOT = ZEROS
 10116         MOVE AL-UANON               TO BRTCLSA.
 10117
 10118     IF BMEMBERL NOT = ZEROS
 10119         MOVE AL-UANON               TO BMEMBERA.
 10120
 10121     MOVE +0                         TO WS-SUB1.
 10122
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 186
* EL6311.cbl
 10124
 10125******************************************************************
 10126*                                                                *
 10127*           E D I T   I S S U E   C O V E R A G E S              *
 10128*                                                                *
 10129******************************************************************
 10130
 10131 1020-EDIT-COVERAGES.
 10132     ADD +1                      TO WS-SUB1.
 10133
 10134     IF WS-SUB1 GREATER +2
 10135        GO TO 1025-EDIT-CONTINUE
 10136     END-IF
 10137
 10138     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10139       IF (BMODEL   GREATER ZERO  OR
 10140            BPMTSL   GREATER ZERO  OR
 10141            BPMTAMTL GREATER ZERO)
 10142          AND
 10143            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10144               GO TO 1021-CONT-EDIT.
 10145
 10146     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10147        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10148        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10149        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10150        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10151        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10152        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10153        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10154        NEXT SENTENCE
 10155         ELSE
 10156            GO TO 1020-EDIT-COVERAGES.
 10157
 10158 1021-CONT-EDIT.
 10159
 10160     IF BMAINTI = 'A'
 10161        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10162           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10163        ELSE
 10164           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10165           MOVE ER-7404          TO EMI-ERROR
 10166           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10167           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10168     ELSE
 10169        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10170           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10171
 10172     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10173        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10174        PERFORM 8600-DEEDIT
 10175        IF DEEDIT-FIELD-V0 NUMERIC
 10176           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10177        ELSE
 10178           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10179
 10180     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10181*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 187
* EL6311.cbl
 10182        IF BMODEL  GREATER THAN ZEROS  AND
 10183           BPMTSL  GREATER THAN ZEROS
 10184           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10185
 10186     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10187         IF BMODEL   GREATER THAN ZEROS  OR
 10188            BPMTSL   GREATER THAN ZEROS  OR
 10189            BPMTAMTL GREATER THAN ZEROS
 10190             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10191
 10192     IF BMAINTI = ('C' OR 'K')
 10193        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10194           NEXT SENTENCE
 10195        ELSE
 10196           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10197           PERFORM 8600-DEEDIT
 10198           IF DEEDIT-FIELD-V0 NUMERIC
 10199              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10200              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10201                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10202              ELSE
 10203                    MOVE ER-2241      TO EMI-ERROR
 10204                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10205                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10206                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10207           ELSE
 10208              MOVE ER-2223          TO EMI-ERROR
 10209              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10210              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10211              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10212     ELSE
 10213        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10214            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10215            PERFORM 8600-DEEDIT
 10216            IF DEEDIT-FIELD-V0      NUMERIC
 10217               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10218                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10219                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10220               ELSE
 10221                  MOVE ER-2241         TO EMI-ERROR
 10222                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10223                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10224                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10225            ELSE
 10226              MOVE ER-2223             TO EMI-ERROR
 10227              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10228              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10229              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10230        ELSE
 10231            MOVE ER-2240               TO EMI-ERROR
 10232            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10233            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10234*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10235*        IF BMODEL  GREATER THAN ZEROS  AND
 10236*           BPMTSL  GREATER THAN ZEROS
 10237*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10238
 10239     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 188
* EL6311.cbl
 10240        AND BMAINTI = ('C' OR 'K')
 10241           NEXT SENTENCE
 10242     ELSE
 10243        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10244           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10245
 10246* EXEC CICS BIF DEEDIT
 10247*              FIELD  (BBENI (WS-SUB1))
 10248*              LENGTH (12)
 10249*          END-EXEC
 10250     MOVE 12
 10251       TO DFHEIV11
 10252*    MOVE '@"L                   #   #00010124' TO DFHEIV0
 10253     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10254     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10255     MOVE X'2020233030303130313234' TO DFHEIV0(25:11)
 10256     CALL 'kxdfhei1' USING DFHEIV0,
 10257           BBENI(WS-SUB1),
 10258           DFHEIV11
 10259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10260           IF BBENI (WS-SUB1)  NUMERIC
 10261              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10262                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10263*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10264*          PERFORM 8600-DEEDIT
 10265*          IF DEEDIT-FIELD-V2  NUMERIC
 10266*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10267*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10268              ELSE
 10269                 MOVE ER-7632    TO EMI-ERROR
 10270                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10271                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10272                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10273           ELSE
 10274              MOVE ER-2223         TO EMI-ERROR
 10275              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10276              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10277              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10278        ELSE
 10279           MOVE ER-7632    TO EMI-ERROR
 10280           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10281           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10283
 10284     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10285        AND (BMAINTI = ('C' OR 'K'))
 10286        CONTINUE
 10287     ELSE
 10288        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10289           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10290           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10291              FOR ALL '.'
 10292           IF WS-TALLY > 1
 10293              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10294                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10295              END-PERFORM
 10296              IF A1 < 9
 10297                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 189
* EL6311.cbl
 10298                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10299              END-IF
 10300           ELSE
 10301              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10302                (A1 > 11)
 10303                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10304                  LOW-VALUES OR SPACES)
 10305              END-PERFORM
 10306              IF A1 > 1 AND < 12
 10307                 MOVE SPACES
 10308                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10309              END-IF
 10310           END-IF
 10311
 10312* EXEC CICS BIF DEEDIT
 10313*              FIELD  (BPREMI (WS-SUB1))
 10314*              LENGTH (11)
 10315*          END-EXEC
 10316     MOVE 11
 10317       TO DFHEIV11
 10318*    MOVE '@"L                   #   #00010179' TO DFHEIV0
 10319     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10321     MOVE X'2020233030303130313739' TO DFHEIV0(25:11)
 10322     CALL 'kxdfhei1' USING DFHEIV0,
 10323           BPREMI(WS-SUB1),
 10324           DFHEIV11
 10325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10326           IF BPREMI (WS-SUB1) NUMERIC
 10327              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10328                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10329*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10330*          PERFORM 8600-DEEDIT
 10331*          IF DEEDIT-FIELD-V2  NUMERIC
 10332*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10333*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10334              ELSE
 10335                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10336                    MOVE ER-7633    TO EMI-ERROR
 10337                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10338                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10339                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10340                 END-IF
 10341              END-IF
 10342           ELSE
 10343              MOVE ER-2223         TO EMI-ERROR
 10344              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10345              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10346              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10347           END-IF
 10348        ELSE
 10349           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10350              MOVE ER-7633         TO EMI-ERROR
 10351              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10352              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10353              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10354           END-IF
 10355        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 190
* EL6311.cbl
 10356     END-IF
 10357
 10358     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10359        NEXT SENTENCE
 10360     ELSE
 10361        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10362
 10363* EXEC CICS BIF DEEDIT
 10364*           FIELD  (BCPREMI (WS-SUB1))
 10365*           LENGTH (11)
 10366*       END-EXEC
 10367     MOVE 11
 10368       TO DFHEIV11
 10369*    MOVE '@"L                   #   #00010219' TO DFHEIV0
 10370     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10371     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10372     MOVE X'2020233030303130323139' TO DFHEIV0(25:11)
 10373     CALL 'kxdfhei1' USING DFHEIV0,
 10374           BCPREMI(WS-SUB1),
 10375           DFHEIV11
 10376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10377        IF BCPREMI (WS-SUB1) NUMERIC
 10378           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10379*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10380*       PERFORM 8600-DEEDIT
 10381*       IF DEEDIT-FIELD-V2  NUMERIC
 10382*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10383        ELSE
 10384           MOVE ER-2223         TO EMI-ERROR
 10385           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10386           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10388
 10389     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10390        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10391        PERFORM 8600-DEEDIT
 10392        IF DEEDIT-FIELD-V0 NUMERIC
 10393           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10394           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10395         ELSE
 10396           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10397           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10398           MOVE ER-2223              TO EMI-ERROR
 10399           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10400
 10401     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10402        IF BEXPIRE   (WS-SUB1) = SPACES
 10403           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10404        ELSE
 10405           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10406           PERFORM 8600-DEEDIT
 10407           IF DEEDIT-FIELD-V0        NUMERIC
 10408              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10409              MOVE 4                TO DC-OPTION-CODE
 10410              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10411              PERFORM 9700-DATE-LINK
 10412              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10413                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 191
* EL6311.cbl
 10414              IF NO-CONVERSION-ERROR
 10415                 NEXT SENTENCE
 10416              ELSE
 10417                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10418                 MOVE ER-2531    TO EMI-ERROR
 10419                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10420                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10421           ELSE
 10422             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10423             MOVE ER-2532        TO EMI-ERROR
 10424             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10425             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10426
 10427     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10428        NEXT SENTENCE
 10429     ELSE
 10430
 10431* EXEC CICS BIF DEEDIT
 10432*           FIELD  (BALT-BENI (WS-SUB1))
 10433*           LENGTH (12)
 10434*       END-EXEC
 10435     MOVE 12
 10436       TO DFHEIV11
 10437*    MOVE '@"L                   #   #00010276' TO DFHEIV0
 10438     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10439     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10440     MOVE X'2020233030303130323736' TO DFHEIV0(25:11)
 10441     CALL 'kxdfhei1' USING DFHEIV0,
 10442           BALT-BENI(WS-SUB1),
 10443           DFHEIV11
 10444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10445        IF BALT-BENI (WS-SUB1) NUMERIC
 10446           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10447*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10448*       PERFORM 8600-DEEDIT
 10449*       IF DEEDIT-FIELD-V0 NUMERIC
 10450*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10451        ELSE
 10452           MOVE ER-2223         TO EMI-ERROR
 10453           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10454           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10455           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10456
 10457     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10458        NEXT SENTENCE
 10459     ELSE
 10460
 10461* EXEC CICS BIF DEEDIT
 10462*           FIELD  (BALT-PREMI (WS-SUB1))
 10463*           LENGTH (11)
 10464*       END-EXEC
 10465     MOVE 11
 10466       TO DFHEIV11
 10467*    MOVE '@"L                   #   #00010295' TO DFHEIV0
 10468     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10469     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10470     MOVE X'2020233030303130323935' TO DFHEIV0(25:11)
 10471     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 192
* EL6311.cbl
 10472           BALT-PREMI(WS-SUB1),
 10473           DFHEIV11
 10474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10475        IF BALT-PREMI (WS-SUB1) NUMERIC
 10476           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10477*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10478*       PERFORM 8600-DEEDIT
 10479*       IF DEEDIT-FIELD-V0 NUMERIC
 10480*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10481        ELSE
 10482           MOVE ER-2223         TO EMI-ERROR
 10483           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10484           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10485           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10486
 10487      GO TO 1020-EDIT-COVERAGES.
 10488     .
 10489 1025-edit-continue.
 10490     IF PI-COMPANY-ID  =  'DMD'
 10491        MOVE LOW-VALUES             TO BNCERTI
 10492                                       BNSTATI.
 10493
 10494     IF EMI-ERROR = ZEROS
 10495         NEXT SENTENCE
 10496     ELSE
 10497         GO TO 8200-SEND-DATAONLY.
 10498
 10499     IF BMAINTI = 'A'
 10500         GO TO 1200-ADD-ISSUE-ROUTINE.
 10501
 10502     IF BMAINTI = 'C'
 10503         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10504
 10505     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10506
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 193
* EL6311.cbl
 10508
 10509 1030-EDIT-FOR-NUMERICS.
 10510     IF WS-CSO-SUB EQUAL 10
 10511        GO TO 1030-EDIT-EXIT.
 10512
 10513     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10514        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10515        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10516           ADD +1               TO WS-CSO-SUB
 10517           GO TO 1030-EDIT-FOR-NUMERICS.
 10518
 10519     MOVE 'N'                   TO WS-NUMERIC-SW.
 10520
 10521 1030-EDIT-EXIT.
 10522******************************************************************
 10523*                                                                *
 10524*                 C A L C U L A T E   A G E                      *
 10525*                                                                *
 10526******************************************************************
 10527
 10528
 10529 1095-CALC-AGE.
 10530
 10531     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10532     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10533     MOVE 1                  TO DC-OPTION-CODE.
 10534     PERFORM 9700-DATE-LINK
 10535     IF NO-CONVERSION-ERROR
 10536         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10537         MOVE WS-BAGE            TO BAGEI
 10538         MOVE +2                 TO BAGEL
 10539         MOVE AL-UNNON TO BAGEA.
 10540
 10541 1099-EXIT.
 10542     EXIT.
 10543
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 194
* EL6311.cbl
 10545
 10546******************************************************************
 10547*                                                                *
 10548*                   S H O W   I S S U E                          *
 10549*                                                                *
 10550******************************************************************
 10551
 10552 1100-SHOW-REQUEST.
 10553     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10554
 10555     IF BCERTNOL = ZEROS AND
 10556        BEFFDTL  = ZEROS
 10557        MOVE -1                  TO BMAINTL
 10558        GO TO 8200-SEND-DATAONLY.
 10559
 10560     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10561
 10562     IF BSUFIXL NOT = ZEROS
 10563        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10564     ELSE
 10565        MOVE SPACE               TO WS-NEW-SUFFIX.
 10566
 10567     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10568     PERFORM 8600-DEEDIT.
 10569     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10570     MOVE '4'                    TO DC-OPTION-CODE.
 10571     PERFORM 9700-DATE-LINK.
 10572     IF DATE-CONVERSION-ERROR
 10573        MOVE ER-0348             TO EMI-ERROR
 10574        MOVE -1                  TO BEFFDTL
 10575        MOVE AL-UABON            TO BEFFDTA
 10576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10577        GO TO 8200-SEND-DATAONLY
 10578     ELSE
 10579        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10580        MOVE AL-UANON            TO BEFFDTA
 10581        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10582
 10583     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10584
 10585     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10586        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10587          MOVE 'Y'                    TO WS-SHOW-SW
 10588          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10589             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10590           ELSE
 10591             IF PI-FILE-BROWSE
 10592                GO TO 4300-BROWSE-FILE-FORWARD
 10593              ELSE
 10594                IF PI-CSR-BROWSE
 10595                   GO TO 4200-BROWSE-CSR-FORWARD
 10596                ELSE
 10597                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10598        ELSE
 10599           GO TO 3900-RE-DISPLAY-RECORD.
 10600
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 195
* EL6311.cbl
 10602
 10603******************************************************************
 10604*                                                                *
 10605*            A D D   I S S U E   R O U T I N E                   *
 10606*                                                                *
 10607******************************************************************
 10608
 10609***************************************************************
 10610*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10611*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10612*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10613*     4. LINK TO THE EDIT ROUTINE.                            *
 10614*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10615*     6. WRITE THE NEW ISSUE RECORD.                          *
 10616*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10617*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10618*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10619*        ELSE                                                 *
 10620*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10621***************************************************************
 10622
 10623 1200-ADD-ISSUE-ROUTINE.
 10624     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10625
 10626
 10627* EXEC CICS GETMAIN
 10628*        SET     (ADDRESS OF PENDING-BUSINESS)
 10629*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10630*    END-EXEC.
 10631*    MOVE '," L                  $   #00010450' TO DFHEIV0
 10632     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10633     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10634     MOVE X'2020233030303130343530' TO DFHEIV0(25:11)
 10635     CALL 'kxdfhei1' USING DFHEIV0,
 10636           DFHEIV20,
 10637           ERPNDB-RECORD-LENGTH,
 10638           DFHEIV99
 10639     SET ADDRESS OF PENDING-BUSINESS TO
 10640         DFHEIV20
 10641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10642
 10643
 10644
 10645* EXEC CICS HANDLE CONDITION
 10646*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10647*    END-EXEC.
 10648*    MOVE '"$I                   ! # #00010455' TO DFHEIV0
 10649     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10651     MOVE X'2320233030303130343535' TO DFHEIV0(25:11)
 10652     CALL 'kxdfhei1' USING DFHEIV0
 10653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10654
 10655
 10656     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10657     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10658     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10659
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 196
* EL6311.cbl
 10660
 10661* EXEC CICS READ
 10662*        INTO    (PENDING-BUSINESS)
 10663*        DATASET (FILE-ID-ERPNDB)
 10664*        RIDFLD  (ERPNDB-KEY)
 10665*    END-EXEC.
 10666     MOVE LENGTH OF
 10667      PENDING-BUSINESS
 10668       TO DFHEIV11
 10669*    MOVE '&"IL       E          (   #00010463' TO DFHEIV0
 10670     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10672     MOVE X'2020233030303130343633' TO DFHEIV0(25:11)
 10673     CALL 'kxdfhei1' USING DFHEIV0,
 10674           FILE-ID-ERPNDB,
 10675           PENDING-BUSINESS,
 10676           DFHEIV11,
 10677           ERPNDB-KEY,
 10678           DFHEIV99,
 10679           DFHEIV99,
 10680           DFHEIV99
 10681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10682
 10683
 10684     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10685
 10686     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10687     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10688     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10689     MOVE SPACES                 TO PENDING-BUSINESS.
 10690     MOVE 'PB'                   TO PB-RECORD-ID.
 10691     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10692     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10693     MOVE SPACES                 TO PB-CERT-SFX.
 10694     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10695     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10696                                    PB-ALT-CHG-SEQ-NO.
 10697
 10698     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10699     MOVE '1'                    TO PB-RECORD-TYPE.
 10700
 10701     IF BSUFIXL NOT = ZEROS
 10702        MOVE BSUFIXI             TO PB-CERT-SFX.
 10703
 10704     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10705
 10706     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10707     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10708
 10709     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10710                                    PB-I-LF-PREM-CALC
 10711                                    PB-I-LF-ALT-PREM-CALC
 10712                                    PB-I-LF-RATE
 10713                                    PB-I-LF-ALT-RATE
 10714                                    PB-I-LF-REI-RATE
 10715                                    PB-I-LF-ALT-REI-RATE
 10716                                    PB-I-RATE-DEV-PCT-LF
 10717                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 197
* EL6311.cbl
 10718                                    PB-I-AH-RATE
 10719                                    PB-I-AH-REI-RATE
 10720                                    PB-I-AH-RATE-TRM
 10721                                    PB-I-RATE-DEV-PCT-AH
 10722                                    PB-I-BUSINESS-TYPE
 10723                                    PB-I-LIFE-COMMISSION
 10724                                    PB-I-JOINT-COMMISSION
 10725                                    PB-I-JOINT-AGE
 10726                                    PB-I-AH-COMMISSION
 10727                                    PB-I-CURR-SEQ
 10728                                    PB-CHG-COUNT
 10729                                    PB-LF-BILLED-AMTS
 10730                                    PB-AH-BILLED-AMTS
 10731                                    PB-CALC-TOLERANCE
 10732                                    PB-I-EXTENTION-DAYS
 10733*                                   PB-I-MICROFILM-NO
 10734                                    PB-I-TERM-IN-DAYS.
 10735
 10736     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10737                                    PB-I-LF-EXPIRE-DT
 10738                                    PB-I-AH-EXPIRE-DT
 10739                                    PB-BILLED-DT
 10740                                    PB-ACCT-EFF-DT
 10741                                    PB-ACCT-EXP-DT
 10742                                    PB-I-1ST-PMT-DT.
 10743
 10744     MOVE 'X'                    TO PB-FATAL-FLAG.
 10745
 10746     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10747
 10748     IF BLSTNML GREATER THAN ZEROS
 10749         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10750
 10751*    IF BMICRNOL  GREATER  ZEROS
 10752*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10753*    ELSE
 10754*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10755     IF BVINL > ZEROS
 10756        MOVE BVINI               TO PB-I-VIN
 10757     END-IF
 10758     IF B1STNML GREATER THAN ZEROS
 10759         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10760
 10761     IF BINITL  GREATER THAN ZEROS
 10762         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10763
 10764     IF BBIRTHL GREATER THAN ZERO
 10765         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10766     ELSE
 10767         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10768
 10769     IF B1STPMTL GREATER THAN ZERO
 10770         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10771     ELSE
 10772         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10773
 10774     IF BAGEL    GREATER THAN ZEROS
 10775         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 198
* EL6311.cbl
 10776        ELSE
 10777         MOVE ZEROS              TO PB-I-AGE.
 10778
 10779     IF BSEXL    GREATER THAN ZEROS
 10780         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10781
 10782     IF BTERM-LEN (1) GREATER THAN ZEROS
 10783        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10784     ELSE
 10785        MOVE ZEROS               TO PB-I-LF-TERM.
 10786
 10787     IF BTERM-LEN (2) GREATER THAN ZEROS
 10788        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10789     ELSE
 10790        MOVE ZEROS               TO PB-I-AH-TERM.
 10791
 10792     IF BLNTRML       GREATER THAN ZEROS
 10793         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10794        ELSE
 10795         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10796
 10797     IF BFREQL        GREATER THAN ZEROS
 10798         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10799        ELSE
 10800         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10801
 10802     IF BSKPCDL       GREATER THAN ZEROS
 10803         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10804
 10805     IF BMODEL        GREATER THAN ZEROS
 10806         MOVE BMODEI             TO PB-I-TERM-TYPE
 10807                                    PI-BMODE.
 10808
 10809     IF BPMTSL        GREATER THAN ZEROS
 10810         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10811                                    PI-BPMTS
 10812        ELSE
 10813         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10814                                    PI-BPMTS.
 10815
 10816     IF BPMTAMTL      GREATER THAN ZEROS
 10817         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10818        ELSE
 10819         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10820
 10821     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10822        IF BTYPE  (1)   NOT = ZEROS
 10823           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10824                                    PI-BTYPE (1)
 10825           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10826           MOVE SPACES           TO PB-I-LF-ABBR
 10827        ELSE
 10828           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10829                                    PB-I-LF-ABBR
 10830           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10831     ELSE
 10832        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10833                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 199
* EL6311.cbl
 10834        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10835
 10836     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10837         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10838     ELSE
 10839         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10840
 10841     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10842         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10843     ELSE
 10844         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10845
 10846     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10847         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10848            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10849            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10850         ELSE
 10851            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10852*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10853*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10854         END-IF
 10855     ELSE
 10856         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10857
 10858     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10859         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10860
 10861     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10862         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10863         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10864     ELSE
 10865         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10866
 10867     IF  BALT-PREM-LEN     (2) > ZEROS
 10868         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10869     ELSE
 10870         MOVE ZEROS            TO PB-I-TOT-FEES.
 10871
 10872     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10873        IF BTYPE      (2)   NOT = ZEROS
 10874           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10875                                  PI-BTYPE (2)
 10876           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10877           MOVE SPACES         TO PB-I-AH-ABBR
 10878        ELSE
 10879           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10880                                  PB-I-AH-ABBR
 10881           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10882     ELSE
 10883        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10884                                  PB-I-AH-ABBR
 10885        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10886
 10887     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10888         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10889     ELSE
 10890         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10891
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 200
* EL6311.cbl
 10892     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10893         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10894            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10895            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10896         ELSE
 10897            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10898*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10899*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10900         END-IF
 10901     ELSE
 10902         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10903
 10904     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10905         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10906
 10907     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10908        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10909     ELSE
 10910        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10911
 10912     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10913        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10914     ELSE
 10915        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10916
 10917     IF BINDGRPL  GREATER THAN ZEROS
 10918         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10919
 10920     IF BRTCLSL   GREATER THAN ZEROS
 10921         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10922
 10923     IF BSIGL     GREATER THAN ZEROS
 10924         MOVE BSIGI              TO PB-I-SIG-SW.
 10925     IF BAPRL > ZEROS
 10926         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10927     ELSE
 10928        if pi-company-id = 'CID'
 10929           move +99.9999         to pb-i-loan-apr
 10930        else
 10931           MOVE ZEROS            TO PB-I-LOAN-APR
 10932        end-if
 10933     end-if
 10934     IF BMEMBERL  GREATER THAN ZEROS
 10935         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10936
 10937     IF BLNOFCRL  GREATER THAN ZEROS
 10938         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10939
 10940     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10941        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10942     ELSE
 10943        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10944
 10945     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10946        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10947     ELSE
 10948        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10949
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 201
* EL6311.cbl
 10950     IF BDAYSL   GREATER THAN ZEROS
 10951        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10952                                    PB-I-EXTENTION-DAYS
 10953     ELSE
 10954        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10955                                    PB-I-EXTENTION-DAYS.
 10956
 10957     IF BDAYSL GREATER THAN ZEROS
 10958        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10959
 10960     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10961        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10962           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10963
 10964     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10965        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10966           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10967
 10968     IF B1STPMTL GREATER THAN ZEROS
 10969        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10970
 10971     IF PB-EXT-DAYS-PROCESSING
 10972        IF PB-I-EXTENTION-DAYS = ZEROS
 10973           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10974
 10975     IF PB-EXPIRE-DT-PROCESSING
 10976        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10977           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10978             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10979
 10980     IF PB-1ST-PMT-DT-PROCESSING
 10981        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10982           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10983
 10984     IF BREINL GREATER THAN ZEROS
 10985        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10986
 10987     IF BENTRYL NOT = ZEROS
 10988        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10989        IF PI-COMPANY-ID = 'CID'
 10990           AND (PB-BATCH-ENTRY = 'P')
 10991           AND (PB-STATE = 'VA')
 10992           PERFORM 1500-UPDATE-ERNOTE
 10993                                 THRU 1500-EXIT
 10994        END-IF
 10995     END-IF
 10996     IF BUNWRITL NOT = ZEROS
 10997        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10998
 10999     IF BFORCEL NOT = ZEROS
 11000        MOVE BFORCEI             TO PB-FORCE-CODE.
 11001
 11002     IF BBILCDL NOT = ZEROS
 11003        MOVE BBILCDI             TO PB-RECORD-BILL.
 11004
 11005     IF BLIVESL GREATER THAN ZEROS
 11006        MOVE WS-BLIVES           TO PB-I-LIVES
 11007     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 202
* EL6311.cbl
 11008        MOVE ZEROS               TO PB-I-LIVES.
 11009
 11010     IF BBILLEDL GREATER THAN ZEROS
 11011        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11012     ELSE
 11013        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11014
 11015*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11016
 11017 1260-WRITE-PB-RECORD.
 11018     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11019                                    PB-INPUT-BY.
 11020     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11021     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11022                                    PB-INPUT-DT.
 11023
 11024     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11025     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11026                                    PB-CONTROL-BY-ORIG-BATCH.
 11027
 11028
 11029     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11030     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11031     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11032     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11033     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11034
 11035     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11036
 11037     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11038
 11039     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11040     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11041     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11042
 11043     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11044     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11045
 11046 1275-WRITE-PENDING-BUSINESS.
 11047     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11048     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11049     MOVE 'A'                    TO JP-RECORD-TYPE.
 11050     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11051
 11052
 11053* EXEC CICS HANDLE CONDITION
 11054*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11055*    END-EXEC.
 11056*    MOVE '"$%                   ! $ #00010837' TO DFHEIV0
 11057     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11059     MOVE X'2420233030303130383337' TO DFHEIV0(25:11)
 11060     CALL 'kxdfhei1' USING DFHEIV0
 11061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11062
 11063
 11064
 11065* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 203
* EL6311.cbl
 11066*        DATASET (FILE-ID-ERPNDB)
 11067*        FROM    (PENDING-BUSINESS)
 11068*        RIDFLD  (PB-CONTROL-PRIMARY)
 11069*    END-EXEC.
 11070     MOVE LENGTH OF
 11071      PENDING-BUSINESS
 11072       TO DFHEIV11
 11073*    MOVE '&$ L                  ''   #00010841' TO DFHEIV0
 11074     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11075     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11076     MOVE X'2020233030303130383431' TO DFHEIV0(25:11)
 11077     CALL 'kxdfhei1' USING DFHEIV0,
 11078           FILE-ID-ERPNDB,
 11079           PENDING-BUSINESS,
 11080           DFHEIV11,
 11081           PB-CONTROL-PRIMARY,
 11082           DFHEIV99,
 11083           DFHEIV99
 11084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11085
 11086
 11087     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11088
 11089     PERFORM 8400-LOG-JOURNAL-RECORD.
 11090
 11091******************************************************************
 11092*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11093******************************************************************
 11094     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11095     MOVE ' '                    TO WS-ERMAIL-SW
 11096
 11097* EXEC CICS READ
 11098*       DATASET   (FILE-ID-ERMAIL)
 11099*       SET       (ADDRESS OF MAILING-DATA)
 11100*       RIDFLD    (ERMAIL-KEY)
 11101*       RESP      (WS-RESPONSE)
 11102*    END-EXEC
 11103*    MOVE '&"S        E          (  N#00010857' TO DFHEIV0
 11104     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11106     MOVE X'204E233030303130383537' TO DFHEIV0(25:11)
 11107     CALL 'kxdfhei1' USING DFHEIV0,
 11108           FILE-ID-ERMAIL,
 11109           DFHEIV20,
 11110           DFHEIV99,
 11111           ERMAIL-KEY,
 11112           DFHEIV99,
 11113           DFHEIV99,
 11114           DFHEIV99
 11115     SET ADDRESS OF MAILING-DATA TO
 11116         DFHEIV20
 11117     MOVE EIBRESP  TO WS-RESPONSE
 11118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11119     IF RESP-NORMAL
 11120        SET ERMAIL-FOUND TO TRUE
 11121     END-IF
 11122
 11123     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 204
* EL6311.cbl
 11124     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11125     MOVE 'OC'                   TO OC-RECORD-ID
 11126     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11127                                 TO OC-CONTROL-PRIMARY (1:33)
 11128     MOVE 'I'                    TO OC-RECORD-TYPE
 11129     MOVE +4096                  TO OC-KEY-SEQ-NO
 11130     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11131     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11132     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11133     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11134     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11135     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11136     MOVE PB-I-AGE               TO OC-INS-AGE
 11137     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11138     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11139     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11140     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11141     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11142     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11143     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11144     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11145     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11146     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11147     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11148     IF PB-I-JOINT-COMMISSION > +0
 11149         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11150     ELSE
 11151         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11152     END-IF
 11153     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11154     MOVE +0                     TO OC-LF-CANCEL-AMT
 11155                                    OC-LF-ITD-CANCEL-AMT
 11156     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11157     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11158     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11159     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11160     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11161     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11162     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11163     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11164     MOVE +0                     TO OC-AH-CANCEL-AMT
 11165                                    OC-AH-ITD-CANCEL-AMT
 11166     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11167     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11168     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11169     IF ERMAIL-FOUND
 11170        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11171     END-IF
 11172     IF NOT CERT-TRL-REC-NOT-FOUND
 11173        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11174                           OC-INS-AGE-DEFAULT-FLAG
 11175        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11176                           OC-JNT-AGE-DEFAULT-FLAG
 11177     END-IF
 11178     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11179     .
 11180 1275-WRITE-ELCRTO.
 11181
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 205
* EL6311.cbl
 11182* EXEC CICS WRITE
 11183*       DATASET   ('ELCRTO')
 11184*       FROM      (ORIGINAL-CERTIFICATE)
 11185*       RIDFLD    (OC-CONTROL-PRIMARY)
 11186*       RESP      (WS-RESPONSE)
 11187*    END-EXEC
 11188     MOVE LENGTH OF
 11189      ORIGINAL-CERTIFICATE
 11190       TO DFHEIV11
 11191     MOVE 'ELCRTO' TO DFHEIV1
 11192*    MOVE '&$ L                  ''  N#00010925' TO DFHEIV0
 11193     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11194     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11195     MOVE X'204E233030303130393235' TO DFHEIV0(25:11)
 11196     CALL 'kxdfhei1' USING DFHEIV0,
 11197           DFHEIV1,
 11198           ORIGINAL-CERTIFICATE,
 11199           DFHEIV11,
 11200           OC-CONTROL-PRIMARY,
 11201           DFHEIV99,
 11202           DFHEIV99
 11203     MOVE EIBRESP  TO WS-RESPONSE
 11204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11205*    display ' just wrote 1275 ' ws-response
 11206     IF RESP-DUPKEY
 11207        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11208        GO TO 1275-WRITE-ELCRTO
 11209     ELSE
 11210        IF NOT RESP-NORMAL
 11211           MOVE -1               TO BMAINTL
 11212           MOVE ER-7450          TO EMI-ERROR
 11213           PERFORM 9900-ERROR-FORMAT
 11214                                 THRU 9900-EXIT
 11215           GO TO 8200-SEND-DATAONLY
 11216        END-IF
 11217     END-IF
 11218******************************************************************
 11219*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11220******************************************************************
 11221
 11222
 11223* EXEC CICS READ
 11224*        INTO    (PENDING-BUSINESS)
 11225*        DATASET (FILE-ID-ERPNDB)
 11226*        RIDFLD  (ERPNDB-KEY)
 11227*        UPDATE
 11228*    END-EXEC.
 11229     MOVE LENGTH OF
 11230      PENDING-BUSINESS
 11231       TO DFHEIV11
 11232*    MOVE '&"IL       EU         (   #00010948' TO DFHEIV0
 11233     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11234     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11235     MOVE X'2020233030303130393438' TO DFHEIV0(25:11)
 11236     CALL 'kxdfhei1' USING DFHEIV0,
 11237           FILE-ID-ERPNDB,
 11238           PENDING-BUSINESS,
 11239           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 206
* EL6311.cbl
 11240           ERPNDB-KEY,
 11241           DFHEIV99,
 11242           DFHEIV99,
 11243           DFHEIV99
 11244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11245
 11246
 11247     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11248     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11249     MOVE 'B'                    TO JP-RECORD-TYPE.
 11250     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11251
 11252     PERFORM 8400-LOG-JOURNAL-RECORD.
 11253
 11254     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11255
 11256
 11257* EXEC CICS REWRITE
 11258*        DATASET (FILE-ID-ERPNDB)
 11259*        FROM    (PENDING-BUSINESS)
 11260*    END-EXEC.
 11261     MOVE LENGTH OF
 11262      PENDING-BUSINESS
 11263       TO DFHEIV11
 11264*    MOVE '&& L                  %   #00010964' TO DFHEIV0
 11265     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11266     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11267     MOVE X'2020233030303130393634' TO DFHEIV0(25:11)
 11268     CALL 'kxdfhei1' USING DFHEIV0,
 11269           FILE-ID-ERPNDB,
 11270           PENDING-BUSINESS,
 11271           DFHEIV11,
 11272           DFHEIV99
 11273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11274
 11275
 11276     MOVE 'C'                    TO JP-RECORD-TYPE.
 11277     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11278
 11279     PERFORM 8400-LOG-JOURNAL-RECORD.
 11280
 11281     IF WS-ERRORS-PRESENT
 11282         GO TO 3900-RE-DISPLAY-RECORD.
 11283
 11284     MOVE ZEROS                  TO EMI-ERROR.
 11285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11286     MOVE LOW-VALUES             TO EL631BI.
 11287     MOVE  -1                    TO BMAINTL.
 11288     GO TO 8100-SEND-INITIAL-MAP.
 11289
 11290 1280-BATCH-HDR-NOT-FOUND.
 11291     MOVE -1                     TO BMAINTL.
 11292     MOVE ER-7450                TO EMI-ERROR.
 11293     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11294     GO TO 8200-SEND-DATAONLY.
 11295
 11296 1290-DUPLICATE-ALT-INDEX.
 11297
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 207
* EL6311.cbl
 11298******************************************************************
 11299*                                                                *
 11300*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11301*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11302*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11303*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11304*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11305*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11306*                                                                *
 11307******************************************************************
 11308
 11309     IF LCP-ONCTR-01 =  0
 11310         ADD 1 TO LCP-ONCTR-01
 11311        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11312
 11313     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11314
 11315     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11316         NEXT SENTENCE
 11317     ELSE
 11318         ADD +1 TO PB-BATCH-SEQ-NO
 11319                   PB-CSR-BATCH-SEQ-NO
 11320         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11321         GO TO 1275-WRITE-PENDING-BUSINESS.
 11322
 11323     MOVE -1                     TO BCERTNOL.
 11324     MOVE AL-UABON               TO BCERTNOA.
 11325     MOVE AL-UNBON               TO BEFFDTA.
 11326
 11327     MOVE 1                      TO EMI-SUB
 11328                                    EMI-SWITCH1
 11329                                    EMI-SWITCH-AREA-1
 11330                                    EMI-SWITCH-AREA-2.
 11331
 11332     MOVE SPACES                 TO EMI-ERROR-LINES.
 11333
 11334
 11335* EXEC CICS SYNCPOINT ROLLBACK
 11336*    END-EXEC.
 11337*    MOVE '6"R                   !   #00011027' TO DFHEIV0
 11338     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11340     MOVE X'2020233030303131303237' TO DFHEIV0(25:11)
 11341     CALL 'kxdfhei1' USING DFHEIV0
 11342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11343
 11344
 11345     MOVE ER-2247                TO EMI-ERROR.
 11346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11347     GO TO 8200-SEND-DATAONLY.
 11348
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 208
* EL6311.cbl
 11350
 11351
 11352 1295-READ-CERT-TRAILER.
 11353
 11354
 11355* EXEC CICS GETMAIN
 11356*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11357*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11358*        INITIMG (GETMAIN-SPACE)
 11359*    END-EXEC
 11360*    MOVE ',"IL                  $   #00011039' TO DFHEIV0
 11361     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11363     MOVE X'2020233030303131303339' TO DFHEIV0(25:11)
 11364     CALL 'kxdfhei1' USING DFHEIV0,
 11365           DFHEIV20,
 11366           ELCRTT-RECORD-LENGTH,
 11367           GETMAIN-SPACE
 11368     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11369         DFHEIV20
 11370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11371
 11372     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11373     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11374     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11375
 11376
 11377* EXEC CICS HANDLE CONDITION
 11378*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11379*    END-EXEC.
 11380*    MOVE '"$I                   ! % #00011049' TO DFHEIV0
 11381     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11383     MOVE X'2520233030303131303439' TO DFHEIV0(25:11)
 11384     CALL 'kxdfhei1' USING DFHEIV0
 11385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11386
 11387
 11388
 11389* EXEC CICS READ
 11390*        DATASET  (CRTT-ID)
 11391*        RIDFLD   (ELCRTT-KEY)
 11392*        INTO     (CERTIFICATE-TRAILERS)
 11393*    END-EXEC.
 11394     MOVE LENGTH OF
 11395      CERTIFICATE-TRAILERS
 11396       TO DFHEIV11
 11397*    MOVE '&"IL       E          (   #00011053' TO DFHEIV0
 11398     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11400     MOVE X'2020233030303131303533' TO DFHEIV0(25:11)
 11401     CALL 'kxdfhei1' USING DFHEIV0,
 11402           CRTT-ID,
 11403           CERTIFICATE-TRAILERS,
 11404           DFHEIV11,
 11405           ELCRTT-KEY,
 11406           DFHEIV99,
 11407           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 209
* EL6311.cbl
 11408           DFHEIV99
 11409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11410
 11411
 11412     GO TO 1295-EXIT.
 11413
 11414 1295-CERT-TRL-REC-NOTFND.
 11415     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11416
 11417 1295-EXIT.
 11418     EXIT.
 11419
 11420******************************************************************
 11421*                                                                *
 11422*          C H A N G E   I S S U E   R O U T I N E               *
 11423*                                                                *
 11424******************************************************************
 11425
 11426***************************************************************
 11427*                                                             *
 11428*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11429*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11430*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11431*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11432*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11433*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11434*     5. LINK TO THE EDIT ROUTINE.                            *
 11435*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11436*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11437*              THE EDIT ROUTINE.                              *
 11438*     7. REWRITE THE NEW ISSUE                                *
 11439*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11440*                                                             *
 11441***************************************************************
 11442
 11443 1300-CHANGE-ISSUE-ROUTINE.
 11444     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11445
 11446     IF BCHGL NOT = ZEROS
 11447        MOVE ER-2196             TO EMI-ERROR
 11448        MOVE AL-UABON            TO BMAINTA
 11449        MOVE -1                  TO BMAINTL
 11450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11451        GO TO 8200-SEND-DATAONLY.
 11452
 11453     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11454
 11455     IF BSUFIXL NOT = ZEROS
 11456        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11457     ELSE
 11458        MOVE SPACE               TO WS-NEW-SUFFIX.
 11459
 11460     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11461     PERFORM 8600-DEEDIT.
 11462     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11463     MOVE '4'                    TO DC-OPTION-CODE.
 11464     PERFORM 9700-DATE-LINK.
 11465     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 210
* EL6311.cbl
 11466        MOVE ER-0348             TO EMI-ERROR
 11467        MOVE -1                  TO BEFFDTL
 11468        MOVE AL-UABON            TO BEFFDTA
 11469        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11470        GO TO 8200-SEND-DATAONLY
 11471     ELSE
 11472        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11473        MOVE AL-UANON            TO BEFFDTA
 11474        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11475
 11476 1325-PROCESS-ISSUE-CHANGES.
 11477
 11478* EXEC CICS HANDLE CONDITION
 11479*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11480*    END-EXEC.
 11481*    MOVE '"$I                   ! & #00011124' TO DFHEIV0
 11482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11484     MOVE X'2620233030303131313234' TO DFHEIV0(25:11)
 11485     CALL 'kxdfhei1' USING DFHEIV0
 11486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11487
 11488
 11489     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11490     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11491     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11492
 11493
 11494* EXEC CICS GETMAIN
 11495*        SET      (ADDRESS OF PENDING-BUSINESS)
 11496*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11497*        INITIMG  (GETMAIN-SPACE)
 11498*     END-EXEC.
 11499*    MOVE ',"IL                  $   #00011132' TO DFHEIV0
 11500     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11501     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11502     MOVE X'2020233030303131313332' TO DFHEIV0(25:11)
 11503     CALL 'kxdfhei1' USING DFHEIV0,
 11504           DFHEIV20,
 11505           ERPNDB-RECORD-LENGTH,
 11506           GETMAIN-SPACE
 11507     SET ADDRESS OF PENDING-BUSINESS TO
 11508         DFHEIV20
 11509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11510
 11511
 11512
 11513* EXEC CICS READ
 11514*        INTO    (PENDING-BUSINESS)
 11515*        DATASET (FILE-ID-ERPNDB)
 11516*        RIDFLD  (ERPNDB-KEY)
 11517*    END-EXEC.
 11518     MOVE LENGTH OF
 11519      PENDING-BUSINESS
 11520       TO DFHEIV11
 11521*    MOVE '&"IL       E          (   #00011138' TO DFHEIV0
 11522     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 211
* EL6311.cbl
 11524     MOVE X'2020233030303131313338' TO DFHEIV0(25:11)
 11525     CALL 'kxdfhei1' USING DFHEIV0,
 11526           FILE-ID-ERPNDB,
 11527           PENDING-BUSINESS,
 11528           DFHEIV11,
 11529           ERPNDB-KEY,
 11530           DFHEIV99,
 11531           DFHEIV99,
 11532           DFHEIV99
 11533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11534
 11535
 11536     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11537
 11538
 11539* EXEC CICS HANDLE CONDITION
 11540*         NOTFND     (1385-REC-NOT-FOUND)
 11541*    END-EXEC.
 11542*    MOVE '"$I                   ! '' #00011146' TO DFHEIV0
 11543     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11545     MOVE X'2720233030303131313436' TO DFHEIV0(25:11)
 11546     CALL 'kxdfhei1' USING DFHEIV0
 11547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11548
 11549
 11550**********************************************************
 11551*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11552*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11553**********************************************************
 11554
 11555
 11556* EXEC CICS READ
 11557*        DATASET (FILE-ID-ERPNDB)
 11558*        INTO    (PENDING-BUSINESS)
 11559*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11560*    END-EXEC.
 11561     MOVE LENGTH OF
 11562      PENDING-BUSINESS
 11563       TO DFHEIV11
 11564*    MOVE '&"IL       E          (   #00011155' TO DFHEIV0
 11565     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11567     MOVE X'2020233030303131313535' TO DFHEIV0(25:11)
 11568     CALL 'kxdfhei1' USING DFHEIV0,
 11569           FILE-ID-ERPNDB,
 11570           PENDING-BUSINESS,
 11571           DFHEIV11,
 11572           PI-PREV-CONTROL-PRIMARY,
 11573           DFHEIV99,
 11574           DFHEIV99,
 11575           DFHEIV99
 11576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11577
 11578
 11579********** DO NOT ALLOW CHANGES IF THRU A/R
 11580     IF BMAINTI = 'C'
 11581         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 212
* EL6311.cbl
 11582             MOVE ER-4005          TO EMI-ERROR
 11583             MOVE -1               TO BMAINTL
 11584             MOVE AL-UABON         TO BMAINTA
 11585             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586             GO TO 8200-SEND-DATAONLY.
 11587**********
 11588     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11589
 11590     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11591        MOVE -1                 TO BMAINTL
 11592        MOVE ER-2197            TO EMI-ERROR
 11593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11594        GO TO 8200-SEND-DATAONLY.
 11595
 11596     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11597        MOVE ER-2196             TO EMI-ERROR
 11598        MOVE AL-UABON            TO BMAINTA
 11599        MOVE -1                  TO BMAINTL
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        GO TO 8200-SEND-DATAONLY.
 11602
 11603     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11604
 11605     IF PB-BILLED-DT = LOW-VALUES AND
 11606        PB-CHG-COUNT = ZEROS
 11607        NEXT SENTENCE
 11608     ELSE
 11609        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11610            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11611           OR
 11612           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11613            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11614           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11615     move zeros                  to ws-check-amts
 11616     move ' '                    to ws-stop-sw
 11617                                    ws-check-sw
 11618                                    ws-proc-check-sw
 11619                                    ws-any-check-sw
 11620                                    ws-chek-browse-sw
 11621
 11622     perform 2500-browse-checks  thru 2500-exit
 11623
 11624     if i-have-processed-checks
 11625        or i-have-checks
 11626        continue
 11627     else
 11628        go to 1330-continue
 11629     end-if
 11630
 11631     compute ws-tot-orig-prem =
 11632        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11633        pb-i-lf-alt-premium-amt
 11634
 11635     if bprem1l <> zeros
 11636        MOVE AL-UNNON            TO bprem1a
 11637        move ws-bprem (1)        to ws-new-iss-total
 11638     else
 11639        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 213
* EL6311.cbl
 11640     end-if
 11641     display ' new iss totala ' ws-new-iss-total
 11642
 11643     if baltpr1l <> zeros
 11644        MOVE AL-UNNON            TO baltpr1a
 11645        compute ws-new-iss-total =
 11646           ws-new-iss-total + ws-balt-prem(1)
 11647     else
 11648        compute ws-new-iss-total =
 11649           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11650     end-if
 11651
 11652     if bprem2l <> zeros
 11653        MOVE AL-UNNON            TO bprem2a
 11654        compute ws-new-iss-total = ws-new-iss-total +
 11655           ws-bprem (2)
 11656     else
 11657        compute ws-new-iss-total = ws-new-iss-total +
 11658           pb-i-ah-premium-amt
 11659     end-if
 11660
 11661     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11662        if ((bprem1l <> zeros)
 11663           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11664                      or
 11665           ((bprem2l <> zeros)
 11666           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11667           move er-3456          to emi-error
 11668           perform 9900-error-format
 11669                                 thru 9900-exit
 11670           go to 1330-continue
 11671        end-if
 11672     end-if
 11673
 11674     if ws-new-iss-total > ws-tot-orig-prem
 11675        move er-3458             to emi-error
 11676        perform 9900-error-format thru 9900-exit
 11677        move al-uabon            to bmainta
 11678        move -1                  to bmaintl
 11679        go to 8200-send-dataonly
 11680     end-if
 11681
 11682     if ws-new-iss-total < ws-tot-orig-prem
 11683        move er-3457             to emi-error
 11684        move al-uabon            to bprem1a
 11685                                    bprem2a
 11686        move +0 to bprem1l bprem2l
 11687        perform 9900-error-format thru 9900-exit
 11688        move -1                  to bmaintl
 11689        go to 1330-continue
 11690     end-if
 11691
 11692     .
 11693 1330-continue.
 11694
 11695
 11696* EXEC CICS READ
 11697*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 214
* EL6311.cbl
 11698*        INTO    (PENDING-BUSINESS)
 11699*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11700*        UPDATE
 11701*    END-EXEC.
 11702     MOVE LENGTH OF
 11703      PENDING-BUSINESS
 11704       TO DFHEIV11
 11705*    MOVE '&"IL       EU         (   #00011277' TO DFHEIV0
 11706     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11707     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11708     MOVE X'2020233030303131323737' TO DFHEIV0(25:11)
 11709     CALL 'kxdfhei1' USING DFHEIV0,
 11710           FILE-ID-ERPNDB,
 11711           PENDING-BUSINESS,
 11712           DFHEIV11,
 11713           PI-PREV-CONTROL-PRIMARY,
 11714           DFHEIV99,
 11715           DFHEIV99,
 11716           DFHEIV99
 11717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11718
 11719
 11720     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11721     MOVE 'B'                    TO JP-RECORD-TYPE
 11722     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11723     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11724
 11725     PERFORM 8400-LOG-JOURNAL-RECORD.
 11726
 11727     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11728        PB-CHG-COUNT NOT = ZEROS
 11729        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11730            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11731           OR
 11732           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11733            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11734            MOVE LOW-VALUES             TO PB-BILLED-DT
 11735            ADD +1                      TO PB-CHG-COUNT.
 11736
 11737     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11738     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11739     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11740     MOVE '5'                    TO DC-OPTION-CODE.
 11741     PERFORM 9700-DATE-LINK
 11742     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11743
 11744*    IF BMICRNOL  GREATER  ZEROS
 11745*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11746
 11747     IF BVINL > ZEROS
 11748        MOVE BVINI               TO PB-I-VIN
 11749     END-IF
 11750     IF (BFORCEL NOT = ZEROS)
 11751        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11752        AND (BFORCEI = ' ')
 11753        AND (PB-FORCE-CODE = 'O')
 11754        COMPUTE PB-I-AH-PREMIUM-AMT =
 11755           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 215
* EL6311.cbl
 11756        PERFORM 1800-REMOVE-CERT-NOTES
 11757                                 THRU 1800-EXIT
 11758        PERFORM 1900-DELETE-ERPYAJ
 11759                                 THRU 1900-EXIT
 11760        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11761     END-IF
 11762     IF (BFORCEL NOT = ZEROS)
 11763        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11764        AND (BFORCEI = 'O')
 11765        AND (PB-FORCE-CODE NOT = 'O')
 11766        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11767           PB-I-AH-PREM-CALC
 11768        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11769        MOVE SPACE               TO DC-OPTION-CODE
 11770        PERFORM 9700-DATE-LINK
 11771        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11772        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11773        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11774        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11775        PERFORM 1500-UPDATE-ERNOTE
 11776                                 THRU 1500-EXIT
 11777        PERFORM 1600-UPDATE-ERPYAJ
 11778                                 THRU 1600-EXIT
 11779     END-IF
 11780     IF BLSTNML  GREATER THAN ZEROS
 11781         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11782
 11783     IF B1STNML  GREATER THAN ZEROS
 11784         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11785
 11786     IF BINITL   GREATER THAN ZEROS
 11787         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11788
 11789     IF BBIRTHL  GREATER THAN ZERO
 11790         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11791
 11792     IF B1STPMTL GREATER THAN ZERO
 11793         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11794
 11795     IF BAGEL    GREATER THAN ZEROS
 11796         MOVE BAGEI              TO PB-I-AGE.
 11797
 11798     MOVE 'N'                    TO WS-INS-AGE-SET
 11799                                    WS-JNT-AGE-SET.
 11800     IF BAGEL    GREATER THAN ZEROS
 11801        MOVE 'Y'                TO WS-INS-AGE-SET
 11802        IF BAGEI = ZERO AND
 11803             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11804           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11805           MOVE 'AGE*'          TO BAGEDEFO
 11806        ELSE
 11807           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11808           MOVE 'AGE '          TO BAGEDEFO
 11809        END-IF
 11810        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11811     END-IF.
 11812
 11813     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 216
* EL6311.cbl
 11814         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11815
 11816     IF LETRREQL   GREATER THAN ZEROS
 11817        MOVE LETRREQI TO PB-I-LETTER-REQD
 11818     END-IF.
 11819
 11820     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11821        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11822
 11823     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11824        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11825
 11826     IF BLNTRML  GREATER THAN ZEROS
 11827         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11828
 11829     IF BFREQL   GREATER THAN ZEROS
 11830         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11831
 11832     IF BSKPCDL  GREATER THAN ZEROS
 11833         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11834
 11835     IF BMODEL   GREATER THAN ZEROS
 11836         MOVE BMODEI             TO PB-I-TERM-TYPE
 11837                                    PI-BMODE.
 11838
 11839     IF BPMTSL   GREATER THAN ZEROS
 11840         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11841                                    PI-BPMTS.
 11842
 11843     IF BPMTAMTL GREATER THAN ZEROS
 11844         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11845
 11846     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11847         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11848
 11849     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11850         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11851
 11852     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11853
 11854     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11855         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11856            SUBTRACT PB-I-LF-PREMIUM-AMT
 11857                     FROM WS-B-LF-ISS-PRM-ENTERED
 11858            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11859            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11860            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11861         ELSE
 11862            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11863*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11864*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11865         END-IF
 11866     END-IF.
 11867
 11868     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11869            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11870                     FROM WS-B-LF-ISS-PRM-ENTERED
 11871         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 217
* EL6311.cbl
 11872         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11873
 11874     IF  BALT-PREM-LEN     (2)  > ZEROS
 11875         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11876
 11877     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11878         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11879
 11880     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11881         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11882            SUBTRACT PB-I-AH-PREMIUM-AMT
 11883                     FROM WS-B-AH-ISS-PRM-ENTERED
 11884            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11885            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11886            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11887         ELSE
 11888            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11889*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11890*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11891         END-IF
 11892     END-IF
 11893
 11894     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11895        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11896
 11897     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11898        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11899
 11900     IF BINDGRPL            GREATER THAN ZEROS
 11901         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11902
 11903     IF BRTCLSL             GREATER THAN ZEROS
 11904         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11905
 11906     IF BSIGL               GREATER THAN ZEROS
 11907         MOVE BSIGI              TO PB-I-SIG-SW.
 11908
 11909     IF BAPRL               GREATER THAN ZEROS
 11910         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11911
 11912     IF BMEMBERL            GREATER THAN ZEROS
 11913         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11914
 11915     IF BLNOFCRL            GREATER THAN ZEROS
 11916         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11917
 11918     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11919        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11920
 11921     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11922        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11923
 11924     IF BDAYSL              GREATER THAN ZEROS
 11925        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11926                                    PB-I-EXTENTION-DAYS.
 11927
 11928     IF BDAYSL GREATER THAN ZEROS
 11929        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 218
* EL6311.cbl
 11930
 11931     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11932        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11933           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11934
 11935     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11936        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11937           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11938
 11939     IF B1STPMTL GREATER THAN ZEROS
 11940        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11941
 11942     IF PB-EXT-DAYS-PROCESSING
 11943        IF PB-I-EXTENTION-DAYS = ZEROS
 11944           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11945
 11946     IF PB-EXPIRE-DT-PROCESSING
 11947        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11948           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11949             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11950
 11951     IF PB-1ST-PMT-DT-PROCESSING
 11952        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11953           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11954
 11955     IF BREINL GREATER THAN ZEROS
 11956        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11957
 11958     IF BFORCEL NOT = ZEROS
 11959        MOVE BFORCEI             TO PB-FORCE-CODE.
 11960     IF (BENTRYL NOT = ZEROS)
 11961        AND (PB-COMPANY-ID = 'CID')
 11962        AND (PB-STATE = 'VA')
 11963        AND (BENTRYI NOT = 'P')
 11964        AND (PB-BATCH-ENTRY = 'P')
 11965        PERFORM 1800-REMOVE-CERT-NOTES
 11966                                 THRU 1800-EXIT
 11967     END-IF
 11968     IF BENTRYL NOT = ZEROS
 11969        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11970        IF PI-COMPANY-ID = 'CID'
 11971           AND (PB-BATCH-ENTRY = 'P')
 11972           AND (PB-STATE = 'VA')
 11973           PERFORM 1500-UPDATE-ERNOTE
 11974                                 THRU 1500-EXIT
 11975        END-IF
 11976     END-IF
 11977
 11978     IF BUNWRITL NOT = ZEROS
 11979        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11980
 11981     IF BBILCDL NOT = ZEROS
 11982        MOVE BBILCDI             TO PB-RECORD-BILL.
 11983
 11984     IF BLIVESL GREATER THAN ZEROS
 11985        MOVE WS-BLIVES           TO PB-I-LIVES.
 11986
 11987
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 219
* EL6311.cbl
 11988*DMD CUSTOM CODING*************START
 11989     IF PI-COMPANY-ID NOT = 'DMD'
 11990         MOVE ZEROS               TO BBILLEDL.
 11991*DMD CUSTOM CODING*************END
 11992
 11993     IF BBILLEDL GREATER THAN ZEROS
 11994        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11995
 11996
 11997*****************************************************************
 11998*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11999*****************************************************************
 12000
 12001     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 12002        IF BTYPE  (1)   = ZEROS OR SPACES
 12003           IF REMOVE-LF-COVERAGE
 12004               MOVE SPACES           TO PB-I-LF-INPUT-CD
 12005                                        PI-BTYPE (1)
 12006               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12007                                        WS-B-LF-ISS-PRM-ENTERED
 12008               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12009                                        WS-B-LF-ISS-PRM-ENTERED
 12010               SUBTRACT PB-I-LF-PREM-CALC FROM
 12011                                        WS-B-LF-ISS-PRM-COMPUTED
 12012               MOVE ZEROS            TO PB-I-LF-TERM
 12013                                        PB-I-LF-BENEFIT-AMT
 12014                                        PB-I-LF-PREMIUM-AMT
 12015                                        PB-I-LF-BENEFIT-CD
 12016                                        PB-I-LF-PREM-CALC
 12017                                        PB-I-LF-CRIT-PER
 12018                                        PB-I-LF-ALT-BENEFIT-AMT
 12019                                        PB-I-LF-ALT-PREMIUM-AMT
 12020               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12021           ELSE
 12022               NEXT SENTENCE
 12023        ELSE
 12024           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12025                                    PI-BTYPE (1).
 12026     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12027        IF BTYPE  (2)   = ZEROS OR SPACES
 12028           IF  REMOVE-AH-COVERAGE
 12029               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12030                                        PI-BTYPE (2)
 12031               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12032                                        WS-B-AH-ISS-PRM-ENTERED
 12033               SUBTRACT PB-I-AH-PREM-CALC FROM
 12034                                        WS-B-AH-ISS-PRM-COMPUTED
 12035               MOVE ZEROS            TO PB-I-AH-TERM
 12036                                        PB-I-AH-BENEFIT-AMT
 12037                                        PB-I-AH-PREMIUM-AMT
 12038                                        PB-I-AH-BENEFIT-CD
 12039                                        PB-I-AH-PREM-CALC
 12040                                        PB-I-AH-CRIT-PER
 12041               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12042           ELSE
 12043               NEXT SENTENCE
 12044        ELSE
 12045           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 220
* EL6311.cbl
 12046                                    PI-BTYPE (2).
 12047 1360-REWRITE-PB-RECORD.
 12048     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12049
 12050     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12051     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12052
 12053     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12054
 12055     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12056     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12057
 12058     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12059         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12060
 12061     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12062         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12063
 12064     IF CSR-EDIT-SESSION
 12065        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12066     END-IF.
 12067
 12068     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12069
 12070     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12071
 12072     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12073
 12074     IF ARCHIVE-LETTER-RELEASED
 12075        MOVE 'C' TO PB-I-LETTER-REQD
 12076        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12077        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12078     END-IF
 12079
 12080     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12081     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12082     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12083
 12084     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12085     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12086
 12087 1375-REWRITE-PB-RECORD.
 12088     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12089     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12090     MOVE 'C'                    TO JP-RECORD-TYPE.
 12091     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12092
 12093
 12094* EXEC CICS REWRITE
 12095*        DATASET (FILE-ID-ERPNDB)
 12096*        FROM    (PENDING-BUSINESS)
 12097*    END-EXEC.
 12098     MOVE LENGTH OF
 12099      PENDING-BUSINESS
 12100       TO DFHEIV11
 12101*    MOVE '&& L                  %   #00011657' TO DFHEIV0
 12102     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12103     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 221
* EL6311.cbl
 12104     MOVE X'2020233030303131363537' TO DFHEIV0(25:11)
 12105     CALL 'kxdfhei1' USING DFHEIV0,
 12106           FILE-ID-ERPNDB,
 12107           PENDING-BUSINESS,
 12108           DFHEIV11,
 12109           DFHEIV99
 12110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12111
 12112
 12113     PERFORM 8400-LOG-JOURNAL-RECORD.
 12114******************************************************************
 12115*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12116******************************************************************
 12117     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12118     MOVE ' '                    TO WS-ERMAIL-SW
 12119
 12120* EXEC CICS READ
 12121*       DATASET   (FILE-ID-ERMAIL)
 12122*       SET       (ADDRESS OF MAILING-DATA)
 12123*       RIDFLD    (ERMAIL-KEY)
 12124*       RESP      (WS-RESPONSE)
 12125*    END-EXEC
 12126*    MOVE '&"S        E          (  N#00011668' TO DFHEIV0
 12127     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12128     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12129     MOVE X'204E233030303131363638' TO DFHEIV0(25:11)
 12130     CALL 'kxdfhei1' USING DFHEIV0,
 12131           FILE-ID-ERMAIL,
 12132           DFHEIV20,
 12133           DFHEIV99,
 12134           ERMAIL-KEY,
 12135           DFHEIV99,
 12136           DFHEIV99,
 12137           DFHEIV99
 12138     SET ADDRESS OF MAILING-DATA TO
 12139         DFHEIV20
 12140     MOVE EIBRESP  TO WS-RESPONSE
 12141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12142     IF RESP-NORMAL
 12143        SET ERMAIL-FOUND TO TRUE
 12144     END-IF
 12145
 12146     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12147     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12148                                 TO ELCRTO-KEY
 12149     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12150     MOVE +0                     TO ELCRTO-SEQ-NO
 12151
 12152* EXEC CICS READ
 12153*       DATASET   ('ELCRTO')
 12154*       INTO      (ORIGINAL-CERTIFICATE)
 12155*       RIDFLD    (ELCRTO-KEY)
 12156*       GTEQ
 12157*       RESP      (WS-RESPONSE)
 12158*    END-EXEC
 12159     MOVE LENGTH OF
 12160      ORIGINAL-CERTIFICATE
 12161       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 222
* EL6311.cbl
 12162     MOVE 'ELCRTO' TO DFHEIV1
 12163*    MOVE '&"IL       G          (  N#00011683' TO DFHEIV0
 12164     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12165     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12166     MOVE X'204E233030303131363833' TO DFHEIV0(25:11)
 12167     CALL 'kxdfhei1' USING DFHEIV0,
 12168           DFHEIV1,
 12169           ORIGINAL-CERTIFICATE,
 12170           DFHEIV11,
 12171           ELCRTO-KEY,
 12172           DFHEIV99,
 12173           DFHEIV99,
 12174           DFHEIV99
 12175     MOVE EIBRESP  TO WS-RESPONSE
 12176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12177*    display ' just read gteq ' ws-response
 12178     IF RESP-NORMAL
 12179        AND (OC-CONTROL-PRIMARY (1:33) =
 12180                 PB-CONTROL-BY-ACCOUNT (1:33))
 12181        AND (OC-RECORD-TYPE = 'I')
 12182        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12183           display ' csr edit session ' PI-CSR-SESSION-SW
 12184           IF NOT CSR-EDIT-SESSION
 12185
 12186* EXEC CICS READ
 12187*                DATASET   ('ELCRTO')
 12188*                INTO      (ORIGINAL-CERTIFICATE)
 12189*                RIDFLD    (OC-CONTROL-PRIMARY)
 12190*                UPDATE
 12191*                RESP      (WS-RESPONSE)
 12192*             END-EXEC
 12193     MOVE LENGTH OF
 12194      ORIGINAL-CERTIFICATE
 12195       TO DFHEIV11
 12196     MOVE 'ELCRTO' TO DFHEIV1
 12197*    MOVE '&"IL       EU         (  N#00011700' TO DFHEIV0
 12198     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12199     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12200     MOVE X'204E233030303131373030' TO DFHEIV0(25:11)
 12201     CALL 'kxdfhei1' USING DFHEIV0,
 12202           DFHEIV1,
 12203           ORIGINAL-CERTIFICATE,
 12204           DFHEIV11,
 12205           OC-CONTROL-PRIMARY,
 12206           DFHEIV99,
 12207           DFHEIV99,
 12208           DFHEIV99
 12209     MOVE EIBRESP  TO WS-RESPONSE
 12210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12211              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12212              IF RESP-NORMAL
 12213                 display ' good read upd '
 12214                 MOVE PB-I-INSURED-LAST-NAME TO
 12215                         OC-INS-LAST-NAME
 12216                 MOVE PB-I-INSURED-FIRST-NAME TO
 12217                         OC-INS-FIRST-NAME
 12218                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 12219                         OC-INS-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 223
* EL6311.cbl
 12220                 MOVE PB-I-AGE         TO OC-INS-AGE
 12221                 MOVE PB-I-JOINT-LAST-NAME   TO
 12222                         OC-JNT-LAST-NAME
 12223                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12224                         OC-JNT-FIRST-NAME
 12225                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12226                         OC-JNT-MIDDLE-INIT
 12227                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12228                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12229                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12230                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12231                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12232                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12233                         OC-LF-ALT-BEN-AMT
 12234                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12235                         OC-LF-ALT-PRM-AMT
 12236                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12237                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12238                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12239                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12240                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12241                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12242                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12243                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12244                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12245                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12246                 IF OC-CANCEL-TRAN-IND = 'N'
 12247                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12248                    MOVE +0            TO OC-LF-CANCEL-AMT
 12249                                          OC-LF-ITD-CANCEL-AMT
 12250                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12251                    MOVE +0            TO OC-AH-CANCEL-AMT
 12252                                          OC-AH-ITD-CANCEL-AMT
 12253                 END-IF
 12254                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12255                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12256                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12257                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12258                 IF ERMAIL-FOUND
 12259                    MOVE MA-CRED-BENE-NAME
 12260                                 TO OC-CRED-BENE-NAME
 12261                 END-IF
 12262                 IF NOT CERT-TRL-REC-NOT-FOUND
 12263                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12264                           OC-INS-AGE-DEFAULT-FLAG
 12265                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12266                           OC-JNT-AGE-DEFAULT-FLAG
 12267                 END-IF
 12268
 12269* EXEC CICS REWRITE
 12270*                   DATASET   ('ELCRTO')
 12271*                   FROM      (ORIGINAL-CERTIFICATE)
 12272*                   RESP      (WS-RESPONSE)
 12273*                END-EXEC
 12274     MOVE LENGTH OF
 12275      ORIGINAL-CERTIFICATE
 12276       TO DFHEIV11
 12277     MOVE 'ELCRTO' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 224
* EL6311.cbl
 12278*    MOVE '&& L                  %  N#00011764' TO DFHEIV0
 12279     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12280     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12281     MOVE X'204E233030303131373634' TO DFHEIV0(25:11)
 12282     CALL 'kxdfhei1' USING DFHEIV0,
 12283           DFHEIV1,
 12284           ORIGINAL-CERTIFICATE,
 12285           DFHEIV11,
 12286           DFHEIV99
 12287     MOVE EIBRESP  TO WS-RESPONSE
 12288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12289                 display ' just rewrote ' ws-response
 12290              END-IF
 12291           END-IF
 12292        ELSE
 12293           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12294           MOVE 'OC'             TO OC-RECORD-ID
 12295           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12296           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12297           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12298           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12299           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12300           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12301           MOVE PB-I-AGE         TO OC-INS-AGE
 12302           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12303           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12304           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12305           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12306           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12307           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12308           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12309           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12310           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12311           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12312           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12313           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12314           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12315           MOVE +0               TO OC-LF-CANCEL-AMT
 12316                                    OC-LF-ITD-CANCEL-AMT
 12317           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12318           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12319           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12320           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12321           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12322           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12323           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12324           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12325           MOVE +0               TO OC-AH-CANCEL-AMT
 12326                                    OC-AH-ITD-CANCEL-AMT
 12327           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12328           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12329           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12330           IF ERMAIL-FOUND
 12331              MOVE MA-CRED-BENE-NAME
 12332                                 TO OC-CRED-BENE-NAME
 12333           END-IF
 12334           IF NOT CERT-TRL-REC-NOT-FOUND
 12335              MOVE CS-INS-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 225
* EL6311.cbl
 12336                           OC-INS-AGE-DEFAULT-FLAG
 12337              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12338                           OC-JNT-AGE-DEFAULT-FLAG
 12339           END-IF
 12340           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12341
 12342* EXEC CICS WRITE
 12343*             DATASET   ('ELCRTO')
 12344*             FROM      (ORIGINAL-CERTIFICATE)
 12345*             RIDFLD    (OC-CONTROL-PRIMARY)
 12346*             RESP      (WS-RESPONSE)
 12347*          END-EXEC
 12348     MOVE LENGTH OF
 12349      ORIGINAL-CERTIFICATE
 12350       TO DFHEIV11
 12351     MOVE 'ELCRTO' TO DFHEIV1
 12352*    MOVE '&$ L                  ''  N#00011821' TO DFHEIV0
 12353     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12354     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12355     MOVE X'204E233030303131383231' TO DFHEIV0(25:11)
 12356     CALL 'kxdfhei1' USING DFHEIV0,
 12357           DFHEIV1,
 12358           ORIGINAL-CERTIFICATE,
 12359           DFHEIV11,
 12360           OC-CONTROL-PRIMARY,
 12361           DFHEIV99,
 12362           DFHEIV99
 12363     MOVE EIBRESP  TO WS-RESPONSE
 12364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12365        END-IF
 12366     ELSE
 12367        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12368        MOVE 'OC'                TO OC-RECORD-ID
 12369        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12370                                 TO OC-CONTROL-PRIMARY (1:33)
 12371        MOVE 'I'                 TO OC-RECORD-TYPE
 12372        MOVE +4096               TO OC-KEY-SEQ-NO
 12373        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12374        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12375        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12376        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12377        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12378        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12379        MOVE PB-I-AGE            TO OC-INS-AGE
 12380        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12381        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12382        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12383        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12384        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12385        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12386        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12387        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12388        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12389        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12390        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12391        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12392        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12393        MOVE +0                  TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 226
* EL6311.cbl
 12394                                    OC-LF-ITD-CANCEL-AMT
 12395        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12396        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12397        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12398        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12399        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12400        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12401        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12402        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12403        MOVE +0                  TO OC-AH-CANCEL-AMT
 12404                                    OC-AH-ITD-CANCEL-AMT
 12405        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12406        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12407        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12408        IF ERMAIL-FOUND
 12409           MOVE MA-CRED-BENE-NAME
 12410                                 TO OC-CRED-BENE-NAME
 12411        END-IF
 12412        IF NOT CERT-TRL-REC-NOT-FOUND
 12413           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12414                           OC-INS-AGE-DEFAULT-FLAG
 12415           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12416                           OC-JNT-AGE-DEFAULT-FLAG
 12417        END-IF
 12418        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12419
 12420* EXEC CICS WRITE
 12421*          DATASET   ('ELCRTO')
 12422*          FROM      (ORIGINAL-CERTIFICATE)
 12423*          RIDFLD    (OC-CONTROL-PRIMARY)
 12424*          RESP      (WS-RESPONSE)
 12425*       END-EXEC
 12426     MOVE LENGTH OF
 12427      ORIGINAL-CERTIFICATE
 12428       TO DFHEIV11
 12429     MOVE 'ELCRTO' TO DFHEIV1
 12430*    MOVE '&$ L                  ''  N#00011881' TO DFHEIV0
 12431     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12432     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12433     MOVE X'204E233030303131383831' TO DFHEIV0(25:11)
 12434     CALL 'kxdfhei1' USING DFHEIV0,
 12435           DFHEIV1,
 12436           ORIGINAL-CERTIFICATE,
 12437           DFHEIV11,
 12438           OC-CONTROL-PRIMARY,
 12439           DFHEIV99,
 12440           DFHEIV99
 12441     MOVE EIBRESP  TO WS-RESPONSE
 12442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12443     END-IF
 12444******************************************************************
 12445*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12446******************************************************************
 12447
 12448     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12449     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12450
 12451
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 227
* EL6311.cbl
 12452* EXEC CICS READ
 12453*        INTO    (PENDING-BUSINESS)
 12454*        DATASET (FILE-ID-ERPNDB)
 12455*        RIDFLD  (ERPNDB-KEY)
 12456*        UPDATE
 12457*    END-EXEC.
 12458     MOVE LENGTH OF
 12459      PENDING-BUSINESS
 12460       TO DFHEIV11
 12461*    MOVE '&"IL       EU         (   #00011895' TO DFHEIV0
 12462     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12464     MOVE X'2020233030303131383935' TO DFHEIV0(25:11)
 12465     CALL 'kxdfhei1' USING DFHEIV0,
 12466           FILE-ID-ERPNDB,
 12467           PENDING-BUSINESS,
 12468           DFHEIV11,
 12469           ERPNDB-KEY,
 12470           DFHEIV99,
 12471           DFHEIV99,
 12472           DFHEIV99
 12473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12474
 12475
 12476     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12477     MOVE 'B'                    TO JP-RECORD-TYPE.
 12478     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12479
 12480     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12481
 12482     PERFORM 8400-LOG-JOURNAL-RECORD.
 12483
 12484     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12485
 12486     MOVE 'C'                    TO JP-RECORD-TYPE.
 12487     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12488
 12489
 12490* EXEC CICS REWRITE
 12491*        DATASET    (FILE-ID-ERPNDB)
 12492*        FROM       (PENDING-BUSINESS)
 12493*    END-EXEC.
 12494     MOVE LENGTH OF
 12495      PENDING-BUSINESS
 12496       TO DFHEIV11
 12497*    MOVE '&& L                  %   #00011915' TO DFHEIV0
 12498     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12499     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12500     MOVE X'2020233030303131393135' TO DFHEIV0(25:11)
 12501     CALL 'kxdfhei1' USING DFHEIV0,
 12502           FILE-ID-ERPNDB,
 12503           PENDING-BUSINESS,
 12504           DFHEIV11,
 12505           DFHEIV99
 12506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12507
 12508
 12509     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 228
* EL6311.cbl
 12510
 12511     IF WS-ERRORS-PRESENT
 12512        GO TO 3900-RE-DISPLAY-RECORD.
 12513
 12514     MOVE ZEROS                  TO EMI-ERROR.
 12515     MOVE -1                     TO BMAINTL.
 12516     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12517     GO TO 3900-RE-DISPLAY-RECORD.
 12518
 12519 1380-BATCH-HDR-NOT-FOUND.
 12520     MOVE -1                     TO BMAINTL.
 12521     MOVE ER-7450                TO EMI-ERROR.
 12522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12523     GO TO 8200-SEND-DATAONLY.
 12524
 12525 1385-REC-NOT-FOUND.
 12526     MOVE -1                     TO BMAINTL.
 12527     MOVE ER-7451                TO EMI-ERROR.
 12528     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12529     GO TO 8200-SEND-DATAONLY.
 12530
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 229
* EL6311.cbl
 12532
 12533 1386-UPDATE-AGE-FLAGS.
 12534
 12535
 12536* EXEC CICS GETMAIN
 12537*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12538*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12539*        INITIMG (GETMAIN-SPACE)
 12540*    END-EXEC
 12541*    MOVE ',"IL                  $   #00011946' TO DFHEIV0
 12542     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12543     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12544     MOVE X'2020233030303131393436' TO DFHEIV0(25:11)
 12545     CALL 'kxdfhei1' USING DFHEIV0,
 12546           DFHEIV20,
 12547           ELCRTT-RECORD-LENGTH,
 12548           GETMAIN-SPACE
 12549     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12550         DFHEIV20
 12551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12552
 12553
 12554* EXEC CICS HANDLE CONDITION
 12555*        NOTFND   (1386-NOTFND)
 12556*    END-EXEC.
 12557*    MOVE '"$I                   ! ( #00011952' TO DFHEIV0
 12558     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12560     MOVE X'2820233030303131393532' TO DFHEIV0(25:11)
 12561     CALL 'kxdfhei1' USING DFHEIV0
 12562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12563
 12564
 12565     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12566     MOVE 'C'                TO ELCRTT-REC-TYPE
 12567
 12568
 12569* EXEC CICS READ
 12570*        UPDATE
 12571*        DATASET  (CRTT-ID)
 12572*        RIDFLD   (ELCRTT-KEY)
 12573*        INTO     (CERTIFICATE-TRAILERS)
 12574*    END-EXEC.
 12575     MOVE LENGTH OF
 12576      CERTIFICATE-TRAILERS
 12577       TO DFHEIV11
 12578*    MOVE '&"IL       EU         (   #00011959' TO DFHEIV0
 12579     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12580     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12581     MOVE X'2020233030303131393539' TO DFHEIV0(25:11)
 12582     CALL 'kxdfhei1' USING DFHEIV0,
 12583           CRTT-ID,
 12584           CERTIFICATE-TRAILERS,
 12585           DFHEIV11,
 12586           ELCRTT-KEY,
 12587           DFHEIV99,
 12588           DFHEIV99,
 12589           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 230
* EL6311.cbl
 12590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12591
 12592
 12593     IF WS-INS-AGE-SET = 'Y'
 12594        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12595     END-IF
 12596     IF WS-JNT-AGE-SET = 'Y'
 12597        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12598     END-IF
 12599
 12600
 12601* EXEC CICS REWRITE
 12602*       DATASET  (CRTT-ID)
 12603*       FROM     (CERTIFICATE-TRAILERS)
 12604*    END-EXEC.
 12605     MOVE LENGTH OF
 12606      CERTIFICATE-TRAILERS
 12607       TO DFHEIV11
 12608*    MOVE '&& L                  %   #00011973' TO DFHEIV0
 12609     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12610     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12611     MOVE X'2020233030303131393733' TO DFHEIV0(25:11)
 12612     CALL 'kxdfhei1' USING DFHEIV0,
 12613           CRTT-ID,
 12614           CERTIFICATE-TRAILERS,
 12615           DFHEIV11,
 12616           DFHEIV99
 12617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12618
 12619
 12620     GO TO 1386-EXIT.
 12621
 12622 1386-NOTFND.
 12623
 12624     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12625     MOVE 'CS'         TO CS-RECORD-ID.
 12626     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12627     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12628     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12629     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12630     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12631
 12632* EXEC CICS WRITE
 12633*       DATASET  (CRTT-ID)
 12634*       RIDFLD   (ELCRTT-KEY)
 12635*       FROM     (CERTIFICATE-TRAILERS)
 12636*    END-EXEC.
 12637     MOVE LENGTH OF
 12638      CERTIFICATE-TRAILERS
 12639       TO DFHEIV11
 12640*    MOVE '&$ L                  ''   #00011989' TO DFHEIV0
 12641     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12643     MOVE X'2020233030303131393839' TO DFHEIV0(25:11)
 12644     CALL 'kxdfhei1' USING DFHEIV0,
 12645           CRTT-ID,
 12646           CERTIFICATE-TRAILERS,
 12647           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 231
* EL6311.cbl
 12648           ELCRTT-KEY,
 12649           DFHEIV99,
 12650           DFHEIV99
 12651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12652
 12653
 12654 1386-EXIT.
 12655     EXIT.
 12656
 12657 1390-UPDATE-ERPNDM.
 12658
 12659
 12660* EXEC CICS HANDLE CONDITION
 12661*        NOTFND (1399-EXIT)
 12662*    END-EXEC.
 12663*    MOVE '"$I                   ! ) #00012000' TO DFHEIV0
 12664     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12666     MOVE X'2920233030303132303030' TO DFHEIV0(25:11)
 12667     CALL 'kxdfhei1' USING DFHEIV0
 12668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12669
 12670
 12671     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12672
 12673
 12674* EXEC CICS READ
 12675*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12676*        DATASET (FILE-ID-ERPNDM)
 12677*        RIDFLD  (ERPNDM-KEY)
 12678*        UPDATE
 12679*    END-EXEC.
 12680*    MOVE '&"S        EU         (   #00012006' TO DFHEIV0
 12681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12682     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12683     MOVE X'2020233030303132303036' TO DFHEIV0(25:11)
 12684     CALL 'kxdfhei1' USING DFHEIV0,
 12685           FILE-ID-ERPNDM,
 12686           DFHEIV20,
 12687           DFHEIV99,
 12688           ERPNDM-KEY,
 12689           DFHEIV99,
 12690           DFHEIV99,
 12691           DFHEIV99
 12692     SET ADDRESS OF PENDING-MAILING-DATA TO
 12693         DFHEIV20
 12694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12695
 12696
 12697     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12698     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12699     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12700
 12701     IF BLSTNML GREATER THAN ZEROS
 12702         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12703
 12704     IF B1STNML GREATER  THAN ZEROS
 12705         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 232
* EL6311.cbl
 12706
 12707     IF BINITL GREATER THAN ZEROS
 12708         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12709
 12710     IF BAGEL GREATER THAN ZEROS
 12711         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12712
 12713     IF BBIRTHL GREATER THAN ZEROS
 12714         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12715
 12716     IF BSEXL GREATER THAN ZEROS
 12717         MOVE  BSEXI             TO PM-INSURED-SEX.
 12718
 12719
 12720* EXEC CICS REWRITE
 12721*        DATASET (FILE-ID-ERPNDM)
 12722*        FROM    (PENDING-MAILING-DATA)
 12723*    END-EXEC.
 12724     MOVE LENGTH OF
 12725      PENDING-MAILING-DATA
 12726       TO DFHEIV11
 12727*    MOVE '&& L                  %   #00012035' TO DFHEIV0
 12728     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12729     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12730     MOVE X'2020233030303132303335' TO DFHEIV0(25:11)
 12731     CALL 'kxdfhei1' USING DFHEIV0,
 12732           FILE-ID-ERPNDM,
 12733           PENDING-MAILING-DATA,
 12734           DFHEIV11,
 12735           DFHEIV99
 12736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12737
 12738
 12739 1399-EXIT.
 12740     EXIT.
 12741 139A-SET-LETTER-REQD.
 12742*  COMPARE BEFORE AND AFTER CHANGE
 12743     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12744        GO TO 139A-EXIT
 12745     END-IF
 12746
 12747*  READ ELCRTO
 12748     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12749                                 TO ELCRTO-KEY
 12750     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12751     MOVE +0                     TO ELCRTO-SEQ-NO
 12752
 12753
 12754* EXEC CICS READ
 12755*       DATASET   ('ELCRTO')
 12756*       INTO      (ORIGINAL-CERTIFICATE)
 12757*       RIDFLD    (ELCRTO-KEY)
 12758*       GTEQ
 12759*       RESP      (WS-RESPONSE)
 12760*    END-EXEC
 12761     MOVE LENGTH OF
 12762      ORIGINAL-CERTIFICATE
 12763       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 233
* EL6311.cbl
 12764     MOVE 'ELCRTO' TO DFHEIV1
 12765*    MOVE '&"IL       G          (  N#00012054' TO DFHEIV0
 12766     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12768     MOVE X'204E233030303132303534' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0,
 12770           DFHEIV1,
 12771           ORIGINAL-CERTIFICATE,
 12772           DFHEIV11,
 12773           ELCRTO-KEY,
 12774           DFHEIV99,
 12775           DFHEIV99,
 12776           DFHEIV99
 12777     MOVE EIBRESP  TO WS-RESPONSE
 12778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12779
 12780*    display ' just read gteq ' ws-response
 12781     IF RESP-NORMAL
 12782        AND (OC-CONTROL-PRIMARY (1:33) =
 12783                 PB-CONTROL-BY-ACCOUNT (1:33))
 12784        AND (OC-RECORD-TYPE = 'I')
 12785*      compare individual fields
 12786        IF LETRREQL   GREATER THAN ZEROS
 12787           CONTINUE
 12788        ELSE
 12789        IF OC-CERT-NO = PB-CERT-NO
 12790          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12791          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12792          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12793          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12794          AND OC-INS-AGE = PB-I-AGE
 12795          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12796          AND OC-LF-TERM = PB-I-LF-TERM
 12797          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12798          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12799          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12800          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12801          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12802          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12803          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12804          AND PB-I-AH-TERM           = OC-AH-TERM
 12805          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12806          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12807          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12808          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12809          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12810           MOVE SPACE TO PB-I-LETTER-REQD
 12811        ELSE
 12812           MOVE 'Y' TO PB-I-LETTER-REQD
 12813        END-IF
 12814     END-IF.
 12815
 12816 139A-EXIT.
 12817     EXIT.
 12818
 12819******************************************************************
 12820*                                                                *
 12821*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 234
* EL6311.cbl
 12822*                                                                *
 12823******************************************************************
 12824
 12825 1400-DELETE-ISSUE-ROUTINE.
 12826     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12827
 12828     IF BCHGL NOT = ZEROS
 12829        MOVE ER-2196             TO EMI-ERROR
 12830        MOVE AL-UABON            TO BMAINTA
 12831        MOVE -1                  TO BMAINTL
 12832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12833        GO TO 8200-SEND-DATAONLY.
 12834
 12835
 12836* EXEC CICS HANDLE CONDITION
 12837*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12838*    END-EXEC.
 12839*    MOVE '"$I                   ! * #00012117' TO DFHEIV0
 12840     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12842     MOVE X'2A20233030303132313137' TO DFHEIV0(25:11)
 12843     CALL 'kxdfhei1' USING DFHEIV0
 12844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12845
 12846
 12847     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12848     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12849     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12850
 12851
 12852* EXEC CICS READ
 12853*        SET     (ADDRESS OF PENDING-BUSINESS)
 12854*        DATASET (FILE-ID-ERPNDB)
 12855*        RIDFLD  (ERPNDB-KEY)
 12856*    END-EXEC.
 12857*    MOVE '&"S        E          (   #00012125' TO DFHEIV0
 12858     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12859     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12860     MOVE X'2020233030303132313235' TO DFHEIV0(25:11)
 12861     CALL 'kxdfhei1' USING DFHEIV0,
 12862           FILE-ID-ERPNDB,
 12863           DFHEIV20,
 12864           DFHEIV99,
 12865           ERPNDB-KEY,
 12866           DFHEIV99,
 12867           DFHEIV99,
 12868           DFHEIV99
 12869     SET ADDRESS OF PENDING-BUSINESS TO
 12870         DFHEIV20
 12871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12872
 12873
 12874     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12875
 12876     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12877
 12878     IF BSUFIXL NOT = ZEROS
 12879        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 235
* EL6311.cbl
 12880     ELSE
 12881        MOVE SPACE               TO WS-NEW-SUFFIX.
 12882
 12883     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12884     PERFORM 8600-DEEDIT.
 12885     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12886     MOVE '4'                    TO DC-OPTION-CODE.
 12887     PERFORM 9700-DATE-LINK.
 12888     IF DATE-CONVERSION-ERROR
 12889        MOVE ER-0348             TO EMI-ERROR
 12890        MOVE -1                  TO BEFFDTL
 12891        MOVE AL-UABON            TO BEFFDTA
 12892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12893        GO TO 8200-SEND-DATAONLY
 12894     ELSE
 12895        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12896        MOVE AL-UANON            TO BEFFDTA
 12897        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12898
 12899
 12900* EXEC CICS HANDLE CONDITION
 12901*         NOTFND    (1490-RECORD-NOT-FOUND)
 12902*    END-EXEC.
 12903*    MOVE '"$I                   ! + #00012156' TO DFHEIV0
 12904     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12906     MOVE X'2B20233030303132313536' TO DFHEIV0(25:11)
 12907     CALL 'kxdfhei1' USING DFHEIV0
 12908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12909
 12910
 12911
 12912* EXEC CICS READ
 12913*        SET     (ADDRESS OF PENDING-BUSINESS)
 12914*        DATASET (FILE-ID-ERPNDB)
 12915*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12916*        UPDATE
 12917*    END-EXEC.
 12918*    MOVE '&"S        EU         (   #00012160' TO DFHEIV0
 12919     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12920     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12921     MOVE X'2020233030303132313630' TO DFHEIV0(25:11)
 12922     CALL 'kxdfhei1' USING DFHEIV0,
 12923           FILE-ID-ERPNDB,
 12924           DFHEIV20,
 12925           DFHEIV99,
 12926           PI-PREV-CONTROL-PRIMARY,
 12927           DFHEIV99,
 12928           DFHEIV99,
 12929           DFHEIV99
 12930     SET ADDRESS OF PENDING-BUSINESS TO
 12931         DFHEIV20
 12932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12933
 12934
 12935     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12936        MOVE -1                 TO BMAINTL
 12937        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 236
* EL6311.cbl
 12938        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12939        GO TO 8200-SEND-DATAONLY.
 12940
 12941     IF PB-BILLED-DT NOT = LOW-VALUES
 12942        MOVE -1                 TO BMAINTL
 12943        MOVE ER-2129            TO EMI-ERROR
 12944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12945        GO TO 8200-SEND-DATAONLY.
 12946
 12947     IF PB-CHG-COUNT NOT = ZEROS
 12948        MOVE ER-2336            TO EMI-ERROR
 12949        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12950        MOVE AL-UABON            TO BMAINTA
 12951        MOVE -1                  TO BMAINTL
 12952        GO TO 8200-SEND-DATAONLY.
 12953
 12954     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12955        PB-CHG-COUNT NOT = ZEROS
 12956        MOVE ER-2196             TO EMI-ERROR
 12957        MOVE AL-UABON            TO BMAINTA
 12958        MOVE -1                  TO BMAINTL
 12959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12960        GO TO 8200-SEND-DATAONLY.
 12961******************************************************************
 12962*                                                                *
 12963*       Determine if there have been any checks created          *
 12964*                                                                *
 12965******************************************************************
 12966
 12967     perform 2500-browse-checks  thru 2500-exit
 12968
 12969     if i-have-processed-checks
 12970        or i-have-checks
 12971        or i-have-a-check-period
 12972        move er-3446             to emi-error
 12973        perform 9900-error-format thru 9900-exit
 12974        move al-uabon            to bmainta
 12975        move -1                  to bmaintl
 12976        go to 8200-send-dataonly
 12977     end-if
 12978******************************************************************
 12979*                                                                *
 12980*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12981*                                                                *
 12982******************************************************************
 12983     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12984     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12985     MOVE +0                     TO ELCRTO-SEQ-NO
 12986
 12987* EXEC CICS READ
 12988*       DATASET   ('ELCRTO')
 12989*       INTO      (ORIGINAL-CERTIFICATE)
 12990*       RIDFLD    (ELCRTO-KEY)
 12991*       GTEQ
 12992*       RESP      (WS-RESPONSE)
 12993*    END-EXEC
 12994     MOVE LENGTH OF
 12995      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 237
* EL6311.cbl
 12996       TO DFHEIV11
 12997     MOVE 'ELCRTO' TO DFHEIV1
 12998*    MOVE '&"IL       G          (  N#00012218' TO DFHEIV0
 12999     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 13000     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13001     MOVE X'204E233030303132323138' TO DFHEIV0(25:11)
 13002     CALL 'kxdfhei1' USING DFHEIV0,
 13003           DFHEIV1,
 13004           ORIGINAL-CERTIFICATE,
 13005           DFHEIV11,
 13006           ELCRTO-KEY,
 13007           DFHEIV99,
 13008           DFHEIV99,
 13009           DFHEIV99
 13010     MOVE EIBRESP  TO WS-RESPONSE
 13011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13012     IF RESP-NORMAL
 13013        AND (OC-CONTROL-PRIMARY (1:33) =
 13014                 PB-CONTROL-BY-ACCOUNT (1:33))
 13015        AND (OC-RECORD-TYPE = 'I')
 13016
 13017* EXEC CICS READ
 13018*          DATASET   ('ELCRTO')
 13019*          INTO      (ORIGINAL-CERTIFICATE)
 13020*          RIDFLD    (ELCRTO-KEY)
 13021*          UPDATE
 13022*          RESP      (WS-RESPONSE)
 13023*       END-EXEC
 13024     MOVE LENGTH OF
 13025      ORIGINAL-CERTIFICATE
 13026       TO DFHEIV11
 13027     MOVE 'ELCRTO' TO DFHEIV1
 13028*    MOVE '&"IL       EU         (  N#00012229' TO DFHEIV0
 13029     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13031     MOVE X'204E233030303132323239' TO DFHEIV0(25:11)
 13032     CALL 'kxdfhei1' USING DFHEIV0,
 13033           DFHEIV1,
 13034           ORIGINAL-CERTIFICATE,
 13035           DFHEIV11,
 13036           ELCRTO-KEY,
 13037           DFHEIV99,
 13038           DFHEIV99,
 13039           DFHEIV99
 13040     MOVE EIBRESP  TO WS-RESPONSE
 13041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13042        IF RESP-NORMAL
 13043
 13044* EXEC CICS DELETE
 13045*             DATASET   ('ELCRTO')
 13046*          END-EXEC
 13047     MOVE 'ELCRTO' TO DFHEIV1
 13048*    MOVE '&(                    &   #00012237' TO DFHEIV0
 13049     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13050     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13051     MOVE X'2020233030303132323337' TO DFHEIV0(25:11)
 13052     CALL 'kxdfhei1' USING DFHEIV0,
 13053           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 238
* EL6311.cbl
 13054           DFHEIV99,
 13055           DFHEIV99,
 13056           DFHEIV99,
 13057           DFHEIV99
 13058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13059        END-IF
 13060     END-IF
 13061******************************************************************
 13062*                                                                *
 13063*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13064*                                                                *
 13065******************************************************************
 13066
 13067* EXEC CICS HANDLE CONDITION
 13068*        NOTFND    (1405-DELETE-CERTIFICATE)
 13069*    END-EXEC.
 13070*    MOVE '"$I                   ! , #00012247' TO DFHEIV0
 13071     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13073     MOVE X'2C20233030303132323437' TO DFHEIV0(25:11)
 13074     CALL 'kxdfhei1' USING DFHEIV0
 13075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13076
 13077
 13078
 13079* EXEC CICS READ
 13080*        EQUAL
 13081*        DATASET   (FILE-ID-ERPNDM)
 13082*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13083*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13084*        UPDATE
 13085*    END-EXEC.
 13086*    MOVE '&"S        EU         (   #00012251' TO DFHEIV0
 13087     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13088     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13089     MOVE X'2020233030303132323531' TO DFHEIV0(25:11)
 13090     CALL 'kxdfhei1' USING DFHEIV0,
 13091           FILE-ID-ERPNDM,
 13092           DFHEIV20,
 13093           DFHEIV99,
 13094           PI-PREV-CONTROL-PRIMARY,
 13095           DFHEIV99,
 13096           DFHEIV99,
 13097           DFHEIV99
 13098     SET ADDRESS OF PENDING-MAILING-DATA TO
 13099         DFHEIV20
 13100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13101
 13102
 13103     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13104     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13105     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13106
 13107     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13108
 13109
 13110* EXEC CICS DELETE
 13111*        DATASET   (FILE-ID-ERPNDM)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 239
* EL6311.cbl
 13112*    END-EXEC.
 13113*    MOVE '&(                    &   #00012265' TO DFHEIV0
 13114     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13115     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13116     MOVE X'2020233030303132323635' TO DFHEIV0(25:11)
 13117     CALL 'kxdfhei1' USING DFHEIV0,
 13118           FILE-ID-ERPNDM,
 13119           DFHEIV99,
 13120           DFHEIV99,
 13121           DFHEIV99,
 13122           DFHEIV99
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13124
 13125
 13126******************************************************************
 13127*                PROCESS   CERTIFICATE                           *
 13128******************************************************************
 13129
 13130 1405-DELETE-CERTIFICATE.
 13131
 13132* EXEC CICS HANDLE CONDITION
 13133*         NOTFND  (1420-CONTINUE-DELETE)
 13134*    END-EXEC.
 13135*    MOVE '"$I                   ! - #00012274' TO DFHEIV0
 13136     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13137     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13138     MOVE X'2D20233030303132323734' TO DFHEIV0(25:11)
 13139     CALL 'kxdfhei1' USING DFHEIV0
 13140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13141
 13142
 13143     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13144     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13145     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13146     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13147
 13148
 13149* EXEC CICS READ
 13150*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13151*        DATASET (FILE-ID-ELCERT)
 13152*        RIDFLD  (ELCERT-KEY)
 13153*        UPDATE
 13154*    END-EXEC.
 13155*    MOVE '&"S        EU         (   #00012283' TO DFHEIV0
 13156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13157     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13158     MOVE X'2020233030303132323833' TO DFHEIV0(25:11)
 13159     CALL 'kxdfhei1' USING DFHEIV0,
 13160           FILE-ID-ELCERT,
 13161           DFHEIV20,
 13162           DFHEIV99,
 13163           ELCERT-KEY,
 13164           DFHEIV99,
 13165           DFHEIV99,
 13166           DFHEIV99
 13167     SET ADDRESS OF CERTIFICATE-MASTER TO
 13168         DFHEIV20
 13169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 240
* EL6311.cbl
 13170
 13171
 13172     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13173
 13174     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13175     MOVE 'B'                    TO JP-RECORD-TYPE
 13176     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13177
 13178     PERFORM 8400-LOG-JOURNAL-RECORD.
 13179
 13180     IF CERT-NOTES-ARE-NOT-PRESENT
 13181        MOVE ' '                 TO WS-CERT-NOTE-SW
 13182     ELSE
 13183        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13184
 13185     IF INSURED-ADDR-PRESENT
 13186        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13187
 13188******************************************************************
 13189******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13190******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13191******************************************************************
 13192******************************************************************
 13193
 13194     IF CERT-ADDED-BATCH AND
 13195        (NOT NO-CLAIM-ATTACHED
 13196         OR
 13197         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13198        GO TO 1410-REWRITE-CERT.
 13199
 13200******************************************************************
 13201******************************************************************
 13202
 13203     IF CERT-ADDED-BATCH  AND
 13204        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13205        GO TO 1410-REWRITE-CERT.
 13206
 13207     IF NO-CLAIM-ATTACHED
 13208        NEXT SENTENCE
 13209     ELSE
 13210        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13211        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13212        GO TO 1410-REWRITE-CERT.
 13213
 13214     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13215     MOVE 'D'                      TO JP-RECORD-TYPE.
 13216     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13217
 13218
 13219* EXEC CICS DELETE
 13220*         DATASET    (FILE-ID-ELCERT)
 13221*    END-EXEC.
 13222*    MOVE '&(                    &   #00012336' TO DFHEIV0
 13223     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13224     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13225     MOVE X'2020233030303132333336' TO DFHEIV0(25:11)
 13226     CALL 'kxdfhei1' USING DFHEIV0,
 13227           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 241
* EL6311.cbl
 13228           DFHEIV99,
 13229           DFHEIV99,
 13230           DFHEIV99,
 13231           DFHEIV99
 13232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13233
 13234
 13235     PERFORM 8400-LOG-JOURNAL-RECORD.
 13236
 13237******************************************************************
 13238*                                                                *
 13239*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13240*                                                                *
 13241******************************************************************
 13242
 13243     IF  CERT-NOTES-ARE-PRESENT
 13244         NEXT SENTENCE
 13245     ELSE
 13246         GO TO 1407-DELETE-MAILING.
 13247
 13248
 13249* EXEC CICS HANDLE CONDITION
 13250*         NOTFND  (1406-DELETE-ERNOTE)
 13251*    END-EXEC.
 13252*    MOVE '"$I                   ! . #00012353' TO DFHEIV0
 13253     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13255     MOVE X'2E20233030303132333533' TO DFHEIV0(25:11)
 13256     CALL 'kxdfhei1' USING DFHEIV0
 13257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13258
 13259
 13260     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13261     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13262     MOVE 0                     TO ERCNOT-SEQUENCE.
 13263
 13264 1406-DELETE-ERCNOT-LOOP.
 13265
 13266
 13267* EXEC CICS READ
 13268*        GTEQ
 13269*        DATASET   (FILE-ID-ERCNOT)
 13270*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13271*        RIDFLD    (ERCNOT-KEY)
 13272*    END-EXEC.
 13273*    MOVE '&"S        G          (   #00012363' TO DFHEIV0
 13274     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13276     MOVE X'2020233030303132333633' TO DFHEIV0(25:11)
 13277     CALL 'kxdfhei1' USING DFHEIV0,
 13278           FILE-ID-ERCNOT,
 13279           DFHEIV20,
 13280           DFHEIV99,
 13281           ERCNOT-KEY,
 13282           DFHEIV99,
 13283           DFHEIV99,
 13284           DFHEIV99
 13285     SET ADDRESS OF CERT-NOTE-FILE TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 242
* EL6311.cbl
 13286         DFHEIV20
 13287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13288
 13289
 13290     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13291     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13292         GO TO 1406-DELETE-ERNOTE
 13293     END-IF.
 13294
 13295     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13296     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13297     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13298
 13299     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13300
 13301
 13302* EXEC CICS DELETE
 13303*        DATASET   (FILE-ID-ERCNOT)
 13304*        RIDFLD    (ERCNOT-KEY)
 13305*        END-EXEC.
 13306*    MOVE '&(  R                 &   #00012381' TO DFHEIV0
 13307     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13308     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13309     MOVE X'2020233030303132333831' TO DFHEIV0(25:11)
 13310     CALL 'kxdfhei1' USING DFHEIV0,
 13311           FILE-ID-ERCNOT,
 13312           ERCNOT-KEY,
 13313           DFHEIV99,
 13314           DFHEIV99,
 13315           DFHEIV99
 13316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13317
 13318
 13319     PERFORM 8400-LOG-JOURNAL-RECORD.
 13320
 13321     GO TO 1406-DELETE-ERCNOT-LOOP.
 13322
 13323 1406-DELETE-ERNOTE.
 13324
 13325
 13326* EXEC CICS HANDLE CONDITION
 13327*         NOTFND  (1407-DELETE-MAILING)
 13328*    END-EXEC.
 13329*    MOVE '"$I                   ! / #00012392' TO DFHEIV0
 13330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13332     MOVE X'2F20233030303132333932' TO DFHEIV0(25:11)
 13333     CALL 'kxdfhei1' USING DFHEIV0
 13334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13335
 13336
 13337
 13338* EXEC CICS READ
 13339*        EQUAL
 13340*        DATASET   (FILE-ID-ERNOTE)
 13341*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13342*        RIDFLD    (ELCERT-KEY)
 13343*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 243
* EL6311.cbl
 13344*    END-EXEC.
 13345*    MOVE '&"S        EU         (   #00012396' TO DFHEIV0
 13346     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13347     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13348     MOVE X'2020233030303132333936' TO DFHEIV0(25:11)
 13349     CALL 'kxdfhei1' USING DFHEIV0,
 13350           FILE-ID-ERNOTE,
 13351           DFHEIV20,
 13352           DFHEIV99,
 13353           ELCERT-KEY,
 13354           DFHEIV99,
 13355           DFHEIV99,
 13356           DFHEIV99
 13357     SET ADDRESS OF CERTIFICATE-NOTE TO
 13358         DFHEIV20
 13359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13360
 13361
 13362     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13363     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13364     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13365
 13366     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13367
 13368
 13369* EXEC CICS DELETE
 13370*        DATASET   (FILE-ID-ERNOTE)
 13371*        END-EXEC.
 13372*    MOVE '&(                    &   #00012410' TO DFHEIV0
 13373     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13375     MOVE X'2020233030303132343130' TO DFHEIV0(25:11)
 13376     CALL 'kxdfhei1' USING DFHEIV0,
 13377           FILE-ID-ERNOTE,
 13378           DFHEIV99,
 13379           DFHEIV99,
 13380           DFHEIV99,
 13381           DFHEIV99
 13382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13383
 13384
 13385     PERFORM 8400-LOG-JOURNAL-RECORD.
 13386
 13387******************************************************************
 13388*                                                                *
 13389*                DELETE MAILING ADDRESS RECORDS                  *
 13390*                                                                *
 13391******************************************************************
 13392
 13393 1407-DELETE-MAILING.
 13394     IF CERT-ADDRESS-PRESENT
 13395        NEXT SENTENCE
 13396     ELSE
 13397        GO TO 1420-CONTINUE-DELETE.
 13398
 13399
 13400* EXEC CICS HANDLE CONDITION
 13401*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 244
* EL6311.cbl
 13402*    END-EXEC.
 13403*    MOVE '"$I                   ! 0 #00012428' TO DFHEIV0
 13404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13406     MOVE X'3020233030303132343238' TO DFHEIV0(25:11)
 13407     CALL 'kxdfhei1' USING DFHEIV0
 13408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13409
 13410
 13411
 13412* EXEC CICS READ
 13413*        EQUAL
 13414*        DATASET   (FILE-ID-ERMAIL)
 13415*        SET       (ADDRESS OF MAILING-DATA)
 13416*        RIDFLD    (ELCERT-KEY)
 13417*        UPDATE
 13418*    END-EXEC.
 13419*    MOVE '&"S        EU         (   #00012432' TO DFHEIV0
 13420     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13421     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13422     MOVE X'2020233030303132343332' TO DFHEIV0(25:11)
 13423     CALL 'kxdfhei1' USING DFHEIV0,
 13424           FILE-ID-ERMAIL,
 13425           DFHEIV20,
 13426           DFHEIV99,
 13427           ELCERT-KEY,
 13428           DFHEIV99,
 13429           DFHEIV99,
 13430           DFHEIV99
 13431     SET ADDRESS OF MAILING-DATA TO
 13432         DFHEIV20
 13433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13434
 13435
 13436     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13437     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13438     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13439
 13440     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13441
 13442
 13443* EXEC CICS DELETE
 13444*        DATASET   (FILE-ID-ERMAIL)
 13445*    END-EXEC.
 13446*    MOVE '&(                    &   #00012446' TO DFHEIV0
 13447     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13448     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13449     MOVE X'2020233030303132343436' TO DFHEIV0(25:11)
 13450     CALL 'kxdfhei1' USING DFHEIV0,
 13451           FILE-ID-ERMAIL,
 13452           DFHEIV99,
 13453           DFHEIV99,
 13454           DFHEIV99,
 13455           DFHEIV99
 13456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13457
 13458
 13459     GO TO 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 245
* EL6311.cbl
 13460
 13461 1410-REWRITE-CERT.
 13462     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13463     MOVE 'C'                      TO JP-RECORD-TYPE.
 13464     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13465     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13466
 13467
 13468* EXEC CICS REWRITE
 13469*         DATASET    (FILE-ID-ELCERT)
 13470*         FROM       (CERTIFICATE-MASTER)
 13471*         END-EXEC.
 13472     MOVE LENGTH OF
 13473      CERTIFICATE-MASTER
 13474       TO DFHEIV11
 13475*    MOVE '&& L                  %   #00012458' TO DFHEIV0
 13476     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13477     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13478     MOVE X'2020233030303132343538' TO DFHEIV0(25:11)
 13479     CALL 'kxdfhei1' USING DFHEIV0,
 13480           FILE-ID-ELCERT,
 13481           CERTIFICATE-MASTER,
 13482           DFHEIV11,
 13483           DFHEIV99
 13484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13485
 13486
 13487     PERFORM 8400-LOG-JOURNAL-RECORD.
 13488
 13489 1420-CONTINUE-DELETE.
 13490     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13491     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13492
 13493     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13494     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13495
 13496     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13497
 13498 1450-DELETE-PB-RECORD.
 13499     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13500     MOVE 'D'                      TO JP-RECORD-TYPE
 13501     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13502
 13503
 13504* EXEC CICS DELETE
 13505*        DATASET    (FILE-ID-ERPNDB)
 13506*    END-EXEC.
 13507*    MOVE '&(                    &   #00012479' TO DFHEIV0
 13508     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13509     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13510     MOVE X'2020233030303132343739' TO DFHEIV0(25:11)
 13511     CALL 'kxdfhei1' USING DFHEIV0,
 13512           FILE-ID-ERPNDB,
 13513           DFHEIV99,
 13514           DFHEIV99,
 13515           DFHEIV99,
 13516           DFHEIV99
 13517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 246
* EL6311.cbl
 13518
 13519
 13520     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13521
 13522     PERFORM 8400-LOG-JOURNAL-RECORD.
 13523
 13524     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13525     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13526     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13527
 13528
 13529* EXEC CICS HANDLE CONDITION
 13530*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13531*    END-EXEC.
 13532*    MOVE '"$I                   ! 1 #00012491' TO DFHEIV0
 13533     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13535     MOVE X'3120233030303132343931' TO DFHEIV0(25:11)
 13536     CALL 'kxdfhei1' USING DFHEIV0
 13537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13538
 13539
 13540
 13541* EXEC CICS READ
 13542*        SET     (ADDRESS OF PENDING-BUSINESS)
 13543*        DATASET (FILE-ID-ERPNDB)
 13544*        RIDFLD  (ERPNDB-KEY)
 13545*        UPDATE
 13546*    END-EXEC.
 13547*    MOVE '&"S        EU         (   #00012495' TO DFHEIV0
 13548     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13549     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13550     MOVE X'2020233030303132343935' TO DFHEIV0(25:11)
 13551     CALL 'kxdfhei1' USING DFHEIV0,
 13552           FILE-ID-ERPNDB,
 13553           DFHEIV20,
 13554           DFHEIV99,
 13555           ERPNDB-KEY,
 13556           DFHEIV99,
 13557           DFHEIV99,
 13558           DFHEIV99
 13559     SET ADDRESS OF PENDING-BUSINESS TO
 13560         DFHEIV20
 13561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13562
 13563
 13564     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13565
 13566     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13567
 13568     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13569        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13570        MOVE 'D'                   TO JP-RECORD-TYPE
 13571        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13572
 13573* EXEC CICS DELETE
 13574*            DATASET    (FILE-ID-ERPNDB)
 13575*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 247
* EL6311.cbl
 13576*    MOVE '&(                    &   #00012510' TO DFHEIV0
 13577     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13578     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13579     MOVE X'2020233030303132353130' TO DFHEIV0(25:11)
 13580     CALL 'kxdfhei1' USING DFHEIV0,
 13581           FILE-ID-ERPNDB,
 13582           DFHEIV99,
 13583           DFHEIV99,
 13584           DFHEIV99,
 13585           DFHEIV99
 13586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13587        PERFORM 8400-LOG-JOURNAL-RECORD
 13588     ELSE
 13589        MOVE 'B'                 TO JP-RECORD-TYPE
 13590        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13591        PERFORM 8400-LOG-JOURNAL-RECORD
 13592        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13593        MOVE 'C'                 TO JP-RECORD-TYPE
 13594        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13595
 13596* EXEC CICS REWRITE
 13597*            DATASET    (FILE-ID-ERPNDB)
 13598*            FROM       (PENDING-BUSINESS)
 13599*       END-EXEC
 13600     MOVE LENGTH OF
 13601      PENDING-BUSINESS
 13602       TO DFHEIV11
 13603*    MOVE '&& L                  %   #00012521' TO DFHEIV0
 13604     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13605     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13606     MOVE X'2020233030303132353231' TO DFHEIV0(25:11)
 13607     CALL 'kxdfhei1' USING DFHEIV0,
 13608           FILE-ID-ERPNDB,
 13609           PENDING-BUSINESS,
 13610           DFHEIV11,
 13611           DFHEIV99
 13612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13613        PERFORM 8400-LOG-JOURNAL-RECORD.
 13614
 13615******************************************************************
 13616*                                                                *
 13617*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13618*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13619*                                                                *
 13620******************************************************************
 13621
 13622     IF NOT PI-AR-PROCESSING
 13623        GO TO 1475-DELETE-FINISHED.
 13624
 13625     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13626        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13627        NEXT SENTENCE
 13628     ELSE
 13629        GO TO 1475-DELETE-FINISHED.
 13630
 13631
 13632* EXEC CICS HANDLE CONDITION
 13633*         NOTFND    (1475-DELETE-FINISHED)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 248
* EL6311.cbl
 13634*         END-EXEC.
 13635*    MOVE '"$I                   ! 2 #00012543' TO DFHEIV0
 13636     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13638     MOVE X'3220233030303132353433' TO DFHEIV0(25:11)
 13639     CALL 'kxdfhei1' USING DFHEIV0
 13640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13641
 13642
 13643     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13644     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13645
 13646
 13647* EXEC CICS READ
 13648*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13649*        DATASET (FILE-ID-ERRQST)
 13650*        RIDFLD  (ERRQST-KEY)
 13651*        UPDATE
 13652*    END-EXEC.
 13653*    MOVE '&"S        EU         (   #00012550' TO DFHEIV0
 13654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13655     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13656     MOVE X'2020233030303132353530' TO DFHEIV0(25:11)
 13657     CALL 'kxdfhei1' USING DFHEIV0,
 13658           FILE-ID-ERRQST,
 13659           DFHEIV20,
 13660           DFHEIV99,
 13661           ERRQST-KEY,
 13662           DFHEIV99,
 13663           DFHEIV99,
 13664           DFHEIV99
 13665     SET ADDRESS OF AR-REQUEST-RECORD TO
 13666         DFHEIV20
 13667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13668
 13669
 13670     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13671
 13672     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13673
 13674     MOVE 'D'                      TO JP-RECORD-TYPE.
 13675     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13676
 13677
 13678* EXEC CICS DELETE
 13679*         DATASET    (FILE-ID-ERRQST)
 13680*    END-EXEC.
 13681*    MOVE '&(                    &   #00012564' TO DFHEIV0
 13682     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13684     MOVE X'2020233030303132353634' TO DFHEIV0(25:11)
 13685     CALL 'kxdfhei1' USING DFHEIV0,
 13686           FILE-ID-ERRQST,
 13687           DFHEIV99,
 13688           DFHEIV99,
 13689           DFHEIV99,
 13690           DFHEIV99
 13691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 249
* EL6311.cbl
 13692
 13693
 13694     PERFORM 8400-LOG-JOURNAL-RECORD.
 13695
 13696 1475-DELETE-FINISHED.
 13697     MOVE ZEROS                  TO EMI-ERROR.
 13698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13699     MOVE LOW-VALUES             TO EL631BI.
 13700     MOVE -1                     TO BMAINTL.
 13701     GO TO 8100-SEND-INITIAL-MAP.
 13702
 13703 1480-BATCH-HDR-NOT-FOUND.
 13704     MOVE -1                     TO BMAINTL.
 13705     MOVE ER-7450                TO EMI-ERROR.
 13706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13707     GO TO 8200-SEND-DATAONLY.
 13708
 13709 1490-RECORD-NOT-FOUND.
 13710     MOVE -1                     TO BMAINTL.
 13711     MOVE ER-7451                TO EMI-ERROR.
 13712     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13713     GO TO 8200-SEND-DATAONLY.
 13714
 13715******************************************************************
 13716*            O V E R   C H A R G E   P R O C E S S I N G         *
 13717******************************************************************
 13718 1500-UPDATE-ERNOTE.
 13719     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13720     MOVE 'A'                    TO WS-NOTE-SW
 13721     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13722     .
 13723 1500-EXIT.
 13724     EXIT.
 13725 1510-ADD-ERNOTE-REC.
 13726
 13727* EXEC CICS GETMAIN
 13728*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13729*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13730*        INITIMG (GETMAIN-SPACE)
 13731*    END-EXEC
 13732*    MOVE ',"IL                  $   #00012600' TO DFHEIV0
 13733     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13734     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13735     MOVE X'2020233030303132363030' TO DFHEIV0(25:11)
 13736     CALL 'kxdfhei1' USING DFHEIV0,
 13737           DFHEIV20,
 13738           ERNOTE-RECORD-LENGTH,
 13739           GETMAIN-SPACE
 13740     SET ADDRESS OF CERTIFICATE-NOTE TO
 13741         DFHEIV20
 13742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13743     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13744                                 TO ERNOTE-KEY
 13745
 13746* EXEC CICS READ
 13747*       DATASET    (FILE-ID-ERNOTE)
 13748*       RIDFLD     (ERNOTE-KEY)
 13749*       INTO       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 250
* EL6311.cbl
 13750*       RESP       (WS-RESPONSE)
 13751*       UPDATE
 13752*    END-EXEC
 13753     MOVE LENGTH OF
 13754      CERTIFICATE-NOTE
 13755       TO DFHEIV11
 13756*    MOVE '&"IL       EU         (  N#00012607' TO DFHEIV0
 13757     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13758     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13759     MOVE X'204E233030303132363037' TO DFHEIV0(25:11)
 13760     CALL 'kxdfhei1' USING DFHEIV0,
 13761           FILE-ID-ERNOTE,
 13762           CERTIFICATE-NOTE,
 13763           DFHEIV11,
 13764           ERNOTE-KEY,
 13765           DFHEIV99,
 13766           DFHEIV99,
 13767           DFHEIV99
 13768     MOVE EIBRESP  TO WS-RESPONSE
 13769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13770     IF RESP-NORMAL
 13771        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13772           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13773        END-IF
 13774        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13775           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13776        END-IF
 13777        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13778           (N1 > +10)
 13779           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13780           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13781        END-PERFORM
 13782        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13783          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13784
 13785* EXEC CICS UNLOCK
 13786*            DATASET    (FILE-ID-ERNOTE)
 13787*          END-EXEC
 13788*    MOVE '&*                    #   #00012628' TO DFHEIV0
 13789     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13790     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13791     MOVE X'2020233030303132363238' TO DFHEIV0(25:11)
 13792     CALL 'kxdfhei1' USING DFHEIV0,
 13793           FILE-ID-ERNOTE,
 13794           DFHEIV99
 13795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13796        ELSE
 13797          PERFORM VARYING N1 FROM +1 BY +1
 13798           UNTIL (N1 > +10)
 13799           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13800          END-PERFORM
 13801          IF (N1 < +11)
 13802            IF N1 >= CN-BILLING-START-LINE-NO AND
 13803              N1 <= CN-BILLING-END-LINE-NO
 13804              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13805                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13806              ELSE
 13807                 MOVE WS-VA-NO-COMM-MESS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 251
* EL6311.cbl
 13808                                    TO CN-LINE (N1)
 13809              END-IF
 13810            ELSE
 13811              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13812               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13813                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13814                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13815                ELSE
 13816                  MOVE WS-VA-NO-COMM-MESS
 13817                                    TO CN-LINE (N1)
 13818                END-IF
 13819                MOVE N1             TO CN-BILLING-END-LINE-NO
 13820              ELSE
 13821                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13822                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13823                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13824                  ELSE
 13825                     MOVE WS-VA-NO-COMM-MESS
 13826                                    TO CN-LINE (N1)
 13827                  END-IF
 13828                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13829                                      CN-BILLING-START-LINE-NO
 13830                ELSE
 13831                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13832                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13833                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13834                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13835                     ELSE
 13836                       MOVE WS-VA-NO-COMM-MESS
 13837                                    TO CN-LINE (N1)
 13838                     END-IF
 13839                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13840                  ELSE
 13841                     PERFORM 1700-SQUEEZE-IT-IN
 13842                                 THRU 1700-EXIT
 13843                  END-IF
 13844                END-IF
 13845              END-IF
 13846            END-IF
 13847            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13848            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13849            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13850
 13851* EXEC CICS REWRITE
 13852*              DATASET    (FILE-ID-ERNOTE)
 13853*              FROM       (CERTIFICATE-NOTE)
 13854*              RESP       (WS-RESPONSE)
 13855*           END-EXEC
 13856     MOVE LENGTH OF
 13857      CERTIFICATE-NOTE
 13858       TO DFHEIV11
 13859*    MOVE '&& L                  %  N#00012685' TO DFHEIV0
 13860     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13861     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13862     MOVE X'204E233030303132363835' TO DFHEIV0(25:11)
 13863     CALL 'kxdfhei1' USING DFHEIV0,
 13864           FILE-ID-ERNOTE,
 13865           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 252
* EL6311.cbl
 13866           DFHEIV11,
 13867           DFHEIV99
 13868     MOVE EIBRESP  TO WS-RESPONSE
 13869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13870          END-IF
 13871        END-IF
 13872     ELSE
 13873        MOVE SPACES              TO CERTIFICATE-NOTE
 13874        MOVE 'CN'                TO CN-RECORD-ID
 13875        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13876                                 TO CN-CONTROL-PRIMARY
 13877                                    ERNOTE-KEY
 13878        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13879                                    CN-BILLING-END-LINE-NO
 13880        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13881           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13882        ELSE
 13883           MOVE WS-VA-NO-COMM-MESS
 13884                                 TO CN-LINE (1)
 13885        END-IF
 13886        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13887        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13888        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13889
 13890* EXEC CICS WRITE
 13891*          DATASET    (FILE-ID-ERNOTE)
 13892*          FROM       (CERTIFICATE-NOTE)
 13893*          RIDFLD     (ERNOTE-KEY)
 13894*          RESP       (WS-RESPONSE)
 13895*       END-EXEC
 13896     MOVE LENGTH OF
 13897      CERTIFICATE-NOTE
 13898       TO DFHEIV11
 13899*    MOVE '&$ L                  ''  N#00012709' TO DFHEIV0
 13900     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13901     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13902     MOVE X'204E233030303132373039' TO DFHEIV0(25:11)
 13903     CALL 'kxdfhei1' USING DFHEIV0,
 13904           FILE-ID-ERNOTE,
 13905           CERTIFICATE-NOTE,
 13906           DFHEIV11,
 13907           ERNOTE-KEY,
 13908           DFHEIV99,
 13909           DFHEIV99
 13910     MOVE EIBRESP  TO WS-RESPONSE
 13911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13912     END-IF
 13913     .
 13914 1510-EXIT.
 13915     EXIT.
 13916 1520-UPDATE-ELCERT.
 13917     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13918                                 TO ELCERT-KEY
 13919
 13920* EXEC CICS READ
 13921*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13922*        DATASET (FILE-ID-ELCERT)
 13923*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 253
* EL6311.cbl
 13924*        UPDATE
 13925*        RESP    (WS-RESPONSE)
 13926*    END-EXEC
 13927*    MOVE '&"S        EU         (  N#00012722' TO DFHEIV0
 13928     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13929     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13930     MOVE X'204E233030303132373232' TO DFHEIV0(25:11)
 13931     CALL 'kxdfhei1' USING DFHEIV0,
 13932           FILE-ID-ELCERT,
 13933           DFHEIV20,
 13934           DFHEIV99,
 13935           ELCERT-KEY,
 13936           DFHEIV99,
 13937           DFHEIV99,
 13938           DFHEIV99
 13939     SET ADDRESS OF CERTIFICATE-MASTER TO
 13940         DFHEIV20
 13941     MOVE EIBRESP  TO WS-RESPONSE
 13942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13943     IF RESP-NORMAL
 13944        IF WS-NOTE-SW = 'A'
 13945           IF CM-NOTE-SW = ' '
 13946              MOVE '2'             TO CM-NOTE-SW
 13947           ELSE
 13948             IF CM-NOTE-SW = '1'
 13949                MOVE '3'           TO CM-NOTE-SW
 13950             ELSE
 13951               IF CM-NOTE-SW = '4'
 13952                  MOVE '6'         TO CM-NOTE-SW
 13953               ELSE
 13954                 IF CM-NOTE-SW = '5'
 13955                    MOVE '7'       TO CM-NOTE-SW
 13956                 END-IF
 13957               END-IF
 13958             END-IF
 13959           END-IF
 13960        ELSE
 13961           IF CM-NOTE-SW = '2'
 13962              MOVE ' '             TO CM-NOTE-SW
 13963           ELSE
 13964             IF CM-NOTE-SW = '3'
 13965                MOVE '1'           TO CM-NOTE-SW
 13966             ELSE
 13967               IF CM-NOTE-SW = '6'
 13968                  MOVE '4'         TO CM-NOTE-SW
 13969               ELSE
 13970                 IF CM-NOTE-SW = '7'
 13971                    MOVE '5'       TO CM-NOTE-SW
 13972                 END-IF
 13973               END-IF
 13974             END-IF
 13975           END-IF
 13976        END-IF
 13977
 13978* EXEC CICS REWRITE
 13979*          DATASET    (FILE-ID-ELCERT)
 13980*          FROM       (CERTIFICATE-MASTER)
 13981*          RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 254
* EL6311.cbl
 13982*       END-EXEC
 13983     MOVE LENGTH OF
 13984      CERTIFICATE-MASTER
 13985       TO DFHEIV11
 13986*    MOVE '&& L                  %  N#00012763' TO DFHEIV0
 13987     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13988     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13989     MOVE X'204E233030303132373633' TO DFHEIV0(25:11)
 13990     CALL 'kxdfhei1' USING DFHEIV0,
 13991           FILE-ID-ELCERT,
 13992           CERTIFICATE-MASTER,
 13993           DFHEIV11,
 13994           DFHEIV99
 13995     MOVE EIBRESP  TO WS-RESPONSE
 13996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13997        IF RESP-NORMAL
 13998           CONTINUE
 13999        ELSE
 14000           MOVE WS-RESPONSE TO EMI-ERROR
 14001           PERFORM 9900-ERROR-FORMAT
 14002                                 THRU 9900-EXIT
 14003           GO TO 8200-SEND-DATAONLY
 14004        END-IF
 14005     ELSE
 14006        MOVE -1                  TO BMAINTL
 14007        MOVE 0249                TO EMI-ERROR
 14008        PERFORM 9900-ERROR-FORMAT
 14009                                 THRU 9900-EXIT
 14010        GO TO 8200-SEND-DATAONLY
 14011     END-IF
 14012     .
 14013 1520-EXIT.
 14014     EXIT.
 14015 1600-UPDATE-ERPYAJ.
 14016     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14017                                 THRU 1610-EXIT
 14018     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14019                                 THRU 1620-EXIT
 14020     .
 14021 1600-EXIT.
 14022     EXIT.
 14023 1610-ADD-ERPYAJ-BANK-REC.
 14024
 14025* EXEC CICS GETMAIN
 14026*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14027*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14028*        INITIMG (GETMAIN-SPACE)
 14029*    END-EXEC
 14030*    MOVE ',"IL                  $   #00012795' TO DFHEIV0
 14031     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14032     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14033     MOVE X'2020233030303132373935' TO DFHEIV0(25:11)
 14034     CALL 'kxdfhei1' USING DFHEIV0,
 14035           DFHEIV20,
 14036           ERPYAJ-RECORD-LENGTH,
 14037           GETMAIN-SPACE
 14038     SET ADDRESS OF PENDING-PAY-ADJ TO
 14039         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 255
* EL6311.cbl
 14040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14041     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14042     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14043     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14044     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14045     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14046     MOVE +10                    TO ERPYAJ-SEQ-NO
 14047     MOVE 'R'                    TO ERPYAJ-TYPE
 14048     IF REVERSAL
 14049        MOVE 'C'                 TO ERPYAJ-TYPE
 14050     END-IF
 14051     MOVE SPACES                 TO PENDING-PAY-ADJ
 14052     MOVE 'PY'                   TO PY-RECORD-ID
 14053     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14054     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14055     IF REVERSAL
 14056        MOVE PB-I-DCC-OVER-CHG-AMT
 14057                                 TO PY-ENTRY-AMT
 14058     END-IF
 14059     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14060                                    PY-INPUT-DT
 14061*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14062*                                   PY-INPUT-DT
 14063     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14064     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14065     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14066     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14067     IF PB-CARRIER = '2'
 14068        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14069     ELSE
 14070        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14071     END-IF
 14072     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14073                                    PY-BILLED-DATE
 14074                                    PY-AR-DATE
 14075                                    PY-REPORTED-DT
 14076                                    PY-CHECK-WRITTEN-DT
 14077     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14078                                    PY-CHECK-QUE-SEQUENCE
 14079     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14080     PERFORM WITH TEST AFTER
 14081        UNTIL (NOT RESP-DUPKEY)
 14082           AND (NOT RESP-DUPREC)
 14083
 14084* EXEC CICS WRITE
 14085*          DATASET    (FILE-ID-ERPYAJ)
 14086*          FROM       (PENDING-PAY-ADJ)
 14087*          RIDFLD     (ERPYAJ-KEY)
 14088*          RESP       (WS-RESPONSE)
 14089*       END-EXEC
 14090     MOVE LENGTH OF
 14091      PENDING-PAY-ADJ
 14092       TO DFHEIV11
 14093*    MOVE '&$ L                  ''  N#00012842' TO DFHEIV0
 14094     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14095     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14096     MOVE X'204E233030303132383432' TO DFHEIV0(25:11)
 14097     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 256
* EL6311.cbl
 14098           FILE-ID-ERPYAJ,
 14099           PENDING-PAY-ADJ,
 14100           DFHEIV11,
 14101           ERPYAJ-KEY,
 14102           DFHEIV99,
 14103           DFHEIV99
 14104     MOVE EIBRESP  TO WS-RESPONSE
 14105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14106        IF RESP-DUPKEY OR RESP-DUPREC
 14107           ADD +1                TO ERPYAJ-SEQ-NO
 14108           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14109        END-IF
 14110     END-PERFORM
 14111     .
 14112 1610-EXIT.
 14113     EXIT.
 14114 1620-ADD-ERPYAJ-DLR-REC.
 14115     MOVE 'C'                    TO ERPYAJ-TYPE
 14116     IF REVERSAL
 14117        MOVE 'R'                 TO ERPYAJ-TYPE
 14118     END-IF
 14119     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14120                                    ERPYAJ-ACCOUNT
 14121     ADD +1                      TO ERPYAJ-SEQ-NO
 14122     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14123     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14124     IF PB-CARRIER = '2'
 14125        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14126     ELSE
 14127        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14128     END-IF
 14129     PERFORM WITH TEST AFTER
 14130        UNTIL (NOT RESP-DUPKEY)
 14131           AND (NOT RESP-DUPREC)
 14132
 14133* EXEC CICS WRITE
 14134*          DATASET    (FILE-ID-ERPYAJ)
 14135*          FROM       (PENDING-PAY-ADJ)
 14136*          RIDFLD     (ERPYAJ-KEY)
 14137*          RESP       (WS-RESPONSE)
 14138*       END-EXEC
 14139     MOVE LENGTH OF
 14140      PENDING-PAY-ADJ
 14141       TO DFHEIV11
 14142*    MOVE '&$ L                  ''  N#00012874' TO DFHEIV0
 14143     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14145     MOVE X'204E233030303132383734' TO DFHEIV0(25:11)
 14146     CALL 'kxdfhei1' USING DFHEIV0,
 14147           FILE-ID-ERPYAJ,
 14148           PENDING-PAY-ADJ,
 14149           DFHEIV11,
 14150           ERPYAJ-KEY,
 14151           DFHEIV99,
 14152           DFHEIV99
 14153     MOVE EIBRESP  TO WS-RESPONSE
 14154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14155        IF RESP-DUPKEY OR RESP-DUPREC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 257
* EL6311.cbl
 14156           ADD +1                TO ERPYAJ-SEQ-NO
 14157           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14158        END-IF
 14159     END-PERFORM
 14160     .
 14161 1620-EXIT.
 14162     EXIT.
 14163 1700-SQUEEZE-IT-IN.
 14164     IF (N1 > CN-BILLING-END-LINE-NO)
 14165        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14166           N1 = +1
 14167           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14168           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14169              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14170                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14171              ELSE
 14172                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14173              END-IF
 14174              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14175              MOVE +2 TO N1
 14176           END-IF
 14177        END-PERFORM
 14178     ELSE
 14179        IF (N1 < CN-BILLING-START-LINE-NO)
 14180           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14181              N1 = +10
 14182              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14183              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14184                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14185                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14186                 ELSE
 14187                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14188                 END-IF
 14189                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14190                 MOVE +9 TO N1
 14191              END-IF
 14192           END-PERFORM
 14193        END-IF
 14194     END-IF
 14195     .
 14196 1700-EXIT.
 14197     EXIT.
 14198 1800-REMOVE-CERT-NOTES.
 14199     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14200                                 TO ERNOTE-KEY
 14201
 14202* EXEC CICS READ
 14203*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14204*       DATASET    (FILE-ID-ERNOTE)
 14205*       RIDFLD     (ERNOTE-KEY)
 14206*       RESP       (WS-RESPONSE)
 14207*       UPDATE
 14208*    END-EXEC
 14209*    MOVE '&"S        EU         (  N#00012926' TO DFHEIV0
 14210     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14211     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14212     MOVE X'204E233030303132393236' TO DFHEIV0(25:11)
 14213     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 258
* EL6311.cbl
 14214           FILE-ID-ERNOTE,
 14215           DFHEIV20,
 14216           DFHEIV99,
 14217           ERNOTE-KEY,
 14218           DFHEIV99,
 14219           DFHEIV99,
 14220           DFHEIV99
 14221     SET ADDRESS OF CERTIFICATE-NOTE TO
 14222         DFHEIV20
 14223     MOVE EIBRESP  TO WS-RESPONSE
 14224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14225     IF RESP-NORMAL
 14226        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14227           (N1 > +10)
 14228           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14229           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14230        END-PERFORM
 14231        IF N1 < +11
 14232           MOVE SPACES              TO CN-LINE (N1)
 14233           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14234              N1 <= CN-BILLING-END-LINE-NO
 14235              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14236              IF CN-BILLING-END-LINE-NO <
 14237                               CN-BILLING-START-LINE-NO
 14238                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14239                                     CN-BILLING-START-LINE-NO
 14240              END-IF
 14241              PERFORM 1820-SQUEEZE-ERNOTE
 14242                                  THRU 1820-EXIT
 14243           END-IF
 14244           IF CN-LINES = SPACES
 14245
 14246* EXEC CICS DELETE
 14247*                DATASET    (FILE-ID-ERNOTE)
 14248*                RESP       (WS-RESPONSE)
 14249*             END-EXEC
 14250*    MOVE '&(                    &  N#00012953' TO DFHEIV0
 14251     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14252     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14253     MOVE X'204E233030303132393533' TO DFHEIV0(25:11)
 14254     CALL 'kxdfhei1' USING DFHEIV0,
 14255           FILE-ID-ERNOTE,
 14256           DFHEIV99,
 14257           DFHEIV99,
 14258           DFHEIV99,
 14259           DFHEIV99
 14260     MOVE EIBRESP  TO WS-RESPONSE
 14261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14262              IF RESP-NORMAL
 14263                 MOVE 'D'        TO WS-NOTE-SW
 14264                 PERFORM 1520-UPDATE-ELCERT
 14265                                 THRU 1520-EXIT
 14266              END-IF
 14267           ELSE
 14268
 14269* EXEC CICS REWRITE
 14270*                DATASET    (FILE-ID-ERNOTE)
 14271*                FROM       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 259
* EL6311.cbl
 14272*                RESP       (WS-RESPONSE)
 14273*             END-EXEC
 14274     MOVE LENGTH OF
 14275      CERTIFICATE-NOTE
 14276       TO DFHEIV11
 14277*    MOVE '&& L                  %  N#00012963' TO DFHEIV0
 14278     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14279     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14280     MOVE X'204E233030303132393633' TO DFHEIV0(25:11)
 14281     CALL 'kxdfhei1' USING DFHEIV0,
 14282           FILE-ID-ERNOTE,
 14283           CERTIFICATE-NOTE,
 14284           DFHEIV11,
 14285           DFHEIV99
 14286     MOVE EIBRESP  TO WS-RESPONSE
 14287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14288           END-IF
 14289        END-IF
 14290     END-IF
 14291     .
 14292 1800-EXIT.
 14293     EXIT.
 14294 1820-SQUEEZE-ERNOTE.
 14295     MOVE CN-BILLING-START-LINE-NO TO N2
 14296     IF N2 = 0
 14297         MOVE +1                 TO N2
 14298     END-IF
 14299     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14300        (N1 > +9)
 14301        IF CN-LINE (N1) = SPACES
 14302           MOVE CN-LINE (N1 + +1)
 14303                                 TO CN-LINE (N1)
 14304           MOVE SPACES           TO CN-LINE (N1 + +1)
 14305        END-IF
 14306     END-PERFORM
 14307     .
 14308 1820-EXIT.
 14309     EXIT.
 14310 1900-DELETE-ERPYAJ.
 14311     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14312     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14313     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14314     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14315     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14316     MOVE +10                    TO ERPYAJ-SEQ-NO
 14317     MOVE 'R'                    TO ERPYAJ-TYPE
 14318     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14319
 14320* EXEC CICS STARTBR
 14321*       DATASET    (FILE-ID-ERPYAJ)
 14322*       RIDFLD     (ERPYAJ-KEY)
 14323*       RESP       (WS-RESPONSE)
 14324*    END-EXEC
 14325     MOVE 0
 14326       TO DFHEIV11
 14327*    MOVE '&,         G          &  N#00012999' TO DFHEIV0
 14328     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14329     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 260
* EL6311.cbl
 14330     MOVE X'204E233030303132393939' TO DFHEIV0(25:11)
 14331     CALL 'kxdfhei1' USING DFHEIV0,
 14332           FILE-ID-ERPYAJ,
 14333           ERPYAJ-KEY,
 14334           DFHEIV99,
 14335           DFHEIV11,
 14336           DFHEIV99
 14337     MOVE EIBRESP  TO WS-RESPONSE
 14338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14339     IF RESP-NORMAL
 14340        CONTINUE
 14341     ELSE
 14342        GO TO 1900-GET-DEALER
 14343     END-IF
 14344     .
 14345 1900-READNEXT-ERPYAJ-B.
 14346*  GET THE BANK ERPYAJ RECORD
 14347
 14348* EXEC CICS READNEXT
 14349*       DATASET    (FILE-ID-ERPYAJ)
 14350*       RIDFLD     (ERPYAJ-KEY)
 14351*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14352*       RESP       (WS-RESPONSE)
 14353*    END-EXEC
 14354     MOVE 0
 14355       TO DFHEIV11
 14356*    MOVE '&.S                   )  N#00013012' TO DFHEIV0
 14357     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14358     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14359     MOVE X'204E233030303133303132' TO DFHEIV0(25:11)
 14360     CALL 'kxdfhei1' USING DFHEIV0,
 14361           FILE-ID-ERPYAJ,
 14362           DFHEIV20,
 14363           DFHEIV99,
 14364           ERPYAJ-KEY,
 14365           DFHEIV99,
 14366           DFHEIV11,
 14367           DFHEIV99,
 14368           DFHEIV99
 14369     SET ADDRESS OF PENDING-PAY-ADJ TO
 14370         DFHEIV20
 14371     MOVE EIBRESP  TO WS-RESPONSE
 14372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14373     IF RESP-NORMAL
 14374        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14375           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14376              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14377                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14378
 14379* EXEC CICS READ
 14380*                   DATASET    (FILE-ID-ERPYAJ)
 14381*                   RIDFLD     (ERPYAJ-KEY)
 14382*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14383*                   RESP       (WS-RESPONSE)
 14384*                   UPDATE
 14385*                END-EXEC
 14386*    MOVE '&"S        EU         (  N#00013023' TO DFHEIV0
 14387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 261
* EL6311.cbl
 14388     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14389     MOVE X'204E233030303133303233' TO DFHEIV0(25:11)
 14390     CALL 'kxdfhei1' USING DFHEIV0,
 14391           FILE-ID-ERPYAJ,
 14392           DFHEIV20,
 14393           DFHEIV99,
 14394           ERPYAJ-KEY,
 14395           DFHEIV99,
 14396           DFHEIV99,
 14397           DFHEIV99
 14398     SET ADDRESS OF PENDING-PAY-ADJ TO
 14399         DFHEIV20
 14400     MOVE EIBRESP  TO WS-RESPONSE
 14401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14402                 IF RESP-NORMAL
 14403
 14404* EXEC CICS DELETE
 14405*                      DATASET   (FILE-ID-ERPYAJ)
 14406*                      RESP      (WS-RESPONSE)
 14407*                   END-EXEC
 14408*    MOVE '&(                    &  N#00013031' TO DFHEIV0
 14409     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14410     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14411     MOVE X'204E233030303133303331' TO DFHEIV0(25:11)
 14412     CALL 'kxdfhei1' USING DFHEIV0,
 14413           FILE-ID-ERPYAJ,
 14414           DFHEIV99,
 14415           DFHEIV99,
 14416           DFHEIV99,
 14417           DFHEIV99
 14418     MOVE EIBRESP  TO WS-RESPONSE
 14419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14420                 END-IF
 14421              ELSE
 14422                 SET REVERSAL    TO TRUE
 14423                 PERFORM 1600-UPDATE-ERPYAJ
 14424                                 THRU 1600-EXIT
 14425                 GO TO 1900-EXIT
 14426              END-IF
 14427           ELSE
 14428              GO TO 1900-READNEXT-ERPYAJ-B
 14429           END-IF
 14430        END-IF
 14431
 14432* EXEC CICS ENDBR
 14433*          DATASET   (FILE-ID-ERPYAJ)
 14434*       END-EXEC
 14435     MOVE 0
 14436       TO DFHEIV11
 14437*    MOVE '&2                    $   #00013046' TO DFHEIV0
 14438     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14440     MOVE X'2020233030303133303436' TO DFHEIV0(25:11)
 14441     CALL 'kxdfhei1' USING DFHEIV0,
 14442           FILE-ID-ERPYAJ,
 14443           DFHEIV11,
 14444           DFHEIV99
 14445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 262
* EL6311.cbl
 14446     END-IF
 14447     .
 14448 1900-GET-DEALER.
 14449     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14450     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14451     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14452     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14453     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14454     MOVE +10                    TO ERPYAJ-SEQ-NO
 14455     MOVE 'C'                    TO ERPYAJ-TYPE
 14456     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14457
 14458* EXEC CICS STARTBR
 14459*       DATASET    (FILE-ID-ERPYAJ)
 14460*       RIDFLD     (ERPYAJ-KEY)
 14461*       RESP       (WS-RESPONSE)
 14462*    END-EXEC
 14463     MOVE 0
 14464       TO DFHEIV11
 14465*    MOVE '&,         G          &  N#00013060' TO DFHEIV0
 14466     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14467     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14468     MOVE X'204E233030303133303630' TO DFHEIV0(25:11)
 14469     CALL 'kxdfhei1' USING DFHEIV0,
 14470           FILE-ID-ERPYAJ,
 14471           ERPYAJ-KEY,
 14472           DFHEIV99,
 14473           DFHEIV11,
 14474           DFHEIV99
 14475     MOVE EIBRESP  TO WS-RESPONSE
 14476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14477     IF RESP-NORMAL
 14478        CONTINUE
 14479     ELSE
 14480        GO TO 1900-EXIT
 14481     END-IF
 14482     .
 14483 1900-READNEXT-ERPYAJ-D.
 14484*  GET THE DEALER ERPYAJ RECORD
 14485
 14486* EXEC CICS READNEXT
 14487*       DATASET    (FILE-ID-ERPYAJ)
 14488*       RIDFLD     (ERPYAJ-KEY)
 14489*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14490*       RESP       (WS-RESPONSE)
 14491*    END-EXEC
 14492     MOVE 0
 14493       TO DFHEIV11
 14494*    MOVE '&.S                   )  N#00013073' TO DFHEIV0
 14495     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14496     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14497     MOVE X'204E233030303133303733' TO DFHEIV0(25:11)
 14498     CALL 'kxdfhei1' USING DFHEIV0,
 14499           FILE-ID-ERPYAJ,
 14500           DFHEIV20,
 14501           DFHEIV99,
 14502           ERPYAJ-KEY,
 14503           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 263
* EL6311.cbl
 14504           DFHEIV11,
 14505           DFHEIV99,
 14506           DFHEIV99
 14507     SET ADDRESS OF PENDING-PAY-ADJ TO
 14508         DFHEIV20
 14509     MOVE EIBRESP  TO WS-RESPONSE
 14510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14511     IF RESP-NORMAL
 14512        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14513           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14514              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14515                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14516
 14517* EXEC CICS READ
 14518*                   DATASET    (FILE-ID-ERPYAJ)
 14519*                   RIDFLD     (ERPYAJ-KEY)
 14520*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14521*                   RESP       (WS-RESPONSE)
 14522*                   UPDATE
 14523*                END-EXEC
 14524*    MOVE '&"S        EU         (  N#00013084' TO DFHEIV0
 14525     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14526     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14527     MOVE X'204E233030303133303834' TO DFHEIV0(25:11)
 14528     CALL 'kxdfhei1' USING DFHEIV0,
 14529           FILE-ID-ERPYAJ,
 14530           DFHEIV20,
 14531           DFHEIV99,
 14532           ERPYAJ-KEY,
 14533           DFHEIV99,
 14534           DFHEIV99,
 14535           DFHEIV99
 14536     SET ADDRESS OF PENDING-PAY-ADJ TO
 14537         DFHEIV20
 14538     MOVE EIBRESP  TO WS-RESPONSE
 14539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14540                 IF RESP-NORMAL
 14541
 14542* EXEC CICS DELETE
 14543*                      DATASET   (FILE-ID-ERPYAJ)
 14544*                      RESP      (WS-RESPONSE)
 14545*                   END-EXEC
 14546*    MOVE '&(                    &  N#00013092' TO DFHEIV0
 14547     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14548     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14549     MOVE X'204E233030303133303932' TO DFHEIV0(25:11)
 14550     CALL 'kxdfhei1' USING DFHEIV0,
 14551           FILE-ID-ERPYAJ,
 14552           DFHEIV99,
 14553           DFHEIV99,
 14554           DFHEIV99,
 14555           DFHEIV99
 14556     MOVE EIBRESP  TO WS-RESPONSE
 14557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14558                 END-IF
 14559              ELSE
 14560                 SET REVERSAL    TO TRUE
 14561              END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 264
* EL6311.cbl
 14562           ELSE
 14563              GO TO 1900-READNEXT-ERPYAJ-D
 14564           END-IF
 14565        END-IF
 14566
 14567* EXEC CICS ENDBR
 14568*          DATASET   (FILE-ID-ERPYAJ)
 14569*       END-EXEC
 14570     MOVE 0
 14571       TO DFHEIV11
 14572*    MOVE '&2                    $   #00013104' TO DFHEIV0
 14573     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14574     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14575     MOVE X'2020233030303133313034' TO DFHEIV0(25:11)
 14576     CALL 'kxdfhei1' USING DFHEIV0,
 14577           FILE-ID-ERPYAJ,
 14578           DFHEIV11,
 14579           DFHEIV99
 14580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14581     END-IF
 14582     .
 14583 1900-EXIT.
 14584     EXIT.
 14585******************************************************************
 14586*            C A N C E L   M A I N L I N E                       *
 14587******************************************************************
 14588
 14589 2000-CANCEL-MAINLINE.
 14590     IF PI-DISPLAY-ORIGINAL-BATCH
 14591        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14592           MOVE ER-0023             TO EMI-ERROR
 14593           MOVE -1                  TO CMAINTL
 14594           MOVE AL-UABON            TO CMAINTA
 14595           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14596           GO TO 8200-SEND-DATAONLY
 14597        ELSE
 14598           NEXT SENTENCE
 14599     ELSE
 14600        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14601           MOVE ER-0023             TO EMI-ERROR
 14602           MOVE -1                  TO CMAINTL
 14603           MOVE AL-UABON            TO CMAINTA
 14604           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14605           GO TO 8200-SEND-DATAONLY.
 14606
 14607     IF CMAINTI = 'S'
 14608        GO TO 2100-SHOW-REQUEST.
 14609
 14610     IF NOT MODIFY-CAP
 14611         MOVE 'UPDATE'       TO SM-READ
 14612         PERFORM 9995-SECURITY-VIOLATION
 14613         MOVE ER-0070        TO EMI-ERROR
 14614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14615         GO TO 8100-SEND-INITIAL-MAP.
 14616
 14617     IF CMAINTL GREATER THAN ZEROS
 14618        IF PI-PF6-FUNCTION
 14619           IF CMAINTI NOT = 'A'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 265
* EL6311.cbl
 14620              MOVE AL-UABON  TO CMAINTA
 14621              MOVE -1        TO CMAINTL
 14622              MOVE ER-2260   TO EMI-ERROR
 14623              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14624              GO TO 8200-SEND-DATAONLY.
 14625
 14626     IF CCERTNOL = ZEROS
 14627       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14628         NEXT SENTENCE
 14629     ELSE
 14630         IF CCERTNOL NOT = ZEROS
 14631             MOVE AL-UANON       TO CCERTNOA
 14632         ELSE
 14633             MOVE -1             TO CCERTNOL
 14634             MOVE  1             TO SET-CURSOR-SW
 14635             MOVE ER-2218       TO EMI-ERROR
 14636             MOVE AL-UABON       TO CCERTNOA
 14637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14638
 14639     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14640        NEXT SENTENCE
 14641     ELSE
 14642        IF CEFFDTL NOT = ZEROS
 14643           MOVE AL-UNNON         TO CEFFDTA
 14644           MOVE CEFFDTI TO DEEDIT-FIELD
 14645           PERFORM 8600-DEEDIT
 14646           MOVE 4                TO DC-OPTION-CODE
 14647           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14648           PERFORM 9700-DATE-LINK
 14649           IF NO-CONVERSION-ERROR
 14650              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14651              ELSE
 14652              MOVE -1            TO CEFFDTL
 14653              MOVE  1            TO SET-CURSOR-SW
 14654              MOVE ER-2226      TO EMI-ERROR
 14655              MOVE AL-UNBON      TO CEFFDTA
 14656              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14657          ELSE
 14658          MOVE -1                 TO CEFFDTL
 14659          MOVE  1                 TO SET-CURSOR-SW
 14660          MOVE ER-2220            TO EMI-ERROR
 14661          MOVE AL-UNBON           TO CEFFDTA
 14662          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14663
 14664     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14665
 14666     IF CCERTNOL NOT = ZEROS
 14667        MOVE CCERTNOI                TO WS-NEW-PRIME
 14668     ELSE
 14669        MOVE SPACES                  TO WS-NEW-PRIME.
 14670
 14671     IF CSUFIXL NOT = ZEROS
 14672        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14673     ELSE
 14674        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14675
 14676     IF CEFFDTL NOT = ZEROS
 14677        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 266
* EL6311.cbl
 14678     ELSE
 14679        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14680
 14681     IF CMAINTI = 'A' OR 'K' OR 'S'
 14682        NEXT SENTENCE
 14683     ELSE
 14684        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14685        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14686           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14687           WS-PB-RECORD-TYPE NOT = '2'
 14688           IF CMAINTI = 'C'
 14689              MOVE ER-2287          TO EMI-ERROR
 14690              MOVE -1               TO CCERTNOL
 14691              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14692              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14693              GO TO 8200-SEND-DATAONLY
 14694             ELSE
 14695              MOVE ER-2260          TO EMI-ERROR
 14696              MOVE -1               TO CCERTNOL
 14697              MOVE AL-UABON         TO CCERTNOA
 14698              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14699              GO TO 8200-SEND-DATAONLY.
 14700
 14701     IF CMAINTI = 'D'
 14702        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14703
 14704     IF CLSTNML GREATER THAN ZEROS
 14705         MOVE AL-UANON           TO CLSTNMA.
 14706
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 267
* EL6311.cbl
 14708
 14709******************************************************************
 14710*                                                                *
 14711*           E D I T   C A N C E L   C O V E R A G E S            *
 14712*                                                                *
 14713******************************************************************
 14714
 14715 2015-EDIT-COVERAGES.
 14716     IF CCANDT1L      GREATER THAN ZEROS OR
 14717        CREFND1L      GREATER THAN ZEROS OR
 14718        CCANDT2L      GREATER THAN ZEROS OR
 14719        CREFND2L      GREATER THAN ZEROS OR
 14720        CMTHD1L       GREATER THAN ZEROS OR
 14721        CMTHD2L       GREATER THAN ZEROS OR
 14722        CLIVESL       GREATER THAN ZEROS OR
 14723        CPAYEEL       GREATER THAN ZEROS OR
 14724        CFORCEL       GREATER THAN ZEROS OR
 14725        CBILCDL       GREATER THAN ZEROS OR
 14726        CCANREAL      GREATER THAN ZEROS
 14727            NEXT SENTENCE
 14728         ELSE
 14729            GO TO 2030-EDIT-COMPLETE.
 14730
 14731     IF CCANDT1L = ZEROS
 14732        AND (CMAINTI = 'C' OR 'K')
 14733        NEXT SENTENCE
 14734     ELSE
 14735        IF CCANDT1L      GREATER THAN ZEROS
 14736            MOVE AL-UNNON            TO CCANDT1A
 14737            IF CCANDT1I = SPACES
 14738               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14739            ELSE
 14740               MOVE CCANDT1I            TO DEEDIT-FIELD
 14741               PERFORM 8600-DEEDIT
 14742               IF DEEDIT-FIELD-V0   NUMERIC
 14743                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14744                  MOVE 4                TO DC-OPTION-CODE
 14745                  PERFORM 9700-DATE-LINK
 14746                  IF NO-CONVERSION-ERROR
 14747                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14748                  ELSE
 14749                      MOVE -1        TO CCANDT1L
 14750                      MOVE ER-2227   TO EMI-ERROR
 14751                      MOVE AL-UNBON  TO CCANDT1A
 14752                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14753               ELSE
 14754                  MOVE -1         TO CCANDT1L
 14755                  MOVE ER-2223    TO EMI-ERROR
 14756                  MOVE AL-UNBON   TO CCANDT1A
 14757                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14758        ELSE
 14759            IF CREFND1L GREATER THAN ZEROS
 14760               MOVE -1             TO CCANDT1L
 14761               MOVE ER-2222        TO EMI-ERROR
 14762               MOVE AL-UNBOF       TO CCANDT1A
 14763               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14764
 14765     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 268
* EL6311.cbl
 14766        AND (CMAINTI = 'C' OR 'K')
 14767         NEXT SENTENCE
 14768     ELSE
 14769         IF CREFND1L NOT = ZEROS
 14770            MOVE AL-UNNON        TO CREFND1A
 14771
 14772* EXEC CICS BIF DEEDIT
 14773*               FIELD  (CREFND1I)
 14774*               LENGTH (11)
 14775*           END-EXEC
 14776     MOVE 11
 14777       TO DFHEIV11
 14778*    MOVE '@"L                   #   #00013297' TO DFHEIV0
 14779     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14780     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14781     MOVE X'2020233030303133323937' TO DFHEIV0(25:11)
 14782     CALL 'kxdfhei1' USING DFHEIV0,
 14783           CREFND1I,
 14784           DFHEIV11
 14785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14786            MOVE CREFND1I        TO WS-CREFND1
 14787*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14788*           PERFORM 8600-DEEDIT
 14789*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14790            IF WS-CREFND1  = ZEROS
 14791               AND CMAINTI = 'A'
 14792             MOVE ER-2437        TO EMI-ERROR
 14793             MOVE -1             TO CREFND1L
 14794             MOVE AL-UNBON       TO CREFND1A
 14795             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14796
 14797     IF CCANREAL > +0
 14798        MOVE AL-UANON            TO CCANREAA
 14799        IF CCANREAI = 'R' OR ' '
 14800           CONTINUE
 14801        ELSE
 14802           MOVE ER-9841        TO EMI-ERROR
 14803           MOVE -1             TO CCANREAL
 14804           MOVE AL-UABON       TO CCANREAA
 14805           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14806        END-IF
 14807     END-IF
 14808     IF CMTHD1L EQUAL +0
 14809        NEXT SENTENCE
 14810     ELSE
 14811        IF CMTHD1L NOT = +0
 14812           MOVE AL-UNNON        TO CMTHD1A
 14813           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14814                         OR '5' OR '6' OR '8' OR '9'
 14815                         OR 'R' OR ' '
 14816              NEXT SENTENCE
 14817           ELSE
 14818              MOVE ER-0582        TO EMI-ERROR
 14819              MOVE -1             TO CMTHD1L
 14820              MOVE AL-UNBON       TO CMTHD1A
 14821              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14822
 14823     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 269
* EL6311.cbl
 14824        AND (CMAINTI = 'C' OR 'K')
 14825         NEXT SENTENCE
 14826     ELSE
 14827         IF CCANDT2L  GREATER THAN ZEROS
 14828             MOVE AL-UNNON       TO CCANDT2A
 14829             IF CCANDT2I = SPACES
 14830                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14831             ELSE
 14832                MOVE CCANDT2I       TO DEEDIT-FIELD
 14833                PERFORM 8600-DEEDIT
 14834                IF DEEDIT-FIELD-V0   NUMERIC
 14835                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14836                   MOVE 4                TO DC-OPTION-CODE
 14837                   PERFORM 9700-DATE-LINK
 14838                   IF NO-CONVERSION-ERROR
 14839                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14840                   ELSE
 14841                      MOVE -1       TO CCANDT2L
 14842                      MOVE ER-2227  TO EMI-ERROR
 14843                      MOVE AL-UNBON TO CCANDT2A
 14844                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14845                ELSE
 14846                   MOVE -1         TO CCANDT2L
 14847                   MOVE ER-2223    TO EMI-ERROR
 14848                   MOVE AL-UNBON   TO CCANDT2A
 14849                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14850         ELSE
 14851            IF CREFND2L GREATER THAN ZEROS
 14852               MOVE -1             TO CCANDT2L
 14853               MOVE ER-2222        TO EMI-ERROR
 14854               MOVE AL-UNBOF       TO CCANDT2A
 14855               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14856
 14857     IF CREFND2L = ZEROS
 14858        AND (CMAINTI = 'C' OR 'K')
 14859         NEXT SENTENCE
 14860     ELSE
 14861         IF CREFND2L NOT = ZEROS
 14862            MOVE AL-UNNON        TO CREFND2A
 14863
 14864* EXEC CICS BIF DEEDIT
 14865*               FIELD  (CREFND2I)
 14866*               LENGTH (11)
 14867*           END-EXEC
 14868     MOVE 11
 14869       TO DFHEIV11
 14870*    MOVE '@"L                   #   #00013378' TO DFHEIV0
 14871     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14872     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14873     MOVE X'2020233030303133333738' TO DFHEIV0(25:11)
 14874     CALL 'kxdfhei1' USING DFHEIV0,
 14875           CREFND2I,
 14876           DFHEIV11
 14877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14878            MOVE CREFND2I        TO WS-CREFND2
 14879*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14880*           PERFORM 8600-DEEDIT
 14881*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 270
* EL6311.cbl
 14882            IF WS-CREFND2  = ZEROS
 14883               AND CMAINTI = 'A'
 14884             MOVE ER-2437        TO EMI-ERROR
 14885             MOVE -1             TO CREFND2L
 14886             MOVE AL-UNBON       TO CREFND2A
 14887             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14888
 14889     IF CMTHD2L EQUAL +0
 14890        NEXT SENTENCE
 14891     ELSE
 14892        IF CMTHD2L NOT = +0
 14893           MOVE AL-UNNON        TO CMTHD2A
 14894           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14895                         OR '5' OR '6' OR '8' OR '9'
 14896                         OR ' ' OR 'R'
 14897              NEXT SENTENCE
 14898           ELSE
 14899              MOVE ER-0582        TO EMI-ERROR
 14900              MOVE -1             TO CMTHD2L
 14901              MOVE AL-UNBON       TO CMTHD2A
 14902              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14903
 14904     IF CLIVESL GREATER THAN ZEROS
 14905         MOVE CLIVESI            TO DEEDIT-FIELD
 14906         PERFORM 8600-DEEDIT
 14907         IF DEEDIT-FIELD-V0 NUMERIC
 14908             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14909             MOVE AL-UNNON       TO CLIVESA
 14910         ELSE
 14911             MOVE -1             TO CLIVESL
 14912             MOVE AL-UNBON       TO CLIVESA
 14913             MOVE ER-2223        TO EMI-ERROR
 14914             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14915
 14916     IF CFORCEL  NOT = ZEROS
 14917         IF FORCE-CAP
 14918            MOVE AL-UANON            TO CFORCEA
 14919         ELSE
 14920            MOVE ER-2945             TO EMI-ERROR
 14921            MOVE AL-UABON            TO CFORCEA
 14922            MOVE -1                  TO CFORCEL
 14923            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14924
 14925     IF CPAYEEL GREATER THAN ZEROS
 14926        MOVE AL-UANON            TO CPAYEEA.
 14927
 14928     IF CBILCDL NOT = ZEROS
 14929        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14930                             AND 'A' AND 'B' AND 'E'
 14931           MOVE ER-2225              TO EMI-ERROR
 14932           MOVE AL-UABON             TO CBILCDA
 14933           MOVE -1                   TO CBILCDL
 14934           MOVE  1                   TO SET-CURSOR-SW
 14935           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14936        ELSE
 14937           MOVE AL-UANON             TO CBILCDA.
 14938
 14939 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 271
* EL6311.cbl
 14940     IF EMI-ERROR = ZEROS
 14941         NEXT SENTENCE
 14942     ELSE
 14943         GO TO 8200-SEND-DATAONLY.
 14944
 14945     IF CMAINTI = 'A'
 14946        GO TO 2200-ADD-CANCEL-ROUTINE.
 14947
 14948     IF CMAINTI = 'C'
 14949        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14950
 14951     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14952
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 272
* EL6311.cbl
 14954
 14955******************************************************************
 14956*                                                                *
 14957*                   S H O W   C A N C E L                        *
 14958*                                                                *
 14959******************************************************************
 14960
 14961 2100-SHOW-REQUEST.
 14962     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14963
 14964     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14965        MOVE -1                  TO CMAINTL
 14966        GO TO 8200-SEND-DATAONLY.
 14967
 14968     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14969
 14970     IF CSUFIXL NOT = ZEROS
 14971        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14972       ELSE
 14973        MOVE SPACE            TO WS-NEW-SUFFIX.
 14974
 14975     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14976     PERFORM 8600-DEEDIT.
 14977     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14978     MOVE '4'                    TO DC-OPTION-CODE.
 14979     PERFORM 9700-DATE-LINK.
 14980     IF DATE-CONVERSION-ERROR
 14981        MOVE ER-0348             TO EMI-ERROR
 14982        MOVE -1                  TO CEFFDTL
 14983        MOVE AL-UABON            TO CEFFDTA
 14984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14985        GO TO 8200-SEND-DATAONLY
 14986     ELSE
 14987        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14988        MOVE AL-UANON            TO CEFFDTA
 14989        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14990
 14991     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14992
 14993     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14994        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14995        MOVE 'Y'                    TO WS-SHOW-SW
 14996        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14997           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14998        ELSE
 14999           IF PI-FILE-BROWSE
 15000              GO TO 4300-BROWSE-FILE-FORWARD
 15001           ELSE
 15002              IF PI-CSR-BROWSE
 15003                 GO TO 4200-BROWSE-CSR-FORWARD
 15004              ELSE
 15005                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15006     ELSE
 15007        GO TO 3900-RE-DISPLAY-RECORD.
 15008
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 273
* EL6311.cbl
 15010
 15011
 15012******************************************************************
 15013*                                                                *
 15014*            A D D   C A N C E L   R O U T I N E                 *
 15015*                                                                *
 15016******************************************************************
 15017
 15018 2200-ADD-CANCEL-ROUTINE.
 15019     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15020
 15021
 15022* EXEC CICS GETMAIN
 15023*        SET     (ADDRESS OF PENDING-BUSINESS)
 15024*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15025*    END-EXEC.
 15026*    MOVE '," L                  $   #00013525' TO DFHEIV0
 15027     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15028     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15029     MOVE X'2020233030303133353235' TO DFHEIV0(25:11)
 15030     CALL 'kxdfhei1' USING DFHEIV0,
 15031           DFHEIV20,
 15032           ERPNDB-RECORD-LENGTH,
 15033           DFHEIV99
 15034     SET ADDRESS OF PENDING-BUSINESS TO
 15035         DFHEIV20
 15036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15037
 15038
 15039
 15040* EXEC CICS HANDLE CONDITION
 15041*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15042*    END-EXEC.
 15043*    MOVE '"$I                   ! 3 #00013530' TO DFHEIV0
 15044     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15046     MOVE X'3320233030303133353330' TO DFHEIV0(25:11)
 15047     CALL 'kxdfhei1' USING DFHEIV0
 15048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15049
 15050
 15051     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15052     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15053     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15054
 15055
 15056* EXEC CICS READ
 15057*        INTO    (PENDING-BUSINESS)
 15058*        DATASET (FILE-ID-ERPNDB)
 15059*        RIDFLD  (ERPNDB-KEY)
 15060*    END-EXEC.
 15061     MOVE LENGTH OF
 15062      PENDING-BUSINESS
 15063       TO DFHEIV11
 15064*    MOVE '&"IL       E          (   #00013538' TO DFHEIV0
 15065     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15067     MOVE X'2020233030303133353338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 274
* EL6311.cbl
 15068     CALL 'kxdfhei1' USING DFHEIV0,
 15069           FILE-ID-ERPNDB,
 15070           PENDING-BUSINESS,
 15071           DFHEIV11,
 15072           ERPNDB-KEY,
 15073           DFHEIV99,
 15074           DFHEIV99,
 15075           DFHEIV99
 15076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15077
 15078
 15079     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15080
 15081     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15082     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15083     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15084     MOVE SPACES                 TO PENDING-BUSINESS.
 15085     MOVE 'PB'                   TO PB-RECORD-ID.
 15086     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15087     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15088     MOVE SPACES                 TO PB-CERT-SFX.
 15089     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15090     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15091                                    PB-ALT-CHG-SEQ-NO.
 15092
 15093     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15094     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15095     MOVE '2'                    TO PB-RECORD-TYPE.
 15096
 15097     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15098     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15099
 15100
 15101     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15102                                    PB-ALT-CHG-SEQ-NO
 15103                                    PB-C-LF-REF-CALC
 15104                                    PB-C-AH-REF-CALC
 15105                                    PB-C-LF-RFND-CLP
 15106                                    PB-C-AH-RFND-CLP
 15107                                    PB-CI-INSURED-AGE
 15108                                    PB-CI-LF-TERM
 15109                                    PB-CI-AH-TERM
 15110                                    PB-CI-LF-BENEFIT-CD
 15111                                    PB-CI-LF-BENEFIT-AMT
 15112                                    PB-CI-LF-ALT-BENEFIT-AMT
 15113                                    PB-CI-LF-PREMIUM-AMT
 15114                                    PB-CI-LF-ALT-PREMIUM-AMT
 15115                                    PB-CI-AH-BENEFIT-CD
 15116                                    PB-CI-AH-BENEFIT-AMT
 15117                                    PB-CI-AH-PREMIUM-AMT
 15118                                    PB-CI-PAY-FREQUENCY
 15119                                    PB-CI-LOAN-APR
 15120                                    PB-CI-LOAN-TERM
 15121                                    PB-CI-LIFE-COMMISSION
 15122                                    PB-CI-AH-COMMISSION
 15123                                    PB-CI-CURR-SEQ
 15124                                    PB-CI-AH-CANCEL-AMT
 15125                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 275
* EL6311.cbl
 15126                                    PB-CI-RATE-DEV-PCT-LF
 15127                                    PB-CI-RATE-DEV-PCT-AH
 15128                                    PB-CI-EXTENTION-DAYS
 15129                                    PB-CI-TERM-IN-DAYS
 15130                                    PB-CI-LIVES
 15131                                    PB-CI-LF-CRIT-PER
 15132                                    PB-CI-AH-CRIT-PER
 15133                                    PB-C-LF-REM-TERM
 15134                                    PB-C-AH-REM-TERM
 15135                                    PB-CHG-COUNT
 15136                                    PB-LF-BILLED-AMTS
 15137                                    PB-AH-BILLED-AMTS
 15138                                    PB-C-INT-ON-REFS
 15139*                                   PB-C-MICROFILM-NO
 15140                                    PB-CALC-TOLERANCE.
 15141
 15142     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15143                                    PB-CI-AH-SETTLEMENT-DT
 15144                                    PB-CI-DEATH-DT
 15145                                    PB-CI-LF-PRIOR-CANCEL-DT
 15146                                    PB-CI-AH-PRIOR-CANCEL-DT
 15147                                    PB-CI-ENTRY-DT
 15148                                    PB-CI-LF-EXPIRE-DT
 15149                                    PB-CI-AH-EXPIRE-DT
 15150                                    PB-CI-LOAN-1ST-PMT-DT
 15151                                    PB-C-LF-CANCEL-DT
 15152                                    PB-C-AH-CANCEL-DT
 15153                                    PB-CREDIT-ACCEPT-DT
 15154                                    PB-BILLED-DT
 15155                                    PB-ACCT-EFF-DT
 15156                                    PB-ACCT-EXP-DT.
 15157
 15158     MOVE 'X'                    TO PB-FATAL-FLAG.
 15159
 15160     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15161
 15162     IF CSUFIXL     GREATER THAN ZEROS
 15163        MOVE CSUFIXI             TO PB-CERT-SFX.
 15164
 15165*    IF CMICRNOL  GREATER  ZEROS
 15166*        IF CMICRNOI  NUMERIC
 15167*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15168*            MOVE AL-UNNON       TO  CMICRNOA
 15169*        ELSE
 15170*            MOVE -1             TO  CMICRNOL
 15171*            MOVE AL-UNBON       TO  CMICRNOA
 15172*            MOVE ER-2701        TO  EMI-ERROR
 15173*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15174
 15175     IF CLSTNML     GREATER THAN ZEROS
 15176        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15177
 15178     IF CCANREAL > ZEROS
 15179        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15180     END-IF
 15181     IF CPCYNL > ZEROS
 15182        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15183     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 276
* EL6311.cbl
 15184     IF CCANDT1L    GREATER THAN ZEROS
 15185        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15186
 15187     IF CCANDT2L    GREATER THAN ZEROS
 15188        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15189
 15190     IF CMTHD1L    GREATER THAN +0
 15191        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15192
 15193     IF CMTHD2L    GREATER THAN +0
 15194        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15195
 15196     IF CREFND1L    GREATER THAN ZEROS
 15197        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15198        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15199     ELSE
 15200        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15201
 15202     IF CREFND2L    GREATER THAN ZEROS
 15203        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15204        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15205     ELSE
 15206        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15207
 15208     IF CLIVESL     GREATER THAN ZEROS
 15209        MOVE WS-CLIVES           TO PB-C-LIVES
 15210     ELSE
 15211        MOVE ZEROS               TO PB-C-LIVES.
 15212
 15213     IF CPAYEEL     GREATER THAN ZEROS
 15214        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15215
 15216     IF CFORCEL     GREATER THAN ZEROS
 15217        MOVE CFORCEI             TO PB-FORCE-CODE.
 15218
 15219     IF CBILCDL     GREATER THAN ZEROS
 15220        MOVE CBILCDI             TO PB-RECORD-BILL.
 15221
 15222*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15223
 15224 2260-WRITE-PB-RECORD.
 15225     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15226                                    PB-INPUT-BY.
 15227     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15228     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15229                                    PB-INPUT-DT.
 15230
 15231     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15232     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15233                                    PB-CONTROL-BY-ORIG-BATCH.
 15234
 15235     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15236     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15237     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15238     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15239     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15240
 15241     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 277
* EL6311.cbl
 15242
 15243     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15244
 15245     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15246     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15247     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15248
 15249     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15250     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15251
 15252 2275-WRITE-PENDING-BUSINESS.
 15253     MOVE 'A'                    TO JP-RECORD-TYPE.
 15254     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15255     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15256     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15257
 15258
 15259* EXEC CICS HANDLE CONDITION
 15260*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15261*    END-EXEC.
 15262*    MOVE '"$%                   ! 4 #00013723' TO DFHEIV0
 15263     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15265     MOVE X'3420233030303133373233' TO DFHEIV0(25:11)
 15266     CALL 'kxdfhei1' USING DFHEIV0
 15267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15268
 15269
 15270
 15271* EXEC CICS WRITE
 15272*        DATASET (FILE-ID-ERPNDB)
 15273*        FROM    (PENDING-BUSINESS)
 15274*        RIDFLD  (PB-CONTROL-PRIMARY)
 15275*    END-EXEC.
 15276     MOVE LENGTH OF
 15277      PENDING-BUSINESS
 15278       TO DFHEIV11
 15279*    MOVE '&$ L                  ''   #00013727' TO DFHEIV0
 15280     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15281     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15282     MOVE X'2020233030303133373237' TO DFHEIV0(25:11)
 15283     CALL 'kxdfhei1' USING DFHEIV0,
 15284           FILE-ID-ERPNDB,
 15285           PENDING-BUSINESS,
 15286           DFHEIV11,
 15287           PB-CONTROL-PRIMARY,
 15288           DFHEIV99,
 15289           DFHEIV99
 15290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15291
 15292
 15293     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15294
 15295     PERFORM 8400-LOG-JOURNAL-RECORD.
 15296
 15297******************************************************************
 15298*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15299******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 278
* EL6311.cbl
 15300
 15301     display ' made it to add orig CANCEL cert '
 15302     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15303     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15304     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15305     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15306
 15307
 15308* EXEC CICS READ
 15309*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15310*        DATASET (FILE-ID-ELCERT)
 15311*        RIDFLD  (ELCERT-KEY)
 15312*        RESP    (WS-RESPONSE)
 15313*    END-EXEC.
 15314*    MOVE '&"S        E          (  N#00013747' TO DFHEIV0
 15315     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15317     MOVE X'204E233030303133373437' TO DFHEIV0(25:11)
 15318     CALL 'kxdfhei1' USING DFHEIV0,
 15319           FILE-ID-ELCERT,
 15320           DFHEIV20,
 15321           DFHEIV99,
 15322           ELCERT-KEY,
 15323           DFHEIV99,
 15324           DFHEIV99,
 15325           DFHEIV99
 15326     SET ADDRESS OF CERTIFICATE-MASTER TO
 15327         DFHEIV20
 15328     MOVE EIBRESP  TO WS-RESPONSE
 15329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15330
 15331
 15332     IF NOT RESP-NORMAL
 15333        GO TO 2276-BYPASS-CRTO
 15334     END-IF
 15335
 15336     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15337     MOVE ' '                    TO WS-ERMAIL-SW
 15338
 15339
 15340* EXEC CICS READ
 15341*       DATASET   (FILE-ID-ERMAIL)
 15342*       SET       (ADDRESS OF MAILING-DATA)
 15343*       RIDFLD    (ERMAIL-KEY)
 15344*       RESP      (WS-RESPONSE)
 15345*    END-EXEC
 15346*    MOVE '&"S        E          (  N#00013761' TO DFHEIV0
 15347     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15349     MOVE X'204E233030303133373631' TO DFHEIV0(25:11)
 15350     CALL 'kxdfhei1' USING DFHEIV0,
 15351           FILE-ID-ERMAIL,
 15352           DFHEIV20,
 15353           DFHEIV99,
 15354           ERMAIL-KEY,
 15355           DFHEIV99,
 15356           DFHEIV99,
 15357           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 279
* EL6311.cbl
 15358     SET ADDRESS OF MAILING-DATA TO
 15359         DFHEIV20
 15360     MOVE EIBRESP  TO WS-RESPONSE
 15361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15362
 15363     IF RESP-NORMAL
 15364        SET ERMAIL-FOUND TO TRUE
 15365     END-IF
 15366
 15367     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15368
 15369     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15370     MOVE 'OC'                   TO OC-RECORD-ID
 15371     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15372                                 TO OC-CONTROL-PRIMARY (1:33)
 15373     MOVE 'I'                    TO OC-RECORD-TYPE
 15374     MOVE +4096                  TO OC-KEY-SEQ-NO
 15375     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15376     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15377     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15378
 15379     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15380     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15381     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15382     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15383     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15384     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15385     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15386     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15387     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15388     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15389     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15390     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15391     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15392     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15393     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15394     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15395     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15396     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15397     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15398     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15399     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15400     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15401     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15402     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15403     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15404     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15405     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15406     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15407     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15408     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15409     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15410     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15411
 15412     IF ERMAIL-FOUND
 15413        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15414     END-IF
 15415     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 280
* EL6311.cbl
 15416        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15417                           OC-INS-AGE-DEFAULT-FLAG
 15418        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15419                           OC-JNT-AGE-DEFAULT-FLAG
 15420     END-IF
 15421     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15422     .
 15423 2275-WRITE-ELCRTO.
 15424
 15425
 15426* EXEC CICS WRITE
 15427*       DATASET   ('ELCRTO')
 15428*       FROM      (ORIGINAL-CERTIFICATE)
 15429*       RIDFLD    (OC-CONTROL-PRIMARY)
 15430*       RESP      (WS-RESPONSE)
 15431*    END-EXEC
 15432     MOVE LENGTH OF
 15433      ORIGINAL-CERTIFICATE
 15434       TO DFHEIV11
 15435     MOVE 'ELCRTO' TO DFHEIV1
 15436*    MOVE '&$ L                  ''  N#00013830' TO DFHEIV0
 15437     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15439     MOVE X'204E233030303133383330' TO DFHEIV0(25:11)
 15440     CALL 'kxdfhei1' USING DFHEIV0,
 15441           DFHEIV1,
 15442           ORIGINAL-CERTIFICATE,
 15443           DFHEIV11,
 15444           OC-CONTROL-PRIMARY,
 15445           DFHEIV99,
 15446           DFHEIV99
 15447     MOVE EIBRESP  TO WS-RESPONSE
 15448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15449
 15450     display ' just wrote 2275 ' ws-response
 15451     IF RESP-DUPKEY
 15452        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15453        GO TO 2275-WRITE-ELCRTO
 15454     ELSE
 15455        IF NOT RESP-NORMAL
 15456           MOVE -1               TO BMAINTL
 15457           MOVE ER-7450          TO EMI-ERROR
 15458           PERFORM 9900-ERROR-FORMAT
 15459                                 THRU 9900-EXIT
 15460           GO TO 8200-SEND-DATAONLY
 15461        END-IF
 15462     END-IF.
 15463
 15464 2276-BYPASS-CRTO.
 15465******************************************************************
 15466*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15467******************************************************************
 15468
 15469
 15470* EXEC CICS READ
 15471*        INTO    (PENDING-BUSINESS)
 15472*        DATASET (FILE-ID-ERPNDB)
 15473*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 281
* EL6311.cbl
 15474*        UPDATE
 15475*    END-EXEC.
 15476     MOVE LENGTH OF
 15477      PENDING-BUSINESS
 15478       TO DFHEIV11
 15479*    MOVE '&"IL       EU         (   #00013856' TO DFHEIV0
 15480     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15481     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15482     MOVE X'2020233030303133383536' TO DFHEIV0(25:11)
 15483     CALL 'kxdfhei1' USING DFHEIV0,
 15484           FILE-ID-ERPNDB,
 15485           PENDING-BUSINESS,
 15486           DFHEIV11,
 15487           ERPNDB-KEY,
 15488           DFHEIV99,
 15489           DFHEIV99,
 15490           DFHEIV99
 15491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15492
 15493
 15494     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15495     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15496     MOVE 'B'                    TO JP-RECORD-TYPE.
 15497     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15498
 15499     PERFORM 8400-LOG-JOURNAL-RECORD.
 15500
 15501     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15502
 15503
 15504* EXEC CICS REWRITE
 15505*        DATASET (FILE-ID-ERPNDB)
 15506*        FROM    (PENDING-BUSINESS)
 15507*    END-EXEC.
 15508     MOVE LENGTH OF
 15509      PENDING-BUSINESS
 15510       TO DFHEIV11
 15511*    MOVE '&& L                  %   #00013872' TO DFHEIV0
 15512     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15513     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15514     MOVE X'2020233030303133383732' TO DFHEIV0(25:11)
 15515     CALL 'kxdfhei1' USING DFHEIV0,
 15516           FILE-ID-ERPNDB,
 15517           PENDING-BUSINESS,
 15518           DFHEIV11,
 15519           DFHEIV99
 15520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15521
 15522
 15523     MOVE 'C'                    TO JP-RECORD-TYPE.
 15524     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15525
 15526     PERFORM 8400-LOG-JOURNAL-RECORD.
 15527
 15528     IF WS-ERRORS-PRESENT
 15529        GO TO 3900-RE-DISPLAY-RECORD.
 15530
 15531     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 282
* EL6311.cbl
 15532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15533     MOVE LOW-VALUES             TO EL631CI.
 15534     MOVE  -1                    TO CMAINTL.
 15535     GO TO 8100-SEND-INITIAL-MAP.
 15536
 15537 2280-BATCH-HDR-NOT-FOUND.
 15538     MOVE -1                     TO BMAINTL.
 15539     MOVE ER-7450                TO EMI-ERROR.
 15540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15541     GO TO 8200-SEND-DATAONLY.
 15542
 15543 2290-DUPLICATE-ALT-INDEX.
 15544
 15545******************************************************************
 15546*                                                                *
 15547*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15548*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15549*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15550*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15551*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15552*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15553*                                                                *
 15554******************************************************************
 15555
 15556     IF LCP-ONCTR-02 =  0
 15557         ADD 1 TO LCP-ONCTR-02
 15558        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15559
 15560     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15561
 15562     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15563         NEXT SENTENCE
 15564     ELSE
 15565         ADD +1 TO PB-BATCH-SEQ-NO
 15566                   PB-CSR-BATCH-SEQ-NO
 15567         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15568         GO TO 2275-WRITE-PENDING-BUSINESS.
 15569
 15570     MOVE -1                     TO CCERTNOL.
 15571     MOVE AL-UABON               TO CCERTNOA.
 15572     MOVE AL-UNBON               TO CEFFDTA.
 15573
 15574     MOVE 1                      TO EMI-SUB
 15575                                    EMI-SWITCH1
 15576                                    EMI-SWITCH-AREA-1
 15577                                    EMI-SWITCH-AREA-2.
 15578
 15579     MOVE SPACES                 TO EMI-ERROR-LINES.
 15580
 15581
 15582* EXEC CICS SYNCPOINT ROLLBACK
 15583*    END-EXEC.
 15584*    MOVE '6"R                   !   #00013935' TO DFHEIV0
 15585     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15587     MOVE X'2020233030303133393335' TO DFHEIV0(25:11)
 15588     CALL 'kxdfhei1' USING DFHEIV0
 15589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 283
* EL6311.cbl
 15590
 15591
 15592     MOVE ER-2247                TO EMI-ERROR.
 15593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15594     GO TO 8200-SEND-DATAONLY.
 15595
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 284
* EL6311.cbl
 15597
 15598******************************************************************
 15599*                                                                *
 15600*          C H A N G E   C A N C E L   R O U T I N E             *
 15601*                                                                *
 15602******************************************************************
 15603
 15604***************************************************************
 15605*                                                             *
 15606*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15607*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15608*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15609*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15610*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15611*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15612*     5. LINK TO THE EDIT ROUTINE.                            *
 15613*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15614*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15615*              THE EDIT ROUTINE.                              *
 15616*     7. REWRITE THE NEW ISSUE                                *
 15617*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15618*                                                             *
 15619***************************************************************
 15620 2300-CHANGE-CANCEL-ROUTINE.
 15621     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15622
 15623     IF CCHGL NOT = ZEROS
 15624        MOVE ER-2196             TO EMI-ERROR
 15625        MOVE AL-UABON            TO CMAINTA
 15626        MOVE -1                  TO CMAINTL
 15627        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15628        GO TO 8200-SEND-DATAONLY.
 15629
 15630     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15631
 15632     IF CSUFIXL NOT = ZEROS
 15633        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15634     ELSE
 15635        MOVE SPACE               TO WS-NEW-SUFFIX.
 15636
 15637     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15638     PERFORM 8600-DEEDIT.
 15639     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15640     MOVE '4'                    TO DC-OPTION-CODE.
 15641
 15642     PERFORM 9700-DATE-LINK.
 15643
 15644     IF DATE-CONVERSION-ERROR
 15645        MOVE ER-0348             TO EMI-ERROR
 15646        MOVE -1                  TO CEFFDTL
 15647        MOVE AL-UABON            TO CEFFDTA
 15648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15649        GO TO 8200-SEND-DATAONLY
 15650     ELSE
 15651        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15652        MOVE AL-UANON            TO CEFFDTA
 15653        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15654
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 285
* EL6311.cbl
 15655 2325-PROCESS-CANCEL-CHANGES.
 15656
 15657* EXEC CICS HANDLE CONDITION
 15658*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15659*    END-EXEC.
 15660*    MOVE '"$I                   ! 5 #00014002' TO DFHEIV0
 15661     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15663     MOVE X'3520233030303134303032' TO DFHEIV0(25:11)
 15664     CALL 'kxdfhei1' USING DFHEIV0
 15665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15666
 15667
 15668     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15669     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15670     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15671
 15672
 15673* EXEC CICS GETMAIN
 15674*        SET      (ADDRESS OF PENDING-BUSINESS)
 15675*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15676*        INITIMG  (GETMAIN-SPACE)
 15677*     END-EXEC.
 15678*    MOVE ',"IL                  $   #00014010' TO DFHEIV0
 15679     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15680     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15681     MOVE X'2020233030303134303130' TO DFHEIV0(25:11)
 15682     CALL 'kxdfhei1' USING DFHEIV0,
 15683           DFHEIV20,
 15684           ERPNDB-RECORD-LENGTH,
 15685           GETMAIN-SPACE
 15686     SET ADDRESS OF PENDING-BUSINESS TO
 15687         DFHEIV20
 15688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15689
 15690
 15691
 15692* EXEC CICS READ
 15693*        INTO    (PENDING-BUSINESS)
 15694*        DATASET (FILE-ID-ERPNDB)
 15695*        RIDFLD  (ERPNDB-KEY)
 15696*    END-EXEC.
 15697     MOVE LENGTH OF
 15698      PENDING-BUSINESS
 15699       TO DFHEIV11
 15700*    MOVE '&"IL       E          (   #00014016' TO DFHEIV0
 15701     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15703     MOVE X'2020233030303134303136' TO DFHEIV0(25:11)
 15704     CALL 'kxdfhei1' USING DFHEIV0,
 15705           FILE-ID-ERPNDB,
 15706           PENDING-BUSINESS,
 15707           DFHEIV11,
 15708           ERPNDB-KEY,
 15709           DFHEIV99,
 15710           DFHEIV99,
 15711           DFHEIV99
 15712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 286
* EL6311.cbl
 15713
 15714
 15715     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15716
 15717
 15718* EXEC CICS HANDLE CONDITION
 15719*         NOTFND     (2385-REC-NOT-FOUND)
 15720*    END-EXEC.
 15721*    MOVE '"$I                   ! 6 #00014024' TO DFHEIV0
 15722     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15724     MOVE X'3620233030303134303234' TO DFHEIV0(25:11)
 15725     CALL 'kxdfhei1' USING DFHEIV0
 15726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15727
 15728
 15729**********************************************************
 15730*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15731*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15732**********************************************************
 15733
 15734
 15735* EXEC CICS READ
 15736*        DATASET (FILE-ID-ERPNDB)
 15737*        INTO    (PENDING-BUSINESS)
 15738*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15739*    END-EXEC.
 15740     MOVE LENGTH OF
 15741      PENDING-BUSINESS
 15742       TO DFHEIV11
 15743*    MOVE '&"IL       E          (   #00014033' TO DFHEIV0
 15744     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15746     MOVE X'2020233030303134303333' TO DFHEIV0(25:11)
 15747     CALL 'kxdfhei1' USING DFHEIV0,
 15748           FILE-ID-ERPNDB,
 15749           PENDING-BUSINESS,
 15750           DFHEIV11,
 15751           PI-PREV-CONTROL-PRIMARY,
 15752           DFHEIV99,
 15753           DFHEIV99,
 15754           DFHEIV99
 15755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15756
 15757
 15758********** DO NOT ALLOW CHANGES IF THRU A/R
 15759     IF BMAINTI = 'C'
 15760         IF PB-EL860-INTERNAL-PROCESS
 15761             MOVE ER-4005          TO EMI-ERROR
 15762             MOVE -1               TO BMAINTL
 15763             MOVE AL-UABON         TO BMAINTA
 15764             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15765             GO TO 8200-SEND-DATAONLY.
 15766**********
 15767
 15768     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15769        MOVE -1                 TO CMAINTL
 15770        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 287
* EL6311.cbl
 15771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15772        GO TO 8200-SEND-DATAONLY.
 15773
 15774     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15775        MOVE ER-2196             TO EMI-ERROR
 15776        MOVE AL-UABON            TO CMAINTA
 15777        MOVE -1                  TO CMAINTL
 15778        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15779        GO TO 8200-SEND-DATAONLY.
 15780     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15781
 15782     IF PB-BILLED-DT = LOW-VALUES AND
 15783        PB-CHG-COUNT = ZEROS
 15784        NEXT SENTENCE
 15785     ELSE
 15786        IF (CREFND1L GREATER THAN ZEROS AND
 15787            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15788           OR
 15789           (CREFND2L GREATER THAN ZEROS AND
 15790            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15791           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15792     if ((crefnd1l <> zeros)
 15793        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15794                      or
 15795        ((crefnd2l <> zeros)
 15796        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15797        continue
 15798     else
 15799        go to 2330-continue-change
 15800     end-if
 15801
 15802     move zeros                  to ws-check-amts
 15803     move ' '                    to ws-stop-sw
 15804                                    ws-check-sw
 15805                                    ws-any-check-sw
 15806                                    ws-proc-check-sw
 15807                                    ws-chek-browse-sw
 15808
 15809     perform 2500-browse-checks  thru 2500-exit
 15810
 15811     if i-have-processed-checks
 15812        or i-have-checks
 15813        continue
 15814     else
 15815        go to 2330-continue-change
 15816     end-if
 15817
 15818     if crefnd1l <> zeros
 15819        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15820        move ws-crefnd1 to ws-new-ref-total
 15821     else
 15822        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15823     end-if
 15824     if crefnd2l <> zeros
 15825        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15826        compute ws-new-ref-total = ws-new-ref-total +
 15827           ws-crefnd2
 15828     else
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 288
* EL6311.cbl
 15829        compute ws-new-ref-total = ws-new-ref-total +
 15830           pb-c-ah-cancel-amt
 15831     end-if
 15832
 15833     if zeros = (ws-lf-diff + ws-ah-diff)
 15834        move er-3449             to emi-error
 15835        perform 9900-error-format thru 9900-exit
 15836        go to 2330-continue-change
 15837     end-if
 15838
 15839     if (ws-new-ref-total < ws-check-amts)
 15840        and (pb-c-refund-sw = 'Y')
 15841        move er-3447             to emi-error
 15842        perform 9900-error-format thru 9900-exit
 15843        move al-uabon            to cmainta
 15844        move -1                  to cmaintl
 15845        go to 8200-send-dataonly
 15846     end-if
 15847
 15848     if (ws-new-ref-total > ws-check-amts)
 15849        and (ws-check-amts not = zeros)
 15850        move er-3448             to emi-error
 15851        move al-uabon            to crefnd1a
 15852                                    crefnd2a
 15853        perform 9900-error-format thru 9900-exit
 15854     end-if
 15855
 15856*     if (ws-lf-diff + ws-ah-diff) < zeros
 15857*        move er-3447             to emi-error
 15858*        perform 9900-error-format thru 9900-exit
 15859*        move al-uabon            to cmainta
 15860*        move -1                  to cmaintl
 15861*        go to 8200-send-dataonly
 15862*     end-if
 15863     .
 15864 2330-continue-change.
 15865
 15866
 15867* EXEC CICS READ
 15868*        DATASET (FILE-ID-ERPNDB)
 15869*        INTO    (PENDING-BUSINESS)
 15870*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15871*        UPDATE
 15872*    END-EXEC.
 15873     MOVE LENGTH OF
 15874      PENDING-BUSINESS
 15875       TO DFHEIV11
 15876*    MOVE '&"IL       EU         (   #00014147' TO DFHEIV0
 15877     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15878     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15879     MOVE X'2020233030303134313437' TO DFHEIV0(25:11)
 15880     CALL 'kxdfhei1' USING DFHEIV0,
 15881           FILE-ID-ERPNDB,
 15882           PENDING-BUSINESS,
 15883           DFHEIV11,
 15884           PI-PREV-CONTROL-PRIMARY,
 15885           DFHEIV99,
 15886           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 289
* EL6311.cbl
 15887           DFHEIV99
 15888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15889
 15890
 15891     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15892     MOVE 'B'                    TO JP-RECORD-TYPE
 15893     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15894     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15895
 15896     PERFORM 8400-LOG-JOURNAL-RECORD.
 15897
 15898     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15899          PB-CHG-COUNT NOT = ZEROS
 15900        IF (CREFND1L GREATER THAN ZEROS AND
 15901            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15902           OR
 15903           (CREFND2L GREATER THAN ZEROS AND
 15904            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15905            ADD +1                      TO PB-CHG-COUNT
 15906            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15907
 15908*    IF CMICRNOL  GREATER  ZEROS
 15909*        IF CMICRNOI  NUMERIC
 15910*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15911*            MOVE AL-UNNON       TO  CMICRNOA
 15912*        ELSE
 15913*            MOVE -1             TO  CMICRNOL
 15914*            MOVE AL-UNBON       TO  CMICRNOA
 15915*            MOVE ER-2701        TO  EMI-ERROR
 15916*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15917
 15918     IF CSUFIXL GREATER THAN ZEROS
 15919        MOVE CSUFIXI             TO PB-CERT-SFX.
 15920
 15921     IF CLSTNML GREATER THAN ZEROS
 15922         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15923
 15924     IF CCANREAL > ZEROS
 15925        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15926     END-IF
 15927     IF CPCYNL > ZEROS
 15928        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15929     END-IF
 15930     IF CCANDT1L    GREATER THAN ZEROS
 15931        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15932
 15933     IF CCANDT2L    GREATER THAN ZEROS
 15934        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15935
 15936     IF CMTHD1L    GREATER THAN +0
 15937        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15938
 15939     IF CMTHD2L    GREATER THAN +0
 15940        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15941
 15942     IF CREFND1L    GREATER THAN ZEROS
 15943        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15944        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 290
* EL6311.cbl
 15945        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15946        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15947
 15948     IF CREFND2L    GREATER THAN ZEROS
 15949        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15950        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15951        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15952        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15953
 15954     IF CLIVESL     GREATER THAN ZEROS
 15955        MOVE WS-CLIVES           TO PB-C-LIVES.
 15956
 15957     IF CPAYEEL     GREATER THAN ZEROS
 15958        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15959
 15960     IF CFORCEL     GREATER THAN ZEROS
 15961        MOVE CFORCEI             TO PB-FORCE-CODE.
 15962
 15963     IF CBILCDL     GREATER THAN ZEROS
 15964        MOVE CBILCDI             TO PB-RECORD-BILL.
 15965
 15966 2360-REWRITE-PB-RECORD.
 15967     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15968     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15969     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15970     MOVE 'C'                    TO JP-RECORD-TYPE.
 15971     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15972     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15973     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15974
 15975     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15976
 15977     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15978     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15979
 15980     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15981
 15982     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15983
 15984     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15985     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15986     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15987
 15988     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15989     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15990
 15991 2375-REWRITE-PENDING-BUSINESS.
 15992     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15993     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15994     MOVE 'C'                    TO JP-RECORD-TYPE.
 15995     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15996
 15997
 15998* EXEC CICS REWRITE
 15999*        DATASET (FILE-ID-ERPNDB)
 16000*        FROM    (PENDING-BUSINESS)
 16001*    END-EXEC.
 16002     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 291
* EL6311.cbl
 16003      PENDING-BUSINESS
 16004       TO DFHEIV11
 16005*    MOVE '&& L                  %   #00014260' TO DFHEIV0
 16006     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16007     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16008     MOVE X'2020233030303134323630' TO DFHEIV0(25:11)
 16009     CALL 'kxdfhei1' USING DFHEIV0,
 16010           FILE-ID-ERPNDB,
 16011           PENDING-BUSINESS,
 16012           DFHEIV11,
 16013           DFHEIV99
 16014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16015
 16016
 16017     PERFORM 8400-LOG-JOURNAL-RECORD.
 16018
 16019******************************************************************
 16020*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16021******************************************************************
 16022
 16023     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16024     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16025     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16026     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16027
 16028
 16029* EXEC CICS READ
 16030*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16031*        DATASET (FILE-ID-ELCERT)
 16032*        RIDFLD  (ELCERT-KEY)
 16033*        RESP    (WS-RESPONSE)
 16034*    END-EXEC.
 16035*    MOVE '&"S        E          (  N#00014276' TO DFHEIV0
 16036     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16038     MOVE X'204E233030303134323736' TO DFHEIV0(25:11)
 16039     CALL 'kxdfhei1' USING DFHEIV0,
 16040           FILE-ID-ELCERT,
 16041           DFHEIV20,
 16042           DFHEIV99,
 16043           ELCERT-KEY,
 16044           DFHEIV99,
 16045           DFHEIV99,
 16046           DFHEIV99
 16047     SET ADDRESS OF CERTIFICATE-MASTER TO
 16048         DFHEIV20
 16049     MOVE EIBRESP  TO WS-RESPONSE
 16050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16051
 16052
 16053     IF NOT RESP-NORMAL
 16054        GO TO 2376-BYPASS-CRTO
 16055     END-IF
 16056
 16057
 16058     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16059     MOVE ' '                    TO WS-ERMAIL-SW
 16060
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 292
* EL6311.cbl
 16061
 16062* EXEC CICS READ
 16063*       DATASET   (FILE-ID-ERMAIL)
 16064*       SET       (ADDRESS OF MAILING-DATA)
 16065*       RIDFLD    (ERMAIL-KEY)
 16066*       RESP      (WS-RESPONSE)
 16067*    END-EXEC
 16068*    MOVE '&"S        E          (  N#00014291' TO DFHEIV0
 16069     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16071     MOVE X'204E233030303134323931' TO DFHEIV0(25:11)
 16072     CALL 'kxdfhei1' USING DFHEIV0,
 16073           FILE-ID-ERMAIL,
 16074           DFHEIV20,
 16075           DFHEIV99,
 16076           ERMAIL-KEY,
 16077           DFHEIV99,
 16078           DFHEIV99,
 16079           DFHEIV99
 16080     SET ADDRESS OF MAILING-DATA TO
 16081         DFHEIV20
 16082     MOVE EIBRESP  TO WS-RESPONSE
 16083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16084
 16085     IF RESP-NORMAL
 16086        SET ERMAIL-FOUND TO TRUE
 16087     END-IF
 16088
 16089     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16090
 16091     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16092                                 TO ELCRTO-KEY
 16093     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16094     MOVE +0                     TO ELCRTO-SEQ-NO
 16095
 16096
 16097* EXEC CICS READ
 16098*       DATASET   ('ELCRTO')
 16099*       INTO      (ORIGINAL-CERTIFICATE)
 16100*       RIDFLD    (ELCRTO-KEY)
 16101*       GTEQ
 16102*       RESP      (WS-RESPONSE)
 16103*    END-EXEC
 16104     MOVE LENGTH OF
 16105      ORIGINAL-CERTIFICATE
 16106       TO DFHEIV11
 16107     MOVE 'ELCRTO' TO DFHEIV1
 16108*    MOVE '&"IL       G          (  N#00014309' TO DFHEIV0
 16109     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16111     MOVE X'204E233030303134333039' TO DFHEIV0(25:11)
 16112     CALL 'kxdfhei1' USING DFHEIV0,
 16113           DFHEIV1,
 16114           ORIGINAL-CERTIFICATE,
 16115           DFHEIV11,
 16116           ELCRTO-KEY,
 16117           DFHEIV99,
 16118           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 293
* EL6311.cbl
 16119           DFHEIV99
 16120     MOVE EIBRESP  TO WS-RESPONSE
 16121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16122
 16123     IF RESP-NORMAL
 16124        AND (OC-CONTROL-PRIMARY (1:33) =
 16125                 PB-CONTROL-BY-ACCOUNT (1:33))
 16126        AND (OC-RECORD-TYPE = 'I')
 16127        display ' resp norm, key =, type i '
 16128        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16129           display ' end proc blank '
 16130           display ' csr edit session ' PI-CSR-SESSION-SW
 16131           IF NOT CSR-EDIT-SESSION
 16132
 16133* EXEC CICS READ
 16134*                DATASET   ('ELCRTO')
 16135*                INTO      (ORIGINAL-CERTIFICATE)
 16136*                RIDFLD    (OC-CONTROL-PRIMARY)
 16137*                UPDATE
 16138*                RESP      (WS-RESPONSE)
 16139*             END-EXEC
 16140     MOVE LENGTH OF
 16141      ORIGINAL-CERTIFICATE
 16142       TO DFHEIV11
 16143     MOVE 'ELCRTO' TO DFHEIV1
 16144*    MOVE '&"IL       EU         (  N#00014326' TO DFHEIV0
 16145     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16146     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16147     MOVE X'204E233030303134333236' TO DFHEIV0(25:11)
 16148     CALL 'kxdfhei1' USING DFHEIV0,
 16149           DFHEIV1,
 16150           ORIGINAL-CERTIFICATE,
 16151           DFHEIV11,
 16152           OC-CONTROL-PRIMARY,
 16153           DFHEIV99,
 16154           DFHEIV99,
 16155           DFHEIV99
 16156     MOVE EIBRESP  TO WS-RESPONSE
 16157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16158              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16159              IF RESP-NORMAL
 16160                 display ' good read upd '
 16161                 IF OC-ISSUE-TRAN-IND = 'N'
 16162                    MOVE CM-INSURED-LAST-NAME   TO
 16163                         OC-INS-LAST-NAME
 16164                    MOVE CM-INSURED-FIRST-NAME  TO
 16165                         OC-INS-FIRST-NAME
 16166                    MOVE CM-INSURED-INITIAL2    TO
 16167                         OC-INS-MIDDLE-INIT
 16168                    MOVE CM-INSURED-ISSUE-AGE   TO
 16169                         OC-INS-AGE
 16170                    MOVE CM-JT-LAST-NAME        TO
 16171                         OC-JNT-LAST-NAME
 16172                    MOVE CM-JT-FIRST-NAME       TO
 16173                         OC-JNT-FIRST-NAME
 16174                    MOVE CM-JT-INITIAL          TO
 16175                         OC-JNT-MIDDLE-INIT
 16176                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 294
* EL6311.cbl
 16177                         OC-JNT-AGE
 16178                    MOVE CM-LF-BENEFIT-CD       TO
 16179                         OC-LF-BENCD
 16180                    MOVE CM-LF-ORIG-TERM        TO
 16181                         OC-LF-TERM
 16182                    MOVE CM-LF-BENEFIT-AMT      TO
 16183                         OC-LF-BEN-AMT
 16184                    MOVE CM-LF-PREMIUM-AMT      TO
 16185                         OC-LF-PRM-AMT
 16186                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16187                         OC-LF-ALT-BEN-AMT
 16188                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16189                         OC-LF-ALT-PRM-AMT
 16190                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16191                         OC-LF-EXP-DT
 16192                    MOVE CM-LIFE-COMM-PCT       TO
 16193                         OC-LF-COMM-PCT
 16194                    MOVE CM-AH-BENEFIT-CD       TO
 16195                         OC-AH-BENCD
 16196                    MOVE CM-AH-ORIG-TERM        TO
 16197                         OC-AH-TERM
 16198                    MOVE CM-AH-BENEFIT-AMT      TO
 16199                         OC-AH-BEN-AMT
 16200                    MOVE CM-AH-PREMIUM-AMT      TO
 16201                         OC-AH-PRM-AMT
 16202                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16203                         OC-AH-EXP-DT
 16204                    MOVE CM-AH-COMM-PCT         TO
 16205                         OC-AH-COMM-PCT
 16206                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16207                         OC-AH-CP
 16208                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16209                         OC-1ST-PMT-DT
 16210                 END-IF
 16211                 MOVE PB-C-LF-CANCEL-DT      TO
 16212                         OC-LF-CANCEL-DT
 16213                 MOVE PB-C-LF-CANCEL-AMT     TO
 16214                         OC-LF-CANCEL-AMT
 16215                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16216                         OC-LF-ITD-CANCEL-AMT
 16217                 MOVE PB-C-AH-CANCEL-DT      TO
 16218                         OC-AH-CANCEL-DT
 16219                 MOVE PB-C-AH-CANCEL-AMT     TO
 16220                         OC-AH-CANCEL-AMT
 16221                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16222                         OC-AH-ITD-CANCEL-AMT
 16223                 MOVE 'Y'                    TO
 16224                         OC-CANCEL-TRAN-IND
 16225                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16226                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16227                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16228                 IF ERMAIL-FOUND
 16229                    MOVE MA-CRED-BENE-NAME
 16230                                 TO OC-CRED-BENE-NAME
 16231                 END-IF
 16232                 IF NOT CERT-TRL-REC-NOT-FOUND
 16233                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16234                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 295
* EL6311.cbl
 16235                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16236                           OC-JNT-AGE-DEFAULT-FLAG
 16237                 END-IF
 16238
 16239* EXEC CICS REWRITE
 16240*                   DATASET   ('ELCRTO')
 16241*                   FROM      (ORIGINAL-CERTIFICATE)
 16242*                   RESP      (WS-RESPONSE)
 16243*                END-EXEC
 16244     MOVE LENGTH OF
 16245      ORIGINAL-CERTIFICATE
 16246       TO DFHEIV11
 16247     MOVE 'ELCRTO' TO DFHEIV1
 16248*    MOVE '&& L                  %  N#00014413' TO DFHEIV0
 16249     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16250     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16251     MOVE X'204E233030303134343133' TO DFHEIV0(25:11)
 16252     CALL 'kxdfhei1' USING DFHEIV0,
 16253           DFHEIV1,
 16254           ORIGINAL-CERTIFICATE,
 16255           DFHEIV11,
 16256           DFHEIV99
 16257     MOVE EIBRESP  TO WS-RESPONSE
 16258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16259                 display ' just rewrote ' ws-response
 16260              END-IF
 16261           END-IF
 16262        ELSE
 16263           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16264           MOVE 'OC'             TO OC-RECORD-ID
 16265           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16266           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16267           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16268           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16269           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16270           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16271           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16272           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16273           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16274           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16275           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16276           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16277           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16278           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16279           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16280           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16281           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16282           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16283           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16284           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16285           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16286           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16287           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16288           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16289           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16290           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16291           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16292           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 296
* EL6311.cbl
 16293           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16294           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16295           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16296           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16297           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16298           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16299           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16300           IF ERMAIL-FOUND
 16301              MOVE MA-CRED-BENE-NAME
 16302                                 TO OC-CRED-BENE-NAME
 16303           END-IF
 16304           IF NOT CERT-TRL-REC-NOT-FOUND
 16305              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16306                           OC-INS-AGE-DEFAULT-FLAG
 16307              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16308                           OC-JNT-AGE-DEFAULT-FLAG
 16309           END-IF
 16310           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16311
 16312* EXEC CICS WRITE
 16313*             DATASET   ('ELCRTO')
 16314*             FROM      (ORIGINAL-CERTIFICATE)
 16315*             RIDFLD    (OC-CONTROL-PRIMARY)
 16316*             RESP      (WS-RESPONSE)
 16317*          END-EXEC
 16318     MOVE LENGTH OF
 16319      ORIGINAL-CERTIFICATE
 16320       TO DFHEIV11
 16321     MOVE 'ELCRTO' TO DFHEIV1
 16322*    MOVE '&$ L                  ''  N#00014470' TO DFHEIV0
 16323     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16325     MOVE X'204E233030303134343730' TO DFHEIV0(25:11)
 16326     CALL 'kxdfhei1' USING DFHEIV0,
 16327           DFHEIV1,
 16328           ORIGINAL-CERTIFICATE,
 16329           DFHEIV11,
 16330           OC-CONTROL-PRIMARY,
 16331           DFHEIV99,
 16332           DFHEIV99
 16333     MOVE EIBRESP  TO WS-RESPONSE
 16334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16335        END-IF
 16336     ELSE
 16337        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16338        MOVE 'OC'                TO OC-RECORD-ID
 16339        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16340                                 TO OC-CONTROL-PRIMARY (1:33)
 16341        MOVE 'I'                 TO OC-RECORD-TYPE
 16342        MOVE +4096               TO OC-KEY-SEQ-NO
 16343        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16344        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16345        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16346        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16347        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16348        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16349        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16350        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 297
* EL6311.cbl
 16351        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16352        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16353        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16354        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16355        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16356        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16357        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16358        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16359        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16360        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16361        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16362        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16363        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16364        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16365        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16366        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16367        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16368        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16369        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16370        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16371        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16372        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16373        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16374        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16375        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16376        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16377        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16378        IF ERMAIL-FOUND
 16379           MOVE MA-CRED-BENE-NAME
 16380                                 TO OC-CRED-BENE-NAME
 16381        END-IF
 16382        IF NOT CERT-TRL-REC-NOT-FOUND
 16383           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16384                           OC-INS-AGE-DEFAULT-FLAG
 16385           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16386                           OC-JNT-AGE-DEFAULT-FLAG
 16387        END-IF
 16388        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16389
 16390
 16391* EXEC CICS WRITE
 16392*          DATASET   ('ELCRTO')
 16393*          FROM      (ORIGINAL-CERTIFICATE)
 16394*          RIDFLD    (OC-CONTROL-PRIMARY)
 16395*          RESP      (WS-RESPONSE)
 16396*       END-EXEC
 16397     MOVE LENGTH OF
 16398      ORIGINAL-CERTIFICATE
 16399       TO DFHEIV11
 16400     MOVE 'ELCRTO' TO DFHEIV1
 16401*    MOVE '&$ L                  ''  N#00014531' TO DFHEIV0
 16402     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16404     MOVE X'204E233030303134353331' TO DFHEIV0(25:11)
 16405     CALL 'kxdfhei1' USING DFHEIV0,
 16406           DFHEIV1,
 16407           ORIGINAL-CERTIFICATE,
 16408           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 298
* EL6311.cbl
 16409           OC-CONTROL-PRIMARY,
 16410           DFHEIV99,
 16411           DFHEIV99
 16412     MOVE EIBRESP  TO WS-RESPONSE
 16413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16414     END-IF.
 16415
 16416 2376-BYPASS-CRTO.
 16417******************************************************************
 16418*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16419******************************************************************
 16420
 16421
 16422* EXEC CICS HANDLE CONDITION
 16423*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16424*    END-EXEC.
 16425*    MOVE '"$I                   ! 7 #00014544' TO DFHEIV0
 16426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16428     MOVE X'3720233030303134353434' TO DFHEIV0(25:11)
 16429     CALL 'kxdfhei1' USING DFHEIV0
 16430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16431
 16432
 16433
 16434* EXEC CICS READ
 16435*        INTO    (PENDING-BUSINESS)
 16436*        DATASET (FILE-ID-ERPNDB)
 16437*        RIDFLD  (ERPNDB-KEY)
 16438*        UPDATE
 16439*    END-EXEC.
 16440     MOVE LENGTH OF
 16441      PENDING-BUSINESS
 16442       TO DFHEIV11
 16443*    MOVE '&"IL       EU         (   #00014548' TO DFHEIV0
 16444     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16445     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16446     MOVE X'2020233030303134353438' TO DFHEIV0(25:11)
 16447     CALL 'kxdfhei1' USING DFHEIV0,
 16448           FILE-ID-ERPNDB,
 16449           PENDING-BUSINESS,
 16450           DFHEIV11,
 16451           ERPNDB-KEY,
 16452           DFHEIV99,
 16453           DFHEIV99,
 16454           DFHEIV99
 16455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16456
 16457
 16458     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16459     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16460     MOVE 'B'                    TO JP-RECORD-TYPE.
 16461     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16462
 16463     PERFORM 8400-LOG-JOURNAL-RECORD.
 16464
 16465     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16466
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 299
* EL6311.cbl
 16467
 16468* EXEC CICS REWRITE
 16469*        DATASET (FILE-ID-ERPNDB)
 16470*        FROM    (PENDING-BUSINESS)
 16471*    END-EXEC.
 16472     MOVE LENGTH OF
 16473      PENDING-BUSINESS
 16474       TO DFHEIV11
 16475*    MOVE '&& L                  %   #00014564' TO DFHEIV0
 16476     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16477     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303134353634' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           FILE-ID-ERPNDB,
 16481           PENDING-BUSINESS,
 16482           DFHEIV11,
 16483           DFHEIV99
 16484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16485
 16486
 16487     MOVE 'C'                    TO JP-RECORD-TYPE.
 16488     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16489
 16490     PERFORM 8400-LOG-JOURNAL-RECORD.
 16491
 16492     IF WS-ERRORS-PRESENT
 16493         GO TO 3900-RE-DISPLAY-RECORD.
 16494
 16495     MOVE ZEROS                  TO EMI-ERROR
 16496     MOVE -1                     TO CMAINTL
 16497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16498     GO TO 3900-RE-DISPLAY-RECORD.
 16499
 16500 2380-BATCH-HDR-NOT-FOUND.
 16501     MOVE -1                     TO BMAINTL.
 16502     MOVE ER-7450                TO EMI-ERROR.
 16503     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16504     GO TO 8200-SEND-DATAONLY.
 16505
 16506 2385-REC-NOT-FOUND.
 16507     MOVE -1                     TO BMAINTL.
 16508     MOVE ER-7451                TO EMI-ERROR.
 16509     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16510     GO TO 8200-SEND-DATAONLY.
 16511
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 300
* EL6311.cbl
 16513
 16514******************************************************************
 16515*                                                                *
 16516*          D E L E T E   C A N C E L   R O U T I N E             *
 16517*                                                                *
 16518******************************************************************
 16519
 16520 2400-DELETE-CANCEL-ROUTINE.
 16521     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16522
 16523     IF CCHGL NOT = ZEROS
 16524        MOVE ER-2196             TO EMI-ERROR
 16525        MOVE AL-UABON            TO CMAINTA
 16526        MOVE -1                  TO CMAINTL
 16527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16528        GO TO 8200-SEND-DATAONLY.
 16529
 16530
 16531* EXEC CICS HANDLE CONDITION
 16532*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16533*    END-EXEC.
 16534*    MOVE '"$I                   ! 8 #00014612' TO DFHEIV0
 16535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16537     MOVE X'3820233030303134363132' TO DFHEIV0(25:11)
 16538     CALL 'kxdfhei1' USING DFHEIV0
 16539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16540
 16541
 16542     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16543     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16544     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16545
 16546
 16547* EXEC CICS READ
 16548*        SET     (ADDRESS OF PENDING-BUSINESS)
 16549*        DATASET (FILE-ID-ERPNDB)
 16550*        RIDFLD  (ERPNDB-KEY)
 16551*    END-EXEC.
 16552*    MOVE '&"S        E          (   #00014620' TO DFHEIV0
 16553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16555     MOVE X'2020233030303134363230' TO DFHEIV0(25:11)
 16556     CALL 'kxdfhei1' USING DFHEIV0,
 16557           FILE-ID-ERPNDB,
 16558           DFHEIV20,
 16559           DFHEIV99,
 16560           ERPNDB-KEY,
 16561           DFHEIV99,
 16562           DFHEIV99,
 16563           DFHEIV99
 16564     SET ADDRESS OF PENDING-BUSINESS TO
 16565         DFHEIV20
 16566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16567
 16568
 16569     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16570
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 301
* EL6311.cbl
 16571     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16572
 16573     IF CSUFIXL NOT = ZEROS
 16574        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16575     ELSE
 16576        MOVE SPACE               TO WS-NEW-SUFFIX.
 16577
 16578     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16579
 16580     PERFORM 8600-DEEDIT.
 16581     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16582     MOVE '4'                    TO DC-OPTION-CODE.
 16583     PERFORM 9700-DATE-LINK.
 16584
 16585     IF DATE-CONVERSION-ERROR
 16586        MOVE ER-0348             TO EMI-ERROR
 16587        MOVE -1                  TO CEFFDTL
 16588        MOVE AL-UABON            TO CEFFDTA
 16589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16590        GO TO 8200-SEND-DATAONLY
 16591     ELSE
 16592        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16593        MOVE AL-UANON            TO CEFFDTA
 16594        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16595
 16596
 16597* EXEC CICS HANDLE CONDITION
 16598*         NOTFND    (2490-RECORD-NOT-FOUND)
 16599*    END-EXEC.
 16600*    MOVE '"$I                   ! 9 #00014653' TO DFHEIV0
 16601     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16603     MOVE X'3920233030303134363533' TO DFHEIV0(25:11)
 16604     CALL 'kxdfhei1' USING DFHEIV0
 16605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16606
 16607
 16608
 16609* EXEC CICS READ
 16610*        SET     (ADDRESS OF PENDING-BUSINESS)
 16611*        DATASET (FILE-ID-ERPNDB)
 16612*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16613*        UPDATE
 16614*    END-EXEC.
 16615*    MOVE '&"S        EU         (   #00014657' TO DFHEIV0
 16616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16618     MOVE X'2020233030303134363537' TO DFHEIV0(25:11)
 16619     CALL 'kxdfhei1' USING DFHEIV0,
 16620           FILE-ID-ERPNDB,
 16621           DFHEIV20,
 16622           DFHEIV99,
 16623           PI-PREV-CONTROL-PRIMARY,
 16624           DFHEIV99,
 16625           DFHEIV99,
 16626           DFHEIV99
 16627     SET ADDRESS OF PENDING-BUSINESS TO
 16628         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 302
* EL6311.cbl
 16629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16630
 16631
 16632     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16633        MOVE -1                 TO CMAINTL
 16634        MOVE ER-2197            TO EMI-ERROR
 16635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16636        GO TO 8200-SEND-DATAONLY.
 16637
 16638     IF PB-BILLED-DT NOT = LOW-VALUES
 16639        MOVE -1                 TO CMAINTL
 16640        MOVE ER-2129            TO EMI-ERROR
 16641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16642        GO TO 8200-SEND-DATAONLY.
 16643
 16644     IF PB-CHG-COUNT NOT = ZEROS
 16645        MOVE ER-2336            TO EMI-ERROR
 16646        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16647        MOVE AL-UABON            TO CMAINTA
 16648        MOVE -1                  TO CMAINTL
 16649        GO TO 8200-SEND-DATAONLY.
 16650
 16651     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16652        PB-CHG-COUNT NOT = ZEROS
 16653        MOVE ER-2196             TO EMI-ERROR
 16654        MOVE AL-UABON            TO CMAINTA
 16655        MOVE -1                  TO CMAINTL
 16656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16657        GO TO 8200-SEND-DATAONLY.
 16658
 16659     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16660        MOVE ER-2900 TO EMI-ERROR
 16661        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16662        MOVE AL-UABON         TO CMAINTA
 16663        MOVE -1               TO CMAINTL
 16664        GO TO 8200-SEND-DATAONLY.
 16665     move ' '                    to ws-stop-sw
 16666                                    ws-check-sw
 16667                                    ws-any-check-sw
 16668                                    ws-proc-check-sw
 16669                                    ws-chek-browse-sw
 16670
 16671     perform 2500-browse-checks  thru 2500-exit
 16672     if (i-have-processed-checks)
 16673        and (pb-c-refund-sw = 'Y')
 16674        move er-3446             to emi-error
 16675        perform 9900-error-format thru 9900-exit
 16676        move al-uabon            to cmainta
 16677        move -1                  to cmaintl
 16678        go to 8200-send-dataonly
 16679     end-if
 16680
 16681* EXEC CICS HANDLE CONDITION
 16682*         NOTFND  (2475-CONTINUE-DELETE)
 16683*    END-EXEC
 16684*    MOVE '"$I                   ! : #00014712' TO DFHEIV0
 16685     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 303
* EL6311.cbl
 16687     MOVE X'3A20233030303134373132' TO DFHEIV0(25:11)
 16688     CALL 'kxdfhei1' USING DFHEIV0
 16689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16690
 16691     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16692     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16693     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16694     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16695
 16696
 16697* EXEC CICS READ
 16698*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16699*        DATASET (FILE-ID-ELCERT)
 16700*        RIDFLD  (ELCERT-KEY)
 16701*        UPDATE
 16702*    END-EXEC.
 16703*    MOVE '&"S        EU         (   #00014721' TO DFHEIV0
 16704     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16705     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16706     MOVE X'2020233030303134373231' TO DFHEIV0(25:11)
 16707     CALL 'kxdfhei1' USING DFHEIV0,
 16708           FILE-ID-ELCERT,
 16709           DFHEIV20,
 16710           DFHEIV99,
 16711           ELCERT-KEY,
 16712           DFHEIV99,
 16713           DFHEIV99,
 16714           DFHEIV99
 16715     SET ADDRESS OF CERTIFICATE-MASTER TO
 16716         DFHEIV20
 16717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16718
 16719
 16720     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16721
 16722     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16723     MOVE 'B'                    TO JP-RECORD-TYPE.
 16724     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16725     PERFORM 8400-LOG-JOURNAL-RECORD.
 16726
 16727     IF PB-CI-LIVES NOT NUMERIC
 16728         MOVE ZERO                    TO PB-CI-LIVES.
 16729
 16730     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16731        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16732           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16733           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16734           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16735                                            CM-LF-CANCEL-DT
 16736           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16737        ELSE
 16738           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16739           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16740           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16741           MOVE PB-CI-LIVES              TO CM-LIVES.
 16742
 16743     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16744        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 304
* EL6311.cbl
 16745           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16746               MOVE CM-LF-STATUS-AT-CANCEL
 16747                                        TO CM-LF-CURRENT-STATUS
 16748               MOVE SPACE
 16749                                        TO CM-LF-STATUS-AT-CANCEL
 16750           ELSE
 16751               MOVE PB-CI-LF-POLICY-STATUS
 16752                                        TO CM-LF-CURRENT-STATUS
 16753        ELSE
 16754           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16755
 16756
 16757     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16758        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16759           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16760           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16761           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16762                                            CM-AH-CANCEL-DT
 16763           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16764        ELSE
 16765           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16766           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16767           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16768           MOVE PB-CI-LIVES              TO CM-LIVES.
 16769
 16770     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16771        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16772           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16773               MOVE CM-AH-STATUS-AT-CANCEL
 16774                                        TO CM-AH-CURRENT-STATUS
 16775               MOVE SPACE
 16776                                        TO CM-AH-STATUS-AT-CANCEL
 16777           ELSE
 16778               MOVE PB-CI-AH-POLICY-STATUS
 16779                                        TO CM-AH-CURRENT-STATUS
 16780        ELSE
 16781           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16782
 16783 2450-REWRITE-CERT.
 16784     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16785     MOVE 'C'                      TO JP-RECORD-TYPE.
 16786     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16787
 16788
 16789* EXEC CICS REWRITE
 16790*        DATASET  (FILE-ID-ELCERT)
 16791*        FROM     (CERTIFICATE-MASTER)
 16792*    END-EXEC.
 16793     MOVE LENGTH OF
 16794      CERTIFICATE-MASTER
 16795       TO DFHEIV11
 16796*    MOVE '&& L                  %   #00014796' TO DFHEIV0
 16797     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16798     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16799     MOVE X'2020233030303134373936' TO DFHEIV0(25:11)
 16800     CALL 'kxdfhei1' USING DFHEIV0,
 16801           FILE-ID-ELCERT,
 16802           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 305
* EL6311.cbl
 16803           DFHEIV11,
 16804           DFHEIV99
 16805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16806
 16807
 16808     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16809
 16810     PERFORM 8400-LOG-JOURNAL-RECORD.
 16811
 16812     move ' '                    to ws-stop-sw
 16813                                    ws-any-check-sw
 16814                                    ws-proc-check-sw
 16815                                    ws-chek-browse-sw
 16816
 16817     if i-have-checks
 16818        perform until i-say-stop
 16819           perform 2510-startbr-erchek
 16820                                 thru 2510-exit
 16821           if resp-normal
 16822              perform 2520-readnext-erchek
 16823                                 thru 2520-exit
 16824           end-if
 16825           if (not resp-normal)
 16826              or (pb-control-by-account (1:33) not =
 16827                 ch-control-primary (1:33))
 16828                 set i-say-stop to true
 16829           else
 16830              perform 2530-readupd-erchek
 16831                                 thru 2530-exit
 16832              if resp-normal
 16833                 perform 2540-delete-erchek
 16834                                 thru 2540-exit
 16835              end-if
 16836              if ws-chek-browse-sw = 'Y'
 16837                 perform 2525-endbr-erchek
 16838                                 thru 2525-exit
 16839                 move ' '        to ws-chek-browse-sw
 16840              end-if
 16841           end-if
 16842        end-perform
 16843     end-if
 16844
 16845     if ws-chek-browse-sw = 'Y'
 16846        perform 2525-endbr-erchek thru 2525-exit
 16847     end-if
 16848     .
 16849 2475-CONTINUE-DELETE.
 16850     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16851     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16852
 16853     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16854     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16855
 16856     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16857
 16858     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16859     MOVE 'D'                    TO JP-RECORD-TYPE
 16860     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 306
* EL6311.cbl
 16861
 16862
 16863* EXEC CICS DELETE
 16864*        DATASET    (FILE-ID-ERPNDB)
 16865*    END-EXEC.
 16866*    MOVE '&(                    &   #00014855' TO DFHEIV0
 16867     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16869     MOVE X'2020233030303134383535' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0,
 16871           FILE-ID-ERPNDB,
 16872           DFHEIV99,
 16873           DFHEIV99,
 16874           DFHEIV99,
 16875           DFHEIV99
 16876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16877
 16878
 16879     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16880
 16881     PERFORM 8400-LOG-JOURNAL-RECORD.
 16882
 16883     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16884     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16885
 16886
 16887* EXEC CICS HANDLE CONDITION
 16888*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16889*    END-EXEC.
 16890*    MOVE '"$I                   ! ; #00014866' TO DFHEIV0
 16891     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16893     MOVE X'3B20233030303134383636' TO DFHEIV0(25:11)
 16894     CALL 'kxdfhei1' USING DFHEIV0
 16895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16896
 16897
 16898
 16899* EXEC CICS READ
 16900*        SET     (ADDRESS OF PENDING-BUSINESS)
 16901*        DATASET (FILE-ID-ERPNDB)
 16902*        RIDFLD  (ERPNDB-KEY)
 16903*        UPDATE
 16904*    END-EXEC.
 16905*    MOVE '&"S        EU         (   #00014870' TO DFHEIV0
 16906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16907     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303134383730' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           FILE-ID-ERPNDB,
 16911           DFHEIV20,
 16912           DFHEIV99,
 16913           ERPNDB-KEY,
 16914           DFHEIV99,
 16915           DFHEIV99,
 16916           DFHEIV99
 16917     SET ADDRESS OF PENDING-BUSINESS TO
 16918         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 307
* EL6311.cbl
 16919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16920
 16921
 16922     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16923     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16924
 16925     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16926        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16927        MOVE 'D'                 TO JP-RECORD-TYPE
 16928        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16929
 16930* EXEC CICS DELETE
 16931*            DATASET    (FILE-ID-ERPNDB)
 16932*       END-EXEC
 16933*    MOVE '&(                    &   #00014884' TO DFHEIV0
 16934     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16935     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16936     MOVE X'2020233030303134383834' TO DFHEIV0(25:11)
 16937     CALL 'kxdfhei1' USING DFHEIV0,
 16938           FILE-ID-ERPNDB,
 16939           DFHEIV99,
 16940           DFHEIV99,
 16941           DFHEIV99,
 16942           DFHEIV99
 16943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16944        PERFORM 8400-LOG-JOURNAL-RECORD
 16945     ELSE
 16946        MOVE 'B'                 TO JP-RECORD-TYPE
 16947        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16948        PERFORM 8400-LOG-JOURNAL-RECORD
 16949        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16950        MOVE 'C'                 TO JP-RECORD-TYPE
 16951        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16952
 16953* EXEC CICS REWRITE
 16954*            DATASET    (FILE-ID-ERPNDB)
 16955*            FROM       (PENDING-BUSINESS)
 16956*       END-EXEC
 16957     MOVE LENGTH OF
 16958      PENDING-BUSINESS
 16959       TO DFHEIV11
 16960*    MOVE '&& L                  %   #00014895' TO DFHEIV0
 16961     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16962     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16963     MOVE X'2020233030303134383935' TO DFHEIV0(25:11)
 16964     CALL 'kxdfhei1' USING DFHEIV0,
 16965           FILE-ID-ERPNDB,
 16966           PENDING-BUSINESS,
 16967           DFHEIV11,
 16968           DFHEIV99
 16969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16970        PERFORM 8400-LOG-JOURNAL-RECORD.
 16971
 16972******************************************************************
 16973*                                                                *
 16974*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16975*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16976*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 308
* EL6311.cbl
 16977******************************************************************
 16978
 16979     IF NOT PI-AR-PROCESSING
 16980        GO TO 2480-DELETE-FINISHED.
 16981
 16982     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16983        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16984        NEXT SENTENCE
 16985     ELSE
 16986        GO TO 2480-DELETE-FINISHED.
 16987
 16988
 16989* EXEC CICS HANDLE CONDITION
 16990*         NOTFND    (2480-DELETE-FINISHED)
 16991*    END-EXEC.
 16992*    MOVE '"$I                   ! < #00014917' TO DFHEIV0
 16993     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16995     MOVE X'3C20233030303134393137' TO DFHEIV0(25:11)
 16996     CALL 'kxdfhei1' USING DFHEIV0
 16997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16998
 16999
 17000     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 17001     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 17002
 17003
 17004* EXEC CICS READ
 17005*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 17006*        DATASET (FILE-ID-ERRQST)
 17007*        RIDFLD  (ERRQST-KEY)
 17008*        UPDATE
 17009*    END-EXEC.
 17010*    MOVE '&"S        EU         (   #00014924' TO DFHEIV0
 17011     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17012     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17013     MOVE X'2020233030303134393234' TO DFHEIV0(25:11)
 17014     CALL 'kxdfhei1' USING DFHEIV0,
 17015           FILE-ID-ERRQST,
 17016           DFHEIV20,
 17017           DFHEIV99,
 17018           ERRQST-KEY,
 17019           DFHEIV99,
 17020           DFHEIV99,
 17021           DFHEIV99
 17022     SET ADDRESS OF AR-REQUEST-RECORD TO
 17023         DFHEIV20
 17024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17025
 17026
 17027     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17028
 17029     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17030
 17031     MOVE 'D'                      TO JP-RECORD-TYPE.
 17032     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17033
 17034
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 309
* EL6311.cbl
 17035* EXEC CICS DELETE
 17036*         DATASET    (FILE-ID-ERRQST)
 17037*    END-EXEC.
 17038*    MOVE '&(                    &   #00014938' TO DFHEIV0
 17039     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17040     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17041     MOVE X'2020233030303134393338' TO DFHEIV0(25:11)
 17042     CALL 'kxdfhei1' USING DFHEIV0,
 17043           FILE-ID-ERRQST,
 17044           DFHEIV99,
 17045           DFHEIV99,
 17046           DFHEIV99,
 17047           DFHEIV99
 17048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17049
 17050
 17051     PERFORM 8400-LOG-JOURNAL-RECORD.
 17052
 17053 2480-DELETE-FINISHED.
 17054     MOVE ZEROS                  TO EMI-ERROR.
 17055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17056     MOVE LOW-VALUES             TO EL631CI.
 17057     MOVE -1                     TO CMAINTL.
 17058     GO TO 8100-SEND-INITIAL-MAP.
 17059
 17060 2485-BATCH-HDR-NOT-FOUND.
 17061     MOVE -1                     TO CMAINTL
 17062     MOVE AL-UABON               TO CMAINTA.
 17063     MOVE ER-7450                TO EMI-ERROR.
 17064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17065     GO TO 8200-SEND-DATAONLY.
 17066
 17067 2490-RECORD-NOT-FOUND.
 17068     MOVE -1                     TO CMAINTL
 17069     MOVE AL-UABON               TO CMAINTA.
 17070     MOVE ER-7451                TO EMI-ERROR.
 17071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17072     GO TO 8200-SEND-DATAONLY.
 17073***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17074***                                                            ***
 17075***     2500  B R O W S E   C H E C K S                        ***
 17076***  We perform this routine from 2 different places.          ***
 17077***  1. If the user changes the refund amount on a cancel, we  ***
 17078***    want to.........                                        ***
 17079***    a. determine if prior checks have been processed        ***
 17080***    b. If the amt is larger, display message instructing    ***
 17081***     them to create another check to make up the difference.***
 17082***    c. If the amt is less, do not allow the change and      ***
 17083***     display a FATAL error suggesting they deal with check  ***
 17084***     records befor continuing.                              ***
 17085***  2. If the user wants to delete a cancel record we......   ***
 17086***    a. browse through all the checks and if there is a      ***
 17087***     processed check, send FATAL message.                   ***
 17088***    b. If there is a non-released check, then delete that   ***
 17089***     check after you delete the pending cancel record.      ***
 17090***                                                            ***
 17091***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 17092
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 310
* EL6311.cbl
 17093 2500-browse-checks.
 17094
 17095     perform 2510-startbr-erchek thru 2510-exit
 17096
 17097     if not resp-normal
 17098        go to 2500-exit
 17099     end-if
 17100
 17101     perform until i-say-stop
 17102        perform 2520-readnext-erchek
 17103                                 thru 2520-exit
 17104        if (not resp-normal)
 17105           or (pb-control-by-account (1:33) not =
 17106              ch-control-primary (1:33))
 17107              set i-say-stop to true
 17108        else
 17109           set i-have-a-check-period to true
 17110           if (ch-approval-status) = ' '
 17111              and (ch-void-dt = low-values)
 17112              and (ch-released-dt = low-values)
 17113              set i-have-checks to true
 17114           else
 17115              if ch-void-dt = low-values
 17116                 set i-have-processed-checks to true
 17117              end-if
 17118           end-if
 17119           if (ch-credit-accept-dt = low-values)
 17120              and (ch-void-dt = low-values)
 17121              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17122              if (ch-check-origin-sw not = 'R')
 17123                 and (pb-record-type = '2')
 17124                 continue
 17125              else
 17126                 compute ws-check-amts =
 17127                    ws-check-amts + ch-amount-paid
 17128              end-if
 17129           end-if
 17130        end-if
 17131     end-perform
 17132
 17133     if ws-chek-browse-sw = 'Y'
 17134        perform 2525-endbr-erchek thru 2525-exit
 17135     end-if
 17136
 17137    .
 17138 2500-exit.
 17139     exit.
 17140
 17141 2510-startbr-erchek.
 17142
 17143     move pb-control-by-account  to erchek-key
 17144     move +0                     to chek-record-seq
 17145
 17146
 17147* exec cics startbr
 17148*       dataset   ('ERCHEK')
 17149*       ridfld    (erchek-key)
 17150*       gteq
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 311
* EL6311.cbl
 17151*       resp      (ws-response)
 17152*    end-exec
 17153     MOVE 'ERCHEK' TO DFHEIV1
 17154     MOVE 0
 17155       TO DFHEIV11
 17156*    MOVE '&,         G          &  N#00015037' TO DFHEIV0
 17157     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17158     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17159     MOVE X'204E233030303135303337' TO DFHEIV0(25:11)
 17160     CALL 'kxdfhei1' USING DFHEIV0,
 17161           DFHEIV1,
 17162           erchek-key,
 17163           DFHEIV99,
 17164           DFHEIV11,
 17165           DFHEIV99
 17166     MOVE EIBRESP  TO ws-response
 17167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17168
 17169     IF RESP-NORMAL
 17170        move 'Y'                 to ws-chek-browse-sw
 17171     end-if
 17172
 17173     .
 17174 2510-exit.
 17175     exit.
 17176
 17177 2520-readnext-erchek.
 17178
 17179
 17180* EXEC CICS READNEXT
 17181*       SET     (ADDRESS OF CHECK-RECORDS)
 17182*       DATASET ('ERCHEK')
 17183*       RIDFLD  (ERCHEK-KEY)
 17184*       RESP    (WS-RESPONSE)
 17185*    END-EXEC
 17186     MOVE 'ERCHEK' TO DFHEIV1
 17187     MOVE 0
 17188       TO DFHEIV11
 17189*    MOVE '&.S                   )  N#00015054' TO DFHEIV0
 17190     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17191     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17192     MOVE X'204E233030303135303534' TO DFHEIV0(25:11)
 17193     CALL 'kxdfhei1' USING DFHEIV0,
 17194           DFHEIV1,
 17195           DFHEIV20,
 17196           DFHEIV99,
 17197           ERCHEK-KEY,
 17198           DFHEIV99,
 17199           DFHEIV11,
 17200           DFHEIV99,
 17201           DFHEIV99
 17202     SET ADDRESS OF CHECK-RECORDS TO
 17203         DFHEIV20
 17204     MOVE EIBRESP  TO WS-RESPONSE
 17205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17206
 17207     .
 17208 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 312
* EL6311.cbl
 17209     exit.
 17210
 17211 2525-endbr-erchek.
 17212
 17213
 17214* exec cics endbr
 17215*       dataset  ('ERCHEK')
 17216*    end-exec
 17217     MOVE 'ERCHEK' TO DFHEIV1
 17218     MOVE 0
 17219       TO DFHEIV11
 17220*    MOVE '&2                    $   #00015067' TO DFHEIV0
 17221     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17223     MOVE X'2020233030303135303637' TO DFHEIV0(25:11)
 17224     CALL 'kxdfhei1' USING DFHEIV0,
 17225           DFHEIV1,
 17226           DFHEIV11,
 17227           DFHEIV99
 17228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17229
 17230     .
 17231 2525-exit.
 17232     exit.
 17233
 17234 2530-readupd-erchek.
 17235
 17236
 17237* EXEC CICS READ
 17238*       UPDATE
 17239*       SET     (ADDRESS OF CHECK-RECORDS)
 17240*       DATASET ('ERCHEK')
 17241*       RIDFLD  (ERCHEK-KEY)
 17242*       RESP    (WS-RESPONSE)
 17243*    END-EXEC
 17244     MOVE 'ERCHEK' TO DFHEIV1
 17245*    MOVE '&"S        EU         (  N#00015077' TO DFHEIV0
 17246     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17247     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17248     MOVE X'204E233030303135303737' TO DFHEIV0(25:11)
 17249     CALL 'kxdfhei1' USING DFHEIV0,
 17250           DFHEIV1,
 17251           DFHEIV20,
 17252           DFHEIV99,
 17253           ERCHEK-KEY,
 17254           DFHEIV99,
 17255           DFHEIV99,
 17256           DFHEIV99
 17257     SET ADDRESS OF CHECK-RECORDS TO
 17258         DFHEIV20
 17259     MOVE EIBRESP  TO WS-RESPONSE
 17260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17261
 17262     .
 17263 2530-exit.
 17264     exit.
 17265
 17266 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 313
* EL6311.cbl
 17267
 17268
 17269* EXEC CICS DELETE
 17270*       DATASET ('ERCHEK')
 17271*       RESP    (WS-RESPONSE)
 17272*    END-EXEC
 17273     MOVE 'ERCHEK' TO DFHEIV1
 17274*    MOVE '&(                    &  N#00015091' TO DFHEIV0
 17275     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17276     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17277     MOVE X'204E233030303135303931' TO DFHEIV0(25:11)
 17278     CALL 'kxdfhei1' USING DFHEIV0,
 17279           DFHEIV1,
 17280           DFHEIV99,
 17281           DFHEIV99,
 17282           DFHEIV99,
 17283           DFHEIV99
 17284     MOVE EIBRESP  TO WS-RESPONSE
 17285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17286
 17287     .
 17288 2540-exit.
 17289     exit.
 17290***************************************************************
 17291*                                                             *
 17292*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17293*                                                             *
 17294***************************************************************
 17295
 17296***************************************************************
 17297*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17298*     AN ALREADY BILLED RECORD.                               *
 17299***************************************************************
 17300
 17301 2700-BUILD-CORRECTION-RECORD.
 17302     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17303     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17304     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17305     MOVE '5'                    TO DC-OPTION-CODE.
 17306     PERFORM 9700-DATE-LINK.
 17307     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17308
 17309     IF PB-CHG-COUNT = ZEROS
 17310        MOVE +1                  TO WS-SEQ-SAVE
 17311     ELSE
 17312        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17313
 17314     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17315     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17316
 17317     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17318
 17319     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17320     MOVE 'A'                    TO JP-RECORD-TYPE.
 17321     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17322
 17323
 17324* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 314
* EL6311.cbl
 17325*        DATASET    (FILE-ID-ERPNDB)
 17326*        FROM       (PENDING-BUSINESS)
 17327*        RIDFLD     (PB-CONTROL-PRIMARY)
 17328*    END-EXEC.
 17329     MOVE LENGTH OF
 17330      PENDING-BUSINESS
 17331       TO DFHEIV11
 17332*    MOVE '&$ L                  ''   #00015132' TO DFHEIV0
 17333     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17335     MOVE X'2020233030303135313332' TO DFHEIV0(25:11)
 17336     CALL 'kxdfhei1' USING DFHEIV0,
 17337           FILE-ID-ERPNDB,
 17338           PENDING-BUSINESS,
 17339           DFHEIV11,
 17340           PB-CONTROL-PRIMARY,
 17341           DFHEIV99,
 17342           DFHEIV99
 17343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17344
 17345
 17346     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17347
 17348     PERFORM 8400-LOG-JOURNAL-RECORD.
 17349
 17350 2799-EXIT.
 17351      EXIT.
 17352
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 315
* EL6311.cbl
 17354
 17355******************************************************************
 17356*                                                                *
 17357*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17358*                                                                *
 17359******************************************************************
 17360
 17361 2800-REWRITE-ISSUE-CERT-KEY.
 17362     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17363
 17364     IF  BCERTNOL GREATER THAN ZEROS
 17365         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17366
 17367     IF  BSUFIXL  GREATER THAN ZEROS
 17368         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17369
 17370     IF  BEFFDTL  GREATER THAN ZEROS
 17371         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17372
 17373 2810-READ-BY-ACCOUNT.
 17374
 17375* EXEC CICS HANDLE CONDITION
 17376*         NOTFND    (2820-PROCESS-REWRITE)
 17377*    END-EXEC.
 17378*    MOVE '"$I                   ! = #00015166' TO DFHEIV0
 17379     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17381     MOVE X'3D20233030303135313636' TO DFHEIV0(25:11)
 17382     CALL 'kxdfhei1' USING DFHEIV0
 17383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17384
 17385
 17386***  read pndb using new key
 17387
 17388* EXEC CICS READ
 17389*        SET     (ADDRESS OF PENDING-BUSINESS)
 17390*        DATASET (FILE-ID-ERPNDB2)
 17391*        RIDFLD  (ERPNDB-ALT-KEY)
 17392*    END-EXEC.
 17393*    MOVE '&"S        E          (   #00015171' TO DFHEIV0
 17394     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17396     MOVE X'2020233030303135313731' TO DFHEIV0(25:11)
 17397     CALL 'kxdfhei1' USING DFHEIV0,
 17398           FILE-ID-ERPNDB2,
 17399           DFHEIV20,
 17400           DFHEIV99,
 17401           ERPNDB-ALT-KEY,
 17402           DFHEIV99,
 17403           DFHEIV99,
 17404           DFHEIV99
 17405     SET ADDRESS OF PENDING-BUSINESS TO
 17406         DFHEIV20
 17407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17408
 17409
 17410     GO TO 2890-DUPLICATE-RECORD.
 17411
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 316
* EL6311.cbl
 17412  2820-PROCESS-REWRITE.
 17413
 17414* EXEC CICS HANDLE CONDITION
 17415*         NOTFND    (2885-RECORD-MISSING)
 17416*    END-EXEC.
 17417*    MOVE '"$I                   ! > #00015180' TO DFHEIV0
 17418     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17420     MOVE X'3E20233030303135313830' TO DFHEIV0(25:11)
 17421     CALL 'kxdfhei1' USING DFHEIV0
 17422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17423
 17424
 17425     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17426
 17427***  read pndb using original key
 17428
 17429* EXEC CICS READ
 17430*        SET     (ADDRESS OF PENDING-BUSINESS)
 17431*        DATASET (FILE-ID-ERPNDB)
 17432*        RIDFLD  (ERPNDB-KEY)
 17433*        UPDATE
 17434*    END-EXEC.
 17435*    MOVE '&"S        EU         (   #00015187' TO DFHEIV0
 17436     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17437     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17438     MOVE X'2020233030303135313837' TO DFHEIV0(25:11)
 17439     CALL 'kxdfhei1' USING DFHEIV0,
 17440           FILE-ID-ERPNDB,
 17441           DFHEIV20,
 17442           DFHEIV99,
 17443           ERPNDB-KEY,
 17444           DFHEIV99,
 17445           DFHEIV99,
 17446           DFHEIV99
 17447     SET ADDRESS OF PENDING-BUSINESS TO
 17448         DFHEIV20
 17449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17450
 17451
 17452     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17453     MOVE 'D'                    TO JP-RECORD-TYPE.
 17454     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17455     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17456
 17457     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17458
 17459     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17460     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17461     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17462
 17463***  delete pndb using original key
 17464
 17465* EXEC CICS DELETE
 17466*        DATASET    (FILE-ID-ERPNDB)
 17467*    END-EXEC.
 17468*    MOVE '&(                    &   #00015206' TO DFHEIV0
 17469     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 317
* EL6311.cbl
 17470     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17471     MOVE X'2020233030303135323036' TO DFHEIV0(25:11)
 17472     CALL 'kxdfhei1' USING DFHEIV0,
 17473           FILE-ID-ERPNDB,
 17474           DFHEIV99,
 17475           DFHEIV99,
 17476           DFHEIV99,
 17477           DFHEIV99
 17478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17479
 17480
 17481     PERFORM 8400-LOG-JOURNAL-RECORD.
 17482
 17483
 17484* EXEC CICS GETMAIN
 17485*        SET      (ADDRESS OF PENDING-BUSINESS)
 17486*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17487*        INITIMG  (GETMAIN-SPACE)
 17488*    END-EXEC.
 17489*    MOVE ',"IL                  $   #00015212' TO DFHEIV0
 17490     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17491     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17492     MOVE X'2020233030303135323132' TO DFHEIV0(25:11)
 17493     CALL 'kxdfhei1' USING DFHEIV0,
 17494           DFHEIV20,
 17495           ERPNDB-RECORD-LENGTH,
 17496           GETMAIN-SPACE
 17497     SET ADDRESS OF PENDING-BUSINESS TO
 17498         DFHEIV20
 17499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17500
 17501
 17502***  pending-business now has original record
 17503     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17504
 17505
 17506* EXEC CICS HANDLE CONDITION
 17507*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17508*    END-EXEC.
 17509*    MOVE '"$I                   ! ? #00015221' TO DFHEIV0
 17510     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17512     MOVE X'3F20233030303135323231' TO DFHEIV0(25:11)
 17513     CALL 'kxdfhei1' USING DFHEIV0
 17514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17515
 17516
 17517***  read elcert using original key
 17518
 17519* EXEC CICS READ
 17520*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17521*        DATASET (FILE-ID-ELCERT)
 17522*        RIDFLD  (ELCERT-KEY)
 17523*        UPDATE
 17524*    END-EXEC.
 17525*    MOVE '&"S        EU         (   #00015226' TO DFHEIV0
 17526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17527     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 318
* EL6311.cbl
 17528     MOVE X'2020233030303135323236' TO DFHEIV0(25:11)
 17529     CALL 'kxdfhei1' USING DFHEIV0,
 17530           FILE-ID-ELCERT,
 17531           DFHEIV20,
 17532           DFHEIV99,
 17533           ELCERT-KEY,
 17534           DFHEIV99,
 17535           DFHEIV99,
 17536           DFHEIV99
 17537     SET ADDRESS OF CERTIFICATE-MASTER TO
 17538         DFHEIV20
 17539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17540
 17541
 17542     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17543     MOVE 'B'                    TO JP-RECORD-TYPE
 17544     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17545     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17546
 17547     IF INSURED-ADDR-PRESENT
 17548        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17549
 17550     IF CERT-NOTES-ARE-NOT-PRESENT
 17551        MOVE SPACE               TO WS-CERT-NOTE-SW
 17552     ELSE
 17553        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17554
 17555     IF CERT-ADDED-BATCH      OR
 17556        CERT-AND-CLAIM-ONLINE OR
 17557        CERT-WAS-CREATED-FOR-CLAIM
 17558        NEXT SENTENCE
 17559     ELSE
 17560        GO TO 2825-DELETE-CERTIFICATE.
 17561
 17562     PERFORM 8400-LOG-JOURNAL-RECORD.
 17563
 17564*********************************************************
 17565** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17566     IF CERT-ADDED-BATCH
 17567         GO TO 2822-REWRITE-ELCERT.
 17568*********************************************************
 17569
 17570     IF NO-CLAIM-ATTACHED
 17571        NEXT SENTENCE
 17572     ELSE
 17573        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17574        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17575
 17576 2822-REWRITE-ELCERT.
 17577     MOVE 'C'                    TO JP-RECORD-TYPE
 17578     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17579
 17580     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17581
 17582
 17583* EXEC CICS REWRITE
 17584*         DATASET    (FILE-ID-ELCERT)
 17585*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 319
* EL6311.cbl
 17586*    END-EXEC.
 17587     MOVE LENGTH OF
 17588      CERTIFICATE-MASTER
 17589       TO DFHEIV11
 17590*    MOVE '&& L                  %   #00015273' TO DFHEIV0
 17591     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17592     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17593     MOVE X'2020233030303135323733' TO DFHEIV0(25:11)
 17594     CALL 'kxdfhei1' USING DFHEIV0,
 17595           FILE-ID-ELCERT,
 17596           CERTIFICATE-MASTER,
 17597           DFHEIV11,
 17598           DFHEIV99
 17599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17600
 17601
 17602     PERFORM 8400-LOG-JOURNAL-RECORD.
 17603
 17604     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17605
 17606 2825-DELETE-CERTIFICATE.
 17607     MOVE 'D'                      TO JP-RECORD-TYPE.
 17608     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17609
 17610     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17611
 17612
 17613* EXEC CICS DELETE
 17614*         DATASET    (FILE-ID-ELCERT)
 17615*    END-EXEC.
 17616*    MOVE '&(                    &   #00015288' TO DFHEIV0
 17617     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17618     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17619     MOVE X'2020233030303135323838' TO DFHEIV0(25:11)
 17620     CALL 'kxdfhei1' USING DFHEIV0,
 17621           FILE-ID-ELCERT,
 17622           DFHEIV99,
 17623           DFHEIV99,
 17624           DFHEIV99,
 17625           DFHEIV99
 17626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17627
 17628
 17629     PERFORM 8400-LOG-JOURNAL-RECORD.
 17630
 17631******************************************************************
 17632*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17633******************************************************************
 17634
 17635     IF CERT-NOTES-ARE-PRESENT
 17636        NEXT SENTENCE
 17637     ELSE
 17638        GO TO 2827-DELETE-MAILING.
 17639
 17640
 17641* EXEC CICS HANDLE CONDITION
 17642*         NOTFND  (2827-DELETE-MAILING)
 17643*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 320
* EL6311.cbl
 17644*    MOVE '"$I                   ! @ #00015303' TO DFHEIV0
 17645     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17647     MOVE X'4020233030303135333033' TO DFHEIV0(25:11)
 17648     CALL 'kxdfhei1' USING DFHEIV0
 17649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17650
 17651
 17652
 17653* EXEC CICS READ
 17654*        EQUAL
 17655*        DATASET   (FILE-ID-ERNOTE)
 17656*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17657*        RIDFLD    (ELCERT-KEY)
 17658*        UPDATE
 17659*    END-EXEC.
 17660*    MOVE '&"S        EU         (   #00015307' TO DFHEIV0
 17661     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17662     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17663     MOVE X'2020233030303135333037' TO DFHEIV0(25:11)
 17664     CALL 'kxdfhei1' USING DFHEIV0,
 17665           FILE-ID-ERNOTE,
 17666           DFHEIV20,
 17667           DFHEIV99,
 17668           ELCERT-KEY,
 17669           DFHEIV99,
 17670           DFHEIV99,
 17671           DFHEIV99
 17672     SET ADDRESS OF CERTIFICATE-NOTE TO
 17673         DFHEIV20
 17674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17675
 17676
 17677     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17678     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17679     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17680
 17681     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17682
 17683
 17684* EXEC CICS DELETE
 17685*        DATASET   (FILE-ID-ERNOTE)
 17686*    END-EXEC.
 17687*    MOVE '&(                    &   #00015321' TO DFHEIV0
 17688     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17689     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17690     MOVE X'2020233030303135333231' TO DFHEIV0(25:11)
 17691     CALL 'kxdfhei1' USING DFHEIV0,
 17692           FILE-ID-ERNOTE,
 17693           DFHEIV99,
 17694           DFHEIV99,
 17695           DFHEIV99,
 17696           DFHEIV99
 17697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17698
 17699
 17700     PERFORM 8400-LOG-JOURNAL-RECORD.
 17701
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 321
* EL6311.cbl
 17702******************************************************************
 17703*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17704******************************************************************
 17705
 17706 2827-DELETE-MAILING.
 17707     IF CERT-ADDRESS-PRESENT
 17708        NEXT SENTENCE
 17709     ELSE
 17710        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17711
 17712
 17713* EXEC CICS HANDLE CONDITION
 17714*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17715*    END-EXEC.
 17716*    MOVE '"$I                   ! A #00015337' TO DFHEIV0
 17717     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17719     MOVE X'4120233030303135333337' TO DFHEIV0(25:11)
 17720     CALL 'kxdfhei1' USING DFHEIV0
 17721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17722
 17723
 17724     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17725
 17726
 17727* EXEC CICS READ
 17728*        EQUAL
 17729*        DATASET   (FILE-ID-ERMAIL)
 17730*        SET       (ADDRESS OF MAILING-DATA)
 17731*        RIDFLD    (ERMAIL-KEY)
 17732*        UPDATE
 17733*    END-EXEC.
 17734*    MOVE '&"S        EU         (   #00015343' TO DFHEIV0
 17735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17736     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17737     MOVE X'2020233030303135333433' TO DFHEIV0(25:11)
 17738     CALL 'kxdfhei1' USING DFHEIV0,
 17739           FILE-ID-ERMAIL,
 17740           DFHEIV20,
 17741           DFHEIV99,
 17742           ERMAIL-KEY,
 17743           DFHEIV99,
 17744           DFHEIV99,
 17745           DFHEIV99
 17746     SET ADDRESS OF MAILING-DATA TO
 17747         DFHEIV20
 17748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17749
 17750
 17751     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17752     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17753     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17754
 17755     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17756
 17757
 17758* EXEC CICS DELETE
 17759*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 322
* EL6311.cbl
 17760*    END-EXEC.
 17761*    MOVE '&(                    &   #00015357' TO DFHEIV0
 17762     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17763     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17764     MOVE X'2020233030303135333537' TO DFHEIV0(25:11)
 17765     CALL 'kxdfhei1' USING DFHEIV0,
 17766           FILE-ID-ERMAIL,
 17767           DFHEIV99,
 17768           DFHEIV99,
 17769           DFHEIV99,
 17770           DFHEIV99
 17771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17772
 17773
 17774     PERFORM 8400-LOG-JOURNAL-RECORD.
 17775
 17776 2830-BUILD-NEW-ISSUE-RECORD.
 17777     MOVE SPACES                 TO ELCERT-KEY.
 17778
 17779     IF  BCERTNOL GREATER THAN ZEROS
 17780         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17781
 17782     IF  BSUFIXL  GREATER THAN ZEROS
 17783         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17784
 17785     IF BEFFDTL GREATER THAN ZEROS
 17786        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17787
 17788 2870-WRITE-PENDING-BUSINESS.
 17789     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17790     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17791     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17792     MOVE '5'                    TO DC-OPTION-CODE.
 17793     PERFORM 9700-DATE-LINK.
 17794     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17795
 17796     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17797
 17798     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17799     MOVE 'A'                    TO JP-RECORD-TYPE.
 17800     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17801
 17802
 17803* EXEC CICS WRITE
 17804*        DATASET  (FILE-ID-ERPNDB)
 17805*        FROM     (PENDING-BUSINESS)
 17806*        RIDFLD   (PB-CONTROL-PRIMARY)
 17807*    END-EXEC.
 17808     MOVE LENGTH OF
 17809      PENDING-BUSINESS
 17810       TO DFHEIV11
 17811*    MOVE '&$ L                  ''   #00015389' TO DFHEIV0
 17812     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17813     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17814     MOVE X'2020233030303135333839' TO DFHEIV0(25:11)
 17815     CALL 'kxdfhei1' USING DFHEIV0,
 17816           FILE-ID-ERPNDB,
 17817           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 323
* EL6311.cbl
 17818           DFHEIV11,
 17819           PB-CONTROL-PRIMARY,
 17820           DFHEIV99,
 17821           DFHEIV99
 17822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17823
 17824
 17825     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17826
 17827     PERFORM 8400-LOG-JOURNAL-RECORD.
 17828
 17829     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17830
 17831 2885-RECORD-MISSING.
 17832     MOVE -1                     TO BMAINTL
 17833     MOVE AL-UABON               TO BMAINTA
 17834     MOVE ER-2902                TO EMI-ERROR.
 17835     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17836     GO TO 8200-SEND-DATAONLY.
 17837
 17838 2890-DUPLICATE-RECORD.
 17839     MOVE -1                     TO BMAINTL.
 17840     MOVE AL-UABON               TO BCERTNOA.
 17841     MOVE AL-UNBON               TO BEFFDTA.
 17842     MOVE SPACE                  TO BMAINTI.
 17843
 17844     MOVE 1                      TO EMI-SUB
 17845                                    EMI-SWITCH1
 17846                                    EMI-SWITCH-AREA-1
 17847                                    EMI-SWITCH-AREA-2.
 17848
 17849     MOVE SPACES                 TO EMI-ERROR-LINES.
 17850
 17851
 17852* EXEC CICS SYNCPOINT ROLLBACK
 17853*    END-EXEC.
 17854*    MOVE '6"R                   !   #00015421' TO DFHEIV0
 17855     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17857     MOVE X'2020233030303135343231' TO DFHEIV0(25:11)
 17858     CALL 'kxdfhei1' USING DFHEIV0
 17859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17860
 17861
 17862     MOVE ER-2247                TO EMI-ERROR.
 17863     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17864     GO TO 8200-SEND-DATAONLY.
 17865
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 324
* EL6311.cbl
 17867
 17868******************************************************************
 17869*                                                                *
 17870*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17871*                                                                *
 17872******************************************************************
 17873
 17874 2900-REWRITE-CAN-CERT-KEY.
 17875     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17876
 17877     IF  CCERTNOL GREATER THAN ZEROS
 17878         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17879
 17880     IF  CSUFIXL  GREATER THAN ZEROS
 17881         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17882
 17883     IF  CEFFDTL  GREATER THAN ZEROS
 17884         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17885
 17886 2910-READ-BY-ACCOUNT.
 17887
 17888* EXEC CICS HANDLE CONDITION
 17889*         NOTFND    (2920-PROCESS-REWRITE)
 17890*    END-EXEC.
 17891*    MOVE '"$I                   ! B #00015449' TO DFHEIV0
 17892     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17893     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17894     MOVE X'4220233030303135343439' TO DFHEIV0(25:11)
 17895     CALL 'kxdfhei1' USING DFHEIV0
 17896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17897
 17898
 17899
 17900* EXEC CICS READ
 17901*        SET     (ADDRESS OF PENDING-BUSINESS)
 17902*        DATASET (FILE-ID-ERPNDB2)
 17903*        RIDFLD  (ERPNDB-ALT-KEY)
 17904*    END-EXEC.
 17905*    MOVE '&"S        E          (   #00015453' TO DFHEIV0
 17906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17908     MOVE X'2020233030303135343533' TO DFHEIV0(25:11)
 17909     CALL 'kxdfhei1' USING DFHEIV0,
 17910           FILE-ID-ERPNDB2,
 17911           DFHEIV20,
 17912           DFHEIV99,
 17913           ERPNDB-ALT-KEY,
 17914           DFHEIV99,
 17915           DFHEIV99,
 17916           DFHEIV99
 17917     SET ADDRESS OF PENDING-BUSINESS TO
 17918         DFHEIV20
 17919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17920
 17921
 17922     GO TO 2990-DUPLICATE-RECORD.
 17923
 17924  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 325
* EL6311.cbl
 17925
 17926* EXEC CICS HANDLE CONDITION
 17927*         NOTFND    (2985-RECORD-MISSING)
 17928*    END-EXEC.
 17929*    MOVE '"$I                   ! C #00015462' TO DFHEIV0
 17930     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17932     MOVE X'4320233030303135343632' TO DFHEIV0(25:11)
 17933     CALL 'kxdfhei1' USING DFHEIV0
 17934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17935
 17936
 17937     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17938
 17939
 17940* EXEC CICS READ
 17941*        SET     (ADDRESS OF PENDING-BUSINESS)
 17942*        DATASET (FILE-ID-ERPNDB)
 17943*        RIDFLD  (ERPNDB-KEY)
 17944*        UPDATE
 17945*    END-EXEC.
 17946*    MOVE '&"S        EU         (   #00015468' TO DFHEIV0
 17947     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17949     MOVE X'2020233030303135343638' TO DFHEIV0(25:11)
 17950     CALL 'kxdfhei1' USING DFHEIV0,
 17951           FILE-ID-ERPNDB,
 17952           DFHEIV20,
 17953           DFHEIV99,
 17954           ERPNDB-KEY,
 17955           DFHEIV99,
 17956           DFHEIV99,
 17957           DFHEIV99
 17958     SET ADDRESS OF PENDING-BUSINESS TO
 17959         DFHEIV20
 17960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17961
 17962
 17963     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17964     MOVE 'D'                    TO JP-RECORD-TYPE.
 17965     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17966     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17967
 17968     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17969
 17970     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17971     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17972     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17973
 17974
 17975* EXEC CICS DELETE
 17976*        DATASET    (FILE-ID-ERPNDB)
 17977*    END-EXEC.
 17978*    MOVE '&(                    &   #00015486' TO DFHEIV0
 17979     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17980     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17981     MOVE X'2020233030303135343836' TO DFHEIV0(25:11)
 17982     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 326
* EL6311.cbl
 17983           FILE-ID-ERPNDB,
 17984           DFHEIV99,
 17985           DFHEIV99,
 17986           DFHEIV99,
 17987           DFHEIV99
 17988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17989
 17990
 17991     PERFORM 8400-LOG-JOURNAL-RECORD.
 17992
 17993
 17994* EXEC CICS GETMAIN
 17995*        SET      (ADDRESS OF PENDING-BUSINESS)
 17996*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17997*        INITIMG  (GETMAIN-SPACE)
 17998*    END-EXEC.
 17999*    MOVE ',"IL                  $   #00015492' TO DFHEIV0
 18000     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18001     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18002     MOVE X'2020233030303135343932' TO DFHEIV0(25:11)
 18003     CALL 'kxdfhei1' USING DFHEIV0,
 18004           DFHEIV20,
 18005           ERPNDB-RECORD-LENGTH,
 18006           GETMAIN-SPACE
 18007     SET ADDRESS OF PENDING-BUSINESS TO
 18008         DFHEIV20
 18009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18010
 18011
 18012     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 18013
 18014 2950-PROCESS-CANCELS.
 18015
 18016
 18017* EXEC CICS HANDLE CONDITION
 18018*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 18019*    END-EXEC.
 18020*    MOVE '"$I                   ! D #00015502' TO DFHEIV0
 18021     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18023     MOVE X'4420233030303135353032' TO DFHEIV0(25:11)
 18024     CALL 'kxdfhei1' USING DFHEIV0
 18025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18026
 18027
 18028
 18029* EXEC CICS READ
 18030*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 18031*        DATASET (FILE-ID-ELCERT)
 18032*        RIDFLD  (ELCERT-KEY)
 18033*        UPDATE
 18034*    END-EXEC.
 18035*    MOVE '&"S        EU         (   #00015506' TO DFHEIV0
 18036     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18037     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18038     MOVE X'2020233030303135353036' TO DFHEIV0(25:11)
 18039     CALL 'kxdfhei1' USING DFHEIV0,
 18040           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 327
* EL6311.cbl
 18041           DFHEIV20,
 18042           DFHEIV99,
 18043           ELCERT-KEY,
 18044           DFHEIV99,
 18045           DFHEIV99,
 18046           DFHEIV99
 18047     SET ADDRESS OF CERTIFICATE-MASTER TO
 18048         DFHEIV20
 18049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18050
 18051
 18052     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18053
 18054     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 18055     MOVE 'B'                      TO JP-RECORD-TYPE.
 18056     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18057     PERFORM 8400-LOG-JOURNAL-RECORD.
 18058
 18059     IF PB-CI-LIVES NOT NUMERIC
 18060         MOVE ZERO                    TO PB-CI-LIVES.
 18061
 18062     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18063        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18064        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 18065        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 18066                                         CM-LF-CANCEL-DT
 18067     ELSE
 18068        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18069        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 18070        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 18071        MOVE PB-CI-LIVES              TO CM-LIVES.
 18072
 18073     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18074        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18075            MOVE CM-LF-STATUS-AT-CANCEL
 18076                                     TO CM-LF-CURRENT-STATUS
 18077            MOVE SPACE
 18078                                     TO CM-LF-STATUS-AT-CANCEL
 18079        ELSE
 18080            MOVE PB-CI-LF-POLICY-STATUS
 18081                                     TO CM-LF-CURRENT-STATUS
 18082     ELSE
 18083        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 18084
 18085     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18086        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18087        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 18088        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 18089                                         CM-AH-CANCEL-DT
 18090     ELSE
 18091        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18092        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 18093        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 18094        MOVE PB-CI-LIVES              TO CM-LIVES.
 18095
 18096     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18097        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18098            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 328
* EL6311.cbl
 18099                                     TO CM-AH-CURRENT-STATUS
 18100            MOVE SPACE
 18101                                     TO CM-AH-STATUS-AT-CANCEL
 18102        ELSE
 18103            MOVE PB-CI-AH-POLICY-STATUS
 18104                                     TO CM-AH-CURRENT-STATUS
 18105     ELSE
 18106        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 18107
 18108 2975-REWRITE-CERT.
 18109     MOVE 'C'                      TO JP-RECORD-TYPE.
 18110     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18111
 18112
 18113* EXEC CICS REWRITE
 18114*        DATASET    (FILE-ID-ELCERT)
 18115*        FROM       (CERTIFICATE-MASTER)
 18116*    END-EXEC.
 18117     MOVE LENGTH OF
 18118      CERTIFICATE-MASTER
 18119       TO DFHEIV11
 18120*    MOVE '&& L                  %   #00015573' TO DFHEIV0
 18121     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18122     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18123     MOVE X'2020233030303135353733' TO DFHEIV0(25:11)
 18124     CALL 'kxdfhei1' USING DFHEIV0,
 18125           FILE-ID-ELCERT,
 18126           CERTIFICATE-MASTER,
 18127           DFHEIV11,
 18128           DFHEIV99
 18129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18130
 18131
 18132     PERFORM 8400-LOG-JOURNAL-RECORD.
 18133
 18134 2960-BUILD-NEW-CANCEL-RECORD.
 18135     IF  CCERTNOL GREATER THAN ZEROS
 18136         MOVE CCERTNOI            TO PB-CERT-PRIME.
 18137
 18138     IF  CSUFIXL  GREATER THAN ZEROS
 18139         MOVE CSUFIXI             TO PB-CERT-SFX.
 18140
 18141     IF  CEFFDTL  GREATER  THAN ZEROS
 18142         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 18143
 18144 2970-WRITE-PENDING-BUSINESS.
 18145     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 18146     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 18147     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 18148     MOVE '5'                    TO DC-OPTION-CODE.
 18149     PERFORM 9700-DATE-LINK.
 18150     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 18151
 18152     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 18153
 18154     MOVE SPACES                 TO PB-CI-INSURED-NAME
 18155                                    PB-CI-INSURED-SEX
 18156                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 329
* EL6311.cbl
 18157                                    PB-CI-AH-BENEFIT-CD
 18158                                    PB-CI-RATE-CLASS
 18159                                    PB-CI-RATE-DEV-LF
 18160                                    PB-CI-RATE-DEV-AH
 18161                                    PB-CI-LF-ABBR
 18162                                    PB-CI-AH-ABBR
 18163                                    PB-CI-OB-FLAG
 18164                                    PB-CI-LF-POLICY-STATUS
 18165                                    PB-CI-AH-POLICY-STATUS
 18166                                    PB-CI-INDV-GRP-CD
 18167                                    PB-CI-BENEFICIARY-NAME
 18168                                    PB-CI-NOTE-SW
 18169                                    PB-CI-SOC-SEC-NO
 18170                                    PB-CI-MEMBER-NO
 18171                                    PB-CI-INT-CODE
 18172                                    PB-CI-COMP-EXCP-SW
 18173                                    PB-CI-ENTRY-STATUS
 18174                                    PB-CI-CREDIT-INTERFACE-SW-1
 18175                                    PB-CI-CREDIT-INTERFACE-SW-2
 18176                                    PB-CI-ENTRY-BATCH.
 18177
 18178     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 18179                                    PB-CI-AH-SETTLEMENT-DT
 18180                                    PB-CI-DEATH-DT
 18181                                    PB-CI-LF-PRIOR-CANCEL-DT
 18182                                    PB-CI-AH-PRIOR-CANCEL-DT
 18183                                    PB-CI-LOAN-1ST-PMT-DT
 18184                                    PB-CI-ENTRY-DT
 18185                                    PB-CI-LF-EXPIRE-DT
 18186                                    PB-CI-AH-EXPIRE-DT.
 18187
 18188     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 18189                                    PB-CI-LF-TERM
 18190                                    PB-CI-LF-BENEFIT-AMT
 18191                                    PB-CI-LF-ALT-BENEFIT-AMT
 18192                                    PB-CI-LF-PREMIUM-AMT
 18193                                    PB-CI-LF-ALT-PREMIUM-AMT
 18194                                    PB-CI-AH-TERM
 18195                                    PB-CI-AH-BENEFIT-AMT
 18196                                    PB-CI-AH-PREMIUM-AMT
 18197                                    PB-CI-RATE-DEV-PCT-LF
 18198                                    PB-CI-RATE-DEV-PCT-AH
 18199                                    PB-CI-LIFE-COMMISSION
 18200                                    PB-CI-AH-COMMISSION
 18201                                    PB-CI-PAY-FREQUENCY
 18202                                    PB-CI-LOAN-APR
 18203                                    PB-CI-LOAN-TERM
 18204                                    PB-CI-CURR-SEQ
 18205                                    PB-CI-AH-CANCEL-AMT
 18206                                    PB-CI-LF-CANCEL-AMT
 18207                                    PB-CI-EXTENTION-DAYS
 18208                                    PB-CI-TERM-IN-DAYS
 18209                                    PB-CI-LOAN-OFFICER
 18210                                    PB-CI-LIVES
 18211                                    PB-CI-LF-CRIT-PER
 18212                                    PB-CI-AH-CRIT-PER
 18213                                    PB-C-LF-REM-TERM
 18214                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 330
* EL6311.cbl
 18215
 18216     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 18217     MOVE 'A'                    TO JP-RECORD-TYPE.
 18218     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18219
 18220
 18221* EXEC CICS HANDLE CONDITION
 18222*        DUPREC   (2990-DUPLICATE-RECORD)
 18223*    END-EXEC.
 18224*    MOVE '"$%                   ! E #00015666' TO DFHEIV0
 18225     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18227     MOVE X'4520233030303135363636' TO DFHEIV0(25:11)
 18228     CALL 'kxdfhei1' USING DFHEIV0
 18229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18230
 18231
 18232
 18233* EXEC CICS WRITE
 18234*        DATASET  (FILE-ID-ERPNDB)
 18235*        FROM     (PENDING-BUSINESS)
 18236*        RIDFLD   (PB-CONTROL-PRIMARY)
 18237*    END-EXEC.
 18238     MOVE LENGTH OF
 18239      PENDING-BUSINESS
 18240       TO DFHEIV11
 18241*    MOVE '&$ L                  ''   #00015670' TO DFHEIV0
 18242     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18243     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18244     MOVE X'2020233030303135363730' TO DFHEIV0(25:11)
 18245     CALL 'kxdfhei1' USING DFHEIV0,
 18246           FILE-ID-ERPNDB,
 18247           PENDING-BUSINESS,
 18248           DFHEIV11,
 18249           PB-CONTROL-PRIMARY,
 18250           DFHEIV99,
 18251           DFHEIV99
 18252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18253
 18254
 18255     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18256
 18257     PERFORM 8400-LOG-JOURNAL-RECORD.
 18258
 18259     GO TO 2325-PROCESS-CANCEL-CHANGES.
 18260
 18261 2985-RECORD-MISSING.
 18262     MOVE -1                     TO CMAINTL
 18263     MOVE AL-UABON               TO CMAINTA.
 18264
 18265     MOVE ER-2902                TO EMI-ERROR.
 18266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18267     GO TO 8200-SEND-DATAONLY.
 18268
 18269 2990-DUPLICATE-RECORD.
 18270     MOVE SPACE                  TO CMAINTI.
 18271     MOVE -1                     TO CMAINTL.
 18272     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 331
* EL6311.cbl
 18273     MOVE AL-UNBON               TO CEFFDTA.
 18274
 18275     MOVE 1                      TO EMI-SUB
 18276                                    EMI-SWITCH1
 18277                                    EMI-SWITCH-AREA-1
 18278                                    EMI-SWITCH-AREA-2.
 18279     MOVE SPACES                 TO EMI-ERROR-LINES.
 18280
 18281
 18282* EXEC CICS SYNCPOINT ROLLBACK
 18283*    END-EXEC.
 18284*    MOVE '6"R                   !   #00015702' TO DFHEIV0
 18285     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18287     MOVE X'2020233030303135373032' TO DFHEIV0(25:11)
 18288     CALL 'kxdfhei1' USING DFHEIV0
 18289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18290
 18291
 18292     MOVE ER-2247                TO EMI-ERROR.
 18293     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18294     GO TO 8200-SEND-DATAONLY.
 18295
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 332
* EL6311.cbl
 18297
 18298***************************************************************
 18299*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 18300*     PREMIUM FOR A SINGLE BATCH.                             *
 18301*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 18302***************************************************************
 18303
 18304 3000-BATCH-MAINLINE.
 18305     IF PI-PREV-KEY NOT = SPACES
 18306         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 18307     ELSE
 18308         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 18309
 18310     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 18311
 18312 3010-READNEXT.
 18313
 18314* EXEC CICS READ
 18315*         DATASET    (FILE-ID-ERPNDB)
 18316*         SET        (ADDRESS OF PENDING-BUSINESS)
 18317*         RIDFLD     (ERPNDB-KEY)
 18318*         GTEQ
 18319*    END-EXEC.
 18320*    MOVE '&"S        G          (   #00015726' TO DFHEIV0
 18321     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18323     MOVE X'2020233030303135373236' TO DFHEIV0(25:11)
 18324     CALL 'kxdfhei1' USING DFHEIV0,
 18325           FILE-ID-ERPNDB,
 18326           DFHEIV20,
 18327           DFHEIV99,
 18328           ERPNDB-KEY,
 18329           DFHEIV99,
 18330           DFHEIV99,
 18331           DFHEIV99
 18332     SET ADDRESS OF PENDING-BUSINESS TO
 18333         DFHEIV20
 18334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18335
 18336
 18337     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18338        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18339          GO TO 3030-END-BATCH.
 18340
 18341     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18342
 18343     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18344        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18345          GO TO 3020-BUMP-SEQ.
 18346
 18347     IF PB-ISSUE
 18348        ADD +1                   TO WS-ISS-TOTAL-CNT
 18349        IF PB-FATAL-ERRORS
 18350           ADD +1                      TO WS-ISS-FATAL-CNT
 18351           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18352           GO TO 3020-BUMP-SEQ
 18353        ELSE
 18354           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 333
* EL6311.cbl
 18355              ADD +1                      TO WS-ISS-FORCE-CNT
 18356              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18357              GO TO 3020-BUMP-SEQ
 18358           ELSE
 18359              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18360                 ADD +1                      TO WS-ISS-HOLD-CNT
 18361                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18362                 GO TO 3020-BUMP-SEQ
 18363              ELSE
 18364                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18365                     THRU  3299-EXIT
 18366                 GO TO 3020-BUMP-SEQ.
 18367
 18368     IF PB-CANCELLATION
 18369        ADD +1                   TO WS-CAN-TOTAL-CNT
 18370        IF PB-FATAL-ERRORS
 18371           ADD +1                 TO WS-CAN-FATAL-CNT
 18372           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18373           GO TO 3020-BUMP-SEQ
 18374        ELSE
 18375           IF PB-UNFORCED-ERRORS
 18376              ADD +1                 TO WS-CAN-FORCE-CNT
 18377              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18378              GO TO 3020-BUMP-SEQ
 18379           ELSE
 18380              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18381                 ADD +1                 TO WS-CAN-HOLD-CNT
 18382                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18383                 GO TO 3020-BUMP-SEQ
 18384              ELSE
 18385                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18386                     THRU  3499-EXIT
 18387                 GO TO 3020-BUMP-SEQ.
 18388
 18389     IF PB-BATCH-TRAILER
 18390         GO TO 3030-END-BATCH.
 18391
 18392 3020-BUMP-SEQ.
 18393     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18394     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18395     GO TO 3010-READNEXT.
 18396
 18397 3030-END-BATCH.
 18398     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18399     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18400     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18401     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18402
 18403     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18404                                          - WS-ISS-FORCE-CNT
 18405                                          - WS-ISS-HOLD-CNT).
 18406
 18407     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18408     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18409
 18410     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18411     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18412     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 334
* EL6311.cbl
 18413     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18414     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18415                                          - WS-CAN-FORCE-CNT
 18416                                          - WS-CAN-HOLD-CNT).
 18417     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18418     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18419
 18420     COMPUTE WS-NET-TOTAL-CNT
 18421         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18422     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18423     COMPUTE WS-NET-FATAL-CNT
 18424         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18425     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18426     COMPUTE WS-NET-FORCE-CNT
 18427         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18428     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18429     COMPUTE WS-NET-HOLD-CNT
 18430         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18431     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18432
 18433     COMPUTE WS-NET-AVAIL-CNT
 18434          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18435                              - WS-ISS-FORCE-CNT
 18436                              - WS-ISS-HOLD-CNT)
 18437          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18438                              - WS-CAN-FORCE-CNT
 18439                              - WS-CAN-HOLD-CNT).
 18440     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18441
 18442     COMPUTE WS-NET-GOOD-PREM
 18443         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18444     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18445     COMPUTE WS-NET-BAD-PREM
 18446         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18447     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18448
 18449     MOVE 0000                   TO EMI-ERROR.
 18450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18451     MOVE -1                     TO DPFENTRL.
 18452     GO TO 8200-SEND-DATAONLY.
 18453
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 335
* EL6311.cbl
 18455
 18456******************************************************************
 18457*                                                                *
 18458*           A D D    B A D   I S S U E   P R E M I U M           *
 18459*                                                                *
 18460******************************************************************
 18461
 18462 3100-ADD-BAD-ISSUE-PREM.
 18463     IF PB-OVERRIDE-LIFE
 18464       OR PB-OVERRIDE-BOTH
 18465           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18466           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18467       ELSE
 18468           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18469           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18470
 18471     IF PB-OVERRIDE-AH
 18472       OR PB-OVERRIDE-BOTH
 18473           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18474       ELSE
 18475           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18476
 18477 3199-EXIT.
 18478     EXIT.
 18479
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 336
* EL6311.cbl
 18481
 18482******************************************************************
 18483*                                                                *
 18484*       A D D   G O O D   I S S U E   P R E M I U M              *
 18485*                                                                *
 18486******************************************************************
 18487
 18488 3200-ADD-GOOD-ISSUE-PREM.
 18489     IF PB-OVERRIDE-LIFE
 18490       OR PB-OVERRIDE-BOTH
 18491           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18492           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18493       ELSE
 18494           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18495           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18496
 18497     IF PB-OVERRIDE-AH
 18498       OR PB-OVERRIDE-BOTH
 18499           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18500       ELSE
 18501           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18502
 18503 3299-EXIT.
 18504     EXIT.
 18505
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 337
* EL6311.cbl
 18507
 18508
 18509******************************************************************
 18510*                                                                *
 18511*        A D D   B A D   C A N C E L   P R E M I U M             *
 18512*                                                                *
 18513******************************************************************
 18514
 18515 3300-ADD-BAD-CANCEL-PREM.
 18516     IF PB-OVERRIDE-LIFE
 18517       OR PB-OVERRIDE-BOTH
 18518           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18519       ELSE
 18520           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18521
 18522     IF PB-OVERRIDE-AH
 18523       OR PB-OVERRIDE-BOTH
 18524           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18525       ELSE
 18526           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18527
 18528 3399-EXIT.
 18529     EXIT.
 18530
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 338
* EL6311.cbl
 18532
 18533******************************************************************
 18534*                                                                *
 18535*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18536*                                                                *
 18537******************************************************************
 18538
 18539 3400-ADD-GOOD-CANCEL-PREM.
 18540     IF PB-OVERRIDE-LIFE
 18541       OR PB-OVERRIDE-BOTH
 18542           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18543       ELSE
 18544           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18545
 18546     IF PB-OVERRIDE-AH
 18547       OR PB-OVERRIDE-BOTH
 18548           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18549       ELSE
 18550           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18551
 18552 3499-EXIT.
 18553     EXIT.
 18554
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 339
* EL6311.cbl
 18556
 18557******************************************************************
 18558*                                                                *
 18559*           E D I T   B A T C H   D A T A                        *
 18560*                                                                *
 18561******************************************************************
 18562
 18563 3500-EDIT-BATCH-DATA.
 18564     IF PI-PREV-KEY NOT = SPACES
 18565        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18566     ELSE
 18567        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18568
 18569     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18570     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18571
 18572
 18573* EXEC CICS HANDLE CONDITION
 18574*         NOTFND      (3590-NOT-FOUND)
 18575*    END-EXEC.
 18576*    MOVE '"$I                   ! F #00015968' TO DFHEIV0
 18577     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18579     MOVE X'4620233030303135393638' TO DFHEIV0(25:11)
 18580     CALL 'kxdfhei1' USING DFHEIV0
 18581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18582
 18583
 18584     IF DRISSL   GREATER THAN ZEROS OR
 18585        DRISSL   GREATER THAN ZEROS OR
 18586        DRLFPRML GREATER THAN ZEROS OR
 18587        DRAHPRML GREATER THAN ZEROS OR
 18588        DRCANCL  GREATER THAN ZEROS OR
 18589        DRLFRFDL GREATER THAN ZEROS OR
 18590        DRAHRFDL GREATER THAN ZEROS
 18591              NEXT SENTENCE
 18592          ELSE
 18593              MOVE ER-3224    TO EMI-ERROR
 18594              MOVE -1         TO DPFENTRL
 18595              MOVE AL-UNBON   TO DPFENTRA
 18596              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18597              GO TO 8200-SEND-DATAONLY.
 18598
 18599     IF NOT MODIFY-CAP
 18600         MOVE 'UPDATE'       TO SM-READ
 18601         PERFORM 9995-SECURITY-VIOLATION
 18602         MOVE ER-0070        TO EMI-ERROR
 18603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18604         GO TO 8100-SEND-INITIAL-MAP.
 18605
 18606        IF DRISSL GREATER THAN ZEROS
 18607           MOVE AL-UNNON         TO DRISSA
 18608           MOVE DRISSI           TO DEEDIT-FIELD
 18609           PERFORM 8600-DEEDIT
 18610           IF DEEDIT-FIELD-V0  NUMERIC
 18611              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18612           ELSE
 18613              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 340
* EL6311.cbl
 18614              MOVE -1         TO DRISSL
 18615              MOVE AL-UNBON   TO DRISSA
 18616              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18617
 18618        IF DRLFPRML GREATER THAN ZEROS
 18619           MOVE AL-UNNON         TO DRLFPRMA
 18620
 18621* EXEC CICS BIF DEEDIT
 18622*              FIELD  (DRLFPRMI)
 18623*              LENGTH (11)
 18624*          END-EXEC
 18625     MOVE 11
 18626       TO DFHEIV11
 18627*    MOVE '@"L                   #   #00016008' TO DFHEIV0
 18628     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18629     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18630     MOVE X'2020233030303136303038' TO DFHEIV0(25:11)
 18631     CALL 'kxdfhei1' USING DFHEIV0,
 18632           DRLFPRMI,
 18633           DFHEIV11
 18634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18635           IF DRLFPRMI NUMERIC
 18636              MOVE DRLFPRMI   TO WS-DRLFPRM
 18637*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18638*          PERFORM 8600-DEEDIT
 18639*          IF DEEDIT-FIELD-V2  NUMERIC
 18640*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18641           ELSE
 18642              MOVE ER-2223    TO EMI-ERROR
 18643              MOVE -1         TO DRLFPRML
 18644              MOVE AL-UNBON   TO DRLFPRMA
 18645              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18646
 18647        IF DRAHPRML GREATER THAN ZEROS
 18648           MOVE AL-UNNON         TO DRAHPRMA
 18649
 18650* EXEC CICS BIF DEEDIT
 18651*              FIELD  (DRAHPRMI)
 18652*              LENGTH (11)
 18653*          END-EXEC
 18654     MOVE 11
 18655       TO DFHEIV11
 18656*    MOVE '@"L                   #   #00016026' TO DFHEIV0
 18657     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18658     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18659     MOVE X'2020233030303136303236' TO DFHEIV0(25:11)
 18660     CALL 'kxdfhei1' USING DFHEIV0,
 18661           DRAHPRMI,
 18662           DFHEIV11
 18663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18664           IF DRAHPRMI NUMERIC
 18665              MOVE DRAHPRMI   TO WS-DRAHPRM
 18666*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18667*          PERFORM 8600-DEEDIT
 18668*          IF DEEDIT-FIELD-V2  NUMERIC
 18669*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18670           ELSE
 18671              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 341
* EL6311.cbl
 18672              MOVE -1         TO DRAHPRML
 18673              MOVE AL-UNBON   TO DRAHPRMA
 18674              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18675
 18676        IF DRCANCL GREATER THAN ZEROS
 18677           MOVE AL-UNNON         TO DRCANCA
 18678           MOVE DRCANCI          TO DEEDIT-FIELD
 18679           PERFORM 8600-DEEDIT
 18680           IF DEEDIT-FIELD-V0  NUMERIC
 18681              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18682           ELSE
 18683              MOVE ER-2223    TO EMI-ERROR
 18684              MOVE -1         TO DRCANCL
 18685              MOVE AL-UNBON   TO DRCANCL
 18686              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18687
 18688        IF DRLFRFDL GREATER THAN ZEROS
 18689           MOVE AL-UNNON         TO DRLFRFDA
 18690
 18691* EXEC CICS BIF DEEDIT
 18692*              FIELD  (DRLFRFDI)
 18693*              LENGTH (11)
 18694*          END-EXEC
 18695     MOVE 11
 18696       TO DFHEIV11
 18697*    MOVE '@"L                   #   #00016056' TO DFHEIV0
 18698     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18699     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18700     MOVE X'2020233030303136303536' TO DFHEIV0(25:11)
 18701     CALL 'kxdfhei1' USING DFHEIV0,
 18702           DRLFRFDI,
 18703           DFHEIV11
 18704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18705           IF DRLFRFDI NUMERIC
 18706              MOVE DRLFRFDI   TO WS-DRLFRFD
 18707*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18708*          PERFORM 8600-DEEDIT
 18709*          IF DEEDIT-FIELD-V2  NUMERIC
 18710*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18711           ELSE
 18712              MOVE ER-2223    TO EMI-ERROR
 18713              MOVE -1         TO DRLFRFDL
 18714              MOVE AL-UNBON   TO DRLFRFDA
 18715              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18716
 18717        IF DRAHRFDL GREATER THAN ZEROS
 18718           MOVE AL-UNNON         TO DRAHRFDA
 18719
 18720* EXEC CICS BIF DEEDIT
 18721*              FIELD  (DRAHRFDI)
 18722*              LENGTH (11)
 18723*          END-EXEC
 18724     MOVE 11
 18725       TO DFHEIV11
 18726*    MOVE '@"L                   #   #00016074' TO DFHEIV0
 18727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18729     MOVE X'2020233030303136303734' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 342
* EL6311.cbl
 18730     CALL 'kxdfhei1' USING DFHEIV0,
 18731           DRAHRFDI,
 18732           DFHEIV11
 18733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18734           IF DRAHRFDI NUMERIC
 18735              MOVE DRAHRFDI   TO WS-DRAHRFD
 18736*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18737*          PERFORM 8600-DEEDIT
 18738*          IF DEEDIT-FIELD-V2  NUMERIC
 18739*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18740           ELSE
 18741              MOVE ER-2223    TO EMI-ERROR
 18742              MOVE -1         TO DRAHRFDL
 18743              MOVE AL-UNBON   TO DRAHRFDA
 18744              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18745
 18746     IF EMI-ERROR = ZEROS
 18747        GO 3600-UPDATE-BATCH-HEADER.
 18748
 18749     GO TO 8200-SEND-DATAONLY.
 18750
 18751 3590-NOT-FOUND.
 18752     MOVE ER-2192                TO EMI-ERROR.
 18753     MOVE -1                     TO DPFENTRL.
 18754     MOVE AL-UNBON               TO DPFENTRA.
 18755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18756     GO TO 8200-SEND-DATAONLY.
 18757
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 343
* EL6311.cbl
 18759
 18760******************************************************************
 18761*                                                                *
 18762*           U P D A T E   B A T C H   H E A D E R                *
 18763*                                                                *
 18764******************************************************************
 18765
 18766 3600-UPDATE-BATCH-HEADER.
 18767
 18768* EXEC CICS HANDLE CONDITION
 18769*         NOTFND      (3690-NOT-FOUND)
 18770*    END-EXEC.
 18771*    MOVE '"$I                   ! G #00016111' TO DFHEIV0
 18772     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18774     MOVE X'4720233030303136313131' TO DFHEIV0(25:11)
 18775     CALL 'kxdfhei1' USING DFHEIV0
 18776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18777
 18778
 18779
 18780* EXEC CICS READ
 18781*        DATASET (FILE-ID-ERPNDB)
 18782*        RIDFLD  (ERPNDB-KEY)
 18783*        SET     (ADDRESS OF PENDING-BUSINESS)
 18784*        UPDATE
 18785*    END-EXEC.
 18786*    MOVE '&"S        EU         (   #00016115' TO DFHEIV0
 18787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18789     MOVE X'2020233030303136313135' TO DFHEIV0(25:11)
 18790     CALL 'kxdfhei1' USING DFHEIV0,
 18791           FILE-ID-ERPNDB,
 18792           DFHEIV20,
 18793           DFHEIV99,
 18794           ERPNDB-KEY,
 18795           DFHEIV99,
 18796           DFHEIV99,
 18797           DFHEIV99
 18798     SET ADDRESS OF PENDING-BUSINESS TO
 18799         DFHEIV20
 18800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18801
 18802
 18803     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18804     MOVE 'B'                    TO JP-RECORD-TYPE.
 18805     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18806
 18807     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18808
 18809     PERFORM 8400-LOG-JOURNAL-RECORD.
 18810
 18811     IF DRISSL GREATER THAN ZEROS
 18812        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18813
 18814     IF DRCANCL GREATER THAN ZEROS
 18815        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18816
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 344
* EL6311.cbl
 18817
 18818     IF DRLFPRML GREATER THAN ZEROS
 18819        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18820
 18821     IF DRAHPRML GREATER THAN ZEROS
 18822        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18823
 18824     IF DRLFRFDL GREATER THAN ZEROS
 18825        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18826
 18827     IF DRAHRFDL GREATER THAN ZEROS
 18828        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18829
 18830 3670-REWRITE-BATCH-HEADER.
 18831     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18832        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18833        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18834        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18835        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18836        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18837        MOVE SPACE               TO PB-OUT-BAL-CD
 18838     ELSE
 18839        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18840
 18841     MOVE 'C'                    TO JP-RECORD-TYPE.
 18842     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18843
 18844
 18845* EXEC CICS REWRITE
 18846*         DATASET      (FILE-ID-ERPNDB)
 18847*         FROM         (PENDING-BUSINESS)
 18848*    END-EXEC.
 18849     MOVE LENGTH OF
 18850      PENDING-BUSINESS
 18851       TO DFHEIV11
 18852*    MOVE '&& L                  %   #00016163' TO DFHEIV0
 18853     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18855     MOVE X'2020233030303136313633' TO DFHEIV0(25:11)
 18856     CALL 'kxdfhei1' USING DFHEIV0,
 18857           FILE-ID-ERPNDB,
 18858           PENDING-BUSINESS,
 18859           DFHEIV11,
 18860           DFHEIV99
 18861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18862
 18863
 18864     PERFORM 8400-LOG-JOURNAL-RECORD.
 18865
 18866     GO TO 7200-DISPLAY-BATCHES.
 18867
 18868 3690-NOT-FOUND.
 18869     MOVE ER-2192                TO EMI-ERROR.
 18870     MOVE -1                     TO DPFENTRL.
 18871     MOVE AL-UNBON               TO DPFENTRA.
 18872     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18873     GO TO 8200-SEND-DATAONLY.
 18874
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 345
* EL6311.cbl
 18876
 18877******************************************************************
 18878*                                                                *
 18879*           R E - D I S P L A Y   R E C O R D                    *
 18880*                                                                *
 18881******************************************************************
 18882
 18883 3900-RE-DISPLAY-RECORD.
 18884
 18885* EXEC CICS HANDLE CONDITION
 18886*         NOTFND   (3990-NOT-FOUND)
 18887*    END-EXEC.
 18888*    MOVE '"$I                   ! H #00016188' TO DFHEIV0
 18889     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18891     MOVE X'4820233030303136313838' TO DFHEIV0(25:11)
 18892     CALL 'kxdfhei1' USING DFHEIV0
 18893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18894
 18895
 18896     IF PI-DISPLAY-ORIGINAL-BATCH
 18897         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18898     ELSE
 18899         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18900
 18901
 18902* EXEC CICS READ
 18903*         DATASET   (FILE-ID)
 18904*         RIDFLD    (PI-PREV-KEY)
 18905*         SET       (ADDRESS OF PENDING-BUSINESS)
 18906*    END-EXEC.
 18907*    MOVE '&"S        E          (   #00016197' TO DFHEIV0
 18908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18910     MOVE X'2020233030303136313937' TO DFHEIV0(25:11)
 18911     CALL 'kxdfhei1' USING DFHEIV0,
 18912           FILE-ID,
 18913           DFHEIV20,
 18914           DFHEIV99,
 18915           PI-PREV-KEY,
 18916           DFHEIV99,
 18917           DFHEIV99,
 18918           DFHEIV99
 18919     SET ADDRESS OF PENDING-BUSINESS TO
 18920         DFHEIV20
 18921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18922
 18923
 18924     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18925
 18926     IF PB-ISSUE
 18927         GO TO 7000-DISPLAY-ISSUES.
 18928
 18929     IF PB-CANCELLATION
 18930         GO TO 7100-DISPLAY-CANCELS.
 18931
 18932     IF PB-BATCH-TRAILER
 18933         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 346
* EL6311.cbl
 18934
 18935 3990-NOT-FOUND.
 18936     MOVE LOW-VALUES             TO EL631BI.
 18937
 18938     IF PI-MAP-NAME = EL631B
 18939         MOVE -1                  TO BMAINTL
 18940     ELSE
 18941         MOVE -1                  TO CMAINTL.
 18942
 18943     GO TO 8100-SEND-INITIAL-MAP.
 18944
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 347
* EL6311.cbl
 18946
 18947***************************************************************
 18948*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18949*                                                             *
 18950*      1. START BROWSE WITH                                   *
 18951*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18952*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18953*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18954*                                                             *
 18955*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18956*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18957*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18958*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18959*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18960*               AND IS IT TO BE DISPLAYED.                    *
 18961*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18962*               DISPLAYED.                                    *
 18963*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18964*               DISPLAYED.                                    *
 18965*                                                             *
 18966*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18967*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18968***************************************************************
 18969
 18970 4000-BROWSE-DETAIL-FORWARD.
 18971     IF FIRST-TIME
 18972        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18973     ELSE
 18974        IF SHOW-RECORD
 18975           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18976           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18977           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18978           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18979           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18980        ELSE
 18981           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18982
 18983
 18984* EXEC CICS HANDLE CONDITION
 18985*         NOTFND   (4050-END-RECORDS)
 18986*         ENDFILE  (4050-END-RECORDS)
 18987*    END-EXEC.
 18988*    MOVE '"$I''                  ! I #00016262' TO DFHEIV0
 18989     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18991     MOVE X'4920233030303136323632' TO DFHEIV0(25:11)
 18992     CALL 'kxdfhei1' USING DFHEIV0
 18993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18994
 18995
 18996
 18997* EXEC CICS STARTBR
 18998*         DATASET   (FILE-ID-ERPNDB2)
 18999*         RIDFLD    (ERPNDB-ALT-KEY)
 19000*    END-EXEC.
 19001     MOVE 0
 19002       TO DFHEIV11
 19003*    MOVE '&,         G          &   #00016267' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 348
* EL6311.cbl
 19004     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19006     MOVE X'2020233030303136323637' TO DFHEIV0(25:11)
 19007     CALL 'kxdfhei1' USING DFHEIV0,
 19008           FILE-ID-ERPNDB2,
 19009           ERPNDB-ALT-KEY,
 19010           DFHEIV99,
 19011           DFHEIV11,
 19012           DFHEIV99
 19013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19014
 19015
 19016     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19017
 19018     IF FIRST-TIME OR SHOW-RECORD
 19019        MOVE SPACE               TO WS-FIRST-TIME-SW
 19020        GO TO 4005-READ-NEXT-RECORD.
 19021
 19022
 19023* EXEC CICS READNEXT
 19024*         DATASET    (FILE-ID-ERPNDB2)
 19025*         SET        (ADDRESS OF PENDING-BUSINESS)
 19026*         RIDFLD     (ERPNDB-ALT-KEY)
 19027*    END-EXEC.
 19028     MOVE 0
 19029       TO DFHEIV11
 19030*    MOVE '&.S                   )   #00016278' TO DFHEIV0
 19031     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19032     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19033     MOVE X'2020233030303136323738' TO DFHEIV0(25:11)
 19034     CALL 'kxdfhei1' USING DFHEIV0,
 19035           FILE-ID-ERPNDB2,
 19036           DFHEIV20,
 19037           DFHEIV99,
 19038           ERPNDB-ALT-KEY,
 19039           DFHEIV99,
 19040           DFHEIV11,
 19041           DFHEIV99,
 19042           DFHEIV99
 19043     SET ADDRESS OF PENDING-BUSINESS TO
 19044         DFHEIV20
 19045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19046
 19047
 19048 4005-READ-NEXT-RECORD.
 19049
 19050* EXEC CICS READNEXT
 19051*         DATASET    (FILE-ID-ERPNDB2)
 19052*         SET        (ADDRESS OF PENDING-BUSINESS)
 19053*         RIDFLD     (ERPNDB-ALT-KEY)
 19054*    END-EXEC.
 19055     MOVE 0
 19056       TO DFHEIV11
 19057*    MOVE '&.S                   )   #00016285' TO DFHEIV0
 19058     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19059     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19060     MOVE X'2020233030303136323835' TO DFHEIV0(25:11)
 19061     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 349
* EL6311.cbl
 19062           FILE-ID-ERPNDB2,
 19063           DFHEIV20,
 19064           DFHEIV99,
 19065           ERPNDB-ALT-KEY,
 19066           DFHEIV99,
 19067           DFHEIV11,
 19068           DFHEIV99,
 19069           DFHEIV99
 19070     SET ADDRESS OF PENDING-BUSINESS TO
 19071         DFHEIV20
 19072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19073
 19074
 19075     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19076
 19077     IF WS-BATCH-PREFIX = '#CL'
 19078        GO TO 4005-READ-NEXT-RECORD.
 19079
 19080     IF SHOW-RECORD
 19081        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 19082           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 19083           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 19084           PB-STATE         NOT = PI-PB-STATE          OR
 19085           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 19086           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 19087           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 19088           GO TO 4050-END-RECORDS
 19089        ELSE
 19090           GO TO 4010-CHECK-REC-TYPE.
 19091
 19092     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 19093        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 19094        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 19095        PB-STATE            NOT = PI-PB-STATE          OR
 19096        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 19097        GO TO 4050-END-RECORDS.
 19098
 19099     IF PB-BATCH-TRAILER
 19100        GO TO 4005-READ-NEXT-RECORD.
 19101
 19102     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19103        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19104           GO TO 4005-READ-NEXT-RECORD
 19105        ELSE
 19106           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19107              GO TO 4010-CHECK-REC-TYPE
 19108           ELSE
 19109              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19110                 GO TO 4010-CHECK-REC-TYPE
 19111              ELSE
 19112                 GO TO 4005-READ-NEXT-RECORD.
 19113
 19114     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19115        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19116           GO TO 4005-READ-NEXT-RECORD.
 19117
 19118 4010-CHECK-REC-TYPE.
 19119     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 350
* EL6311.cbl
 19120         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19121             NEXT SENTENCE
 19122         ELSE
 19123             GO TO 4005-READ-NEXT-RECORD.
 19124
 19125     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19126         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19127             NEXT SENTENCE
 19128        ELSE
 19129             GO TO 4005-READ-NEXT-RECORD.
 19130
 19131     IF NOT DISPLAY-CHANGE-RECORDS AND
 19132            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19133        GO TO 4005-READ-NEXT-RECORD.
 19134
 19135     IF DISPLAY-HOLD-RECORDS AND
 19136        NOT PB-RECORD-ON-HOLD
 19137          GO TO 4005-READ-NEXT-RECORD.
 19138
 19139     IF PB-ISSUE
 19140        IF DISPLAY-CHK-REQ-RECORDS
 19141            GO TO 4005-READ-NEXT-RECORD.
 19142
 19143     IF PB-ISSUE
 19144        IF ISSUE-WITH-WARNING
 19145           IF PB-WARNING-ERRORS
 19146              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19147                  GO TO 4005-READ-NEXT-RECORD
 19148              ELSE
 19149                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19150                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19151                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19152                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19153                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19154                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19155                 GO TO 7000-DISPLAY-ISSUES
 19156           ELSE
 19157              GO TO 4005-READ-NEXT-RECORD.
 19158
 19159     IF PB-ISSUE
 19160        IF (ISSUES-IN-ERROR AND
 19161            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19162            ALL-ISSUES
 19163            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19164            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19165            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19166            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19167            MOVE PB-SV-STATE            TO PI-SV-STATE
 19168            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19169            GO TO 7000-DISPLAY-ISSUES
 19170        ELSE
 19171            GO TO 4005-READ-NEXT-RECORD.
 19172
 19173     IF PB-CANCELLATION
 19174        IF DISPLAY-CHK-REQ-RECORDS
 19175           IF PB-C-REFUND-REQUESTED
 19176              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19177              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 351
* EL6311.cbl
 19178              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19179              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19180              MOVE PB-SV-STATE            TO PI-SV-STATE
 19181              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19182              GO TO 7100-DISPLAY-CANCELS
 19183           ELSE
 19184               GO TO 4005-READ-NEXT-RECORD.
 19185
 19186     IF PB-CANCELLATION
 19187        IF CANCEL-WITH-WARNING
 19188           IF PB-WARNING-ERRORS
 19189              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19190                  GO TO 4005-READ-NEXT-RECORD
 19191              ELSE
 19192                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19193                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19194                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19195                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19196                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19197                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19198                 GO TO 7100-DISPLAY-CANCELS
 19199           ELSE
 19200              GO TO 4005-READ-NEXT-RECORD.
 19201
 19202     IF PB-CANCELLATION
 19203        IF (CANCEL-IN-ERROR  AND
 19204            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19205            ALL-CANCELS
 19206            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19207            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19208            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19209            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19210            MOVE PB-SV-STATE            TO PI-SV-STATE
 19211            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19212            GO TO 7100-DISPLAY-CANCELS.
 19213
 19214     GO TO 4005-READ-NEXT-RECORD.
 19215
 19216 4050-END-RECORDS.
 19217******************************************************************
 19218*                                                                *
 19219*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19220*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19221*         PROGRAM.                                               *
 19222*                                                                *
 19223******************************************************************
 19224
 19225     IF BROWSE-STARTED
 19226        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19227
 19228* EXEC CICS ENDBR
 19229*            DATASET  (FILE-ID-ERPNDB2)
 19230*       END-EXEC.
 19231     MOVE 0
 19232       TO DFHEIV11
 19233*    MOVE '&2                    $   #00016443' TO DFHEIV0
 19234     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 352
* EL6311.cbl
 19236     MOVE X'2020233030303136343433' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0,
 19238           FILE-ID-ERPNDB2,
 19239           DFHEIV11,
 19240           DFHEIV99
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244     IF  EIBTRNID NOT = TRANS-EXB1
 19245         IF PENDING-BUS-RECS-FOUND
 19246             NEXT SENTENCE
 19247           ELSE
 19248             MOVE '9'            TO PI-BROWSE-SW
 19249             GO TO 9400-CLEAR.
 19250
 19251     IF SHOW-RECORD
 19252        MOVE ER-2253            TO EMI-ERROR
 19253       ELSE
 19254        MOVE ER-2254            TO EMI-ERROR.
 19255
 19256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19257
 19258     IF PI-MAP-NAME = SPACES
 19259        MOVE -1                  TO DPFENTRL
 19260        MOVE EL631D               TO PI-MAP-NAME
 19261        GO TO 8100-SEND-INITIAL-MAP.
 19262
 19263     IF PI-MAP-NAME = EL631B
 19264        MOVE -1                  TO BMAINTL
 19265     ELSE
 19266        IF PI-MAP-NAME = EL631C
 19267           MOVE -1               TO CMAINTL
 19268        ELSE
 19269           MOVE -1               TO DPFENTRL.
 19270
 19271     GO TO 8200-SEND-DATAONLY.
 19272
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 353
* EL6311.cbl
 19274
 19275***************************************************************
 19276*                                                             *
 19277*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 19278*                                                             *
 19279*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 19280*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19281*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19282*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 19283*                                                             *
 19284*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19285*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19286*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 19287*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19288*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19289*                AND IS IT TO BE DISPLAYED.                   *
 19290*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19291*                DISPLAYED.                                   *
 19292*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19293*                DISPLAYED.                                   *
 19294*                                                             *
 19295*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19296*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19297*                                                             *
 19298*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19299*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19300*                THEY ARE NOT TO BE DISPLAYED.                *
 19301*                                                             *
 19302***************************************************************
 19303
 19304 4100-BROWSE-PRIMARY-FORWARD.
 19305     IF FIRST-TIME  OR SHOW-RECORD
 19306        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 19307        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 19308        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 19309     ELSE
 19310        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 19311        IF ERPNDB-BATCH-SEQ-NO = +9999
 19312           GO TO 4150-END-BATCH
 19313        ELSE
 19314           IF DISPLAY-CHANGE-RECORDS
 19315              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19316           ELSE
 19317              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19318              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19319
 19320     IF FIRST-TIME
 19321         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19322            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19323              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19324
 19325
 19326* EXEC CICS HANDLE CONDITION
 19327*         ENDFILE  (4150-END-BATCH)
 19328*    END-EXEC.
 19329*    MOVE '"$''                   ! J #00016528' TO DFHEIV0
 19330     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 354
* EL6311.cbl
 19332     MOVE X'4A20233030303136353238' TO DFHEIV0(25:11)
 19333     CALL 'kxdfhei1' USING DFHEIV0
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19335
 19336
 19337 4105-READ-NEXT.
 19338
 19339* EXEC CICS HANDLE CONDITION
 19340*         NOTFND    (4150-END-BATCH)
 19341*    END-EXEC.
 19342*    MOVE '"$I                   ! K #00016533' TO DFHEIV0
 19343     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19345     MOVE X'4B20233030303136353333' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0
 19347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19348
 19349
 19350     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19351
 19352     IF PI-DISPLAY-ORIGINAL-BATCH
 19353        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19354     ELSE
 19355        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19356
 19357
 19358* EXEC CICS READ
 19359*         DATASET   (FILE-ID)
 19360*         SET       (ADDRESS OF PENDING-BUSINESS)
 19361*         RIDFLD    (ERPNDB-KEY)
 19362*         GTEQ
 19363*    END-EXEC.
 19364*    MOVE '&"S        G          (   #00016544' TO DFHEIV0
 19365     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19367     MOVE X'2020233030303136353434' TO DFHEIV0(25:11)
 19368     CALL 'kxdfhei1' USING DFHEIV0,
 19369           FILE-ID,
 19370           DFHEIV20,
 19371           DFHEIV99,
 19372           ERPNDB-KEY,
 19373           DFHEIV99,
 19374           DFHEIV99,
 19375           DFHEIV99
 19376     SET ADDRESS OF PENDING-BUSINESS TO
 19377         DFHEIV20
 19378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19379
 19380
 19381     IF PI-DISPLAY-ORIGINAL-BATCH
 19382        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19383           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19384           GO TO 4150-END-BATCH
 19385        ELSE
 19386           IF PB-BATCH-TRAILER
 19387              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19388              GO TO 4105-READ-NEXT
 19389           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 355
* EL6311.cbl
 19390              NEXT SENTENCE
 19391     ELSE
 19392        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19393           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19394           GO TO 4150-END-BATCH.
 19395
 19396     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19397
 19398     IF WS-BATCH-PREFIX = '#CL'
 19399         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19400         GO TO 4105-READ-NEXT.
 19401
 19402     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19403     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19404     MOVE PB-STATE               TO PI-PB-STATE.
 19405     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19406
 19407     IF PB-BATCH-TRAILER
 19408        IF SHOW-RECORD
 19409           GO TO 4150-END-BATCH
 19410        ELSE
 19411           MOVE ER-2251         TO EMI-ERROR
 19412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19413           MOVE 1               TO PI-BROWSE-TYPE
 19414           GO TO 7200-DISPLAY-BATCHES.
 19415
 19416     IF SHOW-RECORD
 19417           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19418              GO TO 4110-BUMP-SEQ
 19419           ELSE
 19420              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19421                 GO TO 4110-BUMP-SEQ
 19422              ELSE
 19423                 GO TO 4107-CHECK-REC-TYPE.
 19424
 19425     IF NOT  PI-PRIMARY-WITH-SELECT
 19426        GO TO 4107-CHECK-REC-TYPE.
 19427
 19428     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19429        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19430           GO TO 4110-BUMP-SEQ
 19431        ELSE
 19432           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19433              GO TO 4107-CHECK-REC-TYPE
 19434           ELSE
 19435              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19436                 GO TO 4107-CHECK-REC-TYPE
 19437              ELSE
 19438                 GO TO 4110-BUMP-SEQ.
 19439
 19440     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19441        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19442           GO TO 4110-BUMP-SEQ.
 19443
 19444 4107-CHECK-REC-TYPE.
 19445     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19446         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19447             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 356
* EL6311.cbl
 19448           ELSE
 19449             GO TO 4110-BUMP-SEQ.
 19450
 19451     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19452         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19453             NEXT SENTENCE
 19454           ELSE
 19455             GO TO 4110-BUMP-SEQ.
 19456
 19457     IF NOT DISPLAY-CHANGE-RECORDS AND
 19458        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19459           GO TO 4110-BUMP-SEQ.
 19460
 19461     IF DISPLAY-HOLD-RECORDS AND
 19462        NOT PB-RECORD-ON-HOLD
 19463          GO TO 4110-BUMP-SEQ.
 19464
 19465     IF PB-ISSUE
 19466        IF DISPLAY-CHK-REQ-RECORDS
 19467            GO TO 4110-BUMP-SEQ.
 19468
 19469     IF PB-ISSUE
 19470        IF ISSUE-WITH-WARNING
 19471           IF PB-WARNING-ERRORS
 19472              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19473                  GO TO 4110-BUMP-SEQ
 19474              ELSE
 19475                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19476                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19477                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19478                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19479                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19480                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19481                 GO TO 7000-DISPLAY-ISSUES
 19482        ELSE
 19483            GO TO 4110-BUMP-SEQ.
 19484
 19485     IF PB-ISSUE
 19486        IF (ISSUES-IN-ERROR AND
 19487            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19488            ALL-ISSUES
 19489            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19490            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19491            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19492            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19493            MOVE PB-SV-STATE            TO PI-SV-STATE
 19494            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19495            GO TO 7000-DISPLAY-ISSUES
 19496        ELSE
 19497            GO TO 4110-BUMP-SEQ.
 19498
 19499     IF PB-CANCELLATION
 19500        IF DISPLAY-CHK-REQ-RECORDS
 19501           IF PB-C-REFUND-REQUESTED
 19502              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19503              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19504              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19505              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 357
* EL6311.cbl
 19506              MOVE PB-SV-STATE            TO PI-SV-STATE
 19507              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19508              GO TO 7100-DISPLAY-CANCELS
 19509           ELSE
 19510              GO TO 4110-BUMP-SEQ.
 19511
 19512     IF PB-CANCELLATION
 19513        IF CANCEL-WITH-WARNING
 19514           IF PB-WARNING-ERRORS
 19515              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19516                  GO TO 4110-BUMP-SEQ
 19517              ELSE
 19518                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19519                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19520                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19521                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19522                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19523                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19524                 GO TO 7100-DISPLAY-CANCELS
 19525           ELSE
 19526              GO TO 4110-BUMP-SEQ.
 19527
 19528     IF PB-CANCELLATION
 19529        IF (CANCEL-IN-ERROR  AND
 19530            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19531            ALL-CANCELS
 19532            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19533            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19534            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19535            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19536            MOVE PB-SV-STATE            TO PI-SV-STATE
 19537            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19538            GO TO 7100-DISPLAY-CANCELS.
 19539
 19540 4110-BUMP-SEQ.
 19541     IF NOT DISPLAY-CHANGE-RECORDS
 19542        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19543        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19544     ELSE
 19545        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19546           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19547           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19548        ELSE
 19549           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19550           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19551
 19552     GO TO 4105-READ-NEXT.
 19553
 19554 4150-END-BATCH.
 19555******************************************************************
 19556*                                                                *
 19557*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19558*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19559*         PROGRAM.                                               *
 19560*                                                                *
 19561******************************************************************
 19562
 19563     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 358
* EL6311.cbl
 19564         IF PENDING-BUS-RECS-FOUND
 19565             NEXT SENTENCE
 19566           ELSE
 19567             MOVE '9'            TO PI-BROWSE-SW
 19568             GO TO 9400-CLEAR.
 19569
 19570     IF SHOW-RECORD
 19571        MOVE ER-2253             TO EMI-ERROR
 19572     ELSE
 19573        MOVE ER-2251             TO EMI-ERROR.
 19574
 19575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19576
 19577     IF PI-MAP-NAME = SPACES
 19578        MOVE -1                  TO BMAINTL
 19579        MOVE EL631B              TO PI-MAP-NAME
 19580        GO TO 8100-SEND-INITIAL-MAP.
 19581
 19582     IF PI-MAP-NAME = EL631B
 19583        MOVE -1                  TO BMAINTL
 19584     ELSE
 19585        IF PI-MAP-NAME = EL631C
 19586           MOVE -1               TO CMAINTL
 19587        ELSE
 19588           MOVE -1               TO DPFENTRL.
 19589
 19590     GO TO 8200-SEND-DATAONLY.
 19591
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 359
* EL6311.cbl
 19593
 19594***************************************************************
 19595*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19596*                                                             *
 19597*      1. START BROWSE WITH                                   *
 19598*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19599*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19600*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19601*                                                             *
 19602*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19603*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19604*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19605*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19606*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19607*               AND IS IT TO BE DISPLAYED.                    *
 19608*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19609*               DISPLAYED.                                    *
 19610*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19611*               DISPLAYED.                                    *
 19612*                                                             *
 19613*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19614*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19615***************************************************************
 19616
 19617 4200-BROWSE-CSR-FORWARD.
 19618
 19619     IF FIRST-TIME
 19620        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19621     ELSE
 19622        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19623
 19624
 19625* EXEC CICS HANDLE CONDITION
 19626*         NOTFND   (4250-END-RECORDS)
 19627*         ENDFILE  (4250-END-RECORDS)
 19628*    END-EXEC.
 19629*    MOVE '"$I''                  ! L #00016794' TO DFHEIV0
 19630     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19632     MOVE X'4C20233030303136373934' TO DFHEIV0(25:11)
 19633     CALL 'kxdfhei1' USING DFHEIV0
 19634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19635
 19636
 19637
 19638* EXEC CICS STARTBR
 19639*         DATASET   (FILE-ID-ERPNDB4)
 19640*         RIDFLD    (ERPNDB-CSR-KEY)
 19641*    END-EXEC.
 19642     MOVE 0
 19643       TO DFHEIV11
 19644*    MOVE '&,         G          &   #00016799' TO DFHEIV0
 19645     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19647     MOVE X'2020233030303136373939' TO DFHEIV0(25:11)
 19648     CALL 'kxdfhei1' USING DFHEIV0,
 19649           FILE-ID-ERPNDB4,
 19650           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 360
* EL6311.cbl
 19651           DFHEIV99,
 19652           DFHEIV11,
 19653           DFHEIV99
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19655
 19656
 19657     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19658
 19659     IF FIRST-TIME
 19660        MOVE SPACE               TO WS-FIRST-TIME-SW
 19661        GO TO 4205-READ-NEXT-RECORD.
 19662
 19663
 19664* EXEC CICS READNEXT
 19665*         DATASET    (FILE-ID-ERPNDB4)
 19666*         SET        (ADDRESS OF PENDING-BUSINESS)
 19667*         RIDFLD     (ERPNDB-CSR-KEY)
 19668*    END-EXEC.
 19669     MOVE 0
 19670       TO DFHEIV11
 19671*    MOVE '&.S                   )   #00016810' TO DFHEIV0
 19672     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19673     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19674     MOVE X'2020233030303136383130' TO DFHEIV0(25:11)
 19675     CALL 'kxdfhei1' USING DFHEIV0,
 19676           FILE-ID-ERPNDB4,
 19677           DFHEIV20,
 19678           DFHEIV99,
 19679           ERPNDB-CSR-KEY,
 19680           DFHEIV99,
 19681           DFHEIV11,
 19682           DFHEIV99,
 19683           DFHEIV99
 19684     SET ADDRESS OF PENDING-BUSINESS TO
 19685         DFHEIV20
 19686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19687
 19688
 19689 4205-READ-NEXT-RECORD.
 19690
 19691
 19692* EXEC CICS READNEXT
 19693*         DATASET    (FILE-ID-ERPNDB4)
 19694*         SET        (ADDRESS OF PENDING-BUSINESS)
 19695*         RIDFLD     (ERPNDB-CSR-KEY)
 19696*    END-EXEC.
 19697     MOVE 0
 19698       TO DFHEIV11
 19699*    MOVE '&.S                   )   #00016818' TO DFHEIV0
 19700     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19701     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19702     MOVE X'2020233030303136383138' TO DFHEIV0(25:11)
 19703     CALL 'kxdfhei1' USING DFHEIV0,
 19704           FILE-ID-ERPNDB4,
 19705           DFHEIV20,
 19706           DFHEIV99,
 19707           ERPNDB-CSR-KEY,
 19708           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 361
* EL6311.cbl
 19709           DFHEIV11,
 19710           DFHEIV99,
 19711           DFHEIV99
 19712     SET ADDRESS OF PENDING-BUSINESS TO
 19713         DFHEIV20
 19714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19715
 19716
 19717     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19718
 19719     IF WS-BATCH-PREFIX = '#CL'
 19720        GO TO 4205-READ-NEXT-RECORD.
 19721
 19722     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19723        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19724        GO TO 4250-END-RECORDS.
 19725
 19726     IF PB-BATCH-TRAILER
 19727        GO TO 4205-READ-NEXT-RECORD.
 19728
 19729     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19730        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19731           GO TO 4205-READ-NEXT-RECORD
 19732        ELSE
 19733           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19734              GO TO 4210-CHECK-REC-TYPE
 19735           ELSE
 19736              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19737                 GO TO 4210-CHECK-REC-TYPE
 19738              ELSE
 19739                 GO TO 4205-READ-NEXT-RECORD.
 19740
 19741     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19742        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19743           GO TO 4205-READ-NEXT-RECORD.
 19744
 19745 4210-CHECK-REC-TYPE.
 19746     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19747         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19748             NEXT SENTENCE
 19749         ELSE
 19750             GO TO 4205-READ-NEXT-RECORD.
 19751
 19752     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19753         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19754             NEXT SENTENCE
 19755        ELSE
 19756             GO TO 4205-READ-NEXT-RECORD.
 19757
 19758     IF NOT DISPLAY-CHANGE-RECORDS AND
 19759            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19760        GO TO 4205-READ-NEXT-RECORD.
 19761
 19762     IF DISPLAY-HOLD-RECORDS AND
 19763        NOT PB-RECORD-ON-HOLD
 19764          GO TO 4205-READ-NEXT-RECORD.
 19765
 19766     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 362
* EL6311.cbl
 19767        IF DISPLAY-CHK-REQ-RECORDS
 19768            GO TO 4205-READ-NEXT-RECORD.
 19769
 19770     IF PB-ISSUE
 19771        IF ISSUE-WITH-WARNING
 19772           IF PB-WARNING-ERRORS
 19773              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19774                  GO TO 4205-READ-NEXT-RECORD
 19775              ELSE
 19776                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19777                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19778                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19779                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19780                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19781                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19782                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19783                 GO TO 7000-DISPLAY-ISSUES
 19784           ELSE
 19785              GO TO 4205-READ-NEXT-RECORD.
 19786
 19787     IF PB-ISSUE
 19788        IF (ISSUES-IN-ERROR AND
 19789            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19790            ALL-ISSUES
 19791            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19792            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19793            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19794            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19795            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19796            MOVE PB-SV-STATE            TO PI-SV-STATE
 19797            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19798            GO TO 7000-DISPLAY-ISSUES
 19799        ELSE
 19800            GO TO 4205-READ-NEXT-RECORD.
 19801
 19802     IF PB-CANCELLATION
 19803        IF DISPLAY-CHK-REQ-RECORDS
 19804           IF PB-C-REFUND-REQUESTED
 19805              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19806              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19807              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19808              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19809              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19810              MOVE PB-SV-STATE            TO PI-SV-STATE
 19811              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19812              GO TO 7100-DISPLAY-CANCELS
 19813           ELSE
 19814               GO TO 4205-READ-NEXT-RECORD.
 19815
 19816     IF PB-CANCELLATION
 19817        IF CANCEL-WITH-WARNING
 19818           IF PB-WARNING-ERRORS
 19819              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19820                  GO TO 4205-READ-NEXT-RECORD
 19821              ELSE
 19822                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19823                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19824                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 363
* EL6311.cbl
 19825                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19826                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19827                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19828                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19829                 GO TO 7100-DISPLAY-CANCELS
 19830           ELSE
 19831              GO TO 4205-READ-NEXT-RECORD.
 19832
 19833     IF PB-CANCELLATION
 19834        IF (CANCEL-IN-ERROR  AND
 19835            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19836            ALL-CANCELS
 19837            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19838            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19839            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19840            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19841            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19842            MOVE PB-SV-STATE            TO PI-SV-STATE
 19843            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19844            GO TO 7100-DISPLAY-CANCELS.
 19845
 19846     GO TO 4205-READ-NEXT-RECORD.
 19847
 19848 4250-END-RECORDS.
 19849******************************************************************
 19850*                                                                *
 19851*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19852*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19853*         PROGRAM.                                               *
 19854*                                                                *
 19855******************************************************************
 19856
 19857     IF BROWSE-STARTED
 19858        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19859
 19860* EXEC CICS ENDBR
 19861*            DATASET  (FILE-ID-ERPNDB4)
 19862*       END-EXEC.
 19863     MOVE 0
 19864       TO DFHEIV11
 19865*    MOVE '&2                    $   #00016966' TO DFHEIV0
 19866     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19867     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19868     MOVE X'2020233030303136393636' TO DFHEIV0(25:11)
 19869     CALL 'kxdfhei1' USING DFHEIV0,
 19870           FILE-ID-ERPNDB4,
 19871           DFHEIV11,
 19872           DFHEIV99
 19873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19874
 19875
 19876     IF  EIBTRNID NOT = TRANS-EXB1
 19877         IF PENDING-BUS-RECS-FOUND
 19878             NEXT SENTENCE
 19879           ELSE
 19880             MOVE '9'            TO PI-BROWSE-SW
 19881             GO TO 9400-CLEAR.
 19882
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 364
* EL6311.cbl
 19883     IF SHOW-RECORD
 19884        MOVE ER-2253            TO EMI-ERROR
 19885       ELSE
 19886        MOVE ER-2254            TO EMI-ERROR.
 19887
 19888     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19889
 19890     IF PI-MAP-NAME = SPACES
 19891        MOVE -1                  TO DPFENTRL
 19892        MOVE EL631D               TO PI-MAP-NAME
 19893        GO TO 8100-SEND-INITIAL-MAP.
 19894
 19895     IF PI-MAP-NAME = EL631B
 19896        MOVE -1                  TO BMAINTL
 19897     ELSE
 19898        IF PI-MAP-NAME = EL631C
 19899           MOVE -1               TO CMAINTL
 19900        ELSE
 19901           MOVE -1               TO DPFENTRL.
 19902
 19903     GO TO 8200-SEND-DATAONLY.
 19904
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 365
* EL6311.cbl
 19906
 19907***************************************************************
 19908*                                                             *
 19909*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19910*                                                             *
 19911*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19912*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19913*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19914*                                                             *
 19915*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19916*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19917*          A. IS IT WITHIN THE SAME COMPANY                   *
 19918*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19919*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19920*                AND IS IT TO BE DISPLAYED.                   *
 19921*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19922*                DISPLAYED.                                   *
 19923*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19924*                DISPLAYED.                                   *
 19925*                                                             *
 19926*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19927*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19928*                                                             *
 19929*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19930*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19931*                THEY ARE NOT TO BE DISPLAYED.                *
 19932*                                                             *
 19933***************************************************************
 19934
 19935 4300-BROWSE-FILE-FORWARD.
 19936     IF FIRST-TIME OR SHOW-RECORD
 19937        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19938        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19939        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19940     ELSE
 19941        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19942        IF ERPNDB-BATCH-SEQ-NO = +9999
 19943           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19944        ELSE
 19945           IF DISPLAY-CHANGE-RECORDS
 19946              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19947           ELSE
 19948              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19949              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19950
 19951
 19952* EXEC CICS HANDLE CONDITION
 19953*         ENDFILE  (4350-END-BATCH)
 19954*         NOTFND   (4350-END-BATCH)
 19955*    END-EXEC.
 19956*    MOVE '"$''I                  ! M #00017045' TO DFHEIV0
 19957     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19959     MOVE X'4D20233030303137303435' TO DFHEIV0(25:11)
 19960     CALL 'kxdfhei1' USING DFHEIV0
 19961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19962
 19963
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 366
* EL6311.cbl
 19964 4305-READ-NEXT.
 19965     IF PI-DISPLAY-ORIGINAL-BATCH
 19966        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19967     ELSE
 19968        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19969
 19970
 19971* EXEC CICS READ
 19972*         DATASET   (FILE-ID)
 19973*         SET       (ADDRESS OF PENDING-BUSINESS)
 19974*         RIDFLD    (ERPNDB-KEY)
 19975*         GTEQ
 19976*    END-EXEC.
 19977*    MOVE '&"S        G          (   #00017056' TO DFHEIV0
 19978     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19980     MOVE X'2020233030303137303536' TO DFHEIV0(25:11)
 19981     CALL 'kxdfhei1' USING DFHEIV0,
 19982           FILE-ID,
 19983           DFHEIV20,
 19984           DFHEIV99,
 19985           ERPNDB-KEY,
 19986           DFHEIV99,
 19987           DFHEIV99,
 19988           DFHEIV99
 19989     SET ADDRESS OF PENDING-BUSINESS TO
 19990         DFHEIV20
 19991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19992
 19993
 19994     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19995        GO TO 4350-END-BATCH.
 19996
 19997     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19998                                    WS-BATCH-NO.
 19999
 20000     IF  WS-BATCH-PREFIX = '#CL'
 20001         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20002         GO TO 4305-READ-NEXT.
 20003
 20004     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 20005     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 20006     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 20007     MOVE PB-STATE               TO PI-PB-STATE.
 20008     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 20009
 20010     IF PB-BATCH-TRAILER
 20011        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 20012        GO TO 4305-READ-NEXT.
 20013
 20014     IF SHOW-RECORD
 20015           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 20016              GO TO 4310-BUMP-SEQ
 20017           ELSE
 20018              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20019                 GO TO 4310-BUMP-SEQ
 20020              ELSE
 20021                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 367
* EL6311.cbl
 20022
 20023     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20024        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20025           GO TO 4310-BUMP-SEQ
 20026        ELSE
 20027           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20028              GO TO 4307-CHECK-REC-TYPE
 20029           ELSE
 20030              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20031                 GO TO 4307-CHECK-REC-TYPE
 20032              ELSE
 20033                 GO TO 4310-BUMP-SEQ.
 20034
 20035     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20036        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20037           GO TO 4310-BUMP-SEQ.
 20038
 20039 4307-CHECK-REC-TYPE.
 20040     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20041         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20042             NEXT SENTENCE
 20043         ELSE
 20044             GO TO 4310-BUMP-SEQ.
 20045
 20046     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20047         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20048             NEXT SENTENCE
 20049        ELSE
 20050             GO TO 4310-BUMP-SEQ.
 20051
 20052     IF NOT DISPLAY-CHANGE-RECORDS AND
 20053            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20054        GO TO 4310-BUMP-SEQ.
 20055
 20056     IF DISPLAY-HOLD-RECORDS AND
 20057        NOT PB-RECORD-ON-HOLD
 20058          GO TO 4310-BUMP-SEQ.
 20059
 20060     IF PB-ISSUE
 20061        IF DISPLAY-CHK-REQ-RECORDS
 20062           GO TO 4310-BUMP-SEQ.
 20063
 20064     IF PB-ISSUE
 20065        IF ISSUE-WITH-WARNING
 20066           IF PB-WARNING-ERRORS
 20067              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20068                  GO TO 4310-BUMP-SEQ
 20069              ELSE
 20070                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20071                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20072                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20073                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20074                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20075                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20076                 GO TO 7000-DISPLAY-ISSUES
 20077           ELSE
 20078              GO TO 4310-BUMP-SEQ.
 20079
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 368
* EL6311.cbl
 20080     IF PB-ISSUE
 20081        IF (ISSUES-IN-ERROR AND
 20082            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20083            ALL-ISSUES
 20084            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20085            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20086            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20087            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20088            MOVE PB-SV-STATE            TO PI-SV-STATE
 20089            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20090            GO TO 7000-DISPLAY-ISSUES
 20091        ELSE
 20092            GO TO 4310-BUMP-SEQ.
 20093
 20094     IF PB-CANCELLATION
 20095        IF DISPLAY-CHK-REQ-RECORDS
 20096           IF PB-C-REFUND-REQUESTED
 20097              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20098              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20099              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20100              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20101              MOVE PB-SV-STATE            TO PI-SV-STATE
 20102              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20103              GO TO 7100-DISPLAY-CANCELS
 20104           ELSE
 20105              GO TO 4310-BUMP-SEQ.
 20106
 20107     IF PB-CANCELLATION
 20108        IF CANCEL-WITH-WARNING
 20109           IF PB-WARNING-ERRORS
 20110              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20111                  GO TO 4310-BUMP-SEQ
 20112              ELSE
 20113                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20114                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20115                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20116                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20117                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20118                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20119                 GO TO 7100-DISPLAY-CANCELS
 20120           ELSE
 20121              GO TO 4310-BUMP-SEQ.
 20122
 20123     IF PB-CANCELLATION
 20124        IF (CANCEL-IN-ERROR  AND
 20125            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20126            ALL-CANCELS
 20127            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20128            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20129            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20130            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20131            MOVE PB-SV-STATE            TO PI-SV-STATE
 20132            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20133            GO TO 7100-DISPLAY-CANCELS.
 20134
 20135 4310-BUMP-SEQ.
 20136     IF NOT DISPLAY-CHANGE-RECORDS
 20137        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 369
* EL6311.cbl
 20138        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 20139     ELSE
 20140        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 20141           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 20142           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 20143        ELSE
 20144           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 20145           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 20146
 20147     GO TO 4305-READ-NEXT.
 20148
 20149 4350-END-BATCH.
 20150
 20151******************************************************************
 20152*                                                                *
 20153*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20154*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 20155*         PROGRAM.                                               *
 20156*                                                                *
 20157******************************************************************
 20158
 20159     IF  EIBTRNID NOT = TRANS-EXB1
 20160         IF PENDING-BUS-RECS-FOUND
 20161             NEXT SENTENCE
 20162           ELSE
 20163             MOVE '9'            TO PI-BROWSE-SW
 20164             GO TO 9400-CLEAR.
 20165
 20166     IF SHOW-RECORD
 20167        MOVE ER-2253            TO EMI-ERROR
 20168     ELSE
 20169        MOVE ER-2251            TO EMI-ERROR.
 20170
 20171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20172
 20173     IF PI-MAP-NAME = SPACES
 20174        MOVE -1                  TO BMAINTL
 20175        MOVE EL631B               TO PI-MAP-NAME
 20176        GO TO 8100-SEND-INITIAL-MAP.
 20177
 20178     IF PI-MAP-NAME = EL631B
 20179        MOVE -1                  TO BMAINTL
 20180     ELSE
 20181        IF PI-MAP-NAME = EL631C
 20182           MOVE -1               TO CMAINTL
 20183        ELSE
 20184           MOVE -1               TO DPFENTRL.
 20185
 20186     GO TO 8200-SEND-DATAONLY.
 20187
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 370
* EL6311.cbl
 20189
 20190******************************************************************
 20191*                                                                *
 20192*        B R O W S E   D E T A I L   B A C K W A R D             *
 20193*                                                                *
 20194******************************************************************
 20195
 20196 4500-BROWSE-DETAIL-BACKWARD.
 20197
 20198     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 20199
 20200
 20201* EXEC CICS HANDLE CONDITION
 20202*         NOTFND   (4570-NOT-FOUND)
 20203*         ENDFILE  (4550-END-RECORDS)
 20204*    END-EXEC
 20205*    MOVE '"$I''                  ! N #00017269' TO DFHEIV0
 20206     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20208     MOVE X'4E20233030303137323639' TO DFHEIV0(25:11)
 20209     CALL 'kxdfhei1' USING DFHEIV0
 20210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20211
 20212
 20213* EXEC CICS STARTBR
 20214*         DATASET   (FILE-ID-ERPNDB2)
 20215*         RIDFLD    (ERPNDB-ALT-KEY)
 20216*    END-EXEC.
 20217     MOVE 0
 20218       TO DFHEIV11
 20219*    MOVE '&,         G          &   #00017274' TO DFHEIV0
 20220     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20222     MOVE X'2020233030303137323734' TO DFHEIV0(25:11)
 20223     CALL 'kxdfhei1' USING DFHEIV0,
 20224           FILE-ID-ERPNDB2,
 20225           ERPNDB-ALT-KEY,
 20226           DFHEIV99,
 20227           DFHEIV11,
 20228           DFHEIV99
 20229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20230
 20231
 20232     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20233                                    WS-FIRST-TIME-SW.
 20234
 20235 4505-READ-PREV-RECORD.
 20236
 20237* EXEC CICS READPREV
 20238*         DATASET    (FILE-ID-ERPNDB2)
 20239*         SET        (ADDRESS OF PENDING-BUSINESS)
 20240*         RIDFLD     (ERPNDB-ALT-KEY)
 20241*    END-EXEC.
 20242     MOVE 0
 20243       TO DFHEIV11
 20244*    MOVE '&0S                   )   #00017283' TO DFHEIV0
 20245     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20246     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 371
* EL6311.cbl
 20247     MOVE X'2020233030303137323833' TO DFHEIV0(25:11)
 20248     CALL 'kxdfhei1' USING DFHEIV0,
 20249           FILE-ID-ERPNDB2,
 20250           DFHEIV20,
 20251           DFHEIV99,
 20252           ERPNDB-ALT-KEY,
 20253           DFHEIV99,
 20254           DFHEIV11,
 20255           DFHEIV99,
 20256           DFHEIV99
 20257     SET ADDRESS OF PENDING-BUSINESS TO
 20258         DFHEIV20
 20259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20260
 20261
 20262     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20263
 20264     IF WS-BATCH-PREFIX = '#CL'
 20265         GO TO 4505-READ-PREV-RECORD.
 20266
 20267     IF FIRST-TIME
 20268         MOVE SPACE               TO WS-FIRST-TIME-SW
 20269         GO TO 4505-READ-PREV-RECORD.
 20270
 20271     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 20272        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 20273        PB-GROUPING      NOT = PI-PB-GROUPING OR
 20274        PB-STATE         NOT = PI-PB-STATE    OR
 20275        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 20276          GO TO 4550-END-RECORDS.
 20277
 20278
 20279     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20280
 20281     IF PB-BATCH-TRAILER
 20282        GO TO 4505-READ-PREV-RECORD.
 20283
 20284     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20285
 20286     IF  WS-BATCH-PREFIX = '#CL'
 20287         GO TO 4505-READ-PREV-RECORD.
 20288
 20289     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20290        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20291           GO TO 4505-READ-PREV-RECORD
 20292        ELSE
 20293           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20294              GO TO 4510-CHECK-REC-TYPE
 20295           ELSE
 20296              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20297                 GO TO 4510-CHECK-REC-TYPE
 20298              ELSE
 20299                 GO TO 4505-READ-PREV-RECORD.
 20300
 20301     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20302        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20303           GO TO 4505-READ-PREV-RECORD.
 20304
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 372
* EL6311.cbl
 20305 4510-CHECK-REC-TYPE.
 20306     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20307         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20308             NEXT SENTENCE
 20309         ELSE
 20310             GO TO 4505-READ-PREV-RECORD.
 20311
 20312     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20313         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20314             NEXT SENTENCE
 20315        ELSE
 20316             GO TO 4505-READ-PREV-RECORD.
 20317
 20318     IF NOT DISPLAY-CHANGE-RECORDS AND
 20319            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20320        GO TO 4505-READ-PREV-RECORD.
 20321
 20322     IF DISPLAY-HOLD-RECORDS AND
 20323        NOT PB-RECORD-ON-HOLD
 20324          GO TO 4505-READ-PREV-RECORD.
 20325
 20326     IF PB-ISSUE
 20327        IF DISPLAY-CHK-REQ-RECORDS
 20328           GO TO 4505-READ-PREV-RECORD.
 20329
 20330     IF PB-ISSUE
 20331        IF ISSUE-WITH-WARNING
 20332           IF PB-WARNING-ERRORS
 20333              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20334                  GO TO 4505-READ-PREV-RECORD
 20335              ELSE
 20336                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20337                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20338                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20339                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20340                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20341                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20342                 GO TO 7000-DISPLAY-ISSUES
 20343           ELSE
 20344              GO TO 4505-READ-PREV-RECORD.
 20345
 20346     IF PB-ISSUE
 20347        IF (ISSUES-IN-ERROR AND
 20348            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20349            ALL-ISSUES
 20350            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20351            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20352            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20353            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20354            MOVE PB-SV-STATE            TO PI-SV-STATE
 20355            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20356            GO TO 7000-DISPLAY-ISSUES
 20357        ELSE
 20358            GO TO 4505-READ-PREV-RECORD.
 20359
 20360     IF PB-CANCELLATION
 20361        IF DISPLAY-CHK-REQ-RECORDS
 20362           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 373
* EL6311.cbl
 20363              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20364              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20365              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20366              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20367              MOVE PB-SV-STATE            TO PI-SV-STATE
 20368              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20369              GO TO 7100-DISPLAY-CANCELS
 20370           ELSE
 20371              GO TO 4505-READ-PREV-RECORD.
 20372
 20373     IF PB-CANCELLATION
 20374        IF CANCEL-WITH-WARNING
 20375           IF PB-WARNING-ERRORS
 20376              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20377                  GO TO 4505-READ-PREV-RECORD
 20378              ELSE
 20379                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20380                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20381                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20382                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20383                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20384                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20385                 GO TO 7100-DISPLAY-CANCELS
 20386           ELSE
 20387              GO TO 4505-READ-PREV-RECORD.
 20388
 20389     IF PB-CANCELLATION
 20390        IF (CANCEL-IN-ERROR  AND
 20391            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20392            ALL-CANCELS
 20393            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20394            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20395            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20396            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20397            MOVE PB-SV-STATE            TO PI-SV-STATE
 20398            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20399            GO TO 7100-DISPLAY-CANCELS.
 20400
 20401     GO TO 4505-READ-PREV-RECORD.
 20402
 20403 4550-END-RECORDS.
 20404     IF PI-MAP-NAME = EL631B
 20405        MOVE -1                  TO BMAINTL
 20406     ELSE
 20407        IF PI-MAP-NAME = EL631C
 20408           MOVE -1               TO CMAINTL
 20409        ELSE
 20410           MOVE -1               TO DPFENTRL.
 20411
 20412     MOVE ER-2255               TO EMI-ERROR.
 20413     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20414     GO TO 8200-SEND-DATAONLY.
 20415
 20416 4570-NOT-FOUND.
 20417
 20418******************************************************************
 20419*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20420******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 374
* EL6311.cbl
 20421
 20422
 20423* EXEC CICS RESETBR
 20424*         DATASET    (FILE-ID-ERPNDB2)
 20425*         RIDFLD     (ERPNDB-ALT-KEY)
 20426*    END-EXEC.
 20427     MOVE 0
 20428       TO DFHEIV11
 20429*    MOVE '&4         G          &   #00017449' TO DFHEIV0
 20430     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20431     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20432     MOVE X'2020233030303137343439' TO DFHEIV0(25:11)
 20433     CALL 'kxdfhei1' USING DFHEIV0,
 20434           FILE-ID-ERPNDB2,
 20435           ERPNDB-ALT-KEY,
 20436           DFHEIV99,
 20437           DFHEIV11,
 20438           DFHEIV99
 20439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20440
 20441
 20442
 20443* EXEC CICS READNEXT
 20444*         DATASET    (FILE-ID-ERPNDB2)
 20445*         SET        (ADDRESS OF PENDING-BUSINESS)
 20446*         RIDFLD     (ERPNDB-ALT-KEY)
 20447*    END-EXEC.
 20448     MOVE 0
 20449       TO DFHEIV11
 20450*    MOVE '&.S                   )   #00017454' TO DFHEIV0
 20451     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20452     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20453     MOVE X'2020233030303137343534' TO DFHEIV0(25:11)
 20454     CALL 'kxdfhei1' USING DFHEIV0,
 20455           FILE-ID-ERPNDB2,
 20456           DFHEIV20,
 20457           DFHEIV99,
 20458           ERPNDB-ALT-KEY,
 20459           DFHEIV99,
 20460           DFHEIV11,
 20461           DFHEIV99,
 20462           DFHEIV99
 20463     SET ADDRESS OF PENDING-BUSINESS TO
 20464         DFHEIV20
 20465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20466
 20467
 20468
 20469* EXEC CICS READPREV
 20470*         DATASET    (FILE-ID-ERPNDB2)
 20471*         SET        (ADDRESS OF PENDING-BUSINESS)
 20472*         RIDFLD     (ERPNDB-ALT-KEY)
 20473*    END-EXEC.
 20474     MOVE 0
 20475       TO DFHEIV11
 20476*    MOVE '&0S                   )   #00017460' TO DFHEIV0
 20477     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20478     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 375
* EL6311.cbl
 20479     MOVE X'2020233030303137343630' TO DFHEIV0(25:11)
 20480     CALL 'kxdfhei1' USING DFHEIV0,
 20481           FILE-ID-ERPNDB2,
 20482           DFHEIV20,
 20483           DFHEIV99,
 20484           ERPNDB-ALT-KEY,
 20485           DFHEIV99,
 20486           DFHEIV11,
 20487           DFHEIV99,
 20488           DFHEIV99
 20489     SET ADDRESS OF PENDING-BUSINESS TO
 20490         DFHEIV20
 20491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20492
 20493
 20494 4580-READ-PREV-RECORD.
 20495
 20496* EXEC CICS READPREV
 20497*         DATASET    (FILE-ID-ERPNDB2)
 20498*         SET        (ADDRESS OF PENDING-BUSINESS)
 20499*         RIDFLD     (ERPNDB-ALT-KEY)
 20500*    END-EXEC.
 20501     MOVE 0
 20502       TO DFHEIV11
 20503*    MOVE '&0S                   )   #00017467' TO DFHEIV0
 20504     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20505     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20506     MOVE X'2020233030303137343637' TO DFHEIV0(25:11)
 20507     CALL 'kxdfhei1' USING DFHEIV0,
 20508           FILE-ID-ERPNDB2,
 20509           DFHEIV20,
 20510           DFHEIV99,
 20511           ERPNDB-ALT-KEY,
 20512           DFHEIV99,
 20513           DFHEIV11,
 20514           DFHEIV99,
 20515           DFHEIV99
 20516     SET ADDRESS OF PENDING-BUSINESS TO
 20517         DFHEIV20
 20518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20519
 20520
 20521     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20522
 20523     IF WS-BATCH-PREFIX = '#CL'
 20524        GO TO 4580-READ-PREV-RECORD.
 20525
 20526     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20527     GO TO 4505-READ-PREV-RECORD.
 20528
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 376
* EL6311.cbl
 20530
 20531******************************************************************
 20532*                                                                *
 20533*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20534*                                                                *
 20535******************************************************************
 20536
 20537 4600-BROWSE-PRIMARY-BACKWARD.
 20538        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20539
 20540     IF ERPNDB-BATCH-SEQ-NO = +9999
 20541        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20542
 20543        IF ERPNDB-BATCH-SEQ-NO = +0000
 20544           GO TO 4650-END-BATCH
 20545        ELSE
 20546           IF PI-MAP-NAME NOT = EL631D
 20547              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20548                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20549              ELSE
 20550                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20551                 IF DISPLAY-CHANGE-RECORDS
 20552                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20553                 ELSE
 20554                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20555
 20556
 20557* EXEC CICS HANDLE CONDITION
 20558*         NOTFND    (4680-NOT-FOUND)
 20559*         ENDFILE   (4680-NOT-FOUND)
 20560*    END-EXEC.
 20561*    MOVE '"$I''                  ! O #00017508' TO DFHEIV0
 20562     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20564     MOVE X'4F20233030303137353038' TO DFHEIV0(25:11)
 20565     CALL 'kxdfhei1' USING DFHEIV0
 20566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20567
 20568
 20569 4605-READ-NEXT.
 20570     IF ERPNDB-BATCH-SEQ-NO = +0000
 20571        GO TO 4650-END-BATCH.
 20572
 20573     IF PI-DISPLAY-ORIGINAL-BATCH
 20574        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20575     ELSE
 20576        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20577
 20578
 20579* EXEC CICS READ
 20580*         DATASET   (FILE-ID)
 20581*         SET       (ADDRESS OF PENDING-BUSINESS)
 20582*         RIDFLD    (ERPNDB-KEY)
 20583*    END-EXEC.
 20584*    MOVE '&"S        E          (   #00017522' TO DFHEIV0
 20585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20587     MOVE X'2020233030303137353232' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 377
* EL6311.cbl
 20588     CALL 'kxdfhei1' USING DFHEIV0,
 20589           FILE-ID,
 20590           DFHEIV20,
 20591           DFHEIV99,
 20592           ERPNDB-KEY,
 20593           DFHEIV99,
 20594           DFHEIV99,
 20595           DFHEIV99
 20596     SET ADDRESS OF PENDING-BUSINESS TO
 20597         DFHEIV20
 20598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20599
 20600
 20601     IF NOT  PI-PRIMARY-WITH-SELECT
 20602        GO TO 4607-CHECK-REC-TYPE.
 20603
 20604     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20605
 20606     IF  WS-BATCH-PREFIX = '#CL'
 20607         GO TO 4610-BUMP-SEQ.
 20608
 20609     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20610        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20611           GO TO 4610-BUMP-SEQ
 20612        ELSE
 20613           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20614              GO TO 4607-CHECK-REC-TYPE
 20615           ELSE
 20616              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20617                 GO TO 4607-CHECK-REC-TYPE
 20618              ELSE
 20619                 GO TO 4610-BUMP-SEQ.
 20620
 20621     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20622        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20623           GO TO 4610-BUMP-SEQ.
 20624
 20625 4607-CHECK-REC-TYPE.
 20626     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20627         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20628             NEXT SENTENCE
 20629         ELSE
 20630             GO TO 4610-BUMP-SEQ.
 20631
 20632     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20633         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20634             NEXT SENTENCE
 20635        ELSE
 20636             GO TO 4610-BUMP-SEQ.
 20637
 20638     IF NOT DISPLAY-CHANGE-RECORDS AND
 20639            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20640        GO TO 4610-BUMP-SEQ.
 20641
 20642     IF DISPLAY-HOLD-RECORDS AND
 20643        NOT PB-RECORD-ON-HOLD
 20644          GO TO 4610-BUMP-SEQ.
 20645
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 378
* EL6311.cbl
 20646     IF PB-ISSUE
 20647        IF DISPLAY-CHK-REQ-RECORDS
 20648           GO TO 4610-BUMP-SEQ.
 20649
 20650     IF PB-ISSUE
 20651        IF ISSUE-WITH-WARNING
 20652           IF PB-WARNING-ERRORS
 20653              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20654                  GO TO 4610-BUMP-SEQ
 20655              ELSE
 20656                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20657                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20658                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20659                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20660                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20661                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20662                 GO TO 7000-DISPLAY-ISSUES
 20663           ELSE
 20664              GO TO 4610-BUMP-SEQ.
 20665
 20666     IF PB-ISSUE
 20667        IF (ISSUES-IN-ERROR AND
 20668            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20669            ALL-ISSUES
 20670            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20671            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20672            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20673            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20674            MOVE PB-SV-STATE            TO PI-SV-STATE
 20675            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20676            GO TO 7000-DISPLAY-ISSUES
 20677        ELSE
 20678            GO TO 4610-BUMP-SEQ.
 20679
 20680     IF PB-CANCELLATION
 20681        IF DISPLAY-CHK-REQ-RECORDS
 20682           IF PB-C-REFUND-REQUESTED
 20683              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20684              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20685              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20686              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20687              MOVE PB-SV-STATE            TO PI-SV-STATE
 20688              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20689              GO TO 7100-DISPLAY-CANCELS
 20690           ELSE
 20691              GO TO 4610-BUMP-SEQ.
 20692
 20693     IF PB-CANCELLATION
 20694        IF CANCEL-WITH-WARNING
 20695           IF PB-WARNING-ERRORS
 20696              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20697                  GO TO 4610-BUMP-SEQ
 20698              ELSE
 20699                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20700                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20701                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20702                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20703                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 379
* EL6311.cbl
 20704                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20705                 GO TO 7100-DISPLAY-CANCELS
 20706           ELSE
 20707              GO TO 4610-BUMP-SEQ.
 20708
 20709     IF PB-CANCELLATION
 20710        IF (CANCEL-IN-ERROR  AND
 20711            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20712            ALL-CANCELS
 20713            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20714            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20715            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20716            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20717            MOVE PB-SV-STATE            TO PI-SV-STATE
 20718            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20719            GO TO 7100-DISPLAY-CANCELS.
 20720
 20721 4610-BUMP-SEQ.
 20722     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20723        GO TO 4650-END-BATCH.
 20724
 20725     IF DISPLAY-CHANGE-RECORDS
 20726        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20727           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20728        ELSE
 20729           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20730           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20731        ELSE
 20732           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20733           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20734
 20735        GO TO 4605-READ-NEXT.
 20736
 20737 4650-END-BATCH.
 20738     IF PI-MAP-NAME = EL631B
 20739        MOVE -1                  TO BMAINTL
 20740     ELSE
 20741        IF PI-MAP-NAME = EL631C
 20742           MOVE -1               TO CMAINTL
 20743        ELSE
 20744           MOVE -1               TO DPFENTRL.
 20745
 20746     MOVE ER-2252               TO EMI-ERROR.
 20747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20748     GO TO 8200-SEND-DATAONLY.
 20749
 20750 4680-NOT-FOUND.
 20751     IF DISPLAY-CHANGE-RECORDS
 20752        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20753           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20754        ELSE
 20755           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20756           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20757     ELSE
 20758        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20759
 20760     GO TO 4605-READ-NEXT.
 20761
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 380
* EL6311.cbl
 20763
 20764******************************************************************
 20765*                                                                *
 20766*        B R O W S E   F I L E   B A C K W A R D S               *
 20767*                                                                *
 20768******************************************************************
 20769
 20770 4800-BROWSE-FILE-BACKWARD.
 20771
 20772* EXEC CICS HANDLE CONDITION
 20773*         NOTFND   (4860-NOT-FOUND)
 20774*         ENDFILE  (4850-END-RECORDS)
 20775*    END-EXEC.
 20776*    MOVE '"$I''                  ! P #00017698' TO DFHEIV0
 20777     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20779     MOVE X'5020233030303137363938' TO DFHEIV0(25:11)
 20780     CALL 'kxdfhei1' USING DFHEIV0
 20781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20782
 20783
 20784     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20785
 20786     IF PI-DISPLAY-ORIGINAL-BATCH
 20787        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20788     ELSE
 20789        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20790
 20791
 20792* EXEC CICS STARTBR
 20793*         DATASET   (FILE-ID)
 20794*         RIDFLD    (ERPNDB-KEY)
 20795*    END-EXEC.
 20796     MOVE 0
 20797       TO DFHEIV11
 20798*    MOVE '&,         G          &   #00017710' TO DFHEIV0
 20799     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20800     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20801     MOVE X'2020233030303137373130' TO DFHEIV0(25:11)
 20802     CALL 'kxdfhei1' USING DFHEIV0,
 20803           FILE-ID,
 20804           ERPNDB-KEY,
 20805           DFHEIV99,
 20806           DFHEIV11,
 20807           DFHEIV99
 20808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20809
 20810
 20811     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20812
 20813
 20814* EXEC CICS READPREV
 20815*         DATASET    (FILE-ID-ERPNDB)
 20816*         SET        (ADDRESS OF PENDING-BUSINESS)
 20817*         RIDFLD     (ERPNDB-KEY)
 20818*    END-EXEC.
 20819     MOVE 0
 20820       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 381
* EL6311.cbl
 20821*    MOVE '&0S                   )   #00017717' TO DFHEIV0
 20822     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20823     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20824     MOVE X'2020233030303137373137' TO DFHEIV0(25:11)
 20825     CALL 'kxdfhei1' USING DFHEIV0,
 20826           FILE-ID-ERPNDB,
 20827           DFHEIV20,
 20828           DFHEIV99,
 20829           ERPNDB-KEY,
 20830           DFHEIV99,
 20831           DFHEIV11,
 20832           DFHEIV99,
 20833           DFHEIV99
 20834     SET ADDRESS OF PENDING-BUSINESS TO
 20835         DFHEIV20
 20836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20837
 20838
 20839 4810-READ-PREV-RECORD.
 20840
 20841* EXEC CICS READPREV
 20842*         DATASET    (FILE-ID-ERPNDB)
 20843*         SET        (ADDRESS OF PENDING-BUSINESS)
 20844*         RIDFLD     (ERPNDB-KEY)
 20845*    END-EXEC.
 20846     MOVE 0
 20847       TO DFHEIV11
 20848*    MOVE '&0S                   )   #00017724' TO DFHEIV0
 20849     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20850     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20851     MOVE X'2020233030303137373234' TO DFHEIV0(25:11)
 20852     CALL 'kxdfhei1' USING DFHEIV0,
 20853           FILE-ID-ERPNDB,
 20854           DFHEIV20,
 20855           DFHEIV99,
 20856           ERPNDB-KEY,
 20857           DFHEIV99,
 20858           DFHEIV11,
 20859           DFHEIV99,
 20860           DFHEIV99
 20861     SET ADDRESS OF PENDING-BUSINESS TO
 20862         DFHEIV20
 20863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20864
 20865
 20866     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20867        GO TO 4850-END-RECORDS.
 20868
 20869     IF PB-BATCH-TRAILER
 20870        GO TO 4810-READ-PREV-RECORD.
 20871
 20872     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20873
 20874     IF  WS-BATCH-PREFIX = '#CL'
 20875         GO TO 4810-READ-PREV-RECORD.
 20876
 20877     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20878        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 382
* EL6311.cbl
 20879           GO TO 4810-READ-PREV-RECORD
 20880        ELSE
 20881           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20882              GO TO 4820-CHECK-REC-TYPE
 20883           ELSE
 20884              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20885                 GO TO 4820-CHECK-REC-TYPE
 20886              ELSE
 20887                 GO TO 4810-READ-PREV-RECORD.
 20888
 20889     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20890        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20891           GO TO 4810-READ-PREV-RECORD.
 20892
 20893 4820-CHECK-REC-TYPE.
 20894     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20895         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20896             NEXT SENTENCE
 20897         ELSE
 20898             GO TO 4810-READ-PREV-RECORD.
 20899
 20900     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20901         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20902             NEXT SENTENCE
 20903        ELSE
 20904             GO TO 4810-READ-PREV-RECORD.
 20905
 20906     IF NOT DISPLAY-CHANGE-RECORDS AND
 20907            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20908        GO TO 4810-READ-PREV-RECORD.
 20909
 20910     IF DISPLAY-HOLD-RECORDS AND
 20911        NOT PB-RECORD-ON-HOLD
 20912          GO TO 4810-READ-PREV-RECORD.
 20913
 20914     IF PB-ISSUE
 20915        IF DISPLAY-CHK-REQ-RECORDS
 20916           GO TO 4810-READ-PREV-RECORD.
 20917
 20918     IF PB-ISSUE
 20919        IF ISSUE-WITH-WARNING
 20920           IF PB-WARNING-ERRORS
 20921              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20922                  GO TO 4810-READ-PREV-RECORD
 20923              ELSE
 20924                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20925                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20926                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20927                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20928                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20929                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20930                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20931                 GO TO 7000-DISPLAY-ISSUES
 20932           ELSE
 20933              GO TO 4810-READ-PREV-RECORD.
 20934
 20935     IF PB-ISSUE
 20936        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 383
* EL6311.cbl
 20937            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20938            ALL-ISSUES
 20939            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20940            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20941            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20942            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20943            MOVE PB-SV-STATE            TO PI-SV-STATE
 20944            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20945            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20946            GO TO 7000-DISPLAY-ISSUES
 20947        ELSE
 20948            GO TO 4810-READ-PREV-RECORD.
 20949
 20950     IF PB-CANCELLATION
 20951        IF DISPLAY-CHK-REQ-RECORDS
 20952           IF PB-C-REFUND-REQUESTED
 20953              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20954              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20955              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20956              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20957              MOVE PB-SV-STATE            TO PI-SV-STATE
 20958              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20959              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20960              GO TO 7100-DISPLAY-CANCELS
 20961           ELSE
 20962              GO TO 4810-READ-PREV-RECORD.
 20963
 20964     IF PB-CANCELLATION
 20965        IF CANCEL-WITH-WARNING
 20966           IF PB-WARNING-ERRORS
 20967              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20968                  GO TO 4810-READ-PREV-RECORD
 20969              ELSE
 20970                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20971                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20972                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20973                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20974                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20975                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20976                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20977                 GO TO 7100-DISPLAY-CANCELS
 20978           ELSE
 20979              GO TO 4810-READ-PREV-RECORD.
 20980
 20981     IF PB-CANCELLATION
 20982        IF (CANCEL-IN-ERROR  AND
 20983            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20984            ALL-CANCELS
 20985            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20986            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20987            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20988            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20989            MOVE PB-SV-STATE            TO PI-SV-STATE
 20990            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20991            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20992            GO TO 7100-DISPLAY-CANCELS.
 20993
 20994     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 384
* EL6311.cbl
 20995
 20996 4850-END-RECORDS.
 20997     MOVE ER-2252                TO EMI-ERROR.
 20998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20999
 21000     IF PI-MAP-NAME = EL631B
 21001        MOVE -1                  TO BPFENTRL
 21002     ELSE
 21003        MOVE -1                  TO CPFENTRL.
 21004
 21005     GO TO 8200-SEND-DATAONLY.
 21006
 21007 4860-NOT-FOUND.
 21008
 21009******************************************************************
 21010*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 21011******************************************************************
 21012
 21013
 21014* EXEC CICS RESETBR
 21015*         DATASET    (FILE-ID-ERPNDB)
 21016*         RIDFLD     (ERPNDB-KEY)
 21017*     END-EXEC.
 21018     MOVE 0
 21019       TO DFHEIV11
 21020*    MOVE '&4         G          &   #00017877' TO DFHEIV0
 21021     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21022     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21023     MOVE X'2020233030303137383737' TO DFHEIV0(25:11)
 21024     CALL 'kxdfhei1' USING DFHEIV0,
 21025           FILE-ID-ERPNDB,
 21026           ERPNDB-KEY,
 21027           DFHEIV99,
 21028           DFHEIV11,
 21029           DFHEIV99
 21030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21031
 21032
 21033
 21034* EXEC CICS READNEXT
 21035*         DATASET    (FILE-ID-ERPNDB)
 21036*         SET        (ADDRESS OF PENDING-BUSINESS)
 21037*         RIDFLD     (ERPNDB-KEY)
 21038*    END-EXEC.
 21039     MOVE 0
 21040       TO DFHEIV11
 21041*    MOVE '&.S                   )   #00017882' TO DFHEIV0
 21042     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21043     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21044     MOVE X'2020233030303137383832' TO DFHEIV0(25:11)
 21045     CALL 'kxdfhei1' USING DFHEIV0,
 21046           FILE-ID-ERPNDB,
 21047           DFHEIV20,
 21048           DFHEIV99,
 21049           ERPNDB-KEY,
 21050           DFHEIV99,
 21051           DFHEIV11,
 21052           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 385
* EL6311.cbl
 21053           DFHEIV99
 21054     SET ADDRESS OF PENDING-BUSINESS TO
 21055         DFHEIV20
 21056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21057
 21058
 21059
 21060* EXEC CICS READPREV
 21061*         DATASET    (FILE-ID-ERPNDB)
 21062*         SET        (ADDRESS OF PENDING-BUSINESS)
 21063*         RIDFLD     (ERPNDB-KEY)
 21064*    END-EXEC.
 21065     MOVE 0
 21066       TO DFHEIV11
 21067*    MOVE '&0S                   )   #00017888' TO DFHEIV0
 21068     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21069     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21070     MOVE X'2020233030303137383838' TO DFHEIV0(25:11)
 21071     CALL 'kxdfhei1' USING DFHEIV0,
 21072           FILE-ID-ERPNDB,
 21073           DFHEIV20,
 21074           DFHEIV99,
 21075           ERPNDB-KEY,
 21076           DFHEIV99,
 21077           DFHEIV11,
 21078           DFHEIV99,
 21079           DFHEIV99
 21080     SET ADDRESS OF PENDING-BUSINESS TO
 21081         DFHEIV20
 21082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21083
 21084
 21085     GO TO 4810-READ-PREV-RECORD.
 21086
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 386
* EL6311.cbl
 21088
 21089******************************************************************
 21090*                                                                *
 21091*           B R O W S E   C S R   B A C K W A R D                *
 21092*                                                                *
 21093******************************************************************
 21094
 21095 4900-BROWSE-CSR-BACKWARD.
 21096
 21097     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 21098
 21099
 21100* EXEC CICS HANDLE CONDITION
 21101*         NOTFND   (4970-NOT-FOUND)
 21102*         ENDFILE  (4950-END-RECORDS)
 21103*    END-EXEC
 21104*    MOVE '"$I''                  ! Q #00017908' TO DFHEIV0
 21105     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21107     MOVE X'5120233030303137393038' TO DFHEIV0(25:11)
 21108     CALL 'kxdfhei1' USING DFHEIV0
 21109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21110
 21111
 21112* EXEC CICS STARTBR
 21113*         DATASET   (FILE-ID-ERPNDB4)
 21114*         RIDFLD    (ERPNDB-CSR-KEY)
 21115*    END-EXEC.
 21116     MOVE 0
 21117       TO DFHEIV11
 21118*    MOVE '&,         G          &   #00017913' TO DFHEIV0
 21119     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21121     MOVE X'2020233030303137393133' TO DFHEIV0(25:11)
 21122     CALL 'kxdfhei1' USING DFHEIV0,
 21123           FILE-ID-ERPNDB4,
 21124           ERPNDB-CSR-KEY,
 21125           DFHEIV99,
 21126           DFHEIV11,
 21127           DFHEIV99
 21128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21129
 21130
 21131     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 21132                                    WS-FIRST-TIME-SW.
 21133
 21134 4905-READ-PREV-RECORD.
 21135
 21136* EXEC CICS READPREV
 21137*         DATASET    (FILE-ID-ERPNDB4)
 21138*         SET        (ADDRESS OF PENDING-BUSINESS)
 21139*         RIDFLD     (ERPNDB-CSR-KEY)
 21140*    END-EXEC.
 21141     MOVE 0
 21142       TO DFHEIV11
 21143*    MOVE '&0S                   )   #00017922' TO DFHEIV0
 21144     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21145     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 387
* EL6311.cbl
 21146     MOVE X'2020233030303137393232' TO DFHEIV0(25:11)
 21147     CALL 'kxdfhei1' USING DFHEIV0,
 21148           FILE-ID-ERPNDB4,
 21149           DFHEIV20,
 21150           DFHEIV99,
 21151           ERPNDB-CSR-KEY,
 21152           DFHEIV99,
 21153           DFHEIV11,
 21154           DFHEIV99,
 21155           DFHEIV99
 21156     SET ADDRESS OF PENDING-BUSINESS TO
 21157         DFHEIV20
 21158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21159
 21160
 21161     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21162
 21163     IF WS-BATCH-PREFIX = '#CL'
 21164         GO TO 4905-READ-PREV-RECORD.
 21165
 21166     IF FIRST-TIME
 21167         MOVE SPACE               TO WS-FIRST-TIME-SW
 21168         GO TO 4905-READ-PREV-RECORD.
 21169
 21170     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 21171        PB-CSR-ID           NOT = PI-PB-CSR-ID
 21172        GO TO 4950-END-RECORDS.
 21173
 21174     IF PB-BATCH-TRAILER
 21175        GO TO 4905-READ-PREV-RECORD.
 21176
 21177     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21178
 21179     IF  WS-BATCH-PREFIX = '#CL'
 21180         GO TO 4905-READ-PREV-RECORD.
 21181
 21182     IF PI-PB-CERT-NO NOT = LOW-VALUES
 21183        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 21184           GO TO 4905-READ-PREV-RECORD
 21185        ELSE
 21186           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 21187              GO TO 4910-CHECK-REC-TYPE
 21188           ELSE
 21189              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 21190                 GO TO 4910-CHECK-REC-TYPE
 21191              ELSE
 21192                 GO TO 4905-READ-PREV-RECORD.
 21193
 21194     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 21195        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 21196           GO TO 4905-READ-PREV-RECORD.
 21197
 21198 4910-CHECK-REC-TYPE.
 21199     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21200         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21201             NEXT SENTENCE
 21202         ELSE
 21203             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 388
* EL6311.cbl
 21204
 21205     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21206         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21207             NEXT SENTENCE
 21208        ELSE
 21209             GO TO 4905-READ-PREV-RECORD.
 21210
 21211     IF NOT DISPLAY-CHANGE-RECORDS AND
 21212            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21213        GO TO 4905-READ-PREV-RECORD.
 21214
 21215     IF DISPLAY-HOLD-RECORDS AND
 21216        NOT PB-RECORD-ON-HOLD
 21217          GO TO 4905-READ-PREV-RECORD.
 21218
 21219     IF PB-ISSUE
 21220        IF DISPLAY-CHK-REQ-RECORDS
 21221           GO TO 4905-READ-PREV-RECORD.
 21222
 21223     IF PB-ISSUE
 21224        IF ISSUE-WITH-WARNING
 21225           IF PB-WARNING-ERRORS
 21226              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21227                  GO TO 4505-READ-PREV-RECORD
 21228              ELSE
 21229                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21230                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21231                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21232                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21233                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21234                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21235                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21236                 GO TO 7000-DISPLAY-ISSUES
 21237           ELSE
 21238              GO TO 4905-READ-PREV-RECORD.
 21239
 21240     IF PB-ISSUE
 21241        IF (ISSUES-IN-ERROR AND
 21242            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21243            ALL-ISSUES
 21244            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21245            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21246            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21247            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21248            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21249            MOVE PB-SV-STATE            TO PI-SV-STATE
 21250            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21251            GO TO 7000-DISPLAY-ISSUES
 21252        ELSE
 21253            GO TO 4905-READ-PREV-RECORD.
 21254
 21255     IF PB-CANCELLATION
 21256        IF DISPLAY-CHK-REQ-RECORDS
 21257           IF PB-C-REFUND-REQUESTED
 21258              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21259              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21260              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21261              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 389
* EL6311.cbl
 21262              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21263              MOVE PB-SV-STATE            TO PI-SV-STATE
 21264              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21265              GO TO 7100-DISPLAY-CANCELS
 21266           ELSE
 21267              GO TO 4905-READ-PREV-RECORD.
 21268
 21269     IF PB-CANCELLATION
 21270        IF CANCEL-WITH-WARNING
 21271           IF PB-WARNING-ERRORS
 21272              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21273                  GO TO 4505-READ-PREV-RECORD
 21274              ELSE
 21275                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21276                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21277                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21278                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21279                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21280                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21281                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21282                 GO TO 7100-DISPLAY-CANCELS
 21283           ELSE
 21284              GO TO 4905-READ-PREV-RECORD.
 21285
 21286     IF PB-CANCELLATION
 21287        IF (CANCEL-IN-ERROR  AND
 21288            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21289            ALL-CANCELS
 21290            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21291            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21292            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21293            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21294            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21295            MOVE PB-SV-STATE            TO PI-SV-STATE
 21296            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21297            GO TO 7100-DISPLAY-CANCELS.
 21298
 21299     GO TO 4905-READ-PREV-RECORD.
 21300
 21301 4950-END-RECORDS.
 21302     IF PI-MAP-NAME = EL631B
 21303        MOVE -1                  TO BMAINTL
 21304     ELSE
 21305        IF PI-MAP-NAME = EL631C
 21306           MOVE -1               TO CMAINTL
 21307        ELSE
 21308           MOVE -1               TO DPFENTRL.
 21309
 21310     MOVE ER-2255               TO EMI-ERROR.
 21311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21312     GO TO 8200-SEND-DATAONLY.
 21313
 21314 4970-NOT-FOUND.
 21315
 21316******************************************************************
 21317*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21318******************************************************************
 21319
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 390
* EL6311.cbl
 21320
 21321* EXEC CICS RESETBR
 21322*         DATASET    (FILE-ID-ERPNDB4)
 21323*         RIDFLD     (ERPNDB-CSR-KEY)
 21324*    END-EXEC.
 21325     MOVE 0
 21326       TO DFHEIV11
 21327*    MOVE '&4         G          &   #00018087' TO DFHEIV0
 21328     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21329     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21330     MOVE X'2020233030303138303837' TO DFHEIV0(25:11)
 21331     CALL 'kxdfhei1' USING DFHEIV0,
 21332           FILE-ID-ERPNDB4,
 21333           ERPNDB-CSR-KEY,
 21334           DFHEIV99,
 21335           DFHEIV11,
 21336           DFHEIV99
 21337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21338
 21339
 21340
 21341* EXEC CICS READNEXT
 21342*         DATASET    (FILE-ID-ERPNDB4)
 21343*         SET        (ADDRESS OF PENDING-BUSINESS)
 21344*         RIDFLD     (ERPNDB-CSR-KEY)
 21345*    END-EXEC.
 21346     MOVE 0
 21347       TO DFHEIV11
 21348*    MOVE '&.S                   )   #00018092' TO DFHEIV0
 21349     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21350     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21351     MOVE X'2020233030303138303932' TO DFHEIV0(25:11)
 21352     CALL 'kxdfhei1' USING DFHEIV0,
 21353           FILE-ID-ERPNDB4,
 21354           DFHEIV20,
 21355           DFHEIV99,
 21356           ERPNDB-CSR-KEY,
 21357           DFHEIV99,
 21358           DFHEIV11,
 21359           DFHEIV99,
 21360           DFHEIV99
 21361     SET ADDRESS OF PENDING-BUSINESS TO
 21362         DFHEIV20
 21363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21364
 21365
 21366
 21367* EXEC CICS READPREV
 21368*         DATASET    (FILE-ID-ERPNDB4)
 21369*         SET        (ADDRESS OF PENDING-BUSINESS)
 21370*         RIDFLD     (ERPNDB-CSR-KEY)
 21371*    END-EXEC.
 21372     MOVE 0
 21373       TO DFHEIV11
 21374*    MOVE '&0S                   )   #00018098' TO DFHEIV0
 21375     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21376     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21377     MOVE X'2020233030303138303938' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 391
* EL6311.cbl
 21378     CALL 'kxdfhei1' USING DFHEIV0,
 21379           FILE-ID-ERPNDB4,
 21380           DFHEIV20,
 21381           DFHEIV99,
 21382           ERPNDB-CSR-KEY,
 21383           DFHEIV99,
 21384           DFHEIV11,
 21385           DFHEIV99,
 21386           DFHEIV99
 21387     SET ADDRESS OF PENDING-BUSINESS TO
 21388         DFHEIV20
 21389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21390
 21391
 21392 4980-READ-PREV-RECORD.
 21393
 21394* EXEC CICS READPREV
 21395*         DATASET    (FILE-ID-ERPNDB4)
 21396*         SET        (ADDRESS OF PENDING-BUSINESS)
 21397*         RIDFLD     (ERPNDB-CSR-KEY)
 21398*    END-EXEC.
 21399     MOVE 0
 21400       TO DFHEIV11
 21401*    MOVE '&0S                   )   #00018105' TO DFHEIV0
 21402     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21403     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21404     MOVE X'2020233030303138313035' TO DFHEIV0(25:11)
 21405     CALL 'kxdfhei1' USING DFHEIV0,
 21406           FILE-ID-ERPNDB4,
 21407           DFHEIV20,
 21408           DFHEIV99,
 21409           ERPNDB-CSR-KEY,
 21410           DFHEIV99,
 21411           DFHEIV11,
 21412           DFHEIV99,
 21413           DFHEIV99
 21414     SET ADDRESS OF PENDING-BUSINESS TO
 21415         DFHEIV20
 21416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21417
 21418
 21419     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21420
 21421     IF WS-BATCH-PREFIX = '#CL'
 21422        GO TO 4980-READ-PREV-RECORD.
 21423
 21424     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21425     GO TO 4905-READ-PREV-RECORD.
 21426
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 392
* EL6311.cbl
 21428
 21429
 21430******************************************************************
 21431*                                                                *
 21432*        B R O W S E   B A T C H   H E A D E R S                 *
 21433*                                                                *
 21434******************************************************************
 21435
 21436 5000-BROWSE-BATCH-HEADERS.
 21437
 21438     IF EIBTRNID NOT = TRANS-EXB1
 21439        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21440        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21441        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21442        GO TO 5010-READ-NEXT-RECORD.
 21443
 21444     IF EIBAID = DFHPF4
 21445        MOVE '0'                TO PI-EDIT-SW
 21446        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21447        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21448        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21449        GO TO 5010-READ-NEXT-RECORD.
 21450
 21451     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21452     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21453     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21454
 21455
 21456* EXEC CICS HANDLE CONDITION
 21457*         ENDFILE  (5050-NOT-FOUND)
 21458*    END-EXEC.
 21459*    MOVE '"$''                   ! R #00018147' TO DFHEIV0
 21460     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21462     MOVE X'5220233030303138313437' TO DFHEIV0(25:11)
 21463     CALL 'kxdfhei1' USING DFHEIV0
 21464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21465
 21466
 21467 5010-READ-NEXT-RECORD.
 21468
 21469* EXEC CICS HANDLE CONDITION
 21470*         NOTFND    (5050-NOT-FOUND)
 21471*    END-EXEC.
 21472*    MOVE '"$I                   ! S #00018152' TO DFHEIV0
 21473     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21475     MOVE X'5320233030303138313532' TO DFHEIV0(25:11)
 21476     CALL 'kxdfhei1' USING DFHEIV0
 21477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21478
 21479
 21480
 21481* EXEC CICS READ
 21482*         DATASET   (FILE-ID-ERPNDB)
 21483*         SET       (ADDRESS OF PENDING-BUSINESS)
 21484*         RIDFLD    (ERPNDB-KEY)
 21485*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 393
* EL6311.cbl
 21486*    END-EXEC.
 21487*    MOVE '&"S        G          (   #00018156' TO DFHEIV0
 21488     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21490     MOVE X'2020233030303138313536' TO DFHEIV0(25:11)
 21491     CALL 'kxdfhei1' USING DFHEIV0,
 21492           FILE-ID-ERPNDB,
 21493           DFHEIV20,
 21494           DFHEIV99,
 21495           ERPNDB-KEY,
 21496           DFHEIV99,
 21497           DFHEIV99,
 21498           DFHEIV99
 21499     SET ADDRESS OF PENDING-BUSINESS TO
 21500         DFHEIV20
 21501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21502
 21503
 21504     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21505         GO TO 5050-NOT-FOUND.
 21506
 21507     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21508
 21509     IF WS-BATCH-PREFIX = '#CL'
 21510         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21511         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21512         GO TO 5010-READ-NEXT-RECORD.
 21513
 21514     IF NOT PB-BATCH-TRAILER
 21515         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21516         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21517         GO TO 5010-READ-NEXT-RECORD.
 21518
 21519     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21520         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21521             NEXT SENTENCE
 21522         ELSE
 21523             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21524             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21525             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21526             GO TO 5010-READ-NEXT-RECORD.
 21527
 21528     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21529         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21530             NEXT SENTENCE
 21531        ELSE
 21532             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21533             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21534             GO TO 5010-READ-NEXT-RECORD.
 21535
 21536     IF EIBAID = DFHPF4
 21537        MOVE '0'                TO PI-EDIT-SW
 21538        GO TO 7200-DISPLAY-BATCHES.
 21539
 21540     IF PI-CSR-BROWSE
 21541        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21542           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21543           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 394
* EL6311.cbl
 21544           GO TO 5010-READ-NEXT-RECORD.
 21545
 21546     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21547       IF PI-PB-CARRIER    = SPACES AND
 21548          PI-PB-GROUPING   = SPACES AND
 21549          PI-PB-STATE      = SPACES AND
 21550          PI-PB-ACCOUNT    = SPACES
 21551            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21552            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21553            GO TO 7200-DISPLAY-BATCHES
 21554         ELSE
 21555           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21556              PI-PB-GROUPING   = PB-GROUPING AND
 21557              PI-PB-STATE      = PB-STATE    AND
 21558              PI-PB-ACCOUNT    = PB-ACCOUNT
 21559              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21560              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21561              GO TO 7200-DISPLAY-BATCHES.
 21562
 21563     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21564     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21565
 21566
 21567* EXEC CICS HANDLE CONDITION
 21568*         NOTFND    (5050-NOT-FOUND)
 21569*    END-EXEC.
 21570*    MOVE '"$I                   ! T #00018225' TO DFHEIV0
 21571     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21573     MOVE X'5420233030303138323235' TO DFHEIV0(25:11)
 21574     CALL 'kxdfhei1' USING DFHEIV0
 21575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21576
 21577
 21578
 21579* EXEC CICS READ
 21580*         DATASET   (FILE-ID-ERPNDB)
 21581*         SET       (ADDRESS OF PENDING-BUSINESS)
 21582*         RIDFLD    (ERPNDB-KEY)
 21583*         GTEQ
 21584*    END-EXEC.
 21585*    MOVE '&"S        G          (   #00018229' TO DFHEIV0
 21586     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21587     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21588     MOVE X'2020233030303138323239' TO DFHEIV0(25:11)
 21589     CALL 'kxdfhei1' USING DFHEIV0,
 21590           FILE-ID-ERPNDB,
 21591           DFHEIV20,
 21592           DFHEIV99,
 21593           ERPNDB-KEY,
 21594           DFHEIV99,
 21595           DFHEIV99,
 21596           DFHEIV99
 21597     SET ADDRESS OF PENDING-BUSINESS TO
 21598         DFHEIV20
 21599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21600
 21601
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 395
* EL6311.cbl
 21602     GO TO 5010-READ-NEXT-RECORD.
 21603
 21604 5050-NOT-FOUND.
 21605
 21606******************************************************************
 21607*                                                                *
 21608*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21609*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21610*         PROGRAM.                                               *
 21611*                                                                *
 21612******************************************************************
 21613
 21614     IF EIBTRNID NOT = TRANS-EXB1
 21615        IF PENDING-BUS-RECS-FOUND
 21616            NEXT SENTENCE
 21617          ELSE
 21618            MOVE '9'            TO PI-BROWSE-SW
 21619            GO TO 9400-CLEAR.
 21620
 21621     MOVE ER-2256                TO EMI-ERROR.
 21622     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21623
 21624     IF PI-MAP-NAME = SPACES
 21625        MOVE EL631D              TO PI-MAP-NAME
 21626        MOVE -1                  TO DPFENTRL
 21627        GO TO 8100-SEND-INITIAL-MAP.
 21628
 21629     IF PI-MAP-NAME = EL631B
 21630        MOVE -1                  TO BMAINTL
 21631     ELSE
 21632        IF PI-MAP-NAME = EL631C
 21633           MOVE -1               TO CMAINTL
 21634        ELSE
 21635           MOVE -1               TO DPFENTRL
 21636           GO TO 8200-SEND-DATAONLY.
 21637
 21638     GO TO 8100-SEND-INITIAL-MAP.
 21639
 21640     .
 21641 5100-PROCESS-POL-RESC.
 21642     MOVE ZEROS                  TO CG-LF-BENCD
 21643                                    CG-AH-BENCD
 21644                                    CG-LF-CAN-AMT
 21645                                    CG-AH-CAN-AMT
 21646     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21647                                    CG-AH-CAN-DT
 21648     MOVE SPACES                 TO CG-BATCH-NO
 21649     MOVE '4'                    TO CG-OPTION-CODE
 21650     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21651     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21652     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21653     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21654     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21655     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21656     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21657     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21658     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21659     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 396
* EL6311.cbl
 21660     MOVE PI-PREV-ALT-KEY (1:33)
 21661                                 TO CG-CERT-KEY
 21662     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21663     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21664                                    CG-AH-CAN-AMT
 21665     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21666                                    CG-AH-CAN-DT
 21667     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21668     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21669      display 'about to cancel ' cg-cert-key
 21670
 21671* EXEC CICS LINK
 21672*        PROGRAM  ('ELCANC')
 21673*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21674*    END-EXEC
 21675     MOVE LENGTH OF
 21676      CANCEL-GEN-PASS-AREA
 21677       TO DFHEIV11
 21678     MOVE 'ELCANC' TO DFHEIV1
 21679*    MOVE '."C                   (   #00018304' TO DFHEIV0
 21680     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21681     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21682     MOVE X'2020233030303138333034' TO DFHEIV0(25:11)
 21683     CALL 'kxdfhei1' USING DFHEIV0,
 21684           DFHEIV1,
 21685           CANCEL-GEN-PASS-AREA,
 21686           DFHEIV11,
 21687           DFHEIV99,
 21688           DFHEIV99,
 21689           DFHEIV99,
 21690           DFHEIV99
 21691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21692     IF CG-SUCCESS
 21693        CONTINUE
 21694     ELSE
 21695        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21696        MOVE '3'                 TO EMI-SWITCH1
 21697        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21698        EVALUATE TRUE
 21699           WHEN CG-DATE-ERROR
 21700             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21701           WHEN CG-CERT-NOT-FOUND
 21702             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21703           WHEN CG-AMOUNT-ERROR
 21704             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21705           WHEN CG-OPTION-ERROR
 21706             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21707           WHEN CG-PREV-CAN
 21708             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21709           WHEN CG-INVALID-DATA
 21710             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21711           WHEN CG-NO-ACCT-MSTR
 21712             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21713           WHEN CG-SFX-A-EXIST
 21714             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21715           WHEN CG-MISC-ERROR
 21716             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21717           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 397
* EL6311.cbl
 21718             MOVE ' ERROR - ELCANC - RETURN '
 21719                                 TO EMI-ERROR-TEXT (1) (12:25)
 21720        END-EVALUATE
 21721        GO TO 8200-SEND-DATAONLY
 21722     END-IF
 21723
 21724* EXEC CICS GETMAIN
 21725*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21726*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21727*        INITIMG (GETMAIN-SPACE)
 21728*    END-EXEC
 21729*    MOVE ',"IL                  $   #00018339' TO DFHEIV0
 21730     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21731     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21732     MOVE X'2020233030303138333339' TO DFHEIV0(25:11)
 21733     CALL 'kxdfhei1' USING DFHEIV0,
 21734           DFHEIV20,
 21735           ELCRTT-RECORD-LENGTH,
 21736           GETMAIN-SPACE
 21737     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21738         DFHEIV20
 21739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21740
 21741     move ' '                    to ws-elcrtt-update-sw
 21742     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21743     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21744
 21745
 21746* EXEC CICS READ
 21747*        UPDATE
 21748*        DATASET  (CRTT-ID)
 21749*        RIDFLD   (ELCRTT-KEY)
 21750*        INTO     (CERTIFICATE-TRAILERS)
 21751*        resp     (ws-response)
 21752*    END-EXEC
 21753     MOVE LENGTH OF
 21754      CERTIFICATE-TRAILERS
 21755       TO DFHEIV11
 21756*    MOVE '&"IL       EU         (  N#00018349' TO DFHEIV0
 21757     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21758     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21759     MOVE X'204E233030303138333439' TO DFHEIV0(25:11)
 21760     CALL 'kxdfhei1' USING DFHEIV0,
 21761           CRTT-ID,
 21762           CERTIFICATE-TRAILERS,
 21763           DFHEIV11,
 21764           ELCRTT-KEY,
 21765           DFHEIV99,
 21766           DFHEIV99,
 21767           DFHEIV99
 21768     MOVE EIBRESP  TO ws-response
 21769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21770
 21771     if resp-normal
 21772        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21773                  'E' or 'F' or 'G'
 21774           move 'J'              to cs-claim-verification-status
 21775           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 398
* EL6311.cbl
 21776        end-if
 21777        if update-elcrtt
 21778
 21779* EXEC CICS REWRITE
 21780*             DATASET    (crtt-ID)
 21781*             FROM       (CERTIFICATE-TRAILERS)
 21782*          END-EXEC
 21783     MOVE LENGTH OF
 21784      CERTIFICATE-TRAILERS
 21785       TO DFHEIV11
 21786*    MOVE '&& L                  %   #00018364' TO DFHEIV0
 21787     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21788     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21789     MOVE X'2020233030303138333634' TO DFHEIV0(25:11)
 21790     CALL 'kxdfhei1' USING DFHEIV0,
 21791           crtt-ID,
 21792           CERTIFICATE-TRAILERS,
 21793           DFHEIV11,
 21794           DFHEIV99
 21795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21796        else
 21797
 21798* exec cics unlock
 21799*             dataset    (crtt-ID)
 21800*          end-exec
 21801*    MOVE '&*                    #   #00018369' TO DFHEIV0
 21802     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21803     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21804     MOVE X'2020233030303138333639' TO DFHEIV0(25:11)
 21805     CALL 'kxdfhei1' USING DFHEIV0,
 21806           crtt-ID,
 21807           DFHEIV99
 21808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21809        end-if
 21810     end-if
 21811     .
 21812 5100-EXIT.
 21813     EXIT.
 21814
 21815******************************************************************
 21816*                                                                *
 21817*        B R O W S E   B A T C H   B A C K W A R D S             *
 21818*                                                                *
 21819******************************************************************
 21820
 21821 5500-BROWSE-BATCH-BACKWARD.
 21822
 21823* EXEC CICS HANDLE CONDITION
 21824*         NOTFND   (5550-END-RECORDS)
 21825*         ENDFILE  (5550-END-RECORDS)
 21826*    END-EXEC.
 21827*    MOVE '"$I''                  ! U #00018385' TO DFHEIV0
 21828     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21830     MOVE X'5520233030303138333835' TO DFHEIV0(25:11)
 21831     CALL 'kxdfhei1' USING DFHEIV0
 21832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21833
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 399
* EL6311.cbl
 21834
 21835 5505-START-BROWSE.
 21836     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21837     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21838     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21839
 21840
 21841* EXEC CICS STARTBR
 21842*         DATASET   (FILE-ID-ERPNDB)
 21843*         RIDFLD    (ERPNDB-ALT-KEY)
 21844*    END-EXEC.
 21845     MOVE 0
 21846       TO DFHEIV11
 21847*    MOVE '&,         G          &   #00018395' TO DFHEIV0
 21848     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21850     MOVE X'2020233030303138333935' TO DFHEIV0(25:11)
 21851     CALL 'kxdfhei1' USING DFHEIV0,
 21852           FILE-ID-ERPNDB,
 21853           ERPNDB-ALT-KEY,
 21854           DFHEIV99,
 21855           DFHEIV11,
 21856           DFHEIV99
 21857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21858
 21859
 21860     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21861
 21862
 21863* EXEC CICS READNEXT
 21864*         DATASET    (FILE-ID-ERPNDB)
 21865*         SET        (ADDRESS OF PENDING-BUSINESS)
 21866*         RIDFLD     (ERPNDB-KEY)
 21867*    END-EXEC.
 21868     MOVE 0
 21869       TO DFHEIV11
 21870*    MOVE '&.S                   )   #00018402' TO DFHEIV0
 21871     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21872     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21873     MOVE X'2020233030303138343032' TO DFHEIV0(25:11)
 21874     CALL 'kxdfhei1' USING DFHEIV0,
 21875           FILE-ID-ERPNDB,
 21876           DFHEIV20,
 21877           DFHEIV99,
 21878           ERPNDB-KEY,
 21879           DFHEIV99,
 21880           DFHEIV11,
 21881           DFHEIV99,
 21882           DFHEIV99
 21883     SET ADDRESS OF PENDING-BUSINESS TO
 21884         DFHEIV20
 21885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21886
 21887
 21888
 21889* EXEC CICS READPREV
 21890*         DATASET    (FILE-ID-ERPNDB)
 21891*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 400
* EL6311.cbl
 21892*         RIDFLD     (ERPNDB-KEY)
 21893*    END-EXEC.
 21894     MOVE 0
 21895       TO DFHEIV11
 21896*    MOVE '&0S                   )   #00018408' TO DFHEIV0
 21897     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21898     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21899     MOVE X'2020233030303138343038' TO DFHEIV0(25:11)
 21900     CALL 'kxdfhei1' USING DFHEIV0,
 21901           FILE-ID-ERPNDB,
 21902           DFHEIV20,
 21903           DFHEIV99,
 21904           ERPNDB-KEY,
 21905           DFHEIV99,
 21906           DFHEIV11,
 21907           DFHEIV99,
 21908           DFHEIV99
 21909     SET ADDRESS OF PENDING-BUSINESS TO
 21910         DFHEIV20
 21911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21912
 21913
 21914
 21915* EXEC CICS READPREV
 21916*         DATASET    (FILE-ID-ERPNDB)
 21917*         SET        (ADDRESS OF PENDING-BUSINESS)
 21918*         RIDFLD     (ERPNDB-KEY)
 21919*    END-EXEC.
 21920     MOVE 0
 21921       TO DFHEIV11
 21922*    MOVE '&0S                   )   #00018414' TO DFHEIV0
 21923     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21924     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21925     MOVE X'2020233030303138343134' TO DFHEIV0(25:11)
 21926     CALL 'kxdfhei1' USING DFHEIV0,
 21927           FILE-ID-ERPNDB,
 21928           DFHEIV20,
 21929           DFHEIV99,
 21930           ERPNDB-KEY,
 21931           DFHEIV99,
 21932           DFHEIV11,
 21933           DFHEIV99,
 21934           DFHEIV99
 21935     SET ADDRESS OF PENDING-BUSINESS TO
 21936         DFHEIV20
 21937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21938
 21939
 21940     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21941        GO TO 5550-END-RECORDS.
 21942
 21943     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21944
 21945     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21946
 21947     IF  WS-BATCH-PREFIX = '#CL'
 21948             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21949
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 401
* EL6311.cbl
 21950* EXEC CICS ENDBR
 21951*                 DATASET  (FILE-ID-ERPNDB)
 21952*            END-EXEC
 21953     MOVE 0
 21954       TO DFHEIV11
 21955*    MOVE '&2                    $   #00018429' TO DFHEIV0
 21956     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21957     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21958     MOVE X'2020233030303138343239' TO DFHEIV0(25:11)
 21959     CALL 'kxdfhei1' USING DFHEIV0,
 21960           FILE-ID-ERPNDB,
 21961           DFHEIV11,
 21962           DFHEIV99
 21963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21964         GO TO 5505-START-BROWSE.
 21965
 21966     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21967         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21968             NEXT SENTENCE
 21969         ELSE
 21970             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21971
 21972* EXEC CICS ENDBR
 21973*                 DATASET  (FILE-ID-ERPNDB)
 21974*            END-EXEC
 21975     MOVE 0
 21976       TO DFHEIV11
 21977*    MOVE '&2                    $   #00018439' TO DFHEIV0
 21978     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21979     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21980     MOVE X'2020233030303138343339' TO DFHEIV0(25:11)
 21981     CALL 'kxdfhei1' USING DFHEIV0,
 21982           FILE-ID-ERPNDB,
 21983           DFHEIV11,
 21984           DFHEIV99
 21985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21986             GO TO 5505-START-BROWSE.
 21987
 21988
 21989     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21990         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21991             NEXT SENTENCE
 21992        ELSE
 21993             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21994
 21995* EXEC CICS ENDBR
 21996*                 DATASET  (FILE-ID-ERPNDB)
 21997*            END-EXEC
 21998     MOVE 0
 21999       TO DFHEIV11
 22000*    MOVE '&2                    $   #00018450' TO DFHEIV0
 22001     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22002     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22003     MOVE X'2020233030303138343530' TO DFHEIV0(25:11)
 22004     CALL 'kxdfhei1' USING DFHEIV0,
 22005           FILE-ID-ERPNDB,
 22006           DFHEIV11,
 22007           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 402
* EL6311.cbl
 22008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22009             GO TO 5505-START-BROWSE.
 22010
 22011     IF NOT PB-BATCH-TRAILER
 22012        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 22013
 22014* EXEC CICS ENDBR
 22015*            DATASET  (FILE-ID-ERPNDB)
 22016*       END-EXEC
 22017     MOVE 0
 22018       TO DFHEIV11
 22019*    MOVE '&2                    $   #00018457' TO DFHEIV0
 22020     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22022     MOVE X'2020233030303138343537' TO DFHEIV0(25:11)
 22023     CALL 'kxdfhei1' USING DFHEIV0,
 22024           FILE-ID-ERPNDB,
 22025           DFHEIV11,
 22026           DFHEIV99
 22027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22028        GO TO 5505-START-BROWSE.
 22029
 22030     IF PI-CSR-BROWSE
 22031        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 22032           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 22033
 22034* EXEC CICS ENDBR
 22035*               DATASET  (FILE-ID-ERPNDB)
 22036*          END-EXEC
 22037     MOVE 0
 22038       TO DFHEIV11
 22039*    MOVE '&2                    $   #00018465' TO DFHEIV0
 22040     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22041     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22042     MOVE X'2020233030303138343635' TO DFHEIV0(25:11)
 22043     CALL 'kxdfhei1' USING DFHEIV0,
 22044           FILE-ID-ERPNDB,
 22045           DFHEIV11,
 22046           DFHEIV99
 22047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22048           GO TO 5505-START-BROWSE.
 22049
 22050     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 22051        IF PI-PB-CARRIER    = SPACES AND
 22052           PI-PB-GROUPING   = SPACES AND
 22053           PI-PB-STATE      = SPACES AND
 22054           PI-PB-ACCOUNT    = SPACES
 22055             GO TO 7200-DISPLAY-BATCHES
 22056          ELSE
 22057            IF PI-PB-CARRIER    = PB-CARRIER  AND
 22058               PI-PB-GROUPING   = PB-GROUPING AND
 22059               PI-PB-STATE      = PB-STATE    AND
 22060               PI-PB-ACCOUNT    = PB-ACCOUNT
 22061                 GO TO 7200-DISPLAY-BATCHES.
 22062
 22063     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 22064
 22065
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 403
* EL6311.cbl
 22066* EXEC CICS ENDBR
 22067*         DATASET  (FILE-ID-ERPNDB)
 22068*    END-EXEC.
 22069     MOVE 0
 22070       TO DFHEIV11
 22071*    MOVE '&2                    $   #00018485' TO DFHEIV0
 22072     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22073     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22074     MOVE X'2020233030303138343835' TO DFHEIV0(25:11)
 22075     CALL 'kxdfhei1' USING DFHEIV0,
 22076           FILE-ID-ERPNDB,
 22077           DFHEIV11,
 22078           DFHEIV99
 22079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22080
 22081
 22082     GO TO 5505-START-BROWSE.
 22083
 22084 5550-END-RECORDS.
 22085     MOVE ER-2257                TO EMI-ERROR.
 22086     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22087     MOVE -1                     TO DPFENTRL.
 22088
 22089     GO TO 8200-SEND-DATAONLY.
 22090
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 404
* EL6311.cbl
 22092
 22093******************************************************************
 22094*                                                                *
 22095*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 22096*                                                                *
 22097******************************************************************
 22098
 22099 6000-CREATE-TEMP-STORAGE.
 22100
 22101
 22102* EXEC CICS HANDLE CONDITION
 22103*        QIDERR  (6050-QID-ERROR)
 22104*    END-EXEC.
 22105*    MOVE '"$N                   ! V #00018508' TO DFHEIV0
 22106     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22108     MOVE X'5620233030303138353038' TO DFHEIV0(25:11)
 22109     CALL 'kxdfhei1' USING DFHEIV0
 22110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22111
 22112
 22113
 22114* EXEC CICS WRITEQ TS
 22115*        QUEUE    (QID)
 22116*        FROM     (PROGRAM-INTERFACE-BLOCK)
 22117*        LENGTH   (WS-COMM-LENGTH)
 22118*        ITEM     (W-ONE)
 22119*    END-EXEC.
 22120*    MOVE '*" I   L              ''   #00018512' TO DFHEIV0
 22121     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 22122     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22123     MOVE X'2020233030303138353132' TO DFHEIV0(25:11)
 22124     CALL 'kxdfhei1' USING DFHEIV0,
 22125           QID,
 22126           PROGRAM-INTERFACE-BLOCK,
 22127           WS-COMM-LENGTH,
 22128           W-ONE,
 22129           DFHEIV99,
 22130           DFHEIV99
 22131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22132
 22133
 22134 6000-EXIT.
 22135      EXIT.
 22136
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 405
* EL6311.cbl
 22138
 22139******************************************************************
 22140*                                                                *
 22141*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 22142*                                                                *
 22143******************************************************************
 22144
 22145 6050-RECOVER-TEMP-STORAGE.
 22146     IF PGM-NAME = XCTL-EL6312
 22147        GO TO 6050-EXIT.
 22148
 22149     IF PGM-NAME = XCTL-EL6313
 22150        GO TO 6050-EXIT.
 22151
 22152     IF PGM-NAME = XCTL-EL6315
 22153         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 22154     END-IF
 22155
 22156     IF PGM-NAME = XCTL-EL6316
 22157         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 22158     END-IF
 22159
 22160
 22161* EXEC CICS HANDLE CONDITION
 22162*        QIDERR  (6050-QID-ERROR)
 22163*    END-EXEC.
 22164*    MOVE '"$N                   ! W #00018545' TO DFHEIV0
 22165     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22167     MOVE X'5720233030303138353435' TO DFHEIV0(25:11)
 22168     CALL 'kxdfhei1' USING DFHEIV0
 22169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22170
 22171
 22172
 22173* EXEC CICS READQ TS
 22174*         QUEUE   (QID)
 22175*         INTO    (PROGRAM-INTERFACE-BLOCK)
 22176*         LENGTH  (WS-COMM-LENGTH)
 22177*         ITEM    (W-ONE)
 22178*     END-EXEC.
 22179*    MOVE '*$II   L              ''   #00018549' TO DFHEIV0
 22180     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 22181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22182     MOVE X'2020233030303138353439' TO DFHEIV0(25:11)
 22183     CALL 'kxdfhei1' USING DFHEIV0,
 22184           QID,
 22185           PROGRAM-INTERFACE-BLOCK,
 22186           WS-COMM-LENGTH,
 22187           W-ONE,
 22188           DFHEIV99,
 22189           DFHEIV99
 22190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22191
 22192
 22193 6050-DELETE-TEMP-STORAGE.
 22194
 22195
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 406
* EL6311.cbl
 22196* EXEC CICS DELETEQ TS
 22197*        QUEUE   (QID)
 22198*    END-EXEC.
 22199*    MOVE '*&                    #   #00018558' TO DFHEIV0
 22200     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 22201     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22202     MOVE X'2020233030303138353538' TO DFHEIV0(25:11)
 22203     CALL 'kxdfhei1' USING DFHEIV0,
 22204           QID,
 22205           DFHEIV99
 22206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22207
 22208
 22209     GO TO 6050-EXIT.
 22210
 22211 6050-QID-ERROR.
 22212     MOVE ER-0033                TO EMI-ERROR
 22213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22214
 22215 6050-EXIT.
 22216      EXIT.
 22217
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 407
* EL6311.cbl
 22219
 22220******************************************************************
 22221*                                                                *
 22222*            T E R M   C O N V E R S I O N                       *
 22223*                                                                *
 22224******************************************************************
 22225
 22226 6100-TERM-CONVERSION.
 22227
 22228     IF PI-BPMTS = ZERO
 22229         GO TO 6199-EXIT.
 22230
 22231     IF PI-BMODE = ' ' OR 'M'
 22232         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 22233         GO TO 6105-ROUND-TERM.
 22234
 22235     IF PI-BMODE = 'S'
 22236         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 22237         GO TO 6105-ROUND-TERM.
 22238
 22239     IF PI-BMODE = 'W'
 22240         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 22241         GO TO 6105-ROUND-TERM.
 22242
 22243     IF PI-BMODE = 'B'
 22244         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 22245         GO TO 6105-ROUND-TERM.
 22246
 22247     IF PI-BMODE = 'T'
 22248         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 22249
 22250 6105-ROUND-TERM.
 22251
 22252     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 22253         ADD +1                  TO WS-CALC-TERM-WHOLE
 22254         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 22255
 22256     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 22257         GO TO 6125-COMPUTE-TERM-BENEFIT.
 22258
 22259     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 22260         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 22261                                      WS-BTERM    (WS-SUB1)
 22262         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 22263
 22264     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 22265         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 22266             MOVE -1               TO BMODEL
 22267             MOVE ER-2593          TO EMI-ERROR
 22268             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 22269             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22270
 22271 6124-CHECK-BENEFIT.
 22272
 22273     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 22274        GO TO 6126-COMPUTE-BENEFIT.
 22275
 22276     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 408
* EL6311.cbl
 22277
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 409
* EL6311.cbl
 22279******************************************************************
 22280**         COMPUTE TERM AND BENEFIT
 22281******************************************************************
 22282 6125-COMPUTE-TERM-BENEFIT.
 22283
 22284     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 22285        PI-BPMTAMT = ZERO
 22286         GO TO 6199-EXIT.
 22287
 22288     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 22289                                     WS-BTERM  (WS-SUB1).
 22290     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 22291
 22292 6126-COMPUTE-BENEFIT.
 22293
 22294     IF PI-BMODE = 'M' OR  ' '
 22295         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 22296
 22297     IF PI-BMODE = 'W'
 22298         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 22299
 22300     IF PI-BMODE = 'S'
 22301         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 22302
 22303     IF PI-BMODE = 'B'
 22304         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 22305
 22306     IF PI-BMODE = 'T'
 22307         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 22308
 22309     IF WS-SUB1 = +1
 22310        COMPUTE WS-BBEN (WS-SUB1) =
 22311                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 22312
 22313     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 22314     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 22315     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 22316
 22317 6199-EXIT.
 22318     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 410
* EL6311.cbl
 22320
 22321******************************************************************
 22322*                                                                *
 22323*             D I S P L A Y   I S S U E S                        *
 22324*                                                                *
 22325******************************************************************
 22326
 22327 6200-CREATE-VADS.
 22328     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 22329     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 22330     MOVE SPACES                 TO WS-PASS-VADS-REC
 22331
 22332* EXEC CICS GETMAIN
 22333*       SET      (ADDRESS OF PENDING-BUSINESS)
 22334*       LENGTH   (ERPNDB-RECORD-LENGTH)
 22335*       INITIMG  (GETMAIN-SPACE)
 22336*       RESP     (WS-RESPONSE)
 22337*    END-EXEC
 22338*    MOVE ',"IL                  $  N#00018684' TO DFHEIV0
 22339     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22341     MOVE X'204E233030303138363834' TO DFHEIV0(25:11)
 22342     CALL 'kxdfhei1' USING DFHEIV0,
 22343           DFHEIV20,
 22344           ERPNDB-RECORD-LENGTH,
 22345           GETMAIN-SPACE
 22346     SET ADDRESS OF PENDING-BUSINESS TO
 22347         DFHEIV20
 22348     MOVE EIBRESP  TO WS-RESPONSE
 22349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22350
 22351* EXEC CICS READ
 22352*       INTO    (PENDING-BUSINESS)
 22353*       DATASET (FILE-ID-ERPNDB)
 22354*       RIDFLD  (ERPNDB-KEY)
 22355*       RESP    (WS-RESPONSE)
 22356*    END-EXEC
 22357     MOVE LENGTH OF
 22358      PENDING-BUSINESS
 22359       TO DFHEIV11
 22360*    MOVE '&"IL       E          (  N#00018690' TO DFHEIV0
 22361     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22362     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22363     MOVE X'204E233030303138363930' TO DFHEIV0(25:11)
 22364     CALL 'kxdfhei1' USING DFHEIV0,
 22365           FILE-ID-ERPNDB,
 22366           PENDING-BUSINESS,
 22367           DFHEIV11,
 22368           ERPNDB-KEY,
 22369           DFHEIV99,
 22370           DFHEIV99,
 22371           DFHEIV99
 22372     MOVE EIBRESP  TO WS-RESPONSE
 22373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22374     IF RESP-NORMAL
 22375        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22376        IF (RESP-NORMAL)
 22377           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 411
* EL6311.cbl
 22378              AM-CONTROL-PRIMARY (1:20))
 22379           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 22380        ELSE
 22381           MOVE 'ACCOUNT NOT FOUND'
 22382                                 TO VD-ACCOUNT-NAME
 22383        END-IF
 22384        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 22385                                    TO M1
 22386        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 22387        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 22388           (A2 > M1)
 22389           OR (WS-WORK-FIELD (A2:1) = '*')
 22390           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 22391           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 22392        END-PERFORM
 22393        IF A2 > M1
 22394           CONTINUE
 22395        ELSE
 22396           MOVE WS-WORK-FIELD (1:A2 - 1)
 22397                                    TO VD-ACCOUNT-NAME
 22398        END-IF
 22399        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 22400        MOVE PB-CARRIER          TO VD-CARRIER
 22401        MOVE PB-GROUPING         TO VD-GROUPING
 22402        MOVE PB-STATE            TO VD-STATE
 22403        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22404        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22405        MOVE PB-CERT-NO          TO VD-CERT-NO
 22406        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22407        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22408        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22409        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22410        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22411        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22412        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22413        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22414        MOVE PB-CSR-ID           TO VD-CSR-ID
 22415        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22416        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22417        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22418        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22419        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22420        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22421        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22422        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22423        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22424        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22425        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22426        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22427        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22428     END-IF
 22429     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22430
 22431
 22432* EXEC CICS GETMAIN
 22433*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22434*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22435*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 412
* EL6311.cbl
 22436*       RESP     (WS-RESPONSE)
 22437*    END-EXEC
 22438*    MOVE ',"IL                  $  N#00018753' TO DFHEIV0
 22439     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22440     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22441     MOVE X'204E233030303138373533' TO DFHEIV0(25:11)
 22442     CALL 'kxdfhei1' USING DFHEIV0,
 22443           DFHEIV20,
 22444           ERPNDM-RECORD-LENGTH,
 22445           GETMAIN-SPACE
 22446     SET ADDRESS OF PENDING-MAILING-DATA TO
 22447         DFHEIV20
 22448     MOVE EIBRESP  TO WS-RESPONSE
 22449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22450
 22451
 22452* EXEC CICS READ
 22453*       INTO    (PENDING-MAILING-DATA)
 22454*       DATASET (FILE-ID-ERPNDM)
 22455*       RIDFLD  (ERPNDM-KEY)
 22456*       RESP    (WS-RESPONSE)
 22457*    END-EXEC
 22458     MOVE LENGTH OF
 22459      PENDING-MAILING-DATA
 22460       TO DFHEIV11
 22461*    MOVE '&"IL       E          (  N#00018760' TO DFHEIV0
 22462     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22463     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22464     MOVE X'204E233030303138373630' TO DFHEIV0(25:11)
 22465     CALL 'kxdfhei1' USING DFHEIV0,
 22466           FILE-ID-ERPNDM,
 22467           PENDING-MAILING-DATA,
 22468           DFHEIV11,
 22469           ERPNDM-KEY,
 22470           DFHEIV99,
 22471           DFHEIV99,
 22472           DFHEIV99
 22473     MOVE EIBRESP  TO WS-RESPONSE
 22474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22475
 22476     IF RESP-NORMAL
 22477        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22478        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22479        MOVE PM-CITY              TO VD-INSURED-CITY
 22480        MOVE PM-STATE             TO VD-INSURED-STATE
 22481        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22482     END-IF
 22483
 22484     MOVE 'VAC1'                  TO VD-LETTER-ID
 22485     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22486     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22487     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22488     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22489     MOVE +0                      TO VD-ARCHIVE-NO
 22490     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22491     .
 22492 6200-EXIT.
 22493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 413
* EL6311.cbl
 22494 6210-READ-ERACCT.
 22495     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22496     MOVE LOW-VALUES             TO ERACCT-FILL
 22497
 22498* EXEC CICS READ
 22499*         DATASET   ('ERACCT')
 22500*         INTO      (ACCOUNT-MASTER)
 22501*         RIDFLD    (ERACCT-KEY)
 22502*         GTEQ
 22503*         RESP      (WS-RESPONSE)
 22504*    END-EXEC
 22505     MOVE LENGTH OF
 22506      ACCOUNT-MASTER
 22507       TO DFHEIV11
 22508     MOVE 'ERACCT' TO DFHEIV1
 22509*    MOVE '&"IL       G          (  N#00018788' TO DFHEIV0
 22510     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22511     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22512     MOVE X'204E233030303138373838' TO DFHEIV0(25:11)
 22513     CALL 'kxdfhei1' USING DFHEIV0,
 22514           DFHEIV1,
 22515           ACCOUNT-MASTER,
 22516           DFHEIV11,
 22517           ERACCT-KEY,
 22518           DFHEIV99,
 22519           DFHEIV99,
 22520           DFHEIV99
 22521     MOVE EIBRESP  TO WS-RESPONSE
 22522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22523     .
 22524 6210-EXIT.
 22525     EXIT.
 22526
 22527 6220-READ-ERMAIL.
 22528
 22529     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22530     MOVE ' '                    TO WS-ERMAIL-SW
 22531
 22532
 22533* EXEC CICS READ
 22534*       DATASET   (FILE-ID-ERMAIL)
 22535*       SET       (ADDRESS OF MAILING-DATA)
 22536*       RIDFLD    (ERMAIL-KEY)
 22537*       RESP      (WS-RESPONSE)
 22538*    END-EXEC
 22539*    MOVE '&"S        E          (  N#00018804' TO DFHEIV0
 22540     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22542     MOVE X'204E233030303138383034' TO DFHEIV0(25:11)
 22543     CALL 'kxdfhei1' USING DFHEIV0,
 22544           FILE-ID-ERMAIL,
 22545           DFHEIV20,
 22546           DFHEIV99,
 22547           ERMAIL-KEY,
 22548           DFHEIV99,
 22549           DFHEIV99,
 22550           DFHEIV99
 22551     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 414
* EL6311.cbl
 22552         DFHEIV20
 22553     MOVE EIBRESP  TO WS-RESPONSE
 22554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22555
 22556     IF RESP-NORMAL
 22557        SET ERMAIL-FOUND TO TRUE
 22558     END-IF
 22559     .
 22560 6220-EXIT.
 22561     EXIT.
 22562
 22563 6400-CHECK-FOR-RES-REF-CLAIM.
 22564     display 'made it to 6400- for ' pi-cert-no
 22565     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22566
 22567     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22568                                    W-CL-COMP-CD.
 22569     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22570                                    W-CL-CERT-NO.
 22571     MOVE SPACES                 TO MSTR-CERT-SFX.
 22572
 22573
 22574* EXEC CICS HANDLE CONDITION
 22575*        NOTFND  (6400-CONTINUE)
 22576*        ENDFILE (6400-CONTINUE)
 22577*    END-EXEC.
 22578*    MOVE '"$I''                  ! X #00018828' TO DFHEIV0
 22579     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22581     MOVE X'5820233030303138383238' TO DFHEIV0(25:11)
 22582     CALL 'kxdfhei1' USING DFHEIV0
 22583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22584
 22585
 22586
 22587* EXEC CICS IGNORE CONDITION
 22588*        DUPKEY
 22589*    END-EXEC.
 22590*    MOVE '"*$                   !   #00018833' TO DFHEIV0
 22591     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22593     MOVE X'2020233030303138383333' TO DFHEIV0(25:11)
 22594     CALL 'kxdfhei1' USING DFHEIV0
 22595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22596
 22597
 22598
 22599* EXEC CICS STARTBR
 22600*        DATASET   (CLMS-ID)
 22601*        RIDFLD    (ELMSTR-KEY)
 22602*        GENERIC   EQUAL
 22603*        KEYLENGTH (ELMSTR-LENGTH)
 22604*    END-EXEC.
 22605     MOVE 0
 22606       TO DFHEIV11
 22607*    MOVE '&,   KG    E          &   #00018837' TO DFHEIV0
 22608     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22609     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 415
* EL6311.cbl
 22610     MOVE X'2020233030303138383337' TO DFHEIV0(25:11)
 22611     CALL 'kxdfhei1' USING DFHEIV0,
 22612           CLMS-ID,
 22613           ELMSTR-KEY,
 22614           ELMSTR-LENGTH,
 22615           DFHEIV11,
 22616           DFHEIV99
 22617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22618
 22619
 22620     display 'browse started'
 22621     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22622
 22623 6400-NEXT-CLAIM.
 22624
 22625
 22626* EXEC CICS READNEXT
 22627*        DATASET   (CLMS-ID)
 22628*        RIDFLD    (ELMSTR-KEY)
 22629*        SET       (ADDRESS OF CLAIM-MASTER)
 22630*    END-EXEC.
 22631     MOVE 0
 22632       TO DFHEIV11
 22633*    MOVE '&.S                   )   #00018849' TO DFHEIV0
 22634     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22635     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22636     MOVE X'2020233030303138383439' TO DFHEIV0(25:11)
 22637     CALL 'kxdfhei1' USING DFHEIV0,
 22638           CLMS-ID,
 22639           DFHEIV20,
 22640           DFHEIV99,
 22641           ELMSTR-KEY,
 22642           DFHEIV99,
 22643           DFHEIV11,
 22644           DFHEIV99,
 22645           DFHEIV99
 22646     SET ADDRESS OF CLAIM-MASTER TO
 22647         DFHEIV20
 22648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22649
 22650
 22651     display 'read claim for ' mstr-cert-no
 22652     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22653        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22654         GO TO 6400-CONTINUE
 22655     END-IF.
 22656
 22657     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22658        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22659        PI-STATE       NOT = CL-CERT-STATE     OR
 22660        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22661        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22662         GO TO 6400-NEXT-CLAIM
 22663     END-IF.
 22664
 22665     display 'found claim ' cl-claim-no
 22666        ' with denial type ' cl-denial-type
 22667     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 416
* EL6311.cbl
 22668         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22669         GO TO 6400-CONTINUE
 22670     END-IF.
 22671
 22672     GO TO 6400-NEXT-CLAIM.
 22673
 22674 6400-CONTINUE.
 22675
 22676     IF WS-BROWSE-STARTED-SW = 'Y'
 22677
 22678* EXEC CICS ENDBR
 22679*            DATASET   (CLMS-ID)
 22680*        END-EXEC
 22681     MOVE 0
 22682       TO DFHEIV11
 22683*    MOVE '&2                    $   #00018881' TO DFHEIV0
 22684     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22685     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22686     MOVE X'2020233030303138383831' TO DFHEIV0(25:11)
 22687     CALL 'kxdfhei1' USING DFHEIV0,
 22688           CLMS-ID,
 22689           DFHEIV11,
 22690           DFHEIV99
 22691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22692         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22693     END-IF.
 22694
 22695 6400-EXIT.
 22696     EXIT.
 22697
 22698 7000-DISPLAY-ISSUES.
 22699
 22700     IF PI-DISPLAY-ORIGINAL-BATCH
 22701        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22702        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22703     ELSE
 22704        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22705
 22706     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22707
 22708     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22709     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22710
 22711     MOVE LOW-VALUES                 TO EL631BI.
 22712     MOVE ZEROS                      TO PI-BPMTAMT
 22713                                        PI-BPMTS.
 22714     MOVE SPACE                      TO PI-BMODE
 22715                                        PI-BTYPE (1)
 22716                                        PI-BTYPE (2).
 22717     MOVE EL631B                     TO PI-MAP-NAME.
 22718     MOVE 'Y'                        TO PI-BROWSE-SW.
 22719     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22720                                        PI-HIGH-SEQ-NO.
 22721
 22722     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22723        MOVE AL-SABOF                TO BCHGTA
 22724        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22725        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 417
* EL6311.cbl
 22726     ELSE
 22727        MOVE AL-SADOF                TO BCHGTA
 22728                                        BCHGA
 22729        MOVE PB-CHG-COUNT            TO BCHGO.
 22730
 22731     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22732     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22733     MOVE WS-HR-MINS                 TO BMANTATO.
 22734
 22735     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22736        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22737        MOVE SPACE                   TO DC-OPTION-CODE
 22738        PERFORM 9700-DATE-LINK
 22739        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22740        MOVE 'INACTIVE'              TO BMOENDTO
 22741     ELSE
 22742        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22743        MOVE SPACE                   TO DC-OPTION-CODE
 22744        PERFORM 9700-DATE-LINK
 22745        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22746        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22747        MOVE SPACE                   TO DC-OPTION-CODE
 22748        PERFORM 9700-DATE-LINK
 22749        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22750
 22751*    MOVE PB-I-REFERENCE             TO BREFO.
 22752
 22753*    IF PI-COMPANY-ID EQUAL 'HER'
 22754*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22755*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22756*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22757*                MOVE WS-MEMBER-NO-1-8
 22758*                                TO  BMICRNOO.
 22759
 22760*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22761*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22762*            MOVE PB-I-MICROFILM-NO
 22763*                                TO  BMICRNOO.
 22764     IF PB-I-VIN NOT = SPACES
 22765        MOVE PB-I-VIN            TO BVINO
 22766     END-IF
 22767     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22768
 22769
 22770     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22771     MOVE PB-CERT-SFX                TO BSUFIXO.
 22772     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22773     MOVE SPACE                      TO DC-OPTION-CODE.
 22774     PERFORM 9700-DATE-LINK.
 22775     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22776
 22777     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22778     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22779     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22780     MOVE PB-I-INSURED-SEX           TO BSEXO
 22781
 22782     IF PB-I-AGE NOT = ZEROS
 22783         MOVE PB-I-AGE               TO BAGEO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 418
* EL6311.cbl
 22784
 22785     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22786                                 TO ELCERT-KEY
 22787     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22788     IF NOT CERT-TRL-REC-NOT-FOUND
 22789         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22790             MOVE 'AGE*'             TO BAGEDEFO
 22791         ELSE
 22792             MOVE 'AGE '             TO BAGEDEFO
 22793         END-IF
 22794     ELSE
 22795         MOVE 'AGE '             TO BAGEDEFO
 22796     END-IF
 22797
 22798     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22799         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22800         MOVE SPACE                  TO DC-OPTION-CODE
 22801         PERFORM 9700-DATE-LINK
 22802         IF NO-CONVERSION-ERROR
 22803            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22804
 22805     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22806         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22807         MOVE SPACE                  TO DC-OPTION-CODE
 22808         PERFORM 9700-DATE-LINK
 22809         IF NO-CONVERSION-ERROR
 22810            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22811
 22812     IF PB-I-EXTENTION-DAYS NUMERIC
 22813        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22814           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22815        ELSE
 22816           IF PB-I-TERM-IN-DAYS NUMERIC
 22817              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22818                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22819
 22820     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22821        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22822
 22823     MOVE PB-FORCE-CODE              TO BFORCEO.
 22824     MOVE PB-I-TERM-TYPE             TO BMODEO
 22825                                        PI-BMODE.
 22826
 22827     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22828        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22829
 22830     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22831         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22832                                        PI-BPMTS.
 22833
 22834     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22835         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22836           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22837                                        PI-BPMTAMT.
 22838
 22839     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22840     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22841     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 419
* EL6311.cbl
 22842     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22843     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22844     MOVE PB-I-SIG-SW                TO BSIGO.
 22845     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22846     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22847     MOVE PB-RECORD-BILL             TO BBILCDO.
 22848     MOVE PB-FORCE-CODE              TO BFORCEO.
 22849
 22850     IF (PB-I-LIVES NUMERIC)
 22851        AND (PB-I-LIVES > ZEROS)
 22852        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22853        IF (RESP-NORMAL)
 22854           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22855           CONTINUE
 22856        ELSE
 22857           MOVE PB-I-LIVES       TO BLIVESO
 22858        END-IF
 22859     END-IF
 22860
 22861     IF PB-I-NUM-BILLED NUMERIC AND
 22862        PB-I-NUM-BILLED GREATER THAN ZEROS
 22863        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22864*    ELSE
 22865*       MOVE ZEROS                   TO BBILLEDO.
 22866
 22867     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22868
 22869     IF PB-I-LOAN-APR NOT = +99.9999
 22870        MOVE PB-I-LOAN-APR           TO BAPRO.
 22871
 22872     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22873        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22874
 22875     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22876        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22877           MOVE AL-SANOF                TO BORIGHDA
 22878           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22879           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22880
 22881     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22882
 22883     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22884        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22885
 22886     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22887        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22888                                        PI-BTYPE (1).
 22889
 22890     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22891        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22892
 22893     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22894        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22895
 22896     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22897        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22898
 22899     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 420
* EL6311.cbl
 22900        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22901
 22902     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22903        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22904
 22905     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22906         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22907         MOVE SPACE                  TO DC-OPTION-CODE
 22908         PERFORM 9700-DATE-LINK
 22909         IF NO-CONVERSION-ERROR
 22910            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22911
 22912     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22913        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22914        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22915        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22916        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22917                 GIVING BDIFFO (1)
 22918     ELSE
 22919        MOVE SPACES                  TO BBEN-CD     (1)
 22920                                        BBEN-ABBR   (1).
 22921
 22922     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22923        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22924        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22925                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22926
 22927     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22928       IF PB-RECORD-ON-HOLD
 22929          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22930
 22931     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22932       IF PB-RECORD-RETURNED
 22933          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22934
 22935     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22936        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22937             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22938
 22939     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22940
 22941     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22942        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22943
 22944     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22945        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22946                                        PI-BTYPE (2).
 22947
 22948     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22949        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22950
 22951     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22952        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22953
 22954     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22955        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22956
 22957     IF PB-I-TOT-FEES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 421
* EL6311.cbl
 22958        MOVE ZEROS               TO PB-I-TOT-FEES
 22959     END-IF
 22960     IF PB-I-TOT-FEES > ZEROS
 22961        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22962
 22963     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22964         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22965         MOVE SPACE                  TO DC-OPTION-CODE
 22966         PERFORM 9700-DATE-LINK
 22967         IF NO-CONVERSION-ERROR
 22968            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22969
 22970     IF PB-I-TOT-FEES > ZEROS
 22971        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22972        SUBTRACT PB-I-TOT-FEES FROM
 22973                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22974
 22975     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22976        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22977        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22978        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22979        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22980                 GIVING BDIFFO (2)
 22981     ELSE
 22982        MOVE SPACES                  TO BBEN-CD     (2)
 22983                                        BBEN-ABBR   (2).
 22984
 22985     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22986       IF PB-RECORD-ON-HOLD
 22987          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22988
 22989     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22990       IF PB-RECORD-RETURNED
 22991          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22992
 22993     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22994        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22995             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22996
 22997     MOVE PB-CSR-ID                  TO BCSRO.
 22998
 22999     IF PI-COMPANY-ID  =  'DMD'
 23000        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 23001            NEXT SENTENCE
 23002        ELSE
 23003            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 23004               MOVE 'NEW CERT'       TO BNCERTLI
 23005               MOVE EC-NEW-CERT      TO BNCERTO.
 23006
 23007     IF PI-COMPANY-ID  =  'DMD'
 23008        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 23009            NEXT SENTENCE
 23010        ELSE
 23011           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 23012               MOVE 'NEW STATE'      TO BNSTATLI
 23013               MOVE EC-NEW-STATE     TO BNSTATO.
 23014
 23015 7000-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 422
* EL6311.cbl
 23016     MOVE 'C'                        TO BMAINTI.
 23017     MOVE AL-UANON                   TO BMAINTA.
 23018
 23019     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23020        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23021
 23022     IF ARCHIVE-LETTER-RELEASED
 23023        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 23024     END-IF
 23025     IF PI-6315-FINALIZED = 'Y'   AND
 23026        PB-UNFORCED-ERRORS
 23027          MOVE -1                TO BFORCEL
 23028          MOVE  1                TO SET-CURSOR-SW
 23029     END-IF
 23030
 23031     IF NO-CURSOR-SET
 23032        MOVE -1                      TO BMAINTL.
 23033
 23034     GO TO 8100-SEND-INITIAL-MAP.
 23035
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 423
* EL6311.cbl
 23037
 23038 7050-UPDATE-PENDING.
 23039
 23040* EXEC CICS READ
 23041*        DATASET (FILE-ID-ERPNDB)
 23042*        INTO    (PENDING-BUSINESS)
 23043*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 23044*        UPDATE
 23045*    END-EXEC.
 23046     MOVE LENGTH OF
 23047      PENDING-BUSINESS
 23048       TO DFHEIV11
 23049*    MOVE '&"IL       EU         (   #00019231' TO DFHEIV0
 23050     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23051     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23052     MOVE X'2020233030303139323331' TO DFHEIV0(25:11)
 23053     CALL 'kxdfhei1' USING DFHEIV0,
 23054           FILE-ID-ERPNDB,
 23055           PENDING-BUSINESS,
 23056           DFHEIV11,
 23057           PI-PREV-CONTROL-PRIMARY,
 23058           DFHEIV99,
 23059           DFHEIV99,
 23060           DFHEIV99
 23061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23062
 23063
 23064     MOVE 'C' TO PB-I-LETTER-REQD
 23065     MOVE PB-I-LETTER-REQD       TO LETRREQO
 23066     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 23067     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 23068     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 23069     MOVE '5'                    TO DC-OPTION-CODE.
 23070     PERFORM 9700-DATE-LINK
 23071     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 23072
 23073
 23074* EXEC CICS REWRITE
 23075*        DATASET (FILE-ID-ERPNDB)
 23076*        FROM    (PENDING-BUSINESS)
 23077*    END-EXEC.
 23078     MOVE LENGTH OF
 23079      PENDING-BUSINESS
 23080       TO DFHEIV11
 23081*    MOVE '&& L                  %   #00019247' TO DFHEIV0
 23082     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23083     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23084     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 23085     CALL 'kxdfhei1' USING DFHEIV0,
 23086           FILE-ID-ERPNDB,
 23087           PENDING-BUSINESS,
 23088           DFHEIV11,
 23089           DFHEIV99
 23090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23091
 23092
 23093 7050-EXIT.
 23094      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 424
* EL6311.cbl
 23095
 23096******************************************************************
 23097*                                                                *
 23098*             D I S P L A Y   C A N C E L S                      *
 23099*                                                                *
 23100******************************************************************
 23101
 23102 7100-DISPLAY-CANCELS.
 23103     IF PI-DISPLAY-ORIGINAL-BATCH
 23104        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 23105        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 23106     ELSE
 23107        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 23108
 23109     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 23110
 23111     MOVE 'Y'                        TO WS-DISPLAY-SW.
 23112     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 23113
 23114     MOVE LOW-VALUES                 TO EL631CI.
 23115     MOVE EL631C                     TO PI-MAP-NAME.
 23116     MOVE 'Y'                        TO PI-BROWSE-SW.
 23117     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 23118                                        PI-HIGH-SEQ-NO.
 23119
 23120     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 23121        MOVE AL-SABOF                TO CCHGTA
 23122        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 23123        MOVE AL-SANON                TO CCHGA
 23124      ELSE
 23125        MOVE AL-SADOF                TO CCHGTA
 23126                                        CCHGA
 23127        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 23128
 23129*    MOVE PB-C-REFERENCE             TO CREFO.
 23130
 23131*    IF PB-C-MICROFILM-NO IS NUMERIC
 23132*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 23133*          MOVE PB-C-MICROFILM-NO
 23134*                                TO CMICRNOO
 23135*          MOVE AL-UNNON         TO CMICRNOA
 23136*       END-IF
 23137*    END-IF
 23138     IF PB-C-INT-ON-REFS NUMERIC
 23139        IF PB-C-INT-ON-REFS NOT = ZEROS
 23140           MOVE PB-C-INT-ON-REFS
 23141                                 TO CNHINTO
 23142           MOVE AL-SANOF         TO CNHINTA
 23143        END-IF
 23144     END-IF
 23145     MOVE PB-CERT-PRIME              TO CCERTNOO.
 23146     MOVE PB-CERT-SFX                TO CSUFIXO.
 23147     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 23148     MOVE SPACE                      TO DC-OPTION-CODE.
 23149     PERFORM 9700-DATE-LINK.
 23150     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 23151
 23152     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 425
* EL6311.cbl
 23153        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 23154        MOVE SPACE                   TO DC-OPTION-CODE
 23155        PERFORM 9700-DATE-LINK
 23156        IF NO-CONVERSION-ERROR
 23157           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 23158
 23159     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 23160        NEXT SENTENCE
 23161     ELSE
 23162        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 23163
 23164     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 23165        NEXT SENTENCE
 23166     ELSE
 23167        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 23168
 23169     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 23170        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 23171        MOVE SPACE                   TO DC-OPTION-CODE
 23172        PERFORM 9700-DATE-LINK
 23173        IF NO-CONVERSION-ERROR
 23174           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 23175
 23176     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23177         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 23178
 23179     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23180         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 23181
 23182     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 23183        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 23184        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 23185                 GIVING CDRFND1O.
 23186
 23187     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 23188        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 23189        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 23190                 GIVING CDRFND2O.
 23191
 23192     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23193       IF PB-RECORD-ON-HOLD
 23194          MOVE 'ON HOLD'             TO CBILIT1O.
 23195
 23196     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23197       IF PB-RECORD-RETURNED
 23198          MOVE 'RETURNED'            TO CBILIT1O.
 23199
 23200     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23201        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 23202             MOVE 'OVERRIDE'         TO CBILIT1O.
 23203
 23204     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23205       IF PB-RECORD-ON-HOLD
 23206          MOVE 'ON HOLD'             TO CBILIT2O.
 23207
 23208     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23209       IF PB-RECORD-RETURNED
 23210          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 426
* EL6311.cbl
 23211
 23212     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23213        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 23214             MOVE 'OVERRIDE'         TO CBILIT2O.
 23215
 23216     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 23217     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 23218     IF PB-C-POST-CARD-IND = 'Y'
 23219        MOVE 'Y'                     TO CPCYNO
 23220     ELSE
 23221        MOVE 'N'                     TO CPCYNO
 23222     END-IF
 23223     MOVE PB-FORCE-CODE              TO CFORCEO.
 23224     MOVE PB-RECORD-BILL             TO CBILCDO.
 23225     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 23226     MOVE SPACES                     TO CINITSO.
 23227     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 23228         MOVE PB-CI-FIRST-NAME       TO CINITSO
 23229     ELSE
 23230         MOVE PB-CI-INITIALS         TO CINITSO
 23231     END-IF.
 23232
 23233     IF PB-CI-CANCEL-FEE NUMERIC
 23234        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 23235        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 23236     ELSE
 23237        MOVE ZEROES                  TO W-CANCEL-FEE.
 23238
 23239     MOVE W-CANCEL-FEE               TO CCANFEEO.
 23240
 23241     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 23242        ADD PB-CI-LF-PREMIUM-AMT
 23243             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 23244
 23245     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 23246        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 23247
 23248     MOVE PB-CI-LF-TERM              TO CTERM1O.
 23249     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 23250     MOVE PB-CI-AH-TERM              TO CTERM2O.
 23251     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 23252
 23253     IF PB-C-LIVES NUMERIC
 23254        MOVE PB-C-LIVES              TO CLIVESO.
 23255
 23256     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 23257        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 23258
 23259     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 23260        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 23261        MOVE SPACE                   TO DC-OPTION-CODE
 23262        PERFORM 9700-DATE-LINK
 23263        IF NO-CONVERSION-ERROR
 23264           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 23265
 23266     IF  PB-C-REFUND-CREATED
 23267         MOVE 'YES'                  TO CRFNDSWO
 23268     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 427
* EL6311.cbl
 23269         IF PB-C-REFUND-REQUESTED
 23270            MOVE 'REQ'               TO CRFNDSWO
 23271         ELSE
 23272            MOVE 'NO'                TO CRFNDSWO.
 23273
 23274     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 23275     MOVE SPACE                      TO DC-OPTION-CODE.
 23276     PERFORM 9700-DATE-LINK.
 23277     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 23278     MOVE PB-INPUT-BY                TO CENTBYO.
 23279
 23280     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23281        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 23282        MOVE SPACE                   TO DC-OPTION-CODE
 23283        PERFORM 9700-DATE-LINK
 23284        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23285        MOVE 'INACTIVE'              TO CMOENDTO
 23286     ELSE
 23287        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 23288        MOVE SPACE                   TO DC-OPTION-CODE
 23289        PERFORM 9700-DATE-LINK
 23290        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23291        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 23292        MOVE SPACE                   TO DC-OPTION-CODE
 23293        PERFORM 9700-DATE-LINK
 23294        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 23295
 23296     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 23297
 23298     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 23299     MOVE WS-HR-MINS                 TO CMANTATO.
 23300
 23301     EVALUATE PB-LF-REFUND-TYPE
 23302        WHEN '1'
 23303           MOVE 'RULE78'            TO CLFREFNO
 23304        WHEN '2'
 23305           MOVE 'PRORAT'            TO CLFREFNO
 23306        WHEN '3'
 23307           MOVE 'CALIF'             TO CLFREFNO
 23308        WHEN '4'
 23309           MOVE 'IRREG'             TO CLFREFNO
 23310        WHEN '5'
 23311           MOVE 'NETPAY'            TO CLFREFNO
 23312        WHEN '6'
 23313           MOVE 'ATCP'              TO CLFREFNO
 23314        WHEN '7'
 23315           MOVE 'UTAH'              TO CLFREFNO
 23316        WHEN '8'
 23317           MOVE 'MEAN'              TO CLFREFNO
 23318        WHEN '9'
 23319           MOVE 'SUM '              TO CLFREFNO
 23320        WHEN 'B'
 23321           MOVE 'BALN'              TO CLFREFNO
 23322     END-EVALUATE.
 23323
 23324     EVALUATE TRUE
 23325        WHEN PB-AH-REFUND-TYPE =  '1'
 23326           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 428
* EL6311.cbl
 23327        WHEN PB-AH-REFUND-TYPE =  '2'
 23328           MOVE 'PRORAT'            TO CAHREFNO
 23329        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 23330           MOVE 'CALIF'             TO CAHREFNO
 23331        WHEN PB-AH-REFUND-TYPE =  '4'
 23332           MOVE 'IRREG'             TO CAHREFNO
 23333        WHEN PB-AH-REFUND-TYPE =  '5'
 23334           MOVE 'NETPAY'            TO CAHREFNO
 23335        WHEN PB-AH-REFUND-TYPE =  '6'
 23336           MOVE 'ATCP'              TO CAHREFNO
 23337        WHEN PB-AH-REFUND-TYPE =  '7'
 23338           MOVE 'UTAH'              TO CAHREFNO
 23339        WHEN PB-AH-REFUND-TYPE =  '8'
 23340           MOVE 'MEAN'              TO CAHREFNO
 23341        WHEN PB-AH-REFUND-TYPE =  '9'
 23342           MOVE 'SUM '              TO CAHREFNO
 23343        WHEN PB-AH-REFUND-TYPE =  'B'
 23344           MOVE 'BALN'              TO CAHREFNO
 23345     END-EVALUATE.
 23346
 23347     MOVE PB-REIN-CD                 TO CREINCDO.
 23348
 23349     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 23350        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 23351        MOVE SPACE                   TO DC-OPTION-CODE
 23352        PERFORM 9700-DATE-LINK
 23353        IF NO-CONVERSION-ERROR
 23354           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 23355
 23356     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 23357        MOVE 999999                  TO WS-EXP-DT-EDIT
 23358        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 23359        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 23360     ELSE
 23361        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 23362           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 23363           MOVE SPACE                   TO DC-OPTION-CODE
 23364           PERFORM 9700-DATE-LINK
 23365           IF NO-CONVERSION-ERROR
 23366              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 23367
 23368     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 23369        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 23370           MOVE AL-SANOF                TO CORIGHDA
 23371           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 23372           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 23373
 23374     MOVE PB-CSR-ID              TO CCSRO.
 23375
 23376     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 23377     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 23378     MOVE 'N'                    TO ACTSPCO
 23379     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 23380     MOVE '2'                    TO ERACNT-REC-TYPE
 23381     MOVE +3                     TO ERACNT-SEQ-NO
 23382
 23383
 23384* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 429
* EL6311.cbl
 23385*         DATASET   ('ERACNT')
 23386*         INTO      (NOTE-FILE)
 23387*         RIDFLD    (ERACNT-KEY)
 23388*         RESP      (WS-RESPONSE)
 23389*    END-EXEC
 23390     MOVE LENGTH OF
 23391      NOTE-FILE
 23392       TO DFHEIV11
 23393     MOVE 'ERACNT' TO DFHEIV1
 23394*    MOVE '&"IL       E          (  N#00019542' TO DFHEIV0
 23395     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23397     MOVE X'204E233030303139353432' TO DFHEIV0(25:11)
 23398     CALL 'kxdfhei1' USING DFHEIV0,
 23399           DFHEIV1,
 23400           NOTE-FILE,
 23401           DFHEIV11,
 23402           ERACNT-KEY,
 23403           DFHEIV99,
 23404           DFHEIV99,
 23405           DFHEIV99
 23406     MOVE EIBRESP  TO WS-RESPONSE
 23407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23408
 23409     IF RESP-NORMAL
 23410        IF NT-account-special = 'Y'
 23411           MOVE 'Y'              TO actspcO
 23412           MOVE ER-1762          TO EMI-ERROR
 23413           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23414        END-IF
 23415     END-IF
 23416     MOVE 'C'                    TO CMAINTI.
 23417     MOVE AL-UANON               TO CMAINTA.
 23418
 23419     IF PI-6316-FINALIZED = 'Y'  AND
 23420        PB-UNFORCED-ERRORS
 23421          MOVE -1                TO CFORCEL
 23422          MOVE  1                TO SET-CURSOR-SW
 23423     END-IF
 23424
 23425     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23426        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23427
 23428     IF NO-CURSOR-SET
 23429        MOVE -1                  TO CMAINTL.
 23430
 23431     GO TO 8100-SEND-INITIAL-MAP.
 23432
 23433
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 430
* EL6311.cbl
 23435***************************************************************
 23436*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23437*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23438***************************************************************
 23439
 23440 7200-DISPLAY-BATCHES.
 23441     MOVE EL631D                 TO PI-MAP-NAME.
 23442     MOVE LOW-VALUES             TO EL631DI.
 23443
 23444     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23445
 23446
 23447* EXEC CICS HANDLE CONDITION
 23448*         NOTFND   (3690-NOT-FOUND)
 23449*    END-EXEC.
 23450*    MOVE '"$I                   ! Y #00019586' TO DFHEIV0
 23451     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23453     MOVE X'5920233030303139353836' TO DFHEIV0(25:11)
 23454     CALL 'kxdfhei1' USING DFHEIV0
 23455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23456
 23457
 23458     IF PI-DISPLAY-SCREEN
 23459        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23460     ELSE
 23461        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23462
 23463     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23464     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23465
 23466
 23467* EXEC CICS READ
 23468*         DATASET   (FILE-ID-ERPNDB)
 23469*         RIDFLD    (ERPNDB-KEY)
 23470*         SET       (ADDRESS OF PENDING-BUSINESS)
 23471*    END-EXEC.
 23472*    MOVE '&"S        E          (   #00019598' TO DFHEIV0
 23473     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23474     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23475     MOVE X'2020233030303139353938' TO DFHEIV0(25:11)
 23476     CALL 'kxdfhei1' USING DFHEIV0,
 23477           FILE-ID-ERPNDB,
 23478           DFHEIV20,
 23479           DFHEIV99,
 23480           ERPNDB-KEY,
 23481           DFHEIV99,
 23482           DFHEIV99,
 23483           DFHEIV99
 23484     SET ADDRESS OF PENDING-BUSINESS TO
 23485         DFHEIV20
 23486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23487
 23488
 23489     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23490     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23491     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23492     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 431
* EL6311.cbl
 23493     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23494
 23495     MOVE EL631D                 TO PI-MAP-NAME.
 23496     MOVE LOW-VALUES             TO EL631DI.
 23497     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23498
 23499*    IF PI-AR-PROCESSING
 23500*       MOVE PB-REFERENCE        TO DREFO.
 23501
 23502     MOVE PB-CSR-ID              TO DCSRO.
 23503
 23504     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23505        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23506        MOVE SPACE               TO DC-OPTION-CODE
 23507        PERFORM 9700-DATE-LINK
 23508        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23509        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23510        MOVE 'INACTIVE'          TO DLDATEO
 23511     ELSE
 23512        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23513        MOVE SPACE               TO DC-OPTION-CODE
 23514        PERFORM 9700-DATE-LINK
 23515        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23516
 23517     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23518     MOVE SPACE                  TO DC-OPTION-CODE.
 23519     PERFORM 9700-DATE-LINK.
 23520     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23521
 23522     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23523        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23524     ELSE
 23525        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23526        MOVE SPACE               TO DC-OPTION-CODE
 23527        PERFORM 9700-DATE-LINK
 23528        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23529
 23530     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23531     MOVE SPACE                  TO DC-OPTION-CODE.
 23532     PERFORM 9700-DATE-LINK.
 23533     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23534
 23535     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23536     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23537
 23538     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23539        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23540                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23541
 23542     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23543     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23544     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23545
 23546     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23547        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23548                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23549
 23550     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 432
* EL6311.cbl
 23551     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23552     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23553
 23554     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23555        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23556                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23557
 23558     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23559     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23560
 23561     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23562        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23563                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23564
 23565     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23566     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23567     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23568
 23569     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23570        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23571                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23572
 23573     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23574     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23575     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23576
 23577     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23578        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23579                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23580
 23581     MOVE -1                     TO DPFENTRL.
 23582     GO TO 8100-SEND-INITIAL-MAP.
 23583
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 433
* EL6311.cbl
 23585
 23586***************************************************************
 23587*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23588*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23589*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23590*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23591*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23592*     ARE THEN SET ACCORDINGLY.                               *
 23593*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23594*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23595*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23596***************************************************************
 23597
 23598******************************************************************
 23599*                                                                *
 23600*            E R R O R   A N A L Y S I S                         *
 23601*                                                                *
 23602******************************************************************
 23603
 23604******************************************************************
 23605*                                                                *
 23606*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23607*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23608*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23609*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23610*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23611*                                                                *
 23612*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23613*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23614*                                                                *
 23615******************************************************************
 23616
 23617 7300-FORMAT-ERRORS.
 23618     MOVE ' '                    TO PI-ERRORS-SW
 23619     IF PB-COMMON-ERRORS = LOW-VALUES
 23620        IF PB-FATAL-ERRORS
 23621           MOVE ER-2695          TO EMI-ERROR
 23622           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23623           GO TO 7399-EXIT.
 23624
 23625     MOVE +0                     TO WS-SUB4
 23626     move +0                     to pi-6311-fatal-ctr
 23627     .
 23628 7310-ERROR-LOOP.
 23629
 23630     ADD +1                      TO WS-SUB4.
 23631
 23632     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23633        GO TO 7350-SET-ERROR-FLAGS.
 23634
 23635     IF PI-COMPANY-ID = 'UCL'
 23636         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23637             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23638             MOVE ' '                   TO DC-OPTION-CODE
 23639             PERFORM 9700-DATE-LINK
 23640             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23641
 23642     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 434
* EL6311.cbl
 23643     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23644     if (emi-fatal)
 23645        and (emi-error not = 1753 and 1754 and 1757 and
 23646                             1758 and 1759 and 1760)
 23647        add +1                   to pi-6311-fatal-ctr
 23648     end-if
 23649     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23650
 23651     GO TO 7310-ERROR-LOOP.
 23652
 23653
 23654 7350-SET-ERROR-FLAGS.
 23655
 23656     IF EMI-FATAL-CTR NOT = ZEROS
 23657        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23658        MOVE 'X'                 TO PB-FATAL-FLAG
 23659                                    PI-ERRORS-SW
 23660        GO TO 7355-SET-ERROR-FLAGS.
 23661
 23662     move ' ' to pi-unforced-sw
 23663     IF EMI-FORCABLE-CTR NOT = ZEROS
 23664        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23665        IF PB-ISSUE
 23666           IF PB-ISSUE-FORCE
 23667              MOVE 'F'           TO PB-FORCE-ER-CD
 23668              MOVE ER-2600       TO EMI-ERROR
 23669              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23670             ELSE
 23671              MOVE 'X'           TO PB-FORCE-ER-CD
 23672*                                   PI-ERRORS-SW
 23673          ELSE
 23674           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23675              MOVE 'F'           TO PB-FORCE-ER-CD
 23676                                    pi-unforced-sw
 23677              MOVE ER-2600       TO EMI-ERROR
 23678              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23679             ELSE
 23680              MOVE 'X'           TO PB-FORCE-ER-CD
 23681                                    pi-unforced-sw.
 23682*                                   PI-ERRORS-SW.
 23683
 23684     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23685     IF PB-ISSUE
 23686         MOVE 'I'                TO ENDT-RECORD-TYPE
 23687     ELSE
 23688         MOVE 'C'                TO ENDT-RECORD-TYPE
 23689     END-IF
 23690     MOVE +0                     TO ENDT-SEQ-NO
 23691
 23692
 23693* EXEC CICS READ
 23694*        DATASET   (FILE-ID-ERENDT)
 23695*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23696*        RIDFLD    (ERENDT-KEY)
 23697*        RESP      (WS-RESPONSE)
 23698*        GTEQ
 23699*    END-EXEC
 23700*    MOVE '&"S        G          (  N#00019807' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 435
* EL6311.cbl
 23701     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23703     MOVE X'204E233030303139383037' TO DFHEIV0(25:11)
 23704     CALL 'kxdfhei1' USING DFHEIV0,
 23705           FILE-ID-ERENDT,
 23706           DFHEIV20,
 23707           DFHEIV99,
 23708           ERENDT-KEY,
 23709           DFHEIV99,
 23710           DFHEIV99,
 23711           DFHEIV99
 23712     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23713         DFHEIV20
 23714     MOVE EIBRESP  TO WS-RESPONSE
 23715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23716
 23717     IF RESP-NORMAL
 23718        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23719        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23720            MOVE ER-0280          TO EMI-ERROR
 23721            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23722            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23723            IF CALLED-FROM-6315
 23724               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23725            END-IF
 23726            EVALUATE TRUE
 23727              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23728                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23729              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23730                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23731              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23732                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23733            END-EVALUATE
 23734        END-IF
 23735     END-IF
 23736
 23737
 23738
 23739     IF FIRST-ENTRY OR
 23740        EIBAID = DFHPF1 OR DFHPF2
 23741        MOVE '0'                TO PI-EDIT-SW
 23742        GO TO 7399-EXIT.
 23743
 23744 7355-SET-ERROR-FLAGS.
 23745
 23746     IF EMI-WARNING-CTR NOT = ZEROS
 23747        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23748        MOVE 'W'                 TO PB-WARN-ER-CD.
 23749
 23750     IF PB-UNFORCED-ERRORS OR
 23751        PB-FATAL-ERRORS    OR
 23752        PB-RECORD-ON-HOLD  OR
 23753        PB-RECORD-RETURNED OR
 23754        PB-CANCELLATION
 23755          NEXT SENTENCE
 23756        ELSE
 23757          GO TO 7399-EXIT.
 23758
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 436
* EL6311.cbl
 23759
 23760* EXEC CICS  HANDLE CONDITION
 23761*           NOTFND   (7399-EXIT)
 23762*    END-EXEC.
 23763*    MOVE '"$I                   ! Z #00019857' TO DFHEIV0
 23764     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23766     MOVE X'5A20233030303139383537' TO DFHEIV0(25:11)
 23767     CALL 'kxdfhei1' USING DFHEIV0
 23768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23769
 23770
 23771     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23772     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23773     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23774     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23775
 23776
 23777* EXEC CICS READ
 23778*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23779*        DATASET (FILE-ID-ELCERT)
 23780*        RIDFLD  (ELCERT-KEY)
 23781*        UPDATE
 23782*    END-EXEC.
 23783*    MOVE '&"S        EU         (   #00019866' TO DFHEIV0
 23784     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23785     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23786     MOVE X'2020233030303139383636' TO DFHEIV0(25:11)
 23787     CALL 'kxdfhei1' USING DFHEIV0,
 23788           FILE-ID-ELCERT,
 23789           DFHEIV20,
 23790           DFHEIV99,
 23791           ELCERT-KEY,
 23792           DFHEIV99,
 23793           DFHEIV99,
 23794           DFHEIV99
 23795     SET ADDRESS OF CERTIFICATE-MASTER TO
 23796         DFHEIV20
 23797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23798
 23799
 23800
 23801     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23802     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23803
 23804     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23805        GO TO 7360-REWRITE-CERT-MASTER.
 23806
 23807     IF PB-ISSUE
 23808        IF PB-RECORD-RETURNED
 23809            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23810            GO TO 7360-REWRITE-CERT-MASTER
 23811        ELSE
 23812            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23813            GO TO 7360-REWRITE-CERT-MASTER.
 23814
 23815     IF PB-RECORD-RETURNED
 23816         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 437
* EL6311.cbl
 23817         GO TO 7360-REWRITE-CERT-MASTER.
 23818
 23819     IF (PB-C-LF-CANCEL-VOIDED)
 23820        or (pb-c-ah-cancel-voided)
 23821        IF (PB-UNFORCED-ERRORS OR
 23822            PB-FATAL-ERRORS    OR
 23823            PB-RECORD-ON-HOLD)
 23824            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23825            GO TO 7360-REWRITE-CERT-MASTER
 23826        ELSE
 23827            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23828            GO TO 7360-REWRITE-CERT-MASTER.
 23829
 23830     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23831                            OR PB-RECORD-ON-HOLD)
 23832        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23833     ELSE
 23834        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23835
 23836 7360-REWRITE-CERT-MASTER.
 23837
 23838     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23839        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23840
 23841* EXEC CICS UNLOCK
 23842*            DATASET    (FILE-ID-ELCERT)
 23843*       END-EXEC
 23844*    MOVE '&*                    #   #00019913' TO DFHEIV0
 23845     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23846     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23847     MOVE X'2020233030303139393133' TO DFHEIV0(25:11)
 23848     CALL 'kxdfhei1' USING DFHEIV0,
 23849           FILE-ID-ELCERT,
 23850           DFHEIV99
 23851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23852        GO TO 7399-EXIT.
 23853
 23854
 23855* EXEC CICS REWRITE
 23856*         DATASET    (FILE-ID-ELCERT)
 23857*         FROM       (CERTIFICATE-MASTER)
 23858*    END-EXEC.
 23859     MOVE LENGTH OF
 23860      CERTIFICATE-MASTER
 23861       TO DFHEIV11
 23862*    MOVE '&& L                  %   #00019918' TO DFHEIV0
 23863     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23864     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23865     MOVE X'2020233030303139393138' TO DFHEIV0(25:11)
 23866     CALL 'kxdfhei1' USING DFHEIV0,
 23867           FILE-ID-ELCERT,
 23868           CERTIFICATE-MASTER,
 23869           DFHEIV11,
 23870           DFHEIV99
 23871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23872
 23873
 23874 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 438
* EL6311.cbl
 23875      EXIT.
 23876
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 439
* EL6311.cbl
 23878
 23879*************************************************************
 23880*                                                           *
 23881*              S E T   A T T R I B U T E S                  *
 23882*                                                           *
 23883*************************************************************
 23884
 23885 7400-SET-ATTRIBUTES.
 23886
 23887     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23888        GO TO 7499-EXIT.
 23889
 23890**2601**
 23891
 23892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23893        IF PB-ISSUE
 23894           MOVE AL-UABON         TO BEFFDTA
 23895           GO TO 7499-EXIT
 23896         ELSE
 23897           MOVE AL-UABON         TO CEFFDTA
 23898           GO TO 7499-EXIT.
 23899
 23900**2604**
 23901
 23902     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23903        IF PB-ISSUE
 23904           MOVE AL-UABON         TO BTYPE1A
 23905           MOVE -1               TO BTYPE1L
 23906           MOVE  1               TO SET-CURSOR-SW
 23907           GO TO 7499-EXIT.
 23908
 23909**2605**
 23910
 23911     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23912        IF PB-ISSUE
 23913           MOVE AL-UABON         TO BTYPE2A
 23914           MOVE -1               TO BTYPE2L
 23915           MOVE  1               TO SET-CURSOR-SW
 23916           GO TO 7499-EXIT.
 23917
 23918**2606**
 23919
 23920     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23921        IF PB-ISSUE
 23922           MOVE AL-UABON         TO BSIGA
 23923           MOVE -1               TO BSIGL
 23924           MOVE  1               TO SET-CURSOR-SW
 23925           GO TO 7499-EXIT.
 23926
 23927**2607**
 23928
 23929     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23930        IF PB-ISSUE
 23931           MOVE AL-UABON         TO BSIGA
 23932           MOVE -1               TO BSIGL
 23933           MOVE  1               TO SET-CURSOR-SW
 23934           GO TO 7499-EXIT.
 23935
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 440
* EL6311.cbl
 23936**2615**
 23937
 23938     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23939        IF PB-ISSUE
 23940           MOVE AL-UABOF         TO BREINA
 23941           MOVE -1               TO BREINL
 23942           GO TO 7499-EXIT.
 23943
 23944**2622**
 23945
 23946     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23947        IF PB-ISSUE
 23948           MOVE AL-UABON         TO BEFFDTA
 23949           GO TO 7499-EXIT
 23950        ELSE
 23951           MOVE AL-UABON         TO CEFFDTA
 23952           GO TO 7499-EXIT.
 23953
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 441
* EL6311.cbl
 23955
 23956*************************************************************
 23957*                                                           *
 23958*              I S S U E   E R R O R S                      *
 23959*                                                           *
 23960*************************************************************
 23961
 23962 7420-ISSUE-ERRORS.
 23963
 23964     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23965        MOVE -1                  TO LETRREQL
 23966        MOVE AL-UABOF            TO LETRREQA
 23967        MOVE  1                  TO SET-CURSOR-SW
 23968        GO TO 7499-EXIT.
 23969
 23970     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23971        MOVE AL-UABOF            TO LETRREQA
 23972        GO TO 7499-EXIT.
 23973
 23974**2626**
 23975
 23976     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23977        MOVE AL-UABON            TO BCERTNOA
 23978        GO TO 7499-EXIT.
 23979
 23980**2627**
 23981
 23982     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23983        MOVE AL-UNBON            TO BAGEA
 23984        MOVE -1                  TO BAGEL
 23985        MOVE  1                  TO SET-CURSOR-SW
 23986        GO TO 7499-EXIT.
 23987
 23988**2628**
 23989
 23990     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23991        MOVE AL-UNBON            TO BAGEA
 23992        MOVE -1                  TO BAGEL
 23993        MOVE  1                  TO SET-CURSOR-SW
 23994        GO TO 7499-EXIT.
 23995
 23996**2629**
 23997
 23998     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23999        MOVE AL-UABON            TO BSEXA
 24000        MOVE -1                  TO BSEXL
 24001        MOVE  1                  TO SET-CURSOR-SW
 24002        GO TO 7499-EXIT.
 24003
 24004**2630**
 24005
 24006     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 24007        MOVE -1                  TO BTYPE1L
 24008        MOVE  1                  TO SET-CURSOR-SW
 24009        GO TO 7499-EXIT.
 24010
 24011**2631**
 24012
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 442
* EL6311.cbl
 24013     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 24014        MOVE -1                  TO BTYPE1L
 24015        MOVE  1                  TO SET-CURSOR-SW
 24016        GO TO 7499-EXIT.
 24017
 24018**2632**
 24019
 24020     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 24021        MOVE AL-UNBON            TO BBEN1A
 24022        MOVE -1                  TO BBEN1L
 24023        MOVE  1                  TO SET-CURSOR-SW
 24024        GO TO 7499-EXIT.
 24025
 24026**2633**
 24027
 24028     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 24029        MOVE AL-UNBON            TO BPREM1A
 24030        MOVE -1                  TO BPREM1L
 24031        MOVE  1                  TO SET-CURSOR-SW
 24032        GO TO 7499-EXIT.
 24033
 24034**2634**
 24035
 24036     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 24037        MOVE -1                  TO BTYPE2L
 24038        MOVE  1                  TO SET-CURSOR-SW
 24039        GO TO 7499-EXIT.
 24040
 24041**2635**
 24042
 24043     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 24044        MOVE AL-UNBON            TO BBEN2A
 24045        MOVE -1                  TO BBEN2L
 24046        MOVE  1                  TO SET-CURSOR-SW
 24047        GO TO 7499-EXIT.
 24048
 24049**2636**
 24050
 24051     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 24052        MOVE AL-UNBON            TO BPREM2A
 24053        MOVE -1                  TO BPREM2L
 24054        MOVE  1                  TO SET-CURSOR-SW
 24055        GO TO 7499-EXIT.
 24056
 24057**2639**
 24058
 24059     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 24060        MOVE AL-UNBON            TO BBEN1A
 24061        MOVE -1                  TO BBEN1L
 24062        MOVE  1                  TO SET-CURSOR-SW
 24063        GO TO 7499-EXIT.
 24064
 24065**2640**
 24066
 24067     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 24068        MOVE AL-UNBON            TO BBEN2A
 24069        MOVE -1                  TO BBEN2L
 24070        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 443
* EL6311.cbl
 24071        GO TO 7499-EXIT.
 24072
 24073**2647**
 24074
 24075     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 24076        MOVE AL-UNBON            TO BTERM1A
 24077        MOVE -1                  TO BTERM1L
 24078        MOVE  1                  TO SET-CURSOR-SW
 24079        GO TO 7499-EXIT.
 24080
 24081**2648**
 24082
 24083     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 24084              or er-3070
 24085        MOVE AL-UNBON            TO BLNTRMA
 24086        MOVE -1                  TO BLNTRML
 24087        MOVE  1                  TO SET-CURSOR-SW
 24088        GO TO 7499-EXIT.
 24089
 24090**2649**
 24091
 24092     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24093        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24094            MOVE AL-UNBON            TO BPREM1A
 24095            MOVE -1                  TO BPREM1L
 24096            MOVE  1                  TO SET-CURSOR-SW
 24097            GO TO 7499-EXIT
 24098     ELSE
 24099        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24100           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24101            MOVE AL-UNBON            TO BPREM2A
 24102            MOVE -1                  TO BPREM2L
 24103            MOVE  1                  TO SET-CURSOR-SW
 24104            GO TO 7499-EXIT.
 24105
 24106**2650**
 24107
 24108     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 24109        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24110            MOVE AL-UNBON        TO BPREM1A
 24111            MOVE -1              TO BPREM1L
 24112            MOVE  1              TO SET-CURSOR-SW
 24113            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24114                MOVE AL-UNBON        TO BPREM2A
 24115                MOVE -1              TO BPREM2L
 24116                MOVE  1              TO SET-CURSOR-SW
 24117                GO TO 7499-EXIT
 24118            ELSE
 24119                GO TO 7499-EXIT
 24120        ELSE
 24121            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24122                MOVE AL-UNBON        TO BPREM2A
 24123                MOVE -1              TO BPREM2L
 24124                MOVE  1              TO SET-CURSOR-SW
 24125                GO TO 7499-EXIT
 24126            ELSE
 24127                GO TO 7499-EXIT.
 24128
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 444
* EL6311.cbl
 24129**2651**
 24130
 24131     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 24132        MOVE AL-UABON            TO BSIGA
 24133        MOVE -1                  TO BSIGL
 24134        MOVE  1                  TO SET-CURSOR-SW
 24135        GO TO 7499-EXIT.
 24136
 24137**2653**
 24138
 24139     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 24140        MOVE AL-UABON            TO BFREQA
 24141        MOVE -1                  TO BFREQL
 24142        MOVE  1                  TO SET-CURSOR-SW
 24143        GO TO 7499-EXIT.
 24144
 24145**2654**
 24146
 24147     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 24148        MOVE AL-UABON            TO BFREQA
 24149        MOVE -1                  TO BFREQL
 24150        MOVE  1                  TO SET-CURSOR-SW
 24151        GO TO 7499-EXIT.
 24152
 24153**2655**
 24154
 24155     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 24156        MOVE AL-UABON            TO BFREQA
 24157        MOVE -1                  TO BFREQL
 24158        MOVE  1                  TO SET-CURSOR-SW
 24159        GO TO 7499-EXIT.
 24160
 24161**2656**
 24162
 24163     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 24164        MOVE AL-UNBON            TO BAPRA
 24165        MOVE -1                  TO BAPRL
 24166        MOVE  1                  TO SET-CURSOR-SW
 24167        GO TO 7499-EXIT.
 24168
 24169**2657**
 24170
 24171     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24172        MOVE AL-UNBON            TO BAPRA
 24173        MOVE -1                  TO BAPRL
 24174        MOVE  1                  TO SET-CURSOR-SW
 24175        GO TO 7499-EXIT.
 24176
 24177**2658**
 24178
 24179     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24180        MOVE AL-UNBON            TO BTERM2A
 24181        MOVE -1                  TO BTERM2L
 24182        MOVE  1                  TO SET-CURSOR-SW
 24183        GO TO 7499-EXIT.
 24184
 24185**2660**
 24186
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 445
* EL6311.cbl
 24187     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 24188        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 24189        MOVE -1                  TO BLSTNML
 24190        MOVE  1                  TO SET-CURSOR-SW
 24191        GO TO 7499-EXIT.
 24192
 24193
 24194**2662**
 24195
 24196     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 24197        MOVE AL-UNBON            TO BAGEA
 24198        MOVE -1                  TO BAGEL
 24199        MOVE  1                  TO SET-CURSOR-SW
 24200        GO TO 7499-EXIT.
 24201
 24202**2663**
 24203
 24204     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 24205        MOVE AL-UNBON            TO BAGEA
 24206        MOVE -1                  TO BAGEL
 24207        MOVE  1                  TO SET-CURSOR-SW
 24208        GO TO 7499-EXIT.
 24209
 24210**2664**
 24211
 24212     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 24213        MOVE AL-UABON            TO BREINA
 24214        MOVE -1                  TO BREINL
 24215        MOVE  1                  TO SET-CURSOR-SW
 24216        GO TO 7499-EXIT.
 24217
 24218**2667**
 24219
 24220     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 24221        MOVE AL-UNBON            TO BBEN2A
 24222        MOVE -1                  TO BBEN2L
 24223        MOVE  1                  TO SET-CURSOR-SW
 24224        GO TO 7499-EXIT.
 24225
 24226**2668**
 24227
 24228     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 24229        MOVE AL-UABON            TO BEFFDTA
 24230        GO TO 7499-EXIT.
 24231
 24232**2669**
 24233
 24234     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 24235       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 24236       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 24237        MOVE AL-UNBON            TO BAGEA
 24238        MOVE -1                  TO BAGEL
 24239        MOVE  1                  TO SET-CURSOR-SW
 24240        GO TO 7499-EXIT.
 24241
 24242**2670**
 24243
 24244     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 446
* EL6311.cbl
 24245        MOVE AL-UABON            TO BFORCEA
 24246        MOVE -1                  TO BFORCEL
 24247        MOVE  1                  TO SET-CURSOR-SW
 24248        GO TO 7499-EXIT.
 24249
 24250**2671**
 24251
 24252     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 24253        MOVE AL-UABON            TO BEFFDTA
 24254        GO TO 7499-EXIT.
 24255
 24256**2672**
 24257
 24258     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 24259        MOVE AL-UABON            TO BEFFDTA
 24260        GO TO 7499-EXIT.
 24261
 24262**2673**
 24263
 24264     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24265        MOVE AL-UABON            TO BEFFDTA
 24266        GO TO 7499-EXIT.
 24267
 24268**2674**
 24269
 24270     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24271        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 24272        MOVE -1                  TO BTYPE1L
 24273        MOVE  1                  TO SET-CURSOR-SW
 24274        GO TO 7499-EXIT.
 24275
 24276**2677**
 24277
 24278     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 24279        MOVE AL-UNBON            TO BTERM1A
 24280        MOVE -1                  TO BTERM1L
 24281        MOVE  1                  TO SET-CURSOR-SW
 24282        GO TO 7499-EXIT.
 24283
 24284**2678**
 24285
 24286     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 24287        MOVE AL-UNBON            TO BTERM2A
 24288        MOVE -1                  TO BTERM2L
 24289        MOVE  1                  TO SET-CURSOR-SW
 24290        GO TO 7499-EXIT.
 24291
 24292**2679**
 24293
 24294     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 24295        MOVE AL-UABON            TO BTYPE1A
 24296        MOVE -1                  TO BTYPE1L
 24297        MOVE  1                  TO SET-CURSOR-SW
 24298        GO TO 7499-EXIT.
 24299
 24300**2680**
 24301
 24302     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 447
* EL6311.cbl
 24303        MOVE AL-UABOF            TO B1STPMTA
 24304        MOVE -1                  TO B1STPMTL
 24305        MOVE  1                  TO SET-CURSOR-SW
 24306        GO TO 7499-EXIT.
 24307
 24308**2681**
 24309
 24310     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 24311        MOVE AL-UABON            TO BDAYSA
 24312        MOVE -1                  TO BDAYSL
 24313        MOVE  1                  TO SET-CURSOR-SW
 24314        GO TO 7499-EXIT.
 24315
 24316**2682**
 24317
 24318     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 24319        MOVE AL-UABON            TO BTERM1A
 24320        MOVE -1                  TO BTERM1L
 24321        MOVE  1                  TO SET-CURSOR-SW
 24322        GO TO 7499-EXIT.
 24323
 24324**2683**
 24325
 24326     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 24327        MOVE AL-UABON            TO BSKPCDA
 24328        MOVE -1                  TO BSKPCDL
 24329        MOVE  1                  TO SET-CURSOR-SW
 24330        GO TO 7499-EXIT.
 24331
 24332**2684**
 24333
 24334     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 24335        MOVE AL-UABON            TO BTYPE2A
 24336        MOVE -1                  TO BTYPE2L
 24337        MOVE  1                  TO SET-CURSOR-SW
 24338        GO TO 7499-EXIT.
 24339
 24340**2686**
 24341
 24342     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 24343        MOVE AL-UABON            TO BTYPE2A
 24344        MOVE -1                  TO BTYPE2L
 24345        MOVE  1                  TO SET-CURSOR-SW
 24346        GO TO 7499-EXIT.
 24347
 24348**2689**
 24349
 24350     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 24351        MOVE AL-UABON            TO BSIGA
 24352        MOVE -1                  TO BSIGL
 24353        MOVE  1                  TO SET-CURSOR-SW
 24354        GO TO 7499-EXIT.
 24355
 24356**2690**
 24357
 24358     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 24359        MOVE AL-UABOF            TO BLNOFCRA
 24360        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 448
* EL6311.cbl
 24361        MOVE  1                  TO SET-CURSOR-SW
 24362        GO TO 7499-EXIT.
 24363
 24364**2693**
 24365
 24366     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 24367        MOVE AL-UABOF            TO BLNOFCRA
 24368        MOVE AL-UNBON            TO BBEN1A
 24369        MOVE -1                  TO BBEN1L
 24370        MOVE  1                  TO SET-CURSOR-SW
 24371        GO TO 7499-EXIT.
 24372
 24373**2720**
 24374
 24375     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 24376        MOVE AL-UNBON            TO BBEN1A
 24377        MOVE -1                  TO BBEN1L
 24378        MOVE  1                  TO SET-CURSOR-SW
 24379        GO TO 7499-EXIT.
 24380
 24381**2709**
 24382
 24383*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 24384*       MOVE AL-UNBON            TO BBEN1A
 24385*       MOVE -1                  TO BBEN1L
 24386*       MOVE  1                  TO SET-CURSOR-SW
 24387*       GO TO 7499-EXIT.
 24388
 24389*************************************************************
 24390*                                                           *
 24391*            C A N C E L   E R R O R S                      *
 24392*                                                           *
 24393*************************************************************
 24394
 24395**2726**
 24396
 24397     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 24398        MOVE AL-UABON            TO CCERTNOA
 24399        GO TO 7499-EXIT.
 24400
 24401**2728**
 24402
 24403     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 24404        MOVE AL-UABON            TO CCERTNOA
 24405        GO TO 7499-EXIT.
 24406
 24407**2729**
 24408
 24409     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24410        MOVE AL-UABON            TO CCERTNOA
 24411        GO TO 7499-EXIT.
 24412
 24413**2730**
 24414
 24415     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24416        MOVE AL-UABON            TO CCERTNOA
 24417        GO TO 7499-EXIT.
 24418
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 449
* EL6311.cbl
 24419**2731**
 24420
 24421     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24422        MOVE AL-UABON            TO CCANDT1A
 24423        MOVE -1                  TO CCANDT1L
 24424        MOVE  1                  TO SET-CURSOR-SW
 24425        GO TO 7499-EXIT.
 24426
 24427**2732**
 24428
 24429     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24430        MOVE AL-UABON            TO CCANDT1A
 24431        MOVE -1                  TO CCANDT1L
 24432        MOVE  1                  TO SET-CURSOR-SW
 24433        GO TO 7499-EXIT.
 24434
 24435**2733**
 24436
 24437     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24438        MOVE AL-UABON            TO CCANDT1A
 24439        MOVE -1                  TO CCANDT1L
 24440        MOVE  1                  TO SET-CURSOR-SW
 24441        GO TO 7499-EXIT.
 24442
 24443**2734**
 24444
 24445     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24446        MOVE AL-UNBON            TO CREFND1A
 24447        MOVE -1                  TO CREFND1L
 24448        MOVE  1                  TO SET-CURSOR-SW
 24449        GO TO 7499-EXIT.
 24450
 24451**2735**
 24452
 24453     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24454        MOVE AL-UABON            TO CCANDT2A
 24455        MOVE -1                  TO CCANDT2L
 24456        MOVE  1                  TO SET-CURSOR-SW
 24457        GO TO 7499-EXIT.
 24458
 24459**2736**
 24460
 24461     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24462        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24463            MOVE AL-UNBON        TO CREFND1A
 24464            MOVE -1              TO CREFND1L
 24465            MOVE  1              TO SET-CURSOR-SW
 24466            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24467                MOVE AL-UNBON        TO CREFND2A
 24468                MOVE -1              TO CREFND2L
 24469                MOVE  1              TO SET-CURSOR-SW
 24470                GO TO 7499-EXIT
 24471            ELSE
 24472                GO TO 7499-EXIT
 24473        ELSE
 24474            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24475                MOVE AL-UNBON        TO CREFND2A
 24476                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 450
* EL6311.cbl
 24477                MOVE  1              TO SET-CURSOR-SW
 24478                GO TO 7499-EXIT
 24479            ELSE
 24480                GO TO 7499-EXIT.
 24481
 24482**2738**
 24483
 24484     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24485        MOVE -1                  TO CREFND2L
 24486        MOVE  1                  TO SET-CURSOR-SW
 24487        GO TO 7499-EXIT.
 24488
 24489**2739**
 24490
 24491     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24492        MOVE -1                  TO CREFND1L
 24493        MOVE  1                  TO SET-CURSOR-SW
 24494        GO TO 7499-EXIT.
 24495
 24496**2741**
 24497
 24498     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24499        MOVE -1                  TO CREFND1L
 24500        MOVE  1                  TO SET-CURSOR-SW
 24501        GO TO 7499-EXIT.
 24502
 24503**2743**
 24504
 24505     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24506        MOVE AL-UNBON            TO CCANDT1A
 24507        MOVE -1                  TO CCANDT1L
 24508        MOVE  1                  TO SET-CURSOR-SW
 24509        GO TO 7499-EXIT.
 24510
 24511**2744**
 24512
 24513     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24514        MOVE AL-UNBON            TO CCANDT2A
 24515        MOVE -1                  TO CCANDT2L
 24516        MOVE  1                  TO SET-CURSOR-SW
 24517        GO TO 7499-EXIT.
 24518
 24519**2747**
 24520
 24521     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24522        MOVE AL-UABON            TO CLSTNMA
 24523        MOVE -1                  TO CLSTNML
 24524        MOVE  1                  TO SET-CURSOR-SW
 24525        GO TO 7499-EXIT.
 24526
 24527**2749**
 24528
 24529     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24530        MOVE AL-UABON            TO CFORCEA
 24531        MOVE -1                  TO CFORCEL
 24532        MOVE  1                  TO SET-CURSOR-SW
 24533        GO TO 7499-EXIT.
 24534
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 451
* EL6311.cbl
 24535**2753**
 24536
 24537     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24538        MOVE AL-UNBON            TO CCANDT1A
 24539        MOVE -1                  TO CCANDT1L
 24540        MOVE  1                  TO SET-CURSOR-SW
 24541        GO TO 7499-EXIT.
 24542
 24543**2755**
 24544
 24545     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24546        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24547            MOVE AL-UNBON        TO CREFND1A
 24548            MOVE -1              TO CREFND1L
 24549            MOVE  1              TO SET-CURSOR-SW
 24550            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24551                MOVE AL-UNBON        TO CREFND2A
 24552                MOVE -1              TO CREFND2L
 24553                MOVE  1              TO SET-CURSOR-SW
 24554                GO TO 7499-EXIT
 24555            ELSE
 24556                GO TO 7499-EXIT
 24557        ELSE
 24558            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24559                MOVE AL-UNBON        TO CREFND2A
 24560                MOVE -1              TO CREFND2L
 24561                MOVE  1              TO SET-CURSOR-SW
 24562            ELSE
 24563                GO TO 7499-EXIT.
 24564
 24565**2757**
 24566
 24567     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24568        MOVE AL-UNBON            TO CLIVESA
 24569        MOVE -1                  TO CLIVESL
 24570        MOVE  1                  TO SET-CURSOR-SW
 24571        GO TO 7499-EXIT.
 24572
 24573**2771**
 24574
 24575     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24576        MOVE AL-UABON            TO CCANDT2A
 24577        MOVE -1                  TO CCANDT2L
 24578        MOVE  1                  TO SET-CURSOR-SW
 24579        GO TO 7499-EXIT.
 24580
 24581**2774**
 24582
 24583     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24584        MOVE AL-UABON            TO CCANDT1A
 24585        MOVE -1                  TO CCANDT1L
 24586        MOVE  1                  TO SET-CURSOR-SW
 24587        GO TO 7499-EXIT.
 24588
 24589**2775**
 24590
 24591     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24592        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 452
* EL6311.cbl
 24593        MOVE -1                  TO CCANDT2L
 24594        MOVE  1                  TO SET-CURSOR-SW
 24595        GO TO 7499-EXIT.
 24596
 24597**2776**
 24598
 24599     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24600        MOVE AL-UABON            TO CCANDT1A
 24601        MOVE -1                  TO CCANDT1L
 24602        MOVE  1                  TO SET-CURSOR-SW
 24603        GO TO 7499-EXIT.
 24604
 24605
 24606**2777**
 24607
 24608     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24609        MOVE AL-UABON            TO CCANDT2A
 24610        MOVE -1                  TO CCANDT2L
 24611        MOVE  1                  TO SET-CURSOR-SW
 24612        GO TO 7499-EXIT.
 24613
 24614**2794**
 24615
 24616     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24617        MOVE AL-UABON            TO CFORCEA
 24618        MOVE -1                  TO CFORCEL
 24619        MOVE  1                  TO SET-CURSOR-SW
 24620        GO TO 7499-EXIT.
 24621
 24622**2799**
 24623
 24624     IF PI-COMPANY-ID = 'UCL'
 24625         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24626             MOVE AL-UNBON            TO BEFFDTA
 24627             MOVE -1                  TO BEFFDTL
 24628             MOVE  1                  TO SET-CURSOR-SW
 24629             GO TO 7499-EXIT.
 24630
 24631 7499-EXIT.
 24632      EXIT.
 24633
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 453
* EL6311.cbl
 24635
 24636 7500-READ-ERLOFC.
 24637     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24638                                     ERLOFC-KEY.
 24639
 24640     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24641
 24642     IF ST-ACCNT-CNTL
 24643         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24644
 24645     IF CARR-GROUP-ST-ACCNT-CNTL
 24646         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24647         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24648         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24649
 24650     IF CARR-ST-ACCNT-CNTL
 24651         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24652         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24653
 24654     IF CARR-ACCNT-CNTL
 24655         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24656
 24657     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24658
 24659     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24660
 24661
 24662* EXEC CICS HANDLE CONDITION
 24663*        NOTFND   (7550-OFFICER-NOTFND)
 24664*    END-EXEC.
 24665*    MOVE '"$I                   ! [ #00020710' TO DFHEIV0
 24666     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24668     MOVE X'5B20233030303230373130' TO DFHEIV0(25:11)
 24669     CALL 'kxdfhei1' USING DFHEIV0
 24670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24671
 24672
 24673
 24674* EXEC CICS READ
 24675*        DATASET   (FILE-ID-ERLOFC)
 24676*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24677*        RIDFLD    (ERLOFC-KEY)
 24678*        EQUAL
 24679*    END-EXEC.
 24680*    MOVE '&"S        E          (   #00020714' TO DFHEIV0
 24681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24683     MOVE X'2020233030303230373134' TO DFHEIV0(25:11)
 24684     CALL 'kxdfhei1' USING DFHEIV0,
 24685           FILE-ID-ERLOFC,
 24686           DFHEIV20,
 24687           DFHEIV99,
 24688           ERLOFC-KEY,
 24689           DFHEIV99,
 24690           DFHEIV99,
 24691           DFHEIV99
 24692     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 454
* EL6311.cbl
 24693         DFHEIV20
 24694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24695
 24696
 24697     GO TO 7599-EXIT.
 24698
 24699 7550-OFFICER-NOTFND.
 24700     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24701
 24702 7599-EXIT.
 24703      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 455
* EL6311.cbl
 24705******************************************************************
 24706*                                                                *
 24707*            S  E N D    I N I T I A L   M A P                   *
 24708*                                                                *
 24709******************************************************************
 24710
 24711 8100-SEND-INITIAL-MAP.
 24712     MOVE EIBTIME                TO TIME-IN.
 24713
 24714     IF EIBAID = DFHPF11
 24715        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24716        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24717
 24718
 24719     IF PI-COMPANY-ID = CLIENT-GIC
 24720        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24721                                       BCPREM-ATTRB (2).
 24722
 24723     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24724                         CLIENT-PEM OR
 24725                         CLIENT-CSO)
 24726        AND PI-DISPLAY-ORIGINAL-BATCH
 24727          IF PI-MAP-NAME = EL631B
 24728             MOVE AL-SADOF               TO BPF5HDRA
 24729                                            BPF4HDRA
 24730          ELSE
 24731             IF PI-MAP-NAME = EL631C
 24732                MOVE AL-SADOF            TO CPF5HDRA
 24733                                            CPF4HDRA.
 24734
 24735     IF PI-MAP-NAME = EL631B
 24736        MOVE AL-SADOF               TO BPF5HDRA
 24737     ELSE
 24738        MOVE AL-SADOF               TO CPF5HDRA
 24739     END-IF
 24740
 24741*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24742     IF PI-MAP-NAME = EL631B
 24743          IF PI-COMPANY-ID NOT = 'DMD'
 24744             MOVE AL-SANOF            TO BBILLEDA
 24745             MOVE AL-SADOF            TO DMDBILA.
 24746*DMD CUSTOM CODING*************END
 24747
 24748     IF PI-PROCESSOR-ID = 'LGXX'
 24749        IF PI-MAP-NAME = EL631B
 24750           MOVE AL-SABOF                    TO BREFHDGA
 24751           MOVE AL-SANOF                    TO BREFA
 24752        ELSE
 24753           IF PI-MAP-NAME = EL631C
 24754              MOVE AL-SABOF                 TO CREFHDGA
 24755              MOVE AL-SANOF                 TO CREFA.
 24756
 24757     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24758        continue
 24759     ELSE
 24760        IF PI-MAP-NAME = EL631C
 24761           MOVE AL-SADOF         TO CCANTXTA
 24762                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 456
* EL6311.cbl
 24763        end-if
 24764     end-if
 24765     IF PI-MAP-NAME = EL631D
 24766        IF PI-AR-PROCESSING
 24767           MOVE AL-SANOF            TO DREFHDGA
 24768        ELSE
 24769           MOVE AL-SADOF            TO DREFHDGA.
 24770
 24771     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24772        AND (PI-MAP-NAME = EL631B)
 24773        MOVE AL-SADOF            TO BVINHA
 24774                                    BVINA
 24775     END-IF
 24776     IF PI-MAP-NAME = EL631B
 24777        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24778        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24779                                 TO BREGIONO
 24780        MOVE PI-PROCESSOR-ID     TO BUSERO
 24781        IF CSR-EDIT-SESSION
 24782           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24783                                 TO BHEADO
 24784           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24785        ELSE
 24786           MOVE AL-SADOF         TO BF15HDRA
 24787           MOVE '4=B-HDR      '  TO BPF4HDRO
 24788        END-IF
 24789        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24790        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24791        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24792        MOVE WS-CURRENT-DT          TO BDATEO
 24793        MOVE TIME-OUT               TO BTIMEO
 24794        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24795        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24796        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24797        IF   WS-DISPLAY-SCREEN
 24798             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24799             MOVE PB-SV-CARRIER     TO BCARRO
 24800             MOVE PB-SV-GROUPING    TO BGROUPO
 24801             MOVE PB-SV-STATE       TO BSTATEO
 24802             MOVE PB-ACCOUNT        TO BACCTO
 24803        ELSE
 24804             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24805     ELSE
 24806        IF PI-MAP-NAME = EL631C
 24807           MOVE '4=B-HDR      '     TO CPF4HDRO
 24808           IF CSR-EDIT-SESSION
 24809              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24810                                 TO CHEADO
 24811           ELSE
 24812              MOVE AL-SADOF      TO CF15HDRA
 24813           END-IF
 24814           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24815           MOVE WS-CURRENT-DT          TO CDATEO
 24816           MOVE TIME-OUT               TO CTIMEO
 24817           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24818           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24819           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24820           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 457
* EL6311.cbl
 24821           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24822           MOVE WS-C-HDG               TO CAHHDGO
 24823           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24824           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24825           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24826           IF   WS-DISPLAY-SCREEN
 24827                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24828                MOVE PB-SV-CARRIER     TO CCARRO
 24829                MOVE PB-SV-GROUPING    TO CGROUPO
 24830                MOVE PB-SV-STATE       TO CSTATEO
 24831                MOVE PB-ACCOUNT        TO CACCTO
 24832           ELSE
 24833                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24834        ELSE
 24835           MOVE WS-CURRENT-DT          TO DDATEO
 24836           MOVE TIME-OUT               TO DTIMEO
 24837           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24838                                          WS-REFUND-HDG-OVERRIDE
 24839           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24840           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24841           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24842                                          WS-REFUND-HDG-OVERRIDE
 24843           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24844           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24845           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24846           IF CSR-EDIT-SESSION
 24847              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24848                                 TO DHEADO
 24849           END-IF
 24850           IF  WS-DISPLAY-SCREEN
 24851               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24852               MOVE PB-CARRIER         TO DCARRO
 24853               MOVE PB-GROUPING        TO DGROUPO
 24854               MOVE PB-STATE           TO DSTATEO
 24855               MOVE PB-ACCOUNT         TO DACCTO
 24856               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24857           ELSE
 24858               MOVE EL631D             TO PI-MAP-NAME
 24859               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24860               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24861
 24862     MOVE SPACE                        TO WS-DISPLAY-SW.
 24863
 24864
 24865* EXEC CICS SEND
 24866*        MAP      (PI-MAP-NAME)
 24867*        MAPSET   (MAPSET-EL6311S)
 24868*        FROM     (EL631BI)
 24869*        ERASE
 24870*        CURSOR
 24871*    END-EXEC.
 24872     MOVE LENGTH OF
 24873      EL631BI
 24874       TO DFHEIV12
 24875     MOVE -1
 24876       TO DFHEIV11
 24877*    MOVE '8$     CT  E    H L F ,   #00020888' TO DFHEIV0
 24878     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 458
* EL6311.cbl
 24879     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24880     MOVE X'2020233030303230383838' TO DFHEIV0(25:11)
 24881     CALL 'kxdfhei1' USING DFHEIV0,
 24882           PI-MAP-NAME,
 24883           EL631BI,
 24884           DFHEIV12,
 24885           MAPSET-EL6311S,
 24886           DFHEIV99,
 24887           DFHEIV99,
 24888           DFHEIV99,
 24889           DFHEIV11,
 24890           DFHEIV99,
 24891           DFHEIV99,
 24892           DFHEIV99
 24893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24894
 24895
 24896     GO TO 9100-RETURN-TRAN.
 24897
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 459
* EL6311.cbl
 24899
 24900******************************************************************
 24901*                                                                *
 24902*              S E N D    D A T A O N L Y                        *
 24903*                                                                *
 24904******************************************************************
 24905
 24906 8200-SEND-DATAONLY.
 24907     MOVE EIBTIME                TO TIME-IN.
 24908
 24909     IF PI-COMPANY-ID = CLIENT-GIC
 24910        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24911                                       BCPREM-ATTRB (2).
 24912
 24913     IF PI-MAP-NAME = EL631B
 24914        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24915        MOVE WS-CURRENT-DT          TO BDATEO
 24916        MOVE TIME-OUT               TO BTIMEO
 24917        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24918        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24919        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24920        MOVE SPACES                 TO BPFENTRO
 24921        MOVE AL-UANOF               TO BPFENTRA
 24922
 24923*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24924        IF PI-COMPANY-ID NOT = 'DMD'
 24925             MOVE AL-SANOF            TO BBILLEDA
 24926             MOVE AL-SADOF            TO DMDBILA
 24927         ELSE
 24928            NEXT SENTENCE
 24929*DMD CUSTOM CODING*************END
 24930     ELSE
 24931        IF PI-MAP-NAME = EL631C
 24932           MOVE WS-CURRENT-DT          TO CDATEO
 24933           MOVE TIME-OUT               TO CTIMEO
 24934           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24935           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24936           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24937           MOVE SPACES                 TO CPFENTRO
 24938           MOVE AL-UANOF               TO CPFENTRA
 24939        ELSE
 24940           MOVE WS-CURRENT-DT          TO DDATEO
 24941           MOVE TIME-OUT               TO DTIMEO
 24942           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24943
 24944
 24945* EXEC CICS SEND
 24946*        MAP      (PI-MAP-NAME)
 24947*        MAPSET   (MAPSET-EL6311S)
 24948*        FROM     (EL631BI)
 24949*        DATAONLY
 24950*        CURSOR
 24951*    END-EXEC.
 24952     MOVE LENGTH OF
 24953      EL631BI
 24954       TO DFHEIV12
 24955     MOVE -1
 24956       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 460
* EL6311.cbl
 24957*    MOVE '8$D    CT       H L F ,   #00020944' TO DFHEIV0
 24958     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24959     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24960     MOVE X'2020233030303230393434' TO DFHEIV0(25:11)
 24961     CALL 'kxdfhei1' USING DFHEIV0,
 24962           PI-MAP-NAME,
 24963           EL631BI,
 24964           DFHEIV12,
 24965           MAPSET-EL6311S,
 24966           DFHEIV99,
 24967           DFHEIV99,
 24968           DFHEIV99,
 24969           DFHEIV11,
 24970           DFHEIV99,
 24971           DFHEIV99,
 24972           DFHEIV99
 24973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24974
 24975
 24976     GO TO 9100-RETURN-TRAN.
 24977
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 461
* EL6311.cbl
 24979
 24980******************************************************************
 24981*                                                                *
 24982*           U T I L I T Y   R O U T I N E S                      *
 24983*                                                                *
 24984******************************************************************
 24985
 24986 8300-SEND-TEXT.
 24987
 24988* EXEC CICS SEND TEXT
 24989*        FROM     (LOGOFF-TEXT)
 24990*        LENGTH   (LOGOFF-LENGTH)
 24991*        ERASE
 24992*        FREEKB
 24993*    END-EXEC.
 24994*    MOVE '8&      T  E F  H   F -   #00020963' TO DFHEIV0
 24995     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24996     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24997     MOVE X'2020233030303230393633' TO DFHEIV0(25:11)
 24998     CALL 'kxdfhei1' USING DFHEIV0,
 24999           LOGOFF-TEXT,
 25000           LOGOFF-LENGTH,
 25001           DFHEIV99,
 25002           DFHEIV99,
 25003           DFHEIV99,
 25004           DFHEIV99,
 25005           DFHEIV99,
 25006           DFHEIV99,
 25007           DFHEIV99,
 25008           DFHEIV99,
 25009           DFHEIV99,
 25010           DFHEIV99
 25011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25012
 25013
 25014
 25015* EXEC CICS RETURN
 25016*    END-EXEC.
 25017*    MOVE '.(                    ''   #00020970' TO DFHEIV0
 25018     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 25019     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25020     MOVE X'2020233030303230393730' TO DFHEIV0(25:11)
 25021     CALL 'kxdfhei1' USING DFHEIV0,
 25022           DFHEIV99,
 25023           DFHEIV99,
 25024           DFHEIV99,
 25025           DFHEIV99,
 25026           DFHEIV99,
 25027           DFHEIV99
 25028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25029
 25030
 25031 8400-LOG-JOURNAL-RECORD.
 25032     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 25033     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 25034
 25035*    EXEC CICS JOURNAL
 25036*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 462
* EL6311.cbl
 25037*        JTYPEID     ('EL')
 25038*        FROM        (JOURNAL-RECORD)
 25039*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 25040*    END-EXEC.
 25041
 25042 8600-DEEDIT.
 25043
 25044* EXEC CICS BIF DEEDIT
 25045*         FIELD   (DEEDIT-FIELD)
 25046*         LENGTH  (15)
 25047*    END-EXEC.
 25048     MOVE 15
 25049       TO DFHEIV11
 25050*    MOVE '@"L                   #   #00020985' TO DFHEIV0
 25051     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 25052     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 25053     MOVE X'2020233030303230393835' TO DFHEIV0(25:11)
 25054     CALL 'kxdfhei1' USING DFHEIV0,
 25055           DEEDIT-FIELD,
 25056           DFHEIV11
 25057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25058
 25059
 25060 8800-UNAUTHORIZED-ACCESS.
 25061     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 25062     GO TO 8300-SEND-TEXT.
 25063
 25064 8810-PF23.
 25065     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 25066     MOVE XCTL-EL005             TO PGM-NAME.
 25067     GO TO 9300-XCTL.
 25068
 25069 9100-RETURN-TRAN.
 25070     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 25071
 25072     IF  PI-MAP-NAME =  EL631B
 25073         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 25074
 25075     IF  PI-MAP-NAME =  EL631C
 25076         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 25077
 25078     IF  PI-MAP-NAME =  EL631D
 25079         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 25080
 25081
 25082* EXEC CICS RETURN
 25083*        TRANSID    (TRANS-EXB1)
 25084*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25085*        LENGTH     (1300)
 25086*    END-EXEC.
 25087     MOVE 1300
 25088       TO DFHEIV11
 25089*    MOVE '.(CT                  ''   #00021011' TO DFHEIV0
 25090     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 25091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25092     MOVE X'2020233030303231303131' TO DFHEIV0(25:11)
 25093     CALL 'kxdfhei1' USING DFHEIV0,
 25094           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 463
* EL6311.cbl
 25095           PROGRAM-INTERFACE-BLOCK,
 25096           DFHEIV11,
 25097           DFHEIV99,
 25098           DFHEIV99,
 25099           DFHEIV99
 25100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25101
 25102
 25103 9200-RETURN-MAIN-MENU.
 25104     MOVE XCTL-EL626             TO PGM-NAME.
 25105     GO TO 9300-XCTL.
 25106
 25107 9300-XCTL.
 25108
 25109* EXEC CICS XCTL
 25110*        PROGRAM    (PGM-NAME)
 25111*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25112*        LENGTH     (PI-COMM-LENGTH)
 25113*    END-EXEC.
 25114*    MOVE '.$C                   %   #00021022' TO DFHEIV0
 25115     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 25116     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 25117     MOVE X'2020233030303231303232' TO DFHEIV0(25:11)
 25118     CALL 'kxdfhei1' USING DFHEIV0,
 25119           PGM-NAME,
 25120           PROGRAM-INTERFACE-BLOCK,
 25121           PI-COMM-LENGTH,
 25122           DFHEIV99
 25123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25124
 25125
 25126 9400-CLEAR.
 25127     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 25128     GO TO 9300-XCTL.
 25129
 25130 9500-PF12.
 25131     MOVE XCTL-EL010             TO PGM-NAME.
 25132     GO TO 9300-XCTL.
 25133
 25134 9600-PGMID-ERROR.
 25135
 25136* EXEC CICS HANDLE CONDITION
 25137*        PGMIDERR    (8300-SEND-TEXT)
 25138*    END-EXEC.
 25139*    MOVE '"$L                   ! \ #00021037' TO DFHEIV0
 25140     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 25141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 25142     MOVE X'5C20233030303231303337' TO DFHEIV0(25:11)
 25143     CALL 'kxdfhei1' USING DFHEIV0
 25144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25145
 25146
 25147     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 25148     MOVE ' '                    TO PI-ENTRY-CD-1.
 25149     MOVE XCTL-EL005             TO PGM-NAME.
 25150     MOVE PGM-NAME               TO LOGOFF-PGM.
 25151     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 25152     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 464
* EL6311.cbl
 25153
 25154 9700-DATE-LINK.
 25155     MOVE LINK-ELDATCV           TO PGM-NAME.
 25156
 25157* EXEC CICS LINK
 25158*        PROGRAM    (PGM-NAME)
 25159*        COMMAREA   (DATE-CONVERSION-DATA)
 25160*        LENGTH     (DC-COMM-LENGTH)
 25161*    END-EXEC.
 25162*    MOVE '."C                   (   #00021050' TO DFHEIV0
 25163     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25165     MOVE X'2020233030303231303530' TO DFHEIV0(25:11)
 25166     CALL 'kxdfhei1' USING DFHEIV0,
 25167           PGM-NAME,
 25168           DATE-CONVERSION-DATA,
 25169           DC-COMM-LENGTH,
 25170           DFHEIV99,
 25171           DFHEIV99,
 25172           DFHEIV99,
 25173           DFHEIV99
 25174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25175
 25176
 25177 9800-LINK-PENDING-EDIT.
 25178     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 25179     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 25180
 25181     MOVE LINK-EL050             TO PGM-NAME
 25182     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 25183     MOVE ZEROS                  TO WK-CO-MAX-CAP
 25184                                    WK-CO-TOL-CLAIM
 25185                                    WK-CO-TOL-PREM
 25186                                    WK-CO-TOL-REFUND
 25187                                    WK-CO-TOL-PREM-PCT
 25188                                    WK-CO-TOL-REFUND-PCT
 25189                                    WK-REFUND-OVS-AMT
 25190                                    WK-REFUND-OVS-PCT
 25191                                    WK-ACCT-ADDR
 25192                                    WK-LIFE-EDIT-ADDR
 25193                                    WK-AH-EDIT-ADDR
 25194                                    WK-LIFE-BEN-ADDR
 25195                                    WK-AH-BEN-ADDR
 25196                                    WK-STATE-ADDR
 25197                                    WK-PLAN-ADDR
 25198                                    WK-FORM-ADDR
 25199     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 25200
 25201     MOVE '6'                    TO WK-ENTRY-SW.
 25202
 25203     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 25204
 25205     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 25206                                    EC-AM-EXPIRATION-DT
 25207                                    EC-AM-EFFECTIVE-DT
 25208                                    EC-CM-LF-CANCEL-DT
 25209                                    EC-CM-AH-CANCEL-DT
 25210                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 465
* EL6311.cbl
 25211
 25212     MOVE ZEROS                  TO EC-CO-TOL-PREM
 25213                                    EC-CO-TOL-REFUND
 25214                                    EC-CO-MIN-AGE
 25215                                    EC-CO-MIN-PREMIUM
 25216                                    EC-CO-MIN-TERM
 25217                                    EC-CO-MAX-TERM
 25218                                    EC-ST-TOL-PREM
 25219                                    EC-ST-TOL-REFUND
 25220                                    EC-AM-LF-TOL-PREM
 25221                                    EC-AM-AH-TOL-PREM
 25222                                    EC-AM-LF-MAX-ATT-AGE
 25223                                    EC-AM-LF-MAX-AGE
 25224                                    EC-AM-LF-MAX-TERM
 25225                                    EC-AM-LF-MAX-TOT-BEN
 25226                                    EC-AM-AH-MAX-ATT-AGE
 25227                                    EC-AM-AH-MAX-AGE
 25228                                    EC-AM-AH-MAX-TERM
 25229                                    EC-AM-AH-MAX-TOT-BEN
 25230                                    EC-AM-AH-MAX-MON-BEN
 25231                                    EC-RT-LF-MAX-ATT-AGE
 25232                                    EC-RT-LF-MAX-AGE
 25233                                    EC-RT-LF-MAX-TERM
 25234                                    EC-RT-LF-MAX-TOT-BEN
 25235                                    EC-RT-AH-MAX-ATT-AGE
 25236                                    EC-RT-AH-MAX-AGE
 25237                                    EC-RT-AH-MAX-TERM
 25238                                    EC-RT-AH-MAX-TOT-BEN
 25239                                    EC-RT-AH-MAX-MON-BEN
 25240                                    EC-RT-AH-RATE
 25241                                    EC-RT-LF-RATE
 25242                                    EC-RT-LF-NSP-RATE
 25243                                    EC-RT-AH-NSP-RATE
 25244                                    EC-CM-LF-PRIOR-REFUND
 25245                                    EC-CM-AH-PRIOR-REFUND.
 25246
 25247     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 25248                                    EC-ST-TOL-PREM-PCT
 25249                                    EC-AM-LF-TOL-REFUND
 25250                                    EC-AM-LF-DEV-PERCENT
 25251                                    EC-CO-TOL-REFUND-PCT
 25252                                    EC-ST-TOL-REFUND-PCT
 25253                                    EC-AM-AH-TOL-REFUND
 25254                                    EC-AM-AH-DEV-PERCENT.
 25255
 25256
 25257* EXEC CICS LINK
 25258*         PROGRAM   (PGM-NAME)
 25259*         COMMAREA  (PASSED-RECORD)
 25260*         LENGTH    (WS-EDIT-PASS-LENGTH)
 25261*    END-EXEC.
 25262*    MOVE '."C                   (   #00021135' TO DFHEIV0
 25263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25265     MOVE X'2020233030303231313335' TO DFHEIV0(25:11)
 25266     CALL 'kxdfhei1' USING DFHEIV0,
 25267           PGM-NAME,
 25268           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 466
* EL6311.cbl
 25269           WS-EDIT-PASS-LENGTH,
 25270           DFHEIV99,
 25271           DFHEIV99,
 25272           DFHEIV99,
 25273           DFHEIV99
 25274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25275
 25276
 25277     MOVE '1'                    TO PI-EDIT-SW.
 25278     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 25279
 25280     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 25281
 25282     IF PI-COMPANY-ID = 'UCL'
 25283         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 25284
 25285     IF VALID-PB-ID
 25286        GO TO 9800-EXIT.
 25287
 25288     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 25289
 25290     IF PI-MAP-NAME = EL631B
 25291        MOVE -1                  TO BMAINTL
 25292       ELSE
 25293        MOVE -1                  TO CMAINTL.
 25294
 25295     GO TO 8200-SEND-DATAONLY.
 25296
 25297 9800-EXIT.
 25298      EXIT.
 25299
 25300 9900-ERROR-FORMAT.
 25301
 25302     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 25303
 25304     IF NOT EMI-ERRORS-COMPLETE
 25305         MOVE LINK-EL001         TO PGM-NAME
 25306
 25307* EXEC CICS LINK
 25308*            PROGRAM    (PGM-NAME)
 25309*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 25310*            LENGTH     (EMI-COMM-LENGTH)
 25311*        END-EXEC.
 25312*    MOVE '."C                   (   #00021170' TO DFHEIV0
 25313     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25315     MOVE X'2020233030303231313730' TO DFHEIV0(25:11)
 25316     CALL 'kxdfhei1' USING DFHEIV0,
 25317           PGM-NAME,
 25318           ERROR-MESSAGE-INTERFACE-BLOCK,
 25319           EMI-COMM-LENGTH,
 25320           DFHEIV99,
 25321           DFHEIV99,
 25322           DFHEIV99,
 25323           DFHEIV99
 25324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25325
 25326
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 467
* EL6311.cbl
 25327 9900-EXIT.
 25328     EXIT.
 25329
 25330 9990-ABEND.
 25331     MOVE LINK-EL004             TO PGM-NAME.
 25332     MOVE DFHEIBLK               TO EMI-LINE1.
 25333
 25334* EXEC CICS LINK
 25335*        PROGRAM   (PGM-NAME)
 25336*        COMMAREA  (EMI-LINE1)
 25337*        LENGTH    (72)
 25338*    END-EXEC.
 25339     MOVE 72
 25340       TO DFHEIV11
 25341*    MOVE '."C                   (   #00021182' TO DFHEIV0
 25342     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25344     MOVE X'2020233030303231313832' TO DFHEIV0(25:11)
 25345     CALL 'kxdfhei1' USING DFHEIV0,
 25346           PGM-NAME,
 25347           EMI-LINE1,
 25348           DFHEIV11,
 25349           DFHEIV99,
 25350           DFHEIV99,
 25351           DFHEIV99,
 25352           DFHEIV99
 25353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25354
 25355
 25356     IF PI-MAP-NAME = EL631B
 25357        MOVE -1                  TO BMAINTL
 25358       ELSE
 25359        MOVE -1                  TO CMAINTL.
 25360
 25361     IF EIBTRNID NOT = TRANS-EXB1
 25362        GO TO 8100-SEND-INITIAL-MAP
 25363       ELSE
 25364        GO TO 8200-SEND-DATAONLY.
 25365
 25366 9995-SECURITY-VIOLATION.
 25367*                            COPY ELCSCTP.
 25368******************************************************************
 25369*                                                                *
 25370*                            ELCSCTP                             *
 25371*                            VMOD=2.001                          *
 25372*                                                                *
 25373*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25374******************************************************************
 25375
 25376
 25377     MOVE EIBDATE          TO SM-JUL-DATE.
 25378     MOVE EIBTRMID         TO SM-TERMID.
 25379     MOVE THIS-PGM         TO SM-PGM.
 25380     MOVE EIBTIME          TO TIME-IN.
 25381     MOVE TIME-OUT         TO SM-TIME.
 25382     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25383
 25384
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 468
* EL6311.cbl
 25385* EXEC CICS LINK
 25386*         PROGRAM  ('EL003')
 25387*         COMMAREA (SECURITY-MESSAGE)
 25388*         LENGTH   (80)
 25389*    END-EXEC.
 25390     MOVE 'EL003' TO DFHEIV1
 25391     MOVE 80
 25392       TO DFHEIV11
 25393*    MOVE '."C                   (   #00021216' TO DFHEIV0
 25394     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25396     MOVE X'2020233030303231323136' TO DFHEIV0(25:11)
 25397     CALL 'kxdfhei1' USING DFHEIV0,
 25398           DFHEIV1,
 25399           SECURITY-MESSAGE,
 25400           DFHEIV11,
 25401           DFHEIV99,
 25402           DFHEIV99,
 25403           DFHEIV99,
 25404           DFHEIV99
 25405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25406
 25407
 25408******************************************************************
 25409
 25410
 25411 9999-DFHBACK SECTION.
 25412     MOVE '9%                    "   ' TO DFHEIV0
 25413     MOVE 'EL6311' TO DFHEIV1
 25414     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25415     GOBACK.
 25416 9999-DFHEXIT.
 25417     IF DFHEIGDJ EQUAL 0001
 25418         NEXT SENTENCE
 25419     ELSE IF DFHEIGDJ EQUAL 2
 25420         GO TO 9600-PGMID-ERROR,
 25421               9990-ABEND,
 25422               9990-ABEND,
 25423               0010-MAIN-LOGIC
 25424         DEPENDING ON DFHEIGDI
 25425     ELSE IF DFHEIGDJ EQUAL 3
 25426         GO TO 1280-BATCH-HDR-NOT-FOUND
 25427         DEPENDING ON DFHEIGDI
 25428     ELSE IF DFHEIGDJ EQUAL 4
 25429         GO TO 1290-DUPLICATE-ALT-INDEX
 25430         DEPENDING ON DFHEIGDI
 25431     ELSE IF DFHEIGDJ EQUAL 5
 25432         GO TO 1295-CERT-TRL-REC-NOTFND
 25433         DEPENDING ON DFHEIGDI
 25434     ELSE IF DFHEIGDJ EQUAL 6
 25435         GO TO 1380-BATCH-HDR-NOT-FOUND
 25436         DEPENDING ON DFHEIGDI
 25437     ELSE IF DFHEIGDJ EQUAL 7
 25438         GO TO 1385-REC-NOT-FOUND
 25439         DEPENDING ON DFHEIGDI
 25440     ELSE IF DFHEIGDJ EQUAL 8
 25441         GO TO 1386-NOTFND
 25442         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 469
* EL6311.cbl
 25443     ELSE IF DFHEIGDJ EQUAL 9
 25444         GO TO 1399-EXIT
 25445         DEPENDING ON DFHEIGDI
 25446     ELSE IF DFHEIGDJ EQUAL 10
 25447         GO TO 1480-BATCH-HDR-NOT-FOUND
 25448         DEPENDING ON DFHEIGDI
 25449     ELSE IF DFHEIGDJ EQUAL 11
 25450         GO TO 1490-RECORD-NOT-FOUND
 25451         DEPENDING ON DFHEIGDI
 25452     ELSE IF DFHEIGDJ EQUAL 12
 25453         GO TO 1405-DELETE-CERTIFICATE
 25454         DEPENDING ON DFHEIGDI
 25455     ELSE IF DFHEIGDJ EQUAL 13
 25456         GO TO 1420-CONTINUE-DELETE
 25457         DEPENDING ON DFHEIGDI
 25458     ELSE IF DFHEIGDJ EQUAL 14
 25459         GO TO 1406-DELETE-ERNOTE
 25460         DEPENDING ON DFHEIGDI
 25461     ELSE IF DFHEIGDJ EQUAL 15
 25462         GO TO 1407-DELETE-MAILING
 25463         DEPENDING ON DFHEIGDI
 25464     ELSE IF DFHEIGDJ EQUAL 16
 25465         GO TO 1420-CONTINUE-DELETE
 25466         DEPENDING ON DFHEIGDI
 25467     ELSE IF DFHEIGDJ EQUAL 17
 25468         GO TO 1480-BATCH-HDR-NOT-FOUND
 25469         DEPENDING ON DFHEIGDI
 25470     ELSE IF DFHEIGDJ EQUAL 18
 25471         GO TO 1475-DELETE-FINISHED
 25472         DEPENDING ON DFHEIGDI
 25473     ELSE IF DFHEIGDJ EQUAL 19
 25474         GO TO 2280-BATCH-HDR-NOT-FOUND
 25475         DEPENDING ON DFHEIGDI
 25476     ELSE IF DFHEIGDJ EQUAL 20
 25477         GO TO 2290-DUPLICATE-ALT-INDEX
 25478         DEPENDING ON DFHEIGDI
 25479     ELSE IF DFHEIGDJ EQUAL 21
 25480         GO TO 2380-BATCH-HDR-NOT-FOUND
 25481         DEPENDING ON DFHEIGDI
 25482     ELSE IF DFHEIGDJ EQUAL 22
 25483         GO TO 2385-REC-NOT-FOUND
 25484         DEPENDING ON DFHEIGDI
 25485     ELSE IF DFHEIGDJ EQUAL 23
 25486         GO TO 2380-BATCH-HDR-NOT-FOUND
 25487         DEPENDING ON DFHEIGDI
 25488     ELSE IF DFHEIGDJ EQUAL 24
 25489         GO TO 2485-BATCH-HDR-NOT-FOUND
 25490         DEPENDING ON DFHEIGDI
 25491     ELSE IF DFHEIGDJ EQUAL 25
 25492         GO TO 2490-RECORD-NOT-FOUND
 25493         DEPENDING ON DFHEIGDI
 25494     ELSE IF DFHEIGDJ EQUAL 26
 25495         GO TO 2475-CONTINUE-DELETE
 25496         DEPENDING ON DFHEIGDI
 25497     ELSE IF DFHEIGDJ EQUAL 27
 25498         GO TO 2485-BATCH-HDR-NOT-FOUND
 25499         DEPENDING ON DFHEIGDI
 25500     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 470
* EL6311.cbl
 25501         GO TO 2480-DELETE-FINISHED
 25502         DEPENDING ON DFHEIGDI
 25503     ELSE IF DFHEIGDJ EQUAL 29
 25504         GO TO 2820-PROCESS-REWRITE
 25505         DEPENDING ON DFHEIGDI
 25506     ELSE IF DFHEIGDJ EQUAL 30
 25507         GO TO 2885-RECORD-MISSING
 25508         DEPENDING ON DFHEIGDI
 25509     ELSE IF DFHEIGDJ EQUAL 31
 25510         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25511         DEPENDING ON DFHEIGDI
 25512     ELSE IF DFHEIGDJ EQUAL 32
 25513         GO TO 2827-DELETE-MAILING
 25514         DEPENDING ON DFHEIGDI
 25515     ELSE IF DFHEIGDJ EQUAL 33
 25516         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25517         DEPENDING ON DFHEIGDI
 25518     ELSE IF DFHEIGDJ EQUAL 34
 25519         GO TO 2920-PROCESS-REWRITE
 25520         DEPENDING ON DFHEIGDI
 25521     ELSE IF DFHEIGDJ EQUAL 35
 25522         GO TO 2985-RECORD-MISSING
 25523         DEPENDING ON DFHEIGDI
 25524     ELSE IF DFHEIGDJ EQUAL 36
 25525         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25526         DEPENDING ON DFHEIGDI
 25527     ELSE IF DFHEIGDJ EQUAL 37
 25528         GO TO 2990-DUPLICATE-RECORD
 25529         DEPENDING ON DFHEIGDI
 25530     ELSE IF DFHEIGDJ EQUAL 38
 25531         GO TO 3590-NOT-FOUND
 25532         DEPENDING ON DFHEIGDI
 25533     ELSE IF DFHEIGDJ EQUAL 39
 25534         GO TO 3690-NOT-FOUND
 25535         DEPENDING ON DFHEIGDI
 25536     ELSE IF DFHEIGDJ EQUAL 40
 25537         GO TO 3990-NOT-FOUND
 25538         DEPENDING ON DFHEIGDI
 25539     ELSE IF DFHEIGDJ EQUAL 41
 25540         GO TO 4050-END-RECORDS,
 25541               4050-END-RECORDS
 25542         DEPENDING ON DFHEIGDI
 25543     ELSE IF DFHEIGDJ EQUAL 42
 25544         GO TO 4150-END-BATCH
 25545         DEPENDING ON DFHEIGDI
 25546     ELSE IF DFHEIGDJ EQUAL 43
 25547         GO TO 4150-END-BATCH
 25548         DEPENDING ON DFHEIGDI
 25549     ELSE IF DFHEIGDJ EQUAL 44
 25550         GO TO 4250-END-RECORDS,
 25551               4250-END-RECORDS
 25552         DEPENDING ON DFHEIGDI
 25553     ELSE IF DFHEIGDJ EQUAL 45
 25554         GO TO 4350-END-BATCH,
 25555               4350-END-BATCH
 25556         DEPENDING ON DFHEIGDI
 25557     ELSE IF DFHEIGDJ EQUAL 46
 25558         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:06 Page 471
* EL6311.cbl
 25559               4550-END-RECORDS
 25560         DEPENDING ON DFHEIGDI
 25561     ELSE IF DFHEIGDJ EQUAL 47
 25562         GO TO 4680-NOT-FOUND,
 25563               4680-NOT-FOUND
 25564         DEPENDING ON DFHEIGDI
 25565     ELSE IF DFHEIGDJ EQUAL 48
 25566         GO TO 4860-NOT-FOUND,
 25567               4850-END-RECORDS
 25568         DEPENDING ON DFHEIGDI
 25569     ELSE IF DFHEIGDJ EQUAL 49
 25570         GO TO 4970-NOT-FOUND,
 25571               4950-END-RECORDS
 25572         DEPENDING ON DFHEIGDI
 25573     ELSE IF DFHEIGDJ EQUAL 50
 25574         GO TO 5050-NOT-FOUND
 25575         DEPENDING ON DFHEIGDI
 25576     ELSE IF DFHEIGDJ EQUAL 51
 25577         GO TO 5050-NOT-FOUND
 25578         DEPENDING ON DFHEIGDI
 25579     ELSE IF DFHEIGDJ EQUAL 52
 25580         GO TO 5050-NOT-FOUND
 25581         DEPENDING ON DFHEIGDI
 25582     ELSE IF DFHEIGDJ EQUAL 53
 25583         GO TO 5550-END-RECORDS,
 25584               5550-END-RECORDS
 25585         DEPENDING ON DFHEIGDI
 25586     ELSE IF DFHEIGDJ EQUAL 54
 25587         GO TO 6050-QID-ERROR
 25588         DEPENDING ON DFHEIGDI
 25589     ELSE IF DFHEIGDJ EQUAL 55
 25590         GO TO 6050-QID-ERROR
 25591         DEPENDING ON DFHEIGDI
 25592     ELSE IF DFHEIGDJ EQUAL 56
 25593         GO TO 6400-CONTINUE,
 25594               6400-CONTINUE
 25595         DEPENDING ON DFHEIGDI
 25596     ELSE IF DFHEIGDJ EQUAL 57
 25597         GO TO 3690-NOT-FOUND
 25598         DEPENDING ON DFHEIGDI
 25599     ELSE IF DFHEIGDJ EQUAL 58
 25600         GO TO 7399-EXIT
 25601         DEPENDING ON DFHEIGDI
 25602     ELSE IF DFHEIGDJ EQUAL 59
 25603         GO TO 7550-OFFICER-NOTFND
 25604         DEPENDING ON DFHEIGDI
 25605     ELSE IF DFHEIGDJ EQUAL 60
 25606         GO TO 8300-SEND-TEXT
 25607         DEPENDING ON DFHEIGDI.
 25608     MOVE '9%                    "   ' TO DFHEIV0
 25609     MOVE 'EL6311' TO DFHEIV1
 25610     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25611     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16372     Code:      101482
