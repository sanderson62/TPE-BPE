* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   1
* ELRFND.cbl
* Options: int("ELRFND.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRFND.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFND.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFND.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFND.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:50.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   2
* ELRFND.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  LOAN TERM        - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   3
* ELRFND.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  ELRFND  WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '********VMOD=2.011 *************'.
    66 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    68 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    69
    70 01  WS-WORK-MISC.
    71     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    72     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    73     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    74     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    75     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    76     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    77     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    78     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    79     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    80     12  WS-SAVE-EARN-METHOD PIC X.
    81     12  ws-save-ext-days    pic s9(5)        comp-3.
    82     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    83     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    87     12  FACTOR-5            PIC S9(7)        COMP-3.
    88     12  FACTOR-6            PIC S9(7)        COMP-3.
    89     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    90     12  RATE-FACTOR-2       PIC S999         COMP-3.
    91     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    92     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    94     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    95
    96 01  TEXAS-REG-WORK-AREAS.
    97     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    98     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   100     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   101     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   103     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   104     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   105     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   106
   107 01  NET-PAY-INTERFACE.
   108     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   109     12  N-P-ORIG            PIC S9(3)       COMP-3.
   110     12  N-P-REM             PIC S9(3)       COMP-3.
   111     12  N-P-OPT             PIC X.
   112     12  N-P-LOAN            PIC S9(3)       COMP-3.
   113     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   114
   115*                        COPY ERCNETWS.
   116*****************************************************************
   117*                                                               *
   118*                                                               *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   4
* ELRFND.cbl
   119*                            ERCNETWS                           *
   120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   121*                            VMOD=2.014                         *
   122*                                                               *
   123*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   124*                                                               *
   125*****************************************************************.
   126*                   C H A N G E   L O G
   127*
   128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   129*-----------------------------------------------------------------
   130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   131* EFFECTIVE    NUMBER
   132*-----------------------------------------------------------------
   133* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   134* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   135* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   136* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   137* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   138******************************************************************
   139
   140 01  NET-PAY-WORK-AREA.
   141     12  OPTION-SW               PIC X   VALUE 'X'.
   142        88  NPO-STD         VALUE SPACE.
   143        88  NPO-ALT         VALUE 'A'.
   144        88  NPO-SIMPLE      VALUE 'S'.
   145        88  NPO-2MO         VALUE 'I'.
   146        88  NPO-3MO         VALUE 'J'.
   147        88  NPO-4MO         VALUE 'K'.
   148        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   149        88  NPO-TRUNC-0     VALUE 'T'.
   150        88  NPO-TRUNC-1     VALUE 'U'.
   151        88  NPO-TRUNC-2     VALUE 'V'.
   152        88  NPO-TRUNC-3     VALUE 'W'.
   153        88  NPO-TRUNC-4     VALUE 'X'.
   154        88  NPO-REFUND      VALUE 'R'.
   155        88  NPO-PRUDENTIAL  VALUE 'P'.
   156
   157     12  TYPE-SW             PIC X   VALUE 'N'.
   158        88  NET-STD             VALUE 'N'.
   159        88  NET-SMP             VALUE 'S'.
   160
   161     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   162        88  NP-RATING           VALUE '1'.
   163        88  NP-REFUND           VALUE '2'.
   164        88  NP-REMAIN-AMT       VALUE '3'.
   165
   166     12  COMP-3-WORK-AREA         COMP-3.
   167         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   168         16  V               PIC SV9(13)       VALUE +.0.
   169         16  J               PIC SV9(9)        VALUE +0.
   170         16  K               PIC SV9(9)        VALUE +0.
   171         16  I               PIC SV9(10)       VALUE +.0.
   172         16  D               PIC S9(5)         VALUE +.0.
   173         16  APR100          PIC SV9(9)        VALUE +.0.
   174         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   175         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   176         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   5
* ELRFND.cbl
   177         16  pema            pic s9(2)v9(15)   value +0.
   178         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   179         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   180         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   181         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   182         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   183         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   184         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   185         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   186         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   187         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   188         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   189         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   190         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   191         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   192         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   193         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   194         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   195         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   196         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   197         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   198         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   199         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   200         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   201         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   202         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   203         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   204         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   205         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   206         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   207         16  K1              PIC S999          VALUE +1.
   208         16  K12             PIC S999          VALUE +12.
   209         16  K100            PIC S999          VALUE +100.
   210         16  K1000           PIC S9(7)         VALUE +1000.
   211         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   212         16  Y REDEFINES NC-LR
   213                             PIC S99V9(5).
   214         16  TI              PIC S999V9(5)     VALUE +0.
   215         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   216         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   217         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   218         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   219         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   220         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   221         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   222         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   223
   224         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   225         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   226         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   227         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   228         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   229         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   230         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   231         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   232         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   233         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   234         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   6
* ELRFND.cbl
   235         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   236         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   237
   238         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   239
   240         16  ORIGINAL-TERM   PIC S999.
   241         16  M              REDEFINES ORIGINAL-TERM
   242                             PIC S999.
   243
   244         16  REMAINING-TERM  PIC S999.
   245         16  R              REDEFINES REMAINING-TERM
   246                             PIC S999.
   247
   248         16  LOAN-TERM       PIC S999.
   249         16  N              REDEFINES LOAN-TERM
   250                             PIC S999.
   251
   252         16  EXPIRED-TERM    PIC S999.
   253         16  E              REDEFINES EXPIRED-TERM
   254                             PIC S999.
   255
   256         16  PRUDENTIAL-WORK-AMT
   257                             PIC S9(7)V9(8).
   258         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   259                             PIC S9(7)V9(8).
   260
   261         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   262         16  VX              PIC S9V9(13)      VALUE +0.0.
   263         16  SV              PIC S9V9(13)      VALUE +0.0.
   264         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   265         16  SX              PIC S9V9(13)      VALUE +0.0.
   266         16  SE              PIC S9V9(10)      VALUE +0.0.
   267         16  N2              PIC S9(7)         VALUE +0.
   268         16  N3              PIC S9(7)         VALUE +0.
   269         16  K-I             PIC S9V9(8)       VALUE +0.0.
   270
   271     12  BINARY-WORK-AREA        COMP.
   272         16  X1              PIC S999        VALUE +0.
   273         16  X2              PIC S999        VALUE +0.
   274         16  MAX-X           PIC S9(5)       VALUE +0.
   275         16  B1              PIC S9(5)       VALUE +1.
   276         16  LINDX           PIC S999        VALUE ZEROS.
   277         16  AHNDX           PIC S999        VALUE ZEROS.
   278
   279     12  CSO-RATE-WORK-AREAS.
   280         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   281         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   282         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   283     12  WS-WORK-MISC.
   284         16  ws-extra-pmts       pic s999         comp-3.
   285         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   286         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   287*        16  WS-AGE              PIC 99           VALUE ZEROS.
   288         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   289         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   290         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   291         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   292         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   7
* ELRFND.cbl
   293         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   294         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   295         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   296         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   297         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   298         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   299         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   300******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   8
* ELRFND.cbl
   302*                        COPY ELCDATE.
   303******************************************************************
   304*                                                                *
   305*                                                                *
   306*                            ELCDATE.                            *
   307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   308*                            VMOD=2.003
   309*                                                                *
   310*                                                                *
   311*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   312*                 LENGTH = 200                                   *
   313******************************************************************
   314
   315 01  DATE-CONVERSION-DATA.
   316     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   317     12  DC-OPTION-CODE                PIC X.
   318         88  BIN-TO-GREG                VALUE ' '.
   319         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   320         88  EDIT-GREG-TO-BIN           VALUE '2'.
   321         88  YMD-GREG-TO-BIN            VALUE '3'.
   322         88  MDY-GREG-TO-BIN            VALUE '4'.
   323         88  JULIAN-TO-BIN              VALUE '5'.
   324         88  BIN-PLUS-ELAPSED           VALUE '6'.
   325         88  FIND-CENTURY               VALUE '7'.
   326         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   327         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   328         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   329         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   330         88  JULIAN-TO-BIN-3            VALUE 'C'.
   331         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   332         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   333         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   334         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   335         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   336         88  CHECK-LEAP-YEAR            VALUE 'H'.
   337         88  BIN-3-TO-GREG              VALUE 'I'.
   338         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   339         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   340         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   341         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   342         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   343         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   344         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   345         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   346         88  THREE-CHARACTER-BIN
   347                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   348         88  GREGORIAN-TO-BIN
   349                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   350         88  BIN-TO-GREGORIAN
   351                  VALUES ' ' '1' 'I' '8' 'G'.
   352         88  JULIAN-TO-BINARY
   353                  VALUES '5' 'C' 'E' 'F'.
   354     12  DC-ERROR-CODE                 PIC X.
   355         88  NO-CONVERSION-ERROR        VALUE ' '.
   356         88  DATE-CONVERSION-ERROR
   357                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   358         88  DATE-IS-ZERO               VALUE '1'.
   359         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   9
* ELRFND.cbl
   360         88  DATE-IS-INVALID            VALUE '3'.
   361         88  DATE1-GREATER-DATE2        VALUE '4'.
   362         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   363         88  DATE-INVALID-OPTION        VALUE '9'.
   364         88  INVALID-CENTURY            VALUE 'A'.
   365         88  ONLY-CENTURY               VALUE 'B'.
   366         88  ONLY-LEAP-YEAR             VALUE 'C'.
   367         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   368     12  DC-END-OF-MONTH               PIC X.
   369         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   370     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   371         88  USE-NORMAL-PROCESS         VALUE ' '.
   372         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   373         88  ADJUST-UP-100-YRS          VALUE '2'.
   374     12  FILLER                        PIC X.
   375     12  DC-CONVERSION-DATES.
   376         16  DC-BIN-DATE-1             PIC XX.
   377         16  DC-BIN-DATE-2             PIC XX.
   378         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   379         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   380                       DC-GREG-DATE-1-EDIT.
   381             20  DC-EDIT1-MONTH        PIC 99.
   382             20  SLASH1-1              PIC X.
   383             20  DC-EDIT1-DAY          PIC 99.
   384             20  SLASH1-2              PIC X.
   385             20  DC-EDIT1-YEAR         PIC 99.
   386         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   387         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   388                     DC-GREG-DATE-2-EDIT.
   389             20  DC-EDIT2-MONTH        PIC 99.
   390             20  SLASH2-1              PIC X.
   391             20  DC-EDIT2-DAY          PIC 99.
   392             20  SLASH2-2              PIC X.
   393             20  DC-EDIT2-YEAR         PIC 99.
   394         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   395         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   396                     DC-GREG-DATE-1-YMD.
   397             20  DC-YMD-YEAR           PIC 99.
   398             20  DC-YMD-MONTH          PIC 99.
   399             20  DC-YMD-DAY            PIC 99.
   400         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   401         16  DC-GREG-DATE-1-MDY-R REDEFINES
   402                      DC-GREG-DATE-1-MDY.
   403             20  DC-MDY-MONTH          PIC 99.
   404             20  DC-MDY-DAY            PIC 99.
   405             20  DC-MDY-YEAR           PIC 99.
   406         16  DC-GREG-DATE-1-ALPHA.
   407             20  DC-ALPHA-MONTH        PIC X(10).
   408             20  DC-ALPHA-DAY          PIC 99.
   409             20  FILLER                PIC XX.
   410             20  DC-ALPHA-CENTURY.
   411                 24 DC-ALPHA-CEN-N     PIC 99.
   412             20  DC-ALPHA-YEAR         PIC 99.
   413         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   414         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   415         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   416         16  DC-JULIAN-DATE            PIC 9(05).
   417         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  10
* ELRFND.cbl
   418                                       PIC 9(05).
   419         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   420             20  DC-JULIAN-YEAR        PIC 99.
   421             20  DC-JULIAN-DAYS        PIC 999.
   422         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   423         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   424         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   425     12  DATE-CONVERSION-VARIBLES.
   426         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   427         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   428             20  FILLER                PIC 9(3).
   429             20  HOLD-CEN-1-CCYY.
   430                 24  HOLD-CEN-1-CC     PIC 99.
   431                 24  HOLD-CEN-1-YY     PIC 99.
   432             20  HOLD-CEN-1-MO         PIC 99.
   433             20  HOLD-CEN-1-DA         PIC 99.
   434         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   435             20  HOLD-CEN-1-R-MO       PIC 99.
   436             20  HOLD-CEN-1-R-DA       PIC 99.
   437             20  HOLD-CEN-1-R-CCYY.
   438                 24  HOLD-CEN-1-R-CC   PIC 99.
   439                 24  HOLD-CEN-1-R-YY   PIC 99.
   440             20  FILLER                PIC 9(3).
   441         16  HOLD-CENTURY-1-X.
   442             20  FILLER                PIC X(3)  VALUE SPACES.
   443             20  HOLD-CEN-1-X-CCYY.
   444                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   445                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   446             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   447             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   448         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   449             20  HOLD-CEN-1-R-X-MO     PIC XX.
   450             20  HOLD-CEN-1-R-X-DA     PIC XX.
   451             20  HOLD-CEN-1-R-X-CCYY.
   452                 24  HOLD-CEN-1-R-X-CC PIC XX.
   453                 24  HOLD-CEN-1-R-X-YY PIC XX.
   454             20  FILLER                PIC XXX.
   455         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   456         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   457         16  DC-JULIAN-DATE-1          PIC 9(07).
   458         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   459             20  DC-JULIAN-1-CCYY.
   460                 24  DC-JULIAN-1-CC    PIC 99.
   461                 24  DC-JULIAN-1-YR    PIC 99.
   462             20  DC-JULIAN-DA-1        PIC 999.
   463         16  DC-JULIAN-DATE-2          PIC 9(07).
   464         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   465             20  DC-JULIAN-2-CCYY.
   466                 24  DC-JULIAN-2-CC    PIC 99.
   467                 24  DC-JULIAN-2-YR    PIC 99.
   468             20  DC-JULIAN-DA-2        PIC 999.
   469         16  DC-GREG-DATE-A-EDIT.
   470             20  DC-EDITA-MONTH        PIC 99.
   471             20  SLASHA-1              PIC X VALUE '/'.
   472             20  DC-EDITA-DAY          PIC 99.
   473             20  SLASHA-2              PIC X VALUE '/'.
   474             20  DC-EDITA-CCYY.
   475                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  11
* ELRFND.cbl
   476                 24  DC-EDITA-YEAR     PIC 99.
   477         16  DC-GREG-DATE-B-EDIT.
   478             20  DC-EDITB-MONTH        PIC 99.
   479             20  SLASHB-1              PIC X VALUE '/'.
   480             20  DC-EDITB-DAY          PIC 99.
   481             20  SLASHB-2              PIC X VALUE '/'.
   482             20  DC-EDITB-CCYY.
   483                 24  DC-EDITB-CENT     PIC 99.
   484                 24  DC-EDITB-YEAR     PIC 99.
   485         16  DC-GREG-DATE-CYMD         PIC 9(08).
   486         16  DC-GREG-DATE-CYMD-R REDEFINES
   487                              DC-GREG-DATE-CYMD.
   488             20  DC-CYMD-CEN           PIC 99.
   489             20  DC-CYMD-YEAR          PIC 99.
   490             20  DC-CYMD-MONTH         PIC 99.
   491             20  DC-CYMD-DAY           PIC 99.
   492         16  DC-GREG-DATE-MDCY         PIC 9(08).
   493         16  DC-GREG-DATE-MDCY-R REDEFINES
   494                              DC-GREG-DATE-MDCY.
   495             20  DC-MDCY-MONTH         PIC 99.
   496             20  DC-MDCY-DAY           PIC 99.
   497             20  DC-MDCY-CEN           PIC 99.
   498             20  DC-MDCY-YEAR          PIC 99.
   499    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   500        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   501    12  DC-EL310-DATE                  PIC X(21).
   502    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  12
* ELRFND.cbl
   504*                        COPY ELCCALC.
   505******************************************************************
   506*                                                                *
   507*                           ELCCALC.                            *
   508*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   509*                            VMOD=2.025                          *
   510*                                                                *
   511*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   512*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   513*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   514*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   515*                                                                *
   516*  PASSED TO ELRTRM                                              *
   517*  -----------------                                             *
   518*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   519*  ORIGINAL TERM                                                 *
   520*  BEGINNING DATE                                                *
   521*  ENDING DATE                                                   *
   522*  COMPANY I.D.                                                  *
   523*  ACCOUNT MASTER USER FIELD                                     *
   524*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   525*  FREE LOOK DAYS                                                *
   526*                                                                *
   527*  RETURNED FROM ELRTRM                                          *
   528*  ---------------------                                         *
   529*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   530*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   531*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   532*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   533*----------------------------------------------------------------*
   534*  PASSED TO ELRAMT                                              *
   535*  ----------------                                              *
   536*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   537*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   538*  ORIGINAL AMOUNT                                               *
   539*  ALTERNATE BENEFIT (BALLON)                                    *
   540*  A.P.R. - NET PAY ONLY                                         *
   541*  METHOD
   542*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   543*  COMPANY I.D.                                                  *
   544*  BENEFIT TYPE                                                  *
   545*                                                                *
   546*  RETURNED FROM ELRAMT                                          *
   547*  --------------------                                          *
   548*  REMAINING AMOUNT 1 - CURRENT                                  *
   549*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   550*  REMAINING AMOUNT FACTOR
   551*----------------------------------------------------------------*
   552*  PASSED TO ELRESV                                              *
   553*  -----------------                                             *
   554*  CERTIFICATE EFFECTIVE DATE                                    *
   555*  VALUATION DATE                                                *
   556*  PAID THRU DATE                                                *
   557*  BENEFIT                                                       *
   558*  INCURRED DATE                                                 *
   559*  REPORTED DATE                                                 *
   560*  ISSUE AGE                                                     *
   561*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  13
* ELRFND.cbl
   562*  CDT PERCENT                                                   *
   563*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   564* *CLAIM TYPE (LIFE, A/H)                                        *
   565* *REMAINING BENEFIT (FROM ELRAMT)                               *
   566* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   567*                                                                *
   568*  RETURNED FROM ELRESV                                          *
   569*  --------------------                                          *
   570*  CDT TABLE USED                                                *
   571*  CDT FACTOR USED                                               *
   572*  PAY TO CURRENT RESERVE                                        *
   573*  I.B.N.R. - A/H ONLY                                           *
   574*  FUTURE (ACCRUED) AH ONLY                                      *
   575*----------------------------------------------------------------*
   576*  PASSED TO ELRATE                                              *
   577*  ----------------                                              *
   578*  CERT ISSUE DATE                                               *
   579*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   580*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   581*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   582*  STATE CODE (CLIENT DEFINED)                                   *
   583*  STATE CODE (STANDARD P.O. ABBRV)                              *
   584*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   585*  DEVIATION CODE                                                *
   586*  ISSUE AGE                                                     *
   587*  ORIGINAL BENEFIT AMOUNT                                       *
   588*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   589*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   590*  BENEFIT KIND (LIFE OR A/H)                                    *
   591*  A.P.R.                                                        *
   592*  METHOD
   593*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   594*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   595*  COMPANY I.D. (3 CHARACTER)                                    *
   596*  BENEFIT CODE                                                  *
   597*  BENEFIT OVERRIDE CODE                                         *
   598*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   599*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   600*  JOINT INDICATOR (CSL ONLY)                                    *
   601*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   602*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   603*                                                                *
   604*  RETURNED FROM ELRATE                                          *
   605*  --------------------                                          *
   606*  CALCULATED PREMIUM                                            *
   607*  PREMIUM RATE                                                  *
   608*  MORTALITY CODE                                                *
   609*  MAX ATTAINED AGE                                              *
   610*  MAX AGE                                                       *
   611*  MAX TERM                                                      *
   612*  MAX MONTHLY BENEFIT                                           *
   613*  MAX TOTAL BENIFIT                                             *
   614*  COMPOSITE RATE (OPEN-END ONLY)                                *
   615*----------------------------------------------------------------*
   616*  PASSED TO ELRFND                                              *
   617*  ----------------                                              *
   618*  CERT ISSUE DATE                                               *
   619*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  14
* ELRFND.cbl
   620*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   621*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   622*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   623*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   624*  STATE CODE (CLIENT DEFINED)                                   *
   625*  STATE CODE (STANDARD P.O. ABBRV)                              *
   626*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   627*  DEVIATION CODE                                                *
   628*  ISSUE AGE                                                     *
   629*  ORIGINAL BENEFIT AMOUNT                                       *
   630*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   631*  PROCESS TYPE (CANCEL)                                         *
   632*  BENEFIT KIND (LIFE OR A/H)                                    *
   633*  A.P.R.                                                        *
   634*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   635*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   636*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   637*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   638*  COMPANY I.D. (3 CHARACTER)                                    *
   639*  BENEFIT CODE                                                  *
   640*  BENEFIT OVERRIDE CODE                                         *
   641*                                                                *
   642*  RETURNED FROM ELRFND                                          *
   643*  --------------------                                          *
   644*  CALCULATED REFUND                                             *
   645*----------------------------------------------------------------*
   646*  PASSED TO ELEARN                                              *
   647*  ----------------                                              *
   648*  CERT ISSUE DATE                                               *
   649*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   650*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   651*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   652*  STATE CODE (CLIENT DEFINED)                                   *
   653*  STATE CODE (STANDARD P.O. ABBRV)                              *
   654*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   655*  DEVIATION CODE                                                *
   656*  ISSUE AGE                                                     *
   657*  ORIGINAL BENEFIT AMOUNT                                       *
   658*  BENEFIT KIND (LIFE OR A/H)                                    *
   659*  A.P.R.                                                        *
   660*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   661*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   662*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   663*  COMPANY I.D. (3 CHARACTER)                                    *
   664*  BENEFIT CODE                                                  *
   665*  BENEFIT OVERRIDE CODE                                         *
   666*                                                                *
   667*  RETURNED FROM ELEARN                                          *
   668*  --------------------                                          *
   669*  INDICATED  EARNINGS                                           *
   670*----------------------------------------------------------------*
   671*                 LENGTH = 450                                   *
   672*                                                                *
   673******************************************************************
   674******************************************************************
   675*                   C H A N G E   L O G
   676*
   677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  15
* ELRFND.cbl
   678*-----------------------------------------------------------------
   679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   680* EFFECTIVE    NUMBER
   681*-----------------------------------------------------------------
   682* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   683* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   684* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   685* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   686* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   687* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   688* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   689* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   690* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   691* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   692* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   693******************************************************************
   694
   695 01  CALCULATION-PASS-AREA.
   696     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   697                                     COMP.
   698
   699     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   700       88  NO-CP-ERROR                             VALUE ZERO.
   701       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   702                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   703       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   704       88  CP-ERROR-IN-DATES                       VALUE '2'.
   705       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   706       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   707       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   708       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   709       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   710       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   711       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   712       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   713       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   714       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   715       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   716       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   717       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   718       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   719       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   720
   721     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   722       88  NO-CP-ERROR-2                           VALUE ZERO.
   723***********************  INPUT AREAS ****************************
   724
   725     12  CP-CALCULATION-AREA.
   726         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   727         16  CP-CERT-EFF-DT        PIC XX.
   728         16  CP-VALUATION-DT       PIC XX.
   729         16  CP-PAID-THRU-DT       PIC XX.
   730         16  CP-BENEFIT-TYPE       PIC X.
   731           88  CP-AH                               VALUE 'A' 'D'
   732                                                   'I' 'U'.
   733           88  CP-REDUCING-LIFE                    VALUE 'R'.
   734           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   735         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  16
* ELRFND.cbl
   736         16  CP-REPORTED-DT        PIC XX.
   737         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   738         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   739         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   740                                     COMP-3.
   741         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   742                                     COMP-3.
   743         16  CP-CDT-METHOD         PIC X.
   744           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   745           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   746           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   747         16  CP-CLAIM-TYPE         PIC X.
   748           88  CP-AH-CLAIM                         VALUE 'A'.
   749           88  CP-LIFE-CLAIM                       VALUE 'L'.
   750         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   751                                     COMP-3.
   752         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   753                                     COMP-3.
   754         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   755                                     COMP-3.
   756         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   757                                     COMP-3.
   758         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   759                                     COMP-3.
   760         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   761                                     COMP-3.
   762         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   763                                     COMP-3.
   764         16  CP-REM-TERM-METHOD    PIC X.
   765           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   766           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   767           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   768           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   769           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   770           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   771           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   772         16  CP-EARNING-METHOD     PIC X.
   773           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   774           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   775           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   776           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   777           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   778           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   779           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   780           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   781           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   782           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   783           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   784           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   785           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   786           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   787         16  CP-PROCESS-TYPE       PIC X.
   788           88  CP-CLAIM                            VALUE '1'.
   789           88  CP-CANCEL                           VALUE '2'.
   790           88  CP-ISSUE                            VALUE '3'.
   791         16  CP-SPECIAL-CALC-CD    PIC X.
   792           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   793           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  17
* ELRFND.cbl
   794           88  CP-0-MTH-INTEREST               VALUE 'A'.
   795           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   796           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   797           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   798           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   799           88  CP-FARM-PLAN                    VALUE 'F'.
   800           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   801           88  CP-2-MTH-INTEREST               VALUE 'I'.
   802           88  CP-3-MTH-INTEREST               VALUE 'J'.
   803           88  CP-4-MTH-INTEREST               VALUE 'K'.
   804           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   805           88  CP-MORTGAGE-REC                 VALUE 'M'.
   806           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   807           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   808           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   809           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   810                                                     'W' 'X'.
   811           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   812           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   813           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   814           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   815           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   816           88  CP-SUMMARY-REC                  VALUE 'Z'.
   817           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   818           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   819           88  CP-AD-D-BENEFIT                 VALUE '4'.
   820           88  CP-CSL-METH-1                   VALUE '5'.
   821           88  CP-CSL-METH-2                   VALUE '6'.
   822           88  CP-CSL-METH-3                   VALUE '7'.
   823           88  CP-CSL-METH-4                   VALUE '8'.
   824
   825         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   826                                     COMP-3.
   827         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   828         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   829         16  CP-STATE              PIC XX          VALUE SPACE.
   830         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   831         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   832           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   833               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   834         16  CP-R78-OPTION         PIC X.
   835           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   836           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   837
   838         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   839         16  CP-IBNR-RESERVE-SW    PIC X.
   840         16  CP-CLAIM-STATUS       PIC X.
   841         16  CP-RATE-FILE          PIC X.
   842         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   843                                     COMP-3.
   844
   845         16  CP-LIFE-OVERRIDE-CODE PIC X.
   846         16  CP-AH-OVERRIDE-CODE   PIC X.
   847
   848         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   849                                     COMP-3.
   850         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   851                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  18
* ELRFND.cbl
   852         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   853                                     COMP-3.
   854         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   855                                     COMP-3.
   856         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   857                                     COMP-3.
   858         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   859                                  PIC S9(7)V99 COMP-3.
   860
   861         16  CP-PAID-FROM-DATE     PIC X(02).
   862         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   863         16  CP-EXT-DAYS-CALC      PIC X.
   864           88  CP-EXT-NO-CHG                   VALUE ' '.
   865           88  CP-EXT-CHG-LF                   VALUE '1'.
   866           88  CP-EXT-CHG-AH                   VALUE '2'.
   867           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   868         16  CP-DOMICILE-STATE     PIC XX.
   869         16  CP-CARRIER            PIC X.
   870         16  CP-REIN-FLAG          PIC X.
   871         16  CP-REM-TRM-CALC-OPTION PIC X.
   872           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   873                      '2' '3' '4' '5'.
   874           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   875           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   876           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   877           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   878           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   879           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   880           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   881           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   882         16  CP-SIG-SWITCH         PIC X.
   883         16  CP-RATING-METHOD      PIC X.
   884           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   885           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   886           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   887           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   888           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   889           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   890           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   891           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   892           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   893         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   894                                     COMP-3.
   895         16  CP-BEN-CATEGORY       PIC X.
   896         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   897         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   898                                   PIC S99V9(5) COMP-3.
   899         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   900         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   901                                   PIC S99V9(5) COMP-3.
   902         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   903         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   904         16  CP-EXPIRE-DT          PIC XX.
   905         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   906         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   907         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   908         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   909         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  19
* ELRFND.cbl
   910             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   911             88  CP-CALC-CLP              VALUE 'C'.
   912         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   913         16  CP-CANCEL-REASON      PIC X.
   914         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   915         16  CP-PMT-MODE           PIC X.
   916         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   917         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   918         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   919         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   920         16  FILLER                PIC X.
   921
   922***************    OUTPUT FROM ELRESV   ************************
   923
   924         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   925
   926         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   927                                     COMP-3.
   928         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   929                                     COMP-3.
   930         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   931                                     COMP-3.
   932         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   933                                     COMP-3.
   934         16  FILLER                PIC X(09).
   935***************    OUTPUT FROM ELRTRM   *************************
   936
   937         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   938                                     COMP-3.
   939         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   940                                     COMP-3.
   941         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   942                                     COMP-3.
   943         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   944                                     COMP-3.
   945         16  FILLER                PIC X(12).
   946
   947***************    OUTPUT FROM ELRAMT   *************************
   948
   949         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   950                                     COMP-3.
   951         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   952                                     COMP-3.
   953         16  FILLER                PIC X(12).
   954
   955***************    OUTPUT FROM ELRATE   *************************
   956
   957         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   958                                     COMP-3.
   959         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   960                                     COMP-3.
   961         16  CP-MORTALITY-CODE     PIC X(4).
   962         16  CP-RATE-EDIT-FLAG     PIC X.
   963             88  CP-RATES-NEED-APR                  VALUE '1'.
   964         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   965                                     COMP-3.
   966         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   967         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  20
* ELRFND.cbl
   968         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   969                                   PIC S9(7)V99 COMP-3.
   970         16  FILLER                PIC X(07).
   971
   972***************    OUTPUT FROM ELRFND   *************************
   973
   974         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   975                                     COMP-3.
   976         16  CP-REFUND-TYPE-USED   PIC X.
   977           88  CP-R-AS-R78                         VALUE '1'.
   978           88  CP-R-AS-PRORATA                     VALUE '2'.
   979           88  CP-R-AS-CALIF                       VALUE '3'.
   980           88  CP-R-AS-TEXAS                       VALUE '4'.
   981           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   982           88  CP-R-AS-NET-PAY                     VALUE '5'.
   983           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   984           88  CP-R-AS-MEAN                        VALUE '8'.
   985           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   986           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   987           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   988           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   989           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   990           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   991         16  FILLER                PIC X(12).
   992
   993***************    OUTPUT FROM ELEARN   *************************
   994
   995         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   996                                     COMP-3.
   997         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1000                                     COMP-3.
  1001         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1002                                     COMP-3.
  1003         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-EARNING-TYPE-USED  PIC X.
  1008           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1009           88  CP-E-AS-R78                         VALUE '1'.
  1010           88  CP-E-AS-PRORATA                     VALUE '2'.
  1011           88  CP-E-AS-TEXAS                       VALUE '4'.
  1012           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1013           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1014           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1015           88  CP-E-AS-MEAN                        VALUE '8'.
  1016           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1017         16  FILLER                PIC X(12).
  1018
  1019***************    OUTPUT FROM ELPMNT   *************************
  1020
  1021         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1022                                     COMP-3.
  1023         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1024                                     COMP-3.
  1025         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  21
* ELRFND.cbl
  1026
  1027***************   MISC WORK AREAS    *****************************
  1028         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1029                                     COMP-3.
  1030         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1031                                     COMP-3.
  1032         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1033                                     COMP-3.
  1034         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1035                                     COMP-3.
  1036         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1037                                     COMP-3.
  1038         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1039                                     COMP-3.
  1040         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1041             88  OPEN-RATE-FILE                   VALUE 'O'.
  1042             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1043             88  IO-ERROR                         VALUE 'E'.
  1044
  1045         16  CP-FIRST-PAY-DATE     PIC XX.
  1046
  1047         16  CP-JOINT-INDICATOR    PIC X.
  1048
  1049         16  CP-RESERVE-REMAINING-TERM
  1050                                   PIC S9(4)V9    VALUE ZERO
  1051                                     COMP-3.
  1052
  1053         16  CP-INSURED-BIRTH-DT   PIC XX.
  1054
  1055         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1056                                     COMP-3.
  1057
  1058         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1059                                     COMP-3.
  1060
  1061         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1062                                     COMP-3.
  1063
  1064         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1065                                     COMP-3.
  1066
  1067         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1068                                     COMP-3.
  1069
  1070         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1071                                     COMP-3.
  1072
  1073         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1074                                     COMP-3.
  1075
  1076         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1077             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1078
  1079         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1080                                     COMP-3.
  1081         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1082                                     COMP-3.
  1083         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  22
* ELRFND.cbl
  1084         16  cp-extra-periods      pic 9 value zeros.
  1085         16  cp-net-only-state     pic x value spaces.
  1086         16  FILLER                PIC X(13).
  1087******************************************************************
  1088
  1089
  1090****************************************************************
  1091*
  1092* Copyright (c) 2007-2013 Dell Inc.
  1093* All rights reserved.
  1094*
  1095****************************************************************
  1096 01  DFHEIV.
  1097   02  DFHEIV0               PIC X(35).
  1098   02  DFHEIV1               PIC X(08).
  1099   02  DFHEIV2               PIC X(08).
  1100   02  DFHEIV3               PIC X(08).
  1101   02  DFHEIV4               PIC X(06).
  1102   02  DFHEIV5               PIC X(04).
  1103   02  DFHEIV6               PIC X(04).
  1104   02  DFHEIV7               PIC X(02).
  1105   02  DFHEIV8               PIC X(02).
  1106   02  DFHEIV9               PIC X(01).
  1107   02  DFHEIV10              PIC S9(7) COMP-3.
  1108   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1109   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1110   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1111   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1112   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1113   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1114   02  DFHEIV17              PIC X(04).
  1115   02  DFHEIV18              PIC X(04).
  1116   02  DFHEIV19              PIC X(04).
  1117   02  DFHEIV20              USAGE IS POINTER.
  1118   02  DFHEIV21              USAGE IS POINTER.
  1119   02  DFHEIV22              USAGE IS POINTER.
  1120   02  DFHEIV23              USAGE IS POINTER.
  1121   02  DFHEIV24              USAGE IS POINTER.
  1122   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1123   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1124   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1125   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1126   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1127   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1128   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1129   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1130   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1131   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1132   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1133   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1134   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1135   02  FILLER                PIC X(02).
  1136   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1137   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1138   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1139   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1140   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1141   02  DFHEIVL4              PIC X(255) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  23
* ELRFND.cbl
  1142   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1143 LINKAGE  SECTION.
  1144*****************************************************************
  1145*                                                               *
  1146* Copyright (c) 2007-2013 Dell Inc.                             *
  1147* All rights reserved.                                          *
  1148*                                                               *
  1149*****************************************************************
  1150 01  dfheiblk.
  1151     02  eibtime          pic s9(7) comp-3.
  1152     02  eibdate          pic s9(7) comp-3.
  1153     02  eibtrnid         pic x(4).
  1154     02  eibtaskn         pic s9(7) comp-3.
  1155     02  eibtrmid         pic x(4).
  1156     02  dfheigdi         pic s9(4) comp.
  1157     02  eibcposn         pic s9(4) comp.
  1158     02  eibcalen         pic s9(4) comp.
  1159     02  eibaid           pic x(1).
  1160     02  eibfiller1       pic x(1).
  1161     02  eibfn            pic x(2).
  1162     02  eibfiller2       pic x(2).
  1163     02  eibrcode         pic x(6).
  1164     02  eibfiller3       pic x(2).
  1165     02  eibds            pic x(8).
  1166     02  eibreqid         pic x(8).
  1167     02  eibrsrce         pic x(8).
  1168     02  eibsync          pic x(1).
  1169     02  eibfree          pic x(1).
  1170     02  eibrecv          pic x(1).
  1171     02  eibsend          pic x(1).
  1172     02  eibatt           pic x(1).
  1173     02  eibeoc           pic x(1).
  1174     02  eibfmh           pic x(1).
  1175     02  eibcompl         pic x(1).
  1176     02  eibsig           pic x(1).
  1177     02  eibconf          pic x(1).
  1178     02  eiberr           pic x(1).
  1179     02  eibrldbk         pic x(1).
  1180     02  eiberrcd         pic x(4).
  1181     02  eibsynrb         pic x(1).
  1182     02  eibnodat         pic x(1).
  1183     02  eibfiller5       pic x(2).
  1184     02  eibresp          pic s9(8) comp.
  1185     02  eibresp2         pic s9(8) comp.
  1186     02  dfheigdj         pic s9(4) comp.
  1187     02  dfheigdk         pic s9(4) comp.
  1188 01  DFHCOMMAREA                PIC X(450).
  1189
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  24
* ELRFND.cbl
  1191 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1192 0000-DFHEXIT SECTION.
  1193     MOVE '9#                    $   ' TO DFHEIV0.
  1194     MOVE 'ELRFND' TO DFHEIV1.
  1195     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1196     MOVE DFHCOMMAREA    TO  CALCULATION-PASS-AREA.
  1197
  1198 000-START-REFUND-CALC.
  1199*                      COPY ELCRFNDP.
  1200****************************************************************
  1201*                                                              *
  1202*                            ELCRFNDP.                         *
  1203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1204*                            VMOD=2.028                        *
  1205*                                                              *
  1206****************************************************************.
  1207*                   C H A N G E   L O G
  1208*
  1209* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1210*-----------------------------------------------------------------
  1211*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1212* EFFECTIVE    NUMBER
  1213*-----------------------------------------------------------------
  1214* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1215* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1216* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1217* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1218* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1219* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1220* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1221* 032612  CR2011110200001  PEMA AHL CHANGES
  1222* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  1223* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1224* 011317  IR2017011000002  PEMA  REMOVE 'CT' HARDCODING
  1225******************************************************************
  1226
  1227     MOVE ZERO                   TO  CP-RETURN-CODE
  1228                                     CP-CALC-REFUND.
  1229     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1230
  1231 0001-GET-CANCEL-TYPE.
  1232     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1233        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1234        GO TO 1999-CALC-REF-AMT-X.
  1235
  1236     IF CP-CANCEL-REASON = 'R'
  1237        IF CP-CALC-CLP
  1238           MOVE CP-ORIGINAL-PREMIUM
  1239                                 TO CP-CALC-REFUND
  1240        ELSE
  1241           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1242              CP-DDF-ADMIN-FEES
  1243        END-IF
  1244        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1245        GO TO 1999-CALC-REF-AMT-X
  1246     END-IF
  1247     IF CP-REMAINING-TERM = ZERO   OR
  1248        CP-REMAINING-TERM NEGATIVE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  25
* ELRFND.cbl
  1249          MOVE ZERO TO CP-CALC-REFUND
  1250          GO TO 1999-CALC-REF-AMT-X.
  1251
  1252     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1253     MOVE SPACE              TO DC-OPTION-CODE.
  1254     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1255
  1256     IF DATE-CONVERSION-ERROR
  1257         MOVE '2' TO CP-RETURN-CODE
  1258         GO TO 1999-CALC-REF-AMT-X.
  1259
  1260     IF CP-AH
  1261        GO TO 1030-GET-AH-REFUND.
  1262
  1263********************    LIFE REFUNDS    **************************
  1264
  1265     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1266         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1267
  1268     IF CP-LOAN-TERM NOT NUMERIC
  1269         MOVE +0                TO CP-LOAN-TERM.
  1270
  1271     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1272
  1273     COMPUTE R78-FACTOR =
  1274            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1275              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1276************************************************************
  1277***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1278***---------------------------------------------------------
  1279     IF CP-TRUNCATED-LIFE
  1280        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1281     ELSE
  1282        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1283***
  1284************************************************************
  1285**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1286**** FOLLOWING.
  1287****       FOR NC. LIFE..
  1288****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1289****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1290****                             TERM <= 60 USE SUM OF DIGITS.
  1291****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1292****                             TERM > 60 USE RULE OF ANTIC
  1293****                             OTHERWISE USE RULE OF 78.
  1294****
  1295****
  1296
  1297     IF (CP-COMPANY-ID = 'NCL') AND
  1298        (CP-STATE-STD-ABBRV = 'NC')
  1299        IF CP-LEVEL-LIFE
  1300           GO TO 1023-REF-PR
  1301        ELSE
  1302        IF CP-EARN-AS-NET-PAY AND
  1303           CP-TRUNCATED-LIFE
  1304           IF CP-ORIGINAL-TERM GREATER THAN 60
  1305              GO TO 1021-ANTICIPATION-REF
  1306           ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  26
* ELRFND.cbl
  1307              GO TO 1026-REF-R78
  1308        ELSE
  1309        IF CP-REDUCING-LIFE
  1310           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1311              CP-ORIGINAL-TERM GREATER THAN 60)
  1312              GO TO 1021-ANTICIPATION-REF
  1313           ELSE
  1314              GO TO 1075-SUM-OF-DIGITS.
  1315
  1316****
  1317**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1318**** FOLLOWING.
  1319****       FOR OH. LIFE..
  1320****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1321****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1322****  GROSS DECREASING       --- RULE OF 78
  1323****
  1324****
  1325
  1326     IF (CP-COMPANY-ID = 'CID') AND
  1327        (CP-STATE-STD-ABBRV = 'OH') AND
  1328        (CP-CLASS-CODE NOT = 'L ')
  1329        IF CP-LEVEL-LIFE
  1330           GO TO 1023-REF-PR
  1331        ELSE
  1332           IF (CP-ORIGINAL-TERM > 60) OR
  1333              (CP-EARN-AS-NET-PAY)
  1334              GO TO 1028-NET-PAY-REFUND
  1335           ELSE
  1336              GO TO 1026-REF-R78
  1337           END-IF
  1338        END-IF
  1339     END-IF
  1340
  1341**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1342**** FOLLOWING.
  1343****       FOR VA. LIFE..
  1344****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1345****           NET COVERAGES --- USE RULE OF ANTIC.
  1346****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1347****                         --- EFF DATE > 123194 USE ANTIC.
  1348****                         --- EFF DATE BETWEEN 010193 AND 12319
  1349****                             WITH TERM > 61 USE RULE OF ANTIC
  1350****                             OTHERWISE USE RULE OF 78.
  1351****
  1352****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1353****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1354****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1355****            WILL FOLLOW.
  1356****
  1357****
  1358****
  1359
  1360     IF (CP-COMPANY-ID = 'NCL') AND
  1361        (CP-STATE-STD-ABBRV = 'VA')
  1362        IF CP-LEVEL-LIFE
  1363           GO TO 1023-REF-PR
  1364        ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  27
* ELRFND.cbl
  1365        IF CP-EARN-AS-NET-PAY
  1366           GO TO 1021-ANTICIPATION-REF
  1367        ELSE
  1368        IF CP-REDUCING-LIFE
  1369           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1370              GO TO 1026-REF-R78
  1371           ELSE
  1372           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1373              GO TO 1021-ANTICIPATION-REF
  1374           ELSE
  1375           IF CP-ORIGINAL-TERM GREATER THAN 61
  1376              GO TO 1021-ANTICIPATION-REF
  1377           ELSE
  1378              GO TO 1026-REF-R78.
  1379
  1380     IF (CP-COMPANY-ID = 'CID')
  1381        AND (CP-STATE-STD-ABBRV = 'IN')
  1382        AND (DC-GREG-DATE-CYMD < 20030401)
  1383        IF CP-REDUCING-LIFE
  1384           GO TO 1026-REF-R78
  1385        ELSE
  1386           IF CP-LEVEL-LIFE
  1387              GO TO 1023-REF-PR
  1388           END-IF
  1389        END-IF
  1390     END-IF
  1391
  1392     IF (CP-COMPANY-ID = 'CID')
  1393        AND (CP-STATE-STD-ABBRV = 'FL')
  1394        AND (DC-GREG-DATE-CYMD > 20030630)
  1395        IF CP-RATE-AS-NET-PAY
  1396           GO TO 1028-NET-PAY-REFUND
  1397        END-IF
  1398     END-IF
  1399
  1400     IF (CP-COMPANY-ID = 'CID')
  1401        AND (CP-STATE-STD-ABBRV = 'MN')
  1402        AND (CP-EARN-AS-NET-PAY)
  1403        AND (CP-RATE-AS-REG-BALLOON)
  1404        AND (DC-GREG-DATE-CYMD > 20091231)
  1405        GO TO 1028-NET-PAY-REFUND
  1406     END-IF
  1407     IF (CP-COMPANY-ID = 'CID')
  1408        AND (CP-STATE-STD-ABBRV = 'MN')
  1409        AND (DC-GREG-DATE-CYMD > 20091231)
  1410        AND (CP-RATE-AS-NET-PAY)
  1411        GO TO 1021-ANTICIPATION-REF
  1412     END-IF
  1413     IF (CP-COMPANY-ID = 'CID')
  1414        AND (CP-STATE-STD-ABBRV = 'MO')
  1415        AND (DC-GREG-DATE-CYMD > 20030630)
  1416        AND (CP-LOAN-TERM < +121)
  1417        IF CP-RATE-AS-NET-PAY
  1418           GO TO 1028-NET-PAY-REFUND
  1419        END-IF
  1420     END-IF
  1421
  1422     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  28
* ELRFND.cbl
  1423        AND (CP-STATE-STD-ABBRV = 'ND')
  1424        AND (DC-GREG-DATE-CYMD > 20011231)
  1425        AND (CP-REDUCING-LIFE)
  1426        GO TO 1021-ANTICIPATION-REF
  1427     END-IF
  1428
  1429     IF CP-CRITICAL-PERIOD
  1430        IF CP-COMPANY-ID = 'NCL'
  1431           NEXT SENTENCE
  1432        ELSE
  1433           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1434
  1435     IF CP-TERM-IS-DAYS  AND
  1436        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1437         GO TO 1024-REF-PR-DAYS.
  1438
  1439     IF CP-STATE-STD-ABBRV = 'NM'
  1440       IF CP-REDUCING-LIFE
  1441*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1442         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1443             GO TO 1026-REF-R78.
  1444
  1445     IF CP-EARN-ANTICIPATION
  1446         GO TO 1021-ANTICIPATION-REF.
  1447
  1448     IF CP-STATE-STD-ABBRV = 'ME'
  1449         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1450            NEXT SENTENCE
  1451         ELSE
  1452            IF CP-REDUCING-LIFE
  1453               GO TO 1021-ANTICIPATION-REF.
  1454
  1455     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1456        IF CP-STATE-STD-ABBRV = 'TX'
  1457            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1458        END-IF
  1459     END-IF.
  1460
  1461     IF CP-STATE-STD-ABBRV = 'TX'
  1462       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1463          NEXT SENTENCE
  1464       END-IF
  1465        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1466           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1467           GO TO 1021-ANTICIPATION-REF.
  1468
  1469 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1470
  1471     IF CP-EARN-BY-PRORATA
  1472         GO TO 1023-REF-PR.
  1473
  1474     IF CP-EARN-AS-MEAN
  1475         GO TO 1025-REF-MEAN.
  1476
  1477     IF CP-EARN-AS-TEXAS
  1478         GO TO 1027-TEXAS-REFUND.
  1479
  1480     IF CP-EARN-AS-NET-PAY
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  29
* ELRFND.cbl
  1481         GO TO 1028-NET-PAY-REFUND.
  1482
  1483     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1484         GO TO 1000-NO-NET-PAY.
  1485
  1486     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1487       IF CP-STATE-STD-ABBRV = 'NC'
  1488         IF CP-REDUCING-LIFE
  1489           IF CP-ORIGINAL-TERM GREATER 60  AND
  1490              DC-GREG-DATE-CYMD GREATER 19810930
  1491                GO TO 1028-NET-PAY-REFUND
  1492           ELSE
  1493              GO TO 1026-REF-R78.
  1494
  1495
  1496     IF CP-STATE-STD-ABBRV = 'NC'
  1497       IF CP-COMPANY-ID EQUAL 'NCL'
  1498          NEXT SENTENCE
  1499       END-IF
  1500       IF CP-REDUCING-LIFE
  1501         IF CP-ORIGINAL-TERM GREATER 60  AND
  1502            DC-GREG-DATE-CYMD GREATER 19810930
  1503             GO TO 1021-ANTICIPATION-REF
  1504         ELSE
  1505             GO TO 1026-REF-R78.
  1506
  1507     IF CP-STATE-STD-ABBRV = 'UT'
  1508       IF CP-COMPANY-ID EQUAL 'NCL'
  1509          NEXT SENTENCE
  1510       END-IF
  1511         IF CP-ORIGINAL-TERM GREATER 62         AND
  1512            CP-LOAN-APR GREATER ZERO            AND
  1513            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1514            DC-GREG-DATE-CYMD LESS    19830901
  1515             GO TO 1028-NET-PAY-REFUND
  1516         ELSE
  1517             GO TO 1026-REF-R78.
  1518
  1519     IF CP-STATE-STD-ABBRV = 'OH'
  1520       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1521          NEXT SENTENCE
  1522       END-IF
  1523           IF CP-ORIGINAL-TERM GREATER 60         AND
  1524              CP-CLASS-CODE NOT = 'L '            AND
  1525              CP-LOAN-APR GREATER ZERO            AND
  1526              DC-GREG-DATE-CYMD GREATER 19831031
  1527              GO TO 1028-NET-PAY-REFUND
  1528           ELSE
  1529              GO TO 1026-REF-R78.
  1530
  1531     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1532       IF CP-STATE-STD-ABBRV = 'MT'
  1533         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1534
  1535
  1536     IF CP-STATE-STD-ABBRV = 'MT'
  1537       IF CP-COMPANY-ID EQUAL 'NCL'
  1538          NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  30
* ELRFND.cbl
  1539       END-IF
  1540         IF CP-ORIGINAL-TERM GREATER 61         AND
  1541            CP-LOAN-APR GREATER ZERO            AND
  1542            DC-GREG-DATE-CYMD GREATER 19830318
  1543             GO TO 1028-NET-PAY-REFUND
  1544         ELSE
  1545             GO TO 1026-REF-R78.
  1546
  1547 SKIP-CSO-MT-LF-PROCESSING.
  1548
  1549     IF CP-STATE-STD-ABBRV = 'RI'
  1550       IF CP-COMPANY-ID EQUAL 'NCL'
  1551          NEXT SENTENCE
  1552       END-IF
  1553         IF CP-ORIGINAL-TERM GREATER 60         AND
  1554            CP-LOAN-APR GREATER ZERO            AND
  1555            DC-GREG-DATE-CYMD GREATER 19831231
  1556             GO TO 1028-NET-PAY-REFUND
  1557         ELSE
  1558             GO TO 1026-REF-R78.
  1559
  1560
  1561 1000-NO-NET-PAY.
  1562
  1563     IF CP-STATE-STD-ABBRV = 'WY'
  1564       IF CP-COMPANY-ID EQUAL 'NCL'
  1565          NEXT SENTENCE
  1566       END-IF
  1567        IF CP-COMPANY-ID = 'TMS'
  1568           GO TO 1026-REF-R78
  1569        ELSE
  1570           GO TO 1023-REF-PR.
  1571
  1572     IF CP-EARN-BY-R78
  1573         GO TO 1026-REF-R78.
  1574
  1575     IF CP-EARN-AS-SUM-OF-DIGITS
  1576         GO TO 1075-SUM-OF-DIGITS.
  1577
  1578     IF CP-LEVEL-LIFE
  1579         GO TO 1023-REF-PR
  1580     ELSE
  1581         GO TO 1026-REF-R78.
  1582
  1583*-----------------------------------------------------------------
  1584 1021-ANTICIPATION-REF.
  1585     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1586
  1587     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1588     IF CP-LOAN-TERM = ZEROS
  1589        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1590     END-IF
  1591     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1592                            CP-REMAINING-TERM.
  1593
  1594     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1595     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1596     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  31
* ELRFND.cbl
  1597     move cp-term-or-ext-days  to ws-save-ext-days
  1598
  1599     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1600     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1601     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1602
  1603     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1604         MOVE 'N'              TO CP-ROA-REFUND
  1605     ELSE
  1606         MOVE 'Y'              TO CP-ROA-REFUND.
  1607
  1608******    TO COMPUTE PREMIUM AT REFUND DATE
  1609     PERFORM 2500-GET-RATE.
  1610
  1611     MOVE 'N'                  TO CP-ROA-REFUND.
  1612     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1613     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1614     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1615     move ws-save-ext-days     to cp-term-or-ext-days
  1616
  1617     IF CP-PREMIUM-RATE = ZEROS
  1618        MOVE '7'                 TO CP-RETURN-CODE
  1619        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1620        GO TO 1999-CALC-REF-AMT-X.
  1621
  1622     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1623
  1624******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1625     PERFORM 2500-GET-RATE.
  1626
  1627     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1628
  1629     IF CP-PREMIUM-RATE = ZEROS
  1630        MOVE '7'            TO CP-RETURN-CODE
  1631        GO TO 1999-CALC-REF-AMT-X.
  1632
  1633     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1634
  1635     IF  WS-ORIG-PREM = ZEROS
  1636         MOVE ZEROS TO WS-NP-REF-FACTOR
  1637        ELSE
  1638         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1639                                            WS-ORIG-PREM.
  1640
  1641     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1642                                        CP-ORIGINAL-PREMIUM.
  1643
  1644     GO TO 1999-CALC-REF-AMT-X.
  1645
  1646*---------------------------------------------------------------
  1647 1022-REF-CRITICAL-PERIOD-LF.
  1648     GO TO 1023-REF-PR.
  1649
  1650*---------------------------------------------------------------
  1651 1023-REF-PR.
  1652     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1653     COMPUTE CP-CALC-REFUND ROUNDED =
  1654            CP-ORIGINAL-PREMIUM * PR-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  32
* ELRFND.cbl
  1655
  1656     GO TO 1999-CALC-REF-AMT-X.
  1657
  1658*---------------------------------------------------------------
  1659 1024-REF-PR-DAYS.
  1660     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1661     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1662     MOVE '1'                TO DC-OPTION-CODE.
  1663     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1664
  1665     IF DATE-CONVERSION-ERROR
  1666         MOVE '2' TO CP-RETURN-CODE
  1667         GO TO 1999-CALC-REF-AMT-X.
  1668
  1669     COMPUTE CP-CALC-REFUND ROUNDED =
  1670         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1671                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1672
  1673     GO TO 1999-CALC-REF-AMT-X.
  1674
  1675*---------------------------------------------------------------
  1676 1025-REF-MEAN.
  1677     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1678     COMPUTE CP-CALC-REFUND ROUNDED =
  1679          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1680           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1681
  1682     GO TO 1999-CALC-REF-AMT-X.
  1683
  1684*---------------------------------------------------------------
  1685 1026-REF-R78.
  1686     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1687*    IF CP-TERM-TIMES-TERM
  1688*        COMPUTE R78-FACTOR =
  1689*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1690*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1691*
  1692     COMPUTE CP-CALC-REFUND ROUNDED =
  1693        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1694
  1695     GO TO 1999-CALC-REF-AMT-X.
  1696
  1697*---------------------------------------------------------------
  1698 1027-TEXAS-REFUND.
  1699     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1700     IF CP-PAY-FREQUENCY = ZERO
  1701        MOVE ZERO TO CP-CALC-REFUND
  1702        MOVE '5'  TO CP-RETURN-CODE
  1703        GO TO 1999-CALC-REF-AMT-X.
  1704
  1705     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1706         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1707
  1708     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1709         GIVING TEX-FACT-5
  1710             REMAINDER TEX-FACT-6.
  1711
  1712     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  33
* ELRFND.cbl
  1713
  1714     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1715         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1716         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1717
  1718     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1719
  1720     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1721                                        * TEX-FACT-8.
  1722
  1723     GO TO 1999-CALC-REF-AMT-X.
  1724
  1725*---------------------------------------------------------------
  1726 1028-NET-PAY-REFUND.
  1727     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1728     IF CP-LOAN-APR = ZERO
  1729        move '1'                 to cp-refund-type-used
  1730        compute cp-calc-refund rounded =
  1731           cp-original-premium * r78-factor
  1732        go to 1999-calc-ref-amt-x
  1733     end-if
  1734*       MOVE ZERO TO CP-CALC-REFUND
  1735*       MOVE '1'  TO CP-RETURN-CODE
  1736*       GO TO 1999-CALC-REF-AMT-X.
  1737
  1738     MOVE CP-LOAN-APR           TO N-P-APR.
  1739     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1740     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1741
  1742     IF CP-TRUNCATED-LIFE
  1743        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1744
  1745     MOVE 'R'                   TO N-P-OPT.
  1746
  1747     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1748
  1749     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1750                                        CP-ORIGINAL-PREMIUM.
  1751
  1752 1029-UTAH-REFUND.
  1753*
  1754*---------------------------------------------------------------
  1755* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1756*---------------------------------------------------------------
  1757*
  1758     GO TO 1999-CALC-REF-AMT-X.
  1759*
  1760*---------------------------------------------------------------
  1761     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1762                      OR
  1763        (CP-COMPANY-ID EQUAL 'NCL')
  1764         GO TO 1999-CALC-REF-AMT-X.
  1765     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1766
  1767     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1768        GREATER ZERO AND LESS 13
  1769         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1770                 (CP-CALC-REFUND * .05).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  34
* ELRFND.cbl
  1771
  1772     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1773        GREATER 12 AND LESS 25
  1774         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1775                 (CP-CALC-REFUND * .025).
  1776
  1777     GO TO 1999-CALC-REF-AMT-X.
  1778*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  35
* ELRFND.cbl
  1780*---------------------------------------------------------------
  1781 1030-GET-AH-REFUND.
  1782     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1783
  1784     COMPUTE R78-FACTOR =
  1785            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1786                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1787
  1788*    IF CP-TERM-TIMES-TERM
  1789*        COMPUTE R78-FACTOR =
  1790*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1791*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1792*
  1793
  1794**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1795**** FOLLOWING.
  1796****       FOR VA. DISABILITY
  1797****                         --- EFF DATE > 123192 AND
  1798****                             TERM > 61 USE RULE OF ANTIC
  1799****                             OTHERWISE USE RULE OF 78.
  1800****
  1801****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1802****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1803****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1804****            WILL FOLLOW.
  1805****
  1806****
  1807****
  1808     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1809        IF CP-STATE-STD-ABBRV = 'VA'
  1810           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1811              (CP-ORIGINAL-TERM GREATER THAN 61)
  1812               MOVE '6'        TO CP-EARNING-METHOD
  1813               GO TO 1060-ANTICIPATION-REF
  1814            ELSE
  1815               MOVE '1'        TO CP-EARNING-METHOD
  1816               GO TO 1050-R78-REF.
  1817
  1818     IF CP-STATE-STD-ABBRV = 'WY'
  1819        IF CP-COMPANY-ID = 'TMS'
  1820           GO TO 1050-R78-REF.
  1821
  1822     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC'
  1823                     OR 'AHL' OR 'VPP'
  1824         NEXT SENTENCE
  1825     ELSE
  1826         IF CP-CRITICAL-PERIOD
  1827             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1828
  1829*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1830*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1831*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1832*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1833     IF (CP-GAP-NON-REFUNDABLE)
  1834        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1835           OR (CP-BENEFIT-CD = '55' OR '56')
  1836           MOVE ZEROS            TO CP-CALC-REFUND
  1837           MOVE 'G'              TO CP-REFUND-TYPE-USED
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  36
* ELRFND.cbl
  1838           GO TO 1999-CALC-REF-AMT-X
  1839        END-IF
  1840     END-IF
  1841     IF CP-GAP-ACTUARIAL
  1842         GO TO 1070-NET-PAY-REFUND
  1843     END-IF
  1844     IF (CP-COMPANY-ID = 'CID')
  1845        AND (CP-STATE-STD-ABBRV = 'MN')
  1846        AND (DC-GREG-DATE-CYMD > 20091231)
  1847        IF (CP-CRITICAL-PERIOD)
  1848           GO TO 1040-PR-REF
  1849        ELSE
  1850           GO TO 1055-MEAN-REF
  1851     END-IF
  1852     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'VPP'
  1853        IF CP-STATE-STD-ABBRV = 'NC'
  1854           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1855
  1856     IF (CP-COMPANY-ID = 'CID')
  1857        AND (CP-STATE-STD-ABBRV = 'IN')
  1858        AND (DC-GREG-DATE-CYMD < 20030401)
  1859        GO TO 1026-REF-R78
  1860     END-IF
  1861
  1862     IF (CP-COMPANY-ID = 'CID')
  1863        AND (CP-STATE-STD-ABBRV = 'FL')
  1864        AND (DC-GREG-DATE-CYMD > 20030630)
  1865        AND (CP-CRITICAL-PERIOD)
  1866        GO TO 1040-PR-REF
  1867     END-IF
  1868
  1869     IF (CP-COMPANY-ID = 'CID')
  1870        AND (CP-STATE-STD-ABBRV = 'MO')
  1871        AND (DC-GREG-DATE-CYMD > 20030630)
  1872        AND (CP-CRITICAL-PERIOD)
  1873        GO TO 1040-PR-REF
  1874     END-IF
  1875
  1876     IF (CP-COMPANY-ID = 'CID')
  1877        AND (CP-STATE-STD-ABBRV = 'ND')
  1878        AND (CP-CRITICAL-PERIOD)
  1879        AND (DC-GREG-DATE-CYMD > 20011231)
  1880        GO TO 1040-PR-REF
  1881     END-IF
  1882
  1883     IF (CP-COMPANY-ID = 'CID')
  1884        AND (CP-STATE-STD-ABBRV = 'ND')
  1885        AND (DC-GREG-DATE-CYMD > 20011231)
  1886        GO TO 1060-ANTICIPATION-REF
  1887     END-IF
  1888
  1889     IF CP-STATE-STD-ABBRV = 'NC'
  1890       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1891          NEXT SENTENCE
  1892       END-IF
  1893         IF DC-GREG-DATE-CYMD GREATER 19810930
  1894            IF CP-EARN-ANTICIPATION
  1895                GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  37
* ELRFND.cbl
  1896            ELSE
  1897                GO TO 1055-MEAN-REF.
  1898
  1899 SKIP-CSO-NC-AH-PROCESSING.
  1900
  1901     IF CP-STATE-STD-ABBRV = 'NM'
  1902       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL' OR 'VPP'
  1903          NEXT SENTENCE
  1904       END-IF
  1905         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1906            IF CP-COMPANY-ID = 'MON'
  1907              MOVE '6'             TO CP-EARNING-METHOD
  1908              GO TO 1060-ANTICIPATION-REF
  1909             ELSE
  1910              GO TO 1055-MEAN-REF.
  1911
  1912*    IF CP-STATE-STD-ABBRV = 'CT'
  1913*      IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC' OR 'VPP'
  1914*         NEXT SENTENCE
  1915*      END-IF
  1916*         MOVE '6'              TO CP-EARNING-METHOD
  1917*         GO TO 1060-ANTICIPATION-REF.
  1918
  1919     IF CP-STATE-STD-ABBRV = 'ME'
  1920       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC' OR 'VPP'
  1921          NEXT SENTENCE
  1922       END-IF
  1923           IF CP-EARN-BY-PRORATA
  1924              GO TO 1040-PR-REF
  1925           ELSE
  1926              MOVE '6'           TO CP-EARNING-METHOD
  1927              GO TO 1060-ANTICIPATION-REF.
  1928
  1929
  1930     IF CP-COMPANY-ID = 'CID' OR 'DCC' OR 'VPP'
  1931        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1932            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1933
  1934     IF CP-STATE-STD-ABBRV = 'TX'
  1935       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1936          NEXT SENTENCE
  1937       END-IF
  1938        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1939           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1940           MOVE '6'              TO CP-EARNING-METHOD
  1941           GO TO 1060-ANTICIPATION-REF.
  1942
  1943     IF CP-STATE-STD-ABBRV = 'VA'
  1944       IF CP-COMPANY-ID EQUAL 'NCL'
  1945          NEXT SENTENCE
  1946       END-IF
  1947       IF CP-COMPANY-ID = 'NCB'
  1948           MOVE '6'                TO CP-EARNING-METHOD
  1949           GO TO 1060-ANTICIPATION-REF
  1950       ELSE
  1951           IF DC-GREG-DATE-CYMD GREATER 19921231
  1952               IF CP-ORIGINAL-TERM GREATER THAN 61
  1953                   MOVE '6'        TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  38
* ELRFND.cbl
  1954                   GO TO 1060-ANTICIPATION-REF
  1955               ELSE
  1956                   MOVE '1'        TO CP-EARNING-METHOD
  1957                   GO TO 1050-R78-REF.
  1958
  1959 SKIP-CSO-TX-VA-AH-PROCESSING.
  1960
  1961     IF CP-EARN-BY-PRORATA
  1962         GO TO 1040-PR-REF.
  1963
  1964     IF CP-EARN-BY-R78
  1965         GO TO 1050-R78-REF.
  1966
  1967     IF CP-EARN-AS-MEAN
  1968        GO TO 1055-MEAN-REF.
  1969
  1970     IF CP-EARN-AS-SUM-OF-DIGITS
  1971         GO TO 1075-SUM-OF-DIGITS.
  1972     IF CP-DCC-SPP-DDF
  1973        GO TO 1080-DCC-DDF-SPECIAL
  1974     END-IF
  1975     IF CP-EARN-AS-CALIF
  1976         GO TO 1060-ANTICIPATION-REF.
  1977
  1978     IF CP-EARN-ANTICIPATION
  1979         GO TO 1060-ANTICIPATION-REF.
  1980
  1981     IF CP-EARN-AS-NET-PAY
  1982         GO TO 1070-NET-PAY-REFUND.
  1983
  1984     GO TO 1050-R78-REF.
  1985
  1986*---------------------------------------------------------------
  1987 1035-REF-AH-CRITICAL-PERIOD.
  1988     IF CP-REMAINING-TERM GREATER +6
  1989        COMPUTE CP-CALC-REFUND ROUNDED =
  1990          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1991                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1992      ELSE
  1993        COMPUTE CP-CALC-REFUND ROUNDED =
  1994          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1995                                           CP-REMAINING-TERM + 1)
  1996                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1997
  1998     IF CP-CALC-REFUND LESS ZERO
  1999         MOVE ZERO TO CP-CALC-REFUND.
  2000
  2001     GO TO 1999-CALC-REF-AMT-X.
  2002
  2003*---------------------------------------------------------------
  2004 1040-PR-REF.
  2005     MOVE '2'               TO CP-REFUND-TYPE-USED.
  2006     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  2007
  2008     GO TO 1999-CALC-REF-AMT-X.
  2009
  2010*---------------------------------------------------------------
  2011 1050-R78-REF.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  39
* ELRFND.cbl
  2012     MOVE '1'               TO CP-REFUND-TYPE-USED.
  2013     COMPUTE CP-CALC-REFUND ROUNDED =
  2014           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  2015
  2016     GO TO 1999-CALC-REF-AMT-X.
  2017
  2018*---------------------------------------------------------------
  2019 1055-MEAN-REF.
  2020     MOVE '8'               TO CP-REFUND-TYPE-USED.
  2021     COMPUTE CP-CALC-REFUND ROUNDED =
  2022         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  2023          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  2024
  2025     GO TO 1999-CALC-REF-AMT-X.
  2026
  2027*---------------------------------------------------------------
  2028 1060-ANTICIPATION-REF.
  2029     MOVE '6'               TO CP-REFUND-TYPE-USED.
  2030
  2031     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  2032     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  2033     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  2034
  2035     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  2036                               CP-LOAN-TERM.
  2037     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  2038
  2039     PERFORM 2500-GET-RATE.
  2040
  2041     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  2042     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  2043
  2044     IF CP-PREMIUM-RATE = ZEROS
  2045        MOVE '7'                 TO CP-RETURN-CODE
  2046        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  2047        GO TO 1999-CALC-REF-AMT-X.
  2048
  2049     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  2050
  2051     PERFORM 2500-GET-RATE.
  2052
  2053     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  2054
  2055     IF CP-PREMIUM-RATE = ZEROS
  2056        MOVE '7'            TO CP-RETURN-CODE
  2057        GO TO 1999-CALC-REF-AMT-X.
  2058
  2059     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  2060
  2061     IF  WS-ORIG-PREM = ZERO
  2062         MOVE ZERO                TO WS-NP-REF-FACTOR
  2063        ELSE
  2064         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  2065                                            WS-ORIG-PREM.
  2066
  2067     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  2068                                        CP-ORIGINAL-PREMIUM.
  2069
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  40
* ELRFND.cbl
  2070     IF NOT CP-EARN-AS-CALIF
  2071         GO TO 1999-CALC-REF-AMT-X.
  2072
  2073*---------------------------------------------------------------
  2074 1065-CALIF-REGS.
  2075     MOVE '3'               TO CP-REFUND-TYPE-USED.
  2076     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2077         GIVING FACTOR-5.
  2078
  2079     IF FACTOR-5 NOT GREATER +6  AND
  2080        CP-CLASS-CODE = 'A '
  2081         GO TO 1050-R78-REF.
  2082
  2083     IF FACTOR-5 = ZERO
  2084         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2085         GO TO 1999-CALC-REF-AMT-X.
  2086
  2087     IF CP-ORIGINAL-TERM LESS +014
  2088         GO TO 1999-CALC-REF-AMT-X.
  2089
  2090     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2091                                   GIVING FACTOR-5 ROUNDED.
  2092
  2093     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2094
  2095     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2096                                   GIVING FACTOR-2 ROUNDED.
  2097
  2098     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2099     ADD +0.099375 TO FACTOR-1.
  2100
  2101     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2102                                   GIVING FACTOR-5 ROUNDED.
  2103
  2104     SUBTRACT +1.00 FROM FACTOR-5.
  2105
  2106     IF CP-ORIGINAL-TERM LESS +049
  2107         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2108                                   GIVING FACTOR-6 ROUNDED
  2109     ELSE
  2110         MOVE +035 TO FACTOR-6.
  2111
  2112     MOVE +001 TO FACTOR-2.
  2113
  2114     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2115     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2116     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2117     MOVE +001 TO FACTOR-2.
  2118     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2119
  2120     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2121         GIVING CAL-RFND ROUNDED.
  2122
  2123     IF CAL-RFND LESS +0.01
  2124         MOVE ZEROS TO CAL-RFND.
  2125
  2126     IF CAL-RFND LESS CP-CALC-REFUND
  2127         MOVE CAL-RFND TO CP-CALC-REFUND.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  41
* ELRFND.cbl
  2128
  2129     GO TO 1999-CALC-REF-AMT-X.
  2130
  2131*-----------------------------------------------------------------
  2132 1070-NET-PAY-REFUND.
  2133     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2134     IF CP-LOAN-APR = ZERO
  2135         MOVE ZEROS              TO  CP-CALC-REFUND
  2136         MOVE '1'                TO  CP-RETURN-CODE
  2137         GO TO 1999-CALC-REF-AMT-X.
  2138
  2139     MOVE CP-LOAN-APR            TO  N-P-APR.
  2140     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2141     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2142
  2143     MOVE 'R'                    TO  N-P-OPT.
  2144
  2145     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2146
  2147     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2148                                        CP-ORIGINAL-PREMIUM.
  2149
  2150     GO TO 1999-CALC-REF-AMT-X.
  2151*---------------------------------------------------------------
  2152
  2153 1075-SUM-OF-DIGITS.
  2154
  2155     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2156
  2157     COMPUTE RSUM-REMAINING-TERM =
  2158             CP-LOAN-TERM -
  2159                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2160
  2161     COMPUTE RSUM-FACTOR =
  2162        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2163               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2164                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2165            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2166               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2167                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2168
  2169     COMPUTE CP-CALC-REFUND ROUNDED =
  2170           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2171
  2172     GO TO 1999-CALC-REF-AMT-X
  2173     .
  2174 1080-DCC-DDF-SPECIAL.
  2175     COMPUTE CP-MONTH =
  2176        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2177*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2178*    DISPLAY ' MONTH      ' CP-MONTH
  2179*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2180*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2181*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2182*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2183*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2184*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2185*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  42
* ELRFND.cbl
  2186*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2187*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2188     IF CP-MONTH = 0
  2189        MOVE 12                  TO CP-MONTH
  2190     END-IF
  2191     MOVE CP-MONTH               TO WS-MONTH
  2192     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2193     IF CP-DCC-SPP-DDF-IU
  2194        GO TO 1090-DCC-DDF-IU
  2195     END-IF
  2196     IF CP-CALC-CLP
  2197        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2198     END-IF
  2199     EVALUATE TRUE
  2200        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2201           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2202           MOVE CP-ORIGINAL-PREMIUM
  2203                                 TO CP-CALC-REFUND
  2204        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2205           MOVE CP-MONTH         TO WS-MONTH
  2206           PERFORM 1150-UE-GROSS-LT-4
  2207           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2208        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2209           MOVE CP-MONTH         TO WS-MONTH
  2210           PERFORM 1160-UE-GROSS-LT-13
  2211           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2212        WHEN OTHER
  2213           MOVE CP-MONTH         TO WS-MONTH
  2214           PERFORM 1170-UE-GROSS-GT-12
  2215           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2216     END-EVALUATE
  2217     GO TO 1999-CALC-REF-AMT-X
  2218     .
  2219 1085-DCC-DDF-SPECIAL-CLP.
  2220     EVALUATE TRUE
  2221        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2222           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2223           MOVE CP-ORIGINAL-PREMIUM
  2224                                 TO CP-CALC-REFUND
  2225        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2226           MOVE CP-MONTH         TO WS-MONTH
  2227           PERFORM 1100-UE-CLP-LT-4
  2228           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2229        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2230           MOVE CP-MONTH         TO WS-MONTH
  2231           PERFORM 1110-UE-CLP-LT-13
  2232           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2233        WHEN OTHER
  2234           MOVE CP-MONTH         TO WS-MONTH
  2235           PERFORM 1120-UE-CLP-GT-12
  2236           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2237     END-EVALUATE
  2238     GO TO 1999-CALC-REF-AMT-X
  2239     .
  2240 1090-DCC-DDF-IU.
  2241     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2242     IF CP-CALC-CLP
  2243        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  43
* ELRFND.cbl
  2244     END-IF
  2245     EVALUATE TRUE
  2246        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2247           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2248           MOVE CP-ORIGINAL-PREMIUM
  2249                                 TO CP-CALC-REFUND
  2250        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2251           MOVE CP-MONTH         TO WS-MONTH
  2252           PERFORM 1250-IU-UE-GROSS-LT-4
  2253           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2254        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2255           MOVE CP-MONTH         TO WS-MONTH
  2256           PERFORM 1260-IU-UE-GROSS-LT-13
  2257           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2258        WHEN OTHER
  2259           MOVE CP-MONTH         TO WS-MONTH
  2260           PERFORM 1270-IU-UE-GROSS-GT-12
  2261           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2262     END-EVALUATE
  2263     GO TO 1999-CALC-REF-AMT-X
  2264     .
  2265 1095-DCC-DDF-IU-SPECIAL-CLP.
  2266     EVALUATE TRUE
  2267        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2268           OR (CP-DDF-CLP = ZEROS)
  2269           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2270        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2271           MOVE CP-MONTH         TO WS-MONTH
  2272           PERFORM 1200-IU-UE-CLP-LT-4
  2273           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2274        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2275           MOVE CP-MONTH         TO WS-MONTH
  2276           PERFORM 1210-IU-UE-CLP-LT-13
  2277           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2278        WHEN OTHER
  2279           MOVE CP-MONTH         TO WS-MONTH
  2280           PERFORM 1220-IU-UE-CLP-GT-12
  2281           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2282     END-EVALUATE
  2283     GO TO 1999-CALC-REF-AMT-X
  2284     .
  2285 1100-UE-CLP-LT-4.
  2286*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2287     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2288        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2289        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2290        * WS-MONTH / 12)
  2291     .
  2292 1110-UE-CLP-LT-13.
  2293*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2294*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2295*****  -CLP*UEF1}*(mo-3)/9]
  2296     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2297        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2298        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2299        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2300        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
  2301        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  44
* ELRFND.cbl
  2302        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2303     .
  2304 1120-UE-CLP-GT-12.
  2305*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2306     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2307        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2308        * WS-MONTH / 12)
  2309     .
  2310 1150-UE-GROSS-LT-4.
  2311     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2312     COMPUTE WS-TEMP-RESULT ROUNDED =
  2313        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2314        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2315        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2316        * WS-MONTH / 12
  2317     .
  2318 1160-UE-GROSS-LT-13.
  2319     MOVE 3                      TO WS-MONTH
  2320     PERFORM 1150-UE-GROSS-LT-4
  2321     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2322     MOVE CP-MONTH               TO WS-MONTH
  2323     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2324        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2325        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2326     .
  2327 1170-UE-GROSS-GT-12.
  2328*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2329     COMPUTE WS-TEMP-RESULT ROUNDED =
  2330        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2331        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2332        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2333     .
  2334 1200-IU-UE-CLP-LT-4.
  2335*****  no changes with < 4  pema 08/03/11
  2336*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2337     COMPUTE WS-TEMP-RESULT ROUNDED =
  2338        (CP-DDF-CLP - 0)
  2339        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2340        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2341        * WS-MONTH / 12
  2342     .
  2343 1210-IU-UE-CLP-LT-13.
  2344*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2345*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2346*****  - CLP*UEF1]*(mo-3)/9
  2347     MOVE 3                      TO WS-MONTH
  2348     PERFORM 1200-IU-UE-CLP-LT-4
  2349     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2350     MOVE CP-MONTH               TO WS-MONTH
  2351     COMPUTE WS-TEMP-RESULT ROUNDED =
  2352        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2353          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2354     .
  2355 1220-IU-UE-CLP-GT-12.
  2356*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2357     COMPUTE WS-TEMP-RESULT ROUNDED =
  2358        (CP-DDF-CLP - CP-CLP-RATE-UP)
  2359        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  45
* ELRFND.cbl
  2360        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2361     .
  2362 1250-IU-UE-GROSS-LT-4.
  2363*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2364*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2365*****  (1-UEF1)]*mo/12
  2366     PERFORM 1200-IU-UE-CLP-LT-4
  2367     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2368     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2369        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2370        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2371        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2372        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2373        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2374        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2375     .
  2376 1260-IU-UE-GROSS-LT-13.
  2377***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2378     MOVE 3                      TO WS-MONTH
  2379     PERFORM 1250-IU-UE-GROSS-LT-4
  2380     move cp-month               to ws-month
  2381     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2382     COMPUTE WS-TEMP-RESULT ROUNDED =
  2383        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2384        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2385        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2386     .
  2387 1270-IU-UE-GROSS-GT-12.
  2388***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2389     COMPUTE WS-TEMP-RESULT ROUNDED =
  2390        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2391        - CP-CLP-RATE-UP) *
  2392        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2393        * WS-MONTH / 12)
  2394     .
  2395 1299-END-DDF-CALCS.
  2396     .
  2397 1999-CALC-REF-AMT-X.
  2398
  2399     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  2400
  2401
  2402* EXEC CICS RETURN
  2403*    END-EXEC.
  2404*    MOVE '.(                    ''   #00002399' TO DFHEIV0
  2405     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2406     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2407     MOVE X'2020233030303032333939' TO DFHEIV0(25:11)
  2408     CALL 'kxdfhei1' USING DFHEIV0,
  2409           DFHEIV99,
  2410           DFHEIV99,
  2411           DFHEIV99,
  2412           DFHEIV99,
  2413           DFHEIV99,
  2414           DFHEIV99
  2415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2416
  2417
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  46
* ELRFND.cbl
  2418* GOBACK.
  2419     MOVE '9%                    "   ' TO DFHEIV0
  2420     MOVE 'ELRFND' TO DFHEIV1
  2421     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2422     GOBACK.
  2423
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  47
* ELRFND.cbl
  2425  2500-GET-RATE.
  2426
  2427* EXEC CICS LINK
  2428*        PROGRAM    ('ELRATE')
  2429*        COMMAREA   (CALCULATION-PASS-AREA)
  2430*        LENGTH     (CP-COMM-LENGTH)
  2431*        END-EXEC.
  2432     MOVE 'ELRATE' TO DFHEIV1
  2433*    MOVE '."C                   (   #00002405' TO DFHEIV0
  2434     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2436     MOVE X'2020233030303032343035' TO DFHEIV0(25:11)
  2437     CALL 'kxdfhei1' USING DFHEIV0,
  2438           DFHEIV1,
  2439           CALCULATION-PASS-AREA,
  2440           CP-COMM-LENGTH,
  2441           DFHEIV99,
  2442           DFHEIV99,
  2443           DFHEIV99,
  2444           DFHEIV99
  2445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2446
  2447
  2448  2500-EXIT.
  2449       EXIT.
  2450
  2451  9100-CONVERT-DATE.
  2452
  2453* EXEC CICS LINK
  2454*         PROGRAM   ('ELDATCV')
  2455*         COMMAREA  (DATE-CONVERSION-DATA)
  2456*         LENGTH    (DC-COMM-LENGTH)
  2457*    END-EXEC.
  2458     MOVE 'ELDATCV' TO DFHEIV1
  2459*    MOVE '."C                   (   #00002415' TO DFHEIV0
  2460     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2462     MOVE X'2020233030303032343135' TO DFHEIV0(25:11)
  2463     CALL 'kxdfhei1' USING DFHEIV0,
  2464           DFHEIV1,
  2465           DATE-CONVERSION-DATA,
  2466           DC-COMM-LENGTH,
  2467           DFHEIV99,
  2468           DFHEIV99,
  2469           DFHEIV99,
  2470           DFHEIV99
  2471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2472
  2473
  2474  9100-EXIT.
  2475       EXIT.
  2476
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  48
* ELRFND.cbl
  2478  10000-NET-TERM  SECTION.
  2479*                      COPY ERCNETP.
  2480*****************************************************************
  2481*                                                               *
  2482*                            ERCNETP                            *
  2483*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2484*                            VMOD=2.029                         *
  2485*                                                               *
  2486*****************************************************************.
  2487*
  2488*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  2489*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  2490*                                   ORIGINAL TERM (S999)
  2491*                                   REMAINING TERM (S999)
  2492*                                   NET PAY OPTION (X)
  2493*                                   LOAN TERM (S999)
  2494*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  2495*
  2496*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  2497*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  2498*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  2499*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  2500*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  2501*    CHARGED.
  2502*
  2503*    OPTIONS - S = NET SIMPLE
  2504*          SPACE = NET PAY  (1 MO. INTEREST)
  2505*              A = NET PAY  (0 MO. INTEREST)
  2506*              I = NET PAY  (2 MO. INTEREST)
  2507*              J = NET PAY  (3 MO. INTEREST)
  2508*              K = NET PAY  (4 MO. INTEREST)
  2509*              T = TRUNCATED  (0 MO. INTEREST)
  2510*              U = TRUNCATED  (1 MO. INTEREST)
  2511*              V = TRUNCATED  (2 MO. INTEREST)
  2512*              W = TRUNCATED  (3 MO. INTEREST)
  2513*              X = TRUNCATED  (4 MO. INTEREST)
  2514*              R = REFUNDS (REGULAR OR TRUNCATED)
  2515******************************************************************
  2516*                   C H A N G E   L O G
  2517*
  2518* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2519*-----------------------------------------------------------------
  2520*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2521* EFFECTIVE    NUMBER
  2522*-----------------------------------------------------------------
  2523* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2524* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2525* 120403                   PEMA  ADD SPECIAL TX CALC
  2526* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2527* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2528* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2529* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2530* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2531* 021207                   PEMA  ADD PA NP
  2532* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2533* 032807                   PEMA  ADD VT NP PLUS 2
  2534* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2535* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  49
* ELRFND.cbl
  2536* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2537* 110207      TO 'AL' NET PAY CALC
  2538* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2539* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2540* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2541* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2542* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2543* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2544* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2545* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2546* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2547* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2548* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2549* 032612  CR2011110200001  PEMA  AHL CHANGES
  2550* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2551* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2552* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  2553* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  2554* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  2555* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2556* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  2557* 012820  CR2020010600001  PEMA  MOD TX NP FORMULA TO HANDLE TRUNC
  2558* 012820    CONTINUED   AND TO ADJ AF FOR EXTRA DAYS.
  2559******************************************************************
  2560
  2561     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  2562     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  2563     MOVE N-P-LOAN    TO LOAN-TERM.
  2564     MOVE N-P-REM     TO REMAINING-TERM.
  2565     MOVE N-P-OPT     TO OPTION-SW.
  2566
  2567     MOVE +0 TO FACTOR.
  2568     if cp-company-id = 'CID'
  2569        if annual-int-rate = +99.9999
  2570           go to 99000-error
  2571        end-if
  2572     else
  2573        if annual-int-rate = zero
  2574           go to 99000-error
  2575        end-if
  2576     end-if
  2577     IF ORIGINAL-TERM = ZERO
  2578         GO TO 99999-RETURN.
  2579     IF REMAINING-TERM = ZERO
  2580         GO TO 99999-RETURN.
  2581     IF REMAINING-TERM GREATER ORIGINAL-TERM
  2582         GO TO 99000-ERROR.
  2583     IF LOAN-TERM = ZERO
  2584         GO TO 99999-RETURN.
  2585     IF LOAN-TERM LESS ORIGINAL-TERM
  2586         GO TO 99000-ERROR.
  2587
  2588*    IF ANNUAL-INT-RATE LESS +2
  2589*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2590*    IF ANNUAL-INT-RATE LESS +2
  2591*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2592*    IF ANNUAL-INT-RATE LESS +2
  2593*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  50
* ELRFND.cbl
  2594
  2595     IF NPO-REFUND
  2596         MOVE '2' TO NP-PROCESS-SW
  2597       ELSE
  2598         IF ORIGINAL-TERM = REMAINING-TERM
  2599            MOVE '1'   TO NP-PROCESS-SW
  2600           ELSE
  2601            MOVE '3'   TO NP-PROCESS-SW.
  2602
  2603     IF NPO-SIMPLE
  2604         MOVE 'S' TO TYPE-SW
  2605     ELSE
  2606         MOVE 'N' TO TYPE-SW.
  2607
  2608     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  2609     if i = zeros
  2610        move .0000000001         to i
  2611     end-if
  2612
  2613     COMPUTE V ROUNDED = K1 / (K1 + I).
  2614
  2615     MOVE V     TO VX
  2616                   SV.
  2617
  2618     MOVE +1    TO X1
  2619                   SX.
  2620
  2621     MOVE LOAN-TERM TO MAX-X.
  2622
  2623     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  2624
  2625     IF MAX-X = +1
  2626        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  2627
  2628     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  2629
  2630     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  2631         OR 'DCC' or 'VPP' OR 'NCL') AND
  2632        (NOT NP-REFUND)
  2633        NEXT SENTENCE
  2634     ELSE
  2635     IF LOAN-TERM NOT = ORIGINAL-TERM
  2636        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  2637
  2638     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  2639
  2640 10500-VX-LOOP.
  2641
  2642***  VX = AMORT. LOAN TERM.
  2643***  SV = AMORT. INSURANCE TERM.
  2644***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  2645***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  2646***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  2647
  2648     IF X2 = 1
  2649        MOVE V         TO SX
  2650     END-IF
  2651     COMPUTE VX ROUNDED = VX * V.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  51
* ELRFND.cbl
  2652
  2653     ADD B1 TO X1.
  2654
  2655     IF X1 = REMAINING-TERM
  2656          MOVE VX    TO SV.
  2657
  2658     IF X1 EQUAL SV-MINUS-ONE
  2659        MOVE VX      TO SV-MINUS-ONE.
  2660
  2661     IF X1 = X2
  2662          MOVE VX    TO SX.
  2663
  2664     IF X1 NOT = MAX-X
  2665          GO TO 10500-VX-LOOP.
  2666
  2667 10700-COMPUTE-REMAINING-FACTOR.
  2668*****  WK1 = LOAN TERM AMORT
  2669     COMPUTE WK1 = K1 - VX.
  2670*****  WK2 = INS TERM AMORT
  2671     COMPUTE WK2 = K1 - SV.
  2672*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2673     COMPUTE WK5 = K1 - SX.
  2674*****  WK6 = INS TERM - 1
  2675     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  2676
  2677     IF NP-RATING
  2678         GO TO 12000-PREMIUM-RATE.
  2679
  2680     IF NP-REFUND
  2681         GO TO 11000-REFUND-CALC.
  2682
  2683     IF NET-STD
  2684         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  2685
  2686     IF NET-SMP
  2687         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  2688         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  2689         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  2690         COMPUTE WK3 ROUNDED = WK3 * 1000.
  2691
  2692     IF REMAINING-TERM LESS THAN X2
  2693         MOVE +0 TO WK3.
  2694
  2695     MOVE WK3 TO FACTOR.
  2696
  2697     GO TO 99999-RETURN.
  2698
  2699 11000-REFUND-CALC.
  2700     IF REMAINING-TERM NOT LESS MAX-X
  2701        MOVE +1 TO FACTOR
  2702        GO TO 99999-RETURN.
  2703
  2704     IF REMAINING-TERM LESS +1
  2705        MOVE 0 TO FACTOR
  2706        GO TO 99999-RETURN.
  2707
  2708     COMPUTE WK2 ROUNDED = WK2 / I.
  2709     COMPUTE WK5 ROUNDED = WK5 / I.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  52
* ELRFND.cbl
  2710     COMPUTE WK1 ROUNDED = WK1 / I.
  2711
  2712     IF (CP-COMPANY-ID EQUAL 'CID')
  2713        AND (CP-STATE-STD-ABBRV = 'MN')
  2714        AND (CP-CERT-EFF-DT > X'A4FF')
  2715        AND (CP-RATE-AS-REG-BALLOON)
  2716        AND (CP-EARN-AS-NET-PAY)
  2717        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2718        CONTINUE
  2719     ELSE
  2720        GO TO 11000-CHECK-MN-LEV-BALLOON
  2721     END-IF
  2722
  2723     COMPUTE R = M - E
  2724     COMPUTE FACTOR = (R - WK2 + WK5) /
  2725        (M - WK1 + WK5)
  2726
  2727     GO TO 99999-RETURN
  2728
  2729      .
  2730 11000-CHECK-MN-LEV-BALLOON.
  2731
  2732     IF (CP-COMPANY-ID EQUAL 'CID')
  2733        AND (CP-STATE-STD-ABBRV = 'MN')
  2734        AND (CP-CERT-EFF-DT > X'A4FF')
  2735        AND (CP-RATE-AS-REG-BALLOON)
  2736        AND (CP-EARN-AS-NET-PAY)
  2737        AND (CP-DEVIATION-CODE = 'LEV')
  2738        CONTINUE
  2739     ELSE
  2740        GO TO 11000-CONTINUE-REFUND
  2741     END-IF
  2742
  2743     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2744     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2745        ** (M - E)) / I
  2746
  2747     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2748
  2749     GO TO 99999-RETURN
  2750
  2751     .
  2752 11000-CONTINUE-REFUND.
  2753*    IF CP-GAP-ACTUARIAL
  2754*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2755*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2756*       COMPUTE WK3 = WK2 / ANGLEN
  2757*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2758     IF CP-GAP-ACTUARIAL
  2759        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2760           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2761        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2762     ELSE
  2763        COMPUTE WK3 ROUNDED =
  2764          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2765     END-IF
  2766
  2767     MOVE WK3  TO FACTOR.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  53
* ELRFND.cbl
  2768
  2769     GO TO 99999-RETURN.
  2770
  2771 12000-PREMIUM-RATE.
  2772*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  2773*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  2774*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  2775*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  2776*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  2777*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  2778
  2779     COMPUTE K-I = K1 + I.
  2780     MOVE K-I TO ONE-PLUS-I.
  2781
  2782     IF NPO-ALT OR NPO-TRUNC-0
  2783         MOVE K1 TO K-I.
  2784
  2785     IF NPO-2MO OR NPO-TRUNC-2
  2786         COMPUTE K-I = K1 + (2 * I).
  2787
  2788     IF NPO-3MO OR NPO-TRUNC-3
  2789         COMPUTE K-I = K1 + (3 * I).
  2790
  2791     IF NPO-4MO OR NPO-TRUNC-4
  2792         COMPUTE K-I = K1 + (4 * I).
  2793
  2794     COMPUTE RA ROUNDED = 1 -
  2795             ((X2 * (X2 + 1)) /
  2796              (N *  (N  + 1))).
  2797
  2798     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2799        (CP-CSL-VALID-NP-BENEFIT-CD)
  2800        NEXT SENTENCE
  2801     ELSE
  2802        GO TO XXXX-CHECK-DISCOUNT-5.
  2803
  2804     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2805     MOVE ' ' TO DC-OPTION-CODE.
  2806     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2807
  2808     IF DATE-CONVERSION-ERROR
  2809        MOVE '2'                 TO CP-RETURN-CODE
  2810        MOVE ZEROS               TO FACTOR
  2811                                    CP-CALC-PREMIUM
  2812         GO TO 99999-RETURN.
  2813
  2814     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  2815     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  2816     MOVE ' ' TO DC-OPTION-CODE
  2817     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2818
  2819     IF DATE-CONVERSION-ERROR
  2820        MOVE '2'                 TO CP-RETURN-CODE
  2821        MOVE ZEROS               TO FACTOR
  2822                                    CP-CALC-PREMIUM
  2823         GO TO 99999-RETURN.
  2824
  2825     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  54
* ELRFND.cbl
  2826
  2827     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  2828
  2829     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  2830        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  2831        CP-PAY-FREQUENCY / 365) * I
  2832     ELSE
  2833        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  2834        CP-PAY-FREQUENCY / 365) * I.
  2835
  2836     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  2837     13).
  2838
  2839     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  2840     (N - ( ANGLEN-1 / WK3)).
  2841
  2842     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  2843
  2844     COMPUTE WS-CALC-FREQ-RATE EQUAL
  2845       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  2846
  2847     COMPUTE WS-Y-X-FACTOR EQUAL
  2848       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  2849       WS-CALC-FREQ-RATE).
  2850
  2851     COMPUTE WS-ODD-DAY-UNITS EQUAL
  2852       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  2853
  2854     COMPUTE WS-X-Y-FACTOR EQUAL
  2855       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  2856
  2857     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  2858       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  2859       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  2860
  2861     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  2862
  2863     GO TO 99999-RETURN.
  2864
  2865 XXXX-CHECK-DISCOUNT-5.
  2866
  2867     IF WS-DISCOUNT-OPTION EQUAL '5'
  2868        NEXT SENTENCE
  2869     ELSE
  2870        GO TO 12000-CHECK-CLIENT.
  2871
  2872      COMPUTE ANGLEN EQUAL WK1 / I.
  2873
  2874      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2875
  2876      COMPUTE WK3 EQUAL
  2877        (12 *
  2878        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  2879        CP-ORIGINAL-BENEFIT)) /
  2880        APR100.
  2881
  2882     COMPUTE WK3 EQUAL
  2883        (WK3 * CP-PREMIUM-RATE) / +1000.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  55
* ELRFND.cbl
  2884
  2885     COMPUTE WK3 EQUAL
  2886        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  2887
  2888      MOVE WK3 TO CP-CALC-PREMIUM.
  2889
  2890     GO TO 99999-RETURN.
  2891
  2892 12000-CHECK-CLIENT.
  2893
  2894     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2895        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2896        (CP-TRUNCATED-LIFE)
  2897        NEXT SENTENCE
  2898     ELSE
  2899        GO TO 12000-CHECK-NEXT.
  2900
  2901     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2902
  2903     COMPUTE ANGLEN EQUAL WK1 / I.
  2904     COMPUTE ANGLEM EQUAL WK2 / I.
  2905
  2906     COMPUTE FM EQUAL
  2907                    (((ONE-PLUS-I ** M) * I * M) /
  2908                    ((ONE-PLUS-I ** M) - 1))
  2909                    - 1.
  2910
  2911     COMPUTE FN EQUAL
  2912                    (((ONE-PLUS-I ** N) * I * N) /
  2913                    ((ONE-PLUS-I ** N) - 1))
  2914                    - 1.
  2915
  2916     COMPUTE FNM EQUAL
  2917                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  2918                    ((ONE-PLUS-I ** (N - M)) - 1))
  2919                    - 1.
  2920
  2921     COMPUTE GR EQUAL
  2922                    (WS-WORK-RATE * ANGLEM * I) /
  2923                    (M - ANGLEM).
  2924
  2925     COMPUTE ODF EQUAL
  2926                     (1 +
  2927                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  2928                     360)) /
  2929                     ONE-PLUS-I.
  2930
  2931     COMPUTE OD EQUAL
  2932                    (1 + (ODF * (FN / I - 1))) +
  2933                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  2934
  2935     COMPUTE WK3 EQUAL
  2936*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  2937                    ((1 + FN) * ODF *
  2938                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  2939                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  2940                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  2941
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  56
* ELRFND.cbl
  2942     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  2943     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  2944
  2945     COMPUTE WK3 EQUAL
  2946                    (WK3 / (ODF * (1 + FN))) -
  2947*                   CP-ORIGINAL-BENEFIT.
  2948                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  2949
  2950      MOVE WK3 TO CP-CALC-PREMIUM.
  2951
  2952     GO TO 99999-RETURN.
  2953
  2954 12000-CHECK-NEXT.
  2955
  2956     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  2957        NEXT SENTENCE
  2958     ELSE
  2959        GO TO 12000-CHECK-PA-TRUNC.
  2960
  2961      IF WS-WORK-DIS-RATE EQUAL +0
  2962         MOVE '7'                TO CP-RETURN-CODE
  2963         MOVE ZEROS              TO FACTOR
  2964                                    CP-CALC-PREMIUM
  2965         GO TO 99999-RETURN.
  2966
  2967      COMPUTE ANGLEN EQUAL WK1 / I.
  2968
  2969      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2970
  2971      IF WS-WORK-DIS-RATE EQUAL APR100
  2972         ADD .00001 TO APR100.
  2973
  2974      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  2975      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  2976
  2977     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2978        / (1 + I)
  2979     COMPUTE ANGLEN-1 = ANGLEN / Y
  2980      IF CP-COMPANY-ID EQUAL 'CDL'
  2981         COMPUTE WK3 EQUAL
  2982
  2983          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  2984          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  2985
  2986          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2987
  2988          ((WK8 ** N) /
  2989          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2990
  2991          ((WK9 ** N) /
  2992          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  2993
  2994      ELSE
  2995         COMPUTE WK3 EQUAL
  2996
  2997          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2998          (12 + WS-WORK-DIS-RATE) * 12) *
  2999
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  57
* ELRFND.cbl
  3000          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3001
  3002          ((WK8 ** N) /
  3003          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3004
  3005          ((WK9 ** N) /
  3006          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3007
  3008      COMPUTE WK3 EQUAL
  3009          (WK3 * CP-PREMIUM-RATE) / +1000.
  3010
  3011      MOVE WK3 TO CP-CALC-PREMIUM.
  3012
  3013     GO TO 99999-RETURN.
  3014
  3015 12000-CHECK-PA-TRUNC.
  3016
  3017     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3018        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3019        (CP-EARN-AS-NET-PAY) AND
  3020        (CP-TRUNCATED-LIFE)
  3021        NEXT SENTENCE
  3022     ELSE
  3023        GO TO 12000-CHECK-MD-TRUNC.
  3024
  3025     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3026
  3027     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3028     COMPUTE ANGLEN EQUAL WK1 / I.
  3029
  3030     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3031
  3032     COMPUTE WK3 EQUAL
  3033        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3034        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3035
  3036     MOVE WK3 TO CP-CALC-PREMIUM.
  3037
  3038     GO TO 99999-RETURN.
  3039
  3040 12000-CHECK-MD-TRUNC.
  3041
  3042     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3043        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3044        (CP-EARN-AS-NET-PAY) AND
  3045        (CP-TRUNCATED-LIFE)
  3046        NEXT SENTENCE
  3047     ELSE
  3048        GO TO 12000-CHECK-MD.
  3049
  3050     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3051
  3052     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3053     COMPUTE ANGLEM EQUAL WK2 / I.
  3054     COMPUTE ANGLEN EQUAL WK1 / I.
  3055
  3056     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3057
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  58
* ELRFND.cbl
  3058     COMPUTE WK3 EQUAL
  3059        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3060        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3061        (ANGLEN-1 * (M - ANGLEM))).
  3062
  3063     MOVE WK3 TO CP-CALC-PREMIUM.
  3064
  3065     GO TO 99999-RETURN.
  3066
  3067 12000-CHECK-MD.
  3068
  3069     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3070        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3071        (CP-EARN-AS-NET-PAY)
  3072        NEXT SENTENCE
  3073     ELSE
  3074        GO TO 12000-CHECK-ME-TRUNC.
  3075
  3076     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3077
  3078     COMPUTE WK3 EQUAL
  3079        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3080
  3081     MOVE WK3 TO CP-CALC-PREMIUM.
  3082
  3083     GO TO 99999-RETURN.
  3084
  3085 12000-CHECK-ME-TRUNC.
  3086
  3087     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3088        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3089        AND (CP-EARN-AS-NET-PAY)
  3090        AND (CP-TRUNCATED-LIFE)
  3091        CONTINUE
  3092     ELSE
  3093        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3094     END-IF
  3095
  3096     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3097     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3098     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3099     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3100     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3101     COMPUTE ANGLEN-1 = ANGLEN / Y
  3102     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3103     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3104     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3105     COMPUTE WK3
  3106        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3107        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3108            * (1 / (1.0635 ** (M / 12))))
  3109*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3110*    COMPUTE WK9 EQUAL
  3111*       1 / (1 + (.045 * (N - M) / 24))
  3112*    COMPUTE WK7 EQUAL
  3113*       WS-WORK-RATE * 20 / (M + 1).
  3114*    COMPUTE WK3 EQUAL
  3115*       ((( N - ANGLEN) * WK7 * WK8) /
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  59
* ELRFND.cbl
  3116*       (10 * ANGLEN-1 * I)) -
  3117*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3118*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3119*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3120*
  3121     MOVE WK3 TO CP-CALC-PREMIUM.
  3122
  3123     GO TO 99999-RETURN
  3124      .
  3125 12000-CHECK-CID-WA-FARMPLAN.
  3126
  3127     IF (CP-COMPANY-ID EQUAL 'CID')
  3128        AND (CP-STATE-STD-ABBRV = 'WA')
  3129        AND (CP-FARM-PLAN)
  3130        CONTINUE
  3131     ELSE
  3132        GO TO 12000-CHECK-CID-FARMPLAN
  3133     END-IF
  3134**  This was removed due to IR 2015022300001
  3135    GO TO 12000-CHECK-CID-FARMPLAN
  3136
  3137     move cp-original-term       to n
  3138     move cp-no-of-pmts          TO C-TOT-PMTS
  3139     compute c-pmts-per-year = 12 / cp-pay-frequency
  3140     move cp-pay-frequency       to m
  3141     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3142     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3143     if i = zeros
  3144        move .0000000001         to i
  3145     end-if
  3146     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3147
  3148     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3149        (m * 30))) / (1 + I)
  3150     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3151        ** CP-PAY-FREQUENCY) - 1
  3152     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3153     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3154        ** TI) / WS-WORK-DIS-RATE
  3155     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  3156     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3157     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3158        ** m) / WS-WORK-DIS-RATE
  3159     COMPUTE WK2 = WK2 * (1 + J)
  3160     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3161     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3162     COMPUTE WK3 = WK3 * (1 + J)
  3163     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  3164        ** (c-tot-pmts - 1))) / J
  3165     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3166        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  3167        (CP-PREMIUM-RATE / 1000)
  3168     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  3169     COMPUTE WK6 = (WK7 * GR)
  3170
  3171     MOVE WK6 TO CP-CALC-PREMIUM
  3172
  3173     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  60
* ELRFND.cbl
  3174
  3175     .
  3176 12000-CHECK-CID-FARMPLAN.
  3177     IF (CP-COMPANY-ID EQUAL 'CID')
  3178        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3179           OR 'IN' OR 'AZ')
  3180        AND (CP-FARM-PLAN)
  3181        CONTINUE
  3182     ELSE
  3183        GO TO 12000-CHECK-CID-AL-FARMPLAN
  3184     END-IF
  3185     COMPUTE N = M / CP-PAY-FREQUENCY
  3186     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3187     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3188        ** CP-PAY-FREQUENCY) - 1
  3189     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3190     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3191        ** TI) / WS-WORK-DIS-RATE
  3192     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3193     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3194     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3195        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3196     COMPUTE WK2 = WK2 * (1 + J)
  3197     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3198     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3199     COMPUTE WK3 = WK3 * (1 + J)
  3200     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3201        ** (N - 1))) / J
  3202     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3203        ((N * WK2) - WK5)) + (N * WK1)) *
  3204        (CP-PREMIUM-RATE / 1000)
  3205     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3206     COMPUTE WK6 = (WK7 * GR)
  3207     MOVE WK6 TO CP-CALC-PREMIUM
  3208     GO TO 99999-RETURN
  3209     .
  3210 12000-CHECK-CID-AL-FARMPLAN.
  3211
  3212     IF (CP-COMPANY-ID EQUAL 'CID')
  3213        AND (CP-STATE-STD-ABBRV = 'AL')
  3214        AND (CP-FARM-PLAN)
  3215        CONTINUE
  3216     ELSE
  3217        GO TO 12000-CHECK-SC-CID
  3218     END-IF
  3219
  3220     display ' made AL Farm Plan calc '
  3221
  3222     evaluate true
  3223        when cp-pmt-mode = 'B'
  3224           move 26               to c-pmts-per-year
  3225           move 14               to c-days-in-pmt-per
  3226        when cp-pmt-mode = 'W'
  3227           move 52               to c-pmts-per-year
  3228           move 07               to c-days-in-pmt-per
  3229        when cp-pmt-mode = 'S'
  3230           move 24               to c-pmts-per-year
  3231           move 15               to c-days-in-pmt-per
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  61
* ELRFND.cbl
  3232        when cp-pmt-mode = 'A'
  3233           move 1                to c-pmts-per-year
  3234           move 360              to c-days-in-pmt-per
  3235        when cp-pmt-mode = 'T'
  3236           move 2                to c-pmts-per-year
  3237           move 180              to c-days-in-pmt-per
  3238        when cp-pmt-mode = 'Q'
  3239           move 4                to c-pmts-per-year
  3240           move 90               to c-days-in-pmt-per
  3241        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3242           move 6                to c-pmts-per-year
  3243           move 60               to c-days-in-pmt-per
  3244        when other
  3245           move 12               to c-pmts-per-year
  3246           move 30               to c-days-in-pmt-per
  3247     end-evaluate
  3248
  3249     compute c-tot-pmts = n / 12 * c-pmts-per-year
  3250     compute i = cp-loan-apr / c-pmts-per-year / 100
  3251     if i = zeros
  3252        move .0000000001         to i
  3253     end-if
  3254     compute anglen  =
  3255        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3256
  3257     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3258        c-days-in-pmt-per)) / (1 + I)
  3259
  3260     compute angleny = anglen / y
  3261
  3262     compute wk3 rounded =   *> tv1
  3263        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  3264
  3265     compute wk6 =           *> tv2
  3266        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
  3267
  3268     compute wk7 =    *> tv3
  3269        (cp-original-benefit / anglen)
  3270
  3271     compute wk5 rounded = wk7 *wk3 * wk6
  3272
  3273     move wk5                    to cp-calc-premium
  3274     GO TO 99999-RETURN
  3275     .
  3276 12000-CHECK-SC-CID.
  3277     IF (CP-COMPANY-ID = 'CID')
  3278        AND (CP-STATE-STD-ABBRV = 'SC')
  3279        AND (CP-EARN-AS-NET-PAY)
  3280        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3281        move 6                   to ws-extra-pmts
  3282     ELSE
  3283        GO TO 12000-CHECK-AL-CID
  3284     END-IF
  3285     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3286     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3287     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3288        / 12)) / ((M + 1) / 2)
  3289
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  62
* ELRFND.cbl
  3290     if i = .0000000001
  3291        compute wk4 = cp-original-benefit / n
  3292        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  3293            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  3294        display ' hit sc wo apr - wk2 ' wk2
  3295     else
  3296        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  3297        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3298        COMPUTE ANGLEN-1 = ANGLEN / Y
  3299        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3300        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3301           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3302     end-if
  3303*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3304*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3305*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3306*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3307*    COMPUTE ANGLEN-1 = ANGLEN / Y
  3308*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3309*       / 12)) / ((M + 1) / 2)
  3310*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3311*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3312*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3313     MOVE WK3 TO CP-CALC-PREMIUM
  3314     GO TO 99999-RETURN
  3315     .
  3316 12000-CHECK-AL-CID.
  3317     IF (CP-COMPANY-ID EQUAL 'CID')
  3318        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3319        AND (CP-EARN-AS-NET-PAY)
  3320        CONTINUE
  3321     ELSE
  3322        GO TO 12000-CHECK-NH-CID
  3323     END-IF
  3324     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3325     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3326     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3327     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3328                   / (1 + I)
  3329     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3330     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3331     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3332        (CP-PREMIUM-RATE / 1000)
  3333     MOVE WK3 TO CP-CALC-PREMIUM
  3334     GO TO 99999-RETURN
  3335     .
  3336 12000-CHECK-NH-CID.
  3337     IF (CP-COMPANY-ID EQUAL 'CID')
  3338        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3339        AND (CP-EARN-AS-NET-PAY)
  3340        CONTINUE
  3341     ELSE
  3342        GO TO 12000-CHECK-PA-CID
  3343     END-IF
  3344     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3345     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3346     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3347                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  63
* ELRFND.cbl
  3348     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3349     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3350     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3351        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3352     MOVE WK3 TO CP-CALC-PREMIUM
  3353     GO TO 99999-RETURN
  3354     .
  3355 12000-CHECK-PA-CID.
  3356     IF (CP-COMPANY-ID EQUAL 'CID')
  3357        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3358        AND (CP-EARN-AS-NET-PAY)
  3359        CONTINUE
  3360     ELSE
  3361        GO TO 12000-CHECK-ME-CID
  3362     END-IF
  3363
  3364     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3365     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3366     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3367     COMPUTE ANGLEN-1 = ANGLEN / Y
  3368     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3369     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3370     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3371     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3372        * WK5
  3373     MOVE WK3 TO CP-CALC-PREMIUM
  3374     GO TO 99999-RETURN
  3375     .
  3376 12000-CHECK-ME-CID.
  3377     IF (CP-COMPANY-ID EQUAL 'CID')
  3378        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3379        AND (CP-EARN-AS-NET-PAY)
  3380        CONTINUE
  3381     ELSE
  3382        GO TO 12000-CHECK-VT-TRUNC
  3383     END-IF
  3384     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3385     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3386     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3387     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3388     COMPUTE ANGLEN-1 = ANGLEN / Y
  3389     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3390     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3391     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3392        * WK5
  3393     MOVE WK3 TO CP-CALC-PREMIUM
  3394     GO TO 99999-RETURN
  3395     .
  3396 12000-CHECK-VT-TRUNC.
  3397
  3398     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3399        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3400        (CP-EARN-AS-NET-PAY) AND
  3401        (CP-TRUNCATED-LIFE)
  3402        NEXT SENTENCE
  3403     ELSE
  3404        GO TO 12000-CHECK-VT.
  3405
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  64
* ELRFND.cbl
  3406      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3407
  3408      COMPUTE ANGLEN EQUAL WK1 / I.
  3409
  3410      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3411
  3412      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  3413      COMPUTE WK9 EQUAL
  3414        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  3415        ((.0054 - I) / (1 + I)).
  3416      COMPUTE WK7 EQUAL
  3417        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  3418      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3419        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  3420
  3421      MOVE WK3 TO CP-CALC-PREMIUM.
  3422
  3423     GO TO 99999-RETURN.
  3424
  3425 12000-CHECK-VT.
  3426
  3427     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3428        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3429        (CP-EARN-AS-NET-PAY)
  3430        NEXT SENTENCE
  3431     ELSE
  3432        GO TO 12000-CHECK-MINN-WDS.
  3433
  3434      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3435
  3436      COMPUTE ANGLEN EQUAL WK1 / I.
  3437
  3438      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3439
  3440      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  3441                        (ANGLEN-1 * I)) *
  3442
  3443                        (((1.0054 ** N - 1) /
  3444                        (1.0054 ** (N - 1) * .0054)) -
  3445
  3446                        ((V * (1 - 1.0054 ** N * VX)) /
  3447                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  3448
  3449      MOVE WK3 TO CP-CALC-PREMIUM.
  3450
  3451     GO TO 99999-RETURN.
  3452
  3453 12000-CHECK-MINN-WDS.
  3454
  3455     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3456        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3457        (CP-EARN-AS-NET-PAY)
  3458        NEXT SENTENCE
  3459     ELSE
  3460        GO TO 12000-CHECK-MINN-BALL-LEV.
  3461
  3462     COMPUTE ANGLEN EQUAL WK1 / I.
  3463     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  65
* ELRFND.cbl
  3464              (N / +12) * (2 / (N + 1)).
  3465     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  3466         WK3 * ((N - ANGLEN) / I).
  3467
  3468      MOVE WK3 TO CP-CALC-PREMIUM.
  3469
  3470     GO TO 99999-RETURN.
  3471
  3472 12000-CHECK-MINN-BALL-LEV.
  3473
  3474     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3475        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3476        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3477        (CP-EARN-AS-REG-BALLOON)
  3478        NEXT SENTENCE
  3479     ELSE
  3480        GO TO 12000-CHECK-MINN-BALL.
  3481
  3482     COMPUTE ANGLEN EQUAL WK1 / I.
  3483
  3484     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  3485
  3486     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3487        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  3488
  3489     MOVE WK3 TO CP-CALC-PREMIUM.
  3490
  3491     GO TO 99999-RETURN.
  3492
  3493 12000-CHECK-MINN-BALL.
  3494
  3495     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3496        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3497        (CP-EARN-AS-REG-BALLOON)
  3498        NEXT SENTENCE
  3499     ELSE
  3500        GO TO 12000-CHECK-CID-MN-BALL.
  3501
  3502     COMPUTE ANGLEN EQUAL WK1 / I.
  3503     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3504
  3505     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3506     / +100 * (N - 1) / 12 * 2 / N *
  3507     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  3508
  3509      MOVE WK3 TO CP-CALC-PREMIUM.
  3510
  3511     GO TO 99999-RETURN.
  3512
  3513 12000-CHECK-CID-MN-BALL.
  3514     IF (CP-COMPANY-ID EQUAL 'CID')
  3515        AND (CP-STATE-STD-ABBRV = 'MN')
  3516        AND (CP-CERT-EFF-DT > X'A4FF')
  3517        AND (CP-EARN-AS-REG-BALLOON)
  3518        CONTINUE
  3519     ELSE
  3520        GO TO 12000-CHECK-CID-MN-FARM
  3521     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  66
* ELRFND.cbl
  3522     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3523     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3524     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3525     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3526     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3527     COMPUTE V = 1 / (1 + I)
  3528     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3529     COMPUTE Y = (1 + (D * I) / +30)
  3530        / (1 + I)
  3531     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3532        * CP-PREMIUM-RATE / 1000
  3533*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3534*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3535*    ELSE
  3536*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3537*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3538*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3539*       DISPLAY ' BALLOON TOP ' WK6
  3540*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3541*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3542*          / 100
  3543*       DISPLAY ' BALLOON BOTTOM ' WK7
  3544*       COMPUTE GR = WK6 / WK7
  3545*       DISPLAY ' BALLOON PAYMENT ' GR
  3546*    END-IF
  3547     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3548     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3549        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3550     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3551     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3552        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3553           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3554           * CP-PREMIUM-RATE / 1000
  3555     MOVE WK3                    TO CP-CALC-PREMIUM
  3556     GO TO 99999-RETURN.
  3557     .
  3558 12000-CHECK-CID-MN-FARM.
  3559
  3560     IF (CP-COMPANY-ID EQUAL 'CID')
  3561        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  3562        AND (CP-CERT-EFF-DT > X'A4FF')
  3563        AND (CP-EARN-AS-FARM-PLAN)
  3564        CONTINUE
  3565     ELSE
  3566        GO TO 12000-CHECK-CID-NET-BALLoons
  3567     END-IF
  3568
  3569     EVALUATE CP-PMT-MODE
  3570        WHEN 'B'
  3571           MOVE +14              TO C-DAYS-IN-PMT-PER
  3572           MOVE +26              TO C-PMTS-PER-YEAR
  3573           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3574        WHEN 'S'
  3575           MOVE +15              TO C-DAYS-IN-PMT-PER
  3576           MOVE +24              TO C-PMTS-PER-YEAR
  3577           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3578        WHEN 'T'
  3579           MOVE +360             TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  67
* ELRFND.cbl
  3580           MOVE +1               TO C-PMTS-PER-YEAR
  3581           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3582        WHEN 'W'
  3583           MOVE +7               TO C-DAYS-IN-PMT-PER
  3584           MOVE +52              TO C-PMTS-PER-YEAR
  3585           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3586        WHEN OTHER
  3587           move cp-no-of-pmts    to c-tot-pmts
  3588           if cp-pay-frequency > zeros
  3589              compute c-pmts-per-year =
  3590                 12 / cp-pay-frequency
  3591              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  3592           else
  3593              MOVE +30           TO C-DAYS-IN-PMT-PER
  3594              MOVE +12           TO C-PMTS-PER-YEAR
  3595              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3596           end-if
  3597     END-EVALUATE
  3598
  3599     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3600     if i = zeros
  3601        move .0000000001         to i
  3602     end-if
  3603
  3604     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3605        C-DAYS-IN-PMT-PER)) / (1 + I)
  3606
  3607     compute cp-premium-rate =
  3608        cp-premium-rate * 12 / c-pmts-per-year / 10
  3609     move c-tot-pmts to n m
  3610     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3611     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3612     COMPUTE ANGLEN-1 = ANGLEN / Y
  3613     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3614
  3615     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3616        (cp-premium-rate / 100)
  3617
  3618
  3619     MOVE WK3                    TO CP-CALC-PREMIUM
  3620
  3621     GO TO 99999-RETURN.
  3622
  3623     .
  3624 12000-check-cid-net-balloons.
  3625     IF (CP-COMPANY-ID EQUAL 'CID')
  3626        AND (CP-EARN-AS-REG-BALLOON)
  3627        and (CP-NET-ONLY-STATE not = 'Y')
  3628        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3629        CONTINUE
  3630     ELSE
  3631        GO TO 12000-check-cid-net-only-balls
  3632     END-IF
  3633     display ' *** NOT NET ONLY STATE BALLOONS *** '
  3634     COMPUTE Y =
  3635        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3636     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3637     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  68
* ELRFND.cbl
  3638     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3639     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3640     COMPUTE ANGLEMY = ANGLEM / Y
  3641     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3642     COMPUTE ANGLENY = ANGLEN / Y
  3643     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3644     compute cp-original-benefit =
  3645        cp-original-benefit + cp-alternate-benefit
  3646     COMPUTE PVBALLOON rounded =
  3647        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3648     compute wk4 rounded =
  3649        cp-original-benefit - pvballoon
  3650     compute wk6 rounded =
  3651        (cp-original-benefit - cp-alternate-benefit)
  3652***  compute ra = wk4 / anglem-1y
  3653     compute ra = wk4 / anglemy
  3654     compute wk6 rounded = wk6 / anglemy
  3655     display ' rate before ' cp-premium-rate
  3656     compute cp-premium-rate =
  3657        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  3658            / 30) / 12))     /
  3659           ((m + 1) / 2)
  3660     display '************************************'
  3661     display ' orign ben    ' cp-original-benefit
  3662     display ' balloon      ' cp-alternate-benefit
  3663     display ' ra           ' ra
  3664     display ' wk6          ' wk6
  3665     display ' m            ' m
  3666     display ' anglemy      ' anglemy
  3667     display ' anglem-1     ' anglem-1y
  3668     display ' i            ' i
  3669     display ' extra per    ' cp-extra-periods
  3670     display ' prem rate    ' cp-premium-rate
  3671***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3672***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3673     compute wk3 = wk6 * (m - anglem) / i * (1 +
  3674        (cp-extra-periods * i)) * cp-premium-rate / 100
  3675     move wk3                    to cp-calc-premium
  3676     display ' wk3          ' wk3
  3677     display '************************************'
  3678*    compute wk3 rounded =
  3679*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3680*    move wk3                    to cp-lf-balloon-prem
  3681     GO TO 99999-RETURN.
  3682     .
  3683 12000-check-cid-net-only-balls.
  3684     IF (CP-COMPANY-ID EQUAL 'CID')
  3685        AND (CP-EARN-AS-REG-BALLOON)
  3686        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3687        CONTINUE
  3688     ELSE
  3689        GO TO 12000-CHECK-NC-WDS
  3690     END-IF
  3691     display ' *** NET ONLY STATE BALLOONS *** '
  3692     COMPUTE Y =
  3693        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3694     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3695     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  69
* ELRFND.cbl
  3696     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3697     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3698     COMPUTE ANGLEMY = ANGLEM / Y
  3699     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3700     COMPUTE ANGLENY = ANGLEN / Y
  3701     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3702     COMPUTE PVBALLOON rounded =
  3703        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3704     compute wk4 rounded =
  3705        cp-original-benefit - pvballoon
  3706*    compute cp-premium-rate =
  3707*       (cp-premium-rate * (m + 1) / 12)  /
  3708*          ((m + 2) / 2)
  3709***  compute ra = wk4 / anglem-1y
  3710     compute ra = (cp-original-benefit + cp-alternate-benefit -
  3711        pvballoon) / anglemy
  3712     display '************************************'
  3713     display ' ra           ' ra
  3714     display ' m            ' m
  3715     display ' anglemy      ' anglemy
  3716     display ' anglem-1     ' anglem-1y
  3717     display ' i            ' i
  3718     display ' extra per    ' cp-extra-periods
  3719     display ' prem rate    ' cp-premium-rate
  3720     display '************************************'
  3721***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3722***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3723     compute wk3 = ra * (m - anglemy) / i * (1 +
  3724        (cp-extra-periods * i)) * cp-premium-rate / 100
  3725     move wk3                    to cp-calc-premium
  3726     compute wk3 rounded =
  3727        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3728     move wk3                    to cp-lf-balloon-prem
  3729     GO TO 99999-RETURN.
  3730     .
  3731 12000-CHECK-NC-WDS.
  3732
  3733     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3734        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3735        (CP-EARN-AS-NET-PAY)
  3736        NEXT SENTENCE
  3737     ELSE
  3738        GO TO 12000-CHECK-NC-BALL-LEV.
  3739
  3740     COMPUTE WK4 EQUAL N * (1 + I * 2).
  3741     COMPUTE ANGLEN EQUAL WK1 / I.
  3742     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3743              CP-PREMIUM-RATE / +100 *
  3744              N / +12 * 2 / (N + 1) *
  3745              (WK4 - ANGLEN) / (I * ANGLEN).
  3746
  3747      MOVE WK3 TO CP-CALC-PREMIUM.
  3748
  3749     GO TO 99999-RETURN.
  3750
  3751 12000-CHECK-NC-BALL-LEV.
  3752
  3753     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  70
* ELRFND.cbl
  3754        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3755        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3756        (CP-EARN-AS-REG-BALLOON)
  3757        NEXT SENTENCE
  3758     ELSE
  3759        GO TO 12000-CHECK-NC-BALL.
  3760
  3761     COMPUTE ANGLEN EQUAL WK1 / I.
  3762
  3763**** VX = 1 / (1 + I)**N.
  3764
  3765     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3766        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  3767
  3768     MOVE WK3 TO CP-CALC-PREMIUM.
  3769
  3770     GO TO 99999-RETURN.
  3771
  3772 12000-CHECK-NC-BALL.
  3773
  3774     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3775        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3776        (CP-EARN-AS-REG-BALLOON)
  3777        NEXT SENTENCE
  3778     ELSE
  3779        GO TO 12000-CHECK-MINN-TRUNC.
  3780
  3781     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  3782     COMPUTE ANGLEN EQUAL WK1 / I.
  3783     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3784**** VX = 1 / (1 + I)**N.
  3785
  3786     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3787     / +100 * (N - 1) / 12 * 2 / N *
  3788     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  3789
  3790      MOVE WK3 TO CP-CALC-PREMIUM.
  3791
  3792     GO TO 99999-RETURN.
  3793
  3794 12000-CHECK-MINN-TRUNC.
  3795
  3796     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3797        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3798        (M GREATER THAN +63) AND
  3799        (CP-EARN-AS-NET-PAY) AND
  3800        (CP-TRUNCATED-LIFE)
  3801        NEXT SENTENCE
  3802     ELSE
  3803        GO TO 12000-CHECK-MINN.
  3804
  3805      COMPUTE ANGLEN EQUAL WK1 / I.
  3806      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3807
  3808      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3809
  3810      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3811       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  71
* ELRFND.cbl
  3812       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  3813
  3814      MOVE WK3 TO CP-CALC-PREMIUM.
  3815
  3816     GO TO 99999-RETURN.
  3817
  3818 12000-CHECK-MINN.
  3819
  3820     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3821        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3822        (M GREATER THAN +63) AND
  3823        (CP-EARN-AS-NET-PAY)
  3824        NEXT SENTENCE
  3825     ELSE
  3826        GO TO 12000-CHECK-MONTANA-TRUNC.
  3827
  3828      COMPUTE ANGLEN EQUAL WK1 / I.
  3829
  3830      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3831
  3832      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3833       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3834       (((N - ANGLEN) / I) + (2 * N)).
  3835
  3836      MOVE WK3 TO CP-CALC-PREMIUM.
  3837
  3838     GO TO 99999-RETURN.
  3839
  3840 12000-CHECK-MONTANA-TRUNC.
  3841
  3842     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3843        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3844        (M GREATER THAN +63) AND
  3845        (CP-EARN-AS-NET-PAY) AND
  3846        (CP-TRUNCATED-LIFE)
  3847        NEXT SENTENCE
  3848     ELSE
  3849        GO TO 12000-CHECK-MONTANA.
  3850
  3851      COMPUTE ANGLEN EQUAL WK1 / I.
  3852      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3853
  3854      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3855
  3856      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3857      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3858       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  3859
  3860      MOVE WK3 TO CP-CALC-PREMIUM.
  3861
  3862     GO TO 99999-RETURN.
  3863
  3864 12000-CHECK-MONTANA.
  3865
  3866     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3867        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3868        (M GREATER THAN +63) AND
  3869        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  72
* ELRFND.cbl
  3870        NEXT SENTENCE
  3871     ELSE
  3872        GO TO 12001-CONTINUE-NCL-TRUNC.
  3873
  3874      COMPUTE ANGLEN EQUAL WK1 / I.
  3875
  3876      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3877
  3878      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3879       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3880       (((N - ANGLEN) / I) + (4 * N)).
  3881
  3882      MOVE WK3 TO CP-CALC-PREMIUM.
  3883
  3884     GO TO 99999-RETURN.
  3885
  3886 12001-CONTINUE-NCL-TRUNC.
  3887
  3888     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3889        (CP-EARN-AS-NET-PAY) AND
  3890        (CP-TRUNCATED-LIFE)
  3891        NEXT SENTENCE
  3892     ELSE
  3893        GO TO 12001-CONTINUE-NCL.
  3894
  3895      COMPUTE ANGLEN EQUAL WK1 / I.
  3896      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3897
  3898      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3899
  3900      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  3901      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  3902      (ANGLEN-1 * (N + 1) * I).
  3903
  3904      MOVE WK3 TO CP-CALC-PREMIUM.
  3905
  3906     GO TO 99999-RETURN.
  3907
  3908 12001-CONTINUE-NCL.
  3909
  3910     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3911        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3912        (CP-EARN-AS-NET-PAY)
  3913        GO TO 12001-CHECK-NC-NET-PLUS3.
  3914
  3915     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3916        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3917        (CP-EARN-AS-NET-PAY)
  3918        GO TO 12001-CHECK-CA.
  3919
  3920     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3921        (CP-EARN-AS-NET-PAY)
  3922        NEXT SENTENCE
  3923     ELSE
  3924        GO TO 12000-CONTINUE-NET.
  3925
  3926      COMPUTE ANGLEN EQUAL WK1 / I.
  3927      MOVE ANGLEN                TO ANGLEN-1.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  73
* ELRFND.cbl
  3928
  3929      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3930
  3931      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3932       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3933       ((N - ANGLEN) / I).
  3934
  3935      MOVE WK3 TO CP-CALC-PREMIUM.
  3936
  3937     GO TO 99999-RETURN.
  3938
  3939 12000-CONTINUE-NET.
  3940
  3941     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  3942        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  3943        (CP-EARN-AS-NET-PAY)
  3944        NEXT SENTENCE
  3945     ELSE
  3946        GO TO 12001-CONTINUE-MINN.
  3947
  3948      COMPUTE ANGLEN EQUAL WK6 / I.
  3949      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  3950
  3951      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  3952      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  3953      COMPUTE WK3 EQUAL (WK3 / I) *
  3954       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  3955
  3956      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  3957         MOVE +0 TO CP-R-MAX-TOT-BEN.
  3958
  3959      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  3960
  3961      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  3962         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  3963         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  3964
  3965      MOVE WK3 TO CP-CALC-PREMIUM.
  3966
  3967     GO TO 99999-RETURN.
  3968
  3969 12001-CONTINUE-MINN.
  3970
  3971     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3972        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  3973        (CP-TRUNCATED-LIFE)
  3974        NEXT SENTENCE
  3975     ELSE
  3976        GO TO 12001-CHECK-RI-GTL.
  3977
  3978      COMPUTE ANGLEN EQUAL WK1 / I.
  3979      COMPUTE ANGLEM EQUAL WK2 / I.
  3980
  3981      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  3982       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  3983       * M / 2400) * 1000 + .5) / 1000000.
  3984
  3985      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  74
* ELRFND.cbl
  3986       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  3987
  3988     GO TO 99999-RETURN.
  3989
  3990 12001-CHECK-RI-GTL.
  3991
  3992     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3993        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3994        (CP-EARN-AS-NET-PAY)
  3995        NEXT SENTENCE
  3996     ELSE
  3997        GO TO 12001-CHECK-RI-LEASE-GTL.
  3998
  3999      COMPUTE ANGLEN EQUAL WK1 / I.
  4000*     COMPUTE ANGLEM EQUAL WK2 / I.
  4001
  4002      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4003               (1 + WS-WORK-DIS-RATE * N).
  4004      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4005         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4006
  4007
  4008     GO TO 99999-RETURN.
  4009
  4010 12001-CHECK-RI-LEASE-GTL.
  4011
  4012     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4013        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4014        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4015        NEXT SENTENCE
  4016     ELSE
  4017        GO TO 12001-CHECK-OR-GTL.
  4018
  4019     COMPUTE ANGLEN EQUAL WK1 / I.
  4020
  4021     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4022        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4023                        /
  4024        (1000 * I * (1 + .0021 * N)).
  4025     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4026       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4027                            /
  4028       (1000 * (1 + .0027 * (N + 1))).
  4029
  4030     GO TO 99999-RETURN.
  4031
  4032 12001-CHECK-OR-GTL.
  4033
  4034     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4035        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4036        (CP-EARN-AS-NET-PAY)
  4037        NEXT SENTENCE
  4038     ELSE
  4039        GO TO 12001-CHECK-GA-GTL.
  4040
  4041     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4042     COMPUTE ANGLEN EQUAL WK1 / I.
  4043
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  75
* ELRFND.cbl
  4044     IF M LESS THAN +64
  4045        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4046         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4047                   /
  4048         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4049        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4050     ELSE
  4051        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4052        CP-PREMIUM-RATE * (1 + I))
  4053                  /
  4054        (+1000 * I * ANGLEN)
  4055        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4056*    MOVE WK3 TO CP-CALC-PREMIUM.
  4057     GO TO 99999-RETURN.
  4058
  4059 12001-CHECK-GA-GTL.
  4060
  4061     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4062        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4063        (CP-EARN-AS-NET-PAY)
  4064*       (CP-TRUNCATED-LIFE)
  4065        NEXT SENTENCE
  4066     ELSE
  4067        GO TO 12001-CHECK-MA-GTL.
  4068
  4069     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4070     COMPUTE ANGLEN EQUAL WK1 / I.
  4071
  4072     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4073     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4074      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4075     MOVE WK3 TO CP-CALC-PREMIUM.
  4076
  4077     GO TO 99999-RETURN.
  4078
  4079 12001-CHECK-MA-GTL.
  4080
  4081     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4082        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4083        (CP-EARN-AS-NET-PAY) AND
  4084        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4085        NEXT SENTENCE
  4086     ELSE
  4087        GO TO 12001-CHECK-NV-NET.
  4088
  4089     COMPUTE ANGLEN EQUAL WK1 / I.
  4090
  4091     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4092      CP-ALTERNATE-BENEFIT * N.
  4093
  4094     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4095     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4096
  4097     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4098     WK7 * (N - ANGLEN) / I.
  4099     MOVE WK3 TO CP-CALC-PREMIUM.
  4100
  4101     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  76
* ELRFND.cbl
  4102
  4103 12001-CHECK-NV-NET.
  4104     IF (CP-COMPANY-ID EQUAL 'CID')
  4105        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4106        AND (CP-EARN-AS-NET-PAY)
  4107        CONTINUE
  4108     ELSE
  4109        GO TO 12001-CHECK-MN-NET
  4110     END-IF
  4111     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4112     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4113     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4114                   / (1 + I)
  4115     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4116     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4117     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4118        (CP-PREMIUM-RATE * K-I / 1000)
  4119     MOVE WK3                    TO CP-CALC-PREMIUM
  4120     GO TO 99999-RETURN
  4121      .
  4122 12001-CHECK-MN-NET.
  4123     IF (CP-COMPANY-ID EQUAL 'CID')
  4124        AND (CP-STATE-STD-ABBRV = 'MN')
  4125        AND (CP-EARN-AS-NET-PAY)
  4126        AND (NOT CP-LEVEL-LIFE)
  4127        AND (WS-DISCOUNT-OPTION = '1')
  4128        CONTINUE
  4129     ELSE
  4130        GO TO 12001-CHECK-NC-NET
  4131     END-IF
  4132     if i = .0000000001
  4133        compute wk4 = cp-original-benefit / n
  4134        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  4135           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  4136        move wk3 to cp-calc-premium
  4137        go to 99999-return
  4138     end-if
  4139     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4140     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4141     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4142                   / (1 + I)
  4143     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4144     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4145     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4146        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4147     MOVE WK3                    TO CP-CALC-PREMIUM
  4148     GO TO 99999-RETURN
  4149      .
  4150 12001-CHECK-NC-NET.
  4151
  4152     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4153        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4154        (CP-EARN-AS-NET-PAY)
  4155        NEXT SENTENCE
  4156     ELSE
  4157        GO TO 12001-CHECK-NC-NET-PLUS3.
  4158
  4159      COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  77
* ELRFND.cbl
  4160      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4161
  4162      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4163          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4164          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4165          N * (CP-PREMIUM-RATE / 1000)).
  4166
  4167      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4168          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4169
  4170      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4171          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4172          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4173          (ANGLEN * 2))
  4174
  4175      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4176
  4177      IF ANGLEN IS NOT LESS THAN WK7
  4178          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4179              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4180          COMPUTE WK3 ROUNDED =
  4181              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4182
  4183     MOVE WK3 TO CP-CALC-PREMIUM.
  4184
  4185     GO TO 99999-RETURN.
  4186
  4187 12001-CHECK-NC-NET-PLUS3.
  4188
  4189     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4190        (CP-EARN-AS-NET-PAY) AND
  4191        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  4192        NEXT SENTENCE
  4193     ELSE
  4194        GO TO 12001-CHECK-CA.
  4195
  4196     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4197     MOVE ' ' TO DC-OPTION-CODE.
  4198     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4199
  4200     IF DATE-CONVERSION-ERROR
  4201        MOVE '2'                 TO CP-RETURN-CODE
  4202        MOVE ZEROS               TO FACTOR
  4203                                    CP-CALC-PREMIUM
  4204         GO TO 99999-RETURN.
  4205
  4206     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4207        NEXT SENTENCE
  4208     ELSE
  4209        GO TO 12001-CONTINUE-NET.
  4210
  4211     COMPUTE ANGLEN EQUAL WK1 / I.
  4212     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4213
  4214     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4215
  4216     COMPUTE NC-R = 20 *
  4217                    ((NC-LR * ORIGINAL-TERM) / 12)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  78
* ELRFND.cbl
  4218                          / (ORIGINAL-TERM + 1).
  4219
  4220     COMPUTE NC-OB = NC-R / 1000.
  4221
  4222     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4223                    (NC-OB * ORIGINAL-TERM * 3).
  4224
  4225     IF CP-EXT-CHG-LF
  4226         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4227     ELSE
  4228         MOVE 30                 TO  NC-BIG-D.
  4229
  4230     COMPUTE NC-LITTLE-D = (1 + I) /
  4231             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4232
  4233     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4234             (ANGLEN * NC-LITTLE-D ).
  4235
  4236     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4237
  4238     GO TO 99999-RETURN.
  4239
  4240 12001-CHECK-CA.
  4241
  4242     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4243        (WS-DISCOUNT-OPTION = '6')
  4244        NEXT SENTENCE
  4245     ELSE
  4246        GO TO 12001-CHECK-GTL-IA.
  4247
  4248     COMPUTE CA-J = CA-DISCOUNT / 12.
  4249     COMPUTE ANGLEN EQUAL WK1 / I.
  4250     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4251     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4252     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4253     COMPUTE CA-VI = (1 + I)** -1.
  4254     COMPUTE CP-CALC-PREMIUM =
  4255         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4256         ((1 + CA-J) / I) *
  4257         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4258         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4259         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4260
  4261     GO TO 99999-RETURN.
  4262
  4263 12001-CHECK-GTL-IA.
  4264
  4265     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4266        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4267        (CP-EARN-AS-NET-PAY)
  4268        NEXT SENTENCE
  4269     ELSE
  4270        GO TO 12001-CHECK-CID-TRN-VA.
  4271
  4272***************************************************************
  4273
  4274     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4275
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  79
* ELRFND.cbl
  4276     IF GTL-IA-ODD-DAYS = ZEROS
  4277         MOVE ZERO               TO  GTL-IA-SGN
  4278     ELSE
  4279         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4280             MOVE +1             TO  GTL-IA-SGN
  4281         ELSE
  4282             MOVE -1             TO  GTL-IA-SGN.
  4283
  4284     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4285     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4286
  4287     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4288                          GTL-IA-SGN.
  4289
  4290     COMPUTE ANGLEN EQUAL WK1 / I.
  4291     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4292
  4293     IF GTL-IA-ODF NOT = ZERO
  4294         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4295         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4296
  4297     COMPUTE GTL-IA-DIVIDEND =
  4298           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4299                             (ANGLEN - ANGLEN-M))) *
  4300           ((K1 + I) * CP-PREMIUM-RATE *
  4301                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4302
  4303     COMPUTE GTL-IA-DIVISOR =
  4304      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4305
  4306     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4307
  4308     COMPUTE CP-CALC-PREMIUM =
  4309                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4310     GO TO 99999-RETURN.
  4311
  4312
  4313 12001-CHECK-CID-TRN-VA.
  4314
  4315     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4316        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4317        (CP-EARN-AS-NET-PAY) AND
  4318        (CP-TRUNCATED-LIFE) AND
  4319        (CP-STATE-STD-ABBRV = CP-STATE)
  4320        CONTINUE
  4321     ELSE
  4322        GO TO 12001-CHECK-CID-TX
  4323     END-IF
  4324
  4325     COMPUTE ANGLEN EQUAL WK1 / I
  4326     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4327     IF WS-WORK-DIS-RATE = ZEROS
  4328        CONTINUE
  4329     ELSE
  4330        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4331        COMPUTE WK7 = (1 / I) *
  4332              (((WK4 ** M - 1) / (WK4 - 1)) -
  4333              ((WK4 ** M * SX - VX) /
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  80
* ELRFND.cbl
  4334              (WK4 * (1 + I) - 1))) *
  4335              (CP-PREMIUM-RATE / 1000)
  4336        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4337        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4338        COMPUTE CP-CALC-PREMIUM =
  4339           WK8 *  ((WK4 * ANGLEN) / 100)
  4340     END-IF
  4341
  4342     GO TO 99999-RETURN
  4343
  4344     .
  4345
  4346 12001-CHECK-CID-TX.
  4347     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4348        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4349        (CP-EARN-AS-NET-PAY) AND
  4350        (WS-WORK-DIS-RATE > ZEROS) AND
  4351        (CP-STATE-STD-ABBRV = CP-STATE)
  4352        CONTINUE
  4353     ELSE
  4354        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4355     END-IF
  4356* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4357     COMPUTE K-I = 1 + (1 * I)
  4358     COMPUTE ANGLEm EQUAL WK1 / I   *>   Loan term
  4359     COMPUTE ANGLEn EQUAL WK2 / I   *>   Ins  term
  4360     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4361
  4362     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4363     COMPUTE ANGLEmy = ANGLEm / Y
  4364     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4365     IF WS-WORK-DIS-RATE = ZEROS
  4366        CONTINUE
  4367     ELSE
  4368        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4369        COMPUTE WK7 = (K-I / I) *
  4370              (((WK4 ** M - 1) / (WK4 - 1)) -
  4371*             ((WK4 ** M * SX - VX) /
  4372              ((WK4 ** M * SX) - VX) /
  4373*             (WK4 * (1 + I) - 1))) *
  4374              (WK4 * (1 + I) - 1)) *
  4375              (CP-PREMIUM-RATE / 1000)
  4376        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEmy
  4377        COMPUTE WK8 = (WK7 * 100) / (ANGLEmy * K-I)
  4378        COMPUTE CP-CALC-PREMIUM =
  4379           WK8 *  ((WK4 * ANGLEmy * K-I) / 100)
  4380     END-IF
  4381
  4382     GO TO 99999-RETURN
  4383     .
  4384 12001-CHECK-CID-LEV-MN-NEW.
  4385*    IF (CP-COMPANY-ID EQUAL 'CID')
  4386*       AND (CP-STATE-STD-ABBRV = 'MN')
  4387*       AND (CP-EARN-AS-NET-PAY)
  4388*       AND (CP-LEVEL-LIFE)
  4389*       AND (CP-CERT-EFF-DT > X'A4FF')
  4390*       CONTINUE
  4391*    ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  81
* ELRFND.cbl
  4392*       GO TO 12001-CHECK-CID-LEV-MN
  4393*    END-IF
  4394*
  4395*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4396*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4397*    MOVE '1'                    TO DC-OPTION-CODE
  4398*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4399*
  4400*    IF DATE-CONVERSION-ERROR
  4401*       MOVE '2'                 TO CP-RETURN-CODE
  4402*       MOVE ZEROS               TO FACTOR
  4403*                                   CP-CALC-PREMIUM
  4404*       GO TO 99999-RETURN
  4405*    END-IF
  4406*
  4407*    COMPUTE I = CP-LOAN-APR / 100
  4408*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4409*
  4410*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4411*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4412*      * 12 / 360 * D)
  4413*
  4414*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4415*       * 12 / 360 * D
  4416*
  4417*    GO TO 99999-RETURN
  4418      .
  4419 12001-CHECK-CID-LEV-MN.
  4420
  4421     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4422        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4423        (CP-EARN-AS-NET-PAY) AND
  4424        (CP-LEVEL-LIFE) AND
  4425        (CP-STATE-STD-ABBRV = CP-STATE)
  4426        CONTINUE
  4427     ELSE
  4428        GO TO 12001-CHECK-CID-LEV-CA
  4429     END-IF
  4430
  4431     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4432         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4433         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4434
  4435     GO TO 99999-RETURN
  4436
  4437      .
  4438 12001-CHECK-CID-LEV-CA.
  4439
  4440     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4441        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4442        (CP-EARN-AS-NET-PAY) AND
  4443        (CP-LEVEL-LIFE) AND
  4444        (CP-STATE-STD-ABBRV = CP-STATE)
  4445        CONTINUE
  4446     ELSE
  4447        GO TO 12001-CHECK-CID-TRN-CA
  4448     END-IF
  4449
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  82
* ELRFND.cbl
  4450     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4451     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4452     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4453     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4454     COMPUTE CP-CALC-PREMIUM =
  4455          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4456          (CP-PREMIUM-RATE / 1000)) /
  4457          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4458
  4459     GO TO 99999-RETURN
  4460
  4461      .
  4462 12001-CHECK-CID-TRN-CA.
  4463
  4464     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4465        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4466        (CP-EARN-AS-NET-PAY) AND
  4467        (CP-TRUNCATED-LIFE) AND
  4468        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4469        (WS-DISCOUNT-OPTION NOT = ' ')
  4470        CONTINUE
  4471     ELSE
  4472        GO TO 12001-CHECK-CID-TRN-MT
  4473     END-IF
  4474
  4475     COMPUTE ANGLEN EQUAL WK1 / I
  4476     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4477     IF WS-WORK-DIS-RATE = ZEROS
  4478        CONTINUE
  4479     ELSE
  4480        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4481        COMPUTE WK7 = (1 / I) *
  4482              (((WK4 ** M - 1) / (WK4 - 1)) -
  4483              ((WK4 ** M * SX - VX) /
  4484              (WK4 * (1 + I) - 1))) *
  4485              (CP-PREMIUM-RATE / 1000)
  4486        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4487        COMPUTE CP-CALC-PREMIUM =
  4488           WK4 *  WK7
  4489     END-IF
  4490
  4491     GO TO 99999-RETURN
  4492
  4493      .
  4494 12001-CHECK-CID-TRN-MT.
  4495
  4496     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4497        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4498                   OR
  4499        ((CP-STATE-STD-ABBRV = 'IN') AND
  4500        (CP-CERT-EFF-DT > X'9A7F'))
  4501                   OR
  4502        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4503        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4504        (CP-EARN-AS-NET-PAY) AND
  4505        (CP-TRUNCATED-LIFE) AND
  4506        (CP-STATE-STD-ABBRV = CP-STATE)
  4507        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  83
* ELRFND.cbl
  4508     ELSE
  4509        GO TO 12001-CHECK-CID-MT
  4510     END-IF
  4511
  4512* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4513     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4514        MOVE 0                   TO K-I
  4515     ELSE
  4516        MOVE 2                   TO K-I
  4517     END-IF
  4518     COMPUTE CP-TERM-OR-EXT-DAYS =
  4519           CP-TERM-OR-EXT-DAYS + 30
  4520
  4521     COMPUTE ANGLEN EQUAL WK1 / I
  4522     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4523     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4524                   / (1 + I)
  4525     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4526     IF WS-WORK-DIS-RATE = ZEROS
  4527        CONTINUE
  4528     ELSE
  4529        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4530*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4531        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4532              (((WK4 ** M - 1) / (WK4 - 1)) -
  4533              ((WK4 ** M * SX - VX) /
  4534              (WK4 * (1 + I) - 1))) *
  4535              (CP-PREMIUM-RATE / 1000)
  4536        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4537*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4538        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4539        COMPUTE CP-CALC-PREMIUM =
  4540           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4541*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4542     END-IF
  4543
  4544     GO TO 99999-RETURN
  4545
  4546     .
  4547 12001-CHECK-CID-MT.
  4548
  4549     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4550        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4551                                OR 'VT')
  4552                   OR
  4553        ((CP-STATE-STD-ABBRV = 'IN') AND
  4554        (CP-CERT-EFF-DT > X'9A7F'))
  4555                   OR
  4556        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4557        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4558        (CP-EARN-AS-NET-PAY) AND
  4559        (CP-STATE-STD-ABBRV = CP-STATE)
  4560        CONTINUE
  4561     ELSE
  4562        GO TO 12001-CHECK-DCC-DD
  4563     END-IF
  4564
  4565     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  84
* ELRFND.cbl
  4566           CP-TERM-OR-EXT-DAYS + 30
  4567
  4568* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4569     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4570        MOVE 0                   TO K-I
  4571     ELSE
  4572        IF CP-STATE-STD-ABBRV = 'NJ'
  4573           MOVE 1                TO K-I
  4574        ELSE
  4575           MOVE 2                TO K-I
  4576        END-IF
  4577     END-IF
  4578     COMPUTE ANGLEN EQUAL WK1 / I
  4579     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4580     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4581                   / (1 + I)
  4582     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4583     IF WS-WORK-DIS-RATE = ZEROS
  4584        CONTINUE
  4585     ELSE
  4586        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4587*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4588        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4589              (((WK4 ** N - 1) / (WK4 - 1)) -
  4590              ((WK4 ** N - SV) /
  4591              (WK4 * (1 + I) - 1))) *
  4592              (CP-PREMIUM-RATE / 1000)
  4593        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4594*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4595        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4596        COMPUTE CP-CALC-PREMIUM =
  4597           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4598*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4599     END-IF
  4600
  4601     GO TO 99999-RETURN
  4602
  4603     .
  4604 12001-CHECK-DCC-DD.
  4605     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4606        AND (CP-EARN-AS-NET-PAY)
  4607        AND (CP-BEN-CATEGORY = 'D')
  4608        CONTINUE
  4609     ELSE
  4610        GO TO 12001-CHECK-DCC-NET
  4611     END-IF
  4612
  4613     COMPUTE CP-TERM-OR-EXT-DAYS =
  4614           CP-TERM-OR-EXT-DAYS + 30
  4615
  4616     COMPUTE ANGLEN EQUAL WK1 / I.
  4617     COMPUTE ANGLEM EQUAL WK2 / I.
  4618     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4619
  4620     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4621           / (1 + I)
  4622     COMPUTE GR     = ANGLEN / ODF
  4623*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  85
* ELRFND.cbl
  4624*      CP-RATE-DEV-PCT
  4625     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4626     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4627       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4628     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4629     MOVE WK3                    TO CP-CALC-PREMIUM
  4630
  4631     GO TO 99999-RETURN
  4632
  4633     .
  4634 12001-CHECK-DCC-NET.
  4635
  4636     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4637        AND (CP-EARN-AS-NET-PAY)
  4638        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4639             AND 'H' AND 'S' AND 'P')
  4640        CONTINUE
  4641     ELSE
  4642        GO TO 12001-CHECK-DCC-PNET
  4643     END-IF
  4644
  4645     COMPUTE CP-TERM-OR-EXT-DAYS =
  4646           CP-TERM-OR-EXT-DAYS + 30
  4647
  4648     COMPUTE ANGLEN EQUAL WK1 / I.
  4649     COMPUTE ANGLEM EQUAL WK2 / I.
  4650     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4651
  4652     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4653           / (1 + I)
  4654     COMPUTE GR     = ANGLEN / ODF
  4655     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4656     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4657       CP-RATE-DEV-PCT
  4658     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4659*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4660
  4661     COMPUTE WK8 = CP-PREMIUM-RATE *
  4662        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4663     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4664     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4665     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4666       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4667     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4668     MOVE WK3                    TO CP-CALC-PREMIUM
  4669
  4670     GO TO 99999-RETURN
  4671
  4672     .
  4673 12001-CHECK-DCC-PNET.
  4674     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4675        AND (CP-EARN-AS-NET-PAY)
  4676        AND (CP-BENEFIT-CD (1:1) = 'P')
  4677        CONTINUE
  4678     ELSE
  4679        GO TO 12001-CHECK-DCC-MNET
  4680     END-IF
  4681     IF CP-NO-OF-PMTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  86
* ELRFND.cbl
  4682        MOVE +0                  TO CP-NO-OF-PMTS
  4683     END-IF
  4684     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4685        AND ' ' AND 'M'
  4686        MOVE ' '                 TO CP-PMT-MODE
  4687     END-IF
  4688******************************************************************
  4689***   Default is monthly, use loan term for rate and amort     ***
  4690******************************************************************
  4691     move cp-loan-term         to c-tot-pmts
  4692     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4693     MOVE +12                  TO C-PMTS-PER-YEAR
  4694******************************************************************
  4695
  4696     evaluate true
  4697        when cp-pmt-mode = 'W'
  4698           MOVE +52              TO C-PMTS-PER-YEAR
  4699           compute c-tot-pmts = cp-loan-term /
  4700              12 * c-pmts-per-year
  4701           MOVE +7               TO C-DAYS-IN-PMT-PER
  4702        when cp-pmt-mode = 'B'
  4703           MOVE +26              TO C-PMTS-PER-YEAR
  4704           compute c-tot-pmts = cp-loan-term /
  4705              12 * c-pmts-per-year
  4706           MOVE +14              TO C-DAYS-IN-PMT-PER
  4707     end-evaluate
  4708     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4709     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4710        C-DAYS-IN-PMT-PER)) / (1 + I)
  4711     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4712*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4713     COMPUTE ANGLEN-1 = ANGLEN / Y
  4714     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4715     IF CP-RATE-DEV-PCT NOT = ZEROS
  4716        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4717           CP-PREMIUM-RATE
  4718     END-IF
  4719     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4720     GO TO 99999-RETURN
  4721     .
  4722 12001-CHECK-DCC-MNET.
  4723
  4724     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4725        AND (CP-EARN-AS-NET-PAY)
  4726        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4727        CONTINUE
  4728     ELSE
  4729        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4730     END-IF
  4731
  4732*    COMPUTE ANGLEN EQUAL WK1 / I.
  4733*    COMPUTE ANGLEM EQUAL WK2 / I.
  4734*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  4735
  4736     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4737     MOVE WK3                    TO CP-CALC-PREMIUM
  4738
  4739     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  87
* ELRFND.cbl
  4740
  4741     .
  4742 12001-CHECK-DCC-MNET-LF-BAL.
  4743
  4744     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4745        AND (CP-EARN-AS-NET-PAY)
  4746        AND (CP-BENEFIT-CD (1:1) = 'N')
  4747        AND (CP-BEN-CATEGORY NOT = 'N')
  4748        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4749        CONTINUE
  4750     ELSE
  4751        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4752     END-IF
  4753
  4754     IF CP-RATE-DEV-PCT NOT = ZEROS
  4755        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4756           CP-PREMIUM-RATE
  4757     END-IF
  4758*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4759     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4760        / (1 + I)
  4761     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4762     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4763     COMPUTE WK2 = (1 + J) ** (M * -1)
  4764     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4765     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4766          ** ((M - 1) * -1))) / J)
  4767     COMPUTE ANGLEM = ((1 - ((1 + J)
  4768          ** (M * -1))) / J) / OD
  4769     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4770        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4771        / ANGLEM-1
  4772     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4773          ** ((N - M) * -1))) / I)
  4774     MOVE +0                     TO WK3
  4775     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4776        (WS-COUNTER > M)
  4777        COMPUTE ANGLEM = (1 - ((1 + J)
  4778          ** ((M - WS-COUNTER) * -1))) / J
  4779        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4780        COMPUTE WK5-CSL = (RA * ANGLEM)
  4781        + (CP-ALTERNATE-BENEFIT * WK2)
  4782        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4783     END-PERFORM
  4784     MOVE WK3                    TO CP-CALC-PREMIUM
  4785
  4786     GO TO 99999-RETURN
  4787
  4788     .
  4789 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4790
  4791     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4792        AND (CP-EARN-AS-NET-PAY)
  4793        AND (CP-BENEFIT-CD (1:1) = 'S')
  4794        AND (CP-BEN-CATEGORY NOT = 'N')
  4795        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4796        CONTINUE
  4797     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  88
* ELRFND.cbl
  4798        GO TO 12001-CHECK-DCC-MNET-LF
  4799     END-IF
  4800
  4801     IF CP-RATE-DEV-PCT NOT = ZEROS
  4802        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4803           CP-PREMIUM-RATE
  4804     END-IF
  4805     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4806     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4807          ** ((M - 1) * -1))) / K)
  4808     COMPUTE ANGLEM = ((1 - ((1 + K)
  4809          ** (M * -1))) / K)
  4810     MOVE CP-MONTHLY-PAYMENT     TO RA
  4811     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4812        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4813        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4814        CP-PREMIUM-RATE / 1000
  4815     MOVE WK3                    TO CP-CALC-PREMIUM
  4816
  4817     GO TO 99999-RETURN
  4818
  4819     .
  4820 12001-CHECK-DCC-MNET-LF.
  4821
  4822     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4823        AND (CP-EARN-AS-NET-PAY)
  4824        AND (CP-BENEFIT-CD (1:1) = 'N')
  4825        AND (CP-BEN-CATEGORY NOT = 'N')
  4826        CONTINUE
  4827     ELSE
  4828        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4829     END-IF
  4830
  4831     IF CP-RATE-DEV-PCT NOT = ZEROS
  4832        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4833           CP-PREMIUM-RATE
  4834     END-IF
  4835*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4836     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4837        / (1 + I)
  4838     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4839     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4840     COMPUTE WK2 = (1 + J) ** (M * -1)
  4841     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4842     COMPUTE ANGLEM = ((1 - ((1 + J)
  4843          ** (M * -1))) / J) / OD
  4844     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4845     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4846          ** ((N - M) * -1))) / I)
  4847     MOVE +0                     TO WK3
  4848     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4849        (WS-COUNTER > M)
  4850        COMPUTE ANGLEM = (1 - ((1 + J)
  4851          ** ((M - WS-COUNTER + 1) * -1))) / J
  4852        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4853        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4854        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4855     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  89
* ELRFND.cbl
  4856     MOVE WK3                    TO CP-CALC-PREMIUM
  4857
  4858     GO TO 99999-RETURN
  4859
  4860     .
  4861 12001-CHECK-DCC-MNET-SUMLF.
  4862
  4863     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4864        AND (CP-EARN-AS-NET-PAY)
  4865        AND (CP-BENEFIT-CD (1:1) = 'S')
  4866        AND (CP-BEN-CATEGORY NOT = 'N')
  4867        CONTINUE
  4868     ELSE
  4869        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4870     END-IF
  4871
  4872     IF CP-RATE-DEV-PCT NOT = ZEROS
  4873        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4874           CP-PREMIUM-RATE
  4875     END-IF
  4876     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4877     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4878        / (1 + K)
  4879     COMPUTE ANGLEN-M = (WK5 / I)
  4880     COMPUTE WK2 = (1 + K) ** (M * -1)
  4881     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4882     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4883     COMPUTE ANGLEM = ((1 - ((1 + K)
  4884          ** (M * -1))) / K) / Y
  4885     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4886     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4887        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4888        - 1)) / K) * RA
  4889     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4890        + (CP-DAYS-TO-1ST-PMT - +30)
  4891        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4892        +0 / 1000 * 12 / 12)
  4893     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4894        * (12 / 12)
  4895     MOVE WK3                    TO CP-CALC-PREMIUM
  4896
  4897     GO TO 99999-RETURN
  4898
  4899     .
  4900 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4901
  4902     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4903        AND (CP-EARN-AS-NET-PAY)
  4904        AND (CP-BENEFIT-CD (1:1) = 'N')
  4905        AND (CP-BEN-CATEGORY = 'N')
  4906        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4907        CONTINUE
  4908     ELSE
  4909        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4910     END-IF
  4911
  4912*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4913     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  90
* ELRFND.cbl
  4914        / (1 + I)
  4915     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4916     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4917     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4918     COMPUTE WK2 = (1 + J) ** (M * -1)
  4919     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4920     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4921          ** ((M - 1) * -1))) / J)
  4922     COMPUTE ANGLEM = ((1 - ((1 + J)
  4923          ** (M * -1))) / J) / OD
  4924     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4925        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4926        / ANGLEM-1
  4927     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4928          ** ((N - M) * -1))) / I)
  4929     MOVE +0                     TO WK3
  4930     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4931        (WS-COUNTER > M)
  4932        COMPUTE ANGLEM = (1 - ((1 + J)
  4933          ** ((M - WS-COUNTER) * -1))) / J
  4934        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4935        COMPUTE WK5-CSL = (RA * ANGLEM)
  4936        + (CP-ALTERNATE-BENEFIT * WK2)
  4937        COMPUTE WK3 = WK3 +
  4938         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4939        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4940          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4941          (CP-DCC-AH-RATE / 1000)
  4942     END-PERFORM
  4943     MOVE WK3                    TO CP-CALC-PREMIUM
  4944
  4945     GO TO 99999-RETURN
  4946
  4947     .
  4948 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4949
  4950     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4951        AND (CP-EARN-AS-NET-PAY)
  4952        AND (CP-BENEFIT-CD (1:1) = 'S')
  4953        AND (CP-BEN-CATEGORY = 'N')
  4954        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4955        CONTINUE
  4956     ELSE
  4957        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4958     END-IF
  4959
  4960     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4961     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4962          ** ((M - 1) * -1))) / K)
  4963     COMPUTE ANGLEM = ((1 - ((1 + K)
  4964          ** (M * -1))) / K)
  4965     MOVE CP-MONTHLY-PAYMENT     TO RA
  4966     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4967        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4968        * CP-DCC-AH-RATE / 1000))
  4969        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4970        CP-DCC-LF-RATE / 1000
  4971     MOVE WK3                    TO CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  91
* ELRFND.cbl
  4972     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4973        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4974        * CP-DCC-AH-RATE / 1000
  4975     COMPUTE WK3 = WK3 + WK5-CSL
  4976     MOVE WK3                    TO CP-CALC-PREMIUM
  4977
  4978     GO TO 99999-RETURN
  4979      .
  4980 12001-CHECK-DCC-MNET-TOT-N.
  4981
  4982     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4983        AND (CP-EARN-AS-NET-PAY)
  4984        AND (CP-BENEFIT-CD (1:1) = 'N')
  4985        AND (CP-BEN-CATEGORY = 'N')
  4986        CONTINUE
  4987     ELSE
  4988        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4989     END-IF
  4990
  4991*    I = APR/1200
  4992*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4993*    RA = PAYMENT AMOUNT
  4994*    WK5-CSL = THE BALANCE (PAY OFF )
  4995*    WK3 = THE ACCUMULATED PREMIUM
  4996*    WK2 = (1 + I) ^ (m * -1)
  4997*    OD  = GAMMA
  4998*
  4999*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5000     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5001        / (1 + I)
  5002     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5003     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5004        (CP-DCC-AH-RATE / +1000)
  5005     COMPUTE WK2 = (1 + J) ** (M * -1)
  5006     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5007     COMPUTE ANGLEM = ((1 - ((1 + J)
  5008          ** (M * -1))) / J) / OD
  5009     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5010     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5011          ** ((N - M) * -1))) / I)
  5012     MOVE +0                     TO WK3
  5013     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5014        (WS-COUNTER > M)
  5015        COMPUTE ANGLEM = (1 - ((1 + J)
  5016          ** ((M - WS-COUNTER + 1) * -1))) / J
  5017        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5018        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5019        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5020           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5021     END-PERFORM
  5022     MOVE WK3                    TO CP-CALC-PREMIUM
  5023
  5024     GO TO 99999-RETURN
  5025
  5026     .
  5027 12001-CHECK-DCC-MNET-TOT-S.
  5028
  5029     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  92
* ELRFND.cbl
  5030        AND (CP-EARN-AS-NET-PAY)
  5031        AND (CP-BENEFIT-CD (1:1) = 'S')
  5032        AND (CP-BEN-CATEGORY = 'N')
  5033        CONTINUE
  5034     ELSE
  5035        GO TO 12001-CONTINUE-NET
  5036     END-IF
  5037
  5038*    I = APR/1200
  5039*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5040*    RA = PAYMENT AMOUNT
  5041*    WK5-CSL = THE BALANCE (PAY OFF )
  5042*    WK3 = THE ACCUMULATED PREMIUM
  5043*    WK2 = (1 + I) ^ (m * -1)
  5044*    OD  = GAMMA
  5045*
  5046     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5047     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5048        / (1 + J)
  5049     COMPUTE ANGLEM = ((1 - ((1 + J)
  5050          ** (M * -1))) / J) / OD
  5051     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5052          ** ((N - M) * -1))) / I)
  5053          * (1 + J) ** (-1 * M)
  5054     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5055     MOVE CP-MONTHLY-PAYMENT     TO RA
  5056     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5057        / +30)
  5058     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5059        ** (WK1) - 1)) / J) * RA
  5060     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5061        + (CP-DAYS-TO-1ST-PMT - +30)
  5062        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5063        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5064     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5065        (12 / 12)
  5066     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5067        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5068        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5069     COMPUTE WK3 = WK3 + WK5-CSL
  5070     MOVE WK3                    TO CP-CALC-PREMIUM
  5071     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5072     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5073        / (1 + K)
  5074     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5075          ** ((N - M) * -1))) / I)
  5076     COMPUTE WK2 = (1 + K) ** (M * -1)
  5077     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5078     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5079     COMPUTE ANGLEM = ((1 - ((1 + K)
  5080          ** (M * -1))) / K) / Y
  5081*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5082     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5083        ((1 + K) ** (M + 1 / Y
  5084        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5085        - 1)) / K) * RA
  5086     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5087        + (CP-DAYS-TO-1ST-PMT - +30)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  93
* ELRFND.cbl
  5088        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5089        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5090     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5091        * (12 / 12)
  5092     MOVE WK3                    TO CP-LF-PREM
  5093
  5094     GO TO 99999-RETURN
  5095
  5096     .
  5097 12001-CONTINUE-NET.
  5098
  5099     IF NET-STD
  5100        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5101*          OR 'DCC'
  5102         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5103         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5104         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5105         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5106                               * ((1 + N) / (1 + M))
  5107         if (i = .0000000001)
  5108            and (wk3 = zeros)
  5109            move 1               to wk3
  5110         end-if
  5111        ELSE
  5112         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5113         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5114         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5115         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5116
  5117     IF NET-SMP
  5118         COMPUTE N2 = N * N
  5119         COMPUTE N3 = N2 * N
  5120         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5121         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5122         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5123         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5124         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5125
  5126     IF NPO-PRUDENTIAL
  5127       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5128           VARYING WS-COUNTER FROM 1 BY 1
  5129               UNTIL WS-COUNTER = N
  5130       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5131       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5132
  5133     MOVE WK3 TO FACTOR.
  5134
  5135     GO TO 99999-RETURN.
  5136
  5137 12100-PRU-CALC.
  5138     IF WS-COUNTER = 1
  5139         COMPUTE PWK = (I + 1)
  5140     ELSE
  5141         COMPUTE PWK = PWK * (I + 1).
  5142
  5143 12199-EXIT.
  5144      EXIT.
  5145
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  94
* ELRFND.cbl
  5146 99000-ERROR.
  5147     MOVE +9999.999999999 TO N-P-FACTOR.
  5148     MOVE '4'             TO CP-RETURN-CODE.
  5149
  5150     GO TO 99999-EXIT.
  5151
  5152 99999-RETURN.
  5153     MOVE FACTOR          TO N-P-FACTOR.
  5154
  5155 99999-EXIT.
  5156      EXIT.
  5157
  5158 9999-DFHBACK SECTION.
  5159     MOVE '9%                    "   ' TO DFHEIV0
  5160     MOVE 'ELRFND' TO DFHEIV1
  5161     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5162     GOBACK.
  5163 9999-DFHEXIT.
  5164     IF DFHEIGDJ EQUAL 0001
  5165         NEXT SENTENCE.
  5166     MOVE '9%                    "   ' TO DFHEIV0
  5167     MOVE 'ELRFND' TO DFHEIV1
  5168     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5169     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3084     Code:       45083
