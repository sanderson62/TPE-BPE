* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63******************************************************************
    64
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   3
* EL156.cbl
    66 ENVIRONMENT DIVISION.
    67
    68 DATA DIVISION.
    69
    70 WORKING-STORAGE SECTION.
    71 01  DFH-START PIC X(04).
    72
    73 77  FILLER  PIC X(32)  VALUE '********************************'.
    74 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    75 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    76 77  WS-SSN  PIC X(9) VALUE ZEROS.
    77 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    78 77  C0                          PIC S999 COMP-3 VALUE +0.
    79 77  C1                          PIC S999 COMP-3 VALUE +0.
    80 77  C2                          PIC S999 COMP-3 VALUE +0.
    81 77  C3                          PIC S999 COMP-3 VALUE +0.
    82 77  s1                          PIC S999 COMP-3 VALUE +0.
    83 77  s2                          pic s999 comp-3 value +0.
    84 77  P1                          PIC S999 COMP-3 VALUE +0.
    85 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    86 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    87 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    88 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    89 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    90 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    91 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    92 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    93 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    94 77  ws-max-bens                 pic s999 comp-3 value +0.
    95 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    96 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    97 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    98 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    99 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   100 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   101
   102*    COPY ELCSCTM.
   103******************************************************************
   104*                                                                *
   105*                                                                *
   106*                            ELCSCTM                             *
   107*                            VMOD=2.001                          *
   108*                                                                *
   109*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   110*                                                                *
   111******************************************************************
   112 01  SECURITY-MESSAGE.
   113     12  FILLER                          PIC X(30)
   114            VALUE '** LOGIC SECURITY VIOLATION -'.
   115     12  SM-READ                         PIC X(6).
   116     12  FILLER                          PIC X(5)
   117            VALUE ' PGM='.
   118     12  SM-PGM                          PIC X(6).
   119     12  FILLER                          PIC X(5)
   120            VALUE ' OPR='.
   121     12  SM-PROCESSOR-ID                 PIC X(4).
   122     12  FILLER                          PIC X(6)
   123            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   4
* EL156.cbl
   124     12  SM-TERMID                       PIC X(4).
   125     12  FILLER                          PIC XX   VALUE SPACE.
   126     12  SM-JUL-DATE                     PIC 9(5).
   127     12  FILLER                          PIC X    VALUE SPACE.
   128     12  SM-TIME                         PIC 99.99.
   129
   130
   131*    COPY ELCSCRTY.
   132******************************************************************
   133*                                                                *
   134*                                                                *
   135*                            ELCSCRTY                            *
   136*                            VMOD=2.001                          *
   137*                                                                *
   138*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   139*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   140*        SAVED IN PI-SECURITY-ADDRESS.                           *
   141*                                                                *
   142******************************************************************
   143 01  SECURITY-CONTROL.
   144     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   145     12  FILLER                       PIC XX    VALUE 'SC'.
   146     12  SC-CREDIT-CODES.
   147         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   148             20  SC-CREDIT-DISPLAY    PIC X.
   149             20  SC-CREDIT-UPDATE     PIC X.
   150     12  SC-CLAIMS-CODES.
   151         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   152             20  SC-CLAIMS-DISPLAY    PIC X.
   153             20  SC-CLAIMS-UPDATE     PIC X.
   154
   155 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   156 01  WS-DATE-AREA.
   157     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   158     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   159     12  SAVE-DATE-CCYYMMDD.
   160         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   161         16  SAVE-DATE-YMD.
   162             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   163             20  FILLER              PIC X(04)   VALUE SPACES.
   164
   165 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   166 01  STANDARD-AREAS.
   167     12  WS-RESPONSE         PIC S9(8)   COMP.
   168         88  WS-RESP-NORMAL              VALUE +00.
   169         88  WS-RESP-ERROR               VALUE +01.
   170         88  WS-RESP-NOTFND              VALUE +13.
   171         88  WS-RESP-DUPREC              VALUE +14.
   172         88  WS-RESP-ENDFILE             VALUE +20.
   173     12  PMT-HEAD-A.
   174         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   175         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   176         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   177-        '     RESERVES  TYPE    AMOUNT'.
   178     12  PMT-HEAD-B.
   179         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   180         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   181         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   5
* EL156.cbl
   182     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   183     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   184     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   185     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   186     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   187     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   188     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   189     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   190     12  PGM-NAME            PIC X(8).
   191     12  TIME-IN             PIC S9(7).
   192     12  TIME-OUT-R  REDEFINES TIME-IN.
   193         16  FILLER          PIC X.
   194         16  TIME-OUT        PIC 99V99.
   195         16  FILLER          PIC XX.
   196     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   197     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   198     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   199     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   200     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   201     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   202     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   203     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   204     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   205     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   206     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   207     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   208     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   209     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   210     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   211     12  WS-BLANK            PIC X       VALUE ' '.
   212
   213 01  MISC-WORK-AREAS.
   214     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   215     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   216     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   217     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   218     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   219     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   220     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   221     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   222     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   223     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   224     12  W-CALLED-NAME           PIC X(08).
   225     12  W-EOB-CODES.
   226         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   227             20  W-EOB-CODE      PIC XXX.
   228             20  W-EOB-FILLER    PIC X.
   229     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   230     12  W-NAME-LAST             PIC X(15).
   231     12  W-NAME-FIRST            PIC X(15).
   232     12  W-NAME-MIDDLE.
   233         16  FILLER              PIC X.
   234         16  W-NAME-MIDDLE-2     PIC X.
   235         16  FILLER              PIC X(13).
   236     12  W-DMD-CHECK-NO.
   237         16  W-DMD-CHECK-NO-1    PIC X(4).
   238         16  W-DMD-CHECK-NO-2    PIC X.
   239         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   6
* EL156.cbl
   240
   241     12  WS-COMPUTE-FROM-DT  PIC XX.
   242     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   243     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   244     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   245     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   246     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   247     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   248         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   249         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   250     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   251         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   252     12  WS-UPDATE-SW        PIC X VALUE ' '.
   253     12  WS-GROUPING.
   254         16  WS-GROUP-1      PIC X VALUE SPACES.
   255         16  FILLER          PIC X(05) VALUE SPACES.
   256     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   257     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   258     12  WS-WORK-STATE-ACCT.
   259         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   260         16  FILLER          PIC X       VALUE '/'.
   261         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   262     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   263     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   264     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   265     12  QID.
   266         16  QID-TERM        PIC X(4)    VALUE SPACES.
   267         16  FILLER          PIC X(4)    VALUE '156A'.
   268     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   269     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   270     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   271     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   272     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   273     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   274     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   275     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   276     12  WS-STATUS           PIC X       VALUE SPACES.
   277     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   278     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   279     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   280     12  ws-extended-exp-dt  pic xx      value low-values.
   281     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   282     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   283     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   284     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   285     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   286     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   287     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   288     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   289     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   290     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   291     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   292     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   293     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   294     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   295     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   296     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   297     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   7
* EL156.cbl
   298     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   299     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   300     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   301     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   302     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   303     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   304     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   305     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   306     12  WORK-DATE-FROM.
   307         16  WDF-MONTH       PIC 99        VALUE ZERO.
   308         16  WDF-DAY         PIC 99        VALUE ZERO.
   309         16  WDF-YEAR        PIC 99        VALUE ZERO.
   310     12  WORK-DATE-THRU.
   311         16  WDT-MONTH       PIC 99        VALUE ZERO.
   312         16  WDT-DAY         PIC 99        VALUE ZERO.
   313         16  WDT-YEAR        PIC 99        VALUE ZERO.
   314     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   315     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   316     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   317     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   318     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   319     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   320     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   321     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   322     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   323     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   324     12  WS-PY-WK REDEFINES WS-PY-WORK.
   325         16  WS-PY-NUM       PIC S9(7)V99.
   326         16  WS-PY-SIGN      PIC X.
   327     12  WS-DY-WORK          PIC S9(5).
   328     12  WS-DY-WK REDEFINES WS-DY-WORK.
   329         16  WS-DY-NUM       PIC S9(4).
   330         16  WS-DY-SIGN      PIC X.
   331     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   332         88  COMP-REC-FOUND              VALUE 'Y'.
   333     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   334         88  BENEFIT-FOUND       VALUE 'Y'.
   335         88  NO-BENEFIT-FOUND    VALUE 'N'.
   336     12  WS-TERMS.
   337         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   338         16  FILLER          PIC X       VALUE '/'.
   339         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   340         16  WST-REM-DAYS-GRP.
   341             20  WST-SLASH   PIC X       VALUE '/'.
   342             20  WST-REM-DAYS
   343                             PIC --9.
   344     12  WS-ACCESS.
   345         16  FILLER          PIC XX      VALUE SPACES.
   346         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   347     12  WS-STATE-ACCESS.
   348         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   349         16  FILLER          PIC XX      VALUE SPACES.
   350     12  WS-CARR-ACCESS.
   351         16  FILLER          PIC X(3)    VALUE SPACES.
   352         16  WS-CARR         PIC X       VALUE SPACES.
   353     12  DATE-WORK.
   354         16  FILLER          PIC XX      VALUE SPACES.
   355         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   8
* EL156.cbl
   356     12  WS-SAVE-INPUT.
   357         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   358         16  WS-PAYEE        PIC XX      VALUE SPACE.
   359         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   360         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   361         16  WS-OFFLINE      PIC X       VALUE SPACE.
   362         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   363         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   364         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   365         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   366         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   367         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   368         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   369         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   370         16  WS-ETYPE        PIC X       VALUE SPACE.
   371         16  WS-CASH         PIC X       VALUE SPACE.
   372         16  WS-GROUPED      PIC X       VALUE SPACE.
   373         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   374         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   375         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   376         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   377         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   378         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   379         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   380         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   381         16  ws-int-to-rem-borr pic x value spaces.
   382     12  LAST-ERROR-LINE.
   383         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   384         16  FILLER              PIC X(30)
   385             VALUE ' FATAL ERRORS ENCOUNTERED'.
   386         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   387         16  FILLER              PIC X(28)
   388             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   389     12  WS-CHECK-AREA.
   390         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   391         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   392     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   393     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   394         16  FILLER              PIC XX.
   395         16  WS-A-CHECK-NUM-5    PIC 9(5).
   396     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   397         16  FILLER              PIC X.
   398         16  WS-A-CHECK-NUM-6    PIC 9(6).
   399     12  OPTION-1-SAVE-AREA.
   400         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   401         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   402     12  WS-WORK-ZIP.
   403         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   404         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   405     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   406                                 PIC 9(9).
   407     12  WS-FLI-PMTNOTE.
   408         16  WS-PMTOPTION        PIC XX.
   409         16  WS-DOCNAME          PIC X(28).
   410         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   411             20  WS-AMOUNT       PIC X(8).
   412             20  FILLER          PIC X(20).
   413         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page   9
* EL156.cbl
   414             20  WS-NUM-AMT      PIC 9(6)V99.
   415             20  FILLER          PIC X(20).
   416
   417     12  WS-HAN-PMTNOTE.
   418         16  WS-HAN-PMT-CODE     PIC X.
   419         16  WS-HAN-PMT-NOTE     PIC X(39).
   420
   421     12  WS-NCL-PMT-OPTION       PIC XX.
   422         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   423
   424     12  WS-CLAIM-SEQUENCE.
   425         16  FILLER              PIC X VALUE '('.
   426         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   427         16  FILLER              PIC X(04) VALUE ' OF '.
   428         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   429         16  FILLER              PIC X VALUE ')'.
   430
   431     12  WS-REFUND-AMT           PIC Z(7).99.
   432     12  WS-CALC-INT             PIC S9(7)V99.
   433     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   434
   435     12  SUB                     PIC 99 VALUE ZEROS.
   436
   437     12  WS-BOANOTE1.
   438         16  WS-BOANOTE1-DESC    PIC X(11).
   439         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   440         16  FILLER              PIC X(17).
   441     12  WS-BOANOTE2.
   442         16  WS-BOANOTE2-DESC    PIC X(11).
   443         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   444         16  FILLER              PIC X(17).
   445
   446     12  WS-NCLNOTE1.
   447         16  WS-NCLNOTE1-DESC    PIC X(11).
   448         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   449         16  FILLER              PIC X(17).
   450     12  WS-NCLNOTE2.
   451         16  WS-NCLNOTE2-DESC    PIC X(11).
   452         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   453         16  FILLER              PIC X(17).
   454
   455     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   456     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   457     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   458     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   459     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   460     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   461     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   462     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   463     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   464     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   465
   466     12  WS-AIG-WORK-AREAS.
   467         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   468             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   469         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   470             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   471         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  10
* EL156.cbl
   472             20  WS-FROM-MO      PIC 99.
   473             20  WS-FROM-DA      PIC 99.
   474             20  WS-FROM-YR      PIC 99.
   475         16  WS-TEMP-DATE-MDY.
   476             20  WS-TEMP-MO      PIC 99.
   477             20  WS-TEMP-DA      PIC 99.
   478             20  WS-TEMP-YR      PIC 99.
   479         16  WS-BIN-FROM-DT      PIC XX.
   480         16  WS-TEMP-INC-MDY.
   481             20  WS-TEMP-INC-MO  PIC 99.
   482             20  WS-TEMP-INC-DA  PIC 99.
   483             20  WS-TEMP-INC-YR  PIC 99.
   484         16  WS-PMT-DUE-MDY.
   485             20  WS-PMT-DUE-MO   PIC 99.
   486             20  WS-PMT-DUE-DA   PIC 99.
   487             20  WS-PMT-DUE-YR   PIC 99.
   488         16  WS-PMT-DUE-DT       PIC XX.
   489         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   490         16  WS-RETRO-ELIM-DT    PIC XX.
   491         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   492             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   493         16  WS-SAVE-DUE-DA      PIC 99.
   494         16  WS-CDAYS            PIC S9(05).
   495         16  WS-DAYS-OFF         PIC S9(05).
   496         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   497             88  ELIM-SATISFIED            VALUE 'Y'.
   498         16  WS-AIG-CHECKNO.
   499             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   500             20  WS-A-CHECKNO-3-7.
   501                 24  FILLER              PIC X(3)    VALUE SPACES.
   502                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   503                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   504         16  WS-AIG-GROUPING.
   505             20  WS-A-BENE               PIC XXX.
   506             20  FILLER                  PIC XXX.
   507         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   508             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   509             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   510         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   511                 VALUE 'UNEMPLOYMENT PAYMENT'.
   512         16  WS-CHK-THRU-DT              PIC XX.
   513         16  WS-HOLD-BIN-DATE-1          PIC XX.
   514
   515 01  MISC-CSO-AREA.
   516     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   517     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   518     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   519         88  APPROVAL-NEEDED                        VALUE 'Y'.
   520     12  WS-APPROV-NOTE                  PIC X(43)
   521         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   522     12  WS-3550-APPROV-NOTE             PIC X(43)
   523         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   524     12  WS-REAUDIT-NOTE                 PIC X(43)
   525         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   526     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   527     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   528     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   529     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  11
* EL156.cbl
   530     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   531     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   532     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   533         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   534     12  WS-PAYEE-CITY-STATE     PIC X(30).
   535     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   536         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   537     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   538     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   539     12  WS-WORK-NAME            PIC X(30).
   540     12  FILLER  REDEFINES WS-WORK-NAME.
   541         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   542     12  WS-INSURED-NAME         PIC X(30).
   543     12  FILLER  REDEFINES WS-INSURED-NAME.
   544         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   545     12  WS-PAYEE-NAME           PIC X(30).
   546     12  FILLER  REDEFINES WS-PAYEE-NAME.
   547         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   548
   549 01  ERROR-MESSAGES.
   550     12  ER-0000                 PIC X(4)  VALUE '0000'.
   551     12  ER-0004                 PIC X(4)  VALUE '0004'.
   552     12  ER-0008                 PIC X(4)  VALUE '0008'.
   553     12  ER-0019                 PIC X(4)  VALUE '0019'.
   554     12  ER-0029                 PIC X(4)  VALUE '0029'.
   555     12  ER-0042                 PIC X(4)  VALUE '0042'.
   556     12  ER-0070                 PIC X(4)  VALUE '0070'.
   557     12  ER-0130                 PIC X(4)  VALUE '0130'.
   558     12  ER-0149                 PIC X(4)  VALUE '0149'.
   559     12  ER-0154                 PIC X(4)  VALUE '0154'.
   560     12  ER-0168                 PIC X(4)  VALUE '0168'.
   561     12  ER-0169                 PIC X(4)  VALUE '0169'.
   562     12  ER-0172                 PIC X(4)  VALUE '0174'.
   563     12  ER-0198                 PIC X(4)  VALUE '0198'.
   564     12  ER-0204                 PIC X(4)  VALUE '0204'.
   565     12  ER-0206                 PIC X(4)  VALUE '0206'.
   566     12  ER-0252                 PIC X(4)  VALUE '0252'.
   567     12  ER-0254                 PIC X(4)  VALUE '0254'.
   568     12  ER-0282                 PIC X(4)  VALUE '0282'.
   569     12  ER-0283                 PIC X(4)  VALUE '0283'.
   570     12  ER-0294                 PIC X(4)  VALUE '0294'.
   571     12  ER-0338                 PIC X(4)  VALUE '0338'.
   572     12  ER-0419                 PIC X(4)  VALUE '0419'.
   573     12  ER-0420                 PIC X(4)  VALUE '0420'.
   574     12  ER-0421                 PIC X(4)  VALUE '0421'.
   575     12  ER-0422                 PIC X(4)  VALUE '0422'.
   576     12  ER-0433                 PIC X(4)  VALUE '0433'.
   577     12  ER-0436                 PIC X(4)  VALUE '0436'.
   578     12  ER-0437                 PIC X(4)  VALUE '0437'.
   579     12  ER-0438                 PIC X(4)  VALUE '0438'.
   580     12  ER-0439                 PIC X(4)  VALUE '0439'.
   581     12  ER-0440                 PIC X(4)  VALUE '0440'.
   582     12  ER-0441                 PIC X(4)  VALUE '0441'.
   583     12  ER-0442                 PIC X(4)  VALUE '0442'.
   584     12  ER-0443                 PIC X(4)  VALUE '0443'.
   585     12  ER-0444                 PIC X(4)  VALUE '0444'.
   586     12  ER-0445                 PIC X(4)  VALUE '0445'.
   587     12  ER-0446                 PIC X(4)  VALUE '0446'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  12
* EL156.cbl
   588     12  ER-0447                 PIC X(4)  VALUE '0447'.
   589     12  ER-0448                 PIC X(4)  VALUE '0448'.
   590     12  ER-0449                 PIC X(4)  VALUE '0449'.
   591     12  ER-0452                 PIC X(4)  VALUE '0452'.
   592     12  ER-0458                 PIC X(4)  VALUE '0458'.
   593     12  ER-0459                 PIC X(4)  VALUE '0459'.
   594     12  ER-0460                 PIC X(4)  VALUE '0460'.
   595     12  ER-0461                 PIC X(4)  VALUE '0461'.
   596     12  ER-0462                 PIC X(4)  VALUE '0462'.
   597     12  ER-0463                 PIC X(4)  VALUE '0463'.
   598     12  ER-0464                 PIC X(4)  VALUE '0464'.
   599     12  ER-0465                 PIC X(4)  VALUE '0465'.
   600     12  ER-0466                 PIC X(4)  VALUE '0466'.
   601     12  ER-0467                 PIC X(4)  VALUE '0467'.
   602     12  ER-0468                 PIC X(4)  VALUE '0468'.
   603     12  ER-0469                 PIC X(4)  VALUE '0469'.
   604     12  ER-0473                 PIC X(4)  VALUE '0473'.
   605     12  ER-0474                 PIC X(4)  VALUE '0474'.
   606     12  ER-0475                 PIC X(4)  VALUE '0475'.
   607     12  ER-0476                 PIC X(4)  VALUE '0476'.
   608     12  ER-0477                 PIC X(4)  VALUE '0477'.
   609     12  ER-0478                 PIC X(4)  VALUE '0478'.
   610     12  ER-0479                 PIC X(4)  VALUE '0479'.
   611     12  ER-0481                 PIC X(4)  VALUE '0481'.
   612     12  ER-0491                 PIC X(4)  VALUE '0491'.
   613     12  ER-0492                 PIC X(4)  VALUE '0492'.
   614     12  ER-0493                 PIC X(4)  VALUE '0493'.
   615     12  ER-0494                 PIC X(4)  VALUE '0494'.
   616     12  ER-0495                 PIC X(4)  VALUE '0495'.
   617     12  ER-0499                 PIC X(4)  VALUE '0499'.
   618     12  ER-0500                 PIC X(4)  VALUE '0500'.
   619     12  ER-0501                 PIC X(4)  VALUE '0501'.
   620     12  ER-0502                 PIC X(4)  VALUE '0502'.
   621     12  ER-0508                 PIC X(4)  VALUE '0508'.
   622     12  ER-0513                 PIC X(4)  VALUE '0513'.
   623     12  ER-0518                 PIC X(4)  VALUE '0518'.
   624     12  ER-0524                 PIC X(4)  VALUE '0524'.
   625     12  ER-0525                 PIC X(4)  VALUE '0525'.
   626     12  ER-0526                 PIC X(4)  VALUE '0526'.
   627     12  ER-0530                 PIC X(4)  VALUE '0530'.
   628     12  ER-0540                 PIC X(4)  VALUE '0540'.
   629     12  ER-0541                 PIC X(4)  VALUE '0541'.
   630     12  ER-0542                 PIC X(4)  VALUE '0542'.
   631     12  ER-0543                 PIC X(4)  VALUE '0543'.
   632     12  ER-0545                 PIC X(4)  VALUE '0545'.
   633     12  ER-0552                 PIC X(4)  VALUE '0552'.
   634     12  ER-0555                 PIC X(4)  VALUE '0555'.
   635     12  ER-0556                 PIC X(4)  VALUE '0556'.
   636     12  ER-0557                 PIC X(4)  VALUE '0557'.
   637     12  ER-0572                 PIC X(4)  VALUE '0572'.
   638     12  ER-0573                 PIC X(4)  VALUE '0573'.
   639     12  ER-0594                 PIC X(4)  VALUE '0594'.
   640     12  ER-0616                 PIC X(4)  VALUE '0616'.
   641     12  ER-0617                 PIC X(4)  VALUE '0617'.
   642     12  ER-0618                 PIC X(4)  VALUE '0618'.
   643     12  ER-0657                 PIC X(4)  VALUE '0657'.
   644     12  ER-0658                 PIC X(4)  VALUE '0658'.
   645     12  ER-0699                 PIC X(4)  VALUE '0699'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  13
* EL156.cbl
   646     12  ER-0730                 PIC X(4)  VALUE '0730'.
   647     12  ER-0737                 PIC X(4)  VALUE '0737'.
   648     12  ER-0760                 PIC X(4)  VALUE '0760'.
   649     12  ER-0768                 PIC X(4)  VALUE '0768'.
   650     12  ER-0769                 PIC X(4)  VALUE '0769'.
   651     12  ER-0770                 PIC X(4)  VALUE '0770'.
   652     12  ER-0802                 PIC X(4)  VALUE '0802'.
   653     12  ER-0803                 PIC X(4)  VALUE '0803'.
   654     12  ER-0819                 PIC X(4)  VALUE '0819'.
   655     12  ER-0834                 PIC X(4)  VALUE '0834'.
   656     12  ER-0836                 PIC X(4)  VALUE '0836'.
   657     12  ER-0844                 PIC X(4)  VALUE '0844'.
   658     12  ER-0845                 PIC X(4)  VALUE '0845'.
   659     12  ER-0846                 PIC X(4)  VALUE '0846'.
   660     12  ER-0849                 PIC X(4)  VALUE '0849'.
   661     12  ER-0851                 PIC X(4)  VALUE '0851'.
   662     12  ER-0872                 PIC X(4)  VALUE '0872'.
   663     12  ER-0873                 PIC X(4)  VALUE '0873'.
   664     12  ER-0874                 PIC X(4)  VALUE '0874'.
   665     12  ER-0879                 PIC X(4)  VALUE '0879'.
   666     12  ER-0919                 PIC X(4)  VALUE '0919'.
   667     12  ER-0921                 PIC X(4)  VALUE '0921'.
   668     12  ER-0923                 PIC X(4)  VALUE '0923'.
   669     12  ER-0925                 PIC X(4)  VALUE '0925'.
   670     12  ER-0944                 PIC X(4)  VALUE '0944'.
   671     12  ER-0945                 PIC X(4)  VALUE '0945'.
   672     12  ER-0946                 PIC X(4)  VALUE '0946'.
   673     12  ER-0947                 PIC X(4)  VALUE '0947'.
   674     12  ER-0948                 PIC X(4)  VALUE '0948'.
   675     12  ER-0949                 PIC X(4)  VALUE '0949'.
   676     12  ER-0950                 PIC X(4)  VALUE '0950'.
   677     12  ER-0951                 PIC X(4)  VALUE '0951'.
   678     12  ER-0954                 PIC X(4)  VALUE '0954'.
   679     12  ER-0956                 PIC X(4)  VALUE '0956'.
   680     12  ER-0967                 PIC X(4)  VALUE '0967'.
   681     12  ER-0968                 PIC X(4)  VALUE '0968'.
   682     12  ER-0974                 PIC X(4)  VALUE '0974'.
   683     12  ER-0975                 PIC X(4)  VALUE '0975'.
   684     12  ER-1561                 PIC X(4)  VALUE '1561'.
   685     12  ER-1566                 PIC X(4)  VALUE '1566'.
   686     12  ER-1567                 PIC X(4)  VALUE '1567'.
   687     12  ER-1569                 PIC X(4)  VALUE '1569'.
   688     12  er-1582                 pic x(4)  value '1582'.
   689     12  er-1657                 pic x(4)  value '1657'.
   690     12  er-1658                 pic x(4)  value '1658'.
   691     12  er-1667                 pic x(4)  value '1667'.
   692     12  er-1670                 pic x(4)  value '1670'.
   693     12  er-1671                 pic x(4)  value '1671'.
   694     12  er-1672                 pic x(4)  value '1672'.
   695     12  er-1673                 pic x(4)  value '1673'.
   696     12  er-1674                 pic x(4)  value '1674'.
   697     12  er-1677                 pic x(4)  value '1677'.
   698     12  ER-1775                 PIC X(4)  VALUE '1775'.
   699     12  ER-1880                 PIC X(4)  VALUE '1880'.
   700     12  ER-2044                 PIC X(4)  VALUE '2044'.
   701     12  ER-3140                 PIC X(4)  VALUE '3140'.
   702     12  ER-3141                 PIC X(4)  VALUE '3141'.
   703     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  14
* EL156.cbl
   704     12  ER-3516                 PIC X(4)  VALUE '3516'.
   705     12  ER-3527                 PIC X(4)  VALUE '3527'.
   706     12  ER-3528                 PIC X(4)  VALUE '3528'.
   707     12  ER-3529                 PIC X(4)  VALUE '3529'.
   708     12  ER-3530                 PIC X(4)  VALUE '3530'.
   709     12  ER-3531                 PIC X(4)  VALUE '3531'.
   710     12  ER-3532                 PIC X(4)  VALUE '3532'.
   711     12  ER-3533                 PIC X(4)  VALUE '3533'.
   712     12  ER-3534                 PIC X(4)  VALUE '3534'.
   713     12  ER-3535                 PIC X(4)  VALUE '3535'.
   714     12  ER-3536                 PIC X(4)  VALUE '3536'.
   715     12  ER-3537                 PIC X(4)  VALUE '3537'.
   716     12  ER-3538                 PIC X(4)  VALUE '3538'.
   717     12  ER-3539                 PIC X(4)  VALUE '3539'.
   718     12  ER-3540                 PIC X(4)  VALUE '3540'.
   719     12  ER-3541                 PIC X(4)  VALUE '3541'.
   720     12  ER-3542                 PIC X(4)  VALUE '3542'.
   721     12  ER-3543                 PIC X(4)  VALUE '3543'.
   722     12  ER-3546                 PIC X(4)  VALUE '3546'.
   723     12  ER-3549                 PIC X(4)  VALUE '3549'.
   724     12  ER-3818                 PIC X(4)  VALUE '3818'.
   725     12  ER-7540                 PIC X(4)  VALUE '7540'.
   726     12  ER-7576                 PIC X(4)  VALUE '7576'.
   727     12  ER-7579                 PIC X(4)  VALUE '7579'.
   728     12  ER-7580                 PIC X(4)  VALUE '7580'.
   729     12  ER-7583                 PIC X(4)  VALUE '7583'.
   730     12  ER-7830                 PIC X(4)  VALUE '7830'.
   731     12  ER-7831                 PIC X(4)  VALUE '7831'.
   732     12  ER-7832                 PIC X(4)  VALUE '7832'.
   733     12  ER-7833                 PIC X(4)  VALUE '7833'.
   734     12  ER-7834                 PIC X(4)  VALUE '7834'.
   735     12  ER-7835                 PIC X(4)  VALUE '7835'.
   736     12  ER-7836                 PIC X(4)  VALUE '7836'.
   737     12  ER-7837                 PIC X(4)  VALUE '7837'.
   738     12  ER-7838                 PIC X(4)  VALUE '7838'.
   739     12  ER-7841                 PIC X(4)  VALUE '7841'.
   740     12  ER-7844                 PIC X(4)  VALUE '7844'.
   741     12  ER-7845                 PIC X(4)  VALUE '7845'.
   742     12  ER-8000                 PIC X(4)  VALUE '8000'.
   743     12  ER-8051                 PIC X(4)  VALUE '8051'.
   744     12  ER-8052                 PIC X(4)  VALUE '8052'.
   745     12  ER-8053                 PIC X(4)  VALUE '8053'.
   746     12  ER-8054                 PIC X(4)  VALUE '8054'.
   747     12  ER-8055                 PIC X(4)  VALUE '8055'.
   748     12  ER-8056                 PIC X(4)  VALUE '8056'.
   749     12  ER-8057                 PIC X(4)  VALUE '8057'.
   750     12  ER-8058                 PIC X(4)  VALUE '8058'.
   751     12  ER-8059                 PIC X(4)  VALUE '8059'.
   752     12  ER-8060                 PIC X(4)  VALUE '8060'.
   753     12  ER-8061                 PIC X(4)  VALUE '8061'.
   754     12  ER-8062                 PIC X(4)  VALUE '8062'.
   755     12  ER-8063                 PIC X(4)  VALUE '8063'.
   756     12  ER-8064                 PIC X(4)  VALUE '8064'.
   757     12  ER-8065                 PIC X(4)  VALUE '8065'.
   758     12  ER-8066                 PIC X(4)  VALUE '8066'.
   759     12  ER-8146                 PIC X(4)  VALUE '8146'.
   760     12  ER-8147                 PIC X(4)  VALUE '8147'.
   761     12  ER-8152                 PIC X(4)  VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  15
* EL156.cbl
   762     12  ER-8153                 PIC X(4)  VALUE '8153'.
   763     12  ER-8154                 PIC X(4)  VALUE '8154'.
   764     12  ER-8155                 PIC X(4)  VALUE '8155'.
   765     12  ER-8310                 PIC X(4)  VALUE '8310'.
   766     12  ER-8311                 PIC X(4)  VALUE '8311'.
   767     12  ER-8312                 PIC X(4)  VALUE '8312'.
   768     12  ER-8313                 PIC X(4)  VALUE '8313'.
   769     12  ER-8314                 PIC X(4)  VALUE '8314'.
   770     12  ER-8315                 PIC X(4)  VALUE '8315'.
   771     12  ER-8316                 PIC X(4)  VALUE '8316'.
   772     12  ER-8317                 PIC X(4)  VALUE '8317'.
   773
   774 01  CSO-WORK-FIELDS.
   775     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   776       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   777
   778     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   779     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   780         88  CERT-NOTE-ADDED           VALUE 'Y'.
   781     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   782         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   783     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   784
   785     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   786
   787 01  SC-NP6-CERT-NOTE.
   788     12  FILLER                  PIC X(12)
   789               VALUE 'REM BENEFIT '.
   790     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   791     12  SC-NP6-COMM             PIC X(8)
   792               VALUE ' + 6 MO '.
   793     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   794     12  FILLER                  PIC X(12)
   795               VALUE ' = AMT PAID '.
   796     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   797
   798 01  SC-NP6-ORIG-NOTE.
   799     12  FILLER                  PIC X(63)  VALUE
   800         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   801 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   802     88  PDEF-FOUND                   VALUE 'Y'.
   803 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   804     88  ACCT-FOUND                   VALUE 'Y'.
   805 01  CTBL-KEY-SAVE               PIC X(5).
   806 01  CTBL-KEY.
   807     05  CTBL-COMPANY-CD         PIC X.
   808     05  CTBL-TABLE              PIC XXX.
   809     05  CTBL-BEN-TYPE           PIC X.
   810     05  CTBL-BEN-CODE           PIC XX.
   811 01  ERPDEF-KEY-SAVE             PIC X(18).
   812 01  ERPDEF-KEY.
   813     12  ERPDEF-COMPANY-CD       PIC X.
   814     12  ERPDEF-STATE            PIC XX.
   815     12  ERPDEF-PROD-CD          PIC XXX.
   816     12  F                       PIC X(7).
   817     12  ERPDEF-BEN-TYPE         PIC X.
   818     12  ERPDEF-BEN-CODE         PIC XX.
   819     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  16
* EL156.cbl
   820 01  ELCRTT-KEY.
   821     05  CTRLR-COMP-CD       PIC X.
   822     05  CTRLR-CARRIER       PIC X.
   823     05  CTRLR-GROUPING      PIC X(6).
   824     05  CTRLR-STATE         PIC X(2).
   825     05  CTRLR-ACCOUNT       PIC X(10).
   826     05  CTRLR-EFF-DT        PIC XX.
   827     05  CTRLR-CERT-NO       PIC X(11).
   828     05  CTRLR-REC-TYPE      PIC X.
   829 01  ACCESS-KEYS.
   830     12  ELARCH-KEY.
   831         16  ARCH-CO             PIC X.
   832         16  ARCH-NUMBER         PIC S9(08) COMP.
   833         16  ARCH-REC-TYPE       PIC X.
   834         16  ARCH-SEQ            PIC S9(04) COMP.
   835     12  ELMSTR-KEY.
   836         16  MSTR-COMP-CD        PIC X.
   837         16  MSTR-CARRIER        PIC X.
   838         16  MSTR-CLAIM-NO       PIC X(7).
   839         16  MSTR-CERT-NO        PIC X(11).
   840     12  ELCNTL-KEY.
   841         16  CNTL-COMP-ID        PIC X(3).
   842         16  CNTL-REC-TYPE       PIC X.
   843         16  CNTL-ACCESS         PIC X(4).
   844         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   845     12  ELCERT-KEY.
   846         16  CERT-COMP-CD        PIC X.
   847         16  CERT-CARRIER        PIC X.
   848         16  CERT-GROUPING       PIC X(6).
   849         16  CERT-STATE          PIC XX.
   850         16  CERT-ACCOUNT        PIC X(10).
   851         16  CERT-EFF-DT         PIC XX.
   852         16  CERT-CERT-NO        PIC X(11).
   853     12  ELTRLR-KEY.
   854         16  TRLR-COMP-CD        PIC X.
   855         16  TRLR-CARRIER        PIC X.
   856         16  TRLR-CLAIM-NO       PIC X(7).
   857         16  TRLR-CERT-NO        PIC X(11).
   858         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   859     12  ELACTQ-KEY.
   860         16  ACTQ-COMP-CD        PIC X.
   861         16  ACTQ-CARRIER        PIC X.
   862         16  ACTQ-CLAIM-NO       PIC X(7).
   863         16  ACTQ-CERT-NO        PIC X(11).
   864     12  W-NOTE-KEY.
   865         16  W-NOTE-COMP-CD      PIC X.
   866         16  W-NOTE-CERT-KEY.
   867             20  W-NOTE-CARRIER  PIC X.
   868             20  W-NOTE-GROUPING PIC X(6).
   869             20  W-NOTE-STATE    PIC XX.
   870             20  W-NOTE-ACCOUNT  PIC X(10).
   871             20  W-NOTE-EFF-DT   PIC XX.
   872             20  W-NOTE-CERT-NO  PIC X(11).
   873     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   874     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   875     12  ERACCT-KEY.
   876         16  ERACCT-PARTIAL-KEY.
   877             20  ACCT-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  17
* EL156.cbl
   878             20  ACCT-CARRIER    PIC X.
   879             20  ACCT-GROUPING   PIC X(6).
   880             20  ACCT-STATE      PIC XX.
   881             20  ACCT-ACCOUNT    PIC X(10).
   882         16  ACCT-EXP-DT         PIC XX.
   883         16  FILLER              PIC X(4) VALUE SPACES.
   884     12  ELCHKQ-KEY.
   885         16  CHKQ-COMP-CD        PIC X.
   886         16  CHKQ-CONTROL        PIC S9(8) COMP.
   887         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   888     12  ELBENE-KEY.
   889         16  BENE-COMP-CD         PIC X.
   890         16  BENE-RECORD-TYPE     PIC X.
   891         16  BENE-NUMBER          PIC X(10).
   892     12  ERCOMP-KEY.
   893         16  COMP-COMP-CD        PIC X.
   894         16  COMP-CARRIER        PIC X.
   895         16  COMP-GROUP          PIC X(06).
   896         16  COMP-FIN-RESP       PIC X(10).
   897         16  COMP-ACCOUNT        PIC X(10).
   898         16  COMP-TYPE           PIC X.
   899
   900     12  DLO035-KEY.
   901         16  DL35-PROCESS-TYPE   PIC X.
   902         16  DL35-CREDIT-CARD    PIC X(20).
   903         16  DL35-BEN-TYPE       PIC XX.
   904         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   905         16  DL35-RETURN-CODE    PIC XX.
   906
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  18
* EL156.cbl
   908*    COPY ELCDATE.
   909******************************************************************
   910*                                                                *
   911*                                                                *
   912*                            ELCDATE.                            *
   913*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   914*                            VMOD=2.003
   915*                                                                *
   916*                                                                *
   917*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   918*                 LENGTH = 200                                   *
   919******************************************************************
   920
   921 01  DATE-CONVERSION-DATA.
   922     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   923     12  DC-OPTION-CODE                PIC X.
   924         88  BIN-TO-GREG                VALUE ' '.
   925         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   926         88  EDIT-GREG-TO-BIN           VALUE '2'.
   927         88  YMD-GREG-TO-BIN            VALUE '3'.
   928         88  MDY-GREG-TO-BIN            VALUE '4'.
   929         88  JULIAN-TO-BIN              VALUE '5'.
   930         88  BIN-PLUS-ELAPSED           VALUE '6'.
   931         88  FIND-CENTURY               VALUE '7'.
   932         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   933         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   934         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   935         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   936         88  JULIAN-TO-BIN-3            VALUE 'C'.
   937         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   938         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   939         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   940         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   941         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   942         88  CHECK-LEAP-YEAR            VALUE 'H'.
   943         88  BIN-3-TO-GREG              VALUE 'I'.
   944         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   945         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   946         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   947         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   948         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   949         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   950         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   951         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   952         88  THREE-CHARACTER-BIN
   953                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   954         88  GREGORIAN-TO-BIN
   955                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   956         88  BIN-TO-GREGORIAN
   957                  VALUES ' ' '1' 'I' '8' 'G'.
   958         88  JULIAN-TO-BINARY
   959                  VALUES '5' 'C' 'E' 'F'.
   960     12  DC-ERROR-CODE                 PIC X.
   961         88  NO-CONVERSION-ERROR        VALUE ' '.
   962         88  DATE-CONVERSION-ERROR
   963                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   964         88  DATE-IS-ZERO               VALUE '1'.
   965         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  19
* EL156.cbl
   966         88  DATE-IS-INVALID            VALUE '3'.
   967         88  DATE1-GREATER-DATE2        VALUE '4'.
   968         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   969         88  DATE-INVALID-OPTION        VALUE '9'.
   970         88  INVALID-CENTURY            VALUE 'A'.
   971         88  ONLY-CENTURY               VALUE 'B'.
   972         88  ONLY-LEAP-YEAR             VALUE 'C'.
   973         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   974     12  DC-END-OF-MONTH               PIC X.
   975         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   976     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   977         88  USE-NORMAL-PROCESS         VALUE ' '.
   978         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   979         88  ADJUST-UP-100-YRS          VALUE '2'.
   980     12  FILLER                        PIC X.
   981     12  DC-CONVERSION-DATES.
   982         16  DC-BIN-DATE-1             PIC XX.
   983         16  DC-BIN-DATE-2             PIC XX.
   984         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   985         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   986                       DC-GREG-DATE-1-EDIT.
   987             20  DC-EDIT1-MONTH        PIC 99.
   988             20  SLASH1-1              PIC X.
   989             20  DC-EDIT1-DAY          PIC 99.
   990             20  SLASH1-2              PIC X.
   991             20  DC-EDIT1-YEAR         PIC 99.
   992         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   993         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   994                     DC-GREG-DATE-2-EDIT.
   995             20  DC-EDIT2-MONTH        PIC 99.
   996             20  SLASH2-1              PIC X.
   997             20  DC-EDIT2-DAY          PIC 99.
   998             20  SLASH2-2              PIC X.
   999             20  DC-EDIT2-YEAR         PIC 99.
  1000         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1001         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1002                     DC-GREG-DATE-1-YMD.
  1003             20  DC-YMD-YEAR           PIC 99.
  1004             20  DC-YMD-MONTH          PIC 99.
  1005             20  DC-YMD-DAY            PIC 99.
  1006         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1007         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1008                      DC-GREG-DATE-1-MDY.
  1009             20  DC-MDY-MONTH          PIC 99.
  1010             20  DC-MDY-DAY            PIC 99.
  1011             20  DC-MDY-YEAR           PIC 99.
  1012         16  DC-GREG-DATE-1-ALPHA.
  1013             20  DC-ALPHA-MONTH        PIC X(10).
  1014             20  DC-ALPHA-DAY          PIC 99.
  1015             20  FILLER                PIC XX.
  1016             20  DC-ALPHA-CENTURY.
  1017                 24 DC-ALPHA-CEN-N     PIC 99.
  1018             20  DC-ALPHA-YEAR         PIC 99.
  1019         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1020         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1021         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1022         16  DC-JULIAN-DATE            PIC 9(05).
  1023         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  20
* EL156.cbl
  1024                                       PIC 9(05).
  1025         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1026             20  DC-JULIAN-YEAR        PIC 99.
  1027             20  DC-JULIAN-DAYS        PIC 999.
  1028         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1029         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1030         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1031     12  DATE-CONVERSION-VARIBLES.
  1032         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1033         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1034             20  FILLER                PIC 9(3).
  1035             20  HOLD-CEN-1-CCYY.
  1036                 24  HOLD-CEN-1-CC     PIC 99.
  1037                 24  HOLD-CEN-1-YY     PIC 99.
  1038             20  HOLD-CEN-1-MO         PIC 99.
  1039             20  HOLD-CEN-1-DA         PIC 99.
  1040         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1041             20  HOLD-CEN-1-R-MO       PIC 99.
  1042             20  HOLD-CEN-1-R-DA       PIC 99.
  1043             20  HOLD-CEN-1-R-CCYY.
  1044                 24  HOLD-CEN-1-R-CC   PIC 99.
  1045                 24  HOLD-CEN-1-R-YY   PIC 99.
  1046             20  FILLER                PIC 9(3).
  1047         16  HOLD-CENTURY-1-X.
  1048             20  FILLER                PIC X(3)  VALUE SPACES.
  1049             20  HOLD-CEN-1-X-CCYY.
  1050                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1051                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1052             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1053             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1054         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1055             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1056             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1057             20  HOLD-CEN-1-R-X-CCYY.
  1058                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1059                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1060             20  FILLER                PIC XXX.
  1061         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1062         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1063         16  DC-JULIAN-DATE-1          PIC 9(07).
  1064         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1065             20  DC-JULIAN-1-CCYY.
  1066                 24  DC-JULIAN-1-CC    PIC 99.
  1067                 24  DC-JULIAN-1-YR    PIC 99.
  1068             20  DC-JULIAN-DA-1        PIC 999.
  1069         16  DC-JULIAN-DATE-2          PIC 9(07).
  1070         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1071             20  DC-JULIAN-2-CCYY.
  1072                 24  DC-JULIAN-2-CC    PIC 99.
  1073                 24  DC-JULIAN-2-YR    PIC 99.
  1074             20  DC-JULIAN-DA-2        PIC 999.
  1075         16  DC-GREG-DATE-A-EDIT.
  1076             20  DC-EDITA-MONTH        PIC 99.
  1077             20  SLASHA-1              PIC X VALUE '/'.
  1078             20  DC-EDITA-DAY          PIC 99.
  1079             20  SLASHA-2              PIC X VALUE '/'.
  1080             20  DC-EDITA-CCYY.
  1081                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  21
* EL156.cbl
  1082                 24  DC-EDITA-YEAR     PIC 99.
  1083         16  DC-GREG-DATE-B-EDIT.
  1084             20  DC-EDITB-MONTH        PIC 99.
  1085             20  SLASHB-1              PIC X VALUE '/'.
  1086             20  DC-EDITB-DAY          PIC 99.
  1087             20  SLASHB-2              PIC X VALUE '/'.
  1088             20  DC-EDITB-CCYY.
  1089                 24  DC-EDITB-CENT     PIC 99.
  1090                 24  DC-EDITB-YEAR     PIC 99.
  1091         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1092         16  DC-GREG-DATE-CYMD-R REDEFINES
  1093                              DC-GREG-DATE-CYMD.
  1094             20  DC-CYMD-CEN           PIC 99.
  1095             20  DC-CYMD-YEAR          PIC 99.
  1096             20  DC-CYMD-MONTH         PIC 99.
  1097             20  DC-CYMD-DAY           PIC 99.
  1098         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1099         16  DC-GREG-DATE-MDCY-R REDEFINES
  1100                              DC-GREG-DATE-MDCY.
  1101             20  DC-MDCY-MONTH         PIC 99.
  1102             20  DC-MDCY-DAY           PIC 99.
  1103             20  DC-MDCY-CEN           PIC 99.
  1104             20  DC-MDCY-YEAR          PIC 99.
  1105    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1106        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1107    12  DC-EL310-DATE                  PIC X(21).
  1108    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  22
* EL156.cbl
  1110*    COPY ELCLOGOF.
  1111******************************************************************
  1112*                                                                *
  1113*                                                                *
  1114*                            ELCLOGOF.                           *
  1115*                            VMOD=2.001                          *
  1116*                                                                *
  1117*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1118*                                                                *
  1119******************************************************************
  1120 01  CLASIC-LOGOFF.
  1121     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1122     12  LOGOFF-TEXT.
  1123         16  FILLER          PIC X(5)    VALUE SPACES.
  1124         16  LOGOFF-MSG.
  1125             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1126             20  FILLER      PIC X       VALUE SPACES.
  1127             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1128         16  FILLER          PIC X(80)
  1129           VALUE '* YOU ARE NOW LOGGED OFF'.
  1130         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1131         16  FILLER          PIC X       VALUE QUOTE.
  1132         16  LOGOFF-SYS-MSG  PIC X(17)
  1133           VALUE 'S CLAS-IC SYSTEM '.
  1134     12  TEXT-MESSAGES.
  1135         16  UNACCESS-MSG    PIC X(29)
  1136             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1137         16  PGMIDERR-MSG    PIC X(17)
  1138             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  23
* EL156.cbl
  1140*    COPY ELCCALC.
  1141******************************************************************
  1142*                                                                *
  1143*                           ELCCALC.                            *
  1144*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1145*                            VMOD=2.025                          *
  1146*                                                                *
  1147*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1148*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1149*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1150*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1151*                                                                *
  1152*  PASSED TO ELRTRM                                              *
  1153*  -----------------                                             *
  1154*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1155*  ORIGINAL TERM                                                 *
  1156*  BEGINNING DATE                                                *
  1157*  ENDING DATE                                                   *
  1158*  COMPANY I.D.                                                  *
  1159*  ACCOUNT MASTER USER FIELD                                     *
  1160*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1161*  FREE LOOK DAYS                                                *
  1162*                                                                *
  1163*  RETURNED FROM ELRTRM                                          *
  1164*  ---------------------                                         *
  1165*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1166*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1167*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1168*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1169*----------------------------------------------------------------*
  1170*  PASSED TO ELRAMT                                              *
  1171*  ----------------                                              *
  1172*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1173*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1174*  ORIGINAL AMOUNT                                               *
  1175*  ALTERNATE BENEFIT (BALLON)                                    *
  1176*  A.P.R. - NET PAY ONLY                                         *
  1177*  METHOD
  1178*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1179*  COMPANY I.D.                                                  *
  1180*  BENEFIT TYPE                                                  *
  1181*                                                                *
  1182*  RETURNED FROM ELRAMT                                          *
  1183*  --------------------                                          *
  1184*  REMAINING AMOUNT 1 - CURRENT                                  *
  1185*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1186*  REMAINING AMOUNT FACTOR
  1187*----------------------------------------------------------------*
  1188*  PASSED TO ELRESV                                              *
  1189*  -----------------                                             *
  1190*  CERTIFICATE EFFECTIVE DATE                                    *
  1191*  VALUATION DATE                                                *
  1192*  PAID THRU DATE                                                *
  1193*  BENEFIT                                                       *
  1194*  INCURRED DATE                                                 *
  1195*  REPORTED DATE                                                 *
  1196*  ISSUE AGE                                                     *
  1197*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  24
* EL156.cbl
  1198*  CDT PERCENT                                                   *
  1199*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1200* *CLAIM TYPE (LIFE, A/H)                                        *
  1201* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1202* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1203*                                                                *
  1204*  RETURNED FROM ELRESV                                          *
  1205*  --------------------                                          *
  1206*  CDT TABLE USED                                                *
  1207*  CDT FACTOR USED                                               *
  1208*  PAY TO CURRENT RESERVE                                        *
  1209*  I.B.N.R. - A/H ONLY                                           *
  1210*  FUTURE (ACCRUED) AH ONLY                                      *
  1211*----------------------------------------------------------------*
  1212*  PASSED TO ELRATE                                              *
  1213*  ----------------                                              *
  1214*  CERT ISSUE DATE                                               *
  1215*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1216*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1217*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1218*  STATE CODE (CLIENT DEFINED)                                   *
  1219*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1220*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1221*  DEVIATION CODE                                                *
  1222*  ISSUE AGE                                                     *
  1223*  ORIGINAL BENEFIT AMOUNT                                       *
  1224*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1225*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1226*  BENEFIT KIND (LIFE OR A/H)                                    *
  1227*  A.P.R.                                                        *
  1228*  METHOD
  1229*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1230*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1231*  COMPANY I.D. (3 CHARACTER)                                    *
  1232*  BENEFIT CODE                                                  *
  1233*  BENEFIT OVERRIDE CODE                                         *
  1234*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1235*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1236*  JOINT INDICATOR (CSL ONLY)                                    *
  1237*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1238*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1239*                                                                *
  1240*  RETURNED FROM ELRATE                                          *
  1241*  --------------------                                          *
  1242*  CALCULATED PREMIUM                                            *
  1243*  PREMIUM RATE                                                  *
  1244*  MORTALITY CODE                                                *
  1245*  MAX ATTAINED AGE                                              *
  1246*  MAX AGE                                                       *
  1247*  MAX TERM                                                      *
  1248*  MAX MONTHLY BENEFIT                                           *
  1249*  MAX TOTAL BENIFIT                                             *
  1250*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1251*----------------------------------------------------------------*
  1252*  PASSED TO ELRFND                                              *
  1253*  ----------------                                              *
  1254*  CERT ISSUE DATE                                               *
  1255*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  25
* EL156.cbl
  1256*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1257*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1258*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1259*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1260*  STATE CODE (CLIENT DEFINED)                                   *
  1261*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1262*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1263*  DEVIATION CODE                                                *
  1264*  ISSUE AGE                                                     *
  1265*  ORIGINAL BENEFIT AMOUNT                                       *
  1266*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1267*  PROCESS TYPE (CANCEL)                                         *
  1268*  BENEFIT KIND (LIFE OR A/H)                                    *
  1269*  A.P.R.                                                        *
  1270*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1271*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1272*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1273*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1274*  COMPANY I.D. (3 CHARACTER)                                    *
  1275*  BENEFIT CODE                                                  *
  1276*  BENEFIT OVERRIDE CODE                                         *
  1277*                                                                *
  1278*  RETURNED FROM ELRFND                                          *
  1279*  --------------------                                          *
  1280*  CALCULATED REFUND                                             *
  1281*----------------------------------------------------------------*
  1282*  PASSED TO ELEARN                                              *
  1283*  ----------------                                              *
  1284*  CERT ISSUE DATE                                               *
  1285*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1286*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1287*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1288*  STATE CODE (CLIENT DEFINED)                                   *
  1289*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1290*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1291*  DEVIATION CODE                                                *
  1292*  ISSUE AGE                                                     *
  1293*  ORIGINAL BENEFIT AMOUNT                                       *
  1294*  BENEFIT KIND (LIFE OR A/H)                                    *
  1295*  A.P.R.                                                        *
  1296*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1297*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1298*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1299*  COMPANY I.D. (3 CHARACTER)                                    *
  1300*  BENEFIT CODE                                                  *
  1301*  BENEFIT OVERRIDE CODE                                         *
  1302*                                                                *
  1303*  RETURNED FROM ELEARN                                          *
  1304*  --------------------                                          *
  1305*  INDICATED  EARNINGS                                           *
  1306*----------------------------------------------------------------*
  1307*                 LENGTH = 450                                   *
  1308*                                                                *
  1309******************************************************************
  1310******************************************************************
  1311*                   C H A N G E   L O G
  1312*
  1313* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  26
* EL156.cbl
  1314*-----------------------------------------------------------------
  1315*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1316* EFFECTIVE    NUMBER
  1317*-----------------------------------------------------------------
  1318* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1319* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1320* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1321* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1322* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1323* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1324* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1325* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1326* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1327* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1328* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1329******************************************************************
  1330
  1331 01  CALCULATION-PASS-AREA.
  1332     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1333                                     COMP.
  1334
  1335     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1336       88  NO-CP-ERROR                             VALUE ZERO.
  1337       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1338                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1339       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1340       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1341       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1342       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1343       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1344       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1345       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1346       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1347       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1348       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1349       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1350       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1351       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1352       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1353       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1354       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1355       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1356
  1357     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1358       88  NO-CP-ERROR-2                           VALUE ZERO.
  1359***********************  INPUT AREAS ****************************
  1360
  1361     12  CP-CALCULATION-AREA.
  1362         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1363         16  CP-CERT-EFF-DT        PIC XX.
  1364         16  CP-VALUATION-DT       PIC XX.
  1365         16  CP-PAID-THRU-DT       PIC XX.
  1366         16  CP-BENEFIT-TYPE       PIC X.
  1367           88  CP-AH                               VALUE 'A' 'D'
  1368                                                   'I' 'U'.
  1369           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1370           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1371         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  27
* EL156.cbl
  1372         16  CP-REPORTED-DT        PIC XX.
  1373         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1374         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1375         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1376                                     COMP-3.
  1377         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1378                                     COMP-3.
  1379         16  CP-CDT-METHOD         PIC X.
  1380           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1381           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1382           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1383         16  CP-CLAIM-TYPE         PIC X.
  1384           88  CP-AH-CLAIM                         VALUE 'A'.
  1385           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1386         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1391                                     COMP-3.
  1392         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1393                                     COMP-3.
  1394         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1395                                     COMP-3.
  1396         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1397                                     COMP-3.
  1398         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1399                                     COMP-3.
  1400         16  CP-REM-TERM-METHOD    PIC X.
  1401           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1402           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1403           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1404           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1405           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1406           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1407           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1408         16  CP-EARNING-METHOD     PIC X.
  1409           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1410           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1411           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1412           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1413           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1414           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1415           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1416           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1417           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1418           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1419           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1420           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1421           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1422           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1423         16  CP-PROCESS-TYPE       PIC X.
  1424           88  CP-CLAIM                            VALUE '1'.
  1425           88  CP-CANCEL                           VALUE '2'.
  1426           88  CP-ISSUE                            VALUE '3'.
  1427         16  CP-SPECIAL-CALC-CD    PIC X.
  1428           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1429           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  28
* EL156.cbl
  1430           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1431           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1432           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1433           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1434           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1435           88  CP-FARM-PLAN                    VALUE 'F'.
  1436           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1437           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1438           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1439           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1440           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1441           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1442           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1443           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1444           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1445           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1446                                                     'W' 'X'.
  1447           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1448           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1449           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1450           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1451           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1452           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1453           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1454           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1455           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1456           88  CP-CSL-METH-1                   VALUE '5'.
  1457           88  CP-CSL-METH-2                   VALUE '6'.
  1458           88  CP-CSL-METH-3                   VALUE '7'.
  1459           88  CP-CSL-METH-4                   VALUE '8'.
  1460
  1461         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1462                                     COMP-3.
  1463         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1464         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1465         16  CP-STATE              PIC XX          VALUE SPACE.
  1466         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1467         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1468           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1469               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1470         16  CP-R78-OPTION         PIC X.
  1471           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1472           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1473
  1474         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1475         16  CP-IBNR-RESERVE-SW    PIC X.
  1476         16  CP-CLAIM-STATUS       PIC X.
  1477         16  CP-RATE-FILE          PIC X.
  1478         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1479                                     COMP-3.
  1480
  1481         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1482         16  CP-AH-OVERRIDE-CODE   PIC X.
  1483
  1484         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1485                                     COMP-3.
  1486         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1487                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  29
* EL156.cbl
  1488         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1489                                     COMP-3.
  1490         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1491                                     COMP-3.
  1492         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1493                                     COMP-3.
  1494         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1495                                  PIC S9(7)V99 COMP-3.
  1496
  1497         16  CP-PAID-FROM-DATE     PIC X(02).
  1498         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1499         16  CP-EXT-DAYS-CALC      PIC X.
  1500           88  CP-EXT-NO-CHG                   VALUE ' '.
  1501           88  CP-EXT-CHG-LF                   VALUE '1'.
  1502           88  CP-EXT-CHG-AH                   VALUE '2'.
  1503           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1504         16  CP-DOMICILE-STATE     PIC XX.
  1505         16  CP-CARRIER            PIC X.
  1506         16  CP-REIN-FLAG          PIC X.
  1507         16  CP-REM-TRM-CALC-OPTION PIC X.
  1508           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1509                      '2' '3' '4' '5'.
  1510           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1511           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1512           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1513           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1514           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1515           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1516           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1517           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1518         16  CP-SIG-SWITCH         PIC X.
  1519         16  CP-RATING-METHOD      PIC X.
  1520           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1521           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1522           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1523           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1524           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1525           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1526           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1527           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1528           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1529         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1530                                     COMP-3.
  1531         16  CP-BEN-CATEGORY       PIC X.
  1532         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1533         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1534                                   PIC S99V9(5) COMP-3.
  1535         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1536         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1537                                   PIC S99V9(5) COMP-3.
  1538         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1539         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1540         16  CP-EXPIRE-DT          PIC XX.
  1541         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1542         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1543         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1544         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1545         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  30
* EL156.cbl
  1546             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1547             88  CP-CALC-CLP              VALUE 'C'.
  1548         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1549         16  CP-CANCEL-REASON      PIC X.
  1550         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1551         16  CP-PMT-MODE           PIC X.
  1552         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1553         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1554         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1555         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1556         16  FILLER                PIC X.
  1557
  1558***************    OUTPUT FROM ELRESV   ************************
  1559
  1560         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1561
  1562         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1563                                     COMP-3.
  1564         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1565                                     COMP-3.
  1566         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1567                                     COMP-3.
  1568         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1569                                     COMP-3.
  1570         16  FILLER                PIC X(09).
  1571***************    OUTPUT FROM ELRTRM   *************************
  1572
  1573         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1576                                     COMP-3.
  1577         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1578                                     COMP-3.
  1579         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1580                                     COMP-3.
  1581         16  FILLER                PIC X(12).
  1582
  1583***************    OUTPUT FROM ELRAMT   *************************
  1584
  1585         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1586                                     COMP-3.
  1587         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1588                                     COMP-3.
  1589         16  FILLER                PIC X(12).
  1590
  1591***************    OUTPUT FROM ELRATE   *************************
  1592
  1593         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1594                                     COMP-3.
  1595         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-MORTALITY-CODE     PIC X(4).
  1598         16  CP-RATE-EDIT-FLAG     PIC X.
  1599             88  CP-RATES-NEED-APR                  VALUE '1'.
  1600         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1601                                     COMP-3.
  1602         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1603         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  31
* EL156.cbl
  1604         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1605                                   PIC S9(7)V99 COMP-3.
  1606         16  FILLER                PIC X(07).
  1607
  1608***************    OUTPUT FROM ELRFND   *************************
  1609
  1610         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1611                                     COMP-3.
  1612         16  CP-REFUND-TYPE-USED   PIC X.
  1613           88  CP-R-AS-R78                         VALUE '1'.
  1614           88  CP-R-AS-PRORATA                     VALUE '2'.
  1615           88  CP-R-AS-CALIF                       VALUE '3'.
  1616           88  CP-R-AS-TEXAS                       VALUE '4'.
  1617           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1618           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1619           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1620           88  CP-R-AS-MEAN                        VALUE '8'.
  1621           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1622           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1623           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1624           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1625           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1626           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1627         16  FILLER                PIC X(12).
  1628
  1629***************    OUTPUT FROM ELEARN   *************************
  1630
  1631         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1636                                     COMP-3.
  1637         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1638                                     COMP-3.
  1639         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1640                                     COMP-3.
  1641         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1642                                     COMP-3.
  1643         16  CP-EARNING-TYPE-USED  PIC X.
  1644           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1645           88  CP-E-AS-R78                         VALUE '1'.
  1646           88  CP-E-AS-PRORATA                     VALUE '2'.
  1647           88  CP-E-AS-TEXAS                       VALUE '4'.
  1648           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1649           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1650           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1651           88  CP-E-AS-MEAN                        VALUE '8'.
  1652           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1653         16  FILLER                PIC X(12).
  1654
  1655***************    OUTPUT FROM ELPMNT   *************************
  1656
  1657         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1658                                     COMP-3.
  1659         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1660                                     COMP-3.
  1661         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  32
* EL156.cbl
  1662
  1663***************   MISC WORK AREAS    *****************************
  1664         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1671                                     COMP-3.
  1672         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1673                                     COMP-3.
  1674         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1675                                     COMP-3.
  1676         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1677             88  OPEN-RATE-FILE                   VALUE 'O'.
  1678             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1679             88  IO-ERROR                         VALUE 'E'.
  1680
  1681         16  CP-FIRST-PAY-DATE     PIC XX.
  1682
  1683         16  CP-JOINT-INDICATOR    PIC X.
  1684
  1685         16  CP-RESERVE-REMAINING-TERM
  1686                                   PIC S9(4)V9    VALUE ZERO
  1687                                     COMP-3.
  1688
  1689         16  CP-INSURED-BIRTH-DT   PIC XX.
  1690
  1691         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1692                                     COMP-3.
  1693
  1694         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1695                                     COMP-3.
  1696
  1697         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1698                                     COMP-3.
  1699
  1700         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1701                                     COMP-3.
  1702
  1703         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1704                                     COMP-3.
  1705
  1706         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1707                                     COMP-3.
  1708
  1709         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1710                                     COMP-3.
  1711
  1712         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1713             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1714
  1715         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1716                                     COMP-3.
  1717         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1718                                     COMP-3.
  1719         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  33
* EL156.cbl
  1720         16  cp-extra-periods      pic 9 value zeros.
  1721         16  cp-net-only-state     pic x value spaces.
  1722         16  FILLER                PIC X(13).
  1723******************************************************************
  1724*    COPY ELCICALC.
  1725******************************************************************
  1726*                                                                *
  1727*                           ELCCICALC.                           *
  1728*                            VMOD=2.001                          *
  1729*                                                                *
  1730*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1731*                 CALCULATION MODULE                             *
  1732*                                                                *
  1733*  PASSED TO ELCLMI                                              *
  1734*  -----------------                                             *
  1735*  STATE                                                         *
  1736*  PRODUCT                                                       *
  1737*  COVERAGE                                                      *
  1738*  EFFECTIVE DATE                                                *
  1739*  INCURRED DATE                                                 *
  1740*  ESTABLISHED DATE                                              *
  1741*  LAST PAID DATE                                                *
  1742*  REPORTED DATE                                                 *
  1743*  CLAIM PAYMENT AMOUNT                                          *
  1744*                                                                *
  1745*  RETURNED FROM ELRTRM                                          *
  1746*  ---------------------                                         *
  1747*  RETURN CODE                                                   *
  1748*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1749*  CLAIM INTEREST AMOUNT                                         *
  1750*----------------------------------------------------------------*
  1751*----------------------------------------------------------------*
  1752*                 LENGTH = 100                                   *
  1753*                                                                *
  1754******************************************************************
  1755******************************************************************
  1756*                   C H A N G E   L O G
  1757*
  1758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1759*-----------------------------------------------------------------
  1760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1761* EFFECTIVE    NUMBER
  1762*-----------------------------------------------------------------
  1763* 120905    2004040700004  PEMA  NEW COPYBOOK
  1764* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1765******************************************************************
  1766
  1767 01  CLAIM-INT-PASS-AREA.
  1768     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1769                                     COMP.
  1770
  1771     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1772       88  NO-CI-ERROR                             VALUE ZERO.
  1773       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1774       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1775       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1776       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1777       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  34
* EL156.cbl
  1778       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1779       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1780       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1781       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1782***********************  INPUT AREAS ****************************
  1783
  1784     12  CP-CALCULATION-AREA.
  1785         16  CP-COMPANY-CD         PIC X.
  1786         16  CP-STATE              PIC XX.
  1787         16  CP-PRODUCT            PIC XX.
  1788         16  CP-COVERAGE           PIC XX.
  1789         16  CP-INC-DT             PIC XX.
  1790         16  CP-EST-DT             PIC XX.
  1791         16  CP-LSTPD-DT           PIC XX.
  1792         16  CP-RPT-DT             PIC XX.
  1793         16  CP-PRF-DT             PIC XX.
  1794         16  CP-EFF-DT             PIC XX.
  1795         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1796         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1797         16  FILLER                PIC X(37).
  1798
  1799***************    OUTPUT FROM ELCLMI   ************************
  1800
  1801         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1802
  1803         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1804         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1805         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1806         16  FILLER                PIC X(19).
  1807******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  35
* EL156.cbl
  1809*    COPY ELCATTR.
  1810******************************************************************
  1811*                                                                *
  1812*                            ELCATTR.                            *
  1813*                            VMOD=2.001                          *
  1814*                                                                *
  1815*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1816*                                                                *
  1817*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1818*                                                                *
  1819*                   POS 1   P=PROTECTED                          *
  1820*                           U=UNPROTECTED                        *
  1821*                           S=ASKIP                              *
  1822*                   POS 2   A=ALPHA/NUMERIC                      *
  1823*                           N=NUMERIC                            *
  1824*                   POS 3   N=NORMAL                             *
  1825*                           B=BRIGHT                             *
  1826*                           D=DARK                               *
  1827*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1828*                           OF=MODIFIED DATA TAG OFF             *
  1829*                                                                *
  1830*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1831******************************************************************
  1832 01  ATTRIBUTE-LIST.
  1833     12  AL-PABOF            PIC X       VALUE 'Y'.
  1834     12  AL-PABON            PIC X       VALUE 'Z'.
  1835     12  AL-PADOF            PIC X       VALUE '%'.
  1836     12  AL-PADON            PIC X       VALUE '_'.
  1837     12  AL-PANOF            PIC X       VALUE '-'.
  1838     12  AL-PANON            PIC X       VALUE '/'.
  1839     12  AL-SABOF            PIC X       VALUE '8'.
  1840     12  AL-SABON            PIC X       VALUE '9'.
  1841     12  AL-SADOF            PIC X       VALUE '@'.
  1842     12  AL-SADON            PIC X       VALUE QUOTE.
  1843     12  AL-SANOF            PIC X       VALUE '0'.
  1844     12  AL-SANON            PIC X       VALUE '1'.
  1845     12  AL-UABOF            PIC X       VALUE 'H'.
  1846     12  AL-UABON            PIC X       VALUE 'I'.
  1847     12  AL-UADOF            PIC X       VALUE '<'.
  1848     12  AL-UADON            PIC X       VALUE '('.
  1849     12  AL-UANOF            PIC X       VALUE ' '.
  1850     12  AL-UANON            PIC X       VALUE 'A'.
  1851     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1852     12  AL-UNBON            PIC X       VALUE 'R'.
  1853     12  AL-UNDOF            PIC X       VALUE '*'.
  1854     12  AL-UNDON            PIC X       VALUE ')'.
  1855     12  AL-UNNOF            PIC X       VALUE '&'.
  1856     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  36
* EL156.cbl
  1858*    COPY ELCEMIB.
  1859******************************************************************
  1860*                                                                *
  1861*                                                                *
  1862*                            ELCEMIB.                            *
  1863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1864*                            VMOD=2.005                          *
  1865*                                                                *
  1866*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1867*                                                                *
  1868******************************************************************
  1869 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1870     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1871     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1872     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1873     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1874     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1875     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1876     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1877     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1878     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1879         88  EMI-NO-ERRORS                    VALUE '1'.
  1880         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1881         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1882     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1883         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1884     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1885         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1886         88  EMI-AREA1-FULL                   VALUE '2'.
  1887     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1888         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1889         88  EMI-AREA2-FULL                   VALUE '2'.
  1890     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1891         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1892         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1893         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1894         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1895         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1896     12  EMI-ERROR-LINES.
  1897         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1898         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1899         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1900         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1901             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1902                 24  EMI-ERR-NUM         PIC X(4).
  1903                 24  EMI-FILLER          PIC X.
  1904                 24  EMI-SEV             PIC X.
  1905                 24  FILLER              PIC X.
  1906             20  FILLER                  PIC X(02).
  1907     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1908         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1909             20  EMI-ERROR-NUMBER    PIC X(4).
  1910             20  EMI-FILL            PIC X.
  1911             20  EMI-SEVERITY        PIC X.
  1912             20  FILLER              PIC X.
  1913             20  EMI-ERROR-TEXT.
  1914                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1915                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  37
* EL156.cbl
  1916     12  EMI-SEVERITY-SAVE           PIC X.
  1917         88  EMI-NOTE                    VALUE 'N'.
  1918         88  EMI-WARNING                 VALUE 'W'.
  1919         88  EMI-FORCABLE                VALUE 'F'.
  1920         88  EMI-FATAL                   VALUE 'X'.
  1921     12  EMI-MESSAGE-FLAG            PIC X.
  1922         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1923         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1924     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1925     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1926         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1927         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1928         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1929     12  emi-claim-no                pic x(7).
  1930     12  emi-claim-type              pic x(6).
  1931     12  FILLER                      PIC X(124)  VALUE SPACES.
  1932     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1933     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1934     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1935     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  38
* EL156.cbl
  1937*    COPY ELCLNKLT.
  1938******************************************************************
  1939*                                                                *
  1940*                                                                *
  1941*                           ELCLNKLT                             *
  1942*                            VMOD=2.003                          *
  1943*                                                                *
  1944*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1945*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1946*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1947*                                                                *
  1948*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1949*   COMPLETING THE REQUIRED FIELDS.                              *
  1950*                                                                *
  1951*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1952*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1953*                              9999 INDICATES AN UNKNOWN ABEND   *
  1954*                                   WAS DETECTED.                *
  1955*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1956*                              CODES FOUND IN THE ERROR FILE.    *
  1957******************************************************************
  1958 01  W-1523-LINKDATA.
  1959     12  W-1523-COMMON-PI-DATA.
  1960         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1961         16  FILLER              PIC  X(67).
  1962         16  W-1523-COMPANY-CD   PIC  X(01).
  1963         16  FILLER              PIC  X(10).
  1964         16  W-1523-CONTROL-IN-PROGRESS.
  1965             20  W-1523-CARRIER  PIC  X(01).
  1966             20  W-1523-GROUPING PIC  X(06).
  1967             20  W-1523-STATE    PIC  X(02).
  1968             20  W-1523-ACCOUNT  PIC  X(10).
  1969             20  W-1523-CLAIM-CERT-GRP.
  1970                 24  W-1523-CLAIM-NO
  1971                                 PIC  X(07).
  1972                 24  W-1523-CERT-NO.
  1973                     28  W-1523-CERT-PRIME
  1974                                 PIC  X(10).
  1975                     28  W-1523-CERT-SFX
  1976                                 PIC  X(01).
  1977                 24  W-1523-CERT-EFF-DT
  1978                                 PIC  X(02).
  1979         16  FILLER              PIC X(265).
  1980
  1981     12  W-1523-WORK-AREA.
  1982         16  W-1523-FORM-NUMBER  PIC  X(04).
  1983         16  W-1523-NUMBER-COPIES
  1984                                 PIC  9(01).
  1985         16  W-1523-ADDR-TYPE    PIC  X(02).
  1986         16  W-1523-FOLLOW-UP-DATE
  1987                                 PIC  X(02).
  1988         16  W-1523-RESEND-DATE  PIC  X(02).
  1989         16  W-1523-ERROR-CODE   PIC  9(04).
  1990             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1991             88  W-1523-FATAL-ERROR
  1992                                    VALUES  0006 0013 0042
  1993                                            0154 0168 0169
  1994                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  39
* EL156.cbl
  1995                                            0179 0186 0281
  1996                                            0332 2055 3697
  1997                                            3698 3699 3770
  1998                                            3771 3772 7675
  1999                                            9106 9808 9883
  2000                                            9887.
  2001             88  W-1523-STOP-ERRORS
  2002                                    VALUES  0013 0042 0154
  2003                                            0168 0169 0172
  2004                                            0281 0332 2055
  2005                                            3698 3699 7675
  2006                                            9106 9808 9883
  2007                                            9999.
  2008         16  W-1523-REASON       PIC  X(70).
  2009         16  W-1523-ARCHIVE-NUMBER
  2010                                 PIC  9(08).
  2011     12  W-1523-POINTER-AREA.
  2012         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2013         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2014         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2015         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2016         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  40
* EL156.cbl
  2018*    COPY ELCNWA.
  2019*****************************************************************
  2020*                                                               *
  2021*                                                               *
  2022*                            ELCNWA.                            *
  2023*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2024*                            VMOD=2.003                         *
  2025*                                                               *
  2026*            M O V E   N A M E   W O R K   A R E A.             *
  2027*                                                               *
  2028*****************************************************************.
  2029
  2030 01  WS-NAME-WORK-AREA.
  2031     05  WS-INSURED-LAST-NAME        PIC X(15).
  2032     05  WS-INSURED-1ST-NAME         PIC X(12).
  2033     05  WS-INSURED-MID-INIT         PIC X.
  2034
  2035     05  WS-NAME-WORK.
  2036         10  WS-NW                   PIC X
  2037             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2038
  2039     05  WS-NAME-WORK2.
  2040         10  WS-NW2                  PIC X
  2041             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2042                                        NWA-INDEX0.
  2043
  2044     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2045                                     COMP-3.
  2046
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  41
* EL156.cbl
  2048*    COPY ELCDMO.
  2049******************************************************************
  2050*                                                                *
  2051*                                                                *
  2052*                            ELCDMO.                             *
  2053*                            VMOD=2.004                          *
  2054*                                                                *
  2055*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2056*        COMMUNICATION AREA                                      *
  2057*   FILE TYPE = NA                                               *
  2058*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2059*                                                                *
  2060******************************************************************
  2061 01  DMO-COMMUNICATION-AREA.
  2062     12  DM-RECORD-TYPE                  PIC  X(02).
  2063             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2064             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2065             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2066     12  DM-DIST-CODE                    PIC  X(04).
  2067     12  DM-MAIL-CODE                    PIC  X(05).
  2068     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2069     12  DM-INSURED-NAME                 PIC  X(30).
  2070     12  DM-CLAIM-NO                     PIC  X(07).
  2071     12  DM-CLAIM-TYPE                   PIC  X.
  2072
  2073     12  DM-STATUS-DATA-AREA.
  2074         16  DM-CLAIM-STATUS             PIC  X.
  2075             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2076             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2077             88  DM-CLOSED                        VALUE '3'.
  2078             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2079             88  DM-DEFAULT                       VALUE '9'.
  2080         16  DM-STATUS-DATE              PIC  X(08).
  2081******YYYYMMDD
  2082         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2083             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2084             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2085             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2086             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2087             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2088             88  DM-RE-OPENED                     VALUE 'R'.
  2089             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2090             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2091             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2092         16  DM-STAT-CARRIER             PIC X.
  2093
  2094     12  DM-DRAFT-DATA-AREA.
  2095         16  DM-PAYMENT-TYPE             PIC  X.
  2096             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2097         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2098         16  DM-PAYMENT-DATE             PIC  X(08).
  2099******YYYYMMDD
  2100         16  DM-CERT-NO                  PIC  X(11).
  2101         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2102         16  DM-CARRIER                  PIC  X.
  2103
  2104     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  42
* EL156.cbl
  2106*    COPY ELCDMDCD.
  2107******************************************************************
  2108*                                                                *
  2109*                                                                *
  2110*                            ELCDMDCD.                           *
  2111*                            VMOD=2.001                          *
  2112*                                                                *
  2113*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2114*       COMMUNICATIONS AREA                                      *
  2115*                                                                *
  2116******************************************************************
  2117 01  CD-COMMUNICATION-AREA.
  2118     12  CD-SYSTEM-ID            PIC  X(02).
  2119         88 CD-CLAIMS                      VALUE 'CL'.
  2120         88 CD-CREDIT                      VALUE 'CR'.
  2121     12  CD-RECORD-TYPE          PIC  X(02).
  2122         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2123         88 CD-EOB-CODE                    VALUE 'EO'.
  2124         88 CD-ICD9-CODE                   VALUE 'I9'.
  2125         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2126         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2127         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2128         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2129         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2130     12  CD-RECORD-KEY           PIC  X(06).
  2131         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2132     12  CD-RETURN-CODE          PIC  X(02).
  2133     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2134     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2135     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2136     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  43
* EL156.cbl
  2138*    COPY ELCDCTB.
  2139******************************************************************
  2140*                                                                *
  2141*                                                                *
  2142*                            ELCDCTB.                            *
  2143*                            VMOD=2.002                          *
  2144*                                                                *
  2145*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2146*       COMMUNICATIONS AREA                                      *
  2147*                                                                *
  2148******************************************************************
  2149 01  DCT-COMMUNICATION-AREA.
  2150     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2151     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2152     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2153     12  DCT-PRODUCT-CODE         PIC  X(02).
  2154     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2155     12  DCT-RETURN-CODE          PIC  X(02).
  2156     12  DCT-MAIL-CODE            PIC  X(05).
  2157     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2158     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  44
* EL156.cbl
  2160 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2161 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2162 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2163 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  45
* EL156.cbl
  2165*    COPY ELCINTF.
  2166******************************************************************
  2167*                                                                *
  2168*                                                                *
  2169*                            ELCINTF.                            *
  2170*                            VMOD=2.017                          *
  2171*                                                                *
  2172*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2173*                                                                *
  2174*       LENGTH = 1024                                            *
  2175*                                                                *
  2176******************************************************************
  2177*                   C H A N G E   L O G
  2178*
  2179* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2180*-----------------------------------------------------------------
  2181*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2182* EFFECTIVE    NUMBER
  2183*-----------------------------------------------------------------
  2184* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2185******************************************************************
  2186 01  PROGRAM-INTERFACE-BLOCK.
  2187     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2188     12  PI-CALLING-PROGRAM              PIC X(8).
  2189     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2190     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2191     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2192     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2193     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2194     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2195     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2196     12  PI-COMPANY-ID                   PIC XXX.
  2197     12  PI-COMPANY-CD                   PIC X.
  2198
  2199     12  PI-COMPANY-PASSWORD             PIC X(8).
  2200
  2201     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2202
  2203     12  PI-CONTROL-IN-PROGRESS.
  2204         16  PI-CARRIER                  PIC X.
  2205         16  PI-GROUPING                 PIC X(6).
  2206         16  PI-STATE                    PIC XX.
  2207         16  PI-ACCOUNT                  PIC X(10).
  2208         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2209                                         PIC X(10).
  2210         16  PI-CLAIM-CERT-GRP.
  2211             20  PI-CLAIM-NO             PIC X(7).
  2212             20  PI-CERT-NO.
  2213                 25  PI-CERT-PRIME       PIC X(10).
  2214                 25  PI-CERT-SFX         PIC X.
  2215             20  PI-CERT-EFF-DT          PIC XX.
  2216         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2217             20  PI-PLAN-CODE            PIC X(2).
  2218             20  PI-REVISION-NUMBER      PIC X(3).
  2219             20  PI-PLAN-EFF-DT          PIC X(2).
  2220             20  PI-PLAN-EXP-DT          PIC X(2).
  2221             20  FILLER                  PIC X(11).
  2222         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  46
* EL156.cbl
  2223             20  PI-OE-REFERENCE-1.
  2224                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2225                 25  PI-OE-REF-1-SUFF    PIC XX.
  2226
  2227     12  PI-SESSION-IN-PROGRESS          PIC X.
  2228         88  CLAIM-SESSION                   VALUE '1'.
  2229         88  CREDIT-SESSION                  VALUE '2'.
  2230         88  WARRANTY-SESSION                VALUE '3'.
  2231         88  MORTGAGE-SESSION                VALUE '4'.
  2232         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2233
  2234
  2235*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2236
  2237     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2238     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2239
  2240     12  PI-CREDIT-USER                  PIC X.
  2241         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2242         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2243
  2244     12  PI-CLAIM-USER                   PIC X.
  2245         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2246         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2247
  2248     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2249         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2250         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2251         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2252         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2253         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2254
  2255     12  PI-PROCESSOR-ID                 PIC X(4).
  2256
  2257     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2258
  2259     12  PI-MEMBER-CAPTION               PIC X(10).
  2260
  2261     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2262         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2263
  2264     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2265     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2266     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2267     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2268
  2269     12  PI-AH-OVERRIDE-L1               PIC X.
  2270     12  PI-AH-OVERRIDE-L2               PIC XX.
  2271     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2272     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2273
  2274     12  PI-NEW-SYSTEM                   PIC X(2).
  2275
  2276     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2277     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2278         88  PI-USES-PAID-TO                 VALUE '1'.
  2279     12  PI-CRDTCRD-SYSTEM.
  2280         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  47
* EL156.cbl
  2281             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2282             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2283         16  PI-CC-MONTH-END-DT          PIC XX.
  2284     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2285
  2286     12  PI-OE-REFERENCE-2.
  2287         16  PI-OE-REF-2-PRIME           PIC X(10).
  2288         16  PI-OE-REF-2-SUFF            PIC X.
  2289
  2290     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2291
  2292     12  PI-LANGUAGE-TYPE                PIC X.
  2293             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2294             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2295             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2296
  2297     12  PI-POLICY-LINKAGE-IND           PIC X.
  2298         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2299         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2300                                                   LOW-VALUES.
  2301
  2302     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2303     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2304         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2305         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2306
  2307     12  PI-PROCESSOR-CSR-IND            PIC X.
  2308         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2309         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2310
  2311     12  FILLER                          PIC X(3).
  2312
  2313     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2314
  2315     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2316         PI-SYSTEM-LEVEL.
  2317
  2318         16  PI-ENTRY-CODES.
  2319             20  PI-ENTRY-CD-1           PIC X.
  2320             20  PI-ENTRY-CD-2           PIC X.
  2321
  2322         16  PI-RETURN-CODES.
  2323             20  PI-RETURN-CD-1          PIC X.
  2324             20  PI-RETURN-CD-2          PIC X.
  2325
  2326         16  PI-UPDATE-STATUS-SAVE.
  2327             20  PI-UPDATE-BY            PIC X(4).
  2328             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2329
  2330         16  PI-LOWER-CASE-LETTERS       PIC X.
  2331             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2332
  2333*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2334*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2335*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2336
  2337         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2338             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  48
* EL156.cbl
  2339             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2340             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2341             88  ACCNT-CNTL                  VALUE '3'.
  2342             88  CARR-ACCNT-CNTL             VALUE '4'.
  2343
  2344         16  PI-PROCESSOR-CAP-LIST.
  2345             20  PI-SYSTEM-CONTROLS.
  2346                24 PI-SYSTEM-DISPLAY     PIC X.
  2347                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2348                24 PI-SYSTEM-MODIFY      PIC X.
  2349                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2350             20  FILLER                  PIC XX.
  2351             20  PI-DISPLAY-CAP          PIC X.
  2352                 88  DISPLAY-CAP             VALUE 'Y'.
  2353             20  PI-MODIFY-CAP           PIC X.
  2354                 88  MODIFY-CAP              VALUE 'Y'.
  2355             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2356                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2357             20  PI-FORCE-CAP            PIC X.
  2358                 88  FORCE-CAP               VALUE 'Y'.
  2359
  2360         16  PI-PROGRAM-CONTROLS.
  2361             20  PI-PGM-PRINT-OPT        PIC X.
  2362             20  PI-PGM-FORMAT-OPT       PIC X.
  2363             20  PI-PGM-PROCESS-OPT      PIC X.
  2364             20  PI-PGM-TOTALS-OPT       PIC X.
  2365
  2366         16  PI-HELP-INTERFACE.
  2367             20  PI-LAST-ERROR-NO        PIC X(4).
  2368             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2369
  2370         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2371             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2372
  2373         16  PI-CR-CONTROL-IN-PROGRESS.
  2374             20  PI-CR-CARRIER           PIC X.
  2375             20  PI-CR-GROUPING          PIC X(6).
  2376             20  PI-CR-STATE             PIC XX.
  2377             20  PI-CR-ACCOUNT           PIC X(10).
  2378             20  PI-CR-FIN-RESP          PIC X(10).
  2379             20  PI-CR-TYPE              PIC X.
  2380
  2381         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2382
  2383         16  PI-CR-MONTH-END-DT          PIC XX.
  2384
  2385         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2386             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2387             88  PI-ZERO-CARRIER             VALUE '1'.
  2388             88  PI-ZERO-GROUPING            VALUE '2'.
  2389             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2390
  2391         16  PI-CARRIER-SECURITY         PIC X.
  2392             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2393
  2394         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2395             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2396             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  49
* EL156.cbl
  2397
  2398         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2399             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2400                                         INDEXED BY PI-ACCESS-NDX
  2401                                         PIC X.
  2402
  2403         16  PI-GA-BILLING-CONTROL       PIC X.
  2404             88  PI-GA-BILLING               VALUE '1'.
  2405
  2406         16  PI-MAIL-PROCESSING          PIC X.
  2407             88  PI-MAIL-YES                 VALUE 'Y'.
  2408
  2409         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2410
  2411         16  PI-AR-SYSTEM.
  2412             20  PI-AR-PROCESSING-CNTL   PIC X.
  2413                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2414             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2415             20  PI-AR-MONTH-END-DT      PIC XX.
  2416
  2417         16  PI-MP-SYSTEM.
  2418             20  PI-MORTGAGE-USER            PIC X.
  2419                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2420                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2421             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2422                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2423                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2424                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2425                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2426                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2427             20  PI-MP-MONTH-END-DT          PIC XX.
  2428             20  PI-MP-REFERENCE-NO.
  2429                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2430                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2431
  2432         16  PI-LABEL-CONTROL            PIC X(01).
  2433             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2434             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2435
  2436         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2437             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2438
  2439         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2440             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2441             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2442
  2443         16  FILLER                      PIC X(14).
  2444
  2445     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2446******************************************************************
  2447     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2448         16  PI-SAVE-FORM        PIC X(12).
  2449         16  PI-ACCT-KEY         PIC X(26).
  2450         16  PI-PAYEE-NAME       PIC X(30).
  2451         16  PI-DAILY-RATE       PIC S9(3)V99.
  2452         16  PI-MONTH-END-SAVE   PIC XX.
  2453         16  PI-BENEFIT-SAVE.
  2454             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  50
* EL156.cbl
  2455             20  PI-BEN-TYPE     PIC X.
  2456         16  PI-MANUAL-SW        PIC 9.
  2457         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2458         16  PI-PASS-SW          PIC X.
  2459         16  PI-PFKEY-USED       PIC X.
  2460         16  PI-CK-ASSIGN        PIC X.
  2461         16  PI-FATAL-COUNT      PIC 99.
  2462         16  PI-FORCE-COUNT      PIC 99.
  2463         16  PI-SAVE-INPUT.
  2464             20  PI-PMTTYPE      PIC X.
  2465             20  PI-PAYEE.
  2466                 24  PI-PAYEE-TYPE PIC X.
  2467                 24  PI-PAYEE-SEQ  PIC X.
  2468                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2469                   PI-PAYEE-SEQ    PIC S9.
  2470             20  PI-PMTNOTE1     PIC X(60).
  2471             20  PI-PMTNOTE2     PIC X(60).
  2472             20  PI-OFFLINE      PIC X.
  2473             20  PI-ECHECKNO     PIC X(7).
  2474             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2475                 28  PI-ECHECKNO-N     PIC X.
  2476                 28  PI-ECHECKNO-6     PIC X(6).
  2477             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2478                 24  PI-ECHECKNO-CR    PIC XX.
  2479                 24  PI-ECHECKNO-5     PIC X(5).
  2480             20  PI-HOLDTIL      PIC 9(6).
  2481             20  PI-EPYFROM      PIC 9(6).
  2482             20  PI-EPYTHRU      PIC 9(6).
  2483             20  PI-EDAYS        PIC S9(5).
  2484             20  PI-EPYAMT       PIC S9(7)V99.
  2485             20  PI-ERESV        PIC S9(7)V99.
  2486             20  PI-EEXPENS      PIC 9(6)V99.
  2487             20  PI-ETYPE        PIC X.
  2488             20  PI-CASH         PIC X.
  2489             20  PI-GROUPED      PIC X.
  2490             20  PI-INT-RATE     PIC S99V9(5).
  2491             20  PI-AIGFROM      PIC 9(6).
  2492             20  PI-LOAN-NO      PIC X(20).
  2493             20  PI-PROOF-DATE   PIC 9(6).
  2494             20  PI-PRINT-EOB-YN PIC X.
  2495             20  PI-PRINT-CLM-FRM-YN PIC X.
  2496             20  PI-PRINT-SURVEY-YN PIC X.
  2497             20  PI-SPECIAL-RELEASE-YN PIC X.
  2498             20  pi-int-to-rem-borr pic x.
  2499         16  PI-SAVE-COMPUTED.
  2500             20  PI-CCHECKNO     PIC X(7).
  2501             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2502                 28  PI-CCHECKNO-N     PIC X.
  2503                 28  PI-CCHECKNO-6     PIC X(6).
  2504             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2505                 24  PI-CCHECKNO-CR    PIC XX.
  2506                 24  PI-CCHECKNO-5     PIC X(5).
  2507             20  PI-CPYFROM      PIC XX.
  2508             20  PI-CPYTHRU      PIC XX.
  2509             20  PI-CDAYS        PIC S9(5).
  2510             20  PI-CPYAMT       PIC S9(7)V99.
  2511             20  PI-CRESV        PIC 9(6)V99.
  2512             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  51
* EL156.cbl
  2513             20  PI-PMT-APPR-SW  PIC X.
  2514                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2515                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2516                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2517         16  PI-PREV-CLMNO       PIC X(7).
  2518         16  PI-LF-COVERAGE-TYPE PIC X.
  2519         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2520         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2521         16  PI-PROVISIONAL-IND  PIC X.
  2522             88 PI-PROV-PMT      VALUE 'P'.
  2523         16  PI-PREV-TRLR-KEY    PIC X(22).
  2524         16  PI-SPLIT-PMT-SW     PIC X.
  2525         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2526         16  PI-ACTIVITY-CODE    PIC 99.
  2527         16  PI-RESET-SW         PIC X.
  2528         16  PI-SPECIAL-BEN-SW   PIC X.
  2529             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2530         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2531         16  PI-EXP-DT           PIC XX.
  2532         16  PI-LOAN-DUE-DAY     PIC 99.
  2533         16  PI-3RD-PARTY-SW     PIC X.
  2534         16  PI-LOAN-UPDATE-SW   PIC X.
  2535
  2536         16  PI-DMD-DATA.
  2537             20  PI-SV-CERT-KEY       PIC X(21).
  2538             20  PI-SV-CERT-NO        PIC X(11).
  2539             20  PI-SV-BEN            PIC X(10).
  2540             20  PI-SV-CCN            PIC X(16).
  2541             20  PI-INTEREST-PAID-IND PIC X.
  2542                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2543             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2544             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2545             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2546             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2547         16  PI-AT-EOB-CODES.
  2548             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2549         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2550         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2551         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2552         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2553         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2554         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2555         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2556         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2557         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2558         16  PI-LF-BENEFIT-CD         PIC X(2).
  2559         16  PI-EOB-CODES-EXIST PIC X.
  2560         16  PI-SET-NOTE2-MDT   PIC X.
  2561         16  PI-VFY-2ND-BENE          PIC X.
  2562         16  PI-CLM-TYPE              PIC X.
  2563         16  PI-APPROVAL-LEVEL        PIC X.
  2564         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2565         16  PI-REAUDIT-NEEDED        PIC X.
  2566         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2567         16  PI-AH-BENEFIT-CD         PIC XX.
  2568         16  pi-ah-term               pic s999 comp-3.
  2569         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2570         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  52
* EL156.cbl
  2571         16  pi-max-ext-used          pic x.
  2572         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2573         16  PI-JOINT-COV-IND         PIC X.
  2574             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2575             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2576         16  PI-JOINT-INSURED-IND     PIC X.
  2577             88  PI-JOINT-INSURED        VALUE 'Y'.
  2578             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2579         16  pi-int-payees-name       pic x(30).
  2580         16  PI-RB-JOINT-COV-IND      PIC X.
  2581             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2582             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2583*00781          16  FILLER                   PIC X(176).
  2584*052506         16  FILLER                   PIC X(161).
  2585*031808         16  FILLER                   PIC X(154).
  2586*091808         16  FILLER                   PIC X(152).
  2587*041710         16  FILLER                   PIC X(94).
  2588         16  FILLER                   PIC X(35).
  2589
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  53
* EL156.cbl
  2591*    COPY ELCJPFX.
  2592******************************************************************
  2593*                                                                *
  2594*                                                                *
  2595*                            ELCJPFX.                            *
  2596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2597*                            VMOD=2.002                          *
  2598*                                                                *
  2599*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2600*                                                                *
  2601*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2602*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2603*        ELCNTL - CONTROL FILE                                   *
  2604*        ELMSTR - CLAIM MASTERS                                  *
  2605*        ELTRLR - ACTIVITY TRAILERS                              *
  2606*        ELCHKQ - CHECK QUE                                      *
  2607******************************************************************
  2608 01  JOURNAL-RECORD.
  2609     12  jp-date                     pic s9(5) comp-3.
  2610     12  jp-time                     pic s9(7) comp-3.
  2611     12  JP-USER-ID                  PIC X(4).
  2612     12  JP-FILE-ID                  PIC X(8).
  2613     12  JP-PROGRAM-ID               PIC X(8).
  2614     12  JP-RECORD-TYPE              PIC X.
  2615         88 JP-ADD              VALUE 'A'.
  2616         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2617         88 JP-AFTER-CHANGE     VALUE 'C'.
  2618         88 JP-DELETE           VALUE 'D'.
  2619         88 JP-GENERIC-DELETE   VALUE 'G'.
  2620         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2621         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2622     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2623     12  JP-RECORD-AREA
  2624
  2625
  2626                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  54
* EL156.cbl
  2628*    COPY ELCAID.
  2629******************************************************************
  2630*                                                                *
  2631*                            ELCAID.                             *
  2632*                            VMOD=2.001                          *
  2633*                                                                *
  2634*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2635*                                                                *
  2636*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2637*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2638******************************************************************
  2639
  2640 01  DFHAID.
  2641   02  DFHNULL   PIC  X  VALUE  ' '.
  2642   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2643   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2644   02  DFHPEN    PIC  X  VALUE  '='.
  2645   02  DFHOPID   PIC  X  VALUE  'W'.
  2646   02  DFHPA1    PIC  X  VALUE  '%'.
  2647   02  DFHPA2    PIC  X  VALUE  '>'.
  2648   02  DFHPA3    PIC  X  VALUE  ','.
  2649   02  DFHPF1    PIC  X  VALUE  '1'.
  2650   02  DFHPF2    PIC  X  VALUE  '2'.
  2651   02  DFHPF3    PIC  X  VALUE  '3'.
  2652   02  DFHPF4    PIC  X  VALUE  '4'.
  2653   02  DFHPF5    PIC  X  VALUE  '5'.
  2654   02  DFHPF6    PIC  X  VALUE  '6'.
  2655   02  DFHPF7    PIC  X  VALUE  '7'.
  2656   02  DFHPF8    PIC  X  VALUE  '8'.
  2657   02  DFHPF9    PIC  X  VALUE  '9'.
  2658   02  DFHPF10   PIC  X  VALUE  ':'.
  2659   02  DFHPF11   PIC  X  VALUE  '#'.
  2660   02  DFHPF12   PIC  X  VALUE  '@'.
  2661   02  DFHPF13   PIC  X  VALUE  'A'.
  2662   02  DFHPF14   PIC  X  VALUE  'B'.
  2663   02  DFHPF15   PIC  X  VALUE  'C'.
  2664   02  DFHPF16   PIC  X  VALUE  'D'.
  2665   02  DFHPF17   PIC  X  VALUE  'E'.
  2666   02  DFHPF18   PIC  X  VALUE  'F'.
  2667   02  DFHPF19   PIC  X  VALUE  'G'.
  2668   02  DFHPF20   PIC  X  VALUE  'H'.
  2669   02  DFHPF21   PIC  X  VALUE  'I'.
  2670*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2671   02  DFHPF22   PIC  X  VALUE  '['.
  2672   02  DFHPF23   PIC  X  VALUE  '.'.
  2673   02  DFHPF24   PIC  X  VALUE  '<'.
  2674   02  DFHMSRE   PIC  X  VALUE  'X'.
  2675   02  DFHSTRF   PIC  X  VALUE  'h'.
  2676   02  DFHTRIG   PIC  X  VALUE  '"'.
  2677 01  FILLER    REDEFINES DFHAID.
  2678     12  FILLER              PIC X(8).
  2679     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  55
* EL156.cbl
  2681*    COPY EL156S.
  2682 01  EL156AI.
  2683     05  FILLER            PIC  X(0012).
  2684*    -------------------------------
  2685     05  RUNDTEAL PIC S9(0004) COMP.
  2686     05  RUNDTEAF PIC  X(0001).
  2687     05  FILLER REDEFINES RUNDTEAF.
  2688         10  RUNDTEAA PIC  X(0001).
  2689     05  RUNDTEAI PIC  X(0008).
  2690*    -------------------------------
  2691     05  RUNTIMAL PIC S9(0004) COMP.
  2692     05  RUNTIMAF PIC  X(0001).
  2693     05  FILLER REDEFINES RUNTIMAF.
  2694         10  RUNTIMAA PIC  X(0001).
  2695     05  RUNTIMAI PIC  X(0005).
  2696*    -------------------------------
  2697     05  SEQUL PIC S9(0004) COMP.
  2698     05  SEQUF PIC  X(0001).
  2699     05  FILLER REDEFINES SEQUF.
  2700         10  SEQUA PIC  X(0001).
  2701     05  SEQUI PIC  X(0010).
  2702*    -------------------------------
  2703     05  CLMNOL PIC S9(0004) COMP.
  2704     05  CLMNOF PIC  X(0001).
  2705     05  FILLER REDEFINES CLMNOF.
  2706         10  CLMNOA PIC  X(0001).
  2707     05  CLMNOI PIC  X(0007).
  2708*    -------------------------------
  2709     05  CARRL PIC S9(0004) COMP.
  2710     05  CARRF PIC  X(0001).
  2711     05  FILLER REDEFINES CARRF.
  2712         10  CARRA PIC  X(0001).
  2713     05  CARRI PIC  X(0001).
  2714*    -------------------------------
  2715     05  CERTNOL PIC S9(0004) COMP.
  2716     05  CERTNOF PIC  X(0001).
  2717     05  FILLER REDEFINES CERTNOF.
  2718         10  CERTNOA PIC  X(0001).
  2719     05  CERTNOI PIC  X(0010).
  2720*    -------------------------------
  2721     05  SUFXL PIC S9(0004) COMP.
  2722     05  SUFXF PIC  X(0001).
  2723     05  FILLER REDEFINES SUFXF.
  2724         10  SUFXA PIC  X(0001).
  2725     05  SUFXI PIC  X(0001).
  2726*    -------------------------------
  2727     05  CLMTYPL PIC S9(0004) COMP.
  2728     05  CLMTYPF PIC  X(0001).
  2729     05  FILLER REDEFINES CLMTYPF.
  2730         10  CLMTYPA PIC  X(0001).
  2731     05  CLMTYPI PIC  X(0006).
  2732*    -------------------------------
  2733     05  CLMSTATL PIC S9(0004) COMP.
  2734     05  CLMSTATF PIC  X(0001).
  2735     05  FILLER REDEFINES CLMSTATF.
  2736         10  CLMSTATA PIC  X(0001).
  2737     05  CLMSTATI PIC  X(0006).
  2738*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  56
* EL156.cbl
  2739     05  LSTNMEL PIC S9(0004) COMP.
  2740     05  LSTNMEF PIC  X(0001).
  2741     05  FILLER REDEFINES LSTNMEF.
  2742         10  LSTNMEA PIC  X(0001).
  2743     05  LSTNMEI PIC  X(0015).
  2744*    -------------------------------
  2745     05  FSTNMEL PIC S9(0004) COMP.
  2746     05  FSTNMEF PIC  X(0001).
  2747     05  FILLER REDEFINES FSTNMEF.
  2748         10  FSTNMEA PIC  X(0001).
  2749     05  FSTNMEI PIC  X(0012).
  2750*    -------------------------------
  2751     05  MINITL PIC S9(0004) COMP.
  2752     05  MINITF PIC  X(0001).
  2753     05  FILLER REDEFINES MINITF.
  2754         10  MINITA PIC  X(0001).
  2755     05  MINITI PIC  X(0001).
  2756*    -------------------------------
  2757     05  PRIMHDGL PIC S9(0004) COMP.
  2758     05  PRIMHDGF PIC  X(0001).
  2759     05  FILLER REDEFINES PRIMHDGF.
  2760         10  PRIMHDGA PIC  X(0001).
  2761     05  PRIMHDGI PIC  X(0012).
  2762*    -------------------------------
  2763     05  PCERTNOL PIC S9(0004) COMP.
  2764     05  PCERTNOF PIC  X(0001).
  2765     05  FILLER REDEFINES PCERTNOF.
  2766         10  PCERTNOA PIC  X(0001).
  2767     05  PCERTNOI PIC  X(0010).
  2768*    -------------------------------
  2769     05  PSUFXL PIC S9(0004) COMP.
  2770     05  PSUFXF PIC  X(0001).
  2771     05  FILLER REDEFINES PSUFXF.
  2772         10  PSUFXA PIC  X(0001).
  2773     05  PSUFXI PIC  X(0001).
  2774*    -------------------------------
  2775     05  STATUSL PIC S9(0004) COMP.
  2776     05  STATUSF PIC  X(0001).
  2777     05  FILLER REDEFINES STATUSF.
  2778         10  STATUSA PIC  X(0001).
  2779     05  STATUSI PIC  X(0010).
  2780*    -------------------------------
  2781     05  LOANHL PIC S9(0004) COMP.
  2782     05  LOANHF PIC  X(0001).
  2783     05  FILLER REDEFINES LOANHF.
  2784         10  LOANHA PIC  X(0001).
  2785     05  LOANHI PIC  X(0014).
  2786*    -------------------------------
  2787     05  LOANNOL PIC S9(0004) COMP.
  2788     05  LOANNOF PIC  X(0001).
  2789     05  FILLER REDEFINES LOANNOF.
  2790         10  LOANNOA PIC  X(0001).
  2791     05  LOANNOI PIC  X(0025).
  2792*    -------------------------------
  2793     05  DUEDAYHL PIC S9(0004) COMP.
  2794     05  DUEDAYHF PIC  X(0001).
  2795     05  FILLER REDEFINES DUEDAYHF.
  2796         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  57
* EL156.cbl
  2797     05  DUEDAYHI PIC  X(0008).
  2798*    -------------------------------
  2799     05  DUEDAYL PIC S9(0004) COMP.
  2800     05  DUEDAYF PIC  X(0001).
  2801     05  FILLER REDEFINES DUEDAYF.
  2802         10  DUEDAYA PIC  X(0001).
  2803     05  DUEDAYI PIC  X(0002).
  2804*    -------------------------------
  2805     05  ZINTHL PIC S9(0004) COMP.
  2806     05  ZINTHF PIC  X(0001).
  2807     05  FILLER REDEFINES ZINTHF.
  2808         10  ZINTHA PIC  X(0001).
  2809     05  ZINTHI PIC  X(0009).
  2810*    -------------------------------
  2811     05  ZINTL PIC S9(0004) COMP.
  2812     05  ZINTF PIC  X(0001).
  2813     05  FILLER REDEFINES ZINTF.
  2814         10  ZINTA PIC  X(0001).
  2815     05  ZINTI PIC  99V99999.
  2816*    -------------------------------
  2817     05  PTHRHDGL PIC S9(0004) COMP.
  2818     05  PTHRHDGF PIC  X(0001).
  2819     05  FILLER REDEFINES PTHRHDGF.
  2820         10  PTHRHDGA PIC  X(0001).
  2821     05  PTHRHDGI PIC  X(0014).
  2822*    -------------------------------
  2823     05  PDTHRUL PIC S9(0004) COMP.
  2824     05  PDTHRUF PIC  X(0001).
  2825     05  FILLER REDEFINES PDTHRUF.
  2826         10  PDTHRUA PIC  X(0001).
  2827     05  PDTHRUI PIC  X(0008).
  2828*    -------------------------------
  2829     05  TOTPAIDL PIC S9(0004) COMP.
  2830     05  TOTPAIDF PIC  X(0001).
  2831     05  FILLER REDEFINES TOTPAIDF.
  2832         10  TOTPAIDA PIC  X(0001).
  2833     05  TOTPAIDI PIC  X(0010).
  2834*    -------------------------------
  2835     05  COVERL PIC S9(0004) COMP.
  2836     05  COVERF PIC  X(0001).
  2837     05  FILLER REDEFINES COVERF.
  2838         10  COVERA PIC  X(0001).
  2839     05  COVERI PIC  X(0010).
  2840*    -------------------------------
  2841     05  INCURL PIC S9(0004) COMP.
  2842     05  INCURF PIC  X(0001).
  2843     05  FILLER REDEFINES INCURF.
  2844         10  INCURA PIC  X(0001).
  2845     05  INCURI PIC  X(0008).
  2846*    -------------------------------
  2847     05  LSTDTEL PIC S9(0004) COMP.
  2848     05  LSTDTEF PIC  X(0001).
  2849     05  FILLER REDEFINES LSTDTEF.
  2850         10  LSTDTEA PIC  X(0001).
  2851     05  LSTDTEI PIC  X(0008).
  2852*    -------------------------------
  2853     05  CRTSTATL PIC S9(0004) COMP.
  2854     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  58
* EL156.cbl
  2855     05  FILLER REDEFINES CRTSTATF.
  2856         10  CRTSTATA PIC  X(0001).
  2857     05  CRTSTATI PIC  X(0010).
  2858*    -------------------------------
  2859     05  EFFECTL PIC S9(0004) COMP.
  2860     05  EFFECTF PIC  X(0001).
  2861     05  FILLER REDEFINES EFFECTF.
  2862         10  EFFECTA PIC  X(0001).
  2863     05  EFFECTI PIC  X(0008).
  2864*    -------------------------------
  2865     05  TERMSL PIC S9(0004) COMP.
  2866     05  TERMSF PIC  X(0001).
  2867     05  FILLER REDEFINES TERMSF.
  2868         10  TERMSA PIC  X(0001).
  2869     05  TERMSI PIC  X(0011).
  2870*    -------------------------------
  2871     05  STACCTL PIC S9(0004) COMP.
  2872     05  STACCTF PIC  X(0001).
  2873     05  FILLER REDEFINES STACCTF.
  2874         10  STACCTA PIC  X(0001).
  2875     05  STACCTI PIC  X(0013).
  2876*    -------------------------------
  2877     05  EXPDTEHL PIC S9(0004) COMP.
  2878     05  EXPDTEHF PIC  X(0001).
  2879     05  FILLER REDEFINES EXPDTEHF.
  2880         10  EXPDTEHA PIC  X(0001).
  2881     05  EXPDTEHI PIC  X(0014).
  2882*    -------------------------------
  2883     05  EXPDTEL PIC S9(0004) COMP.
  2884     05  EXPDTEF PIC  X(0001).
  2885     05  FILLER REDEFINES EXPDTEF.
  2886         10  EXPDTEA PIC  X(0001).
  2887     05  EXPDTEI PIC  X(0008).
  2888*    -------------------------------
  2889     05  BENECAPL PIC S9(0004) COMP.
  2890     05  BENECAPF PIC  X(0001).
  2891     05  FILLER REDEFINES BENECAPF.
  2892         10  BENECAPA PIC  X(0001).
  2893     05  BENECAPI PIC  X(0013).
  2894*    -------------------------------
  2895     05  BENEL PIC S9(0004) COMP.
  2896     05  BENEF PIC  X(0001).
  2897     05  FILLER REDEFINES BENEF.
  2898         10  BENEA PIC  X(0001).
  2899     05  BENEI PIC  X(0009).
  2900*    -------------------------------
  2901     05  FORMTYPL PIC S9(0004) COMP.
  2902     05  FORMTYPF PIC  X(0001).
  2903     05  FILLER REDEFINES FORMTYPF.
  2904         10  FORMTYPA PIC  X(0001).
  2905     05  FORMTYPI PIC  X(0001).
  2906*    -------------------------------
  2907     05  PMTTYPEL PIC S9(0004) COMP.
  2908     05  PMTTYPEF PIC  X(0001).
  2909     05  FILLER REDEFINES PMTTYPEF.
  2910         10  PMTTYPEA PIC  X(0001).
  2911     05  PMTTYPEI PIC  X(0001).
  2912*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  59
* EL156.cbl
  2913     05  PAYEEL PIC S9(0004) COMP.
  2914     05  PAYEEF PIC  X(0001).
  2915     05  FILLER REDEFINES PAYEEF.
  2916         10  PAYEEA PIC  X(0001).
  2917     05  PAYEEI PIC  X(0002).
  2918*    -------------------------------
  2919     05  CHECKNOL PIC S9(0004) COMP.
  2920     05  CHECKNOF PIC  X(0001).
  2921     05  FILLER REDEFINES CHECKNOF.
  2922         10  CHECKNOA PIC  X(0001).
  2923     05  CHECKNOI PIC  X(0007).
  2924*    -------------------------------
  2925     05  OFFLINEL PIC S9(0004) COMP.
  2926     05  OFFLINEF PIC  X(0001).
  2927     05  FILLER REDEFINES OFFLINEF.
  2928         10  OFFLINEA PIC  X(0001).
  2929     05  OFFLINEI PIC  X(0001).
  2930*    -------------------------------
  2931     05  HOLDTILL PIC S9(0004) COMP.
  2932     05  HOLDTILF PIC  X(0001).
  2933     05  FILLER REDEFINES HOLDTILF.
  2934         10  HOLDTILA PIC  X(0001).
  2935     05  HOLDTILI PIC  X(0008).
  2936*    -------------------------------
  2937     05  NOTE1L PIC S9(0004) COMP.
  2938     05  NOTE1F PIC  X(0001).
  2939     05  FILLER REDEFINES NOTE1F.
  2940         10  NOTE1A PIC  X(0001).
  2941     05  NOTE1I PIC  X(0060).
  2942*    -------------------------------
  2943     05  ITRB1L PIC S9(0004) COMP.
  2944     05  ITRB1F PIC  X(0001).
  2945     05  FILLER REDEFINES ITRB1F.
  2946         10  ITRB1A PIC  X(0001).
  2947     05  ITRB1I PIC  X(0008).
  2948*    -------------------------------
  2949     05  NOTE2L PIC S9(0004) COMP.
  2950     05  NOTE2F PIC  X(0001).
  2951     05  FILLER REDEFINES NOTE2F.
  2952         10  NOTE2A PIC  X(0001).
  2953     05  NOTE2I PIC  X(0060).
  2954*    -------------------------------
  2955     05  ITRB2L PIC S9(0004) COMP.
  2956     05  ITRB2F PIC  X(0001).
  2957     05  FILLER REDEFINES ITRB2F.
  2958         10  ITRB2A PIC  X(0001).
  2959     05  ITRB2I PIC  X(0010).
  2960*    -------------------------------
  2961     05  EOBYNL PIC S9(0004) COMP.
  2962     05  EOBYNF PIC  X(0001).
  2963     05  FILLER REDEFINES EOBYNF.
  2964         10  EOBYNA PIC  X(0001).
  2965     05  EOBYNI PIC  X(0001).
  2966*    -------------------------------
  2967     05  CLMFMYNL PIC S9(0004) COMP.
  2968     05  CLMFMYNF PIC  X(0001).
  2969     05  FILLER REDEFINES CLMFMYNF.
  2970         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  60
* EL156.cbl
  2971     05  CLMFMYNI PIC  X(0001).
  2972*    -------------------------------
  2973     05  SURVYYNL PIC S9(0004) COMP.
  2974     05  SURVYYNF PIC  X(0001).
  2975     05  FILLER REDEFINES SURVYYNF.
  2976         10  SURVYYNA PIC  X(0001).
  2977     05  SURVYYNI PIC  X(0001).
  2978*    -------------------------------
  2979     05  SPRELYNL PIC S9(0004) COMP.
  2980     05  SPRELYNF PIC  X(0001).
  2981     05  FILLER REDEFINES SPRELYNF.
  2982         10  SPRELYNA PIC  X(0001).
  2983     05  SPRELYNI PIC  X(0001).
  2984*    -------------------------------
  2985     05  PINTHL PIC S9(0004) COMP.
  2986     05  PINTHF PIC  X(0001).
  2987     05  FILLER REDEFINES PINTHF.
  2988         10  PINTHA PIC  X(0001).
  2989     05  PINTHI PIC  X(0004).
  2990*    -------------------------------
  2991     05  PINTL PIC S9(0004) COMP.
  2992     05  PINTF PIC  X(0001).
  2993     05  FILLER REDEFINES PINTF.
  2994         10  PINTA PIC  X(0001).
  2995     05  PINTI PIC  X(0008).
  2996*    -------------------------------
  2997     05  ITRBYNL PIC S9(0004) COMP.
  2998     05  ITRBYNF PIC  X(0001).
  2999     05  FILLER REDEFINES ITRBYNF.
  3000         10  ITRBYNA PIC  X(0001).
  3001     05  ITRBYNI PIC  X(0001).
  3002*    -------------------------------
  3003     05  PROOFDTL PIC S9(0004) COMP.
  3004     05  PROOFDTF PIC  X(0001).
  3005     05  FILLER REDEFINES PROOFDTF.
  3006         10  PROOFDTA PIC  X(0001).
  3007     05  PROOFDTI PIC  X(0008).
  3008*    -------------------------------
  3009     05  AIGFRMHL PIC S9(0004) COMP.
  3010     05  AIGFRMHF PIC  X(0001).
  3011     05  FILLER REDEFINES AIGFRMHF.
  3012         10  AIGFRMHA PIC  X(0001).
  3013     05  AIGFRMHI PIC  X(0012).
  3014*    -------------------------------
  3015     05  AIGFROML PIC S9(0004) COMP.
  3016     05  AIGFROMF PIC  X(0001).
  3017     05  FILLER REDEFINES AIGFROMF.
  3018         10  AIGFROMA PIC  X(0001).
  3019     05  AIGFROMI PIC  X(0008).
  3020*    -------------------------------
  3021     05  PMTHDGAL PIC S9(0004) COMP.
  3022     05  PMTHDGAF PIC  X(0001).
  3023     05  FILLER REDEFINES PMTHDGAF.
  3024         10  PMTHDGAA PIC  X(0001).
  3025     05  PMTHDGAI PIC  X(0066).
  3026*    -------------------------------
  3027     05  EPYFROML PIC S9(0004) COMP.
  3028     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  61
* EL156.cbl
  3029     05  FILLER REDEFINES EPYFROMF.
  3030         10  EPYFROMA PIC  X(0001).
  3031     05  EPYFROMI PIC  X(0008).
  3032*    -------------------------------
  3033     05  EPYTHRUL PIC S9(0004) COMP.
  3034     05  EPYTHRUF PIC  X(0001).
  3035     05  FILLER REDEFINES EPYTHRUF.
  3036         10  EPYTHRUA PIC  X(0001).
  3037     05  EPYTHRUI PIC  X(0008).
  3038*    -------------------------------
  3039     05  EDAYSL PIC S9(0004) COMP.
  3040     05  EDAYSF PIC  X(0001).
  3041     05  FILLER REDEFINES EDAYSF.
  3042         10  EDAYSA PIC  X(0001).
  3043     05  EDAYSI PIC  S9(6).
  3044*    -------------------------------
  3045     05  EPYAMTL PIC S9(0004) COMP.
  3046     05  EPYAMTF PIC  X(0001).
  3047     05  FILLER REDEFINES EPYAMTF.
  3048         10  EPYAMTA PIC  X(0001).
  3049     05  EPYAMTI PIC  S9(8)V99.
  3050*    -------------------------------
  3051     05  ERESVL PIC S9(0004) COMP.
  3052     05  ERESVF PIC  X(0001).
  3053     05  FILLER REDEFINES ERESVF.
  3054         10  ERESVA PIC  X(0001).
  3055     05  ERESVI PIC  S9(7)V99.
  3056*    -------------------------------
  3057     05  ETYPEL PIC S9(0004) COMP.
  3058     05  ETYPEF PIC  X(0001).
  3059     05  FILLER REDEFINES ETYPEF.
  3060         10  ETYPEA PIC  X(0001).
  3061     05  ETYPEI PIC  X(0001).
  3062*    -------------------------------
  3063     05  EEXPENSL PIC S9(0004) COMP.
  3064     05  EEXPENSF PIC  X(0001).
  3065     05  FILLER REDEFINES EEXPENSF.
  3066         10  EEXPENSA PIC  X(0001).
  3067     05  EEXPENSI PIC  9(6)V99.
  3068*    -------------------------------
  3069     05  CPYFROML PIC S9(0004) COMP.
  3070     05  CPYFROMF PIC  X(0001).
  3071     05  FILLER REDEFINES CPYFROMF.
  3072         10  CPYFROMA PIC  X(0001).
  3073     05  CPYFROMI PIC  X(0008).
  3074*    -------------------------------
  3075     05  CPYTHRUL PIC S9(0004) COMP.
  3076     05  CPYTHRUF PIC  X(0001).
  3077     05  FILLER REDEFINES CPYTHRUF.
  3078         10  CPYTHRUA PIC  X(0001).
  3079     05  CPYTHRUI PIC  X(0008).
  3080*    -------------------------------
  3081     05  CDAYSL PIC S9(0004) COMP.
  3082     05  CDAYSF PIC  X(0001).
  3083     05  FILLER REDEFINES CDAYSF.
  3084         10  CDAYSA PIC  X(0001).
  3085     05  CDAYSI PIC  9(6).
  3086*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  62
* EL156.cbl
  3087     05  CPYAMTL PIC S9(0004) COMP.
  3088     05  CPYAMTF PIC  X(0001).
  3089     05  FILLER REDEFINES CPYAMTF.
  3090         10  CPYAMTA PIC  X(0001).
  3091     05  CPYAMTI PIC  S9(8)V99.
  3092*    -------------------------------
  3093     05  CRESVL PIC S9(0004) COMP.
  3094     05  CRESVF PIC  X(0001).
  3095     05  FILLER REDEFINES CRESVF.
  3096         10  CRESVA PIC  X(0001).
  3097     05  CRESVI PIC  9(6)V99.
  3098*    -------------------------------
  3099     05  CEXPENSL PIC S9(0004) COMP.
  3100     05  CEXPENSF PIC  X(0001).
  3101     05  FILLER REDEFINES CEXPENSF.
  3102         10  CEXPENSA PIC  X(0001).
  3103     05  CEXPENSI PIC  9(6)V99.
  3104*    -------------------------------
  3105     05  ERRMSG0L PIC S9(0004) COMP.
  3106     05  ERRMSG0F PIC  X(0001).
  3107     05  FILLER REDEFINES ERRMSG0F.
  3108         10  ERRMSG0A PIC  X(0001).
  3109     05  ERRMSG0I PIC  X(0072).
  3110*    -------------------------------
  3111     05  ERRMSG1L PIC S9(0004) COMP.
  3112     05  ERRMSG1F PIC  X(0001).
  3113     05  FILLER REDEFINES ERRMSG1F.
  3114         10  ERRMSG1A PIC  X(0001).
  3115     05  ERRMSG1I PIC  X(0072).
  3116*    -------------------------------
  3117     05  ERRMSG2L PIC S9(0004) COMP.
  3118     05  ERRMSG2F PIC  X(0001).
  3119     05  FILLER REDEFINES ERRMSG2F.
  3120         10  ERRMSG2A PIC  X(0001).
  3121     05  ERRMSG2I PIC  X(0072).
  3122*    -------------------------------
  3123     05  ENTERPFL PIC S9(0004) COMP.
  3124     05  ENTERPFF PIC  X(0001).
  3125     05  FILLER REDEFINES ENTERPFF.
  3126         10  ENTERPFA PIC  X(0001).
  3127     05  ENTERPFI PIC  99.
  3128*    -------------------------------
  3129     05  PF6TITL PIC S9(0004) COMP.
  3130     05  PF6TITF PIC  X(0001).
  3131     05  FILLER REDEFINES PF6TITF.
  3132         10  PF6TITA PIC  X(0001).
  3133     05  PF6TITI PIC  X(0016).
  3134 01  EL156AO REDEFINES EL156AI.
  3135     05  FILLER            PIC  X(0012).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  RUNDTEAO PIC  X(0008).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  RUNTIMAO PIC  99.99.
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  63
* EL156.cbl
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  CLMNOO PIC  X(0007).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  CARRO PIC  X(0001).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  CERTNOO PIC  X(0010).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  SUFXO PIC  X(0001).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  CLMTYPO PIC  X(0006).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  CLMSTATO PIC  X(0006).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  LSTNMEO PIC  X(0015).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  FSTNMEO PIC  X(0012).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  MINITO PIC  X(0001).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  PRIMHDGO PIC  X(0012).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  PCERTNOO PIC  X(0010).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  PSUFXO PIC  X(0001).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  STATUSO PIC  X(0010).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  LOANHO PIC  X(0014).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  LOANNOO PIC  X(0025).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  DUEDAYHO PIC  X(0008).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  DUEDAYO PIC  X(0002).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  ZINTHO PIC  X(0009).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  ZINTO PIC  9.99999.
  3202*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  64
* EL156.cbl
  3203     05  FILLER            PIC  X(0003).
  3204     05  PTHRHDGO PIC  X(0014).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  PDTHRUO PIC  X(0008).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  TOTPAIDO PIC  Z(6).99-.
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  COVERO PIC  X(0010).
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  INCURO PIC  X(0008).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  LSTDTEO PIC  X(0008).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  CRTSTATO PIC  X(0010).
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  EFFECTO PIC  X(0008).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  TERMSO PIC  X(0011).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  STACCTO PIC  X(0013).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  EXPDTEHO PIC  X(0014).
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  EXPDTEO PIC  X(0008).
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  BENECAPO PIC  X(0013).
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  BENEO PIC  Z(6).99.
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  FORMTYPO PIC  X(0001).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  PMTTYPEO PIC  X(0001).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  PAYEEO PIC  X(0002).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  CHECKNOO PIC  X(0007).
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  OFFLINEO PIC  X(0001).
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  65
* EL156.cbl
  3261     05  HOLDTILO PIC  99B99B99.
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  NOTE1O PIC  X(0060).
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  ITRB1O PIC  X(0008).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  NOTE2O PIC  X(0060).
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  ITRB2O PIC  X(0010).
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  EOBYNO PIC  X(0001).
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  CLMFMYNO PIC  X(0001).
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  SURVYYNO PIC  X(0001).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  SPRELYNO PIC  X(0001).
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  PINTHO PIC  X(0004).
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  PINTO PIC  Z,ZZ9.99.
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  ITRBYNO PIC  X(0001).
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  PROOFDTO PIC  99B99B99.
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  AIGFRMHO PIC  X(0012).
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  AIGFROMO PIC  99B99B99.
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  PMTHDGAO PIC  X(0066).
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  EPYFROMO PIC  99B99B99.
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  EPYTHRUO PIC  99B99B99.
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  EDAYSO PIC  Z(4)9-.
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  66
* EL156.cbl
  3319*    -------------------------------
  3320     05  FILLER            PIC  X(0003).
  3321     05  ERESVO PIC  Z(5).99-.
  3322*    -------------------------------
  3323     05  FILLER            PIC  X(0003).
  3324     05  ETYPEO PIC  X(0001).
  3325*    -------------------------------
  3326     05  FILLER            PIC  X(0003).
  3327     05  EEXPENSO PIC  Z(5).99.
  3328*    -------------------------------
  3329     05  FILLER            PIC  X(0003).
  3330     05  CPYFROMO PIC  99B99B99.
  3331*    -------------------------------
  3332     05  FILLER            PIC  X(0003).
  3333     05  CPYTHRUO PIC  99B99B99.
  3334*    -------------------------------
  3335     05  FILLER            PIC  X(0003).
  3336     05  CDAYSO PIC  Z(4)9-.
  3337*    -------------------------------
  3338     05  FILLER            PIC  X(0003).
  3339     05  CPYAMTO PIC  Z(6).99-.
  3340*    -------------------------------
  3341     05  FILLER            PIC  X(0003).
  3342     05  CRESVO PIC  Z(5).99.
  3343*    -------------------------------
  3344     05  FILLER            PIC  X(0003).
  3345     05  CEXPENSO PIC  Z(5).99.
  3346*    -------------------------------
  3347     05  FILLER            PIC  X(0003).
  3348     05  ERRMSG0O PIC  X(0072).
  3349*    -------------------------------
  3350     05  FILLER            PIC  X(0003).
  3351     05  ERRMSG1O PIC  X(0072).
  3352*    -------------------------------
  3353     05  FILLER            PIC  X(0003).
  3354     05  ERRMSG2O PIC  X(0072).
  3355*    -------------------------------
  3356     05  FILLER            PIC  X(0003).
  3357     05  ENTERPFO PIC  X(0002).
  3358*    -------------------------------
  3359     05  FILLER            PIC  X(0003).
  3360     05  PF6TITO PIC  X(0016).
  3361*    -------------------------------
  3362 01  EL156BI REDEFINES EL156AI.
  3363     05  FILLER            PIC  X(0012).
  3364*    -------------------------------
  3365     05  RUNDTEBL PIC S9(0004) COMP.
  3366     05  RUNDTEBF PIC  X(0001).
  3367     05  FILLER REDEFINES RUNDTEBF.
  3368         10  RUNDTEBA PIC  X(0001).
  3369     05  RUNDTEBI PIC  X(0008).
  3370*    -------------------------------
  3371     05  RUNTIMBL PIC S9(0004) COMP.
  3372     05  RUNTIMBF PIC  X(0001).
  3373     05  FILLER REDEFINES RUNTIMBF.
  3374         10  RUNTIMBA PIC  X(0001).
  3375     05  RUNTIMBI PIC  X(0005).
  3376*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  67
* EL156.cbl
  3377     05  PAYDTBL PIC S9(0004) COMP.
  3378     05  PAYDTBF PIC  X(0001).
  3379     05  FILLER REDEFINES PAYDTBF.
  3380         10  PAYDTBA PIC  X(0001).
  3381     05  PAYDTBI PIC  X(0008).
  3382*    -------------------------------
  3383     05  PAYTYPBL PIC S9(0004) COMP.
  3384     05  PAYTYPBF PIC  X(0001).
  3385     05  FILLER REDEFINES PAYTYPBF.
  3386         10  PAYTYPBA PIC  X(0001).
  3387     05  PAYTYPBI PIC  X(0015).
  3388*    -------------------------------
  3389     05  PAYAMTBL PIC S9(0004) COMP.
  3390     05  PAYAMTBF PIC  X(0001).
  3391     05  FILLER REDEFINES PAYAMTBF.
  3392         10  PAYAMTBA PIC  X(0001).
  3393     05  PAYAMTBI PIC  X(0011).
  3394*    -------------------------------
  3395     05  LOANHBL PIC S9(0004) COMP.
  3396     05  LOANHBF PIC  X(0001).
  3397     05  FILLER REDEFINES LOANHBF.
  3398         10  LOANHBA PIC  X(0001).
  3399     05  LOANHBI PIC  X(0012).
  3400*    -------------------------------
  3401     05  LOANNBL PIC S9(0004) COMP.
  3402     05  LOANNBF PIC  X(0001).
  3403     05  FILLER REDEFINES LOANNBF.
  3404         10  LOANNBA PIC  X(0001).
  3405     05  LOANNBI PIC  X(0025).
  3406*    -------------------------------
  3407     05  CKNUMHDL PIC S9(0004) COMP.
  3408     05  CKNUMHDF PIC  X(0001).
  3409     05  FILLER REDEFINES CKNUMHDF.
  3410         10  CKNUMHDA PIC  X(0001).
  3411     05  CKNUMHDI PIC  X(0012).
  3412*    -------------------------------
  3413     05  CKNUMBL PIC S9(0004) COMP.
  3414     05  CKNUMBF PIC  X(0001).
  3415     05  FILLER REDEFINES CKNUMBF.
  3416         10  CKNUMBA PIC  X(0001).
  3417     05  CKNUMBI PIC  X(0007).
  3418*    -------------------------------
  3419     05  AGTHDGL PIC S9(0004) COMP.
  3420     05  AGTHDGF PIC  X(0001).
  3421     05  FILLER REDEFINES AGTHDGF.
  3422         10  AGTHDGA PIC  X(0001).
  3423     05  AGTHDGI PIC  X(0016).
  3424*    -------------------------------
  3425     05  NAMEBL PIC S9(0004) COMP.
  3426     05  NAMEBF PIC  X(0001).
  3427     05  FILLER REDEFINES NAMEBF.
  3428         10  NAMEBA PIC  X(0001).
  3429     05  NAMEBI PIC  X(0030).
  3430*    -------------------------------
  3431     05  NAMEB2L PIC S9(0004) COMP.
  3432     05  NAMEB2F PIC  X(0001).
  3433     05  FILLER REDEFINES NAMEB2F.
  3434         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  68
* EL156.cbl
  3435     05  NAMEB2I PIC  X(0030).
  3436*    -------------------------------
  3437     05  ADDR1BL PIC S9(0004) COMP.
  3438     05  ADDR1BF PIC  X(0001).
  3439     05  FILLER REDEFINES ADDR1BF.
  3440         10  ADDR1BA PIC  X(0001).
  3441     05  ADDR1BI PIC  X(0030).
  3442*    -------------------------------
  3443     05  ADDR1B2L PIC S9(0004) COMP.
  3444     05  ADDR1B2F PIC  X(0001).
  3445     05  FILLER REDEFINES ADDR1B2F.
  3446         10  ADDR1B2A PIC  X(0001).
  3447     05  ADDR1B2I PIC  X(0030).
  3448*    -------------------------------
  3449     05  ADDR2BL PIC S9(0004) COMP.
  3450     05  ADDR2BF PIC  X(0001).
  3451     05  FILLER REDEFINES ADDR2BF.
  3452         10  ADDR2BA PIC  X(0001).
  3453     05  ADDR2BI PIC  X(0030).
  3454*    -------------------------------
  3455     05  ADDR2B2L PIC S9(0004) COMP.
  3456     05  ADDR2B2F PIC  X(0001).
  3457     05  FILLER REDEFINES ADDR2B2F.
  3458         10  ADDR2B2A PIC  X(0001).
  3459     05  ADDR2B2I PIC  X(0030).
  3460*    -------------------------------
  3461     05  CITYSTBL PIC S9(0004) COMP.
  3462     05  CITYSTBF PIC  X(0001).
  3463     05  FILLER REDEFINES CITYSTBF.
  3464         10  CITYSTBA PIC  X(0001).
  3465     05  CITYSTBI PIC  X(0030).
  3466*    -------------------------------
  3467     05  CITYST2L PIC S9(0004) COMP.
  3468     05  CITYST2F PIC  X(0001).
  3469     05  FILLER REDEFINES CITYST2F.
  3470         10  CITYST2A PIC  X(0001).
  3471     05  CITYST2I PIC  X(0030).
  3472*    -------------------------------
  3473     05  ZIPBL PIC S9(0004) COMP.
  3474     05  ZIPBF PIC  X(0001).
  3475     05  FILLER REDEFINES ZIPBF.
  3476         10  ZIPBA PIC  X(0001).
  3477     05  ZIPBI PIC  X(0009).
  3478*    -------------------------------
  3479     05  ZIPB2L PIC S9(0004) COMP.
  3480     05  ZIPB2F PIC  X(0001).
  3481     05  FILLER REDEFINES ZIPB2F.
  3482         10  ZIPB2A PIC  X(0001).
  3483     05  ZIPB2I PIC  X(0009).
  3484*    -------------------------------
  3485     05  INTHDBL PIC S9(0004) COMP.
  3486     05  INTHDBF PIC  X(0001).
  3487     05  FILLER REDEFINES INTHDBF.
  3488         10  INTHDBA PIC  X(0001).
  3489     05  INTHDBI PIC  X(0012).
  3490*    -------------------------------
  3491     05  INTAMTBL PIC S9(0004) COMP.
  3492     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  69
* EL156.cbl
  3493     05  FILLER REDEFINES INTAMTBF.
  3494         10  INTAMTBA PIC  X(0001).
  3495     05  INTAMTBI PIC  X(0011).
  3496*    -------------------------------
  3497     05  PMTHDGBL PIC S9(0004) COMP.
  3498     05  PMTHDGBF PIC  X(0001).
  3499     05  FILLER REDEFINES PMTHDGBF.
  3500         10  PMTHDGBA PIC  X(0001).
  3501     05  PMTHDGBI PIC  X(0034).
  3502*    -------------------------------
  3503     05  CLMNOBL PIC S9(0004) COMP.
  3504     05  CLMNOBF PIC  X(0001).
  3505     05  FILLER REDEFINES CLMNOBF.
  3506         10  CLMNOBA PIC  X(0001).
  3507     05  CLMNOBI PIC  X(0007).
  3508*    -------------------------------
  3509     05  CARRBL PIC S9(0004) COMP.
  3510     05  CARRBF PIC  X(0001).
  3511     05  FILLER REDEFINES CARRBF.
  3512         10  CARRBA PIC  X(0001).
  3513     05  CARRBI PIC  X(0001).
  3514*    -------------------------------
  3515     05  CERTNOBL PIC S9(0004) COMP.
  3516     05  CERTNOBF PIC  X(0001).
  3517     05  FILLER REDEFINES CERTNOBF.
  3518         10  CERTNOBA PIC  X(0001).
  3519     05  CERTNOBI PIC  X(0010).
  3520*    -------------------------------
  3521     05  SUFXBL PIC S9(0004) COMP.
  3522     05  SUFXBF PIC  X(0001).
  3523     05  FILLER REDEFINES SUFXBF.
  3524         10  SUFXBA PIC  X(0001).
  3525     05  SUFXBI PIC  X(0001).
  3526*    -------------------------------
  3527     05  CLMTYPBL PIC S9(0004) COMP.
  3528     05  CLMTYPBF PIC  X(0001).
  3529     05  FILLER REDEFINES CLMTYPBF.
  3530         10  CLMTYPBA PIC  X(0001).
  3531     05  CLMTYPBI PIC  X(0006).
  3532*    -------------------------------
  3533     05  INCURBL PIC S9(0004) COMP.
  3534     05  INCURBF PIC  X(0001).
  3535     05  FILLER REDEFINES INCURBF.
  3536         10  INCURBA PIC  X(0001).
  3537     05  INCURBI PIC  X(0008).
  3538*    -------------------------------
  3539     05  PYFROMBL PIC S9(0004) COMP.
  3540     05  PYFROMBF PIC  X(0001).
  3541     05  FILLER REDEFINES PYFROMBF.
  3542         10  PYFROMBA PIC  X(0001).
  3543     05  PYFROMBI PIC  X(0008).
  3544*    -------------------------------
  3545     05  PYTHRUBL PIC S9(0004) COMP.
  3546     05  PYTHRUBF PIC  X(0001).
  3547     05  FILLER REDEFINES PYTHRUBF.
  3548         10  PYTHRUBA PIC  X(0001).
  3549     05  PYTHRUBI PIC  X(0008).
  3550*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  70
* EL156.cbl
  3551     05  DAYSBL PIC S9(0004) COMP.
  3552     05  DAYSBF PIC  X(0001).
  3553     05  FILLER REDEFINES DAYSBF.
  3554         10  DAYSBA PIC  X(0001).
  3555     05  DAYSBI PIC  X(0005).
  3556*    -------------------------------
  3557     05  BYBL PIC S9(0004) COMP.
  3558     05  BYBF PIC  X(0001).
  3559     05  FILLER REDEFINES BYBF.
  3560         10  BYBA PIC  X(0001).
  3561     05  BYBI PIC  X(0004).
  3562*    -------------------------------
  3563     05  PROOFDBL PIC S9(0004) COMP.
  3564     05  PROOFDBF PIC  X(0001).
  3565     05  FILLER REDEFINES PROOFDBF.
  3566         10  PROOFDBA PIC  X(0001).
  3567     05  PROOFDBI PIC  X(0008).
  3568*    -------------------------------
  3569     05  ACCTBL PIC S9(0004) COMP.
  3570     05  ACCTBF PIC  X(0001).
  3571     05  FILLER REDEFINES ACCTBF.
  3572         10  ACCTBA PIC  X(0001).
  3573     05  ACCTBI PIC  X(0010).
  3574*    -------------------------------
  3575     05  STATEBL PIC S9(0004) COMP.
  3576     05  STATEBF PIC  X(0001).
  3577     05  FILLER REDEFINES STATEBF.
  3578         10  STATEBA PIC  X(0001).
  3579     05  STATEBI PIC  X(0002).
  3580*    -------------------------------
  3581     05  GROUPBL PIC S9(0004) COMP.
  3582     05  GROUPBF PIC  X(0001).
  3583     05  FILLER REDEFINES GROUPBF.
  3584         10  GROUPBA PIC  X(0001).
  3585     05  GROUPBI PIC  X(0006).
  3586*    -------------------------------
  3587     05  ACARRBL PIC S9(0004) COMP.
  3588     05  ACARRBF PIC  X(0001).
  3589     05  FILLER REDEFINES ACARRBF.
  3590         10  ACARRBA PIC  X(0001).
  3591     05  ACARRBI PIC  X(0001).
  3592*    -------------------------------
  3593     05  ACCTNMBL PIC S9(0004) COMP.
  3594     05  ACCTNMBF PIC  X(0001).
  3595     05  FILLER REDEFINES ACCTNMBF.
  3596         10  ACCTNMBA PIC  X(0001).
  3597     05  ACCTNMBI PIC  X(0030).
  3598*    -------------------------------
  3599     05  UNDISBL PIC S9(0004) COMP.
  3600     05  UNDISBF PIC  X(0001).
  3601     05  FILLER REDEFINES UNDISBF.
  3602         10  UNDISBA PIC  X(0001).
  3603     05  UNDISBI PIC  X(0010).
  3604*    -------------------------------
  3605     05  RATEBL PIC S9(0004) COMP.
  3606     05  RATEBF PIC  X(0001).
  3607     05  FILLER REDEFINES RATEBF.
  3608         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  71
* EL156.cbl
  3609     05  RATEBI PIC  X(0006).
  3610*    -------------------------------
  3611     05  ERMSG1BL PIC S9(0004) COMP.
  3612     05  ERMSG1BF PIC  X(0001).
  3613     05  FILLER REDEFINES ERMSG1BF.
  3614         10  ERMSG1BA PIC  X(0001).
  3615     05  ERMSG1BI PIC  X(0072).
  3616*    -------------------------------
  3617     05  ENTPFBL PIC S9(0004) COMP.
  3618     05  ENTPFBF PIC  X(0001).
  3619     05  FILLER REDEFINES ENTPFBF.
  3620         10  ENTPFBA PIC  X(0001).
  3621     05  ENTPFBI PIC  99.
  3622 01  EL156BO REDEFINES EL156AI.
  3623     05  FILLER            PIC  X(0012).
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  RUNDTEBO PIC  X(0008).
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  RUNTIMBO PIC  99.99.
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  PAYDTBO PIC  99B99B99.
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  PAYTYPBO PIC  X(0015).
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  LOANHBO PIC  X(0012).
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  LOANNBO PIC  X(0025).
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  CKNUMHDO PIC  X(0012).
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  CKNUMBO PIC  X(0007).
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  AGTHDGO PIC  X(0016).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  NAMEBO PIC  X(0030).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  NAMEB2O PIC  X(0030).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  ADDR1BO PIC  X(0030).
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  ADDR1B2O PIC  X(0030).
  3666*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  72
* EL156.cbl
  3667     05  FILLER            PIC  X(0003).
  3668     05  ADDR2BO PIC  X(0030).
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  ADDR2B2O PIC  X(0030).
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  CITYSTBO PIC  X(0030).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  CITYST2O PIC  X(0030).
  3678*    -------------------------------
  3679     05  FILLER            PIC  X(0003).
  3680     05  ZIPBO PIC  ZZZZ99999.
  3681*    -------------------------------
  3682     05  FILLER            PIC  X(0003).
  3683     05  ZIPB2O PIC  ZZZZZZZZZ.
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  INTHDBO PIC  X(0012).
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
  3692     05  PMTHDGBO PIC  X(0034).
  3693*    -------------------------------
  3694     05  FILLER            PIC  X(0003).
  3695     05  CLMNOBO PIC  X(0007).
  3696*    -------------------------------
  3697     05  FILLER            PIC  X(0003).
  3698     05  CARRBO PIC  X(0001).
  3699*    -------------------------------
  3700     05  FILLER            PIC  X(0003).
  3701     05  CERTNOBO PIC  X(0010).
  3702*    -------------------------------
  3703     05  FILLER            PIC  X(0003).
  3704     05  SUFXBO PIC  X(0001).
  3705*    -------------------------------
  3706     05  FILLER            PIC  X(0003).
  3707     05  CLMTYPBO PIC  X(0006).
  3708*    -------------------------------
  3709     05  FILLER            PIC  X(0003).
  3710     05  INCURBO PIC  X(0008).
  3711*    -------------------------------
  3712     05  FILLER            PIC  X(0003).
  3713     05  PYFROMBO PIC  99B99B99.
  3714*    -------------------------------
  3715     05  FILLER            PIC  X(0003).
  3716     05  PYTHRUBO PIC  99B99B99.
  3717*    -------------------------------
  3718     05  FILLER            PIC  X(0003).
  3719     05  DAYSBO PIC  X(0005).
  3720*    -------------------------------
  3721     05  FILLER            PIC  X(0003).
  3722     05  BYBO PIC  X(0004).
  3723*    -------------------------------
  3724     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  73
* EL156.cbl
  3725     05  PROOFDBO PIC  99B99B99.
  3726*    -------------------------------
  3727     05  FILLER            PIC  X(0003).
  3728     05  ACCTBO PIC  X(0010).
  3729*    -------------------------------
  3730     05  FILLER            PIC  X(0003).
  3731     05  STATEBO PIC  X(0002).
  3732*    -------------------------------
  3733     05  FILLER            PIC  X(0003).
  3734     05  GROUPBO PIC  X(0006).
  3735*    -------------------------------
  3736     05  FILLER            PIC  X(0003).
  3737     05  ACARRBO PIC  X(0001).
  3738*    -------------------------------
  3739     05  FILLER            PIC  X(0003).
  3740     05  ACCTNMBO PIC  X(0030).
  3741*    -------------------------------
  3742     05  FILLER            PIC  X(0003).
  3743     05  UNDISBO PIC  ZZZ,Z99.99.
  3744*    -------------------------------
  3745     05  FILLER            PIC  X(0003).
  3746     05  RATEBO PIC  ZZZ.99.
  3747*    -------------------------------
  3748     05  FILLER            PIC  X(0003).
  3749     05  ERMSG1BO PIC  X(0072).
  3750*    -------------------------------
  3751     05  FILLER            PIC  X(0003).
  3752     05  ENTPFBO PIC  X(0002).
  3753*    -------------------------------
  3754****************************************************************
  3755*
  3756* Copyright (c) 2007 by Clerity Solutions, Inc.
  3757* All rights reserved.
  3758*
  3759****************************************************************
  3760 01  DFHEIV.
  3761   02  DFHEIV0               PIC X(35).
  3762   02  DFHEIV1               PIC X(08).
  3763   02  DFHEIV2               PIC X(08).
  3764   02  DFHEIV3               PIC X(08).
  3765   02  DFHEIV4               PIC X(06).
  3766   02  DFHEIV5               PIC X(04).
  3767   02  DFHEIV6               PIC X(04).
  3768   02  DFHEIV7               PIC X(02).
  3769   02  DFHEIV8               PIC X(02).
  3770   02  DFHEIV9               PIC X(01).
  3771   02  DFHEIV10              PIC S9(7) COMP-3.
  3772   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3773   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3774   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3775   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3776   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3777   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3778   02  DFHEIV17              PIC X(04).
  3779   02  DFHEIV18              PIC X(04).
  3780   02  DFHEIV19              PIC X(04).
  3781   02  DFHEIV20              USAGE IS POINTER.
  3782   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  74
* EL156.cbl
  3783   02  DFHEIV22              USAGE IS POINTER.
  3784   02  DFHEIV23              USAGE IS POINTER.
  3785   02  DFHEIV24              USAGE IS POINTER.
  3786   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3787   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3788   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3789   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3790   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3791   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3792   02  FILLER                PIC X(02).
  3793   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3794   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3795   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3796   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3797   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3798 LINKAGE  SECTION.
  3799*****************************************************************
  3800*                                                               *
  3801* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3802* All rights reserved.                                          *
  3803*                                                               *
  3804*****************************************************************
  3805 01  dfheiblk.
  3806     02  eibtime          pic s9(7) comp-3.
  3807     02  eibdate          pic s9(7) comp-3.
  3808     02  eibtrnid         pic x(4).
  3809     02  eibtaskn         pic s9(7) comp-3.
  3810     02  eibtrmid         pic x(4).
  3811     02  dfheigdi         pic s9(4) comp.
  3812     02  eibcposn         pic s9(4) comp.
  3813     02  eibcalen         pic s9(4) comp.
  3814     02  eibaid           pic x(1).
  3815     02  eibfiller1       pic x(1).
  3816     02  eibfn            pic x(2).
  3817     02  eibfiller2       pic x(2).
  3818     02  eibrcode         pic x(6).
  3819     02  eibfiller3       pic x(2).
  3820     02  eibds            pic x(8).
  3821     02  eibreqid         pic x(8).
  3822     02  eibrsrce         pic x(8).
  3823     02  eibsync          pic x(1).
  3824     02  eibfree          pic x(1).
  3825     02  eibrecv          pic x(1).
  3826     02  eibsend          pic x(1).
  3827     02  eibatt           pic x(1).
  3828     02  eibeoc           pic x(1).
  3829     02  eibfmh           pic x(1).
  3830     02  eibcompl         pic x(1).
  3831     02  eibsig           pic x(1).
  3832     02  eibconf          pic x(1).
  3833     02  eiberr           pic x(1).
  3834     02  eibrldbk         pic x(1).
  3835     02  eiberrcd         pic x(4).
  3836     02  eibsynrb         pic x(1).
  3837     02  eibnodat         pic x(1).
  3838     02  eibfiller5       pic x(2).
  3839     02  eibresp          pic 9(09) comp.
  3840     02  eibresp2         pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  75
* EL156.cbl
  3841     02  dfheigdj         pic s9(4) comp.
  3842     02  dfheigdk         pic s9(4) comp.
  3843 01  DFHCOMMAREA             PIC X(1024).
  3844
  3845*    COPY ELCMSTR.
  3846******************************************************************
  3847*                                                                *
  3848*                            ELCMSTR.                            *
  3849*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3850*                            VMOD=2.012                          *
  3851*                                                                *
  3852*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3853*                                                                *
  3854*   FILE TYPE = VSAM,KSDS                                        *
  3855*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3856*                                                                *
  3857*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3858*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3859*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3860*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3861*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3862*                                                 RKP=75,LEN=21  *
  3863*                                                                *
  3864*   **** NOTE ****                                               *
  3865*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3866*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3867*                                                                *
  3868*   LOG = YES                                                    *
  3869*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3870******************************************************************
  3871*                   C H A N G E   L O G
  3872*
  3873* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3874*-----------------------------------------------------------------
  3875*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3876* EFFECTIVE    NUMBER
  3877*-----------------------------------------------------------------
  3878* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3879* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3880* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3881* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3882* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3883******************************************************************
  3884 01  CLAIM-MASTER.
  3885     12  CL-RECORD-ID                PIC XX.
  3886         88  VALID-CL-ID         VALUE 'CL'.
  3887
  3888     12  CL-CONTROL-PRIMARY.
  3889         16  CL-COMPANY-CD           PIC X.
  3890         16  CL-CARRIER              PIC X.
  3891         16  CL-CLAIM-NO             PIC X(7).
  3892         16  CL-CERT-NO.
  3893             20  CL-CERT-PRIME       PIC X(10).
  3894             20  CL-CERT-SFX         PIC X.
  3895
  3896     12  CL-CONTROL-BY-NAME.
  3897         16  CL-COMPANY-CD-A1        PIC X.
  3898         16  CL-INSURED-LAST-NAME    PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  76
* EL156.cbl
  3899         16  CL-INSURED-NAME.
  3900             20  CL-INSURED-1ST-NAME PIC X(12).
  3901             20  CL-INSURED-MID-INIT PIC X.
  3902
  3903     12  CL-CONTROL-BY-SSN.
  3904         16  CL-COMPANY-CD-A2        PIC X.
  3905         16  CL-SOC-SEC-NO.
  3906             20  CL-SSN-STATE        PIC XX.
  3907             20  CL-SSN-ACCOUNT      PIC X(6).
  3908             20  CL-SSN-LN3          PIC X(3).
  3909
  3910     12  CL-CONTROL-BY-CERT-NO.
  3911         16  CL-COMPANY-CD-A4        PIC X.
  3912         16  CL-CERT-NO-A4.
  3913             20  CL-CERT-A4-PRIME    PIC X(10).
  3914             20  CL-CERT-A4-SFX      PIC X.
  3915
  3916     12  CL-CONTROL-BY-CCN.
  3917         16  CL-COMPANY-CD-A5        PIC X.
  3918         16  CL-CCN-A5.
  3919             20  CL-CCN.
  3920                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3921                 24  CL-CCN-PRIME-A5 PIC X(12).
  3922             20  CL-CCN-FILLER-A5    PIC X(4).
  3923
  3924     12  CL-INSURED-PROFILE-DATA.
  3925         16  CL-INSURED-BIRTH-DT     PIC XX.
  3926         16  CL-INSURED-SEX-CD       PIC X.
  3927             88  INSURED-IS-MALE        VALUE 'M'.
  3928             88  INSURED-IS-FEMALE      VALUE 'F'.
  3929             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3930         16  CL-INSURED-OCC-CD       PIC X(6).
  3931         16  FILLER                  PIC X(5).
  3932
  3933     12  CL-PROCESSING-INFO.
  3934         16  CL-PROCESSOR-ID         PIC X(4).
  3935         16  CL-CLAIM-STATUS         PIC X.
  3936             88  CLAIM-IS-OPEN          VALUE 'O'.
  3937             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3938         16  CL-CLAIM-TYPE           PIC X.
  3939*            88  AH-CLAIM               VALUE 'A'.
  3940*            88  LIFE-CLAIM             VALUE 'L'.
  3941*            88  PROPERTY-CLAIM         VALUE 'P'.
  3942*            88  IUI-CLAIM              VALUE 'I'.
  3943*            88  GAP-CLAIM              VALUE 'G'.
  3944*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3945         16  CL-CLAIM-PREM-TYPE      PIC X.
  3946             88  SINGLE-PREMIUM         VALUE '1'.
  3947             88  O-B-COVERAGE           VALUE '2'.
  3948             88  OPEN-END-COVERAGE      VALUE '3'.
  3949         16  CL-INCURRED-DT          PIC XX.
  3950         16  CL-REPORTED-DT          PIC XX.
  3951         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3952         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3953         16  CL-LAST-PMT-DT          PIC XX.
  3954         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3955         16  CL-PAID-THRU-DT         PIC XX.
  3956         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  77
* EL156.cbl
  3957         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3958         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3959         16  CL-PMT-CALC-METHOD      PIC X.
  3960             88  CL-360-DAY-YR          VALUE '1'.
  3961             88  CL-365-DAY-YR          VALUE '2'.
  3962             88  CL-FULL-MONTHS         VALUE '3'.
  3963         16  CL-CAUSE-CD             PIC X(6).
  3964
  3965         16  CL-PRIME-CERT-NO.
  3966             20  CL-PRIME-CERT-PRIME PIC X(10).
  3967             20  CL-PRIME-CERT-SFX   PIC X.
  3968
  3969         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3970             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3971             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3972
  3973         16  CL-MICROFILM-NO         PIC X(10).
  3974         16  FILLER REDEFINES CL-MICROFILM-NO.
  3975             20  CL-BENEFIT-PERIOD   PIC 99.
  3976             20  FILLER              PIC X(8).
  3977         16  CL-PROG-FORM-TYPE       PIC X.
  3978         16  CL-LAST-ADD-ON-DT       PIC XX.
  3979
  3980         16  CL-LAST-REOPEN-DT       PIC XX.
  3981         16  CL-LAST-CLOSE-DT        PIC XX.
  3982         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3983             88  FINAL-PAID             VALUE '1'.
  3984             88  CLAIM-DENIED           VALUE '2'.
  3985             88  AUTO-CLOSE             VALUE '3'.
  3986             88  MANUAL-CLOSE           VALUE '4'.
  3987             88  BENEFITS-CHANGED       VALUE 'C'.
  3988             88  SETUP-ERRORS           VALUE 'E'.
  3989         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3990         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3991         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3992             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3993         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3994         16  FILLER                  PIC X.
  3995
  3996     12  CL-CERTIFICATE-DATA.
  3997         16  CL-CERT-ORIGIN          PIC X.
  3998             88  CERT-WAS-ONLINE        VALUE '1'.
  3999             88  CERT-WAS-CREATED       VALUE '2'.
  4000             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4001         16  CL-CERT-KEY-DATA.
  4002             20  CL-CERT-CARRIER     PIC X.
  4003             20  CL-CERT-GROUPING    PIC X(6).
  4004             20  CL-CERT-STATE       PIC XX.
  4005             20  CL-CERT-ACCOUNT.
  4006                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4007                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4008             20  CL-CERT-EFF-DT      PIC XX.
  4009
  4010     12  CL-STATUS-CONTROLS.
  4011         16  CL-PRIORITY-CD          PIC X.
  4012             88  CONFIDENTIAL-DATA      VALUE '8'.
  4013             88  HIGHEST-PRIORITY       VALUE '9'.
  4014         16  CL-SUPV-ATTN-CD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  78
* EL156.cbl
  4015             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4016             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4017         16  CL-PURGED-DT            PIC XX.
  4018         16  CL-RESTORED-DT          PIC XX.
  4019         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4020         16  CL-NEXT-RESEND-DT       PIC XX.
  4021         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4022         16  CL-CRITICAL-PERIOD      PIC 99.
  4023*        16  FILLER                  PIC XX.
  4024         16  CL-LAST-MAINT-DT        PIC XX.
  4025         16  CL-LAST-MAINT-USER      PIC X(4).
  4026         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4027         16  CL-LAST-MAINT-TYPE      PIC X.
  4028             88  CLAIM-SET-UP           VALUE ' '.
  4029             88  PAYMENT-MADE           VALUE '1'.
  4030             88  LETTER-SENT            VALUE '2'.
  4031             88  MASTER-WAS-ALTERED     VALUE '3'.
  4032             88  MASTER-WAS-RESTORED    VALUE '4'.
  4033             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4034             88  FILE-CONVERTED         VALUE '6'.
  4035             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4036             88  ERROR-CORRECTION       VALUE 'E'.
  4037         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4038         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4039         16  CL-BENEFICIARY          PIC X(10).
  4040         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4041         16  CL-DENIAL-TYPE          PIC X.
  4042             88  CL-TYPE-DENIAL          VALUE '1'.
  4043             88  CL-TYPE-RESCISSION      VALUE '2'.
  4044             88  CL-TYPE-REFORMATION     VALUE '3'.
  4045             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4046             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4047         16  filler                  pic x(5).
  4048*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4049*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4050*        16  CL-RTW-DT               PIC XX.
  4051
  4052     12  CL-TRAILER-CONTROLS.
  4053         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4054             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4055             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4056             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4057         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4058         16  FILLER                  PIC XX.
  4059         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4060         16  CL-ADDRESS-TRAILER-CNT.
  4061             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4062                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4063             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4064                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4065             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4066                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4067             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4068                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4069             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4070                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4071             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4072                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  79
* EL156.cbl
  4073             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4074                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4075
  4076     12  CL-CV-REFERENCE-NO.
  4077         16  CL-CV-REFNO-PRIME       PIC X(18).
  4078         16  CL-CV-REFNO-SFX         PIC XX.
  4079
  4080     12  CL-FILE-LOCATION            PIC X(4).
  4081
  4082     12  CL-PROCESS-ERRORS.
  4083         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4084             88  NO-FATAL-ERRORS        VALUE ZERO.
  4085         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4086             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4087
  4088     12  CL-PRODUCT-CD               PIC X.
  4089
  4090     12  CL-CURRENT-KEY-DATA.
  4091         16  CL-CURRENT-CARRIER      PIC X.
  4092         16  CL-CURRENT-GROUPING     PIC X(6).
  4093         16  CL-CURRENT-STATE        PIC XX.
  4094         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4095
  4096     12  CL-ASSOCIATES               PIC X.
  4097         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4098         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4099         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4100         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4101
  4102     12  CL-ACTIVITY-CODE            PIC 99.
  4103     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4104     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4105
  4106     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4107     12  CL-LAG-REPORT-CODE          PIC 9.
  4108     12  CL-LOAN-TYPE                PIC XX.
  4109     12  CL-LEGAL-STATE              PIC XX.
  4110
  4111     12  CL-YESNOSW                  PIC X.
  4112     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4113         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4114         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4115         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4116     12  cl-insured-type             pic x.
  4117         88  cl-claim-on-primary         value 'P'.
  4118         88  cl-claim-on-co-borrower     value 'C'.
  4119     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  80
* EL156.cbl
  4121*    COPY ELCCNTL.
  4122******************************************************************
  4123*                                                                *
  4124*                                                                *
  4125*                            ELCCNTL.                            *
  4126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4127*                            VMOD=2.059                          *
  4128*                                                                *
  4129*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4130*                                                                *
  4131*   FILE TYPE = VSAM,KSDS                                        *
  4132*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4133*                                                                *
  4134*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4135*       ALTERNATE INDEX = NONE                                   *
  4136*                                                                *
  4137*   LOG = YES                                                    *
  4138*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4139******************************************************************
  4140*                   C H A N G E   L O G
  4141*
  4142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4143*-----------------------------------------------------------------
  4144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4145* EFFECTIVE    NUMBER
  4146*-----------------------------------------------------------------
  4147* 082503                   PEMA  ADD BENEFIT GROUP
  4148* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4149* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4150* 092705    2005050300006  PEMA  ADD SPP LEASES
  4151* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4152* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4153* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4154* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4155* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4156* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4157* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4158* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4159* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4160* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4161******************************************************************
  4162*
  4163 01  CONTROL-FILE.
  4164     12  CF-RECORD-ID                       PIC XX.
  4165         88  VALID-CF-ID                        VALUE 'CF'.
  4166
  4167     12  CF-CONTROL-PRIMARY.
  4168         16  CF-COMPANY-ID                  PIC XXX.
  4169         16  CF-RECORD-TYPE                 PIC X.
  4170             88  CF-COMPANY-MASTER              VALUE '1'.
  4171             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4172             88  CF-STATE-MASTER                VALUE '3'.
  4173             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4174             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4175             88  CF-CARRIER-MASTER              VALUE '6'.
  4176             88  CF-MORTALITY-MASTER            VALUE '7'.
  4177             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4178             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  81
* EL156.cbl
  4179             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4180             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4181             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4182             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4183             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4184             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4185             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4186             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4187             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4188         16  CF-ACCESS-CD-GENL              PIC X(4).
  4189         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4190             20  CF-PROCESSOR               PIC X(4).
  4191         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4192             20  CF-STATE-CODE              PIC XX.
  4193             20  FILLER                     PIC XX.
  4194         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4195             20  FILLER                     PIC XX.
  4196             20  CF-HI-BEN-IN-REC           PIC XX.
  4197         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4198             20  FILLER                     PIC XXX.
  4199             20  CF-CARRIER-CNTL            PIC X.
  4200         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4201             20  FILLER                     PIC XX.
  4202             20  CF-HI-TYPE-IN-REC          PIC 99.
  4203         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4204             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4205                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4206             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4207             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4208         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4209             20  FILLER                     PIC X.
  4210             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4211         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4212             20  FILLER                     PIC XX.
  4213             20  CF-MORTGAGE-PLAN           PIC XX.
  4214         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4215
  4216     12  CF-LAST-MAINT-DT                   PIC XX.
  4217     12  CF-LAST-MAINT-BY                   PIC X(4).
  4218     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4219
  4220     12  CF-RECORD-BODY                     PIC X(728).
  4221
  4222
  4223****************************************************************
  4224*             COMPANY MASTER RECORD                            *
  4225****************************************************************
  4226
  4227     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4228         16  CF-COMPANY-ADDRESS.
  4229             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4230             20  CF-CL-IN-CARE-OF           PIC X(30).
  4231             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4232             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4233             20  CF-CL-CITY-STATE           PIC X(30).
  4234             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4235             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4236         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  82
* EL156.cbl
  4237         16  CF-COMPANY-PASSWORD            PIC X(8).
  4238         16  CF-SECURITY-OPTION             PIC X.
  4239             88  ALL-SECURITY                   VALUE '1'.
  4240             88  COMPANY-VERIFY                 VALUE '2'.
  4241             88  PROCESSOR-VERIFY               VALUE '3'.
  4242             88  NO-SECURITY                    VALUE '4'.
  4243             88  ALL-BUT-TERM                   VALUE '5'.
  4244         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4245             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4246         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4247             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4248         16  CF-INFORCE-LOCATION            PIC X.
  4249             88  CERTS-ARE-ONLINE               VALUE '1'.
  4250             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4251             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4252         16  CF-LOWER-CASE-LETTERS          PIC X.
  4253         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4254             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4255             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4256             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4257             88  CF-ACCNT-CNTL                  VALUE '3'.
  4258             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4259
  4260         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4261         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4262
  4263         16  CF-LGX-CREDIT-USER             PIC X.
  4264             88  CO-IS-NOT-USER                 VALUE 'N'.
  4265             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4266
  4267         16 CF-CREDIT-CALC-CODES.
  4268             20  CF-CR-REM-TERM-CALC PIC X.
  4269               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4270               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4271               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4272               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4273               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4274               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4275               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4276             20  CF-CR-R78-METHOD           PIC X.
  4277               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4278               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4279
  4280         16  CF-CLAIM-CONTROL-COUNTS.
  4281             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4282                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4283
  4284             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4285                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4286
  4287             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4288                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4289
  4290             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4291                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4292
  4293         16  CF-CURRENT-MONTH-END           PIC XX.
  4294
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  83
* EL156.cbl
  4295         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4296             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4297             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4298             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4299             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4300                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4301                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4302             20  CF-CO-PREM-REJECT-SW       PIC X.
  4303                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4304                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4305             20  CF-CO-REF-REJECT-SW        PIC X.
  4306                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4307                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4308
  4309         16  CF-CO-REPORTING-DT             PIC XX.
  4310         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4311         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4312           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4313           88  CF-CO-MONTH-END                  VALUE '1'.
  4314
  4315         16  CF-LGX-CLAIM-USER              PIC X.
  4316             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4317             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4318
  4319         16  CF-CREDIT-EDIT-CONTROLS.
  4320             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4321             20  CF-MIN-AGE                 PIC 99.
  4322             20  CF-DEFAULT-AGE             PIC 99.
  4323             20  CF-MIN-TERM                PIC S999      COMP-3.
  4324             20  CF-MAX-TERM                PIC S999      COMP-3.
  4325             20  CF-DEFAULT-SEX             PIC X.
  4326             20  CF-JOINT-AGE-INPUT         PIC X.
  4327                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4328             20  CF-BIRTH-DATE-INPUT        PIC X.
  4329                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4330             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4331                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4332                 88  CF-ZERO-CARRIER            VALUE '1'.
  4333                 88  CF-ZERO-GROUPING           VALUE '2'.
  4334                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4335             20  CF-EDIT-SW                 PIC X.
  4336                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4337             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4338             20  CF-CR-PR-METHOD            PIC X.
  4339               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4340               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4341             20  FILLER                     PIC X.
  4342
  4343         16  CF-CREDIT-MISC-CONTROLS.
  4344             20  CF-REIN-TABLE-SW           PIC X.
  4345                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4346             20  CF-COMP-TABLE-SW           PIC X.
  4347                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4348             20  CF-EXPERIENCE-RETENTION-AGE
  4349                                            PIC S9        COMP-3.
  4350             20  CF-CONVERSION-DT           PIC XX.
  4351             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4352             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  84
* EL156.cbl
  4353                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4354                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4355
  4356             20  CF-CR-CHECK-NO-CONTROL.
  4357                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4358                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4359                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4360                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4361                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4362                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4363
  4364                 24  CF-CR-CHECK-COUNT       REDEFINES
  4365                     CF-CR-CHECK-COUNTER      PIC X(4).
  4366
  4367                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4368                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4369
  4370                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4371                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4372                 24  CF-MAIL-PROCESSING       PIC X.
  4373                     88  MAIL-PROCESSING          VALUE 'Y'.
  4374
  4375         16  CF-MISC-SYSTEM-CONTROL.
  4376             20  CF-SYSTEM-C                 PIC X.
  4377                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4378             20  CF-SYSTEM-D                 PIC X.
  4379                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4380             20  CF-SOC-SEC-NO-SW            PIC X.
  4381                 88  SOC-SEC-NO-USED             VALUE '1'.
  4382             20  CF-MEMBER-NO-SW             PIC X.
  4383                 88  MEMBER-NO-USED              VALUE '1'.
  4384             20  CF-TAX-ID-NUMBER            PIC X(11).
  4385             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4386             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4387                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4388                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4389                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4390                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4391             20  CF-SYSTEM-E                 PIC X.
  4392                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4393
  4394         16  CF-LGX-LIFE-USER               PIC X.
  4395             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4396             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4397
  4398         16  CF-CR-MONTH-END-DT             PIC XX.
  4399
  4400         16  CF-FILE-MAINT-DATES.
  4401             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4402                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4403             20  CF-LAST-BATCH       REDEFINES
  4404                 CF-LAST-BATCH-NO               PIC X(4).
  4405             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4406             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4407             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4408             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4409             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4410             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  85
* EL156.cbl
  4411             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4412             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4413             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4414             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4415
  4416         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4417         16  FILLER                         PIC X.
  4418
  4419         16  CF-ALT-MORT-CODE               PIC X(4).
  4420         16  CF-MEMBER-CAPTION              PIC X(10).
  4421
  4422         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4423             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4424             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4425             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4426             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4427             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4428
  4429         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4430
  4431         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4432         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4433         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4434         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4435
  4436         16  CF-AH-OVERRIDE-L1              PIC X.
  4437         16  CF-AH-OVERRIDE-L2              PIC XX.
  4438         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4439         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4440
  4441         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4442         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4443
  4444         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4445         16  CF-AR-LAST-EL860-DT            PIC XX.
  4446         16  CF-MP-MONTH-END-DT             PIC XX.
  4447
  4448         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4449         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4450             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4451
  4452         16  CF-AR-MONTH-END-DT             PIC XX.
  4453
  4454         16  CF-CRDTCRD-USER                PIC X.
  4455             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4456             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4457
  4458         16  CF-CC-MONTH-END-DT             PIC XX.
  4459
  4460         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4461
  4462         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4463             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4464             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4465             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4466         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4467         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4468         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  86
* EL156.cbl
  4469         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4470             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4471             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4472         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4473         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4474         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4475             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4476         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4477
  4478         16  CF-CL-ZIP-CODE.
  4479             20  CF-CL-ZIP-PRIME.
  4480                 24  CF-CL-ZIP-1ST          PIC X.
  4481                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4482                 24  FILLER                 PIC X(4).
  4483             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4484         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4485             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4486             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4487             20  FILLER                     PIC XXX.
  4488
  4489         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4490         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4491         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4492         16  CF-CO-OPTION-START-DATE        PIC XX.
  4493         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4494           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4495                                                      '3' '4'.
  4496           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4497           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4498           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4499           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4500           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4501           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4502
  4503         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4504
  4505         16  CF-PAYMENT-APPROVAL-LEVELS.
  4506             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4507             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4508             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4509             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4510             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4511             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4512
  4513         16  CF-END-USER-REPORTING-USER     PIC X.
  4514             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4515             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4516
  4517         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4518             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4519             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4520
  4521         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4522
  4523         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4524         16  FILLER                         PIC X.
  4525
  4526         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  87
* EL156.cbl
  4527             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4528             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4529             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4530
  4531         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4532
  4533         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4534             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4535             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4536
  4537         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4538             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4539             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4540
  4541         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4542
  4543         16  CF-CO-ACH-ID-CODE              PIC  X.
  4544             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4545             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4546             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4547         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4548         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4549         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4550         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4551         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4552         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4553         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4554         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4555         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4556                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4557         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4558                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4559
  4560         16  CF-CO-OVER-SHORT.
  4561             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4562             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4563
  4564*         16  FILLER                         PIC X(102).
  4565         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4566             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4567             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4568
  4569         16  CF-AH-APPROVAL-DAYS.
  4570             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4571             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4572             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4573             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4574
  4575         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4576
  4577         16  CF-APPROV-LEV-5.
  4578             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4579             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4580             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4581
  4582         16  FILLER                         PIC X(68).
  4583****************************************************************
  4584*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  88
* EL156.cbl
  4585****************************************************************
  4586
  4587     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4588         16  CF-PROCESSOR-NAME              PIC X(30).
  4589         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4590         16  CF-PROCESSOR-TITLE             PIC X(26).
  4591         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4592                 88  MESSAGE-YES                VALUE 'Y'.
  4593                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4594
  4595*****************************************************
  4596****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4597****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4598****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4599****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4600*****************************************************
  4601
  4602         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4603             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4604             20  CF-APPLICATION-FORCE       PIC X.
  4605             20  CF-INDIVIDUAL-APP.
  4606                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4607                     28  CF-BROWSE-APP      PIC X.
  4608                     28  CF-UPDATE-APP      PIC X.
  4609
  4610         16  CF-CURRENT-TERM-ON             PIC X(4).
  4611         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4612             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4613             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4614             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4615             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4616             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4617             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4618             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4619         16  CF-PROCESSOR-CARRIER           PIC X.
  4620             88  NO-CARRIER-SECURITY            VALUE ' '.
  4621         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4622             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4623         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4624             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4625         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4626             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4627
  4628         16  CF-PROC-SYS-ACCESS-SW.
  4629             20  CF-PROC-CREDIT-CLAIMS-SW.
  4630                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4631                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4632                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4633                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4634             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4635                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4636                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4637             20  CF-PROC-LIFE-GNRLDGR-SW.
  4638                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4639                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4640                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4641                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4642             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  89
* EL156.cbl
  4643                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4644                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4645         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4646             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4647             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4648         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4649
  4650         16  CF-APPROVAL-LEVEL                  PIC X.
  4651             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4652             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4653             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4654             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4655             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4656
  4657         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4658
  4659         16  CF-LANGUAGE-TYPE                   PIC X.
  4660             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4661             88  CF-LANG-IS-FR                      VALUE 'F'.
  4662
  4663         16  CF-CSR-IND                         PIC X.
  4664         16  FILLER                             PIC X(239).
  4665
  4666****************************************************************
  4667*             PROCESSOR/REMINDERS RECORD                       *
  4668****************************************************************
  4669
  4670     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4671         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4672             20  CF-START-REMIND-DT         PIC XX.
  4673             20  CF-END-REMIND-DT           PIC XX.
  4674             20  CF-REMINDER-TEXT           PIC X(50).
  4675         16  FILLER                         PIC X(296).
  4676
  4677
  4678****************************************************************
  4679*             STATE MASTER RECORD                              *
  4680****************************************************************
  4681
  4682     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4683         16  CF-STATE-ABBREVIATION          PIC XX.
  4684         16  CF-STATE-NAME                  PIC X(25).
  4685         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4686         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4687             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4688             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4689             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4690             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4691                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4692                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4693             20  CF-ST-PREM-REJECT-SW       PIC X.
  4694                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4695                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4696             20  CF-ST-REF-REJECT-SW        PIC X.
  4697                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4698                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4699         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4700         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  90
* EL156.cbl
  4701         16  CF-ST-REFUND-RULES.
  4702             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4703             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4704             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4705         16  CF-ST-FST-PMT-EXTENSION.
  4706             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4707             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4708                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4709                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4710                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4711                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4712         16  CF-ST-STATE-CALL.
  4713             20  CF-ST-CALL-UNEARNED        PIC X.
  4714             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4715             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4716         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4717             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4718             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4719         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4720         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4721         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4722         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4723         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4724         16  FILLER                         PIC X.
  4725         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4726             20  CF-ST-BENEFIT-CD           PIC XX.
  4727             20  CF-ST-BENEFIT-KIND         PIC X.
  4728                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4729                 88  CF-ST-AH-KIND              VALUE 'A'.
  4730             20  CF-ST-REM-TERM-CALC        PIC X.
  4731                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4732                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4733                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4734                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4735                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4736                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4737                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4738                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4739
  4740             20  CF-ST-REFUND-CALC          PIC X.
  4741                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4742                 88  ST-REFD-BY-R78             VALUE '1'.
  4743                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4744                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4745                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4746                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4747                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4748                 88  ST-REFD-UTAH               VALUE '7'.
  4749                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4750                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4751                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4752
  4753             20  CF-ST-EARNING-CALC         PIC X.
  4754                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4755                 88  ST-EARN-BY-R78             VALUE '1'.
  4756                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4757                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4758                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  91
* EL156.cbl
  4759                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4760                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4761                 88  ST-EARN-MEAN               VALUE '8'.
  4762                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4763
  4764             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4765                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4766                 88  ST-OVRD-BY-R78             VALUE '1'.
  4767                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4768                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4769                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4770                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4771                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4772                 88  ST-OVRD-MEAN               VALUE '8'.
  4773                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4774             20  cf-st-extra-periods        pic 9.
  4775*            20  FILLER                     PIC X.
  4776
  4777         16  CF-ST-COMMISSION-CAPS.
  4778             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4779             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4780             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4781             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4782         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4783                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4784
  4785         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4786
  4787         16  CF-ST-STATUTORY-INTEREST.
  4788             20  CF-ST-STAT-DATE-FROM       PIC X.
  4789                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4790                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4791             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4792             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4793             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4794             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4795             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4796
  4797         16  CF-ST-OVER-SHORT.
  4798             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4799             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4800
  4801         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4802
  4803         16  CF-ST-RT-CALC                  PIC X.
  4804
  4805         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4806         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4807         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4808         16  CF-ST-RF-LR-CALC               PIC X.
  4809         16  CF-ST-RF-LL-CALC               PIC X.
  4810         16  CF-ST-RF-LN-CALC               PIC X.
  4811         16  CF-ST-RF-AH-CALC               PIC X.
  4812         16  CF-ST-RF-CP-CALC               PIC X.
  4813*        16  FILLER                         PIC X(206).
  4814*CIDMOD         16  FILLER                         PIC X(192).
  4815         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4816             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  92
* EL156.cbl
  4817         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4818         16  CF-ST-VFY-2ND-BENE             PIC X.
  4819         16  CF-ST-CAUSAL-STATE             PIC X.
  4820         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4821         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4822         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4823             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4824         16  CF-ST-NET-ONLY-STATE           PIC X.
  4825             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4826         16  FILLER                         PIC X(181).
  4827
  4828****************************************************************
  4829*             BENEFIT MASTER RECORD                            *
  4830****************************************************************
  4831
  4832     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4833         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4834             20  CF-BENEFIT-CODE            PIC XX.
  4835             20  CF-BENEFIT-NUMERIC  REDEFINES
  4836                 CF-BENEFIT-CODE            PIC XX.
  4837             20  CF-BENEFIT-ALPHA           PIC XXX.
  4838             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4839             20  CF-BENEFIT-COMMENT         PIC X(10).
  4840
  4841             20  CF-LF-COVERAGE-TYPE        PIC X.
  4842                 88  CF-REDUCING                VALUE 'R'.
  4843                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4844
  4845             20  CF-SPECIAL-CALC-CD         PIC X.
  4846                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4847                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4848                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4849                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4850                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4851                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4852                 88  CF-FARM-PLAN               VALUE 'F'.
  4853                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4854                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4855                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4856                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4857                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4858                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4859                 88  CF-PRUDENTIAL              VALUE 'P'.
  4860                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4861                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4862                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4863                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4864                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4865                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4866
  4867             20  CF-JOINT-INDICATOR         PIC X.
  4868                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4869
  4870*            20  FILLER                     PIC X(12).
  4871             20  cf-maximum-benefits        pic s999 comp-3.
  4872             20  FILLER                     PIC X(09).
  4873             20  CF-BENEFIT-CATEGORY        PIC X.
  4874             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  93
* EL156.cbl
  4875
  4876             20  CF-CO-REM-TERM-CALC        PIC X.
  4877                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4878                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4879                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4880                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4881                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4882
  4883             20  CF-CO-EARNINGS-CALC        PIC X.
  4884                 88  CO-EARN-BY-R78             VALUE '1'.
  4885                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4886                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4887                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4888                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4889                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4890                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4891                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4892
  4893             20  CF-CO-REFUND-CALC          PIC X.
  4894                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4895                 88  CO-REFD-BY-R78             VALUE '1'.
  4896                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4897                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4898                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4899                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4900                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4901                 88  CO-REFD-MEAN               VALUE '8'.
  4902                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4903                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4904                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4905
  4906             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4907                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4908                 88  CO-OVRD-BY-R78             VALUE '1'.
  4909                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4910                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4911                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4912                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4913                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4914                 88  CO-OVRD-MEAN               VALUE '8'.
  4915                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4916
  4917             20  CF-CO-BEN-I-G-CD           PIC X.
  4918                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4919                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4920                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4921
  4922         16  FILLER                         PIC X(304).
  4923
  4924
  4925****************************************************************
  4926*             CARRIER MASTER RECORD                            *
  4927****************************************************************
  4928
  4929     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4930         16  CF-ADDRESS-DATA.
  4931             20  CF-MAIL-TO-NAME            PIC X(30).
  4932             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  94
* EL156.cbl
  4933             20  CF-ADDRESS-LINE-1          PIC X(30).
  4934             20  CF-ADDRESS-LINE-2          PIC X(30).
  4935             20  CF-CITY-STATE              PIC X(30).
  4936             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4937             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4938
  4939         16  CF-CLAIM-NO-CONTROL.
  4940             20  CF-CLAIM-NO-METHOD         PIC X.
  4941                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4942                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4943                 88  CLAIM-NO-SEQ               VALUE '3'.
  4944                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4945             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4946                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4947                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4948                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4949
  4950         16  CF-CHECK-NO-CONTROL.
  4951             20  CF-CHECK-NO-METHOD         PIC X.
  4952                 88  CHECK-NO-MANUAL            VALUE '1'.
  4953                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4954                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4955                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4956             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4957                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4958
  4959         16  CF-DOMICILE-STATE              PIC XX.
  4960
  4961         16  CF-EXPENSE-CONTROLS.
  4962             20  CF-EXPENSE-METHOD          PIC X.
  4963                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4964                 88  DOLLARS-PER-PMT            VALUE '2'.
  4965                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4966                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4967             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4968             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4969
  4970         16  CF-CORRESPONDENCE-CONTROL.
  4971             20  CF-LETTER-RESEND-OPT       PIC X.
  4972                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4973                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4974             20  FILLER                     PIC X(4).
  4975
  4976         16  CF-RESERVE-CONTROLS.
  4977             20  CF-MANUAL-SW               PIC X.
  4978                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4979             20  CF-FUTURE-SW               PIC X.
  4980                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4981             20  CF-PTC-SW                  PIC X.
  4982                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4983             20  CF-IBNR-SW                 PIC X.
  4984                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4985             20  CF-PTC-LF-SW               PIC X.
  4986                 88  CF-LF-PTC-USED             VALUE '1'.
  4987             20  CF-CDT-ACCESS-METHOD       PIC X.
  4988                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4989                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4990                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  95
* EL156.cbl
  4991             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4992
  4993         16  CF-CLAIM-CALC-METHOD           PIC X.
  4994             88  360-PLUS-MONTHS                VALUE '1'.
  4995             88  365-PLUS-MONTHS                VALUE '2'.
  4996             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4997             88  360-DAILY                      VALUE '4'.
  4998             88  365-DAILY                      VALUE '5'.
  4999
  5000         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5001         16  FILLER                         PIC X(11).
  5002
  5003         16  CF-LIMIT-AMOUNTS.
  5004             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5005             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5006             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5007             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5008             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5009             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5010             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5011             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5012             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5013             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5014
  5015         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5016         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5017         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5018
  5019         16  CF-ZIP-CODE.
  5020             20  CF-ZIP-PRIME.
  5021                 24  CF-ZIP-1ST             PIC X.
  5022                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5023                 24  FILLER                 PIC X(4).
  5024             20  CF-ZIP-PLUS4               PIC X(4).
  5025         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5026             20  CF-CAN-POSTAL-1            PIC XXX.
  5027             20  CF-CAN-POSTAL-2            PIC XXX.
  5028             20  FILLER                     PIC XXX.
  5029
  5030         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5031         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5032         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5033
  5034         16  CF-RATING-SWITCH               PIC X.
  5035             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5036             88  CF-NO-RATING                   VALUE 'N'.
  5037
  5038         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5039
  5040         16  CF-CARRIER-OVER-SHORT.
  5041             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5042             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5043
  5044         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5045         16  CF-SECPAY-SWITCH               PIC X.
  5046             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5047             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5048         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  96
* EL156.cbl
  5049         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5050         16  FILLER                         PIC X(444).
  5051*        16  FILLER                         PIC X(452).
  5052
  5053
  5054****************************************************************
  5055*             MORTALITY MASTER RECORD                          *
  5056****************************************************************
  5057
  5058     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5059         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5060                                INDEXED BY CF-MORT-NDX.
  5061             20  CF-MORT-TABLE              PIC X(5).
  5062             20  CF-MORT-TABLE-TYPE         PIC X.
  5063                 88  CF-MORT-JOINT              VALUE 'J'.
  5064                 88  CF-MORT-SINGLE             VALUE 'S'.
  5065                 88  CF-MORT-COMBINED           VALUE 'C'.
  5066                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5067                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5068             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5069             20  CF-MORT-AGE-METHOD         PIC XX.
  5070                 88  CF-AGE-LAST                VALUE 'AL'.
  5071                 88  CF-AGE-NEAR                VALUE 'AN'.
  5072             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5073             20  CF-MORT-ADJUSTMENT-DIRECTION
  5074                                            PIC X.
  5075                 88  CF-MINUS                   VALUE '-'.
  5076                 88  CF-PLUS                    VALUE '+'.
  5077             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5078             20  CF-MORT-JOINT-CODE         PIC X.
  5079                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5080             20  CF-MORT-PC-Q               PIC X.
  5081                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5082             20  CF-MORT-TABLE-CODE         PIC X(4).
  5083             20  CF-MORT-COMMENTS           PIC X(15).
  5084             20  FILLER                     PIC X(14).
  5085
  5086         16  FILLER                         PIC X(251).
  5087
  5088
  5089****************************************************************
  5090*             BUSSINESS TYPE MASTER RECORD                     *
  5091****************************************************************
  5092
  5093     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5094* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5095* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5096* AND RECORD 05 IS TYPES 81-99
  5097         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5098             20  CF-BUSINESS-TITLE          PIC  X(19).
  5099             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5100                                            PIC S9V9(4) COMP-3.
  5101             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5102             20  FILLER                     PIC  X.
  5103         16  FILLER                         PIC  X(248).
  5104
  5105
  5106****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  97
* EL156.cbl
  5107*             TERMINAL MASTER RECORD                           *
  5108****************************************************************
  5109
  5110     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5111
  5112         16  CF-COMPANY-TERMINALS.
  5113             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5114                                  PIC X(4).
  5115         16  FILLER               PIC X(248).
  5116
  5117
  5118****************************************************************
  5119*             LIFE EDIT MASTER RECORD                          *
  5120****************************************************************
  5121
  5122     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5123         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5124             20  CF-LIFE-CODE-IN            PIC XX.
  5125             20  CF-LIFE-CODE-OUT           PIC XX.
  5126         16  FILLER                         PIC X(248).
  5127
  5128
  5129****************************************************************
  5130*             AH EDIT MASTER RECORD                            *
  5131****************************************************************
  5132
  5133     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5134         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5135             20  CF-AH-CODE-IN              PIC XXX.
  5136             20  CF-AH-CODE-OUT             PIC XX.
  5137         16  FILLER                         PIC X(248).
  5138
  5139
  5140****************************************************************
  5141*             CREDIBILITY TABLES                               *
  5142****************************************************************
  5143
  5144     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5145         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5146                             INDEXED BY CF-CRDB-NDX.
  5147             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5148             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5149             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5150         16  FILLER                         PIC  X(332).
  5151
  5152
  5153****************************************************************
  5154*             REPORT CUSTOMIZATION RECORD                      *
  5155****************************************************************
  5156
  5157     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5158         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5159             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5160             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5161             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5162**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5163****       A T-TRANSFER.                                   ****
  5164             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  98
* EL156.cbl
  5165
  5166         16  FILLER                         PIC XX.
  5167
  5168         16  CF-CARRIER-CNTL-OPT.
  5169             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5170                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5171                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5172             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5173                                            PIC X.
  5174         16  CF-GROUP-CNTL-OPT.
  5175             20  CF-GROUP-OPT-SEQ           PIC 9.
  5176                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5177                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5178             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5179                                            PIC X(6).
  5180         16  CF-STATE-CNTL-OPT.
  5181             20  CF-STATE-OPT-SEQ           PIC 9.
  5182                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5183                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5184             20  CF-STATE-SELECT OCCURS 3 TIMES
  5185                                            PIC XX.
  5186         16  CF-ACCOUNT-CNTL-OPT.
  5187             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5188                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5189                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5190             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5191                                            PIC X(10).
  5192         16  CF-BUS-TYP-CNTL-OPT.
  5193             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5194                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5195                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5196             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5197                                            PIC XX.
  5198         16  CF-LF-TYP-CNTL-OPT.
  5199             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5200                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5201                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5202             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5203                                            PIC XX.
  5204         16  CF-AH-TYP-CNTL-OPT.
  5205             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5206                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5207                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5208             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5209                                            PIC XX.
  5210         16  CF-REPTCD1-CNTL-OPT.
  5211             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5212                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5213                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5214             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5215                                            PIC X(10).
  5216         16  CF-REPTCD2-CNTL-OPT.
  5217             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5218                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5219                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5220             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5221                                            PIC X(10).
  5222         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page  99
* EL156.cbl
  5223             20  CF-USER1-OPT-SEQ           PIC 9.
  5224                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5225                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5226             20  CF-USER1-SELECT OCCURS 3 TIMES
  5227                                            PIC X(10).
  5228         16  CF-USER2-CNTL-OPT.
  5229             20  CF-USER2-OPT-SEQ           PIC 9.
  5230                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5231                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5232             20  CF-USER2-SELECT OCCURS 3 TIMES
  5233                                            PIC X(10).
  5234         16  CF-USER3-CNTL-OPT.
  5235             20  CF-USER3-OPT-SEQ           PIC 9.
  5236                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5237                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5238             20  CF-USER3-SELECT OCCURS 3 TIMES
  5239                                            PIC X(10).
  5240         16  CF-USER4-CNTL-OPT.
  5241             20  CF-USER4-OPT-SEQ           PIC 9.
  5242                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5243                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5244             20  CF-USER4-SELECT OCCURS 3 TIMES
  5245                                            PIC X(10).
  5246         16  CF-USER5-CNTL-OPT.
  5247             20  CF-USER5-OPT-SEQ           PIC 9.
  5248                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5249                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5250             20  CF-USER5-SELECT OCCURS 3 TIMES
  5251                                            PIC X(10).
  5252         16  CF-REINS-CNTL-OPT.
  5253             20  CF-REINS-OPT-SEQ           PIC 9.
  5254                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5255                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5256             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5257                 24  CF-REINS-PRIME         PIC XXX.
  5258                 24  CF-REINS-SUB           PIC XXX.
  5259
  5260         16  CF-AGENT-CNTL-OPT.
  5261             20  CF-AGENT-OPT-SEQ           PIC 9.
  5262                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5263                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5264             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5265                                            PIC X(10).
  5266
  5267         16  FILLER                         PIC X(43).
  5268
  5269         16  CF-LOSS-RATIO-SELECT.
  5270             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5271             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5272         16  CF-ENTRY-DATE-SELECT.
  5273             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5274             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5275         16  CF-EFFECTIVE-DATE-SELECT.
  5276             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5277             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5278
  5279         16  CF-EXCEPTION-LIST-IND          PIC X.
  5280             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 100
* EL156.cbl
  5281
  5282         16  FILLER                         PIC X(318).
  5283
  5284****************************************************************
  5285*                  EXCEPTION REPORTING RECORD                  *
  5286****************************************************************
  5287
  5288     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5289         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5290             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5291
  5292         16  CF-COMBINED-LIFE-AH-OPT.
  5293             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5294             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5295             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5296             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5297
  5298         16  CF-LIFE-OPT.
  5299             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5300             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5301             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5302             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5303             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5304             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5305             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5306             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5307             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5308             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5309
  5310         16  CF-AH-OPT.
  5311             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5312             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5313             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5314             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5315             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5316             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5317             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5318             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5319             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5320             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5321
  5322         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5323             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5324             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5325             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5326
  5327         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5328
  5329         16  FILLER                         PIC X(673).
  5330
  5331
  5332****************************************************************
  5333*             MORTGAGE SYSTEM PLAN RECORD                      *
  5334****************************************************************
  5335
  5336     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5337         16  CF-PLAN-TYPE                   PIC X.
  5338             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 101
* EL156.cbl
  5339             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5340             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5341         16  CF-PLAN-ABBREV                 PIC XXX.
  5342         16  CF-PLAN-DESCRIPT               PIC X(10).
  5343         16  CF-PLAN-NOTES                  PIC X(20).
  5344         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5345         16  CF-PLAN-UNDERWRITING.
  5346             20  CF-PLAN-TERM-DATA.
  5347                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5348                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5349             20  CF-PLAN-AGE-DATA.
  5350                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5351                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5352                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5353             20  CF-PLAN-BENEFIT-DATA.
  5354                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5355                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5356                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5357                                            PIC S9(7)V99  COMP-3.
  5358         16  CF-PLAN-POLICY-FORMS.
  5359             20  CF-POLICY-FORM             PIC X(12).
  5360             20  CF-MASTER-APPLICATION      PIC X(12).
  5361             20  CF-MASTER-POLICY           PIC X(12).
  5362         16  CF-PLAN-RATING.
  5363             20  CF-RATE-CODE               PIC X(5).
  5364             20  CF-SEX-RATING              PIC X.
  5365                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5366                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5367             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5368             20  CF-SUB-STD-TYPE            PIC X.
  5369                 88  CF-PCT-OF-PREM            VALUE '1'.
  5370                 88  CF-PCT-OF-BENE            VALUE '2'.
  5371         16  CF-PLAN-PREM-TOLERANCES.
  5372             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5373             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5374         16  CF-PLAN-PYMT-TOLERANCES.
  5375             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5376             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5377         16  CF-PLAN-MISC-DATA.
  5378             20  FILLER                     PIC X.
  5379             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5380             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5381         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5382         16  CF-PLAN-IND-GRP                PIC X.
  5383             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5384                                                     '1'.
  5385             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5386                                                     '2'.
  5387         16  CF-MIB-SEARCH-SW               PIC X.
  5388             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5389             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5390             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5391             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5392         16  CF-ALPHA-SEARCH-SW             PIC X.
  5393             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5394             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5395             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5396             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 102
* EL156.cbl
  5397             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5398             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5399             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5400             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5401             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5402             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5403                                                     'A' 'B' 'C'
  5404                                                     'X' 'Y' 'Z'.
  5405         16  CF-EFF-DT-RULE-SW              PIC X.
  5406             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5407             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5408             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5409             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5410             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5411         16  FILLER                         PIC X(4).
  5412         16  CF-HEALTH-QUESTIONS            PIC X.
  5413             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5414         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5415         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5416         16  CF-PLAN-SNGL-JNT               PIC X.
  5417             88  CF-COMBINED-PLAN              VALUE 'C'.
  5418             88  CF-JNT-PLAN                   VALUE 'J'.
  5419             88  CF-SNGL-PLAN                  VALUE 'S'.
  5420         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5421         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5422         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5423         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5424         16  CF-RERATE-CNTL                 PIC  X.
  5425             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5426             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5427             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5428             88  CF-AUTO-RECALC                 VALUE '4'.
  5429         16  CF-BENEFIT-TYPE                PIC  X.
  5430             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5431             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5432         16  CF-POLICY-FEE                  PIC S999V99
  5433                                                    COMP-3.
  5434         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5435         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5436         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5437         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5438         16  FILLER                         PIC  X(32).
  5439         16  CF-TERMINATION-FORM            PIC  X(04).
  5440         16  FILLER                         PIC  X(08).
  5441         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5442                                                       COMP-3.
  5443         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5444         16  CF-ISSUE-LETTER                PIC  X(4).
  5445         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5446         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5447             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5448             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5449         16  CF-MP-REFUND-CALC              PIC X.
  5450             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5451             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5452             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5453             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5454             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 103
* EL156.cbl
  5455             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5456             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5457             88  CF-MP-REFD-MEAN                VALUE '8'.
  5458         16  CF-ALT-RATE-CODE               PIC  X(5).
  5459
  5460
  5461         16  FILLER                         PIC X(498).
  5462****************************************************************
  5463*             MORTGAGE COMPANY MASTER RECORD                   *
  5464****************************************************************
  5465
  5466     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5467         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5468         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5469             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5470             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5471             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5472             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5473             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5474
  5475         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5476         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5477         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5478         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5479         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5480
  5481         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5482             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5483         16  CF-MP-RECON-USE-IND            PIC X(1).
  5484             88  CF-MP-USE-RECON             VALUE 'Y'.
  5485         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5486             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5487         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5488             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5489             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5490         16  FILLER                         PIC X(1).
  5491         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5492             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5493         16  CF-MORTG-MIB-VERSION           PIC X.
  5494             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5495             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5496             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5497         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5498             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5499                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5500             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5501                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5502             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5503                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5504             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5505                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5506             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5507                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5508             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5509                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5510         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5511         16  FILLER                         PIC X(7).
  5512         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 104
* EL156.cbl
  5513             20  CF-MORTG-MIB-COMM          PIC X(5).
  5514             20  CF-MORTG-MIB-TERM          PIC X(5).
  5515         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5516             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5517         16  FILLER                         PIC X(03).
  5518         16  CF-MP-CHECK-NO-CONTROL.
  5519             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5520                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5521                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5522                                                ' ' LOW-VALUES.
  5523                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5524                                               VALUE '3'.
  5525         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5526         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5527         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5528             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5529                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5530             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5531                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5532             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5533                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5534             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5535                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5536             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5537                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5538             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5539                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5540         16  CF-MORTG-BILLING-AREA.
  5541             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5542                                            PIC X.
  5543         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5544         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5545         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5546         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5547             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5548             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5549         16  FILLER                         PIC X.
  5550         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5551             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5552             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5553         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5554         16  FILLER                         PIC X(8).
  5555         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5556         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5557         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5558         16  CF-ACH-COMPANY-ID.
  5559             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5560                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5561                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5562                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5563             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5564         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5565             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5566         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5567             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5568             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5569         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5570         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 105
* EL156.cbl
  5571         16  FILLER                         PIC X(536).
  5572
  5573****************************************************************
  5574*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5575****************************************************************
  5576
  5577     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5578         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5579             20  CF-FEMALE-HEIGHT.
  5580                 24  CF-FEMALE-FT           PIC 99.
  5581                 24  CF-FEMALE-IN           PIC 99.
  5582             20  CF-FEMALE-MIN-WT           PIC 999.
  5583             20  CF-FEMALE-MAX-WT           PIC 999.
  5584         16  FILLER                         PIC X(428).
  5585
  5586     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5587         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5588             20  CF-MALE-HEIGHT.
  5589                 24  CF-MALE-FT             PIC 99.
  5590                 24  CF-MALE-IN             PIC 99.
  5591             20  CF-MALE-MIN-WT             PIC 999.
  5592             20  CF-MALE-MAX-WT             PIC 999.
  5593         16  FILLER                         PIC X(428).
  5594******************************************************************
  5595*             AUTOMATIC ACTIVITY RECORD                          *
  5596******************************************************************
  5597     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5598         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5599             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5600             20  CF-SYS-LETTER-ID           PIC X(04).
  5601             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5602             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5603             20  CF-SYS-RESET-SW            PIC X(01).
  5604             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5605             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5606
  5607         16  FILLER                         PIC X(50).
  5608
  5609         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5610             20  CF-USER-ACTIVE-SW          PIC X(01).
  5611             20  CF-USER-LETTER-ID          PIC X(04).
  5612             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5613             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5614             20  CF-USER-RESET-SW           PIC X(01).
  5615             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5616             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5617             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5618
  5619         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 106
* EL156.cbl
  5621*    COPY ELCCERT.
  5622******************************************************************
  5623*                                                                *
  5624*                            ELCCERT.                            *
  5625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5626*                            VMOD=2.013                          *
  5627*                                                                *
  5628*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5629*                                                                *
  5630*   FILE TYPE = VSAM,KSDS                                        *
  5631*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5632*                                                                *
  5633*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5634*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5635*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5636*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5637*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5638*                                                                *
  5639*   LOG = YES                                                    *
  5640*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5641******************************************************************
  5642*                   C H A N G E   L O G
  5643*
  5644* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5645*-----------------------------------------------------------------
  5646*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5647* EFFECTIVE    NUMBER
  5648*-----------------------------------------------------------------
  5649* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5650* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5651* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5652* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5653* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5654* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5655* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5656* 032612  CR2011110200001  PEMA  AHL CHANGES
  5657* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5658* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5659******************************************************************
  5660
  5661 01  CERTIFICATE-MASTER.
  5662     12  CM-RECORD-ID                      PIC XX.
  5663         88  VALID-CM-ID                      VALUE 'CM'.
  5664
  5665     12  CM-CONTROL-PRIMARY.
  5666         16  CM-COMPANY-CD                 PIC X.
  5667         16  CM-CARRIER                    PIC X.
  5668         16  CM-GROUPING.
  5669             20  CM-GROUPING-PREFIX        PIC X(3).
  5670             20  CM-GROUPING-PRIME         PIC X(3).
  5671         16  CM-STATE                      PIC XX.
  5672         16  CM-ACCOUNT.
  5673             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5674             20  CM-ACCOUNT-PRIME          PIC X(6).
  5675         16  CM-CERT-EFF-DT                PIC XX.
  5676         16  CM-CERT-NO.
  5677             20  CM-CERT-PRIME             PIC X(10).
  5678             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 107
* EL156.cbl
  5679
  5680     12  CM-CONTROL-BY-NAME.
  5681         16  CM-COMPANY-CD-A1              PIC X.
  5682         16  CM-INSURED-LAST-NAME          PIC X(15).
  5683         16  CM-INSURED-INITIALS.
  5684             20  CM-INSURED-INITIAL1       PIC X.
  5685             20  CM-INSURED-INITIAL2       PIC X.
  5686
  5687     12  CM-CONTROL-BY-SSN.
  5688         16  CM-COMPANY-CD-A2              PIC X.
  5689         16  CM-SOC-SEC-NO.
  5690             20  CM-SSN-STATE              PIC XX.
  5691             20  CM-SSN-ACCOUNT            PIC X(6).
  5692             20  CM-SSN-LN3.
  5693                 25  CM-INSURED-INITIALS-A2.
  5694                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5695                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5696                 25 CM-PART-LAST-NAME-A2         PIC X.
  5697
  5698     12  CM-CONTROL-BY-CERT-NO.
  5699         16  CM-COMPANY-CD-A4              PIC X.
  5700         16  CM-CERT-NO-A4                 PIC X(11).
  5701
  5702     12  CM-CONTROL-BY-MEMB.
  5703         16  CM-COMPANY-CD-A5              PIC X.
  5704         16  CM-MEMBER-NO.
  5705             20  CM-MEMB-STATE             PIC XX.
  5706             20  CM-MEMB-ACCOUNT           PIC X(6).
  5707             20  CM-MEMB-LN4.
  5708                 25  CM-INSURED-INITIALS-A5.
  5709                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5710                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5711                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5712
  5713     12  CM-INSURED-PROFILE-DATA.
  5714         16  CM-INSURED-FIRST-NAME.
  5715             20  CM-INSURED-1ST-INIT       PIC X.
  5716             20  FILLER                    PIC X(9).
  5717         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5718         16  CM-INSURED-SEX                PIC X.
  5719             88  CM-SEX-MALE                  VALUE 'M'.
  5720             88  CM-SEX-FEMAL                 VALUE 'F'.
  5721         16  CM-INSURED-JOINT-AGE          PIC 99.
  5722         16  CM-JOINT-INSURED-NAME.
  5723             20  CM-JT-LAST-NAME           PIC X(15).
  5724             20  CM-JT-FIRST-NAME.
  5725                 24  CM-JT-1ST-INIT        PIC X.
  5726                 24  FILLER                PIC X(9).
  5727             20  CM-JT-INITIAL             PIC X.
  5728
  5729     12  CM-LIFE-DATA.
  5730         16  CM-LF-BENEFIT-CD              PIC XX.
  5731         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5732         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5733         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5734         16  CM-LF-DEV-CODE                PIC XXX.
  5735         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5736         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 108
* EL156.cbl
  5737         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5738         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5739         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5740         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5741         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5742         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5743         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5744         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5745         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5746         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5747         16  cm-temp-epiq                  pic xx.
  5748             88  EPIQ-CLASS                  value 'EQ'.
  5749*        16  FILLER                        PIC XX.
  5750
  5751     12  CM-AH-DATA.
  5752         16  CM-AH-BENEFIT-CD              PIC XX.
  5753         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5754         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5755         16  CM-AH-DEV-CODE                PIC XXX.
  5756         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5757         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5758         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5759         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5760         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5761         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5762         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5763         16  CM-AH-PAID-THRU-DT            PIC XX.
  5764             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5765         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5766         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5767         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5768         16  FILLER                        PIC X.
  5769
  5770     12  CM-LOAN-INFORMATION.
  5771         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5772         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5773                                           PIC S9(5)V99  COMP-3.
  5774         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5775         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5776         16  CM-PAY-FREQUENCY              PIC S99.
  5777         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5778         16  CM-RATE-CLASS                 PIC XX.
  5779         16  CM-BENEFICIARY                PIC X(25).
  5780         16  CM-POLICY-FORM-NO             PIC X(12).
  5781         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5782         16  CM-LAST-ADD-ON-DT             PIC XX.
  5783         16  CM-DEDUCTIBLE-AMOUNTS.
  5784             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5785             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5786         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5787             20  CM-RESIDENT-STATE         PIC XX.
  5788             20  CM-RATE-CODE              PIC X(4).
  5789             20  FILLER                    PIC XX.
  5790         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5791             20  CM-LOAN-OFFICER           PIC X(5).
  5792             20  FILLER                    PIC XXX.
  5793         16  CM-CSR-CODE                   PIC XXX.
  5794         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 109
* EL156.cbl
  5795             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5796         16  CM-POST-CARD-IND              PIC X.
  5797         16  CM-NH-INTERFACE-SW            PIC X.
  5798         16  CM-PREMIUM-TYPE               PIC X.
  5799             88  CM-SING-PRM                  VALUE '1'.
  5800             88  CM-O-B-COVERAGE              VALUE '2'.
  5801             88  CM-OPEN-END                  VALUE '3'.
  5802         16  CM-IND-GRP-TYPE               PIC X.
  5803             88  CM-INDIVIDUAL                VALUE 'I'.
  5804             88  CM-GROUP                     VALUE 'G'.
  5805         16  CM-SKIP-CODE                  PIC X.
  5806             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5807             88  SKIP-JULY                    VALUE '1'.
  5808             88  SKIP-AUGUST                  VALUE '2'.
  5809             88  SKIP-SEPTEMBER               VALUE '3'.
  5810             88  SKIP-JULY-AUG                VALUE '4'.
  5811             88  SKIP-AUG-SEPT                VALUE '5'.
  5812             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5813             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5814             88  SKIP-JUNE                    VALUE '8'.
  5815             88  SKIP-JUNE-JULY               VALUE '9'.
  5816             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5817             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5818         16  CM-PAYMENT-MODE               PIC X.
  5819             88  PAY-MONTHLY                  VALUE SPACE.
  5820             88  PAY-WEEKLY                   VALUE '1'.
  5821             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5822             88  PAY-BI-WEEKLY                VALUE '3'.
  5823             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5824         16  CM-LOAN-NUMBER                PIC X(8).
  5825         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5826         16  CM-OLD-LOF                    PIC XXX.
  5827*        16  CM-LOAN-OFFICER               PIC XXX.
  5828         16  CM-REIN-TABLE                 PIC XXX.
  5829         16  CM-SPECIAL-REIN-CODE          PIC X.
  5830         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5831         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5832         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5833
  5834     12  CM-STATUS-DATA.
  5835         16  CM-ENTRY-STATUS               PIC X.
  5836         16  CM-ENTRY-DT                   PIC XX.
  5837
  5838         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5839         16  CM-LF-CANCEL-DT               PIC XX.
  5840         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5841
  5842         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5843         16  CM-LF-DEATH-DT                PIC XX.
  5844         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5845
  5846         16  CM-LF-CURRENT-STATUS          PIC X.
  5847             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5848                                                'M' '4' '5' '9'.
  5849             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5850             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5851             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5852             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 110
* EL156.cbl
  5853             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5854             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5855             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5856             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5857             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5858             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5859             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5860             88  CM-LF-DECLINED               VALUE 'D'.
  5861             88  CM-LF-VOIDED                 VALUE 'V'.
  5862
  5863         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5864         16  CM-AH-CANCEL-DT               PIC XX.
  5865         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5866
  5867         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5868         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5869         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5870
  5871         16  CM-AH-CURRENT-STATUS          PIC X.
  5872             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5873                                                'M' '4' '5' '9'.
  5874             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5875             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5876             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5877             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5878             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5879             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5880             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5881             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5882             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5883             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5884             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5885             88  CM-AH-DECLINED               VALUE 'D'.
  5886             88  CM-AH-VOIDED                 VALUE 'V'.
  5887
  5888         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5889             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5890             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5891             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5892         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5893
  5894         16  CM-ENTRY-BATCH                PIC X(6).
  5895         16  CM-LF-EXIT-BATCH              PIC X(6).
  5896         16  CM-AH-EXIT-BATCH              PIC X(6).
  5897         16  CM-LAST-MONTH-END             PIC XX.
  5898
  5899     12  CM-NOTE-SW                        PIC X.
  5900         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5901         88  CERT-NOTES-PRESENT               VALUE '1'.
  5902         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5903         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5904         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5905         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5906         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5907         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5908     12  CM-COMP-EXCP-SW                   PIC X.
  5909         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5910         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 111
* EL156.cbl
  5911     12  CM-INSURED-ADDRESS-SW             PIC X.
  5912         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5913         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5914
  5915*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5916     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5917     12  FILLER                            PIC X.
  5918
  5919*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5920     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5921     12  FILLER                            PIC X.
  5922*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5923     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5924
  5925     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5926         88  CERT-ADDED-BATCH                 VALUE ' '.
  5927         88  CERT-ADDED-ONLINE                VALUE '1'.
  5928         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5929         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5930         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5931     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5932         88  CERT-AS-LOADED                   VALUE ' '.
  5933         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5934         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5935         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5936         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5937         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5938         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5939         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5940
  5941     12  CM-ACCOUNT-COMM-PCTS.
  5942         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5943         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5944
  5945     12  CM-USER-FIELD                     PIC X.
  5946     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5947     12  CM-CLP-STATE                      PIC XX.
  5948     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5949     12  CM-USER-RESERVED                  PIC XXX.
  5950     12  FILLER REDEFINES CM-USER-RESERVED.
  5951         16  CM-AH-CLASS-CD                PIC XX.
  5952         16  F                             PIC X.
  5953******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 112
* EL156.cbl
  5955*    COPY ELCTRLR.
  5956******************************************************************
  5957*                                                                *
  5958*                            ELCTRLR.                            *
  5959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5960*                            VMOD=2.014                          *
  5961*                                                                *
  5962*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5963*                                                                *
  5964*   FILE TYPE = VSAM,KSDS                                        *
  5965*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5966*                                                                *
  5967*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5968*       ALTERNATE INDEX = NONE                                   *
  5969*                                                                *
  5970*   LOG = YES                                                    *
  5971*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5972******************************************************************
  5973*                   C H A N G E   L O G
  5974*
  5975* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5976*-----------------------------------------------------------------
  5977*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5978* EFFECTIVE    NUMBER
  5979*-----------------------------------------------------------------
  5980* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5981* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5982* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5983* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5984* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5985* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5986* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5987* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5988* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5989* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5990* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5991* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5992* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5993* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5994* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5995* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5996* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5997* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5998* 040814    2014030500002  AJRA  ADD ICD CODES
  5999* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6000******************************************************************
  6001 01  ACTIVITY-TRAILERS.
  6002     12  AT-RECORD-ID                    PIC XX.
  6003         88  VALID-AT-ID                       VALUE 'AT'.
  6004
  6005     12  AT-CONTROL-PRIMARY.
  6006         16  AT-COMPANY-CD               PIC X.
  6007         16  AT-CARRIER                  PIC X.
  6008         16  AT-CLAIM-NO                 PIC X(7).
  6009         16  AT-CERT-NO.
  6010             20  AT-CERT-PRIME           PIC X(10).
  6011             20  AT-CERT-SFX             PIC X.
  6012         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 113
* EL156.cbl
  6013             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6014             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6015             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6016             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6017             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6018             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6019             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6020             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6021             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6022             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6023             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6024             88  AT-BENEFICIARY-TRL           VALUE +91.
  6025             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6026             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6027             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6028             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6029
  6030     12  AT-TRAILER-TYPE                 PIC X.
  6031         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6032         88  PAYMENT-TR                       VALUE '2'.
  6033         88  AUTO-PAY-TR                      VALUE '3'.
  6034         88  CORRESPONDENCE-TR                VALUE '4'.
  6035         88  ADDRESS-TR                       VALUE '5'.
  6036         88  GENERAL-INFO-TR                  VALUE '6'.
  6037         88  AUTO-PROMPT-TR                   VALUE '7'.
  6038         88  DENIAL-TR                        VALUE '8'.
  6039         88  INCURRED-CHG-TR                  VALUE '9'.
  6040         88  FORM-CONTROL-TR                  VALUE 'A'.
  6041
  6042     12  AT-RECORDED-DT                  PIC XX.
  6043     12  AT-RECORDED-BY                  PIC X(4).
  6044     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6045
  6046     12  AT-TRAILER-BODY                 PIC X(165).
  6047
  6048     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6049         16  AT-RESERVE-CONTROLS.
  6050             20  AT-MANUAL-SW            PIC X.
  6051                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6052             20  AT-FUTURE-SW            PIC X.
  6053                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6054             20  AT-PTC-SW               PIC X.
  6055                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6056             20  AT-IBNR-SW              PIC X.
  6057                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6058             20  AT-PTC-LF-SW            PIC X.
  6059                 88  AT-LF-PTC-USED          VALUE '1'.
  6060             20  AT-CDT-ACCESS-METHOD    PIC X.
  6061                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6062                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6063                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6064             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6065         16  AT-LAST-COMPUTED-DT         PIC XX.
  6066         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6067         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6068         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6069         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6070         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 114
* EL156.cbl
  6071         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6072         16  AT-EXPENSE-CONTROLS.
  6073             20  AT-EXPENSE-METHOD       PIC X.
  6074                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6075                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6076                 88  PERCENT-OF-PMT           VALUE '3'.
  6077                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6078             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6079             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6080         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6081         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6082
  6083         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6084         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6085
  6086*        16  FILLER                      PIC X(53).
  6087         16  FILLER                      PIC X(47).
  6088
  6089         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6090         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6091
  6092         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6093             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6094             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6095*                    C = CLOSED
  6096*                    O = OPEN
  6097             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6098*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6099
  6100     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6101         16  AT-PAYMENT-TYPE             PIC X.
  6102             88  PARTIAL-PAYMENT                VALUE '1'.
  6103             88  FINAL-PAYMENT                  VALUE '2'.
  6104             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6105             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6106             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6107             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6108             88  VOIDED-PAYMENT                 VALUE '9'.
  6109             88  TRANSFER                       VALUE 'T'.
  6110             88  LIFE-INTEREST                  VALUE 'I'.
  6111
  6112         16  AT-CLAIM-TYPE               PIC X.
  6113             88  PAID-FOR-AH                    VALUE 'A'.
  6114             88  PAID-FOR-LIFE                  VALUE 'L'.
  6115             88  PAID-FOR-IUI                   VALUE 'I'.
  6116             88  PAID-FOR-GAP                   VALUE 'G'.
  6117             88  PAID-FOR-FAM                   VALUE 'F'.
  6118         16  AT-CLAIM-PREM-TYPE          PIC X.
  6119             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6120             88  AT-O-B-COVERAGE                VALUE '2'.
  6121             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6122         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6123         16  AT-CHECK-NO                 PIC X(7).
  6124         16  AT-PAID-FROM-DT             PIC XX.
  6125         16  AT-PAID-THRU-DT             PIC XX.
  6126         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6127         16  FILLER                      PIC X.
  6128         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 115
* EL156.cbl
  6129         16  AT-PAYMENT-ORIGIN           PIC X.
  6130             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6131             88  ONLINE-AUTO-PMT                VALUE '2'.
  6132             88  OFFLINE-PMT                    VALUE '3'.
  6133         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6134         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6135         16  AT-VOID-DATA.
  6136             20  AT-VOID-DT              PIC XX.
  6137*00144       20  AT-VOID-REASON          PIC X(30).
  6138             20  AT-VOID-REASON          PIC X(26).
  6139         16  AT-PMT-APPROVED-BY          PIC X(04).
  6140         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6141         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6142         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6143                                         PIC S99V9(5)  COMP-3.
  6144         16  AT-CREDIT-INTERFACE.
  6145             20  AT-PMT-SELECT-DT        PIC XX.
  6146                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6147             20  AT-PMT-ACCEPT-DT        PIC XX.
  6148                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6149             20  AT-VOID-SELECT-DT       PIC XX.
  6150                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6151             20  AT-VOID-ACCEPT-DT       PIC XX.
  6152                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6153
  6154         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6155                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6156                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6157         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6158
  6159         16  AT-FORCE-CONTROL            PIC X.
  6160             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6161         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6162         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6163         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6164         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6165         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6166         16  AT-BENEFIT-TYPE             PIC X.
  6167
  6168         16  AT-EXPENSE-TYPE             PIC X.
  6169         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6170
  6171         16  AT-PAYEE-TYPE-CD.
  6172             20  AT-PAYEE-TYPE           PIC X.
  6173                 88  INSURED-PAID           VALUE 'I'.
  6174                 88  BENEFICIARY-PAID       VALUE 'B'.
  6175                 88  ACCOUNT-PAID           VALUE 'A'.
  6176                 88  OTHER-1-PAID           VALUE 'O'.
  6177                 88  OTHER-2-PAID           VALUE 'Q'.
  6178                 88  DOCTOR-PAID            VALUE 'P'.
  6179                 88  EMPLOYER-PAID          VALUE 'E'.
  6180             20  AT-PAYEE-SEQ            PIC X.
  6181
  6182         16  AT-CASH-PAYMENT             PIC X.
  6183         16  AT-GROUPED-PAYMENT          PIC X.
  6184         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6185         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6186         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 116
* EL156.cbl
  6187         16  AT-VOID-TYPE                PIC X.
  6188             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6189             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6190         16  AT-AIG-UNEMP-IND            PIC X.
  6191             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6192         16  AT-ASSOCIATES               PIC X.
  6193             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6194             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6195
  6196         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6197         16  AT-CV-PMT-CODE              PIC X.
  6198             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6199             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6200             88  FULL-ADD-PAYMENT           VALUE '3'.
  6201             88  HALF-ADD-PAYMENT           VALUE '4'.
  6202             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6203             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6204             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6205             88  ADDL-PAYMENT               VALUE '8'.
  6206
  6207         16  AT-EOB-CODE1                PIC XXX.
  6208         16  AT-EOB-CODE2                PIC XXX.
  6209         16  AT-EOB-CODE3                PIC XXX.
  6210         16  FILLER REDEFINES AT-EOB-CODE3.
  6211             20  AT-PRINT-CLM-FORM       PIC X.
  6212             20  AT-PRINT-SURVEY         PIC X.
  6213             20  AT-SPECIAL-RELEASE      PIC X.
  6214         16  AT-EOB-CODE4                PIC XXX.
  6215         16  FILLER REDEFINES AT-EOB-CODE4.
  6216             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6217             20  FILLER                  PIC X.
  6218         16  AT-EOB-CODE5                PIC XXX.
  6219         16  FILLER REDEFINES AT-EOB-CODE5.
  6220             20  AT-PMT-PROOF-DT         PIC XX.
  6221             20  FILLER                  PIC X.
  6222
  6223         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6224             88  AT-PRINT-EOB            VALUE 'Y'.
  6225
  6226         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6227         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6228
  6229     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6230         16  AT-SCHEDULE-START-DT        PIC XX.
  6231         16  AT-SCHEDULE-END-DT          PIC XX.
  6232         16  AT-TERMINATED-DT            PIC XX.
  6233         16  AT-LAST-PMT-TYPE            PIC X.
  6234             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6235             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6236         16  AT-FIRST-PMT-DATA.
  6237             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6238             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6239             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6240         16  AT-REGULAR-PMT-DATA.
  6241             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6242             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6243             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6244         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 117
* EL156.cbl
  6245             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6246                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6247                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6248                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6249                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6250                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6251             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6252         16  AT-AUTO-PAY-DAY             PIC 99.
  6253         16  AT-AUTO-CASH                PIC X.
  6254             88  AT-CASH                      VALUE 'Y'.
  6255             88  AT-NON-CASH                  VALUE 'N'.
  6256*        16  FILLER                      PIC X(129).
  6257         16  AT-AUTO-END-LETTER          PIC X(4).
  6258         16  FILLER                      PIC X(125).
  6259
  6260         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6261         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6262
  6263     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6264         16  AT-LETTER-SENT-DT           PIC XX.
  6265         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6266         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6267         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6268         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6269         16  AT-LETTER-ORIGIN            PIC X.
  6270             88  ONLINE-CREATION              VALUE '1' '3'.
  6271             88  OFFLINE-CREATION             VALUE '2' '4'.
  6272             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6273             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6274         16  AT-STD-LETTER-FORM          PIC X(4).
  6275         16  AT-REASON-TEXT              PIC X(70).
  6276         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6277         16  AT-ADDRESEE-TYPE            PIC X.
  6278              88  INSURED-ADDRESEE            VALUE 'I'.
  6279              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6280              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6281              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6282              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6283              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6284              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6285         16  AT-ADDRESSEE-NAME           PIC X(30).
  6286         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6287         16  AT-RESEND-PRINT-DATE        PIC XX.
  6288         16  AT-CORR-SOL-UNSOL           PIC X.
  6289         16  AT-LETTER-PURGED-DT         PIC XX.
  6290*
  6291*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6292*
  6293         16  AT-CSO-REDEFINITION.
  6294             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6295             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6296             20  AT-LETTER-TO-BENE       PIC X(1).
  6297             20  AT-STOP-LETTER-DT       PIC X(2).
  6298             20  FILLER                  PIC X(19).
  6299*             20  FILLER                  PIC X(27).
  6300             20  AT-CSO-LETTER-STATUS    PIC X.
  6301                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6302                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 118
* EL156.cbl
  6303                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6304             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6305             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6306*
  6307*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6308*
  6309*        16  FILLER                      PIC X(26).
  6310*
  6311*        16  AT-DMD-BSR-CODE             PIC X.
  6312*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6313*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6314*
  6315*        16  AT-DMD-LETTER-STATUS        PIC X.
  6316*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6317*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6318*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6319*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6320*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6321
  6322         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6323         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6324
  6325     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6326         16  AT-ADDRESS-TYPE             PIC X.
  6327             88  INSURED-ADDRESS               VALUE 'I'.
  6328             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6329             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6330             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6331             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6332             88  OTHER-ADDRESS-1               VALUE 'O'.
  6333             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6334         16  AT-MAIL-TO-NAME             PIC X(30).
  6335         16  AT-ADDRESS-LINE-1           PIC X(30).
  6336         16  AT-ADDRESS-LINE-2           PIC X(30).
  6337         16  AT-CITY-STATE.
  6338             20  AT-CITY                 PIC X(28).
  6339             20  AT-STATE                PIC XX.
  6340         16  AT-ZIP.
  6341             20  AT-ZIP-CODE.
  6342                 24  AT-ZIP-1ST          PIC X.
  6343                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6344                 24  FILLER              PIC X(4).
  6345             20  AT-ZIP-PLUS4            PIC X(4).
  6346         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6347             20  AT-CAN-POSTAL-1         PIC XXX.
  6348             20  AT-CAN-POSTAL-2         PIC XXX.
  6349             20  FILLER                  PIC XXX.
  6350         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6351*         16  FILLER                      PIC X(23).
  6352         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6353         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6354         16  FILLER                      PIC X(13).
  6355         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6356         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6357
  6358     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6359         16  AT-INFO-LINE-1              PIC X(60).
  6360         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 119
* EL156.cbl
  6361             20  AT-NOTE-ERROR-NO OCCURS 15
  6362                                         PIC X(4).
  6363         16  AT-INFO-LINE-2              PIC X(60).
  6364         16  FILLER REDEFINES AT-INFO-LINE-2.
  6365             20  AT-ICD-CODE-1           PIC X(8).
  6366             20  AT-ICD-CODE-2           PIC X(8).
  6367             20  FILLER                  PIC X(44).
  6368         16  AT-INFO-TRAILER-TYPE        PIC X.
  6369             88  AT-ERRORS-NOTE          VALUE 'E'.
  6370             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6371             88  AT-CALL-NOTE            VALUE 'C'.
  6372             88  AT-MAINT-NOTE           VALUE 'M'.
  6373             88  AT-CERT-CHANGE          VALUE 'X'.
  6374             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6375             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6376             88  AT-CERT-CANCELLED       VALUE 'T'.
  6377         16  AT-CALL-TYPE                PIC X.
  6378             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6379             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6380         16  AT-NOTE-CONTINUATION        PIC X.
  6381             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6382         16  AT-EOB-CODES-EXIST          PIC X.
  6383             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6384         16  FILLER                      PIC X(35).
  6385         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6386         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6387
  6388     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6389         16  AT-PROMPT-LINE-1            PIC X(60).
  6390         16  AT-PROMPT-LINE-2            PIC X(60).
  6391         16  AT-PROMPT-START-DT          PIC XX.
  6392         16  AT-PROMPT-END-DT            PIC XX.
  6393         16  FILLER                      PIC X(35).
  6394         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6395         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6396
  6397     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6398         16  AT-DENIAL-INFO-1            PIC X(60).
  6399         16  AT-DENIAL-INFO-2            PIC X(60).
  6400         16  AT-DENIAL-DT                PIC XX.
  6401         16  AT-RETRACTION-DT            PIC XX.
  6402         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6403*         16  FILLER                      PIC X(31).
  6404         16  AT-DENIAL-PROOF-DT          PIC XX.
  6405         16  FILLER                      PIC X(29).
  6406         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6407         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6408
  6409     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6410         16  AT-OLD-INCURRED-DT          PIC XX.
  6411         16  AT-OLD-REPORTED-DT          PIC XX.
  6412         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6413         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6414         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6415         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6416         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6417         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6418         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 120
* EL156.cbl
  6419         16  AT-OLD-DIAG-CODE            PIC X(6).
  6420         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6421         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6422         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6423         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6424         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6425         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6426         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6427         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6428         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6429         16  FILLER                      PIC X(9).
  6430         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6431
  6432     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6433         16  AT-FORM-SEND-ON-DT          PIC XX.
  6434         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6435         16  AT-FORM-RE-SEND-DT          PIC XX.
  6436         16  AT-FORM-ANSWERED-DT         PIC XX.
  6437         16  AT-FORM-PRINTED-DT          PIC XX.
  6438         16  AT-FORM-REPRINT-DT          PIC XX.
  6439         16  AT-FORM-TYPE                PIC X.
  6440             88  INITIAL-FORM                  VALUE '1'.
  6441             88  PROGRESS-FORM                 VALUE '2'.
  6442         16  AT-INSTRUCT-LN-1            PIC X(28).
  6443         16  AT-INSTRUCT-LN-2            PIC X(28).
  6444         16  AT-INSTRUCT-LN-3            PIC X(28).
  6445         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6446         16  AT-FORM-ADDRESS             PIC X.
  6447             88  FORM-TO-INSURED              VALUE 'I'.
  6448             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6449             88  FORM-TO-OTHER-1              VALUE 'O'.
  6450             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6451         16  AT-RELATED-1.
  6452             20 AT-REL-CARR-1            PIC X.
  6453             20 AT-REL-CLAIM-1           PIC X(7).
  6454             20 AT-REL-CERT-1            PIC X(11).
  6455         16  AT-RELATED-2.
  6456             20 AT-REL-CARR-2            PIC X.
  6457             20 AT-REL-CLAIM-2           PIC X(7).
  6458             20 AT-REL-CERT-2            PIC X(11).
  6459         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6460         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6461         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6462         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6463         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6464         16  AT-STOP-FORM-DT             PIC X(2).
  6465
  6466         16  FILLER                      PIC X(09).
  6467         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6468         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6469******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 121
* EL156.cbl
  6471*    COPY ELCACTQ.
  6472******************************************************************
  6473*                                                                *
  6474*                            ELCACTQ.                            *
  6475*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6476*                            VMOD=2.004                          *
  6477*                                                                *
  6478*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6479*                                                                *
  6480*   FILE TYPE = VSAM,KSDS                                        *
  6481*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6482*                                                                *
  6483*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6484*       ALTERNATE INDEX = NONE                                   *
  6485*                                                                *
  6486*   LOG = YES                                                    *
  6487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6488*                                                                *
  6489*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6490******************************************************************
  6491
  6492 01  ACTIVITY-QUE.
  6493     12  AQ-RECORD-ID                PIC XX.
  6494         88  VALID-AQ-ID                VALUE 'AQ'.
  6495
  6496     12  AQ-CONTROL-PRIMARY.
  6497         16  AQ-COMPANY-CD           PIC X.
  6498         16  AQ-CARRIER              PIC X.
  6499         16  AQ-CLAIM-NO             PIC X(7).
  6500         16  AQ-CERT-NO.
  6501             20  AQ-CERT-PRIME       PIC X(10).
  6502             20  AQ-CERT-SFX         PIC X.
  6503
  6504     12  AQ-PENDING-ACTIVITY-FLAGS.
  6505         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6506         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6507             88  PENDING-PAYMENTS       VALUE '1'.
  6508         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6509             88  PENDING-FULL-PRINT     VALUE '1'.
  6510             88  PENDING-PART-PRINT     VALUE '2'.
  6511         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6512             88  PENDING-LETTERS        VALUE '1'.
  6513         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6514             88  PENDING-RESTORE        VALUE 'C'.
  6515             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6516
  6517     12  FILLER                      PIC X(20).
  6518
  6519     12  AQ-RESEND-DATE              PIC XX.
  6520     12  AQ-FOLLOWUP-DATE            PIC XX.
  6521     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6522     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6523     12  AQ-AUTO-LETTER              PIC X(4).
  6524     12  FILLER                      PIC XX.
  6525     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6526*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 122
* EL156.cbl
  6528*    COPY ERCACCT.
  6529******************************************************************
  6530*                                                                *
  6531*                                                                *
  6532*                            ERCACCT                             *
  6533*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6534*                            VMOD=2.031                          *
  6535*                                                                *
  6536*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6537*                                                                *
  6538*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6539*   VSAM ACCOUNT MASTER FILES.                                   *
  6540*                                                                *
  6541*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6542*                                                                *
  6543*   FILE TYPE = VSAM,KSDS                                        *
  6544*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6545*                                                                *
  6546*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6547*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6548*                                                                *
  6549*   LOG = NO                                                     *
  6550*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6551*                                                                *
  6552*                                                                *
  6553******************************************************************
  6554*                   C H A N G E   L O G
  6555*
  6556* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6557*-----------------------------------------------------------------
  6558*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6559* EFFECTIVE    NUMBER
  6560*-----------------------------------------------------------------
  6561* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6562* 092705    2005050300006  PEMA  ADD SPP LEASES
  6563* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6564* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6565* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6566* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6567* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6568* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6569******************************************************************
  6570
  6571 01  ACCOUNT-MASTER.
  6572     12  AM-RECORD-ID                      PIC XX.
  6573         88  VALID-AM-ID                      VALUE 'AM'.
  6574
  6575     12  AM-CONTROL-PRIMARY.
  6576         16  AM-COMPANY-CD                 PIC X.
  6577         16  AM-MSTR-CNTRL.
  6578             20  AM-CONTROL-A.
  6579                 24  AM-CARRIER            PIC X.
  6580                 24  AM-GROUPING.
  6581                     28 AM-GROUPING-PREFIX PIC XXX.
  6582                     28 AM-GROUPING-PRIME  PIC XXX.
  6583                 24  AM-STATE              PIC XX.
  6584                 24  AM-ACCOUNT.
  6585                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 123
* EL156.cbl
  6586                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6587             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6588                                           PIC X(19).
  6589             20  AM-CNTRL-B.
  6590                 24  AM-EXPIRATION-DT      PIC XX.
  6591                 24  FILLER                PIC X(4).
  6592             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6593                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6594
  6595     12  AM-CONTROL-BY-VAR-GRP.
  6596         16  AM-COMPANY-CD-A1              PIC X.
  6597         16  AM-VG-CARRIER                 PIC X.
  6598         16  AM-VG-GROUPING                PIC X(6).
  6599         16  AM-VG-STATE                   PIC XX.
  6600         16  AM-VG-ACCOUNT                 PIC X(10).
  6601         16  AM-VG-DATE.
  6602             20  AM-VG-EXPIRATION-DT       PIC XX.
  6603             20  FILLER                    PIC X(4).
  6604         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6605                                           PIC 9(11)      COMP-3.
  6606     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6607         16  FILLER                        PIC X(10).
  6608         16  AM-VG-KEY3.
  6609             20  AM-VG3-ACCOUNT            PIC X(10).
  6610             20  AM-VG3-EXP-DT             PIC XX.
  6611         16  FILLER                        PIC X(4).
  6612     12  AM-MAINT-INFORMATION.
  6613         16  AM-LAST-MAINT-DT              PIC XX.
  6614         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6615         16  AM-LAST-MAINT-USER            PIC X(4).
  6616         16  FILLER                        PIC XX.
  6617
  6618     12  AM-EFFECTIVE-DT                   PIC XX.
  6619     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6620
  6621     12  AM-PREV-DATES  COMP-3.
  6622         16  AM-PREV-EXP-DT                PIC 9(11).
  6623         16  AM-PREV-EFF-DT                PIC 9(11).
  6624
  6625     12  AM-REPORT-CODE-1                  PIC X(10).
  6626     12  AM-REPORT-CODE-2                  PIC X(10).
  6627
  6628     12  AM-CITY-CODE                      PIC X(4).
  6629     12  AM-COUNTY-PARISH                  PIC X(6).
  6630
  6631     12  AM-NAME                           PIC X(30).
  6632     12  AM-PERSON                         PIC X(30).
  6633     12  AM-ADDRS                          PIC X(30).
  6634     12  AM-CITY.
  6635         16  AM-ADDR-CITY                  PIC X(28).
  6636         16  AM-ADDR-STATE                 PIC XX.
  6637     12  AM-ZIP.
  6638         16  AM-ZIP-PRIME.
  6639             20  AM-ZIP-PRI-1ST            PIC X.
  6640                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6641             20  FILLER                    PIC X(4).
  6642         16  AM-ZIP-PLUS4                  PIC X(4).
  6643     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 124
* EL156.cbl
  6644         16  AM-CAN-POSTAL-1               PIC XXX.
  6645         16  AM-CAN-POSTAL-2               PIC XXX.
  6646         16  FILLER                        PIC XXX.
  6647     12  AM-TEL-NO.
  6648         16  AM-AREA-CODE                  PIC 999.
  6649         16  AM-TEL-PRE                    PIC 999.
  6650         16  AM-TEL-NBR                    PIC 9(4).
  6651     12  AM-TEL-LOC                        PIC X.
  6652         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6653         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6654
  6655     12  AM-COMM-STRUCTURE.
  6656         16  AM-DEFN-1.
  6657             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6658                 24  AM-AGT.
  6659                     28  AM-AGT-PREFIX     PIC X(4).
  6660                     28  AM-AGT-PRIME      PIC X(6).
  6661                 24  AM-COM-TYP            PIC X.
  6662                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6663                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6664                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6665                 24  AM-RECALC-LV-INDIC    PIC X.
  6666                 24  AM-RETRO-LV-INDIC     PIC X.
  6667                 24  AM-GL-CODES           PIC X.
  6668                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6669                 24  FILLER                PIC X(01).
  6670         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6671             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6672                 24  FILLER                PIC X(11).
  6673                 24  AM-L-COMA             PIC XXX.
  6674                 24  AM-J-COMA             PIC XXX.
  6675                 24  AM-A-COMA             PIC XXX.
  6676                 24  FILLER                PIC X(6).
  6677
  6678     12  AM-COMM-CHANGE-STATUS             PIC X.
  6679         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6680
  6681     12  AM-CSR-CODE                       PIC X(4).
  6682
  6683     12  AM-BILLING-STATUS                 PIC X.
  6684         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6685         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6686     12  AM-AUTO-REFUND-SW                 PIC X.
  6687         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6688         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6689     12  AM-GPCD                           PIC 99.
  6690     12  AM-IG                             PIC X.
  6691         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6692         88  AM-HAS-GROUP                     VALUE '2'.
  6693     12  AM-STATUS                         PIC X.
  6694         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6695         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6696         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6697         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6698         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6699         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6700         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6701         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 125
* EL156.cbl
  6702         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6703         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6704     12  AM-REMIT-TO                       PIC 99.
  6705     12  AM-ID-NO                          PIC X(11).
  6706
  6707     12  AM-CAL-TABLE                      PIC XX.
  6708     12  AM-LF-DEVIATION                   PIC XXX.
  6709     12  AM-AH-DEVIATION                   PIC XXX.
  6710     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6711     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6712     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6713     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6714     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6715     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6716
  6717     12  AM-USER-FIELDS.
  6718         16  AM-FLD-1                      PIC XX.
  6719         16  AM-FLD-2                      PIC XX.
  6720         16  AM-FLD-3                      PIC XX.
  6721         16  AM-FLD-4                      PIC XX.
  6722         16  AM-FLD-5                      PIC XX.
  6723
  6724     12  AM-1ST-PROD-DATE.
  6725         16  AM-1ST-PROD-YR                PIC XX.
  6726         16  AM-1ST-PROD-MO                PIC XX.
  6727         16  AM-1ST-PROD-DA                PIC XX.
  6728     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6729     12  AM-CERTS-PURGED-DATE.
  6730         16  AM-PUR-YR                     PIC XX.
  6731         16  AM-PUR-MO                     PIC XX.
  6732         16  AM-PUR-DA                     PIC XX.
  6733     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6734     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6735     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6736     12  AM-INACTIVE-DATE.
  6737         16  AM-INA-MO                     PIC 99.
  6738         16  AM-INA-DA                     PIC 99.
  6739         16  AM-INA-YR                     PIC 99.
  6740     12  AM-AR-HI-CERT-DATE                PIC XX.
  6741
  6742     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6743     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6744
  6745     12  AM-OB-PAYMENT-MODE                PIC X.
  6746         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6747         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6748         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6749         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6750
  6751     12  AM-AH-ONLY-INDICATOR              PIC X.
  6752         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6753         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6754
  6755     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6756
  6757     12  AM-OVER-SHORT.
  6758         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6759         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 126
* EL156.cbl
  6760
  6761     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6762     12  AM-DCC-CLP-STATE                  PIC XX.
  6763
  6764     12  AM-RECALC-COMM                    PIC X.
  6765     12  AM-RECALC-REIN                    PIC X.
  6766
  6767     12  AM-REI-TABLE                      PIC XXX.
  6768     12  AM-REI-ET-LF                      PIC X.
  6769     12  AM-REI-ET-AH                      PIC X.
  6770     12  AM-REI-PE-LF                      PIC X.
  6771     12  AM-REI-PE-AH                      PIC X.
  6772     12  AM-REI-PRT-ST                     PIC X.
  6773     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6774     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6775     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6776     12  AM-REI-GROUP-A                    PIC X(6).
  6777     12  AM-REI-MORT                       PIC X(4).
  6778     12  AM-REI-PRT-OW                     PIC X.
  6779     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6780     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6781     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6782     12  AM-REI-GROUP-B                    PIC X(6).
  6783
  6784     12  AM-TRUST-TYPE                     PIC X(2).
  6785
  6786     12  AM-EMPLOYER-STMT-USED             PIC X.
  6787     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6788
  6789     12  AM-STD-AH-TYPE                    PIC XX.
  6790     12  AM-EARN-METHODS.
  6791         16  AM-EARN-METHOD-R              PIC X.
  6792             88 AM-REF-RL-R78                 VALUE 'R'.
  6793             88 AM-REF-RL-PR                  VALUE 'P'.
  6794             88 AM-REF-RL-MEAN                VALUE 'M'.
  6795             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6796         16  AM-EARN-METHOD-L              PIC X.
  6797             88 AM-REF-LL-R78                 VALUE 'R'.
  6798             88 AM-REF-LL-PR                  VALUE 'P'.
  6799             88 AM-REF-LL-MEAN                VALUE 'M'.
  6800             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6801         16  AM-EARN-METHOD-A              PIC X.
  6802             88 AM-REF-AH-R78                 VALUE 'R'.
  6803             88 AM-REF-AH-PR                  VALUE 'P'.
  6804             88 AM-REF-AH-MEAN                VALUE 'M'.
  6805             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6806             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6807             88 AM-REF-AH-NET                 VALUE 'N'.
  6808
  6809     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6810     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6811     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6812
  6813     12  AM-RET-Y-N                        PIC X.
  6814     12  AM-RET-P-E                        PIC X.
  6815     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6816     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6817     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 127
* EL156.cbl
  6818     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6819         16  AM-POOL-PRIME                 PIC XXX.
  6820         16  AM-POOL-SUB                   PIC XXX.
  6821     12  AM-RETRO-EARNINGS.
  6822         16  AM-RET-EARN-R                 PIC X.
  6823         16  AM-RET-EARN-L                 PIC X.
  6824         16  AM-RET-EARN-A                 PIC X.
  6825     12  AM-RET-ST-TAX-USE                 PIC X.
  6826         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6827         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6828     12  AM-RETRO-BEG-EARNINGS.
  6829         16  AM-RET-BEG-EARN-R             PIC X.
  6830         16  AM-RET-BEG-EARN-L             PIC X.
  6831         16  AM-RET-BEG-EARN-A             PIC X.
  6832     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6833     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6834
  6835     12  AM-USER-SELECT-OPTIONS.
  6836         16  AM-USER-SELECT-1              PIC X(10).
  6837         16  AM-USER-SELECT-2              PIC X(10).
  6838         16  AM-USER-SELECT-3              PIC X(10).
  6839         16  AM-USER-SELECT-4              PIC X(10).
  6840         16  AM-USER-SELECT-5              PIC X(10).
  6841
  6842     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6843
  6844     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6845
  6846     12  AM-RPT045A-SWITCH                 PIC X.
  6847         88  RPT045A-OFF                   VALUE 'N'.
  6848
  6849     12  AM-INSURANCE-LIMITS.
  6850         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6851         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6852
  6853     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6854         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6855
  6856     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6857         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6858         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6859
  6860     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6861
  6862     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6863     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6864     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6865     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6866     12  AM-DCC-UEF-STATE                  PIC XX.
  6867     12  FILLER                            PIC XXX.
  6868     12  AM-REPORT-CODE-3                  PIC X(10).
  6869*    12  FILLER                            PIC X(22).
  6870
  6871     12  AM-RESERVE-DATE.
  6872         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6873         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6874         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6875
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 128
* EL156.cbl
  6876     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6877     12  AM-NOTIFICATION-TYPES.
  6878         16  AM-NOTIF-OF-LETTERS           PIC X.
  6879         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6880         16  AM-NOTIF-OF-REPORTS           PIC X.
  6881         16  AM-NOTIF-OF-STATUS            PIC X.
  6882
  6883     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6884         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6885         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6886         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6887         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6888
  6889     12  AM-BENEFIT-CONTROLS.
  6890         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6891             20  AM-BENEFIT-CODE           PIC XX.
  6892             20  AM-BENEFIT-TYPE           PIC X.
  6893             20  AM-BENEFIT-REVISION       PIC XXX.
  6894             20  AM-BENEFIT-REM-TERM       PIC X.
  6895             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6896             20  FILLER                    PIC XX.
  6897         16  FILLER                        PIC X(80).
  6898
  6899     12  AM-TRANSFER-DATA.
  6900         16  AM-TRANSFERRED-FROM.
  6901             20  AM-TRNFROM-CARRIER        PIC X.
  6902             20  AM-TRNFROM-GROUPING.
  6903                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6904                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6905             20  AM-TRNFROM-STATE          PIC XX.
  6906             20  AM-TRNFROM-ACCOUNT.
  6907                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6908                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6909             20  AM-TRNFROM-DTE            PIC XX.
  6910         16  AM-TRANSFERRED-TO.
  6911             20  AM-TRNTO-CARRIER          PIC X.
  6912             20  AM-TRNTO-GROUPING.
  6913                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6914                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6915             20  AM-TRNTO-STATE            PIC XX.
  6916             20  AM-TRNTO-ACCOUNT.
  6917                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6918                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6919             20  AM-TRNTO-DTE              PIC XX.
  6920         16  FILLER                        PIC X(10).
  6921
  6922     12  AM-SAVED-REMIT-TO                 PIC 99.
  6923
  6924     12  AM-COMM-STRUCTURE-SAVED.
  6925         16  AM-DEFN-1-SAVED.
  6926             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6927                 24  AM-AGT-SV             PIC X(10).
  6928                 24  AM-COM-TYP-SV         PIC X.
  6929                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6930                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6931                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6932                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6933                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 129
* EL156.cbl
  6934                 24  AM-GL-CODES-SV        PIC X.
  6935                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6936                 24  FILLER                PIC X.
  6937         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6938             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6939                 24  FILLER                PIC X(11).
  6940                 24  AM-L-COMA-SV          PIC XXX.
  6941                 24  AM-J-COMA-SV          PIC XXX.
  6942                 24  AM-A-COMA-SV          PIC XXX.
  6943                 24  FILLER                PIC X(6).
  6944
  6945     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6946         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6947            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6948            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6949            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6950
  6951     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6952     12  FILLER                            PIC X(120).
  6953
  6954     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6955         16  AM-CONTROL-NAME               PIC X(30).
  6956         16  AM-EXECUTIVE-ONE.
  6957             20  AM-EXEC1-NAME             PIC X(15).
  6958             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6959                                                          COMP-3.
  6960             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6961                                                          COMP-3.
  6962         16  AM-EXECUTIVE-TWO.
  6963             20  AM-EXEC2-NAME             PIC X(15).
  6964             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6965                                                          COMP-3.
  6966             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6967                                                          COMP-3.
  6968
  6969     12  AM-RETRO-ADDITIONAL-DATA.
  6970         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6971         16  AM-RETRO-PREM-P-E             PIC X.
  6972         16  AM-RETRO-CLMS-P-I             PIC X.
  6973         16  AM-RETRO-RET-BRACKET-LF.
  6974             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6975                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6976                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6977             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6978                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6979                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6980             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6981                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6982                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6983         16  AM-RETRO-RET-BRACKET-AH.
  6984             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6985                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6986                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6987                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6988             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6989                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6990                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6991             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 130
* EL156.cbl
  6992                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6993                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6994
  6995     12  AM-COMMENTS.
  6996         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6997
  6998     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6999         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7000         16  AM-FLI-BILLING-CODE           PIC X.
  7001         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7002         16  AM-FLI-UNITED-IDENT           PIC X.
  7003         16  AM-FLI-INTEREST-LOST-DATA.
  7004             20  AM-FLI-BANK-NO            PIC X(5).
  7005             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7006             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7007             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7008         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7009             20  AM-FLI-AGT                PIC X(9).
  7010             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7011             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7012         16  FILLER                        PIC X(102).
  7013
  7014     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7015         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7016             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7017             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7018             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7019             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7020             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7021         16  FILLER                          PIC X(10).
  7022******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 131
* EL156.cbl
  7024*    COPY ELCCHKQ.
  7025******************************************************************
  7026*                                                                *
  7027*                                                                *
  7028*                            ELCCHKQ.                            *
  7029*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7030*                            VMOD=2.007                          *
  7031*                                                                *
  7032*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7033*                                                                *
  7034*   FILE TYPE = VSAM,KSDS                                        *
  7035*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7036*                                                                *
  7037*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7038*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7039*                                                                *
  7040*   LOG = YES                                                    *
  7041*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7042******************************************************************
  7043 01  CHECK-QUE.
  7044     12  CQ-RECORD-ID                PIC XX.
  7045         88  VALID-CQ-ID         VALUE 'CQ'.
  7046
  7047     12  CQ-CONTROL-PRIMARY.
  7048         16  CQ-COMPANY-CD           PIC X.
  7049         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7050         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7051
  7052     12  CQ-CONTROL-BY-PAYEE.
  7053         16  CQ-CONTROL-BY-NUMBER.
  7054             20  CQ-COMPANY-CD-A1     PIC X.
  7055             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7056         16  CQ-PAYEE-CARRIER        PIC X.
  7057         16  CQ-PAYEE-GROUPING       PIC X(6).
  7058         16  CQ-PAYEE-STATE          PIC XX.
  7059         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7060         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7061
  7062     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7063         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7064         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7065         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7066         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7067         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7068         16  FILLER                  PIC X(3).
  7069
  7070     12  CQ-ENTRY-TYPE               PIC X.
  7071             88  CHECK-ON-QUE           VALUE 'Q'.
  7072             88  ALIGNMENT-CHECK        VALUE 'A'.
  7073             88  SPOILED-CHECK          VALUE 'S'.
  7074             88  PAYMENT-ABORTED        VALUE 'X'.
  7075
  7076     12  CQ-CLAIM-MAST-CNTL.
  7077         16  CQ-CARRIER              PIC X.
  7078         16  CQ-CLAIM-NO             PIC X(7).
  7079         16  CQ-CERT-NO.
  7080             20  CQ-CERT-PRIME       PIC X(10).
  7081             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 132
* EL156.cbl
  7082         16  CQ-CLAIM-TYPE           PIC X.
  7083             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7084             88  CQ-AH-CLAIM            VALUE 'A'.
  7085         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7086             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7087             88  CQ-O-B-COVERAGE        VALUE '2'.
  7088             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7089
  7090     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7091     12  CQ-CHECK-NUMBER             PIC X(7).
  7092     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7093     12  CQ-PAYMENT-TYPE             PIC X.
  7094             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7095             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7096             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7097             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7098             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7099             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7100             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7101             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7102     12  CQ-VOID-INDICATOR           PIC X.
  7103             88  CHECK-IS-STOPPED          VALUE 'S'.
  7104             88  CHECK-IS-VOID             VALUE 'V'.
  7105     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7106     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7107     12  CQ-CHECK-BY-USER            PIC X(4).
  7108     12  CQ-PRE-NUMBERING-SW         PIC X.
  7109       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7110       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7111
  7112     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7113     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7114     12  CQ-LEDGER-FLAG              PIC X(01).
  7115     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7116     12  CQ-LAST-UPDATED-DT          PIC XX.
  7117     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7118     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7119
  7120     12  FILLER                      PIC X(04).
  7121
  7122******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 133
* EL156.cbl
  7124*    COPY ELCBENE.
  7125******************************************************************
  7126*                                                                *
  7127*                            ELCBENE.                            *
  7128*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7129*                            VMOD=2.006                          *
  7130*                                                                *
  7131*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7132*                                                                *
  7133*   FILE TYPE = VSAM,KSDS                                        *
  7134*   RECORD SIZE = 500   RECFORM = FIX                            *
  7135*                                                                *
  7136*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7137*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7138*                                                                *
  7139*   LOG = YES                                                    *
  7140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7141*                                                                *
  7142*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7143******************************************************************
  7144
  7145 01  BENEFICIARY-MASTER.
  7146     12  BE-RECORD-ID                PIC XX.
  7147         88  VALID-BE-ID                VALUE 'BE'.
  7148
  7149     12  BE-CONTROL-PRIMARY.
  7150         16  BE-COMPANY-CD           PIC X.
  7151         16  BE-RECORD-TYPE          PIC X.
  7152             88  BENEFICIARY-RECORD  VALUE 'B'.
  7153             88  ADJUSTOR-RECORD     VALUE 'A'.
  7154         16  BE-BENEFICIARY          PIC X(10).
  7155     12  BE-CONTROL-BY-NAME.
  7156         16  BE-COMPANY-CD-A1        PIC X.
  7157         16  BE-RECORD-TYPE-A1       PIC X.
  7158         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7159         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7160
  7161     12  BE-LAST-MAINT-DT            PIC XX.
  7162     12  BE-LAST-MAINT-BY            PIC X(4).
  7163     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7164
  7165     12  BE-ADDRESS-DATA.
  7166         16  BE-MAIL-TO-NAME         PIC X(30).
  7167         16  BE-ADDRESS-LINE-1       PIC X(30).
  7168         16  BE-ADDRESS-LINE-2       PIC X(30).
  7169         16  BE-ADDRESS-LINE-3       PIC X(30).
  7170         16  BE-CITY-STATE.
  7171             20  BE-CITY             PIC X(28).
  7172             20  BE-STATE            PIC XX.
  7173         16  BE-ZIP-CODE.
  7174             20  BE-ZIP-PRIME.
  7175                 24  BE-ZIP-1ST      PIC X.
  7176                     88  BE-CANADIAN-POST-CODE
  7177                                         VALUE 'A' THRU 'Z'.
  7178                 24  FILLER          PIC X(4).
  7179             20  BE-ZIP-PLUS4        PIC X(4).
  7180         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7181             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 134
* EL156.cbl
  7182             20  BE-CAN-POSTAL-2     PIC XXX.
  7183             20  FILLER              PIC XXX.
  7184         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7185         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7186
  7187******************************************************************
  7188*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7189*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7190******************************************************************
  7191     12  BE-CARRIER                  PIC X.
  7192
  7193     12  BE-ADDRESS-DATA2.
  7194         16  BE-MAIL-TO-NAME2        PIC X(30).
  7195         16  BE-ADDRESS-LINE-12      PIC X(30).
  7196         16  BE-ADDRESS-LINE-22      PIC X(30).
  7197         16  BE-ADDRESS-LINE-32      PIC X(30).
  7198         16  BE-CITY-STATE2.
  7199             20  BE-CITY2            PIC X(28).
  7200             20  BE-STATE2           PIC XX.
  7201         16  BE-ZIP-CODE2.
  7202             20  BE-ZIP-PRIME2.
  7203                 24  BE-ZIP-1ST2     PIC X.
  7204                     88  BE-CANADIAN-POST-CODE2
  7205                                         VALUE 'A' THRU 'Z'.
  7206                 24  FILLER          PIC X(4).
  7207             20  BE-ZIP-PLUS42       PIC X(4).
  7208         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7209             20  BE-CAN-POSTAL-12    PIC XXX.
  7210             20  BE-CAN-POSTAL-22    PIC XXX.
  7211             20  FILLER              PIC XXX.
  7212         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7213         16  BE-BILLING-STMT-DATA.
  7214             20  BE-BSR              PIC X.
  7215                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7216                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7217             20  BE-BSR-FROM         PIC X(30).
  7218             20  BE-BSR-DEPT         PIC X(30).
  7219             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7220             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7221             20  BE-OUTPUT-TYPE      PIC X.
  7222                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7223                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7224
  7225     12  FILLER                      PIC X(28).
  7226******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 135
* EL156.cbl
  7228*    COPY ELCARCH.
  7229******************************************************************
  7230*                                                                *
  7231*                            ELCARCH.                            *
  7232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7233*                            VMOD=2.007                          *
  7234*                                                                *
  7235*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7236*                                                                *
  7237*   FILE TYPE = VSAM,KSDS                                        *
  7238*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7239*                                                                *
  7240*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7241*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7242*                                                                *
  7243*   LOG = NO                                                     *
  7244*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7245*                                                                *
  7246*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7247******************************************************************
  7248 01  LETTER-ARCHIVE.
  7249     12  LA-RECORD-ID                PIC XX.
  7250         88  VALID-LA-ID                VALUE 'LA'.
  7251
  7252     12  LA-CONTROL-PRIMARY.
  7253         16  LA-COMPANY-CD           PIC X.
  7254         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7255         16  LA-RECORD-TYPE          PIC X.
  7256             88  LA-HEADER-DATA         VALUE '1'.
  7257             88  LA-ADDRESS-DATA        VALUE '2'.
  7258             88  LA-TEXT-DATA           VALUE '3'.
  7259             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7260         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7261
  7262     12  LA-CONTROL-BY-TYPE.
  7263         16  LA-COMPANY-CD-A1        PIC X.
  7264         16  LA-RECORD-TYPE-A1       PIC X.
  7265         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7266         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7267
  7268     12  LA-TEXT-RECORD.
  7269         16  LA-SKIP-CONTROL         PIC XX.
  7270             88  NO-LINES-SKIPPED       VALUE SPACES.
  7271             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7272         16  LA-TEXT-LINE            PIC X(70).
  7273
  7274     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7275         16  FILLER                  PIC XX.
  7276         16  LA-ADDRESS-LINE         PIC X(30).
  7277         16  FILLER                  PIC X(40).
  7278
  7279     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7280         16  FILLER                  PIC XX.
  7281         16  LA-CARRIER              PIC X.
  7282         16  LA-CLAIM-NO             PIC X(7).
  7283         16  LA-CERT-NO.
  7284             20  LA-CERT-PRIME       PIC X(10).
  7285             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 136
* EL156.cbl
  7286         16  LA-NO-OF-COPIES         PIC S9.
  7287         16  LA-RESEND-DATE          PIC XX.
  7288         16  LA-PROCESSOR-CD         PIC X(4).
  7289         16  LA-CREATION-DT          PIC XX.
  7290         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7291         16  LA-RESEND-PRINT-DATE    PIC XX.
  7292         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7293         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7294*
  7295* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7296*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7297*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7298*   I        20  LA-DMD-RES-ST           PIC XX.
  7299*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7300*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7301*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7302*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7303*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7304*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7305*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7306*   I        20  LA-DMD-UND-CODE         PIC XX.
  7307*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7308*   V    16  FILLER                  PIC X(15).
  7309* -----
  7310*
  7311* REINSERTED  CSO  MODS
  7312*
  7313         16  FILLER.
  7314             20  FILLER                  PIC X(29).
  7315             20  LA-CSO-LETTER-STATUS    PIC X.
  7316                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7317                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7318                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7319             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7320             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7321*
  7322
  7323     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7324         16  FILLER                  PIC XX.
  7325         16  LA4-CARRIER             PIC X.
  7326         16  LA4-CLAIM-NO            PIC X(7).
  7327         16  LA4-CERT-NO.
  7328             20  LA4-CERT-PRIME      PIC X(10).
  7329             20  LA4-CERT-SFX        PIC X.
  7330         16  LA4-NO-OF-COPIES        PIC S9.
  7331         16  LA4-RESEND-DATE         PIC XX.
  7332         16  LA4-PROCESSOR-CD        PIC X(4).
  7333         16  LA4-CREATION-DT         PIC XX.
  7334         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7335         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7336         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7337         16  LA4-FORM-TYPE           PIC X.
  7338             88  LA4-INITIAL-FORM    VALUE '1'.
  7339             88  LA4-PROGRESS-FORM   VALUE '2'.
  7340         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7341         16  LA4-STATE               PIC X(02).
  7342         16  FILLER                  PIC X(31).
  7343******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 137
* EL156.cbl
  7345*    COPY ELCDAR.
  7346******************************************************************
  7347*                                                                *
  7348*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7349*   FILE TYPE = VSAM,KSDS                                        *
  7350*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7351*   BASE CLUSTER = DLYACTV                                       *
  7352*   LOG = YES                                                    *
  7353*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7354*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7355*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7356*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7357*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7358*               BY PROGRAM "LGINFCE".                            *
  7359*                                                                *
  7360******************************************************************
  7361 01  DAILY-ACTIVITY-RECORD.
  7362     05  DA-KEY.
  7363         10  DA-COMP-CD          PIC X.
  7364         10  DA-CARRIER          PIC X.
  7365         10  DA-CLAIM-NO         PIC X(7).
  7366         10  DA-CERT-NO.
  7367             15  DA-CERT-PRIME   PIC X(10).
  7368             15  DA-CERT-SFX     PIC X.
  7369     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7370     05  DA-RECORD-TYPE          PIC X.
  7371     05  FILLER                  PIC X(2).
  7372******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 138
* EL156.cbl
  7374*    COPY ERCCOMP.
  7375******************************************************************
  7376*                                                                *
  7377*                                                                *
  7378*                            ERCCOMP                             *
  7379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7380*                            VMOD=2.019                          *
  7381*                                                                *
  7382*   ONLINE CREDIT SYSTEM                                         *
  7383*                                                                *
  7384*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7385*                                                                *
  7386*   FILE TYPE = VSAM,KSDS                                        *
  7387*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7388*                                                                *
  7389*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7390*       ALTERNATE PATH = NONE                                    *
  7391*                                                                *
  7392*   LOG = NO                                                     *
  7393*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7394*                                                                *
  7395******************************************************************
  7396*                   C H A N G E   L O G
  7397*
  7398* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7399*-----------------------------------------------------------------
  7400*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7401* EFFECTIVE    NUMBER
  7402*-----------------------------------------------------------------
  7403* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7404* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7405* 092205    2005050300006  PEMA  ADD LEASE FEE
  7406* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7407* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7408* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7409* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7410* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7411* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7412******************************************************************
  7413
  7414 01  COMPENSATION-MASTER.
  7415     12  CO-RECORD-ID                          PIC XX.
  7416         88  VALID-CO-ID                          VALUE 'CO'.
  7417
  7418     12  CO-CONTROL-PRIMARY.
  7419         16  CO-COMPANY-CD                     PIC X.
  7420         16  CO-CONTROL.
  7421             20  CO-CTL-1.
  7422                 24  CO-CARR-GROUP.
  7423                     28  CO-CARRIER            PIC X.
  7424                     28  CO-GROUPING.
  7425                         32  CO-GROUP-PREFIX   PIC XXX.
  7426                         32  CO-GROUP-PRIME    PIC XXX.
  7427                 24  CO-RESP-NO.
  7428                     28  CO-RESP-PREFIX        PIC X(4).
  7429                     28  CO-RESP-PRIME         PIC X(6).
  7430             20  CO-CTL-2.
  7431                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 139
* EL156.cbl
  7432                     28  CO-ACCT-PREFIX        PIC X(4).
  7433                     28  CO-ACCT-PRIME         PIC X(6).
  7434         16  CO-TYPE                           PIC X.
  7435             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7436             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7437             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7438
  7439     12  CO-MAINT-INFORMATION.
  7440         16  CO-LAST-MAINT-DT                  PIC XX.
  7441         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7442         16  CO-LAST-MAINT-USER                PIC X(4).
  7443     12  FILLER                                PIC XX.
  7444     12  CO-STMT-TYPE                          PIC XXX.
  7445     12  CO-COMP-TYPE                          PIC X.
  7446         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7447     12  CO-STMT-OWNER                         PIC X(4).
  7448     12  CO-BALANCE-CONTROL                    PIC X.
  7449         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7450         88  CO-NO-BALANCE                        VALUE 'N'.
  7451
  7452     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7453         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7454         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7455         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7456
  7457     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7458         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7459         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7460
  7461     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7462     12  CO-GA-DIRECT-DEP                      PIC X.
  7463     12  CO-FUTURE-SPACE                       PIC X.
  7464         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7465
  7466     12  CO-ACCT-NAME                          PIC X(30).
  7467     12  CO-MAIL-NAME                          PIC X(30).
  7468     12  CO-ADDR-1                             PIC X(30).
  7469     12  CO-ADDR-2                             PIC X(30).
  7470     12  CO-ADDR-3.
  7471         16  CO-ADDR-CITY                      PIC X(27).
  7472         16  CO-ADDR-STATE                     PIC XX.
  7473     12  CO-CSO-1099                           PIC X.
  7474     12  CO-ZIP.
  7475         16  CO-ZIP-PRIME.
  7476             20  CO-ZIP-PRI-1ST                PIC X.
  7477                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7478             20  FILLER                        PIC X(4).
  7479         16  CO-ZIP-PLUS4                      PIC X(4).
  7480     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7481         16  CO-CAN-POSTAL-1                   PIC XXX.
  7482         16  CO-CAN-POSTAL-2                   PIC XXX.
  7483         16  FILLER                            PIC XXX.
  7484     12  CO-SOC-SEC                            PIC X(13).
  7485     12  CO-TELEPHONE.
  7486         16  CO-AREA-CODE                      PIC XXX.
  7487         16  CO-PREFIX                         PIC XXX.
  7488         16  CO-PHONE                          PIC X(4).
  7489
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 140
* EL156.cbl
  7490     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7491
  7492     12  CO-AR-BAL-LEVEL                       PIC X.
  7493         88  CO-AR-REF-LVL                        VALUE '1'.
  7494         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7495         88  CO-AR-BILL-LVL                       VALUE '2'.
  7496         88  CO-AR-AGT-LVL                        VALUE '3'.
  7497         88  CO-AR-FR-LVL                         VALUE '4'.
  7498
  7499     12  CO-AR-NORMAL-PRINT                    PIC X.
  7500         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7501         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7502
  7503     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7504
  7505     12  CO-AR-REPORTING                       PIC X.
  7506         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7507         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7508
  7509     12  CO-AR-PULL-CHECK                      PIC X.
  7510         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7511         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7512
  7513     12  CO-AR-BALANCE-PRINT                   PIC X.
  7514         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7515
  7516     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7517         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7518         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7519         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7520
  7521     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7522
  7523     12  CO-USER-CODE                          PIC X.
  7524     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7525
  7526******************************************************************
  7527*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7528*    THE LAST MONTH END RUN.
  7529******************************************************************
  7530
  7531     12  CO-LAST-ACTIVITY-DATE.
  7532         16  CO-ACT-YEAR                       PIC 99.
  7533         16  CO-ACT-MONTH                      PIC 99.
  7534         16  CO-ACT-DAY                        PIC 99.
  7535
  7536     12  CO-LAST-STMT-DT.
  7537         16  CO-LAST-STMT-YEAR                 PIC 99.
  7538         16  CO-LAST-STMT-MONTH                PIC 99.
  7539         16  CO-LAST-STMT-DAY                  PIC 99.
  7540
  7541     12  CO-MO-END-TOTALS.
  7542         16  CO-MONTHLY-TOTALS.
  7543             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7544             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7545             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7546             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7547             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 141
* EL156.cbl
  7548
  7549         16  CO-AGING-TOTALS.
  7550             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7551             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7552             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7553             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7554
  7555         16  CO-YTD-TOTALS.
  7556             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7557             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7558
  7559         16  CO-OVER-UNDER-TOTALS.
  7560             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7561             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7562
  7563     12  CO-MISCELLANEOUS-TOTALS.
  7564         16  CO-FICA-TOTALS.
  7565             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7566             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7567
  7568         16  CO-CLAIM-TOTALS.
  7569             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7570             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7571
  7572******************************************************************
  7573*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7574*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7575******************************************************************
  7576
  7577     12  CO-CURRENT-TOTALS.
  7578         16  CO-CURRENT-LAST-STMT-DT.
  7579             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7580             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7581             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7582
  7583         16  CO-CURRENT-MONTHLY-TOTALS.
  7584             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7585             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7586             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7587             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7588             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7589
  7590         16  CO-CURRENT-AGING-TOTALS.
  7591             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7592             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7593             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7594             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7595
  7596         16  CO-CURRENT-YTD-TOTALS.
  7597             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7598             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7599
  7600     12  CO-PAID-COMM-TOTALS.
  7601         16  CO-YTD-PAID-COMMS.
  7602             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7603             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7604
  7605     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 142
* EL156.cbl
  7606         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7607         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7608
  7609     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7610         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7611         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7612         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7613         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7614         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7615         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7616         88  CO-FINAL-LETTER                  VALUE 'F'.
  7617         88  CO-RECONCILING                   VALUE 'R'.
  7618         88  CO-PHONE-CALL                    VALUE 'P'.
  7619         88  CO-LEGAL                         VALUE 'L'.
  7620         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7621         88  CO-WRITE-OFF                     VALUE 'W'.
  7622         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7623
  7624     12  CO-CSR-CODE                       PIC X(4).
  7625
  7626     12  CO-GA-STATUS-INFO.
  7627         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7628         16  CO-GA-TERMINATION-DT          PIC XX.
  7629         16  CO-GA-STATUS-CODE             PIC X.
  7630             88  CO-GA-ACTIVE                 VALUE 'A'.
  7631             88  CO-GA-INACTIVE               VALUE 'I'.
  7632             88  CO-GA-PENDING                VALUE 'P'.
  7633         16  CO-GA-COMMENTS.
  7634             20  CO-GA-COMMENT-1           PIC X(40).
  7635             20  CO-GA-COMMENT-2           PIC X(40).
  7636             20  CO-GA-COMMENT-3           PIC X(40).
  7637             20  CO-GA-COMMENT-4           PIC X(40).
  7638
  7639     12  CO-RPTCD2                         PIC X(10).
  7640     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7641         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7642         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7643
  7644     12  CO-TYPE-AGENT                     PIC X(01).
  7645         88  CO-CORPORATION                   VALUE 'C'.
  7646         88  CO-PARTNERSHIP                   VALUE 'P'.
  7647         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7648         88  CO-TRUST                         VALUE 'T'.
  7649         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7650
  7651     12  CO-FAXNO.
  7652         16  CO-FAX-AREA-CODE                  PIC XXX.
  7653         16  CO-FAX-PREFIX                     PIC XXX.
  7654         16  CO-FAX-PHONE                      PIC X(4).
  7655
  7656     12  CO-BANK-INFORMATION.
  7657         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7658         16  CO-BANK-TRANSIT-NON REDEFINES
  7659             CO-BANK-TRANSIT-NO                PIC 9(8).
  7660
  7661         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7662     12  CO-MISC-DEDUCT-INFO REDEFINES
  7663                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 143
* EL156.cbl
  7664         16  CO-MD-GL-ACCT                     PIC X(10).
  7665         16  CO-MD-DIV                         PIC XX.
  7666         16  CO-MD-CENTER                      PIC X(4).
  7667         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7668         16  CO-CREATE-AP-CHECK                PIC X.
  7669         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7670         16  FILLER                            PIC XXX.
  7671     12  CO-ACH-STATUS                         PIC X.
  7672         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7673         88  CO-ACH-PENDING                        VALUE 'P'.
  7674
  7675     12  CO-BILL-SW                            PIC X.
  7676     12  CO-CONTROL-NAME                       PIC X(30).
  7677     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7678     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7679     12  CO-CLP-STATE                          PIC XX.
  7680     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7681     12  CO-SPP-REFUND-EDIT                    PIC X.
  7682
  7683******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 144
* EL156.cbl
  7685*    COPY ERCDMDNT.
  7686******************************************************************
  7687*                                                                *
  7688*                            ERCDMDNT                            *
  7689*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7690*                            VMOD=2.005                          *
  7691*                                                                *
  7692*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7693*                                                                *
  7694*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7695*                                                                *
  7696*        FILE TYPE= VSAM,KSDS                                    *
  7697*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7698*                                                                *
  7699*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7700*                                                                *
  7701*        LOG = YES                                               *
  7702*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7703*                                                                *
  7704******************************************************************
  7705
  7706 01  CERTIFICATE-NOTE.
  7707     12  CN-RECORD-ID                     PIC  XX.
  7708         88  VALID-CN-ID                      VALUE 'CN'.
  7709
  7710     12  CN-CONTROL-PRIMARY.
  7711         16  CN-COMPANY-CD                PIC X.
  7712         16  CN-CERT-KEY.
  7713             20  CN-CARRIER               PIC X.
  7714             20  CN-GROUPING.
  7715                 24  CN-GROUPING-PREFIX   PIC XXX.
  7716                 24  CN-GROUPING-PRIME    PIC XXX.
  7717             20  CN-STATE                 PIC XX.
  7718             20  CN-ACCOUNT.
  7719                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7720                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7721             20  CN-CERT-EFF-DT           PIC XX.
  7722             20  CN-CERT-NO.
  7723                 24  CN-CERT-PRIME        PIC X(10).
  7724                 24  CN-CERT-SFX          PIC X.
  7725
  7726     12  CN-BILLING-START-LINE-NO         PIC 99.
  7727     12  CN-BILLING-END-LINE-NO           PIC 99.
  7728
  7729     12  CN-LINES.
  7730         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7731
  7732     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7733         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7734         16  CN-CSI-GENERAL-DATA-AREA.
  7735             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7736
  7737         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7738             CN-CSI-GENERAL-DATA-AREA.
  7739             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7740             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7741             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7742             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 145
* EL156.cbl
  7743             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7744             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7745             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7746             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7747             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7748             20  FILLER                       PIC XX.
  7749             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7750             20  FILLER                       PIC X(38).
  7751
  7752         16  CN-CSI-PRODUCT-DATA-AREA.
  7753             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7754
  7755         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7756             CN-CSI-PRODUCT-DATA-AREA.
  7757             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7758             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7759             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7760             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7761             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7762             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7763             20  FILLER                   PIC XX.
  7764             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7765             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7766             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7767             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7768             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7769             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7770             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7771             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7772             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7773             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7774             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7775             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7776             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7777             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7778             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7779             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7780             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7781             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7782             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7783             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7784             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7785             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7786             20  FILLER                   PIC X(25).
  7787
  7788         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7789             CN-CSI-CREDIT-CARD-DATA.
  7790             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7791             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7792             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7793             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7794             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7795             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7796             20  FILLER                   PIC XX.
  7797             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7798             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7799             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7800             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 146
* EL156.cbl
  7801             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7802             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7803             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7804             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7805             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7806             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7807             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7808             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7809             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7810             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7811             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7812             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7813             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7814             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7815             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7816             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7817             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7818             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7819             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7820             20  FILLER                   PIC X(17).
  7821
  7822         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7823             CN-CSI-FAMILY-LEAVE-DATA.
  7824             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7825             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7826             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7827             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7828             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7829             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7830             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7831             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7832             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7833             20  CN-CSI-SL-INT-ON-PROCEEDS
  7834                                          PIC S9(5)V99  COMP-3.
  7835             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7836             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7837             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7838             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7839             20  CN-CSI-SL-POLICY-BENEFITS
  7840                                          PIC S9(5)V99  COMP-3.
  7841             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7842             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7843             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7844             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7845             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7846             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7847             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7848             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7849             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7850             20  CN-CSI-SL-STATE-NOT      PIC X.
  7851             20  FILLER                   PIC XX.
  7852
  7853         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7854             CN-CSI-SENIOR-LIFE-DATA.
  7855             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7856             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7857             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7858                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 147
* EL156.cbl
  7859             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7860             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7861             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7862             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7863             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7864             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7865             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7866             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7867             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7868             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7869             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7870             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7871             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7872             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7873             20  CN-CSI-PP-REPAIR         PIC X.
  7874             20  CN-CSI-PP-REPLACE        PIC X.
  7875             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7876             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7877             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7878             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7879             20  FILLER                   PIC X(5).
  7880
  7881         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7882             CN-CSI-PURCH-PROP-DATA.
  7883             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7884             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7885             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7886             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7887             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7888             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7889             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7890             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7891             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7892             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7893             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7894             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7895             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7896             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7897             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7898             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7899             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7900             20  CN-CSI-EW-REPLACE        PIC X.
  7901             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7902             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7903             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7904             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7905             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7906             20  FILLER                   PIC X(4).
  7907
  7908     12  CN-LAST-MAINT-DT                 PIC XX.
  7909     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7910     12  CN-LAST-MAINT-USER               PIC X(4).
  7911     12  FILLER                           PIC X(6).
  7912
  7913******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 148
* EL156.cbl
  7915*    COPY ERCCNOT.
  7916******************************************************************
  7917*                                                                *
  7918*                            ERCCNOT                             *
  7919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7920*                            VMOD=2.003                          *
  7921*                                                                *
  7922*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7923*                                                                *
  7924*        FILE TYPE= VSAM,KSDS                                    *
  7925*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7926*                                                                *
  7927*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7928*                                                                *
  7929*        LOG = YES                                               *
  7930*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7931*                                                                *
  7932******************************************************************
  7933*                   C H A N G E   L O G
  7934*
  7935* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7936*-----------------------------------------------------------------
  7937*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7938* EFFECTIVE    NUMBER
  7939*-----------------------------------------------------------------
  7940* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7941******************************************************************
  7942
  7943 01  CERT-NOTE-FILE.
  7944     12  CZ-RECORD-ID                PIC  XX.
  7945         88  VALID-CZ-ID                  VALUE 'CZ'.
  7946
  7947     12  CZ-CONTROL-PRIMARY.
  7948         16  CZ-COMPANY-CD           PIC X.
  7949         16  CZ-CARRIER              PIC X.
  7950         16  CZ-GROUPING.
  7951             20 CZ-GROUPING-PREFIX   PIC XXX.
  7952             20 CZ-GROUPING-PRIME    PIC XXX.
  7953         16  CZ-STATE                PIC XX.
  7954         16  CZ-ACCOUNT.
  7955             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7956             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7957         16  CZ-CERT-EFF-DT          PIC XX.
  7958         16  CZ-CERT-NO.
  7959             20  CZ-CERT-PRIME       PIC X(10).
  7960             20  CZ-CERT-SFX         PIC X.
  7961         16  CZ-RECORD-TYPE          PIC X.
  7962             88  CERT-NOTE           VALUE '1'.
  7963             88  CLAIM-CERT-NOTE     VALUE '2'.
  7964         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7965
  7966     12  CZ-LAST-MAINT-DT            PIC XX.
  7967     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7968     12  CZ-LAST-MAINT-USER          PIC X(4).
  7969
  7970     12  CZ-NOTE-INFORMATION.
  7971         16  CZ-NOTE                 PIC X(63).
  7972         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 149
* EL156.cbl
  7973******************************************************************
  7974*                            COPY ERCPDEF.
  7975******************************************************************
  7976*                                                                *
  7977*                                                                *
  7978*                            ERCPDEF.                            *
  7979*                                                                *
  7980*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7981*                                                                *
  7982*    FILE TYPE = VSAM,KSDS                                       *
  7983*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7984*                                                                *
  7985*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7986*                                                                *
  7987*    LOG = YES                                                   *
  7988*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7989******************************************************************
  7990*                   C H A N G E   L O G
  7991*
  7992* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7993*-----------------------------------------------------------------
  7994*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7995* EFFECTIVE    NUMBER
  7996*-----------------------------------------------------------------
  7997* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7998* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7999* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8000******************************************************************
  8001 01  PRODUCT-MASTER.
  8002    12  PD-RECORD-ID                 PIC X(02).
  8003        88  VALID-PD-ID                  VALUE 'PD'.
  8004    12  PD-CONTROL-PRIMARY.
  8005        16  PD-COMPANY-CD            PIC X.
  8006        16  PD-STATE                 PIC XX.
  8007        16  PD-PRODUCT-CD            PIC XXX.
  8008        16  PD-FILLER                PIC X(7).
  8009        16  PD-BEN-TYPE              PIC X.
  8010        16  PD-BEN-CODE              PIC XX.
  8011        16  PD-PROD-EXP-DT           PIC XX.
  8012    12  FILLER                       PIC X(50).
  8013    12  PD-PRODUCT-DATA OCCURS 8.
  8014        16  PD-PROD-CODE             PIC X.
  8015            88  PD-PROD-LIFE           VALUE 'L'.
  8016            88  PD-PROD-PROP           VALUE 'P'.
  8017            88  PD-PROD-AH             VALUE 'A'.
  8018            88  PD-PROD-IU             VALUE 'I'.
  8019            88  PD-PROD-GAP            VALUE 'G'.
  8020            88  PD-PROD-FAML           VALUE 'F'.
  8021        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8022        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8023        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8024        16  PD-MAX-TERM              PIC S999        COMP-3.
  8025        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8026        16  FILLER                   PIC X.
  8027        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8028        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8029        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8030        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 150
* EL156.cbl
  8031        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8032        16  PD-REC-CRIT-PERIOD       PIC 99.
  8033        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8034            20  PD-RECURRING-YN      PIC X.
  8035            20  FILLER               PIC X.
  8036        16  PD-RTW-MOS               PIC 99.
  8037        16  PD-MAX-EXTENSION         PIC 99.
  8038        16  pd-ben-pct               pic sv999 comp-3.
  8039*       16  FILLER                   PIC XX.
  8040    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8041    12  PD-TERM-LIMITS OCCURS 15.
  8042        16  PD-LOW-TERM              PIC S999        COMP-3.
  8043        16  PD-HI-TERM               PIC S999        COMP-3.
  8044*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8045    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8046        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8047        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8048    12  PD-EARN-FACTORS.
  8049        16  FILLER OCCURS 15.
  8050            20  FILLER OCCURS 15.
  8051                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8052    12  PD-PRODUCT-DESC              PIC X(80).
  8053    12  PD-TRUNCATED                 PIC X.
  8054    12  FILLER                       PIC X(59).
  8055    12  PD-MAINT-INFORMATION.
  8056        16  PD-LAST-MAINT-DT         PIC X(02).
  8057        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8058        16  PD-LAST-MAINT-BY         PIC X(04).
  8059*                            COPY ELCCRTT.
  8060******************************************************************
  8061*                                                                *
  8062*                            ELCCRTT.                            *
  8063*                                                                *
  8064*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8065*                                                                *
  8066*   FILE TYPE = VSAM,KSDS                                        *
  8067*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8068*                                                                *
  8069*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8070*                                                                *
  8071*   LOG = YES                                                    *
  8072*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8073******************************************************************
  8074*                   C H A N G E   L O G
  8075*
  8076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8077*-----------------------------------------------------------------
  8078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8079* EFFECTIVE    NUMBER
  8080*-----------------------------------------------------------------
  8081* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8082* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8083* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8084* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8085* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8086* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8087* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8088* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 151
* EL156.cbl
  8089* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8090******************************************************************
  8091
  8092 01  CERTIFICATE-TRAILERS.
  8093     12  CS-RECORD-ID                      PIC XX.
  8094         88  VALID-CS-ID                      VALUE 'CS'.
  8095
  8096     12  CS-CONTROL-PRIMARY.
  8097         16  CS-COMPANY-CD                 PIC X.
  8098         16  CS-CARRIER                    PIC X.
  8099         16  CS-GROUPING                   PIC X(6).
  8100         16  CS-STATE                      PIC XX.
  8101         16  CS-ACCOUNT                    PIC X(10).
  8102         16  CS-CERT-EFF-DT                PIC XX.
  8103         16  CS-CERT-NO.
  8104             20  CS-CERT-PRIME             PIC X(10).
  8105             20  CS-CERT-SFX               PIC X.
  8106         16  CS-TRAILER-TYPE               PIC X.
  8107             88  COMM-TRLR           VALUE 'A'.
  8108             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8109             88  CERT-DATA-TRLR      VALUE 'C'.
  8110
  8111     12  CS-DATA-AREA                      PIC X(516).
  8112
  8113     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8114         16  CS-BANK-COMMISSION-AREA.
  8115             20  CS-BANK-COMMS       OCCURS 10.
  8116                 24  CS-AGT                PIC X(10).
  8117                 24  CS-COM-TYP            PIC X.
  8118                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8119                 24  CS-RECALC-LV-INDIC    PIC X.
  8120                 24  FILLER                PIC X(10).
  8121         16  FILLER                        PIC X(256).
  8122
  8123     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8124****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8125         16  CS-MB-CLAIM-DATA OCCURS 24.
  8126             20  CS-CLAIM-NO               PIC X(7).
  8127             20  CS-CLAIM-TYPE             PIC X.
  8128                 88  CS-AH-CLM               VALUE 'A'.
  8129                 88  CS-IU-CLM               VALUE 'I'.
  8130                 88  CS-GP-CLM               VALUE 'G'.
  8131                 88  CS-LF-CLM               VALUE 'L'.
  8132                 88  CS-PR-CLM               VALUE 'P'.
  8133                 88  CS-FL-CLM               VALUE 'F'.
  8134             20  CS-INSURED-TYPE           PIC X.
  8135                 88  CS-PRIM-INSURED          VALUE 'P'.
  8136                 88  CS-CO-BORROWER           VALUE 'C'.
  8137             20  CS-BENEFIT-PERIOD         PIC 99.
  8138             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8139             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8140             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8141         16  FILLER                        PIC X(12).
  8142     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8143         16  CS-VIN-NUMBER                 PIC X(17).
  8144         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8145         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8146         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 152
* EL156.cbl
  8147         16  cs-agent-name.
  8148             20  cs-agent-fname            pic x(20).
  8149             20  cs-agent-mi               pic x.
  8150             20  cs-agent-lname            pic x(25).
  8151         16  cs-license-no                 pic x(15).
  8152         16  cs-npn-number                 pic x(10).
  8153         16  cs-agent-edit-status          pic x.
  8154             88  cs-ae-refer-to-manager      value 'M'.
  8155             88  cs-ae-cover-sheet           value 'C'.
  8156             88  cs-ae-sig-form              value 'S'.
  8157             88  cs-ae-verified              value 'V'.
  8158             88  cs-unidentified-signature   value 'U'.
  8159             88  cs-cert-returned            value 'R'.
  8160             88  cs-accept-no-commission     value 'N'.
  8161         16  cs-year                       pic 9999.
  8162         16  cs-make                       pic x(20).
  8163         16  cs-model                      pic x(20).
  8164         16  cs-future                     pic x(20).
  8165         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8166         16  FILLER                        PIC X(356). *> was 420
  8167*        16  FILLER                        PIC X(496).
  8168 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8169                          CONTROL-FILE CERTIFICATE-MASTER
  8170                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8171                          ACCOUNT-MASTER CHECK-QUE
  8172                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8173                          DAILY-ACTIVITY-RECORD
  8174                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8175                          CERT-NOTE-FILE PRODUCT-MASTER
  8176                          CERTIFICATE-TRAILERS.
  8177 0000-DFHEXIT SECTION.
  8178     MOVE '9#                    $   ' TO DFHEIV0.
  8179     MOVE 'EL156' TO DFHEIV1.
  8180     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8181
  8182     IF EIBCALEN = 0
  8183         GO TO 8800-UNAUTHORIZED-ACCESS.
  8184
  8185     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8186     MOVE EIBTRMID               TO QID-TERM.
  8187     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8188     MOVE '2'                    TO EMI-SWITCH2.
  8189     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8190     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8191
  8192     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8193     MOVE '5'                    TO DC-OPTION-CODE.
  8194     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8195     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8196                                    SAVE-BIN-DATE.
  8197     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8198     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8199
  8200     IF SAVE-DATE-YY > 70
  8201         MOVE 19                 TO SAVE-DATE-CC
  8202     ELSE
  8203         MOVE 20                 TO SAVE-DATE-CC.
  8204
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 153
* EL156.cbl
  8205     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8206         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8207     END-IF.
  8208
  8209     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8210        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8211     ELSE
  8212        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8213     END-IF
  8214
  8215     IF PI-PRINT-CLM-FRM-YN = 'N'
  8216         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8217     ELSE
  8218         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8219     END-IF
  8220
  8221     IF PI-PRINT-SURVEY-YN = 'N'
  8222         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8223     ELSE
  8224         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8225     END-IF
  8226
  8227     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8228         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8229     ELSE
  8230         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8231     END-IF
  8232
  8233* EXEC CICS HANDLE CONDITION
  8234*        NOTOPEN   (9990-ABEND)
  8235*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8236*        MAPFAIL   (0400-FIRST-TIME)
  8237*        DUPREC    (6180-DUPREC)
  8238*        ERROR     (9990-ABEND)
  8239*    END-EXEC.
  8240*    MOVE '"$JL?%.               ! " #00008228' TO DFHEIV0
  8241     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8243     MOVE X'2220233030303038323238' TO DFHEIV0(25:11)
  8244     CALL 'kxdfhei1' USING DFHEIV0
  8245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8246
  8247
  8248     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8249         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8250
  8251     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8252         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8253             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8254             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8255             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8256             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8257             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8258             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8259             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8260             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8261             MOVE LOW-VALUES           TO EL156AI
  8262             MOVE 'Y'                  TO FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 154
* EL156.cbl
  8263         ELSE
  8264             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8265             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8266             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8267             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8268             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8269             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8270             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8271             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8272
  8273     IF RETURNED-FROM NOT = SPACES
  8274        IF (RETURNED-FROM = 'EL614')
  8275           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8276           IF WS-SAVED-EOB-CODES NOT = SPACES
  8277              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8278           ELSE
  8279              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8280           END-IF
  8281        END-IF
  8282         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8283            MOVE 'Y'             TO FIRST-ENTRY
  8284            IF RETURNED-FROM = 'EL614'
  8285               AND (PI-PASS-SW NOT = 'C')
  8286               IF WS-SAVED-EOB-CODES NOT = SPACES
  8287                  MOVE WS-SAVED-EOB-CODES
  8288                                 TO PI-PMTNOTE2
  8289                                    WS-PMTNOTE2
  8290                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8291               ELSE
  8292                  MOVE SPACES    TO PI-PMTNOTE2
  8293                                    WS-PMTNOTE2
  8294                                    PI-EOB-CODES-EXIST
  8295               END-IF
  8296            END-IF
  8297            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8298            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8299            IF RETURNED-FROM = 'EL614'
  8300               GO TO 1000-EDIT-DATA
  8301            END-IF
  8302            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8303               (PAYEEI   = LOW-VALUES OR SPACES)
  8304               GO TO 8100-SEND-INITIAL-MAP
  8305            ELSE
  8306               GO TO 1000-EDIT-DATA.
  8307
  8308     IF EIBTRNID NOT = TRANS-ID
  8309         GO TO 0400-FIRST-TIME.
  8310
  8311     IF EIBAID = DFHCLEAR
  8312        IF PI-PASS-SW = 'C'
  8313           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8314           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8315           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8316           MOVE 'Y'            TO RETURNED-FROM-B
  8317           GO TO 1000-EDIT-DATA
  8318        ELSE
  8319           GO TO 9400-CLEAR.
  8320
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 155
* EL156.cbl
  8321     IF PI-PASS-SW = 'C'
  8322         MOVE MAP-NAMEB          TO MAP-NAME
  8323         IF EIBAID = DFHPF1 OR DFHPF13
  8324             GO TO 5000-UPDATE
  8325           ELSE
  8326             IF EIBAID NOT = DFHENTER
  8327                 MOVE LOW-VALUES TO EL156BI
  8328                 MOVE MAP-NAMEB  TO MAP-NAME
  8329                 MOVE ER-0029    TO EMI-ERROR
  8330                 MOVE -1         TO  ENTPFBL
  8331                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8332                 GO TO 8200-SEND-DATAONLY.
  8333
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 156
* EL156.cbl
  8335 0200-RECEIVE.
  8336     MOVE LOW-VALUES             TO EL156AI.
  8337     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8338         MOVE ER-0008            TO EMI-ERROR
  8339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8340         IF PI-PASS-SW = 'C'
  8341             MOVE -1             TO ENTPFBL
  8342             GO TO 8200-SEND-DATAONLY
  8343         ELSE
  8344             MOVE -1             TO PMTTYPEL
  8345             GO TO 8200-SEND-DATAONLY.
  8346
  8347     IF PI-COMPANY-ID = 'DMD'
  8348         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8349
  8350     IF PI-PASS-SW = 'C'
  8351         MOVE MAP-NAMEB          TO MAP-NAME.
  8352
  8353
  8354* EXEC CICS RECEIVE
  8355*        MAP   (MAP-NAME)
  8356*        MAPSET(MAPSET-NAME)
  8357*        ASIS
  8358*        INTO  (EL156AI)
  8359*    END-EXEC.
  8360     MOVE LENGTH OF
  8361      EL156AI
  8362       TO DFHEIV11
  8363*    MOVE '8"TAI  L              ''   #00008341' TO DFHEIV0
  8364     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8365     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8366     MOVE X'2020233030303038333431' TO DFHEIV0(25:11)
  8367     CALL 'kxdfhei1' USING DFHEIV0,
  8368           MAP-NAME,
  8369           EL156AI,
  8370           DFHEIV11,
  8371           MAPSET-NAME,
  8372           DFHEIV99,
  8373           DFHEIV99
  8374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8375
  8376
  8377     IF PI-PASS-SW NOT = 'C'
  8378         GO TO 0250-MAPA.
  8379
  8380     IF ENTPFBL NOT > ZERO
  8381         MOVE MAP-NAMEB          TO MAP-NAME
  8382         MOVE ER-0029            TO EMI-ERROR
  8383         MOVE -1                 TO  ENTPFBL
  8384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8385         GO TO 8200-SEND-DATAONLY.
  8386
  8387     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8388         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8389       ELSE
  8390         MOVE MAP-NAMEB           TO MAP-NAME
  8391         MOVE ER-0029             TO EMI-ERROR
  8392         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 157
* EL156.cbl
  8393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8394         GO TO 8200-SEND-DATAONLY.
  8395
  8396     IF EIBAID = DFHPF1 OR DFHPF13
  8397         IF MODIFY-CAP
  8398            GO TO 5000-UPDATE
  8399          ELSE
  8400            MOVE 'UPDATE'           TO SM-READ
  8401            PERFORM 9995-SECURITY-VIOLATION
  8402            MOVE MAP-NAMEB          TO MAP-NAME
  8403            MOVE ER-0070            TO EMI-ERROR
  8404            MOVE -1                 TO  ENTPFBL
  8405            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8406            GO TO 8200-SEND-DATAONLY.
  8407
  8408 0250-MAPA.
  8409     IF ENTERPFL = 0
  8410         GO TO 0300-CHECK-PFKEYS.
  8411
  8412     IF EIBAID NOT = DFHENTER
  8413         MOVE ER-0004            TO EMI-ERROR
  8414         GO TO 0320-INPUT-ERROR.
  8415
  8416     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8417         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8418     ELSE
  8419         MOVE ER-0029            TO EMI-ERROR
  8420         GO TO 0320-INPUT-ERROR.
  8421
  8422 0300-CHECK-PFKEYS.
  8423     IF EIBAID = DFHPF7 OR DFHPF8
  8424         GO TO 8820-PF7-8.
  8425
  8426     IF EIBAID = DFHPF23
  8427         GO TO 8810-PF23.
  8428
  8429     IF EIBAID = DFHPF24
  8430         GO TO 9200-RETURN-MAIN-MENU.
  8431
  8432     IF EIBAID = DFHPF12
  8433         GO TO 9500-PF12.
  8434
  8435     IF EIBAID = DFHPF1
  8436        IF PI-PASS-SW = 'A' OR 'B'
  8437          GO TO 0330-BROWSE-FORWARD.
  8438
  8439     IF EIBAID = DFHPF2
  8440        IF PI-PASS-SW = 'A' OR 'B'
  8441          GO TO 0350-BROWSE-BACKWARD.
  8442
  8443     IF EIBAID = DFHPF6
  8444        IF PI-EOB-CODES-EXIST = 'Y'
  8445           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8446        ELSE
  8447           MOVE SPACES              TO WS-PMTNOTE2
  8448        END-IF
  8449         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8450         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 158
* EL156.cbl
  8451            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8452         END-IF
  8453         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8454         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  8455             MOVE 'EL614'        TO PGM-NAME
  8456             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8457             GO TO 9300-XCTL
  8458         ELSE
  8459             MOVE XCTL-157       TO PGM-NAME
  8460             GO TO 9300-XCTL.
  8461
  8462     IF EIBAID = DFHPF9
  8463        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8464        MOVE XCTL-141            TO PGM-NAME
  8465        GO TO 9300-XCTL.
  8466
  8467     IF EIBAID = DFHPF10
  8468        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8469        MOVE XCTL-155            TO PGM-NAME
  8470        GO TO 9300-XCTL.
  8471
  8472     MOVE SPACES                 TO ERRMSG0O
  8473                                    ERRMSG1O
  8474                                    ERRMSG2O.
  8475
  8476     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8477         IF PI-PASS-SW NOT = 'B'
  8478             MOVE ER-0422        TO EMI-ERROR
  8479             GO TO 0320-INPUT-ERROR
  8480           ELSE
  8481             GO TO 0700-TEST-FOR-CHANGES.
  8482
  8483     IF EIBAID = DFHPF11
  8484        IF PI-PASS-SW = 'C'
  8485           MOVE ER-0029          TO EMI-ERROR
  8486           GO TO 0320-INPUT-ERROR.
  8487
  8488     IF EIBAID = DFHENTER OR DFHPF11
  8489        NEXT SENTENCE
  8490     ELSE
  8491        MOVE ER-0029             TO EMI-ERROR
  8492        GO TO 0320-INPUT-ERROR.
  8493
  8494     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8495
  8496     if pi-epyfrom not = zeros
  8497        if pi-epyfrom not = ws-epyfrom
  8498           move zeros        to ws-edays
  8499        end-if
  8500     end-if
  8501
  8502     if pi-epythru not = zeros
  8503        if pi-epythru not = ws-epythru
  8504           move zeros        to ws-edays
  8505        end-if
  8506     end-if
  8507
  8508     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 159
* EL156.cbl
  8509         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8510         GO TO 1000-EDIT-DATA
  8511     ELSE
  8512         IF PI-FATAL-COUNT NOT = 0 OR
  8513            PI-FORCE-COUNT NOT = 0
  8514             GO TO 1000-EDIT-DATA
  8515         ELSE
  8516             GO TO 2000-EDIT-DONE.
  8517
  8518 0320-INPUT-ERROR.
  8519     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8520
  8521     IF ENTERPFL = 0
  8522         MOVE -1                 TO PMTTYPEL
  8523     ELSE
  8524         MOVE AL-UNBON           TO ENTERPFA
  8525         MOVE -1                 TO ENTERPFL.
  8526
  8527     GO TO 8200-SEND-DATAONLY.
  8528
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 160
* EL156.cbl
  8530 0330-BROWSE-FORWARD.
  8531
  8532     MOVE CLMNOI            TO PI-CLAIM-NO.
  8533     MOVE CARRI             TO PI-CARRIER.
  8534     MOVE CERTNOI           TO PI-CERT-PRIME.
  8535     MOVE SUFXI             TO PI-CERT-SFX.
  8536
  8537     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8538     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8539     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8540     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8541
  8542     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8543
  8544
  8545* EXEC CICS HANDLE CONDITION
  8546*         NOTFND   (0380-CLAIM-END-FILE)
  8547*         ENDFILE  (0380-CLAIM-END-FILE)
  8548*    END-EXEC.
  8549*    MOVE '"$I''                  ! # #00008515' TO DFHEIV0
  8550     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8552     MOVE X'2320233030303038353135' TO DFHEIV0(25:11)
  8553     CALL 'kxdfhei1' USING DFHEIV0
  8554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8555
  8556
  8557
  8558* EXEC CICS STARTBR
  8559*         DATASET    ('ELMSTR')
  8560*         RIDFLD     (ELMSTR-KEY)
  8561*         GTEQ
  8562*    END-EXEC.
  8563     MOVE 'ELMSTR' TO DFHEIV1
  8564     MOVE 0
  8565       TO DFHEIV11
  8566*    MOVE '&,         G          &   #00008520' TO DFHEIV0
  8567     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8568     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8569     MOVE X'2020233030303038353230' TO DFHEIV0(25:11)
  8570     CALL 'kxdfhei1' USING DFHEIV0,
  8571           DFHEIV1,
  8572           ELMSTR-KEY,
  8573           DFHEIV99,
  8574           DFHEIV11,
  8575           DFHEIV99
  8576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8577
  8578
  8579     MOVE 'Y' TO WS-BROWSE-START-SW.
  8580
  8581 0335-READNEXT.
  8582
  8583
  8584* EXEC CICS READNEXT
  8585*         DATASET    ('ELMSTR')
  8586*         RIDFLD     (ELMSTR-KEY)
  8587*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 161
* EL156.cbl
  8588*    END-EXEC.
  8589     MOVE 'ELMSTR' TO DFHEIV1
  8590     MOVE 0
  8591       TO DFHEIV11
  8592*    MOVE '&.S                   )   #00008530' TO DFHEIV0
  8593     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8594     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8595     MOVE X'2020233030303038353330' TO DFHEIV0(25:11)
  8596     CALL 'kxdfhei1' USING DFHEIV0,
  8597           DFHEIV1,
  8598           DFHEIV20,
  8599           DFHEIV99,
  8600           ELMSTR-KEY,
  8601           DFHEIV99,
  8602           DFHEIV11,
  8603           DFHEIV99,
  8604           DFHEIV99
  8605     SET ADDRESS OF CLAIM-MASTER TO
  8606         DFHEIV20
  8607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8608
  8609
  8610     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8611        GO TO 0380-CLAIM-END-FILE.
  8612
  8613     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8614        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8615        GO TO 0335-READNEXT.
  8616
  8617     IF PI-COMPANY-ID = 'CRI'
  8618         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8619            GO TO 0380-CLAIM-END-FILE.
  8620
  8621     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8622         GO TO 0335-READNEXT.
  8623
  8624     IF PI-CARRIER-SECURITY > SPACES
  8625         IF CL-CARRIER = PI-CARRIER-SECURITY
  8626             NEXT SENTENCE
  8627         ELSE
  8628             GO TO 0335-READNEXT.
  8629
  8630     IF PI-ACCOUNT-SECURITY > SPACES
  8631         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8632             NEXT SENTENCE
  8633         ELSE
  8634             GO TO 0335-READNEXT.
  8635
  8636     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8637     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8638     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8639
  8640     GO TO 0400-FIRST-TIME.
  8641
  8642 0350-BROWSE-BACKWARD.
  8643
  8644     MOVE CLMNOI            TO PI-CLAIM-NO
  8645                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 162
* EL156.cbl
  8646     MOVE CARRI             TO PI-CARRIER.
  8647     MOVE CERTNOI           TO PI-CERT-PRIME.
  8648     MOVE SUFXI             TO PI-CERT-SFX.
  8649
  8650     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8651
  8652     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8653     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8654     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8655
  8656
  8657* EXEC CICS HANDLE CONDITION
  8658*         NOTFND   (0380-CLAIM-END-FILE)
  8659*         ENDFILE  (0380-CLAIM-END-FILE)
  8660*    END-EXEC.
  8661*    MOVE '"$I''                  ! $ #00008582' TO DFHEIV0
  8662     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8664     MOVE X'2420233030303038353832' TO DFHEIV0(25:11)
  8665     CALL 'kxdfhei1' USING DFHEIV0
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669
  8670* EXEC CICS STARTBR
  8671*         DATASET    ('ELMSTR')
  8672*         RIDFLD     (ELMSTR-KEY)
  8673*         GTEQ
  8674*    END-EXEC.
  8675     MOVE 'ELMSTR' TO DFHEIV1
  8676     MOVE 0
  8677       TO DFHEIV11
  8678*    MOVE '&,         G          &   #00008587' TO DFHEIV0
  8679     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8680     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8681     MOVE X'2020233030303038353837' TO DFHEIV0(25:11)
  8682     CALL 'kxdfhei1' USING DFHEIV0,
  8683           DFHEIV1,
  8684           ELMSTR-KEY,
  8685           DFHEIV99,
  8686           DFHEIV11,
  8687           DFHEIV99
  8688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8689
  8690
  8691     MOVE 'Y' TO WS-BROWSE-START-SW.
  8692
  8693
  8694* EXEC CICS READNEXT
  8695*         DATASET    ('ELMSTR')
  8696*         RIDFLD     (ELMSTR-KEY)
  8697*         SET        (ADDRESS OF CLAIM-MASTER)
  8698*    END-EXEC.
  8699     MOVE 'ELMSTR' TO DFHEIV1
  8700     MOVE 0
  8701       TO DFHEIV11
  8702*    MOVE '&.S                   )   #00008595' TO DFHEIV0
  8703     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 163
* EL156.cbl
  8704     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8705     MOVE X'2020233030303038353935' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
  8707           DFHEIV1,
  8708           DFHEIV20,
  8709           DFHEIV99,
  8710           ELMSTR-KEY,
  8711           DFHEIV99,
  8712           DFHEIV11,
  8713           DFHEIV99,
  8714           DFHEIV99
  8715     SET ADDRESS OF CLAIM-MASTER TO
  8716         DFHEIV20
  8717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8718
  8719
  8720
  8721* EXEC CICS READPREV
  8722*         DATASET    ('ELMSTR')
  8723*         RIDFLD     (ELMSTR-KEY)
  8724*         SET        (ADDRESS OF CLAIM-MASTER)
  8725*    END-EXEC.
  8726     MOVE 'ELMSTR' TO DFHEIV1
  8727     MOVE 0
  8728       TO DFHEIV11
  8729*    MOVE '&0S                   )   #00008601' TO DFHEIV0
  8730     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8732     MOVE X'2020233030303038363031' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0,
  8734           DFHEIV1,
  8735           DFHEIV20,
  8736           DFHEIV99,
  8737           ELMSTR-KEY,
  8738           DFHEIV99,
  8739           DFHEIV11,
  8740           DFHEIV99,
  8741           DFHEIV99
  8742     SET ADDRESS OF CLAIM-MASTER TO
  8743         DFHEIV20
  8744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8745
  8746
  8747 0360-BROWSE-BACKWARD.
  8748
  8749
  8750* EXEC CICS READPREV
  8751*         DATASET    ('ELMSTR')
  8752*         RIDFLD     (ELMSTR-KEY)
  8753*         SET        (ADDRESS OF CLAIM-MASTER)
  8754*    END-EXEC.
  8755     MOVE 'ELMSTR' TO DFHEIV1
  8756     MOVE 0
  8757       TO DFHEIV11
  8758*    MOVE '&0S                   )   #00008609' TO DFHEIV0
  8759     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8760     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8761     MOVE X'2020233030303038363039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 164
* EL156.cbl
  8762     CALL 'kxdfhei1' USING DFHEIV0,
  8763           DFHEIV1,
  8764           DFHEIV20,
  8765           DFHEIV99,
  8766           ELMSTR-KEY,
  8767           DFHEIV99,
  8768           DFHEIV11,
  8769           DFHEIV99,
  8770           DFHEIV99
  8771     SET ADDRESS OF CLAIM-MASTER TO
  8772         DFHEIV20
  8773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8774
  8775
  8776     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8777        GO TO 0380-CLAIM-END-FILE.
  8778
  8779     IF PI-COMPANY-ID = 'CRI'
  8780         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8781            GO TO 0380-CLAIM-END-FILE.
  8782
  8783     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8784         GO TO 0360-BROWSE-BACKWARD.
  8785
  8786     IF PI-CARRIER-SECURITY > SPACES
  8787         IF CL-CARRIER = PI-CARRIER-SECURITY
  8788             NEXT SENTENCE
  8789         ELSE
  8790             GO TO 0360-BROWSE-BACKWARD.
  8791
  8792     IF PI-ACCOUNT-SECURITY > SPACES
  8793         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8794             NEXT SENTENCE
  8795         ELSE
  8796             GO TO 0360-BROWSE-BACKWARD.
  8797
  8798     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8799     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8800     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8801
  8802     GO TO 0400-FIRST-TIME.
  8803
  8804 0380-CLAIM-END-FILE.
  8805
  8806     MOVE ER-0130     TO EMI-ERROR.
  8807     MOVE -1          TO CLMNOL.
  8808     MOVE AL-UABON    TO CARRA
  8809                         CLMNOA
  8810                         CERTNOA
  8811                         SUFXA.
  8812
  8813     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8814
  8815     GO TO 8200-SEND-DATAONLY.
  8816
  8817 0400-FIRST-TIME.
  8818
  8819     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 165
* EL156.cbl
  8820        MOVE 'N'         TO WS-BROWSE-START-SW
  8821
  8822* EXEC CICS ENDBR
  8823*            DATASET    ('ELMSTR')
  8824*       END-EXEC.
  8825     MOVE 'ELMSTR' TO DFHEIV1
  8826     MOVE 0
  8827       TO DFHEIV11
  8828*    MOVE '&2                    $   #00008660' TO DFHEIV0
  8829     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8830     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8831     MOVE X'2020233030303038363630' TO DFHEIV0(25:11)
  8832     CALL 'kxdfhei1' USING DFHEIV0,
  8833           DFHEIV1,
  8834           DFHEIV11,
  8835           DFHEIV99
  8836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8837
  8838
  8839     IF PI-PROCESSOR-ID = 'LGXX'
  8840         NEXT SENTENCE
  8841     ELSE
  8842
  8843* EXEC CICS READQ TS
  8844*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8845*            INTO    (SECURITY-CONTROL)
  8846*            LENGTH  (SC-COMM-LENGTH)
  8847*            ITEM    (SC-ITEM)
  8848*        END-EXEC
  8849*    MOVE '*$II   L              ''   #00008667' TO DFHEIV0
  8850     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8852     MOVE X'2020233030303038363637' TO DFHEIV0(25:11)
  8853     CALL 'kxdfhei1' USING DFHEIV0,
  8854           PI-SECURITY-TEMP-STORE-ID,
  8855           SECURITY-CONTROL,
  8856           SC-COMM-LENGTH,
  8857           SC-ITEM,
  8858           DFHEIV99,
  8859           DFHEIV99
  8860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8861         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8862         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8863
  8864     MOVE LOW-VALUES             TO EL156AI.
  8865     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8866     MOVE 'Y'                    TO FIRST-ENTRY.
  8867     GO TO 7000-SHOW-CLAIM.
  8868
  8869 0500-CREATE-TEMP-STORAGE.
  8870     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8871
  8872
  8873* EXEC CICS WRITEQ TS
  8874*        QUEUE (QID)
  8875*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8876*        LENGTH(PI-COMM-LENGTH)
  8877*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 166
* EL156.cbl
  8878*    MOVE '*"                    ''   #00008684' TO DFHEIV0
  8879     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8880     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8881     MOVE X'2020233030303038363834' TO DFHEIV0(25:11)
  8882     CALL 'kxdfhei1' USING DFHEIV0,
  8883           QID,
  8884           PROGRAM-INTERFACE-BLOCK,
  8885           PI-COMM-LENGTH,
  8886           DFHEIV99,
  8887           DFHEIV99,
  8888           DFHEIV99
  8889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8890
  8891
  8892
  8893* EXEC CICS WRITEQ TS
  8894*        QUEUE (QID)
  8895*        FROM  (EL156AI)
  8896*        LENGTH(MAP-LENGTH)
  8897*    END-EXEC.
  8898*    MOVE '*"                    ''   #00008690' TO DFHEIV0
  8899     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8900     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8901     MOVE X'2020233030303038363930' TO DFHEIV0(25:11)
  8902     CALL 'kxdfhei1' USING DFHEIV0,
  8903           QID,
  8904           EL156AI,
  8905           MAP-LENGTH,
  8906           DFHEIV99,
  8907           DFHEIV99,
  8908           DFHEIV99
  8909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8910
  8911
  8912 0599-EXIT.
  8913      EXIT.
  8914
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 167
* EL156.cbl
  8916 0600-RECOVER-TEMP-STORAGE.
  8917
  8918* EXEC CICS READQ TS
  8919*        QUEUE (QID)
  8920*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8921*        LENGTH(PI-COMM-LENGTH)
  8922*    END-EXEC.
  8923*    MOVE '*$I    L              ''   #00008701' TO DFHEIV0
  8924     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8926     MOVE X'2020233030303038373031' TO DFHEIV0(25:11)
  8927     CALL 'kxdfhei1' USING DFHEIV0,
  8928           QID,
  8929           PROGRAM-INTERFACE-BLOCK,
  8930           PI-COMM-LENGTH,
  8931           DFHEIV99,
  8932           DFHEIV99,
  8933           DFHEIV99
  8934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8935
  8936
  8937
  8938* EXEC CICS READQ TS
  8939*        QUEUE (QID)
  8940*        INTO  (EL156AI)
  8941*        LENGTH(MAP-LENGTH)
  8942*    END-EXEC.
  8943*    MOVE '*$I    L              ''   #00008707' TO DFHEIV0
  8944     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8945     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8946     MOVE X'2020233030303038373037' TO DFHEIV0(25:11)
  8947     CALL 'kxdfhei1' USING DFHEIV0,
  8948           QID,
  8949           EL156AI,
  8950           MAP-LENGTH,
  8951           DFHEIV99,
  8952           DFHEIV99,
  8953           DFHEIV99
  8954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8955
  8956
  8957     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8958
  8959     IF PMTTYPEI NOT = LOW-VALUES
  8960         MOVE AL-UANON           TO PMTTYPEA.
  8961
  8962     IF PAYEEI NOT = LOW-VALUES
  8963         MOVE AL-UANON           TO PAYEEA.
  8964
  8965     IF NOTE1I NOT = LOW-VALUES
  8966         MOVE AL-UANON           TO NOTE1A.
  8967
  8968     IF (RETURNED-FROM = 'EL614')
  8969        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8970     END-IF
  8971*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8972*       AND (PI-EOB-CODES-EXIST = 'Y')
  8973*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 168
* EL156.cbl
  8974*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8975     IF PI-SET-NOTE2-MDT = 'Y'
  8976         MOVE AL-SANON           TO NOTE2A
  8977     END-IF
  8978
  8979     IF OFFLINEI NOT = LOW-VALUES
  8980         MOVE AL-UANON           TO OFFLINEA.
  8981
  8982*    IF GROUPEDI NOT = LOW-VALUES
  8983*        MOVE AL-UANON           TO GROUPEDA.
  8984
  8985*    IF CASHI NOT = LOW-VALUES
  8986*        MOVE AL-UANON           TO CASHA.
  8987
  8988     IF CHECKNOI NOT = LOW-VALUES
  8989         MOVE AL-UANON           TO CHECKNOA.
  8990
  8991     IF HOLDTILI NOT = LOW-VALUES
  8992         MOVE AL-UANON           TO HOLDTILA.
  8993
  8994     IF EPYFROMI NOT = LOW-VALUES
  8995         MOVE AL-UANON           TO EPYFROMA.
  8996
  8997     IF AIGFROMI NOT = LOW-VALUES
  8998         MOVE AL-UANON           TO AIGFROMA.
  8999
  9000     IF EPYTHRUI NOT = LOW-VALUES
  9001         MOVE AL-UANON           TO EPYTHRUA.
  9002
  9003     IF EDAYSI NOT = LOW-VALUES
  9004         MOVE AL-UNNON           TO EDAYSA.
  9005
  9006     IF EPYAMTL NOT = +0
  9007         MOVE AL-UNNON           TO EPYAMTA.
  9008
  9009     IF ERESVL NOT = +0
  9010         MOVE AL-UNNON           TO ERESVA.
  9011
  9012     IF EEXPENSL NOT = +0
  9013         MOVE AL-UNNON           TO EEXPENSA.
  9014
  9015     IF ETYPEI NOT = LOW-VALUES
  9016         MOVE AL-UNNON           TO ETYPEA.
  9017
  9018     IF PROOFDTI NOT = 0
  9019         MOVE AL-UNNON           TO PROOFDTA.
  9020
  9021     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9022        MOVE AL-UANON            TO EOBYNA
  9023     END-IF
  9024     IF CLMFMYNI = 'Y' OR 'N'
  9025        MOVE AL-UANON            TO CLMFMYNA
  9026     END-IF
  9027
  9028     IF SURVYYNI = 'Y' OR 'N'
  9029        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9030           MOVE AL-UANON         TO SURVYYNA
  9031        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 169
* EL156.cbl
  9032     END-IF
  9033
  9034     IF SPRELYNI = 'Y' OR 'N'
  9035        MOVE AL-UANON            TO SPRELYNA
  9036     END-IF
  9037
  9038     .
  9039 0699-EXIT.
  9040      EXIT.
  9041
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 170
* EL156.cbl
  9043 0700-TEST-FOR-CHANGES.
  9044     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9045         MOVE ER-0433            TO EMI-ERROR
  9046         GO TO 0750-FUNCTION-ERROR.
  9047
  9048     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9049
  9050     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9051         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9052         MOVE 'A'                TO PI-PASS-SW
  9053         GO TO 1000-EDIT-DATA.
  9054
  9055     IF PI-FATAL-COUNT NOT = 0
  9056         MOVE ER-0499            TO EMI-ERROR
  9057         GO TO 0750-FUNCTION-ERROR.
  9058
  9059     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9060         MOVE ER-0500            TO EMI-ERROR
  9061         GO TO 0750-FUNCTION-ERROR.
  9062
  9063     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9064        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9065           MOVE ER-0542          TO EMI-ERROR
  9066           MOVE -1               TO EPYAMTL
  9067           GO TO 0750-FUNCTION-ERROR.
  9068
  9069     IF PI-OFFLINE = 'Y'  OR
  9070        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9071        MOVE EIBAID              TO PI-PFKEY-USED
  9072        GO TO 5000-UPDATE.
  9073
  9074     GO TO 6000-BUILD-SCREEN-B.
  9075
  9076 0750-FUNCTION-ERROR.
  9077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9078
  9079     IF ENTERPFL > 0
  9080         MOVE -1                 TO ENTERPFL
  9081         MOVE AL-UNBON           TO ENTERPFA
  9082         GO TO 8200-SEND-DATAONLY
  9083     ELSE
  9084         MOVE -1                 TO ENTERPFL
  9085         MOVE AL-UNNOF           TO ENTERPFA
  9086         GO TO 8200-SEND-DATAONLY.
  9087
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 171
* EL156.cbl
  9089 0800-DELETE-TS.
  9090
  9091* EXEC CICS HANDLE CONDITION
  9092*        QIDERR(0800-EXIT)
  9093*    END-EXEC.
  9094*    MOVE '"$N                   ! % #00008846' TO DFHEIV0
  9095     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9097     MOVE X'2520233030303038383436' TO DFHEIV0(25:11)
  9098     CALL 'kxdfhei1' USING DFHEIV0
  9099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9100
  9101
  9102
  9103* EXEC CICS DELETEQ TS
  9104*        QUEUE(QID)
  9105*    END-EXEC.
  9106*    MOVE '*&                    #   #00008850' TO DFHEIV0
  9107     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9108     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9109     MOVE X'2020233030303038383530' TO DFHEIV0(25:11)
  9110     CALL 'kxdfhei1' USING DFHEIV0,
  9111           QID,
  9112           DFHEIV99
  9113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9114
  9115
  9116 0800-EXIT.
  9117      EXIT.
  9118 0900-GET-DDF-LIMITS.
  9119
  9120     if cm-clp-state = zeros or spaces or low-values
  9121        move cm-state            to cm-clp-state
  9122     end-if
  9123     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9124     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9125     MOVE cm-clp-state           TO ERPDEF-STATE
  9126     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9127     evaluate true
  9128        when (cl-claim-type = 'L' or 'P')
  9129           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9130             and 'CU')
  9131           move 'L'              to erpdef-ben-type
  9132           move pi-lf-benefit-cd to erpdef-ben-code
  9133        when (cl-claim-type not = 'L' and 'P')
  9134           and (pi-ah-benefit-cd not = '00' and '  ')
  9135           move 'A'              to erpdef-ben-type
  9136           move pi-ah-benefit-cd to erpdef-ben-code
  9137        when (cl-claim-type not = 'L' and 'P')
  9138           and (pi-ah-benefit-cd = '00' or '  ')
  9139           move 'L'              to erpdef-ben-type
  9140           move pi-lf-benefit-cd to erpdef-ben-code
  9141        when (cl-claim-type = 'L' or 'P')
  9142           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9143           move 'A'              to erpdef-ben-type
  9144           move pi-ah-benefit-cd to erpdef-ben-code
  9145        when other
  9146           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 172
* EL156.cbl
  9147           move pi-ah-benefit-cd to erpdef-ben-code
  9148     end-evaluate
  9149*    if (cl-claim-type = 'L' or 'P')
  9150*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9151*          and 'CU')
  9152*       move 'L'                 to erpdef-ben-type
  9153*       move pi-lf-benefit-cd    to erpdef-ben-code
  9154*    else
  9155*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9156*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9157*    end-if
  9158     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9159
  9160     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9161
  9162
  9163* EXEC CICS STARTBR
  9164*        DATASET  ('ERPDEF')
  9165*        RIDFLD   (ERPDEF-KEY)
  9166*        GTEQ
  9167*        RESP     (WS-RESPONSE)
  9168*    END-EXEC
  9169     MOVE 'ERPDEF' TO DFHEIV1
  9170     MOVE 0
  9171       TO DFHEIV11
  9172*    MOVE '&,         G          &  N#00008900' TO DFHEIV0
  9173     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9174     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9175     MOVE X'204E233030303038393030' TO DFHEIV0(25:11)
  9176     CALL 'kxdfhei1' USING DFHEIV0,
  9177           DFHEIV1,
  9178           ERPDEF-KEY,
  9179           DFHEIV99,
  9180           DFHEIV11,
  9181           DFHEIV99
  9182     MOVE EIBRESP  TO WS-RESPONSE
  9183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9184
  9185     IF NOT WS-RESP-NORMAL
  9186        GO TO 0900-EXIT
  9187     END-IF
  9188
  9189     .
  9190 0900-READNEXT.
  9191
  9192
  9193* EXEC CICS READNEXT
  9194*       DATASET  ('ERPDEF')
  9195*       SET      (ADDRESS OF PRODUCT-MASTER)
  9196*       RIDFLD   (ERPDEF-KEY)
  9197*       RESP     (WS-RESPONSE)
  9198*    END-EXEC
  9199     MOVE 'ERPDEF' TO DFHEIV1
  9200     MOVE 0
  9201       TO DFHEIV11
  9202*    MOVE '&.S                   )  N#00008914' TO DFHEIV0
  9203     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9204     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 173
* EL156.cbl
  9205     MOVE X'204E233030303038393134' TO DFHEIV0(25:11)
  9206     CALL 'kxdfhei1' USING DFHEIV0,
  9207           DFHEIV1,
  9208           DFHEIV20,
  9209           DFHEIV99,
  9210           ERPDEF-KEY,
  9211           DFHEIV99,
  9212           DFHEIV11,
  9213           DFHEIV99,
  9214           DFHEIV99
  9215     SET ADDRESS OF PRODUCT-MASTER TO
  9216         DFHEIV20
  9217     MOVE EIBRESP  TO WS-RESPONSE
  9218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9219
  9220     IF NOT WS-RESP-NORMAL
  9221        GO TO 0900-ENDBR
  9222     END-IF
  9223
  9224     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9225        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9226           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9227        ELSE
  9228           GO TO 0900-READNEXT
  9229        END-IF
  9230     ELSE
  9231        GO TO 0900-ENDBR
  9232     END-IF
  9233
  9234     IF CM-LOAN-TERM = ZEROS
  9235        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9236     END-IF
  9237
  9238     .
  9239 0900-ENDBR.
  9240
  9241
  9242* EXEC CICS ENDBR
  9243*       DATASET  ('ERPDEF')
  9244*    END-EXEC
  9245     MOVE 'ERPDEF' TO DFHEIV1
  9246     MOVE 0
  9247       TO DFHEIV11
  9248*    MOVE '&2                    $   #00008942' TO DFHEIV0
  9249     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9250     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9251     MOVE X'2020233030303038393432' TO DFHEIV0(25:11)
  9252     CALL 'kxdfhei1' USING DFHEIV0,
  9253           DFHEIV1,
  9254           DFHEIV11,
  9255           DFHEIV99
  9256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9257
  9258     .
  9259 0900-EXIT.
  9260     EXIT.
  9261 1000-EDIT-DATA.
  9262
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 174
* EL156.cbl
  9263     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9264         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9265         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9266
  9267     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9268
  9269     IF NOT MODIFY-CAP
  9270         MOVE ER-0070            TO EMI-ERROR
  9271         MOVE -1                 TO PMTTYPEL
  9272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9273         GO TO 2000-EDIT-DONE.
  9274
  9275     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9276                         '5' AND '6'
  9277         MOVE ER-0420            TO EMI-ERROR
  9278         MOVE -1                 TO PMTTYPEL
  9279         MOVE AL-UABON           TO PMTTYPEA
  9280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9281     ELSE
  9282         MOVE AL-UANON           TO PMTTYPEA.
  9283
  9284*    IF PI-OFFLINE = 'Y'
  9285*       IF PI-GROUPED = 'Y'
  9286*          MOVE ER-1880         TO EMI-ERROR
  9287*          MOVE -1              TO GROUPEDL
  9288*          MOVE AL-UABON        TO GROUPEDA
  9289*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9290*
  9291*    IF GROUPEDL > +0
  9292*       IF PI-GROUPED = 'Y' OR 'N'
  9293*          MOVE AL-UANON TO GROUPEDA
  9294*       ELSE
  9295*          MOVE ER-3140            TO EMI-ERROR
  9296*          MOVE -1                 TO GROUPEDL
  9297*          MOVE AL-UABON           TO GROUPEDA
  9298*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9299*
  9300*    IF CASHL > +0
  9301*       IF PI-CASH = 'Y' OR 'N'
  9302*          MOVE AL-UANON           TO CASHA
  9303*       ELSE
  9304*          MOVE ER-3141            TO EMI-ERROR
  9305*          MOVE -1                 TO CASHL
  9306*          MOVE AL-UABON           TO CASHA
  9307*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9308
  9309     IF LOANNOL > +0
  9310         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9311
  9312 1000-EDIT-PAYEE.
  9313
  9314     IF PI-PAYEE-SEQ NOT NUMERIC
  9315         MOVE ER-0294            TO  EMI-ERROR
  9316         MOVE -1                 TO  PAYEEL
  9317         MOVE AL-UABON           TO  PAYEEA
  9318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9319         GO TO 1000-CONT-EDIT.
  9320
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 175
* EL156.cbl
  9321     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9322                         'E' OR 'O' OR 'Q'
  9323         NEXT SENTENCE
  9324     ELSE
  9325         MOVE ER-0294            TO  EMI-ERROR
  9326         MOVE -1                 TO  PAYEEL
  9327         MOVE AL-UABON           TO  PAYEEA
  9328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9329         GO TO 1000-CONT-EDIT.
  9330
  9331     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9332        (PI-PAYEE-SEQ NOT < '1' AND
  9333         PI-PAYEE-SEQ NOT > '9'))
  9334      OR
  9335        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9336         (PI-PAYEE-SEQ NOT > '9'))
  9337         MOVE AL-UANON            TO PAYEEA
  9338     ELSE
  9339         MOVE ER-0294            TO EMI-ERROR
  9340         MOVE -1                 TO PAYEEL
  9341         MOVE AL-UABON           TO PAYEEA
  9342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9343
  9344     IF PI-COMPANY-ID = 'DMD'
  9345         IF PI-PAYEE-TYPE = 'B' AND
  9346            PI-PAYEE-SEQ NOT = '0'
  9347               MOVE ER-7841            TO EMI-ERROR
  9348               MOVE -1                 TO PAYEEL
  9349               MOVE AL-UABON           TO PAYEEA
  9350               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9351
  9352     IF PI-COMPANY-ID = 'JHL'
  9353         IF PI-PAYEE = 'B0'
  9354             NEXT SENTENCE
  9355           ELSE
  9356
  9357* EXEC CICS HANDLE CONDITION
  9358*            ENDFILE(1950-NOT-FOUND)
  9359*            NOTFND (1950-NOT-FOUND)
  9360*        END-EXEC
  9361*    MOVE '"$''I                  ! & #00009044' TO DFHEIV0
  9362     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9364     MOVE X'2620233030303039303434' TO DFHEIV0(25:11)
  9365     CALL 'kxdfhei1' USING DFHEIV0
  9366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9367         MOVE 'N'                    TO FOUND-TOL-SW
  9368         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9369         MOVE '2'                    TO CNTL-REC-TYPE
  9370         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9371         MOVE +0                     TO CNTL-SEQ-NO
  9372         MOVE 'PROC'                 TO FILE-SWITCH
  9373         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9374         IF PI-PAYEE = 'I1' AND
  9375            APPROVAL-LEVEL-2
  9376             NEXT SENTENCE
  9377           ELSE
  9378         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 176
* EL156.cbl
  9379             MOVE ER-3546        TO EMI-ERROR
  9380             MOVE -1             TO PAYEEL
  9381             MOVE AL-UABON       TO PAYEEA
  9382             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9383
  9384     IF PI-PAYEE-TYPE = 'E'
  9385        IF PI-PMTTYPE = '5' OR '6'
  9386            NEXT SENTENCE
  9387        ELSE
  9388            MOVE ER-3539            TO EMI-ERROR
  9389            MOVE -1                 TO PAYEEL
  9390            MOVE AL-UABON           TO PAYEEA
  9391            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9392
  9393 1000-CONT-EDIT.
  9394
  9395     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9396        IF PI-EPYAMT NOT NEGATIVE
  9397            MOVE ER-0421         TO EMI-ERROR
  9398            MOVE -1              TO OFFLINEL
  9399            MOVE AL-UABON        TO OFFLINEA
  9400            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9401        ELSE
  9402            MOVE AL-UANON        TO OFFLINEA.
  9403
  9404     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  9405        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9406           CONTINUE
  9407        ELSE
  9408           IF PI-PRINT-EOB-YN = 'S' AND
  9409              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9410                CONTINUE
  9411           ELSE
  9412              MOVE ER-1561       TO EMI-ERROR
  9413              MOVE -1            TO EOBYNL
  9414              MOVE AL-UABON      TO EOBYNA
  9415              PERFORM 9900-ERROR-FORMAT
  9416                                 THRU 9900-EXIT
  9417           END-IF
  9418        END-IF
  9419
  9420        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9421            MOVE ER-1566        TO EMI-ERROR
  9422            MOVE -1             TO CLMFMYNL
  9423            MOVE AL-UABON       TO CLMFMYNA
  9424            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425        END-IF
  9426
  9427        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9428            MOVE ER-1567        TO EMI-ERROR
  9429            MOVE -1             TO SURVYYNL
  9430            MOVE AL-UABON       TO SURVYYNA
  9431            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9432        END-IF
  9433
  9434        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9435            MOVE ER-1569        TO EMI-ERROR
  9436            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 177
* EL156.cbl
  9437            MOVE AL-UABON       TO SPRELYNA
  9438            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9439        END-IF
  9440
  9441     END-IF
  9442     IF PI-EPYAMT IS NEGATIVE
  9443         IF PI-OFFLINE NOT = 'Y'
  9444             MOVE ER-0836        TO  EMI-ERROR
  9445             MOVE -1             TO  OFFLINEL
  9446             MOVE AL-UABON       TO  OFFLINEA
  9447             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9448
  9449     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9450        MOVE ER-0872             TO EMI-ERROR
  9451        MOVE -1                  TO PROOFDTL
  9452        MOVE AL-UABON            TO PROOFDTA
  9453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9454     ELSE
  9455        MOVE '4'                TO DC-OPTION-CODE
  9456        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9457        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9458        IF DATE-CONVERSION-ERROR
  9459            MOVE ER-0873        TO EMI-ERROR
  9460            MOVE -1                  TO PROOFDTL
  9461            MOVE AL-UABON            TO PROOFDTA
  9462            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9463        ELSE
  9464            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9465            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9466                MOVE ER-0873    TO EMI-ERROR
  9467                MOVE -1                  TO PROOFDTL
  9468                MOVE AL-UABON            TO PROOFDTA
  9469                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9470            END-IF
  9471        END-IF
  9472     END-IF.
  9473
  9474     IF PI-COMPANY-ID = 'DMD'
  9475        IF NOTE1L NOT = ZEROS
  9476            MOVE ER-7844        TO  EMI-ERROR
  9477            MOVE -1             TO  NOTE1L
  9478            MOVE AL-UABON       TO  NOTE1A
  9479            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9480
  9481     IF PI-COMPANY-ID = 'DMD'
  9482        IF NOTE2L NOT = ZEROS
  9483          GO TO 1004-DMD-EOB-CHECKS.
  9484
  9485     IF NOTE1L NOT > +0
  9486         GO TO 1005-CHECK-ERRORS.
  9487
  9488     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9489         GO TO 1005-CHECK-ERRORS.
  9490
  9491     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9492         GO TO 1003-HAN-PMT-NOTES.
  9493
  9494     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 178
* EL156.cbl
  9495
  9496     IF WS-PMTOPTION NUMERIC
  9497        IF WS-PMTOPTION > '00' AND < '17'
  9498           NEXT SENTENCE
  9499        ELSE
  9500           MOVE ER-0618          TO EMI-ERROR
  9501           MOVE -1               TO NOTE1L
  9502           MOVE AL-UABON         TO NOTE1A
  9503           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9504     ELSE
  9505        GO TO 1005-CHECK-ERRORS.
  9506
  9507     IF WS-PMTOPTION = '05' AND
  9508        WS-DOCNAME = SPACES
  9509          MOVE ER-0616             TO EMI-ERROR
  9510          MOVE -1                  TO NOTE1L
  9511          MOVE AL-UABON            TO NOTE1A
  9512          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9513
  9514     IF WS-PMTOPTION = '15' OR '16'
  9515
  9516* EXEC CICS BIF DEEDIT
  9517*            FIELD (WS-AMOUNT)
  9518*            LENGTH(08)
  9519*        END-EXEC
  9520     MOVE 08
  9521       TO DFHEIV11
  9522*    MOVE '@"L                   #   #00009196' TO DFHEIV0
  9523     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9524     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9525     MOVE X'2020233030303039313936' TO DFHEIV0(25:11)
  9526     CALL 'kxdfhei1' USING DFHEIV0,
  9527           WS-AMOUNT,
  9528           DFHEIV11
  9529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9530        IF (WS-NUM-AMT = ZEROS) OR
  9531           (WS-AMOUNT NOT NUMERIC)
  9532           MOVE ER-0617          TO EMI-ERROR
  9533           MOVE -1               TO NOTE1L
  9534           MOVE AL-UABON         TO NOTE1A
  9535           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9536
  9537     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9538
  9539     GO TO 1005-CHECK-ERRORS.
  9540
  9541 1003-HAN-PMT-NOTES.
  9542
  9543     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9544
  9545     IF WS-HAN-PMT-CODE = SPACE
  9546         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9547     ELSE
  9548     IF WS-HAN-PMT-CODE = 'A'
  9549         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9550                                 TO WS-HAN-PMT-NOTE
  9551     ELSE
  9552     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 179
* EL156.cbl
  9553         MOVE ':FINAL PAYMENT / DECEASED'
  9554                                 TO WS-HAN-PMT-NOTE
  9555     ELSE
  9556     IF WS-HAN-PMT-CODE = 'C'
  9557         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9558                                 TO WS-HAN-PMT-NOTE
  9559     ELSE
  9560     IF WS-HAN-PMT-CODE = 'D'
  9561         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9562                                 TO WS-HAN-PMT-NOTE
  9563     ELSE
  9564     IF WS-HAN-PMT-CODE = 'E'
  9565         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9566                                 TO WS-HAN-PMT-NOTE
  9567     ELSE
  9568     IF WS-HAN-PMT-CODE = 'F'
  9569         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9570                                 TO WS-HAN-PMT-NOTE
  9571     ELSE
  9572     IF WS-HAN-PMT-CODE = 'P'
  9573         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9574
  9575     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9576     GO TO 1005-CHECK-ERRORS.
  9577
  9578 1004-DMD-EOB-CHECKS.
  9579
  9580     INITIALIZE PI-AT-EOB-CODES.
  9581
  9582     IF NOTE2I (20:21) > SPACES
  9583         MOVE ER-7845          TO EMI-ERROR
  9584         MOVE -1               TO NOTE2L
  9585         MOVE AL-UABON         TO NOTE2A
  9586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9587         GO TO 1005-CHECK-ERRORS
  9588      ELSE
  9589         MOVE NOTE2I             TO W-EOB-CODES.
  9590
  9591     MOVE +1                     TO W-EOB-NDX.
  9592
  9593 1004-CHECK-EACH-EOB.
  9594
  9595     IF W-EOB-NDX > +5
  9596             OR
  9597        W-EOB-CODE (W-EOB-NDX) = SPACES
  9598         GO TO 1004-CHECK-DUP-EOB.
  9599
  9600     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9601         MOVE ER-0956            TO EMI-ERROR
  9602         MOVE -1                 TO NOTE2L
  9603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9604         GO TO 1005-CHECK-ERRORS.
  9605
  9606     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9607     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9608     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9609     MOVE 'DLO023'               TO PGM-NAME.
  9610
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 180
* EL156.cbl
  9611
  9612* EXEC CICS LINK
  9613*        PROGRAM    (PGM-NAME)
  9614*        COMMAREA   (CD-COMMUNICATION-AREA)
  9615*        LENGTH     (CD-RCRD-LENGTH)
  9616*    END-EXEC.
  9617*    MOVE '."C                   (   #00009281' TO DFHEIV0
  9618     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9620     MOVE X'2020233030303039323831' TO DFHEIV0(25:11)
  9621     CALL 'kxdfhei1' USING DFHEIV0,
  9622           PGM-NAME,
  9623           CD-COMMUNICATION-AREA,
  9624           CD-RCRD-LENGTH,
  9625           DFHEIV99,
  9626           DFHEIV99,
  9627           DFHEIV99,
  9628           DFHEIV99
  9629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9630
  9631
  9632     IF CD-RETURN-CODE = 'OK'
  9633         GO TO 1004-CONT.
  9634
  9635     MOVE -1                     TO NOTE2L.
  9636
  9637     IF CD-RETURN-CODE = '01'
  9638         MOVE ER-8310            TO EMI-ERROR
  9639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9640         GO TO 1005-CHECK-ERRORS.
  9641
  9642     IF CD-RETURN-CODE = '02'
  9643         MOVE ER-8311            TO EMI-ERROR
  9644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9645         GO TO 1005-CHECK-ERRORS.
  9646
  9647     IF CD-RETURN-CODE = '03'
  9648         MOVE ER-8312            TO EMI-ERROR
  9649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9650         GO TO 1005-CHECK-ERRORS.
  9651
  9652     IF CD-RETURN-CODE = '04'
  9653         MOVE ER-8313            TO EMI-ERROR
  9654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9655         GO TO 1005-CHECK-ERRORS.
  9656
  9657     IF CD-RETURN-CODE = '05'
  9658         MOVE ER-8314            TO EMI-ERROR
  9659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9660         GO TO 1005-CHECK-ERRORS.
  9661
  9662     IF CD-RETURN-CODE = '06'
  9663         MOVE ER-8315            TO EMI-ERROR
  9664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9665         GO TO 1005-CHECK-ERRORS.
  9666
  9667     IF CD-RETURN-CODE = 'E1'
  9668         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 181
* EL156.cbl
  9669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9670         GO TO 1005-CHECK-ERRORS.
  9671
  9672     IF CD-RETURN-CODE = 'N1'
  9673         MOVE ER-8317            TO EMI-ERROR
  9674         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9675         GO TO 1005-CHECK-ERRORS.
  9676
  9677 1004-CONT.
  9678     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9679
  9680     ADD +1 TO W-EOB-NDX.
  9681     GO TO 1004-CHECK-EACH-EOB.
  9682
  9683 1004-CHECK-DUP-EOB.
  9684     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9685         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9686                               PI-AT-EOB-CODE (3) OR
  9687                               PI-AT-EOB-CODE (4) OR
  9688                               PI-AT-EOB-CODE (5)))
  9689                  OR
  9690        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9691         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9692                               PI-AT-EOB-CODE (4) OR
  9693                               PI-AT-EOB-CODE (5)))
  9694                  OR
  9695        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9696         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9697                               PI-AT-EOB-CODE (5)))
  9698                  OR
  9699        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9700         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9701            MOVE ER-8000            TO EMI-ERROR
  9702            MOVE AL-UABON           TO NOTE2A
  9703            MOVE -1                 TO NOTE2L
  9704            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9705            GO TO 1005-CHECK-ERRORS.
  9706
  9707 1005-CHECK-ERRORS.
  9708*    IF PI-COMPANY-ID NOT = 'DMD'
  9709        GO TO 1006-CHECK-ERRORS.
  9710
  9711*********  DMD CODE START ******************
  9712*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9713*       GO TO 1006-CHECK-ERRORS.
  9714*
  9715*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9716*
  9717*    COMPUTE W-PAYMENT-TOTAL
  9718*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9719*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9720*               AND
  9721*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9722*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9723*          MOVE ER-0967    TO EMI-ERROR
  9724*          MOVE -1         TO PMTTYPEL
  9725*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9726*
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 182
* EL156.cbl
  9727*    GO TO 1006-CHECK-ERRORS.
  9728*********  DMD CODE END ******************
  9729
  9730 1006-CHECK-ERRORS.
  9731     if emi-forcable-ctr = zeros
  9732        and emi-fatal-ctr = zeros
  9733        continue
  9734     else
  9735        IF NOT EMI-NO-ERRORS
  9736           GO TO 2000-EDIT-DONE
  9737        end-if
  9738     end-if
  9739
  9740* EXEC CICS HANDLE CONDITION
  9741*        NOTFND(1950-NOT-FOUND)
  9742*    END-EXEC.
  9743*    MOVE '"$I                   ! '' #00009394' TO DFHEIV0
  9744     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9746     MOVE X'2720233030303039333934' TO DFHEIV0(25:11)
  9747     CALL 'kxdfhei1' USING DFHEIV0
  9748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9749
  9750
  9751     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9752     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9753     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9754     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9755     MOVE 'MSTR'                 TO FILE-SWITCH.
  9756
  9757     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9758
  9759     IF PI-COMPANY-ID = 'DMD'
  9760         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9761
  9762     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9763        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9764           MOVE ER-0873    TO EMI-ERROR
  9765           MOVE -1                  TO PROOFDTL
  9766           MOVE AL-UABON            TO PROOFDTA
  9767           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9768        END-IF
  9769     END-IF
  9770     if cl-benefit-period = zeros
  9771        move er-1667             to emi-error
  9772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9773     end-if
  9774     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9775     MOVE +95                    TO TRLR-SEQ-NO
  9776
  9777* EXEC CICS READ
  9778*       DATASET  ('ELTRLR')
  9779*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9780*       RIDFLD   (ELTRLR-KEY)
  9781*       RESP     (WS-RESPONSE)
  9782*    END-EXEC
  9783     MOVE 'ELTRLR' TO DFHEIV1
  9784*    MOVE '&"S        E          (  N#00009423' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 183
* EL156.cbl
  9785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9787     MOVE X'204E233030303039343233' TO DFHEIV0(25:11)
  9788     CALL 'kxdfhei1' USING DFHEIV0,
  9789           DFHEIV1,
  9790           DFHEIV20,
  9791           DFHEIV99,
  9792           ELTRLR-KEY,
  9793           DFHEIV99,
  9794           DFHEIV99,
  9795           DFHEIV99
  9796     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9797         DFHEIV20
  9798     MOVE EIBRESP  TO WS-RESPONSE
  9799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9800
  9801     if ws-resp-normal
  9802        perform varying s1 from +1 by +1 until
  9803           at-note-error-no (s1) = spaces
  9804           if at-note-error-no (s1) = '1662'
  9805              continue
  9806           else
  9807              move at-note-error-no (s1)
  9808                                 to emi-error
  9809              if at-note-error-no (s1) = '1653'
  9810                 evaluate true
  9811                    when cl-claim-type = 'L'
  9812                       move '  LF  '
  9813                                 to emi-claim-type
  9814                    when cl-claim-type = 'I'
  9815                       move '  IU  '
  9816                                 to emi-claim-type
  9817                    when cl-claim-type = 'A'
  9818                       move '  AH  '
  9819                                 to emi-claim-type
  9820                    when other
  9821                       move ' FMLA '
  9822                                 to emi-claim-type
  9823                 end-evaluate
  9824              end-if
  9825              PERFORM 9900-ERROR-FORMAT
  9826                                 THRU 9900-EXIT
  9827           end-if
  9828        end-perform
  9829     end-if
  9830     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9831         IF PI-PMTTYPE = '5' OR '6'
  9832             NEXT SENTENCE
  9833         ELSE
  9834             MOVE ER-0555             TO EMI-ERROR
  9835             MOVE -1                  TO PMTTYPEL
  9836             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9837
  9838     IF CL-LAST-CLOSE-REASON = '2'
  9839         IF CL-CLAIM-STATUS = 'C'
  9840             MOVE ER-0760        TO  EMI-ERROR
  9841             MOVE -1             TO  PMTTYPEL
  9842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 184
* EL156.cbl
  9843
  9844     IF PI-ACTIVITY-CODE = 9
  9845         MOVE ER-3538            TO  EMI-ERROR
  9846         MOVE -1                 TO  PMTTYPEL
  9847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9848
  9849     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9850         GO TO 1008-READ-CERT.
  9851**********************AIG LOGIC STARTS *********************
  9852     IF CL-CERT-PRIME = 'INCOMPLETE'
  9853         MOVE ER-3540            TO  EMI-ERROR
  9854         MOVE -1                 TO  PMTTYPEL
  9855         MOVE AL-UABON           TO  PMTTYPEA
  9856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9857         GO TO 2000-EDIT-DONE.
  9858
  9859     IF PI-PMTTYPE = '4'
  9860         IF PI-EPYAMT IS NEGATIVE
  9861             IF PI-ECHECKNO-CR = 'CR'
  9862                 NEXT SENTENCE
  9863             ELSE
  9864                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9865
  9866     IF PI-PMTTYPE = '4'
  9867         IF PI-ECHECKNO-CR = 'CR'
  9868             IF PI-EPYAMT IS NEGATIVE
  9869                 NEXT SENTENCE
  9870             ELSE
  9871                 MOVE ER-0834    TO  EMI-ERROR
  9872                 MOVE -1         TO  EPYAMTL
  9873                 MOVE AL-UNBON   TO  EPYAMTA
  9874                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9875
  9876     IF PI-PMTTYPE = '4'
  9877         IF PI-EPYAMT IS NEGATIVE
  9878             IF PI-OFFLINE = 'Y'
  9879                 NEXT SENTENCE
  9880             ELSE
  9881                 MOVE 'Y'        TO  PI-OFFLINE
  9882                                     WS-OFFLINE
  9883                                     OFFLINEO
  9884                 MOVE AL-UANON   TO  OFFLINEA.
  9885
  9886*    IF PI-PMTTYPE = '4'
  9887*        IF PI-EPYAMT IS NEGATIVE
  9888*            IF PI-CASH = 'Y'
  9889*                NEXT SENTENCE
  9890*            ELSE
  9891*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9892*                MOVE AL-UANON   TO  CASHA
  9893*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9894*
  9895*    IF PI-CASH NOT = 'Y' AND 'N'
  9896*         IF PI-OFFLINE = 'Y'  AND
  9897*            PI-ECHECKNO-CR = 'CR'
  9898*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9899*              MOVE AL-UANON     TO  CASHA
  9900*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 185
* EL156.cbl
  9901*
  9902*    IF PI-CASH NOT = 'Y' AND 'N'
  9903*        IF PI-PMTTYPE = '5' OR '6'
  9904*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9905*            MOVE AL-UANON       TO  CASHA
  9906*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9907*
  9908*    IF PI-CASH NOT = 'Y' AND 'N'
  9909*       IF CL-ASSOCIATES = 'N' OR 'A'
  9910*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9911*           MOVE AL-UANON        TO  CASHA
  9912*       ELSE
  9913*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9914*           MOVE AL-UANON        TO  CASHA.
  9915*
  9916*    IF PI-PMTTYPE = '5' OR '6'
  9917*        IF PI-CASH = 'N'
  9918*            MOVE ER-0819        TO  EMI-ERROR
  9919*            MOVE AL-UANON       TO  CASHA
  9920*            MOVE -1             TO  CASHL
  9921*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9922*
  9923*    IF CL-ASSOCIATES = 'N' OR 'A'
  9924*       IF CASHI = 'N'
  9925*        MOVE ER-3537            TO  EMI-ERROR
  9926*        MOVE AL-UANON           TO  CASHA
  9927*        MOVE -1                 TO  CASHL
  9928*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9929
  9930 1007-DEFAULT-AIG-CHECKNO.
  9931
  9932     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9933         MOVE ER-3532            TO  EMI-ERROR
  9934         MOVE -1                 TO  PMTTYPEL
  9935         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9936**********************AIG LOGIC ENDS ***********************
  9937
  9938 1008-READ-CERT.
  9939
  9940     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9941     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9942     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9943     MOVE CL-CERT-STATE          TO CERT-STATE.
  9944     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9945     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9946     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9947     MOVE 'CERT'                 TO FILE-SWITCH.
  9948
  9949     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9950
  9951     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9952        MOVE CM-LF-LOAN-EXPIRE-DT
  9953                                 TO WS-EXP-DT PI-EXP-DT
  9954                                    ws-extended-exp-dt
  9955     ELSE
  9956        MOVE CM-AH-LOAN-EXPIRE-DT
  9957                                 TO WS-EXP-DT PI-EXP-DT
  9958                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 186
* EL156.cbl
  9959     end-if
  9960     if pi-dcc-product-code not = spaces
  9961        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9962        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9963        PERFORM 0900-GET-DDF-limits
  9964                                 THRU 0900-EXIT
  9965        IF PDEF-FOUND
  9966           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9967              (P1 > +8)
  9968              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9969           END-PERFORM
  9970           IF P1 < +9
  9971              MOVE '6'           TO DC-OPTION-CODE
  9972              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9973              MOVE PD-MAX-EXTENSION (P1)
  9974                                 TO DC-ELAPSED-MONTHS
  9975              PERFORM 9700-LINK-DATE-CONVERT
  9976                                 THRU 9700-EXIT
  9977              if no-conversion-error
  9978                 move dc-bin-date-2 to ws-extended-exp-dt
  9979              end-if
  9980           else
  9981              move er-1674       to emi-error
  9982              PERFORM 9900-ERROR-FORMAT
  9983                                 THRU 9900-EXIT
  9984           end-if
  9985        end-if
  9986     end-if
  9987*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9988*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9989
  9990     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9991         MOVE ER-0458            TO EMI-ERROR
  9992         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9993
  9994     IF (CL-INCURRED-DT > WS-EXP-DT)
  9995        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9996        MOVE ER-1677             TO EMI-ERROR
  9997        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9998     END-IF
  9999     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10000     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10001         MOVE ER-0459            TO EMI-ERROR
 10002         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10003
 10004     IF CL-REPORTED-DT = LOW-VALUES
 10005        MOVE ER-0530             TO EMI-ERROR
 10006        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10007
 10008     IF PI-COMPANY-ID = 'NCL'
 10009        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10010            MOVE ER-0770            TO EMI-ERROR
 10011            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10012
 10013     IF PI-COMPANY-ID = 'NCL'
 10014        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10015            MOVE ER-0737            TO EMI-ERROR
 10016            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 187
* EL156.cbl
 10017
 10018     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10019         MOVE ER-0768            TO  EMI-ERROR
 10020         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10021
 10022     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10023         MOVE ER-0769            TO  EMI-ERROR
 10024         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10025
 10026     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10027         GO TO 1020-DO-LIFE-EDITS
 10028     ELSE
 10029         GO TO 1030-DO-AH-EDITS.
 10030
 10031 1010-GENERAL-ERROR.
 10032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10033
 10034     IF EMI-MESSAGE-FORMATTED
 10035         MOVE -1                 TO PMTTYPEL.
 10036
 10037 1010-EXIT.
 10038     EXIT.
 10039
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 188
* EL156.cbl
 10041 1020-DO-LIFE-EDITS.
 10042     IF CM-LF-BENEFIT-CD = '00'
 10043         IF PI-PMTTYPE = '5' OR '6'
 10044             MOVE ER-0658        TO EMI-ERROR
 10045             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10046         ELSE
 10047            if (pi-company-id = 'DCC' or 'CAP')
 10048               and (pi-dcc-product-code not = spaces)
 10049               continue
 10050            else
 10051               MOVE ER-1775      TO EMI-ERROR
 10052               PERFORM 1040-PMTTYPE-ERROR
 10053                                 THRU 1040-EXIT
 10054            end-if
 10055         end-if
 10056     end-if
 10057
 10058     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10059     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10060         MOVE ER-0460            TO EMI-ERROR
 10061         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10062
 10063     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10064     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10065     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10066     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10067     MOVE '4'                    TO  CNTL-REC-TYPE.
 10068     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10069     MOVE 'BENE'                 TO  FILE-SWITCH.
 10070     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10071     IF NO-BENEFIT-FOUND
 10072         GO TO 1950-NOT-FOUND.
 10073
 10074     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10075
 10076     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10077         IF PI-PMTTYPE = '4'
 10078             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10079                PI-LF-COVERAGE-TYPE = 'P'
 10080                 NEXT SENTENCE
 10081             ELSE
 10082                 MOVE ER-0461        TO EMI-ERROR
 10083                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10084         ELSE
 10085            NEXT SENTENCE
 10086     ELSE
 10087         IF PI-PMTTYPE = '2'
 10088            IF NOT CM-O-B-COVERAGE
 10089              AND CM-LF-CURRENT-STATUS = '7'
 10090                MOVE ER-0462     TO EMI-ERROR
 10091                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10092
 10093     IF PI-PMTTYPE = '2'
 10094         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10095            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10096             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10097             MOVE ER-0730            TO  EMI-ERROR
 10098             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 189
* EL156.cbl
 10099             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10100
 10101     IF PI-PMTTYPE = '2'
 10102         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10103            PI-LF-COVERAGE-TYPE = 'P'
 10104             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10105                 MOVE ER-0462    TO  EMI-ERROR
 10106                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10107
 10108     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10109       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10110         MOVE ER-0466            TO EMI-ERROR
 10111         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10112
 10113     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10114         IF PI-PMTTYPE = '3'
 10115             MOVE 0436           TO EMI-ERROR
 10116             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10117             GO TO 1045-EDIT-PAYEE-ADDR
 10118         ELSE
 10119             GO TO 1045-EDIT-PAYEE-ADDR.
 10120
 10121     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10122        PI-LF-COVERAGE-TYPE = 'P'
 10123         IF PI-PMTTYPE = '3'
 10124             MOVE ER-0436          TO  EMI-ERROR
 10125             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10126         ELSE
 10127             NEXT SENTENCE
 10128     ELSE
 10129         IF PI-PMTTYPE = '1' OR '3'
 10130             MOVE ER-0436            TO EMI-ERROR
 10131             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10132*
 10133     IF PI-COMPANY-ID = 'CID' AND
 10134        CL-CERT-STATE = 'SC'  AND
 10135        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10136           MOVE ER-0879    TO  EMI-ERROR
 10137           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10138           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10139     END-IF.
 10140     IF PI-COMPANY-ID = 'AHL'
 10141        evaluate true
 10142           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10143              MOVE ER-0879       TO  EMI-ERROR
 10144              PERFORM 1040-PMTTYPE-ERROR
 10145                                 THRU 1040-EXIT
 10146              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10147           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10148                 '6D' OR '6H' OR '6R'
 10149              MOVE ER-0879       TO  EMI-ERROR
 10150              PERFORM 1040-PMTTYPE-ERROR
 10151                                 THRU 1040-EXIT
 10152              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10153           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10154              MOVE ER-0879       TO  EMI-ERROR
 10155              PERFORM 1040-PMTTYPE-ERROR
 10156                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 190
* EL156.cbl
 10157              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10158        end-evaluate
 10159     END-IF
 10160     GO TO 1045-EDIT-PAYEE-ADDR.
 10161
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 191
* EL156.cbl
 10163 1030-DO-AH-EDITS.
 10164     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10165     IF CM-AH-BENEFIT-CD = '00'
 10166         IF PI-PMTTYPE = '5' OR '6'
 10167             MOVE ER-0658        TO EMI-ERROR
 10168             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10169         ELSE
 10170             MOVE ER-1775        TO EMI-ERROR
 10171             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10172
 10173     IF CL-TOTAL-PAID-AMT = ZEROS
 10174         IF PI-PMTTYPE = '4'
 10175             MOVE ER-0438        TO EMI-ERROR
 10176             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10177
 10178     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10179         IF PI-PMTTYPE = '3'
 10180             MOVE ER-0463        TO EMI-ERROR
 10181             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10182         ELSE
 10183             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10184              AND CM-LF-CURRENT-STATUS = '7'
 10185                 MOVE ER-0465    TO EMI-ERROR
 10186                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10187
 10188     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10189         IF PI-PMTTYPE = '3'
 10190             MOVE ER-0464        TO EMI-ERROR
 10191             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10192         ELSE
 10193             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10194                 MOVE ER-0469    TO EMI-ERROR
 10195                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10196
 10197     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10198         IF PI-PMTTYPE = '3'
 10199             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10200                 MOVE ER-0467    TO EMI-ERROR
 10201                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10202             ELSE
 10203                 NEXT SENTENCE
 10204         ELSE
 10205             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10206                 MOVE ER-0468    TO EMI-ERROR
 10207                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10208
 10209     GO TO 1045-EDIT-PAYEE-ADDR.
 10210
 10211 1040-PMTTYPE-ERROR.
 10212     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10213
 10214     IF EMI-MESSAGE-FORMATTED
 10215         MOVE -1                 TO PMTTYPEL
 10216         MOVE AL-UABON           TO PMTTYPEA.
 10217
 10218 1040-EXIT.
 10219     EXIT.
 10220
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 192
* EL156.cbl
 10222 1045-EDIT-PAYEE-ADDR.
 10223
 10224     IF PI-OFFLINE = 'N' AND
 10225        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10226           < PI-PAYEE-SEQ-NUM)
 10227        OR
 10228         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10229         (PI-PAYEE-TYPE = 'B')                 AND
 10230         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10231        OR
 10232         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10233           < PI-PAYEE-SEQ-NUM)
 10234        OR
 10235         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10236           < PI-PAYEE-SEQ-NUM)
 10237        OR
 10238         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10239           < PI-PAYEE-SEQ-NUM)
 10240        OR
 10241         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10242           < PI-PAYEE-SEQ-NUM)
 10243        OR
 10244         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10245           < PI-PAYEE-SEQ-NUM))
 10246             MOVE ER-0437        TO EMI-ERROR
 10247             MOVE -1             TO PAYEEL
 10248             MOVE AL-UABON       TO PAYEEA
 10249             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10250
 10251     IF PI-OFFLINE    = 'N' AND
 10252        PI-PAYEE-TYPE = 'B' AND
 10253        PI-PAYEE-SEQ  = '0'
 10254         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10255         IF BENE-FOUND-SW = 'N'
 10256             MOVE ER-0437        TO EMI-ERROR
 10257             MOVE -1             TO PAYEEL
 10258             MOVE AL-UABON       TO PAYEEA
 10259             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10260
 10261     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10262        IF PI-OFFLINE    = 'N'  AND
 10263           PI-PAYEE-TYPE = 'B'  AND
 10264           PI-PAYEE-SEQ  = '9'
 10265             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10266             IF BENE-FOUND-SW = 'N'
 10267                MOVE ER-0437        TO EMI-ERROR
 10268                MOVE -1             TO PAYEEL
 10269                MOVE AL-UABON       TO PAYEEA
 10270                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10271
 10272*    IF PI-COMPANY-ID = 'CRI'
 10273*        IF CL-CLAIM-TYPE = 'L'
 10274*            MOVE 'N'                TO  WS-GROUPED
 10275*                                        PI-GROUPED
 10276*                                        GROUPEDI
 10277*            MOVE AL-UANON           TO  GROUPEDA
 10278*            GO TO 1050-EDIT-CHECK-NO
 10279*        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 193
* EL156.cbl
 10280*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10281*            IF WS-GROUP-1 = 'C'
 10282*                NEXT SENTENCE
 10283*            ELSE
 10284*                MOVE 'N'            TO  WS-GROUPED
 10285*                                        PI-GROUPED
 10286*                                        GROUPEDI
 10287*                MOVE AL-UANON       TO  GROUPEDA
 10288*                GO TO 1050-EDIT-CHECK-NO.
 10289
 10290*     IF PI-GROUPED = 'Y'
 10291*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10292*           NEXT SENTENCE
 10293*        ELSE
 10294*           MOVE ER-0437        TO EMI-ERROR
 10295*           MOVE -1             TO PAYEEL
 10296**02180            MOVE AL-UABON       TO PAYEEA
 10297*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10298*
 10299*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10300*        (PI-GROUPED    = ' ')
 10301*        NEXT SENTENCE
 10302*     ELSE
 10303*
 10304     GO TO 1050-EDIT-CHECK-NO.
 10305*     IF PI-COMPANY-ID = 'CRI'
 10306*        MOVE 'N'           TO GROUPEDI
 10307*                              PI-GROUPED
 10308*                              WS-GROUPED
 10309*        MOVE AL-UANON      TO GROUPEDA.
 10310*
 10311*     IF PI-COMPANY-ID = 'CRI'
 10312*        IF PI-PAYEE-TYPE = 'B'
 10313*           IF BENE-FOUND-SW = 'Y'
 10314*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10315*                 MOVE 'Y'           TO GROUPEDI
 10316*                                       PI-GROUPED
 10317*                                       WS-GROUPED
 10318*                 MOVE AL-UANON      TO GROUPEDA
 10319*              ELSE
 10320*                 NEXT SENTENCE
 10321*           ELSE
 10322*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10323*              IF BENE-FOUND-SW = 'Y'
 10324*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10325*                    MOVE 'Y'      TO GROUPEDI
 10326*                                     PI-GROUPED
 10327*                                     WS-GROUPED
 10328*                    MOVE AL-UANON TO GROUPEDA.
 10329*
 10330
 10331     IF PI-COMPANY-ID NOT = 'CRI'
 10332        GO TO 1050-EDIT-CHECK-NO.
 10333
 10334*************** CRI CODE START ******************
 10335     IF PI-PAYEE-TYPE NOT = 'A'
 10336        GO TO 1050-EDIT-CHECK-NO.
 10337
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 194
* EL156.cbl
 10338     MOVE LOW-VALUES             TO ERACCT-KEY.
 10339     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10340     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10341     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10342     MOVE PI-STATE               TO ACCT-STATE.
 10343     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10344     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10345     MOVE 'ACCT'                 TO FILE-SWITCH.
 10346
 10347     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10348     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10349
 10350
 10351* EXEC CICS HANDLE CONDITION
 10352*         NOTFND   (1950-NOT-FOUND)
 10353*         ENDFILE  (1950-NOT-FOUND)
 10354*    END-EXEC.
 10355*    MOVE '"$I''                  ! ( #00009979' TO DFHEIV0
 10356     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10358     MOVE X'2820233030303039393739' TO DFHEIV0(25:11)
 10359     CALL 'kxdfhei1' USING DFHEIV0
 10360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10361
 10362
 10363
 10364* EXEC CICS STARTBR
 10365*         DATASET   ('ERACCT')
 10366*         RIDFLD    (ERACCT-KEY)
 10367*         GTEQ
 10368*    END-EXEC.
 10369     MOVE 'ERACCT' TO DFHEIV1
 10370     MOVE 0
 10371       TO DFHEIV11
 10372*    MOVE '&,         G          &   #00009984' TO DFHEIV0
 10373     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10375     MOVE X'2020233030303039393834' TO DFHEIV0(25:11)
 10376     CALL 'kxdfhei1' USING DFHEIV0,
 10377           DFHEIV1,
 10378           ERACCT-KEY,
 10379           DFHEIV99,
 10380           DFHEIV11,
 10381           DFHEIV99
 10382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10383
 10384
 10385 1046-READNEXT-ERACCT.
 10386
 10387
 10388* EXEC CICS READNEXT
 10389*         DATASET   ('ERACCT')
 10390*         RIDFLD    (ERACCT-KEY)
 10391*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10392*    END-EXEC.
 10393     MOVE 'ERACCT' TO DFHEIV1
 10394     MOVE 0
 10395       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 195
* EL156.cbl
 10396*    MOVE '&.S                   )   #00009992' TO DFHEIV0
 10397     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10398     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10399     MOVE X'2020233030303039393932' TO DFHEIV0(25:11)
 10400     CALL 'kxdfhei1' USING DFHEIV0,
 10401           DFHEIV1,
 10402           DFHEIV20,
 10403           DFHEIV99,
 10404           ERACCT-KEY,
 10405           DFHEIV99,
 10406           DFHEIV11,
 10407           DFHEIV99,
 10408           DFHEIV99
 10409     SET ADDRESS OF ACCOUNT-MASTER TO
 10410         DFHEIV20
 10411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10412
 10413
 10414     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10415        IF WS-ERACCT-HOLD-RECORD = SPACES
 10416           GO TO 1950-NOT-FOUND
 10417        ELSE
 10418           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10419           GO TO 1048-CONTINUE.
 10420
 10421     IF ACCT-EXP-DT = HIGH-VALUES
 10422        NEXT SENTENCE
 10423     ELSE
 10424        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10425        GO TO 1046-READNEXT-ERACCT.
 10426
 10427 1048-CONTINUE.
 10428
 10429*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10430*       MOVE 'Y'                 TO GROUPEDI
 10431*                                   PI-GROUPED
 10432*                                   WS-GROUPED
 10433*       MOVE AL-UANON            TO GROUPEDA.
 10434*************** CRI CODE END ******************
 10435
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 196
* EL156.cbl
 10437 1050-EDIT-CHECK-NO.
 10438
 10439     IF PI-OFFLINE = 'Y'
 10440         IF PI-ECHECKNO = SPACES
 10441              MOVE ER-0439        TO EMI-ERROR
 10442              GO TO 1090-CHECK-NO-ERROR
 10443           ELSE
 10444*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10445*           IF PI-ECHECKNO-N = 'N' AND
 10446*              PI-CASH       = 'Y'
 10447*                MOVE ER-3535        TO EMI-ERROR
 10448*                GO TO 1090-CHECK-NO-ERROR
 10449*             ELSE
 10450*                MOVE AL-UANON    TO CHECKNOA
 10451*                GO TO 1100-EDIT-HOLDTIL
 10452*         ELSE
 10453            MOVE AL-UANON    TO CHECKNOA
 10454            GO TO 1100-EDIT-HOLDTIL.
 10455
 10456     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10457     MOVE '6'                    TO CNTL-REC-TYPE.
 10458
 10459     IF CONTROL-IS-ACTUAL-CARRIER
 10460         MOVE PI-CARRIER         TO WS-CARR
 10461     ELSE
 10462         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10463
 10464     IF PI-COMPANY-ID = 'FIA'
 10465         MOVE PI-CARRIER         TO WS-CARR.
 10466
 10467     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10468     MOVE 0                      TO CNTL-SEQ-NO.
 10469     MOVE 'CARR'                 TO FILE-SWITCH.
 10470
 10471     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10472
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 197
* EL156.cbl
 10474     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10475         GO TO 1051-EDIT-CHECKNO-CONT.
 10476
 10477**********************AIG LOGIC STARTS**********************
 10478     IF PI-ECHECKNO = SPACES
 10479         IF CHECK-NO-MANUAL
 10480             MOVE ER-0441        TO EMI-ERROR
 10481             GO TO 1090-CHECK-NO-ERROR
 10482         ELSE
 10483             MOVE AL-UANOF       TO CHECKNOA
 10484             GO TO 1100-EDIT-HOLDTIL.
 10485
 10486     IF PI-ECHECKNO NOT = SPACES
 10487         IF CHECK-NO-MANUAL
 10488             MOVE AL-UANON       TO CHECKNOA
 10489             GO TO 1100-EDIT-HOLDTIL.
 10490
 10491     IF PI-ECHECKNO-CR = 'CR'
 10492        IF PI-OFFLINE = 'Y'
 10493            MOVE AL-UANON       TO CHECKNOA
 10494            GO TO 1100-EDIT-HOLDTIL
 10495        ELSE
 10496            MOVE ER-3534        TO EMI-ERROR
 10497            GO TO 1090-CHECK-NO-ERROR.
 10498
 10499     IF PI-ECHECKNO-N = 'N'
 10500        IF PI-CASH = 'N'
 10501            MOVE AL-UANON       TO CHECKNOA
 10502            GO TO 1100-EDIT-HOLDTIL
 10503        ELSE
 10504            MOVE ER-3535          TO EMI-ERROR
 10505            GO TO 1090-CHECK-NO-ERROR.
 10506
 10507     MOVE ER-0442        TO EMI-ERROR
 10508     GO TO 1090-CHECK-NO-ERROR.
 10509**********************AIG LOGIC ENDS************************
 10510
 10511 1051-EDIT-CHECKNO-CONT.
 10512
 10513     IF PI-COMPANY-ID = 'DMD'
 10514        IF PI-ECHECKNO NOT = SPACES
 10515           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10516              MOVE ER-0442        TO EMI-ERROR
 10517              GO TO 1090-CHECK-NO-ERROR
 10518            ELSE
 10519              GO TO 1100-EDIT-HOLDTIL
 10520          ELSE
 10521           GO TO 1100-EDIT-HOLDTIL.
 10522
 10523     IF PI-ECHECKNO = SPACES
 10524         IF CHECK-NO-MANUAL
 10525             MOVE ER-0441        TO EMI-ERROR
 10526             GO TO 1090-CHECK-NO-ERROR
 10527         ELSE
 10528             MOVE AL-UANOF       TO CHECKNOA
 10529             GO TO 1100-EDIT-HOLDTIL
 10530     ELSE
 10531         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 198
* EL156.cbl
 10532             MOVE AL-UANON       TO CHECKNOA
 10533             GO TO 1100-EDIT-HOLDTIL
 10534         ELSE
 10535             MOVE ER-0442        TO EMI-ERROR
 10536             GO TO 1090-CHECK-NO-ERROR.
 10537
 10538 1090-CHECK-NO-ERROR.
 10539     MOVE -1                     TO CHECKNOL.
 10540     MOVE AL-UABON               TO CHECKNOA.
 10541     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10542
 10543     GO TO 2000-EDIT-DONE.
 10544
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 199
* EL156.cbl
 10546 1100-EDIT-HOLDTIL.
 10547     MOVE AL-UANON               TO HOLDTILA.
 10548
 10549     IF PI-HOLDTIL = ZEROS
 10550        IF PI-OFFLINE = 'Y'
 10551           MOVE ER-0572          TO EMI-ERROR
 10552           GO TO 1105-HOLDTIL-ERROR
 10553        ELSE
 10554           GO TO 1110-EDIT-PAID-FROM.
 10555
 10556     MOVE '4'                    TO DC-OPTION-CODE.
 10557     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10558     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10559
 10560     IF DATE-CONVERSION-ERROR
 10561         MOVE ER-0446            TO EMI-ERROR
 10562         GO TO 1105-HOLDTIL-ERROR
 10563     END-IF
 10564     IF PI-OFFLINE = 'Y'
 10565        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10566           MOVE ER-0446            TO EMI-ERROR
 10567           GO TO 1105-HOLDTIL-ERROR
 10568        END-IF
 10569     END-IF
 10570
 10571     IF PI-OFFLINE = 'Y'
 10572        GO TO 1110-EDIT-PAID-FROM.
 10573
 10574     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10575     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10576     MOVE '1'                    TO DC-OPTION-CODE.
 10577     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10578
 10579     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10580         MOVE ER-0447            TO EMI-ERROR
 10581         GO TO 1105-HOLDTIL-ERROR.
 10582
 10583     GO TO 1110-EDIT-PAID-FROM.
 10584
 10585 1105-HOLDTIL-ERROR.
 10586     MOVE -1                     TO HOLDTILL.
 10587     MOVE AL-UNBON               TO HOLDTILA.
 10588     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10589
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 200
* EL156.cbl
 10591 1110-EDIT-PAID-FROM.
 10592     MOVE AL-UANON               TO EPYFROMA.
 10593
 10594     IF PI-EPYFROM = ZEROS
 10595         GO TO 1120-CALCULATE-PAID-FROM.
 10596
 10597     IF PI-PMTTYPE = '5' OR '6'
 10598         MOVE ER-0448            TO EMI-ERROR
 10599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10600         MOVE AL-UNBON           TO EPYFROMA
 10601         MOVE -1                 TO EPYFROML
 10602         GO TO 1150-EDIT-PAID-THRU.
 10603
 10604     MOVE '4'                    TO DC-OPTION-CODE.
 10605     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10606     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10607
 10608     IF DATE-CONVERSION-ERROR
 10609         MOVE ER-0449            TO EMI-ERROR
 10610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10611         MOVE AL-UNBON           TO EPYFROMA
 10612         MOVE -1                 TO EPYFROML
 10613     ELSE
 10614         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10615
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 201
* EL156.cbl
 10617 1120-CALCULATE-PAID-FROM.
 10618     IF PI-PMTTYPE = '5' OR '6'
 10619         GO TO 1150-EDIT-PAID-THRU.
 10620
 10621*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10622*       IF PI-PMTTYPE = '4'
 10623*         GO TO 1150-EDIT-PAID-THRU.
 10624
 10625     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10626         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10627         MOVE ' '                TO DC-OPTION-CODE
 10628         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10629         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10630         GO TO 1145-TEST-PAID-FROM.
 10631
 10632     IF PI-PMTTYPE = '4'
 10633        GO TO 1150-EDIT-PAID-THRU.
 10634
 10635     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10636     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10637     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10638     MOVE '5'                    TO CNTL-REC-TYPE.
 10639     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10640     MOVE 'BENE'                 TO FILE-SWITCH.
 10641
 10642     IF WS-BEN-CD = ZEROS
 10643         GO TO 1950-NOT-FOUND.
 10644
 10645     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10646
 10647     IF NO-BENEFIT-FOUND
 10648         GO TO 1950-NOT-FOUND.
 10649
 10650     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10651     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10652
 10653     IF PI-BEN-DAYS NOT NUMERIC
 10654        MOVE ZEROS               TO PI-BEN-DAYS.
 10655
 10656     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10657
 10658     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10659        (CL-TOTAL-PAID-AMT > ZEROS)
 10660         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10661         MOVE '6'                 TO DC-OPTION-CODE
 10662         MOVE +0                  TO DC-ELAPSED-MONTHS
 10663         MOVE +1                  TO DC-ELAPSED-DAYS
 10664         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10665         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10666         GO TO 1145-TEST-PAID-FROM.
 10667
 10668******************************************************************
 10669****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10670****** SPECIAL ENTERED DATE.
 10671******************************************************************
 10672
 10673     IF PI-AIGFROM = ZEROS
 10674         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 202
* EL156.cbl
 10675
 10676     MOVE AL-UANON TO AIGFROMA.
 10677
 10678     MOVE '4'                    TO DC-OPTION-CODE.
 10679     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10680     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10681
 10682     IF DATE-CONVERSION-ERROR
 10683         MOVE ER-0449            TO EMI-ERROR
 10684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10685         MOVE AL-UNBON           TO AIGFROMA
 10686         MOVE -1                 TO AIGFROML
 10687         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10688     ELSE
 10689         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10690         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10691
 10692     GO TO 1140-CONTINUE-PAID-FROM.
 10693
 10694 1130-CONTINUE-PAID-FROM.
 10695
 10696     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10697        (CL-TOTAL-PAID-AMT = ZEROS)
 10698           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10699
 10700 1140-CONTINUE-PAID-FROM.
 10701
 10702     IF PI-BEN-TYPE = 'R'
 10703         IF PI-BEN-DAYS = ZEROS
 10704             NEXT SENTENCE
 10705         ELSE
 10706         IF PI-COMPANY-ID NOT = 'DMD'
 10707             SUBTRACT 1 FROM PI-BEN-DAYS.
 10708
 10709     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10710
 10711     IF PI-COMPANY-ID = 'DMD'
 10712         MOVE -1                 TO DC-ELAPSED-DAYS
 10713         MOVE +0                 TO DC-ELAPSED-MONTHS
 10714         MOVE '6'                TO DC-OPTION-CODE
 10715         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10716         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10717         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10718                               REMAINDER DC-ELAPSED-DAYS
 10719      ELSE
 10720         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10721         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10722
 10723     MOVE '6'                    TO DC-OPTION-CODE.
 10724     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10725     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10726
 10727     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10728
 10729     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10730         MOVE ER-0541            TO EMI-ERROR
 10731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10732         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 203
* EL156.cbl
 10733         MOVE AL-UNBON           TO EPYFROMA.
 10734
 10735     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10736        (PI-BENEFIT-SAVE = '60E')
 10737        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10738           (CL-TOTAL-PAID-AMT = ZEROS)
 10739             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10740             MOVE 30                  TO DC-ELAPSED-DAYS
 10741             MOVE +0                  TO DC-ELAPSED-MONTHS
 10742             MOVE '6'                 TO DC-OPTION-CODE
 10743             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10744
 10745     IF PI-BEN-TYPE = 'R'
 10746         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10747     ELSE
 10748         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10749         IF WS-SV-EPYFROM = LOW-VALUES
 10750            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10751
 10752     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10753         IF WS-USE-AIG-PAYFROM   OR
 10754            WS-AIG-RECALC-PAYFROM
 10755              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10756                                      DC-BIN-DATE-1
 10757              MOVE ' '            TO  DC-OPTION-CODE
 10758              MOVE +0             TO  DC-ELAPSED-MONTHS
 10759                                      DC-ELAPSED-DAYS
 10760              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10761              IF NO-CONVERSION-ERROR
 10762                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10763
 10764     IF PI-CPYFROM < CL-INCURRED-DT
 10765        MOVE -1                  TO EPYFROML
 10766        MOVE ER-3542             TO EMI-ERROR
 10767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10768
 10769     IF CM-ENTRY-DT < CL-INCURRED-DT
 10770        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10771        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10772        MOVE +0                     TO DC-ELAPSED-DAYS
 10773        MOVE +0                     TO DC-ELAPSED-MONTHS
 10774        MOVE '1'                    TO DC-OPTION-CODE
 10775        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10776        ELSE
 10777        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10778
 10779     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10780         NEXT SENTENCE
 10781     ELSE
 10782         IF DC-ELAPSED-MONTHS < 2
 10783             MOVE ER-3255        TO EMI-ERROR
 10784             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10785
 10786 1145-TEST-PAID-FROM.
 10787     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10788         GO TO 1150-EDIT-PAID-THRU.
 10789
 10790     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 204
* EL156.cbl
 10791         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10792         MOVE ' '                TO DC-OPTION-CODE
 10793         MOVE +0                 TO DC-ELAPSED-MONTHS
 10794                                    DC-ELAPSED-DAYS
 10795         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10796         IF NO-CONVERSION-ERROR
 10797             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10798         ELSE
 10799             MOVE SPACES             TO EMI-DATE-FIELD.
 10800
 10801     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10802         IF CL-TOTAL-PAID-AMT = ZEROS
 10803             MOVE ER-3543            TO EMI-ERROR
 10804             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10805             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10806             IF EMI-MESSAGE-FORMATTED
 10807                MOVE -1             TO EPYFROML
 10808                MOVE AL-UNBON       TO EPYFROMA
 10809             ELSE
 10810                NEXT SENTENCE
 10811         ELSE
 10812             MOVE ER-0452            TO EMI-ERROR
 10813             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10815             IF EMI-MESSAGE-FORMATTED
 10816                MOVE -1             TO EPYFROML
 10817                MOVE AL-UNBON       TO EPYFROMA.
 10818
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 205
* EL156.cbl
 10820 1150-EDIT-PAID-THRU.
 10821
 10822     MOVE AL-UANON               TO EPYTHRUA.
 10823
 10824     IF PI-EPYTHRU = ZEROS
 10825*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10826         IF PI-PMTTYPE = '5' OR '6'
 10827           OR (CL-CLAIM-TYPE NOT = 'L' AND PI-PMTTYPE = '4')
 10828             GO TO 1200-EDIT-FIND-TOLERANCES
 10829         ELSE
 10830            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10831               (PI-PMTTYPE = '2' AND
 10832                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10833               GO TO 1152-CHECK-TYPE
 10834            ELSE
 10835               MOVE ER-0473      TO EMI-ERROR
 10836               GO TO 1170-PAID-THRU-FATAL-ERROR
 10837     ELSE
 10838         IF PI-PMTTYPE = '5' OR '6'
 10839             MOVE ER-0474        TO EMI-ERROR
 10840             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10841
 10842     MOVE '4'                    TO DC-OPTION-CODE.
 10843     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10844     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10845
 10846     IF DATE-CONVERSION-ERROR
 10847         MOVE ER-0475            TO EMI-ERROR
 10848         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10849
 10850     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10851
 10852     IF PI-COMPANY-ID = 'DMD'
 10853         IF PI-PMTTYPE NOT = '2'
 10854                 AND
 10855            WS-EXP-DT > WS-SV-EPYTHRU
 10856             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10857             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10858             MOVE '1'              TO DC-OPTION-CODE
 10859             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10860             IF DATE-CONVERSION-ERROR
 10861                 MOVE ER-0944      TO EMI-ERROR
 10862                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10863             ELSE
 10864                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10865                    DC-ELAPSED-DAYS   = 1
 10866                     MOVE ER-0945  TO EMI-ERROR
 10867                     MOVE -1       TO EPYTHRUL
 10868                     MOVE AL-UABON TO EPYTHRUA
 10869                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10870
 10871     IF PI-PMTTYPE = '4'
 10872         NEXT SENTENCE
 10873     ELSE
 10874         IF WS-SV-EPYTHRU = WS-EXP-DT
 10875             IF PI-PMTTYPE NOT = '2' AND '3'
 10876                 MOVE ER-3541    TO EMI-ERROR
 10877                 MOVE -1         TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 206
* EL156.cbl
 10878                 MOVE AL-UABON   TO PMTTYPEA
 10879                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10880
 10881     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10882         MOVE ER-0501            TO EMI-ERROR
 10883         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10884
 10885     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10886        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10887*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10888*              MOVE ER-0540         TO EMI-ERROR
 10889*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10890*              MOVE -1              TO EPYTHRUL
 10891*              MOVE AL-UNBON        TO EPYTHRUA
 10892*          ELSE
 10893*          IF PI-COMPANY-ID = 'DMD'
 10894*              MOVE ER-7540         TO EMI-ERROR
 10895*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10896*              MOVE -1              TO EPYTHRUL
 10897*              MOVE AL-UNBON        TO EPYTHRUA
 10898*          ELSE
 10899               IF PI-PMTTYPE NOT = '2' AND '3'
 10900                  IF PI-COMPANY-ID = '???'
 10901                      MOVE ER-7540  TO EMI-ERROR
 10902                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10903                      MOVE -1       TO EPYTHRUL
 10904                      MOVE AL-UNBON TO EPYTHRUA
 10905                  ELSE
 10906                      MOVE ER-0540  TO EMI-ERROR
 10907                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10908                      MOVE -1       TO EPYTHRUL
 10909                      MOVE AL-UNBON TO EPYTHRUA.
 10910
 10911     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10912            OR
 10913        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10914         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10915            OR
 10916        (PI-CPYFROM NOT = LOW-VALUES AND
 10917         PI-CPYFROM < CL-PAID-THRU-DT)
 10918        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10919
 10920 1152-CHECK-TYPE.
 10921     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10922        OR (PI-PMTTYPE = '5' OR '6')
 10923         GO TO 1160-EDIT-PAID-THRU-AH.
 10924
 10925 1155-EDIT-PAID-THRU-LIFE.
 10926     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10927     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10928     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10929     MOVE '4'                    TO CNTL-REC-TYPE.
 10930     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10931     MOVE 'BENE'                 TO FILE-SWITCH.
 10932
 10933     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10934
 10935     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 207
* EL156.cbl
 10936         GO TO 1950-NOT-FOUND.
 10937
 10938     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10939
 10940     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10941
 10942     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10943        PI-LF-COVERAGE-TYPE = 'P'
 10944         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10945         GO TO 1200-EDIT-FIND-TOLERANCES.
 10946
 10947     IF PI-EPYTHRU = ZEROS
 10948        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10949
 10950     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10951         MOVE ER-0476            TO EMI-ERROR
 10952         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10953
 10954     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10955*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10956     move cl-critical-period    to dc-elapsed-months
 10957     MOVE +0                    TO DC-ELAPSED-DAYS.
 10958     MOVE '6'                   TO DC-OPTION-CODE.
 10959     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10960
 10961     IF (NO-CONVERSION-ERROR AND
 10962         WS-SPECIAL-CALC-CD = 'C')
 10963        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10964            MOVE ER-0657 TO EMI-ERROR
 10965            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10966
 10967     IF PI-COMPANY-ID = 'NCL'
 10968         IF WS-SPECIAL-CALC-CD = 'C' AND
 10969            cl-critical-period = zeros
 10970*           CM-LF-CRITICAL-PERIOD = +0
 10971             MOVE ER-0844       TO EMI-ERROR
 10972             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10973
 10974     GO TO 1200-EDIT-FIND-TOLERANCES.
 10975
 10976 1160-EDIT-PAID-THRU-AH.
 10977     IF PI-EPYTHRU = ZEROS
 10978        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10979                                    WS-SV-EPYTHRU
 10980     ELSE
 10981        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10982
 10983     IF WS-SV-EPYTHRU < PI-CPYFROM
 10984         MOVE ER-0508            TO EMI-ERROR
 10985         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10986
 10987     perform 7975-read-acct      thru 7975-exit
 10988     move zeros                  to pi-max-ext
 10989     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10990        PERFORM 0900-GET-DDF-LIMITS
 10991                                 THRU 0900-EXIT
 10992        IF PDEF-FOUND
 10993           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 208
* EL156.cbl
 10994              (P1 > +8)
 10995              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10996           END-PERFORM
 10997           IF P1 < +9
 10998              MOVE PD-MAX-extension (P1)
 10999                                 TO pi-max-ext
 11000           else
 11001              move er-1674       to emi-error
 11002              PERFORM 9900-ERROR-FORMAT
 11003                                 THRU 9900-EXIT
 11004           END-IF
 11005        else
 11006           move er-1672          to emi-error
 11007           PERFORM 9900-ERROR-FORMAT
 11008                                 THRU 9900-EXIT
 11009        END-IF
 11010     end-if
 11011     move spaces                 to pi-max-ext-used
 11012     IF PI-PMTTYPE = '3'
 11013        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11014        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11015           MOVE ER-0477          TO EMI-ERROR
 11016           PERFORM 1165-PAID-THRU-ERROR
 11017                                 THRU 1165-EXIT
 11018        ELSE
 11019           continue
 11020        end-if
 11021     ELSE
 11022        IF WS-SV-EPYTHRU > WS-EXP-DT
 11023           move ws-exp-dt        to dc-bin-date-1
 11024           move ws-sv-epythru    to dc-bin-date-2
 11025           MOVE '1'              TO DC-OPTION-CODE
 11026           MOVE +0               TO DC-ELAPSED-DAYS
 11027                                    DC-ELAPSED-MONTHS
 11028           PERFORM 9700-LINK-DATE-CONVERT
 11029                                 THRU 9700-EXIT
 11030           if no-conversion-error
 11031              if dc-elapsed-days > zeros
 11032                 add +1 to dc-elapsed-months
 11033              end-if
 11034              if dc-elapsed-months > pi-max-ext
 11035                 MOVE ER-0557    TO EMI-ERROR
 11036                 PERFORM 1165-PAID-THRU-ERROR
 11037                                 THRU 1165-EXIT
 11038              else
 11039                 move 'Y'        to pi-max-ext-used
 11040                 move er-1670    to emi-error
 11041                 perform 9900-error-format
 11042                                 thru 9900-exit
 11043              end-if
 11044           end-if
 11045        end-if
 11046     end-if
 11047
 11048     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11049         PI-PMTTYPE NOT = '3'
 11050         MOVE ER-0541        TO EMI-ERROR
 11051         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 209
* EL156.cbl
 11052
 11053     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11054        (PI-PMTTYPE NOT = '3')
 11055         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11056             MOVE ER-0478        TO EMI-ERROR
 11057             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11058
 11059     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11060        (PI-PMTTYPE NOT = '4')
 11061         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11062             MOVE ER-0479        TO EMI-ERROR
 11063             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11064
 11065     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11066         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11067             MOVE ER-0545        TO EMI-ERROR
 11068             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11069
 11070     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11071         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11072             MOVE ER-0481        TO EMI-ERROR
 11073             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11074
 11075*    IF PI-COMPANY-ID = 'NCL'
 11076*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11077*           CM-AH-CRITICAL-PERIOD = +0
 11078*            MOVE ER-0844        TO  EMI-ERROR
 11079*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11080
 11081*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11082     if (cl-critical-period = zeros)
 11083        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11084          GO TO 1200-EDIT-FIND-TOLERANCES.
 11085
 11086     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11087     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11088     MOVE '1'        TO DC-OPTION-CODE.
 11089     MOVE +0         TO DC-ELAPSED-DAYS
 11090                        DC-ELAPSED-MONTHS.
 11091     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11092
 11093*    IF NO-CONVERSION-ERROR
 11094*       COMPUTE ws-benefits-paid =
 11095*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11096*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11097*           MOVE ER-0657 TO EMI-ERROR
 11098*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11099
 11100     GO TO 1200-EDIT-FIND-TOLERANCES.
 11101
 11102 1165-PAID-THRU-ERROR.
 11103     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11104
 11105     IF EMI-MESSAGE-FORMATTED
 11106         MOVE -1                 TO EPYTHRUL
 11107         MOVE AL-UNBON           TO EPYTHRUA.
 11108
 11109 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 210
* EL156.cbl
 11110     EXIT.
 11111
 11112 1166-CHECK-ALL-TRLRS.
 11113
 11114     IF PI-PMTTYPE = '4'
 11115        GO TO 1166-TRLR-EXIT.
 11116
 11117     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11118
 11119     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11120        WS-SV-EPYFROM = LOW-VALUES
 11121          GO TO 1166-END-CHECK.
 11122
 11123
 11124* EXEC CICS HANDLE CONDITION
 11125*        ENDFILE   (1166-END-CHECK)
 11126*        NOTFND    (1166-END-CHECK)
 11127*    END-EXEC.
 11128*    MOVE '"$''I                  ! ) #00010707' TO DFHEIV0
 11129     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11131     MOVE X'2920233030303130373037' TO DFHEIV0(25:11)
 11132     CALL 'kxdfhei1' USING DFHEIV0
 11133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11134
 11135
 11136     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11137     MOVE +100                   TO TRLR-SEQ-NO.
 11138
 11139
 11140* EXEC CICS STARTBR
 11141*         DATASET    ('ELTRLR')
 11142*         RIDFLD     (ELTRLR-KEY)
 11143*         GTEQ
 11144*    END-EXEC.
 11145     MOVE 'ELTRLR' TO DFHEIV1
 11146     MOVE 0
 11147       TO DFHEIV11
 11148*    MOVE '&,         G          &   #00010715' TO DFHEIV0
 11149     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11150     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11151     MOVE X'2020233030303130373135' TO DFHEIV0(25:11)
 11152     CALL 'kxdfhei1' USING DFHEIV0,
 11153           DFHEIV1,
 11154           ELTRLR-KEY,
 11155           DFHEIV99,
 11156           DFHEIV11,
 11157           DFHEIV99
 11158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11159
 11160
 11161     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11162
 11163 1166-READ-TRLR-NEXT.
 11164
 11165
 11166* EXEC CICS READNEXT
 11167*         DATASET    ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 211
* EL156.cbl
 11168*         RIDFLD     (ELTRLR-KEY)
 11169*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11170*    END-EXEC.
 11171     MOVE 'ELTRLR' TO DFHEIV1
 11172     MOVE 0
 11173       TO DFHEIV11
 11174*    MOVE '&.S                   )   #00010725' TO DFHEIV0
 11175     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11176     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11177     MOVE X'2020233030303130373235' TO DFHEIV0(25:11)
 11178     CALL 'kxdfhei1' USING DFHEIV0,
 11179           DFHEIV1,
 11180           DFHEIV20,
 11181           DFHEIV99,
 11182           ELTRLR-KEY,
 11183           DFHEIV99,
 11184           DFHEIV11,
 11185           DFHEIV99,
 11186           DFHEIV99
 11187     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11188         DFHEIV20
 11189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11190
 11191
 11192     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11193        TRLR-CARRIER  = MSTR-CARRIER  AND
 11194        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11195        TRLR-CERT-NO  = MSTR-CERT-NO
 11196          NEXT SENTENCE
 11197      ELSE
 11198          GO TO 1166-END-CHECK.
 11199
 11200* **  BYPASS ALL NON-PAYMENT TRAILERS
 11201
 11202     IF AT-TRAILER-TYPE = '2'
 11203        NEXT SENTENCE
 11204     ELSE
 11205        GO TO 1166-READ-TRLR-NEXT.
 11206
 11207* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11208
 11209     IF AT-PAYMENT-TYPE = '1' OR '2'
 11210        NEXT SENTENCE
 11211     ELSE
 11212        GO TO 1166-READ-TRLR-NEXT.
 11213
 11214* **  BYPASS ALL VOID PAYMENTS
 11215
 11216     IF AT-VOID-DT NOT = LOW-VALUES
 11217        GO TO 1166-READ-TRLR-NEXT.
 11218
 11219     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11220        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11221          GO TO 1166-READ-TRLR-NEXT.
 11222
 11223     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11224         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11225            OR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 212
* EL156.cbl
 11226        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11227         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11228        NEXT SENTENCE
 11229     ELSE
 11230         IF CL-TOTAL-PAID-AMT > ZEROS
 11231             MOVE ER-0502            TO EMI-ERROR
 11232             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11233             MOVE -1                 TO EPYTHRUL
 11234             MOVE AL-UNBON           TO EPYTHRUA.
 11235
 11236     GO TO 1166-READ-TRLR-NEXT.
 11237
 11238 1166-END-CHECK.
 11239
 11240     IF WS-BROWSE-TRLR-SW = 'Y'
 11241
 11242* EXEC CICS ENDBR
 11243*            DATASET   ('ELTRLR')
 11244*       END-EXEC.
 11245     MOVE 'ELTRLR' TO DFHEIV1
 11246     MOVE 0
 11247       TO DFHEIV11
 11248*    MOVE '&2                    $   #00010780' TO DFHEIV0
 11249     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11250     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11251     MOVE X'2020233030303130373830' TO DFHEIV0(25:11)
 11252     CALL 'kxdfhei1' USING DFHEIV0,
 11253           DFHEIV1,
 11254           DFHEIV11,
 11255           DFHEIV99
 11256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11257
 11258
 11259     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11260
 11261 1166-TRLR-EXIT.
 11262     EXIT.
 11263
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 213
* EL156.cbl
 11265 1170-PAID-THRU-FATAL-ERROR.
 11266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11267
 11268     MOVE -1                     TO EPYTHRUL.
 11269     MOVE AL-UNBON               TO EPYTHRUA.
 11270
 11271 1200-EDIT-FIND-TOLERANCES.
 11272
 11273* EXEC CICS HANDLE CONDITION
 11274*        ENDFILE(1950-NOT-FOUND)
 11275*        NOTFND (1950-NOT-FOUND)
 11276*    END-EXEC.
 11277*    MOVE '"$''I                  ! * #00010797' TO DFHEIV0
 11278     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11280     MOVE X'2A20233030303130373937' TO DFHEIV0(25:11)
 11281     CALL 'kxdfhei1' USING DFHEIV0
 11282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11283
 11284
 11285     IF PI-PROCESSOR-ID = 'LGXX'
 11286        GO TO 1240-FIND-ACCT-TOLERANCES.
 11287
 11288     MOVE 'N'                    TO FOUND-TOL-SW.
 11289     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11290     MOVE '2'                    TO CNTL-REC-TYPE.
 11291     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11292     MOVE +0                     TO CNTL-SEQ-NO.
 11293     MOVE 'PROC'                 TO FILE-SWITCH.
 11294
 11295     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11296
 11297     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11298     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11299                                    PI-MAX-PMT-TOL.
 11300     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11301
 11302     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11303         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11304
 11305     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11306     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11307                                    PI-MAX-LF-PMT-TOL.
 11308
 11309     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11310         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11311
 11312     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11313                                    PI-MAX-EXP-PMT.
 11314
 11315 1240-FIND-ACCT-TOLERANCES.
 11316
 11317     IF WS-PMT-TOL NOT = +0
 11318         MOVE 'Y'                TO FOUND-TOL-SW.
 11319
 11320     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11321         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11322         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 214
* EL156.cbl
 11323         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11324         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11325         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11326         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11327     ELSE
 11328         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11329         MOVE PI-CARRIER             TO ACCT-CARRIER
 11330         MOVE PI-GROUPING            TO ACCT-GROUPING
 11331         MOVE PI-STATE               TO ACCT-STATE
 11332         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11333         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11334
 11335     MOVE 'ACCT'                 TO FILE-SWITCH.
 11336
 11337     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11338     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11339
 11340
 11341* EXEC CICS HANDLE CONDITION
 11342*         NOTFND   (1950-NOT-FOUND)
 11343*         ENDFILE  (1950-NOT-FOUND)
 11344*    END-EXEC.
 11345*    MOVE '"$I''                  ! + #00010857' TO DFHEIV0
 11346     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11348     MOVE X'2B20233030303130383537' TO DFHEIV0(25:11)
 11349     CALL 'kxdfhei1' USING DFHEIV0
 11350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11351
 11352
 11353
 11354* EXEC CICS STARTBR
 11355*        DATASET('ERACCT')
 11356*        RIDFLD (ERACCT-KEY)
 11357*        GTEQ
 11358*    END-EXEC.
 11359     MOVE 'ERACCT' TO DFHEIV1
 11360     MOVE 0
 11361       TO DFHEIV11
 11362*    MOVE '&,         G          &   #00010862' TO DFHEIV0
 11363     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11364     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11365     MOVE X'2020233030303130383632' TO DFHEIV0(25:11)
 11366     CALL 'kxdfhei1' USING DFHEIV0,
 11367           DFHEIV1,
 11368           ERACCT-KEY,
 11369           DFHEIV99,
 11370           DFHEIV11,
 11371           DFHEIV99
 11372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11373
 11374
 11375 1245-FIND-ACCT-TOLERANCES-LOOP.
 11376
 11377
 11378* EXEC CICS READNEXT
 11379*        DATASET('ERACCT')
 11380*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 215
* EL156.cbl
 11381*        RIDFLD (ERACCT-KEY)
 11382*    END-EXEC.
 11383     MOVE 'ERACCT' TO DFHEIV1
 11384     MOVE 0
 11385       TO DFHEIV11
 11386*    MOVE '&.S                   )   #00010870' TO DFHEIV0
 11387     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11388     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11389     MOVE X'2020233030303130383730' TO DFHEIV0(25:11)
 11390     CALL 'kxdfhei1' USING DFHEIV0,
 11391           DFHEIV1,
 11392           DFHEIV20,
 11393           DFHEIV99,
 11394           ERACCT-KEY,
 11395           DFHEIV99,
 11396           DFHEIV11,
 11397           DFHEIV99,
 11398           DFHEIV99
 11399     SET ADDRESS OF ACCOUNT-MASTER TO
 11400         DFHEIV20
 11401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11402
 11403
 11404     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11405        IF WS-ERACCT-HOLD-RECORD = SPACES
 11406           GO TO 1950-NOT-FOUND
 11407        ELSE
 11408           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11409           GO TO 1250-CONTINUE.
 11410
 11411     IF ACCT-EXP-DT = HIGH-VALUES
 11412        NEXT SENTENCE
 11413     ELSE
 11414        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11415        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11416
 11417 1250-CONTINUE.
 11418
 11419     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11420
 11421     IF FOUND-TOL-SW = 'N'
 11422         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11423
 11424********* 1260-FIND-STATE-TOLERANCES.
 11425
 11426     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11427     MOVE PI-STATE               TO WS-ST-ACCESS.
 11428     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11429     MOVE '3'                    TO CNTL-REC-TYPE.
 11430     MOVE +0                     TO CNTL-SEQ-NO.
 11431     MOVE 'STAT'                 TO FILE-SWITCH.
 11432
 11433     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11434
 11435     IF WS-PMT-TOL = +0
 11436         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11437
 11438     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 216
* EL156.cbl
 11439     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11440     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11441     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11442     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11443
 11444****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11445****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11446     IF PI-PAYEE-TYPE <> 'B'
 11447           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11448     END-IF.
 11449
 11450     IF PI-PMTTYPE      = '2'  AND
 11451        PI-SPLIT-PMT-SW = 'Y'  AND
 11452        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11453          MOVE ER-3530                TO EMI-ERROR
 11454          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11455
 11456********* 1280-FIND-BENEFIT-TOLERANCES.
 11457
 11458     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11459        OR (PI-PMTTYPE = '5' OR '6')
 11460         GO TO 1300-FIND-CARR-TOLERANCES.
 11461
 11462     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11463     MOVE '4'                    TO CNTL-REC-TYPE.
 11464     MOVE +0                     TO CNTL-SEQ-NO.
 11465     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11466     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11467     MOVE 'BENE'                 TO FILE-SWITCH.
 11468
 11469     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11470
 11471     IF NO-BENEFIT-FOUND
 11472         GO TO 1950-NOT-FOUND.
 11473
 11474     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11475     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11476     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11477
 11478
 11479* EXEC CICS HANDLE CONDITION
 11480*        NOTFND(1950-NOT-FOUND)
 11481*    END-EXEC.
 11482*    MOVE '"$I                   ! , #00010950' TO DFHEIV0
 11483     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11485     MOVE X'2C20233030303130393530' TO DFHEIV0(25:11)
 11486     CALL 'kxdfhei1' USING DFHEIV0
 11487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11488
 11489
 11490 1300-FIND-CARR-TOLERANCES.
 11491     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11492     MOVE '6'                    TO CNTL-REC-TYPE.
 11493
 11494     IF CONTROL-IS-ACTUAL-CARRIER
 11495         MOVE PI-CARRIER               TO WS-CARR
 11496     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 217
* EL156.cbl
 11497         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11498
 11499     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11500     MOVE +0                     TO CNTL-SEQ-NO.
 11501     MOVE 'CARR'                 TO FILE-SWITCH.
 11502
 11503     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11504
 11505     IF WS-DAYS-TOL = +0
 11506         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11507
 11508     IF WS-PMT-TOL = +0
 11509         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11510
 11511     IF WS-MAX-DAYS-TOL = +0
 11512         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11513
 11514     IF WS-MAX-PMT-TOL = +0
 11515         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11516                                    PI-MAX-PMT-TOL.
 11517
 11518     IF WS-MAX-LF-PMT-TOL = +0
 11519        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11520                                    PI-MAX-LF-PMT-TOL.
 11521
 11522     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11523
 11524********* 1320-FIND-COMP-TOLERANCES.
 11525
 11526     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11527     MOVE '1'                    TO CNTL-REC-TYPE.
 11528     MOVE SPACES                 TO CNTL-ACCESS.
 11529     MOVE +0                     TO CNTL-SEQ-NO.
 11530     MOVE 'COMP'                 TO FILE-SWITCH.
 11531
 11532     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11533
 11534     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11535     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11536
 11537     IF WS-PMT-TOL NOT = +0
 11538        IF WS-TOL-SEVERITY NOT = ' '
 11539         GO TO 1360-EDIT-DAYS.
 11540
 11541     IF WS-PMT-TOL = +0
 11542         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11543
 11544     IF WS-TOL-SEVERITY = ' '
 11545         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11546
 11547 1360-EDIT-DAYS.
 11548     IF PI-PMTTYPE NOT = '4'
 11549        IF PI-EDAYS NEGATIVE OR
 11550           PI-EPYAMT NEGATIVE
 11551          MOVE ER-0513             TO EMI-ERROR
 11552          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11553          MOVE -1                  TO PMTTYPEL.
 11554
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 218
* EL156.cbl
 11555     IF PI-PMTTYPE = '5' OR '6'
 11556        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11557
 11558     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11559        IF PI-PMTTYPE = '4'
 11560          MOVE PI-EDAYS          TO PI-CDAYS.
 11561
 11562     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11563         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11564
 11565     IF PI-PMTTYPE = '4'
 11566        MOVE PI-EDAYS            TO PI-CDAYS
 11567        GO TO 1400-EDIT-PAYMENT.
 11568
 11569     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11570        GO TO 1500-EDIT-EXPENSES.
 11571
 11572*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11573*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11574*          CM-AH-BENEFIT-CD = '23'              AND
 11575*          CL-CERT-STATE    = '04'              AND
 11576*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11577*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11578*            GO TO 1362-CHECK-MAX-DAYS.
 11579
 11580     IF PI-EDAYS = ZEROS
 11581*        IF PI-COMPANY-ID = 'DMD'
 11582*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11583*            MOVE -1             TO DC-ELAPSED-DAYS
 11584*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11585*            MOVE '6'            TO DC-OPTION-CODE
 11586*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11587*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11588*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11589*            MOVE '1'            TO DC-OPTION-CODE
 11590*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11591*            IF NO-CONVERSION-ERROR
 11592*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11593*                                 + DC-ODD-DAYS-OVER
 11594*               MOVE 6           TO EDAYSL
 11595*               MOVE AL-UNNON    TO EDAYSA
 11596*            ELSE
 11597*                NEXT SENTENCE
 11598*       ELSE
 11599            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11600            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11601            MOVE '1'             TO DC-OPTION-CODE
 11602            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11603            IF NO-CONVERSION-ERROR
 11604                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11605                ADD 1                 TO PI-EDAYS
 11606                MOVE AL-UNNON         TO EDAYSA.
 11607
 11608*    IF PI-COMPANY-ID = 'DMD'
 11609*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11610*        MOVE -1                 TO DC-ELAPSED-DAYS
 11611*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11612*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 219
* EL156.cbl
 11613*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11614*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11615*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11616*        MOVE '1'                TO DC-OPTION-CODE
 11617*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11618*    ELSE
 11619         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11620         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11621         MOVE '1'                TO DC-OPTION-CODE.
 11622         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11623
 11624     IF NO-CONVERSION-ERROR
 11625        IF PI-COMPANY-ID = 'DMD'
 11626            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11627                             + DC-ODD-DAYS-OVER
 11628        ELSE
 11629            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11630            ADD 1                TO PI-CDAYS.
 11631
 11632     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11633        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11634        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11635
 11636     IF PI-EDAYS NOT NUMERIC
 11637         MOVE ER-0491            TO EMI-ERROR
 11638         GO TO 1370-DAYS-ERROR.
 11639
 11640     IF CL-NO-OF-PMTS-MADE = 0
 11641        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11642        AND CL-CERT-STATE = 'MI'
 11643        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11644            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11645     END-IF.
 11646
 11647 1362-CHECK-MAX-DAYS.
 11648
 11649     IF WS-MAX-DAYS-TOL = +999
 11650         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11651
 11652     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11653         IF PI-EDAYS = ZEROS
 11654             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11655         ELSE
 11656             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11657
 11658     IF WS-MAX-DAYS-TOL NOT = ZERO
 11659        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11660           PI-CDAYS > WS-MAX-DAYS-TOL
 11661             MOVE ER-0492          TO EMI-ERROR
 11662             GO TO 1370-DAYS-ERROR.
 11663
 11664 1365-SKIP-MAX-DAYS-EDIT.
 11665     IF PI-EDAYS = ZEROS
 11666        GO TO 1400-EDIT-PAYMENT.
 11667
 11668     IF WS-DAYS-TOL NOT = ZERO
 11669        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11670           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 220
* EL156.cbl
 11671                MOVE ER-0493     TO EMI-ERROR
 11672                GO TO 1370-DAYS-ERROR.
 11673
 11674     GO TO 1400-EDIT-PAYMENT.
 11675
 11676 1370-DAYS-ERROR.
 11677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11678
 11679     IF EMI-MESSAGE-FORMATTED
 11680         MOVE -1                 TO EDAYSL
 11681         MOVE AL-UABON           TO EDAYSA.
 11682
 11683     GO TO 1400-EDIT-PAYMENT.
 11684
 11685 1380-EDIT-EXPENSE-PMT-AMT.
 11686     IF PI-PMTTYPE = '5' OR '6'
 11687         NEXT SENTENCE
 11688     ELSE
 11689         GO TO 1400-EDIT-PAYMENT.
 11690
 11691     IF WS-MAX-EXP-PMT NOT = ZEROS
 11692        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11693            MOVE ER-3529            TO EMI-ERROR
 11694            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11695
 11696     GO TO 1500-EDIT-EXPENSES.
 11697
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 221
* EL156.cbl
 11699
 11700 1390-CHECK-PAYMENT-DAYS.
 11701
 11702     IF PI-EDAYS = 0
 11703         MOVE PI-CDAYS TO WS-PD-DAYS
 11704     ELSE
 11705         MOVE PI-EDAYS TO WS-PD-DAYS
 11706     END-IF.
 11707
 11708     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11709         IF WS-PD-DAYS = 14
 11710            GO TO 1390-EXIT
 11711         END-IF
 11712     END-IF.
 11713
 11714     IF PI-COMPANY-ID = 'AHL'  AND
 11715        CM-AH-BENEFIT-CD = '1K'
 11716         IF WS-PD-DAYS = 14
 11717            GO TO 1390-EXIT
 11718         END-IF
 11719     END-IF.
 11720
 11721     IF WS-PD-DAYS < 30
 11722         MOVE ER-3549              TO EMI-ERROR
 11723         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11724     END-IF.
 11725
 11726 1390-EXIT.
 11727      EXIT.
 11728
 11729 1400-EDIT-PAYMENT.
 11730*    IF PI-COMPANY-ID = 'DMD'
 11731*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11732*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11733
 11734     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 11735        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11736        MOVE PI-CARRIER          TO ACCT-CARRIER
 11737        MOVE PI-GROUPING         TO ACCT-GROUPING
 11738        MOVE PI-STATE            TO ACCT-STATE
 11739        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11740        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11741        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11742        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11743
 11744
 11745* EXEC CICS READ
 11746*          DATASET ('ERACCT')
 11747*          RIDFLD  (ERACCT-KEY)
 11748*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11749*          GTEQ
 11750*          resp    (WS-RESPONSE)
 11751*       END-EXEC
 11752     MOVE 'ERACCT' TO DFHEIV1
 11753*    MOVE '&"S        G          (  N#00011208' TO DFHEIV0
 11754     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11756     MOVE X'204E233030303131323038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 222
* EL156.cbl
 11757     CALL 'kxdfhei1' USING DFHEIV0,
 11758           DFHEIV1,
 11759           DFHEIV20,
 11760           DFHEIV99,
 11761           ERACCT-KEY,
 11762           DFHEIV99,
 11763           DFHEIV99,
 11764           DFHEIV99
 11765     SET ADDRESS OF ACCOUNT-MASTER TO
 11766         DFHEIV20
 11767     MOVE EIBRESP  TO WS-RESPONSE
 11768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11769        IF WS-RESP-NORMAL
 11770           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11771           and pi-cert-eff-dt < am-expiration-dt
 11772           and pi-cert-eff-dt >= am-effective-dt
 11773           move am-dcc-product-code to pi-dcc-product-code
 11774        else
 11775           move spaces           to pi-dcc-product-code
 11776        end-if
 11777        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11778           PERFORM 0900-GET-DDF-LIMITS
 11779                                 THRU 0900-EXIT
 11780           IF PDEF-FOUND
 11781              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11782                 (P1 > +8)
 11783                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11784              END-PERFORM
 11785              IF P1 < +9
 11786                 if pd-ben-pct (p1) not numeric
 11787                    move zeros   to pd-ben-pct (p1)
 11788                 end-if
 11789                 if pd-ben-pct (p1) = zeros
 11790                    move +1      to ws-work-ben-pct
 11791                 else
 11792                    move pd-ben-pct (p1)
 11793                                 to ws-work-ben-pct
 11794                 end-if
 11795                 compute cm-ah-benefit-amt =
 11796                    cm-ah-benefit-amt * ws-work-ben-pct
 11797                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11798                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11799                 end-if
 11800              else
 11801                 move er-1674    to emi-error
 11802                 PERFORM 9900-ERROR-FORMAT
 11803                                 THRU 9900-EXIT
 11804              END-IF
 11805           else
 11806              move er-1672       to emi-error
 11807              PERFORM 9900-ERROR-FORMAT
 11808                                 THRU 9900-EXIT
 11809           END-IF
 11810        end-if
 11811     END-IF
 11812     IF PI-PMTTYPE NOT = '4'
 11813        GO TO 1405-CALC-PAYMENT.
 11814     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 223
* EL156.cbl
 11815         MOVE PI-EPYAMT           TO PI-CPYAMT
 11816         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11817         GO TO 1430-CHECK-AH-TOLERANCE.
 11818
 11819*    IF PI-COMPANY-ID = 'FIA'
 11820*       IF CERT-ACCOUNT = '0000011043'
 11821*        COMPUTE PI-DAILY-RATE ROUNDED =
 11822*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11823*        COMPUTE PI-CPYAMT ROUNDED =
 11824*                          PI-DAILY-RATE * PI-EDAYS
 11825*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11826*        GO TO 1430-CHECK-AH-TOLERANCE.
 11827
 11828     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11829         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11830         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11831         GO TO 1420-CHECK-AIG-BENEFIT.
 11832
 11833     IF WS-CALC-METHOD = '2' OR  '5'
 11834         COMPUTE PI-DAILY-RATE ROUNDED =
 11835                        (CM-AH-BENEFIT-AMT * 12) / 365
 11836         COMPUTE PI-CPYAMT ROUNDED =
 11837                           PI-DAILY-RATE * PI-EDAYS
 11838        GO TO 1420-CHECK-AIG-BENEFIT.
 11839
 11840     IF WS-CALC-METHOD = '3'
 11841         COMPUTE PI-DAILY-RATE =
 11842                         (CM-AH-BENEFIT-AMT * 12) / 365
 11843         COMPUTE PI-CPYAMT ROUNDED =
 11844                           PI-DAILY-RATE * PI-EDAYS
 11845        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 224
* EL156.cbl
 11847*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11848
 11849****************************************************************
 11850****************************************************************
 11851*                  CALCULATED FROM      PAYMENT      PAYMENT
 11852*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11853* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11854*1-01-83  1-15-83    0    15     15        15           15
 11855*1-01-83  1-30-83    0    30     30        30           30
 11856*1-01-83  1-31-83    1     0     31        30           30
 11857*1-01-83  2-01-83    1     1     32        31           31
 11858*1-01-83  2-15-83    1    15     46        45           45
 11859*1-01-83  2-28-83    2     0     59        60           60
 11860*1-01-83  3-01-83    2     1     60        61           61
 11861*1-01-83  3-31-83    3     0     90        90           90
 11862*1-15-83  1-31-83    0    17     17        17           16
 11863*1-15-83  2-01-83    0    18     18        18           17
 11864*1-15-83  2-28-83    1    14     45        44           46
 11865*1-21-83  3-09-83    1    20     48        50           49
 11866*2-05-83  3-06-83    1     2     30        32           32
 11867*2-05-83  3-23-83    1    19     47        49           49
 11868*2-15-83  2-28-83    0    14     14        14           16
 11869*2-15-83  3-01-83    0    15     15        15           17
 11870*2-21-83  3-19-83    0    27     27        27           29
 11871*2-21-83  3-20-83    1     0     28        30           30
 11872*2-21-83  4-10-83    1    18     49        30           50
 11873*2-21-83  5-19-83    2    27     88        87           89
 11874*2-21-83  5-22-83    3     2     91        92           92
 11875*3-21-83  5-19-83    1    30     60        60           59
 11876****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 225
* EL156.cbl
 11878 1405-CALC-PAYMENT.
 11879     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11880     MOVE ' '                    TO DC-OPTION-CODE.
 11881     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11882     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11883     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11884
 11885     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11886     MOVE ' '                    TO DC-OPTION-CODE.
 11887     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11888     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11889     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11890
 11891     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11892     MOVE -1                     TO DC-ELAPSED-DAYS.
 11893     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11894     MOVE '6'                    TO DC-OPTION-CODE.
 11895     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11896     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11897
 11898     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11899     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11900     MOVE '1'                    TO DC-OPTION-CODE.
 11901     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11902
 11903     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11904     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11905     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11906
 11907******************************************************************
 11908*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11909*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11910*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11911******************************************************************
 11912
 11913     IF WS-CALC-METHOD = '1'           AND
 11914        DC-ELAPSED-MONTHS > ZERO AND
 11915        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11916        WDF-DAY > WDT-DAY
 11917          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11918          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11919          MOVE -1                  TO DC-ELAPSED-MONTHS
 11920          MOVE '6'                 TO DC-OPTION-CODE
 11921          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11922          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11923          COMPUTE WS-SAVE-ODD-DAYS =
 11924          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11925          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11926
 11927     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11928     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11929     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11930
 11931     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11932     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11933
 11934*    IF PI-COMPANY-ID = 'FIA'
 11935*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 226
* EL156.cbl
 11936*        COMPUTE PI-DAILY-RATE ROUNDED =
 11937*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11938*        COMPUTE PI-CPYAMT ROUNDED =
 11939*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11940*        GO TO 1420-CHECK-AIG-BENEFIT.
 11941
 11942*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11943*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11944*          CM-AH-BENEFIT-CD = '23'               AND
 11945*          CL-CERT-STATE    = '04'               AND
 11946*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11947*            COMPUTE WS-DAILY-RATE ROUNDED =
 11948*                               CM-AH-BENEFIT-AMT / 30
 11949*            COMPUTE PI-CPYAMT ROUNDED =
 11950*                               (WS-DAILY-RATE * PI-CDAYS)
 11951*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11952*            GO TO 1420-CHECK-AIG-BENEFIT.
 11953
 11954     IF WS-CALC-METHOD = '1'
 11955         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11956         COMPUTE PI-CPYAMT ROUNDED =
 11957             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11958             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11959         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11960         GO TO 1420-CHECK-AIG-BENEFIT.
 11961
 11962     IF WS-CALC-METHOD = '2'
 11963         COMPUTE PI-DAILY-RATE ROUNDED =
 11964                          (CM-AH-BENEFIT-AMT * 12) / 365
 11965         COMPUTE PI-CPYAMT ROUNDED =
 11966             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11967             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11968         GO TO 1420-CHECK-AIG-BENEFIT.
 11969
 11970     IF WS-CALC-METHOD = '4'
 11971         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11972         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11973         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11974         COMPUTE PI-CPYAMT ROUNDED =
 11975                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11976         GO TO 1420-CHECK-AIG-BENEFIT.
 11977
 11978     IF WS-CALC-METHOD = '5'
 11979         COMPUTE PI-DAILY-RATE ROUNDED =
 11980                            (CM-AH-BENEFIT-AMT * 12) / 365
 11981         COMPUTE PI-CPYAMT ROUNDED =
 11982                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11983         GO TO 1420-CHECK-AIG-BENEFIT.
 11984
 11985     IF WS-CALC-METHOD NOT = '3'
 11986        GO TO 1410-CHECK-PAYMENT.
 11987
 11988******   CALCULATION METHOD  3  ROUTINE
 11989     COMPUTE PI-DAILY-RATE =
 11990                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11991
 11992******CHECK TO SEE IF WITHIN SAME MONTH
 11993     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 227
* EL156.cbl
 11994        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11995                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11996         GO TO 1420-CHECK-AIG-BENEFIT.
 11997
 11998******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11999     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12000             SAVE-ODD-DAYS-OVER = ZEROS
 12001      COMPUTE PI-CPYAMT  ROUNDED =
 12002                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12003      GO TO 1420-CHECK-AIG-BENEFIT.
 12004
 12005******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12006******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12007     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12008        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12009        IF WDF-MONTH > 12
 12010           ADD 1                 TO WDF-YEAR
 12011           SUBTRACT 12         FROM WDF-MONTH.
 12012
 12013******CONVERT THE NEW FROM MONTH TO BINARY
 12014     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12015        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12016        MOVE '4'              TO DC-OPTION-CODE
 12017        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12018        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12019
 12020     IF WDF-MONTH = WDT-MONTH AND
 12021        WDF-YEAR  = WDT-YEAR
 12022          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12023                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12024                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12025        ELSE
 12026          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12027          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12028          COMPUTE PI-CPYAMT ROUNDED =
 12029       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12030       +
 12031       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12032       +
 12033       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12034
 12035     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 228
* EL156.cbl
 12037 1410-CHECK-PAYMENT.
 12038******PAYMENT OPTION 6
 12039******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12040     IF SAVE-ELAPSED-MONTHS > ZERO
 12041        IF SAVE-ODD-DAYS-OVER = ZEROS
 12042           GO TO 1412-CHECK-TO-DAY
 12043        ELSE
 12044           IF WDF-DAY > WDT-DAY
 12045              IF WDF-MONTH = 02
 12046                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12047                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12048                  GO TO 1412-CHECK-TO-DAY
 12049              ELSE
 12050                  IF FROM-DAYS-IN-MONTH = 31
 12051                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12052                     GO TO 1412-CHECK-TO-DAY
 12053                  ELSE
 12054                     GO TO 1412-CHECK-TO-DAY
 12055           ELSE
 12056               GO TO 1412-CHECK-TO-DAY.
 12057
 12058     IF WDF-MONTH NOT = WDT-MONTH
 12059        IF WDF-MONTH = 02
 12060           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12061           IF WDF-DAY = 29
 12062              ADD 1              TO SAVE-ODD-DAYS-OVER
 12063           ELSE
 12064              ADD 2              TO SAVE-ODD-DAYS-OVER
 12065        ELSE
 12066           IF FROM-DAYS-IN-MONTH = 31
 12067              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12068
 12069 1412-CHECK-TO-DAY.
 12070        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12071           IF WDT-DAY = 28
 12072              ADD 2              TO SAVE-ODD-DAYS-OVER
 12073           ELSE
 12074              IF WDT-DAY = 29
 12075                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12076              ELSE
 12077                 NEXT SENTENCE
 12078        ELSE
 12079           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12080              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12081
 12082     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12083     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12084     COMPUTE PI-CPYAMT ROUNDED =
 12085         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12086         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12087
 12088     GO TO 1420-CHECK-AIG-BENEFIT.
 12089
 12090 1415-CHECK-LEAP-YEAR.
 12091     IF FROM-DAYS-IN-MONTH = 29
 12092        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12093
 12094 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 229
* EL156.cbl
 12095     EXIT.
 12096
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 230
* EL156.cbl
 12098 1420-CHECK-AIG-BENEFIT.
 12099
 12100     IF WS-SPECIAL-CALC-CD = 'Q'
 12101         GO TO 1425-CHECK-WHOLE-MONTH.
 12102
 12103*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12104*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12105*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12106*       (PI-PMTTYPE = '1' OR '2')
 12107*        NEXT SENTENCE
 12108*    ELSE
 12109         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12110         GO TO 1430-CHECK-AH-TOLERANCE.
 12111
 12112******************AIG LOGIC STARTS**********************
 12113*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12114*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12115*    MOVE ER-3533      TO EMI-ERROR.
 12116*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12117*    GO TO 1430-CHECK-AH-TOLERANCE.
 12118******************AIG LOGIC ENDS************************
 12119
 12120 1425-CHECK-WHOLE-MONTH.
 12121******************************************************************
 12122****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12123****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12124****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12125****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12126****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12127****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12128****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12129****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12130****          PAID * MONTHLY BENEFIT.                         ****
 12131******************************************************************
 12132
 12133     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12134
 12135     IF CL-NO-OF-PMTS-MADE > +0
 12136         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12137
 12138     IF PI-CDAYS < WS-BEN-DAYS
 12139         GO TO 1430-CHECK-AH-TOLERANCE.
 12140
 12141     IF PI-CDAYS = WS-BEN-DAYS
 12142         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12143         GO TO 1430-CHECK-AH-TOLERANCE.
 12144
 12145*    IF PI-COMPANY-ID = 'ACM'
 12146*       NEXT SENTENCE
 12147*    ELSE
 12148        GO TO 1425-NOT-ACM-W15C.
 12149
 12150*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12151*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12152*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12153*    MOVE '6'                    TO  DC-OPTION-CODE.
 12154*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12155*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 231
* EL156.cbl
 12156*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12157*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12158*       MOVE '1'                 TO  DC-OPTION-CODE
 12159*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12160*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12161*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12162*       IF NO-CONVERSION-ERROR
 12163*          IF (DC-ELAPSED-MONTHS > +0) OR
 12164*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12165*             NEXT SENTENCE
 12166*          ELSE
 12167*             MOVE +0            TO  PI-CPYAMT
 12168*             MOVE ER-0846       TO  EMI-ERROR
 12169*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12170*             GO TO 1430-CHECK-AH-TOLERANCE
 12171*       ELSE
 12172*           MOVE ER-0846         TO  EMI-ERROR
 12173*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12174*           GO TO 1430-CHECK-AH-TOLERANCE.
 12175*
 12176*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12177*       ADD +1 TO DC-ELAPSED-MONTHS.
 12178*
 12179*    COMPUTE PI-CPYAMT ROUNDED =
 12180*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12181*
 12182*    GO TO 1430-CHECK-AH-TOLERANCE.
 12183
 12184 1425-NOT-ACM-W15C.
 12185
 12186     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12187     MOVE '6'                        TO  DC-OPTION-CODE.
 12188     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12189     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12190
 12191     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12192     IF NO-CONVERSION-ERROR
 12193         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12194     ELSE
 12195         MOVE ER-0846                TO  EMI-ERROR
 12196         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12197         GO TO 1430-CHECK-AH-TOLERANCE.
 12198
 12199     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12200     MOVE '1'                        TO  DC-OPTION-CODE.
 12201     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12202     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12203     IF NO-CONVERSION-ERROR
 12204         IF DC-ODD-DAYS-OVER = +0
 12205             NEXT SENTENCE
 12206         ELSE
 12207             MOVE ER-0846            TO  EMI-ERROR
 12208             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12209             GO TO 1430-CHECK-AH-TOLERANCE
 12210     ELSE
 12211         MOVE ER-0846                TO  EMI-ERROR
 12212         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12213         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 232
* EL156.cbl
 12214
 12215     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12216         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12217
 12218     GO TO 1430-CHECK-AH-TOLERANCE.
 12219
 12220 1425-CONT-WHOLE-MONTH-PMTS.
 12221******************************************************************
 12222****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12223****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12224****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12225******************************************************************
 12226
 12227     IF PI-COMPANY-ID = 'ACM'
 12228        NEXT SENTENCE
 12229     ELSE
 12230        IF DC-ODD-DAYS-OVER = +0
 12231            NEXT SENTENCE
 12232        ELSE
 12233            MOVE ER-0845            TO  EMI-ERROR
 12234            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12235            GO TO 1430-CHECK-AH-TOLERANCE.
 12236
 12237     COMPUTE PI-CPYAMT ROUNDED =
 12238                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12239
 12240 1430-CHECK-AH-TOLERANCE.
 12241     IF PI-PMT-APPR-SW = 'G'
 12242         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12243
 12244*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12245*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12246*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12247*
 12248*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12249*      IF WDF-MONTH = 02
 12250*        IF SAVE-ELAPSED-MONTHS = 0
 12251*          NEXT SENTENCE
 12252*        ELSE
 12253*          IF SAVE-ODD-DAYS-OVER > 0
 12254*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12255*            COMPUTE WS-PMT-MOS ROUNDED =
 12256*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12257*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12258*                                     WS-PMT-MOS
 12259*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12260*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12261*          ELSE
 12262*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12263*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12264*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12265*                                     WS-PMT-MOS.
 12266
 12267     IF WS-MAX-PMT-TOL NOT = ZERO
 12268        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12269           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12270            MOVE ER-0494         TO  EMI-ERROR
 12271            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 233
* EL156.cbl
 12272            GO TO 1500-EDIT-EXPENSES.
 12273
 12274 1430-CONT-CHECK-AH-TOLERANCE.
 12275
 12276     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12277        GO TO 1500-EDIT-EXPENSES.
 12278
 12279     IF CM-O-B-COVERAGE
 12280        GO TO 1500-EDIT-EXPENSES.
 12281
 12282     IF PI-COMPANY-ID = 'NCL'
 12283       IF FOUND-TOL-SW = 'Y'
 12284         IF WS-PMT-TOL NOT = ZERO
 12285           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12286              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12287                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12288                  IF WS-NCL-PMT-OPTION = SPACES
 12289                      MOVE ER-0699 TO EMI-ERROR
 12290                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12291                  ELSE
 12292                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12293                      NEXT SENTENCE
 12294                  ELSE
 12295                  IF NOT WS-VALID-NCL-OPTION
 12296                      MOVE ER-0699 TO EMI-ERROR
 12297                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12298
 12299     IF WS-PMT-TOL NOT = ZERO
 12300        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12301           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12302           MOVE ER-0495          TO EMI-ERROR
 12303           PERFORM 1490-PAYMENT-ERROR
 12304                                 THRU 1490-EXIT
 12305        end-if
 12306     end-if
 12307
 12308     GO TO 1500-EDIT-EXPENSES.
 12309
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 234
* EL156.cbl
 12311 1440-COMPUTE-LIFE-REMAINING.
 12312
 12313     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12314        IF PI-PMTTYPE = '4'
 12315          MOVE PI-EPYAMT TO PI-CPYAMT
 12316          GO TO 1460-TEST-TYPE.
 12317
 12318     IF WS-LF-COVERAGE-TYPE = 'L'
 12319        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12320                          - CL-TOTAL-PAID-AMT
 12321        GO TO 1450-CHECK-MAX.
 12322
 12323     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12324        PI-LF-COVERAGE-TYPE = 'P'
 12325          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12326                              CM-LF-ITD-DEATH-AMT
 12327          GO TO 1450-CHECK-MAX.
 12328
 12329     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12330     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12331     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12332     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12333     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12334     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12335     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12336     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12337     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12338
 12339     PERFORM 9800-LINK-REM-TERM.
 12340
 12341     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12342     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12343     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12344     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12345     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12346     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12347     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12348     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12349     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12350     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12351     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12352     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12353     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12354     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12355     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12356     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12357     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 12358        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12359        MOVE PI-CARRIER          TO ACCT-CARRIER
 12360        MOVE PI-GROUPING         TO ACCT-GROUPING
 12361        MOVE PI-STATE            TO ACCT-STATE
 12362        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12363        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12364        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12365        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12366
 12367
 12368* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 235
* EL156.cbl
 12369*          DATASET ('ERACCT')
 12370*          RIDFLD  (ERACCT-KEY)
 12371*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12372*          GTEQ
 12373*          resp    (WS-RESPONSE)
 12374*       END-EXEC
 12375     MOVE 'ERACCT' TO DFHEIV1
 12376*    MOVE '&"S        G          (  N#00011813' TO DFHEIV0
 12377     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12379     MOVE X'204E233030303131383133' TO DFHEIV0(25:11)
 12380     CALL 'kxdfhei1' USING DFHEIV0,
 12381           DFHEIV1,
 12382           DFHEIV20,
 12383           DFHEIV99,
 12384           ERACCT-KEY,
 12385           DFHEIV99,
 12386           DFHEIV99,
 12387           DFHEIV99
 12388     SET ADDRESS OF ACCOUNT-MASTER TO
 12389         DFHEIV20
 12390     MOVE EIBRESP  TO WS-RESPONSE
 12391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12392        IF WS-RESP-NORMAL
 12393           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12394           and (pi-cert-eff-dt < am-expiration-dt)
 12395           and (pi-cert-eff-dt >= am-effective-dt)
 12396           move am-dcc-product-code to pi-dcc-product-code
 12397        else
 12398           move spaces           to pi-dcc-product-code
 12399        end-if
 12400        if pi-dcc-product-code not = spaces
 12401           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12402           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12403           PERFORM 0900-GET-DDF-limits
 12404                                 THRU 0900-EXIT
 12405           IF PDEF-FOUND
 12406              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12407                 (P1 > +8)
 12408                 OR (PD-PROD-CODE (P1) = 'L')
 12409              END-PERFORM
 12410              IF P1 < +9
 12411                 MOVE PD-MAX-AMT (P1)
 12412                                 TO CP-R-MAX-TOT-BEN
 12413              else
 12414                 move er-1674    to emi-error
 12415                 PERFORM 9900-ERROR-FORMAT
 12416                                 THRU 9900-EXIT
 12417              END-IF
 12418           else
 12419              move er-1672       to emi-error
 12420              PERFORM 9900-ERROR-FORMAT
 12421                                 THRU 9900-EXIT
 12422           END-IF
 12423        end-if
 12424     END-IF
 12425
 12426* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 236
* EL156.cbl
 12427*       PROGRAM  (LINK-REMAMT)
 12428*       COMMAREA (CALCULATION-PASS-AREA)
 12429*       LENGTH   (CP-COMM-LENGTH)
 12430*    END-EXEC.
 12431*    MOVE '."C                   (   #00011853' TO DFHEIV0
 12432     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12434     MOVE X'2020233030303131383533' TO DFHEIV0(25:11)
 12435     CALL 'kxdfhei1' USING DFHEIV0,
 12436           LINK-REMAMT,
 12437           CALCULATION-PASS-AREA,
 12438           CP-COMM-LENGTH,
 12439           DFHEIV99,
 12440           DFHEIV99,
 12441           DFHEIV99,
 12442           DFHEIV99
 12443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12444
 12445
 12446     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12447
 12448     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12449     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12450
 12451     IF PI-COMPANY-ID = 'BOA' AND
 12452        PI-PMTTYPE    = '2'   AND
 12453        PI-OFFLINE    = 'N'
 12454           GO TO 1441-COMPUTE-BOA-INTEREST.
 12455
 12456     IF PI-COMPANY-ID = 'NCL' AND
 12457        PI-PMTTYPE    = '2'   AND
 12458        PI-OFFLINE    = 'N'
 12459          GO TO 1442-COMPUTE-NCL-INTEREST
 12460       ELSE
 12461          GO TO 1445-CONTINUE.
 12462
 12463 1441-COMPUTE-BOA-INTEREST.
 12464     MOVE +0             TO WS-CALC-INT.
 12465
 12466     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12467     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12468     MOVE +0             TO DC-ELAPSED-MONTHS
 12469                            DC-ELAPSED-DAYS.
 12470     MOVE '1'            TO DC-OPTION-CODE.
 12471     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12472     IF NO-CONVERSION-ERROR
 12473         NEXT SENTENCE
 12474     ELSE
 12475         GO TO 1445-CONTINUE.
 12476
 12477     IF (PI-INT-RATE NOT > ZEROS)  AND
 12478        (DC-ELAPSED-DAYS > +30)
 12479         MOVE ER-3531            TO EMI-ERROR
 12480         MOVE -1                 TO PINTL
 12481         MOVE AL-UNBON           TO PINTA
 12482         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12483
 12484     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 237
* EL156.cbl
 12485         GO TO 1445-CONTINUE.
 12486
 12487     IF (PI-INT-RATE NOT > ZEROS)  OR
 12488        (DC-ELAPSED-DAYS NOT > +30)
 12489         MOVE PI-EPYAMT TO PI-CPYAMT
 12490         GO TO 1441-FORMAT-NOTE.
 12491
 12492     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12493                                 *  PI-INT-RATE
 12494                                 *  DC-ELAPSED-DAYS
 12495                                 /  365
 12496                                 /  100.
 12497
 12498     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12499
 12500 1441-FORMAT-NOTE.
 12501
 12502     MOVE SPACES        TO WS-BOANOTE1.
 12503     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12504     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12505     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12506     MOVE AL-UANON      TO NOTE1A.
 12507
 12508     IF WS-CALC-INT > ZEROS
 12509         MOVE SPACES        TO WS-BOANOTE2
 12510         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12511         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12512         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12513         MOVE AL-UANON      TO NOTE2A.
 12514
 12515     GO TO 1445-CONTINUE.
 12516
 12517 1442-COMPUTE-NCL-INTEREST.
 12518     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12519     MOVE PI-STATE               TO WS-ST-ACCESS.
 12520     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12521     MOVE '3'                    TO CNTL-REC-TYPE.
 12522     MOVE +0                     TO CNTL-SEQ-NO.
 12523     MOVE 'STAT'                 TO FILE-SWITCH.
 12524
 12525     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12526
 12527     MOVE +0                 TO WS-CALC-INT.
 12528
 12529     IF ST-STAT-FROM-INCURRED
 12530         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12531       ELSE
 12532     IF ST-STAT-FROM-REPORTED
 12533         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12534       ELSE
 12535         GO TO 1445-CONTINUE.
 12536
 12537     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12538     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12539     MOVE +0                 TO DC-ELAPSED-MONTHS
 12540                                DC-ELAPSED-DAYS.
 12541     MOVE '1'                TO DC-OPTION-CODE.
 12542     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 238
* EL156.cbl
 12543     IF NO-CONVERSION-ERROR
 12544         NEXT SENTENCE
 12545     ELSE
 12546         GO TO 1445-CONTINUE.
 12547
 12548     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12549        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12550         GO TO 1445-CONTINUE.
 12551
 12552     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12553                                 *  CF-ST-STAT-INTEREST.
 12554
 12555     MOVE SPACES              TO WS-NCLNOTE1.
 12556     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12557     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12558     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12559                                 PI-PMTNOTE1
 12560                                 NOTE1I.
 12561     MOVE AL-UANON            TO NOTE1A.
 12562
 12563     IF WS-CALC-INT > ZEROS
 12564         MOVE SPACES          TO WS-NCLNOTE2
 12565         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12566         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12567         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12568                                 PI-PMTNOTE2
 12569                                 NOTE2I
 12570         MOVE AL-UANON        TO NOTE2A.
 12571
 12572     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12573
 12574 1445-CONTINUE.
 12575
 12576     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12577        GO TO 1460-TEST-TYPE.
 12578
 12579     IF CM-O-B-COVERAGE
 12580        GO TO 1460-TEST-TYPE.
 12581
 12582     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12583         GO TO 1450-CHECK-MAX.
 12584
 12585     if (pi-company-id = 'DCC' or 'CAP')
 12586        and (pdef-found)
 12587        if pi-epyamt > pd-max-amt (p1)
 12588           move er-1657          to emi-error
 12589           perform 1490-payment-error
 12590                                 thru 1490-exit
 12591           go to 1460-test-type
 12592        end-if
 12593     else
 12594        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12595           > PI-EPYAMT)
 12596                         OR
 12597           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12598           < PI-EPYAMT)
 12599           MOVE ER-0594          TO EMI-ERROR
 12600           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 239
* EL156.cbl
 12601                                 THRU 1490-EXIT
 12602           GO TO 1460-TEST-TYPE
 12603        end-if
 12604     end-if
 12605     .
 12606 1450-CHECK-MAX.
 12607
 12608     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12609        PI-LF-COVERAGE-TYPE = 'P'
 12610         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12611                                   CM-LF-ITD-DEATH-AMT
 12612     ELSE
 12613         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12614                                   CL-TOTAL-PAID-AMT.
 12615
 12616     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12617          MOVE ER-0543           TO EMI-ERROR
 12618          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12619
 12620 1460-TEST-TYPE.
 12621
 12622     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12623        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12624           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12625                                   CM-LF-ALT-BENEFIT-AMT -
 12626                                   CL-TOTAL-PAID-AMT
 12627           IF PI-EPYAMT > WS-LF-BEN-AMT
 12628               MOVE ER-0543      TO EMI-ERROR
 12629               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12630           END-IF
 12631        END-IF
 12632     END-IF
 12633
 12634     IF PI-PMT-APPR-SW = 'G'
 12635       NEXT SENTENCE
 12636     ELSE
 12637       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12638         IF PI-EPYAMT = ZERO
 12639             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12640                 MOVE ER-0494    TO  EMI-ERROR
 12641                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12642                 GO TO 1500-EDIT-EXPENSES
 12643             ELSE
 12644                 NEXT SENTENCE
 12645         ELSE
 12646             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12647                 MOVE ER-0494    TO  EMI-ERROR
 12648                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12649                 GO TO 1500-EDIT-EXPENSES.
 12650
 12651     IF PI-PMTTYPE NOT = '2' OR
 12652        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12653         GO TO 1500-EDIT-EXPENSES.
 12654
 12655     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12656     MOVE ER-0526                TO EMI-ERROR.
 12657     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12658
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 240
* EL156.cbl
 12659     IF EMI-ERROR-NUMBER (1) = '0526'
 12660        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12661
 12662     IF EMI-ERROR-NUMBER (2) = '0526'
 12663        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12664
 12665     GO TO 1500-EDIT-EXPENSES.
 12666
 12667 1490-PAYMENT-ERROR.
 12668     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12669
 12670     IF EMI-MESSAGE-FORMATTED
 12671         MOVE -1                 TO EPYAMTL
 12672         MOVE AL-UNBON           TO EPYAMTA.
 12673
 12674 1490-EXIT.
 12675      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 241
* EL156.cbl
 12677 1500-EDIT-EXPENSES.
 12678     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12679         GO TO 1500-SKIP-ERROR-0556.
 12680
 12681 1500-CONTINUE-ON.
 12682
 12683     IF CM-O-B-COVERAGE
 12684        MOVE ER-0556             TO EMI-ERROR
 12685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12686
 12687 1500-SKIP-ERROR-0556.
 12688     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12689        IF PI-EEXPENS NOT = ZEROS
 12690           MOVE ER-0524          TO EMI-ERROR
 12691           GO TO 1590-EXPENSE-ERROR
 12692        ELSE
 12693           GO TO 1600-EDIT-RESERVES.
 12694
 12695     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12696     MOVE '6'                    TO CNTL-REC-TYPE.
 12697
 12698     IF CONTROL-IS-ACTUAL-CARRIER
 12699         MOVE PI-CARRIER         TO WS-CARR
 12700     ELSE
 12701         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12702
 12703     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12704     MOVE +0                     TO CNTL-SEQ-NO.
 12705     MOVE 'CARR'                 TO FILE-SWITCH.
 12706
 12707     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12708
 12709     IF EXPENSE-CALC-MANUAL
 12710        GO TO 1600-EDIT-RESERVES.
 12711
 12712     IF DOLLARS-PER-PMT
 12713        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12714        GO TO 1600-EDIT-RESERVES.
 12715
 12716     IF DOLLARS-PER-MONTH AND
 12717        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12718       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12719       GO TO 1600-EDIT-RESERVES.
 12720
 12721     IF PERCENT-OF-PAYMENT
 12722        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12723
 12724     GO TO 1600-EDIT-RESERVES.
 12725
 12726 1590-EXPENSE-ERROR.
 12727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12728
 12729     IF EMI-MESSAGE-FORMATTED
 12730        MOVE -1                  TO EEXPENSL
 12731        MOVE AL-UNBON            TO EEXPENSA.
 12732
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 242
* EL156.cbl
 12734 1600-EDIT-RESERVES.
 12735     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12736        IF PI-ERESV = ZEROS
 12737           GO TO 1700-EDIT-EXPENSE-TYPE
 12738        ELSE
 12739           MOVE ER-0525          TO EMI-ERROR
 12740           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12741           GO TO 1700-EDIT-EXPENSE-TYPE.
 12742
 12743     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12744     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12745     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12746
 12747     IF NOT AT-MANUAL-RESERVES-USED
 12748        IF PI-ERESV NOT = ZEROS
 12749           MOVE ER-0518          TO EMI-ERROR
 12750           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12751
 12752     IF AT-MANUAL-RESERVES-USED
 12753        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12754        GO TO 1700-EDIT-EXPENSE-TYPE.
 12755
 12756     IF AT-FUTURE-RESERVES-USED
 12757        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12758
 12759     IF AT-FUTURE-RESERVES-USED
 12760        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12761
 12762     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12763        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12764
 12765     IF AT-IBNR-RESERVES-USED
 12766        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12767
 12768     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12769     GO TO 1700-EDIT-EXPENSE-TYPE.
 12770
 12771 1690-RESERVE-ERROR.
 12772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12773
 12774     IF EMI-MESSAGE-FORMATTED
 12775        MOVE AL-UNBON            TO ERESVA
 12776        MOVE -1                  TO ERESVL.
 12777
 12778 1690-EXIT.
 12779      EXIT.
 12780
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 243
* EL156.cbl
 12782 1700-EDIT-EXPENSE-TYPE.
 12783     IF PI-PMTTYPE NOT = '5' AND '6'
 12784        GO TO 2000-EDIT-DONE.
 12785
 12786     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12787                   '6' OR '7' OR '8' OR '9'
 12788        GO TO 2000-EDIT-DONE.
 12789
 12790 1705-EXPENSE-ERROR.
 12791     MOVE ER-0573                TO EMI-ERROR.
 12792     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12793
 12794     IF EMI-MESSAGE-FORMATTED
 12795        MOVE AL-UABON            TO ETYPEA
 12796        MOVE -1                  TO ETYPEL.
 12797
 12798     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 244
* EL156.cbl
 12800 1950-NOT-FOUND.
 12801     IF FILE-SWITCH = 'MSTR'
 12802        MOVE ER-0204             TO EMI-ERROR.
 12803
 12804     IF FILE-SWITCH = 'CARR'
 12805        MOVE ER-0252             TO EMI-ERROR.
 12806
 12807     IF FILE-SWITCH = 'COMP'
 12808        MOVE ER-0254             TO EMI-ERROR.
 12809
 12810     IF FILE-SWITCH = 'STAT'
 12811        MOVE ER-0149             TO EMI-ERROR.
 12812
 12813     IF FILE-SWITCH = 'PROC'
 12814        MOVE ER-0019             TO EMI-ERROR.
 12815
 12816     IF FILE-SWITCH = 'ACCT'
 12817        MOVE ER-0198             TO EMI-ERROR.
 12818
 12819     IF FILE-SWITCH = 'BENE'
 12820        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12821           MOVE ER-0282          TO EMI-ERROR
 12822        ELSE
 12823           MOVE ER-0283          TO EMI-ERROR.
 12824
 12825     MOVE -1                     TO PMTTYPEL.
 12826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12827
 12828     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12829                                     WS-FORCE-CTR.
 12830
 12831     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12832                                     WS-FATAL-CTR.
 12833
 12834     GO TO 8200-SEND-DATAONLY.
 12835
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 245
* EL156.cbl
 12837 2000-EDIT-DONE.
 12838     perform 2210-dcc-max-benes thru 2210-exit
 12839     if pi-company-id not = 'DCC' and 'CAP'
 12840        IF (WS-SPECIAL-CALC-CD = 'C')
 12841           and (cl-critical-period > 0)
 12842           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12843              IF PI-EPYAMT > ZEROS
 12844                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12845                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12846              ELSE
 12847                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12848                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12849              END-IF
 12850              if ws-benefits-paid > cl-critical-period
 12851                 MOVE ER-0657          TO EMI-ERROR
 12852                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12853              END-IF
 12854           END-IF
 12855        END-IF
 12856     end-if
 12857     IF PI-HOLDTIL NOT = ZEROS
 12858        MOVE PI-HOLDTIL          TO HOLDTILO
 12859        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12860
 12861     IF PI-EPYFROM NOT = ZEROS
 12862        MOVE PI-EPYFROM          TO EPYFROMO
 12863        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12864
 12865     IF PI-EPYTHRU NOT = ZEROS
 12866        MOVE PI-EPYTHRU            TO EPYTHRUO
 12867        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12868        IF PI-USES-PAID-TO
 12869           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12870           MOVE '4'                TO DC-OPTION-CODE
 12871           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12872           IF NO-CONVERSION-ERROR
 12873              MOVE +1              TO DC-ELAPSED-DAYS
 12874              MOVE +0              TO DC-ELAPSED-MONTHS
 12875              MOVE '6'             TO DC-OPTION-CODE
 12876              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12877              IF NO-CONVERSION-ERROR
 12878                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12879
 12880     MOVE PI-EDAYS               TO EDAYSO.
 12881
 12882     IF PI-AIGFROM NOT = ZEROS
 12883        MOVE PI-AIGFROM          TO AIGFROMO
 12884        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12885
 12886     MOVE PI-EPYAMT              TO EPYAMTO.
 12887     MOVE PI-ERESV               TO ERESVO.
 12888     MOVE PI-EEXPENS             TO EEXPENSO.
 12889
 12890     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12891     MOVE SPACES                 TO DC-OPTION-CODE.
 12892     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12893
 12894     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 246
* EL156.cbl
 12895        MOVE SPACES              TO CPYFROMI
 12896     ELSE
 12897        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12898        IF PI-EPYFROM = ZEROS
 12899           MOVE AL-UANON             TO EPYFROMA
 12900           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12901           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12902
 12903     IF PI-USES-PAID-TO
 12904        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12905        MOVE +1                            TO DC-ELAPSED-DAYS
 12906        MOVE +0                            TO DC-ELAPSED-MONTHS
 12907        MOVE '6'                           TO DC-OPTION-CODE
 12908        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12909        IF NO-CONVERSION-ERROR
 12910           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12911           IF PI-EPYTHRU = ZEROS
 12912              MOVE AL-UANON                TO EPYTHRUA
 12913              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12914              MOVE ' '                     TO DC-OPTION-CODE
 12915              MOVE +0                      TO DC-ELAPSED-DAYS
 12916                                              DC-ELAPSED-MONTHS
 12917              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12918              IF NO-CONVERSION-ERROR
 12919                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12920                  GO TO 2001-CONTINUE
 12921              ELSE
 12922                  GO TO 2001-CONTINUE
 12923           ELSE
 12924              GO TO 2001-CONTINUE.
 12925
 12926     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12927     MOVE SPACES                 TO DC-OPTION-CODE.
 12928     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12929
 12930     IF DATE-CONVERSION-ERROR
 12931        MOVE SPACES              TO CPYTHRUI
 12932     ELSE
 12933        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12934        IF PI-EPYTHRU = ZEROS
 12935           MOVE AL-UANON TO EPYTHRUA
 12936           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12937           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12938
 12939 2001-CONTINUE.
 12940
 12941     MOVE PI-CDAYS               TO CDAYSO.
 12942
 12943     IF PI-EDAYS = ZEROS
 12944        MOVE AL-UNNON TO EDAYSA
 12945        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12946
 12947     MOVE PI-CPYAMT              TO CPYAMTO.
 12948
 12949     IF PI-EPYAMT = ZEROS
 12950        MOVE AL-UNNON            TO EPYAMTA
 12951        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12952
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 247
* EL156.cbl
 12953     MOVE PI-CRESV               TO CRESVO.
 12954     MOVE PI-CEXPENS             TO CEXPENSO.
 12955
 12956     IF PI-EEXPENS = ZEROS
 12957        MOVE AL-UNNON TO EEXPENSA
 12958        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12959
 12960     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12961        AND (CL-CLAIM-TYPE = 'L')
 12962        AND (PI-OFFLINE NOT EQUAL 'Y')
 12963        IF PI-PMTTYPE = '2' OR '4'
 12964           PERFORM 2200-CALC-INTEREST
 12965                                 THRU 2200-EXIT
 12966        END-IF
 12967     END-IF
 12968     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12969     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12970     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12971
 12972     IF EMI-FATAL-CTR = ZEROS
 12973        MOVE 'B'                 TO PI-PASS-SW.
 12974
 12975     IF NOT EMI-MESSAGE-FORMATTED
 12976         MOVE -1                 TO EPYFROML
 12977     ELSE
 12978         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12979            EMI-ERROR-NUMBER (2) = SPACES
 12980             MOVE -1             TO EPYFROML.
 12981
 12982     GO TO 8200-SEND-DATAONLY.
 12983
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 248
* EL156.cbl
 12985 2200-CALC-INTEREST.
 12986     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12987        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12988        MOVE '4'                 TO DC-OPTION-CODE
 12989        PERFORM 9700-LINK-DATE-CONVERT
 12990        IF DATE-CONVERSION-ERROR
 12991            MOVE LOW-VALUES      TO CP-PRF-DT
 12992        ELSE
 12993           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12994        END-IF
 12995     END-IF
 12996     if (pi-int-to-rem-borr <> 'Y' and 'N')
 12997        if pi-rb-joint-coverage
 12998           move 'Y'              to pi-int-to-rem-borr
 12999        end-if
 13000     end-if
 13001     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13002        IN CLAIM-INT-PASS-AREA
 13003     MOVE CL-CERT-STATE          TO CP-STATE
 13004        IN CLAIM-INT-PASS-AREA
 13005     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13006     MOVE 'LF'                   TO CP-COVERAGE
 13007     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13008     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13009     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13010     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13011     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13012     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13013
 13014* EXEC CICS LINK
 13015*       PROGRAM   ('ELCLMI')
 13016*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13017*       LENGTH    (CP-CLAIM-LENGTH)
 13018*    END-EXEC
 13019     MOVE 'ELCLMI' TO DFHEIV1
 13020*    MOVE '."C                   (   #00012426' TO DFHEIV0
 13021     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13023     MOVE X'2020233030303132343236' TO DFHEIV0(25:11)
 13024     CALL 'kxdfhei1' USING DFHEIV0,
 13025           DFHEIV1,
 13026           CLAIM-INT-PASS-AREA,
 13027           CP-CLAIM-LENGTH,
 13028           DFHEIV99,
 13029           DFHEIV99,
 13030           DFHEIV99,
 13031           DFHEIV99
 13032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13033     MOVE AL-PANOF               TO PINTHA
 13034                                    PINTA
 13035     if cp-clm-int-amt = zeros
 13036        move ' ' to pi-int-to-rem-borr
 13037     end-if
 13038     IF NO-CI-ERROR
 13039        MOVE CP-CLM-INT-AMT      TO PINTO
 13040                                    PI-INT-AMT
 13041        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13042        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 249
* EL156.cbl
 13043        MOVE AL-PANOF            TO PINTHA
 13044                                    PINTA
 13045        if pi-rb-joint-coverage
 13046           and pi-int-amt > zeros
 13047           move '  INT TO'       to itrb1o
 13048           move ' REM BORR?'     to itrb2o
 13049           move pi-int-to-rem-borr
 13050                                 to itrbyno
 13051           move al-uanon         to itrbyna
 13052           move +1               to itrbynl
 13053        else
 13054           move ' '              to pi-int-to-rem-borr
 13055        end-if
 13056     ELSE
 13057        IF CI-RETURN-CODE = '8'
 13058           MOVE ER-3818          TO EMI-ERROR
 13059           MOVE -1               TO ZINTL
 13060           PERFORM 9900-ERROR-FORMAT
 13061                                 THRU 9900-EXIT
 13062           GO TO 2200-EXIT
 13063        ELSE
 13064           MOVE ZEROS            TO PINTO
 13065                                    PI-INT-AMT
 13066                                    PI-INT-DAYS
 13067                                    PI-INT-RATE-USED
 13068        END-IF
 13069     END-IF
 13070     IF PI-INT-AMT NOT = ZEROS
 13071        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13072           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13073           CONTINUE
 13074        ELSE
 13075           MOVE CL-SOC-SEC-NO (1:3)
 13076                                 TO WS-SSN (1:3)
 13077           MOVE CL-SOC-SEC-NO (5:2)
 13078                                 TO WS-SSN (4:2)
 13079           MOVE CL-SOC-SEC-NO (8:4)
 13080                                 TO WS-SSN (6:4)
 13081           IF (WS-SSN NUMERIC)
 13082              AND (WS-SSN NOT = ZEROS)
 13083              CONTINUE
 13084           ELSE
 13085              MOVE ER-2044       TO EMI-ERROR
 13086              PERFORM 9900-ERROR-FORMAT
 13087                                 THRU 9900-EXIT
 13088           END-IF
 13089        END-IF
 13090        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13091        if pi-int-to-rem-borr = 'Y'
 13092           move +61              to trlr-seq-no
 13093        else
 13094           MOVE +51              TO TRLR-SEQ-NO
 13095        end-if
 13096
 13097* EXEC CICS READ
 13098*          DATASET  ('ELTRLR')
 13099*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13100*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 250
* EL156.cbl
 13101*          RESP     (WS-RESPONSE)
 13102*       END-EXEC
 13103     MOVE 'ELTRLR' TO DFHEIV1
 13104*    MOVE '&"S        E          (  N#00012494' TO DFHEIV0
 13105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13107     MOVE X'204E233030303132343934' TO DFHEIV0(25:11)
 13108     CALL 'kxdfhei1' USING DFHEIV0,
 13109           DFHEIV1,
 13110           DFHEIV20,
 13111           DFHEIV99,
 13112           ELTRLR-KEY,
 13113           DFHEIV99,
 13114           DFHEIV99,
 13115           DFHEIV99
 13116     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13117         DFHEIV20
 13118     MOVE EIBRESP  TO WS-RESPONSE
 13119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13120        IF (NOT WS-RESP-NORMAL)
 13121                    OR
 13122           ((WS-RESP-NORMAL)
 13123           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13124           OR (AT-CITY-STATE = SPACES)))
 13125           MOVE ER-0874          TO EMI-ERROR
 13126           if pi-rb-joint-coverage
 13127              move -1            to itrbynl
 13128           end-if
 13129           PERFORM 9900-ERROR-FORMAT
 13130                                 THRU 9900-EXIT
 13131        else
 13132           move at-mail-to-name  to pi-int-payees-name
 13133        END-IF
 13134     END-IF
 13135     .
 13136 2200-EXIT.
 13137     EXIT.
 13138 2210-dcc-max-benes.
 13139
 13140     move pi-ah-term             to ws-max-bens
 13141     if cl-critical-period not = zeros and spaces
 13142        move cl-critical-period  to ws-max-bens
 13143     end-if
 13144     move cm-ah-benefit-amt      to ws-monthly-benefit
 13145     if pdef-found
 13146        and (pd-max-amt (p1) not = zeros)
 13147        if pd-ben-pct (p1) not numeric
 13148           move zeros            to pd-ben-pct (p1)
 13149        end-if
 13150        if pd-ben-pct (p1) = zeros
 13151           move +1               to ws-work-ben-pct
 13152        else
 13153           move pd-ben-pct (p1)  to ws-work-ben-pct
 13154        end-if
 13155*       compute ws-monthly-benefit =
 13156*          ws-monthly-benefit * ws-work-ben-pct
 13157*       if ws-monthly-benefit > pd-max-amt (p1)
 13158*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 251
* EL156.cbl
 13159*       end-if
 13160     end-if
 13161
 13162     move cl-cert-key-data       to elcrtt-key (2:21)
 13163     move cl-company-cd          to ctrlr-comp-cd
 13164     move cl-cert-no             to ctrlr-cert-no
 13165     move 'B'                    to ctrlr-rec-type
 13166
 13167
 13168* EXEC CICS READ
 13169*       DATASET  ('ELCRTT')
 13170*       set      (address of CERTIFICATE-TRAILERS)
 13171*       RIDFLD   (ELCRTT-KEY)
 13172*       RESP     (WS-RESPONSE)
 13173*    END-EXEC
 13174     MOVE 'ELCRTT' TO DFHEIV1
 13175*    MOVE '&"S        E          (  N#00012547' TO DFHEIV0
 13176     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13178     MOVE X'204E233030303132353437' TO DFHEIV0(25:11)
 13179     CALL 'kxdfhei1' USING DFHEIV0,
 13180           DFHEIV1,
 13181           DFHEIV20,
 13182           DFHEIV99,
 13183           ELCRTT-KEY,
 13184           DFHEIV99,
 13185           DFHEIV99,
 13186           DFHEIV99
 13187     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13188         DFHEIV20
 13189     MOVE EIBRESP  TO WS-RESPONSE
 13190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13191     IF not WS-RESP-NORMAL
 13192        go to 2210-exit
 13193     end-if
 13194
 13195*    if instypei = 'P'
 13196*       move +1 to s1
 13197*    else
 13198*       MOVE +2 to s1
 13199*    end-if
 13200
 13201*    move +1 to s1
 13202*    evaluate cl-claim-type
 13203*       when 'A'
 13204*          move +1 to s2
 13205*       when 'I'
 13206*          move +2 to s2
 13207*       when 'G'
 13208*          move +3 to s2
 13209*       when 'L'
 13210*          move +4 to s2
 13211*       when 'P'
 13212*          move +5 to s2
 13213*    end-evaluate
 13214
 13215     move zeros                  to ws-prev-days-paid
 13216                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 252
* EL156.cbl
 13217                                    ws-prev-amt-paid
 13218     perform varying s1 from +1 by +1 until
 13219        (s1 > +24)
 13220        or (cs-claim-type (s1) = spaces)
 13221        if pi-company-id not = 'DCC' and 'CAP'
 13222           if cs-claim-type (s1) = cl-claim-type
 13223              compute ws-prev-days-paid =
 13224                 ws-prev-days-paid + cs-days-paid (s1)
 13225              compute ws-prev-amt-paid =
 13226                 ws-prev-amt-paid + cs-total-paid (s1)
 13227           end-if
 13228        else
 13229           if (cs-claim-type (s1) = cl-claim-type)
 13230              and (cs-benefit-period (s1) = cl-benefit-period)
 13231              and (cs-insured-type (s1) = cl-insured-type)
 13232              compute ws-prev-days-paid =
 13233                 ws-prev-days-paid + cs-days-paid (s1)
 13234              compute ws-prev-amt-paid =
 13235                 ws-prev-amt-paid + cs-total-paid (s1)
 13236           end-if
 13237        end-if
 13238     end-perform
 13239     if pi-epyamt > zeros
 13240        compute ws-benefits-paid =
 13241           (ws-prev-amt-paid + pi-epyamt)
 13242           / ws-monthly-benefit
 13243     else
 13244        compute ws-benefits-paid =
 13245           (ws-prev-amt-paid + pi-cpyamt)
 13246           / ws-monthly-benefit
 13247     end-if
 13248*    if pi-company-id = 'DCC'
 13249     if cl-claim-type not = 'L' and 'P'
 13250        if ws-benefits-paid > ws-max-bens
 13251           move er-1658          to emi-error
 13252           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13253        end-if
 13254     end-if
 13255*    end-if
 13256*     if s1 < +25
 13257*        if pi-epyamt > zeros
 13258*           compute ws-benefits-paid =
 13259*              (cs-total-paid (s1) + PI-EPYAMT)
 13260*              / ws-monthly-benefit
 13261*        else
 13262*           compute ws-benefits-paid =
 13263*              (cs-total-paid (s1) + PI-CPYAMT)
 13264*              / ws-monthly-benefit
 13265*        end-if
 13266
 13267*       if ws-benefits-paid > pd-crit-period (p1)
 13268*        if ws-benefits-paid > ws-max-bens
 13269*           move er-1658          to emi-error
 13270*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13271*        end-if
 13272*     end-if
 13273     .
 13274 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 253
* EL156.cbl
 13275     exit.
 13276
 13277 2220-update-elcrtt.
 13278
 13279
 13280* EXEC CICS GETMAIN
 13281*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13282*       LENGTH   (ELCRTT-LENGTH)
 13283*       INITIMG  (GETMAIN-SPACE)
 13284*    END-EXEC
 13285*    MOVE ',"IL                  $   #00012641' TO DFHEIV0
 13286     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13287     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13288     MOVE X'2020233030303132363431' TO DFHEIV0(25:11)
 13289     CALL 'kxdfhei1' USING DFHEIV0,
 13290           DFHEIV20,
 13291           ELCRTT-LENGTH,
 13292           GETMAIN-SPACE
 13293     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13294         DFHEIV20
 13295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13296
 13297     move cl-cert-key-data       to elcrtt-key (2:21)
 13298     move cl-company-cd          to ctrlr-comp-cd
 13299     move cl-cert-no             to ctrlr-cert-no
 13300     move 'B'                    to ctrlr-rec-type
 13301
 13302
 13303* EXEC CICS READ
 13304*       UPDATE
 13305*       DATASET  (ELCRTT-DSID)
 13306*       into     (CERTIFICATE-TRAILERS)
 13307*       RIDFLD   (ELCRTT-KEY)
 13308*       RESP     (WS-RESPONSE)
 13309*    END-EXEC
 13310     MOVE LENGTH OF
 13311      CERTIFICATE-TRAILERS
 13312       TO DFHEIV11
 13313*    MOVE '&"IL       EU         (  N#00012652' TO DFHEIV0
 13314     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13315     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13316     MOVE X'204E233030303132363532' TO DFHEIV0(25:11)
 13317     CALL 'kxdfhei1' USING DFHEIV0,
 13318           ELCRTT-DSID,
 13319           CERTIFICATE-TRAILERS,
 13320           DFHEIV11,
 13321           ELCRTT-KEY,
 13322           DFHEIV99,
 13323           DFHEIV99,
 13324           DFHEIV99
 13325     MOVE EIBRESP  TO WS-RESPONSE
 13326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13327
 13328     IF WS-RESP-NORMAL
 13329        perform 2225-upd-crt-trlr thru 2225-exit
 13330
 13331* EXEC CICS REWRITE
 13332*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 254
* EL156.cbl
 13333*          from     (CERTIFICATE-TRAILERS)
 13334*          RESP     (WS-RESPONSE)
 13335*       END-EXEC
 13336     MOVE LENGTH OF
 13337      CERTIFICATE-TRAILERS
 13338       TO DFHEIV11
 13339*    MOVE '&& L                  %  N#00012662' TO DFHEIV0
 13340     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13341     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13342     MOVE X'204E233030303132363632' TO DFHEIV0(25:11)
 13343     CALL 'kxdfhei1' USING DFHEIV0,
 13344           ELCRTT-DSID,
 13345           CERTIFICATE-TRAILERS,
 13346           DFHEIV11,
 13347           DFHEIV99
 13348     MOVE EIBRESP  TO WS-RESPONSE
 13349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13350     else
 13351        if ws-resp-notfnd
 13352           move 'CS'             to certificate-trailers
 13353           move cl-company-cd    to cs-company-cd
 13354           move cl-cert-key-data to cs-control-primary (2:21)
 13355           move cl-cert-no       to cs-cert-no
 13356           move 'B'              to cs-trailer-type
 13357           perform varying s1 from +1 by +1 until s1 > +24
 13358              move zeros         to cs-benefit-period (s1)
 13359                                    cs-days-paid (s1)
 13360                                    cs-total-paid (s1)
 13361                                    cs-remaining-bens (s1)
 13362           end-perform
 13363           perform 2225-upd-crt-trlr
 13364                                 thru 2225-exit
 13365
 13366* EXEC CICS WRITE
 13367*             DATASET  (ELCRTT-DSID)
 13368*             from     (CERTIFICATE-TRAILERS)
 13369*             RIDFLD   (cs-control-primary)
 13370*             RESP     (WS-RESPONSE)
 13371*          END-EXEC
 13372     MOVE LENGTH OF
 13373      CERTIFICATE-TRAILERS
 13374       TO DFHEIV11
 13375*    MOVE '&$ L                  ''  N#00012682' TO DFHEIV0
 13376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13378     MOVE X'204E233030303132363832' TO DFHEIV0(25:11)
 13379     CALL 'kxdfhei1' USING DFHEIV0,
 13380           ELCRTT-DSID,
 13381           CERTIFICATE-TRAILERS,
 13382           DFHEIV11,
 13383           cs-control-primary,
 13384           DFHEIV99,
 13385           DFHEIV99
 13386     MOVE EIBRESP  TO WS-RESPONSE
 13387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13388        end-if
 13389     END-IF
 13390
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 255
* EL156.cbl
 13391     .
 13392 2220-exit.
 13393     exit.
 13394
 13395 2225-upd-crt-trlr.
 13396
 13397*    if instypei = 'P'
 13398*       move +1 to s1
 13399*    else
 13400*       MOVE +2 to s1
 13401*    end-if
 13402
 13403*    move +1 to s1
 13404*    evaluate cl-claim-type
 13405*       when 'A'
 13406*          move +1 to s2
 13407*       when 'I'
 13408*          move +2 to s2
 13409*       when 'G'
 13410*          move +3 to s2
 13411*       when 'L'
 13412*          move +4 to s2
 13413*       when 'P'
 13414*          move +5 to s2
 13415*    end-evaluate
 13416     perform varying s1 from +1 by +1 until
 13417        (s1 > +24)
 13418        or (cl-claim-no = cs-claim-no (s1))
 13419     end-perform
 13420     if s1 < +25
 13421        compute cs-total-paid (s1) =
 13422           cs-total-paid (s1) + at-amount-paid
 13423        compute cs-days-paid (s1) =
 13424           cs-days-paid (s1) +  at-days-in-period
 13425*       compute cs-remaining-bens (s1) =
 13426*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13427        perform 2230-accum-bens-paid thru 2230-exit
 13428     end-if
 13429
 13430     .
 13431 2225-exit.
 13432     exit.
 13433 2230-accum-bens-paid.
 13434     if cl-claim-type not = 'L' and 'P'
 13435        move pi-ah-term          to ws-max-bens
 13436        if cl-critical-period not = zeros and spaces
 13437           move cl-critical-period
 13438                                 to ws-max-bens
 13439        end-if
 13440     else
 13441        move 01                  to ws-max-bens
 13442     end-if
 13443     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13444     perform varying s2 from +1 by +1 until
 13445        (s2 > +24)
 13446        or (cs-claim-no (s2) = spaces)
 13447        if pi-company-id not = 'DCC' and 'CAP'
 13448           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 256
* EL156.cbl
 13449              compute ws-tot-days-paid =
 13450                 ws-tot-days-paid + cs-days-paid (s2)
 13451              compute ws-tot-amt-paid =
 13452                 ws-tot-amt-paid + cs-total-paid (s2)
 13453           end-if
 13454        else
 13455           if (cs-benefit-period (s2) = cl-benefit-period)
 13456              and (cs-claim-type (s2) = cl-claim-type)
 13457              and (cs-insured-type (s2) = cl-insured-type)
 13458              compute ws-tot-days-paid =
 13459                 ws-tot-days-paid + cs-days-paid (s2)
 13460              compute ws-tot-amt-paid =
 13461                 ws-tot-amt-paid + cs-total-paid (s2)
 13462           end-if
 13463        end-if
 13464     end-perform
 13465     if cl-claim-type = 'L' and 'P'
 13466        if ws-tot-amt-paid > zeros
 13467           move zeros            to cs-remaining-bens (s1)
 13468        else
 13469           move 01               to cs-remaining-bens (s1)
 13470        end-if
 13471     else
 13472        compute ws-pd-bens rounded =
 13473           ws-tot-amt-paid / pi-ah-benefit-amt
 13474        compute cs-remaining-bens (s1) =
 13475           ws-max-bens - ws-pd-bens
 13476        if cs-remaining-bens (s1) < zeros
 13477           move zeros            to cs-remaining-bens (s1)
 13478        end-if
 13479     end-if
 13480     .
 13481 2230-exit.
 13482     exit.
 13483 3000-MOVE-INPUT-TO-SAVE-AREA.
 13484     IF PMTTYPEL > 0
 13485         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13486
 13487     if ws-pmttype = '4'
 13488        if pi-rb-joint-coverage
 13489           if payeel = +0
 13490              move +2            to payeel
 13491              move al-uanon      to payeea
 13492              move 'Q1'          to payeeo
 13493           else
 13494              if payeei not = 'Q1' and 'q1'
 13495                 move er-1582    to emi-error
 13496                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13497              end-if
 13498           end-if
 13499        end-if
 13500     end-if
 13501     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13502
 13503     IF WS-PMTTYPE = '9'
 13504         MOVE 'P'                TO PI-PROVISIONAL-IND
 13505         MOVE '1'                TO WS-PMTTYPE.
 13506
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 257
* EL156.cbl
 13507     IF PAYEEL > 0
 13508         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13509         MOVE PAYEEI             TO WS-PAYEE.
 13510
 13511     IF NOTE1L > +0
 13512         MOVE NOTE1I             TO WS-PMTNOTE1
 13513                                    WS-FLI-PMTNOTE
 13514                                    WS-HAN-PMTNOTE.
 13515
 13516     IF NOTE2L > +0
 13517         MOVE NOTE2I             TO WS-PMTNOTE2.
 13518
 13519     IF OFFLINEL > 0
 13520         MOVE OFFLINEI           TO WS-OFFLINE.
 13521
 13522     IF PROOFDTL > 0
 13523         MOVE PROOFDTI            TO DATE-WORK
 13524         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13525         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13526         MOVE '4'                 TO DC-OPTION-CODE
 13527         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13528         IF NO-CONVERSION-ERROR
 13529            MOVE NUM-WORK         TO PROOFDTO
 13530            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13531            MOVE NUM-WORK         TO WS-PROOF-DATE
 13532         ELSE
 13533            MOVE ZEROS            TO WS-PROOF-DATE
 13534         END-IF
 13535     END-IF.
 13536
 13537     IF EOBYNL > +0
 13538         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13539         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13540     END-IF
 13541
 13542     IF CLMFMYNL > +0
 13543         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13544         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13545     END-IF
 13546
 13547     IF SURVYYNL > +0
 13548         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13549         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13550     END-IF
 13551
 13552     IF SPRELYNL > +0
 13553         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13554         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13555     END-IF
 13556     if itrbynl <> +0
 13557        move function upper-case(itrbyni) to itrbyni
 13558        move itrbyni             to ws-int-to-rem-borr
 13559     end-if
 13560*    IF GROUPEDL > +0
 13561*        MOVE GROUPEDI           TO WS-GROUPED.
 13562*
 13563*    IF CASHL > +0
 13564*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 258
* EL156.cbl
 13565     IF LOANNOL > +0
 13566         MOVE LOANNOI            TO WS-LOAN-NO.
 13567
 13568     IF CHECKNOL > 0
 13569         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13570
 13571     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13572         IF WS-AIG-CREDIT-ENTERED
 13573             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13574             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13575             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13576             MOVE AL-UANON         TO CHECKNOA.
 13577
 13578     IF HOLDTILL > 0
 13579         MOVE HOLDTILI           TO DATE-WORK
 13580         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13581         MOVE NUM-WORK           TO WS-HOLDTIL.
 13582
 13583     IF ZINTL > +0
 13584
 13585* EXEC CICS BIF DEEDIT
 13586*           FIELD   (ZINTI)
 13587*           LENGTH  (07)
 13588*       END-EXEC
 13589     MOVE 07
 13590       TO DFHEIV11
 13591*    MOVE '@"L                   #   #00012884' TO DFHEIV0
 13592     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13593     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13594     MOVE X'2020233030303132383834' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0,
 13596           ZINTI,
 13597           DFHEIV11
 13598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13599        IF ZINTI NOT NUMERIC
 13600           MOVE ER-0419          TO EMI-ERROR
 13601           PERFORM 9900-ERROR-FORMAT
 13602           MOVE AL-UABON         TO ZINTA
 13603           MOVE -1               TO ZINTL
 13604        ELSE
 13605           MOVE ZINTI            TO CP-INT-RATE
 13606                                    WS-INT-RATE
 13607           MOVE CP-INT-RATE      TO ZINTO
 13608           MOVE AL-UNNON         TO ZINTA
 13609        END-IF
 13610     ELSE
 13611        MOVE ZEROS               TO CP-INT-RATE
 13612     END-IF
 13613     IF EPYFROML > 0
 13614         MOVE EPYFROMI           TO DATE-WORK
 13615         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13616         MOVE NUM-WORK           TO WS-EPYFROM.
 13617
 13618     IF AIGFROML > 0
 13619         MOVE AIGFROMI           TO DATE-WORK
 13620         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13621         MOVE NUM-WORK           TO WS-AIGFROM
 13622     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 259
* EL156.cbl
 13623         IF (AIGFROMI = LOW-VALUES) AND
 13624            (PI-AIGFROM NOT = ZEROS)
 13625              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13626
 13627     IF EPYTHRUL > +0
 13628        MOVE EPYTHRUI           TO DATE-WORK
 13629        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13630        MOVE NUM-WORK           TO WS-EPYTHRU
 13631        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13632        MOVE '4'                TO DC-OPTION-CODE
 13633        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13634        IF NO-CONVERSION-ERROR
 13635           IF PI-USES-PAID-TO
 13636              MOVE '6'                TO DC-OPTION-CODE
 13637              MOVE -1                 TO DC-ELAPSED-DAYS
 13638              MOVE +0                 TO DC-ELAPSED-MONTHS
 13639              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13640              IF NO-CONVERSION-ERROR
 13641                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13642                 MOVE ' '             TO DC-OPTION-CODE
 13643                 MOVE +0              TO DC-ELAPSED-DAYS
 13644                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13645              IF NO-CONVERSION-ERROR
 13646                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13647
 13648*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13649*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13650     IF EDAYSL > 0
 13651
 13652* EXEC CICS BIF DEEDIT
 13653*            FIELD(EDAYSI)
 13654*            LENGTH(6)
 13655*        END-EXEC
 13656     MOVE 6
 13657       TO DFHEIV11
 13658*    MOVE '@"L                   #   #00012940' TO DFHEIV0
 13659     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13660     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13661     MOVE X'2020233030303132393430' TO DFHEIV0(25:11)
 13662     CALL 'kxdfhei1' USING DFHEIV0,
 13663           EDAYSI,
 13664           DFHEIV11
 13665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13666         MOVE EDAYSI             TO WS-DY-WORK
 13667         IF WS-DY-SIGN = SPACES
 13668            MOVE WS-DY-NUM       TO WS-EDAYS
 13669            ADD 0                TO WS-EDAYS
 13670         ELSE
 13671            MOVE EDAYSI          TO WS-EDAYS
 13672            ADD 0                TO WS-EDAYS.
 13673
 13674*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13675*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13676     IF EPYAMTL > 0
 13677
 13678* EXEC CICS BIF DEEDIT
 13679*            FIELD(EPYAMTI)
 13680*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 260
* EL156.cbl
 13681*        END-EXEC
 13682     MOVE 10
 13683       TO DFHEIV11
 13684*    MOVE '@"L                   #   #00012955' TO DFHEIV0
 13685     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13686     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13687     MOVE X'2020233030303132393535' TO DFHEIV0(25:11)
 13688     CALL 'kxdfhei1' USING DFHEIV0,
 13689           EPYAMTI,
 13690           DFHEIV11
 13691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13692         MOVE EPYAMTI            TO WS-PY-WORK
 13693         IF WS-PY-SIGN = SPACES
 13694            MOVE WS-PY-NUM       TO WS-EPYAMT
 13695            ADD 0                TO WS-EPYAMT
 13696         ELSE
 13697            MOVE EPYAMTI         TO WS-EPYAMT
 13698            ADD 0                TO WS-EPYAMT.
 13699
 13700     IF ERESVL > 0
 13701
 13702* EXEC CICS BIF DEEDIT
 13703*            FIELD(ERESVI)
 13704*            LENGTH(9)
 13705*        END-EXEC
 13706     MOVE 9
 13707       TO DFHEIV11
 13708*    MOVE '@"L                   #   #00012968' TO DFHEIV0
 13709     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13710     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13711     MOVE X'2020233030303132393638' TO DFHEIV0(25:11)
 13712     CALL 'kxdfhei1' USING DFHEIV0,
 13713           ERESVI,
 13714           DFHEIV11
 13715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13716         MOVE ERESVI TO WS-ERESV.
 13717
 13718     IF EEXPENSL > 0
 13719
 13720* EXEC CICS BIF DEEDIT
 13721*            FIELD(EEXPENSI)
 13722*            LENGTH(8)
 13723*        END-EXEC
 13724     MOVE 8
 13725       TO DFHEIV11
 13726*    MOVE '@"L                   #   #00012975' TO DFHEIV0
 13727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13729     MOVE X'2020233030303132393735' TO DFHEIV0(25:11)
 13730     CALL 'kxdfhei1' USING DFHEIV0,
 13731           EEXPENSI,
 13732           DFHEIV11
 13733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13734         MOVE EEXPENSI           TO WS-EEXPENS.
 13735
 13736     IF ETYPEL > ZEROS
 13737         MOVE ETYPEI             TO WS-ETYPE.
 13738
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 261
* EL156.cbl
 13739     IF PI-COMPANY-ID = 'BOA'
 13740        IF PINTL > ZEROS
 13741
 13742* EXEC CICS BIF DEEDIT
 13743*            FIELD (PINTI)
 13744*            LENGTH(05)
 13745*          END-EXEC
 13746     MOVE 05
 13747       TO DFHEIV11
 13748*    MOVE '@"L                   #   #00012986' TO DFHEIV0
 13749     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13750     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13751     MOVE X'2020233030303132393836' TO DFHEIV0(25:11)
 13752     CALL 'kxdfhei1' USING DFHEIV0,
 13753           PINTI,
 13754           DFHEIV11
 13755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13756           IF PINTI NUMERIC
 13757               MOVE AL-UNNON     TO PINTA
 13758               MOVE PINTI        TO WS-INT-RATE
 13759               MOVE WS-INT-RATE  TO PINTO.
 13760
 13761 3000-EXIT.
 13762     EXIT.
 13763
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 262
* EL156.cbl
 13765 3050-REBUILD-ENTERED.
 13766
 13767     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13768
 13769     IF PI-PROV-PMT
 13770         MOVE '9'           TO PMTTYPEO
 13771     ELSE
 13772         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13773
 13774     MOVE PI-PAYEE          TO PAYEEO.
 13775     MOVE PI-PMTNOTE1       TO NOTE1O.
 13776     MOVE PI-PMTNOTE2       TO NOTE2O.
 13777     MOVE PI-OFFLINE        TO OFFLINEO.
 13778     IF PI-PROOF-DATE NOT = ZEROS
 13779         MOVE PI-PROOF-DATE TO PROOFDTO
 13780         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13781     END-IF.
 13782*    MOVE PI-GROUPED        TO GROUPEDO.
 13783
 13784*    MOVE PI-CASH           TO CASHO.
 13785
 13786     IF PI-INT-RATE > ZEROS
 13787        MOVE PI-INT-RATE         TO PINTO
 13788     end-if
 13789     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13790        IF PI-INT-AMT > ZEROS
 13791           MOVE PI-INT-AMT       TO PINTO
 13792           MOVE AL-PANOF         TO PINTA
 13793                                    PINTHA
 13794           if pi-rb-joint-coverage
 13795              move '  INT TO'    to itrb1o
 13796              move ' REM BORR?'  to itrb2o
 13797              move 'Y'           to itrbyno
 13798              move al-uanon      to itrbyna
 13799              move +1            to itrbynl
 13800           end-if
 13801        END-IF
 13802     END-IF
 13803     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13804     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13805     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13806     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13807     IF PI-HOLDTIL NOT = ZEROS
 13808        MOVE PI-HOLDTIL          TO HOLDTILO
 13809        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13810
 13811     IF PI-EPYFROM NOT = ZEROS
 13812        MOVE PI-EPYFROM          TO EPYFROMO
 13813        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13814
 13815     IF PI-AIGFROM NOT = ZEROS
 13816        MOVE PI-AIGFROM          TO AIGFROMO
 13817        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13818
 13819     IF PI-EPYTHRU NOT = ZEROS
 13820        MOVE PI-EPYTHRU          TO EPYTHRUO
 13821        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13822        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 263
* EL156.cbl
 13823           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13824           MOVE '4'                TO DC-OPTION-CODE
 13825           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13826           IF NO-CONVERSION-ERROR
 13827              MOVE +1 TO DC-ELAPSED-DAYS
 13828              MOVE +0 TO DC-ELAPSED-MONTHS
 13829              MOVE '6' TO DC-OPTION-CODE
 13830              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13831              IF NO-CONVERSION-ERROR
 13832                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13833
 13834     IF PI-EDAYS NOT = ZEROS
 13835        MOVE PI-EDAYS TO EDAYSO.
 13836
 13837     IF PI-EPYAMT NOT = ZEROS
 13838        MOVE PI-EPYAMT TO EPYAMTO.
 13839
 13840     IF PI-ERESV NOT = ZEROS
 13841        MOVE PI-ERESV TO ERESVO.
 13842
 13843     IF PI-EEXPENS NOT = ZEROS
 13844        MOVE PI-EEXPENS TO EEXPENSO.
 13845
 13846     MOVE PI-ETYPE TO ETYPEO.
 13847
 13848     IF PI-ECHECKNO NOT = SPACES
 13849        MOVE PI-ECHECKNO         TO CHECKNOO
 13850     ELSE
 13851        MOVE PI-CCHECKNO         TO CHECKNOO.
 13852
 13853     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13854     MOVE SPACES                 TO DC-OPTION-CODE.
 13855     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13856
 13857     IF DATE-CONVERSION-ERROR
 13858        MOVE SPACES              TO CPYFROMI
 13859     ELSE
 13860        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13861
 13862     IF PI-USES-PAID-TO
 13863        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13864        MOVE +1                  TO DC-ELAPSED-DAYS
 13865        MOVE +0                  TO DC-ELAPSED-MONTHS
 13866        MOVE '6'                 TO DC-OPTION-CODE
 13867        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13868        IF NO-CONVERSION-ERROR
 13869           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13870           GO TO 3051-CONTINUE.
 13871
 13872     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13873     MOVE SPACES                 TO DC-OPTION-CODE.
 13874     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13875
 13876     IF DATE-CONVERSION-ERROR
 13877        MOVE SPACES              TO CPYTHRUI
 13878     ELSE
 13879        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13880
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 264
* EL156.cbl
 13881 3051-CONTINUE.
 13882
 13883     IF PI-CDAYS NOT = ZEROS
 13884        MOVE PI-CDAYS TO CDAYSO.
 13885
 13886     IF PI-CPYAMT NOT = ZEROS
 13887        MOVE PI-CPYAMT TO CPYAMTO.
 13888
 13889     IF PI-CRESV NOT = ZEROS
 13890        MOVE PI-CRESV TO CRESVO.
 13891
 13892     IF PI-CEXPENS NOT = ZEROS
 13893        MOVE PI-CEXPENS TO CEXPENSO.
 13894
 13895 3059-EXIT.
 13896     EXIT.
 13897
 13898 3100-DEEDIT-DATE.
 13899
 13900* EXEC CICS BIF DEEDIT
 13901*        FIELD(DATE-WORK)
 13902*        LENGTH(8)
 13903*    END-EXEC.
 13904     MOVE 8
 13905       TO DFHEIV11
 13906*    MOVE '@"L                   #   #00013133' TO DFHEIV0
 13907     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13908     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13909     MOVE X'2020233030303133313333' TO DFHEIV0(25:11)
 13910     CALL 'kxdfhei1' USING DFHEIV0,
 13911           DATE-WORK,
 13912           DFHEIV11
 13913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13914
 13915
 13916 3100-EXIT.
 13917     EXIT.
 13918
 13919 3200-CALC-AIG-DAYS.
 13920
 13921     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13922
 13923     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13924     MOVE ' '                    TO DC-OPTION-CODE.
 13925     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13926     IF NO-CONVERSION-ERROR
 13927         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13928     ELSE
 13929         GO TO 3290-ERROR.
 13930
 13931     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13932         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13933                                WS-BIN-FROM-DT
 13934     ELSE
 13935         IF CL-TOTAL-PAID-AMT > ZEROS
 13936             IF WS-SV-EPYFROM = LOW-VALUES
 13937                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13938                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 265
* EL156.cbl
 13939             ELSE
 13940                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13941                                        WS-BIN-FROM-DT
 13942         ELSE
 13943             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13944                                        WS-BIN-FROM-DT.
 13945
 13946 3210-CONTINUE.
 13947
 13948     MOVE ' '                    TO DC-OPTION-CODE.
 13949     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13950     IF DATE-CONVERSION-ERROR
 13951         GO TO 3290-ERROR.
 13952
 13953     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13954
 13955     IF PI-LOAN-DUE-DAY = 31
 13956         MOVE 30              TO WS-PMT-DUE-DA
 13957                                 WS-SAVE-DUE-DA
 13958     ELSE
 13959         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13960                                 WS-SAVE-DUE-DA.
 13961
 13962     IF (PI-LOAN-DUE-DAY > 28) AND
 13963        (WS-PMT-DUE-MO = 2)
 13964         MOVE 'Y'                TO WS-DUE-DAY-SW
 13965         MOVE 28                 TO WS-PMT-DUE-DA.
 13966
 13967     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13968     MOVE '4'                    TO DC-OPTION-CODE.
 13969     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13970     IF NO-CONVERSION-ERROR
 13971         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13972     ELSE
 13973         GO TO 3290-ERROR.
 13974
 13975*--------------------------------------------------------------*
 13976*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13977*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13978*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13979*                                                              *
 13980*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13981*             INCURRED DATE      - 04/15/91                    *
 13982*             PMT DUE DATE       - 04/03/91                    *
 13983*             PMT DUE DATE       - 05/03/91                    *
 13984*--------------------------------------------------------------*
 13985
 13986     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13987        (WS-SV-AIGFROM = LOW-VALUES)
 13988         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13989            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13990             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13991             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13992             IF NO-CONVERSION-ERROR
 13993                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13994                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13995             ELSE
 13996                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 266
* EL156.cbl
 13997
 13998     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13999        (WS-SV-AIGFROM = LOW-VALUES)
 14000         GO TO 3205-CONT-CALC-PMT.
 14001
 14002     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14003     MOVE ' '                    TO DC-OPTION-CODE.
 14004     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14005     IF NO-CONVERSION-ERROR
 14006         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14007     ELSE
 14008         GO TO 3290-ERROR.
 14009
 14010     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14011        (WS-PMT-DUE-DA < WS-FROM-DA)
 14012          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14013          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14014          IF NO-CONVERSION-ERROR
 14015              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14016              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14017          ELSE
 14018              GO TO 3290-ERROR.
 14019
 14020 3205-CONT-CALC-PMT.
 14021
 14022*--------------------------------------------------------------*
 14023*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14024*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14025*--------------------------------------------------------------*
 14026
 14027     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14028        PI-PMTTYPE = '2'
 14029          NEXT SENTENCE
 14030     ELSE
 14031        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14032           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14033             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14034             MOVE ER-3527            TO EMI-ERROR
 14035             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14036             MOVE -1                 TO EPYTHRUL
 14037             MOVE AL-UNBON           TO EPYTHRUA
 14038                                        EPYFROMA
 14039             GO TO 3299-EXIT.
 14040
 14041*--------------------------------------------------------------*
 14042*    CALCULATE RETRO ELIMINATION DATE                          *
 14043*--------------------------------------------------------------*
 14044
 14045     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14046         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14047     ELSE
 14048         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14049
 14050     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14051     MOVE +0             TO DC-ELAPSED-MONTHS.
 14052     MOVE '6'            TO DC-OPTION-CODE.
 14053     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14054     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 267
* EL156.cbl
 14055         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14056     ELSE
 14057         GO TO 3290-ERROR.
 14058
 14059 3210-CHECK-PMT-DATE.
 14060
 14061*--------------------------------------------------------------*
 14062*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14063*    THE ENTERED PAY FROM DATE                                 *
 14064*--------------------------------------------------------------*
 14065
 14066     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14067         NEXT SENTENCE
 14068     ELSE
 14069         GO TO 3220-COMPUTE-DAYS.
 14070
 14071     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14072     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14073     IF NO-CONVERSION-ERROR
 14074         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14075         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14076         GO TO 3210-CHECK-PMT-DATE
 14077     ELSE
 14078         GO TO 3290-ERROR.
 14079
 14080 3220-COMPUTE-DAYS.
 14081
 14082     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14083     MOVE ZEROS         TO WS-CDAYS.
 14084     MOVE 'N'           TO WS-ELIMINATION-SW.
 14085
 14086*--------------------------------------------------------------*
 14087*    COMPUTE CALIFORNIA DUE DAYS                               *
 14088*--------------------------------------------------------------*
 14089
 14090     IF CL-TOTAL-PAID-AMT > ZEROS
 14091         MOVE 'Y' TO WS-ELIMINATION-SW
 14092         GO TO 3240-FIRST-PMT-DUE
 14093     ELSE
 14094        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14095            NEXT SENTENCE
 14096        ELSE
 14097            GO TO 3240-FIRST-PMT-DUE.
 14098
 14099 3230-NEXT-PMT-DUE.
 14100
 14101     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14102     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14103     IF NO-CONVERSION-ERROR
 14104         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14105         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14106     ELSE
 14107         GO TO 3290-ERROR.
 14108
 14109 3240-FIRST-PMT-DUE.
 14110
 14111     IF CL-TOTAL-PAID-AMT > ZEROS
 14112         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 268
* EL156.cbl
 14113     ELSE
 14114        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14115            GO TO 3230-NEXT-PMT-DUE.
 14116
 14117     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14118         GO TO 3250-VERIFY-ELIMINATION.
 14119
 14120     ADD +30 TO WS-CDAYS.
 14121     MOVE 'Y' TO WS-ELIMINATION-SW.
 14122     GO TO 3230-NEXT-PMT-DUE.
 14123
 14124 3250-VERIFY-ELIMINATION.
 14125
 14126     IF ELIM-SATISFIED
 14127         GO TO 3260-END-CALC.
 14128
 14129     IF PI-PMTTYPE = '1'
 14130         MOVE ZEROS TO WS-CDAYS
 14131         GO TO 3260-END-CALC.
 14132
 14133     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14134         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14135     ELSE
 14136         IF CL-TOTAL-PAID-AMT > ZEROS
 14137             IF WS-SV-EPYFROM = LOW-VALUES
 14138                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14139             ELSE
 14140                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14141         ELSE
 14142             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14143
 14144     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14145     MOVE '1'                    TO DC-OPTION-CODE.
 14146     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14147     IF NO-CONVERSION-ERROR
 14148         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14149     ELSE
 14150         GO TO 3290-ERROR.
 14151
 14152     IF CL-TOTAL-PAID-AMT > ZEROS
 14153         MOVE WS-DAYS-OFF TO WS-CDAYS
 14154     ELSE
 14155         IF PI-BEN-DAYS > WS-DAYS-OFF
 14156             MOVE ZEROS TO WS-CDAYS
 14157         ELSE
 14158             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14159
 14160 3260-END-CALC.
 14161
 14162     MOVE WS-CDAYS TO PI-CDAYS.
 14163
 14164     IF PI-EDAYS = ZEROS
 14165         MOVE PI-CDAYS TO PI-EDAYS
 14166         MOVE AL-UNNON TO EDAYSA.
 14167
 14168     GO TO 3299-EXIT.
 14169
 14170 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 269
* EL156.cbl
 14171
 14172     MOVE ER-3528            TO EMI-ERROR.
 14173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14174     MOVE -1                 TO CDAYSL.
 14175     MOVE AL-UNBON           TO CDAYSA.
 14176
 14177 3299-EXIT.
 14178     EXIT.
 14179
 14180 3300-BUMP-DATE.
 14181
 14182     IF WS-RESTORE-DUE-DAY
 14183         MOVE 'N'              TO WS-DUE-DAY-SW
 14184         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14185         ADD 1                 TO WS-PMT-DUE-MO
 14186         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14187         MOVE '4'              TO DC-OPTION-CODE
 14188         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14189         IF NO-CONVERSION-ERROR
 14190             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14191             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14192             GO TO 3399-EXIT
 14193         ELSE
 14194             MOVE '9'          TO DC-ERROR-CODE
 14195             GO TO 3399-EXIT.
 14196
 14197     IF (WS-PMT-DUE-MO = 1) AND
 14198        (WS-SAVE-DUE-DA > 28)
 14199           MOVE 'Y' TO WS-DUE-DAY-SW.
 14200
 14201     MOVE +0                 TO DC-ELAPSED-DAYS.
 14202     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14203     MOVE '6'                TO DC-OPTION-CODE.
 14204     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14205
 14206 3399-EXIT.
 14207     EXIT.
 14208
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 270
* EL156.cbl
 14210 3400-COMPUTE-EXPIRY.
 14211
 14212     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14213     MOVE +0                    TO DC-ELAPSED-DAYS
 14214                                   DC-ODD-DAYS-OVER.
 14215     MOVE '1'                   TO DC-END-OF-MONTH.
 14216     MOVE '6'                   TO DC-OPTION-CODE.
 14217
 14218     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14219         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14220     ELSE
 14221         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14222
 14223     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14224     IF NO-CONVERSION-ERROR
 14225         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14226     ELSE
 14227         GO TO 3390-CONTINUE.
 14228
 14229     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14230         GO TO 3390-CONTINUE.
 14231
 14232     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14233     MOVE '4'                    TO CNTL-REC-TYPE.
 14234     MOVE +0                     TO CNTL-SEQ-NO.
 14235     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14236     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14237     MOVE 'BENE'                 TO FILE-SWITCH.
 14238
 14239     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14240
 14241     IF NO-BENEFIT-FOUND
 14242         GO TO 3390-CONTINUE.
 14243
 14244     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 14245        IF (PI-OFFLINE = 'Y') OR
 14246           (PI-PMTTYPE = '7')
 14247           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14248                                     THRU 9870-EXIT
 14249           IF ERROR-ON-OUTPUT
 14250             MOVE -1                 TO ENTERPFL
 14251             MOVE AL-UANON           TO ENTERPFA
 14252             MOVE MAP-NAMEA          TO MAP-NAME
 14253             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14254             GO TO 8200-SEND-DATAONLY.
 14255
 14256     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14257        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14258        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14259          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14260          MOVE +0        TO DC-ELAPSED-DAYS
 14261          MOVE +1        TO DC-ELAPSED-MONTHS
 14262          MOVE 6         TO DC-OPTION-CODE
 14263          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14264          IF NO-CONVERSION-ERROR
 14265              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14266
 14267 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 271
* EL156.cbl
 14268
 14269      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14270         MOVE CM-AH-LOAN-EXPIRE-DT
 14271                                 TO DC-BIN-DATE-1
 14272      ELSE
 14273         MOVE CM-LF-LOAN-EXPIRE-DT
 14274                                 TO DC-BIN-DATE-1
 14275      END-IF
 14276
 14277      MOVE ' '                    TO DC-OPTION-CODE.
 14278      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14279      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14280      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14281
 14282 3499-EXIT.
 14283     EXIT.
 14284
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 272
* EL156.cbl
 14286
 14287 3600-CHECK-VERIFICATION.
 14288
 14289     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14290
 14291     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14292
 14293     IF PI-PAYEE-TYPE = 'I'
 14294        GO TO 3600-READ-TRAILER.
 14295
 14296     IF PI-PAYEE-TYPE = 'B'
 14297        ADD +10                  TO TRLR-SEQ-NO
 14298        GO TO 3600-READ-TRAILER.
 14299
 14300     IF PI-PAYEE-TYPE = 'A'
 14301        ADD +20                  TO TRLR-SEQ-NO
 14302        GO TO 3600-READ-TRAILER.
 14303
 14304     IF PI-PAYEE-TYPE = 'O'
 14305        ADD +50                  TO TRLR-SEQ-NO
 14306        GO TO 3600-READ-TRAILER.
 14307
 14308     IF PI-PAYEE-TYPE = 'Q'
 14309        ADD +60                  TO TRLR-SEQ-NO
 14310        GO TO 3600-READ-TRAILER.
 14311
 14312     IF PI-PAYEE-TYPE = 'P'
 14313        ADD +30                  TO TRLR-SEQ-NO
 14314        GO TO 3600-READ-TRAILER.
 14315
 14316     IF PI-PAYEE-TYPE = 'E'
 14317        ADD +40                  TO TRLR-SEQ-NO.
 14318
 14319 3600-READ-TRAILER.
 14320
 14321
 14322* EXEC CICS HANDLE CONDITION
 14323*         NOTFND(3600-CONTINUE)
 14324*    END-EXEC.
 14325*    MOVE '"$I                   ! - #00013543' TO DFHEIV0
 14326     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14328     MOVE X'2D20233030303133353433' TO DFHEIV0(25:11)
 14329     CALL 'kxdfhei1' USING DFHEIV0
 14330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14331
 14332
 14333     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14334
 14335 3600-CONTINUE.
 14336
 14337     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14338         GO TO 3600-AH-VERIFY
 14339     END-IF.
 14340
 14341     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14342       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14343         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 273
* EL156.cbl
 14344           MOVE ER-7576            TO EMI-ERROR
 14345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14346           MOVE -1                 TO PAYEEL
 14347           MOVE AL-UABON           TO PAYEEA
 14348           GO TO 3600-EXIT
 14349         END-IF
 14350       END-IF
 14351     END-IF.
 14352
 14353     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14354     MOVE 1 TO WS-SUB2
 14355     MOVE SPACES TO WS-PAYEE-NAME
 14356     PERFORM VARYING WS-SUB FROM 1 BY 1
 14357             UNTIL WS-SUB > 30
 14358         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14359            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14360                 WS-PAYEE-NAME-X (WS-SUB2)
 14361            ADD +1 TO WS-SUB2
 14362         END-IF
 14363     END-PERFORM.
 14364
 14365     STRING CL-INSURED-1ST-NAME
 14366            CL-INSURED-MID-INIT
 14367            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14368     MOVE 1 TO WS-SUB2
 14369     MOVE SPACES TO WS-INSURED-NAME
 14370     PERFORM VARYING WS-SUB FROM 1 BY 1
 14371             UNTIL WS-SUB > 30
 14372         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14373            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14374                 WS-INSURED-NAME-X (WS-SUB2)
 14375            ADD +1 TO WS-SUB2
 14376         END-IF
 14377     END-PERFORM.
 14378
 14379     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14380        MOVE ER-7579            TO EMI-ERROR
 14381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14382        MOVE -1                 TO PAYEEL
 14383        MOVE AL-UABON           TO PAYEEA
 14384     END-IF.
 14385
 14386     IF PI-PMTTYPE = '4'  AND
 14387        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14388        PI-PAYEE-TYPE <> 'I'
 14389          MOVE ER-7580          TO EMI-ERROR
 14390          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14391          MOVE -1               TO PAYEEL
 14392          MOVE AL-UABON         TO PAYEEA
 14393     END-IF.
 14394
 14395     GO TO 3600-EXIT.
 14396
 14397 3600-AH-VERIFY.
 14398
 14399     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14400        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14401           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 274
* EL156.cbl
 14402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14403           MOVE -1                 TO PAYEEL
 14404           MOVE AL-UABON           TO PAYEEA
 14405        END-IF
 14406     END-IF.
 14407
 14408
 14409 3600-EXIT.
 14410     EXIT.
 14411
 14412 5000-UPDATE.
 14413
 14414     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14415
 14416     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14417
 14418     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14419        PI-OFFLINE = 'Y'
 14420        NEXT SENTENCE
 14421     ELSE
 14422        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14423
 14424*    IF PI-COMPANY-ID = 'CRI'
 14425*       IF PI-PMTTYPE = '1' OR  '2'
 14426*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14427*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14428*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14429
 14430*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14431*       IF PI-PMTTYPE = '1'
 14432*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14433*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14434
 14435     IF PI-PMTTYPE      = '2' AND
 14436        PI-SPLIT-PMT-SW = 'Y' AND
 14437        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14438          MOVE ER-3530                TO EMI-ERROR
 14439          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14440
 14441     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14442        AND (CL-CLAIM-TYPE = 'L')
 14443        IF PI-PMTTYPE = '2' OR '4'
 14444           IF PI-INT-AMT NOT = ZEROS
 14445              PERFORM 7110-BUILD-PMT-TRLR
 14446                                 THRU 7130-EXIT
 14447           ELSE
 14448              IF PI-PMTTYPE = '2'
 14449                 PERFORM 7140-BUILD-NOTE-TRLR
 14450                                 THRU 7170-EXIT
 14451              END-IF
 14452           END-IF
 14453        END-IF
 14454     END-IF
 14455*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14456*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14457*            MOVE 'N'                 TO  WS-LETTER-SW.
 14458
 14459*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 275
* EL156.cbl
 14460*        IF CL-NO-OF-PMTS-MADE = +1
 14461*                OR
 14462*           PI-PMTTYPE = '2'
 14463*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14464
 14465     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14466
 14467*    IF PI-COMPANY-ID = 'DMD'
 14468*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14469*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14470
 14471
 14472* EXEC CICS REWRITE
 14473*         DATASET('ELMSTR')
 14474*         FROM(CLAIM-MASTER)
 14475*     END-EXEC.
 14476     MOVE LENGTH OF
 14477      CLAIM-MASTER
 14478       TO DFHEIV11
 14479     MOVE 'ELMSTR' TO DFHEIV1
 14480*    MOVE '&& L                  %   #00013685' TO DFHEIV0
 14481     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14482     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14483     MOVE X'2020233030303133363835' TO DFHEIV0(25:11)
 14484     CALL 'kxdfhei1' USING DFHEIV0,
 14485           DFHEIV1,
 14486           CLAIM-MASTER,
 14487           DFHEIV11,
 14488           DFHEIV99
 14489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14490
 14491
 14492     IF WS-LETTER-SW = 'N'
 14493         GO TO 5000-END-UPDATE.
 14494
 14495 5000-GENERATE-AUTO-LETTER.
 14496
 14497
 14498* EXEC CICS LINK
 14499*        PROGRAM    (LINK-1523)
 14500*        COMMAREA   (W-1523-LINKDATA)
 14501*        LENGTH     (W-1523-COMM-LENGTH)
 14502*    END-EXEC.
 14503*    MOVE '."C                   (   #00013695' TO DFHEIV0
 14504     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14506     MOVE X'2020233030303133363935' TO DFHEIV0(25:11)
 14507     CALL 'kxdfhei1' USING DFHEIV0,
 14508           LINK-1523,
 14509           W-1523-LINKDATA,
 14510           W-1523-COMM-LENGTH,
 14511           DFHEIV99,
 14512           DFHEIV99,
 14513           DFHEIV99,
 14514           DFHEIV99
 14515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14516
 14517
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 276
* EL156.cbl
 14518     IF W-1523-FATAL-ERROR
 14519         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14521         MOVE ER-0802                TO  EMI-ERROR
 14522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14523
 14524     IF W-1523-ERROR-CODE = 0191
 14525         MOVE ER-0803                TO  EMI-ERROR
 14526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14527
 14528     IF PI-COMPANY-ID      = 'HAN' AND
 14529        PI-PMTTYPE         = '1'   AND
 14530        PI-3RD-PARTY-SW    = 'Y'   AND
 14531        W-1523-FORM-NUMBER = 'EOB1'
 14532           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14533           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14534           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14535           GO TO 5000-GENERATE-AUTO-LETTER.
 14536
 14537 5000-END-UPDATE.
 14538
 14539     MOVE ER-0000                TO EMI-ERROR.
 14540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14541     GO TO 7000-SHOW-CLAIM.
 14542
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 277
* EL156.cbl
 14544 5000-MOVE-NAME.
 14545     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14546     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14547     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14548
 14549 5000-EXIT.
 14550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 278
* EL156.cbl
 14552 5300-CREATE-DMO.
 14553
 14554     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14555     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14556     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14557
 14558
 14559* EXEC CICS HANDLE CONDITION
 14560*         NOTFND   (5300-NOTE-NOT-FOUND)
 14561*    END-EXEC.
 14562*    MOVE '"$I                   ! . #00013741' TO DFHEIV0
 14563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14565     MOVE X'2E20233030303133373431' TO DFHEIV0(25:11)
 14566     CALL 'kxdfhei1' USING DFHEIV0
 14567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14568
 14569
 14570
 14571* EXEC CICS READ
 14572*         DATASET('ERNOTE')
 14573*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14574*         RIDFLD (W-NOTE-KEY)
 14575*    END-EXEC.
 14576     MOVE 'ERNOTE' TO DFHEIV1
 14577*    MOVE '&"S        E          (   #00013745' TO DFHEIV0
 14578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14580     MOVE X'2020233030303133373435' TO DFHEIV0(25:11)
 14581     CALL 'kxdfhei1' USING DFHEIV0,
 14582           DFHEIV1,
 14583           DFHEIV20,
 14584           DFHEIV99,
 14585           W-NOTE-KEY,
 14586           DFHEIV99,
 14587           DFHEIV99,
 14588           DFHEIV99
 14589     SET ADDRESS OF CERTIFICATE-NOTE TO
 14590         DFHEIV20
 14591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14592
 14593
 14594     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14595     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14596     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14597
 14598     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14599         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14600     ELSE
 14601         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14602
 14603     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14604     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14605     MOVE 'DLO006'               TO PGM-NAME.
 14606
 14607
 14608* EXEC CICS LINK
 14609*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 279
* EL156.cbl
 14610*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14611*        LENGTH     (DCT-RCRD-LENGTH)
 14612*    END-EXEC.
 14613*    MOVE '."C                   (   #00013764' TO DFHEIV0
 14614     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14616     MOVE X'2020233030303133373634' TO DFHEIV0(25:11)
 14617     CALL 'kxdfhei1' USING DFHEIV0,
 14618           PGM-NAME,
 14619           DCT-COMMUNICATION-AREA,
 14620           DCT-RCRD-LENGTH,
 14621           DFHEIV99,
 14622           DFHEIV99,
 14623           DFHEIV99,
 14624           DFHEIV99
 14625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14626
 14627
 14628     IF DCT-RETURN-CODE = 'OK'
 14629         GO TO 5300-CONT.
 14630
 14631     IF DCT-RETURN-CODE = '01' OR '02'
 14632         GO TO 5300-EXIT.
 14633
 14634     IF DCT-RETURN-CODE = '03'
 14635         MOVE ER-0951            TO EMI-ERROR
 14636         GO TO 5300-BAD-EXIT.
 14637
 14638     IF DCT-RETURN-CODE = '04'
 14639         MOVE ER-0946            TO EMI-ERROR
 14640         GO TO 5300-BAD-EXIT.
 14641
 14642     IF DCT-RETURN-CODE = '05'
 14643         MOVE ER-0947            TO EMI-ERROR
 14644         GO TO 5300-BAD-EXIT.
 14645
 14646     IF DCT-RETURN-CODE = '06'
 14647         MOVE ER-0921            TO EMI-ERROR
 14648         GO TO 5300-BAD-EXIT.
 14649
 14650     IF DCT-RETURN-CODE = '07'
 14651         MOVE ER-0849            TO EMI-ERROR
 14652         GO TO 5300-BAD-EXIT.
 14653
 14654     IF DCT-RETURN-CODE = '08'
 14655         MOVE ER-0948            TO EMI-ERROR
 14656         GO TO 5300-BAD-EXIT.
 14657
 14658     IF DCT-RETURN-CODE = 'N1'
 14659         MOVE ER-0950            TO EMI-ERROR
 14660         GO TO 5300-BAD-EXIT.
 14661
 14662     IF DCT-RETURN-CODE = 'E1'
 14663         MOVE ER-0974            TO EMI-ERROR
 14664         GO TO 5300-BAD-EXIT.
 14665
 14666     IF DCT-RETURN-CODE = 'E2'
 14667         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 280
* EL156.cbl
 14668         GO TO 5300-BAD-EXIT.
 14669
 14670     IF DCT-RETURN-CODE NOT = 'OK'
 14671         MOVE ER-0949            TO EMI-ERROR
 14672         GO TO 5300-BAD-EXIT.
 14673
 14674 5300-CONT.
 14675
 14676     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14677     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14678     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14679     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14680     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14681     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14682     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14683     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14684
 14685     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14686     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14687     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14688     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14689     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14690
 14691     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14692
 14693     IF PI-PMTTYPE = '2'
 14694         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14695         MOVE '4'                TO DM-CLAIM-STATUS
 14696     ELSE
 14697         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14698         MOVE '2'                TO DM-CLAIM-STATUS.
 14699
 14700     MOVE 'DLO025'               TO PGM-NAME.
 14701
 14702
 14703* EXEC CICS LINK
 14704*        PROGRAM    (PGM-NAME)
 14705*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14706*        LENGTH     (DM-DMO-LENGTH)
 14707*    END-EXEC.
 14708*    MOVE '."C                   (   #00013844' TO DFHEIV0
 14709     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14711     MOVE X'2020233030303133383434' TO DFHEIV0(25:11)
 14712     CALL 'kxdfhei1' USING DFHEIV0,
 14713           PGM-NAME,
 14714           DMO-COMMUNICATION-AREA,
 14715           DM-DMO-LENGTH,
 14716           DFHEIV99,
 14717           DFHEIV99,
 14718           DFHEIV99,
 14719           DFHEIV99
 14720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14721
 14722
 14723     IF DM-RETURN-CODE = 'OK'
 14724         GO TO 5300-EXIT.
 14725
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 281
* EL156.cbl
 14726     IF DM-RETURN-CODE = '01'
 14727         MOVE ER-8051            TO EMI-ERROR
 14728         GO TO 5300-BAD-EXIT.
 14729
 14730     IF DM-RETURN-CODE = '02'
 14731         MOVE ER-8052            TO EMI-ERROR
 14732         GO TO 5300-BAD-EXIT.
 14733
 14734     IF DM-RETURN-CODE = '03'
 14735         MOVE ER-8053            TO EMI-ERROR
 14736         GO TO 5300-BAD-EXIT.
 14737
 14738     IF DM-RETURN-CODE = '04'
 14739         MOVE ER-8054            TO EMI-ERROR
 14740         GO TO 5300-BAD-EXIT.
 14741
 14742     IF DM-RETURN-CODE = '05'
 14743         MOVE ER-8055            TO EMI-ERROR
 14744         GO TO 5300-BAD-EXIT.
 14745
 14746     IF DM-RETURN-CODE = '06'
 14747         MOVE ER-8056            TO EMI-ERROR
 14748         GO TO 5300-BAD-EXIT.
 14749
 14750     IF DM-RETURN-CODE = '07'
 14751         MOVE ER-8057            TO EMI-ERROR
 14752         GO TO 5300-BAD-EXIT.
 14753
 14754     IF DM-RETURN-CODE = '08'
 14755         MOVE ER-8058            TO EMI-ERROR
 14756         GO TO 5300-BAD-EXIT.
 14757
 14758     IF DM-RETURN-CODE = '09'
 14759         MOVE ER-8059            TO EMI-ERROR
 14760         GO TO 5300-BAD-EXIT.
 14761
 14762     IF DM-RETURN-CODE = '10'
 14763         MOVE ER-8060            TO EMI-ERROR
 14764         GO TO 5300-BAD-EXIT.
 14765
 14766     IF DM-RETURN-CODE = '11'
 14767         MOVE ER-8061            TO EMI-ERROR
 14768         GO TO 5300-BAD-EXIT.
 14769
 14770     IF DM-RETURN-CODE = '12'
 14771         MOVE ER-8062            TO EMI-ERROR
 14772         GO TO 5300-BAD-EXIT.
 14773
 14774     IF DM-RETURN-CODE = '13'
 14775         MOVE ER-8063            TO EMI-ERROR
 14776         GO TO 5300-BAD-EXIT.
 14777
 14778     IF DM-RETURN-CODE = '14'
 14779         MOVE ER-8064            TO EMI-ERROR
 14780         GO TO 5300-BAD-EXIT.
 14781
 14782     IF DM-RETURN-CODE = '15'
 14783         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 282
* EL156.cbl
 14784         GO TO 5300-BAD-EXIT.
 14785
 14786     IF DM-RETURN-CODE = '16'
 14787         MOVE ER-8154            TO EMI-ERROR
 14788         GO TO 5300-BAD-EXIT.
 14789
 14790     IF DM-RETURN-CODE = '17'
 14791         MOVE ER-8155            TO EMI-ERROR
 14792         GO TO 5300-BAD-EXIT.
 14793
 14794     IF DM-RETURN-CODE = 'N1'
 14795         MOVE ER-8152            TO EMI-ERROR
 14796         GO TO 5300-BAD-EXIT.
 14797
 14798     IF DM-RETURN-CODE = 'E1'
 14799         MOVE ER-8153            TO EMI-ERROR
 14800         GO TO 5300-BAD-EXIT.
 14801
 14802     MOVE ER-8066            TO EMI-ERROR.
 14803     GO TO 5300-BAD-EXIT.
 14804
 14805 5300-NOTE-NOT-FOUND.
 14806
 14807     MOVE ER-0954                TO EMI-ERROR.
 14808     GO TO 5300-BAD-EXIT.
 14809
 14810 5300-BAD-EXIT.
 14811
 14812* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14813*    MOVE '6"R                   !   #00013938' TO DFHEIV0
 14814     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14816     MOVE X'2020233030303133393338' TO DFHEIV0(25:11)
 14817     CALL 'kxdfhei1' USING DFHEIV0
 14818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14819
 14820     IF MAP-NAME = 'EL156A'
 14821         MOVE -1             TO ENTERPFL
 14822       ELSE
 14823         MOVE LOW-VALUES     TO EL156BI
 14824         MOVE -1             TO ENTPFBL.
 14825
 14826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14827     GO TO 8200-SEND-DATAONLY.
 14828
 14829 5300-EXIT.
 14830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 283
* EL156.cbl
 14832 5350-FORMAT-LAST-NAME-1ST.
 14833*****************************************************************
 14834*             M O V E   N A M E   R O U T I N E                 *
 14835*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14836*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14837*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14838*                  FIELD                   VALUE                *
 14839*           W-NAME-LAST    (CL15)      SMITH                    *
 14840*           W-NAME-FIRST   (CL15)      JOHN                     *
 14841*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14842*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14843*     CONTAIN                                                   *
 14844*                SMITH, JOHN ALLEN                              *
 14845*     OR                                                        *
 14846*                SMITH, JOHN A.                                 *
 14847*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14848*     COPYBOOK, ELCNWA.                                         *
 14849*****************************************************************.
 14850
 14851     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14852     MOVE ZERO                   TO  WS-NAME-SW.
 14853     SET NWA-INDEX               TO +1.
 14854
 14855     IF W-NAME-LAST   = SPACES AND
 14856        W-NAME-MIDDLE = SPACES
 14857         MOVE +1                 TO WS-NAME-SW.
 14858
 14859     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14860     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14861
 14862     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14863     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14864
 14865     SET NWA-INDEX UP BY +1.
 14866
 14867     IF W-NAME-MIDDLE NOT = SPACES
 14868         IF W-NAME-MIDDLE-2 = SPACES
 14869             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14870             SET NWA-INDEX UP BY +1
 14871             MOVE '.'            TO WS-NW (NWA-INDEX)
 14872             SET NWA-INDEX UP BY +2
 14873         ELSE
 14874             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14875             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14876
 14877 5350-EXIT.
 14878     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 284
* EL156.cbl
 14880 5360-MOVE-NAME.
 14881
 14882     IF WS-NAME-SW > +1
 14883         GO TO 5360-EXIT.
 14884
 14885     IF WS-NAME-WORK2 = SPACES
 14886         GO TO 5360-EXIT.
 14887
 14888     SET NWA-INDEX2            TO +1.
 14889     SET NWA-INDEX3            TO +2.
 14890
 14891 5360-MOVE-NAME-CYCLE.
 14892
 14893     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14894
 14895     IF NWA-INDEX < +30
 14896         SET NWA-INDEX UP BY +1
 14897     ELSE
 14898         ADD +2                TO  WS-NAME-SW
 14899         GO TO 5360-EXIT.
 14900
 14901     IF NWA-INDEX2 < +20
 14902         SET NWA-INDEX3 UP BY +1
 14903         SET NWA-INDEX2 UP BY +1.
 14904
 14905     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14906        WS-NW2 (NWA-INDEX3) = SPACES
 14907         IF WS-NAME-SW = ZERO
 14908             MOVE ','            TO  WS-NW (NWA-INDEX)
 14909             SET NWA-INDEX UP BY +2
 14910             MOVE +1             TO  WS-NAME-SW
 14911             GO TO 5360-EXIT
 14912         ELSE
 14913             GO TO 5360-EXIT.
 14914
 14915     GO TO 5360-MOVE-NAME-CYCLE.
 14916
 14917 5360-EXIT.
 14918     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 285
* EL156.cbl
 14920 6000-BUILD-SCREEN-B.
 14921     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14922     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14923     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14924     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14925
 14926     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14927
 14928 6050-BUILD-SCREEN.
 14929     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14930     MOVE LOW-VALUES             TO EL156BI.
 14931     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14932
 14933     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14934
 14935     IF PI-PAYEE-TYPE = 'I'
 14936        GO TO 6060-READ-TRAILER.
 14937
 14938     IF PI-PAYEE-TYPE = 'B'
 14939        ADD +10                  TO TRLR-SEQ-NO
 14940        GO TO 6060-READ-TRAILER.
 14941
 14942     IF PI-PAYEE-TYPE = 'A'
 14943        ADD +20                  TO TRLR-SEQ-NO
 14944        GO TO 6060-READ-TRAILER.
 14945
 14946     IF PI-PAYEE-TYPE = 'O'
 14947        ADD +50                  TO TRLR-SEQ-NO
 14948        GO TO 6060-READ-TRAILER.
 14949
 14950     IF PI-PAYEE-TYPE = 'Q'
 14951        ADD +60                  TO TRLR-SEQ-NO
 14952        GO TO 6060-READ-TRAILER.
 14953
 14954     IF PI-PAYEE-TYPE = 'P'
 14955        ADD +30                  TO TRLR-SEQ-NO
 14956        GO TO 6060-READ-TRAILER.
 14957
 14958     IF PI-PAYEE-TYPE = 'E'
 14959        ADD +40                  TO TRLR-SEQ-NO.
 14960
 14961 6060-READ-TRAILER.
 14962
 14963     IF PI-PAYEE-TYPE    = 'A' AND
 14964        PI-PAYEE-SEQ-NUM = 0
 14965          GO TO 6061-READ-ACCOUNT.
 14966
 14967     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14968        (PI-PAYEE-TYPE    = 'B')             AND
 14969        (PI-PAYEE-SEQ-NUM = 9)
 14970          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14971          IF BENE-FOUND-SW = 'N'
 14972            GO TO 6065-NOT-FOUND
 14973          ELSE
 14974            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14975            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14976            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14977*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 286
* EL156.cbl
 14978            STRING BE-CITY ' ' BE-STATE
 14979               DELIMITED BY '  ' INTO CITYSTBO
 14980            END-STRING
 14981            MOVE BE-ZIP-CODE       TO ZIPBO
 14982            GO TO 6061-READ-ACCOUNT.
 14983
 14984     IF PI-PAYEE-TYPE    = 'B' AND
 14985        PI-PAYEE-SEQ-NUM = 0
 14986          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14987          IF BENE-FOUND-SW = 'N'
 14988            GO TO 6065-NOT-FOUND
 14989          ELSE
 14990            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14991            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14992            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14993*           MOVE BE-CITY-STATE     TO CITYSTBO
 14994            STRING BE-CITY ' ' BE-STATE
 14995               DELIMITED BY '  ' INTO CITYSTBO
 14996            END-STRING
 14997            MOVE BE-ZIP-CODE       TO ZIPBO
 14998            GO TO 6061-READ-ACCOUNT.
 14999
 15000
 15001* EXEC CICS HANDLE CONDITION
 15002*         NOTFND(6065-NOT-FOUND)
 15003*     END-EXEC.
 15004*    MOVE '"$I                   ! / #00014119' TO DFHEIV0
 15005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15007     MOVE X'2F20233030303134313139' TO DFHEIV0(25:11)
 15008     CALL 'kxdfhei1' USING DFHEIV0
 15009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15010
 15011
 15012     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15013
 15014     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15015     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15016     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15017     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15018*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15019     STRING AT-CITY ' ' AT-STATE
 15020        DELIMITED BY '  ' INTO CITYSTBO
 15021     END-STRING
 15022     MOVE AT-ZIP-CODE            TO ZIPBO.
 15023
 15024 6061-READ-ACCOUNT.
 15025
 15026* EXEC CICS HANDLE CONDITION
 15027*         NOTFND(6068-ACCT-NOT-FND)
 15028*     END-EXEC.
 15029*    MOVE '"$I                   ! 0 #00014136' TO DFHEIV0
 15030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15032     MOVE X'3020233030303134313336' TO DFHEIV0(25:11)
 15033     CALL 'kxdfhei1' USING DFHEIV0
 15034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15035
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 287
* EL156.cbl
 15036
 15037
 15038* EXEC CICS READ
 15039*         DATASET('ERACCT')
 15040*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15041*         RIDFLD (PI-ACCT-KEY)
 15042*     END-EXEC.
 15043     MOVE 'ERACCT' TO DFHEIV1
 15044*    MOVE '&"S        E          (   #00014140' TO DFHEIV0
 15045     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15047     MOVE X'2020233030303134313430' TO DFHEIV0(25:11)
 15048     CALL 'kxdfhei1' USING DFHEIV0,
 15049           DFHEIV1,
 15050           DFHEIV20,
 15051           DFHEIV99,
 15052           PI-ACCT-KEY,
 15053           DFHEIV99,
 15054           DFHEIV99,
 15055           DFHEIV99
 15056     SET ADDRESS OF ACCOUNT-MASTER TO
 15057         DFHEIV20
 15058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15059
 15060
 15061     MOVE AM-CARRIER             TO ACARRBO.
 15062     MOVE AM-GROUPING            TO GROUPBO.
 15063     MOVE AM-STATE               TO STATEBO.
 15064     MOVE AM-ACCOUNT             TO ACCTBO.
 15065     MOVE AM-NAME                TO ACCTNMBO.
 15066
 15067     IF PI-PAYEE-TYPE = 'A' AND
 15068        PI-PAYEE-SEQ-NUM = 0
 15069          MOVE AM-NAME             TO NAMEBO
 15070                                      PI-PAYEE-NAME
 15071          MOVE AM-ADDRS            TO ADDR1BO
 15072          MOVE SPACES              TO ADDR2BO
 15073*         MOVE AM-CITY             TO CITYSTBO
 15074          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15075             DELIMITED BY '  ' INTO CITYSTBO
 15076          END-STRING
 15077          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15078          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15079          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15080          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15081
 15082***  We don't really need the code below because we don't do the
 15083***  AK thing anymore.  However, we may have a state special
 15084***  of some sort in the future so why not just leave it??
 15085     IF CITYSTBO EQUAL SPACES
 15086         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15087         GO TO 6070-FORMAT-DATA
 15088     END-IF.
 15089
 15090     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15091     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15092     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15093     PERFORM VARYING WS-SUB FROM 30 BY -1
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 288
* EL156.cbl
 15094          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15095        IF WS-END-SUB = 0  AND
 15096           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15097              OR LOW-VALUES  OR '.')
 15098            CONTINUE
 15099        ELSE
 15100            IF WS-END-SUB = 0
 15101                MOVE WS-SUB TO WS-END-SUB
 15102            ELSE
 15103                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15104                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15105                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15106                END-IF
 15107            END-IF
 15108        END-IF
 15109        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15110            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15111            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15112        END-IF
 15113     END-PERFORM.
 15114
 15115     IF WS-BEG-SUB > 0
 15116         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15117         IF WS-STATE-LENGTH = 2
 15118             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15119                  TO PI-CHECK-STATE-FOR-AK
 15120         ELSE
 15121             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15122                'ALASKA'
 15123                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15124             ELSE
 15125                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15126             END-IF
 15127         END-IF
 15128     ELSE
 15129         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15130     END-IF.
 15131
 15132     GO TO 6070-FORMAT-DATA.
 15133
 15134 6065-NOT-FOUND.
 15135     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15136     GO TO 6061-READ-ACCOUNT.
 15137
 15138 6068-ACCT-NOT-FND.
 15139     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15140
 15141 6070-FORMAT-DATA.
 15142     IF PI-HOLDTIL = ZEROS
 15143        MOVE SAVE-DATE           TO PAYDTBI
 15144       ELSE
 15145        MOVE PI-HOLDTIL          TO PAYDTBO
 15146        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 15147
 15148     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15149     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15150
 15151     IF EIBAID = DFHPF3 OR DFHPF4
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 289
* EL156.cbl
 15152        NEXT SENTENCE
 15153     ELSE
 15154       GO TO 6071-CONTINUE.
 15155
 15156     MOVE PI-EPYFROM          TO PYFROMBO.
 15157     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15158
 15159     IF NOT PI-USES-PAID-TO
 15160        MOVE PI-EPYTHRU          TO PYTHRUBO
 15161        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15162     ELSE
 15163        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15164        MOVE '4'              TO DC-OPTION-CODE
 15165        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15166        IF NO-CONVERSION-ERROR
 15167           MOVE +1            TO DC-ELAPSED-DAYS
 15168           MOVE +0            TO DC-ELAPSED-MONTHS
 15169           MOVE '6'           TO DC-OPTION-CODE
 15170           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15171           IF NO-CONVERSION-ERROR
 15172              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15173
 15174     MOVE PI-EDAYS            TO DAYSBO.
 15175     MOVE PI-EPYAMT           TO PAYAMTBO.
 15176     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15177        IF PI-INT-AMT > ZEROS
 15178           MOVE PI-INT-AMT       TO INTAMTBO
 15179        END-IF
 15180     END-IF
 15181     GO TO 6072-SET-TYPE.
 15182
 15183 6071-CONTINUE.
 15184
 15185     IF PI-CPYFROM NOT = LOW-VALUES
 15186        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15187        MOVE SPACES              TO DC-OPTION-CODE
 15188        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15189        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15190
 15191     IF PI-CPYTHRU NOT = LOW-VALUES
 15192        IF NOT PI-USES-PAID-TO
 15193           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15194           MOVE SPACES             TO DC-OPTION-CODE
 15195           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15196           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15197        ELSE
 15198           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15199           MOVE '6'                TO DC-OPTION-CODE
 15200           MOVE +1                 TO DC-ELAPSED-DAYS
 15201           MOVE +0                 TO DC-ELAPSED-MONTHS
 15202           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15203           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15204
 15205     MOVE PI-CDAYS               TO DAYSBO.
 15206     MOVE PI-CPYAMT              TO PAYAMTBO.
 15207     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15208        IF PI-INT-AMT > ZEROS
 15209           MOVE PI-INT-AMT       TO INTAMTBO
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 290
* EL156.cbl
 15210        END-IF
 15211     END-IF
 15212     .
 15213 6072-SET-TYPE.
 15214     IF PI-PMTTYPE = '1'
 15215        MOVE 'PARTIAL'           TO PAYTYPBO.
 15216
 15217     IF PI-PMTTYPE = '2'
 15218        MOVE 'FINAL'             TO PAYTYPBO.
 15219
 15220     IF PI-PMTTYPE = '3'
 15221        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15222
 15223     IF PI-PMTTYPE = '4'
 15224        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15225
 15226     IF PI-PMTTYPE = '5'
 15227        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15228
 15229     IF PI-PMTTYPE = '6'
 15230        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15231
 15232     IF PI-PROV-PMT
 15233        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15234
 15235     IF PI-ECHECKNO NOT = SPACES
 15236        MOVE PI-ECHECKNO         TO CKNUMBO
 15237     ELSE
 15238        MOVE PI-CCHECKNO         TO CKNUMBO.
 15239
 15240     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 15241        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15242        MOVE +91                 TO  TRLR-SEQ-NO
 15243
 15244* EXEC CICS READ
 15245*           DATASET  ('ELTRLR')
 15246*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15247*           RIDFLD   (ELTRLR-KEY)
 15248*           RESP     (WS-RESPONSE)
 15249*       END-EXEC
 15250     MOVE 'ELTRLR' TO DFHEIV1
 15251*    MOVE '&"S        E          (  N#00014328' TO DFHEIV0
 15252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15254     MOVE X'204E233030303134333238' TO DFHEIV0(25:11)
 15255     CALL 'kxdfhei1' USING DFHEIV0,
 15256           DFHEIV1,
 15257           DFHEIV20,
 15258           DFHEIV99,
 15259           ELTRLR-KEY,
 15260           DFHEIV99,
 15261           DFHEIV99,
 15262           DFHEIV99
 15263     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15264         DFHEIV20
 15265     MOVE EIBRESP  TO WS-RESPONSE
 15266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15267
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 291
* EL156.cbl
 15268        IF WS-RESP-NORMAL
 15269           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15270        ELSE
 15271           MOVE SPACES           TO  LOANNBO
 15272        END-IF
 15273     END-IF
 15274
 15275*       MOVE PI-LOAN-NO          TO LOANNBO
 15276
 15277     IF CKNUMBO = SPACES
 15278         MOVE SPACES             TO CKNUMHDO.
 15279
 15280     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15281     MOVE CL-CARRIER             TO CARRBO.
 15282     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15283     MOVE CL-CERT-SFX            TO SUFXBO.
 15284
 15285     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15286        EVALUATE CL-CLAIM-TYPE
 15287           WHEN 'I'
 15288              MOVE '  IU  '      TO CLMTYPBO
 15289           WHEN 'G'
 15290              MOVE ' GAP  '      TO CLMTYPBO
 15291           WHEN 'F'
 15292              MOVE ' FMLA '      TO CLMTYPBO
 15293           WHEN OTHER
 15294              MOVE PI-AH-OVERRIDE-L6
 15295                                 TO CLMTYPBO
 15296        END-EVALUATE
 15297        MOVE ZEROS               TO UNDISBO
 15298*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15299        IF PI-PMTTYPE = '5' OR '6'
 15300           GO TO 6073-GET-NOTIFY-DATA
 15301        ELSE
 15302           MOVE PI-DAILY-RATE    TO RATEBO
 15303           GO TO 6073-GET-NOTIFY-DATA.
 15304
 15305     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15306
 15307     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15308        MOVE ZEROS               TO UNDISBO
 15309     ELSE
 15310        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15311
 15312 6073-GET-NOTIFY-DATA.
 15313
 15314     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15315
 15316     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15317         MOVE SPACES             TO  NAMEB2O
 15318                                     ADDR1B2O
 15319                                     ADDR2B2O
 15320                                     CITYST2O
 15321                                     AGTHDGO
 15322         MOVE ZEROS              TO  ZIPB2O
 15323         GO TO 6080-SET-INCURRED.
 15324
 15325     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 292
* EL156.cbl
 15326     MOVE +29                    TO  TRLR-SEQ-NO.
 15327
 15328
 15329* EXEC CICS HANDLE CONDITION
 15330*        NOTFND   (6074-GET-COMP-DATA)
 15331*    END-EXEC.
 15332*    MOVE '"$I                   ! 1 #00014395' TO DFHEIV0
 15333     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15335     MOVE X'3120233030303134333935' TO DFHEIV0(25:11)
 15336     CALL 'kxdfhei1' USING DFHEIV0
 15337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15338
 15339
 15340     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15341
 15342     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15343     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15344     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15345*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15346     STRING AT-CITY ' ' AT-STATE
 15347        DELIMITED BY '  ' INTO CITYST2O
 15348     END-STRING
 15349     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15350     GO TO 6080-SET-INCURRED.
 15351
 15352 6074-GET-COMP-DATA.
 15353
 15354     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15355         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15356
 15357     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15358         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15359                                         ADDR1B2O
 15360                                         ADDR2B2O
 15361                                         CITYST2O
 15362         MOVE ZEROS                  TO  ZIPB2O
 15363         GO TO 6080-SET-INCURRED.
 15364
 15365     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15366     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15367     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15368     MOVE AM-GROUPING            TO  COMP-GROUP.
 15369     MOVE 'A'                    TO  COMP-TYPE.
 15370     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15371                                 TO  COMP-FIN-RESP.
 15372
 15373     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15374         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15375                                       'G' OR 'B' or 'S'
 15376             MOVE 'G'            TO  COMP-TYPE
 15377             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15378         ELSE
 15379             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15380                                 TO  COMP-ACCOUNT
 15381     ELSE
 15382         MOVE 'G'                TO  COMP-TYPE
 15383         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 293
* EL156.cbl
 15384
 15385     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15386
 15387     IF COMP-REC-FOUND
 15388         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15389         MOVE CO-ADDR-1          TO  ADDR1B2O
 15390         MOVE CO-ADDR-2          TO  ADDR2B2O
 15391*        MOVE CO-ADDR-3          TO  CITYST2O
 15392         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15393            DELIMITED BY '  ' INTO CITYST2O
 15394         END-STRING
 15395         MOVE CO-ZIP             TO  ZIPB2O
 15396     ELSE
 15397         MOVE 'NO COMP ADDRESS AVAILABLE'
 15398                                 TO  NAMEB2O
 15399                                     ADDR1B2O
 15400                                     ADDR2B2O
 15401                                     CITYST2O
 15402         MOVE ZEROS               TO ZIPB2O.
 15403
 15404 6080-SET-INCURRED.
 15405     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15406     MOVE SPACES                 TO DC-OPTION-CODE.
 15407     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15408     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15409     MOVE PI-PROCESSOR-ID        TO BYBO.
 15410     MOVE MAP-NAMEB              TO MAP-NAME.
 15411     MOVE 'C'                    TO PI-PASS-SW.
 15412     MOVE EIBAID                 TO PI-PFKEY-USED.
 15413     MOVE -1                     TO ENTPFBL.
 15414     GO TO 8100-SEND-INITIAL-MAP.
 15415
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 294
* EL156.cbl
 15417 6100-BUILD-PAYMENT-TRAILER.
 15418
 15419     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15420     MOVE '6'                    TO CNTL-REC-TYPE.
 15421
 15422     IF CONTROL-IS-ACTUAL-CARRIER
 15423         MOVE PI-CARRIER         TO WS-CARR
 15424     ELSE
 15425         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15426
 15427     IF PI-COMPANY-ID = 'FIA'
 15428         MOVE PI-CARRIER         TO  WS-CARR.
 15429
 15430     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15431     MOVE 0                      TO CNTL-SEQ-NO.
 15432     MOVE 'CARR'                 TO FILE-SWITCH.
 15433
 15434     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15435
 15436     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15437         IF PI-OFFLINE     = 'Y' AND
 15438            PI-ECHECKNO-CR = 'CR'
 15439              GO TO 6110-READ-CONTROL
 15440         ELSE
 15441            IF PI-CASH = 'N'
 15442                GO TO 6110-READ-CONTROL.
 15443
 15444     IF CHECK-NO-MANUAL    OR
 15445        CHECK-NO-AT-PRINT  OR
 15446        PI-OFFLINE = 'Y'
 15447          GO TO 6130-BUILD-TRAILER.
 15448
 15449     IF PI-COMPANY-ID = 'FIA'
 15450         NEXT SENTENCE
 15451     ELSE
 15452         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15453             GO TO 6110-READ-CONTROL.
 15454
 15455     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15456
 15457     IF CHECK-CNT-RESET-VALUE
 15458        MOVE +1                  TO CF-CHECK-COUNTER
 15459     ELSE
 15460        ADD +1                   TO CF-CHECK-COUNTER.
 15461
 15462     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15463
 15464     IF CHECK-NO-CARR-SEQ
 15465        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15466
 15467     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15468
 15469     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15470     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15471        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15472         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15473         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15474            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 295
* EL156.cbl
 15475         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15476                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15477     END-IF.
 15478
 15479     GO TO 6120-REWRITE.
 15480
 15481 6105-STATE-CHECK-NUMBER.
 15482     IF CHECK-NO-MANUAL    OR
 15483        CHECK-NO-AT-PRINT  OR
 15484        PI-OFFLINE = 'Y'
 15485           GO TO 6130-BUILD-TRAILER
 15486     END-IF.
 15487
 15488     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15489     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15490     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15491     MOVE '3'                TO CNTL-REC-TYPE.
 15492     MOVE +0                 TO CNTL-SEQ-NO.
 15493     MOVE 'STAT'             TO FILE-SWITCH.
 15494     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15495
 15496     IF CF-ST-CHECK-CNT-RESET
 15497         MOVE +1             TO CF-ST-CHECK-COUNTER
 15498     ELSE
 15499         ADD +1              TO CF-ST-CHECK-COUNTER
 15500     END-IF.
 15501
 15502     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15503     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15504     GO TO 6120-REWRITE.
 15505
 15506 6110-READ-CONTROL.
 15507     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15508     MOVE '1'                    TO CNTL-REC-TYPE.
 15509     MOVE SPACES                 TO CNTL-ACCESS.
 15510     MOVE 0                      TO CNTL-SEQ-NO.
 15511
 15512     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15513
 15514     IF CO-CHECK-COUNT-RESET
 15515        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15516     ELSE
 15517        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15518
 15519     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15520
 15521     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15522         IF PI-OFFLINE     = 'Y'  AND
 15523            PI-ECHECKNO-CR = 'CR'
 15524              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15525              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15526              MOVE AL-UANON           TO CHECKNOA
 15527              GO TO 6120-REWRITE
 15528         ELSE
 15529         IF PI-CASH = 'N'
 15530             MOVE 'N'                TO PI-ECHECKNO-N
 15531             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15532             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 296
* EL156.cbl
 15533             MOVE AL-UANON           TO CHECKNOA
 15534             GO TO 6120-REWRITE.
 15535
 15536     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15537
 15538 6120-REWRITE.
 15539
 15540* EXEC CICS REWRITE
 15541*         DATASET('ELCNTL')
 15542*         FROM(CONTROL-FILE)
 15543*     END-EXEC.
 15544     MOVE LENGTH OF
 15545      CONTROL-FILE
 15546       TO DFHEIV11
 15547     MOVE 'ELCNTL' TO DFHEIV1
 15548*    MOVE '&& L                  %   #00014598' TO DFHEIV0
 15549     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15550     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15551     MOVE X'2020233030303134353938' TO DFHEIV0(25:11)
 15552     CALL 'kxdfhei1' USING DFHEIV0,
 15553           DFHEIV1,
 15554           CONTROL-FILE,
 15555           DFHEIV11,
 15556           DFHEIV99
 15557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15558
 15559
 15560     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15561
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 297
* EL156.cbl
 15563 6130-BUILD-TRAILER.
 15564
 15565
 15566* EXEC CICS GETMAIN
 15567*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15568*         LENGTH    (200)
 15569*         INITIMG   (GETMAIN-SPACE)
 15570*     END-EXEC.
 15571     MOVE 200
 15572       TO DFHEIV11
 15573*    MOVE ',"IL                  $   #00014608' TO DFHEIV0
 15574     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15575     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15576     MOVE X'2020233030303134363038' TO DFHEIV0(25:11)
 15577     CALL 'kxdfhei1' USING DFHEIV0,
 15578           DFHEIV20,
 15579           DFHEIV11,
 15580           GETMAIN-SPACE
 15581     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15582         DFHEIV20
 15583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15584
 15585
 15586     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15587                                    AT-PREV-PAID-THRU-DT.
 15588     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15589     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15590     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15591     MOVE 'AT'                   TO AT-RECORD-ID.
 15592     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15593
 15594     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15595        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15596           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15597     ELSE
 15598           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15599           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15600
 15601     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15602         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15603             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15604             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15605           ELSE
 15606             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15607             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15608
 15609     MOVE '2'                    TO AT-TRAILER-TYPE.
 15610     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15611                                    AT-PAYMENT-LAST-MAINT-DT.
 15612     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15613                                    AT-PAYMENT-LAST-UPDATED-BY.
 15614     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15615     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15616     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15617     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15618
 15619     IF PI-PMT-APPROVED
 15620        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 298
* EL156.cbl
 15621           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15622
 15623     IF PI-PFKEY-USED = DFHPF5
 15624        GO TO 6140-PF5-ENTERED.
 15625
 15626     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15627     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15628
 15629     IF PI-AIG-SPECIAL-BENEFIT
 15630         IF WS-1ST-SPECIAL-PMT
 15631             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15632             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15633                                        AT-AMOUNT-PAID
 15634         ELSE
 15635             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15636
 15637     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15638
 15639     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15640     MOVE '4'                    TO DC-OPTION-CODE.
 15641     PERFORM 9700-LINK-DATE-CONVERT.
 15642
 15643     IF DATE-CONVERSION-ERROR
 15644        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15645     ELSE
 15646        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15647
 15648     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15649     MOVE '4'                    TO DC-OPTION-CODE.
 15650     PERFORM 9700-LINK-DATE-CONVERT.
 15651
 15652     IF DATE-CONVERSION-ERROR
 15653        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15654     ELSE
 15655        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15656
 15657     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15658     GO TO 6150-FINISH-MOVE.
 15659
 15660 6140-PF5-ENTERED.
 15661     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15662     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15663
 15664     IF PI-AIG-SPECIAL-BENEFIT
 15665         IF WS-1ST-SPECIAL-PMT
 15666             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15667             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15668                                        AT-AMOUNT-PAID
 15669         ELSE
 15670             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15671
 15672     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15673     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15674     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15675
 15676 6150-FINISH-MOVE.
 15677
 15678     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 299
* EL156.cbl
 15679         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15680     ELSE
 15681         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15682
 15683     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15684     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15685
 15686*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15687*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15688
 15689     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15690         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15691
 15692     IF PI-OFFLINE = 'N'
 15693        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15694        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15695     ELSE
 15696        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15697        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15698
 15699     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15700
 15701     IF WS-2ND-SPECIAL-PMT
 15702         MOVE 'Y'                TO AT-CASH-PAYMENT
 15703         MOVE SPACES             TO AT-CHECK-NO
 15704         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15705         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15706         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15707         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15708
 15709     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15710                                    AT-TO-BE-WRITTEN-DT.
 15711
 15712     IF PI-HOLDTIL NOT = ZEROS
 15713        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15714        MOVE '4'                 TO DC-OPTION-CODE
 15715        PERFORM 9700-LINK-DATE-CONVERT
 15716        IF PI-OFFLINE = 'N'
 15717           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15718        ELSE
 15719           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15720
 15721     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15722     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15723                                    AT-CHECK-QUE-SEQUENCE.
 15724
 15725     IF PI-PFKEY-USED = DFHPF4
 15726        MOVE '1'                 TO AT-FORCE-CONTROL.
 15727
 15728     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15729        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15730        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15731        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15732
 15733     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15734                                    AT-VOID-SELECT-DT
 15735                                    AT-VOID-ACCEPT-DT
 15736                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 300
* EL156.cbl
 15737     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15738        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15739        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15740        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15741        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15742     ELSE
 15743        MOVE ZEROS               TO AT-DAILY-RATE
 15744                                    AT-ELIMINATION-DAYS
 15745        MOVE SPACES              TO AT-BENEFIT-TYPE
 15746     END-IF
 15747     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15748     MOVE '4'                    TO DC-OPTION-CODE.
 15749     PERFORM 9700-LINK-DATE-CONVERT.
 15750     IF DATE-CONVERSION-ERROR
 15751         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15752     ELSE
 15753         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15754     END-IF.
 15755     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15756     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15757     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15758     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15759     IF (PI-REAUDIT-NEEDED = 'Y')
 15760        or (pi-max-ext-used = 'Y')
 15761        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15762         PERFORM 6155-READ-CONTROL
 15763         PERFORM 6157-SET-APP-LEVEL
 15764         IF AT-APPROVAL-LEVEL-REQD < '4'
 15765            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15766         END-IF
 15767         MOVE 'Y' TO WS-NEED-APPROVAL
 15768         GO TO 6170-WRITE
 15769     END-IF.
 15770*******************************************************
 15771     IF NOT PI-PMT-GRADUATED
 15772         GO TO 6170-WRITE.
 15773     PERFORM 6155-READ-CONTROL.
 15774
 15775     IF PAID-FOR-LIFE
 15776         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15777             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15778                                     WS-PMT-APPROVAL-SW
 15779             GO TO 6170-WRITE.
 15780
 15781*05999      IF PAID-FOR-AH
 15782     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15783         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15784             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15785                                     WS-PMT-APPROVAL-SW
 15786             GO TO 6170-WRITE.
 15787
 15788     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15789
 15790     PERFORM 6157-SET-APP-LEVEL.
 15791
 15792     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15793
 15794     IF NOT PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 301
* EL156.cbl
 15795         GO TO 6170-WRITE.
 15796
 15797
 15798* EXEC CICS HANDLE CONDITION
 15799*        NOTFND   (6170-WRITE)
 15800*    END-EXEC.
 15801*    MOVE '"$I                   ! 2 #00014825' TO DFHEIV0
 15802     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15804     MOVE X'3220233030303134383235' TO DFHEIV0(25:11)
 15805     CALL 'kxdfhei1' USING DFHEIV0
 15806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15807
 15808
 15809     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15810     MOVE '2'                    TO CNTL-REC-TYPE.
 15811     MOVE +0                     TO CNTL-SEQ-NO.
 15812     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15813
 15814
 15815* EXEC CICS READ
 15816*         DATASET  ('ELCNTL')
 15817*         SET      (ADDRESS OF CONTROL-FILE)
 15818*         RIDFLD   (ELCNTL-KEY)
 15819*    END-EXEC.
 15820     MOVE 'ELCNTL' TO DFHEIV1
 15821*    MOVE '&"S        E          (   #00014834' TO DFHEIV0
 15822     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15824     MOVE X'2020233030303134383334' TO DFHEIV0(25:11)
 15825     CALL 'kxdfhei1' USING DFHEIV0,
 15826           DFHEIV1,
 15827           DFHEIV20,
 15828           DFHEIV99,
 15829           ELCNTL-KEY,
 15830           DFHEIV99,
 15831           DFHEIV99,
 15832           DFHEIV99
 15833     SET ADDRESS OF CONTROL-FILE TO
 15834         DFHEIV20
 15835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15836
 15837
 15838     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15839
 15840     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15841                         OR '4' OR '5'
 15842         NEXT SENTENCE
 15843     ELSE
 15844         MOVE 'Y' TO WS-NEED-APPROVAL
 15845         GO TO 6170-WRITE.
 15846
 15847     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15848         MOVE 'Y' TO WS-NEED-APPROVAL
 15849         IF WS-APPROVAL-LEVEL = '1'
 15850             MOVE '2'        TO  AT-APPROVED-LEVEL
 15851                            WS-SAVE-APPROVED-LEVEL
 15852             GO TO 6170-WRITE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 302
* EL156.cbl
 15853         ELSE
 15854             IF WS-APPROVAL-LEVEL = '2'
 15855                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15856                                WS-SAVE-APPROVED-LEVEL
 15857                 GO TO 6170-WRITE
 15858             ELSE IF WS-APPROVAL-LEVEL = '3'
 15859                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15860                                WS-SAVE-APPROVED-LEVEL
 15861                 GO TO 6170-WRITE
 15862             ELSE IF WS-APPROVAL-LEVEL = '4'
 15863                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15864                                WS-SAVE-APPROVED-LEVEL
 15865                 GO TO 6170-WRITE.
 15866
 15867     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15868                             WS-PMT-APPROVAL-SW.
 15869     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15870                             AT-APPROVAL-LEVEL-REQD.
 15871
 15872*******************************************************
 15873 6155-READ-CONTROL.
 15874     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15875     MOVE '1'                    TO CNTL-REC-TYPE.
 15876     MOVE SPACES                 TO CNTL-ACCESS.
 15877     MOVE +0                     TO CNTL-SEQ-NO.
 15878     MOVE 'COMP'                 TO FILE-SWITCH.
 15879
 15880     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15881 6157-SET-APP-LEVEL.
 15882******A&H Limits are set as a monthly payment.  Calculate the mont
 15883******equivalent of the amount paid today
 15884     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15885        PI-SAVE-ODD-DAYS-OVER > 0
 15886           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15887                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15888           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15889                                  WS-CALC-PMT-MONTHS
 15890     ELSE
 15891           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15892     END-IF.
 15893*06007      IF ((PAID-FOR-AH) AND
 15894     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15895*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15896        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15897              OR
 15898        ((PAID-FOR-LIFE) AND
 15899        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15900            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15901       ELSE
 15902*06014      IF ((PAID-FOR-AH)  AND
 15903         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15904*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15905           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15906              OR
 15907        ((PAID-FOR-LIFE) AND
 15908        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15909            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15910         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 303
* EL156.cbl
 15911*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15912           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15913               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15914              OR
 15915          ((PAID-FOR-LIFE) AND
 15916          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15917            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15918       ELSE
 15919           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15920               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15921              OR
 15922          ((PAID-FOR-LIFE) AND
 15923          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15924            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15925       ELSE
 15926            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15927
 15928     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15929        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15930        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15931            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15932        END-IF
 15933     ELSE
 15934     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15935        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15936        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15937            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15938        END-IF
 15939     ELSE
 15940     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15941        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15942        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15943            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15944        END-IF
 15945     ELSE
 15946     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15947        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15948        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15949            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15950        END-IF
 15951     ELSE
 15952     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15953            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15954
 15955 6170-WRITE.
 15956
 15957     if pi-company-id = 'DCC' or 'CAP'
 15958        PERFORM 0900-GET-DDF-limits
 15959                                 THRU 0900-EXIT
 15960     end-if
 15961     perform 2220-update-elcrtt  thru 2220-exit
 15962     IF PI-COMPANY-ID = 'DMD'
 15963        IF PI-AT-EOB-CODES NOT = SPACES
 15964           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15965           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15966           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15967           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15968           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 304
* EL156.cbl
 15969
 15970
 15971* EXEC CICS HANDLE CONDITION
 15972*        DUPREC    (6180-DUPREC)
 15973*    END-EXEC.
 15974*    MOVE '"$%                   ! 3 #00014972' TO DFHEIV0
 15975     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15977     MOVE X'3320233030303134393732' TO DFHEIV0(25:11)
 15978     CALL 'kxdfhei1' USING DFHEIV0
 15979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15980
 15981
 15982
 15983* EXEC CICS WRITE
 15984*         DATASET       ('ELTRLR')
 15985*         FROM          (ACTIVITY-TRAILERS)
 15986*         RIDFLD        (AT-CONTROL-PRIMARY)
 15987*     END-EXEC.
 15988     MOVE LENGTH OF
 15989      ACTIVITY-TRAILERS
 15990       TO DFHEIV11
 15991     MOVE 'ELTRLR' TO DFHEIV1
 15992*    MOVE '&$ L                  ''   #00014976' TO DFHEIV0
 15993     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15994     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15995     MOVE X'2020233030303134393736' TO DFHEIV0(25:11)
 15996     CALL 'kxdfhei1' USING DFHEIV0,
 15997           DFHEIV1,
 15998           ACTIVITY-TRAILERS,
 15999           DFHEIV11,
 16000           AT-CONTROL-PRIMARY,
 16001           DFHEIV99,
 16002           DFHEIV99
 16003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16004
 16005
 16006     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16007        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16008*06088           GO TO 6199-EXIT.
 16009           GO TO 6176-APPROVAL-NOTE.
 16010
 16011
 16012* EXEC CICS GETMAIN
 16013*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16014*         LENGTH    (200)
 16015*         INITIMG   (GETMAIN-SPACE)
 16016*     END-EXEC.
 16017     MOVE 200
 16018       TO DFHEIV11
 16019*    MOVE ',"IL                  $   #00014987' TO DFHEIV0
 16020     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16022     MOVE X'2020233030303134393837' TO DFHEIV0(25:11)
 16023     CALL 'kxdfhei1' USING DFHEIV0,
 16024           DFHEIV20,
 16025           DFHEIV11,
 16026           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 305
* EL156.cbl
 16027     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16028         DFHEIV20
 16029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16030
 16031
 16032     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16033
 16034     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16035     MOVE 'AT'                   TO AT-RECORD-ID.
 16036     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16037     MOVE '6'                    TO AT-TRAILER-TYPE.
 16038     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16039                                    AT-GEN-INFO-LAST-MAINT-DT
 16040     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16041                                    AT-GEN-INFO-LAST-UPDATED-BY
 16042     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16043
 16044     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16045     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16046     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16047
 16048     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16049
 16050 6175-WRITE.
 16051
 16052
 16053* EXEC CICS HANDLE CONDITION
 16054*        DUPREC    (6190-DUPREC)
 16055*    END-EXEC.
 16056*    MOVE '"$%                   ! 4 #00015013' TO DFHEIV0
 16057     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16059     MOVE X'3420233030303135303133' TO DFHEIV0(25:11)
 16060     CALL 'kxdfhei1' USING DFHEIV0
 16061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16062
 16063
 16064
 16065* EXEC CICS WRITE
 16066*         DATASET     ('ELTRLR')
 16067*         FROM        (ACTIVITY-TRAILERS)
 16068*         RIDFLD      (AT-CONTROL-PRIMARY)
 16069*     END-EXEC.
 16070     MOVE LENGTH OF
 16071      ACTIVITY-TRAILERS
 16072       TO DFHEIV11
 16073     MOVE 'ELTRLR' TO DFHEIV1
 16074*    MOVE '&$ L                  ''   #00015017' TO DFHEIV0
 16075     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16076     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16077     MOVE X'2020233030303135303137' TO DFHEIV0(25:11)
 16078     CALL 'kxdfhei1' USING DFHEIV0,
 16079           DFHEIV1,
 16080           ACTIVITY-TRAILERS,
 16081           DFHEIV11,
 16082           AT-CONTROL-PRIMARY,
 16083           DFHEIV99,
 16084           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 306
* EL156.cbl
 16085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16086
 16087
 16088 6176-APPROVAL-NOTE.
 16089
 16090     IF NOT APPROVAL-NEEDED
 16091         GO TO 6199-EXIT.
 16092
 16093
 16094* EXEC CICS GETMAIN
 16095*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16096*        LENGTH    (200)
 16097*        INITIMG   (GETMAIN-SPACE)
 16098*    END-EXEC.
 16099     MOVE 200
 16100       TO DFHEIV11
 16101*    MOVE ',"IL                  $   #00015028' TO DFHEIV0
 16102     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16103     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16104     MOVE X'2020233030303135303238' TO DFHEIV0(25:11)
 16105     CALL 'kxdfhei1' USING DFHEIV0,
 16106           DFHEIV20,
 16107           DFHEIV11,
 16108           GETMAIN-SPACE
 16109     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16110         DFHEIV20
 16111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16112
 16113
 16114     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16115
 16116     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16117     MOVE 'AT'               TO AT-RECORD-ID
 16118     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16119     MOVE '6'                TO AT-TRAILER-TYPE
 16120     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16121                                AT-GEN-INFO-LAST-MAINT-DT
 16122     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16123                                AT-GEN-INFO-LAST-UPDATED-BY
 16124     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16125
 16126     IF PI-REAUDIT-NEEDED = 'Y'
 16127         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16128     ELSE
 16129         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16130     END-IF
 16131     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16132         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16133     END-IF
 16134     MOVE SPACES             TO AT-INFO-LINE-2
 16135
 16136     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16137 6177-WRITE.
 16138
 16139
 16140* EXEC CICS HANDLE CONDITION
 16141*        DUPREC    (6185-DUPREC)
 16142*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 307
* EL156.cbl
 16143*    MOVE '"$%                   ! 5 #00015059' TO DFHEIV0
 16144     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16146     MOVE X'3520233030303135303539' TO DFHEIV0(25:11)
 16147     CALL 'kxdfhei1' USING DFHEIV0
 16148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16149
 16150
 16151
 16152* EXEC CICS WRITE
 16153*         DATASET     ('ELTRLR')
 16154*         FROM        (ACTIVITY-TRAILERS)
 16155*         RIDFLD      (AT-CONTROL-PRIMARY)
 16156*     END-EXEC.
 16157     MOVE LENGTH OF
 16158      ACTIVITY-TRAILERS
 16159       TO DFHEIV11
 16160     MOVE 'ELTRLR' TO DFHEIV1
 16161*    MOVE '&$ L                  ''   #00015063' TO DFHEIV0
 16162     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16163     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16164     MOVE X'2020233030303135303633' TO DFHEIV0(25:11)
 16165     CALL 'kxdfhei1' USING DFHEIV0,
 16166           DFHEIV1,
 16167           ACTIVITY-TRAILERS,
 16168           DFHEIV11,
 16169           AT-CONTROL-PRIMARY,
 16170           DFHEIV99,
 16171           DFHEIV99
 16172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16173
 16174
 16175
 16176     GO TO 6199-EXIT.
 16177
 16178 6180-DUPREC.
 16179
 16180     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16181     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16182     GO TO 6170-WRITE.
 16183
 16184 6185-DUPREC.
 16185     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16186     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16187     GO TO 6177-WRITE.
 16188
 16189 6190-DUPREC.
 16190     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16191     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16192     GO TO 6175-WRITE.
 16193
 16194 6199-EXIT.
 16195      EXIT.
 16196
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 308
* EL156.cbl
 16198 6200-UPDATE-CLAIM-MSTR.
 16199     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16200     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16201     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16202     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16203
 16204     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16205
 16206     MOVE ZEROS                  TO W-INTEREST.
 16207
 16208     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 16209        IF (PI-OFFLINE = 'Y') OR
 16210           (PI-PMTTYPE = '7')
 16211           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16212                                 THRU 9870-EXIT
 16213        END-IF
 16214     END-IF
 16215     IF NOT ERROR-ON-OUTPUT
 16216        CONTINUE
 16217     ELSE
 16218
 16219* EXEC CICS REWRITE
 16220*          DATASET('ELMSTR')
 16221*          FROM(CLAIM-MASTER)
 16222*       END-EXEC
 16223     MOVE LENGTH OF
 16224      CLAIM-MASTER
 16225       TO DFHEIV11
 16226     MOVE 'ELMSTR' TO DFHEIV1
 16227*    MOVE '&& L                  %   #00015112' TO DFHEIV0
 16228     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16229     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16230     MOVE X'2020233030303135313132' TO DFHEIV0(25:11)
 16231     CALL 'kxdfhei1' USING DFHEIV0,
 16232           DFHEIV1,
 16233           CLAIM-MASTER,
 16234           DFHEIV11,
 16235           DFHEIV99
 16236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16237
 16238        MOVE -1                  TO ENTPFBL
 16239        MOVE AL-UANON            TO ENTPFBA
 16240        MOVE MAP-NAMEB           TO MAP-NAME
 16241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16242        GO TO 8200-SEND-DATAONLY
 16243     END-IF
 16244
 16245     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16246
 16247     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16248
 16249     IF PI-AIG-SPECIAL-BENEFIT
 16250         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16251
 16252     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16253
 16254     IF PI-SPECIAL-BEN-SW = 'Y'
 16255         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 309
* EL156.cbl
 16256         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16257
 16258     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16259         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16260     ELSE
 16261         IF PI-PMTTYPE NOT = '4'
 16262            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16263
 16264     IF PI-PMTTYPE = '5' OR '6'
 16265        GO TO  6250-SET-MAINT.
 16266
 16267     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16268                                         CL-LAG-REPORT-CODE.
 16269
 16270     IF CL-ACTIVITY-CODE = 09
 16271         GO TO 6200-CONT-UPDATE.
 16272
 16273     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16274         IF CL-ACTIVITY-CODE = 11
 16275             GO TO 6200-CONT-UPDATE.
 16276
 16277     IF WS-ACT-REC-FOUND-SW = 'N'
 16278         GO TO 6200-CONT-UPDATE.
 16279
 16280     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16281         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16282         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16283         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16284
 16285     IF WS-UPDATE-SW = 'Y'
 16286         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16287                                         CL-NEXT-FOLLOWUP-DT.
 16288
 16289 6200-CONT-UPDATE.
 16290
 16291     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16292       IF CLAIM-IS-CLOSED
 16293         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16294           IF WS-OPEN-CLOSE-SW = '2'
 16295             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16296                                        CL-LAST-CLOSE-DT.
 16297
 16298     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16299        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16300        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16301
 16302     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16303        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16304        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16305        MOVE 'C'                 TO CL-CLAIM-STATUS
 16306        IF PI-PMTTYPE = '2'
 16307           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16308              or 'F')
 16309           CONTINUE
 16310        ELSE
 16311           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16312        END-IF
 16313     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 310
* EL156.cbl
 16314        IF PI-PMTTYPE = '2' OR '3'
 16315           IF PI-PMTTYPE = '2' AND
 16316              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16317                 or 'F')
 16318              CONTINUE
 16319           ELSE
 16320              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16321           END-IF
 16322        END-IF
 16323     END-IF
 16324
 16325     IF PI-PMTTYPE = '4'
 16326        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16327
 16328     IF PI-COMPANY-ID = 'CVL'
 16329         IF PI-LOAN-UPDATE-SW = 'Y'
 16330             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16331             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16332             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16333             MOVE CL-CERT-STATE      TO  CERT-STATE
 16334             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16335             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16336             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16337             MOVE 'CERT'             TO  FILE-SWITCH
 16338             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16339             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16340             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16341
 16342     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16343        GO TO 6220-USE-COMPUTED.
 16344
 16345     IF (PI-PMTTYPE = '4')  AND
 16346        (PI-EPYAMT < ZEROS)
 16347          COMPUTE CL-NO-OF-DAYS-PAID =
 16348                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16349          IF CL-NO-OF-DAYS-PAID < +0
 16350              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16351          ELSE
 16352              NEXT SENTENCE
 16353     ELSE
 16354          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16355
 16356     IF PI-PROCESSOR-ID = 'FIX '
 16357        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16358           NEXT SENTENCE
 16359        ELSE
 16360           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16361     ELSE
 16362        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16363
 16364     IF PI-PMTTYPE = '4'
 16365        GO TO 6250-SET-MAINT.
 16366
 16367     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16368
 16369     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16370     MOVE '4'                    TO DC-OPTION-CODE.
 16371     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 311
* EL156.cbl
 16372     IF DATE-CONVERSION-ERROR
 16373        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16374     ELSE
 16375        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16376           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16377           IF PI-AIG-SPECIAL-BENEFIT
 16378               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16379           ELSE
 16380               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16381
 16382     GO TO 6250-SET-MAINT.
 16383
 16384 6220-USE-COMPUTED.
 16385
 16386     IF (PI-PMTTYPE = '4')  AND
 16387        (PI-CPYAMT < ZEROS)
 16388          COMPUTE CL-NO-OF-DAYS-PAID =
 16389                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16390          IF CL-NO-OF-DAYS-PAID < +0
 16391              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16392          ELSE
 16393              NEXT SENTENCE
 16394     ELSE
 16395          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16396
 16397     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16398
 16399     IF PI-PMTTYPE = '4'
 16400        GO TO 6250-SET-MAINT.
 16401
 16402     IF PI-AIG-SPECIAL-BENEFIT
 16403         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16404     ELSE
 16405         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16406
 16407     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16408
 16409     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16410        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16411
 16412 6250-SET-MAINT.
 16413     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16414
 16415     IF PI-PROCESSOR-ID = 'FIX '
 16416        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16417           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16418        ELSE
 16419           NEXT SENTENCE
 16420     ELSE
 16421        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16422
 16423     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16424     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16425     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16426
 16427 6299-EXIT.
 16428      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 312
* EL156.cbl
 16430 6300-UPDATE-CERT.
 16431
 16432*  ADD CERTNOTE FOR SC NP+6
 16433     IF PI-COMPANY-ID = 'CID' AND
 16434       (PI-PMTTYPE = '2' OR '3') AND
 16435        CL-CERT-STATE = 'SC'  AND
 16436        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16437           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16438     END-IF.
 16439
 16440     IF PI-COMPANY-ID = 'AHL' AND
 16441       (PI-PMTTYPE = '2' OR '3') AND
 16442        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16443           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16444           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16445     END-IF.
 16446
 16447     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16448     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16449     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16450     MOVE CL-CERT-STATE    TO CERT-STATE.
 16451     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16452     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16453     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16454     MOVE 'CERT'           TO FILE-SWITCH.
 16455
 16456     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16457
 16458     IF CERT-NOTE-ADDED
 16459        IF CM-NOTE-SW = ' '
 16460           MOVE '4'             TO CM-NOTE-SW
 16461        ELSE
 16462           IF CM-NOTE-SW = '1'
 16463               MOVE '5'           TO CM-NOTE-SW
 16464           ELSE
 16465              IF CM-NOTE-SW = '2'
 16466                 MOVE '6'         TO CM-NOTE-SW
 16467              ELSE
 16468                 IF CM-NOTE-SW = '3'
 16469                    MOVE '7'      TO CM-NOTE-SW
 16470                 END-IF
 16471              END-IF
 16472           END-IF
 16473        END-IF
 16474     END-IF.
 16475
 16476     IF PI-COMPANY-ID = 'CVL'
 16477         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16478         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16479
 16480     IF PI-PMTTYPE NOT = '4'
 16481        GO TO 6340-UPDATE-CERT.
 16482
 16483     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16484        IF PI-PFKEY-USED = DFHPF5
 16485           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16486        ELSE
 16487           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 313
* EL156.cbl
 16488
 16489*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16490*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16491*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16492*               PI-LF-COVERAGE-TYPE = 'P'
 16493*                GO TO 6350-REWRITE-CERT.
 16494
 16495     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16496       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16497          PI-LF-COVERAGE-TYPE = 'P'
 16498           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16499                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16500                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16501                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16502                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16503                GO TO 6350-REWRITE-CERT
 16504            ELSE
 16505                GO TO 6350-REWRITE-CERT.
 16506
 16507     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16508         GO TO 6350-REWRITE-CERT.
 16509
 16510     IF NOT CM-AH-LUMP-SUM-DISAB
 16511        GO TO 6380-UNLOCK-CERT.
 16512
 16513     IF PI-PFKEY-USED = DFHPF5
 16514        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16515                                    CM-AH-ITD-AH-PMT
 16516        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16517        GO TO 6350-REWRITE-CERT
 16518     ELSE
 16519        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16520                                    CM-AH-ITD-AH-PMT
 16521        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16522        GO TO 6350-REWRITE-CERT.
 16523
 16524 6340-UPDATE-CERT.
 16525
 16526     IF CL-CLAIM-TYPE = 'L'
 16527         IF PI-PFKEY-USED = DFHPF5
 16528             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16529         ELSE
 16530             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16531
 16532     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16533         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16534             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16535                PI-LF-COVERAGE-TYPE = 'P'
 16536                 GO TO 6350-REWRITE-CERT.
 16537
 16538     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16539       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16540          PI-LF-COVERAGE-TYPE = 'P'
 16541           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16542                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16543                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16544                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16545                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 314
* EL156.cbl
 16546                GO TO 6350-REWRITE-CERT.
 16547
 16548     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16549         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16550            PI-LF-COVERAGE-TYPE NOT = 'P'
 16551             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16552             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16553             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16554             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16555             GO TO 6350-REWRITE-CERT.
 16556
 16557     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16558         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16559         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16560         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16561         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16562         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16563         IF PI-PFKEY-USED = DFHPF5
 16564             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16565                                        CM-AH-ITD-AH-PMT
 16566             GO TO 6350-REWRITE-CERT
 16567         ELSE
 16568             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16569                                        CM-AH-ITD-AH-PMT
 16570             GO TO 6350-REWRITE-CERT.
 16571
 16572 6350-REWRITE-CERT.
 16573
 16574
 16575* EXEC CICS REWRITE
 16576*         DATASET  ('ELCERT')
 16577*         FROM(CERTIFICATE-MASTER)
 16578*     END-EXEC.
 16579     MOVE LENGTH OF
 16580      CERTIFICATE-MASTER
 16581       TO DFHEIV11
 16582     MOVE 'ELCERT' TO DFHEIV1
 16583*    MOVE '&& L                  %   #00015453' TO DFHEIV0
 16584     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16585     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16586     MOVE X'2020233030303135343533' TO DFHEIV0(25:11)
 16587     CALL 'kxdfhei1' USING DFHEIV0,
 16588           DFHEIV1,
 16589           CERTIFICATE-MASTER,
 16590           DFHEIV11,
 16591           DFHEIV99
 16592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16593
 16594
 16595     GO TO 6399-EXIT.
 16596
 16597 6380-UNLOCK-CERT.
 16598
 16599* EXEC CICS UNLOCK
 16600*         DATASET  ('ELCERT')
 16601*     END-EXEC.
 16602     MOVE 'ELCERT' TO DFHEIV1
 16603*    MOVE '&*                    #   #00015461' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 315
* EL156.cbl
 16604     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16605     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16606     MOVE X'2020233030303135343631' TO DFHEIV0(25:11)
 16607     CALL 'kxdfhei1' USING DFHEIV0,
 16608           DFHEIV1,
 16609           DFHEIV99
 16610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16611
 16612
 16613 6399-EXIT.
 16614      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 316
* EL156.cbl
 16616 6400-UPDATE-ZERO-TRAILER.
 16617     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16618     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16619
 16620     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16621
 16622     IF PI-EPYAMT NOT = ZEROS
 16623         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16624     ELSE
 16625         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16626
 16627     IF PI-ERESV NOT = ZEROS
 16628        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16629
 16630     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16631        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16632
 16633     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16634        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16635     ELSE
 16636        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16637
 16638     IF PI-PMTTYPE = '5'
 16639        IF PI-EPYAMT = ZEROS
 16640           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16641        ELSE
 16642           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16643
 16644     IF PI-PMTTYPE = '6'
 16645        IF PI-EPYAMT = ZEROS
 16646           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16647        ELSE
 16648           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16649
 16650 6420-CHECK-OPEN-CLOSE.
 16651     IF PI-PMTTYPE = '5' OR '6'
 16652        GO TO 6450-REWRITE.
 16653
 16654     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16655         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16656             IF CLAIM-IS-CLOSED
 16657                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16658                 MOVE 1          TO  SUB-1
 16659                 GO TO 6440-AIG-LOOP.
 16660
 16661     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16662        GO TO 6450-REWRITE.
 16663
 16664     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16665        GO TO 6450-REWRITE.
 16666
 16667     MOVE 1                      TO SUB-1.
 16668
 16669 6430-LOOP.
 16670     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16671        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16672        IF PI-PMTTYPE = '1' OR '4'
 16673           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 317
* EL156.cbl
 16674           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16675           GO TO 6450-REWRITE
 16676        ELSE
 16677           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16678           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16679           GO TO 6450-REWRITE.
 16680
 16681     IF SUB-1 = 6
 16682      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16683      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16684      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16685      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16686      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16687      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16688      GO TO 6430-LOOP.
 16689
 16690     ADD 1                       TO SUB-1.
 16691     GO TO 6430-LOOP.
 16692
 16693
 16694 6440-AIG-LOOP.
 16695
 16696     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16697       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16698       IF WS-OPEN-CLOSE-SW = '1'
 16699         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16700         IF PI-PMTTYPE = '2'
 16701           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16702           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16703         ELSE
 16704           IF PI-PMTTYPE = '3'
 16705             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16706             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16707           ELSE
 16708             IF PI-PMTTYPE = '4'
 16709               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16710               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16711             ELSE
 16712               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16713               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16714       ELSE
 16715         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16716         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16717         GO TO 6450-REWRITE.
 16718
 16719     IF SUB-1 = 6
 16720      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16721      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16722      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16723      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16724      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16725      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16726      GO TO 6440-AIG-LOOP.
 16727
 16728     ADD 1                       TO SUB-1.
 16729     GO TO 6440-AIG-LOOP.
 16730
 16731 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 318
* EL156.cbl
 16732     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16733     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16734     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16735
 16736     IF PI-COMPANY-ID = 'DMD'
 16737         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16738         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16739         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16740         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16741         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16742
 16743
 16744* EXEC CICS REWRITE
 16745*         DATASET  ('ELTRLR')
 16746*         FROM     (ACTIVITY-TRAILERS)
 16747*     END-EXEC.
 16748     MOVE LENGTH OF
 16749      ACTIVITY-TRAILERS
 16750       TO DFHEIV11
 16751     MOVE 'ELTRLR' TO DFHEIV1
 16752*    MOVE '&& L                  %   #00015595' TO DFHEIV0
 16753     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16754     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16755     MOVE X'2020233030303135353935' TO DFHEIV0(25:11)
 16756     CALL 'kxdfhei1' USING DFHEIV0,
 16757           DFHEIV1,
 16758           ACTIVITY-TRAILERS,
 16759           DFHEIV11,
 16760           DFHEIV99
 16761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16762
 16763
 16764 6499-EXIT.
 16765      EXIT.
 16766
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 319
* EL156.cbl
 16768 6500-READ-DLO035.
 16769     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16770     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16771     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16772     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16773
 16774
 16775* EXEC CICS LINK
 16776*        PROGRAM    ('DLO035')
 16777*        COMMAREA   (DLO035-KEY)
 16778*        LENGTH     (DL35-LENGTH)
 16779*    END-EXEC.
 16780     MOVE 'DLO035' TO DFHEIV1
 16781*    MOVE '."C                   (   #00015610' TO DFHEIV0
 16782     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16784     MOVE X'2020233030303135363130' TO DFHEIV0(25:11)
 16785     CALL 'kxdfhei1' USING DFHEIV0,
 16786           DFHEIV1,
 16787           DLO035-KEY,
 16788           DL35-LENGTH,
 16789           DFHEIV99,
 16790           DFHEIV99,
 16791           DFHEIV99,
 16792           DFHEIV99
 16793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16794
 16795
 16796     IF DL35-RETURN-CODE = 'OK'
 16797         GO TO 6500-EXIT.
 16798
 16799     IF DL35-RETURN-CODE = '01'
 16800         MOVE ER-7830            TO EMI-ERROR
 16801         GO TO 6500-BAD-EXIT.
 16802
 16803     IF DL35-RETURN-CODE = '02'
 16804         MOVE ER-7831            TO EMI-ERROR
 16805         GO TO 6500-BAD-EXIT.
 16806
 16807     IF DL35-RETURN-CODE = '03'
 16808         MOVE ER-7832            TO EMI-ERROR
 16809         GO TO 6500-BAD-EXIT.
 16810
 16811     IF DL35-RETURN-CODE = '04'
 16812         MOVE ER-7833            TO EMI-ERROR
 16813         GO TO 6500-BAD-EXIT.
 16814
 16815     IF DL35-RETURN-CODE = '05'
 16816         MOVE ER-7834            TO EMI-ERROR
 16817         GO TO 6500-BAD-EXIT.
 16818
 16819     IF DL35-RETURN-CODE = '06'
 16820         MOVE ER-7835            TO EMI-ERROR
 16821         GO TO 6500-BAD-EXIT.
 16822
 16823     IF DL35-RETURN-CODE = '07'
 16824         MOVE ER-7836            TO EMI-ERROR
 16825         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 320
* EL156.cbl
 16826
 16827     IF DL35-RETURN-CODE = 'E1'
 16828         MOVE ER-7837            TO EMI-ERROR
 16829         GO TO 6500-BAD-EXIT.
 16830
 16831     IF DL35-RETURN-CODE NOT = 'OK'
 16832         MOVE ER-7838            TO EMI-ERROR
 16833         GO TO 6500-BAD-EXIT.
 16834
 16835 6500-EXIT.
 16836      EXIT.
 16837
 16838 6500-BAD-EXIT.
 16839
 16840* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16841*    MOVE '6"R                   !   #00015659' TO DFHEIV0
 16842     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16844     MOVE X'2020233030303135363539' TO DFHEIV0(25:11)
 16845     CALL 'kxdfhei1' USING DFHEIV0
 16846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16847
 16848     MOVE -1                 TO PMTTYPEL.
 16849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16850     GO TO 8200-SEND-DATAONLY.
 16851
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 321
* EL156.cbl
 16853 6600-UPDATE-DLO035.
 16854     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16855     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16856     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16857     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16858
 16859
 16860* EXEC CICS LINK
 16861*        PROGRAM    ('DLO035')
 16862*        COMMAREA   (DLO035-KEY)
 16863*        LENGTH     (DL35-LENGTH)
 16864*    END-EXEC.
 16865     MOVE 'DLO035' TO DFHEIV1
 16866*    MOVE '."C                   (   #00015671' TO DFHEIV0
 16867     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16869     MOVE X'2020233030303135363731' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0,
 16871           DFHEIV1,
 16872           DLO035-KEY,
 16873           DL35-LENGTH,
 16874           DFHEIV99,
 16875           DFHEIV99,
 16876           DFHEIV99,
 16877           DFHEIV99
 16878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16879
 16880
 16881     IF DL35-RETURN-CODE = 'OK'
 16882         GO TO 6600-EXIT.
 16883
 16884     IF DL35-RETURN-CODE = '01'
 16885         MOVE ER-7830            TO EMI-ERROR
 16886         GO TO 6500-BAD-EXIT.
 16887
 16888     IF DL35-RETURN-CODE = '02'
 16889         MOVE ER-7831            TO EMI-ERROR
 16890         GO TO 6500-BAD-EXIT.
 16891
 16892     IF DL35-RETURN-CODE = '03'
 16893         MOVE ER-7832            TO EMI-ERROR
 16894         GO TO 6500-BAD-EXIT.
 16895
 16896     IF DL35-RETURN-CODE = '04'
 16897         MOVE ER-7833            TO EMI-ERROR
 16898         GO TO 6500-BAD-EXIT.
 16899
 16900     IF DL35-RETURN-CODE = '05'
 16901         MOVE ER-7834            TO EMI-ERROR
 16902         GO TO 6500-BAD-EXIT.
 16903
 16904     IF DL35-RETURN-CODE = '06'
 16905         MOVE ER-7835            TO EMI-ERROR
 16906         GO TO 6500-BAD-EXIT.
 16907
 16908     IF DL35-RETURN-CODE = '07'
 16909         MOVE ER-7836            TO EMI-ERROR
 16910         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 322
* EL156.cbl
 16911
 16912     IF DL35-RETURN-CODE = 'E1'
 16913         MOVE ER-7837            TO EMI-ERROR
 16914         GO TO 6500-BAD-EXIT.
 16915
 16916     IF DL35-RETURN-CODE NOT = 'OK'
 16917         MOVE ER-7838            TO EMI-ERROR
 16918         GO TO 6500-BAD-EXIT.
 16919
 16920 6600-EXIT.
 16921      EXIT.
 16922
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 323
* EL156.cbl
 16924 6700-UPDATE-ACTQ.
 16925***************************************************************
 16926*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16927*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16928*    ONE ALREADY THERE.                                       *
 16929***************************************************************
 16930
 16931
 16932* EXEC CICS HANDLE CONDITION
 16933*         NOTFND(6720-BUILD-NEW-RECORD)
 16934*     END-EXEC.
 16935*    MOVE '"$I                   ! 6 #00015727' TO DFHEIV0
 16936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16938     MOVE X'3620233030303135373237' TO DFHEIV0(25:11)
 16939     CALL 'kxdfhei1' USING DFHEIV0
 16940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16941
 16942
 16943
 16944* EXEC CICS READ
 16945*         DATASET('ELACTQ')
 16946*         RIDFLD (ELMSTR-KEY)
 16947*         SET    (ADDRESS OF ACTIVITY-QUE)
 16948*         UPDATE
 16949*     END-EXEC.
 16950     MOVE 'ELACTQ' TO DFHEIV1
 16951*    MOVE '&"S        EU         (   #00015731' TO DFHEIV0
 16952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16953     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16954     MOVE X'2020233030303135373331' TO DFHEIV0(25:11)
 16955     CALL 'kxdfhei1' USING DFHEIV0,
 16956           DFHEIV1,
 16957           DFHEIV20,
 16958           DFHEIV99,
 16959           ELMSTR-KEY,
 16960           DFHEIV99,
 16961           DFHEIV99,
 16962           DFHEIV99
 16963     SET ADDRESS OF ACTIVITY-QUE TO
 16964         DFHEIV20
 16965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16966
 16967
 16968     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16969
 16970     IF PI-AIG-SPECIAL-BENEFIT AND
 16971        PI-CASH = 'Y'
 16972         ADD 2                   TO AQ-PAYMENT-COUNTER
 16973     ELSE
 16974         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16975
 16976     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16977         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16978
 16979     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16980
 16981     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 324
* EL156.cbl
 16982         IF WS-PMT-APPROVAL-SW = 'A'
 16983             NEXT SENTENCE
 16984         ELSE
 16985            IF PI-AIG-SPECIAL-BENEFIT AND
 16986               PI-CASH = 'Y'
 16987                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16988                                     WS-PMT-UNAPPROVED-CNT
 16989            ELSE
 16990                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16991                                     WS-PMT-UNAPPROVED-CNT
 16992     ELSE
 16993         IF PI-PMT-APPR-SW = 'Y'
 16994            IF PI-AIG-SPECIAL-BENEFIT AND
 16995               PI-CASH = 'Y'
 16996                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16997                                     WS-PMT-UNAPPROVED-CNT
 16998            ELSE
 16999                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17000                                     WS-PMT-UNAPPROVED-CNT.
 17001
 17002     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17003         MOVE ER-3536 TO EMI-ERROR
 17004         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17005
 17006     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17007
 17008
 17009* EXEC CICS REWRITE
 17010*         DATASET('ELACTQ')
 17011*         FROM   (ACTIVITY-QUE)
 17012*     END-EXEC.
 17013     MOVE LENGTH OF
 17014      ACTIVITY-QUE
 17015       TO DFHEIV11
 17016     MOVE 'ELACTQ' TO DFHEIV1
 17017*    MOVE '&& L                  %   #00015778' TO DFHEIV0
 17018     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17019     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17020     MOVE X'2020233030303135373738' TO DFHEIV0(25:11)
 17021     CALL 'kxdfhei1' USING DFHEIV0,
 17022           DFHEIV1,
 17023           ACTIVITY-QUE,
 17024           DFHEIV11,
 17025           DFHEIV99
 17026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17027
 17028
 17029     GO TO 6799-EXIT.
 17030
 17031 6720-BUILD-NEW-RECORD.
 17032
 17033* EXEC CICS GETMAIN
 17034*         SET    (ADDRESS OF ACTIVITY-QUE)
 17035*         LENGTH (60)
 17036*         INITIMG(GETMAIN-SPACE)
 17037*     END-EXEC.
 17038     MOVE 60
 17039       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 325
* EL156.cbl
 17040*    MOVE ',"IL                  $   #00015786' TO DFHEIV0
 17041     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17042     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17043     MOVE X'2020233030303135373836' TO DFHEIV0(25:11)
 17044     CALL 'kxdfhei1' USING DFHEIV0,
 17045           DFHEIV20,
 17046           DFHEIV11,
 17047           GETMAIN-SPACE
 17048     SET ADDRESS OF ACTIVITY-QUE TO
 17049         DFHEIV20
 17050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17051
 17052
 17053     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17054
 17055     IF PI-AIG-SPECIAL-BENEFIT AND
 17056        PI-CASH = 'Y'
 17057         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17058     ELSE
 17059         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17060
 17061     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17062     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17063     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17064     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17065                                    AQ-FOLLOWUP-DATE.
 17066     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17067     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17068
 17069     IF PI-PMT-GRADUATED
 17070         IF WS-PMT-APPROVAL-SW = 'A'
 17071             NEXT SENTENCE
 17072         ELSE
 17073            IF PI-AIG-SPECIAL-BENEFIT AND
 17074               PI-CASH = 'Y'
 17075                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17076            ELSE
 17077                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17078     ELSE
 17079         IF PI-PMT-APPR-SW = 'Y'
 17080            IF PI-AIG-SPECIAL-BENEFIT AND
 17081               PI-CASH = 'Y'
 17082                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17083            ELSE
 17084                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17085
 17086     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17087         MOVE ER-3536 TO EMI-ERROR
 17088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17089
 17090
 17091* EXEC CICS WRITE
 17092*         DATASET('ELACTQ')
 17093*         RIDFLD (ELMSTR-KEY)
 17094*         FROM   (ACTIVITY-QUE)
 17095*     END-EXEC.
 17096     MOVE LENGTH OF
 17097      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 326
* EL156.cbl
 17098       TO DFHEIV11
 17099     MOVE 'ELACTQ' TO DFHEIV1
 17100*    MOVE '&$ L                  ''   #00015829' TO DFHEIV0
 17101     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17102     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17103     MOVE X'2020233030303135383239' TO DFHEIV0(25:11)
 17104     CALL 'kxdfhei1' USING DFHEIV0,
 17105           DFHEIV1,
 17106           ACTIVITY-QUE,
 17107           DFHEIV11,
 17108           ELMSTR-KEY,
 17109           DFHEIV99,
 17110           DFHEIV99
 17111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17112
 17113
 17114 6799-EXIT.
 17115      EXIT.
 17116
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 327
* EL156.cbl
 17118 6800-BUILD-FORM-TRAILER.
 17119
 17120
 17121* EXEC CICS GETMAIN
 17122*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17123*         LENGTH   (200)
 17124*         INITIMG  (GETMAIN-SPACE)
 17125*    END-EXEC.
 17126     MOVE 200
 17127       TO DFHEIV11
 17128*    MOVE ',"IL                  $   #00015841' TO DFHEIV0
 17129     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17130     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17131     MOVE X'2020233030303135383431' TO DFHEIV0(25:11)
 17132     CALL 'kxdfhei1' USING DFHEIV0,
 17133           DFHEIV20,
 17134           DFHEIV11,
 17135           GETMAIN-SPACE
 17136     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17137         DFHEIV20
 17138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17139
 17140
 17141     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17142
 17143     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17144     MOVE 'AT'                   TO AT-RECORD-ID.
 17145     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17146
 17147     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17148     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17149                                    AT-FORM-LAST-MAINT-DT
 17150                                    AT-FORM-SEND-ON-DT.
 17151     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17152                                    AT-FORM-LAST-UPDATED-BY.
 17153     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17154     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17155     MOVE '6'                    TO DC-OPTION-CODE.
 17156     MOVE +29                    TO DC-ELAPSED-DAYS.
 17157     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17158     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17159     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17160
 17161     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17162         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17163
 17164     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17165                                    AT-FORM-RE-SEND-DT
 17166                                    AT-EMP-FORM-ANSWERED-DT
 17167                                    AT-PHY-FORM-ANSWERED-DT
 17168                                    AT-EMP-FORM-SEND-ON-DT
 17169                                    AT-PHY-FORM-SEND-ON-DT
 17170                                    AT-FORM-PRINTED-DT
 17171                                    AT-FORM-REPRINT-DT.
 17172     MOVE '2'                    TO AT-FORM-TYPE.
 17173
 17174     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17175     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 328
* EL156.cbl
 17176
 17177     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17178         NEXT SENTENCE
 17179     ELSE
 17180         IF CL-PROG-FORM-TYPE NOT = 'S'
 17181            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17182
 17183
 17184* EXEC CICS WRITE
 17185*         DATASET  ('ELTRLR')
 17186*         FROM     (ACTIVITY-TRAILERS)
 17187*         RIDFLD   (AT-CONTROL-PRIMARY)
 17188*     END-EXEC.
 17189     MOVE LENGTH OF
 17190      ACTIVITY-TRAILERS
 17191       TO DFHEIV11
 17192     MOVE 'ELTRLR' TO DFHEIV1
 17193*    MOVE '&$ L                  ''   #00015889' TO DFHEIV0
 17194     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17195     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17196     MOVE X'2020233030303135383839' TO DFHEIV0(25:11)
 17197     CALL 'kxdfhei1' USING DFHEIV0,
 17198           DFHEIV1,
 17199           ACTIVITY-TRAILERS,
 17200           DFHEIV11,
 17201           AT-CONTROL-PRIMARY,
 17202           DFHEIV99,
 17203           DFHEIV99
 17204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17205
 17206
 17207 6899-EXIT.
 17208      EXIT.
 17209
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 329
* EL156.cbl
 17211 6900-BUILD-ARCHIVE-HEADER.
 17212
 17213     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17214     MOVE '1'                    TO CNTL-REC-TYPE.
 17215     MOVE +0                     TO CNTL-SEQ-NO.
 17216     MOVE SPACES                 TO CNTL-ACCESS.
 17217
 17218
 17219* EXEC CICS READ
 17220*         DATASET  ('ELCNTL')
 17221*         SET      (ADDRESS OF CONTROL-FILE)
 17222*         RIDFLD   (ELCNTL-KEY)
 17223*         UPDATE
 17224*    END-EXEC.
 17225     MOVE 'ELCNTL' TO DFHEIV1
 17226*    MOVE '&"S        EU         (   #00015906' TO DFHEIV0
 17227     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17228     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17229     MOVE X'2020233030303135393036' TO DFHEIV0(25:11)
 17230     CALL 'kxdfhei1' USING DFHEIV0,
 17231           DFHEIV1,
 17232           DFHEIV20,
 17233           DFHEIV99,
 17234           ELCNTL-KEY,
 17235           DFHEIV99,
 17236           DFHEIV99,
 17237           DFHEIV99
 17238     SET ADDRESS OF CONTROL-FILE TO
 17239         DFHEIV20
 17240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17241
 17242
 17243     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17244     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17245
 17246
 17247* EXEC CICS REWRITE
 17248*         FROM     (CONTROL-FILE)
 17249*         DATASET  ('ELCNTL')
 17250*    END-EXEC.
 17251     MOVE LENGTH OF
 17252      CONTROL-FILE
 17253       TO DFHEIV11
 17254     MOVE 'ELCNTL' TO DFHEIV1
 17255*    MOVE '&& L                  %   #00015916' TO DFHEIV0
 17256     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17257     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17258     MOVE X'2020233030303135393136' TO DFHEIV0(25:11)
 17259     CALL 'kxdfhei1' USING DFHEIV0,
 17260           DFHEIV1,
 17261           CONTROL-FILE,
 17262           DFHEIV11,
 17263           DFHEIV99
 17264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17265
 17266
 17267
 17268* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 330
* EL156.cbl
 17269*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17270*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17271*    END-EXEC.
 17272*    MOVE '"$$%                  ! 7 #00015921' TO DFHEIV0
 17273     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17275     MOVE X'3720233030303135393231' TO DFHEIV0(25:11)
 17276     CALL 'kxdfhei1' USING DFHEIV0
 17277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17278
 17279
 17280
 17281* EXEC CICS GETMAIN
 17282*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17283*         LENGTH  (ELARCH-LENGTH)
 17284*         INITIMG (GETMAIN-SPACE)
 17285*    END-EXEC.
 17286*    MOVE ',"IL                  $   #00015926' TO DFHEIV0
 17287     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17289     MOVE X'2020233030303135393236' TO DFHEIV0(25:11)
 17290     CALL 'kxdfhei1' USING DFHEIV0,
 17291           DFHEIV20,
 17292           ELARCH-LENGTH,
 17293           GETMAIN-SPACE
 17294     SET ADDRESS OF LETTER-ARCHIVE TO
 17295         DFHEIV20
 17296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17297
 17298
 17299     MOVE 'LA'                   TO LA-RECORD-ID.
 17300     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17301                                    LA-ARCHIVE-NO-A1.
 17302     MOVE '4'                    TO LA-RECORD-TYPE
 17303                                    LA-RECORD-TYPE-A1.
 17304     MOVE +0                     TO LA-LINE-SEQ-NO
 17305                                    LA-LINE-SEQ-NO-A1.
 17306     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17307                                    LA-COMPANY-CD-A1.
 17308     MOVE CL-CARRIER             TO LA4-CARRIER.
 17309     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17310     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17311     MOVE CL-CERT-STATE          TO LA4-STATE.
 17312     MOVE +0                     TO LA4-NO-OF-COPIES.
 17313     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17314     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17315     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17316                                    LA4-INITIAL-PRINT-DATE
 17317                                    LA4-RESEND-PRINT-DATE
 17318                                    LA4-FORM-REM-PRINT-DT.
 17319     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17320     MOVE '2'                    TO LA4-FORM-TYPE.
 17321
 17322
 17323* EXEC CICS WRITE
 17324*         DATASET  ('ELARCH')
 17325*         FROM     (LETTER-ARCHIVE)
 17326*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 331
* EL156.cbl
 17327*    END-EXEC.
 17328     MOVE LENGTH OF
 17329      LETTER-ARCHIVE
 17330       TO DFHEIV11
 17331     MOVE 'ELARCH' TO DFHEIV1
 17332*    MOVE '&$ L                  ''   #00015955' TO DFHEIV0
 17333     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17335     MOVE X'2020233030303135393535' TO DFHEIV0(25:11)
 17336     CALL 'kxdfhei1' USING DFHEIV0,
 17337           DFHEIV1,
 17338           LETTER-ARCHIVE,
 17339           DFHEIV11,
 17340           LA-CONTROL-PRIMARY,
 17341           DFHEIV99,
 17342           DFHEIV99
 17343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17344
 17345
 17346 6999-EXIT.
 17347      EXIT.
 17348
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 332
* EL156.cbl
 17350 7000-SHOW-CLAIM.
 17351     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17352     MOVE 'A'                    TO PI-PASS-SW.
 17353     MOVE LOW-VALUES             TO PI-CPYFROM
 17354                                    PI-MONTH-END-SAVE
 17355                                    PI-CPYTHRU.
 17356
 17357     MOVE ZEROS                  TO PI-FATAL-COUNT
 17358                                    PI-DAILY-RATE
 17359                                    PI-BEN-DAYS
 17360                                    PI-MANUAL-SW
 17361                                    PI-SAVE-CURSOR
 17362                                    PI-FORCE-COUNT
 17363                                    PI-HOLDTIL
 17364                                    PI-EPYFROM
 17365                                    PI-EPYTHRU
 17366                                    PI-EDAYS
 17367                                    PI-EPYAMT
 17368                                    PI-ERESV
 17369                                    PI-EEXPENS
 17370                                    PI-CDAYS
 17371                                    PI-CPYAMT
 17372                                    PI-CRESV
 17373                                    PI-CEXPENS
 17374                                    PI-INT-RATE
 17375                                    PI-AIGFROM.
 17376     MOVE ZEROS                  TO PI-PROOF-DATE.
 17377     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17378                                    PI-REM-BEN-AMT
 17379                                    PI-MO-BEN-AMT
 17380                                    pi-ah-term.
 17381
 17382     MOVE LOW-VALUES             TO EL156AI.
 17383     MOVE MAP-NAMEA              TO MAP-NAME.
 17384
 17385* EXEC CICS HANDLE CONDITION
 17386*        NOTFND   (7010-BUILD-MAP)
 17387*    END-EXEC.
 17388*    MOVE '"$I                   ! 8 #00015999' TO DFHEIV0
 17389     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17391     MOVE X'3820233030303135393939' TO DFHEIV0(25:11)
 17392     CALL 'kxdfhei1' USING DFHEIV0
 17393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17394
 17395
 17396     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17397     MOVE '2'                    TO CNTL-REC-TYPE.
 17398     MOVE +0                     TO CNTL-SEQ-NO.
 17399     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17400
 17401
 17402* EXEC CICS READ
 17403*         DATASET  ('ELCNTL')
 17404*         SET      (ADDRESS OF CONTROL-FILE)
 17405*         RIDFLD   (ELCNTL-KEY)
 17406*    END-EXEC.
 17407     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 333
* EL156.cbl
 17408*    MOVE '&"S        E          (   #00016008' TO DFHEIV0
 17409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17411     MOVE X'2020233030303136303038' TO DFHEIV0(25:11)
 17412     CALL 'kxdfhei1' USING DFHEIV0,
 17413           DFHEIV1,
 17414           DFHEIV20,
 17415           DFHEIV99,
 17416           ELCNTL-KEY,
 17417           DFHEIV99,
 17418           DFHEIV99,
 17419           DFHEIV99
 17420     SET ADDRESS OF CONTROL-FILE TO
 17421         DFHEIV20
 17422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17423
 17424
 17425     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17426
 17427     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17428         MOVE AL-UANON      TO SURVYYNA
 17429     END-IF.
 17430
 17431
 17432     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17433     MOVE '1'                    TO CNTL-REC-TYPE.
 17434     MOVE SPACES                 TO CNTL-ACCESS.
 17435     MOVE +0                     TO CNTL-SEQ-NO.
 17436
 17437
 17438* EXEC CICS READ
 17439*         DATASET  ('ELCNTL')
 17440*         SET      (ADDRESS OF CONTROL-FILE)
 17441*         RIDFLD   (ELCNTL-KEY)
 17442*    END-EXEC.
 17443     MOVE 'ELCNTL' TO DFHEIV1
 17444*    MOVE '&"S        E          (   #00016026' TO DFHEIV0
 17445     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17446     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17447     MOVE X'2020233030303136303236' TO DFHEIV0(25:11)
 17448     CALL 'kxdfhei1' USING DFHEIV0,
 17449           DFHEIV1,
 17450           DFHEIV20,
 17451           DFHEIV99,
 17452           ELCNTL-KEY,
 17453           DFHEIV99,
 17454           DFHEIV99,
 17455           DFHEIV99
 17456     SET ADDRESS OF CONTROL-FILE TO
 17457         DFHEIV20
 17458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17459
 17460
 17461     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17462
 17463 7010-BUILD-MAP.
 17464
 17465
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 334
* EL156.cbl
 17466* EXEC CICS HANDLE CONDITION
 17467*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17468*    END-EXEC.
 17469*    MOVE '"$I                   ! 9 #00016036' TO DFHEIV0
 17470     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17472     MOVE X'3920233030303136303336' TO DFHEIV0(25:11)
 17473     CALL 'kxdfhei1' USING DFHEIV0
 17474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17475
 17476
 17477     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17478     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17479     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17480     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17481     MOVE 'MSTR'                 TO FILE-SWITCH.
 17482
 17483     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17484
 17485     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17486     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17487     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17488     MOVE CL-CCN                 TO PI-SV-CCN.
 17489
 17490     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17491     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17492     MOVE CL-CLAIM-NO            TO CLMNOO.
 17493     MOVE CL-CARRIER             TO CARRO.
 17494     MOVE CL-CERT-PRIME          TO CERTNOO.
 17495     MOVE CL-CERT-SFX            TO SUFXO.
 17496
 17497     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17498        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17499        CONTINUE
 17500     ELSE
 17501        MOVE AL-SADOF            TO ZINTHA
 17502                                    ZINTA
 17503                                    PINTHA
 17504                                    PINTA
 17505     END-IF
 17506     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17507     EVALUATE TRUE
 17508     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17509         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17510     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17511         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17512
 17513     WHEN CL-CLAIM-TYPE = 'I'
 17514         MOVE '  IU  '           TO CLMTYPO
 17515     WHEN CL-CLAIM-TYPE = 'G'
 17516         MOVE ' GAP  '           TO CLMTYPO
 17517     WHEN CL-CLAIM-TYPE = 'F'
 17518         MOVE ' FMLA '           TO CLMTYPO
 17519     END-EVALUATE.
 17520     IF CLAIM-IS-OPEN
 17521         MOVE ' OPEN'            TO CLMSTATO
 17522     ELSE
 17523         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 335
* EL156.cbl
 17524
 17525     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17526
 17527     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17528         MOVE SPACES             TO  PCERTNOO
 17529                                     PSUFXO
 17530                                     PRIMHDGO
 17531                                     SEQUO
 17532         MOVE AL-SADOF           TO  PCERTNOA
 17533                                     PSUFXA
 17534                                     PRIMHDGA
 17535                                     SEQUA
 17536     ELSE
 17537         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17538         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17539         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17540         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17541         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17542         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17543         MOVE AL-SANON               TO  PCERTNOA
 17544                                         PSUFXA
 17545                                         PRIMHDGA
 17546         MOVE AL-SABON               TO  SEQUA.
 17547
 17548     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17549
 17550     IF CL-NO-OF-PMTS-MADE = 0 AND
 17551        CL-TOTAL-PAID-AMT = 0
 17552         NEXT SENTENCE
 17553     ELSE
 17554         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17555             IF NOT PI-USES-PAID-TO
 17556                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17557                 MOVE ' '                 TO DC-OPTION-CODE
 17558                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17559                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17560             ELSE
 17561                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17562                 MOVE '6'                 TO DC-OPTION-CODE
 17563                 MOVE +1                  TO DC-ELAPSED-DAYS
 17564                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17565                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17566                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17567
 17568     IF MAP-NAME = 'EL156A'
 17569        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17570           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17571             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17572           end-if
 17573        end-if
 17574     end-if
 17575     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17576         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17577         MOVE ' '                TO DC-OPTION-CODE
 17578         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17579         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17580
 17581     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 336
* EL156.cbl
 17582         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17583         MOVE ' '                TO DC-OPTION-CODE
 17584         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17585         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17586
 17587     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17588
 17589     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17590         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17591         MOVE ' '                TO DC-OPTION-CODE
 17592         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17593         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17594
 17595     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17596         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17597         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17598     ELSE
 17599         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17600         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17601
 17602     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17603     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17604     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17605     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17606                                    PI-GROUPING.
 17607     MOVE CL-CERT-STATE          TO CERT-STATE
 17608                                    PI-STATE.
 17609     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17610                                    PI-ACCOUNT.
 17611     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17612     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17613     MOVE 'CERT'                 TO FILE-SWITCH.
 17614
 17615     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17616     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17617        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17618        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17619            MOVE 'N' TO PI-JOINT-INSURED-IND
 17620     ELSE
 17621            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17622     END-IF.
 17623
 17624     perform 7975-read-acct      thru 7975-exit
 17625     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17626     MOVE PI-STATE               TO WS-ST-ACCESS.
 17627     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17628     MOVE '3'                    TO CNTL-REC-TYPE.
 17629     MOVE +0                     TO CNTL-SEQ-NO.
 17630     MOVE 'STAT'                 TO FILE-SWITCH.
 17631
 17632     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17633
 17634     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17635     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17636
 17637     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17638        GO TO 7020-BYPASS-BENEFIT.
 17639
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 337
* EL156.cbl
 17640     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17641     MOVE '4'                    TO CNTL-REC-TYPE.
 17642     MOVE +0                     TO CNTL-SEQ-NO.
 17643     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17644     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17645     MOVE 'BENE'                 TO FILE-SWITCH.
 17646
 17647     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17648
 17649     IF NO-BENEFIT-FOUND
 17650        GO TO 7020-BYPASS-BENEFIT.
 17651
 17652     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17653     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17654     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17655
 17656 7020-BYPASS-BENEFIT.
 17657
 17658*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17659*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17660*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17661
 17662     move zeros                  to PI-MAX-BENEFIT-AMT
 17663     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17664     move cm-ah-orig-term        to pi-ah-term
 17665     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17666     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17667          'G' and 'F'
 17668         GO TO 7021-GO-TO-LIFE.
 17669
 17670     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17671        and (acct-found)
 17672        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17673        PERFORM 0900-GET-DDF-limits
 17674                                 THRU 0900-EXIT
 17675        IF PDEF-FOUND
 17676           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17677              (P1 > +8)
 17678              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17679           END-PERFORM
 17680           IF P1 < +9
 17681              if pd-ben-pct (p1) not numeric
 17682                 move zeros      to pd-ben-pct (p1)
 17683              end-if
 17684              if pd-ben-pct (p1) = zeros
 17685                 move +1         to ws-work-ben-pct
 17686              else
 17687                 move pd-ben-pct (p1)
 17688                                 to ws-work-ben-pct
 17689              end-if
 17690              compute cm-ah-benefit-amt =
 17691                 cm-ah-benefit-amt * ws-work-ben-pct
 17692              move pd-max-amt (p1) to pi-max-benefit-amt
 17693           END-IF
 17694        END-IF
 17695     end-if
 17696     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17697     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 338
* EL156.cbl
 17698     if (pi-max-benefit-amt not = zeros)
 17699        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17700        move pi-max-benefit-amt  to beneo
 17701     else
 17702        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17703     end-if
 17704     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17705     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17706                                    CP-ORIGINAL-TERM.
 17707     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17708
 17709*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17710*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17711*    ELSE
 17712         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17713
 17714     MOVE ' '                    TO DC-OPTION-CODE.
 17715     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17716     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17717
 17718     IF PI-COMPANY-ID = 'DMD'
 17719         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17720         GO TO 7023-BYPASS-REMAINING-TERM.
 17721
 17722     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17723     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17724     GO TO 7022-AROUND-LIFE.
 17725
 17726 7021-GO-TO-LIFE.
 17727
 17728     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17729     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17730     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17731                                    CP-ORIGINAL-TERM.
 17732     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17733     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17734     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17735     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17736
 17737     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17738         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17739     ELSE
 17740         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17741
 17742     MOVE ' '                    TO DC-OPTION-CODE.
 17743     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17744     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17745
 17746 7022-AROUND-LIFE.
 17747
 17748     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17749     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17750     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17751     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17752     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17753     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17754     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17755
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 339
* EL156.cbl
 17756     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17757
 17758     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17759        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17760           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17761
 17762     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17763        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17764           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17765
 17766 7023-BYPASS-REMAINING-TERM.
 17767     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17768       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17769          MOVE ZEROS                  TO BENEO
 17770       ELSE
 17771          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17772          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17773          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17774          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17775          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17776          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17777          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17778          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17779          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17780          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17781          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17782          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17783          IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17784             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17785             PERFORM 0900-GET-DDF-limits
 17786                                 THRU 0900-EXIT
 17787             IF PDEF-FOUND
 17788                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17789                   (P1 > +8)
 17790                   OR (PD-PROD-CODE (P1) = 'L')
 17791                END-PERFORM
 17792                IF P1 < +9
 17793                   MOVE PD-MAX-AMT (P1)
 17794                                 TO CP-R-MAX-TOT-BEN
 17795                END-IF
 17796             END-IF
 17797          END-IF
 17798
 17799* EXEC CICS LINK
 17800*            PROGRAM  (LINK-REMAMT)
 17801*            COMMAREA (CALCULATION-PASS-AREA)
 17802*            LENGTH   (CP-COMM-LENGTH)
 17803*         END-EXEC
 17804*    MOVE '."C                   (   #00016361' TO DFHEIV0
 17805     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17807     MOVE X'2020233030303136333631' TO DFHEIV0(25:11)
 17808     CALL 'kxdfhei1' USING DFHEIV0,
 17809           LINK-REMAMT,
 17810           CALCULATION-PASS-AREA,
 17811           CP-COMM-LENGTH,
 17812           DFHEIV99,
 17813           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 340
* EL156.cbl
 17814           DFHEIV99,
 17815           DFHEIV99
 17816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17817          MOVE CP-REMAINING-AMT       TO BENEO
 17818       end-if
 17819     end-if
 17820     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17821     MOVE +95                    TO TRLR-SEQ-NO
 17822
 17823* EXEC CICS READ
 17824*       DATASET  ('ELTRLR')
 17825*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17826*       RIDFLD   (ELTRLR-KEY)
 17827*       RESP     (WS-RESPONSE)
 17828*    END-EXEC
 17829     MOVE 'ELTRLR' TO DFHEIV1
 17830*    MOVE '&"S        E          (  N#00016371' TO DFHEIV0
 17831     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17832     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17833     MOVE X'204E233030303136333731' TO DFHEIV0(25:11)
 17834     CALL 'kxdfhei1' USING DFHEIV0,
 17835           DFHEIV1,
 17836           DFHEIV20,
 17837           DFHEIV99,
 17838           ELTRLR-KEY,
 17839           DFHEIV99,
 17840           DFHEIV99,
 17841           DFHEIV99
 17842     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17843         DFHEIV20
 17844     MOVE EIBRESP  TO WS-RESPONSE
 17845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17846
 17847     if ws-resp-normal
 17848        perform varying s1 from +1 by +1 until
 17849           at-note-error-no (s1) = spaces
 17850           move at-note-error-no (s1)
 17851                                 to emi-error
 17852           if at-note-error-no (s1) = '1653'
 17853              evaluate true
 17854                 when cl-claim-type = 'L'
 17855                    move '  LF  '
 17856                                 to emi-claim-type
 17857                 when cl-claim-type = 'I'
 17858                    move '  IU  '
 17859                                 to emi-claim-type
 17860                 when cl-claim-type = 'F'
 17861                    move ' FMLA '
 17862                                 to emi-claim-type
 17863                 when other
 17864                    move '  AH  '
 17865                                 to emi-claim-type
 17866              end-evaluate
 17867           end-if
 17868           PERFORM 9900-ERROR-FORMAT
 17869                                 THRU 9900-EXIT
 17870        end-perform
 17871     end-if
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 341
* EL156.cbl
 17872     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17873         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17874            WS-LF-COVERAGE-TYPE = 'P'
 17875             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17876                                        CM-LF-ITD-DEATH-AMT
 17877             MOVE WS-REMAINING-AMT  TO  BENEO.
 17878
 17879     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17880     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17881     MOVE WS-TERMS               TO TERMSO.
 17882
 17883     IF WS-STATUS = '6' OR '7' OR '8'
 17884         MOVE AL-SABOF           TO CRTSTATA.
 17885
 17886     IF WS-STATUS = '1' OR '4'
 17887        IF CP-REMAINING-TERM-3 = ZEROS
 17888           MOVE 'EXPIRED'        TO CRTSTATO
 17889        ELSE
 17890           MOVE 'ACTIVE  '       TO CRTSTATO.
 17891
 17892     IF WS-STATUS = '2'
 17893         MOVE 'PEND    '         TO CRTSTATO.
 17894
 17895     IF WS-STATUS = '3'
 17896         MOVE 'RESTORE '         TO CRTSTATO.
 17897
 17898     IF WS-STATUS = '5'
 17899         MOVE 'REISSUE '         TO CRTSTATO.
 17900
 17901     IF WS-STATUS = '6'
 17902         MOVE 'LMP DIS'          TO CRTSTATO.
 17903
 17904     IF WS-STATUS = '7'
 17905         MOVE 'DEATH'            TO CRTSTATO.
 17906
 17907     IF WS-STATUS = '8'
 17908         MOVE 'CANCEL'           TO CRTSTATO.
 17909
 17910     IF WS-STATUS = '9'
 17911         MOVE 'RE-ONLY '         TO CRTSTATO.
 17912
 17913     IF WS-STATUS = 'V'
 17914         MOVE 'VOID  '           TO CRTSTATO.
 17915
 17916     IF WS-STATUS = 'D'
 17917         MOVE 'DECLINE '         TO CRTSTATO.
 17918
 17919     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17920         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17921         MOVE '5'                TO CNTL-REC-TYPE
 17922     ELSE
 17923         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17924         MOVE '4'                TO CNTL-REC-TYPE.
 17925
 17926     MOVE '** NONE **'           TO COVERO.
 17927     MOVE AL-SABON               TO COVERA.
 17928
 17929     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 342
* EL156.cbl
 17930         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17931             MOVE CM-BENEFICIARY TO LOANNOO
 17932             MOVE AL-UANON       TO LOANNOA.
 17933
 17934     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 17935        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17936        MOVE +91                 TO  TRLR-SEQ-NO
 17937
 17938* EXEC CICS READ
 17939*           DATASET  ('ELTRLR')
 17940*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17941*           RIDFLD   (ELTRLR-KEY)
 17942*           RESP     (WS-RESPONSE)
 17943*       END-EXEC
 17944     MOVE 'ELTRLR' TO DFHEIV1
 17945*    MOVE '&"S        E          (  N#00016468' TO DFHEIV0
 17946     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17948     MOVE X'204E233030303136343638' TO DFHEIV0(25:11)
 17949     CALL 'kxdfhei1' USING DFHEIV0,
 17950           DFHEIV1,
 17951           DFHEIV20,
 17952           DFHEIV99,
 17953           ELTRLR-KEY,
 17954           DFHEIV99,
 17955           DFHEIV99,
 17956           DFHEIV99
 17957     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17958         DFHEIV20
 17959     MOVE EIBRESP  TO WS-RESPONSE
 17960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17961
 17962        IF WS-RESP-NORMAL
 17963           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17964        ELSE
 17965           MOVE SPACES           TO  LOANNOO
 17966        END-IF
 17967*052506
 17968*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17969*052506
 17970     END-IF
 17971
 17972     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17973        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17974
 17975     IF WS-BEN-CD = ZEROS
 17976         GO TO 7050-SHOW-CONTINUE.
 17977
 17978     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17979     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17980     MOVE +0                     TO CNTL-SEQ-NO.
 17981     MOVE 'BENE'                 TO FILE-SWITCH.
 17982
 17983     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17984     IF BENEFIT-FOUND
 17985        MOVE CF-JOINT-INDICATOR (SUB-1)
 17986                                 TO PI-JOINT-COV-IND
 17987                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 343
* EL156.cbl
 17988        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 17989                                 TO COVERO
 17990        MOVE AL-SANON            TO COVERA
 17991     END-IF
 17992     if (cntl-rec-type = '4')   *> Life claim
 17993        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 17994        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 17995        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 17996        MOVE '5'              TO CNTL-REC-TYPE
 17997        MOVE WS-ACCESS        TO CNTL-ACCESS
 17998        MOVE +0               TO CNTL-SEQ-NO
 17999        MOVE 'BENE'           TO FILE-SWITCH
 18000        PERFORM 7200-FIND-BENEFIT
 18001                              THRU 7200-EXIT
 18002        IF (BENEFIT-FOUND)
 18003           and (pi-rb-joint-cov-ind) not = 'J'
 18004           MOVE CF-JOINT-INDICATOR (SUB-1)
 18005                              TO PI-rb-JOINT-COV-IND
 18006        end-if
 18007     end-if
 18008     .
 18009 7050-SHOW-CONTINUE.
 18010
 18011     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18012        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18013            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18014     END-IF
 18015
 18016     IF PI-COMPANY-ID = 'DMD'
 18017         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18018
 18019     MOVE -1                     TO PMTTYPEL.
 18020     GO TO 8100-SEND-INITIAL-MAP.
 18021
 18022 7100-SHOW-RECORD-NOT-FOUND.
 18023     IF FILE-SWITCH = 'MSTR'
 18024         MOVE ER-0204            TO EMI-ERROR.
 18025
 18026     IF FILE-SWITCH = 'CERT'
 18027         MOVE ER-0206            TO EMI-ERROR.
 18028
 18029     IF FILE-SWITCH = 'STAT'
 18030         MOVE ER-0149            TO EMI-ERROR.
 18031
 18032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18033
 18034     MOVE -1                     TO PMTTYPEL.
 18035     GO TO 8100-SEND-INITIAL-MAP
 18036
 18037     .
 18038 7110-BUILD-PMT-TRLR.
 18039     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18040     MOVE +51                    TO TRLR-SEQ-NO
 18041
 18042* EXEC CICS READ
 18043*        DATASET  ('ELTRLR')
 18044*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18045*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 344
* EL156.cbl
 18046*        RESP     (WS-RESPONSE)
 18047*    END-EXEC
 18048     MOVE 'ELTRLR' TO DFHEIV1
 18049*    MOVE '&"S        E          (  N#00016554' TO DFHEIV0
 18050     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18052     MOVE X'204E233030303136353534' TO DFHEIV0(25:11)
 18053     CALL 'kxdfhei1' USING DFHEIV0,
 18054           DFHEIV1,
 18055           DFHEIV20,
 18056           DFHEIV99,
 18057           ELTRLR-KEY,
 18058           DFHEIV99,
 18059           DFHEIV99,
 18060           DFHEIV99
 18061     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18062         DFHEIV20
 18063     MOVE EIBRESP  TO WS-RESPONSE
 18064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18065     IF WS-RESP-NORMAL
 18066        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18067     END-IF
 18068     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18069
 18070* EXEC CICS GETMAIN
 18071*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18072*         LENGTH    (200)
 18073*         INITIMG   (GETMAIN-SPACE)
 18074*     END-EXEC
 18075     MOVE 200
 18076       TO DFHEIV11
 18077*    MOVE ',"IL                  $   #00016564' TO DFHEIV0
 18078     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18080     MOVE X'2020233030303136353634' TO DFHEIV0(25:11)
 18081     CALL 'kxdfhei1' USING DFHEIV0,
 18082           DFHEIV20,
 18083           DFHEIV11,
 18084           GETMAIN-SPACE
 18085     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18086         DFHEIV20
 18087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18088     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18089                                    AT-PREV-PAID-THRU-DT
 18090     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18091     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18092     MOVE 'AT'                   TO AT-RECORD-ID
 18093     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18094     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18095     MOVE '2'                    TO AT-TRAILER-TYPE
 18096     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18097                                    AT-PAYMENT-LAST-MAINT-DT
 18098     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18099                                    AT-PAYMENT-LAST-UPDATED-BY
 18100     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18101     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18102     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18103     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 345
* EL156.cbl
 18104     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18105     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18106     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18107     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18108     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18109     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18110     if pi-int-to-rem-borr = 'Y'
 18111        move 'Q1'                to at-payee-type-cd
 18112     else
 18113        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18114     end-if
 18115     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18116     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18117     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18118     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18119     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18120                                    AT-TO-BE-WRITTEN-DT
 18121     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18122                                    AT-CHECK-QUE-SEQUENCE
 18123                                    AT-ADDL-RESERVE
 18124     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18125                                    AT-VOID-SELECT-DT
 18126                                    AT-VOID-ACCEPT-DT
 18127                                    AT-VOID-DT
 18128                                    AT-PMT-PROOF-DT
 18129                                    AT-INT-PMT-SELECT-DT
 18130     MOVE ZEROS                  TO AT-DAILY-RATE
 18131                                    AT-ELIMINATION-DAYS
 18132     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18133*    EXEC CICS HANDLE CONDITION
 18134*        DUPREC    (7120-DUPREC)
 18135*    END-EXEC
 18136     .
 18137 7115-WRITE-INT-TRLR.
 18138
 18139* EXEC CICS WRITE
 18140*         DATASET       ('ELTRLR')
 18141*         FROM          (ACTIVITY-TRAILERS)
 18142*         RIDFLD        (AT-CONTROL-PRIMARY)
 18143*         RESP          (WS-RESPONSE)
 18144*     END-EXEC
 18145     MOVE LENGTH OF
 18146      ACTIVITY-TRAILERS
 18147       TO DFHEIV11
 18148     MOVE 'ELTRLR' TO DFHEIV1
 18149*    MOVE '&$ L                  ''  N#00016619' TO DFHEIV0
 18150     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18151     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18152     MOVE X'204E233030303136363139' TO DFHEIV0(25:11)
 18153     CALL 'kxdfhei1' USING DFHEIV0,
 18154           DFHEIV1,
 18155           ACTIVITY-TRAILERS,
 18156           DFHEIV11,
 18157           AT-CONTROL-PRIMARY,
 18158           DFHEIV99,
 18159           DFHEIV99
 18160     MOVE EIBRESP  TO WS-RESPONSE
 18161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 346
* EL156.cbl
 18162      IF WS-RESP-DUPREC
 18163         GO TO 7120-DUPREC
 18164      END-IF
 18165     GO TO 7130-EXIT
 18166     .
 18167 7120-DUPREC.
 18168     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18169     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18170     GO TO 7115-WRITE-INT-TRLR
 18171     .
 18172 7130-EXIT.
 18173      EXIT.
 18174 7140-BUILD-NOTE-TRLR.
 18175
 18176
 18177* EXEC CICS GETMAIN
 18178*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18179*         LENGTH    (200)
 18180*         INITIMG   (GETMAIN-SPACE)
 18181*     END-EXEC
 18182     MOVE 200
 18183       TO DFHEIV11
 18184*    MOVE ',"IL                  $   #00016639' TO DFHEIV0
 18185     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18187     MOVE X'2020233030303136363339' TO DFHEIV0(25:11)
 18188     CALL 'kxdfhei1' USING DFHEIV0,
 18189           DFHEIV20,
 18190           DFHEIV11,
 18191           GETMAIN-SPACE
 18192     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18193         DFHEIV20
 18194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18195     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18196     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18197     MOVE 'AT'                   TO AT-RECORD-ID
 18198     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18199     MOVE '6'                    TO AT-TRAILER-TYPE
 18200     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18201                                    AT-GEN-INFO-LAST-MAINT-DT
 18202     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18203                                    AT-GEN-INFO-LAST-UPDATED-BY
 18204     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18205     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18206     .
 18207 7150-WRITE.
 18208
 18209* EXEC CICS HANDLE CONDITION
 18210*        DUPREC    (7160-DUPREC)
 18211*    END-EXEC
 18212*    MOVE '"$%                   ! : #00016657' TO DFHEIV0
 18213     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18215     MOVE X'3A20233030303136363537' TO DFHEIV0(25:11)
 18216     CALL 'kxdfhei1' USING DFHEIV0
 18217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18218
 18219* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 347
* EL156.cbl
 18220*         DATASET     ('ELTRLR')
 18221*         FROM        (ACTIVITY-TRAILERS)
 18222*         RIDFLD      (AT-CONTROL-PRIMARY)
 18223*         RESP        (WS-RESPONSE)
 18224*     END-EXEC
 18225     MOVE LENGTH OF
 18226      ACTIVITY-TRAILERS
 18227       TO DFHEIV11
 18228     MOVE 'ELTRLR' TO DFHEIV1
 18229*    MOVE '&$ L                  ''  N#00016660' TO DFHEIV0
 18230     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18231     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18232     MOVE X'204E233030303136363630' TO DFHEIV0(25:11)
 18233     CALL 'kxdfhei1' USING DFHEIV0,
 18234           DFHEIV1,
 18235           ACTIVITY-TRAILERS,
 18236           DFHEIV11,
 18237           AT-CONTROL-PRIMARY,
 18238           DFHEIV99,
 18239           DFHEIV99
 18240     MOVE EIBRESP  TO WS-RESPONSE
 18241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18242      IF WS-RESP-DUPREC
 18243         GO TO 7160-DUPREC
 18244      END-IF
 18245     GO TO 7170-EXIT
 18246     .
 18247 7160-DUPREC.
 18248     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18249     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18250     GO TO 7150-WRITE
 18251     .
 18252 7170-EXIT.
 18253      EXIT.
 18254
 18255 7180-ADD-CERT-NOTE.
 18256*ADD CERT NOTE FOR SC NP+6
 18257
 18258
 18259* EXEC CICS GETMAIN
 18260*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18261*         LENGTH    (150)
 18262*         INITIMG   (GETMAIN-SPACE)
 18263*     END-EXEC.
 18264     MOVE 150
 18265       TO DFHEIV11
 18266*    MOVE ',"IL                  $   #00016682' TO DFHEIV0
 18267     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18269     MOVE X'2020233030303136363832' TO DFHEIV0(25:11)
 18270     CALL 'kxdfhei1' USING DFHEIV0,
 18271           DFHEIV20,
 18272           DFHEIV11,
 18273           GETMAIN-SPACE
 18274     SET ADDRESS OF CERT-NOTE-FILE TO
 18275         DFHEIV20
 18276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18277
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 348
* EL156.cbl
 18278
 18279     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18280     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18281     MOVE +1                     TO WRK-NOTE-SEQ.
 18282     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18283     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18284     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18285     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18286     MOVE CL-CERT-STATE          TO CZ-STATE.
 18287     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18288     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18289     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18290     MOVE '2'                    TO CZ-RECORD-TYPE.
 18291     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18292     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18293     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18294     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18295     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18296     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18297     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18298     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18299     IF PI-COMPANY-ID = 'AHL'
 18300        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18301           CONTINUE
 18302        ELSE
 18303           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18304              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18305           ELSE
 18306              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18307           END-IF
 18308        END-IF
 18309     END-IF
 18310     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18311     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18312
 18313 7181-WRITE.
 18314
 18315
 18316* EXEC CICS WRITE
 18317*         DATASET     ('ERCNOT')
 18318*         FROM        (CERT-NOTE-FILE)
 18319*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18320*         RESP        (WS-RESPONSE)
 18321*    END-EXEC.
 18322     MOVE LENGTH OF
 18323      CERT-NOTE-FILE
 18324       TO DFHEIV11
 18325     MOVE 'ERCNOT' TO DFHEIV1
 18326*    MOVE '&$ L                  ''  N#00016724' TO DFHEIV0
 18327     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18328     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18329     MOVE X'204E233030303136373234' TO DFHEIV0(25:11)
 18330     CALL 'kxdfhei1' USING DFHEIV0,
 18331           DFHEIV1,
 18332           CERT-NOTE-FILE,
 18333           DFHEIV11,
 18334           CZ-CONTROL-PRIMARY,
 18335           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 349
* EL156.cbl
 18336           DFHEIV99
 18337     MOVE EIBRESP  TO WS-RESPONSE
 18338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18339
 18340
 18341     IF WS-RESP-DUPREC
 18342         GO TO 7182-DUPREC
 18343     END-IF.
 18344
 18345     SET CERT-NOTE-ADDED TO TRUE.
 18346
 18347     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18348         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18349     END-IF.
 18350
 18351     GO TO 7189-EXIT.
 18352
 18353 7182-DUPREC.
 18354
 18355     ADD +1                      TO  WRK-NOTE-SEQ.
 18356     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18357     GO TO 7181-WRITE.
 18358
 18359 7189-EXIT.
 18360      EXIT.
 18361
 18362 7190-ADD-ORIG-NOTE.
 18363
 18364
 18365* EXEC CICS GETMAIN
 18366*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18367*         LENGTH    (150)
 18368*         INITIMG   (GETMAIN-SPACE)
 18369*     END-EXEC.
 18370     MOVE 150
 18371       TO DFHEIV11
 18372*    MOVE ',"IL                  $   #00016754' TO DFHEIV0
 18373     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18375     MOVE X'2020233030303136373534' TO DFHEIV0(25:11)
 18376     CALL 'kxdfhei1' USING DFHEIV0,
 18377           DFHEIV20,
 18378           DFHEIV11,
 18379           GETMAIN-SPACE
 18380     SET ADDRESS OF CERT-NOTE-FILE TO
 18381         DFHEIV20
 18382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18383
 18384
 18385     ADD +1                      TO WRK-NOTE-SEQ.
 18386     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18387     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18388     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18389     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18390     MOVE CL-CERT-STATE          TO CZ-STATE.
 18391     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18392     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18393     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 350
* EL156.cbl
 18394     MOVE '2'                    TO CZ-RECORD-TYPE.
 18395     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18396     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18397     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18398     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18399     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18400     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18401
 18402 7191-WRITE.
 18403
 18404
 18405* EXEC CICS WRITE
 18406*         DATASET     ('ERCNOT')
 18407*         FROM        (CERT-NOTE-FILE)
 18408*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18409*         RESP        (WS-RESPONSE)
 18410*    END-EXEC.
 18411     MOVE LENGTH OF
 18412      CERT-NOTE-FILE
 18413       TO DFHEIV11
 18414     MOVE 'ERCNOT' TO DFHEIV1
 18415*    MOVE '&$ L                  ''  N#00016779' TO DFHEIV0
 18416     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18417     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18418     MOVE X'204E233030303136373739' TO DFHEIV0(25:11)
 18419     CALL 'kxdfhei1' USING DFHEIV0,
 18420           DFHEIV1,
 18421           CERT-NOTE-FILE,
 18422           DFHEIV11,
 18423           CZ-CONTROL-PRIMARY,
 18424           DFHEIV99,
 18425           DFHEIV99
 18426     MOVE EIBRESP  TO WS-RESPONSE
 18427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18428
 18429
 18430     IF WS-RESP-DUPREC
 18431         GO TO 7192-DUPREC
 18432     END-IF.
 18433
 18434     GO TO 7199-EXIT.
 18435
 18436 7192-DUPREC.
 18437
 18438     ADD +1                      TO  WRK-NOTE-SEQ.
 18439     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18440     GO TO 7191-WRITE.
 18441
 18442 7199-EXIT.
 18443      EXIT.
 18444 7200-FIND-BENEFIT.
 18445     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18446
 18447
 18448* EXEC CICS HANDLE CONDITION
 18449*        ENDFILE(7200-EXIT)
 18450*        NOTFND(7200-EXIT)
 18451*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 351
* EL156.cbl
 18452*    MOVE '"$''I                  ! ; #00016803' TO DFHEIV0
 18453     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18455     MOVE X'3B20233030303136383033' TO DFHEIV0(25:11)
 18456     CALL 'kxdfhei1' USING DFHEIV0
 18457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18458
 18459
 18460
 18461* EXEC CICS READ
 18462*        DATASET('ELCNTL')
 18463*        SET(ADDRESS OF CONTROL-FILE)
 18464*        RIDFLD(ELCNTL-KEY)
 18465*        GTEQ
 18466*    END-EXEC.
 18467     MOVE 'ELCNTL' TO DFHEIV1
 18468*    MOVE '&"S        G          (   #00016808' TO DFHEIV0
 18469     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18471     MOVE X'2020233030303136383038' TO DFHEIV0(25:11)
 18472     CALL 'kxdfhei1' USING DFHEIV0,
 18473           DFHEIV1,
 18474           DFHEIV20,
 18475           DFHEIV99,
 18476           ELCNTL-KEY,
 18477           DFHEIV99,
 18478           DFHEIV99,
 18479           DFHEIV99
 18480     SET ADDRESS OF CONTROL-FILE TO
 18481         DFHEIV20
 18482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18483
 18484
 18485     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18486        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18487           GO TO 7200-EXIT.
 18488
 18489     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18490         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18491            ((SUB-1 > 8) OR
 18492            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18493
 18494     IF SUB-1 NOT = 9
 18495         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18496
 18497     GO TO 7200-EXIT.
 18498
 18499 7200-BENEFIT-DUMMY.
 18500
 18501 7200-DUMMY-EXIT.
 18502     EXIT.
 18503
 18504 7200-EXIT.
 18505     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 352
* EL156.cbl
 18507*052506
 18508*052506 7250-FIND-LETTER-TRLR.
 18509*052506     EXEC CICS HANDLE CONDITION
 18510*052506         ENDFILE  (7250-END)
 18511*052506         NOTFND   (7250-END)
 18512*052506     END-EXEC.
 18513*052506
 18514*052506     EXEC CICS STARTBR
 18515*052506         DATASET   ('ELTRLR')
 18516*052506         RIDFLD    (ELTRLR-KEY)
 18517*052506         GTEQ
 18518*052506     END-EXEC.
 18519*052506
 18520*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18521*052506
 18522*052506 7250-FIND-LOOP.
 18523*052506     EXEC CICS READNEXT
 18524*052506         DATASET   ('ELTRLR')
 18525*052506         RIDFLD    (ELTRLR-KEY)
 18526*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18527*052506     END-EXEC.
 18528*052506
 18529*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18530*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18531*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18532*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18533*052506        GO TO 7250-END
 18534*052506     END-IF.
 18535*052506
 18536*052506     IF AT-TRAILER-TYPE NOT = '4'
 18537*052506         GO TO 7250-FIND-LOOP
 18538*052506     END-IF.
 18539*052506
 18540*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18541*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18542*052506     END-IF.
 18543*052506
 18544*052506     GO TO 7250-FIND-LOOP.
 18545*052506
 18546*052506 7250-END.
 18547*052506
 18548*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18549*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18550*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18551*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18552*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18553*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18554*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18555*052506     END-IF.
 18556*052506
 18557*052506     EXEC CICS ENDBR
 18558*052506          DATASET    ('ELTRLR')
 18559*052506     END-EXEC.
 18560*052506
 18561*052506 7250-EXIT.
 18562*052506     EXIT.
 18563*052506     EJECT
 18564*052506
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 353
* EL156.cbl
 18565 7300-CHECK-AUTO-ACTIVITY.
 18566
 18567     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18568         NEXT SENTENCE
 18569     ELSE
 18570         GO TO 7399-EXIT.
 18571
 18572     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18573
 18574     IF WS-ACT-REC-FOUND-SW = 'N'
 18575         GO TO 7399-EXIT.
 18576
 18577     IF PI-ACTIVITY-CODE = 09
 18578         GO TO 7300-CONT-AUTO-ACTIVITY.
 18579
 18580     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18581        (PI-ACTIVITY-CODE = 11)
 18582         GO TO 7300-CONT-AUTO-ACTIVITY.
 18583
 18584     IF PI-PROVISIONAL-IND = 'P'
 18585         IF PI-PMTTYPE = '1'
 18586             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18587                 MOVE 'N'    TO  PI-RESET-SW
 18588                 GO TO 7399-EXIT.
 18589
 18590     IF PI-PMTTYPE = '1'
 18591         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18592             MOVE 'N'        TO  PI-RESET-SW
 18593             GO TO 7399-EXIT.
 18594
 18595     IF PI-PMTTYPE = '2' OR '3'
 18596         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18597             MOVE 'N'        TO  PI-RESET-SW
 18598             GO TO 7399-EXIT.
 18599
 18600     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18601         IF PI-PROVISIONAL-IND = 'P'
 18602             NEXT SENTENCE
 18603         ELSE
 18604             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18605
 18606 7300-CONT-AUTO-ACTIVITY.
 18607
 18608     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18609         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18610         MOVE '4'            TO DC-OPTION-CODE
 18611         MOVE +0             TO DC-ELAPSED-DAYS
 18612                                DC-ELAPSED-MONTHS
 18613         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18614         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18615         IF PI-USES-PAID-TO
 18616             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18617             IF NO-CONVERSION-ERROR
 18618                 MOVE +1     TO DC-ELAPSED-DAYS
 18619                 MOVE +0     TO DC-ELAPSED-MONTHS
 18620                 MOVE '6'    TO DC-OPTION-CODE
 18621                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18622                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 354
* EL156.cbl
 18623                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18624
 18625     IF PI-PFKEY-USED = DFHPF5
 18626         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18627         IF PI-USES-PAID-TO
 18628             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18629             MOVE +1                  TO DC-ELAPSED-DAYS
 18630             MOVE +0                  TO DC-ELAPSED-MONTHS
 18631             MOVE '6'                 TO DC-OPTION-CODE
 18632             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18633             IF NO-CONVERSION-ERROR
 18634                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18635
 18636     IF WS-CHK-THRU-DT < PI-EXP-DT
 18637         NEXT SENTENCE
 18638     ELSE
 18639         MOVE 03                     TO  WS-ACTIVITY-CODE
 18640         GO TO 7390-PROCESS-ACTIVITY.
 18641
 18642     IF PI-PROV-PMT
 18643         MOVE 09                     TO  WS-ACTIVITY-CODE
 18644     ELSE
 18645        IF PI-PMTTYPE = '1'
 18646            MOVE 02                  TO  WS-ACTIVITY-CODE
 18647        ELSE
 18648        IF PI-PMTTYPE = '2' OR '3'
 18649            MOVE 07                  TO  WS-ACTIVITY-CODE
 18650        ELSE
 18651        IF PI-PMTTYPE = '4'
 18652            MOVE 00                  TO  WS-ACTIVITY-CODE
 18653        ELSE
 18654            MOVE 'N'                 TO  PI-RESET-SW
 18655            GO TO 7399-EXIT.
 18656
 18657 7390-PROCESS-ACTIVITY.
 18658
 18659     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18660
 18661 7399-EXIT.
 18662     EXIT.
 18663
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 355
* EL156.cbl
 18665 7400-CHECK-AUTO-ACTIVITY.
 18666
 18667
 18668* EXEC CICS HANDLE CONDITION
 18669*        NOTFND   (7400-NOT-FOUND)
 18670*    END-EXEC.
 18671*    MOVE '"$I                   ! < #00016997' TO DFHEIV0
 18672     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18674     MOVE X'3C20233030303136393937' TO DFHEIV0(25:11)
 18675     CALL 'kxdfhei1' USING DFHEIV0
 18676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18677
 18678
 18679     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18680     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18681     MOVE SPACES                 TO  CNTL-ACCESS.
 18682     MOVE +0                     TO  CNTL-SEQ-NO.
 18683
 18684
 18685* EXEC CICS READ
 18686*        DATASET   ('ELCNTL')
 18687*        RIDFLD    (ELCNTL-KEY)
 18688*        SET       (ADDRESS OF CONTROL-FILE)
 18689*    END-EXEC.
 18690     MOVE 'ELCNTL' TO DFHEIV1
 18691*    MOVE '&"S        E          (   #00017006' TO DFHEIV0
 18692     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18694     MOVE X'2020233030303137303036' TO DFHEIV0(25:11)
 18695     CALL 'kxdfhei1' USING DFHEIV0,
 18696           DFHEIV1,
 18697           DFHEIV20,
 18698           DFHEIV99,
 18699           ELCNTL-KEY,
 18700           DFHEIV99,
 18701           DFHEIV99,
 18702           DFHEIV99
 18703     SET ADDRESS OF CONTROL-FILE TO
 18704         DFHEIV20
 18705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18706
 18707
 18708     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18709     GO TO 7400-EXIT.
 18710
 18711 7400-NOT-FOUND.
 18712     MOVE 'N'                        TO  PI-RESET-SW
 18713                                         WS-LETTER-SW
 18714                                         WS-ACT-REC-FOUND-SW.
 18715
 18716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18717
 18718 7400-EXIT.
 18719     EXIT.
 18720
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 356
* EL156.cbl
 18722 7450-FORMAT-AUTO-LETTER.
 18723
 18724     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18725         MOVE 'Y'                    TO PI-RESET-SW
 18726         GO TO 7450-CONTINUE-PROCESS.
 18727
 18728     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18729
 18730     IF SUB > 9
 18731         SUBTRACT 9 FROM SUB
 18732         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18733     ELSE
 18734         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18735
 18736 7450-CONTINUE-PROCESS.
 18737
 18738     IF WS-ACTIVITY-CODE = ZEROS
 18739         MOVE 'N'                    TO  WS-LETTER-SW
 18740         GO TO 7450-EXIT.
 18741
 18742     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18743
 18744     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18745         MOVE 'N'                    TO  PI-RESET-SW
 18746                                         WS-LETTER-SW
 18747         GO TO 7450-EXIT.
 18748
 18749     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18750         MOVE 'N'                    TO  WS-LETTER-SW
 18751         GO TO 7450-EXIT.
 18752
 18753     MOVE 'Y'                        TO  WS-LETTER-SW.
 18754     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18755     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18756
 18757     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18758
 18759     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18760         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18761         MOVE '6'                    TO  DC-OPTION-CODE
 18762         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18763         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18764         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18765         IF NO-CONVERSION-ERROR
 18766             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18767         ELSE
 18768              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18769
 18770     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18771         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18772         MOVE '6'                    TO  DC-OPTION-CODE
 18773         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18774         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18775         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18776         IF NO-CONVERSION-ERROR
 18777             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18778         ELSE
 18779             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 357
* EL156.cbl
 18780
 18781 7450-EXIT.
 18782     EXIT.
 18783
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 358
* EL156.cbl
 18785 7500-RESET-AUTO-ACTIVITY.
 18786
 18787     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18788     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18789     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18790     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18791     MOVE +100                   TO  TRLR-SEQ-NO.
 18792
 18793 7500-STARTBR-TRLR.
 18794
 18795
 18796* EXEC CICS HANDLE CONDITION
 18797*        ENDFILE  (7590-END)
 18798*        NOTFND   (7590-END)
 18799*    END-EXEC.
 18800*    MOVE '"$''I                  ! = #00017099' TO DFHEIV0
 18801     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18803     MOVE X'3D20233030303137303939' TO DFHEIV0(25:11)
 18804     CALL 'kxdfhei1' USING DFHEIV0
 18805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18806
 18807
 18808
 18809* EXEC CICS STARTBR
 18810*        DATASET   ('ELTRLR')
 18811*        RIDFLD    (ELTRLR-KEY)
 18812*        GTEQ
 18813*    END-EXEC.
 18814     MOVE 'ELTRLR' TO DFHEIV1
 18815     MOVE 0
 18816       TO DFHEIV11
 18817*    MOVE '&,         G          &   #00017104' TO DFHEIV0
 18818     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18819     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18820     MOVE X'2020233030303137313034' TO DFHEIV0(25:11)
 18821     CALL 'kxdfhei1' USING DFHEIV0,
 18822           DFHEIV1,
 18823           ELTRLR-KEY,
 18824           DFHEIV99,
 18825           DFHEIV11,
 18826           DFHEIV99
 18827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18828
 18829
 18830     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18831
 18832 7500-READ-NEXT.
 18833
 18834
 18835* EXEC CICS READNEXT
 18836*        DATASET   ('ELTRLR')
 18837*        RIDFLD    (ELTRLR-KEY)
 18838*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18839*    END-EXEC.
 18840     MOVE 'ELTRLR' TO DFHEIV1
 18841     MOVE 0
 18842       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 359
* EL156.cbl
 18843*    MOVE '&.S                   )   #00017114' TO DFHEIV0
 18844     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18845     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18846     MOVE X'2020233030303137313134' TO DFHEIV0(25:11)
 18847     CALL 'kxdfhei1' USING DFHEIV0,
 18848           DFHEIV1,
 18849           DFHEIV20,
 18850           DFHEIV99,
 18851           ELTRLR-KEY,
 18852           DFHEIV99,
 18853           DFHEIV11,
 18854           DFHEIV99,
 18855           DFHEIV99
 18856     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18857         DFHEIV20
 18858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18859
 18860
 18861     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18862        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18863        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18864        PI-CERT-NO    NOT = TRLR-CERT-NO
 18865         GO TO 7590-END.
 18866
 18867     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18868         GO TO 7500-READ-NEXT.
 18869
 18870     IF AT-TRAILER-TYPE NOT = '4'
 18871         GO TO 7500-READ-NEXT.
 18872
 18873     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18874         GO TO 7500-READ-NEXT.
 18875
 18876     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18877        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18878         GO TO 7500-READ-NEXT.
 18879
 18880     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18881        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18882        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18883         GO TO 7500-READ-NEXT.
 18884
 18885     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18886                         AND
 18887        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18888                         AND
 18889        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18890            GO TO 7500-READ-NEXT.
 18891
 18892     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18893
 18894
 18895* EXEC CICS ENDBR
 18896*        DATASET   ('ELTRLR')
 18897*    END-EXEC.
 18898     MOVE 'ELTRLR' TO DFHEIV1
 18899     MOVE 0
 18900       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 360
* EL156.cbl
 18901*    MOVE '&2                    $   #00017153' TO DFHEIV0
 18902     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18904     MOVE X'2020233030303137313533' TO DFHEIV0(25:11)
 18905     CALL 'kxdfhei1' USING DFHEIV0,
 18906           DFHEIV1,
 18907           DFHEIV11,
 18908           DFHEIV99
 18909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18910
 18911
 18912     MOVE 'N'                        TO  WS-BROWSE-SW.
 18913
 18914
 18915* EXEC CICS READ
 18916*        DATASET   ('ELTRLR')
 18917*        RIDFLD    (ELTRLR-KEY)
 18918*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18919*        UPDATE
 18920*    END-EXEC.
 18921     MOVE 'ELTRLR' TO DFHEIV1
 18922*    MOVE '&"S        EU         (   #00017159' TO DFHEIV0
 18923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18925     MOVE X'2020233030303137313539' TO DFHEIV0(25:11)
 18926     CALL 'kxdfhei1' USING DFHEIV0,
 18927           DFHEIV1,
 18928           DFHEIV20,
 18929           DFHEIV99,
 18930           ELTRLR-KEY,
 18931           DFHEIV99,
 18932           DFHEIV99,
 18933           DFHEIV99
 18934     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18935         DFHEIV20
 18936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18937
 18938
 18939     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18940
 18941     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18942         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18943     ELSE
 18944         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18945             NEXT SENTENCE
 18946         ELSE
 18947             GO TO 7500-REWRITE-TRLR.
 18948
 18949     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18950
 18951     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18952     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18953     MOVE '1'                        TO  ARCH-REC-TYPE.
 18954     MOVE +0                         TO  ARCH-SEQ.
 18955
 18956     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18957
 18958 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 361
* EL156.cbl
 18959
 18960
 18961* EXEC CICS REWRITE
 18962*        DATASET   ('ELTRLR')
 18963*        FROM      (ACTIVITY-TRAILERS)
 18964*    END-EXEC.
 18965     MOVE LENGTH OF
 18966      ACTIVITY-TRAILERS
 18967       TO DFHEIV11
 18968     MOVE 'ELTRLR' TO DFHEIV1
 18969*    MOVE '&& L                  %   #00017187' TO DFHEIV0
 18970     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18971     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18972     MOVE X'2020233030303137313837' TO DFHEIV0(25:11)
 18973     CALL 'kxdfhei1' USING DFHEIV0,
 18974           DFHEIV1,
 18975           ACTIVITY-TRAILERS,
 18976           DFHEIV11,
 18977           DFHEIV99
 18978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18979
 18980
 18981     GO TO 7500-STARTBR-TRLR.
 18982
 18983 7590-END.
 18984
 18985     IF WS-BROWSE-SW = 'Y'
 18986         MOVE 'N'                    TO  WS-BROWSE-SW
 18987
 18988* EXEC CICS ENDBR
 18989*            DATASET   ('ELTRLR')
 18990*        END-EXEC.
 18991     MOVE 'ELTRLR' TO DFHEIV1
 18992     MOVE 0
 18993       TO DFHEIV11
 18994*    MOVE '&2                    $   #00017198' TO DFHEIV0
 18995     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18996     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18997     MOVE X'2020233030303137313938' TO DFHEIV0(25:11)
 18998     CALL 'kxdfhei1' USING DFHEIV0,
 18999           DFHEIV1,
 19000           DFHEIV11,
 19001           DFHEIV99
 19002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19003
 19004
 19005 7599-EXIT.
 19006     EXIT.
 19007
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 362
* EL156.cbl
 19009 7600-READ-ARCH-UPDATE.
 19010
 19011
 19012* EXEC CICS HANDLE CONDITION
 19013*        NOTFND   (7699-EXIT)
 19014*    END-EXEC.
 19015*    MOVE '"$I                   ! > #00017208' TO DFHEIV0
 19016     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19018     MOVE X'3E20233030303137323038' TO DFHEIV0(25:11)
 19019     CALL 'kxdfhei1' USING DFHEIV0
 19020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19021
 19022
 19023
 19024* EXEC CICS READ
 19025*        DATASET   ('ELARCH')
 19026*        RIDFLD    (ELARCH-KEY)
 19027*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19028*        UPDATE
 19029*    END-EXEC.
 19030     MOVE 'ELARCH' TO DFHEIV1
 19031*    MOVE '&"S        EU         (   #00017212' TO DFHEIV0
 19032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19033     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19034     MOVE X'2020233030303137323132' TO DFHEIV0(25:11)
 19035     CALL 'kxdfhei1' USING DFHEIV0,
 19036           DFHEIV1,
 19037           DFHEIV20,
 19038           DFHEIV99,
 19039           ELARCH-KEY,
 19040           DFHEIV99,
 19041           DFHEIV99,
 19042           DFHEIV99
 19043     SET ADDRESS OF LETTER-ARCHIVE TO
 19044         DFHEIV20
 19045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19046
 19047
 19048     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19049
 19050
 19051* EXEC CICS REWRITE
 19052*        DATASET   ('ELARCH')
 19053*        FROM      (LETTER-ARCHIVE)
 19054*    END-EXEC.
 19055     MOVE LENGTH OF
 19056      LETTER-ARCHIVE
 19057       TO DFHEIV11
 19058     MOVE 'ELARCH' TO DFHEIV1
 19059*    MOVE '&& L                  %   #00017221' TO DFHEIV0
 19060     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19061     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19062     MOVE X'2020233030303137323231' TO DFHEIV0(25:11)
 19063     CALL 'kxdfhei1' USING DFHEIV0,
 19064           DFHEIV1,
 19065           LETTER-ARCHIVE,
 19066           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 363
* EL156.cbl
 19067           DFHEIV99
 19068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19069
 19070
 19071 7699-EXIT.
 19072     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 364
* EL156.cbl
 19074 7700-GET-DCT.
 19075
 19076     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19077     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19078     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19079     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19080                                    PI-MAX-BENEFIT-AMT
 19081                                    PI-MAX-BENEFIT-PYMT
 19082                                    PI-MIN-PAYMENT-AMT
 19083                                    PI-TIME-OF-LOSS-BAL.
 19084
 19085
 19086* EXEC CICS HANDLE CONDITION
 19087*         NOTFND (5300-NOTE-NOT-FOUND)
 19088*     END-EXEC.
 19089*    MOVE '"$I                   ! ? #00017240' TO DFHEIV0
 19090     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19092     MOVE X'3F20233030303137323430' TO DFHEIV0(25:11)
 19093     CALL 'kxdfhei1' USING DFHEIV0
 19094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19095
 19096
 19097
 19098* EXEC CICS READ
 19099*         DATASET('ERNOTE')
 19100*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19101*         RIDFLD (W-NOTE-KEY)
 19102*     END-EXEC.
 19103     MOVE 'ERNOTE' TO DFHEIV1
 19104*    MOVE '&"S        E          (   #00017244' TO DFHEIV0
 19105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19107     MOVE X'2020233030303137323434' TO DFHEIV0(25:11)
 19108     CALL 'kxdfhei1' USING DFHEIV0,
 19109           DFHEIV1,
 19110           DFHEIV20,
 19111           DFHEIV99,
 19112           W-NOTE-KEY,
 19113           DFHEIV99,
 19114           DFHEIV99,
 19115           DFHEIV99
 19116     SET ADDRESS OF CERTIFICATE-NOTE TO
 19117         DFHEIV20
 19118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19119
 19120
 19121     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19122     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19123     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19124     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19125     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19126
 19127     IF PI-PAYEE-TYPE NOT = 'B'
 19128         GO TO 7700-EXIT.
 19129
 19130     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19131     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 365
* EL156.cbl
 19132     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19133
 19134     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19135         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19136     ELSE
 19137         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19138
 19139     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19140     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19141     MOVE 'DLO006'               TO PGM-NAME.
 19142
 19143
 19144* EXEC CICS LINK
 19145*        PROGRAM    (PGM-NAME)
 19146*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19147*        LENGTH     (DCT-RCRD-LENGTH)
 19148*    END-EXEC.
 19149*    MOVE '."C                   (   #00017272' TO DFHEIV0
 19150     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19151     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19152     MOVE X'2020233030303137323732' TO DFHEIV0(25:11)
 19153     CALL 'kxdfhei1' USING DFHEIV0,
 19154           PGM-NAME,
 19155           DCT-COMMUNICATION-AREA,
 19156           DCT-RCRD-LENGTH,
 19157           DFHEIV99,
 19158           DFHEIV99,
 19159           DFHEIV99,
 19160           DFHEIV99
 19161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19162
 19163
 19164     IF DCT-RETURN-CODE = 'OK'
 19165         GO TO 7700-CONT.
 19166
 19167     IF DCT-RETURN-CODE = '01' OR '02'
 19168         GO TO 7700-SET-TO-YES.
 19169
 19170     IF DCT-RETURN-CODE = '03'
 19171
 19172* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19173*    MOVE '6"R                   !   #00017285' TO DFHEIV0
 19174     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19176     MOVE X'2020233030303137323835' TO DFHEIV0(25:11)
 19177     CALL 'kxdfhei1' USING DFHEIV0
 19178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19179         MOVE ER-0951            TO EMI-ERROR
 19180         MOVE -1                 TO PMTTYPEL
 19181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19182         GO TO 8200-SEND-DATAONLY.
 19183
 19184     IF DCT-RETURN-CODE = '04'
 19185
 19186* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19187*    MOVE '6"R                   !   #00017292' TO DFHEIV0
 19188     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 366
* EL156.cbl
 19190     MOVE X'2020233030303137323932' TO DFHEIV0(25:11)
 19191     CALL 'kxdfhei1' USING DFHEIV0
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19193         MOVE ER-0946            TO EMI-ERROR
 19194         MOVE -1                 TO PMTTYPEL
 19195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19196         GO TO 8200-SEND-DATAONLY.
 19197
 19198     IF DCT-RETURN-CODE = '05'
 19199
 19200* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19201*    MOVE '6"R                   !   #00017299' TO DFHEIV0
 19202     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19204     MOVE X'2020233030303137323939' TO DFHEIV0(25:11)
 19205     CALL 'kxdfhei1' USING DFHEIV0
 19206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19207         MOVE ER-0947            TO EMI-ERROR
 19208         MOVE -1                 TO PMTTYPEL
 19209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19210         GO TO 8200-SEND-DATAONLY.
 19211
 19212     IF DCT-RETURN-CODE = '06'
 19213
 19214* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19215*    MOVE '6"R                   !   #00017306' TO DFHEIV0
 19216     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19218     MOVE X'2020233030303137333036' TO DFHEIV0(25:11)
 19219     CALL 'kxdfhei1' USING DFHEIV0
 19220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19221         MOVE ER-0921            TO EMI-ERROR
 19222         MOVE -1                 TO PMTTYPEL
 19223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19224         GO TO 8200-SEND-DATAONLY.
 19225
 19226     IF DCT-RETURN-CODE = '07'
 19227
 19228* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19229*    MOVE '6"R                   !   #00017313' TO DFHEIV0
 19230     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19232     MOVE X'2020233030303137333133' TO DFHEIV0(25:11)
 19233     CALL 'kxdfhei1' USING DFHEIV0
 19234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19235         MOVE ER-0919            TO EMI-ERROR
 19236         MOVE -1                 TO PMTTYPEL
 19237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19238         GO TO 8200-SEND-DATAONLY.
 19239
 19240     IF DCT-RETURN-CODE = '08'
 19241
 19242* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19243*    MOVE '6"R                   !   #00017320' TO DFHEIV0
 19244     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19246     MOVE X'2020233030303137333230' TO DFHEIV0(25:11)
 19247     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 367
* EL156.cbl
 19248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19249         MOVE ER-0948            TO EMI-ERROR
 19250         MOVE -1                 TO PMTTYPEL
 19251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19252         GO TO 8200-SEND-DATAONLY.
 19253
 19254     IF DCT-RETURN-CODE = 'N1'
 19255
 19256* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19257*    MOVE '6"R                   !   #00017327' TO DFHEIV0
 19258     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19260     MOVE X'2020233030303137333237' TO DFHEIV0(25:11)
 19261     CALL 'kxdfhei1' USING DFHEIV0
 19262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19263         MOVE ER-0950            TO EMI-ERROR
 19264         MOVE -1                 TO PMTTYPEL
 19265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19266         GO TO 8200-SEND-DATAONLY.
 19267
 19268     IF DCT-RETURN-CODE = 'E1'
 19269
 19270* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19271*    MOVE '6"R                   !   #00017334' TO DFHEIV0
 19272     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19274     MOVE X'2020233030303137333334' TO DFHEIV0(25:11)
 19275     CALL 'kxdfhei1' USING DFHEIV0
 19276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19277         MOVE ER-0974            TO EMI-ERROR
 19278         MOVE -1                 TO PMTTYPEL
 19279         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19280         GO TO 8200-SEND-DATAONLY.
 19281
 19282     IF DCT-RETURN-CODE = 'E2'
 19283
 19284* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19285*    MOVE '6"R                   !   #00017341' TO DFHEIV0
 19286     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19288     MOVE X'2020233030303137333431' TO DFHEIV0(25:11)
 19289     CALL 'kxdfhei1' USING DFHEIV0
 19290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19291         MOVE ER-0975            TO EMI-ERROR
 19292         MOVE -1                 TO PMTTYPEL
 19293         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19294         GO TO 8200-SEND-DATAONLY.
 19295
 19296     IF DCT-RETURN-CODE NOT = 'OK'
 19297
 19298* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19299*    MOVE '6"R                   !   #00017348' TO DFHEIV0
 19300     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19302     MOVE X'2020233030303137333438' TO DFHEIV0(25:11)
 19303     CALL 'kxdfhei1' USING DFHEIV0
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19305         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 368
* EL156.cbl
 19306         MOVE -1                 TO PMTTYPEL
 19307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19308         GO TO 8200-SEND-DATAONLY.
 19309
 19310 7700-CONT.
 19311
 19312*    MOVE 'N'                    TO CASHO.
 19313*    MOVE +1                     TO CASHL.
 19314*    MOVE AL-UANON               TO CASHA.
 19315
 19316     IF PI-OFFLINE = 'Y'
 19317         GO TO 7700-EXIT.
 19318
 19319     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19320     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19321     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19322     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19323     MOVE +7                     TO CHECKNOL.
 19324     MOVE AL-UANON               TO CHECKNOA.
 19325     GO TO 7700-EXIT.
 19326
 19327 7700-SET-TO-YES.
 19328
 19329*    MOVE 'Y'                    TO CASHO.
 19330*    MOVE +1                     TO CASHL.
 19331*    MOVE AL-UANON               TO CASHA.
 19332
 19333 7700-EXIT.
 19334     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 369
* EL156.cbl
 19336 7800-READ-COMP-MSTR.
 19337
 19338
 19339* EXEC CICS HANDLE CONDITION
 19340*        NOTFND   (7800-COMP-NOTFND)
 19341*    END-EXEC.
 19342*    MOVE '"$I                   ! @ #00017382' TO DFHEIV0
 19343     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19345     MOVE X'4020233030303137333832' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0
 19347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19348
 19349
 19350
 19351* EXEC CICS READ
 19352*        DATASET   ('ERCOMP')
 19353*        RIDFLD    (ERCOMP-KEY)
 19354*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19355*    END-EXEC.
 19356     MOVE 'ERCOMP' TO DFHEIV1
 19357*    MOVE '&"S        E          (   #00017386' TO DFHEIV0
 19358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19360     MOVE X'2020233030303137333836' TO DFHEIV0(25:11)
 19361     CALL 'kxdfhei1' USING DFHEIV0,
 19362           DFHEIV1,
 19363           DFHEIV20,
 19364           DFHEIV99,
 19365           ERCOMP-KEY,
 19366           DFHEIV99,
 19367           DFHEIV99,
 19368           DFHEIV99
 19369     SET ADDRESS OF COMPENSATION-MASTER TO
 19370         DFHEIV20
 19371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19372
 19373
 19374     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19375     GO TO 7800-COMP-EXIT.
 19376
 19377 7800-COMP-NOTFND.
 19378     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19379
 19380 7800-COMP-EXIT.
 19381     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 370
* EL156.cbl
 19383 7900-READ-CLAIM.
 19384
 19385* EXEC CICS READ
 19386*        DATASET  ('ELMSTR')
 19387*        SET      (ADDRESS OF CLAIM-MASTER)
 19388*        RIDFLD   (ELMSTR-KEY)
 19389*    END-EXEC.
 19390     MOVE 'ELMSTR' TO DFHEIV1
 19391*    MOVE '&"S        E          (   #00017402' TO DFHEIV0
 19392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19394     MOVE X'2020233030303137343032' TO DFHEIV0(25:11)
 19395     CALL 'kxdfhei1' USING DFHEIV0,
 19396           DFHEIV1,
 19397           DFHEIV20,
 19398           DFHEIV99,
 19399           ELMSTR-KEY,
 19400           DFHEIV99,
 19401           DFHEIV99,
 19402           DFHEIV99
 19403     SET ADDRESS OF CLAIM-MASTER TO
 19404         DFHEIV20
 19405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19406
 19407
 19408 7900-EXIT.
 19409      EXIT.
 19410
 19411 7910-READ-CLAIM-UPDATE.
 19412
 19413* EXEC CICS READ
 19414*        DATASET  ('ELMSTR')
 19415*        SET      (ADDRESS OF CLAIM-MASTER)
 19416*        RIDFLD   (ELMSTR-KEY)
 19417*        UPDATE
 19418*    END-EXEC.
 19419     MOVE 'ELMSTR' TO DFHEIV1
 19420*    MOVE '&"S        EU         (   #00017412' TO DFHEIV0
 19421     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19422     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19423     MOVE X'2020233030303137343132' TO DFHEIV0(25:11)
 19424     CALL 'kxdfhei1' USING DFHEIV0,
 19425           DFHEIV1,
 19426           DFHEIV20,
 19427           DFHEIV99,
 19428           ELMSTR-KEY,
 19429           DFHEIV99,
 19430           DFHEIV99,
 19431           DFHEIV99
 19432     SET ADDRESS OF CLAIM-MASTER TO
 19433         DFHEIV20
 19434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19435
 19436
 19437 7910-EXIT.
 19438      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 371
* EL156.cbl
 19440 7920-READ-BENE.
 19441     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19442     MOVE 'B'                TO BENE-RECORD-TYPE.
 19443     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19444
 19445     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19446        IF PI-PAYEE-TYPE    = 'B' AND
 19447           PI-PAYEE-SEQ-NUM = 9
 19448             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19449             MOVE WS-A-BENE           TO BENE-NUMBER.
 19450
 19451
 19452* EXEC CICS HANDLE CONDITION
 19453*        NOTFND   (7920-NOT-FOUND)
 19454*    END-EXEC.
 19455*    MOVE '"$I                   ! A #00017433' TO DFHEIV0
 19456     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19458     MOVE X'4120233030303137343333' TO DFHEIV0(25:11)
 19459     CALL 'kxdfhei1' USING DFHEIV0
 19460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19461
 19462
 19463
 19464* EXEC CICS READ
 19465*        DATASET  ('ELBENE')
 19466*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19467*        RIDFLD   (ELBENE-KEY)
 19468*    END-EXEC.
 19469     MOVE 'ELBENE' TO DFHEIV1
 19470*    MOVE '&"S        E          (   #00017437' TO DFHEIV0
 19471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19473     MOVE X'2020233030303137343337' TO DFHEIV0(25:11)
 19474     CALL 'kxdfhei1' USING DFHEIV0,
 19475           DFHEIV1,
 19476           DFHEIV20,
 19477           DFHEIV99,
 19478           ELBENE-KEY,
 19479           DFHEIV99,
 19480           DFHEIV99,
 19481           DFHEIV99
 19482     SET ADDRESS OF BENEFICIARY-MASTER TO
 19483         DFHEIV20
 19484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19485
 19486
 19487     MOVE 'Y' TO BENE-FOUND-SW.
 19488     GO TO 7920-EXIT.
 19489
 19490 7920-NOT-FOUND.
 19491     MOVE 'N'                    TO BENE-FOUND-SW.
 19492
 19493 7920-EXIT.
 19494      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 372
* EL156.cbl
 19496 7930-READ-CONTROL.
 19497
 19498* EXEC CICS READ
 19499*        DATASET  ('ELCNTL')
 19500*        SET      (ADDRESS OF CONTROL-FILE)
 19501*        RIDFLD   (ELCNTL-KEY)
 19502*    END-EXEC.
 19503     MOVE 'ELCNTL' TO DFHEIV1
 19504*    MOVE '&"S        E          (   #00017453' TO DFHEIV0
 19505     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19507     MOVE X'2020233030303137343533' TO DFHEIV0(25:11)
 19508     CALL 'kxdfhei1' USING DFHEIV0,
 19509           DFHEIV1,
 19510           DFHEIV20,
 19511           DFHEIV99,
 19512           ELCNTL-KEY,
 19513           DFHEIV99,
 19514           DFHEIV99,
 19515           DFHEIV99
 19516     SET ADDRESS OF CONTROL-FILE TO
 19517         DFHEIV20
 19518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19519
 19520
 19521 7930-EXIT.
 19522      EXIT.
 19523
 19524 7940-READ-CONTROL-UPDATE.
 19525
 19526* EXEC CICS READ
 19527*        DATASET  ('ELCNTL')
 19528*        SET      (ADDRESS OF CONTROL-FILE)
 19529*        RIDFLD   (ELCNTL-KEY)
 19530*        UPDATE
 19531*    END-EXEC.
 19532     MOVE 'ELCNTL' TO DFHEIV1
 19533*    MOVE '&"S        EU         (   #00017463' TO DFHEIV0
 19534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19535     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19536     MOVE X'2020233030303137343633' TO DFHEIV0(25:11)
 19537     CALL 'kxdfhei1' USING DFHEIV0,
 19538           DFHEIV1,
 19539           DFHEIV20,
 19540           DFHEIV99,
 19541           ELCNTL-KEY,
 19542           DFHEIV99,
 19543           DFHEIV99,
 19544           DFHEIV99
 19545     SET ADDRESS OF CONTROL-FILE TO
 19546         DFHEIV20
 19547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19548
 19549
 19550 7940-EXIT.
 19551      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 373
* EL156.cbl
 19553 7950-READ-TRAILER.
 19554
 19555* EXEC CICS READ
 19556*        DATASET  ('ELTRLR')
 19557*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19558*        RIDFLD   (ELTRLR-KEY)
 19559*    END-EXEC.
 19560     MOVE 'ELTRLR' TO DFHEIV1
 19561*    MOVE '&"S        E          (   #00017474' TO DFHEIV0
 19562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19564     MOVE X'2020233030303137343734' TO DFHEIV0(25:11)
 19565     CALL 'kxdfhei1' USING DFHEIV0,
 19566           DFHEIV1,
 19567           DFHEIV20,
 19568           DFHEIV99,
 19569           ELTRLR-KEY,
 19570           DFHEIV99,
 19571           DFHEIV99,
 19572           DFHEIV99
 19573     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19574         DFHEIV20
 19575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19576
 19577
 19578 7950-EXIT.
 19579      EXIT.
 19580
 19581 7960-READ-TRAILER-UPDATE.
 19582
 19583* EXEC CICS READ
 19584*        DATASET  ('ELTRLR')
 19585*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19586*        RIDFLD   (ELTRLR-KEY)
 19587*        UPDATE
 19588*    END-EXEC.
 19589     MOVE 'ELTRLR' TO DFHEIV1
 19590*    MOVE '&"S        EU         (   #00017484' TO DFHEIV0
 19591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19593     MOVE X'2020233030303137343834' TO DFHEIV0(25:11)
 19594     CALL 'kxdfhei1' USING DFHEIV0,
 19595           DFHEIV1,
 19596           DFHEIV20,
 19597           DFHEIV99,
 19598           ELTRLR-KEY,
 19599           DFHEIV99,
 19600           DFHEIV99,
 19601           DFHEIV99
 19602     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19603         DFHEIV20
 19604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19605
 19606
 19607 7960-EXIT.
 19608      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 374
* EL156.cbl
 19610 7970-READ-CERT.
 19611
 19612* EXEC CICS READ
 19613*        DATASET  ('ELCERT')
 19614*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19615*        RIDFLD   (ELCERT-KEY)
 19616*    END-EXEC.
 19617     MOVE 'ELCERT' TO DFHEIV1
 19618*    MOVE '&"S        E          (   #00017495' TO DFHEIV0
 19619     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19620     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19621     MOVE X'2020233030303137343935' TO DFHEIV0(25:11)
 19622     CALL 'kxdfhei1' USING DFHEIV0,
 19623           DFHEIV1,
 19624           DFHEIV20,
 19625           DFHEIV99,
 19626           ELCERT-KEY,
 19627           DFHEIV99,
 19628           DFHEIV99,
 19629           DFHEIV99
 19630     SET ADDRESS OF CERTIFICATE-MASTER TO
 19631         DFHEIV20
 19632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19633
 19634
 19635 7970-EXIT.
 19636      EXIT.
 19637 7975-read-acct.
 19638
 19639     move spaces              to WS-ACCT-RECORD-SW
 19640                                 pi-dcc-product-code
 19641
 19642     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19643     MOVE PI-CARRIER          TO ACCT-CARRIER
 19644     MOVE PI-GROUPING         TO ACCT-GROUPING
 19645     MOVE PI-STATE            TO ACCT-STATE
 19646     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19647     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19648     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19649     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19650
 19651
 19652* EXEC CICS READ
 19653*       DATASET ('ERACCT')
 19654*       RIDFLD  (ERACCT-KEY)
 19655*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19656*       GTEQ
 19657*       resp    (WS-RESPONSE)
 19658*    END-EXEC
 19659     MOVE 'ERACCT' TO DFHEIV1
 19660*    MOVE '&"S        G          (  N#00017517' TO DFHEIV0
 19661     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19663     MOVE X'204E233030303137353137' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           DFHEIV1,
 19666           DFHEIV20,
 19667           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 375
* EL156.cbl
 19668           ERACCT-KEY,
 19669           DFHEIV99,
 19670           DFHEIV99,
 19671           DFHEIV99
 19672     SET ADDRESS OF ACCOUNT-MASTER TO
 19673         DFHEIV20
 19674     MOVE EIBRESP  TO WS-RESPONSE
 19675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19676     IF WS-RESP-NORMAL
 19677        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19678        and pi-cert-eff-dt < am-expiration-dt
 19679        and pi-cert-eff-dt >= am-effective-dt
 19680        move am-dcc-product-code to pi-dcc-product-code
 19681        set acct-found to true
 19682     end-if
 19683
 19684     .
 19685 7975-exit.
 19686     exit.
 19687 7980-READ-CERT-UPDATE.
 19688
 19689* EXEC CICS READ
 19690*        DATASET  ('ELCERT')
 19691*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19692*        RIDFLD   (ELCERT-KEY)
 19693*        UPDATE
 19694*    END-EXEC.
 19695     MOVE 'ELCERT' TO DFHEIV1
 19696*    MOVE '&"S        EU         (   #00017536' TO DFHEIV0
 19697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19698     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19699     MOVE X'2020233030303137353336' TO DFHEIV0(25:11)
 19700     CALL 'kxdfhei1' USING DFHEIV0,
 19701           DFHEIV1,
 19702           DFHEIV20,
 19703           DFHEIV99,
 19704           ELCERT-KEY,
 19705           DFHEIV99,
 19706           DFHEIV99,
 19707           DFHEIV99
 19708     SET ADDRESS OF CERTIFICATE-MASTER TO
 19709         DFHEIV20
 19710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19711
 19712
 19713 7980-EXIT.
 19714      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 376
* EL156.cbl
 19716 8000-LOAD-ERROR-MESSAGES.
 19717     IF PI-PASS-SW = 'C'
 19718        MOVE EMI-LINE1           TO ERMSG1BO
 19719     ELSE
 19720        MOVE EMI-LINE1           TO ERRMSG1O
 19721        MOVE EMI-LINE2           TO ERRMSG2O.
 19722
 19723 8000-EXIT.
 19724     EXIT.
 19725
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 377
* EL156.cbl
 19727
 19728 8010-DMD-ERROR-CHECKS.
 19729     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19730
 19731     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19732         GO TO 8051-ISSUE-ERROR.
 19733
 19734     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19735     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19736     MOVE '3'                    TO DC-OPTION-CODE.
 19737     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19738     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19739         GO TO 8051-ISSUE-ERROR.
 19740
 19741     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19742       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19743                           OR
 19744          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19745           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19746             MOVE ER-0851         TO EMI-ERROR
 19747             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19748       END-IF
 19749       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19750             MOVE ER-8147         TO EMI-ERROR
 19751             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19752
 19753     GO TO 8090-EXIT.
 19754
 19755 8051-ISSUE-ERROR.
 19756     MOVE ER-8146            TO EMI-ERROR.
 19757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19758     GO TO 8090-EXIT.
 19759
 19760 8090-EXIT.
 19761      EXIT.
 19762
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 378
* EL156.cbl
 19764 8100-SEND-INITIAL-MAP.
 19765
 19766     MOVE SAVE-DATE              TO RUNDTEAO.
 19767     MOVE EIBTIME                TO TIME-IN.
 19768     MOVE TIME-OUT               TO RUNTIMAO.
 19769     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19770
 19771     IF MAP-NAME = 'EL156A'
 19772        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19773           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19774        END-IF
 19775        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 19776           MOVE 'N'     TO SURVYYNO
 19777        END-IF
 19778     END-IF
 19779*    IF MAP-NAME = 'EL156A'
 19780*       IF PI-COMPANY-ID = 'CRI'
 19781*          NEXT SENTENCE
 19782*       ELSE
 19783*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19784
 19785     IF MAP-NAME = 'EL156A'
 19786        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19787           NEXT SENTENCE
 19788        ELSE
 19789           MOVE AL-SADOF TO  PINTA    PINTHA.
 19790
 19791     IF MAP-NAME = 'EL156A'
 19792        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19793            NEXT SENTENCE
 19794        ELSE
 19795           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19796
 19797*    IF MAP-NAME = 'EL156A'
 19798*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19799*          NEXT SENTENCE
 19800*       ELSE
 19801*          MOVE AL-SADOF TO CASHHA CASHA.
 19802
 19803     IF MAP-NAME = 'EL156A'
 19804        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19805                        or 'CAP'
 19806           NEXT SENTENCE
 19807        ELSE
 19808           MOVE AL-SADOF        TO  LOANHA
 19809                                    LOANNOA.
 19810
 19811     IF MAP-NAME = 'EL156A'
 19812        MOVE -1                 TO  ENTERPFL
 19813        IF PI-USES-PAID-TO
 19814           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19815           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19816           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19817        ELSE
 19818           NEXT SENTENCE
 19819     ELSE
 19820        IF MAP-NAME = 'EL156B'
 19821           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 379
* EL156.cbl
 19822              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19823              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19824
 19825
 19826* EXEC CICS SEND
 19827*        MAP   (MAP-NAME)
 19828*        MAPSET(MAPSET-NAME)
 19829*        FROM  (EL156AI)
 19830*        ERASE
 19831*        CURSOR
 19832*    END-EXEC.
 19833     MOVE LENGTH OF
 19834      EL156AI
 19835       TO DFHEIV12
 19836     MOVE -1
 19837       TO DFHEIV11
 19838*    MOVE '8$     CT  E    H L F ,   #00017655' TO DFHEIV0
 19839     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19840     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303137363535' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           MAP-NAME,
 19844           EL156AI,
 19845           DFHEIV12,
 19846           MAPSET-NAME,
 19847           DFHEIV99,
 19848           DFHEIV99,
 19849           DFHEIV99,
 19850           DFHEIV11,
 19851           DFHEIV99,
 19852           DFHEIV99,
 19853           DFHEIV99
 19854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19855
 19856
 19857     GO TO 9100-RETURN-TRAN.
 19858
 19859 8200-SEND-DATAONLY.
 19860
 19861     IF FIRST-ENTRY = 'Y'
 19862         GO TO 8100-SEND-INITIAL-MAP.
 19863
 19864     IF RETURNED-FROM-B = 'Y'
 19865         GO TO 8100-SEND-INITIAL-MAP.
 19866
 19867     MOVE SAVE-DATE              TO RUNDTEAO.
 19868     MOVE EIBTIME                TO TIME-IN.
 19869     MOVE TIME-OUT               TO RUNTIMAO.
 19870
 19871     IF EIBAID = DFHPF11
 19872        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19874        MOVE 'EL001   '          TO RETURNED-FROM
 19875        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19876        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19877        GO TO 8100-SEND-INITIAL-MAP.
 19878
 19879     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 380
* EL156.cbl
 19880
 19881     IF MAP-NAME =  'EL156A'
 19882        MOVE -1                 TO  ENTERPFL
 19883        IF PI-USES-PAID-TO
 19884           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19885           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19886           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19887        ELSE
 19888           NEXT SENTENCE
 19889     ELSE
 19890        IF MAP-NAME = 'EL156B'
 19891           IF PI-USES-PAID-TO
 19892              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19893              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19894
 19895     IF MAP-NAME =  'EL156A'
 19896        IF PI-COMPANY-ID = 'BOA'
 19897            IF PI-INT-RATE NUMERIC
 19898                MOVE PI-INT-RATE TO PINTO.
 19899     IF MAP-NAME = 'EL156A'
 19900        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19901           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19902*          MOVE 'Y'              TO EOBYNO
 19903        END-IF
 19904     END-IF
 19905
 19906
 19907* EXEC CICS SEND
 19908*        MAP   (MAP-NAME)
 19909*        MAPSET(MAPSET-NAME)
 19910*        FROM  (EL156AI)
 19911*        DATAONLY
 19912*        CURSOR
 19913*    END-EXEC.
 19914     MOVE LENGTH OF
 19915      EL156AI
 19916       TO DFHEIV12
 19917     MOVE -1
 19918       TO DFHEIV11
 19919*    MOVE '8$D    CT       H L F ,   #00017712' TO DFHEIV0
 19920     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19921     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19922     MOVE X'2020233030303137373132' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0,
 19924           MAP-NAME,
 19925           EL156AI,
 19926           DFHEIV12,
 19927           MAPSET-NAME,
 19928           DFHEIV99,
 19929           DFHEIV99,
 19930           DFHEIV99,
 19931           DFHEIV11,
 19932           DFHEIV99,
 19933           DFHEIV99,
 19934           DFHEIV99
 19935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19936
 19937
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 381
* EL156.cbl
 19938     GO TO 9100-RETURN-TRAN.
 19939
 19940 8300-SEND-TEXT.
 19941
 19942* EXEC CICS SEND TEXT
 19943*        FROM(LOGOFF-TEXT)
 19944*        LENGTH(LOGOFF-LENGTH)
 19945*        ERASE
 19946*        FREEKB
 19947*    END-EXEC.
 19948*    MOVE '8&      T  E F  H   F -   #00017723' TO DFHEIV0
 19949     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19950     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19951     MOVE X'2020233030303137373233' TO DFHEIV0(25:11)
 19952     CALL 'kxdfhei1' USING DFHEIV0,
 19953           LOGOFF-TEXT,
 19954           LOGOFF-LENGTH,
 19955           DFHEIV99,
 19956           DFHEIV99,
 19957           DFHEIV99,
 19958           DFHEIV99,
 19959           DFHEIV99,
 19960           DFHEIV99,
 19961           DFHEIV99,
 19962           DFHEIV99,
 19963           DFHEIV99,
 19964           DFHEIV99
 19965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19966
 19967
 19968
 19969* EXEC CICS RETURN
 19970*    END-EXEC.
 19971*    MOVE '.(                    ''   #00017730' TO DFHEIV0
 19972     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19973     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19974     MOVE X'2020233030303137373330' TO DFHEIV0(25:11)
 19975     CALL 'kxdfhei1' USING DFHEIV0,
 19976           DFHEIV99,
 19977           DFHEIV99,
 19978           DFHEIV99,
 19979           DFHEIV99,
 19980           DFHEIV99,
 19981           DFHEIV99
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985 8500-FILE-NOTOPEN.
 19986     IF FILE-SWITCH = 'MSTR'
 19987         MOVE ER-0154            TO EMI-ERROR.
 19988     IF FILE-SWITCH = 'TRLR'
 19989         MOVE ER-0172            TO EMI-ERROR.
 19990     IF FILE-SWITCH = 'CERT'
 19991         MOVE ER-0169            TO EMI-ERROR.
 19992     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19993                      'PROC' OR 'STAT'
 19994         MOVE ER-0042            TO EMI-ERROR.
 19995     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 382
* EL156.cbl
 19996         MOVE ER-0338            TO EMI-ERROR.
 19997     IF FILE-SWITCH = 'ACCT'
 19998         MOVE ER-0168            TO EMI-ERROR.
 19999
 20000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20001     MOVE -1                     TO PMTTYPEL.
 20002
 20003     IF FIRST-ENTRY = 'Y'
 20004         GO TO 8100-SEND-INITIAL-MAP.
 20005
 20006     GO TO 8200-SEND-DATAONLY.
 20007
 20008 8600-PGRM-NOT-FOUND.
 20009
 20010     MOVE ER-0923                TO EMI-ERROR.
 20011     MOVE -1                     TO ENTPFBL.
 20012     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20013
 20014     IF FIRST-ENTRY = 'Y'
 20015         GO TO 8100-SEND-INITIAL-MAP
 20016     ELSE
 20017         GO TO 8200-SEND-DATAONLY.
 20018
 20019 8800-UNAUTHORIZED-ACCESS.
 20020     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20021     GO TO 8300-SEND-TEXT.
 20022
 20023 8810-PF23.
 20024     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20025     MOVE XCTL-005               TO PGM-NAME.
 20026     GO TO 9300-XCTL.
 20027
 20028 8820-PF7-8.
 20029     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20030     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20031                                    PI-SAVED-PROGRAM-2
 20032                                    PI-SAVED-PROGRAM-3
 20033                                    PI-SAVED-PROGRAM-4
 20034                                    PI-SAVED-PROGRAM-5
 20035                                    PI-SAVED-PROGRAM-6
 20036                                    PI-RETURN-TO-PROGRAM.
 20037     IF EIBAID = DFHPF8
 20038        MOVE XCTL-132            TO PGM-NAME
 20039     ELSE
 20040        MOVE XCTL-130            TO PGM-NAME.
 20041
 20042     GO TO 9300-XCTL.
 20043
 20044 9100-RETURN-TRAN.
 20045     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20046     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20047
 20048
 20049* EXEC CICS RETURN
 20050*        TRANSID(TRANS-ID)
 20051*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20052*        LENGTH(PI-COMM-LENGTH)
 20053*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 383
* EL156.cbl
 20054*    MOVE '.(CT                  ''   #00017796' TO DFHEIV0
 20055     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20056     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20057     MOVE X'2020233030303137373936' TO DFHEIV0(25:11)
 20058     CALL 'kxdfhei1' USING DFHEIV0,
 20059           TRANS-ID,
 20060           PROGRAM-INTERFACE-BLOCK,
 20061           PI-COMM-LENGTH,
 20062           DFHEIV99,
 20063           DFHEIV99,
 20064           DFHEIV99
 20065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20066
 20067
 20068 9200-RETURN-MAIN-MENU.
 20069     MOVE XCTL-126               TO PGM-NAME.
 20070     GO TO 9300-XCTL.
 20071
 20072 9300-XCTL.
 20073
 20074* EXEC CICS XCTL
 20075*        PROGRAM(PGM-NAME)
 20076*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20077*        LENGTH(PI-COMM-LENGTH)
 20078*    END-EXEC.
 20079*    MOVE '.$C                   %   #00017807' TO DFHEIV0
 20080     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20081     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20082     MOVE X'2020233030303137383037' TO DFHEIV0(25:11)
 20083     CALL 'kxdfhei1' USING DFHEIV0,
 20084           PGM-NAME,
 20085           PROGRAM-INTERFACE-BLOCK,
 20086           PI-COMM-LENGTH,
 20087           DFHEIV99
 20088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20089
 20090
 20091 9400-CLEAR.
 20092     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20093     GO TO 9300-XCTL.
 20094
 20095 9500-PF12.
 20096     MOVE XCTL-010               TO PGM-NAME.
 20097     GO TO 9300-XCTL.
 20098
 20099 9700-LINK-DATE-CONVERT.
 20100     MOVE LINK-ELDATCV           TO PGM-NAME.
 20101
 20102* EXEC CICS LINK
 20103*        PROGRAM   (PGM-NAME)
 20104*        COMMAREA  (DATE-CONVERSION-DATA)
 20105*        LENGTH    (DC-COMM-LENGTH)
 20106*    END-EXEC.
 20107*    MOVE '."C                   (   #00017823' TO DFHEIV0
 20108     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20110     MOVE X'2020233030303137383233' TO DFHEIV0(25:11)
 20111     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 384
* EL156.cbl
 20112           PGM-NAME,
 20113           DATE-CONVERSION-DATA,
 20114           DC-COMM-LENGTH,
 20115           DFHEIV99,
 20116           DFHEIV99,
 20117           DFHEIV99,
 20118           DFHEIV99
 20119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20120
 20121
 20122 9700-EXIT.
 20123     EXIT.
 20124
 20125 9800-LINK-REM-TERM.
 20126     MOVE LINK-REMTERM TO PGM-NAME.
 20127
 20128
 20129* EXEC CICS LINK
 20130*        PROGRAM   (PGM-NAME)
 20131*        COMMAREA  (CALCULATION-PASS-AREA)
 20132*        LENGTH    (CP-COMM-LENGTH)
 20133*    END-EXEC.
 20134*    MOVE '."C                   (   #00017835' TO DFHEIV0
 20135     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20137     MOVE X'2020233030303137383335' TO DFHEIV0(25:11)
 20138     CALL 'kxdfhei1' USING DFHEIV0,
 20139           PGM-NAME,
 20140           CALCULATION-PASS-AREA,
 20141           CP-COMM-LENGTH,
 20142           DFHEIV99,
 20143           DFHEIV99,
 20144           DFHEIV99,
 20145           DFHEIV99
 20146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20147
 20148
 20149 9800-EXIT.
 20150     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 385
* EL156.cbl
 20152 9830-DMD-REMAINING-TERM.
 20153
 20154     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20155         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20156
 20157     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20158                              CM-PMT-EXTENSION-DAYS.
 20159
 20160     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20161                                  CL-NO-OF-DAYS-PAID.
 20162
 20163     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20164         GIVING W-REM REMAINDER W-REM-DAYS.
 20165
 20166     MOVE W-REM                  TO WST-REM.
 20167
 20168     IF W-REM-DAYS > ZEROS
 20169         MOVE '/'                TO WST-SLASH
 20170         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20171     ELSE
 20172         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20173
 20174 9830-EXIT.
 20175     EXIT.
 20176
 20177 9870-OUTPUT-ACTIVITY-RECORD.
 20178
 20179
 20180* EXEC CICS GETMAIN
 20181*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20182*         LENGTH(25)
 20183*         INITIMG(WS-BLANK)
 20184*    END-EXEC.
 20185     MOVE 25
 20186       TO DFHEIV11
 20187*    MOVE ',"IL                  $   #00017871' TO DFHEIV0
 20188     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20189     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20190     MOVE X'2020233030303137383731' TO DFHEIV0(25:11)
 20191     CALL 'kxdfhei1' USING DFHEIV0,
 20192           DFHEIV20,
 20193           DFHEIV11,
 20194           WS-BLANK
 20195     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20196         DFHEIV20
 20197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20198
 20199
 20200     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20201     MOVE ELMSTR-KEY             TO DA-KEY.
 20202     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20203
 20204     IF PI-PMTTYPE EQUAL '7'
 20205         MOVE 'V'                TO DA-RECORD-TYPE
 20206     ELSE
 20207         MOVE 'P'                TO DA-RECORD-TYPE.
 20208
 20209
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 386
* EL156.cbl
 20210* EXEC CICS HANDLE CONDITION
 20211*         NOTOPEN(9870-NOTOPEN)
 20212*         DUPREC(9870-EXIT)
 20213*    END-EXEC.
 20214*    MOVE '"$J%                  ! B #00017886' TO DFHEIV0
 20215     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20217     MOVE X'4220233030303137383836' TO DFHEIV0(25:11)
 20218     CALL 'kxdfhei1' USING DFHEIV0
 20219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20220
 20221
 20222
 20223* EXEC CICS WRITE
 20224*         DATASET('DLYACTV')
 20225*         RIDFLD(DA-KEY)
 20226*         FROM(DAILY-ACTIVITY-RECORD)
 20227*         LENGTH(25)
 20228*    END-EXEC.
 20229     MOVE 'DLYACTV' TO DFHEIV1
 20230     MOVE 25
 20231       TO DFHEIV11
 20232*    MOVE '&$ L                  ''   #00017891' TO DFHEIV0
 20233     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20234     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20235     MOVE X'2020233030303137383931' TO DFHEIV0(25:11)
 20236     CALL 'kxdfhei1' USING DFHEIV0,
 20237           DFHEIV1,
 20238           DAILY-ACTIVITY-RECORD,
 20239           DFHEIV11,
 20240           DA-KEY,
 20241           DFHEIV99,
 20242           DFHEIV99
 20243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20244
 20245     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20246     GO TO 9870-EXIT.
 20247
 20248 9870-NOTOPEN.
 20249
 20250     MOVE '2955'                 TO EMI-ERROR.
 20251     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20252
 20253 9870-EXIT.
 20254     EXIT.
 20255
 20256 9900-ERROR-FORMAT.
 20257
 20258     IF EMI-ERROR = ER-0923
 20259         MOVE PGM-NAME           TO W-CALLED-NAME.
 20260
 20261     MOVE LINK-001      TO PGM-NAME.
 20262     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20263
 20264
 20265* EXEC CICS LINK
 20266*        PROGRAM (PGM-NAME)
 20267*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 387
* EL156.cbl
 20268*        LENGTH  (EMI-COMM-LENGTH)
 20269*    END-EXEC.
 20270*    MOVE '."C                   (   #00017916' TO DFHEIV0
 20271     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20273     MOVE X'2020233030303137393136' TO DFHEIV0(25:11)
 20274     CALL 'kxdfhei1' USING DFHEIV0,
 20275           PGM-NAME,
 20276           ERROR-MESSAGE-INTERFACE-BLOCK,
 20277           EMI-COMM-LENGTH,
 20278           DFHEIV99,
 20279           DFHEIV99,
 20280           DFHEIV99,
 20281           DFHEIV99
 20282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20283
 20284
 20285     IF EMI-ERROR = ER-0923
 20286         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20287
 20288 9900-EXIT.
 20289     EXIT.
 20290
 20291 9990-ABEND.
 20292     MOVE LINK-004               TO PGM-NAME.
 20293     MOVE DFHEIBLK               TO EMI-LINE1.
 20294
 20295* EXEC CICS LINK
 20296*        PROGRAM   (PGM-NAME)
 20297*        COMMAREA  (EMI-LINE1)
 20298*        LENGTH    (64)
 20299*    END-EXEC.
 20300     MOVE 64
 20301       TO DFHEIV11
 20302*    MOVE '."C                   (   #00017931' TO DFHEIV0
 20303     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20305     MOVE X'2020233030303137393331' TO DFHEIV0(25:11)
 20306     CALL 'kxdfhei1' USING DFHEIV0,
 20307           PGM-NAME,
 20308           EMI-LINE1,
 20309           DFHEIV11,
 20310           DFHEIV99,
 20311           DFHEIV99,
 20312           DFHEIV99,
 20313           DFHEIV99
 20314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20315
 20316
 20317     MOVE 'EL156A'               TO  MAP-NAME.
 20318     MOVE LOW-VALUES             TO  EL156AO.
 20319     GO TO 8100-SEND-INITIAL-MAP.
 20320
 20321 9995-SECURITY-VIOLATION.
 20322*    COPY ELCSCTP.
 20323******************************************************************
 20324*                                                                *
 20325*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 388
* EL156.cbl
 20326*                            VMOD=2.001                          *
 20327*                                                                *
 20328*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20329******************************************************************
 20330
 20331
 20332     MOVE EIBDATE          TO SM-JUL-DATE.
 20333     MOVE EIBTRMID         TO SM-TERMID.
 20334     MOVE THIS-PGM         TO SM-PGM.
 20335     MOVE EIBTIME          TO TIME-IN.
 20336     MOVE TIME-OUT         TO SM-TIME.
 20337     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20338
 20339
 20340* EXEC CICS LINK
 20341*         PROGRAM  ('EL003')
 20342*         COMMAREA (SECURITY-MESSAGE)
 20343*         LENGTH   (80)
 20344*    END-EXEC.
 20345     MOVE 'EL003' TO DFHEIV1
 20346     MOVE 80
 20347       TO DFHEIV11
 20348*    MOVE '."C                   (   #00017959' TO DFHEIV0
 20349     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20351     MOVE X'2020233030303137393539' TO DFHEIV0(25:11)
 20352     CALL 'kxdfhei1' USING DFHEIV0,
 20353           DFHEIV1,
 20354           SECURITY-MESSAGE,
 20355           DFHEIV11,
 20356           DFHEIV99,
 20357           DFHEIV99,
 20358           DFHEIV99,
 20359           DFHEIV99
 20360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20361
 20362
 20363******************************************************************
 20364
 20365
 20366
 20367 9999-DFHBACK SECTION.
 20368     MOVE '9%                    "   ' TO DFHEIV0
 20369     MOVE 'EL156' TO DFHEIV1
 20370     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20371     GOBACK.
 20372 9999-DFHEXIT.
 20373     IF DFHEIGDJ EQUAL 0001
 20374         NEXT SENTENCE
 20375     ELSE IF DFHEIGDJ EQUAL 2
 20376         GO TO 9990-ABEND,
 20377               8600-PGRM-NOT-FOUND,
 20378               0400-FIRST-TIME,
 20379               6180-DUPREC,
 20380               9990-ABEND
 20381         DEPENDING ON DFHEIGDI
 20382     ELSE IF DFHEIGDJ EQUAL 3
 20383         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 389
* EL156.cbl
 20384               0380-CLAIM-END-FILE
 20385         DEPENDING ON DFHEIGDI
 20386     ELSE IF DFHEIGDJ EQUAL 4
 20387         GO TO 0380-CLAIM-END-FILE,
 20388               0380-CLAIM-END-FILE
 20389         DEPENDING ON DFHEIGDI
 20390     ELSE IF DFHEIGDJ EQUAL 5
 20391         GO TO 0800-EXIT
 20392         DEPENDING ON DFHEIGDI
 20393     ELSE IF DFHEIGDJ EQUAL 6
 20394         GO TO 1950-NOT-FOUND,
 20395               1950-NOT-FOUND
 20396         DEPENDING ON DFHEIGDI
 20397     ELSE IF DFHEIGDJ EQUAL 7
 20398         GO TO 1950-NOT-FOUND
 20399         DEPENDING ON DFHEIGDI
 20400     ELSE IF DFHEIGDJ EQUAL 8
 20401         GO TO 1950-NOT-FOUND,
 20402               1950-NOT-FOUND
 20403         DEPENDING ON DFHEIGDI
 20404     ELSE IF DFHEIGDJ EQUAL 9
 20405         GO TO 1166-END-CHECK,
 20406               1166-END-CHECK
 20407         DEPENDING ON DFHEIGDI
 20408     ELSE IF DFHEIGDJ EQUAL 10
 20409         GO TO 1950-NOT-FOUND,
 20410               1950-NOT-FOUND
 20411         DEPENDING ON DFHEIGDI
 20412     ELSE IF DFHEIGDJ EQUAL 11
 20413         GO TO 1950-NOT-FOUND,
 20414               1950-NOT-FOUND
 20415         DEPENDING ON DFHEIGDI
 20416     ELSE IF DFHEIGDJ EQUAL 12
 20417         GO TO 1950-NOT-FOUND
 20418         DEPENDING ON DFHEIGDI
 20419     ELSE IF DFHEIGDJ EQUAL 13
 20420         GO TO 3600-CONTINUE
 20421         DEPENDING ON DFHEIGDI
 20422     ELSE IF DFHEIGDJ EQUAL 14
 20423         GO TO 5300-NOTE-NOT-FOUND
 20424         DEPENDING ON DFHEIGDI
 20425     ELSE IF DFHEIGDJ EQUAL 15
 20426         GO TO 6065-NOT-FOUND
 20427         DEPENDING ON DFHEIGDI
 20428     ELSE IF DFHEIGDJ EQUAL 16
 20429         GO TO 6068-ACCT-NOT-FND
 20430         DEPENDING ON DFHEIGDI
 20431     ELSE IF DFHEIGDJ EQUAL 17
 20432         GO TO 6074-GET-COMP-DATA
 20433         DEPENDING ON DFHEIGDI
 20434     ELSE IF DFHEIGDJ EQUAL 18
 20435         GO TO 6170-WRITE
 20436         DEPENDING ON DFHEIGDI
 20437     ELSE IF DFHEIGDJ EQUAL 19
 20438         GO TO 6180-DUPREC
 20439         DEPENDING ON DFHEIGDI
 20440     ELSE IF DFHEIGDJ EQUAL 20
 20441         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 06-May-16 09:19 Page 390
* EL156.cbl
 20442         DEPENDING ON DFHEIGDI
 20443     ELSE IF DFHEIGDJ EQUAL 21
 20444         GO TO 6185-DUPREC
 20445         DEPENDING ON DFHEIGDI
 20446     ELSE IF DFHEIGDJ EQUAL 22
 20447         GO TO 6720-BUILD-NEW-RECORD
 20448         DEPENDING ON DFHEIGDI
 20449     ELSE IF DFHEIGDJ EQUAL 23
 20450         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20451               6900-BUILD-ARCHIVE-HEADER
 20452         DEPENDING ON DFHEIGDI
 20453     ELSE IF DFHEIGDJ EQUAL 24
 20454         GO TO 7010-BUILD-MAP
 20455         DEPENDING ON DFHEIGDI
 20456     ELSE IF DFHEIGDJ EQUAL 25
 20457         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20458         DEPENDING ON DFHEIGDI
 20459     ELSE IF DFHEIGDJ EQUAL 26
 20460         GO TO 7160-DUPREC
 20461         DEPENDING ON DFHEIGDI
 20462     ELSE IF DFHEIGDJ EQUAL 27
 20463         GO TO 7200-EXIT,
 20464               7200-EXIT
 20465         DEPENDING ON DFHEIGDI
 20466     ELSE IF DFHEIGDJ EQUAL 28
 20467         GO TO 7400-NOT-FOUND
 20468         DEPENDING ON DFHEIGDI
 20469     ELSE IF DFHEIGDJ EQUAL 29
 20470         GO TO 7590-END,
 20471               7590-END
 20472         DEPENDING ON DFHEIGDI
 20473     ELSE IF DFHEIGDJ EQUAL 30
 20474         GO TO 7699-EXIT
 20475         DEPENDING ON DFHEIGDI
 20476     ELSE IF DFHEIGDJ EQUAL 31
 20477         GO TO 5300-NOTE-NOT-FOUND
 20478         DEPENDING ON DFHEIGDI
 20479     ELSE IF DFHEIGDJ EQUAL 32
 20480         GO TO 7800-COMP-NOTFND
 20481         DEPENDING ON DFHEIGDI
 20482     ELSE IF DFHEIGDJ EQUAL 33
 20483         GO TO 7920-NOT-FOUND
 20484         DEPENDING ON DFHEIGDI
 20485     ELSE IF DFHEIGDJ EQUAL 34
 20486         GO TO 9870-NOTOPEN,
 20487               9870-EXIT
 20488         DEPENDING ON DFHEIGDI.
 20489     MOVE '9%                    "   ' TO DFHEIV0
 20490     MOVE 'EL156' TO DFHEIV1
 20491     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20492     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12228     Code:       76227
